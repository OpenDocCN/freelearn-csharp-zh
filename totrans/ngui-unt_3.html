<html><head></head><body><div class="chapter" title="Chapter&#xA0;3.&#xA0;Enhancing your UI"><div class="titlepage"><div><div><h1 class="title"><a id="ch03"/>Chapter 3. Enhancing your UI</h1></div></div></div><p>In this chapter, we will learn how to enhance our UI experience by using more advanced features, which are as follows:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Draggable panels and animations</li><li class="listitem" style="list-style-type: disc">The drag-and-drop system</li><li class="listitem" style="list-style-type: disc">Automatic content alignment</li><li class="listitem" style="list-style-type: disc">Clipping</li><li class="listitem" style="list-style-type: disc">Scrollable text</li><li class="listitem" style="list-style-type: disc">The localization system</li></ul></div><p>Let's start by talking about NGUI components and their overall behavior.</p><div class="section" title="NGUI components"><div class="titlepage"><div><div><h1 class="title"><a id="ch03lvl1sec22"/>NGUI components</h1></div></div></div><p>In <a class="link" href="ch02.html" title="Chapter 2. Creating Widgets">Chapter 2</a>, <span class="emphasis"><em>Creating Widgets</em></span>, we added the <span class="strong"><strong>UIStretch</strong></span> and <span class="strong"><strong>UIAnchor</strong></span> components to our widgets, and also the <span class="strong"><strong>Load Level On Click</strong></span> component. There are many more components, and the purpose of this chapter is to discuss these components. We will use the most important ones in this chapter. It is possible to add a component to any kind of widget—considering it is logical of course.</p><p>This component-oriented structure makes NGUI extremely flexible and modular. We will start by making our main menu a draggable window.</p></div></div>
<div class="section" title="The draggable panel"><div class="titlepage"><div><div><h1 class="title"><a id="ch03lvl1sec23"/>The draggable panel</h1></div></div></div><p>We <a id="id121" class="indexterm"/>will <a id="id122" class="indexterm"/>now learn how to turn our menu into a draggable window. Let's add the correct component to it and study its parameters, which are as follows:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Select the <span class="strong"><strong>Panel</strong></span> GameObject.</li><li class="listitem">Rename it as <code class="literal">MainMenu</code>.</li><li class="listitem">Attach the <span class="strong"><strong>Draggable Panel</strong></span> component to it by navigating to <span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>NGUI</strong></span> | <span class="strong"><strong>Interaction</strong></span>.</li></ol></div><p>The <span class="strong"><strong>MainMenu</strong></span> GameObject now has a <span class="strong"><strong>UIDraggable Panel</strong></span> component<a id="id123" class="indexterm"/> attached to it.</p><div class="section" title="Parameters"><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec39"/>Parameters</h2></div></div></div><p>The following <a id="id124" class="indexterm"/>are the 13 parameters for setting values in the <span class="strong"><strong>UIDraggable Panel</strong></span>:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Drag Effect</strong></span>: This is the effect used while dragging the panel to have a smoother drag.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Restrict Within Panel</strong></span>: This uses the parent panel to restrain the draggable panel within its clipping bounds.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Disable Drag If Fits</strong></span>: If the content fits the parent panel's clipping bounds, dragging will be disabled.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Smooth Drag Start</strong></span>: This avoids a "jump" effect on drag start.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Reposition Clipping</strong></span>: This repositions the <span class="strong"><strong>Clipping</strong></span> to the <span class="strong"><strong>Top Left Corner</strong></span> immediately.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>IOS Drag Emulation</strong></span>: Dragging movement speed is reduced when overpassing the clipping edges.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Scroll Wheel Factor</strong></span>: If you want the scroll wheel to drag the panel on the y axis, set this value to greater than 0.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Momentum Amount</strong></span>: This is the effect applied when the panel is dropped. The panel will keep moving after releasing the scroll wheel.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Horizontal Scroll Bar</strong></span>: This lets you drag a scroll bar to define it as the panel's horizontal scroll bar.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Vertical Scroll Bar</strong></span>: This lets you drag another scroll bar to define it as the panel's vertical scroll bar.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Show Scroll Bars</strong></span>: This allows you to show scroll bars always, show them only if necessary, or show them while dragging.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Scale</strong></span>: This defines which axis the panel should drag on: <code class="literal">0</code> means no dragging, <code class="literal">1</code> allows full dragging on this axis.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Relative Position On Reset</strong></span>: This is the offset relative to the mouse's position. It is useful if you want an offset from the mouse's position while dragging.</li></ul></div><p>Now that we have seen the component's parameters, let's use them to drag our main menu.</p></div><div class="section" title="Dragging the MainMenu"><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec40"/>Dragging the MainMenu</h2></div></div></div><p>We have <a id="id125" class="indexterm"/>added the <span class="strong"><strong>UIDraggable Panel</strong></span> component that sets this <span class="strong"><strong>UIPanel</strong></span> as a <span class="strong"><strong>Draggable Panel</strong></span>. Now, we must mark our <span class="strong"><strong>MainMenu</strong></span> as the GameObject that holds the draggable content.</p><p>We will also add a <span class="strong"><strong>Box Collider</strong></span> component to define where the user must click to drag the panel:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Select our <span class="strong"><strong>MainMenu</strong></span> GameObject and perform the following steps:<div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Set the <span class="strong"><strong>Clipping</strong></span> parameter of <span class="strong"><strong>UIPanel</strong></span> to <span class="strong"><strong>Alpha Clip</strong></span>.</li><li class="listitem">Set the <span class="strong"><strong>Size</strong></span> field in <span class="strong"><strong>Clipping</strong></span> to <code class="literal">1920</code> x <code class="literal">1080</code>.</li><li class="listitem">Uncheck the <span class="strong"><strong>IOS Drag Emulation</strong></span> Boolean.</li></ol></div></li><li class="listitem">Add the <span class="strong"><strong>Drag Panel Contents</strong></span> component to it.</li><li class="listitem">Add the <span class="strong"><strong>Box Collider</strong></span> component to it and perform the following steps:<div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Check the <span class="strong"><strong>Is Trigger</strong></span> Boolean—we don't need collisions, just a trigger to receive Raycasts from the <span class="strong"><strong>UICamera</strong></span>.</li><li class="listitem">Set its <span class="strong"><strong>Center</strong></span> coordinates to {<code class="literal">0</code>, <code class="literal">395</code>, <code class="literal">0</code>}.</li><li class="listitem">Set its <span class="strong"><strong>Size</strong></span> coordinates to {<code class="literal">1300</code>, <code class="literal">62</code>, <code class="literal">1</code>}.</li></ol></div></li></ol></div><p>Click on the play button. By clicking on the window's title, you can drag the main menu. But still, it isn't configured correctly; you can only move it on the x axis.</p><p>Let's change an important parameter of the <span class="strong"><strong>UIDraggable Panel</strong></span> component of <span class="strong"><strong>MainMenu</strong></span> to allow dragging on the x axis by performing the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Select our <span class="strong"><strong>MainMenu</strong></span> GameObject.</li><li class="listitem">Set <span class="strong"><strong>Scale</strong></span> in <span class="strong"><strong>UIDraggable Panel</strong></span> to {<code class="literal">1</code>, <code class="literal">1</code>, <code class="literal">0</code>}.</li></ol></div><p>And that's it! Our <span class="strong"><strong>MainMenu</strong></span> is now draggable on both the axes. If you drag it outside the screen, it will move back inside when dropped. We had to define a clipping of the screen's size for this <span class="strong"><strong>Restrict Within Panel</strong></span> function to work.</p></div></div>
<div class="section" title="The drag-and-drop system"><div class="titlepage"><div><div><h1 class="title"><a id="ch03lvl1sec24"/>The drag-and-drop system</h1></div></div></div><p>We <a id="id126" class="indexterm"/>will now create our own <span class="strong"><strong>drag-and-drop</strong></span> system that<a id="id127" class="indexterm"/> will enable the user to select a power. They will be able to drag one of the two available powers inside a selection box as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/8667OT_03_01.jpg" alt="The drag-and-drop system"/></div><div class="section" title="Powers selection"><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec41"/>Powers selection</h2></div></div></div><p>Let's <a id="id128" class="indexterm"/>create a drag-and-drop system to select which of the two powers the player can choose: a <span class="strong"><strong>Bomb</strong></span> power, which will explode or a <span class="strong"><strong>Time</strong></span> power, which will slow down time for a few seconds.</p><div class="section" title="Draggable items container"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl3sec10"/>Draggable items container</h3></div></div></div><p>Let's start <a id="id129" class="indexterm"/>by creating a nice box for our powers and a draggable items container by performing the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Select our <span class="strong"><strong>MainMenu</strong></span> GameObject and perform the given steps:<div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Create a new empty child GameObject by pressing <span class="emphasis"><em>Alt</em></span> + <span class="emphasis"><em>Shift</em></span> + <span class="emphasis"><em>N</em></span>.</li><li class="listitem">Rename it as <code class="literal">Powers</code>.</li></ol></div></li><li class="listitem">Select the <span class="strong"><strong>Background</strong></span> and <span class="strong"><strong>Label</strong></span> GameObjects from <span class="strong"><strong>Sound</strong></span>:<div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Duplicate them.</li><li class="listitem">Drag these new duplicates inside our <span class="strong"><strong>Powers</strong></span> GameObject.</li></ol></div></li><li class="listitem">Select the <span class="strong"><strong>Background</strong></span> GameObject in <span class="strong"><strong>Powers</strong></span> and perform these steps:<div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Set its <span class="strong"><strong>Dimensions</strong></span> to <code class="literal">320</code> x <code class="literal">420</code>.</li><li class="listitem">Set the <span class="strong"><strong>Pixel Offset</strong></span> in <span class="strong"><strong>UIAnchor</strong></span> to {<code class="literal">0</code>, <code class="literal">-100</code>}.</li></ol></div></li><li class="listitem">Select the <span class="strong"><strong>Label</strong></span> GameObject in <span class="strong"><strong>Powers</strong></span>:<div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Rename it as <code class="literal">TitleLabel</code>.</li><li class="listitem">Change its text to <code class="literal">[AAFFFF]Powers</code>.</li></ol></div></li><li class="listitem">Select<a id="id130" class="indexterm"/> the <span class="strong"><strong>Label</strong></span> GameObject, which is a child of <span class="strong"><strong>Title</strong></span>, and perform the following steps:<div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Duplicate it.</li><li class="listitem">Rename this new duplicate as <code class="literal">SelectedLabel</code>.</li><li class="listitem">Drag it inside our <span class="strong"><strong>Powers</strong></span> GameObject.</li><li class="listitem">Drag our <span class="strong"><strong>Background</strong></span> GameObject in <span class="strong"><strong>Powers</strong></span> to the <span class="strong"><strong>Container</strong></span> field in its <span class="strong"><strong>UIAnchor</strong></span>.</li><li class="listitem">Set its <span class="strong"><strong>Side</strong></span> parameter in <span class="strong"><strong>UIAnchor</strong></span> to <span class="strong"><strong>Top</strong></span>.</li><li class="listitem">Set its <span class="strong"><strong>Pixel Offset</strong></span> in <span class="strong"><strong>UIAnchor</strong></span> to {<code class="literal">0</code>, <code class="literal">-95</code>}.</li><li class="listitem">Change its <span class="strong"><strong>Font</strong></span> to <code class="literal">SciFi Font – Normal</code>.</li><li class="listitem">Change its text to <code class="literal">[AAFFFF]Selected</code>.</li></ol></div></li><li class="listitem">Select our <span class="strong"><strong>SelectedLabel</strong></span> GameObject in <span class="strong"><strong>Powers</strong></span> and perform the following steps:<div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Duplicate it.</li><li class="listitem">Rename this new duplicate as <code class="literal">AvailableLabel</code>.</li><li class="listitem">Change its text to <code class="literal">[AAFFFF]Available</code>.</li><li class="listitem">Set its <span class="strong"><strong>Pixel Offset</strong></span> in <span class="strong"><strong>UIAnchor</strong></span> to {<code class="literal">0</code>, <code class="literal">-295</code>}.</li></ol></div></li><li class="listitem">Select our <span class="strong"><strong>SelectedLabel GameObject</strong></span> in <span class="strong"><strong>Powers</strong></span> and perform these steps:<div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Duplicate it.</li><li class="listitem">Rename this new duplicate it as <code class="literal">InstructionsLabel</code>.</li><li class="listitem">Change text to <code class="literal">[55AA99]Drag Power Here</code>—one word per line.</li><li class="listitem">Set its <span class="strong"><strong>Overflow</strong></span> parameter to <span class="strong"><strong>Shrink Content</strong></span>.</li><li class="listitem">Set its <span class="strong"><strong>Depth</strong></span> to <code class="literal">4</code>.</li><li class="listitem">Set its <span class="strong"><strong>Dimensions</strong></span> to <code class="literal">128</code> x <code class="literal">45</code>.</li><li class="listitem">Set its <span class="strong"><strong>Pixel Offset</strong></span> in <span class="strong"><strong>UIAnchor</strong></span> to {<code class="literal">0</code>, <code class="literal">-175</code>}.</li></ol></div></li><li class="listitem">Select our <span class="strong"><strong>Background</strong></span> sprite GameObject in <span class="strong"><strong>Powers</strong></span> and perform the following steps:<div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Duplicate it.</li><li class="listitem">Rename this new duplicate as <code class="literal">PowersContainer</code>.</li><li class="listitem">Set its <span class="strong"><strong>Dimensions</strong></span> to <code class="literal">215</code> x <code class="literal">90</code>.</li><li class="listitem">Set its <span class="strong"><strong>Color Tint</strong></span> to {<code class="literal">100</code>, <code class="literal">100</code>, <code class="literal">100</code>, <code class="literal">255</code>}.</li><li class="listitem">Set its <span class="strong"><strong>Depth</strong></span> to <code class="literal">3</code>.</li><li class="listitem">Drag our <span class="strong"><strong>AvailableLabel</strong></span> GameObject from <span class="strong"><strong>Powers</strong></span> to the <span class="strong"><strong>Container</strong></span> field in its <span class="strong"><strong>UIAnchor</strong></span>.</li><li class="listitem">Set its <span class="strong"><strong>Pixel Offset</strong></span> in <span class="strong"><strong>UIAnchor</strong></span> to {<code class="literal">0</code>, <code class="literal">-60</code>}.</li></ol></div></li></ol></div><p>Ok, we now <a id="id131" class="indexterm"/>have our powers box with the correct labels and a background.</p></div><div class="section" title="Draggable items"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl3sec11"/>Draggable items</h3></div></div></div><p>Now that we <a id="id132" class="indexterm"/>have the PowersContainer, let's create the following two draggable items:</p><div class="mediaobject"><img src="graphics/8667OT_03_02.jpg" alt="Draggable items"/></div><p>Follow the ensuing steps to create them:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Select our <span class="strong"><strong>PowersContainer</strong></span> GameObject in <span class="strong"><strong>Powers</strong></span>.</li><li class="listitem">Create a new child GameObject with <span class="emphasis"><em>Alt</em></span> + <span class="emphasis"><em>Shift</em></span> + <span class="emphasis"><em>N</em></span> and rename it as <code class="literal">Bomb</code>.</li><li class="listitem">Attach a <span class="strong"><strong>Collider</strong></span> object to it by navigating to <span class="strong"><strong>NGUI</strong></span> | <span class="strong"><strong>Attach</strong></span>. It will be used to detect the mouse and receive the correct messages for the drag-and-drop system by performing the following steps:<div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Check the <span class="strong"><strong>Is Trigger</strong></span> Boolean.</li><li class="listitem">Set its <span class="strong"><strong>Size</strong></span> field of new <span class="strong"><strong>Box Collider</strong></span> to {<code class="literal">90</code>, <code class="literal">90</code>, <code class="literal">1</code>}.</li></ol></div></li><li class="listitem">Attach a <span class="strong"><strong>Drag Object</strong></span> component to it by navigating to <span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>NGUI</strong></span> | <span class="strong"><strong>Interaction</strong></span>:<div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Drag our <span class="strong"><strong>Bomb</strong></span> from <span class="strong"><strong>PowersContainer</strong></span> in its <span class="strong"><strong>Target</strong></span> field.</li><li class="listitem">Set its <span class="strong"><strong>Scale</strong></span> to {<code class="literal">1</code>, <code class="literal">1</code>, <code class="literal">0</code>}.</li><li class="listitem">Set the <span class="strong"><strong>Momentum Amount</strong></span> to <code class="literal">0</code>.</li></ol></div></li><li class="listitem">Select and duplicate the <span class="strong"><strong>Background</strong></span> sprite GameObject in <span class="strong"><strong>Powers</strong></span>. Then perform the following steps:<div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Drag it inside our new <span class="strong"><strong>Bomb</strong></span> GameObject.</li><li class="listitem">Set its <span class="strong"><strong>Depth</strong></span> to <code class="literal">5</code>.</li><li class="listitem">Set its <span class="strong"><strong>Dimensions</strong></span> to <code class="literal">90</code> x <code class="literal">90</code>.</li><li class="listitem">Remove its <span class="strong"><strong>UIAnchor</strong></span> component.</li><li class="listitem">Reset its <span class="strong"><strong>Transform</strong></span> position values to {<code class="literal">0</code>, <code class="literal">0</code>, <code class="literal">0</code>}.</li></ol></div></li><li class="listitem">Select<a id="id133" class="indexterm"/> and duplicate the <span class="strong"><strong>AvailableLabel</strong></span> GameObject in <span class="strong"><strong>Powers</strong></span>. Then perform these steps:<div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Rename that new duplicate as <code class="literal">Label</code>.</li><li class="listitem">Drag it inside our new <span class="strong"><strong>Bomb</strong></span> GameObject.</li><li class="listitem">Change its text to <code class="literal">[AAFFFF]Bomb</code>.</li><li class="listitem">Set its <span class="strong"><strong>Depth</strong></span> to <code class="literal">6</code>.</li><li class="listitem">Remove its <span class="strong"><strong>UIAnchor</strong></span> component.</li><li class="listitem">Reset its <span class="strong"><strong>Transform</strong></span> position values to {<code class="literal">0</code>, <code class="literal">0</code>, <code class="literal">0</code>}.</li></ol></div></li><li class="listitem">Select our <span class="strong"><strong>Bomb</strong></span> GameObject.</li><li class="listitem">Attach a <span class="strong"><strong>Button Color</strong></span> component to it by navigating to <span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>NGUI</strong></span> | <span class="strong"><strong>Interaction</strong></span> and perform these steps:<div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Drag our <span class="strong"><strong>Background</strong></span> GameObject from <span class="strong"><strong>Bomb</strong></span> to the <span class="strong"><strong>Target</strong></span> field.</li><li class="listitem">Set its <span class="strong"><strong>Pressed</strong></span><code class="literal"> </code>color to {<code class="literal">0</code>, <code class="literal">255</code>, <code class="literal">0</code>, <code class="literal">150</code>}.</li></ol></div></li><li class="listitem">Create a new <code class="literal">DragItem.cs</code> C# script and attach this script to the <span class="strong"><strong>Button Color</strong></span> component.</li></ol></div><p>We have one draggable Bomb power with a <code class="literal">DragItem.cs </code>script attached to it. Let's create the second Time power by performing the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Select and duplicate our <span class="strong"><strong>Bomb</strong></span> GameObject in <span class="strong"><strong>PowersContainer</strong></span>.</li><li class="listitem">Rename that new duplicate as <code class="literal">Time</code>.</li><li class="listitem">Select our new <span class="strong"><strong>Label</strong></span> GameObject, which is a child of <span class="strong"><strong>Time</strong></span>.</li><li class="listitem">Change its text to <code class="literal">[AAFFFF]Time</code>.</li></ol></div><p>Ok, we now have our two draggable Powers, and they are on top of each other. Let's correct this using Anchors and a Grid component, which will automatically align our items. We can do this using the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Select our <span class="strong"><strong>PowersContainer</strong></span> GameObject.</li><li class="listitem">Create a new child by pressing <span class="emphasis"><em>Alt</em></span> + <span class="emphasis"><em>Shift</em></span> + <span class="emphasis"><em>N</em></span> and rename this new child as <code class="literal">Grid</code>.</li><li class="listitem">Attach a <span class="strong"><strong>Grid</strong></span> component to it by navigating to <span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>NGUI</strong></span> | <span class="strong"><strong>Interaction</strong></span>.</li><li class="listitem">Drag both our <span class="strong"><strong>Bomb</strong></span> and <span class="strong"><strong>Time</strong></span> GameObjects in our new <span class="strong"><strong>Grid</strong></span> GameObject.</li><li class="listitem">Select our <span class="strong"><strong>Grid</strong></span> GameObject and perform the following steps:<div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Set its <span class="strong"><strong>Cell Width</strong></span> to <code class="literal">105</code>.</li><li class="listitem">Check the <span class="strong"><strong>Sorted</strong></span> Boolean.</li><li class="listitem">Check the <span class="strong"><strong>Reposition Now</strong></span> Boolean to update the table.</li><li class="listitem">Set its <span class="strong"><strong>Transform</strong></span> position to {<code class="literal">-52</code>, <code class="literal">0</code>, <code class="literal">0</code>}.</li></ol></div></li></ol></div><p>The UIGrid component <a id="id134" class="indexterm"/>automatically aligns its children. We now have our two draggable powers aligned. If you click on play, you'll see that you can drag them around as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/8667OT_03_03.jpg" alt="Draggable items"/></div></div><div class="section" title="The drop surface"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl3sec12"/>The drop surface</h3></div></div></div><p>We will<a id="id135" class="indexterm"/> create a new <span class="strong"><strong>Surface</strong></span> GameObject with a <code class="literal">DropSurface.cs</code> script and a <span class="strong"><strong>Box Collider</strong></span> component to define where the draggable items can be dropped.</p><p>When the user drops an object with a <span class="strong"><strong>DragItem</strong></span> component on the <span class="strong"><strong>Surface</strong></span> GameObject, the <span class="strong"><strong>DragItem</strong></span> component will be destroyed, and a "dropped version" of the object will be instantiated as a child of the <span class="strong"><strong>Surface</strong></span> GameObject.</p><p>First, let's create and configure the <span class="strong"><strong>Surface</strong></span> GameObject by performing the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Select and duplicate our <span class="strong"><strong>Background</strong></span> GameObject from <span class="strong"><strong>Powers</strong></span> and rename this new duplicate as <code class="literal">Surface</code>.</li><li class="listitem">Select our new <span class="strong"><strong>Surface</strong></span> GameObject from <span class="strong"><strong>Powers</strong></span> and perform these steps:<div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Change its <span class="strong"><strong>Sprite</strong></span> to <span class="strong"><strong>Highlight</strong></span>.</li><li class="listitem">Change its <span class="strong"><strong>Color Tint</strong></span> to {<code class="literal">0</code>, <code class="literal">25</code>, <code class="literal">5</code>, <code class="literal">255</code>}.</li><li class="listitem">Set its <span class="strong"><strong>Depth</strong></span> to <code class="literal">3</code>.</li><li class="listitem">Set its <span class="strong"><strong>Dimensions</strong></span> to <code class="literal">130</code> x <code class="literal">130</code>.</li><li class="listitem">Drag our <span class="strong"><strong>SelectedLabel</strong></span> GameObject from <span class="strong"><strong>Powers</strong></span> to the <span class="strong"><strong>Container</strong></span> field in its <span class="strong"><strong>UIAnchor</strong></span>.</li><li class="listitem">Set its <span class="strong"><strong>Pixel Offset</strong></span> to {<code class="literal">0</code>, <code class="literal">-80</code>}.</li></ol></div></li><li class="listitem">Attach<a id="id136" class="indexterm"/> a <span class="strong"><strong>Collider</strong></span> object to it by navigating to <span class="strong"><strong>NGUI</strong></span> | <span class="strong"><strong>Attach</strong></span> | <span class="strong"><strong>Collider</strong></span>. It will detect <span class="strong"><strong>DragItems</strong></span>. Then perform the following steps:<div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Check its <span class="strong"><strong>Is Trigger</strong></span> Boolean.</li><li class="listitem">Set its <span class="strong"><strong>Size</strong></span> to {<code class="literal">130</code>, <code class="literal">130</code>, <code class="literal">1</code>}.</li></ol></div></li><li class="listitem">Create and attach a new <code class="literal">DropSurface.cs</code> C# script to it.</li></ol></div><p>Good, our surface is now ready to detect our items.</p></div><div class="section" title="Prefab instantiated on drop"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl3sec13"/>Prefab instantiated on drop</h3></div></div></div><p>Now, we<a id="id137" class="indexterm"/> need to create two prefabs for our powers that will be instantiated as children of the <span class="strong"><strong>Surface</strong></span> GameObject when a <span class="strong"><strong>DragItem</strong></span> component is dropped on it. They will look as follows:</p><div class="mediaobject"><img src="graphics/8667OT_03_04.jpg" alt="Prefab instantiated on drop"/></div><p>Let's create these prefabs by performing the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Select the <span class="strong"><strong>Bomb</strong></span> GameObject from <span class="strong"><strong>Grid</strong></span> and the following steps:<div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Duplicate it.</li><li class="listitem">Rename it as <code class="literal">SelectedBomb</code>.</li></ol></div></li><li class="listitem">Select our new <span class="strong"><strong>SelectedBomb</strong></span> GameObject from <span class="strong"><strong>Grid</strong></span>. Then perform the following steps:<div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Change its <span class="strong"><strong>Normal</strong></span> color tint to <span class="strong"><strong>R</strong></span>: <code class="literal">0</code>, <span class="strong"><strong>G</strong></span>: <code class="literal">145</code>, <span class="strong"><strong>B</strong></span>: <code class="literal">60</code>, and <span class="strong"><strong>A</strong></span>: <code class="literal">255</code>.</li><li class="listitem">Remove its <span class="strong"><strong>Box Collider</strong></span> component.</li><li class="listitem">Remove its <span class="strong"><strong>Drag Item</strong></span> component.</li></ol></div></li><li class="listitem">Create and attach a new <code class="literal">Power.cs</code> C# script to it.</li><li class="listitem">Select the <span class="strong"><strong>Background</strong></span> sprite GameObject from <span class="strong"><strong>SelectedBomb</strong></span>. Then perform the following steps:<div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Change the <span class="strong"><strong>Sprite</strong></span> to <span class="strong"><strong>Light</strong></span>.</li><li class="listitem">Set its <span class="strong"><strong>Depth</strong></span> to <code class="literal">4</code>.</li><li class="listitem">Set its <span class="strong"><strong>Dimensions</strong></span> to <code class="literal">120</code> x <code class="literal">120</code>.</li></ol></div></li><li class="listitem">Select the <span class="strong"><strong>Label</strong></span> GameObject from <span class="strong"><strong>SelectedBomb</strong></span> and set its <span class="strong"><strong>Depth</strong></span> to <code class="literal">5</code>.</li><li class="listitem">Drag our <span class="strong"><strong>SelectedBomb</strong></span> GameObject into a folder of your choice in your <span class="strong"><strong>Project</strong></span> view to create a prefab from it.</li><li class="listitem">Once our <span class="strong"><strong>SelectedBomb</strong></span> is a prefab (blue in the scene's <span class="strong"><strong>Hierarchy</strong></span>), you may delete it from the scene.</li></ol></div><p>We now<a id="id138" class="indexterm"/> have our <span class="strong"><strong>SelectedBomb</strong></span> prefab. Let's declare a variable in our <code class="literal">DragItem.cs</code> script that will store the prefab to instantiate on drop. We can do this by following the ensuing steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Select our <span class="strong"><strong>Bomb</strong></span> GameObject from <span class="strong"><strong>Grid</strong></span>.</li><li class="listitem">Open the <code class="literal">DragItem.cs</code> script attached to it and add this public variable using the following code:<div class="informalexample"><pre class="programlisting">public Object CreateOnDrop;</pre></div></li><li class="listitem">Save the script and go back to Unity.</li><li class="listitem">Select our <span class="strong"><strong>Bomb</strong></span> GameObject from <span class="strong"><strong>Grid</strong></span> and drag our <span class="strong"><strong>SelectedBomb</strong></span> prefab from the Project view in the <span class="strong"><strong>Create On Drop</strong></span> field in its <span class="strong"><strong>Drag Item</strong></span>.</li></ol></div><p>Now let's do the same for our <span class="strong"><strong>Time</strong></span> power in the following manner:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Select our <span class="strong"><strong>SelectedBomb</strong></span> prefab in the <span class="strong"><strong>Project</strong></span> view and perform the following steps:<div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Duplicate it with <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>D</em></span>.</li><li class="listitem">Rename the new duplicate prefab as <code class="literal">SelectedTime</code>.</li></ol></div></li><li class="listitem">Select its <span class="strong"><strong>Label</strong></span> child GameObject and change its text to <code class="literal">[AAFFFF]Time</code>.</li><li class="listitem">Select our <span class="strong"><strong>Time</strong></span> GameObject from <span class="strong"><strong>Grid</strong></span> in the scene's <span class="strong"><strong>Hierarchy</strong></span>.</li><li class="listitem">Drag our <span class="strong"><strong>SelectedTime</strong></span> prefab from the <span class="strong"><strong>Project</strong></span> view in the <span class="strong"><strong>Create On Drop</strong></span> field in its <span class="strong"><strong>Drag Item</strong></span>.</li></ol></div><p>We can now add an <code class="literal">OnDrop()</code> method to our <code class="literal">DropSurface.cs</code> script to handle dropped objects in the following manner:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Select our <span class="strong"><strong>Surface</strong></span> GameObject from <span class="strong"><strong>Powers</strong></span>.</li><li class="listitem">Open its attached <code class="literal">DropSurface.cs</code> script.</li></ol></div><p>The <code class="literal">OnDrop()</code> event has one argument: the <code class="literal">dropped</code> GameObject. Let's add this method to our script<a id="id139" class="indexterm"/> to handle the drop by using the following code snippet:</p><div class="informalexample"><pre class="programlisting">//Called when an object is dropped on DropSurface
public void OnDrop(GameObject dropped)
{
  //Get the DragItem from the dropped object
  DragItem dragItem = dropped.GetComponent&lt;DragItem&gt;();
  //If it has none, don't go further
  if(dragItem == null) return;
  //Instantiate the defined CreateOnDrop Object
  GameObject newPower = NGUITools.AddChild(this.gameObject, dragItem.CreateOnDrop as GameObject);
  //Destroy the dropped Object
  Destroy(dropped);
}</pre></div><p>Save the script and click on the play button. When you drop a power on the <span class="strong"><strong>Surface</strong></span> GameObject, nothing happens! Why?</p><p>That's because the <code class="literal">OnDrop()</code> event depends on the Raycast from <code class="literal">Camera</code>, and at the moment of the drop, our dragged power's <span class="strong"><strong>Box Collider</strong></span> component is in the way of the mouse cursor and the <span class="strong"><strong>Surface</strong></span> GameObject.</p><p>We just have to disable the collider of <span class="strong"><strong>Power</strong></span> while it is dragged. We can do this in the following manner:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Select our <span class="strong"><strong>Bomb</strong></span> GameObject from <span class="strong"><strong>Grid</strong></span>.</li><li class="listitem">Open its attached <code class="literal">DragItem.cs</code> script.</li></ol></div><p>We will use the <code class="literal">OnPress()</code> event to do this. The <code class="literal">OnPress()</code> method will take the object's <code class="literal">pressed</code> state as an argument in the following manner:</p><div class="informalexample"><pre class="programlisting">//Method called when the Item is Pressed or Released
void OnPress(bool pressed)
{
  //Invert the collider's state
  collider.enabled = !pressed;
}</pre></div><p>Save the script and click on play. You can now drag-and-drop the powers on the surface!</p></div><div class="section" title="Handling an invalid drop"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl3sec14"/>Handling an invalid drop</h3></div></div></div><p>Now, let's <a id="id140" class="indexterm"/>make sure power is repositioned to its default position if the user drops it outside the <span class="strong"><strong>Surface</strong></span> GameObject.</p><p>To achieve this, we can check the camera's last hit when the <code class="literal">OnPress(false)</code> event occurs. Open our <code class="literal">DragItem.cs</code> and add the following lines after <code class="literal">collider.enabled = !pressed</code>:</p><div class="informalexample"><pre class="programlisting">//If the Item is released
if(!pressed)
{
  //Get the last hit collider
  Collider col = UICamera.lastHit.collider;
  //If there is no collider, or no DropSurface behind the Power
  if(col == null || col.GetComponent&lt;DropSurface&gt;() == null)
  {
    //Get the grid in parent objects
    UIGrid grid = NGUITools.FindInParents&lt;UIGrid&gt;(gameObject);
    //If a grid is found, order it to Reposition now
    if(grid != null) grid.Reposition();
  }
}</pre></div><p>Save and click on play. If you drop a Power anywhere but on the <span class="strong"><strong>Surface</strong></span> GameObject, our items will be repositioned automatically. Great!</p><p>A slight problem: you can drop both of them on the surface, and then you're stuck. Let's explore the solution in the following sections.</p></div><div class="section" title="Replacing the current item"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl3sec15"/>Replacing the current item</h3></div></div></div><p>We will <a id="id141" class="indexterm"/>now ensure that you can only have one power on the surface. If you drag a second one while the DropSurface is already occupied, the current power will be replaced by the new one and the drag item component will reappear in the <span class="strong"><strong>PowersContainer</strong></span> GameObject.</p><p>We will need to know which power is currently dropped on the surface and which original drag Item component must be instantiated in <span class="strong"><strong>Grid</strong></span> in <span class="strong"><strong>PowersContainer</strong></span>:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Select our <span class="strong"><strong>SelectedBomb</strong></span> prefab in the <span class="strong"><strong>Project</strong></span> view.</li><li class="listitem">Open its attached <code class="literal">Power.cs</code> script.</li></ol></div><p>This script will be used to contain information about the dropped item. Let's declare a new <code class="literal">enum</code> to distinguish which type of power, and an <code class="literal">Object</code> variable to set which prefab will be instantiated to make the draggable item in power reappear when replaced:</p><div class="informalexample"><pre class="programlisting">//Declare an enum to define type of Power
public enum Type 
{
  None,
  Time,
  Bomb
}
//Declare a Type variable to choose it in Inspector
public Type type;
//Object variable to define the DragItem to recreate
public Object createOnDestroy;</pre></div><p>Now, we need<a id="id142" class="indexterm"/> to go back to Unity and create prefabs for our <code class="literal">Bomb</code> and <code class="literal">Time</code> draggable items before we assign them to the <code class="literal">createOnDestroy</code> variables:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Select our <span class="strong"><strong>Bomb</strong></span> GameObject from <span class="strong"><strong>Powers</strong></span> in the <span class="strong"><strong>Hierarchy</strong></span> of <span class="strong"><strong>Scene</strong></span> and drag it into a folder of your choice in your <span class="strong"><strong>Project</strong></span> view to create a prefab from it.</li><li class="listitem">Select our <span class="strong"><strong>SelectedBomb</strong></span> Prefab in the <span class="strong"><strong>Project</strong></span> view and perform the following steps:<div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Set its <span class="strong"><strong>Power</strong></span> component's <span class="strong"><strong>Type</strong></span> variable to <span class="strong"><strong>Bomb</strong></span>.</li><li class="listitem">Drag our new <span class="strong"><strong>Bomb</strong></span> Prefab from the Project view to the <span class="strong"><strong>Power</strong></span> component's <span class="strong"><strong>Create On Destroy</strong></span> field.</li></ol></div></li></ol></div><p>We assigned the <span class="strong"><strong>Type</strong></span> parameter of <span class="strong"><strong>SelectedBomb</strong></span> to <span class="strong"><strong>Bomb</strong></span>, and it now has an assigned prefab that we will instantiate to recreate the draggable item when it gets replaced.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note10"/>Note</h3><p>Repeat steps 1 and 2, replacing the word <code class="literal">Bomb</code> with <code class="literal">Time</code> to do the same for our Time power GameObject and prefab.</p></div></div><p>Now, we have to code a system that will register which type of power is currently selected. We'll use the <code class="literal">GameManager.cs</code> script in the following manner to store it:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open our <code class="literal">GameManager.cs</code> script and declare this new static variable:<div class="informalexample"><pre class="programlisting">//This static variable will contain the selected power
public static Power.Type SelectedPower = Power.Type.None;</pre></div></li><li class="listitem">Add this new static method to set our <code class="literal">SelectedPower</code> from other scripts:<div class="informalexample"><pre class="programlisting">//This static method changes the SelectedPower value
public static void SetPower(Power.Type newPower)
{
  SelectedPower = newPower;
}</pre></div></li></ol></div><p>Ok, we now have a method to register the currently selected power. It is time to modify our <code class="literal">DropSurface.cs</code> script:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Select our <span class="strong"><strong>Surface</strong></span> GameObject from <span class="strong"><strong>Powers</strong></span> and open the <code class="literal">DropSurface.cs</code> script.</li><li class="listitem">Declare a new <code class="literal">GameObject</code> variable to store our <span class="strong"><strong>Grid</strong></span> GameObject:<div class="informalexample"><pre class="programlisting">public GameObject dragItemsContainer;</pre></div></li><li class="listitem">Save the script, select our <span class="strong"><strong>Surface</strong></span> GameObject from <span class="strong"><strong>Powers</strong></span> in the <span class="strong"><strong>Hierarchy</strong></span> view. Drag our <span class="strong"><strong>Grid</strong></span> GameObject from <span class="strong"><strong>PowersContainer</strong></span> in its <span class="strong"><strong>DropSurface</strong></span> component's <span class="strong"><strong>Drag Items Container</strong></span> field.</li></ol></div><p>Now, go <a id="id143" class="indexterm"/>back to our <code class="literal">DropSurface.cs</code> script. We will add these following lines to handle the fact that the user cannot drop two powers on the surface; it will replace the previous one and recreate its original <code class="literal">Drag Item</code>. In the <code class="literal">OnDrop()</code> method, just below the <code class="literal">if(dragItem == null) return</code> line, add the following:</p><div class="informalexample"><pre class="programlisting">RecreateDragItem();</pre></div><p>Now, add a new <code class="literal">RecreateDragItem()</code> method<a id="id144" class="indexterm"/> to the file:</p><div class="informalexample"><pre class="programlisting">void RecreateDragItem()
{
  //If there's already a Power selected
  if(GameManager.SelectedPower != Power.Type.None)
  {
    //Get the selected power's Power.cs script
    Power selectedPowerScript = transform.GetChild(0).GetComponent&lt;Power&gt;();
    //Add the Drag Item to the grid
    NGUITools.AddChild(dragItemsContainer, selectedPowerScript.createOnDestroy as GameObject);
    //Destroy the currently selected Power
    Destroy(selectedPowerScript.gameObject);
  }
}</pre></div><p>Ok, we now have to inform the <code class="literal">GameManager.cs</code> script that the selected Power has changed. We can do this by calling our <code class="literal">SetPower()</code> static method.</p><p>Add the following line in the <code class="literal">OnDrop()</code> method just before the <code class="literal">Destroy(dropped)</code> line:</p><div class="informalexample"><pre class="programlisting">//Set the new selected power in the GameManager
GameManager.SetPower(newPower.GetComponent&lt;Power&gt;().type);</pre></div><p>Save all the scripts and click on the play button. You can drop the first Power on the <span class="strong"><strong>Surface</strong></span> GameObject and then drop the second one. The first power is now replaced and will reappear in the <span class="strong"><strong>Available</strong></span> power container.</p><p>Unfortunately, we cannot simply remove the power. Let's correct this in the following sections.</p></div><div class="section" title="Removing the current item"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl3sec16"/>Removing the current item</h3></div></div></div><p>We want <a id="id145" class="indexterm"/>to remove the selected power by clicking on it. In our <code class="literal">DropSurface.cs</code> script, add this new <code class="literal">OnClick()</code> method that will be called when the user clicks on the surface:</p><div class="informalexample"><pre class="programlisting">void OnClick()
{
  //Recreate the DragItem now
  RecreateDragItem();
  //Reset SelectedPower to None
  GameManager.SetPower(Power.Type.None);
  //Force reposition of the grid
  dragItemsContainer.GetComponent&lt;UIGrid&gt;().Reposition();
}</pre></div><p>Now click on play. You can now remove the selected power by right- or left-clicking on it.</p></div></div></div>
<div class="section" title="Animations with NGUI"><div class="titlepage"><div><div><h1 class="title"><a id="ch03lvl1sec25"/>Animations with NGUI</h1></div></div></div><p>One great<a id="id146" class="indexterm"/> aspect of NGUI is that you can use Unity's animation system <a id="id147" class="indexterm"/>on any kind of widget. There also are some Tween components that let you modify most values over time, such as dimensions, color, and scale. For example, you can change an object's color from color A to color B in 5 seconds.</p><p>We have a nice main menu. But we actually have our options that are constantly displayed. That is not very user friendly.</p><p>We will use animations and tweens to hide our options and show them only when the user clicks on the <span class="strong"><strong>Options</strong></span> button. With options hidden, our menu will look as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/8667OT_03_05.jpg" alt="Animations with NGUI"/></div><p>But first, let's make our powers' apparition smoother.</p><div class="section" title="Smooth powers apparition"><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec42"/>Smooth powers apparition</h2></div></div></div><p>Let's <a id="id148" class="indexterm"/>add <span class="strong"><strong>Scale Tweens</strong></span>
<a id="id149" class="indexterm"/> on our prefabs to make them appear smoothly by performing the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">In the Project view, select our <span class="strong"><strong>SelectedBomb</strong></span> prefab.</li><li class="listitem">Attach a <span class="strong"><strong>Scale Tween</strong></span> component by navigating to <span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>NGUI</strong></span> | <span class="strong"><strong>Tween</strong></span> and perform the following steps:<div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Set its <span class="strong"><strong>From</strong></span> parameter to {<code class="literal">0</code>, <code class="literal">0</code>, <code class="literal">0</code>,}.</li><li class="listitem">Set its <span class="strong"><strong>Duration</strong></span> to <code class="literal">0.2</code>.</li></ol></div></li><li class="listitem">Right-click on the <span class="strong"><strong>Tween Scale</strong></span> component and then click on <span class="strong"><strong>Copy Component</strong></span>.</li><li class="listitem">Select our <span class="strong"><strong>SelectedTime</strong></span>, <span class="strong"><strong>Bomb</strong></span>, and <span class="strong"><strong>Time</strong></span> prefabs.</li><li class="listitem">In the <span class="strong"><strong>Inspector</strong></span> view, right-click on any existing component name and click on <span class="strong"><strong>Paste Component As New</strong></span>.</li></ol></div><p>Now, as soon as these widgets are created, they scale from 0 to 1 in 0.2 seconds, which makes them appear smoothly.</p><p>We can now see how we'll hide and show options using a button.</p></div><div class="section" title="Clipping to hide options"><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec43"/>Clipping to hide options</h2></div></div></div><p>First, <a id="id150" class="indexterm"/>we have to hide our option boxes. To do that, we will use <span class="strong"><strong>Panel</strong></span> <span class="strong"><strong>Clipping</strong></span>
<a id="id151" class="indexterm"/> and increase their width when we need to show them. Let's set up the Clipping option:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Select our <span class="strong"><strong>Window</strong></span> GameObject from <span class="strong"><strong>MainMenu</strong></span> and set its <span class="strong"><strong>Dimensions</strong></span> to <code class="literal">515</code> x <code class="literal">850</code>.</li><li class="listitem">Select the <span class="strong"><strong>MainMenu</strong></span> GameObject and perform the following steps:<div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Set its <span class="strong"><strong>Depth</strong></span> in <span class="strong"><strong>UIPanel</strong></span> to <code class="literal">-1</code>.</li><li class="listitem">Create a new child for <span class="strong"><strong>MainMenu</strong></span> with <span class="emphasis"><em>Alt</em></span> + <span class="emphasis"><em>Shift</em></span> + <span class="emphasis"><em>N</em></span>.</li><li class="listitem">Rename this new child as <code class="literal">Container</code>.</li></ol></div></li><li class="listitem">Select our new <span class="strong"><strong>Container</strong></span> GameObject.</li><li class="listitem">Attach a <span class="strong"><strong>Panel</strong></span> component to it by navigating to <span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>NGUI</strong></span> | <span class="strong"><strong>UI</strong></span>. Then perform the following steps:<div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Set its <span class="strong"><strong>Depth</strong></span> to <code class="literal">0</code>.</li><li class="listitem">Set its <span class="strong"><strong>Clipping</strong></span> parameter to <span class="strong"><strong>Alpha Clip</strong></span>.</li><li class="listitem">Set its <span class="strong"><strong>Size</strong></span> to <code class="literal">515</code> x <code class="literal">1080</code>.</li></ol></div></li><li class="listitem">Fold all the children of <span class="strong"><strong>MainMenu</strong></span> using the arrow next to each of them.</li><li class="listitem">Select every child of <span class="strong"><strong>MainMenu</strong></span>, except the new <span class="strong"><strong>Container</strong></span> child, and drag them all inside our new <span class="strong"><strong>Container</strong></span> GameObject.</li></ol></div><p>Good, our options are now hidden. Your <span class="strong"><strong>Hierarchy</strong></span> should look as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/8667OT_03_06.jpg" alt="Clipping to hide options"/></div><p>Let's add<a id="id152" class="indexterm"/> an <span class="strong"><strong>Options</strong></span> button that will show or hide these options:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Select and duplicate our <span class="strong"><strong>Play</strong></span><code class="literal"> </code>GameObject from <span class="strong"><strong>Buttons</strong></span> and rename this new duplicate as <code class="literal">Options</code>.</li><li class="listitem">Select our new <span class="strong"><strong>Options</strong></span> GameObject from <span class="strong"><strong>Buttons</strong></span> and perform the following steps:<div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Set its <span class="strong"><strong>Side</strong></span> parameter in <span class="strong"><strong>UIAnchor</strong></span> to <span class="strong"><strong>Bottom</strong></span>.</li><li class="listitem">Reset its <span class="strong"><strong>Pixel Offset</strong></span> in <span class="strong"><strong>UIAnchor</strong></span> to {<code class="literal">0</code>, <code class="literal">0</code>}.</li><li class="listitem">Set its <span class="strong"><strong>Size</strong></span> in <span class="strong"><strong>Box Collider</strong></span> to {<code class="literal">140</code>, <code class="literal">40</code>, <code class="literal">0</code>}.</li><li class="listitem">Remove its <span class="strong"><strong>Load Level On Click</strong></span> component.</li></ol></div></li><li class="listitem">Select our <span class="strong"><strong>Background</strong></span> GameObject from <span class="strong"><strong>Options</strong></span> and set its <span class="strong"><strong>Dimensions</strong></span> to <code class="literal">140</code> x <code class="literal">40</code>.</li><li class="listitem">Select our <span class="strong"><strong>Label</strong></span> GameObject from <span class="strong"><strong>Options</strong></span>:<div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Change its text to <code class="literal">Options</code>.</li><li class="listitem">Set its <span class="strong"><strong>Overflow</strong></span> parameter to <span class="strong"><strong>Shrink Content</strong></span>.</li><li class="listitem">Set its <span class="strong"><strong>Dimensions</strong></span> to <code class="literal">90</code> x <code class="literal">25</code>.</li></ol></div></li></ol></div><p>Ok, so now we have an <span class="strong"><strong>Options</strong></span> button. Next, we want it to enlarge our <span class="strong"><strong>Window</strong></span> and the Panel Clipping <code class="literal">width</code> of <span class="strong"><strong>Container</strong></span> when clicked. We can do this using code, but we will use tweens and animations in the following manner to see how they work:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Select our <span class="strong"><strong>Window</strong></span> GameObject in <span class="strong"><strong>Container</strong></span>.</li><li class="listitem">Attach a <span class="strong"><strong>Tween Width</strong></span> component to it by navigating to <span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>NGUI</strong></span> | <span class="strong"><strong>Tween</strong></span>. Then perform the following steps:<div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Set its <span class="strong"><strong>From</strong></span> parameter to <code class="literal">515</code>.</li><li class="listitem">Set its <span class="strong"><strong>To</strong></span> parameter to <code class="literal">1300</code>.</li><li class="listitem">Set <span class="strong"><strong>Duration</strong></span> to <code class="literal">0.5</code>.</li><li class="listitem">Reset <span class="strong"><strong>Dimensions</strong></span> to <code class="literal">515</code> x <code class="literal">850</code>.</li><li class="listitem">Disable the <span class="strong"><strong>Tween Width</strong></span> component to prevent it from tweening at start.</li></ol></div></li></ol></div><p>We have <a id="id153" class="indexterm"/>a <span class="strong"><strong>Tween</strong></span> component that will resize the <code class="literal">width</code> of <span class="strong"><strong>Window</strong></span> when activated. Let's use the <span class="strong"><strong>UIPlay Tween</strong></span> component to start it when the <span class="strong"><strong>Options</strong></span> button is clicked on:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Select our <span class="strong"><strong>Options</strong></span> button GameObject.</li><li class="listitem">Attach a <span class="strong"><strong>Play Tween</strong></span> component by navigating to <span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>NGUI</strong></span> | <span class="strong"><strong>Interaction</strong></span>. Then perform the following steps:<div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Drag our <span class="strong"><strong>Window</strong></span> GameObject from <span class="strong"><strong>Container</strong></span> in the <span class="strong"><strong>Tween Target</strong></span> field.</li><li class="listitem">Set the <span class="strong"><strong>Play</strong></span> direction to <span class="strong"><strong>Toggle</strong></span>.</li></ol></div></li></ol></div><p>Click on play. You will see that the window resizes as needed when <span class="strong"><strong>Options</strong></span> is clicked. However, the <span class="strong"><strong>Clipping</strong></span> parameter doesn't. Let's correct this using a Unity animation:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Select our <span class="strong"><strong>Container</strong></span> GameObject from <span class="strong"><strong>MainMenu</strong></span>.</li><li class="listitem">Open the <span class="strong"><strong>Animation</strong></span> window by navigating to <span class="strong"><strong>Window</strong></span> | <span class="strong"><strong>Animation</strong></span>.</li><li class="listitem">Click the red record button.</li><li class="listitem">Save the animation as <code class="literal">ShowOptions.anim</code> and perform the following steps:<div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Re-enter <code class="literal">515</code> for the clipping <span class="strong"><strong>X Size</strong></span> from <span class="strong"><strong>UIPanel</strong></span> to add a key.</li><li class="listitem">Move the time cursor in the <span class="strong"><strong>Animation</strong></span> window to <code class="literal">0:30</code>.</li><li class="listitem">Enter <code class="literal">1300</code> for the clipping <span class="strong"><strong>X Size</strong></span> from <span class="strong"><strong>UIPanel</strong></span> to add a key.</li><li class="listitem">Click on the red record button again to finish.</li></ol></div></li><li class="listitem">Uncheck its <span class="strong"><strong>Play Automatically</strong></span> Boolean in the <span class="strong"><strong>Animation</strong></span> component.</li></ol></div><p>We have our animation ready. Now, let's link the button to the animation in the following manner:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Select our <span class="strong"><strong>Options</strong></span> GameObject from <span class="strong"><strong>Buttons</strong></span>.</li><li class="listitem">Attach a Play Animation component to it by navigating to <span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>NGUI</strong></span> | <span class="strong"><strong>Interaction</strong></span>. Then perform the following steps:<div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Drag our <span class="strong"><strong>Container</strong></span> GameObject from <span class="strong"><strong>MainMenu</strong></span> in the <span class="strong"><strong>Target</strong></span> field.</li><li class="listitem">For the <span class="strong"><strong>Clip Name</strong></span> parameter, type in <code class="literal">ShowOptions</code>.</li><li class="listitem">Set the <span class="strong"><strong>Play</strong></span> direction to <span class="strong"><strong>Toggle</strong></span>.</li></ol></div></li></ol></div><p>Click on play. Our window and clipping both resize perfectly in both directions when the <span class="strong"><strong>Options</strong></span> button is clicked.</p><p>But you can see that our <span class="strong"><strong>Options</strong></span> widgets aren't visible until you actually drag the main menu around;<a id="id154" class="indexterm"/> that's because the clipping is not refreshed after the animation.</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">To solve this, we can simply force a <span class="strong"><strong>Drag at the end of the Animation</strong></span> option.</li><li class="listitem">Select our <span class="strong"><strong>MainMenu</strong></span> GameObject and perform the following steps:<div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Create and add a new <code class="literal">UpdatePanel.cs</code> script to it.</li><li class="listitem">Open our new <code class="literal">UpdatePanel.cs</code> script.</li></ol></div></li><li class="listitem">Now, add this new <code class="literal">UpdateNow()</code> method to the script that will force a drag of (0, 0, 0) value on our <span class="strong"><strong>MainMenu</strong></span>:<div class="informalexample"><pre class="programlisting">public void UpdateNow()
{
  //Force a drag of {0, 0, 0} to update Panel
  GetComponent&lt;UIDraggablePanel&gt;().MoveRelative(Vector3.zero);
}</pre></div></li><li class="listitem">Save the script and then perform the following steps:<div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Select our <span class="strong"><strong>Options</strong></span> GameObject in <span class="strong"><strong>Buttons</strong></span>.</li><li class="listitem">Drag our <span class="strong"><strong>MainMenu</strong></span> GameObject in the <span class="strong"><strong>Notify</strong></span> field of the <span class="strong"><strong>UIPlay Animation</strong></span> component.</li><li class="listitem">Choose our new <code class="literal">UpdatePanel.UpdateNow</code> method for the <span class="strong"><strong>Method</strong></span> field.</li></ol></div></li><li class="listitem">Click on the play button. The <span class="strong"><strong>Options</strong></span> boxes now appear after the animation!</li></ol></div><p>Great! We have used NGUI's <span class="strong"><strong>Tween</strong></span> and <span class="strong"><strong>Play Animations</strong></span> components to enhance our UI and make it nicer and more user friendly.</p></div></div>
<div class="section" title="Scrollable text"><div class="titlepage"><div><div><h1 class="title"><a id="ch03lvl1sec26"/>Scrollable text</h1></div></div></div><p>Let's add a <a id="id155" class="indexterm"/>welcome <a id="id156" class="indexterm"/>textbox with instructions for the user. This text will be scrollable using the mouse wheel or a simple click-and-drag. It will look as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/8667OT_03_07.jpg" alt="Scrollable text"/></div><p>At the start, it will scroll<a id="id157" class="indexterm"/> automatically. Let's create it now:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Select our <span class="strong"><strong>Nickname</strong></span> container GameObject, duplicate it by pressing <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>D</em></span>.</li><li class="listitem">Rename this new duplicate as <code class="literal">Help</code>.</li><li class="listitem">Select this <span class="strong"><strong>Help</strong></span> GameObject and perform the following steps:<div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Drag our <span class="strong"><strong>Title</strong></span> GameObject in the <span class="strong"><strong>Container</strong></span> field in its <span class="strong"><strong>UIAnchor</strong></span>.</li><li class="listitem">Set its <span class="strong"><strong>Side</strong></span> parameter in <span class="strong"><strong>UIAnchor</strong></span> to <span class="strong"><strong>Bottom</strong></span>.</li><li class="listitem">Set its <span class="strong"><strong>Pixel Offset</strong></span> in <span class="strong"><strong>UIAnchor</strong></span> to {<code class="literal">0</code>, <code class="literal">-50</code>}.</li></ol></div></li><li class="listitem">Attach a Panel component by navigating to <span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>NGUI</strong></span> | <span class="strong"><strong>UI</strong></span>:<div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Set its <span class="strong"><strong>Depth</strong></span> to <code class="literal">1</code>.</li><li class="listitem">Set its <span class="strong"><strong>Clipping</strong></span> parameter to <span class="strong"><strong>Alpha Clip</strong></span>.</li><li class="listitem">Set its <span class="strong"><strong>Clipping Size</strong></span> to <code class="literal">440</code> x <code class="literal">85</code>.</li></ol></div></li><li class="listitem">Attach a <span class="strong"><strong>Collider</strong></span> object to it by navigating to <span class="strong"><strong>NGUI</strong></span> | <span class="strong"><strong>Attach</strong></span> and set its <span class="strong"><strong>Size</strong></span> to {<code class="literal">440</code>, <code class="literal">85</code>, <code class="literal">0</code>}.</li><li class="listitem">Delete the <span class="strong"><strong>Input</strong></span> GameObject from <span class="strong"><strong>Help</strong></span>.</li><li class="listitem">Select our <span class="strong"><strong>Label</strong></span> GameObject from <span class="strong"><strong>Help</strong></span> and perform the following steps:<div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Change its <span class="strong"><strong>Font</strong></span> to <span class="strong"><strong>SciFi Font – Normal</strong></span>.</li><li class="listitem">Remove its <span class="strong"><strong>UIAnchor</strong></span> component.</li><li class="listitem">Set its text to:<div class="informalexample"><pre class="programlisting">Welcome!
[HIT RETURN KEY]
[HIT RETURN KEY]
You can Select one of two [AAFFFF]Powers[FFFFFF]:
[AAFFAA]Bomb[FFFFFF]: Explodes all enemies at once
[AAFFAA]Time[FFFFFF]: Reduces Time speed for 10 seconds</pre></div></li></ol></div></li><li class="listitem">Attach a <span class="strong"><strong>Tween Position</strong></span> component to it by navigating to <span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>NGUI</strong></span> | <span class="strong"><strong>Interaction</strong></span>. Then perform the following steps:<div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Set its <span class="strong"><strong>From</strong></span> parameter to {<code class="literal">0</code>, <code class="literal">-50</code>, <code class="literal">0</code>}.</li><li class="listitem">Set its <span class="strong"><strong>To</strong></span> parameter to {<code class="literal">0</code>, <code class="literal">20</code>, <code class="literal">0</code>}.</li><li class="listitem">Set its <span class="strong"><strong>Duration</strong></span> value to <code class="literal">1.5</code>.</li><li class="listitem">Set its <span class="strong"><strong>Start Delay</strong></span> value to <code class="literal">3</code>.</li></ol></div></li><li class="listitem">Set its <span class="strong"><strong>Transform</strong></span> position to {<code class="literal">0</code>, <code class="literal">-50</code>, <code class="literal">0</code>}.</li><li class="listitem">Select the <span class="strong"><strong>Background</strong></span> GameObject from <span class="strong"><strong>Help</strong></span> and perform the following steps:<div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Set its <span class="strong"><strong>Dimensions</strong></span> to <code class="literal">440</code> x <code class="literal">85</code>.</li><li class="listitem">Set its <span class="strong"><strong>Color Tint</strong></span> to {<code class="literal">150</code>, <code class="literal">255</code>, <code class="literal">255</code>, <code class="literal">255</code>}.</li></ol></div></li></ol></div><p>Click on the<a id="id158" class="indexterm"/> play button. We now have a welcome text that scrolls automatically by changing its Y coordinate inside a clipped Panel. Let's enable the scroll wheel and mouse drag on this scrollable text:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Select our <span class="strong"><strong>Help</strong></span> GameObject.</li><li class="listitem">Attach a <span class="strong"><strong>Drag Object</strong></span> component to it by navigating to <span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>NGUI</strong></span> | <span class="strong"><strong>Interaction</strong></span>. Then perform the following steps:<div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Drag our <span class="strong"><strong>Label</strong></span> GameObject from <span class="strong"><strong>Help</strong></span> to the <span class="strong"><strong>Target</strong></span> field.</li><li class="listitem">Set the <span class="strong"><strong>Scale</strong></span> to {<code class="literal">0</code>, <code class="literal">1</code>, <code class="literal">0</code>} to limit to vertical scrolling.</li><li class="listitem">Set the <span class="strong"><strong>Scroll Wheel Factor</strong></span> value to <code class="literal">1</code>.</li><li class="listitem">Check the <span class="strong"><strong>Restrict Within Panel</strong></span> Boolean.</li></ol></div></li></ol></div><p>Click on play. You can now drag the text label manually with either a left-click and drag or the mouse wheel. The <span class="strong"><strong>Box Collider</strong></span> component on the <span class="strong"><strong>Help</strong></span> GameObject detects mouse events, and the <span class="strong"><strong>UIDrag Object</strong></span> reacts accordingly by changing the Y position of our <span class="strong"><strong>Label</strong></span>.</p><p>We had to add a <span class="strong"><strong>UIPanel</strong></span> component to the <span class="strong"><strong>Help</strong></span> GameObject in order to restrict movement within the clipping's bounds.</p></div>
<div class="section" title="Localization system"><div class="titlepage"><div><div><h1 class="title"><a id="ch03lvl1sec27"/>Localization system</h1></div></div></div><p>Now<a id="id159" class="indexterm"/> that we have a complete UI, let's configure the <span class="strong"><strong>localization</strong></span> <span class="strong"><strong>system</strong></span> and<a id="id160" class="indexterm"/> add a pop-up list to change our UI's language.</p><div class="section" title="Localization files"><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec44"/>Localization files</h2></div></div></div><p>All our localized text strings must be contained in a <code class="literal">.txt</code> file for each language. For the purpose of this book, we will have English and French, and we will need the <code class="literal">English.txt</code> file and the <code class="literal">French.txt</code> file.</p><p>Let's create<a id="id161" class="indexterm"/> them right now in the following manner:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Access your project's Assets folder with your file explorer and create a new folder named <code class="literal">Localization</code>.</li><li class="listitem">Inside this new folder, create a new text document named <code class="literal">English.txt</code>.</li><li class="listitem">Duplicate this new <code class="literal">English.txt</code> file and rename it as <code class="literal">French.txt</code>.</li><li class="listitem">Open them both in your favorite IDE or text editor.</li></ol></div><p>Ok, now our localization files are ready to be used with the localization system.</p></div><div class="section" title="Localization component"><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec45"/>Localization component</h2></div></div></div><p>We can <a id="id162" class="indexterm"/>now configure the localization system to work with our UI. We need to have the localization component attached to a GameObject in the scene:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Select our <span class="strong"><strong>GameManager</strong></span> GameObject and attach a <span class="strong"><strong>Localization</strong></span> component to it by navigating to <span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>NGUI</strong></span> | <span class="strong"><strong>Internal</strong></span>.</li><li class="listitem">In the <span class="strong"><strong>Project</strong></span> view, navigate to Assets | Localization and drag our <code class="literal">English.txt</code> and <code class="literal">French.txt</code> files in the languages array.</li></ol></div><p>The <span class="strong"><strong>Starting Language</strong></span> is set to <span class="strong"><strong>English</strong></span>, and we also have <span class="strong"><strong>French</strong></span> available in the array.</p></div><div class="section" title="Language selection box"><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec46"/>Language selection box</h2></div></div></div><p>The next step<a id="id163" class="indexterm"/> is to create a <span class="strong"><strong>language selection box</strong></span> as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/8667OT_03_08.jpg" alt="Language selection box"/></div><p>If we want to see what we're doing, we should first disable the Clipping of our <span class="strong"><strong>Container</strong></span> by setting the <span class="strong"><strong>Clipping</strong></span>
<code class="literal"> </code>parameter in its <span class="strong"><strong>UIPanel</strong></span> to <span class="strong"><strong>None</strong></span>.</p><p>Once the Clipping is disabled, follow these steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Select the <span class="strong"><strong>Popup</strong></span> GameObject from <span class="strong"><strong>Difficulty</strong></span>:<div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Check its <span class="strong"><strong>Localized</strong></span> Boolean in <span class="strong"><strong>UIPopup List</strong></span>.</li><li class="listitem">Rename its child <span class="strong"><strong>Label</strong></span> GameObject as <code class="literal">CurrentDifficulty</code>.</li></ol></div></li><li class="listitem">Select and duplicate our <span class="strong"><strong>Difficulty</strong></span> GameObject in <span class="strong"><strong>Container</strong></span>.</li><li class="listitem">Rename the new duplicate as <code class="literal">Language</code>.</li><li class="listitem">Select our new <span class="strong"><strong>Background</strong></span> GameObject in <span class="strong"><strong>Language</strong></span> and set its <span class="strong"><strong>Pixel Offset</strong></span> in <span class="strong"><strong>UIAnchor</strong></span> to {<code class="literal">420</code>, -<code class="literal">90</code>}.<div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note11"/>Note</h3><p>Sometimes, anchors don't update themselves. You may need to deactivate and then activate the <span class="strong"><strong>Language</strong></span> GameObject for the Label's <span class="strong"><strong>UIAnchor</strong></span> to update.</p></div></div></li><li class="listitem">Select <a id="id164" class="indexterm"/>our <span class="strong"><strong>Label</strong></span> GameObject from <span class="strong"><strong>Language</strong></span> and change its text to <code class="literal">[AAFFFF]Language</code>.</li><li class="listitem">Select our <span class="strong"><strong>Popup</strong></span> GameObject from <code class="literal">Language</code> and perform the following steps:<div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Change the <span class="strong"><strong>Options</strong></span> text value to have the following two options:<div class="informalexample"><pre class="programlisting">English
French</pre></div></li><li class="listitem">Set its <span class="strong"><strong>Position</strong></span> to <span class="strong"><strong>Below</strong></span>.</li><li class="listitem">Check the <span class="strong"><strong>Localized</strong></span> Boolean.</li></ol></div></li><li class="listitem">Attach a <span class="strong"><strong>Language Selection</strong></span> component by navigating to <span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>NGUI</strong></span> | <span class="strong"><strong>Interaction</strong></span>.</li><li class="listitem">Rename the <span class="strong"><strong>Label</strong></span>, which is a child of <span class="strong"><strong>Popup</strong></span>, as <code class="literal">CurrentLanguage</code>.</li></ol></div><p>We can now reactivate <span class="strong"><strong>Clipping</strong></span> in <span class="strong"><strong>Container</strong></span> by setting the <span class="strong"><strong>Clipping</strong></span> parameter in its <span class="strong"><strong>UIPanel</strong></span> to <span class="strong"><strong>Alpha Clip</strong></span>. The clipping <span class="strong"><strong>Size</strong></span> has been saved.</p><p>That's it, our localization system is in place, and when the pop-up list changes value, the <code class="literal">Language Selection.cs</code> script automatically changes the localization's <span class="strong"><strong>Current Language</strong></span> value.</p></div><div class="section" title="Localizing a Label"><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec47"/>Localizing a Label</h2></div></div></div><p>We are now<a id="id165" class="indexterm"/> ready to localize our first Label using the <span class="strong"><strong>UILocalize</strong></span> component and a <code class="literal">Key</code> that will define which string to use from our <code class="literal">.txt</code> files. Perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Select our <span class="strong"><strong>Label</strong></span> GameObject from <span class="strong"><strong>Title</strong></span>.</li><li class="listitem">Attach a <span class="strong"><strong>Localize</strong></span> component to it by navigating to <span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>NGUI</strong></span> | <span class="strong"><strong>UI</strong></span>.</li><li class="listitem">Set its <code class="literal">Key</code> parameter by typing <code class="literal">MainMenu</code>.</li><li class="listitem">Switch to our <code class="literal">English.txt</code> localization file and add the following line:<div class="informalexample"><pre class="programlisting">MainMenu = [AAFFFF]Main Menu</pre></div></li><li class="listitem">Switch to our <code class="literal">French.txt</code> localization file and add the following line:<div class="informalexample"><pre class="programlisting">MainMenu = [AAFFFF]Menu Principal</pre></div></li></ol></div><p>Save both the <code class="literal">.txt</code> files and click on the play button. If you access options and change the language to <span class="strong"><strong>French</strong></span>, our window's title changes from <span class="strong"><strong>Main Menu</strong></span> to <span class="strong"><strong>Menu Principal</strong></span>. <a id="id166" class="indexterm"/>That's because the <span class="strong"><strong>UILocalize</strong></span> component updates the <span class="strong"><strong>UILabel</strong></span> component it's attached to using the string present after the <code class="literal">=</code> in our <code class="literal">.txt</code> localization file. If you exit the play mode, the language will be saved and the UI will be initialized with the last selected language.</p><p>Now, we must add a <span class="strong"><strong>UILocalize</strong></span> component with its specific <code class="literal">Key</code> to every <span class="strong"><strong>Label</strong></span> in the scene, then add a localization string for each of them in both of our <code class="literal">.txt</code> files.</p><p>Don't be afraid; it isn't that long, and it will train you to use the Localization System:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">In the <span class="strong"><strong>Hierarchy</strong></span> view, type <code class="literal">Label</code> inside the search box.</li><li class="listitem">Select all the <span class="strong"><strong>Label</strong></span> GameObjects matching the search by pressing <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>A</em></span> and attach a <span class="strong"><strong>Localize</strong></span> component to the selection by navigating to <span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>NGUI</strong></span> | <span class="strong"><strong>UI</strong></span>.</li><li class="listitem">Select our <span class="strong"><strong>Label</strong></span> GameObject from <span class="strong"><strong>Title</strong></span> and remove its second <span class="strong"><strong>UILocalize</strong></span> component as it already had one!</li></ol></div><p>Now, all of our <span class="strong"><strong>Label</strong></span> GameObjects have a <span class="strong"><strong>UILocalize</strong></span> component attached to them. One by one, select them and set their <code class="literal">Key</code> parameter based on their text set in the <span class="strong"><strong>UILabel</strong></span> component.</p><p>You must ignore the Labels of <span class="strong"><strong>Popup List</strong></span>; they don't need a <span class="strong"><strong>UILocalize</strong></span> component since we checked their <span class="strong"><strong>Localized</strong></span> Booleans. Simply add localization strings for their <span class="strong"><strong>Options</strong></span> with the same names: <span class="strong"><strong>Normal</strong></span>, <span class="strong"><strong>Hard</strong></span>, <span class="strong"><strong>English</strong></span>, and <span class="strong"><strong>French</strong></span>.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note12"/>Note</h3><p>Don't forget to apply the same operations to labels included in our four different powers prefabs: <span class="strong"><strong>Time</strong></span>, <span class="strong"><strong>Bomb</strong></span>, <span class="strong"><strong>SelectedTime</strong></span>, and <span class="strong"><strong>SelectedBomb</strong></span>. New lines (return) are replaced by <code class="literal">\n</code> in the localization files. Colors work identically.</p></div></div><p>When you're done with setting their <code class="literal">Key</code> parameters, switch to our <code class="literal">English.txt</code> file and add every key you need, plus <code class="literal">=</code> followed by the corresponding localized text.</p><p>Now, copy all of these keys declarations and paste them in our <code class="literal">French.txt</code> file and then replace the English words with French words or any other language you choose.</p><p>By the time you're finished, our entire UI will be localized!</p></div></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch03lvl1sec28"/>Summary</h1></div></div></div><p>In this chapter, we first learned how to set up a draggable panel. Then, we created and configured a drag-and-drop system to select which power we want using the <span class="strong"><strong>UIDrag Object</strong></span> component and the custom code.</p><p>Remember to use the <span class="strong"><strong>UIGrid</strong></span> component often to automatically align objects—they are very powerful when used wisely with <span class="strong"><strong>UIAnchor</strong></span> and <span class="strong"><strong>UIStretch</strong></span> components.</p><p>Using Unity's animations and NGUI's Tweens are no longer a secret for us—we used them to create a smooth apparition for these powers, and we combined them with Clipping to hide/show our Options menu.</p><p>Finally, we created scrollable text and learned how to use the Localization System to set up multiple languages.</p><p>We can now take a look at using C# with NGUI in the next chapter and see what we can accomplish using code.</p></div></body></html>