# 前言

在软件设计模式和框架是稳健应用开发核心的时代，掌握 **模型-视图-视图模型**（**MVVM**）模式对于步入 .NET MAUI 领域的开发者来说变得至关重要。“.NET MAUI 中的 MVVM 模式”：一本关于基本模式、最佳实践和技术的 definitive guide，已经精心制作，旨在为渴望踏上这一旅程的开发者提供指南。

本书与众不同的地方在于其对 .NET MAUI 的专注。我们不仅泛泛而谈 MVVM，而是深入探讨其在特定框架中的实际应用。即使你是 MVVM 或 .NET MAUI 的初学者，这本指南也旨在使其既易于接近又富有成效。

我们的旅程从深入探索 MVVM 设计模式和 .NET MAUI 框架的核心组件开始。随着我们的进展，我们将导航数据绑定的复杂性，利用社区工具包的力量，以及有效地管理集合。我们将进一步深入理解依赖注入、服务模式和消息传递，你将学习关于不同导航方法的知识，理解用户输入和验证，并掌握处理远程数据的技术。后几章将指导你创建适合 MVVM 的控件，本地化你的应用程序，以及单元测试的关键方面。

从这些基础知识到高级技术，到本旅程结束时，你将完全具备将 MVVM 有效地集成到你的 .NET MAUI 项目中的知识。

欢迎来到你的 definitive guide！

# 本书面向的对象

本书面向的是那些希望在 .NET MAUI 的背景下利用 MVVM 模式力量的开发者。无论你是刚开始接触 .NET MAUI 的爱好者，还是希望提升自己在 .NET MAUI 和 MVVM 方面的专业水平的资深专业人士，这本指南都能满足你的需求。

虽然不需要有 .NET MAUI 或 Xamarin.Forms 的先前经验，但具备 C# 的基础知识是必不可少的。熟悉 C# 的开发者会发现内容易于接近且结构化，可以无缝地将技能提升到 .NET MAUI 和 MVVM 的美妙世界。

从移动应用程序开发领域的初学者到寻求在 .NET MAUI 的 MVVM 实现方面获得专业知识的老兵，本书为所有人提供了一本全面的指南。

# 本书涵盖的内容

*第一章*，*MVVM 设计模式*，概述了 MVVM 模式的核心组件，展示了它们的作用和相互作用。它说明了将 UI 与逻辑分离以提高可测试性和维护性的价值。它解决了常见的 MVVM 错误观念，并提供了对 MVVM 的基础理解，无论具体技术如何。

*第二章*，*什么是.NET MAUI？*，概述了.NET MAUI 的整体格局、其关键特性和优势以及其架构。它提供了关于.NET MAUI 从 Xamarin 和 Xamarin Forms 起源以及其演变历程的见解。

*第三章*，*.NET MAUI 中的数据绑定构建块*，展示了.NET MAUI 中的数据绑定（MVVM 的基石）是.NET MAUI 的一个基本组成部分。本章解构了支撑这一基本功能的关键原则、元素和技术。

*第四章*，*.NET MAUI 中的数据绑定*，在上一章的基础上进一步深入其复杂性和细微差别，全面探索.NET MAUI 中数据绑定的所有方面。

*第五章*，*社区工具包*，聚焦于两个有影响力的社区工具包：MVVM 工具包和.NET MAUI 社区工具包。它展示了这些社区驱动的倡议如何增强.NET MAUI 应用程序中 MVVM 的有效性。

*第六章*，*与集合一起工作*，概述了如何使用.NET MAUI 中的 MVVM 有效地显示数据集。从绑定数据和适应其变化到制作数据模板，本章提供了以 MVVM 为中心的指南，用于展示数据和促进用户与之交互。

*第七章*，*依赖注入、服务和消息传递*，阐明了通过服务注册和依赖注入将 ViewModel 与视图对齐的方法。它突出了将服务注入 ViewModel 的细微差别，以及通过消息传递促进 ViewModel 之间无缝通信，同时保持关注点分离并提高可测试性。

*第八章*，*.NET MAUI 中的导航*，全部关于基于 MVVM 的导航。本章概述了.NET MAUI Shell 是什么以及其对导航的影响。它展示了如何构建一个针对利用 Shell 的.NET MAUI 应用程序以及不使用 Shell 的应用程序量身定制的导航服务。

*第九章*，*处理用户输入和验证*，展示了如何有效地处理用户输入，从在 ViewModel 级别验证数据，到标准自定义验证规则，再到在存在未保存更改的情况下提示用户确认或取消。

*第十章*，*与远程数据一起工作*，展示了如何处理远程数据，介绍了用于保持关注点分离的存储库，并利用依赖注入。它说明了如何使用 Refit 进行简化的 API 交互，以及如何处理异步任务及其 UI 影响。

*第十一章*，*创建 MVVM 友好的控件*，深入探讨了创建针对 MVVM 定制的控件，这些控件支持通过命令进行数据绑定和交互。

*第十二章*，*使用 MVVM 进行本地化*，概述了在应用程序中本地化硬编码标签的技术，以及如何有效地从 API 获取特定语言的数据。

*第十三章*，*单元测试*，展示了单元测试有多容易且多么重要。它指导您设置单元测试项目、生成数据、模拟依赖关系以及测试 MAUI 代码。

*第十四章*，*故障排除和调试技巧*，突出了常见的故障及其解决方案。它展示了与数据绑定、依赖注入以及构建自定义控件和转换器相关的问题和陷阱。

# 要充分利用本书

您需要熟悉 C#的基础知识。

在本书的早期，我们将说明如何使用 Visual Studio 2022 或 Visual Studio Code 设置您的开发环境。本书中描述的步骤基于 Visual Studio，但所有解释和展示的内容也可以在任何支持.NET MAUI 的 IDE 中完成。

**如果您使用的是本书的电子版，我们建议您亲自输入代码或从本书的 GitHub 仓库（下一节中提供链接）获取代码。这样做将帮助您避免与代码复制和粘贴相关的任何潜在错误。**

# 下载示例代码文件

您可以从 GitHub 下载本书的示例代码文件，网址为[`github.com/PacktPublishing/MVVM-pattern-.NET-MAUI`](https://github.com/PacktPublishing/MVVM-pattern-.NET-MAUI)。如果代码有更新，它将在 GitHub 仓库中更新。

我们还有其他来自我们丰富的书籍和视频目录的代码包，可在[`github.com/PacktPublishing/`](https://github.com/PacktPublishing/)找到。查看它们吧！

# 使用的约定

本书使用了多种文本约定。

`文本中的代码`：表示文本中的代码单词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 昵称。以下是一个示例：“`RecipeDetailViewModel`代表菜谱的详细信息。目前，它只包含一个`Title`属性，我们现在给它一个硬编码的值`"Classic Caesar Salad"`。”

代码块设置如下：

```cs
<Grid ColumnDefinitions="*, Auto">
    <Label
        FontAttributes="Bold" FontSize="22"
        Text="{Binding Path=Title, Mode=OneTime}"
        VerticalOptions="Center" />
    <Image
        x:Name="favoriteIcon"
        Grid.Column="1" Margin="5"
        HeightRequest="35" Source="favorite.png"
        VerticalOptions="Center" WidthRequest="35">
    </Image>
</Grid>
```

当我们希望您注意代码块中的特定部分时，相关的行或项目将以粗体显示：

```cs
private bool _hideAllergenInformation = true;
public bool HideAllergenInformation
{
    get => _hideAllergenInformation;
    set => SetProperty(ref _hideAllergenInformation, value);
}
```

`Messages`。“

小贴士或重要注意事项

看起来像这样。

# 联系我们

欢迎读者反馈。

**一般反馈**：如果您对本书的任何方面有疑问，请通过电子邮件 customercare@packtpub.com 联系我们，并在邮件主题中提及书名。

**勘误**：尽管我们已经尽一切努力确保内容的准确性，但错误仍然可能发生。如果您在本书中发现错误，我们将不胜感激，如果您能向我们报告，请访问[www.packtpub.com/support/errata](http://www.packtpub.com/support/errata)并填写表格。

**盗版**：如果您在互联网上以任何形式发现我们作品的非法副本，如果您能提供位置地址或网站名称，我们将不胜感激。请通过版权@packtpub.com 与我们联系，并提供材料的链接。

**如果您有兴趣成为作者**：如果您在某个领域有专业知识，并且您有兴趣撰写或为本书做出贡献，请访问[authors.packtpub.com](http://authors.packtpub.com)。

# 分享您的想法

一旦您阅读了*《.NET MAUI 中的 MVVM 模式》*，我们很乐意听听您的想法！请[点击此处直接进入此书的亚马逊评论页面](https://packt.link/r/1805125001)并分享您的反馈。

您的评论对我们和科技社区非常重要，并将帮助我们确保我们提供高质量的内容。

# 下载本书的免费 PDF 副本

感谢您购买本书！

您喜欢在路上阅读，但无法携带您的印刷书籍到处走？

您选择的设备是否与您的电子书购买不兼容？

不要担心，现在，随着每本 Packt 书籍，您都可以免费获得该书的 DRM 免费 PDF 版本。

在任何地方、任何地方、任何设备上阅读。从您最喜欢的技术书籍中直接搜索、复制和粘贴代码到您的应用程序中。

优惠远不止于此，您还可以获得独家折扣、时事通讯和每日免费内容的每日电子邮件。

按照以下简单步骤获取这些好处：

1.  扫描二维码或访问以下链接

![](img/B20941_QR_Free_PDF.jpg)

[`packt.link/free-ebook/9781805125006`](https://packt.link/free-ebook/9781805125006)

1.  提交您的购买证明

1.  就这样！我们将直接将您的免费 PDF 和其他好处发送到您的电子邮件。

# 第一部分：关键概念和组件

在本部分中，我们首先讨论 Model-View-ViewModel 设计模式，而不将其与特定平台绑定。接下来，我们将介绍.NET MAUI 框架，并强调为什么它与 MVVM 配合得如此之好。随着我们继续前进，您将了解社区工具包的好处，并亲身体验集合。这个基础为您在以后学习更高级的主题奠定了基础。

本部分包含以下章节：

+   *第一章*，*MVVM 设计模式*

+   *第二章*，*.NET MAUI 框架*

+   *第三章*，*在.NET MAUI 中的数据绑定构建块*

+   *第四章*，*在.NET MAUI 中的数据绑定*

+   *第五章*，*社区工具包*

+   *第六章*, *与集合一起工作*
