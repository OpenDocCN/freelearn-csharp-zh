<html><head></head><body><div><div><div><h1 class="chapterNumber">5</h1>
    <h1 id="_idParaDest-298" class="chapterTitle">Building Your Own Types with Object-Oriented Programming</h1>
    <p class="normal">This chapter is about making your own types using <strong class="keyWord">object-oriented programming</strong> (<strong class="keyWord">OOP</strong>). You will learn about all the different categories of members that a <em class="italic">type</em> can have, including fields to store data and methods to perform actions. You will use OOP concepts such as aggregation and encapsulation. You will also learn about language features such as tuple syntax support, <code class="inlineCode">out</code> variables, inferred tuple names, and default literals. Finally, you will learn about pattern matching and defining records to make the equality of variables and immutability easier to implement.</p>
    <p class="normal">This chapter will cover the following topics:</p>
    <ul>
      <li class="bulletList">Talking about OOP</li>
      <li class="bulletList">Building class libraries</li>
      <li class="bulletList">Storing data in fields</li>
      <li class="bulletList">Working with methods and tuples</li>
      <li class="bulletList">Controlling access with properties and indexers</li>
      <li class="bulletList">Pattern matching with objects</li>
      <li class="bulletList">Working with record types</li>
    </ul>
    <h1 id="_idParaDest-299" class="heading-1">Talking about OOP</h1>
    <p class="normal">An object in<a id="_idIndexMarker634"/> the real world is a thing, such as a car or a person, whereas an object in programming often represents something in the real world, such as a product or bank account, but it can also be something more abstract.</p>
    <p class="normal">In C#, we use the C# keywords <code class="inlineCode">class</code>, <code class="inlineCode">record</code>, and <code class="inlineCode">struct</code> to define a type of object. You will learn about <code class="inlineCode">struct</code> types in <em class="chapterRef">Chapter 6</em>, <em class="italic">Implementing Interfaces and Inheriting Classes</em>. You can think of a type as being a blueprint or template for an object.</p>
    <p class="normal">The concepts of OOP are briefly described here:</p>
    <ul>
      <li class="bulletList"><strong class="keyWord">Encapsulation</strong> is the <a id="_idIndexMarker635"/>combination of the data and actions that are related to<a id="_idIndexMarker636"/> an object. For example, a <code class="inlineCode">BankAccount</code> type might have data, such as <code class="inlineCode">Balance</code> and <code class="inlineCode">AccountName</code>, as well as actions, such as <code class="inlineCode">Deposit</code> and <code class="inlineCode">Withdraw</code>. When encapsulating, you often want to control what can access those actions and the data, for example, restricting how the internal state of an object can be accessed or modified from the outside.</li>
      <li class="bulletList"><strong class="keyWord">Composition</strong> is <a id="_idIndexMarker637"/>about <a id="_idIndexMarker638"/>what an object is made of. For example, a <code class="inlineCode">Car</code> is composed of different parts, such as four <code class="inlineCode">Wheel</code> objects, several <code class="inlineCode">Seat</code> objects, and an <code class="inlineCode">Engine</code>.</li>
      <li class="bulletList"><strong class="keyWord">Aggregation</strong> is <a id="_idIndexMarker639"/>about<a id="_idIndexMarker640"/> what can be combined with an object. For example, a <code class="inlineCode">Person</code> is not part of a <code class="inlineCode">Car</code> object, but they could sit in the driver’s <code class="inlineCode">Seat</code> and then become the car’s <code class="inlineCode">Driver</code>—two separate objects that are aggregated together to form a new component.</li>
      <li class="bulletList"><strong class="keyWord">Inheritance</strong> is <a id="_idIndexMarker641"/>about reusing<a id="_idIndexMarker642"/> code by having a <strong class="keyWord">subclass</strong> derive from a <strong class="keyWord">base</strong> or <strong class="keyWord">superclass</strong>. All functionality in the base class is inherited by, and <a id="_idIndexMarker643"/>becomes available in, the <strong class="keyWord">derived</strong> class. For example, the base or super <code class="inlineCode">Exception</code> class has some members that have the same implementation <a id="_idIndexMarker644"/>across all exceptions, and the sub or derived <code class="inlineCode">SqlException</code> class inherits those members and has extra members that are only relevant when a SQL database exception occurs, like a property for the database connection.</li>
      <li class="bulletList"><strong class="keyWord">Abstraction</strong> is <a id="_idIndexMarker645"/>about <a id="_idIndexMarker646"/>capturing the core idea of an object and ignoring the details or specifics. C# has the <code class="inlineCode">abstract</code> keyword that formalizes this concept but do not confuse the concept of abstraction with the use of the <code class="inlineCode">abstract</code> keyword because it is more than that. The concept of abstraction can also be achieved using interfaces. If a class is not explicitly <strong class="keyWord">abstract</strong>, then it can be described as being <strong class="keyWord">concrete</strong>. Bases or superclasses are often abstract; for example, the superclass <code class="inlineCode">Stream</code> is abstract, and its subclasses, like <code class="inlineCode">FileStream</code> and <code class="inlineCode">MemoryStream</code>, are concrete. Only concrete classes can be used to create objects; abstract classes can only be used as the base for other classes because they are missing some implementation. Abstraction is a tricky balance. If you make a class more abstract, more classes will be able to inherit from it, but at the same time, there will be less functionality to share. A real-world example of abstraction is the approach car manufacturers have taken to <strong class="keyWord">electric vehicles</strong> (<strong class="keyWord">EVs</strong>). They create a common “platform” (basically just the battery and wheels) that is an abstraction of what all EVs need, and then add on top of that to build different vehicles like cars, trucks, vans, and so on. The platform on its own is not a complete product, like an abstract class.</li>
      <li class="bulletList"><strong class="keyWord">Polymorphism</strong> is <a id="_idIndexMarker647"/>about <a id="_idIndexMarker648"/>allowing a derived class to override an inherited action to provide custom behavior.<div><p class="normal">There is a lot to cover in the next two chapters about OOP, and some parts of it are difficult to learn. At the end of <em class="chapterRef">Chapter 6</em>, <em class="italic">Implementing Interfaces and Inheriting Classes</em>, I have written a summary of the categories of custom types and their capabilities with example code. This will help you review the most important facts and highlight the differences between choices, like an <code class="inlineCode">abstract</code> class or an <code class="inlineCode">interface</code>, and when to use them.</p>
        </div>
      </li>
    </ul>
    <h1 id="_idParaDest-300" class="heading-1">Building class libraries</h1>
    <p class="normal"><strong class="keyWord">Class library</strong> assemblies <a id="_idIndexMarker649"/>group types together into easily deployable units (DLL files). Apart from when you learned about unit testing, you have only created console apps to contain your code. To make the code that you write reusable across multiple projects, you should put it in class library assemblies, just like Microsoft does.</p>
    <h2 id="_idParaDest-301" class="heading-2">Creating a class library</h2>
    <p class="normal">The first task is <a id="_idIndexMarker650"/>to create a reusable .NET class library:</p>
    <ol>
      <li class="numberedList" value="1">Use your preferred code editor to create a new project, as defined in the following list:<ul>
          <li class="bulletList level-2">Project template: <strong class="screenText">Class Library</strong> / <code class="inlineCode">classlib</code></li>
          <li class="bulletList level-2">Project file and folder: <code class="inlineCode">PacktLibraryNet2</code></li>
          <li class="bulletList level-2">Solution file and folder: <code class="inlineCode">Chapter05</code></li>
        </ul>
      </li>
      <li class="numberedList">Open the <code class="inlineCode">PacktLibraryNet2.csproj</code> file, and note that, by default, class libraries created by the .NET 9 SDK target .NET 9 and, therefore, can only be referenced by other .NET 9-compatible assemblies, as highlighted in the following markup:
        <pre class="programlisting code-one"><code class="hljs-code">&lt;Project Sdk="Microsoft.NET.Sdk"&gt;
  &lt;PropertyGroup&gt;
    <strong class="hljs-slc">&lt;TargetFramework&gt;net9</strong><strong class="hljs-number-slc">.0</strong><strong class="hljs-slc">&lt;/TargetFramework&gt;</strong>
    &lt;ImplicitUsings&gt;enable&lt;/ImplicitUsings&gt;
    &lt;Nullable&gt;enable&lt;/Nullable&gt;
  &lt;/PropertyGroup&gt;
&lt;/Project&gt;
</code></pre>
      </li>
      <li class="numberedList">Modify <a id="_idIndexMarker651"/>the framework to target .NET Standard 2.0, add an entry to explicitly use the C# 13 compiler, and statically import the <code class="inlineCode">System.Console</code> class for all C# files, as highlighted in the following markup:
        <pre class="programlisting code-one"><code class="hljs-code">&lt;Project Sdk="Microsoft.NET.Sdk"&gt;
  &lt;PropertyGroup&gt;
<strong class="hljs-slc">    &lt;!--.NET Standard </strong><strong class="hljs-number-slc">2.0</strong><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc">class</strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc">library</strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc">can</strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc">be</strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc">used</strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc">by</strong><strong class="hljs-slc">:</strong>
<strong class="hljs-slc">        .</strong><strong class="hljs-title-slc">NET</strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc">Framework</strong><strong class="hljs-slc">, </strong><strong class="hljs-title-slc">Xamarin</strong><strong class="hljs-slc">, </strong><strong class="hljs-title-slc">modern</strong><strong class="hljs-slc"> .</strong><strong class="hljs-title-slc">NET</strong><strong class="hljs-slc">. --&gt;</strong>
<strong class="hljs-slc">    &lt;</strong><strong class="hljs-title-slc">TargetFramework</strong><strong class="hljs-slc">&gt;</strong><strong class="hljs-title-slc">netstandard2.0</strong><strong class="hljs-slc">&lt;/</strong><strong class="hljs-title-slc">TargetFramework</strong><strong class="hljs-slc">&gt;</strong>
<strong class="hljs-slc">    &lt;!--</strong><strong class="hljs-title-slc">Compile</strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc">this</strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc">library</strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc">using</strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc">C</strong><strong class="hljs-slc"># 13 </strong><strong class="hljs-title-slc">so</strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc">we</strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc">can</strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc">use</strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc">most</strong>
<strong class="hljs-slc">        </strong><strong class="hljs-title-slc">modern</strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc">compiler</strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc">features</strong><strong class="hljs-slc">. --&gt;</strong>
<strong class="hljs-slc">    &lt;</strong><strong class="hljs-title-slc">LangVersion</strong><strong class="hljs-slc">&gt;13&lt;/</strong><strong class="hljs-title-slc">LangVersion</strong><strong class="hljs-slc">&gt;</strong>
    &lt;Nullable&gt;enable&lt;/Nullable&gt;
    &lt;ImplicitUsings&gt;enable&lt;/ImplicitUsings&gt;
  &lt;/PropertyGroup&gt;
<strong class="hljs-slc">  &lt;</strong><strong class="hljs-title-slc">ItemGroup</strong><strong class="hljs-slc">&gt;</strong>
<strong class="hljs-slc">    &lt;</strong><strong class="hljs-title-slc">Using</strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc">Include</strong><strong class="hljs-slc">="</strong><strong class="hljs-title-slc">System.Console</strong><strong class="hljs-slc">" </strong><strong class="hljs-title-slc">Static</strong><strong class="hljs-slc">="</strong><strong class="hljs-title-slc">true</strong><strong class="hljs-slc">" /&gt;</strong>
<strong class="hljs-slc">  &lt;/</strong><strong class="hljs-title-slc">ItemGroup</strong><strong class="hljs-slc">&gt;</strong>
&lt;/Project&gt;
</code></pre>
      </li>
    </ol>
    <div><p class="normal">Although we can use the C# 13 compiler, some modern compiler features require a modern .NET runtime. For example, we cannot use default implementations in an interface (introduced in C# 8) because it requires .NET Standard 2.1. We cannot use the <code class="inlineCode">required</code> keyword (introduced in C# 11) because it requires an attribute introduced in .NET 7. But many useful modern compiler features, like raw literal strings, will be available to us.</p>
    </div>
    <ol>
      <li class="numberedList" value="4">Save <a id="_idIndexMarker652"/>and close the file.</li>
      <li class="numberedList">Delete the file named <code class="inlineCode">Class1.cs</code>.</li>
      <li class="numberedList">Compile the project so that other projects can reference it later:<ul>
          <li class="bulletList level-2">In Visual Studio, navigate to <strong class="screenText">Build</strong> | <strong class="screenText">Build PacktLibraryNet2</strong>.</li>
          <li class="bulletList level-2">In VS Code, enter the following command: <code class="inlineCode">dotnet build</code>.</li>
        </ul>
      </li>
    </ol>
    <div><p class="normal"><strong class="keyWord">Good practice</strong>: To use all the latest C# language and .NET platform features, put types in a .NET 9 class library. To support legacy .NET platforms, like .NET Core, .NET Framework, and Xamarin, put types that you might reuse in a .NET Standard 2.0 class library. By default, targeting .NET Standard 2.0 uses the C# 7 compiler, but this can be overridden so you get the benefits of the newer SDK and compiler even though you are limited to .NET Standard 2.0 APIs.</p>
    </div>
    <h2 id="_idParaDest-302" class="heading-2">Understanding file-scoped namespaces</h2>
    <p class="normal">Traditionally, you<a id="_idIndexMarker653"/> define types like a class nested in a namespace, as shown in the following code:</p>
    <pre class="programlisting code"><code class="hljs-code">namespace Packt.Shared
{
  public class Person
  {
  }
}
</code></pre>
    <p class="normal">If you define multiple types in the same code file, then they can be in different namespaces, since the types must be explicitly inside the curly braces for each namespace.</p>
    <p class="normal">If you <a id="_idIndexMarker654"/>use C# 10 or later, you can simplify your code by ending a namespace declaration with a semicolon and removing the curly braces, so the type definitions do not need to be indented, as shown in the following code:</p>
    <pre class="programlisting code"><code class="hljs-code">// All types in this file will be defined in this file-scoped namespace.
namespace Packt.Shared;
public class Person
{
}
</code></pre>
    <p class="normal">This is known<a id="_idIndexMarker655"/> as a <strong class="keyWord">file-scoped namespace</strong> declaration. You can only have one file-scoped namespace per file. This feature is especially useful for book writers who have limited horizontal space.</p>
    <div><p class="normal"><strong class="keyWord">Good practice</strong>: Put each type that you create in its own code file, or at least put types in the same namespace in the same code file so that you can use file-scoped namespace declarations.</p>
    </div>
    <h2 id="_idParaDest-303" class="heading-2">Defining a class in a namespace</h2>
    <p class="normal">The <a id="_idIndexMarker656"/>next task is to define a class that will represent a person:</p>
    <ol>
      <li class="numberedList" value="1">In the <code class="inlineCode">PacktLibraryNet2</code> project, add a new class file named <code class="inlineCode">Person.cs</code>.</li>
      <li class="numberedList">In <code class="inlineCode">Person.cs</code>, delete any existing statements and set the namespace to <code class="inlineCode">Packt.Shared</code>, and for the <code class="inlineCode">Person</code> class, set the access modifier to <code class="inlineCode">public</code>, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">// All types in this file will be defined in this file-scoped namespace.
namespace Packt.Shared;
public class Person
{
}
</code></pre>
        <div><p class="normal"><strong class="keyWord">Good practice</strong>: We’re doing this because it is important to put your classes in a logically named namespace. A better namespace name would be domain-specific, for example, <code class="inlineCode">System.Numerics</code> for types related to advanced numbers. In this case, the types we will create are <code class="inlineCode">Person</code>, <code class="inlineCode">BankAccount</code>, and <code class="inlineCode">WondersOfTheWorld</code>, and they do not have a typical domain, so we will use the more generic <code class="inlineCode">Packt.Shared</code>.</p>
        </div>
      </li>
    </ol>
    <h2 id="_idParaDest-304" class="heading-2">Understanding type access modifiers</h2>
    <p class="normal">Note that <a id="_idIndexMarker657"/>the C# keyword <code class="inlineCode">public</code> is applied before <code class="inlineCode">class</code>. This <a id="_idIndexMarker658"/>keyword is an <strong class="keyWord">access modifier</strong>, and it allows for any other code to access this class even outside this class library.</p>
    <p class="normal">If you do not explicitly apply the <code class="inlineCode">public</code> keyword, then it will only be accessible within the assembly that defined it. This is because the implicit access modifier for a class is <code class="inlineCode">internal</code>. We need this class to be accessible outside the assembly, so we must make sure it is <code class="inlineCode">public</code>.</p>
    <p class="normal">If you have nested classes, meaning a class defined in another class, then the inner class could have the <code class="inlineCode">private</code> access modifier, which would mean it is not accessible outside its parent class.</p>
    <p class="normal">Introduced with .NET 7, the <code class="inlineCode">file</code> access modifier applied to a type means that type can only be used within its code file. This would only be useful if you define multiple classes in the same code file, which is rarely good practice but is used with source generators.</p>
    <div><p class="normal"><strong class="keyWord">More information</strong>: You can learn more about the <code class="inlineCode">file</code> access modifier at the following link: <a href="https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/file">https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/file</a>.</p>
    </div>
    <div><p class="normal"><strong class="keyWord">Good practice</strong>: The two most common access modifiers for a class are <code class="inlineCode">public</code> and <code class="inlineCode">internal</code> (the default access modifier for a class if not specified). Always explicitly specify the access modifier for a class to make it clear what it is. Other access modifiers include <code class="inlineCode">private</code> and <code class="inlineCode">file</code>, but they are rarely used.</p>
    </div>
    <h2 id="_idParaDest-305" class="heading-2">Understanding members</h2>
    <p class="normal">The <code class="inlineCode">Person</code> type<a id="_idIndexMarker659"/> does not yet have any members encapsulated within it. We will create some over the following pages. Members can be fields, methods, or specialized versions of both. You’ll find a description of them here:</p>
    <ul>
      <li class="bulletList"><strong class="keyWord">Fields</strong> are<a id="_idIndexMarker660"/> used to store data. You can think of fields as variables that belong to a type. There are also three specialized categories of field, as shown in the following bullets:<ul>
          <li class="bulletList level-2"><strong class="keyWord">Constant</strong>: The <a id="_idIndexMarker661"/>data never changes. The compiler literally copies the data into any code that reads it. For example, <code class="inlineCode">byte.MaxValue</code> is always <code class="inlineCode">255</code>. Constants must be set to a literal value. Literal values can only be a <code class="inlineCode">string</code> surrounded by <code class="inlineCode">""</code>, a <code class="inlineCode">char</code> surrounded with single quotes, a Boolean like <code class="inlineCode">true</code> or <code class="inlineCode">false</code>, or a number like <code class="inlineCode">3</code>, <code class="inlineCode">3L</code>, <code class="inlineCode">3.0</code>, <code class="inlineCode">3.0F</code>, or <code class="inlineCode">3.0M</code>. Non-literal values are not supported, so you cannot have a constant date/time value.</li>
          <li class="bulletList level-2"><strong class="keyWord">Read-only</strong>: The <a id="_idIndexMarker662"/>data cannot change after the class is instantiated, but the data can be calculated or loaded from an external source at the time of instantiation. For example, <code class="inlineCode">String.Empty</code> is <code class="inlineCode">""</code>, <code class="inlineCode">Guid.Empty</code> is a <strong class="keyWord">GUID</strong> (<strong class="keyWord">globally unique identifier</strong>) with all zeros, <code class="inlineCode">TimeSpan.Zero</code> is a time interval of zero, <code class="inlineCode">DateTime.MinValue</code> is <code class="inlineCode">00:00:00.0000000 UTC, January 1, 0001</code> in the Gregorian calendar, and <code class="inlineCode">Path.DirectorySeparatorChar</code> is <code class="inlineCode">\</code> on Windows. </li>
        </ul>
        <p class="bulletList level-2"><code class="inlineCode">DateTime.UnixEpoch</code> is <code class="inlineCode">00:00:00.0000000 UTC, January 1, 1970,</code> in the Gregorian calendar but this field was introduced after .NET Standard 2.0, so you won’t be able to try it in your current class library.</p>
        <ul>
          <li class="bulletList level-2"><strong class="keyWord">Event</strong>: The <a id="_idIndexMarker663"/>data references one or more methods that you want to execute when something happens, such as clicking on a button or responding to a request from some other code. Events will be covered in <em class="chapterRef">Chapter 6</em>, <em class="italic">Implementing Interfaces and Inheriting Classes</em>. For example, <code class="inlineCode">Console.CancelKeyPress</code> happens when <em class="keystroke">Ctrl </em>+ <em class="keystroke">C</em> or <em class="keystroke">Ctrl </em>+ <em class="keystroke">Break</em> are pressed in a console app.</li>
        </ul>
      </li>
      <li class="bulletList"><strong class="keyWord">Methods</strong> are <a id="_idIndexMarker664"/>used to execute statements. You <a id="_idIndexMarker665"/>saw some examples when you learned about functions in <em class="chapterRef">Chapter 4</em>, <em class="italic">Writing, Debugging, and Testing Functions</em>. There are also four specialized categories of methods:<ul>
          <li class="bulletList level-2"><strong class="keyWord">Constructor</strong>: The<a id="_idIndexMarker666"/> statements execute when you use the <code class="inlineCode">new</code> keyword to allocate memory to instantiate a class. For example, to instantiate Christmas Day, 2023, you could write the following code: <code class="inlineCode">new DateTime(2023, 12, 25)</code>.</li>
          <li class="bulletList level-2"><strong class="keyWord">Property</strong>: The<a id="_idIndexMarker667"/> statements execute when you get or set data. The data is commonly stored in a field but can be stored externally or calculated at runtime. Properties are the preferred way to encapsulate <a id="_idIndexMarker668"/>fields unless the memory address of the field needs to be exposed; for example, <code class="inlineCode">Console.ForegroundColor</code> to set the current color of text in a console app.</li>
          <li class="bulletList level-2"><strong class="keyWord">Indexer</strong>: The<a id="_idIndexMarker669"/> statements execute when you get or set data using “array” syntax <code class="inlineCode">[]</code>. For example, use <code class="inlineCode">name[0]</code> to get the first character in the <code class="inlineCode">name</code> variable, which is a <code class="inlineCode">string</code>.</li>
          <li class="bulletList level-2"><strong class="keyWord">Operator</strong>: The <a id="_idIndexMarker670"/>statements execute when you apply an operator like <code class="inlineCode">+</code> and <code class="inlineCode">/</code> to operands of your type. For example, use <code class="inlineCode">a + b</code> to add two variables together.</li>
        </ul>
      </li>
    </ul>
    <h2 id="_idParaDest-306" class="heading-2">Importing a namespace to use a type</h2>
    <p class="normal">In this section, we<a id="_idIndexMarker671"/> will make an instance of the <code class="inlineCode">Person</code> class.</p>
    <p class="normal">Before we can instantiate a class, we need to reference the assembly that contains it from another project. We will use the class in a console app:</p>
    <ol>
      <li class="numberedList" value="1">Use your preferred code editor to add a new <strong class="screenText">Console App</strong> / <code class="inlineCode">console</code> named <code class="inlineCode">PeopleApp</code> to the <code class="inlineCode">Chapter05</code> solution. Make sure you <em class="italic">add</em> the new project to the existing <code class="inlineCode">Chapter05</code> solution because you are about to reference from the console app project to the existing class library project so both projects must be in the same solution.</li>
      <li class="numberedList">If you use Visual Studio:<ol class="numberedList level-2" style="list-style-type: decimal;">
          <li class="numberedList level-2" value="1">Configure the startup project for the solution to the current selection.</li>
          <li class="numberedList level-2">In <strong class="screenText">Solution Explorer</strong>, select the <code class="inlineCode">PeopleApp</code> project, navigate to <strong class="screenText">Project</strong> | <strong class="screenText">Add Project Reference…</strong>, check the box to select the <code class="inlineCode">PacktLibraryNet2</code> project, and then click <strong class="screenText">OK</strong>.</li>
          <li class="numberedList level-2">In <code class="inlineCode">PeopleApp.csproj</code>, add an entry to statically import the <code class="inlineCode">System.Console</code> class, as shown in the following markup:
            <pre class="programlisting code"><code class="hljs-code">&lt;ItemGroup&gt;
&lt;Using Include="System.Console" Static="true" /&gt;
&lt;/ItemGroup&gt;
</code></pre>
          </li>
          <li class="numberedList level-2">Navigate to <strong class="screenText">Build</strong> | <strong class="screenText">Build PeopleApp</strong>.</li>
        </ol>
      </li>
      <li class="numberedList">If you<a id="_idIndexMarker672"/> use VS Code:<ol class="numberedList level-2" style="list-style-type: decimal;">
          <li class="numberedList level-2" value="1">Edit <code class="inlineCode">PeopleApp.csproj</code> to add a project reference to <code class="inlineCode">PacktLibraryNet2</code>, and add an entry to statically import the <code class="inlineCode">System.Console</code> class, as highlighted in the following markup:
            <pre class="programlisting code"><code class="hljs-code">&lt;Project Sdk="Microsoft.NET.Sdk"&gt;
  &lt;PropertyGroup&gt;
    &lt;OutputType&gt;Exe&lt;/OutputType&gt;
    &lt;TargetFramework&gt;net9.0&lt;/TargetFramework&gt;
    &lt;Nullable&gt;enable&lt;/Nullable&gt;
    &lt;ImplicitUsings&gt;enable&lt;/ImplicitUsings&gt;
  &lt;/PropertyGroup&gt;
<strong class="hljs-slc">  </strong><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">ItemGroup</strong><strong class="hljs-tag-slc">&gt;</strong>
<strong class="hljs-slc">  </strong><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">ProjectReference</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">Include</strong><strong class="hljs-tag-slc">=</strong>
<strong class="hljs-tag-slc">  </strong><strong class="hljs-string-slc">"../PacktLibraryNet2/PacktLibraryNet2.csproj"</strong><strong class="hljs-tag-slc"> /&gt;</strong>
<strong class="hljs-slc">  </strong><strong class="hljs-tag-slc">&lt;/</strong><strong class="hljs-name-slc">ItemGroup</strong><strong class="hljs-tag-slc">&gt;</strong>
<strong class="hljs-slc">  </strong><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">ItemGroup</strong><strong class="hljs-tag-slc">&gt;</strong>
<strong class="hljs-slc">    </strong><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">Using</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">Include</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">"System.Console"</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">Static</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">"true"</strong><strong class="hljs-tag-slc"> /&gt;</strong>
<strong class="hljs-slc">  </strong><strong class="hljs-tag-slc">&lt;/</strong><strong class="hljs-name-slc">ItemGroup</strong><strong class="hljs-tag-slc">&gt;</strong>
&lt;/Project&gt;
</code></pre>
          </li>
          <li class="numberedList level-2">In a terminal, compile the <code class="inlineCode">PeopleApp</code> project and its dependency <code class="inlineCode">PacktLibraryNet2</code> project, as shown in the following command:
            <pre class="programlisting con"><code class="hljs-con">dotnet build
</code></pre>
          </li>
        </ol>
      </li>
      <li class="numberedList">In the <code class="inlineCode">PeopleApp</code> project, add a new class file named <code class="inlineCode">Program.Helpers.cs</code>.</li>
      <li class="numberedList">In <code class="inlineCode">Program.Helpers.cs</code>, delete any existing statements, and define a <code class="inlineCode">partial Program</code> class with a method to configure the console to enable special symbols, like the euro currency, and to control the current <a id="_idIndexMarker673"/>culture, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">using System.Globalization; // To use CultureInfo.
partial class Program
{
  private static void ConfigureConsole(
    string culture = "en-US",
    bool useComputerCulture = false,
    bool showCulture = true)
  {
    OutputEncoding = System.Text.Encoding.UTF8;
    if (!useComputerCulture)
    {
      CultureInfo.CurrentCulture = CultureInfo.GetCultureInfo(culture);
    }
    if (showCulture)
    {
      WriteLine($"Current culture: {CultureInfo.CurrentCulture.DisplayName}.");
    }
  }
}
</code></pre>
      </li>
    </ol>
    <div><p class="normal">By the end of this chapter, you will understand how the preceding method uses C# features like partial classes, optional parameters, and so on. If you would like to learn more about working with languages and cultures, as well as dates, times, and time zones, then there is a chapter about globalization and localization in my companion book, <em class="italic">Apps and Services with .NET 8</em>.</p>
    </div>
    <h2 id="_idParaDest-307" class="heading-2">Instantiating a class</h2>
    <p class="normal">Now, we<a id="_idIndexMarker674"/> are ready to write statements to instantiate the <code class="inlineCode">Person</code> class:</p>
    <ol>
      <li class="numberedList" value="1">In the <code class="inlineCode">PeopleApp</code> project, in the <code class="inlineCode">Program.cs</code> file, delete the existing statements, then add statements to import the namespace for our <code class="inlineCode">Person</code> class, and then call the <code class="inlineCode">ConfigureConsole</code> method without any arguments so that it sets the current culture to US English, allowing all readers to see the same output, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">using Packt.Shared; // To use Person.
ConfigureConsole(); // Sets current culture to US English.
// Alternatives:
// ConfigureConsole(useComputerCulture: true); // Use your culture.
// ConfigureConsole(culture: "fr-FR"); // Use French culture.
</code></pre>
      </li>
    </ol>
    <div><p class="normal">Although we could import the <code class="inlineCode">Packt.Shared</code> namespace globally, it will be clearer to anyone reading this code where we import the types we use from if the <code class="inlineCode">import</code> statement is at the top of the file, and the <code class="inlineCode">PeopleApp</code> project will only have this one <code class="inlineCode">Program.cs</code> file that needs the namespace imported.</p>
    </div>
    <ol>
      <li class="numberedList" value="2">In <code class="inlineCode">Program.cs</code>, add statements to:<ul>
          <li class="bulletList level-2">Create an instance of the <code class="inlineCode">Person</code> type.</li>
          <li class="bulletList level-2">Output the instance using a textual description of itself.</li>
        </ul>
      </li>
    </ol>
    <p class="normal-one">The <code class="inlineCode">new</code> keyword allocates memory for the object and initializes any internal data, as shown in the following code:</p>
    <pre class="programlisting code-one"><code class="hljs-code">// Person bob = new Person(); // C# 1 or later.
// var bob = new Person(); // C# 3 or later.
Person bob = new(); // C# 9 or later.
WriteLine(bob); // Implicit call to ToString().
// WriteLine(bob.ToString()); // Does the same thing.
</code></pre>
    <ol>
      <li class="numberedList" value="3">Run the <code class="inlineCode">PeopleApp</code> project and view the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">Current culture: English (United States).
Packt.Shared.Person
</code></pre>
      </li>
    </ol>
    <p class="normal">You might be <a id="_idIndexMarker675"/>wondering, “Why does the <code class="inlineCode">bob</code> variable have a method named <code class="inlineCode">ToString</code>? The <code class="inlineCode">Person</code> class is empty!” Don’t worry, we’re about to find out!</p>
    <h2 id="_idParaDest-308" class="heading-2">Inheriting from System.Object</h2>
    <p class="normal">Although <a id="_idIndexMarker676"/>our <code class="inlineCode">Person</code> class did not explicitly choose to inherit from a type, all types ultimately inherit directly or indirectly from a special type named <code class="inlineCode">System.Object</code>. The implementation of the <code class="inlineCode">ToString</code> method in the <code class="inlineCode">System.Object</code> type outputs the full namespace and type name.</p>
    <p class="normal">Back in the original <code class="inlineCode">Person</code> class, we could have explicitly told the compiler that <code class="inlineCode">Person</code> inherits from the <code class="inlineCode">System.Object</code> type, as shown in the following code:</p>
    <pre class="programlisting code"><code class="hljs-code">public class Person : System.Object
</code></pre>
    <p class="normal">When class B is inherited from class A, we say that A is the base or superclass, and B is the derived or subclass. In this case, <code class="inlineCode">System.Object</code> is the base or superclass, and <code class="inlineCode">Person</code> is the derived or subclass. You can also use the C# keyword <code class="inlineCode">object</code>.</p>
    <p class="normal">Let’s make our class explicitly inherit from <code class="inlineCode">object</code> and then review what members all objects have:</p>
    <ol>
      <li class="numberedList" value="1">Modify your <code class="inlineCode">Person</code> class to explicitly inherit from <code class="inlineCode">object</code>, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">public class Person : object
</code></pre>
      </li>
      <li class="numberedList">Click inside the <code class="inlineCode">object</code> keyword and press <em class="italic">F12</em>, or right-click on the <code class="inlineCode">object</code> keyword and choose <strong class="screenText">Go to Definition</strong>.</li>
    </ol>
    <p class="normal">You <a id="_idIndexMarker677"/>will see the Microsoft-defined <code class="inlineCode">System.Object</code> type and its members. This is something you don’t need to understand the details of yet, but note that the class is in a .NET Standard 2.0 class library assembly, as shown in <em class="italic">Figure 5.1</em>:</p>
    <figure class="mediaobject"><img src="img/B22322_05_01.png" alt="" width="878" height="323"/></figure>
    <p class="packt_figref">Figure 5.1: The System.Object class definition in .NET Standard 2.0</p>
    <p class="normal">If you scroll down the class code file, note that the <code class="inlineCode">Object</code> class has a method named <code class="inlineCode">ToString</code>.</p>
    <div><p class="normal"><strong class="keyWord">Good practice</strong>: Assume other programmers know that if inheritance is not specified, the class will inherit from <code class="inlineCode">System.Object</code>.</p>
    </div>
    <h2 id="_idParaDest-309" class="heading-2">Avoiding a namespace conflict with a using alias</h2>
    <p class="normal">We need to<a id="_idIndexMarker678"/> learn a bit more about namespaces and their types. It is possible that there are two namespaces that contain the same type name, and importing both namespaces causes ambiguity. For example, <code class="inlineCode">JsonOptions</code> exists in multiple Microsoft-defined namespaces. If you use the wrong one to configure JSON serialization, then it will be ignored and you’ll be confused as to why!</p>
    <p class="normal">Let’s review a made-up example:</p>
    <pre class="programlisting code"><code class="hljs-code">// In the file, France.Paris.cs
namespace France
{
  public class Paris
  {
  }
}
// In the file, Texas.Paris.cs
namespace Texas
{
  public class Paris
  {
  }
}
// In the file, Program.cs
using France;
using Texas;
Paris p = new();
</code></pre>
    <p class="normal">If we build this project, then the compiler would complain with the following error:</p>
    <pre class="programlisting con"><code class="hljs-con">Error CS0104: 'Paris' is an ambiguous reference between 'France.Paris' and 'Texas.Paris'
</code></pre>
    <p class="normal">We <a id="_idIndexMarker679"/>can define an alias for one of the namespaces to differentiate it, as shown in the following code:</p>
    <pre class="programlisting code"><code class="hljs-code">using France; // To use Paris.
using Tx = Texas; // Tx becomes alias for the namespace, and it is not imported.
Paris p1 = new(); // Creates an instance of France.Paris.
Tx.Paris p2 = new(); // Creates an instance of Texas.Paris.
</code></pre>
    <h2 id="_idParaDest-310" class="heading-2">Renaming a type with a using alias</h2>
    <p class="normal">Another<a id="_idIndexMarker680"/> situation where you might want to use an alias is if you would like to rename a type. For example, if you use the <code class="inlineCode">Environment</code> class in the <code class="inlineCode">System</code> namespace a lot, you could rename it with an alias to make it shorter, as shown in the following code:</p>
    <pre class="programlisting code"><code class="hljs-code">using Env = System.Environment;
WriteLine(Env.OSVersion);
WriteLine(Env.MachineName);
WriteLine(Env.CurrentDirectory);
</code></pre>
    <p class="normal">Starting with C# 12, you can alias any type. This means you can rename existing types or give a type name to unnamed types like tuples, as you will see later in this chapter.</p>
    <div><p class="normal">You can learn how to refactor your code using alias any type at the following link: <a href="https://devblogs.microsoft.com/dotnet/refactor-your-code-using-alias-any-type/">https://devblogs.microsoft.com/dotnet/refactor-your-code-using-alias-any-type/</a>.</p>
    </div>
    <h1 id="_idParaDest-311" class="heading-1">Storing data in fields</h1>
    <p class="normal">In this<a id="_idIndexMarker681"/> section, we will define a selection of fields in the class to store information about a person.</p>
    <h2 id="_idParaDest-312" class="heading-2">Defining fields</h2>
    <p class="normal">Let’s say<a id="_idIndexMarker682"/> that we have decided that a person is composed of a name and a date and time of birth. We will encapsulate these two values inside a person, and the values will be visible outside it:</p>
    <ul>
      <li class="bulletList">Inside the <code class="inlineCode">Person</code> class, write statements to declare two public fields to store a person’s name and the date of when they were born, as highlighted in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">public class Person : object
{
<strong class="hljs-slc">  </strong><strong class="hljs-meta-slc">#</strong><strong class="hljs-keyword-slc">region</strong><strong class="hljs-meta-slc"> Fields: Data or state for this person.</strong>
<strong class="hljs-slc">  </strong><strong class="hljs-keyword-slc">public</strong><strong class="hljs-slc"> </strong><strong class="hljs-built_in-slc">string</strong><strong class="hljs-slc">? Name; </strong><strong class="hljs-comment-slc">// ? means it can be null.</strong>
<strong class="hljs-slc">  </strong><strong class="hljs-keyword-slc">public</strong><strong class="hljs-slc"> DateTimeOffset Born;</strong>
<strong class="hljs-slc">  </strong><strong class="hljs-meta-slc">#</strong><strong class="hljs-keyword-slc">endregion</strong>
}
</code></pre>
      </li>
    </ul>
    <div><p class="normal">We have multiple choices for the data type of the <code class="inlineCode">Born</code> field. .NET 6 introduced the <code class="inlineCode">DateOnly</code> type. This would store only the date without a time value. <code class="inlineCode">DateTime</code> stores the date and time when the person was born, but it varies between local and <strong class="keyWord">Universal Coordinated Time</strong> (<strong class="keyWord">UTC</strong>). The best choice is <code class="inlineCode">DateTimeOffset</code>, which stores the date, time, and hours offset from <strong class="keyWord">UTC</strong>, which is related to the time zone. The choice depends on how much detail you need to store.</p>
    </div>
    <h2 id="_idParaDest-313" class="heading-2">Types for fields</h2>
    <p class="normal">Since C# 8, the <a id="_idIndexMarker683"/>compiler has had the ability to warn you if a reference type, like a <code class="inlineCode">string</code>, could have a <code class="inlineCode">null</code> value and, therefore, potentially throw a <code class="inlineCode">NullReferenceException</code>. Since .NET 6, the SDK enables those warnings by default. You can suffix the <code class="inlineCode">string</code> type with a question mark, <code class="inlineCode">?</code>, to indicate that you accept this, and the warning disappears. You will learn more about nullability and how to handle it in <em class="chapterRef">Chapter 6</em>, <em class="italic">Implementing Interfaces and Inheriting Classes</em>.</p>
    <p class="normal">You can use any type for a field, including arrays and collections, such as lists and dictionaries. These would be used if you needed to store multiple values in one named field. In this example, a person only has one name and one date and time of birth.</p>
    <h2 id="_idParaDest-314" class="heading-2">Member access modifiers</h2>
    <p class="normal">Part of encapsulation <a id="_idIndexMarker684"/>is choosing how visible members are to other code.</p>
    <p class="normal">Note that, as we did with the class, we explicitly applied the <code class="inlineCode">public</code> keyword to these fields. If we hadn’t, then they would be implicitly <code class="inlineCode">private</code> to the class, which means they are accessible only inside the class.</p>
    <p class="normal">There are four <strong class="keyWord">member access modifier</strong> keywords, and two combinations of access modifier keywords that you can apply to a class member, like a field or method. Member access modifiers apply to an individual member. They are similar to but separate from type access modifiers that apply to the whole type. The six possible combinations are shown in <em class="italic">Table 5.1</em>:</p>
    <table id="table001-4" class="table-container">
      <tbody>
        <tr>
          <td class="table-cell">
            <p class="normal"><strong class="keyWord">Member Access Modifier</strong></p>
          </td>
          <td class="table-cell">
            <p class="normal"><strong class="keyWord">Description</strong></p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">private</code></p>
          </td>
          <td class="table-cell">
            <p class="normal">The member is accessible inside the type only. This is the default.</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">internal</code></p>
          </td>
          <td class="table-cell">
            <p class="normal">The member is accessible inside the type and any type in the same assembly.</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">protected</code></p>
          </td>
          <td class="table-cell">
            <p class="normal">The member is accessible inside the type and any type that inherits from the type.</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">public</code></p>
          </td>
          <td class="table-cell">
            <p class="normal">The member is accessible everywhere.</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">internal protected</code></p>
          </td>
          <td class="table-cell">
            <p class="normal">The member is accessible inside the type, any type in the same assembly, and any type that inherits from the type. Equivalent to a fictional access modifier named <code class="inlineCode">internal_or_protected</code>.</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">private protected</code></p>
          </td>
          <td class="table-cell">
            <p class="normal">The member is accessible inside the type and any type that inherits from the type and is in the same assembly. Equivalent to a fictional access modifier named <code class="inlineCode">internal_and_protected</code>. This combination is only available with C# 7.2 or later.</p>
          </td>
        </tr>
      </tbody>
    </table>
    <p class="packt_figref">Table 5.1: Six member access modifiers</p>
    <div><p class="normal"><strong class="keyWord">Good practice</strong>: Explicitly apply one of the access modifiers to all type members, even if you want to use the implicit access modifier for members, which is <code class="inlineCode">private</code>. Additionally, fields should usually be <code class="inlineCode">private</code> or <code class="inlineCode">protected</code>, and you should then create <code class="inlineCode">public</code> properties to get or set the field values. This is because the property then controls access. You will do this later in the chapter.</p>
    </div>
    <h2 id="_idParaDest-315" class="heading-2">Setting and outputting field values</h2>
    <p class="normal">Now, we will <a id="_idIndexMarker685"/>use those fields in your <a id="_idIndexMarker686"/>code:</p>
    <ol>
      <li class="numberedList" value="1">In <code class="inlineCode">Program.cs</code>, after instantiating <code class="inlineCode">bob</code>, add statements to set his name and date and time of birth, and then output those fields formatted nicely, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">bob.Name = "Bob Smith";
bob.Born = new DateTimeOffset(
  year: 1965, month: 12, day: 22,
  hour: 16, minute: 28, second: 0,
  offset: TimeSpan.FromHours(-5)); // US Eastern Standard Time.
WriteLine(format: "{0} was born on {1:D}.", // Long date.
  arg0: bob.Name, arg1: bob.Born);
</code></pre>
      </li>
    </ol>
    <div><p class="normal">The format code for <code class="inlineCode">arg1</code> is one of the standard date and time formats. <code class="inlineCode">D</code> means a long date format and <code class="inlineCode">d</code> would mean a short date format. You can learn more about standard date and time format codes at the following link: <a href="https://learn.microsoft.com/en-us/dotnet/standard/base-types/standard-date-and-time-format-strings">https://learn.microsoft.com/en-us/dotnet/standard/base-types/standard-date-and-time-format-strings</a>.</p>
    </div>
    <ol>
      <li class="numberedList" value="2">Run <a id="_idIndexMarker687"/>the <code class="inlineCode">PeopleApp</code> project and view the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">Bob Smith was born on Wednesday, December 22, 1965.
</code></pre>
      </li>
    </ol>
    <p class="normal-one">If you <a id="_idIndexMarker688"/>change the call to <code class="inlineCode">ConfigureConsole</code> to use your local computer culture or a specified culture, like French in France (<code class="inlineCode">"</code><code class="inlineCode">fr-FR"</code>), then your output will look different.</p>
    <h2 id="_idParaDest-316" class="heading-2">Setting field values using object initializer syntax</h2>
    <p class="normal">You can<a id="_idIndexMarker689"/> also initialize fields using a shorthand <strong class="keyWord">object initializer</strong> syntax with curly braces, which was introduced with C# 3. Let’s see how:</p>
    <ol>
      <li class="numberedList" value="1">Add statements underneath the existing code to create another new person named Alice. Note the different standard format code for the date and time of birth when writing her to the console, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">Person alice = new()
{
  Name = "Alice Jones",
  Born = new(1998, 3, 7, 16, 28, 0,
    // This is an optional offset from UTC time zone.
    TimeSpan.Zero)
};
WriteLine(format: "{0} was born on {1:d}.", // Short date.
  arg0: alice.Name, arg1: alice.Born);
</code></pre>
      </li>
    </ol>
    <div><p class="normal">We could have used string interpolation to format the output, but for long strings, it will wrap over multiple lines, which can be harder to read in a printed book. In the code examples in this book, remember that <code class="inlineCode">{0}</code> is a placeholder for <code class="inlineCode">arg0</code>, and so on.</p>
    </div>
    <ol>
      <li class="numberedList" value="2">Run <a id="_idIndexMarker690"/>the <code class="inlineCode">PeopleApp</code> project and view the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">Alice Jones was born on 3/7/1998.
</code></pre>
      </li>
    </ol>
    <div><p class="normal"> <strong class="keyWord">Good practice</strong>: Use named parameters to pass arguments, so it is clearer what the values mean, especially for types like <code class="inlineCode">DateTimeOffset</code> where there are a bunch of numbers one after the other.</p>
    </div>
    <h2 id="_idParaDest-317" class="heading-2">Storing a value using an enum type</h2>
    <p class="normal">Sometimes, a value<a id="_idIndexMarker691"/> needs to be one of a limited set of options. For example, there are seven ancient wonders of the world, and a person may have one favorite.</p>
    <p class="normal">At other times, a value needs to be a combination of a limited set of options. For example, a person may have a bucket list of ancient world wonders they want to visit. We can store this data by defining an <code class="inlineCode">enum</code> type.</p>
    <p class="normal">An <code class="inlineCode">enum</code> type is <a id="_idIndexMarker692"/>a very efficient way of storing one or more choices because, internally, it uses integer values in combination with a lookup table of <code class="inlineCode">string</code> descriptions. Let’s see an example:</p>
    <ol>
      <li class="numberedList" value="1">Add a new file to the <code class="inlineCode">PacktLibraryNet2</code> project named <code class="inlineCode">WondersOfTheAncientWorld.cs</code>.</li>
      <li class="numberedList">Modify the <code class="inlineCode">WondersOfTheAncientWorld.cs</code> contents, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">namespace Packt.Shared;
public enum WondersOfTheAncientWorld
{
  GreatPyramidOfGiza,
  HangingGardensOfBabylon,
  StatueOfZeusAtOlympia,
  TempleOfArtemisAtEphesus,
  MausoleumAtHalicarnassus,
  ColossusOfRhodes,
  LighthouseOfAlexandria
}
</code></pre>
      </li>
      <li class="numberedList">In <code class="inlineCode">Person.cs</code>, define a field to store a person’s favorite ancient world wonder, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">public WondersOfTheAncientWorld FavoriteAncientWonder;
</code></pre>
      </li>
      <li class="numberedList">In <code class="inlineCode">Program.cs</code>, set Bob’s favorite ancient wonder of the world and output it, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">bob.FavoriteAncientWonder = WondersOfTheAncientWorld.StatueOfZeusAtOlympia;
WriteLine(
  format: "{0}'s favorite wonder is {1}. Its integer is {2}.",
  arg0: bob.Name,
  arg1: bob.FavoriteAncientWonder,
  arg2: (int)bob.FavoriteAncientWonder);
</code></pre>
      </li>
      <li class="numberedList">Run the <code class="inlineCode">PeopleApp</code> project and view the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">Bob Smith's favorite wonder is StatueOfZeusAtOlympia. Its integer is 2.
</code></pre>
      </li>
    </ol>
    <p class="normal">The <code class="inlineCode">enum</code> value<a id="_idIndexMarker693"/> is internally stored as an <code class="inlineCode">int</code> for efficiency. The <code class="inlineCode">int</code> values are automatically assigned, starting at <code class="inlineCode">0</code>, so the third world wonder in our <code class="inlineCode">enum</code> has a value of <code class="inlineCode">2</code>. You can assign <code class="inlineCode">int</code> values that are not listed in the <code class="inlineCode">enum</code>. They will output as the <code class="inlineCode">int</code> value instead of a name since a match will not be found.</p>
    <h2 id="_idParaDest-318" class="heading-2">Storing multiple values using an enum type</h2>
    <p class="normal">For the <a id="_idIndexMarker694"/>bucket list, we could create an array or collection of instances of the <code class="inlineCode">enum</code>, and collections as fields will be shown later in this chapter, but there is a better approach for this scenario. We can combine multiple choices into a single value using <code class="inlineCode">enum</code> flags. Let’s see how:</p>
    <ol>
      <li class="numberedList" value="1">Modify the <code class="inlineCode">enum</code> by decorating it with the <code class="inlineCode">[Flags]</code> attribute, and explicitly set a <code class="inlineCode">byte</code> value for each wonder that represents different bit columns, as highlighted in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">namespace Packt.Shared;
<strong class="hljs-slc">[</strong><strong class="hljs-meta-slc">Flags</strong><strong class="hljs-slc">]</strong>
public enum WondersOfTheAncientWorld <strong class="hljs-slc">: </strong><strong class="hljs-built_in-slc">byte</strong>
{
  None                     <strong class="hljs-slc">= </strong><strong class="hljs-number-slc">0b</strong><strong class="hljs-slc">_0000_0000, </strong><strong class="hljs-comment-slc">// i.e. 0</strong>
  GreatPyramidOfGiza       <strong class="hljs-slc">= </strong><strong class="hljs-number-slc">0b</strong><strong class="hljs-slc">_0000_0001, </strong><strong class="hljs-comment-slc">// i.e. 1</strong>
  HangingGardensOfBabylon  <strong class="hljs-slc">= </strong><strong class="hljs-number-slc">0b</strong><strong class="hljs-slc">_0000_0010, </strong><strong class="hljs-comment-slc">// i.e. 2</strong>
  StatueOfZeusAtOlympia    <strong class="hljs-slc">= </strong><strong class="hljs-number-slc">0b</strong><strong class="hljs-slc">_0000_0100, </strong><strong class="hljs-comment-slc">// i.e. 4</strong>
  TempleOfArtemisAtEphesus <strong class="hljs-slc">= </strong><strong class="hljs-number-slc">0b</strong><strong class="hljs-slc">_0000_1000, </strong><strong class="hljs-comment-slc">// i.e. 8</strong>
  MausoleumAtHalicarnassus <strong class="hljs-slc">= </strong><strong class="hljs-number-slc">0b</strong><strong class="hljs-slc">_0001_0000, </strong><strong class="hljs-comment-slc">// i.e. 16</strong>
  ColossusOfRhodes         <strong class="hljs-slc">= </strong><strong class="hljs-number-slc">0b</strong><strong class="hljs-slc">_0010_0000, </strong><strong class="hljs-comment-slc">// i.e. 32</strong>
  LighthouseOfAlexandria   <strong class="hljs-slc">= </strong><strong class="hljs-number-slc">0b</strong><strong class="hljs-slc">_0100_0000  </strong><strong class="hljs-comment-slc">// i.e. 64</strong>
}
</code></pre>
      </li>
    </ol>
    <div><p class="normal">The integer types that an <code class="inlineCode">enum</code> is allowed to inherit from are <code class="inlineCode">Byte</code>, <code class="inlineCode">SByte</code>, <code class="inlineCode">Int16</code>, <code class="inlineCode">Int32</code>, <code class="inlineCode">Int64</code>, <code class="inlineCode">UInt16</code>, <code class="inlineCode">UInt32</code>, and <code class="inlineCode">UInt64</code>. The new integer types <code class="inlineCode">Int128</code> and <code class="inlineCode">UInt128</code> are not supported.</p>
    </div>
    <p class="normal-one">We <a id="_idIndexMarker695"/>assign explicit values for each choice that will not overlap when looking at the bits stored in memory. We should also decorate the <code class="inlineCode">enum</code> type with the <code class="inlineCode">System.Flags</code> attribute so that when the value is returned, it can automatically match with multiple values as a comma-separated <code class="inlineCode">string</code> instead of returning an <code class="inlineCode">int</code> value.</p>
    <p class="normal-one">Normally, an <code class="inlineCode">enum</code> type uses an <code class="inlineCode">int</code> variable internally, but since we don’t need values that big, we can reduce memory requirements by 75%, that is, 1 byte per value instead of 4 bytes, by telling it to use a <code class="inlineCode">byte</code> variable. As another example, if you wanted to define an <code class="inlineCode">enum</code> for days of the week, there will only ever be seven of them.</p>
    <p class="normal-one">If we want to indicate that our bucket list includes the <em class="italic">Hanging Gardens of Babylon</em> and the <em class="italic">Mausoleum at Halicarnassus</em> ancient world wonders, then we would want the <code class="inlineCode">16</code> and <code class="inlineCode">2</code> bits set to <code class="inlineCode">1</code>. In other words, we would store the value <code class="inlineCode">18</code>, as shown in <em class="italic">Table 5.2</em>:</p>
    <table id="table002-4" class="table-container">
      <tbody>
        <tr>
          <td class="table-cell">
            <p class="normal">64</p>
          </td>
          <td class="table-cell">
            <p class="normal">32</p>
          </td>
          <td class="table-cell">
            <p class="normal">16</p>
          </td>
          <td class="table-cell">
            <p class="normal">8</p>
          </td>
          <td class="table-cell">
            <p class="normal">4</p>
          </td>
          <td class="table-cell">
            <p class="normal">2</p>
          </td>
          <td class="table-cell">
            <p class="normal">1</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal">0</p>
          </td>
          <td class="table-cell">
            <p class="normal">0</p>
          </td>
          <td class="table-cell">
            <p class="normal">1</p>
          </td>
          <td class="table-cell">
            <p class="normal">0</p>
          </td>
          <td class="table-cell">
            <p class="normal">0</p>
          </td>
          <td class="table-cell">
            <p class="normal">1</p>
          </td>
          <td class="table-cell">
            <p class="normal">0</p>
          </td>
        </tr>
      </tbody>
    </table>
    <p class="packt_figref">Table 5.2: Storing 18 as bits in an enum</p>
    <ol>
      <li class="numberedList" value="2">In <code class="inlineCode">Person.cs</code>, leave the existing field to store a single favorite ancient world wonder and add the following statement to your list of fields to store multiple ancient world wonders:
        <pre class="programlisting code-one"><code class="hljs-code">public WondersOfTheAncientWorld BucketList;
</code></pre>
      </li>
      <li class="numberedList">In <code class="inlineCode">Program.cs</code>, add <a id="_idIndexMarker696"/>statements to set the bucket list using the <code class="inlineCode">|</code> operator (the bitwise logical <code class="inlineCode">OR</code>) to combine the <code class="inlineCode">enum</code> values. We could also set the value using the number <code class="inlineCode">18</code> cast into the <code class="inlineCode">enum</code> type, as shown in the comment, but we shouldn’t because that would make the code harder to understand, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">bob.BucketList =
  WondersOfTheAncientWorld.HangingGardensOfBabylon
  | WondersOfTheAncientWorld.MausoleumAtHalicarnassus;
// bob.BucketList = (WondersOfTheAncientWorld)18;
WriteLine($"{bob.Name}'s bucket list is {bob.BucketList}.");
</code></pre>
      </li>
      <li class="numberedList">Run the <code class="inlineCode">PeopleApp</code> project and view the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">Bob Smith's bucket list is HangingGardensOfBabylon, MausoleumAtHalicarnassus.
</code></pre>
      </li>
    </ol>
    <div><p class="normal"><strong class="keyWord">Good practice</strong>: Use the <code class="inlineCode">enum</code> values to store combinations of discrete options. Derive an <code class="inlineCode">enum</code> type from <code class="inlineCode">byte</code> if there are up to eight options, from <code class="inlineCode">ushort</code> if there are up to 16 options, from <code class="inlineCode">uint</code> if there are up to 32 options, and from <code class="inlineCode">ulong</code> if there are up to 64 options.</p>
    </div>
    <p class="normal">Now that we have decorated the <code class="inlineCode">enum</code> with the <code class="inlineCode">[Flags]</code> attribute, combinations of values can be stored in a single variable or field. Now, a programmer could store a combination of values in the <code class="inlineCode">FavoriteAncientWonder</code> too when it should only store one value. To enforce this, we should convert the field into a property that allows us to take control over how other programmers can get and set the value. You will see how to do this later in this chapter.</p>
    <h2 id="_idParaDest-319" class="heading-2">Changing an enum base type for performance</h2>
    <p class="normal">The <a id="_idIndexMarker697"/>preceding section was about storing multiple values using an <code class="inlineCode">enum</code> type. It’s about <code class="inlineCode">enum</code> types decorated with the <code class="inlineCode">[Flags]</code> attribute that use bitwise operations to efficiently store those multiple values. In the code example, we defined an <code class="inlineCode">enum</code> for the Seven Wonders of the Ancient World, so it only needed seven combinable values (and <code class="inlineCode">0</code> for <code class="inlineCode">None</code>).</p>
    <p class="normal">The preceding section was not about making all your <code class="inlineCode">enum</code> types derive from <code class="inlineCode">byte</code> to make your code faster because that would be bad advice.</p>
    <p class="normal">On March 18, 2024, Nick Chapsas posted a YouTube video titled, <em class="italic">Turn All Your Enums Into Bytes Now! | Code Cop #014</em>, which you can watch at the following link: <a href="https://www.youtube.com/watch?v=1gWzE9SIGkQ">https://www.youtube.com/watch?v=1gWzE9SIGkQ</a>. He criticized blog articles that recommend changing the default base integer type of <code class="inlineCode">enum</code> types from <code class="inlineCode">int</code> to <code class="inlineCode">byte</code> to improve performance.</p>
    <p class="normal">The original designers of the C# language spent effort on implementing the ability for <code class="inlineCode">enum</code> types to derive from other integers than just the default <code class="inlineCode">int</code>. For example, you can use fewer bytes by using a positive integer like <code class="inlineCode">byte</code> or <code class="inlineCode">ushort</code>, or the same or more bytes by using a positive integer like <code class="inlineCode">uint</code> or <code class="inlineCode">ulong</code>. They implemented this feature because sometimes a .NET developer will need this capability.</p>
    <p class="normal">I think it is important that my readers know that they can do it when necessary. Microsoft’s official guidance states, “Even though you can change this underlying type, it is not necessary or recommended for most scenarios. No significant performance gain is achieved by using a data type that is smaller than <code class="inlineCode">Int32</code>.”, as you can read at the following link: <a href="https://learn.microsoft.com/en-us/dotnet/fundamentals/code-analysis/quality-rules/ca1028">https://learn.microsoft.com/en-us/dotnet/fundamentals/code-analysis/quality-rules/ca1028</a>.</p>
    <div><p class="normal">For those developers who object to changing any <code class="inlineCode">enum</code> from <code class="inlineCode">int</code> to some other integer, there is a compiler code analysis warning that I linked to above. If enabled, it will trigger if you set an <code class="inlineCode">enum</code> to anything other than <code class="inlineCode">int</code>: “CA1028: Enum storage should be Int32.” This warning is not enabled by default because Microsoft knows that there are legitimate reasons why a developer might need to use it.</p>
    </div>
    <p class="normal">Let’s see <a id="_idIndexMarker698"/>some real-life examples of when you would need to change an <code class="inlineCode">enum</code> from deriving from <code class="inlineCode">int</code> to deriving from another integer type:</p>
    <ul>
      <li class="bulletList">You want to increase the size of the integer to store more than 16 options in a flag <code class="inlineCode">enum</code>. The default <code class="inlineCode">int</code> only allows 16 options: 0, 1, 2, 4, 8, 16, 32, 64, 128, 256, 512, 1024, 2048, 4096, 8192, and 16384. Changing to <code class="inlineCode">uint</code> would double the number of choices to 32 without using any more space in memory. Changing to <code class="inlineCode">ulong</code> would give 64 options. Changing to <code class="inlineCode">ushort</code> would allow the same 16 options in half the bytes.</li>
      <li class="bulletList">You need to transfer data as a binary stream via a serial connection to an embedded device and you must carefully follow the protocol, or you are defining your own serial messaging protocol, and you want to reduce the packet size to make the best use of your available bandwidth.</li>
      <li class="bulletList">You have SQL tables with millions of records where some of the columns are <code class="inlineCode">enum</code> values. Setting those columns to <code class="inlineCode">tinyint</code> with a matching <code class="inlineCode">enum</code> : <code class="inlineCode">byte</code> property in the C# entity class can make indexes perform better by being smaller and reducing the number of page reads from disk. Some developers will work on systems that are 30 or more years old with spinning metal disks. Not everyone is deploying to a modern 64-bit OS with modern hardware.</li>
      <li class="bulletList">You need to reduce the size of a <code class="inlineCode">struct</code> because it will be created 100,000 times per second on resource-constrained hardware, or you have game code that is set to use <code class="inlineCode">byte</code> and <code class="inlineCode">short</code> because you have millions of them in contiguous arrays for the game’s data. You would gain a fair <a id="_idIndexMarker699"/>bit of performance doing this, especially from a cache point of view.</li>
    </ul>
    <p class="normal">Now, let’s see how to store multiple values using collections.</p>
    <h2 id="_idParaDest-320" class="heading-2">Storing multiple values using collections</h2>
    <p class="normal">Let’s now <a id="_idIndexMarker700"/>add a field to store a person’s children. This is an example of aggregation because children are instances of a class that is related to the current person, but they are not part of the person itself. We will use a generic <code class="inlineCode">List&lt;T&gt;</code> collection type that can store an ordered collection of any type. You will learn more about collections in <em class="chapterRef">Chapter 8</em>, <em class="italic">Working with Common .NET Types</em>. For now, just follow along:</p>
    <ul>
      <li class="bulletList">In <code class="inlineCode">Person.cs</code>, declare a new field to store multiple <code class="inlineCode">Person</code> instances that represent the children of this person, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">public List&lt;Person&gt; Children = new();
</code></pre>
      </li>
    </ul>
    <p class="normal"><code class="inlineCode">List&lt;Person&gt;</code> is read aloud as “list of <code class="inlineCode">Person</code>,” for example, “the type of the property named <code class="inlineCode">Children</code> is a list of <code class="inlineCode">Person</code> instances.”</p>
    <p class="normal">We must ensure the collection is initialized to a new instance before we can add items to it; otherwise, the field will be <code class="inlineCode">null</code> and throw runtime exceptions when we try to use any of its members, like <code class="inlineCode">Add</code>.</p>
    <h2 id="_idParaDest-321" class="heading-2">Understanding generic collections</h2>
    <p class="normal">The angle<a id="_idIndexMarker701"/> brackets in the <code class="inlineCode">List&lt;T&gt;</code> type is a feature of C# called <strong class="keyWord">generics</strong> that was introduced in 2005 with C# 2. It’s a fancy term for making a collection <strong class="keyWord">strongly typed</strong>, that is, the compiler knows specifically what type of object can be stored in the collection. Generics improve the performance and correctness of your code.</p>
    <p class="normal"><strong class="keyWord">Strongly typed</strong> has a <a id="_idIndexMarker702"/>different meaning than <strong class="keyWord">statically typed</strong>. The old <code class="inlineCode">System.Collection</code> types are statically typed to contain weakly typed <code class="inlineCode">System.Object</code> items. The newer <code class="inlineCode">System.Collection.Generic</code> types are statically typed to contain strongly typed <code class="inlineCode">&lt;T&gt;</code> instances.</p>
    <p class="normal">Ironically, the term <em class="italic">generics</em> means we can use a more specific static type!</p>
    <ol>
      <li class="numberedList" value="1">In <code class="inlineCode">Program.cs</code>, add statements to add three children for <code class="inlineCode">Bob</code>, and then show how many children he has and what their names are, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">// Works with all versions of C#.
Person alfred = new Person();
alfred.Name = "Alfred";
bob.Children.Add(alfred);
// Works with C# 3 and later.
bob.Children.Add(new Person { Name = "Bella" });
// Works with C# 9 and later.
bob.Children.Add(new() { Name = "Zoe" });
WriteLine($"{bob.Name} has {bob.Children.Count} children:");
for (int childIndex = 0; childIndex &lt; bob.Children.Count; childIndex++)
{
  WriteLine($"&gt; {bob.Children[childIndex].Name}");
}
</code></pre>
      </li>
      <li class="numberedList">Run the <code class="inlineCode">PeopleApp</code> project and view the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">Bob Smith has 3 children:
&gt; Alfred
&gt; Bella
&gt; Zoe
</code></pre>
      </li>
    </ol>
    <p class="normal">We could also use a <code class="inlineCode">foreach</code> statement to enumerate over the collection. As an optional challenge, change<a id="_idIndexMarker703"/> the <code class="inlineCode">for</code> statement to output the same information using <code class="inlineCode">foreach</code>.</p>
    <h2 id="_idParaDest-322" class="heading-2">Making a field static</h2>
    <p class="normal">The fields <a id="_idIndexMarker704"/>that we have created so far have all been <strong class="keyWord">instance</strong> members, meaning that a different value of each field exists for each instance of the class that is created. The <code class="inlineCode">alice</code> and <code class="inlineCode">bob</code> variables have different <code class="inlineCode">Name</code> values.</p>
    <p class="normal">Sometimes, you want to define a field that only has one value that is shared across all instances.</p>
    <p class="normal">These are called <strong class="keyWord">static members</strong> because fields are not the only members that can be static. Let’s see what can be achieved using <code class="inlineCode">static</code> fields using a bank account as an example. Each instance of <code class="inlineCode">BankAccount</code> will have its own <code class="inlineCode">AccountName</code> and <code class="inlineCode">Balance</code> values, but all instances will share a single <code class="inlineCode">InterestRate</code> value.</p>
    <p class="normal">Let’s do it:</p>
    <ol>
      <li class="numberedList" value="1">In the <code class="inlineCode">PacktLibraryNet2</code> project, add a new class file named <code class="inlineCode">BankAccount.cs</code>.</li>
      <li class="numberedList">Modify the class to give it three fields – two instance fields and one static field – as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">namespace Packt.Shared;
public class BankAccount
{
  public string? AccountName; // Instance member. It could be null.
  public decimal Balance; // Instance member. Defaults to zero.
  public static decimal InterestRate; // Shared member. Defaults to zero.
}
</code></pre>
      </li>
      <li class="numberedList">In <code class="inlineCode">Program.cs</code>, add<a id="_idIndexMarker705"/> statements to set the shared interest rate, and then create two instances of the <code class="inlineCode">BankAccount</code> type, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">BankAccount.InterestRate = 0.012M; // Store a shared value in static field.
BankAccount jonesAccount = new();
jonesAccount.AccountName = "Mrs. Jones";
jonesAccount.Balance = 2400;
WriteLine(format: "{0} earned {1:C} interest.",
  arg0: jonesAccount.AccountName,
  arg1: jonesAccount.Balance * BankAccount.InterestRate);
BankAccount gerrierAccount = new();
gerrierAccount.AccountName = "Ms. Gerrier";
gerrierAccount.Balance = 98;
WriteLine(format: "{0} earned {1:C} interest.",
  arg0: gerrierAccount.AccountName,
  arg1: gerrierAccount.Balance * BankAccount.InterestRate);
</code></pre>
      </li>
      <li class="numberedList">Run the <code class="inlineCode">PeopleApp</code> project and view the additional output:
        <pre class="programlisting con-one"><code class="hljs-con">Mrs. Jones earned $28.80 interest.
Ms. Gerrier earned $1.18 interest.
</code></pre>
      </li>
    </ol>
    <div><p class="normal">Remember that <code class="inlineCode">C</code> is a format code that tells .NET to use the current culture’s currency format for the decimal numbers.</p>
    </div>
    <p class="normal">Fields are not the only members that can be static. Constructors, methods, properties, and other members can also be static.</p>
    <p class="normal">Static methods do not need an object instance to be called. For example, <code class="inlineCode">Console.WriteLine</code> does<a id="_idIndexMarker706"/> not need an object instance; the method is called directly from the class name. Static methods are covered in <em class="chapterRef">Chapter 6, Implementing Interfaces and Inheriting Classes</em>.</p>
    <h2 id="_idParaDest-323" class="heading-2">Making a field constant</h2>
    <p class="normal">If the<a id="_idIndexMarker707"/> value of a field will never change, you can use the <code class="inlineCode">const</code> keyword and assign a literal value at compile time. Any statement that changes the value will cause a compile-time error. Let’s see a simple example:</p>
    <ol>
      <li class="numberedList" value="1">In <code class="inlineCode">Person.cs</code>, add a <code class="inlineCode">string</code> constant for the species of a person, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">// Constant fields: Values that are fixed at compilation.
public const string Species = "Homo Sapiens";
</code></pre>
      </li>
      <li class="numberedList">To get the value of a constant field, you must write the name of the class, not the name of an instance of the class. In <code class="inlineCode">Program.cs</code>, add a statement to write Bob’s name and species to the console, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">// Constant fields are accessible via the type.
WriteLine($"{bob.Name} is a {Person.Species}.");
</code></pre>
      </li>
      <li class="numberedList">Run the <code class="inlineCode">PeopleApp</code> project and view the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">Bob Smith is a Homo Sapiens.
</code></pre>
      </li>
    </ol>
    <p class="normal-one">Examples of <code class="inlineCode">const</code> fields in Microsoft types include <code class="inlineCode">System.Int32.MaxValue</code> and <code class="inlineCode">System.Math.PI</code> because neither value will ever change, as you can see in <em class="italic">Figure 5.2</em>:</p>
    <figure class="mediaobject"><img src="img/B22322_05_02.png" alt="" width="812" height="289"/></figure>
    <p class="packt_figref">Figure 5.2: Examples of constants in the System.Math class</p>
    <div><p class="normal"><strong class="keyWord">Good practice</strong>: Constants are not always the best choice for two important reasons: the value must be known at compile time, and it must be expressible as a literal <code class="inlineCode">string</code>, <code class="inlineCode">Boolean</code>, or number value. Every reference to the <code class="inlineCode">const</code> field is replaced with the literal value at compile time, which will, therefore, not be reflected if the value changes in a future version and you do not recompile any assemblies that reference it to get the new value.</p>
    </div>
    <h2 id="_idParaDest-324" class="heading-2">Making a field read-only</h2>
    <p class="normal">Often, a better<a id="_idIndexMarker708"/> choice for fields that should not change is to mark them as read-only:</p>
    <ol>
      <li class="numberedList" value="1">In <code class="inlineCode">Person.cs</code>, add a statement to declare an instance read-only field to store a person’s home planet, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">// Read-only fields: Values that can be set at runtime.
public readonly string HomePlanet = "Earth";
</code></pre>
      </li>
      <li class="numberedList">In <code class="inlineCode">Program.cs</code>, add a statement to write Bob’s name and home planet to the console, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">// Read-only fields are accessible via the variable.
WriteLine($"{bob.Name} was born on {bob.HomePlanet}.");
</code></pre>
      </li>
      <li class="numberedList">Run the <code class="inlineCode">PeopleApp</code> project and view the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">Bob Smith was born on Earth.
</code></pre>
      </li>
    </ol>
    <div><p class="normal"><strong class="keyWord">Good practice</strong>: Use read-only fields over constant fields for two important reasons: the value can be calculated or loaded at runtime and can be expressed using any executable statement. So, a read-only field can be set using a constructor or a field assignment. Every reference to the read-only field is a live reference, so any future changes will be correctly reflected by the calling code.</p>
    </div>
    <p class="normal">You can also <a id="_idIndexMarker709"/>declare <code class="inlineCode">static</code> <code class="inlineCode">readonly</code> fields whose values will be shared across all instances of the type.</p>
    <h2 id="_idParaDest-325" class="heading-2">Requiring fields to be set during instantiation</h2>
    <p class="normal">C# 11 introduced the <code class="inlineCode">required</code> modifier. If you use it on a field or property, the compiler will<a id="_idIndexMarker710"/> ensure that you set the field or property to a value when you instantiate it. It requires targeting .NET 7 or later, so we need to create a new class library first:</p>
    <ol>
      <li class="numberedList" value="1">In the <code class="inlineCode">Chapter05</code> solution, add a new class library project named <code class="inlineCode">PacktLibraryModern</code> that targets .NET 9. (The oldest supported version for the <code class="inlineCode">required</code> modifier is .NET 7.)</li>
      <li class="numberedList">In the <code class="inlineCode">PacktLibraryModern</code> project, rename <code class="inlineCode">Class1.cs</code> to <code class="inlineCode">Book.cs</code>.</li>
      <li class="numberedList">Modify the code file contents to give the class four fields, with two set as <code class="inlineCode">required</code>, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">namespace Packt.Shared;
public class Book
{
  // Needs .NET 7 or later as well as C# 11 or later.
  public required string? Isbn;
  public required string? Title;
  // Works with any version of .NET.
  public string? Author;
  public int PageCount;
}
</code></pre>
      </li>
    </ol>
    <div><p class="normal">Note that all <code class="inlineCode">three</code> string properties are nullable. Setting a property or field to be <code class="inlineCode">required</code> does not mean that it cannot be <code class="inlineCode">null</code>. It just means that it must be explicitly set to <code class="inlineCode">null</code>.</p>
    </div>
    <ol>
      <li class="numberedList" value="4">In<a id="_idIndexMarker711"/> the <code class="inlineCode">PeopleApp</code> console app project, add a reference to the <code class="inlineCode">PacktLibraryModern</code> class library project:<ul>
          <li class="bulletList level-2">If you use Visual Studio, then in <strong class="screenText">Solution Explorer</strong>, select the <code class="inlineCode">PeopleApp</code> project, navigate to <strong class="screenText">Project</strong> | <strong class="screenText">Add Project Reference…</strong>, check the box to select the <code class="inlineCode">PacktLibraryModern</code> project, and then click <strong class="screenText">OK</strong>.</li>
          <li class="bulletList level-2">If you use VS Code, then edit <code class="inlineCode">PeopleApp.csproj</code> to add a project reference to <code class="inlineCode">PacktLibraryModern</code>, as highlighted in the following markup:
            <pre class="programlisting code"><code class="hljs-code">&lt;ItemGroup&gt;
  &lt;ProjectReference Include=
"..\PacktLibraryNet2\PacktLibraryNet2.csproj" /&gt;
<strong class="hljs-slc">  &lt;ProjectReference Include=</strong>
<strong class="hljs-slc">    </strong><strong class="hljs-string-slc">"..\PacktLibraryModern\PacktLibraryModern.csproj"</strong><strong class="hljs-slc"> /&gt;</strong>
&lt;/ItemGroup&gt;
</code></pre>
          </li>
        </ul>
      </li>
      <li class="numberedList">Build the <code class="inlineCode">PeopleApp</code> project. This will compile its referenced dependencies and copy the class library <code class="inlineCode">.dll</code> to the correct subdirectory in the local <code class="inlineCode">bin</code> folder.</li>
      <li class="numberedList">In the <code class="inlineCode">PeopleApp</code> project, in <code class="inlineCode">Program.cs</code>, attempt to instantiate a <code class="inlineCode">Book</code> without setting the <code class="inlineCode">Isbn</code> and <code class="inlineCode">Title</code> fields, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">Book book = new();
</code></pre>
      </li>
      <li class="numberedList">Note<a id="_idIndexMarker712"/> that you will see a compiler error, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">C:\cs13net9\Chapter05\PeopleApp\Program.cs(137,13): error CS9035: Required member 'Book.Isbn' must be set in the object initializer or attribute constructor. [C:\cs13net9\Chapter05\PeopleApp\PeopleApp.csproj]
C:\cs13net9\Chapter05\PeopleApp\Program.cs(137,13): error CS9035: Required member 'Book.Title' must be set in the object initializer or attribute constructor. [C:\cs13net9\Chapter05\PeopleApp\PeopleApp.csproj]
    0 Warning(s)
    2 Error(s)
</code></pre>
      </li>
      <li class="numberedList">In <code class="inlineCode">Program.cs</code>, modify the statement to set the two required properties using object initialization syntax, as highlighted in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">Book book = new()
<strong class="hljs-slc">{</strong>
<strong class="hljs-slc">  Isbn = </strong><strong class="hljs-string-slc">"978-1803237800"</strong><strong class="hljs-slc">,</strong>
<strong class="hljs-slc">  Title = </strong><strong class="hljs-string-slc">"C# 12 and .NET 8 - Modern Cross-Platform Development Fundamentals"</strong>
<strong class="hljs-slc">}</strong>;
</code></pre>
      </li>
      <li class="numberedList">Note that the statement now compiles without errors.</li>
      <li class="numberedList">In <code class="inlineCode">Program.cs</code>, add a statement to output information about the book, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">WriteLine("{0}: {1} written by {2} has {3:N0} pages.",
  book.Isbn, book.Title, book.Author, book.PageCount);
</code></pre>
      </li>
    </ol>
    <p class="normal">Before we run the project and view the output, let’s talk about an alternative way that we could initialize fields (or properties) for a type.</p>
    <h2 id="_idParaDest-326" class="heading-2">Initializing fields with constructors</h2>
    <p class="normal">Fields <a id="_idIndexMarker713"/>often need to be initialized at runtime. You can do this in a constructor that will be called when you make an instance of a class using the <code class="inlineCode">new</code> keyword. Constructors execute before any fields are set by the code that uses the type:</p>
    <ol>
      <li class="numberedList" value="1">In <code class="inlineCode">Person.cs</code>, add statements after the existing read-only <code class="inlineCode">HomePlanet</code> field to define a second read-only field, and then set the <code class="inlineCode">Name</code> and <code class="inlineCode">Instantiated</code> fields in a constructor, as highlighted in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">// Read-only fields: Values that can be set at runtime.
public readonly string HomePlanet = "Earth";
<strong class="hljs-keyword-slc">public</strong><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc">readonly</strong><strong class="hljs-slc"> DateTime Instantiated;</strong>
#endregion
<strong class="hljs-meta-slc">#</strong><strong class="hljs-keyword-slc">region</strong><strong class="hljs-meta-slc"> Constructors: Called when using new to instantiate a type.</strong>
<strong class="hljs-keyword-slc">public</strong><strong class="hljs-function-slc"> </strong><strong class="hljs-title-slc">Person</strong><strong class="hljs-function-slc">()</strong>
<strong class="hljs-slc">{</strong>
<strong class="hljs-slc">  </strong><strong class="hljs-comment-slc">// Constructors can set default values for fields</strong>
<strong class="hljs-slc">  </strong><strong class="hljs-comment-slc">// including any read-only fields like Instantiated.</strong>
<strong class="hljs-slc">  Name = </strong><strong class="hljs-string-slc">"Unknown"</strong><strong class="hljs-slc">;</strong>
<strong class="hljs-slc">  Instantiated = DateTime.Now;</strong>
<strong class="hljs-slc">}</strong>
<strong class="hljs-meta-slc">#</strong><strong class="hljs-keyword-slc">endregion</strong>
</code></pre>
      </li>
      <li class="numberedList">In <code class="inlineCode">Program.cs</code>, add statements to instantiate a new person and then output its initial field values, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">Person blankPerson = new();
WriteLine(format:
  "{0} of {1} was created at {2:hh:mm:ss} on a {2:dddd}.",
  arg0: blankPerson.Name,
  arg1: blankPerson.HomePlanet,
  arg2: blankPerson.Instantiated);
</code></pre>
      </li>
      <li class="numberedList">Run <a id="_idIndexMarker714"/>the <code class="inlineCode">PeopleApp</code> project and view the result from both the code about the book as well as the blank person, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">978-1803237800: C# 12 and .NET 8 - Modern Cross-Platform Development Fundamentals written by  has 0 pages.
Unknown of Earth was created at 11:58:12 on a Sunday
</code></pre>
      </li>
    </ol>
    <h2 id="_idParaDest-327" class="heading-2">Defining multiple constructors</h2>
    <p class="normal">You<a id="_idIndexMarker715"/> can have multiple constructors in a type. This is especially useful to encourage developers to set initial values for fields:</p>
    <ol>
      <li class="numberedList" value="1">In <code class="inlineCode">Person.cs</code>, add statements to define a second constructor that allows a developer to set initial values for the person’s name and home planet, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">public Person(string initialName, string homePlanet)
{
  Name = initialName;
  HomePlanet = homePlanet;
  Instantiated = DateTime.Now;
}
</code></pre>
      </li>
      <li class="numberedList">In <code class="inlineCode">Program.cs</code>, add statements to create another person using the constructor with two parameters, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">Person gunny = new(initialName: "Gunny", homePlanet: "Mars");
WriteLine(format:
  "{0} of {1} was created at {2:hh:mm:ss} on a {2:dddd}.",
  arg0: gunny.Name,
  arg1: gunny.HomePlanet,
  arg2: gunny.Instantiated);
</code></pre>
      </li>
      <li class="numberedList">Run the <code class="inlineCode">PeopleApp</code> project and view the result:
        <pre class="programlisting con-one"><code class="hljs-con">Gunny of Mars was created at 11:59:25 on a Sunday
</code></pre>
      </li>
    </ol>
    <h2 id="_idParaDest-328" class="heading-2">Setting required fields with a constructor</h2>
    <p class="normal">Now, let’s<a id="_idIndexMarker716"/> return to the <code class="inlineCode">Book</code> class example with its <code class="inlineCode">required</code> fields:</p>
    <ol>
      <li class="numberedList" value="1">In the <code class="inlineCode">PacktLibraryModern</code> project, in <code class="inlineCode">Book.cs</code>, add statements to define a pair of constructors, one that supports object initializer syntax and one to set the two required properties, as highlighted in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">public class Book
{
<strong class="hljs-slc">  </strong><strong class="hljs-comment-slc">// Constructor for use with object initializer syntax.</strong>
<strong class="hljs-slc">  </strong><strong class="hljs-keyword-slc">public</strong><strong class="hljs-function-slc"> </strong><strong class="hljs-title-slc">Book</strong><strong class="hljs-function-slc">()</strong><strong class="hljs-slc"> { }</strong>
<strong class="hljs-slc">  </strong><strong class="hljs-comment-slc">// Constructor with parameters to set required fields.</strong>
<strong class="hljs-slc">  </strong><strong class="hljs-keyword-slc">public</strong><strong class="hljs-function-slc"> </strong><strong class="hljs-title-slc">Book</strong><strong class="hljs-function-slc">(</strong><strong class="hljs-built_in-slc">string</strong><strong class="hljs-params-slc">? isbn, </strong><strong class="hljs-built_in-slc">string</strong><strong class="hljs-params-slc">? title</strong><strong class="hljs-function-slc">)</strong>
<strong class="hljs-slc">  {</strong>
<strong class="hljs-slc">    Isbn = isbn;</strong>
<strong class="hljs-slc">    Title = title;</strong>
<strong class="hljs-slc">  }</strong>
</code></pre>
      </li>
      <li class="numberedList">In <code class="inlineCode">Program.cs</code>, comment out the statement that instantiates a book using object initializer syntax, add a statement to instantiate a book using the constructor, and then set the non-<code class="inlineCode">required</code> properties for the book, as highlighted in the following code:
        <pre class="programlisting code-one"><code class="hljs-code"><strong class="hljs-comment-slc">/*</strong>
<strong class="hljs-comment-slc">// Instantiate a book using object initializer syntax.</strong>
Book book = new()
{
  Isbn = "978-1803237800",
  Title = "C# 12 and .NET 8 - Modern Cross-Platform Development Fundamentals"
};
<strong class="hljs-comment-slc">*/</strong>
<strong class="hljs-slc">Book book = </strong><strong class="hljs-keyword-slc">new</strong><strong class="hljs-slc">(isbn: </strong><strong class="hljs-string-slc">"978-1803237800"</strong><strong class="hljs-slc">, title:</strong>
<strong class="hljs-slc">  </strong><strong class="hljs-string-slc">"C# 12 and .NET 8 - Modern Cross-Platform Development Fundamentals"</strong><strong class="hljs-slc">)</strong>
<strong class="hljs-slc">{</strong>
<strong class="hljs-slc">  Author = </strong><strong class="hljs-string-slc">"Mark J. Price"</strong><strong class="hljs-slc">,</strong>
<strong class="hljs-slc">  PageCount = </strong><strong class="hljs-number-slc">821</strong>
<strong class="hljs-slc">};</strong>
</code></pre>
      </li>
      <li class="numberedList">Note<a id="_idIndexMarker717"/> that you will see a compiler error as before because the compiler cannot automatically tell that calling the constructor will have set the two <code class="inlineCode">required</code> properties.</li>
      <li class="numberedList">In the <code class="inlineCode">PacktLibraryModern</code> project, in <code class="inlineCode">Book.cs</code>, import the namespace to perform code analysis and then decorate the constructor with the attribute to tell the compiler that it sets all the required properties and fields, as highlighted in the following code:
        <pre class="programlisting code-one"><code class="hljs-code"><strong class="hljs-keyword-slc">using</strong><strong class="hljs-slc"> System.Diagnostics.CodeAnalysis; </strong><strong class="hljs-comment-slc">// To use [SetsRequiredMembers].</strong>
namespace Packt.Shared;
public class Book
{
  public Book() { } // For use with initialization syntax.
<strong class="hljs-slc">  [</strong><strong class="hljs-meta-slc">SetsRequiredMembers</strong><strong class="hljs-slc">]</strong>
  public Book(string isbn, string title)
</code></pre>
      </li>
      <li class="numberedList">In <code class="inlineCode">Program.cs</code>, note the statement that calls the constructor now compiles without errors.</li>
      <li class="numberedList">Optionally, run the <code class="inlineCode">PeopleApp</code> project to confirm it behaves as expected, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">978-1803237800: C# 12 and .NET 8 - Modern Cross-Platform Development Fundamentals written by Mark J. Price has 821 pages.
</code></pre>
      </li>
    </ol>
    <div><p class="normal"><strong class="keyWord">More information</strong>: You can learn more about <code class="inlineCode">required</code> fields and how to set them using a constructor at the following link: <a href="https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/required">https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/required</a>.</p>
    </div>
    <p class="normal">Constructors <a id="_idIndexMarker718"/>are a special category of method. Let’s look at methods in more detail.</p>
    <h1 id="_idParaDest-329" class="heading-1">Working with methods and tuples</h1>
    <p class="normal"><strong class="keyWord">Methods</strong> are <a id="_idIndexMarker719"/>members of a type that execute a block of statements. They are functions that belong to a type.</p>
    <h2 id="_idParaDest-330" class="heading-2">Returning values from methods</h2>
    <p class="normal">Methods can <a id="_idIndexMarker720"/>return a single value or nothing:</p>
    <ul>
      <li class="bulletList">A method that performs some actions but does not return a value indicates this with the <code class="inlineCode">void</code> type before the name of the method.</li>
      <li class="bulletList">A method that performs some actions and returns a value indicates this with the type of the return value before the name of the method.</li>
    </ul>
    <p class="normal">For example, in the next task, you will create two methods:</p>
    <ul>
      <li class="bulletList"><code class="inlineCode">WriteToConsole</code>: This will perform an action (writing some text to the console), but it will return nothing from the method, indicated by the <code class="inlineCode">void</code> keyword.</li>
      <li class="bulletList"><code class="inlineCode">GetOrigin</code>: This will return a text value, indicated by the <code class="inlineCode">string</code> keyword.</li>
    </ul>
    <p class="normal">Let’s write the code:</p>
    <ol>
      <li class="numberedList" value="1">In <code class="inlineCode">Person.cs</code>, add statements to define the two methods that I described earlier, as shown<a id="_idIndexMarker721"/> in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">#region Methods: Actions the type can perform.
public void WriteToConsole()
{
  WriteLine($"{Name} was born on a {Born:dddd}.");
}
public string GetOrigin()
{
  return $"{Name} was born on {HomePlanet}.";
}
#endregion
</code></pre>
      </li>
      <li class="numberedList">In <code class="inlineCode">Program.cs</code>, add statements to call the two methods, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">bob.WriteToConsole();
WriteLine(bob.GetOrigin());
</code></pre>
      </li>
      <li class="numberedList">Run the <code class="inlineCode">PeopleApp</code> project and view the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">Bob Smith was born on a Wednesday.
Bob Smith was born on Earth.
</code></pre>
      </li>
    </ol>
    <h2 id="_idParaDest-331" class="heading-2">Defining and passing parameters to methods</h2>
    <p class="normal">Methods can have <a id="_idIndexMarker722"/>parameters passed to them to change their behavior. Parameters are defined a bit like variable declarations<a id="_idIndexMarker723"/> but inside the parentheses of the method declaration, as you saw earlier in this chapter with constructors. Let’s see more examples:</p>
    <ol>
      <li class="numberedList" value="1">In <code class="inlineCode">Person.cs</code>, add statements to define two methods, the first without parameters and the second with one parameter, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">public string SayHello()
{
  return $"{Name} says 'Hello!'";
}
public string SayHelloTo(string name)
{
  return $"{Name} says 'Hello, {name}!'";
}
</code></pre>
      </li>
      <li class="numberedList">In <code class="inlineCode">Program.cs</code>, add <a id="_idIndexMarker724"/>statements to call the two methods, and write the return value to the console, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">WriteLine(bob.SayHello());
WriteLine(bob.SayHelloTo("Emily"));
</code></pre>
      </li>
      <li class="numberedList">Run the <code class="inlineCode">PeopleApp</code> project and view the result:
        <pre class="programlisting con-one"><code class="hljs-con">Bob Smith says 'Hello!'
Bob Smith says 'Hello, Emily!'
</code></pre>
      </li>
    </ol>
    <p class="normal">When typing a statement that calls a method, IntelliSense shows a tooltip with the name, the type of any parameters, and the return type of the method.</p>
    <h2 id="_idParaDest-332" class="heading-2">Overloading methods</h2>
    <p class="normal">Instead of <a id="_idIndexMarker725"/>having two different method names, we could give both methods the same name. This is allowed because the methods each have a different signature.</p>
    <p class="normal">A <strong class="keyWord">method signature</strong> is a <a id="_idIndexMarker726"/>list of parameter types that can be passed when calling the method. Overloaded methods must differ in their list of parameter types. Two overloaded methods cannot have the same list of parameter types and differ only in <a id="_idIndexMarker727"/>their return types. Let’s code an example:</p>
    <ol>
      <li class="numberedList" value="1">In <code class="inlineCode">Person.cs</code>, change the name of the <code class="inlineCode">SayHelloTo</code> method to <code class="inlineCode">SayHello</code>.</li>
      <li class="numberedList">In <code class="inlineCode">Program.cs</code>, change the method call to use the <code class="inlineCode">SayHello</code> method, and note that the quick info for the method tells you that it has an additional overload, <strong class="screenText">1 of 2</strong>, as well as <strong class="screenText">2 of 2</strong>, in Visual Studio, although other code editors may be different, as shown in <em class="italic">Figure 5.3</em>:</li>
    </ol>
    <figure class="mediaobject"><img src="img/B22322_05_03.png" alt="" width="812" height="224"/></figure>
    <p class="packt_figref">Figure 5.3: An IntelliSense tooltip for an overloaded method</p>
    <div><p class="normal"><strong class="keyWord">Good practice</strong>: Use overloaded methods to simplify your class by making it appear to have fewer methods.</p>
    </div>
    <h2 id="_idParaDest-333" class="heading-2">Passing optional parameters</h2>
    <p class="normal">Another<a id="_idIndexMarker728"/> way to simplify methods is to make parameters optional. You make a parameter optional by assigning a default value inside the method parameter list. Optional parameters must always come last in the list of parameters.</p>
    <p class="normal">We will now create a method with three optional parameters:</p>
    <ol>
      <li class="numberedList" value="1">In <code class="inlineCode">Person.cs</code>, add statements to define the method, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">public string OptionalParameters(string command = "Run!",
  double number = 0.0, bool active = true)
{
  return string.Format(
    format: "command is {0}, number is {1}, active is {2}",
    arg0: command,
    arg1: number,
    arg2: active);
}
</code></pre>
      </li>
      <li class="numberedList">In <code class="inlineCode">Program.cs</code>, add <a id="_idIndexMarker729"/>a statement to call the method and write its return value to the console, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">WriteLine(bob.OptionalParameters());
</code></pre>
      </li>
      <li class="numberedList">Watch IntelliSense appear as you type the code. You will see a tooltip showing the three optional parameters with their default values.</li>
      <li class="numberedList">Run the <code class="inlineCode">PeopleApp</code> project and view the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">command is Run!, number is 0, active is True
</code></pre>
      </li>
      <li class="numberedList">In <code class="inlineCode">Program.cs</code>, add a statement to pass a <code class="inlineCode">string</code> value for the <code class="inlineCode">command</code> parameter and a <code class="inlineCode">double</code> value for the <code class="inlineCode">number</code> parameter, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">WriteLine(bob.OptionalParameters("Jump!", 98.5));
</code></pre>
      </li>
      <li class="numberedList">Run the <code class="inlineCode">PeopleApp</code> project and see the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">command is Jump!, number is 98.5, active is True
</code></pre>
      </li>
    </ol>
    <p class="normal">The default values for the <code class="inlineCode">command</code> and <code class="inlineCode">number</code> parameters have been replaced, but the default for <code class="inlineCode">active</code> is still <code class="inlineCode">true</code>.</p>
    <h2 id="_idParaDest-334" class="heading-2">Naming parameter values when calling methods</h2>
    <p class="normal">Optional parameters<a id="_idIndexMarker730"/> are often combined with naming parameters when you call the method because naming a parameter allows the values to be passed in a different order than how they were declared:</p>
    <ol>
      <li class="numberedList" value="1">In <code class="inlineCode">Program.cs</code>, add a statement to pass a <code class="inlineCode">string</code> value for the <code class="inlineCode">command</code> parameter and a <code class="inlineCode">double</code> value for the <code class="inlineCode">number</code> parameter, but using named parameters, so that the order they are passed through can be swapped around, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">WriteLine(bob.OptionalParameters(number: 52.7, command: "Hide!"));
</code></pre>
      </li>
      <li class="numberedList">Run the <code class="inlineCode">PeopleApp</code> project and view the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">command is Hide!, number is 52.7, active is True
</code></pre>
      </li>
    </ol>
    <p class="normal-one">You can even use named parameters to skip over optional parameters.</p>
    <ol>
      <li class="numberedList" value="3">In <code class="inlineCode">Program.cs</code>, add a statement to pass a <code class="inlineCode">string</code> value for the <code class="inlineCode">command</code> parameter using positional order, skip the <code class="inlineCode">number</code> parameter, and use the named <code class="inlineCode">active</code> parameter, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">WriteLine(bob.OptionalParameters("Poke!", active: false));
</code></pre>
      </li>
      <li class="numberedList">Run the <code class="inlineCode">PeopleApp</code> project and view the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">command is Poke!, number is 0, active is False
</code></pre>
        <div><p class="normal"><strong class="keyWord">Good practice</strong>: Although you can mix named and positional parameter values, most developers prefer to read code that uses one or the other within the same method call.</p>
        </div>
      </li>
    </ol>
    <h2 id="_idParaDest-335" class="heading-2">Mixing optional and required parameters</h2>
    <p class="normal">At the <a id="_idIndexMarker731"/>moment, all the parameters in the <code class="inlineCode">OptionalParameters</code> method are optional. What if one of them is required?</p>
    <ol>
      <li class="numberedList" value="1">In <code class="inlineCode">Person.cs</code>, add a fourth parameter without a default value to the <code class="inlineCode">OptionalParameters</code> method, as highlighted in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">public string OptionalParameters(string command = "Run!",
  double number = 0.0, bool active = true<strong class="hljs-params-slc">, </strong><strong class="hljs-built_in-slc">int</strong><strong class="hljs-params-slc"> count</strong>)
</code></pre>
      </li>
      <li class="numberedList">Build the project and note the compiler error:
        <pre class="programlisting con-one"><code class="hljs-con">Error CS1737 Optional parameters must appear after all required parameters.
</code></pre>
      </li>
      <li class="numberedList">In the <code class="inlineCode">OptionalParameters</code> method, move the <code class="inlineCode">count</code> parameter before the optional parameters, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">public string OptionalParameters(<strong class="hljs-built_in-slc">int</strong><strong class="hljs-params-slc"> count,</strong>
  string command = "Run!",
  double number = 0.0, bool active = true)
</code></pre>
      </li>
      <li class="numberedList">In <code class="inlineCode">Program.cs</code>, modify all the calls to the <code class="inlineCode">OptionalParameters</code> method to pass an <code class="inlineCode">int</code> value as the first argument, for example, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">WriteLine(bob.OptionalParameters(3));
WriteLine(bob.OptionalParameters(3, "Jump!", 98.5));
WriteLine(bob.OptionalParameters(3, number: 52.7, command: "Hide!"));
WriteLine(bob.OptionalParameters(3, "Poke!", active: false));
</code></pre>
      </li>
    </ol>
    <div><p class="normal">Remember that if you name the arguments, then you can change their positions, for example: <code class="inlineCode">bob.OptionalParameters(number: 52.7, command: "Hide!", count: 3)</code>.</p>
    </div>
    <ol>
      <li class="numberedList" value="5">As you<a id="_idIndexMarker732"/> call the <code class="inlineCode">OptionalParameters</code> method, note the tooltip that shows the one required, three optional parameters, and their default values in Visual Studio, as shown in <em class="italic">Figure 5.4</em>:</li>
    </ol>
    <figure class="mediaobject"><img src="img/B22322_05_04.png" alt="" width="812" height="224"/></figure>
    <p class="packt_figref">Figure 5.4: IntelliSense showing the required and optional parameters as you type code</p>
    <h2 id="_idParaDest-336" class="heading-2">Controlling how parameters are passed</h2>
    <p class="normal">When a parameter is <a id="_idIndexMarker733"/>passed into a method, it can be passed in one of several ways:</p>
    <ul>
      <li class="bulletList">By <strong class="keyWord">value</strong> (this is the default): Think of these as being <em class="italic">in-only</em>. Although the value can be changed, this only affects the parameter in the method.</li>
      <li class="bulletList">As an <code class="inlineCode">out</code> parameter: Think of these as being <em class="italic">out-only</em>. <code class="inlineCode">out</code> parameters cannot have a default value assigned in their declaration and cannot be left uninitialized. They must be set inside the method; otherwise, the compiler will give an error.</li>
      <li class="bulletList">By <strong class="keyWord">reference</strong> as a <code class="inlineCode">ref</code> parameter: Think of these as being <em class="italic">in-and-out</em>. Like <code class="inlineCode">out</code> parameters, <code class="inlineCode">ref</code> parameters also cannot have default values, but since they can already be set outside the method, they do not need to be set inside the method.</li>
      <li class="bulletList">As an <code class="inlineCode">in</code> parameter: Think of these as being a reference parameter that is <em class="italic">read-only</em>. <code class="inlineCode">in</code> parameters cannot have their values changed and the compiler will show an error if you try.</li>
    </ul>
    <p class="normal">Let’s see some<a id="_idIndexMarker734"/> examples of passing parameters in and out of a method:</p>
    <ol>
      <li class="numberedList" value="1">In <code class="inlineCode">Person.cs</code>, add statements to define a method with three parameters, one <code class="inlineCode">in</code> parameter, one <code class="inlineCode">ref</code> parameter, and one <code class="inlineCode">out</code> parameter, as shown in the following method:
        <pre class="programlisting code-one"><code class="hljs-code">public void PassingParameters(int w, in int x, ref int y, out int z)
{
  // out parameters cannot have a default and they
  // must be initialized inside the method.
  z = 100;
  // Increment each parameter except the read-only x.
  w++;
  // x++; // Gives a compiler error!
  y++;
  z++;
  WriteLine($"In the method: w={w}, x={x}, y={y}, z={z}");
}
</code></pre>
      </li>
      <li class="numberedList">In <code class="inlineCode">Program.cs</code>, add statements to declare some <code class="inlineCode">int</code> variables and pass them into the method, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">int a = 10;
int b = 20;
int c = 30;
int d = 40;
WriteLine($"Before: a={a}, b={b}, c={c}, d={d}");
bob.PassingParameters(a, b, ref c, out d);
WriteLine($"After: a={a}, b={b}, c={c}, d={d}");
</code></pre>
      </li>
      <li class="numberedList">Run <a id="_idIndexMarker735"/>the <code class="inlineCode">PeopleApp</code> project and view the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">Before: a=10, b=20, c=30, d=40
In the method: w=11, x=20, y=31, z=101
After: a=10, b=20, c=31, d=101
</code></pre>
      </li>
    </ol>
    <p class="normal-one">Note the following about the preceding output:</p>
    <ul>
      <li class="bulletList level-2">When passing a variable as a parameter by default, its current value gets passed, not the variable itself. Therefore, <code class="inlineCode">w</code> has a copy of the value of the <code class="inlineCode">a</code> variable. The <code class="inlineCode">a</code> variable retains its original value of <code class="inlineCode">10</code> even after <code class="inlineCode">w</code> is incremented to 11.</li>
      <li class="bulletList level-2">When passing a variable as an <code class="inlineCode">in</code> parameter, a reference to the variable gets passed into the method. Therefore, <code class="inlineCode">x</code> is a reference to <code class="inlineCode">b</code>. If the <code class="inlineCode">b</code> variable gets incremented by some other process while the method is executing, then the <code class="inlineCode">x</code> parameter would show that.</li>
      <li class="bulletList level-2">When passing a variable as a <code class="inlineCode">ref</code> parameter, a reference to the variable gets passed into the method. Therefore, <code class="inlineCode">y</code> is a reference to <code class="inlineCode">c</code>. The <code class="inlineCode">c</code> variable gets incremented when the <code class="inlineCode">y</code> parameter gets incremented.</li>
      <li class="bulletList level-2">When passing a variable as an <code class="inlineCode">out</code> parameter, a reference to the variable gets passed into the method. Therefore, <code class="inlineCode">z</code> is a reference to <code class="inlineCode">d</code>. The value of the <code class="inlineCode">d</code> variable gets replaced by whatever code executes inside the method.</li>
    </ul>
    <p class="normal-one">We could simplify the code in the <code class="inlineCode">Main</code> method by not assigning the value <code class="inlineCode">40</code> to the <code class="inlineCode">d</code> variable since it will always be replaced anyway. In C# 7 and later, we can simplify code that uses the <code class="inlineCode">out</code> parameter.</p>
    <ol>
      <li class="numberedList" value="4">In <code class="inlineCode">Program.cs</code>, add statements to declare some more variables, including an <code class="inlineCode">out</code> parameter <a id="_idIndexMarker736"/>named <code class="inlineCode">h</code> declared inline, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">int e = 50;
int f = 60;
int g = 70;
WriteLine($"Before: e={e}, f={f}, g={g}, h doesn't exist yet!");
// Simplified C# 7 or later syntax for the out parameter.
bob.PassingParameters(e, f, ref g, out int h);
WriteLine($"After: e={e}, f={f}, g={g}, h={h}");
</code></pre>
      </li>
      <li class="numberedList">Run the <code class="inlineCode">PeopleApp</code> project and view the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">Before: e=50, f=60, g=70, h doesn't exist yet!
In the method: w=51, x=60, y=71, z=101
After: e=50, f=60, g=71, h=101
</code></pre>
      </li>
    </ol>
    <h2 id="_idParaDest-337" class="heading-2">Passing a variable number of parameters</h2>
    <p class="normal">The <code class="inlineCode">params</code> keyword<a id="_idIndexMarker737"/> in C# is used to specify a method parameter that takes a variable number of arguments. It allows you to pass an array of arguments to a method, or to pass a list of arguments that the compiler will automatically convert to an array.</p>
    <p class="normal">With C# 13 and later, as well as passing an array, you can pass any type that can be constructed via a collection expression, for example, a <code class="inlineCode">List&lt;T&gt;</code> or <code class="inlineCode">IEnumerable&lt;T&gt;</code>. Collection expressions are covered in detail in <em class="chapterRef">Chapter 8, Working with Common .NET Types</em>, but basically, you can define a collection of items by surrounding a comma-separated list of items in square brackets <code class="inlineCode">[ ]</code>.</p>
    <p class="normal">The benefits of using <code class="inlineCode">params</code> include flexibility. It allows methods to accept any number of arguments and is easy to use because it simplifies the method signature by avoiding the need to explicitly create an array before calling the method.</p>
    <p class="normal">There are some considerations when using the <code class="inlineCode">params</code> keyword:</p>
    <ul>
      <li class="bulletList">The <code class="inlineCode">params</code> keyword can only be used for one parameter in a method, and it must be the last parameter if the method has more than one.</li>
      <li class="bulletList">You can pass individual arguments, and the compiler will automatically package them into an array. Alternatively, you can pass an array or collection expression.</li>
      <li class="bulletList">When using <code class="inlineCode">params</code>, you can call the method without passing any arguments for that parameter, and an empty array will be passed.</li>
    </ul>
    <p class="normal">Let’s see some<a id="_idIndexMarker738"/> code examples:</p>
    <ol>
      <li class="numberedList" value="1">In <code class="inlineCode">Person.cs</code>, add statements to define a method with two parameters, one normal parameter and one <code class="inlineCode">params</code> parameter, as shown in the following method:
        <pre class="programlisting code-one"><code class="hljs-code">public void ParamsParameters(
  string text, params int[] numbers)
{
  int total = 0;
  foreach(int number in numbers)
  {
    total += number;
  }
  WriteLine($"{text}: {total}");
}
</code></pre>
        <div><p class="normal">With C# 12 and earlier, <code class="inlineCode">params int[]</code> must be an array, although the items can by any data type, not just <code class="inlineCode">int</code>. With C# 13 and later, <code class="inlineCode">params int[]</code> could be any data type supported by collection expressions, like <code class="inlineCode">params List&lt;int&gt;</code> or <code class="inlineCode">IEnumerable&lt;int&gt;</code>, although the items can by any data type, not just <code class="inlineCode">int</code>.</p>
        </div>
      </li>
    </ol>
    <ol>
      <li class="numberedList" value="2">In <code class="inlineCode">Program.cs</code>, add statements to pass a string and some numbers into the method in various ways, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">bob.ParamsParameters("Sum using commas",
  3, 6, 1, 2);
bob.ParamsParameters("Sum using collection expression",
  [3, 6, 1, 2]);
bob.ParamsParameters("Sum using explicit array",
  new int[] { 3, 6, 1, 2 });
bob.ParamsParameters("Sum (empty)");
</code></pre>
      </li>
      <li class="numberedList">Run<a id="_idIndexMarker739"/> the <code class="inlineCode">PeopleApp</code> project and view the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">Sum using commas: 12
Sum using collection expression: 12
Sum using explicit array: 12
Sum (empty): 0
</code></pre>
      </li>
    </ol>
    <p class="normal">The <code class="inlineCode">params</code> keyword is a powerful feature in C# that enhances the flexibility and readability of your code by allowing methods to accept a variable number of arguments.</p>
    <h2 id="_idParaDest-338" class="heading-2">Understanding ref returns</h2>
    <p class="normal">In C# 7 or later, the <code class="inlineCode">ref</code> keyword <a id="_idIndexMarker740"/>is not just for passing parameters into a method; it can also be applied to the <code class="inlineCode">return</code> value. This allows an external variable to reference an internal variable and modify its value after the method call. This might be useful in advanced scenarios, for example, passing placeholders into big data structures, but it’s beyond the scope of this book. If you are interested in learning more, then you can read the information at the following link: <a href="https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/ref#reference-return-values">https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/ref#reference-return-values</a>.</p>
    <p class="normal">Now, let’s return to looking at more advanced scenarios of methods that return values.</p>
    <h2 id="_idParaDest-339" class="heading-2">Combining multiple returned values using tuples</h2>
    <p class="normal">Each<a id="_idIndexMarker741"/> method can only return a single value that has a single type. That type could be a simple type, such as <code class="inlineCode">string</code> in the previous example; a complex type, such as <code class="inlineCode">Person</code>; or a collection type, such as <code class="inlineCode">List&lt;Person&gt;</code>.</p>
    <p class="normal">Imagine that we want to define a method named <code class="inlineCode">GetTheData</code> that needs to return both a <code class="inlineCode">string</code> value and an <code class="inlineCode">int</code> value. We could define a new class named <code class="inlineCode">TextAndNumber</code> with a <code class="inlineCode">string</code> field and an <code class="inlineCode">int</code> field, and return an instance of that complex type, as shown in the following code:</p>
    <pre class="programlisting code"><code class="hljs-code">public class TextAndNumber
{
  public string Text;
  public int Number;
}
public class LifeTheUniverseAndEverything
{
  public TextAndNumber GetTheData()
  {
    return new TextAndNumber
    {
      Text = "What's the meaning of life?",
      Number = 42
    };
  }
}
</code></pre>
    <p class="normal">But defining a class just to combine two values is unnecessary because, in modern versions of C#, we can use <strong class="keyWord">tuples</strong>. Tuples are an efficient way to combine two or more <a id="_idIndexMarker742"/>values into a single unit. I pronounce them as <em class="italic">tuh-ples</em> but I have heard other developers pronounce them as <em class="italic">too-ples</em>. To-may-toe, to-mah-toe, po-tay-toe, po-tah-toe, I guess.</p>
    <p class="normal">Tuples have been a part of some languages, such as F#, since their first version, but .NET only added support for them with .NET 4 in 2010, using the <code class="inlineCode">System.Tuple</code> type.</p>
    <p class="normal">It was only <a id="_idIndexMarker743"/>with C# 7 in 2017 that C# added language syntax support for tuples using the parentheses characters <code class="inlineCode">()</code>, and at the same time, .NET added a new <code class="inlineCode">System.ValueTuple</code> type that is more efficient in some common scenarios than the old .NET 4 <code class="inlineCode">System.Tuple</code> type. The C# tuple syntax uses the more efficient one.</p>
    <p class="normal">Let’s explore tuples:</p>
    <ol>
      <li class="numberedList" value="1">In <code class="inlineCode">Person.cs</code>, add statements to define a method that returns a tuple combining a <code class="inlineCode">string</code> and <code class="inlineCode">int</code>, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">// Method that returns a tuple: (string, int).
public (string, int) GetFruit()
{
  return ("Apples", 5);
}
</code></pre>
      </li>
      <li class="numberedList">In <code class="inlineCode">Program.cs</code>, add statements to call the <code class="inlineCode">GetFruit</code> method, and then output the tuple’s fields, which are automatically named <code class="inlineCode">Item1</code> and <code class="inlineCode">Item2</code>, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">(string, int) fruit = bob.GetFruit();
WriteLine($"{fruit.Item1}, {fruit.Item2} there are.");
</code></pre>
      </li>
      <li class="numberedList">Run the <code class="inlineCode">PeopleApp</code> project and view the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">Apples, 5 there are.
</code></pre>
      </li>
    </ol>
    <h2 id="_idParaDest-340" class="heading-2">Naming the fields of a tuple</h2>
    <p class="normal">To access<a id="_idIndexMarker744"/> the fields of a tuple, the default names are <code class="inlineCode">Item1</code>, <code class="inlineCode">Item2</code>, and so on.</p>
    <p class="normal">You can explicitly specify the field names:</p>
    <ol>
      <li class="numberedList" value="1">In <code class="inlineCode">Person.cs</code>, add <a id="_idIndexMarker745"/>statements to define a method that returns a tuple with named fields, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">// Method that returns a tuple with named fields.
public (string Name, int Number) GetNamedFruit()
{
  return (Name: "Apples", Number: 5);
}
</code></pre>
      </li>
      <li class="numberedList">In <code class="inlineCode">Program.cs</code>, add statements to call the method and output the tuple’s named fields, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">var fruitNamed = bob.GetNamedFruit();
WriteLine($"There are {fruitNamed.Number} {fruitNamed.Name}.");
</code></pre>
      </li>
    </ol>
    <div><p class="normal">We use <code class="inlineCode">var</code> to shorten the following full syntax:</p>
      <pre class="programlisting code"><code class="hljs-code"><code class="inlineCode">(string Name, int Number) fruitNamed = bob.GetNamedFruit();</code>
</code></pre>
    </div>
    <ol>
      <li class="numberedList" value="3">Run the <code class="inlineCode">PeopleApp</code> project and view the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">There are 5 Apples.
</code></pre>
      </li>
    </ol>
    <div><p class="normal">If you construct a tuple from another object, you can use a feature introduced in C# 7.1 called <strong class="keyWord">tuple name inference</strong>.</p>
    </div>
    <ol>
      <li class="numberedList" value="4">In <code class="inlineCode">Program.cs</code>, create two tuples, each made of a <code class="inlineCode">string</code> and <code class="inlineCode">int</code> value, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">var thing1 = ("Neville", 4);
WriteLine($"{thing1.Item1} has {thing1.Item2} children.");
var thing2 = (bob.Name, bob.Children.Count);
WriteLine($"{thing2.Name} has {thing2.Count} children.");
</code></pre>
      </li>
    </ol>
    <p class="normal">In C# 7, both <a id="_idIndexMarker746"/>things would use the <code class="inlineCode">Item1</code> and <code class="inlineCode">Item2</code> naming schemes. In C# 7.1 and later, <code class="inlineCode">thing2</code> can infer the names <code class="inlineCode">Name</code> and <code class="inlineCode">Count</code>.</p>
    <h2 id="_idParaDest-341" class="heading-2">Aliasing tuples</h2>
    <p class="normal">The <a id="_idIndexMarker747"/>ability to alias a tuple was introduced in C# 12 so that you could name the type and use that as the type name when declaring variables and parameters, for example, as shown in the following code:</p>
    <pre class="programlisting code"><code class="hljs-code">using UnnamedParameters = (string, int); // Aliasing a tuple type.
// Aliasing a tuple type with parameter names.
using Fruit = (string Name, int Number);
</code></pre>
    <p class="normal">When aliasing tuples, use the title case naming convention for its parameters, for example, <code class="inlineCode">Name</code>, <code class="inlineCode">Number</code>, and <code class="inlineCode">BirthDate</code>.</p>
    <p class="normal">Let’s see an example:</p>
    <ol>
      <li class="numberedList" value="1">In <code class="inlineCode">Program.cs</code>, at the top of the file, define a named tuple type, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">using Fruit = (string Name, int Number); // Aliasing a tuple type.
</code></pre>
      </li>
      <li class="numberedList">In <code class="inlineCode">Program.cs</code>, copy and paste the statement that calls the <code class="inlineCode">GetNamedFruit</code> method and change <code class="inlineCode">var</code> to <code class="inlineCode">Fruit</code>, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">// Without an aliased tuple type.
//var fruitNamed = bob.GetNamedFruit();
// With an aliased tuple type.
Fruit fruitNamed = bob.GetNamedFruit();
</code></pre>
      </li>
      <li class="numberedList">Run<a id="_idIndexMarker748"/> the <code class="inlineCode">PeopleApp</code> project and note the result is the same.</li>
    </ol>
    <h2 id="_idParaDest-342" class="heading-2">Deconstructing tuples</h2>
    <p class="normal">You can<a id="_idIndexMarker749"/> also deconstruct tuples into separate variables. The deconstructing declaration has the same syntax as named field tuples but without a named variable for the tuple, as shown in the following code:</p>
    <pre class="programlisting code"><code class="hljs-code">// Store return value in a tuple variable with two named fields.
(string name, int number) namedFields = bob.GetNamedFruit();
// You can then access the named fields.
WriteLine($"{namedFields.name}, {namedFields.number}");
// Deconstruct the return value into two separate variables.
(string name, int number) = bob.GetNamedFruit();
// You can then access the separate variables.
WriteLine($"{name}, {number}");
</code></pre>
    <p class="normal">Deconstruction has the effect of splitting the tuple into its parts and assigning those parts to new variables. Let’s see it in action:</p>
    <ol>
      <li class="numberedList" value="1">In <code class="inlineCode">Program.cs</code>, add statements to deconstruct the tuple returned from the <code class="inlineCode">GetFruit</code> method, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">(string fruitName, int fruitNumber) = bob.GetFruit();
WriteLine($"Deconstructed tuple: {fruitName}, {fruitNumber}");
</code></pre>
      </li>
      <li class="numberedList">Run the <code class="inlineCode">PeopleApp</code> project and view the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">Deconstructed tuple: Apples, 5
</code></pre>
      </li>
    </ol>
    <h2 id="_idParaDest-343" class="heading-2">Deconstructing other types using tuples</h2>
    <p class="normal">Tuples are <a id="_idIndexMarker750"/>not the only type that can be deconstructed. Any type can have special methods, named <code class="inlineCode">Deconstruct</code>, that break down an object into parts. You can have as many <code class="inlineCode">Deconstruct</code> methods as you like as long as they have different signatures. Let’s implement some for the <code class="inlineCode">Person</code> class:</p>
    <ol>
      <li class="numberedList" value="1">In <code class="inlineCode">Person.cs</code>, add two <code class="inlineCode">Deconstruct</code> methods with <code class="inlineCode">out</code> parameters defined for the parts we want to deconstruct into, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">// Deconstructors: Break down this object into parts.
public void Deconstruct(out string? name,
  out DateTimeOffset dob)
{
  name = Name;
  dob = Born;
}
public void Deconstruct(out string? name,
  out DateTimeOffset dob,
  out WondersOfTheAncientWorld fav)
{
  name = Name;
  dob = Born;
  fav = FavoriteAncientWonder;
}
</code></pre>
      </li>
      <li class="numberedList">In <code class="inlineCode">Program.cs</code>, add statements to deconstruct <code class="inlineCode">bob</code>, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">var (name1, dob1) = bob; // Implicitly calls the Deconstruct method.
WriteLine($"Deconstructed person: {name1}, {dob1}");
var (name2, dob2, fav2) = bob;
WriteLine($"Deconstructed person: {name2}, {dob2}, {fav2}");
</code></pre>
      </li>
    </ol>
    <div><p class="normal">You do not explicitly call the <code class="inlineCode">Deconstruct</code> method. It is called implicitly when you assign an object to a tuple variable.</p>
    </div>
    <ol>
      <li class="numberedList" value="3">Run<a id="_idIndexMarker751"/> the <code class="inlineCode">PeopleApp</code> project and view the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">Deconstructed person: Bob Smith, 12/22/1965 4:28:00 PM -05:00
Deconstructed person: Bob Smith, 12/22/1965 4:28:00 PM -05:00,
StatueOfZeusAtOlympia
</code></pre>
      </li>
    </ol>
    <h2 id="_idParaDest-344" class="heading-2">Implementing functionality using local functions</h2>
    <p class="normal">A language feature<a id="_idIndexMarker752"/> introduced in C# 7 is the ability to define a <strong class="keyWord">local function</strong>.</p>
    <p class="normal">Local functions are the method equivalent of local variables. In other words, they are methods that are only accessible from within the containing method in which they have been<a id="_idIndexMarker753"/> defined. In other languages, they are sometimes <a id="_idIndexMarker754"/>called <strong class="keyWord">nested</strong> or <strong class="keyWord">inner functions</strong>.</p>
    <p class="normal">Local functions <a id="_idIndexMarker755"/>can be defined anywhere inside a method: the top, the bottom, or even somewhere in the middle!</p>
    <p class="normal">We will use a <a id="_idIndexMarker756"/>local function to implement a factorial calculation:</p>
    <ol>
      <li class="numberedList" value="1">In <code class="inlineCode">Person.cs</code>, add statements to define a <code class="inlineCode">Factorial</code> function that uses a local function inside itself to calculate the result, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">// Method with a local function.
public static int Factorial(int number)
{
  if (number &lt; 0)
  {
    throw new ArgumentException(
      $"{nameof(number)} cannot be less than zero.");
  }
  return localFactorial(number);
  int localFactorial(int localNumber) // Local function.
  {
    if (localNumber == 0) return 1;
    return localNumber * localFactorial(localNumber - 1);
  }
}
</code></pre>
      </li>
      <li class="numberedList">In <code class="inlineCode">Program.cs</code>, add<a id="_idIndexMarker757"/> statements to call the <code class="inlineCode">Factorial</code> function, and write the return value to the <a id="_idIndexMarker758"/>console, with exception handling, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">// Change to -1 to make the exception handling code execute.
int number = 5;
try
{
  WriteLine($"{number}! is {Person.Factorial(number)}");
}
catch (Exception ex)
{
  WriteLine($"{ex.GetType()} says: {ex.Message} number was {number}.");
}
</code></pre>
      </li>
      <li class="numberedList">Run the <code class="inlineCode">PeopleApp</code> project and view the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">5! is 120
</code></pre>
      </li>
      <li class="numberedList">Change the number to <code class="inlineCode">-1</code> so that we can check the exception handling.</li>
      <li class="numberedList">Run the <code class="inlineCode">PeopleApp</code> project and view the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">System.ArgumentException says: number cannot be less than zero. number was -1.
</code></pre>
      </li>
    </ol>
    <h2 id="_idParaDest-345" class="heading-2">Splitting classes using partial</h2>
    <p class="normal">When<a id="_idIndexMarker759"/> working on large projects with multiple team members, or when working with especially large and complex class implementations, it is useful to be able to split the definition of a class across multiple files. You do this using the <code class="inlineCode">partial</code> keyword.</p>
    <p class="normal">Imagine that we want to add statements to the <code class="inlineCode">Person</code> class that are automatically generated by a tool, like an object-relational mapper, that reads schema information from a database. If the class is defined as <code class="inlineCode">partial</code>, then we can split the class into an autogenerated code file and a manually edited code file.</p>
    <p class="normal">Let’s write some code that simulates this example:</p>
    <ol>
      <li class="numberedList" value="1">In <code class="inlineCode">Person.cs</code>, add the <code class="inlineCode">partial</code> keyword, as highlighted in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">public <strong class="hljs-keyword-slc">partial</strong> class Person
</code></pre>
      </li>
      <li class="numberedList">In the <code class="inlineCode">PacktLibraryNet2</code> project/folder, add a new class file named <code class="inlineCode">PersonAutoGen.cs</code>.</li>
      <li class="numberedList">Add statements to the new file, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">namespace Packt.Shared;
// This file simulates an auto-generated class.
public partial class Person
{
}
</code></pre>
      </li>
      <li class="numberedList">Build the <code class="inlineCode">PacktLibraryNet2</code> project. If you see the <code class="inlineCode">CS0260 Missing partial modifier on declaration of type 'Person'; another partial declaration of this type exists</code> error, then make sure you have applied the <code class="inlineCode">partial</code> keyword to both <code class="inlineCode">Person</code> classes.</li>
    </ol>
    <p class="normal">The rest of the<a id="_idIndexMarker760"/> code we write for this chapter will be written in the <code class="inlineCode">PersonAutoGen.cs</code> file.</p>
    <h2 id="_idParaDest-346" class="heading-2">Partial methods</h2>
    <p class="normal">Partial methods <a id="_idIndexMarker761"/>were introduced with C# 3 on .NET Framework in 2007. They are a feature that allows the definition of method signatures in one part of a <code class="inlineCode">partial</code> <code class="inlineCode">class</code> or <code class="inlineCode">struct</code>, with the actual implementation provided in another part. Partial methods are particularly useful in scenarios where code generation and manual code coexist, such as in code generated by tools like Entity Framework Core or a source code generator.</p>
    <p class="normal">There are some key <a id="_idIndexMarker762"/>characteristics of <code class="inlineCode">partial</code> methods, as shown in the following list:</p>
    <ul>
      <li class="bulletList">Partial methods are declared with the <code class="inlineCode">partial</code> keyword. The declaration provides the method signature, while the implementation provides the method body.</li>
      <li class="bulletList">The implementation of a partial method is optional. If a partial method is declared but not implemented, the compiler removes the call to the method and no error is thrown.</li>
      <li class="bulletList">Partial methods are implicitly private and cannot have access modifiers. They must also return <code class="inlineCode">void</code> and cannot have <code class="inlineCode">out</code> parameters.</li>
      <li class="bulletList">Partial methods cannot be <code class="inlineCode">virtual</code>.</li>
    </ul>
    <p class="normal">Partial methods are often used in scenarios involving code generation where a base structure is <a id="_idIndexMarker763"/>provided, and custom logic can be added without modifying the generated code.</p>
    <p class="normal">Imagine that you have a class file, as shown in the following code:</p>
    <pre class="programlisting code"><code class="hljs-code">// MyClass1.cs
public partial class MyClass
{
  // No method body in the declaration.
  partial void OnSomethingHappened();
  public void DoWork()
  {
    // Some work here.
    // Call the partial method.
    OnSomethingHappened();
  }
}
</code></pre>
    <p class="normal">Now, imagine that you have another class file, as shown in the following code:</p>
    <pre class="programlisting code"><code class="hljs-code">// MyClass2.cs
public partial class MyClass
{
  partial void OnSomethingHappened()
  {
    Console.WriteLine("Something happened.");
  }
}
</code></pre>
    <p class="normal">In the preceding examples, <code class="inlineCode">OnSomethingHappened</code> is a partial method declared in <code class="inlineCode">MyClass1.cs</code> and implemented in <code class="inlineCode">MyClass2.cs</code>. The method <code class="inlineCode">DoWork</code> calls the partial method, which prints a message if the implementation is provided.</p>
    <p class="normal">If in the example, <code class="inlineCode">OnSomethingHappened</code> is declared but not implemented, then the C# compiler will remove the call to <code class="inlineCode">OnSomethingHappened</code> in <code class="inlineCode">DoWork</code>, and no error will be thrown.</p>
    <p class="normal">Partial methods are often used in auto-generated code where developers can hook into the process without modifying the generated code. This would be the case if the <code class="inlineCode">MyClass1.cs</code> file was<a id="_idIndexMarker764"/> generated automatically.</p>
    <p class="normal">Partial methods in C# provide a powerful way to extend and customize generated code without modifying it directly. They offer a clean mechanism for inserting custom behavior, ensuring that code generation and custom logic can coexist. By leveraging partial methods, developers can maintain a clear separation between generated and custom code, enhancing maintainability and readability. Now that you’ve seen lots of examples of fields and methods, we will look at some specialized types of methods that can be used to access fields to provide control and improve the developer’s experience.</p>
    <h1 id="_idParaDest-347" class="heading-1">Controlling access with properties and indexers</h1>
    <p class="normal">Earlier, you created a method named <code class="inlineCode">GetOrigin</code> that returned a <code class="inlineCode">string</code> containing the name and origin of the person. Languages such as Java do this a lot. C# has a better way, and it is called properties.</p>
    <p class="normal">A <strong class="keyWord">property</strong> is <a id="_idIndexMarker765"/>simply a method (or a pair of methods) that acts and looks like a field when you want to get or set a value, but it acts like a method, thereby simplifying the syntax and enabling functionality, like validation and calculation, when you set and get a value.</p>
    <div><p class="normal">A fundamental difference between a field and a property is that a field provides a memory address to data. You could pass that memory address to an external component, like a Windows API C-style function call, and it could then modify the data. A property does not provide a memory address to its data, which provides more control. All you can do is ask the property to get or set the data. The property then executes statements and can decide how to respond, including refusing the request!</p>
    </div>
    <h2 id="_idParaDest-348" class="heading-2">Defining read-only properties</h2>
    <p class="normal">A <code class="inlineCode">readonly</code> property <a id="_idIndexMarker766"/>only has a <code class="inlineCode">get</code> implementation:</p>
    <ol>
      <li class="numberedList" value="1">In <code class="inlineCode">PersonAutoGen.cs</code>, in the <code class="inlineCode">Person</code> class, add <a id="_idIndexMarker767"/>statements to define three properties:<ul>
          <li class="bulletList level-2">The first property will perform the same role as the <code class="inlineCode">GetOrigin</code> method, using the property syntax that works with all versions of C#.</li>
          <li class="bulletList level-2">The second property will return a greeting message, using the lambda expression body <code class="inlineCode">=&gt;</code> syntax from C# 6 and later.</li>
          <li class="bulletList level-2">The third property will calculate the person’s age.</li>
        </ul>
      </li>
    </ol>
    <p class="normal-one">Here’s the code:</p>
    <pre class="programlisting code-one"><code class="hljs-code">#region Properties: Methods to get and/or set data or state.
// A readonly property defined using C# 1 to 5 syntax.
public string Origin
{
  get
  {
    return string.Format("{0} was born on {1}.",
      arg0: Name, arg1: HomePlanet);
  }
}
// Two readonly properties defined using C# 6 or later
// lambda expression body syntax.
public string Greeting =&gt; $"{Name} says 'Hello!'";
public int Age =&gt; DateTime.Today.Year - Born.Year;
#endregion
</code></pre>
    <div><p class="normal"><strong class="keyWord">Good practice</strong>: This isn’t the best way to calculate someone’s age, but we aren’t learning how to calculate an age from a date and time of birth. If you need to do that properly, then read the discussion at the following link: <a href="https://stackoverflow.com/questions/9/how-do-i-calculate-someones-age-in-c">https://stackoverflow.com/questions/9/how-do-i-calculate-someones-age-in-c</a>.</p>
    </div>
    <ol>
      <li class="numberedList" value="2">In <code class="inlineCode">Program.cs</code>, add<a id="_idIndexMarker768"/> the statements to <a id="_idIndexMarker769"/>get the properties, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">Person sam = new()
{
  Name = "Sam",
  Born = new(1969, 6, 25, 0, 0, 0, TimeSpan.Zero)
};
WriteLine(sam.Origin);
WriteLine(sam.Greeting);
WriteLine(sam.Age);
</code></pre>
      </li>
      <li class="numberedList">Run the <code class="inlineCode">PeopleApp</code> project and view the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">Sam was born on Earth
Sam says 'Hello!'
54
</code></pre>
      </li>
    </ol>
    <p class="normal">The output shows <code class="inlineCode">54</code> because I ran the console app on July 5, 2023, when Sam was 54 years old.</p>
    <h2 id="_idParaDest-349" class="heading-2">Defining settable properties</h2>
    <p class="normal">To <a id="_idIndexMarker770"/>create <a id="_idIndexMarker771"/>a settable property, you must use the older syntax and provide a pair of methods—not just a <code class="inlineCode">get</code> part, but also a <code class="inlineCode">set</code> part:</p>
    <ol>
      <li class="numberedList" value="1">In <code class="inlineCode">PersonAutoGen.cs</code>, add statements to define a <code class="inlineCode">string</code> property that has both a <code class="inlineCode">get</code> and <code class="inlineCode">set</code> method (also known as a <strong class="keyWord">getter</strong> and <strong class="keyWord">setter</strong>), as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">// A read-write property defined using C# 3 auto-syntax.
public string? FavoriteIceCream { get; set; }
</code></pre>
      </li>
    </ol>
    <p class="normal-one">Although<a id="_idIndexMarker772"/> you have not manually created a field to store the person’s favorite ice cream, it is there, automatically created by the compiler for you.</p>
    <p class="normal-one">Sometimes, you<a id="_idIndexMarker773"/> need more control over what happens when a property is set. In this scenario, you must use a more detailed syntax and manually create a <code class="inlineCode">private</code> field to store the value of the property.</p>
    <ol>
      <li class="numberedList" value="2">In <code class="inlineCode">PersonAutoGen.cs</code>, add statements to define a <code class="inlineCode">private</code> <code class="inlineCode">string</code> field, known as a <strong class="keyWord">backing field</strong>, as <a id="_idIndexMarker774"/>shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">// A private backing field to store the property value.
private string? _favoritePrimaryColor;
</code></pre>
      </li>
    </ol>
    <div><p class="normal"><strong class="keyWord">Good practice</strong>: Although there is no formal standard to name private fields, the most common is to use camel case with an underscore as a prefix.</p>
    </div>
    <ol>
      <li class="numberedList" value="3">In <code class="inlineCode">PersonAutoGen.cs</code>, add statements to define a <code class="inlineCode">string</code> property that has both <code class="inlineCode">get</code> and <code class="inlineCode">set</code> and validation logic in the setter, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">// A public property to read and write to the field.
public string? FavoritePrimaryColor
{
  get
  {
    return _favoritePrimaryColor;
  }
  set
  {
    switch (value?.ToLower())
    {
      case "red":
      case "green":
      case "blue":
        _favoritePrimaryColor = value;
        break;
      default:
        throw new ArgumentException(
          $"{value} is not a primary color. " +
          "Choose from: red, green, blue.");
    }
  }
}
</code></pre>
      </li>
    </ol>
    <div><p class="normal"><strong class="keyWord">Good practice</strong>: Avoid adding too much code to your getters and setters. This could indicate a problem with your design. Consider adding private methods that you then call in the <code class="inlineCode">set</code> and <code class="inlineCode">get</code> methods to simplify your implementations.</p>
    </div>
    <ol>
      <li class="numberedList" value="4">In <code class="inlineCode">Program.cs</code>, add<a id="_idIndexMarker775"/> statements to set Sam’s favorite<a id="_idIndexMarker776"/> ice cream and color, and then write them out, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">sam.FavoriteIceCream = "Chocolate Fudge";
WriteLine($"Sam's favorite ice-cream flavor is {sam.FavoriteIceCream}.");
string color = "Red";
try
{
  sam.FavoritePrimaryColor = color;
  WriteLine($"Sam's favorite primary color is {sam.FavoritePrimaryColor}.");
}
catch (Exception ex)
{
  WriteLine("Tried to set {0} to '{1}': {2}",
    nameof(sam.FavoritePrimaryColor), color, ex.Message);
}
</code></pre>
      </li>
    </ol>
    <div><p class="normal">The print book is limited to about 820 pages. If I added exception handling code to all code examples as we have done here, then I would probably have to remove at least one chapter from the book to make enough space. In the future, I will not explicitly tell you to add exception handling code, but get into the habit of adding it yourself when needed.</p>
    </div>
    <ol>
      <li class="numberedList" value="5">Run <a id="_idIndexMarker777"/>the <code class="inlineCode">PeopleApp</code> project and view the <a id="_idIndexMarker778"/>result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">Sam's favorite ice-cream flavor is Chocolate Fudge.
Sam's favorite primary color is Red.
</code></pre>
      </li>
      <li class="numberedList">Try to set the color to any value other than red, green, or blue, like black.</li>
      <li class="numberedList">Run the <code class="inlineCode">PeopleApp</code> project and view the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">Tried to set FavoritePrimaryColor to 'Black': Black is not a primary color. Choose from: red, green, blue.
</code></pre>
      </li>
    </ol>
    <div><p class="normal"><strong class="keyWord">Good practice</strong>: Use properties instead of fields when you want to execute statements during a read or write to a field without using a method pair, like <code class="inlineCode">GetAge</code> and <code class="inlineCode">SetAge</code>.</p>
    </div>
    <h2 id="_idParaDest-350" class="heading-2">Partial properties</h2>
    <p class="normal">In the<a id="_idIndexMarker779"/> previous section, you learned about partial classes and<a id="_idIndexMarker780"/> partial methods. With C# 13 on .NET 9, you can define partial properties, and they work in a similar way. The main benefit is to support source-generated types. Partial properties make it easier for source generator designers to create natural feeling APIs, as you will see in <em class="chapterRef">Chapter 8, Working with Common .NET Types</em>, when we see the Regex source generator.</p>
    <h2 id="_idParaDest-351" class="heading-2">Limiting flags enum values</h2>
    <p class="normal">Earlier in<a id="_idIndexMarker781"/> this chapter, we defined a field to store a person’s favorite ancient wonder. But we then made the <code class="inlineCode">enum</code> able to store combinations of values. Now, let’s limit the favorite to one:</p>
    <ol>
      <li class="numberedList" value="1">In <code class="inlineCode">Person.cs</code>, comment out the <code class="inlineCode">FavoriteAncientWonder</code> field and add a comment to note it has moved to the <code class="inlineCode">PersonAutoGen.cs</code> code file, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">// This has been moved to PersonAutoGen.cs as a property.
// public WondersOfTheAncientWorld FavoriteAncientWonder;
</code></pre>
      </li>
      <li class="numberedList">In <code class="inlineCode">PersonAutoGen.cs</code>, add a <code class="inlineCode">private</code> field and <code class="inlineCode">public</code> property for <code class="inlineCode">FavoriteAncientWonder</code>, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">private WondersOfTheAncientWorld _favoriteAncientWonder;
public WondersOfTheAncientWorld FavoriteAncientWonder
{
  get { return _favoriteAncientWonder; }
  set
  {
    string wonderName = value.ToString();
    if (wonderName.Contains(','))
    {
      throw new ArgumentException(
        message: "Favorite ancient wonder can only have a single enum value.",
        paramName: nameof(FavoriteAncientWonder));
    }
    if (!Enum.IsDefined(typeof(WondersOfTheAncientWorld), value))
    {
      throw new ArgumentException(
        $"{value} is not a member of the WondersOfTheAncientWorld enum.",
        paramName: nameof(FavoriteAncientWonder));
    }
    _favoriteAncientWonder = value;
  }
}
</code></pre>
        <div><p class="normal">We could simplify the validation by only checking if the value is defined in the original <code class="inlineCode">enum</code> because <code class="inlineCode">IsDefined</code> returns <code class="inlineCode">false</code> for multiple values and undefined values. However, I want to show a different exception for multiple values, so I will use the fact that multiple values formatted as a string would include a comma in the list of names. This also means we must check for multiple values before we check if the value is defined. A comma-separated list is how multiple <code class="inlineCode">enum</code> values are represented as a <code class="inlineCode">string</code>, but you cannot use commas to set multiple <code class="inlineCode">enum</code> values. You should use <code class="inlineCode">|</code> (the bitwise <code class="inlineCode">OR</code>).</p>
        </div>
      </li>
    </ol>
    <ol>
      <li class="numberedList" value="3">In <code class="inlineCode">Program.cs</code>, in the <em class="italic">Storing a value using an enum type</em> region, set Bob’s <a id="_idIndexMarker782"/>favorite wonder to more than one <code class="inlineCode">enum</code> value, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">bob.FavoriteAncientWonder =
  WondersOfTheAncientWorld.StatueOfZeusAtOlympia |
  WondersOfTheAncientWorld.GreatPyramidOfGiza;
</code></pre>
      </li>
      <li class="numberedList">Run the <code class="inlineCode">PeopleApp</code> project and note the exception, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">Unhandled exception. System.ArgumentException: Favorite ancient wonder can only have a single enum value. (Parameter 'FavoriteAncientWonder')
   at Packt.Shared.Person.set_FavoriteAncientWonder(WondersOfTheAncientWorld value) in C:\cs13net9\Chapter05\PacktLibraryNet2\PersonAutoGen.cs:line 67
   at Program.&lt;Main&gt;$(String[] args) in C:\cs13net9\Chapter05\PeopleApp\Program.cs:line 57
</code></pre>
      </li>
      <li class="numberedList">In <code class="inlineCode">Program.cs</code>, set <a id="_idIndexMarker783"/>Bob’s favorite wonder to an invalid <code class="inlineCode">enum</code> value like 128, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">bob.FavoriteAncientWonder = (WondersOfTheAncientWorld)128;
</code></pre>
      </li>
      <li class="numberedList">Run the <code class="inlineCode">PeopleApp</code> project and note the exception, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">Unhandled exception. System.ArgumentException: 128 is not a member of the WondersOfTheAncientWorld enum. (Parameter 'FavoriteAncientWonder')
</code></pre>
      </li>
      <li class="numberedList">In <code class="inlineCode">Program.cs</code>, set Bob’s favorite wonder back to a valid single <code class="inlineCode">enum</code> value.</li>
    </ol>
    <h2 id="_idParaDest-352" class="heading-2">Defining indexers</h2>
    <p class="normal"><strong class="keyWord">Indexers</strong> allow<a id="_idIndexMarker784"/> the calling code to use the array syntax to access a property. For example, the <code class="inlineCode">string</code> type defines an indexer so that the calling code can access individual characters in the <code class="inlineCode">string</code>, as shown in the following code:</p>
    <pre class="programlisting code"><code class="hljs-code">string alphabet = "abcdefghijklmnopqrstuvwxyz";
char letterF = alphabet[5]; // 0 is a, 1 is b, and so on.
</code></pre>
    <p class="normal">You can overload indexers so that different types can be used for their parameters. For example, as well as passing an <code class="inlineCode">int</code> value, you could also pass a <code class="inlineCode">string</code> value.</p>
    <p class="normal">We will define<a id="_idIndexMarker785"/> an indexer to simplify access to the children of a person:</p>
    <ol>
      <li class="numberedList" value="1">In <code class="inlineCode">PersonAutoGen.cs</code>, add statements to define an indexer to get and set a child using the index of the child, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">#region Indexers: Properties that use array syntax to access them.
public Person this[int index]
{
  get
  {
    return Children[index]; // Pass on to the List&lt;T&gt; indexer.
  }
  set
  {
    Children[index] = value;
  }
}
#endregion
</code></pre>
      </li>
    </ol>
    <div><p class="normal">Note the use of <code class="inlineCode">this[]</code> to define an indexer. It is not to be confused with the use of the <code class="inlineCode">this</code> keyword to refer to the current instance of an object, or the use of <code class="inlineCode">this()</code> to refer to the current type’s constructor.</p>
    </div>
    <ol>
      <li class="numberedList" value="2">In <code class="inlineCode">PersonAutoGen.cs</code>, add statements to define an indexer to get and set a child using the name of the child, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">// A read-only string indexer.
public Person this[string name]
{
  get
  {
    return Children.Find(p =&gt; p.Name == name);
  }
}
</code></pre>
      </li>
    </ol>
    <div><p class="normal">You will learn more about collections like <code class="inlineCode">List&lt;T&gt;</code> in <em class="chapterRef">Chapter 8</em>, <em class="italic">Working with Common .NET Types</em>, and how to write lambda expressions using <code class="inlineCode">=&gt;</code> in <em class="chapterRef">Chapter 11</em>,<em class="chapterRef"> </em><em class="italic">Querying and Manipulating Data Using LINQ</em>.</p>
    </div>
    <ol>
      <li class="numberedList" value="3">In <code class="inlineCode">Program.cs</code>, add <a id="_idIndexMarker786"/>statements to add two children to <code class="inlineCode">Sam</code>, and then access the first and second children using the longer <code class="inlineCode">Children</code> field and the shorter indexer syntax, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">sam.Children.Add(new() { Name = "Charlie",
  Born = new(2010, 3, 18, 0, 0, 0, TimeSpan.Zero) });
sam.Children.Add(new() { Name = "Ella",
  Born = new(2020, 12, 24, 0, 0, 0, TimeSpan.Zero) });
// Get using Children list.
WriteLine($"Sam's first child is {sam.Children[0].Name}.");
WriteLine($"Sam's second child is {sam.Children[1].Name}.");
// Get using the int indexer.
WriteLine($"Sam's first child is {sam[0].Name}.");
WriteLine($"Sam's second child is {sam[1].Name}.");
// Get using the string indexer.
WriteLine($"Sam's child named Ella is {sam["Ella"].Age} years old.");
</code></pre>
      </li>
      <li class="numberedList">Run the <code class="inlineCode">PeopleApp</code> project and view the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">Sam's first child is Charlie.
Sam's second child is Ella.
Sam's first child is Charlie.
Sam's second child is Ella.
Sam's child named Ella is 3 years old.
</code></pre>
      </li>
    </ol>
    <p class="normal"><code class="inlineCode">sam[0].Name</code> calls the indexer aka <code class="inlineCode">this</code> on the <code class="inlineCode">Person</code> class because <code class="inlineCode">[]</code> are the symbols that call <a id="_idIndexMarker787"/>an indexer. <code class="inlineCode">sam.Children[0].Name</code> calls the indexer on the collection named <code class="inlineCode">Children</code>, which is a <code class="inlineCode">List&lt;Person&gt;</code>. We have implemented the indexer on <code class="inlineCode">Person</code> to do the same thing so we can use a shorter syntax.</p>
    <p class="normal">It’s similar with <code class="inlineCode">string</code> values. If I have <code class="inlineCode">string name = "Mark";</code> then imagine that it has a property named <code class="inlineCode">Characters</code> that is a <code class="inlineCode">List&lt;char&gt;</code>. I could use <code class="inlineCode">name.Characters[0]</code> to return the character <code class="inlineCode">M</code>. But since <code class="inlineCode">string</code> has an indexer defined, I can do the same with <code class="inlineCode">name[0]</code>.</p>
    <p class="normal">Most types do not define an indexer. It’s just a way to define a property that is called using <code class="inlineCode">[]</code> instead of a name. It can actually do anything you want. But it should be used to define an array/collection style getter/setter. If your type doesn’t need that, it doesn’t need an indexer.</p>
    <p class="normal">For any type you define, just imagine another developer using your type. What would they expect the indexer to do? For example, what if you get the first index, as shown in the following code:</p>
    <pre class="programlisting code"><code class="hljs-code">Car car = new("Ford");
var thing1 = car[0]; // What type is thing1? What is its value?
Database db = new("Commerce");
var thing2 = db[0]; // What type is thing2? What is its value?
string name = "Mark";
var thing3 = name[0]; // thing3 is a char. Its value is "M".
List&lt;int&gt; numbers = new() { 27, 95, 13 };
var thing4 = numbers[0]; // thing4 is an int. Its value is 27.
</code></pre>
    <p class="normal"><code class="inlineCode">thing1</code> might be the first passenger in the car or the first wheel of the car. <code class="inlineCode">thing2</code> might be the first table in the database or the first user. For custom types, it is up to you to decide what makes the most sense for your type.</p>
    <h1 id="_idParaDest-353" class="heading-1">Pattern matching with objects</h1>
    <p class="normal">In <em class="chapterRef">Chapter 3</em>, <em class="italic">Controlling Flow, Converting Types, and Handling Exceptions</em>, you were introduced to basic <a id="_idIndexMarker788"/>pattern matching. In this section, we will <a id="_idIndexMarker789"/>explore pattern matching in more detail.</p>
    <h2 id="_idParaDest-354" class="heading-2">Pattern-matching flight passengers</h2>
    <p class="normal">In this<a id="_idIndexMarker790"/> example, we will define some classes that represent various types of passengers on a flight, and then we will use a switch expression with pattern matching to determine the cost of their flight:</p>
    <ol>
      <li class="numberedList" value="1">In the <code class="inlineCode">PacktLibraryNet2</code> project/folder, add a new file named <code class="inlineCode">FlightPatterns.cs</code>.</li>
      <li class="numberedList">If you use Visual Studio, in <code class="inlineCode">FlightPatterns.cs</code>, delete the existing statements, including the class named <code class="inlineCode">FlightPatterns</code>, because we will define multiple classes, and none match the name of the code file.</li>
      <li class="numberedList">In <code class="inlineCode">FlightPatterns.cs</code>, add statements to define three types of passenger with different properties, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">// All the classes in this file will be defined in the following namespace.
namespace Packt.Shared;
public class Passenger
{
  public string? Name { get; set; }
}
public class BusinessClassPassenger : Passenger
{
  public override string ToString()
  {
    return $"Business Class: {Name}";
  }
}
public class FirstClassPassenger : Passenger
{
  public int AirMiles { get; set; }
  public override string ToString()
  {
    return $"First Class with {AirMiles:N0} air miles: {Name}";
  }
}
public class CoachClassPassenger : Passenger
{
  public double CarryOnKG { get; set; }
  public override string ToString()
  {
    return $"Coach Class with {CarryOnKG:N2} KG carry on: {Name}";
  }
}
</code></pre>
      </li>
    </ol>
    <div><p class="normal">You will learn about overriding the <code class="inlineCode">ToString</code> method in <em class="chapterRef">Chapter 6</em>, <em class="italic">Implementing Interfaces and Inheriting Classes</em>.</p>
    </div>
    <ol>
      <li class="numberedList" value="4">In <code class="inlineCode">Program.cs</code>, add <a id="_idIndexMarker791"/>statements to define an object array containing five passengers of various types and property values, and then enumerate them, outputting the cost of their flight, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">// An array containing a mix of passenger types.
Passenger[] passengers = {
  new FirstClassPassenger { AirMiles = 1_419, Name = "Suman" },
  new FirstClassPassenger { AirMiles = 16_562, Name = "Lucy" },
  new BusinessClassPassenger { Name = "Janice" },
  new CoachClassPassenger { CarryOnKG = 25.7, Name = "Dave" },
  new CoachClassPassenger { CarryOnKG = 0, Name = "Amit" },
};
foreach (Passenger passenger in passengers)
{
  decimal flightCost = passenger switch
  {
    FirstClassPassenger p when p.AirMiles &gt; 35_000 =&gt; 1_500M,
    FirstClassPassenger p when p.AirMiles &gt; 15_000 =&gt; 1_750M,
    FirstClassPassenger _                         =&gt; 2_000M,
    BusinessClassPassenger _                      =&gt; 1_000M,
    CoachClassPassenger p when p.CarryOnKG &lt; 10.0 =&gt; 500M,
    CoachClassPassenger _                         =&gt; 650M,
    _                                             =&gt; 800M
  };
  WriteLine($"Flight costs {flightCost:C} for {passenger}");
}
</code></pre>
      </li>
    </ol>
    <p class="normal-one">While<a id="_idIndexMarker792"/> reviewing the preceding code, note the following:</p>
    <ul>
      <li class="bulletList level-2">Most code editors do not align the lambda symbols =&gt; as I have done above.</li>
      <li class="bulletList level-2">To pattern match the properties of an object, you must name a local variable, like <code class="inlineCode">p</code>, which can then be used in an expression.</li>
      <li class="bulletList level-2">To <a id="_idIndexMarker793"/>pattern match on a type only, you can use <code class="inlineCode">_</code> to discard the local variable; for example, <code class="inlineCode">FirstClassPassenger _</code> means that you match on the type but you don’t care what values any of its properties have, so a named variable like <code class="inlineCode">p</code> is not needed. In a moment, you will see how we can improve the code even more.</li>
      <li class="bulletList level-2">The <code class="inlineCode">switch</code> expression also uses <code class="inlineCode">_</code> to represent its default branch.</li>
    </ul>
    <ol>
      <li class="numberedList" value="5">Run the <code class="inlineCode">PeopleApp</code> project and view the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">Flight costs $2,000.00 for First Class with 1,419 air miles: Suman
Flight costs $1,750.00 for First Class with 16,562 air miles: Lucy
Flight costs $1,000.00 for Business Class: Janice
Flight costs $650.00 for Coach Class with 25.70 KG carry on: Dave
Flight costs $500.00 for Coach Class with 0.00 KG carry on: Amit
</code></pre>
      </li>
    </ol>
    <h2 id="_idParaDest-355" class="heading-2">Enhancements to pattern matching in modern C#</h2>
    <p class="normal">The previous <a id="_idIndexMarker794"/>examples worked with C# 8. Now, we will look at some enhancements in C# 9 and later. First, you no longer need to use the underscore to discard the local variable when doing type matching:</p>
    <ol>
      <li class="numberedList" value="1">In <code class="inlineCode">Program.cs</code>, comment out the C# 8 syntax, and add C# 9 and later syntax to modify the branches for first-class passengers to use a nested <code class="inlineCode">switch</code> expression and the new support for conditionals, like <code class="inlineCode">&gt;</code>, as highlighted in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">decimal flightCost = passenger switch
{
  <strong class="hljs-comment-slc">/* C# 8 syntax</strong>
  FirstClassPassenger p when p.AirMiles &gt; 35_000 =&gt; 1_500M,
  FirstClassPassenger p when p.AirMiles &gt; 15_000 =&gt; 1_750M,
  FirstClassPassenger _                          =&gt; 2_000M, <strong class="hljs-comment-slc">*/</strong>
<strong class="hljs-slc">  </strong><strong class="hljs-comment-slc">// C# 9 or later syntax</strong>
<strong class="hljs-slc">  FirstClassPassenger p =&gt; p.AirMiles </strong><strong class="hljs-keyword-slc">switch</strong>
<strong class="hljs-slc">  {</strong>
<strong class="hljs-slc">    &gt; </strong><strong class="hljs-number-slc">35</strong><strong class="hljs-slc">_000 =&gt; </strong><strong class="hljs-number-slc">1</strong><strong class="hljs-slc">_500M,</strong>
<strong class="hljs-slc">    &gt; </strong><strong class="hljs-number-slc">15</strong><strong class="hljs-slc">_000 =&gt; </strong><strong class="hljs-number-slc">1</strong><strong class="hljs-slc">_750M,</strong>
<strong class="hljs-slc">    _       =&gt; </strong><strong class="hljs-number-slc">2</strong><strong class="hljs-slc">_000M</strong>
<strong class="hljs-slc">  },</strong>
  BusinessClassPassenger                        =&gt; 1_000M,
  CoachClassPassenger p when p.CarryOnKG &lt; 10.0 =&gt; 500M,
  CoachClassPassenger                           =&gt; 650M,
  _                                             =&gt; 800M
};
</code></pre>
      </li>
      <li class="numberedList">Run<a id="_idIndexMarker795"/> the <code class="inlineCode">PeopleApp</code> project to view the results, and note that they are the same as before.</li>
    </ol>
    <p class="normal">You could also use the relational pattern in combination with the property pattern to avoid the nested <code class="inlineCode">switch</code> expression, as shown in the following code:</p>
    <pre class="programlisting code"><code class="hljs-code">FirstClassPassenger { AirMiles: &gt; 35000 } =&gt; 1500M,
FirstClassPassenger { AirMiles: &gt; 15000 } =&gt; 1750M,
FirstClassPassenger                       =&gt; 2000M,
</code></pre>
    <h1 id="_idParaDest-356" class="heading-1">Working with record types</h1>
    <p class="normal">Before<a id="_idIndexMarker796"/> we dive into the new <code class="inlineCode">record</code> language feature, let us see some other related new features of C# 9 and later.</p>
    <h2 id="_idParaDest-357" class="heading-2">Init-only properties</h2>
    <p class="normal">You have<a id="_idIndexMarker797"/> used object initialization syntax to instantiate objects and set initial properties throughout this chapter. Those properties can also be changed after instantiation.</p>
    <p class="normal">Sometimes, you want to treat properties like <code class="inlineCode">readonly</code> fields so that they can be set during instantiation but not after. In other words, they are immutable. The <code class="inlineCode">init</code> keyword enables this. It can be used in place of the <code class="inlineCode">set</code> keyword in a property definition.</p>
    <p class="normal">Since this is a language feature not supported by .NET Standard 2.0, we cannot use it in the <code class="inlineCode">PacktLibraryNet2</code> project. We must use it in the modern project:</p>
    <ol>
      <li class="numberedList" value="1">In the <code class="inlineCode">PacktLibraryModern</code> project, add a new file named <code class="inlineCode">Records.cs</code>.</li>
      <li class="numberedList">In <code class="inlineCode">Records.cs</code>, define a person class with two immutable properties, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">namespace Packt.Shared;
public class ImmutablePerson
{
  public string? FirstName { get; init; }
  public string? LastName { get; init; }
}
</code></pre>
      </li>
      <li class="numberedList">In <code class="inlineCode">Program.cs</code>, add statements to instantiate a new immutable person, and then try to change one of its properties, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">ImmutablePerson jeff = new()
{
  FirstName = "Jeff",
  LastName = "Winger"
};
jeff.FirstName = "Geoff";
</code></pre>
      </li>
      <li class="numberedList">Compile the console app and note the compile error, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">C:\cs13net9\Chapter05\PeopleApp\Program.cs(404,1): error CS8852: Init-only property or indexer 'ImmutablePerson.FirstName' can only be assigned in an object initializer, or on 'this' or 'base' in an instance constructor or an 'init' accessor. [/Users/markjprice/Code/Chapter05/PeopleApp/PeopleApp.csproj]
</code></pre>
      </li>
      <li class="numberedList">Comment<a id="_idIndexMarker798"/> out the attempt to set the <code class="inlineCode">FirstName</code> property after instantiation.</li>
    </ol>
    <div><p class="normal">Even if you do not set <code class="inlineCode">FirstName</code> in the object initializer, you still would not be able to set it post-initialization. If you need to force a property to be set, then apply the <code class="inlineCode">required</code> keyword that you learned about earlier in this chapter.</p>
    </div>
    <h2 id="_idParaDest-358" class="heading-2">Defining record types</h2>
    <p class="normal">Init-only properties<a id="_idIndexMarker799"/> provide some immutability to C#. You can take the concept further by using <strong class="keyWord">record types</strong>. These are defined by using the <code class="inlineCode">record</code> keyword instead of (or as well as) the <code class="inlineCode">class</code> keyword. That can make the whole object immutable, and it acts like a value when compared. We will discuss equality and comparisons of classes, records, and value types in more detail in <em class="chapterRef">Chapter 6</em>, <em class="italic">Implementing Interfaces and Inheriting Classes</em>.</p>
    <p class="normal">Immutable records should not have any state (properties and fields) that change after instantiation. Instead, the idea is that you create new records from existing ones. The new record has the changed state. This is called non-destructive mutation. To do this, C# 9 introduced the <code class="inlineCode">with</code> keyword:</p>
    <ol>
      <li class="numberedList" value="1">In <code class="inlineCode">Records.cs</code>, add a record named <code class="inlineCode">ImmutableVehicle</code> after the <code class="inlineCode">ImmutablePerson</code> class, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">public record ImmutableVehicle
{
  public int Wheels { get; init; }
  public string? Color { get; init; }
  public string? Brand { get; init; }
}
</code></pre>
      </li>
      <li class="numberedList">In <code class="inlineCode">Program.cs</code>, add<a id="_idIndexMarker800"/> statements to create a <code class="inlineCode">car</code> and then a mutated copy of it, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">ImmutableVehicle car = new()
{
  Brand = "Mazda MX-5 RF",
  Color = "Soul Red Crystal Metallic",
  Wheels = 4
};
ImmutableVehicle repaintedCar = car
  with { Color = "Polymetal Grey Metallic" };
WriteLine($"Original car color was {car.Color}.");
WriteLine($"New car color is {repaintedCar.Color}.");
</code></pre>
      </li>
      <li class="numberedList">Run the <code class="inlineCode">PeopleApp</code> project to view the results, and note the change to the car color in the mutated copy, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">Original car color was Soul Red Crystal Metallic.
New car color is Polymetal Grey Metallic.
</code></pre>
      </li>
    </ol>
    <div><p class="normal">You could also release the memory for the <code class="inlineCode">car</code> variable and the <code class="inlineCode">repaintedCar</code> would still fully exist.</p>
    </div>
    <h2 id="_idParaDest-359" class="heading-2">Equality of record types</h2>
    <p class="normal">One of <a id="_idIndexMarker801"/>the most important behaviors of <code class="inlineCode">record</code> types is their equality. Two records with the same property values are considered equal. This may not sound surprising, but if you used a normal class instead of a record, then they would <em class="italic">not</em> be considered equal. Let’s see:</p>
    <ol>
      <li class="numberedList" value="1">In the <code class="inlineCode">PacktLibraryModern</code> project, add a new file named <code class="inlineCode">Equality.cs</code>.</li>
      <li class="numberedList">In <code class="inlineCode">Equality.cs</code>, define a <code class="inlineCode">class</code> and a <code class="inlineCode">record</code> type, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">namespace Packt.Shared;
public class AnimalClass
{
  public string? Name { get; set; }
}
public record AnimalRecord
{
  public string? Name { get; set; }
}
</code></pre>
      </li>
      <li class="numberedList">In <code class="inlineCode">Program.cs</code>, add statements to create two instances of <code class="inlineCode">AnimalClass</code> and two instances of <code class="inlineCode">AnimalRecord</code>, and then compare them for equality, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">AnimalClass ac1 = new() { Name = "Rex" };
AnimalClass ac2 = new() { Name = "Rex" };
WriteLine($"ac1 == ac2: {ac1 == ac2}");
AnimalRecord ar1 = new() { Name = "Rex" };
AnimalRecord ar2 = new() { Name = "Rex" };
WriteLine($"ar1 == ar2: {ar1 == ar2}");
</code></pre>
      </li>
      <li class="numberedList">Run the <code class="inlineCode">PeopleApp</code> project to view the results, and note that two class instances are not equal even if they have the same property values, and two record instances are equal if they have the same property values, as shown in<a id="_idIndexMarker802"/> the following output:
        <pre class="programlisting con-one"><code class="hljs-con">ac1 == ac2: False
ar1 == ar2: True
</code></pre>
      </li>
    </ol>
    <div><p class="normal">Class instances are only equal if they are literally the same object. This is true when their memory addresses are equal. You will learn more about the equality of types in <em class="chapterRef">Chapter 6</em>, <em class="italic">Implementing Interfaces and Inheriting Classes</em>.</p>
    </div>
    <h2 id="_idParaDest-360" class="heading-2">Equality of other types</h2>
    <p class="normal">It is common<a id="_idIndexMarker803"/> to compare two variables using the <code class="inlineCode">==</code> and <code class="inlineCode">!=</code> operators. The behavior of these two operators is different for reference types and value types.</p>
    <p class="normal">When you check the equality of two value type variables, .NET literally compares the <em class="italic">values</em> of those two variables on the stack and returns <code class="inlineCode">true</code> if they are equal:</p>
    <ol>
      <li class="numberedList" value="1">In <code class="inlineCode">Program.cs</code>, add statements to declare two integers with equal values and then compare them, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">int number1 = 3;
int number2 = 3;
WriteLine($"number1: {number1}, number2: {number2}");
WriteLine($"number1 == number2: {number1 == number2}");
</code></pre>
      </li>
      <li class="numberedList">Run the <code class="inlineCode">PeopleApp</code> project and view the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">number1: 3, number2: 3
number1 == number2: True
</code></pre>
      </li>
    </ol>
    <p class="normal-one">When you check the equality of two reference type variables, .NET compares the memory addresses of those two variables and returns <code class="inlineCode">true</code> if they are equal.</p>
    <ol>
      <li class="numberedList" value="3">In <code class="inlineCode">Program.cs</code>, add statements to declare two <code class="inlineCode">Person</code> instances with equal names, and then compare the variables and their names, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">Person p1 = new() { Name = "Kevin" };
Person p2 = new() { Name = "Kevin" };
WriteLine($"p1: {p1}, p2: {p2}");
WriteLine($"p1.Name: {p1.Name}, p2.Name: {p2.Name}");
WriteLine($"p1 == p2: {p1 == p2}");
</code></pre>
      </li>
      <li class="numberedList">Run<a id="_idIndexMarker804"/> the <code class="inlineCode">PeopleApp</code> project and view the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">p1: Packt.Shared.Person, p2: Packt.Shared.Person
p1.Name: Kevin, p2.Name: Kevin
p1 == p2: False
</code></pre>
      </li>
    </ol>
    <div><p class="normal">This is because they are not the same object. If both variables literally pointed to the same object on the heap, then they would be equal.</p>
    </div>
    <ol>
      <li class="numberedList" value="5">Add statements to declare a third <code class="inlineCode">Person</code> object and assign <code class="inlineCode">p1</code> to it, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">Person p3 = p1;
WriteLine($"p3: {p3}");
WriteLine($"p3.Name: {p3.Name}");
WriteLine($"p1 == p3: {p1 == p3}");
</code></pre>
      </li>
      <li class="numberedList">Run the <code class="inlineCode">PeopleApp</code> project and view the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">p3: Packt.Shared.Person
p3.Name: Kevin
p1 == p3: True
</code></pre>
        <div><p class="normal">The one exception to this behavior of reference types is the <code class="inlineCode">string</code> type. It is a reference type, but the equality operators have been overridden to make them behave as if they were value types.</p>
        </div>
      </li>
    </ol>
    <ol>
      <li class="numberedList" value="7">Add<a id="_idIndexMarker805"/> statements to compare the <code class="inlineCode">Name</code> properties of two <code class="inlineCode">Person</code> instances, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">// string is the only class reference type implemented to
// act like a value type for equality.
WriteLine($"p1.Name: {p1.Name}, p2.Name: {p2.Name}");
WriteLine($"p1.Name == p2.Name: {p1.Name == p2.Name}");
</code></pre>
      </li>
      <li class="numberedList">Run the <code class="inlineCode">PeopleApp</code> project and view the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">p1.Name: Kevin, p2.Name: Kevin
p1.Name == p2.Name: True
</code></pre>
      </li>
    </ol>
    <p class="normal">You can do the same as <code class="inlineCode">string</code> with your classes to override the equality operator <code class="inlineCode">==</code> to return <code class="inlineCode">true</code>, even if the two variables are not referencing the same object (the same memory address on the heap) but, instead, their fields have the same values. However, that is beyond the scope of this book.</p>
    <div><p class="normal"><strong class="keyWord">Good practice</strong>: Alternatively, use a <code class="inlineCode">record class</code> because one of its benefits is that it implements this equality behavior for you.</p>
    </div>
    <h2 id="_idParaDest-361" class="heading-2">Positional data members in records</h2>
    <p class="normal">The <a id="_idIndexMarker806"/>syntax for defining a record can be greatly simplified using positional data members. Instead of using object initialization syntax with curly braces, sometimes you might prefer to provide a constructor with positional parameters, as you saw earlier in this chapter. You can also combine<a id="_idIndexMarker807"/> this with a deconstructor to split the object into individual parts, as shown in the following code:</p>
    <pre class="programlisting code"><code class="hljs-code">public record ImmutableAnimal
{
  public string Name { get; init; }
  public string Species { get; init; }
  public ImmutableAnimal(string name, string species)
  {
    Name = name;
    Species = species;
  }
  public void Deconstruct(out string name, out string species)
  {
    name = Name;
    species = Species;
  }
}
</code></pre>
    <p class="normal">The properties, constructor, and deconstructor can be generated for you:</p>
    <ol>
      <li class="numberedList" value="1">In <code class="inlineCode">Records.cs</code>, add statements to define another record using simplified syntax, known as positional records, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">// Simpler syntax to define a record that auto-generates the
// properties, constructor, and deconstructor.
public record ImmutableAnimal(string Name, string Species);
</code></pre>
      </li>
      <li class="numberedList">In <code class="inlineCode">Program.cs</code>, add statements to construct and deconstruct immutable animals, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">ImmutableAnimal oscar = new("Oscar", "Labrador");
var (who, what) = oscar; // Calls the Deconstruct method.
WriteLine($"{who} is a {what}.");
</code></pre>
      </li>
      <li class="numberedList">Run the <code class="inlineCode">PeopleApp</code> project and view the results, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">Oscar is a Labrador.
</code></pre>
      </li>
    </ol>
    <p class="normal">You will <a id="_idIndexMarker808"/>see records again when we look at C# 10 or later support to create <code class="inlineCode">struct</code> records in <em class="chapterRef">Chapter 6</em>, <em class="italic">Implementing Interfaces and Inheriting Classes</em>.</p>
    <div><p class="normal"><strong class="keyWord">More information</strong>: There are many more ways to use records in your projects. I recommend that you review the official documentation at the following link: <a href="https://learn.microsoft.com/en-us/dotnet/csharp/whats-new/tutorials/records">https://learn.microsoft.com/en-us/dotnet/csharp/whats-new/tutorials/records</a>.</p>
    </div>
    <h2 id="_idParaDest-362" class="heading-2">Defining a primary constructor for a class</h2>
    <p class="normal">Introduced <a id="_idIndexMarker809"/>with C# 12, you can define one constructor as part of the class definition. This is called the primary constructor. The syntax is the same as for positional data members in records, but the behavior is slightly different.</p>
    <p class="normal">Traditionally, we separate the class definition from any constructors, as shown in the following code:</p>
    <pre class="programlisting code"><code class="hljs-code">public class Headset // Class definition.
{
  // Constructor.
  public Headset(string manufacturer, string productName)
  {
    // You can reference manufacturer and productName parameters in
    // the constructor and the rest of the class.
  }
}
</code></pre>
    <p class="normal">With class primary constructors, you combine both into a more succinct syntax, as shown in the following code:</p>
    <pre class="programlisting code"><code class="hljs-code">public class Headset(string manufacturer, string productName);
</code></pre>
    <p class="normal">Let’s see an<a id="_idIndexMarker810"/> example:</p>
    <ol>
      <li class="numberedList" value="1">In the <code class="inlineCode">PacktLibraryModern</code> project, add a class file named <code class="inlineCode">Headset.cs</code>.</li>
      <li class="numberedList">Modify the code file contents to give the class two parameters for manufacturer and product name respectively, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">namespace Packt.Shared;
public class Headset(string manufacturer, string productName);
</code></pre>
      </li>
      <li class="numberedList">In <code class="inlineCode">Program.cs</code>, add statements to instantiate a headset, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">Headset vp = new("Apple", "Vision Pro");
WriteLine($"{vp.ProductName} is made by {vp.Manufacturer}.");
</code></pre>
      </li>
    </ol>
    <div><p class="normal">One of the differences between a <code class="inlineCode">record</code> and a <code class="inlineCode">class</code> type with a primary constructor is that its parameters don’t become public properties automatically, so you will see <code class="inlineCode">CS1061</code> compiler errors. Neither <code class="inlineCode">ProductName</code> nor <code class="inlineCode">productName</code> are accessible outside the class.</p>
    </div>
    <ol>
      <li class="numberedList" value="4">In <code class="inlineCode">Headset.cs</code>, add statements to define two properties and set them using the parameters passed to the primary constructor, as highlighted in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">namespace Packt.Shared;
public class Headset(string manufacturer, string productName)
<strong class="hljs-slc">{</strong>
<strong class="hljs-slc">  </strong><strong class="hljs-keyword-slc">public</strong><strong class="hljs-slc"> </strong><strong class="hljs-built_in-slc">string</strong><strong class="hljs-slc"> Manufacturer { </strong><strong class="hljs-keyword-slc">get</strong><strong class="hljs-slc">; </strong><strong class="hljs-keyword-slc">set</strong><strong class="hljs-slc">; } = manufacturer;</strong>
<strong class="hljs-slc">  </strong><strong class="hljs-keyword-slc">public</strong><strong class="hljs-slc"> </strong><strong class="hljs-built_in-slc">string</strong><strong class="hljs-slc"> ProductName { </strong><strong class="hljs-keyword-slc">get</strong><strong class="hljs-slc">; </strong><strong class="hljs-keyword-slc">set</strong><strong class="hljs-slc">; } = productName;</strong>
<strong class="hljs-slc">}</strong>
</code></pre>
      </li>
      <li class="numberedList">Run the <code class="inlineCode">PeopleApp</code> project and view the results, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">Vision Pro is made by Apple.
</code></pre>
      </li>
      <li class="numberedList">In <code class="inlineCode">Headset.cs</code>, add a <a id="_idIndexMarker811"/>default parameterless constructor, as highlighted in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">namespace Packt.Shared;
public class Headset(string manufacturer, string productName)
{
  public string Manufacturer { get; set; } = manufacturer;
  public string ProductName { get; set; } = productName;
<strong class="hljs-slc">  </strong><strong class="hljs-comment-slc">// Default parameterless constructor calls the primary constructor.</strong>
<strong class="hljs-slc">  </strong><strong class="hljs-keyword-slc">public</strong><strong class="hljs-function-slc"> </strong><strong class="hljs-title-slc">Headset</strong><strong class="hljs-function-slc">() : </strong><strong class="hljs-title-slc">this</strong><strong class="hljs-function-slc">(</strong><strong class="hljs-string-slc">"Microsoft"</strong><strong class="hljs-params-slc">, </strong><strong class="hljs-string-slc">"HoloLens"</strong><strong class="hljs-function-slc">)</strong><strong class="hljs-slc"> { }</strong>
}
</code></pre>
      </li>
    </ol>
    <div><p class="normal">Note the use of <code class="inlineCode">this()</code> to call the constructor of the base class and pass two parameters to it when the default constructor of <code class="inlineCode">Headset</code> is called.</p>
    </div>
    <ol>
      <li class="numberedList" value="7">In <code class="inlineCode">Program.cs</code>, create an uninitialized instance of a headset and an instance for Meta Quest 3, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">Headset holo = new();
WriteLine($"{holo.ProductName} is made by {holo.Manufacturer}.");
Headset mq = new() { Manufacturer = "Meta", ProductName = "Quest 3" };
WriteLine($"{mq.ProductName} is made by {mq.Manufacturer}.");
</code></pre>
      </li>
      <li class="numberedList">Run<a id="_idIndexMarker812"/> the <code class="inlineCode">PeopleApp</code> project and view the results, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">Vision Pro is made by Apple.
HoloLens is made by Microsoft.
Quest 3 is made by Meta.
</code></pre>
      </li>
    </ol>
    <div><p class="normal"><strong class="keyWord">More information</strong>: You can learn more about primary constructors for classes and structs at the following links: <a href="https://learn.microsoft.com/en-us/dotnet/csharp/whats-new/tutorials/primary-constructors">https://learn.microsoft.com/en-us/dotnet/csharp/whats-new/tutorials/primary-constructors</a> and <a href="https://devblogs.microsoft.com/dotnet/csharp-primary-constructors-refactoring/">https://devblogs.microsoft.com/dotnet/csharp-primary-constructors-refactoring/</a>. In particular, it is worth reading the comments at the bottom of the second link to understand why many developers do not like primary constructors in classes.</p>
    </div>
    <div><p class="normal"><strong class="keyWord">Good practice</strong>: Only use a primary constructor in a class if it will only initialize non-read-only private fields, and does not need to execute other statements.</p>
    </div>
    <h1 id="_idParaDest-363" class="heading-1">Practicing and exploring</h1>
    <p class="normal">Test your knowledge and understanding by answering some questions, getting some hands-on practice, and exploring this chapter’s topics with deeper research.</p>
    <h2 id="_idParaDest-364" class="heading-2">Exercise 5.1 – online material</h2>
    <p class="normal">Online material can be extra content written by me for this book, or it can be references to content created by Microsoft or third parties.</p>
    <h3 id="_idParaDest-365" class="heading-3">Pattern matching</h3>
    <p class="normal">There are many ways to use pattern matching in your projects. I recommend that you review the official documentation at the following link: <a href="https://learn.microsoft.com/en-us/dotnet/csharp/fundamentals/functional/pattern-matching">https://learn.microsoft.com/en-us/dotnet/csharp/fundamentals/functional/pattern-matching</a>.</p>
    <h2 id="_idParaDest-366" class="heading-2">Exercise 5.2 – practice exercises</h2>
    <p class="normal">Practice exercises go deeper into the topics for this chapter.</p>
    <h3 id="_idParaDest-367" class="heading-3">Practice access modifiers</h3>
    <p class="normal">Imagine that you are the compiler. What errors would you show when building the following projects? What would need to change to fix it?</p>
    <p class="normal">In a class library project, in <code class="inlineCode">Car.cs</code>:</p>
    <pre class="programlisting code"><code class="hljs-code">class Car
{
  int Wheels { get; set; }
  public bool IsEV { get; set; }
  internal void Start()
  {
    Console.WriteLine("Starting...");
  }
}
</code></pre>
    <p class="normal">In a console app project that references the class library project, in <code class="inlineCode">Program.cs</code>:</p>
    <pre class="programlisting code"><code class="hljs-code">Car fiat = new() { Wheels = 4, IsEV = true };
fiat.Start();
</code></pre>
    <h2 id="_idParaDest-368" class="heading-2">Exercise 5.3 – test your knowledge</h2>
    <p class="normal">Answer the following questions:</p>
    <ol>
      <li class="numberedList" value="1">What are the seven access modifier keywords and combinations of keywords, and what do they do?</li>
      <li class="numberedList">What is the difference between the <code class="inlineCode">static</code>, <code class="inlineCode">const</code>, and <code class="inlineCode">readonly</code> keywords when applied to a type member?</li>
      <li class="numberedList">What does a constructor do?</li>
      <li class="numberedList">Why should you apply the <code class="inlineCode">[Flags]</code> attribute to an <code class="inlineCode">enum</code> type when you want to store combined values?</li>
      <li class="numberedList">Why is the <code class="inlineCode">partial</code> keyword useful?</li>
      <li class="numberedList">What is a tuple?</li>
      <li class="numberedList">What does the <code class="inlineCode">record</code> keyword do?</li>
      <li class="numberedList">What does overloading mean?</li>
      <li class="numberedList">What is the difference between the following two statements? (Do not just say a &gt; character!)
        <pre class="programlisting code-one"><code class="hljs-code">public List&lt;Person&gt; Children = new();
public List&lt;Person&gt; Children =&gt; new();
</code></pre>
      </li>
      <li class="numberedList">How do you make a method parameter optional?</li>
      <li class="numberedList">Why can’t a <code class="inlineCode">DateTime</code> field be a constant?</li>
    </ol>
    <h2 id="_idParaDest-369" class="heading-2">Exercise 5.4 – explore topics</h2>
    <p class="normal">Use the links on the following page to learn more about the topics covered in this chapter:</p>
    <p class="normal"><a href="https://github.com/markjprice/cs13net9/blob/main/docs/book-links.md#chapter-5---building-your-own-types-with-object-oriented-programming">https://github.com/markjprice/cs13net9/blob/main/docs/book-links.md#chapter-5---building-your-own-types-with-object-oriented-programming</a></p>
    <h1 id="_idParaDest-370" class="heading-1">Summary</h1>
    <p class="normal">In this chapter, you learned about:</p>
    <ul>
      <li class="bulletList">Making your own types using OOP.</li>
      <li class="bulletList">Some of the different categories of members that a type can have, including fields to store data and methods to perform actions.</li>
      <li class="bulletList">OOP concepts, such as aggregation and encapsulation</li>
      <li class="bulletList">How to use modern C# features, like relational and property pattern matching enhancements, <code class="inlineCode">init</code>-only properties, and record types.</li>
    </ul>
    <p class="normal">In the next chapter, you will take these concepts further by defining operators, delegates, and events, implementing interfaces, and inheriting from existing classes.</p>
  </div>
</div></div></body></html>