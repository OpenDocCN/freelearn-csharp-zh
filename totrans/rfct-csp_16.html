<html><head></head><body>
<div><h1 class="chapter-number" id="_idParaDest-342"><a id="_idTextAnchor341"/>16</h1>
<h1 id="_idParaDest-343"><a id="_idTextAnchor342"/>Adopting Code Standards</h1>
<p>In this chapter, we’ll talk about the importance of establishing clear <strong class="bold">code standards</strong> with the right degree of flexibility. We’ll also cover some built-in tooling in Visual Studio that will help your team adopt a consistent set of coding standards. This in turn helps you focus on the right things during code review.</p>
<p>This chapter covers the following topics:</p>
<ul>
<li>Understanding code standards</li>
<li>Establishing code standards</li>
<li>Formatting and code cleanup in Visual Studio</li>
<li>Applying code standards with <code>EditorConfig</code></li>
</ul>
<h1 id="_idParaDest-344"><a id="_idTextAnchor343"/>Technical requirements</h1>
<p>The starting code for this chapter is available from GitHub at <a href="https://github.com/PacktPublishing/Refactoring-with-CSharp">https://github.com/PacktPublishing/Refactoring-with-CSharp</a> in the <code>Chapter16/Ch16BeginningCode</code> folder.</p>
<h1 id="_idParaDest-345"><a id="_idTextAnchor344"/>Understanding code standards</h1>
<p>In this chapter, we’re going to explore the idea of code standards.</p>
<p>Code standards<a id="_idIndexMarker910"/> are an agreed-upon set of standards your team decides should be applied to any new code created by the team.</p>
<p>These standards have an important role in resolving disputes, focusing attention on the areas that truly matter, reducing the amount of technical debt teams naturally accumulate, and helping pay down existing technical debt.</p>
<h3>The importance of code standards</h3>
<p>One of the most frustrating experiences I’ve ever had as a developer is when I’ve sent a carefully<a id="_idIndexMarker911"/> thought-out change to another developer for review and I’ve heard back remarks such as the following:</p>
<ul>
<li><em class="italic">I don’t like your curly </em><em class="italic">brace formatting</em></li>
<li><em class="italic">Your indentation doesn’t match mine. I use spaces instead </em><em class="italic">of tabs</em></li>
<li><em class="italic">I’d like it if you’d use </em><code>var</code><em class="italic"> instead of </em><em class="italic">the Type</em></li>
</ul>
<p>In these scenarios, the developer in question ignores the <em class="italic">substance</em> of the change and instead focuses on the <em class="italic">style</em> of the change – specifically where the style differs from their preferences.</p>
<p>The cure for this is to adopt a set of code standards that you and your team agree upon. These standards establish what your team cares about with regard to new code going forward. The standards might also contain the rationale behind the team’s style and code preferences.</p>
<p>Some examples of code <a id="_idIndexMarker912"/>standard decisions might include the following:</p>
<ul>
<li>We use file-scoped namespaces because they result in less nesting</li>
<li>Unit test classes should be named after the classes they test</li>
<li>We prefer using target-typed <code>new</code> when instantiating objects</li>
<li>Class definitions should be clearly organized and start with fields, then move on to constructors, properties, and finally methods</li>
</ul>
<p>These standards don’t have to be so rigid that developers don’t have any decisions to make or live in constant fear of violating them.</p>
<p>Your code standards should be prescriptive enough that they address the major points of contention and confusion. This helps you focus on creating and maintaining code in a way that maximizes your ability to provide value to the organization.</p>
<h3>How code standards influence refactoring</h3>
<p>When<a id="_idIndexMarker913"/> you have a definitive set of standards that you and your team agree on, it opens the floodgates for refactoring.</p>
<p>Without a set of standards, when you talk about old code, you might say “I don’t like this very much,” or “This isn’t how I would have written this,” or “This seems poorly put together.”</p>
<p>These things may be true, but they aren’t compelling arguments for refactoring.</p>
<p>Instead, when <a id="_idIndexMarker914"/>you can say “This class violates our code standards in these areas,” the conversation becomes much more productive. This is especially true when you can establish that some of your standards are critical while others are important but less critical.</p>
<p>There are certain aspects of code standards that I believe are critical and worth going in and making changes to just to get the code onto the new standards. For me, these areas often revolve around the handling of <code>IDisposable</code> resources and using proper exception management practices.</p>
<p>Whatever you and your team agree upon is critical. These standards will impact your priorities and the decisions you make while maintaining code. Standards violations can be issues that get dedicated work items assigned to people to go in and fix without any other reason for touching the code in question. We’ll talk more about this in the final chapter of this book.</p>
<h3>Applying code standards to existing code</h3>
<p>The <a id="_idIndexMarker915"/>non-critical standards are used to guide the work developers do every day. All code changes are expected to comply with these code standards. Often, the standards encourage developers to update nearby pre-existing code that is out of compliance.</p>
<p>For example, your team might have a code standard to not use the <code>var</code> keyword when you can help it (or to always prefer <code>var</code>, if that’s your jam). The team’s expectation would be that as developers write new code, the new code will comply with this rule.</p>
<p>When standards are defined, teams sometimes expect that code near the code you’re changing will also be updated to comply with the standards. This is particularly true for code in the same method. After all, you’ve spent effort testing your new code to validate the changes you made. This testing effort can help catch any issues introduced by refactoring the rest of the method.</p>
<p>Over time, these code standards will help reduce the rate at which your team accumulates technical debt. This ongoing improvement of the existing code will also help pay down existing technical debt in frequently changed areas.</p>
<h1 id="_idParaDest-346"><a id="_idTextAnchor345"/>Establishing code standards</h1>
<p>So, now<a id="_idIndexMarker916"/> that I’ve convinced you how code standards can reduce conflict in your team, focus code reviews, and guide refactoring efforts, let’s talk about where these standards come from and how we adopt them in our teams.</p>
<h3>Collective code standards</h3>
<p>Every software<a id="_idIndexMarker917"/> development team already has code standards.</p>
<p>I say this because each software development team already has, by definition, at least one developer. Every developer, whether they’re aware of it or not, has their own set of internalized code standards.</p>
<p>They may not have thought about their preferences or be able to list them out, but if you look at each developer on your team and the code they write in isolation, there will be a certain amount of consistency to it.</p>
<p>The problem teams encounter is not that they don’t have standards, but rather that they have too many standards. Each developer operates from their own internal set of standards and preferences and the team must now come together and interact with each other’s unique styles and preferences.</p>
<p>Usually, teams will gravitate toward certain styles as developers tend to mimic the existing style in code files. As time goes on and teams grow, there are usually conflicts over certain choices. When this happens, your team will need to decide whether the creative freedom of not having defined any collective standards is worth the friction and distractions caused by these differing preferences.</p>
<p>Eventually, most teams formalize a set of standards around the things that really matter to those teams. Let’s talk about what should go on that list.</p>
<h3>Selecting what is important</h3>
<p>Programming is a creative endeavor and so we don’t want to place too many restrictions on how <a id="_idIndexMarker918"/>developers write code. On the other hand, when there are too few rules, it can result in somewhat eclectic areas of code that are suited to one developer’s preferences but not the larger team.</p>
<p>So, how does a development team figure out what should go in its standards?</p>
<p>I like to start with the standards that keep teams safe. These involve following established best practices such as those defined in the .NET’s <strong class="bold">Framework Design Guidelines</strong> (see <em class="italic">Further reading</em> for more information). These practices are less oriented around individual opinions. This lets them have a high impact while being relatively free of drama as a result.</p>
<p>Next, look at the major sticking points your team bumps into in code review. If you’re sick of discussions around tabs versus spaces – whether or not the <code>{</code> belongs on its own line, or the use of <code>var</code> – these are things to consider adding to your team’s standards.</p>
<p>If these areas are major sources of disagreements, you have a couple of choices:</p>
<ul>
<li>Pick a stance on the area of contention and adopt it as a team</li>
<li>Make having no official stance on the topic your team’s official position</li>
</ul>
<p>Picking a stance and adopting it as a team may cause temporary arguments and hurt feelings. In the long term, adopting a stance tends to be beneficial since your team can operate with a consistent style. While developers may feel less appreciated or valued by the position, most tend to naturally warm to the new style over time, though this can lead to turnover in some cases when developers feel very strongly about a topic or that their opinions weren’t considered.</p>
<p>You may not think that explicitly saying your team has no stance on an aspect of code would be very beneficial. However, I’ve seen this approach have a massive impact on the conversations teams have. By explicitly having no policy on the topic, the contentious topic now becomes something quickly resolved.</p>
<p>Instead of debating whether <code>var</code> belongs in your code, the team can point to its standards that say individual developers can make their own choices on this matter. This moves your team past contentious areas and on to more productive topics. The primary downside is that your overall code will be less consistent.</p>
<p class="callout-heading">The value of consistency</p>
<p class="callout">Code that follows consistent styling and design decisions feels more professional, makes it easier for developers to work in areas they’ve not worked in before and keeps developers productive and focused on the function of code instead of its form.</p>
<p>Make sure <a id="_idIndexMarker919"/>the engineering team is represented when creating code standards and determining what goes in those standards. This can be done by involving the entire team or by picking a subset that represents the various experience levels and preferences of the engineers in your organization. Additionally, if you have individuals who may react particularly strongly to a new style, make sure their concerns are fully heard and – where possible – involve them in the process.</p>
<h3>Sources of code standards</h3>
<p>Sometimes, creating a<a id="_idIndexMarker920"/> standard of your own can be too difficult or polarizing, or you may find that you don’t know where to start when creating code standards.</p>
<p>When this happens, I recommend starting from an established set of code standards and customizing those as needed.</p>
<p>In <a href="B21324_12.xhtml#_idTextAnchor259"><em class="italic">Chapter 12</em></a>, we covered the built-in code analysis rulesets and how you can progressively move your ruleset from the latest ruleset to the latest minimum, then the latest recommended, and finally all the latest rulesets. These code analysis rules can help enforce best practices.</p>
<p>If you’d like a little more formality to things, Microsoft has documented C# coding conventions and framework design guidelines that give you a good starting point for your team. Both documents are referenced at the end of this chapter in the <em class="italic">Further reading</em> section and are fantastic, evergreen sources of wisdom around .NET and C#.</p>
<h3>Evolving code standards</h3>
<p>I <a id="_idIndexMarker921"/>mention “evergreen” because C# is not a dormant language. Every November, Microsoft ships new versions of C# with new language features building upon the previous year’s improvements. This makes the C# language feel more organic as it evolves over time.</p>
<p>Additionally, the context in which we program changes over time. When .NET was first introduced, it was essentially a productivity improvement for developers primarily performing Windows desktop development. Since then, we’ve seen .NET become open source and cross-platform. At the same time, many organizations have migrated from on-premises data centers as cloud computing on platforms such as Azure and AWS has become the norm.</p>
<p>Things <a id="_idIndexMarker922"/>that were best practices back in the original days of C# have since faded in popularity as new language features have arrived to take their place and as the .NET platform grows new features.</p>
<p>I’ve been working with .NET since the beginning and have felt this in my own coding style. Throughout this book, I’ve discussed <code>var</code> because it’s an easy language feature to talk about, but it is a good example of how C# changes over time.</p>
<p>Prior to <code>var</code>, you’d declare a dictionary of <code>Guid</code> keys and <code>int</code> values as follows:</p>
<pre class="source-code">
Dictionary&lt;Guid, int&gt; data = new Dictionary&lt;Guid, int&gt;();</pre>
<p>When <code>var</code> was introduced, the standard shifted to using <code>var</code> to simplify your declaration since the Type was obvious:</p>
<pre class="source-code">
<strong class="bold">var</strong> data = new Dictionary&lt;Guid, int&gt;();</pre>
<p>This resulted in less duplicated syntax and improved developer productivity while still keeping the Type obvious.</p>
<p>With the recent addition of target-typed <code>new</code>, my preference changed to use it as follows:</p>
<pre class="source-code">
<strong class="bold">Dictionary&lt;Guid, int&gt; data = new();</strong></pre>
<p>I’m sharing my own personal journey on standards here because it’s a microcosm of what engineering teams will go through.</p>
<p>You’ll adapt to standards and then C# will change over time, and you’ll adjust your standards to keep up. What you may consider a “best” practice right now may later turn out to not work well a few months into implementation. It’s also natural for the obstacles facing your team to change. When this happens, this forces you and your team to adopt new strategies to overcome these obstacles.</p>
<p>It’s okay to change your standards over time. That’s normal and is a sign of an evolving language and the evolving context of our daily programming jobs.</p>
<h3>Integrating standards into your processes</h3>
<p>Code standards affect a few different places in software development, from how you approach <a id="_idIndexMarker923"/>building new features to the way in which you maintain code.</p>
<p>Your code standards should be clearly documented and stored in a central location, such as a team wiki or shared document. These standards should be communicated to new developers who join the team to help them familiarize themselves with the team’s expectations on code standards.</p>
<p>Code standards should also be reinforced in the code review process after all other concerns on the substance of code changes are discussed. These issues should be resolved before the code is approved and the work item is completed, but this shouldn’t be done in a punitive manner.</p>
<p>It’s important to understand that internalizing code standards takes some time for new developers on the team. It’s normal for it to take a few months with the team before your new developers think in terms of the team’s standards.</p>
<p>One thing that can help is to incorporate tools into the process that make it easy for your team to validate whether its code meets standards before it sends the code on for peer review. Code analysis rules and Roslyn Analyzers can help with this, but Visual Studio places a few more tools at your disposal that can help standardize code before code reaches human review: code formatting and <code>.</code><code>editorconfig</code> files.</p>
<h1 id="_idParaDest-347"><a id="_idTextAnchor346"/>Formatting and code cleanup in Visual Studio</h1>
<p>It turns out that <a id="_idIndexMarker924"/>Visual Studio can automatically arrange and even clean up <a id="_idIndexMarker925"/>your code in a consistent manner through built-in features.</p>
<h3>Formatting documents</h3>
<p>One <a id="_idIndexMarker926"/>of the easiest ways to do this is with the <strong class="bold">Format Document</strong> feature, either by pressing <em class="italic">Ctrl</em> + <em class="italic">K</em> and then <em class="italic">Ctrl</em> + <em class="italic">D</em> or by opening<a id="_idIndexMarker927"/> the <strong class="bold">Edit</strong> menu, then going to <strong class="bold">Advanced</strong> and selecting <strong class="bold">Format Document</strong>, as shown in <em class="italic">Figure 16</em><em class="italic">.1</em>:</p>
<div><div><img alt="Figure 16.1 – Formatting the active editor document" src="img/B21324_16_01.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 16.1 – Formatting the active editor document</p>
<p>This will <a id="_idIndexMarker928"/>change the code in your current file to match the preferences you’ve configured in Visual Studio.</p>
<p>These settings <a id="_idIndexMarker929"/>can be configured by opening the <strong class="bold">Tools</strong> menu and then selecting <strong class="bold">Options…</strong>. From there, expand the <strong class="bold">Text Editor</strong>, <strong class="bold">C#</strong>, <strong class="bold">Code Style</strong>, and <strong class="bold">Formatting</strong> nodes until you see the various preferences for indentation, new lines, spacing, and wrapping.</p>
<p>These settings blades allow you to configure the formatting preferences of Visual Studio and preview the formatting choices, as shown in <em class="italic">Figure 16</em><em class="italic">.2</em>:</p>
<div><div><img alt="Figure 16.2 – Changing how Visual Studio formats catch statements" src="img/B21324_16_02.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 16.2 – Changing how Visual Studio formats catch statements</p>
<p>Once you’ve customized <a id="_idIndexMarker930"/>your settings, these settings will be used any time you use the <strong class="bold">Format </strong><strong class="bold">Document</strong> feature.</p>
<p>Many <a id="_idIndexMarker931"/>developers learn the <em class="italic">Ctrl</em> + <em class="italic">K</em> and <em class="italic">Ctrl</em> + <em class="italic">D</em> shortcuts to format documents early on and use them reflexively, but you can actually get Visual Studio to apply code cleanup automatically.</p>
<h3>Automatically formatting documents</h3>
<p>Visual Studio<a id="_idIndexMarker932"/> has a <strong class="bold">Code Cleanup</strong> feature <a id="_idIndexMarker933"/>that allows you to<a id="_idIndexMarker934"/> format your code either manually or automatically whenever the file is saved.</p>
<p>This is done through <code>using</code> statements, sort the members in your classes into a more consistent order, and apply your code formatting preferences to a file.</p>
<p>To <a id="_idIndexMarker935"/>configure a code cleanup profile, go to the <strong class="bold">Options</strong> dialog again and this time, find <strong class="bold">Code Cleanup</strong> in the <strong class="bold">Text Editor</strong> node, as shown in <em class="italic">Figure 16</em><em class="italic">.3</em>:</p>
<div><div><img alt="Figure 16.3 – Enabling code cleanup when files are saved" src="img/B21324_16_03.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 16.3 – Enabling code cleanup when files are saved</p>
<p>From here, you can check <strong class="bold">Run Code Cleanup profile on Save</strong> to have your cleanup profile automatically applied.</p>
<p>I also recommend you click <strong class="bold">Configure Code Cleanup</strong> to view your cleanup profiles.</p>
<p>This shows you the fixers that will be applied as part of each profile, as shown in <em class="italic">Figure 16</em><em class="italic">.4</em>, and allows you to configure what is and isn’t included in the code cleanup action:</p>
<div><div><img alt="Figure 16.4 – Configuring code cleanup profiles" src="img/B21324_16_04.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 16.4 – Configuring code cleanup profiles</p>
<p>Automatically <a id="_idIndexMarker936"/>cleaning up code on<a id="_idIndexMarker937"/> save<a id="_idIndexMarker938"/> can be helpful, but it does have <a id="_idIndexMarker939"/>some downsides. If your code hasn’t been cleaned up in a while, your cleanup action could appear to create many changes in the file. This can be confusing in git when multiple authors are trying to modify the same file or even see what has changed.</p>
<h3>Configuring code style settings</h3>
<p>Believe <a id="_idIndexMarker940"/>it or not, when we covered the C# settings for new lines and indentation earlier, this wasn’t the limit of what Visual Studio can do.</p>
<p>Visual Studio provides a <strong class="bold">Code Style</strong> settings section that allows you to configure your individual preferences around most language features found in C#.</p>
<p>These settings are found in the <strong class="bold">Options</strong> dialog under <strong class="bold">Text Editor</strong>, <strong class="bold">C#</strong>, <strong class="bold">Code Style</strong>, and then <strong class="bold">General</strong>, as shown in <em class="italic">Figure 16</em><em class="italic">.5</em>:</p>
<div><div><img alt="Figure 16.5 – Configuring Code Style rules in Visual Studio" src="img/B21324_16_05.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 16.5 – Configuring Code Style rules in Visual Studio</p>
<p>In this user<a id="_idIndexMarker941"/> interface, you can configure which rules you care about, what your preferences are on each rule, and how much you care about each rule. Also notice the <strong class="bold">Generate .editorconfig file from settings</strong> button, as we’ll talk about that more later.</p>
<p>For each rule, you get to select whether the rule only appears as a refactoring option, whether Visual Studio subtly suggests the rule through green underlines on identifiers, or whether Visual Studio should be more aggressive, such as using compiler warnings or compiler errors for violations from standards.</p>
<p>There are a lot of these settings, but they allow you to fine-tune your individual preferences for which C# features you prefer and how you like them formatted.</p>
<p>However, these are your <em class="italic">individual</em> settings that get applied to the code you work with on your own machine. In the next section, we’ll talk about how to make these settings apply to your entire team.</p>
<h1 id="_idParaDest-348"><a id="_idTextAnchor347"/>Applying code standards with EditorConfig</h1>
<p>Let’s take a<a id="_idIndexMarker942"/> look at how you can take the same<a id="_idIndexMarker943"/> code style settings found in the options dialog and attach them to a project through an <code>.</code><code>editorconfig</code> file.</p>
<p>The <code>.editorconfig</code> files that contain style and language usage rules <a id="_idIndexMarker944"/>that apply to your project. Any violation of your <code>EditorConfig</code> rules will result in compiler warnings and suggestions in the Visual Studio editor.</p>
<p class="callout-heading">EditorConfig files outside of Visual Studio</p>
<p class="callout">At the time of this writing, <code>.editorconfig</code> files work in Visual Studio and JetBrains Rider natively. In VS Code, EditorConfig files are supported as long as you install the C# Dev Kit and the EditorConfig for VS Code extension. See the <em class="italic">Further reading</em> section for instructions on enabling these features in VS Code and JetBrains Rider.</p>
<p>The key benefit of <code>EditorConfig</code> files is that they allow all developers working on a project to work with a consistent set of formatting and styling preferences.</p>
<h2 id="_idParaDest-349"><a id="_idTextAnchor348"/>Reviewing our starter code</h2>
<p>The code we’ll be formatting <a id="_idIndexMarker945"/>lives in our <a href="B21324_16.xhtml#_idTextAnchor341"><em class="italic">Chapter 16</em></a> solution, which has a <code>FlightQueryDecoder</code> console app and an associated <code>xUnit</code> test project. This code is minimal for this chapter and revolves around the <code>FlightQueryParser</code> class.</p>
<p>Let’s start with the first half of <code>FlightQueryParser</code>, which parses a flight search string such as <code>AD08FEBDENLHR</code> into a <code>FlightQuery</code> object:</p>
<pre class="source-code">
namespace Packt.FlightQueryDecoder;
public class FlightQueryParser
{
  public FlightQuery ParseQuery(string query) {
    if (query.StartsWith("AD") &amp;&amp; query.Length == 13)
    {
      var flightQuery = new FlightQuery {
        Date = DateTime.Parse(query.Substring(2, 5)),
        Origin = query.Substring(7, 3),
        Destination = query.Substring(10, 3)
      };
      return flightQuery;
    }
    else {
      throw new ArgumentException("Invalid query format");
    }
  }</pre>
<p>The actual<a id="_idIndexMarker946"/> logic here isn’t the focus. What I want to highlight to you is the inconsistency in how the code is formatted within the block.</p>
<p>Let’s see the other half of the file, which takes a flight search result string such as <code>DEN LHR 05:50P 09:40A E0/789 8:50</code> and converts it to a <code>FlightQueryResult</code>:</p>
<pre class="source-code">
  public FlightQueryResult ParseResult(string result)
  {
    var fqr = new FlightQueryResult();
    var segments = result.Split(' ',
      StringSplitOptions.RemoveEmptyEntries
      | StringSplitOptions.TrimEntries);
    fqr.Origin = segments[0];
    fqr.Destination = segments[1];
    string today = DateTime.Today.ToShortDateString();
    fqr.DepartureTime = DateTime.Parse(
      today + " "+segments[2] + 'M');
    string seg3 = segments[3];
    fqr.ArrivalTime = DateTime.Parse($"{today} {seg3}M");
    fqr.AircraftTypeDesignator = segments[4];
    fqr.FlightDuration = TimeSpan.Parse(segments[5]);
    return fqr;
  }
}</pre>
<p>While this code is <a id="_idIndexMarker947"/>deliberately bad and inconsistently formatted to serve as an example, I’m sure you’ve seen many larger files in the real world with equally inconsistent styling.</p>
<p>Now that we’ve introduced this code with its different styling choices, let’s add an <code>.editorconfig</code> file to the project and see how that can help enforce styles.</p>
<h2 id="_idParaDest-350"><a id="_idTextAnchor349"/>Adding an EditorConfig</h2>
<p>To <a id="_idIndexMarker948"/>add the <code>.editorconfig</code> file, right-click on the <code>Packt.FlightQueryDecoder</code> project and choose <strong class="bold">Add</strong> and then <strong class="bold">New EditorConfig</strong> or <strong class="bold">New </strong><strong class="bold">EditorConfig (IntelliCode)</strong>.</p>
<p class="callout-heading">What is EditorConfig (IntelliCode)?</p>
<p class="callout">There’s a difference between the <code>.editorconfig</code> file with the default options, whereas the IntelliCode choice analyzes your project and generates an <code>.editorconfig</code> file from the conventions it observes in your current code. Both are viable options for creating a starting point for your projects.</p>
<p>Depending on which option you selected, you may need to select which folder the <code>.editorconfig</code> file should live in. If you’re prompted, select the default choice of the <code>Packt.FlightQueryDecoder</code> folder.</p>
<p>Once<a id="_idIndexMarker949"/> this completes, you should see a new <code>.editorconfig</code> file present in your project in <strong class="bold">Solution Explorer</strong>.</p>
<p>Before we go on to work with this <code>.editorconfig</code> file, it’s worth pointing out that the <code>.editorconfig</code> file based on your current code style choices. This allows you to customize your styles and then create an <code>.editorconfig</code> file out of these choices.</p>
<p>Now that we have an <code>.editorconfig</code> file, let’s customize it.</p>
<h2 id="_idParaDest-351"><a id="_idTextAnchor350"/>Customizing EditorConfigs</h2>
<p>Double-click on the <code>.editorconfig</code> file to open its properties view.</p>
<p>You’ll see <a id="_idIndexMarker950"/>an editor with tabs allowing you to customize various properties related to white space, code style, naming style, and Roslyn Analyzers.</p>
<p>There are a lot of options here, so we’ll focus on just a few very specific ones.</p>
<p>Go to the <strong class="bold">Code Style</strong> tab and then scroll down to the bottom for the <strong class="bold">var </strong><strong class="bold">preferences</strong> group.</p>
<p>From here, you can state your team’s preferences and the severity of violations of those preferences. For example, if your team wants to avoid <code>var</code>, you could set all three <code>var</code> rules to <strong class="bold">Prefer explicit type</strong> and increase the severity to <strong class="bold">Warning</strong> or <strong class="bold">Error</strong>, as shown in <em class="italic">Figure 16</em><em class="italic">.6</em>:</p>
<div><div><img alt="Figure 16.6 – Customizing the var preferences for your project" src="img/B21324_16_06.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 16.6 – Customizing the var preferences for your project</p>
<p>Save this<a id="_idIndexMarker951"/> file and go back into <code>FlightQueryParser.cs</code>, and you should now see warnings and errors in your editor for violations of these rules, as seen in <em class="italic">Figure 16</em><em class="italic">.7</em>:</p>
<div><div><img alt="Figure 16.7 – Visual Studio warnings against using var based on code style rules" src="img/B21324_16_07.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 16.7 – Visual Studio warnings against using var based on code style rules</p>
<p>These rule violations do not cause your code to not compile but they do appear in the <strong class="bold">Error List</strong> view, as shown in <em class="italic">Figure 16</em><em class="italic">.8</em>:</p>
<div><div><img alt="Figure 16.8 – Code violations appearing in Error List" src="img/B21324_16_08.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 16.8 – Code violations appearing in Error List</p>
<p>Because <code>.editorconfig</code> files are added to source control when you commit your code, other <a id="_idIndexMarker952"/>developers on your team will pull down that file and see the exact same styling preferences and warnings you see on your machine.</p>
<p>This makes code standards apparent during the development process and reduces the odds of a peer review of important code changes breaking down into a discussion of the appropriate placement of opening curly braces or the use of <code>var</code>.</p>
<h1 id="_idParaDest-352"><a id="_idTextAnchor351"/>Summary</h1>
<p>Code standards are important for helping your team focus on productive things and ensuring source code can be easily maintained by all developers on your team.</p>
<p>While code standards don’t need to include everything, it can be helpful to codify stances on commonly contested items or best practices your team wants to make sure absolutely every change follows.</p>
<p>Visual Studio provides a number of features that help ensure a consistent and high-quality codebase including code formatting, code cleanup profiles, formatting on save, code analysis warning profiles, code styles at the editor level, and EditorConfigs to configure code styles inside of your editor.</p>
<p>In the final chapter of this book, we’ll discuss refactoring code as part of a larger organization and as part of an agile software development team.</p>
<h1 id="_idParaDest-353"><a id="_idTextAnchor352"/>Questions</h1>
<ol>
<li>How do you determine what code standards your team should adopt?</li>
<li>What are some ways you can handle disagreements on style rules?</li>
<li>What are some options for configuring how Visual Studio formats code?</li>
<li>What does the <strong class="bold">New EditorConfig (IntelliCode)</strong> option do?</li>
</ol>
<h1 id="_idParaDest-354"><a id="_idTextAnchor353"/>Further reading</h1>
<p>You can find more information about materials from this chapter at these URLs:</p>
<ul>
<li><em class="italic">Framework design </em><em class="italic">guidelines</em>: <a href="https://learn.microsoft.com/en-us/dotnet/standard/design-guidelines/">https://learn.microsoft.com/en-us/dotnet/standard/design-guidelines/</a></li>
<li><em class="italic">.NET coding style </em><em class="italic">guidelines</em>: <a href="https://learn.microsoft.com/en-us/dotnet/csharp/fundamentals/coding-style/coding-conventions">https://learn.microsoft.com/en-us/dotnet/csharp/fundamentals/coding-style/coding-conventions</a></li>
<li><em class="italic">Create portable, custom editor settings with </em><em class="italic">EditorConfig</em>: <a href="https://learn.microsoft.com/en-us/visualstudio/ide/create-portable-custom-editor-options">https://learn.microsoft.com/en-us/visualstudio/ide/create-portable-custom-editor-options</a></li>
<li><em class="italic">Beginner friendly EditorConfig </em><em class="italic">settings</em>: <a href="https://newdevsguide.com/2022/11/22/beginner-friendly-csharp/">https://newdevsguide.com/2022/11/22/beginner-friendly-csharp/</a></li>
<li><em class="italic">Using EditorConfig in VS Code with C# Dev </em><em class="italic">Kit</em>: <a href="https://code.visualstudio.com/docs/csharp/formatting-linting#_how-to-support-editorconfig-with-c-dev-kit">https://code.visualstudio.com/docs/csharp/formatting-linting#_how-to-support-editorconfig-with-c-dev-kit</a></li>
<li><em class="italic">Using EditorConfig in JetBrains </em><em class="italic">Rider</em>:<em class="italic"> </em><a href="https://www.jetbrains.com/help/rider/Using_EditorConfig.html">https://www.jetbrains.com/help/rider/Using_EditorConfig.html</a></li>
</ul>
</div>
</body></html>