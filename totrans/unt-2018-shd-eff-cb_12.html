<html><head></head><body>
        

                            
                    <h1 class="header-title" id="calibre_pb_0">Shader Graph</h1>
                
            
            
                
<p class="calibre3">In this chapter, you will learn the following recipes:</p>
<ul class="calibre11">
<li class="calibre12">Creating a Shader Graph project</li>
<li class="calibre12">Implementing a simple a Shader Graph</li>
<li class="calibre12">Exposing properties to the Inspector via Shader Graph</li>
<li class="calibre12">Implementing a glowing highlight system</li>
</ul>


            

            
        
    

        

                            
                    <h1 class="header-title" id="calibre_pb_0">Introduction</h1>
                
            
            
                
<p class="calibre3">First released in Unity 2018.1, Shader Graph allows you to create shaders using a visual interface by connecting nodes instead of having to dive into the code. This will allow developers, including artists, to be able to create shaders in a similar manner to material editors in 3D modeling programs such as Autodesk Maya and Blender, or the material editor in the Unreal Engine. At the time of writing, Shader Graph is only supported for certain kinds of projects and doesn't allow the same flexibility as writing the shaders from scratch.</p>


            

            
        
    

        

                            
                    <h1 class="header-title" id="calibre_pb_0">Creating a Shader Graph project</h1>
                
            
            
                
<p class="calibre3">Unlike all of the previous shaders we have written, the Shader Graph tool requires users to have a project that is using the Lightweight Render Pipeline. The Lightweight Render Pipeline is meant for lower-end hardware, and is focused on drawing with a single-pass and decreasing the draw count wherever possible. For this first recipe, you will ensure that your project is set up correctly, by using the settings that Shader Graph needs.</p>


            

            
        
    

        

                            
                    <h1 class="header-title" id="calibre_pb_0">How to do it...</h1>
                
            
            
                
<p class="calibre3">To get started, we first need to create our new project:</p>
<ol class="calibre15">
<li value="1" class="calibre12">From the Unity Hub, when creating a new project, set the Template to Lightweight RP (Preview):</li>
</ol>
<div><img src="img/00235.jpeg" class="calibre25"/></div>
<p class="calibre26">Shader Graph is currently only compatible with the Lightweight Render Pipeline, so this ensures that the graph will work correctly.</p>
<p>Shader Graph is only available with Unity 2018.1 and above. If you are using a prior version, make sure to upgrade before continuing with this chapter.</p>
<ol start="2" class="calibre15">
<li value="2" class="calibre12">Once selected, press the Create project button:</li>
</ol>
<div><img src="img/00236.jpeg" class="calibre25"/></div>
<p class="calibre26">  As you can see, this project already includes a number of assets inside it.</p>
<ol start="3" class="calibre15">
<li value="3" class="calibre12">When the Unity Editor opens, the Shader Graph is not included by default in the Unity editor. To access it, you'll need to make use of the Unity Package Manager. From the top menu, go to Window | Package Manager. The Package Manager will allow you to install or uninstall different aspects of Unity. You'll notice two buttons, one for packages that are in the project (In Project) and one for all the packages that are currently available to be downloaded (All).</li>
</ol>
<ol start="4" class="calibre15">
<li value="4" class="calibre12">From the Package Manager window, hit the All button, scroll down until you see the Shader Graph button, and select it. From there, click on the Install 1.1.9-preview button, and wait for it to complete the download and import the content:</li>
</ol>
<div><img src="img/00237.jpeg" class="calibre155"/></div>
<ol start="5" class="calibre15">
<li value="5" class="calibre12">Once everything has been downloaded, go to the Project tab, select Create | Shader, and see if you can find the following new options:
<ul class="calibre80">
<li class="calibre12">PBR Graph</li>
<li class="calibre12">Sub Graph</li>
<li class="calibre12">Unlit Graph</li>
</ul>
</li>
</ol>


            

            
        
    

        

                            
                    <h1 class="header-title" id="calibre_pb_0">How it works...</h1>
                
            
            
                
<p class="calibre3">As we mentioned before, Shader Graph is currently only compatible with the Lightweight Render Pipeline. The easiest way to ensure that a project is using that pipeline is by selecting it as the Template when creating the project.</p>
<p class="calibre3">Once the project has been created, we make use of the newly added Package Manager, which allows you to install or uninstall different aspects of Unity. In this case, you have added the Shader Graph functionality.</p>
<p class="calibre3">If everything's included, Shader Graph has been installed successfully, and you should be able to work on the rest of the recipes for this chapter!</p>


            

            
        
    

        

                            
                    <h1 class="header-title" id="calibre_pb_0">Implementing a simple a Shader Graph</h1>
                
            
            
                
<p class="calibre3">To get acquainted with the interface of the Shader Graph, let's create something similar to what we have seen before by sampling a texture to create a simple shader.</p>


            

            
        
    

        

                            
                    <h1 class="header-title" id="calibre_pb_0">Getting ready</h1>
                
            
            
                
<p class="calibre3">Ensure that you have created a project using the Lightweight Render Pipeline, as described in the <em class="calibre14">Create a Shader Graph project</em> recipe. Afterward, complete the following steps:</p>
<ol class="calibre15">
<li value="1" class="calibre12">Create a new scene, if you haven't done so already, by going to File | New Scene</li>
<li value="2" class="calibre12">Afterward, we need to have something to show our shader, so let's create a new sphere by going to Game Object | 3D Object| Sphere:</li>
</ol>
<div><img src="img/00238.jpeg" class="calibre28"/></div>


            

            
        
    

        

                            
                    <h1 class="header-title" id="calibre_pb_0">How to do it...</h1>
                
            
            
                
<p class="calibre3">We will start off by creating a simple shader graph.</p>
<ol class="calibre15">
<li value="1" class="calibre12">From the Project window, create a new shader by going to Create | Shader | PBR Graph, and name it <kbd class="calibre13">SimpleGraph</kbd>.</li>
<li value="2" class="calibre12">Afterward, create a new material by going to Create | Material (I named mine <kbd class="calibre13">SimpleGraphMat</kbd>). Next, assign the shader to the material by selecting the Material, then from the Inspector tab, you should select the Shader dropdown at the top and select graphs/SimpleGraph.</li>
</ol>
<p>As always, you can also drag and drop the shader on top of the material as well.</p>
<ol start="3" class="calibre15">
<li value="3" class="calibre12">Next, drag and drop the material onto our spherical object in the scene so we can see our shader being used in action:</li>
</ol>
<div><img src="img/00239.jpeg" class="calibre25"/></div>
<ol start="4" class="calibre15">
<li value="4" class="calibre12">Now that the setup is done, we can start creating the graph. If you select the shader, you should notice, the Inspector tab that there is a button that says Open Shader Editor. Click on the button and the Shader Graph Editor will open automatically:</li>
</ol>
<div><img src="img/00240.jpeg" class="calibre25"/></div>
<p>To move within the Shader Graph Editor, you can use the mouse wheel to zoom in and out, and you can hold the middle mouse button and drag to pan the graph. Alternatively, you can also use <em class="calibre21">Alt</em> + left mouse button.</p>
<ol start="5" class="calibre15">
<li value="5" class="calibre12">To get started, let's add a texture. Right-click to the left of the PBR Master and select Create Node. From there, you'll see a menu that allows you to either type in the name of a node or select from the menus. To go through the menus, select Input | Texture| Sample Texture 2D. Alternatively, you can type in <kbd class="calibre13">tex</kbd>, then select the Sample Texture 2D option using the arrow keys, and then press <em class="calibre2">Enter</em>:</li>
</ol>
<p>You can also create a new node by moving your mouse over where you want to create one and pressing the Space key.</p>
<div><img src="img/00241.jpeg" class="calibre25"/></div>
<p>Feel free to click and drag any of the nodes on the Shader Graph to make it easier to see. </p>
<ol start="6" class="calibre15">
<li value="6" class="calibre12">On the left-hand side of the Sample Texture 2D node, click on the circle with the dot in it to assign the texture as something that we can use (I used the Ground_Albedo property included with the project):</li>
</ol>
<div><img src="img/00242.jpeg" class="calibre156"/></div>
<p class="calibre26">Afterward, you should see the data from the texture given in an image under the node. </p>
<ol start="7" class="calibre15">
<li value="7" class="calibre12">Click and drag the pink circle on the right-hand side of the Sample Texture 2D node to the input Albedo node on the PBR Master node:</li>
</ol>
<div><img src="img/00243.jpeg" class="calibre25"/></div>
<p class="calibre26">Just like we've learned in previous chapters, we can give a <kbd class="calibre13">fixed4</kbd> to a <kbd class="calibre13">fixed3</kbd> and it will just disregard the fourth parameter. </p>
<p>If you are ever interested in what a particular node does or what the properties stand for, feel free to right click on it and select Open Documentation. It will open a window that will give you a description of what the node does.</p>
<ol start="8" class="calibre15">
<li value="8" class="calibre12">Click on the Save Asset button on the top menu and then return to the Unity editor:</li>
</ol>
<div><img src="img/00244.jpeg" class="calibre25"/></div>
<p class="calibre3">As you can see, the shader has now been updated to contain the information from the Shader Graph editor!</p>


            

            
        
    

        

                            
                    <h1 class="header-title" id="calibre_pb_0">How it works...</h1>
                
            
            
                
<p class="calibre3">From Shader Graph, we are introduced to the first nodes we have encountered. Of note is the PBR Master section on the screen. This is where all of the information about the shader will go to. You may notice that the properties are very similar to the regular Standard Shader we've used in the past, and we can modify the properties in a similar manner now, but we can also create additional nodes and connect them together to create unique effects.</p>
<p class="calibre3">The Sample Texture2D node allows us to give the Texture property as an input and then give the data from it as an RGBA output on the right-hand side (things on the right side of a node are outputs while things on the left side are inputs, such as the Albedo property on the PBR Master node).</p>
<p class="calibre3">Note that the color of the circle from the Texture input is red (the T stands for texture), the output of RGBA is pink (the 4 stands for <kbd class="calibre13">fixed4</kbd>), and the input for the Albedo input of the PBR Master node is yellow (the 3 stands for <kbd class="calibre13">fixed3</kbd>). </p>


            

            
        
    

        

                            
                    <h1 class="header-title" id="calibre_pb_0">Exposing properties to the Inspector via Shader Graph</h1>
                
            
            
                
<p class="calibre3">It is great to be able to create graphs and set up their properties using the graph editor, but sometimes it is nice to use the same shader with a simple tweak in the same manner that we've used with the previous shaders we've created. To do this, we can make use of the blackboard panel.</p>


            

            
        
    

        

                            
                    <h1 class="header-title" id="calibre_pb_0">Getting ready</h1>
                
            
            
                
<p class="calibre3">Ensure that you have created the SimpleGraph shader in the previous recipe. Afterward, complete the following steps:</p>
<ol class="calibre15">
<li value="1" class="calibre12">From the Project tab, select the SimpleGraph shader and duplicate it by pressing <em class="calibre2">Ctrl</em> + <em class="calibre2">D</em>. Once duplicated, name the newly created shader <kbd class="calibre13">ExposeProperty</kbd>.</li>
<li value="2" class="calibre12">Next, create a new material (<kbd class="calibre13">ExposePropertyMat</kbd>) and set the shader it uses to the graphs/ExposeProperty selection.</li>
<li value="3" class="calibre12">Assign the material to the sphere in our scene:</li>
</ol>
<div><img src="img/00245.jpeg" class="calibre25"/></div>
<p class="calibre3">The project should look the same as what we had in the previous recipe since we are using a duplicate of the previous shader. </p>


            

            
        
    

        

                            
                    <h1 class="header-title" id="calibre_pb_0">How to do it...</h1>
                
            
            
                
<p class="calibre3">If you look at our shader from the Inspector tab, you may notice the Texture property with the Ground_Albedo image we assigned in the last recipe. A property like this could be something we want to modify, but, by default, it is grayed out so that we cannot change it without going into the Shader Graph. To adjust this, we can expose the property using the Blackboard aspect of the Shader Graph Editor:</p>
<ol class="calibre15">
<li value="1" class="calibre12">Double-click on the ExposeProperty shader to open up the Shader Graph:</li>
</ol>
<div><img src="img/00246.jpeg" class="calibre25"/></div>
<p class="calibre26">Notice, on the bottom left, the graphs/ExposeProperty blackboard menu. This will contain a list of all the parameters we are able to modify via the Inspector.</p>
<p>As you may already know, Shader Graph is brand new and as such is prone to issues, such as the Blackboard not being visible by default. Unfortunately, at this time, there's no way to turn it on and off through a menu. If you do not see the Blackboard, you might try to save your graph and return. Alternatively, you can reset your layout by going into Layout | Revert Factory Settings... </p>
<ol start="2" class="calibre15">
<li value="2" class="calibre12">From the blackboard panel, click on the + icon and select Texture:</li>
</ol>
<div><img src="img/00247.jpeg" class="calibre25"/></div>
<ol start="3" class="calibre15">
<li value="3" class="calibre12">From there, you can give the property a name (I used <kbd class="calibre13">TextureProperty</kbd>). Note that, under Default, you can assign a texture in the same way as done previously.</li>
<li value="4" class="calibre12">From there, to hook the property to our current shader, drag and drop the button with the property name on Shader Graph. Alternatively, you can right-click and select Create Node. Once at the menu, you can select Properties | Property: TextureProperty. Afterward, connect the TextureProperty output of the Property node to the Texture input of the Sample Texture 2D node:</li>
</ol>
<div><img src="img/00248.jpeg" class="calibre157"/></div>
<ol start="5" class="calibre15">
<li value="5" class="calibre12">Afterward, hit the Save Asset button and dive back into the Unity editor:</li>
</ol>
<div><img src="img/00249.jpeg" class="calibre158"/></div>
<p class="calibre3">Now, you should be able to assign the TextureProperty to whatever you want, through the Inspector, and you won't have to dive back into the graph to make those changes!</p>


            

            
        
    

        

                            
                    <h1 class="header-title" id="calibre_pb_0">How it works...</h1>
                
            
            
                
<p class="calibre3">The Blackboard menu allows you to create variables that are accessible from the Inspector. This works in a similar manner to the <kbd class="calibre13">Properties</kbd> block in previous chapters. Currently, it supports the following types:</p>
<ul class="calibre11">
<li class="calibre12">Vector1</li>
<li class="calibre12">Vector2</li>
<li class="calibre12">Vector3</li>
<li class="calibre12">Vector4</li>
<li class="calibre12">Color</li>
<li class="calibre12">Texture</li>
<li class="calibre12">Cubemap</li>
<li class="calibre12">Boolean</li>
</ul>
<p class="calibre3">Properties added to the Blackboard can be reordered by dragging them around, and each property can be renamed by double-clicking on the name. </p>
<p>For more information on the Blackboard, check out the following link: <a href="https://github.com/Unity-Technologies/ShaderGraph/wiki/Blackboard" class="calibre31">https://github.com/Unity-Technologies/ShaderGraph/wiki/Blackboard</a>.</p>


            

            
        
    

        

                            
                    <h1 class="header-title" id="calibre_pb_0">Implementing a glowing highlight system</h1>
                
            
            
                
<p class="calibre3">Now that we have some background information on how to build shaders, let's look at a real-world example of a shader we could potentially use. When playing certain kinds of games, you may notice that, when the player faces an object they can interact with, the object may glow such as in Dontnod Entertainment's <em class="calibre14">Life is Strange</em>, The Fullbright Company‎'s <em class="calibre14">Gone Home</em>, and even in recent mobile games such as Jam City's <em class="calibre14">Harry Potter Hogwarts Mystery</em>. This is something that we can easily do in Shader Graph, which will also allow us to see a non-trivial example of Shader Graph being used.</p>


            

            
        
    

        

                            
                    <h1 class="header-title" id="calibre_pb_0">Getting ready</h1>
                
            
            
                
<p class="calibre3">Ensure that you have created a project using the Lightweight Render Pipeline, as described in the <em class="calibre14">Creating a Shader Graph project</em> recipe. Afterward, complete the following steps:</p>
<ol class="calibre15">
<li value="1" class="calibre12">Create a new scene, if you haven't done so already, by going to File | New Scene</li>
<li value="2" class="calibre12">Afterward, we need to have something to show our shader, so let's create a new sphere by going to Game Object | 3D Object | Sphere</li>
</ol>


            

            
        
    

        

                            
                    <h1 class="header-title" id="calibre_pb_0">How to do it...</h1>
                
            
            
                
<p class="calibre3">We will start off by creating a simple shader graph:</p>
<ol class="calibre15">
<li value="1" class="calibre12">From the Project window, create a new shader by going to Create Shader PBR Graph, and name it <kbd class="calibre13">GlowGraph</kbd>.</li>
<li value="2" class="calibre12">Afterward, create a new material by going to Create | Material (I named mine <kbd class="calibre13">GlowGraphMat</kbd>). Next, assign the shader to the material by selecting the material, and then, from the Inspector tab, you should select the Shader dropdown at the top and select graphs/GlowGraph.</li>
<li value="3" class="calibre12">Then, drag and drop the material onto our sphere object in the scene, so we can see our shader being used in action.</li>
<li value="4" class="calibre12">Now that the setup is done, we can start creating the graph. If you select the shader, you should see that, from the Inspector tab, there will be a button that says Open Shader Graph. Click on the button and the Shader Graph Editor will open automatically.</li>
<li value="5" class="calibre12">Firstly, we will add a new node called a Fresnel (pronounced fer-nel) Effect. To add it, go to the left-hand side of the PBR Master node, right-click, and select Create Node. From there, type in <kbd class="calibre13">Fresnel</kbd>, and once it has been selected press the <em class="calibre2">Enter</em> key.</li>
</ol>
<p>The Fresnel Effect is often used to provide rim-lighting for objects. For more information on it, check out: <a href="https://github.com/Unity-Technologies/ShaderGraph/wiki/Fresnel-Effect-Node" class="calibre31">https://github.com/Unity-Technologies/ShaderGraph/wiki/Fresnel-Effect-Node</a>.</p>
<ol start="6" class="calibre15">
<li value="6" class="calibre12">Once created, connect the Out of the Fresnel Effect node to the Emission property of the PBR Master node.</li>
</ol>
<ol start="7" class="calibre15">
<li value="7" class="calibre12">To make it easier to tell what each node does, click on the grey color to the left of the Albedo property and change it to a different color, such as a bright pink:</li>
</ol>
<div><img src="img/00250.jpeg" class="calibre25"/></div>
<p class="calibre26">Notice how the Fresnel effect is applied on top of the Albedo color due to it using that value for the Emission property.</p>
<ol start="8" class="calibre15">
<li value="8" class="calibre12">We just want the edges of our object to glow, so change the <kbd class="calibre13">Power</kbd> property of the Fresnel Effect node to <kbd class="calibre13">4</kbd>. Currently, the light around our object is white, but we can make it a different color instead by multiplying it by a color.</li>
<li value="9" class="calibre12">To do this, go to the Blackboard and create a new color by clicking on the + icon and then selecting Color. Once created, give it a name (<kbd class="calibre13">HoverColor</kbd>) and then set the Default color.</li>
</ol>
<ol start="10" class="calibre15">
<li value="10" class="calibre12">Once created, drag and drop the property beneath the Fresnel Effect node in the same way we learned in the previous recipe:</li>
</ol>
<div><img src="img/00251.jpeg" class="calibre159"/></div>
<ol start="11" class="calibre15">
<li value="11" class="calibre12">Now, we need to multiply these together. Create a new node between them by selecting Math | Basic | Multiply. Connect the Out of the Fresnel Effect node to the A of the Multiply node. Then, connect the HoverColor property to the B of the Multiply node. Afterward, connect the Out of the Multiply node to the Emission property:</li>
</ol>
<div><img src="img/00252.jpeg" class="calibre160"/></div>
<ol start="12" class="calibre15">
<li value="12" class="calibre12"> Save the graph and dive back into the Unity editor. You should notice that the effect is indeed working as intended.</li>
</ol>
<ol start="13" class="calibre15">
<li value="13" class="calibre12">From the Project tab, select the <kbd class="calibre13">GlowGraph</kbd> shader we've created. Notice that the Inspector tab includes information on the properties used in the shader:</li>
</ol>
<div><img src="img/00253.jpeg" class="calibre25"/></div>
<p>Even though we are using the name HoverColor in the shader graph, throughout code it is referred to as <kbd class="calibre37">Color_AA468061</kbd>. If we wish to refer to this in the code, we will need to use this name latter instead.</p>
<ol start="14" class="calibre15">
<li value="14" class="calibre12">Create a new C# Script called <kbd class="calibre13">HighlightOnHover</kbd>. Double-click on it to enter your IDE, and use the following code:</li>
</ol>
<pre class="calibre18">using UnityEngine;<br class="title-page-name"/><br class="title-page-name"/>public class HighlightOnHover : MonoBehaviour<br class="title-page-name"/>{<br class="title-page-name"/><br class="title-page-name"/>    public Color highlightColor = Color.red;<br class="title-page-name"/><br class="title-page-name"/>    private Material material;<br class="title-page-name"/><br class="title-page-name"/>    // Use this for initialization<br class="title-page-name"/>    void Start()<br class="title-page-name"/>    {<br class="title-page-name"/>        material = GetComponent&lt;MeshRenderer&gt;().material;<br class="title-page-name"/><br class="title-page-name"/>        // Turn off glow<br class="title-page-name"/>        OnMouseExit();<br class="title-page-name"/>    }<br class="title-page-name"/><br class="title-page-name"/>    void OnMouseOver()<br class="title-page-name"/>    {<br class="title-page-name"/>        material.SetColor("Color_AA468061", highlightColor);<br class="title-page-name"/>    }<br class="title-page-name"/><br class="title-page-name"/>    void OnMouseExit()<br class="title-page-name"/>    {<br class="title-page-name"/>        material.SetColor("Color_AA468061", Color.black);<br class="title-page-name"/>    }<br class="title-page-name"/><br class="title-page-name"/>}</pre>
<ol start="15" class="calibre15">
<li value="15" class="calibre12">Save your script and return to the Unity editor. From there, attach the component to your sphere and start the game:</li>
</ol>
<div><img src="img/00254.jpeg" class="calibre25"/></div>
<p class="calibre3">Now, when we highlight the object with the mouse, we will see the hover effect, but, otherwise, it will turn itself off!</p>


            

            
        
    

        

                            
                    <h1 class="header-title" id="calibre_pb_0">How it works...</h1>
                
            
            
                
<p class="calibre3">The Emission property is reflective of the light that an object receives. If the Emission is white it will be fully lit with that color. If black, it will act as if it doesn't exist. We make use of that by using black by default. However, if we do put our mouse over the object, the <kbd class="calibre13">OnMouseOver</kbd> function will trigger, causing it to use the color mentioned.</p>
<p>I could write much more on the subject of Shader Graph, but, unfortunately, there isn't enough space in the book. If you would like to explore Shader Graph even more, Andy Touch has put together a lovely group of examples of Shader Graph being used that could be great research material. Check it out at <a href="https://github.com/UnityTechnologies/ShaderGraph_ExampleLibrary" class="calibre31">https://github.com/UnityTechnologies/ShaderGraph_ExampleLibrary</a>.</p>


            

            
        
    </body></html>