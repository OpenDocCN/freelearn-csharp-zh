<html><head></head><body><div><div><div><div><h1 class="title"><a id="appA"/>Appendix A. Installation Guide</h1></div></div></div><p>With this book, we provide development examples that can be installed using the demo version of Microsoft Dynamics NAV 2013 Release 2 W1.</p><p>This<a class="indexterm" id="id1457"/> demo version can be downloaded from <a class="ulink" href="http://msdn.microsoft.com">msdn.microsoft.com</a>.</p><div><div><div><div><h1 class="title"><a id="ch10lvl1sec72"/>Licensing</h1></div></div></div><p>Microsoft has very <a class="indexterm" id="id1458"/>strict licensing regulations for using and developing in Microsoft Dynamics NAV.</p><p>For educational purposes, you are allowed to use the MSDN license to develop new objects with number 123.456.700 to 123.456.799.</p><div><div><div><div><h2 class="title"><a id="ch10lvl2sec208"/>Installing Microsoft Dynamics NAV</h2></div></div></div><p>After downloading the <a class="indexterm" id="id1459"/>product CD from the MSDN website, start the <code class="literal">setup.exe</code> file. From the installation options, select <strong>Install Demo</strong>, as shown in the following screenshot:</p><div><img alt="Installing Microsoft Dynamics NAV" src="img/0365EN_Ap_01.jpg"/></div></div><div><div><div><div><h2 class="title"><a id="ch10lvl2sec209"/>Changing the license</h2></div></div></div><p>After the<a class="indexterm" id="id1460"/> installation, we can use both the Development Environment and the Windows client. We use the Development Environment for administration purposes and development. The user interface is created using the Windows client.</p><p>Each server instance of Microsoft Dynamics NAV runs on a license file. This file determines what access we have in the system. The demo license that is installed allows us to access all functionality but not the C/AL code.</p><p>To access all the C/AL code, we need an official partner development license. To get this license, we would have to register as a partner and start being a reseller. If this is not what we want, we can use the MSDN license.</p><p>The MSDN license will allow access to all the new objects developed for the book. Access to the base application change examples is not possible with this license.</p><p>To change the license, navigate to <strong>Classic Client</strong>, open the <strong>Tools</strong> menu, and select <strong>License Information</strong>, as shown in the following screenshot:</p><div><img alt="Changing the license" src="img/0365EN_Ap_02.jpg"/><div><p>License Information</p></div></div><p>This opens<a class="indexterm" id="id1461"/> the <strong>License Information</strong> screen where we can select <strong>Upload</strong>, which opens a file dialog box where we can select the MSDN license.</p><div><div><h3 class="title"><a id="note79"/>Note</h3><p>To enable the license file on the Classic client, restart the application.</p></div></div><div><div><div><div><h3 class="title"><a id="ch10lvl3sec239"/>Restarting service tier</h3></div></div></div><p>To enable the<a class="indexterm" id="id1462"/> license file on the Role Tailored Client, we need to restart the Service Tier. This can be done from the <strong>Services</strong> window in the Windows <strong>Control Panel</strong>, as shown in the following screenshot:</p><div><img alt="Restarting service tier" src="img/0365EN_Ap_03.jpg"/></div></div></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch10lvl1sec73"/>Installing the objects</h1></div></div></div><p>This book has<a class="indexterm" id="id1463"/> three Microsoft Dynamics <a class="indexterm" id="id1464"/>NAV object files, two DLL files, a SQL Server script, and some helper files for the installation. They are as follows:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">Chapter2-4.fob</code>: This file contains the squash court examples used in <a class="link" href="ch02.html" title="Chapter 2. A Sample Application">Chapter 2</a>, <em>A Sample Application</em>, <a class="link" href="ch03.html" title="Chapter 3. Financial Management">Chapter 3</a>, <em>Financial Management</em>, and <a class="link" href="ch04.html" title="Chapter 4. Relationship Management">Chapter 4</a>, <em>Relationship Management</em>.</li><li class="listitem" style="list-style-type: disc"><code class="literal">Chapter7-9.fob</code>: This file contains the Storage and Logistics application used in <a class="link" href="ch07.html" title="Chapter 7. Storage and Logistics">Chapter 7</a>, <em>Storage and Logistics</em>, and the sample interfaces for <a class="link" href="ch09.html" title="Chapter 9. Interfacing">Chapter 9</a>, <em>Interfacing</em>. We need the additional SQL Server scripts to get the ADO examples to run.</li><li class="listitem" style="list-style-type: disc"><code class="literal">Chapter8.fob</code>: This file contains the Job extensions for <a class="link" href="ch08.html" title="Chapter 8. Consulting">Chapter 8</a>, <em>Consulting</em>. This chapter also requires the additional DLL files to be installed.</li><li class="listitem" style="list-style-type: disc"><code class="literal">RF database.sql</code>: This is the SQL Server script that is used in <a class="link" href="ch09.html" title="Chapter 9. Interfacing">Chapter 9</a>, <em>Interfacing</em>, to create the RD Database and create the demo data.</li><li class="listitem" style="list-style-type: disc"><code class="literal">MSDN.flf</code>: This is the MSDN license we can use to access the custom objects numbered from 123.456.700 to 123.456.799.</li><li class="listitem" style="list-style-type: disc"><code class="literal">NavMaps.dll</code> and <code class="literal">VEControl.dll</code>: These are the Dynamic Link Library files we need for <a class="link" href="ch07.html" title="Chapter 7. Storage and Logistics">Chapter 7</a>, <em>Storage and Logistics</em>.</li><li class="listitem" style="list-style-type: disc"><code class="literal">Pin1.gif – Pin5.gif</code>: These are the icons displayed on the Bing Map.</li></ul></div><div><div><div><div><h2 class="title"><a id="ch10lvl2sec210"/>Importing a FOB file</h2></div></div></div><p>To install the <a class="indexterm" id="id1465"/>objects, first open the Object Designer in the Classic Client by selecting the <strong>Object Designer</strong> (<em>Shift</em> + <em>F12</em>) option from the <strong>Tools</strong> menu, as shown in the following screenshot:</p><div><img alt="Importing a FOB file" src="img/0365EN_Ap_04.jpg"/></div><p>When the Object Designer is active, the <strong>File</strong> menu shows some additional options:</p><div><img alt="Importing a FOB file" src="img/0365EN_Ap_05.jpg"/><div><p>File menu options</p></div></div><p>We select <strong>Import</strong>, which<a class="indexterm" id="id1466"/> opens a file dialog window. Now, select the <code class="literal">.fob</code> file you want to import.</p><p>If everything is as it should be, the following dialog should appear:</p><div><img alt="Importing a FOB file" src="img/0365EN_Ap_06.jpg"/></div><p>Select <strong>Yes</strong> and this dialog box confirms the import.</p></div><div><div><div><div><h2 class="title"><a id="ch10lvl2sec211"/>Installing the Dynamic Link Library files</h2></div></div></div><p>To support the<a class="indexterm" id="id1467"/> Bing Maps Client Add-in, Geocoding, and <a class="indexterm" id="id1468"/>the distance calculation we ship the following two DLL files, five GIF files, and some supporting files for the installation:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">NavMaps.dll</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">VEControl.dll</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">pin1.gif</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">pin2.gif</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">pin3.gif</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">pin4.gif</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">pin5.gif</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">RegisterDll.bat</code></li></ul></div><p>These files <a class="indexterm" id="id1469"/>should now be placed in this folder:</p><div><img alt="Installing the Dynamic Link Library files" src="img/0365EN_Ap_07.jpg"/></div><div><div><div><div><h3 class="title"><a id="ch10lvl3sec240"/>Registering NavMaps.dll</h3></div></div></div><p>To <a class="indexterm" id="id1470"/>register this DLL we use <code class="literal">RegAsm</code>. The <a class="indexterm" id="id1471"/>command is predefined in the <code class="literal">RegisterDll.bat</code> file that we can execute.</p></div><div><div><div><div><h3 class="title"><a id="ch10lvl3sec241"/>Registering VEControl.dll</h3></div></div></div><p>To register<a class="indexterm" id="id1472"/> the visual map control, we add<a class="indexterm" id="id1473"/> the reference to the <strong>Client Add-in</strong> table (2000000069). To do this, we can run the table from <strong>Object Designer</strong>, as shown in this screenshot:</p><div><img alt="Registering VEControl.dll" src="img/0365EN_Ap_08.jpg"/><div><p>Running table from Object Designer</p></div></div></div></div></div></body></html>