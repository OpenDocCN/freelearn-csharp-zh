<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">Working with Files</h1>
                </header>
            
            <article>
                
<p class="mce-root">In this chapter, we will be looking at these recipes:</p>
<ul>
<li>Setting up .NET Core in Ubuntu</li>
<li>Creating a log as text</li>
<li>Creating an ASP.NET Core application in Ubuntu to use the library</li>
<li>Setting up .NET Core in macOS</li>
<li>Reading from a comma separated (CSV) text file</li>
<li>Creating a .NET Core console application in macOS to use the library</li>
<li>Compressing? Why not?</li>
<li>Creating a classic Windows application to use the library</li>
<li>Encrypting and Decrypting content in a text file</li>
<li>Creating a classic Windows application to use the library</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Technical requirements</h1>
                </header>
            
            <article>
                
<p>Readers should have a basic knowledge of C#. They should also have a basic knowledge of using Visual Studio, installing packages using NuGet, and referencing libraries within projects from other projects.</p>
<p class="mce-root">The code files for this chapter can be found on GitHub:<br/>
<a href="https://github.com/PacktPublishing/DotNET-Standard-2-Cookbook/tree/master/Chapter03">https://github.com/PacktPublishing/DotNET-Standard-2-Cookbook/tree/master/Chapter03</a></p>
<p class="mce-root">Check out the following video to see the code in action:<br/>
<a href="https://goo.gl/82FCEP">https://goo.gl/82FCEP</a></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Introduction</h1>
                </header>
            
            <article>
                
<p>As a developer, at some point, we will have to write some data to the disk or read data from the disk. This may be a simple text file, or may be a log file in a system you have written. .NET Framework offers great support for working with files. Mainly, we will be looking at the <kbd>System.IO</kbd> namespace and its usage of it.</p>
<p>In this chapter, we will be looking at some cross-platform applications as well. Each recipe will go through setting up new environments, such as Ubuntu and macOS, as well as building a .NET Standard 2.0 library and an accompanying application that uses the library.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Setting up .NET Core in Ubuntu</h1>
                </header>
            
            <article>
                
<p>In this recipe, we will be going through how to set up .NET Core 2.x in an Ubuntu system. Ubuntu is a widely used Debian-based Linux environment. By visiting <a href="https://www.ubuntu.com/desktop">https://www.ubuntu.com/desktop</a>, you can easily download and install Ubuntu on your system. You may have to use a virtual PC to do this. There are two great free tools that you can use:</p>
<ol>
<li>VMWare Workstation Player for Windows: <a href="https://www.vmware.com/products/workstation-player.html">https://www.vmware.com/products/workstation-player.html</a></li>
<li>Oracle Virtual Box for Windows, Linux, and macOS: <a href="https://www.virtualbox.org/wiki/Downloads">https://www.virtualbox.org/wiki/Downloads</a></li>
</ol>
<p>This chapter assumes you have already set up and installed the required operating systems.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>You will have to download a virtual PC and install the latest version of Ubuntu. If you haven't got a virtual PC that runs Ubuntu, make sure you have before continuing this recipe done it yet. I am using Ubuntu version 16.04 here. To find out which version you have, simply type the following command in the terminal:</p>
<pre><strong>$ lsb_release -a</strong></pre>
<p>You should get the following output:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-610 image-border" src="assets/e7eaf634-8447-45a2-855d-e968604894f6.png" style="width:24.75em;height:11.67em;"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<ol>
<li>Open your favorite browser, type the following URL, and press <em>Enter</em>:<br/>
<kbd>https://www.microsoft.com/net/download/linux</kbd></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-679 image-border" src="assets/f6b55a07-898d-4e84-b273-abc73e4d7a40.png" style="width:46.42em;height:27.33em;"/></div>
<ol start="2">
<li>Select the Install .NET Core SDK 2.x Package button.</li>
</ol>
<ol start="3">
<li>From the <span class="packt_screen">Linux Distribution</span> drop-down list, select <span class="packt_screen">Ubuntu 16.04</span><strong>.<br/></strong></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-680 image-border" src="assets/6224db25-34e2-4f7d-9d06-5b23744be9fd.png" style="width:16.08em;height:19.67em;"/></div>
<ol start="4">
<li>Follow the instructions on the page to install the current SDK or perform the following steps to install.</li>
<li>Now open the terminal, type the following command, and press <em>Enter</em>:</li>
</ol>
<pre class="mce-root"><strong>      $ curl https://packages.microsoft.com/keys/microsoft.asc | <br/>      gpg --dearmor &gt; microsoft.gpg</strong></pre>
<ol start="6">
<li>If  you have a fresh installation of Ubuntu you might not have curl installed. If not use the following command to install curl:</li>
</ol>
<pre class="mce-root"><strong>      $ sudo apt-get install curl</strong><span> </span></pre>
<ol start="7">
<li>Now, again in the terminal type the following command and press <em>Enter</em> to get the list of files:</li>
</ol>
<pre class="mce-root"><span><strong><span>      $ sudo mv microsoft.gpg /etc/apt/trusted.gpg.d/microsoft.gpg</span></strong></span></pre>
<ol start="8">
<li> Type the following command and press <em>Enter</em> in the terminal:</li>
</ol>
<pre class="mce-root"><span><strong><span>      $ sudo sh -c 'echo "deb [arch=amd64] <br/>      https://packages.microsoft.com/repos/<br/>      microsoft-ubuntu-xenial-prod xenial main" &gt; <br/>      /etc/apt/sources.list.d/dotnetdev.list'</span></strong></span></pre>
<ol start="9">
<li>Let's update the package list using this command:</li>
</ol>
<pre class="mce-root"><strong>      $ sudo apt-get update</strong></pre>
<ol start="10">
<li>Finally, let's install the SDK using this command:</li>
</ol>
<pre class="mce-root"><strong>      $ sudo apt-get install dotnet-sdk-2.0.2</strong></pre>
<ol start="11">
<li>Now we are done with installing the SDK, let's test it using the following command:</li>
</ol>
<pre class="mce-root"><strong>      $ dotnet --version</strong><span> </span></pre>
<ol start="12">
<li>If it's all OK, you should get the following output:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-612 image-border" src="assets/1cad7b95-a4f3-47fb-a17d-9bd695ca1a55.png" style="width:28.42em;height:6.67em;"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>In steps 1 to 3, we navigated through to find the required SDK version for our Ubuntu installation. These commands are straightforward. I have used Ubuntu 16.04 as my operating system. In steps 4 and 5, we used <kbd>curl</kbd> to download the security key to the system and to tell Ubuntu that we will be downloading the SDKs from a trusted source. In a fresh Ubuntu installation, we might not have the <kbd>curl</kbd> command. So, if you ran into a <kbd>command not found</kbd> problem, you can just simply install <kbd>curl</kbd> first as in step 4.</p>
<p>In step 6, we used an Ubuntu command to update its package list with Microsoft repositories. Then, in step 7, we updated the source list using the <kbd>apt-get</kbd> command. Finally, in step 8, we did the actual installation of .NET Core 2.0 SDK.</p>
<p>In steps 9 and 10, we checked that our installation was all OK to move on.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Creating a log as text</h1>
                </header>
            
            <article>
                
<p>In this recipe, we will be creating a .NET Standard 2.0 library that writes a text file as a log file. This log file will contain simple text entries of operations we do in an application. It will also demonstrate the use of command-line tools that come under the .NET Core SDK to create a solution and add projects as we move on.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>Make sure you have installed Ubuntu 16.04 and .NET Core 2.0 SDK. If not, please follow the previous recipe to do so. Assuming everything is installed and .NET Core 2.0 is up and running, let's get started on creating the library that writes logs as text.</p>
<p>Make sure you have downloaded and installed Visual Studio Code from <a href="https://code.visualstudio.com">https://code.visualstudio.com</a>. It's a straightforward installation of a <kbd>.deb</kbd> file from the site.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<ol>
<li>Open the terminal.</li>
<li>Now in your home directory or any other directory type the following command and press <em>Enter</em>:</li>
</ol>
<pre class="mce-root"><span>      <strong>$ dotnet new sln -o Chapter3 -n Chapter3.LogFile</strong></span></pre>
<ol start="3">
<li> Now, change to the newly created directory, using the following command:</li>
</ol>
<pre class="mce-root"><span><strong><span>      $ cd Chapter3</span></strong></span></pre>
<ol start="4">
<li>Now you are inside the root of your solution. Let's create the .NET Standard library project using the following command:</li>
</ol>
<pre class="mce-root"><span><strong><span>      $ dotnet new classlib -o Chapter3.LogFile.LogLib</span></strong></span></pre>
<ol start="5">
<li>Now that we have created our <kbd>Class Library Project</kbd>, let's open the whole solution using Visual Studio Code.</li>
<li>Type the following command in the terminal and press <em>Enter</em>:</li>
</ol>
<pre class="mce-root"><span><strong><span>      $ code .</span></strong></span></pre>
<ol start="7">
<li>The previous command will open Visual Studio Code in the current directory and the IDE should look like this:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-614 image-border" src="assets/4fd8eb18-8cc1-4128-9c60-7769677d1de8.png" style="width:30.33em;height:19.83em;"/></div>
<ol start="8">
<li>Now, in the code tree, select <kbd>Class1.cs</kbd>, press <em>F2</em>, and change the name to <kbd>TextLog.cs</kbd> and press <em>Enter</em>.</li>
<li>Also in the code window, change the class name from <kbd>Class1</kbd> to <kbd>TextLog</kbd>.</li>
<li>Now your code should look like this:</li>
</ol>
<pre class="mce-root"><span>      using</span><span> </span><span>System</span><span>;<br/></span><span><br/>      namespace</span><span> </span><span>Chapter3</span><span>.</span><span>LogFile</span><span>.</span><span>LogLib<br/></span><span>      {<br/>          </span><span>public</span><span> </span><span>class</span><span> </span><span>TextLog<br/>          </span><span>{<br/>          </span><span>}<br/></span><span>      }</span></pre>
<ol start="11">
<li>Let's add our new project to the solution. Make sure you are in the root of the project directory. Type the <kbd>ls</kbd> command and the output should look like this:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-615 image-border" src="assets/64c41bc2-6104-4786-9875-6dfc6b2c3395.png" style="width:33.50em;height:7.08em;"/></div>
<ol start="12">
<li>Type the following command in the terminal and press <em>Enter</em>:</li>
</ol>
<pre class="mce-root"><span><strong><span>      $ dotnet sln Chapter3.LogFile.sln  <br/>      add Chapter3.LogFile.LogLib/Chapter3.LogFile.LogLib.csproj</span></strong></span></pre>
<ol start="13">
<li>Now, in the root directory of the solution, type the following command to build the solution and its attached projects:</li>
</ol>
<pre class="mce-root"><span>      <strong>$ dotnet build</strong> </span></pre>
<ol start="14">
<li>The output window should look like this:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-616 image-border" src="assets/eac5a56c-50ca-4739-a3dd-cde9718233a6.png" style="width:150.00em;height:36.33em;"/></div>
<ol start="15">
<li>Let's add some code to our library. At the top of the <kbd>using</kbd> directives, add the following code:</li>
</ol>
<pre class="mce-root"><span>      using System.IO;</span></pre>
<ol start="16">
<li>At the top of the class, next to the open curly bracket, add the following code:</li>
</ol>
<pre class="mce-root"><span>      private</span><span> </span><span>string</span><span> logFileName </span><span>=</span><span> </span><span>"server_log.txt"</span><span>;<br/></span><span>      private</span><span> </span><span>StreamWriter</span><span> logFile;</span></pre>
<ol start="17">
<li>Let's add a constructor. Add the following code next to the variables we have created:</li>
</ol>
<pre class="mce-root"><span>      public</span><span> </span><span>TextLog</span><span>()<br/></span><span>      {<br/>          </span><span>if</span><span> (</span><span>!</span><span>File</span><span>.</span><span>Exists</span><span>(</span><span>logFileName</span><span>))<br/>          </span><span>{<br/>              </span><span>logFile</span><span> </span><span>=</span><span> </span><span>File</span><span>.</span><span>CreateText</span><span>(</span><span>logFileName</span><span>);<br/>          </span><span>}<br/>          </span><span>else<br/>          </span><span>{<br/>              </span><span>logFile</span><span> </span><span>=</span><span> </span><span>File</span><span>.</span><span>AppendText</span><span>(</span><span>logFileName</span><span>);<br/>          </span><span>} <br/></span><span>      }</span></pre>
<ol start="18">
<li>Next to the constructor code, add the method to write the log file:</li>
</ol>
<pre class="mce-root"><span>      public</span><span> </span><span>void</span><span> </span><span>WriteLog</span><span>(</span><span>string</span><span> message)<br/></span><span>      {<br/>          </span><span>logFile</span><span>.</span><span>WriteLine</span><span>(</span><span>$"{</span><span>DateTime</span><span>.</span><span>Now</span><span>} Log Message: {</span><span>message</span><span>} "</span><span>);<br/></span><span>      }</span></pre>
<ol start="19">
<li>Let's add the last method to the code:</li>
</ol>
<pre class="mce-root"><span>      public</span><span> </span><span>void</span><span> </span><span>CloseLog</span><span>()<br/></span><span>      {<br/>          </span><span>logFile</span><span>.</span><span>Close</span><span>();<br/></span><span>      }</span></pre>
<ol start="20">
<li>Now that we have added all our code to the library, let's go back to the terminal window and perform a build using the following command:</li>
</ol>
<pre class="mce-root"><span><strong><span>      $ dontnet build</span></strong></span></pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>In the first step, we opened the terminal window in the Ubuntu system. This terminal is similar to the command window you use in Windows operating systems. A terminal helps you to execute shell commands supported by the .NET Core 2.0. In step <em>2,</em> we created a blank solution. The <kbd>dotnet new</kbd> command creates a new solution file containing directories. In step <em>3</em>, we changed the directory to the root of the solution file. From this point onwards, we will be adding the projects to the solution.</p>
<p>In step 4, we used the same <kbd>dotnet new</kbd> command to create the class library. By default, this class library will use the .NET Standard 2.0 library, so we don't have to tell the command-line tool to create the .NET Standard 2.0 library. We can confirm this by expanding the <kbd>Chapter3.LogFile.LogLib</kbd> node in Visual Studio Code, then clicking on the <kbd>Chapter3.LogFile.LogLib.csproj</kbd> label. In the right-hand pane of Visual Studio Code, you will be able to see this XML code:</p>
<div>
<pre><span>&lt;</span><span>Project</span><span> </span><span>Sdk</span><span>=</span><span>"Microsoft.NET.Sdk"</span><span>&gt;<br/>    </span><span>&lt;</span><span>PropertyGroup</span><span>&gt;<br/>        </span><span>&lt;</span><span>TargetFramework</span><span>&gt;</span><span>netstandard2.0</span><span>&lt;/</span><span>TargetFramework</span><span>&gt;<br/>    </span><span>&lt;/</span><span>PropertyGroup</span><span>&gt;<br/></span><span>&lt;/</span><span>Project</span><span>&gt;</span></pre></div>
<p>In this code, <kbd>&lt;TargetFramwork&gt;</kbd> markup says it's <kbd>netstandard2.0</kbd><strong> </strong>and it's confirmed, we have a .NET Standard 2.0 library on our hands. In steps 6 to 10, we used Visual Studio Code to open the current directory and make changes to the existing class. In step 11, we made sure we were in the root directory of the solution. In step 12, we added the Class Library project to the solution using the command-line tool. You will be able to list all the projects in the solution by executing the following command in the terminal:</p>
<pre><strong>$ dotnet sln list</strong> </pre>
<p>The command will list all the available projects in the current solution file. In step 13, we performed a <kbd>build</kbd> command to make sure everything was intact and working fine. In step 15, we added the namespace for handing inputs and outputs to the system. The <kbd>System.IO</kbd> namespace contains all the file handling classes inside it.</p>
<p>In step 16, we created two <kbd>private</kbd> variables to hold the filename and <kbd>StreamWriter</kbd> class that helps you to write to text files. In step 17, we created a constructor method that checks whether the file, exists. If it doesn't exist, it will create a whole new text file and, if there is a file already, we will open the file to append text to it. This is a very good practice when you handle files for these sort of tasks.</p>
<p>In step 18, we created a method that takes a <kbd>string</kbd> parameter as the message and writes that message to the file. In step 19, we created a method to close the opened file. Finally, step 20 verified that the syntax is OK and builds correctly using a <kbd>build</kbd> command.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Creating an ASP.NET Core application in Ubuntu to use the library</h1>
                </header>
            
            <article>
                
<p>We will be creating an ASP.NET Core application to use the library in this recipe. ASP.NET Core will be using the MVC design pattern, as well as working in Linux, macOS, and, of course, in Windows. We will be using Ubuntu as the operating system for building this small app to demonstrate the cross-platform capabilities of .NET Core.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>Make sure you have completed the previous recipe that includes setting up the environment and building of the .NET Standard 2.0 library that creates a text file as a log. This recipe assumes you have basic knowledge of MVC architecture. In simple terms, MVC is a software architectural pattern that separates data models, controlling code, and user interfaces. Let's have a look at how to build this application and use our library.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it..</h1>
                </header>
            
            <article>
                
<ol>
<li>Open the terminal and navigate to the root of your application built in the previous recipe.</li>
<li>The directory structure should look like this:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-617 image-border" src="assets/e4aba8d1-f464-4b54-96bb-602b2aade0cb.png" style="width:34.67em;height:9.17em;"/></div>
<ol start="3">
<li>Now type the following command and press <em>Enter</em> in the terminal to create the new ASP.NET Core MVC application:</li>
</ol>
<pre>     <strong> $ dotnet new mvc -o Chapter3.LogFile.LogAppMvc</strong></pre>
<ol start="4">
<li>Let's add this new project to the solution:</li>
</ol>
<pre>     <strong> $ dotnet sln add </strong><br/><strong>      Chapter3.LogFile.LogAppMvc/Chapter3.LogFile.LogAppMvc.csproj</strong></pre>
<ol start="5">
<li>Now let's perform a build to check that everything is working fine:</li>
</ol>
<pre>     <strong> $ dotnet build</strong></pre>
<ol start="6">
<li>Now, navigate to the app we just created:</li>
</ol>
<pre>   <strong>   $ cd Chapter3.LogFile.LogAppMvc/</strong></pre>
<ol start="7">
<li>Execute the application with the following command:</li>
</ol>
<pre><strong>      $ dotnet run</strong></pre>
<ol start="8">
<li>If everything is fine, open your browser and type <kbd>http://localhost:5000</kbd> in the address bar and hit <em>Enter</em>. The browser output should look like this:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-618 image-border" src="assets/95b54e8d-b852-46bd-a113-16df7faf1103.png" style="width:150.00em;height:101.67em;"/></div>
<ol start="9">
<li>Let's close the browser and, in the terminal window, hit <em>Ctrl</em> + <em>C</em> to stop the web server.</li>
<li>We need to add the reference to our .NET Standard 2.0 library we built before. Let's add it now using this command in the terminal:</li>
</ol>
<pre><strong>      $ dotnet add reference <br/>      ../Chapter3.LogFile.LogLib/Chapter3.LogFile.LogLib.csproj</strong> </pre>
<ol start="11">
<li>Let's get back to the root folder by typing the following command:</li>
</ol>
<pre>      <strong>$ cd ..</strong></pre>
<ol start="12">
<li>Now, in the root of the solution directory, type the following command to open Visual Studio Code using the current directory:</li>
</ol>
<pre>      <strong>$ code .</strong> </pre>
<ol start="13">
<li>In Visual Studio Code, expand the <kbd>Chapter3</kbd> label and expand <kbd>Chapter3.LogFile.LogAppMvc</kbd><strong>.</strong></li>
<li>Again, expand the <kbd>Controllers</kbd> folder and click on <kbd>HomeController.cs</kbd><strong>:<br/></strong></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><strong><img class="alignnone size-full wp-image-681 image-border" src="assets/63ad3193-1ff4-4793-a9a5-aafe9ff92d3d.png" style="width:36.08em;height:32.08em;"/><br/></strong></div>
<ol start="15">
<li>In <kbd>HomeController.cs</kbd>, add the following <kbd>using</kbd> directive to the last line of the <kbd>using</kbd> directives block:</li>
</ol>
<div>
<pre><span>      using</span><span> </span><span>Chapter3</span><span>.</span><span>LogFile</span><span>.</span><span>LogLib</span><span>;</span></pre></div>
<ol start="16">
<li>Now, next to the starting curly bracket of the <kbd>Index</kbd> method of the <kbd>HomeController</kbd> class, add the following code:</li>
</ol>
<div>
<pre><span>      TextLog</span><span> logFile </span><span>=</span><span> </span><span>new</span><span> </span><span>TextLog</span><span>();<br/></span><span>      logFile</span><span>.</span><span>WriteLog</span><span>(</span><span>"You are in the Index action."</span><span>);<br/></span><span>      logFile</span><span>.</span><span>CloseLog</span><span>();</span></pre></div>
<ol start="17">
<li>Let's add more code inside the <kbd>About</kbd> method too:</li>
</ol>
<div>
<pre><span>      TextLog</span><span> logFile </span><span>=</span><span> </span><span>new</span><span> </span><span>TextLog</span><span>();<br/></span><span>      logFile</span><span>.</span><span>WriteLog</span><span>(</span><span>"You are in the About action."</span><span>);<br/></span><span>      logFile</span><span>.</span><span>CloseLog</span><span>();</span></pre></div>
<ol start="18">
<li>Do the same to the <kbd>Contact</kbd> method as well:</li>
</ol>
<div>
<pre><span>      TextLog</span><span> logFile </span><span>=</span><span> </span><span>new</span><span> </span><span>TextLog</span><span>();<br/></span><span>      logFile</span><span>.</span><span>WriteLog</span><span>(</span><span>"You are in the Contact action."</span><span>);<br/></span><span>      logFile</span><span>.</span><span>CloseLog</span><span>();</span></pre></div>
<ol start="19">
<li>Now we are done with adding code, let's navigate to <kbd>Chapter3.LogFile.LogAppMvc</kbd>:</li>
</ol>
<pre><strong>      $ cd Chapter3.LogFile.LogAppMvc/</strong></pre>
<ol start="20">
<li>Let's run the application:</li>
</ol>
<pre>      <strong>$ dotnet run</strong></pre>
<ol start="21">
<li>Open your favorite browser, type <kbd>localhost:5000</kbd> in the address bar, and press <em>Enter</em>. Click on the navigation links for <span class="packt_screen">Home</span>, <span class="packt_screen">About</span>, and <span class="packt_screen">Contact</span> a few times.</li>
<li>Close the browser.</li>
</ol>
<ol start="23">
<li>Now go to Visual Studio Code, expand the <kbd>Chapter3</kbd> label, and expand <kbd>Chapter3.LogFile.LogAppMvc</kbd><strong>.</strong> You should see a file named <kbd>server_log.txt</kbd> in the root:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-620 image-border" src="assets/022e2704-8de3-478a-8965-53fd86c6804f.png" style="width:46.83em;height:37.17em;"/></div>
<ol start="24">
<li>Now click on the <kbd>server_log.txt</kbd> filename to see the output:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-621 image-border" src="assets/92b9b012-5ecd-42f9-aa55-14f13c4ed072.png" style="width:47.75em;height:16.50em;"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>In steps 1 and 2, we opened the terminal and made sure we are in the correct directory, which is the root of the solution. After that, in step 3, we created the ASP.NET Core 2.0 MVC application. In step 4, we added that project to the solution. After this step, we have two projects in the solution and you will be able to see all projects in the solution by giving this command in the root of the solution directory:</p>
<pre><strong>dotnet sln list</strong> </pre>
<p>In steps 5, 6, and 7, we built the project from the root to check that everything was fine. Then, we navigated to the newly created project folder and executed the project to test whether everything was OK. In step 8, we opened the default browser and gave the URL to test the ASP.NET Core 2.0 application. As you can see, the URL looked like <kbd>http://localhost:5000</kbd>. By default, the web server (which is kestrel) runs on port 5000.</p>
<div class="mce-root packt_infobox">Kestrel is a cross-platform web server for ASP.NET Core and is built using a cross-platform asynchronous I/O library called <strong>libuv.</strong></div>
<p>So, we didn't change anything and kept the defaults as they are. In step 11, we navigated back to the root solution directory and then, in step 12, we opened Visual Studio Code using that directory.</p>
<p>In step 14, we navigated to <kbd>HomeController.cs</kbd> and, in step 15, we added the first <kbd>using</kbd> statement to access the classes that allow you to use the file operations. In step 16, we created the <kbd>TextLog</kbd> class and used it in the <kbd>WriteLog()</kbd> method. Finally, we used the <kbd>CloseLog()</kbd> method to close the opened file. We did the same in steps 17 and 18. In steps 19 and 20, we navigated to the ASP.NET Core 2.0 application directory and executed the application.</p>
<p>In steps 21 and 22, we opened the browser and used the application to write some text to the disk. Then we closed the browser. Finally, in steps 23 and 24, we witnessed the file that was written to the disk while we were using the application.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Setting up .NET Core in macOS</h1>
                </header>
            
            <article>
                
<p>In this recipe, we will be looking at how to set up things on macOS to run .NET Core 2.0 applications. At the time of writing, the macOS version is macOS High Sierra 10.13.2. We need a device such as a MacBook or an iMac for running macOS, or else you can skip this recipe.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>Make sure you have macOS up and running on a device. Have your favorite browser open. Also, I assume you have experience of downloading and installing applications on a Mac device.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<ol>
<li>Open your favorite browser and navigate to <a href="https://www.microsoft.com/net/download/macos">https://www.microsoft.com/net/download/macos</a>.</li>
</ol>
<ol start="2">
<li>Click on the <kbd>Download .NET Core 2.1.x SDK</kbd> (at the time of writing, the version is 2.1.105) button.</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/abc542de-4235-41b5-8236-6799ee2fd478.png"/></div>
<ol start="3">
<li>Now, in the download dialog box, select <span class="packt_screen">Save</span>.</li>
<li>Now double-click on the file from the downloaded location (typically in the <kbd>Downloads</kbd> folder) and follow the instructions to install.</li>
<li>After installation, you should be good to go. Let's open a terminal and test the installation. (<span class="packt_screen">Applications</span> | <span class="packt_screen">Utilities</span> | <span class="packt_screen">Terminal</span>).</li>
<li>Now, in the terminal, type the following command:</li>
</ol>
<pre>      <strong>$ dotnet --version</strong></pre>
<ol start="7">
<li>If everything is OK, you should see output like this:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-624 image-border" src="assets/8aa3723a-93b1-4a64-898d-ba2472140a8c.png" style="width:109.83em;height:13.92em;"/></div>
<ol start="8">
<li>Let's download Visual Studio Code for Mac at <a href="https://code.visualstudio.com/">https://code.visualstudio.com/</a>.</li>
<li>In the dialog box, choose <span class="packt_screen">Save File</span> to download.</li>
</ol>
<ol start="10">
<li>After downloading the file, locate it and double-click on it to extract. Then drag drop the file in the <kbd>Applications</kbd> folder and you are good to go with Visual Studio Code.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>Throughout these steps, we have downloaded and installed .NET Core 2.0 and Visual Studio Code. Each step is self-explanatory. After opening Visual Studio Code, you might have to install a few extensions such as C# to make things easier.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Reading from a comma separated (CSV) text file</h1>
                </header>
            
            <article>
                
<p>In this recipe, will be using .NET Core 2.0 under macOS. I assume you are familiar with using a terminal and typing a few commands in it. We will be looking at command-line tools supplied with .NET Core 2.0 to create our .NET Standard 2.0 library that reads a <strong>Comma Separated Values</strong> (<strong>CSV</strong>) file and returns its data.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>If you have not already completed the previous recipe, make sure you have done it. It will help you to download .NET Core 2.0 and Visual Studio Code as an IDE. Let's fire up the terminal and get started.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<ol>
<li>Open a terminal window (<span class="packt_screen">Applications</span> | <span class="packt_screen">Utilities</span> | <span class="packt_screen">Terminal</span>).</li>
<li>Now, in your <kbd>home</kbd> directory, type the following command (you might have to create a separate directory for your projects and do the following command): </li>
</ol>
<pre>      <strong>$ dotnet new sln -o Chapter3.CsvFile</strong></pre>
<ol start="3">
<li> Now, type the following command to navigate to the newly created solution:</li>
</ol>
<pre>      <strong>$ cd Chapter3.CsvFile</strong></pre>
<ol start="4">
<li>Again, type this command to create the .NET Standard 2.0 library project:</li>
</ol>
<pre>      <strong>$ dotnet new classlib -o Chapter3.CsvFile.CsvReader</strong></pre>
<ol start="5">
<li>Now let's add this project to our solution by typing this command:</li>
</ol>
<pre>      <strong>$ dotnet sln add</strong> <br/>      <strong>Chapter3.CsvFile.CsvReader/Chapter3.CsvFile.CsvReader.csproj</strong></pre>
<ol start="6">
<li>Let's open Visual Studio Code and open the current solution directory (<span class="packt_screen">File</span> | <span class="packt_screen">Open</span>). (<span class="packt_screen">Visual Studio Code</span> should normally list it under the <span class="packt_screen">Applications</span> directory).</li>
<li>Visual Studio Code should look like this:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-627 image-border" src="assets/829d3393-bfac-46d5-8baf-197754713df2.png" style="width:163.42em;height:93.83em;"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Visual Studio Code</div>
<ol start="8">
<li>Now, select the <kbd>Class1.cs</kbd> label in the file tree.</li>
<li>Press the <em>Enter</em><strong> </strong>key and rename the <kbd>Class1.cs</kbd> to <kbd>CsvFileLib.cs</kbd> and press <em>Enter</em> again.</li>
<li>Now, in the code editor, change the <kbd>Class1</kbd> class name to match the filename <kbd>CsvFileLib</kbd>.</li>
</ol>
<ol start="11">
<li>Let's click on the <span class="packt_screen">CsvFileLib.cs</span> tab and add some code. Add the <kbd>using</kbd> directive on the top of the code window next to the last line of the <kbd>using</kbd> directives:</li>
</ol>
<pre><span>      using</span><span> System.IO;<br/>      using System.Collections.Generics;<br/></span></pre>
<ol start="12">
<li> At the top of the class, after the open curly bracket of the <kbd>CsvFileLib</kbd>, class add the following code:</li>
</ol>
<div>
<pre><span>      private</span><span> </span><span>string</span><span> _fileName; </span></pre></div>
<ol start="13">
<li> Now, next to the preceding line, add the following constructor code for the class:</li>
</ol>
<div>
<pre><span>      public</span><span> CsvFileLib(</span><span>string</span><span> csvFile)<br/></span><span>      {<br/>          </span><span>_fileName </span><span>=</span><span> csvFile;<br/></span><span>      }</span></pre></div>
<ol start="14">
<li> Finally, let's add the method to read all the lines in a CSV file:</li>
</ol>
<div>
<pre><span>      public</span><span> </span><span>List</span><span>&lt;</span><span>string</span><span>&gt; ReadCsvFile()<br/></span><span>      {</span><span><br/></span><span>          var</span><span> fileContents </span><span>=</span><span> </span><span>new</span><span> </span><span>List</span><span>&lt;</span><span>string</span><span>&gt;();</span><span><br/></span><span><br/>          using</span><span> (</span><span>var</span><span> csvFile </span><span>=</span><span> File.OpenRead(_fileName))<br/></span><span>          {</span><span><br/></span><span>              var</span><span> fileStream </span><span>=</span><span> </span><span>new</span><span> </span><span>StreamReader</span><span>(csvFile);</span><span><br/></span><span><br/>              while</span><span>(</span><span>!</span><span>fileStream.EndOfStream)<br/></span><span>              {<br/></span><span>                  fileContents.Add(fileStream.ReadLine());<br/></span><span>              }<br/></span><span>              fileStream.Close();<br/></span><span>          }<br/></span><span><br/></span><span>          return</span><span> fileContents;<br/></span><span>      }</span></pre></div>
<ol start="15">
<li>Now, type the following command in the terminal to build the solution (make sure you are in the root of the solutions directory):</li>
</ol>
<pre>      <strong>$ dotnet build</strong></pre>
<ol start="16">
<li>This will build and check the code for any syntax errors.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>In steps 1 to 5, we used .NET Core command-line tools to create a solution and then create a project. Then, we added the project to the solution. In steps 6 and 7, we opened Visual Studio Code for macOS and opened the directory we just created. Visual Studio Code for macOS allows you to work with .NET-based applications on macOS. Also, by installing extensions, it allows you to work with other popular technologies as well.</p>
<p>In steps 9 and 10, we renamed the default <kbd>Class1.cs</kbd> generated from the template and we renamed the file and the class to a meaningful name. In step 11, we added the necessary namespaces to work with files and collections. In step 12, we created a private variable to hold the filename. In step 13, we created a constructor that takes a filename with a path as a <kbd>string</kbd> parameter and then populated the variable we created in step 12.</p>
<p>In step 14, we created a method that reads the entire file and stores each line of the text to a List collection. This collection stores its items as <kbd>string</kbd>, In the first line of the <span><kbd>ReadCsvFile()</kbd> method, we created a local variable to hold the handler of the CSV text file. The following part of the code opens the given text file and, in the next line, stores all the content in a variable as a stream. The third line loops through till the end of the file and stores each line on the previous list. Finally, it closes the stream and returns the list of content from the <kbd>ReadCsvFile()</kbd> Method:<br/></span></p>
<pre><span>      using</span><span> (</span><span>var</span><span> csvFile </span><span>=</span><span> File.OpenRead(_fileName))<br/></span><span>      {</span><span><br/></span><span>          var</span><span> fileStream </span><span>=</span><span> </span><span>new</span><span> </span><span>StreamReader</span><span>(csvFile);</span><span><br/></span><span><br/>          while</span><span>(</span><span>!</span><span>fileStream.EndOfStream)<br/></span><span>          {<br/></span><span>              fileContents.Add(fileStream.ReadLine());<br/></span><span>          }<br/></span><span>    <br/>          fileStream.Close();<br/></span><span>      }</span></pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Creating a .NET Core console application in macOS to use the library</h1>
                </header>
            
            <article>
                
<p>In this recipe, we will be creating a .NET Core console application to use the library built in the previous session. .NET Core is a cross-platform .NET flavor that runs on Windows, Linux, and macOS. This recipe focuses on .NET Core that runs under macOS.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>Let's open the terminal and make sure we are in the root of the solution built in the previous recipe. Perform a quick build command as follows to check that everything is working fine:</p>
<pre><strong>$ dotnet build</strong></pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<ol>
<li>Open the terminal (<span class="packt_screen">Applications</span> | <span class="packt_screen">Utilities</span> | <span class="packt_screen">Terminal</span>).</li>
<li>Navigate to the root of the solution we built in the previous recipe and enter the following command:</li>
</ol>
<pre>      <strong>$ dotnet new console -o Chapter3.CsvFile.ConsoleApp</strong></pre>
<ol start="3">
<li> Again, type this command to see the content of the directory:</li>
</ol>
<pre>      <strong>$ ls</strong></pre>
<ol start="4">
<li>Your terminal should look like this:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-628 image-border" src="assets/7bfbbed8-a02c-4219-abc5-c5cc672fe3c1.png" style="width:45.00em;height:6.08em;"/></div>
<ol start="5">
<li> Execute the following commands to add this project to the solution and to test build:</li>
</ol>
<pre>      <strong>$ dotnet sln add </strong><br/><strong>      Chapter3.CsvFile.Console/Chapter3.CsvFile.ConsoleApp.csproj </strong><br/><br/><strong>      $ dotnet build</strong></pre>
<ol start="6">
<li> Let's open Visual Studio Code and open (<span class="packt_screen">File</span> | <span class="packt_screen">Open</span>) the full solution.</li>
</ol>
<ol start="7">
<li>Your Visual Studio Code should look like this:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-682 image-border" src="assets/1b308fc3-6669-406f-bf87-9bb1634c1e2c.png" style="width:23.92em;height:28.58em;"/></div>
<ol start="8">
<li>Now expand the <kbd>Chapter3.CsvFile.Console</kbd> node and select the <kbd>Chapter3.CsvFile.Console</kbd> label.</li>
</ol>
<ol start="9">
<li>Click on the New File icon in the tab.</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-683 image-border" src="assets/8e467659-a848-4890-ba1f-14aa7aa0c0c6.png" style="width:24.92em;height:19.33em;"/></div>
<ol start="10">
<li>Type <kbd>movies.txt</kbd> as the name and press <em>Enter</em>.</li>
<li>Now select the <kbd>movies.txt</kbd> file and add the following content:<br/>
<kbd>1,X-Men: Apocalypse,2016</kbd><br/>
<kbd>2,The Secret Life of Pets,2016</kbd><br/>
<kbd>3,Suicide Squad,2016</kbd><br/>
<kbd>4,Independence Day: Resurgence,2016</kbd><br/>
<kbd>5,Star Trek 3,2016</kbd><br/>
<kbd>6,Batman v Superman: Dawn of Justice,2016</kbd><br/>
<kbd>7,The Jungle Book,2016</kbd><br/>
<kbd>8,Hail, Caesar!,2016</kbd><br/>
<kbd>9,Zoolander 2,2016</kbd><br/>
<kbd>10,How to Be Single,2016</kbd></li>
</ol>
<ol start="12">
<li>You text file should look like this:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-631 image-border" src="assets/79468c37-8a76-440c-a5cf-476a39f501e0.png" style="width:46.83em;height:20.08em;"/></div>
<ol start="13">
<li>Let's open the terminal (<span class="packt_screen">Applications</span> | <span class="packt_screen">Utilities</span> | <span class="packt_screen">Terminal</span>) and navigate to the newly created console project.</li>
<li>Type the following command and press <em>Enter</em> to add our library to the console application as a reference:</li>
</ol>
<pre>      <strong>$ dotnet add reference </strong><br/><strong>      ../Chapter3.CsvFile.CsvReader/Chapter3.CsvFile.CsvReader.csproj</strong></pre>
<ol start="15">
<li> Let's go back to Visual Studio Code, select <kbd>Program.cs</kbd>, and add this <kbd>using</kbd> directive after the last line of <kbd>using</kbd> directives:</li>
</ol>
<div>
<pre><span>      using</span><span> Chapter3.CsvFile.CsvReader;</span></pre></div>
<ol start="16">
<li>Now delete any existing code inside the <kbd>Main()</kbd> method and add this code between the curly brackets:</li>
</ol>
<div>
<pre><span>      var</span><span> moviesFile </span><span>=</span><span> </span><span>new</span><span> </span><span>CsvFileLib</span><span>(</span><span>"movies.txt"</span><span>);<br/></span><span>      var</span><span> moviesList </span><span>=</span><span> moviesFile.ReadCsvFile();<br/><br/></span><span>      foreach</span><span> (</span><span>var</span><span> movie </span><span>in</span><span> moviesList)<br/></span><span>      {<br/>          </span><span>var</span><span> row </span><span>=</span><span> movie.Split(</span><span>','</span><span>);<br/>          </span><span>Console.WriteLine(</span><span>$"ID: {row[</span><span>0</span><span>]} Title : <br/>              {row[</span><span>1</span><span>]} Year : {row[</span><span>2</span><span>]}"</span><span>);<br/></span><span>      }</span></pre></div>
<ol start="17">
<li>Save the current changes and go back to the terminal, type the following command, and press <em>Enter</em>:</li>
</ol>
<pre>      <strong>$ dotnet build</strong> </pre>
<ol start="18">
<li>Again, type the following code and press <em>Enter</em>:</li>
</ol>
<pre>      <strong>$ dotnet run</strong> </pre>
<ol start="19">
<li>You should see this output in your terminal window:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-632 image-border" src="assets/2c3eae69-b845-4ed5-9ee4-e40b6c488f53.png" style="width:45.17em;height:20.42em;"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>In steps 1 to 4, we navigated to the previously built .NET Standard 2.0 library. Using the macOS terminal we reached the root of that solution. Also, we have created a new .NET Standard 2.0 library. When you create a library project in .NET Core 2.0, by default it chooses .NET Standard 2.0 as the template. So we don't worry about telling the command-line tool to create the library as .NET Standard 2.0 library.</p>
<p>In step 5, we added the newly created project to our solution and performed a build to check that everything was fine. In steps 6 to 9, we opened the current directory using Visual Studio Code and then, in steps 9 to 12, we created a sample text file with comma separated values for testing purposes. In step 14, we added the library to our console application as a reference.</p>
<p>In step 15, we added the reference for the library project in the <kbd>using</kbd> statements and then, in step 16, we created an instance of the <span><kbd>CsvFileLib</kbd> class and stored the output of the <kbd>ReadCsvFile()</kbd> method in a variable. Finally, we looped through the list, which is returned by the <kbd>ReadCsvFile()</kbd> method, and printed the output in the console window.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Compressing? Why not?</h1>
                </header>
            
            <article>
                
<p>In this recipe, we will be looking at file compression capabilities supported on .NET Framework and how to use them in a .NET Standard 2.0 library. File compression classes are supported inside the <kbd>System.IO.Compression</kbd> namespace. Classes inside this namespace are used to compress the file as well as decompress it. They are also used to read content inside a compressed file. Let's have a look and create a .NET Standard 2.0 library that compresses and decompresses a file.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>Make sure you have the latest version of Visual Studio 2017 up and running. As mentioned previously, we will be using classes inside <kbd>System.IO.Compression</kbd><strong>.</strong> Mainly, we will be looking at the <kbd>ZipFile</kbd> class. Let's get going and build our library that compresses and decompresses a file.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<ol>
<li>Open Visual Studio 2017.</li>
<li>Click <span class="packt_screen">File</span> | <span class="packt_screen">New</span> | <span class="packt_screen">Project</span><strong> </strong>to create a project. </li>
<li>In the <span class="packt_screen">New Project</span> dialog box, expand the <span class="packt_screen">Other Project Types</span> node in the left-hand pane, and select <span class="packt_screen">Visual Studio Solutions</span>. In the right-hand pane, select <span class="packt_screen">Blank Solution</span><strong>.</strong></li>
</ol>
<ol start="4">
<li>In the <span class="packt_screen">Name:</span> textbox, type <kbd>Chapter3.Compress</kbd> and, in the <span class="packt_screen">Location:</span> textbox, select path from the drop-down box or click on the <span class="packt_screen">Browse...</span> button to locate a path.</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-634 image-border" src="assets/91ca9b7e-4c52-4010-8064-ce1b724a7512.png" style="width:46.50em;height:8.50em;"/></div>
<ol start="5">
<li>Click <span class="packt_screen">OK</span>.</li>
<li>Now, your Solution Explorer (<em>Ctrl</em> + <em>Alt</em> + <em>L</em>) should look like this:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-635 image-border" src="assets/505303ba-f200-4eda-9bdb-c4d1b928fb1b.png" style="width:30.00em;height:16.83em;"/></div>
<ol start="7">
<li>Now, right-click on the <kbd>Chapter3.Compress</kbd> label in the Solution Explorer and select <span class="packt_screen">Add</span> | <span class="packt_screen">New Project</span>.</li>
<li>In the <span class="packt_screen">New Project</span> dialog box, expand the <span class="packt_screen">Visual C#</span> node.</li>
</ol>
<ol start="9">
<li>Select <span class="packt_screen">.NET Standard</span> in the left-hand pane and <span class="packt_screen">Class Library (.NET Standard)</span> in the right-hand pane.</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-636 image-border" src="assets/8eb776ce-df84-4fdd-b99f-0289dc1b8d4c.png" style="width:156.58em;height:108.17em;"/></div>
<ol start="10">
<li>Now, in the <span class="packt_screen">Name:</span> textbox, type <kbd>Chapter3.Compress.CompressLib</kbd>, leave the other defaults as they are, and click <span class="packt_screen">OK</span>.</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-637 image-border" src="assets/7e0e60a1-0de0-48ca-a0c2-46c395355fdd.png" style="width:155.00em;height:14.67em;"/></div>
<ol start="11">
<li>Now, the <span class="packt_screen">Solution Explorer</span> (<em>Ctrl</em> + <em>Alt</em> + <em>L</em>) should look like this:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-638 image-border" src="assets/9e26f41e-5f28-4a35-81c7-40d2d8e78924.png" style="width:30.75em;height:14.42em;"/></div>
<ol start="12">
<li>Now select <kbd>Class1.cs</kbd> in the <span class="packt_screen">Solution Explorer</span> and press <em>F2</em> to rename the file <kbd>Zipper.cs</kbd>.</li>
<li>Answer <span class="packt_screen">Yes</span> in the confirmation dialog box that asks to rename the class name as well.</li>
<li>Now, in the <kbd>Zipper.cs</kbd> code window (double-click on the <kbd>Zipper.cs</kbd> label in <span class="packt_screen">Solution Explorer</span> to open), type the following code next to the last line of the <kbd>using</kbd> directives:</li>
</ol>
<pre>      using System.Collections.Generic;<br/>      using System.IO.Compression;</pre>
<ol start="15">
<li>Create a <kbd>private</kbd> class variable at the top of the class code (next to the starting curly bracket of the class):</li>
</ol>
<pre>      private string _sourcePath;</pre>
<ol start="16">
<li> Let's add a constructor to our class by adding this code:</li>
</ol>
<pre>      public Zipper(string sourcePath)<br/>      {<br/>          _sourcePath = sourcePath;<br/>      }</pre>
<ol start="17">
<li>Now add this method next to the constructor code:</li>
</ol>
<pre>      public void CompressFile(string zipPath)<br/>      {<br/>          ZipFile.CreateFromDirectory(zipPath, _sourcePath);<br/>      }</pre>
<ol start="18">
<li>Finally, add the following code to list the zipped content:</li>
</ol>
<pre>      public List&lt;string&gt; ListArchive(string zipFile)<br/>      {<br/>          var fileList = new List&lt;string&gt;()<br/>    <br/>          using (ZipArchive archive = ZipFile.OpenRead(zipFile)<br/>          {<br/>              foreach(var entry in archive.Entries)<br/>              {<br/>                  fileList.Add(entry.Name);<br/>              }<br/>          }<br/><br/>          return fileList;<br/>      }</pre>
<ol start="19">
<li> Perform a quick build by pressing <em>Ctrl</em> + <em>Shift</em> + <em>B</em>, for syntax errors.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>In steps 1 to 5, we created a blank solution using Visual Studio 2017 and gave it a proper, meaningful name. In steps 7 to 10, we added a .NET Standard 2.0 class library to the project. We renamed the default <kbd>Class1.cs</kbd> generated by the template in step 12. In step 14, we added two namespaces to the code. The <kbd>System.IO.Compression</kbd> namespace contains all the necessary classes for compressing and decompressing. In step 15, we added a private variable that holds the path to compress. In this case, it is a folder.</p>
<p>Step 16 introduced the constructor with a source path parameter to zip. In step 17, we created a method that uses the <kbd>ZipFile</kbd> class and its method to compress a given source folder. And then, finally, we created a method that lists the name of a compressed archive. It takes a parameter as the compressed zip files path:</p>
<pre>var fileList = new List&lt;string&gt;()<br/>    <br/>    using (ZipArchive archive = ZipFile.OpenRead(zipFile)<br/>    {<br/>        foreach(var entry in archive.Entries)<br/>        {<br/>            fileList.Add(entry.Name);<br/>        }<br/>    }<br/><br/>    return fileList;</pre>
<p class="mce-root">The first line creates an empty list that populates <kbd>strings</kbd> as items. Then we created a <kbd>ZipArchive</kbd> instance. We have used the <kbd>using</kbd> keyword to wrap around that statement. It's a safe method of programming for this sort of item. The <kbd>using</kbd> keyword is a very convenient way of using an object that implements the <kbd>IDisposable</kbd> interface.</p>
<div class="packt_quote packt_infobox">The <kbd>IDisposable</kbd> interface provides a mechanism for releasing unmanaged resources.</div>
<p>And finally, we went through all the entries using a <kbd>foreach</kbd> and then returned the populated list.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Creating a classic Windows application to use the library</h1>
                </header>
            
            <article>
                
<p>In this recipe, we will be looking at a classic Windows application that compresses a given folder using the library that we built in the previous recipe. Make sure you have completed the previous recipe that creates a .NET Standard 2.0 library.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>Let's open the previous solution for the library we built. Make sure you perform a quick build (<em>Ctrl</em> + <em>Shift</em> + <em>B</em>) to check for any syntax errors.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<ol>
<li>Open Visual Studio 2017.</li>
<li>Now open the solution that we built from the previous recipe.</li>
</ol>
<ol start="3">
<li>The <span class="packt_screen">Solution Explorer</span> should look like this:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-639 image-border" src="assets/70bc46ff-6ae4-4e2f-91a5-dc0ebe30c75f.png" style="width:17.50em;height:10.58em;"/></div>
<ol start="4">
<li>Now, let's select the solution name and right-click.</li>
<li>From the menu, select <span class="packt_screen">Add</span> | <span class="packt_screen">New Project</span>.</li>
<li>In the <span class="packt_screen">New Project</span> dialog box, expand the <span class="packt_screen">Visual C#</span> node and select <span class="packt_screen">Windows Classic Desktop</span> in the left-hand pane.</li>
<li>In the right-hand pane, select <span class="packt_screen">Windows Forms App (.NET Framework)</span>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-640 image-border" src="assets/b195f446-7a46-4da2-9e4a-5e2ebf9505b4.png" style="width:45.08em;height:31.33em;"/></div>
<ol start="8">
<li>Now, in the <span class="packt_screen">Name:</span> textbox, type <kbd>Chapter3.Compress.ZipperWinApp</kbd>, leave the <span class="packt_screen">Location:</span> textbox as it is, and click <span class="packt_screen">OK</span>.</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-641 image-border" src="assets/dcbc0737-590f-4900-bf54-407906de5747.png" style="width:155.50em;height:14.33em;"/></div>
<ol start="9">
<li>Now, the <span class="packt_screen">Solution Explorer</span> should look like this:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-642 image-border" src="assets/44558378-3ee4-47dc-b85a-407f35fca147.png" style="width:34.50em;height:26.25em;"/></div>
<ol start="10">
<li>Let's rename the <kbd>Form1.cs</kbd> as <kbd>MainForm.cs</kbd> by selecting it and pressing <em>F2</em>.</li>
<li>Answer <span class="packt_screen">Yes</span> in the confirmation box to confirm the changing of the main class name as well.</li>
<li>Now, select the Windows form from the designer window.</li>
<li>Drag drop a <span class="packt_screen">TextBox</span>, a <span class="packt_screen">Button</span>, and a <span class="packt_screen">ListBox</span> in the form.</li>
<li>Also drag drop a <span class="packt_screen">FolderDialogBox</span> control in the Windows form.</li>
</ol>
<ol start="15">
<li>Change the properties of the previous controls as per this table:<br/>
<table>
<tbody>
<tr>
<td><strong>Control</strong></td>
<td><strong>Property</strong></td>
<td><strong>Value</strong></td>
</tr>
<tr>
<td><span class="packt_screen">TextBox</span></td>
<td><span class="packt_screen">Name</span></td>
<td><kbd>FolderTextBox</kbd></td>
</tr>
<tr>
<td><span class="packt_screen">Button</span></td>
<td><span class="packt_screen">Name</span></td>
<td><kbd>BrowseButton</kbd></td>
</tr>
<tr>
<td><span class="packt_screen">Button</span></td>
<td><span class="packt_screen">Text</span></td>
<td><kbd>Browse...</kbd></td>
</tr>
<tr>
<td><span class="packt_screen">ListBox</span></td>
<td><span class="packt_screen">Name</span></td>
<td><kbd>FileListBox</kbd></td>
</tr>
<tr>
<td><span class="packt_screen">Form</span></td>
<td><span class="packt_screen">Text</span></td>
<td><kbd>Zipper WinApp</kbd></td>
</tr>
<tr>
<td><span class="packt_screen">FolderDialogBox</span></td>
<td><span class="packt_screen">Name</span></td>
<td><kbd>ZipFolder</kbd></td>
</tr>
</tbody>
</table>
</li>
<li>Now, your designer area should look like this:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-643 image-border" src="assets/44fdfaf1-1b8f-434a-a372-e3dc73619749.png" style="width:29.17em;height:27.08em;"/></div>
<ol start="17">
<li>Now, select the <kbd>Chapter3.Compress.ZipperWinApp</kbd> label in the <span class="packt_screen">Solution Explorer</span> and expand it.</li>
<li>Right-click on the <span class="packt_screen">References</span> label and select <span class="packt_screen">Add Reference</span>.</li>
<li>Click on the <span class="packt_screen">Projects</span> node in the <span class="packt_screen">Reference Manager</span> dialog box.</li>
</ol>
<ol start="20">
<li>Check the checkbox in front of <kbd>Chapter3.Compress.CompressLib</kbd> from the project list in the right-hand pane.</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-644 image-border" src="assets/86241a4f-2080-43d0-8b57-157733bc3541.png" style="width:49.00em;height:22.50em;"/></div>
<ol start="21">
<li> Click <span class="packt_screen">OK</span>.</li>
<li>Now double-click on the <span class="packt_screen">Browse...</span> button to open the code window.</li>
<li>Scroll up in the code window and add the following <kbd>using</kbd> directive to the last line of all the <kbd>using</kbd> directives, at the top:</li>
</ol>
<pre>      using Chapter3.Compress.CompressLib;</pre>
<ol start="24">
<li>Now scroll down till you reach the button click event of the <span class="packt_screen">Browse...</span> button and add the following code in between the curly brackets:</li>
</ol>
<pre>      if (ZipFolder.ShowDialog() == DialogResult.OK)<br/>      {<br/>          FolderTextBox.Text = ZipFolder.SelectedPath;<br/><br/>          string zipFileName = <br/>              @"C:\Projects\Chapter3\TestFolder\result.zip";<br/>    <br/>          var zipFile = new Zipper(zipFileName);<br/>          zipFile.CompressFile(FolderTextBox.Text);<br/><br/>          MessageBox.Show("You folder has been zipped.", <br/>              "Information", MessageBoxButtons.OK, <br/>              MessageBoxIcon.Information);<br/><br/>          var fileList = zipFile.ListArchive(zipFileName);<br/><br/>          FileListBox.Items.AddRange(fileList.ToArray());<br/>      }</pre>
<ol start="25">
<li>Let's press <em>F5</em> and test our code. Your output should look like this:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-645 image-border" src="assets/0166d55e-3817-4cb2-9729-1b4cb204009b.png" style="width:24.58em;height:22.08em;"/></div>
<ol start="26">
<li>Let's click the <span class="packt_screen">Browse...</span> button and navigate to a folder:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-684 image-border" src="assets/7662896a-fb9a-4830-9066-f5570ce3515d.png" style="width:26.75em;height:22.08em;"/></div>
<ol start="27">
<li>Click <span class="packt_screen">OK</span>. Now, the folder will be compressed and the output file will be <kbd>result.zip</kbd>.</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-685 image-border" src="assets/3ec8c012-edd8-43ba-ac56-c011ac4dd396.png" style="width:30.58em;height:21.17em;"/></div>
<ol start="28">
<li>Click <span class="packt_screen">OK</span>.</li>
<li>Now you will see the list of files in the compressed ZIP file:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-648 image-border" src="assets/1d79cbe3-df5d-4250-9357-b0d43cad2f70.png" style="width:23.17em;height:20.92em;"/></div>
<ol start="30">
<li>Let's browse to the folder selected using Windows Explorer and have a look (you can copy and paste the path from the textbox in the application itself):</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-649 image-border" src="assets/dadad59e-2bfc-4f17-a098-8a1eab594453.png" style="width:28.33em;height:18.17em;"/></div>
<ol start="31">
<li>Double-click on the file and you will see that the content of the ZIP file matches the list we had in step 29:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-650 image-border" src="assets/8a5b65af-ba46-4bf0-804d-102058f5dfc1.png" style="width:26.42em;height:24.08em;"/></div>
<ol start="32">
<li>Now close the app.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>In steps 1 to 9, we opened the existing solution with the .NET Standard 2.0 class library built in the previous recipe. Then we added a new Classic Windows Application project to that solution. We also gave it a proper name to match the solution. In steps 10 and 11, we renamed the default Windows form generated by Visual Studio. In steps 12 to 16, we added the necessary controls to build the user interface of our application.</p>
<p>In steps 18 to 21, we added the reference to the .NET Standard 2.0 library from our Classic Windows Application. This is a mandatory step, or else you will not have access to the library and its functionality. In step 23, we added a using statement that will tell the Windows application we have referenced the library and allow us to access its accessible methods.</p>
<p>In step 24, we added code to the button click event of the <span class="packt_screen">Browse...</span> button. In the first line of that code, we have used an <kbd>if</kbd> statement to open the folder dialog box and checked whether the <span class="packt_screen">OK</span> button is pressed in the dialog box. Then, the following two lines of code s<span>tore the selected path in the textbox of our Windows application:</span></p>
<pre>FolderTextBox.Text = ZipFolder.SelectedPath;<br/><br/>string zipFileName = @"C:\Projects\Chapter3\TestFolder\result.zip";</pre>
<p>Then we have a <kbd>string</kbd> variable that stores the destination ZIP filename: </p>
<pre>var zipFile = new Zipper(zipFileName);<br/>zipFile.CompressFile(FolderTextBox.Text);<br/><br/>MessageBox.Show("You folder has been zipped.", <br/>    "Information", MessageBoxButtons.OK, MessageBoxIcon.Information);</pre>
<p>In the first line, we have an instance of the <kbd>Zipper</kbd> class and, in the second line, we have used its <kbd>CompressFile()</kbd> method. Finally, we have displayed a notification to the end user by using the <kbd>MessageBox.Show()</kbd> method. Finally, in the following two lines of code, w<span>e used the </span><kbd>ListArchive()</kbd><span> method to extract the content of the ZIP file and added the output to the list box control:</span></p>
<pre>var fileList = zipFile.ListArchive(zipFileName);<br/>FileListBox.Items.AddRange(fileList.ToArray());</pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Encrypting and decrypting content in a text file</h1>
                </header>
            
            <article>
                
<p>In this recipe, we will be looking at another capability of the <kbd>System.IO</kbd> namespace. We will be creating a .NET Standard 2.0 library that encrypts an existing text file as well as decrypts it.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p class="mce-root">Encryption is a great way of securing your files. The <kbd>System.IO</kbd> namespace provides you with great functionality to encrypt and decrypt your content. Let's have a look at how to do it in a .NET Standard 2.0 library.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<ol>
<li>Open Visual Studio 2017.</li>
<li>Click <span class="packt_screen">File</span> | <span class="packt_screen">New</span> | <span class="packt_screen">Project</span><strong> </strong>to create a project. </li>
<li>In the <span class="packt_screen">New Project</span> dialog box, expand the <span class="packt_screen">Other Project Types</span> node in the left-hand pane, and select <span class="packt_screen">Visual Studio Solutions</span>. In the right-hand pane, select <span class="packt_screen">Blank Solution</span>.</li>
<li>In the <span class="packt_screen">Name:</span> textbox, type <kbd>Chapter3.SecureFile</kbd> and, in the <span class="packt_screen">Location:</span> textbox, select the path from the drop-down box or click on the <span class="packt_screen">Browse...</span> button to locate a path.</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-652 image-border" src="assets/536217ac-e63e-4237-af11-4aad1fdac658.png" style="width:47.08em;height:10.17em;"/></div>
<ol start="5">
<li>Click <span class="packt_screen">OK</span>.</li>
<li>Now, your <span class="packt_screen">Solution Explorer</span> (<em>Ctrl</em> + <em>Alt</em> + <em>L</em>) should look like this:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-654 image-border" src="assets/e79e009a-6297-4ca2-87df-7311c48a3f7f.png" style="width:26.58em;height:8.17em;"/></div>
<ol start="7">
<li>Now, right-click on the <kbd>Chapter3.SecureFile</kbd> label in the <span class="packt_screen">Solution Explorer</span> and select <span class="packt_screen">Add</span> | <span class="packt_screen">New Project</span><strong>.</strong></li>
<li>In the <span class="packt_screen">New Project</span> dialog box, expand the <span class="packt_screen">Visual C#</span> node.</li>
</ol>
<ol start="9">
<li>Select <span class="packt_screen">.NET Standard</span> in the left-hand pane and <span class="packt_screen">Class Library (.NET Standard)</span> in the right-hand pane.</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-655 image-border" src="assets/dec30139-1060-461e-a10d-7180279c4786.png" style="width:156.92em;height:108.33em;"/></div>
<ol start="10">
<li>Now, in the <span class="packt_screen">Name:</span> textbox, type <kbd>Chapter3.SecureFile.CryptLib</kbd>, leave the other defaults as they are, and click <span class="packt_screen">OK</span>.</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-656 image-border" src="assets/ccc1044a-50d5-4bc6-b040-223d78062981.png" style="width:45.58em;height:4.92em;"/></div>
<ol start="11">
<li>Now, the <span class="packt_screen">Solution Explorer</span> (<em>Ctrl</em> + <em>Alt</em> + <em>L</em>) should look like this:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-657 image-border" src="assets/b69b197f-d1cb-42ed-abcd-a65bb49539e5.png" style="width:24.25em;height:10.75em;"/></div>
<ol start="12">
<li>Now select <kbd>Class1.cs</kbd> in the <span class="packt_screen">Solution Explorer</span> and press <em>F2</em> to rename the file to <kbd>CryptFile.cs</kbd>.</li>
<li>Answer <span class="packt_screen">Yes</span> in the confirmation dialog box that asks to rename the class name as well.</li>
<li>Now double-click on<kbd>CryptFile.cs</kbd> to open the code window.</li>
<li>In the code window, scroll up to the top and add the following <kbd>using</kbd> directive to the last line of the <kbd>using</kbd> directives:</li>
</ol>
<pre>      using System.IO;</pre>
<ol start="16">
<li>Now add the following code next to the start curly bracket of the <kbd>CryptFile</kbd> class:</li>
</ol>
<pre>      private string _fileName;</pre>
<ol start="17">
<li>Let's add the default constructor method as follows:</li>
</ol>
<pre>      public CryptFile(string fileName)<br/>      {<br/>          _fileName = fileName;<br/>      }</pre>
<ol start="18">
<li>Now let's add a method to encrypt the file:</li>
</ol>
<pre>      public void EncryptFile()<br/>      {<br/>          File.Encrypt(_fileName);<br/>      }</pre>
<ol start="19">
<li>Also add this method to decrypt the file:</li>
</ol>
<pre>      public void DecryptFile()<br/>      {<br/>          File.Decrypt(_fileName);<br/>      }</pre>
<ol start="20">
<li>Press <em>Ctrl</em> + <em>Shift</em> + <em>B</em> to perform a quick build to check for the correct syntax.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>In steps 1 to 5, we opened Visual Studio 2017, created an empty solution, and gave it a proper name. In steps 7 to 11, we added a .NET Standard 2.0 library to the solution. In steps 12 and 13, we changed the default name of the class generated from the template. In step 15, we added the <kbd>System.IO</kbd> <span>namespace </span>that contains the file encryption and decryption functionality.</p>
<p>In step 16, we added a class-wide private <kbd>string</kbd> variable to hold the filename to encrypt and decrypt. In step 17, we added the default constructor that populates the private variable to hold the filename. In step 18, we added a method to encrypt the file. We used the <kbd>Encrypt()</kbd> method of the file class found in the <kbd>System.IO</kbd> <span>namespace</span>. We did the same in step 19 to decrypt the file.</p>
<p>Finally, we performed a quick build to check that all the syntax was intact.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Creating a classic Windows application to use the library</h1>
                </header>
            
            <article>
                
<p>This recipe will focus on building a classic Windows application to use the .NET Standard 2.0 library that we created in the previous recipe.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>Make sure you have completed the previous recipe where we built a .NET Standard 2.0 library. It used the <kbd>System.IO</kbd> namespace to encrypt and decrypt a file. Open that solution and do a quick <em>Ctrl</em> + <em>Shift</em> + <em>B</em> to check that everything is fine.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<ol>
<li>Open Visual Studio 2017.</li>
<li>Now open the solution we built from the previous recipe.</li>
<li>The <span class="packt_screen">Solution Explorer</span> should look like this:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-658 image-border" src="assets/57707bf4-4068-4cc0-a515-12579db36310.png" style="width:24.17em;height:11.00em;"/></div>
<ol start="4">
<li>Now, let's select the solution name and right-click.</li>
<li>From the menu, select <span class="packt_screen">Add</span> | <span class="packt_screen">New Project</span>.</li>
<li>In the <span class="packt_screen">New Project</span> dialog box, expand the <span class="packt_screen">Visual C#</span> node and select <span class="packt_screen">Windows Classic Desktop</span> in the left-hand pane.</li>
</ol>
<ol start="7">
<li>In the right-hand pane, select <span class="packt_screen">Windows Forms App (.NET Framework)</span>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/cb3a92e5-28de-4849-ab60-b87f8810b0b1.png" style="width:56.08em;height:38.83em;"/></div>
<ol start="8">
<li>Now, in the <span class="packt_screen">Name:</span> textbox, type <kbd>Chapter3.SecureFile.SecureWinApp</kbd>, leave the <span class="packt_screen">Location:</span> textbox as it is, and click <span class="packt_screen">OK</span>.</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-659 image-border" src="assets/08c0e52a-d4c0-4684-b641-2905e9746458.png" style="width:155.25em;height:14.83em;"/></div>
<ol start="9">
<li>Now, the <span class="packt_screen">Solution Explorer</span> should look like this:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-660 image-border" src="assets/00413fb3-2716-4b11-aed2-1a43bada7dd5.png" style="width:29.50em;height:23.42em;"/></div>
<ol start="10">
<li>Let's rename <kbd>Form1.cs</kbd> as <kbd>MainForm.cs</kbd>, by selecting it and pressing <em>F2</em>.</li>
<li>Answer <span class="packt_screen">Yes</span> in the confirmation box to confirm the changing of the main class name as well.</li>
<li>Now select the Windows form from the designer window.</li>
<li>Drag and drop two <span class="packt_screen">Buttons</span> in the form.</li>
<li>Also drag and drop an <kbd>OpenFileDialogBox</kbd> control in the Windows form.</li>
<li>Change the properties of the previous controls as per this table:<br/>
<table>
<tbody>
<tr>
<td><strong>Control</strong></td>
<td><strong>Property</strong></td>
<td><strong>Value</strong></td>
</tr>
<tr>
<td><span class="packt_screen">Button</span></td>
<td><span class="packt_screen">Name</span></td>
<td><kbd>EncryptButton</kbd></td>
</tr>
<tr>
<td><span class="packt_screen">Button</span></td>
<td><span class="packt_screen">Text</span></td>
<td><kbd>Encrypt</kbd></td>
</tr>
<tr>
<td><span class="packt_screen">Button</span></td>
<td><span class="packt_screen">Name</span></td>
<td><kbd>DecryptButton</kbd></td>
</tr>
<tr>
<td><span class="packt_screen">Button</span></td>
<td><span class="packt_screen">Text</span></td>
<td><kbd>Decrypt</kbd></td>
</tr>
<tr>
<td><span class="packt_screen">OpenFileDialogBox</span></td>
<td><span class="packt_screen">Name</span></td>
<td><kbd>OpenDialog</kbd></td>
</tr>
<tr>
<td><span class="packt_screen">OpenFileDialogBox</span></td>
<td><span class="packt_screen">Filter</span></td>
<td><kbd>Text Files|*.txt</kbd></td>
</tr>
</tbody>
</table>
</li>
</ol>
<ol start="16">
<li>Now, your designer area should look like this:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-661 image-border" src="assets/060b628e-8463-4a20-b2a8-599f8bcf9d65.png" style="width:31.50em;height:36.83em;"/></div>
<ol start="17">
<li>Now select the <kbd>Chapter3.SecureFile.SecureWinApp</kbd> label in the <span class="packt_screen">Solution Explorer</span> and expand it.</li>
<li>Right-click on the <span class="packt_screen">References</span> label and select <span class="packt_screen">Add Reference</span>.</li>
<li>Click on the <span class="packt_screen">Projects</span> node in the <span class="packt_screen">Reference Manager</span> dialog box. </li>
</ol>
<ol start="20">
<li>Check the check box in front of the <kbd>Chapter3.SecureFile.CryptLib</kbd> label from the project list in the right-hand pane.</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-662 image-border" src="assets/0912295c-c415-465c-a3a3-9a63fc2fdb8e.png" style="width:44.75em;height:20.42em;"/></div>
<ol start="21">
<li> Click <span class="packt_screen">OK</span>.</li>
<li>Now switch back to the design window and double-click on the <span class="packt_screen">Encrypt</span> button to open the code window.</li>
<li>In the code window, scroll up to the top and add the following <kbd>using</kbd> directive as the last line of the <kbd>using</kbd> block:</li>
</ol>
<pre>      using Chapter3.SecureFile.CryptLib;</pre>
<ol start="24">
<li>Now scroll down to the <span class="packt_screen">Encrypt</span> button, click, and add the following code in between the curly brackets:</li>
</ol>
<pre>      if (OpenDialog.ShowDialog() == DialogResult.OK)<br/>      {<br/>          var textFileName = OpenDialog.FileName;<br/>          var secureFile = new CryptFile(textFileName);<br/><br/>          secureFile.EncryptFile();<br/><br/>          MessageBox.Show("File encrypted", "Information", <br/>              MessageBoxButtons.OK,     <br/>              MessageBoxIcon.Information);<br/>      }</pre>
<ol start="25">
<li>Now switch back to the designer window by clicking on the <span class="packt_screen">MainForm.cs [designer]</span> tab.</li>
<li>Double-click on the <span class="packt_screen">Decrypt</span> button to reach the code for that button click.</li>
<li>Add the following code in between the curly brackets of the button click code:</li>
</ol>
<pre>      if (OpenDialog.ShowDialog() == DialogResult.OK)<br/>      {<br/><br/>          var textFileName = OpenDialog.FileName;<br/>          var secureFile = new CryptFile(textFileName);<br/><br/>          secureFile.DecryptFile();<br/><br/>          MessageBox.Show("File decrypted", "Information", <br/>              MessageBoxButtons.OK,<br/>              MessageBoxIcon.Information);<br/>      }</pre>
<ol start="28">
<li>Now press <em>F5</em> to execute the code (make sure the classic Windows application project is the default project)</li>
<li>Press the <span class="packt_screen">Encrypt</span> button and select a file:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-687 image-border" src="assets/b69b8519-f9d9-47de-a202-c485009ca1a7.png" style="width:146.08em;height:79.25em;"/></div>
<ol start="30">
<li>Click <span class="packt_screen">Open</span> and click <span class="packt_screen">OK</span> in the information box.</li>
<li>Now open Windows Explorer and navigate to the location of the file that you just encrypted.</li>
<li>You will notice a lock on the file.</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-664 image-border" src="assets/6fe3a32c-4edb-45bb-95ec-bc81391a7471.png" style="width:129.08em;height:79.75em;"/></div>
<ol start="33">
<li>Now switch back to your app, click on the <span class="packt_screen">Decrypt</span> button, and follow the same steps as before.</li>
</ol>
<ol start="34">
<li>Now the lock is removed from the file.</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-665 image-border" src="assets/329f4d76-d1e0-4ce4-801b-574f74a7851e.png" style="width:47.33em;height:29.17em;"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>In steps 1 to 4, we opened the existing solution with the library we built in the previous recipe. In steps 5 to 9, we added a classic Windows project to the solution. We have assigned proper names to the project to keep consistency and readability. In steps 10 to 15, we changed the name of the Windows form and then added necessary controls to the form. At the end, we changed the properties of those controls. </p>
<p>In steps 18 to 21, we added a reference to the project that contains the library. This is a mandatory step, or else we won't be able to access the library functionality from our Windows application. Now, in step 23, we added the reference to a library project from the code level. This step will allow you to access all the methods available from the code level. In step 24, we used an <kbd>if</kbd> statement to open the <span class="packt_screen">File Open</span> dialog box and to check whether the <span class="packt_screen">Open</span> button is clicked. In the next lines of code, we created an instance of the <kbd>CryptFile</kbd> class and used the filename with the path as its parameter. Finally, we used the <kbd>EncryptFile()</kbd> method to start the encryption and <kbd>MessageBox.Show()</kbd> to display the information to the user. Again, in step 25, we used the Decrypt button of the application to use the other <kbd>DecryptFile()</kbd> method of the <kbd>CryptFile</kbd> class.</p>
<p>Finally, in steps 28 to 31, we executed our application and tested it. In steps 32 and 34, we confirmed that encryption and decryption worked.</p>


            </article>

            
        </section>
    </body></html>