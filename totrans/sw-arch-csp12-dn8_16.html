<html><head></head><body>
<div><h1 class="chapterNumber">16</h1>
<h1 class="chapterTitle" id="_idParaDest-326">Working with Serverless – Azure Functions</h1>
<p class="normal">In <em class="chapterRef">Chapter 10</em>, <em class="italic">Deciding on the Best Cloud-Based Solution</em>, we explored the fundamentals and strategic advantages of different cloud architectures and serverless can be considered one of the newest ways to provide flexible cloud-based solutions. We delved into how serverless systems offer scalability, cost-efficiency, and agility – key factors that drive today’s software architecture decisions.</p>
<p class="normal">Building on that foundation, this chapter delves deeper into a pivotal component of serverless architecture: Azure Functions.</p>
<p class="normal">Azure Functions stands out as the component that Microsoft delivers as a prime example of serverless architecture in action. It offers a versatile, event-driven approach that integrates seamlessly with the .NET ecosystem, making it the for architects and developers aiming to build efficient, scalable, and responsive applications.</p>
<p class="normal">We will navigate through the intricacies of Azure Functions, emphasizing their application in complex enterprise environments. This chapter will arm you with practical insights into leveraging Azure Functions for robust application architecture, discussing best practices, design patterns, and advanced features specific to the .NET stack.</p>
<p class="normal">This chapter provides a comprehensive understanding of Azure Functions, focusing on enhancing your technical mastery of this platform. We delve into the specifics of Azure Functions, covering its setup, programming using C#, and various hosting plans like the Consumption, Premium, and App Service plans. By the end of this chapter, you will have a thorough understanding of Azure Functions, equipped with the knowledge to deploy, maintain, and optimize its functions effectively in your projects.</p>
<p class="normal">In this chapter, we will cover the following topics:</p>
<ul>
<li class="bulletList">Understanding the Azure Functions app</li>
<li class="bulletList">Programming Azure Functions using C#</li>
<li class="bulletList">Maintaining Azure Functions</li>
</ul>
<p class="normal">By the end of this chapter, you will understand how to use Azure Functions in C# to speed up your development cycle.</p>
<h1 class="heading-1" id="_idParaDest-327">Technical requirements</h1>
<p class="normal">This chapter requires that you have the following:</p>
<ul>
<li class="bulletList">The free Visual Studio 2022 Community Edition or, even better, with all the Azure tools installed.</li>
<li class="bulletList">A free Azure account. The <em class="italic">Creating an Azure account</em> section of <em class="italic">Chapter 1</em>, <em class="italic">Understanding the Importance of Software Architecture</em>, explains how to create one.</li>
</ul>
<h1 class="heading-1" id="_idParaDest-328">Understanding the Azure Functions app</h1>
<p class="normal">The Azure Functions app<a id="_idIndexMarker1128"/> is an Azure <strong class="keyWord">PaaS</strong> (<strong class="keyWord">platform as a service</strong>) where you can build pieces of code (functions), connect them to your application, and use triggers to start them. The concept is quite simple – you build a function in the language you prefer and decide on the trigger that will start it. You can write as many functions as you want in your system. There are cases where the system is written entirely with functions.</p>
<p class="normal">The steps to create the necessary environment are as simple as the ones we need to follow to create the function itself. The following screenshot shows the parameters that you must decide on when you create the environment. After you select <strong class="keyWord">Create a resource</strong> in Azure and filter by <strong class="keyWord">Function App</strong>, upon clicking the <strong class="keyWord">Create</strong> button, you will see<a id="_idIndexMarker1129"/> the following screen:</p>
<figure class="mediaobject"><img alt="" role="presentation" src="img/B19820_16_01.png"/></figure>
<p class="packt_figref">Figure 16.1: Creating an Azure function app</p>
<p class="normal">There are a couple of key points that you should consider while creating your Azure Functions environment. The possibilities given for running functions increase from time to time, as do the programming language options and publishing styles. One of the most important configurations we have is the hosting plan, which is where you will run your functions. There are three options<a id="_idIndexMarker1130"/> for the hosting plan: a Consumption (Serverless), Premium, and App Service plan. Let’s talk about them.</p>
<h2 class="heading-2" id="_idParaDest-329">Consumption plan</h2>
<p class="normal">If you choose a Consumption plan, your functions<a id="_idIndexMarker1131"/> will only consume resources when they are executed. This means that you will only be charged while your functions are running. Scalability and memory resources will be automatically managed by Azure. This is truly what we call serverless.</p>
<p class="normal">Something we need to take note of while writing functions in this plan is the timeout. By default, after 5 minutes, the function will time out. You can change the timeout value using the <code class="inlineCode">functionTimeout</code> parameter in the <code class="inlineCode">host.json</code> file. The maximum value is 10 minutes.</p>
<div><p class="normal">When you choose the Consumption plan, how you will be charged will depend on what you are executing, the execution<a id="_idIndexMarker1132"/> time, and memory usage. More information on this can be found at <a href="https://azure.microsoft.com/en-us/pricing/details/functions/">https://azure.microsoft.com/en-us/pricing/details/functions/</a>.</p>
</div>
<p class="normal">Note that this can be a good option when you do not have app services in your environment, and you are running functions with low periodicity. On the other hand, if you need continuous processing, you may want<a id="_idIndexMarker1133"/> to consider using a Premium plan or an App Service plan. Let’s have a look at them below.</p>
<h2 class="heading-2" id="_idParaDest-330">Premium plan</h2>
<p class="normal">Depending on what you use<a id="_idIndexMarker1134"/> your functions for, especially if they need to run continuously or almost continuously, or if some function executions take longer than 10 minutes, you may want to consider a Premium plan. Besides, you may need to connect your function to a VNET/VPN environment, and in this case, you will be forced to run in this plan.</p>
<p class="normal">You may also need more CPU or memory options than what is provided with the Consumption plan. The Premium plan gives you one-core, two-core, and four-core instance options.</p>
<p class="normal">It is worth mentioning that even with unlimited time to run your function if you decide to use an HTTP trigger function, 230 seconds is the maximum allowed for responding to a request. The reason this is a limit is related to the default idle timeout value of Azure Load Balancer.</p>
<div><p class="normal">You may have to redesign your solution<a id="_idIndexMarker1135"/> in such situations to adhere to the best practices set by Microsoft (<a href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-best-practices">https://docs.microsoft.com/en-us/azure/azure-functions/functions-best-practices</a>).</p>
</div>
<p class="normal">Although the Premium plan is a great alternative, if you want to optimize the usage of your App Services<a id="_idIndexMarker1136"/> instances, the best option is the App Service plan. Let’s have a look at it.</p>
<h2 class="heading-2" id="_idParaDest-331">The App Service plan</h2>
<p class="normal">The App Service plan is one of the options<a id="_idIndexMarker1137"/> you can choose when you want to create an Azure Functions app. Here are a couple of reasons (suggested by Microsoft) why you should use the App Service plan instead of the Consumption plan to maintain your functions:</p>
<ul>
<li class="bulletList">You can use underutilized existing App Service instances.</li>
<li class="bulletList">You can run your function app on a custom image if you want to.</li>
</ul>
<p class="normal">In the App Service plan scenario, the <code class="inlineCode">functionTimeout</code> value varies according to the Azure Functions runtime version. However, the value needs to be at least 30 minutes.</p>
<div><p class="normal">You can find a tabled comparison<a id="_idIndexMarker1138"/> between the timeouts in each Consumption plan at <a href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-scale#timeout">https://docs.microsoft.com/en-us/azure/azure-functions/functions-scale#timeout</a>.</p>
</div>
<p class="normal">Now that we have a foundational understanding of the Azure Functions app and its role in serverless architecture, let’s explore how to bring these concepts into action. In the following section, we’ll dive into programming Azure Functions using C#, turning theoretical knowledge into practical application.</p>
<h1 class="heading-1" id="_idParaDest-332">Programming Azure Functions using C#</h1>
<p class="normal">In this section, you will learn how to create<a id="_idIndexMarker1139"/> Azure Functions. It is worth mentioning<a id="_idIndexMarker1140"/> that there are several ways to create them using C#. The first one is by creating the functions and developing them in the Azure portal itself. To do this, let us assume that you have created an Azure Functions app with similar configurations to the ones in the screenshot at the beginning of the chapter.</p>
<p class="normal">By selecting the resource created and navigating to the <strong class="screenText">Functions</strong> menu, you will be able to add new functions to this environment, as you can see in the following screenshot:</p>
<figure class="mediaobject"><img alt="" role="presentation" src="img/B19820_16_02.png"/></figure>
<p class="packt_figref">Figure 16.2: Adding a function</p>
<p class="normal">Here, you will need to decide the kind of trigger that you want to use to start the execution. The most frequently used ones are the <strong class="screenText">HTTP trigger</strong> and the <strong class="screenText">Timer trigger</strong>. The first enables the creation of an HTTP API that will trigger the function. The second means functions will be triggered by a timer you set.</p>
<p class="normal">When you decide on the trigger <a id="_idIndexMarker1141"/>you want to use, you must name<a id="_idIndexMarker1142"/> the function. Depending on the trigger you decide on, you will have to set up some parameters. For instance, an <strong class="screenText">HTTP trigger</strong> requires that you set up an authorization level. Three options are available: <strong class="screenText">Function</strong>, <strong class="screenText">Anonymous</strong>, and <strong class="screenText">Admin</strong>. The <strong class="screenText">Function</strong> option requires a specific key to access each HTTP trigger, while <strong class="screenText">Anonymous</strong> does not require anything. For the <strong class="screenText">Admin</strong> option, the key used is the master one, which is created together with the function app.</p>
<figure class="mediaobject"><img alt="Interface gráfica do usuário, Texto, Aplicativo  Descrição gerada automaticamente" src="img/B19820_16_03.png"/></figure>
<p class="packt_figref">Figure 16.3: Configuring an HTTP function</p>
<p class="normal">It is important to note that this book<a id="_idIndexMarker1143"/> does not cover all the options<a id="_idIndexMarker1144"/> that are available when it comes to building functions. As a software architect, you should understand that Azure provides a good service for serverless architectures in terms of functions. This can be useful in several situations. This was discussed in more detail in <em class="italic">Chapter 10</em>, <em class="italic">Deciding on the Best Cloud-Based Solution</em>.</p>
<p class="normal">The result of this is as follows. Notice that Azure provides an editor that allows us to run the code, check logs, and test the function that we have created. This is a good interface for testing and coding basic functions:</p>
<figure class="mediaobject"><img alt="" role="presentation" src="img/B19820_16_04.png"/></figure>
<p class="packt_figref">Figure 16.4: HTTP function environment</p>
<p class="normal">However, if you want<a id="_idIndexMarker1145"/> to create more sophisticated <a id="_idIndexMarker1146"/>functions, you may need a more sophisticated environment so that you can code and debug them more efficaciously. This is where the Visual Studio Azure Functions project can help you. Besides, using Visual Studio to execute the development of the function moves you in the direction of using source control and CI/CD for your functions.</p>
<p class="normal">In Visual Studio, you can create a project dedicated to Azure Functions by going to <strong class="screenText">Create a new project</strong>:</p>
<figure class="mediaobject"><img alt="Texto  Descrição gerada automaticamente" src="img/B19820_16_05.png"/></figure>
<p class="packt_figref">Figure 16.5: Creating an Azure Functions project in Visual Studio 2022</p>
<p class="normal">Once you have created<a id="_idIndexMarker1147"/> your project, Visual Studio will ask<a id="_idIndexMarker1148"/> you for the type of triggers you are using and for the Azure version that your function will run on. It is worth mentioning that, for some scenarios, a storage account is required while creating the function app, such as managing triggers and logging executions.</p>
<figure class="mediaobject"><img alt="" role="presentation" src="img/B19820_16_06.png"/></figure>
<p class="packt_figref">Figure 16.6: Creating a new Azure Functions application</p>
<p class="normal">It is worth mentioning that Azure Functions supports different platforms and programming languages. At the time of writing, there are two available runtime versions of Azure Functions with support provided. The first version (v1) is compatible with .NET Framework 4.8. The v2 and v3 versions are not supported anymore, so for .NET 8, you shall use version 4 (v4).</p>
<div><p class="normal">You can always check<a id="_idIndexMarker1149"/> for up-to-date information about it at <a href="https://learn.microsoft.com/en-us/azure/azure-functions/functions-versions">https://learn.microsoft.com/en-us/azure/azure-functions/functions-versions</a>.</p>
</div>
<p class="normal">As a software architect, you must keep<a id="_idIndexMarker1150"/> code reusability in mind. In this case, you should<a id="_idIndexMarker1151"/> pay attention to which version of Azure Functions you decide to build your functions in. However, it is always recommended that you use the latest version of the runtime as soon as it acquires general availability status.</p>
<p class="normal">By default, the code that is generated is similar to that generated when you create Azure Functions in the Azure portal:</p>
<pre class="programlisting code"><code class="hljs-code">using System.Net;
using Google.Protobuf.WellKnownTypes;
using Microsoft.AspNetCore.WebUtilities;
using Microsoft.Azure.Functions.Worker;
using Microsoft.Azure.Functions.Worker.Http;
using Microsoft.Extensions.Logging;
namespace FunctionAppSampleIsolated
{
    public class AzureFunctionHttpSampleNet8
    {
        private readonly ILogger _logger;
        public AzureFunctionHttpSampleNet8(ILoggerFactory loggerFactory)
        {
            _logger = loggerFactory.CreateLogger&lt;AzureFunctionHttpSampleNet8&gt;();
        }
        [Function("AzureFunctionHttpSampleNet8")]
        public HttpResponseData Run([HttpTrigger(AuthorizationLevel.Function, "get", "post")] HttpRequestData req)
        {
            _logger.LogInformation("C# HTTP trigger function processed a request.");
            string responseMessage = "This HTTP triggered function executed successfully. Pass a name in the query string or in the request body for a personalized response.";
            var queryDictionary = QueryHelpers.ParseQuery(req.Url.Query);
            if (queryDictionary.ContainsKey("name"))
                responseMessage = $"Hello, {queryDictionary["name"]}. This HTTP triggered function executed successfully.";
            var response = req.CreateResponse(HttpStatusCode.OK);
            response.Headers.Add("Content-Type", "text/plain; charset=utf-8");
            response.WriteString(responseMessage);
            return response;
        }
    }
}
</code></pre>
<p class="normal">Since you have understood<a id="_idIndexMarker1152"/> the basis for creating Azure Functions<a id="_idIndexMarker1153"/> using C#, it is also important to understand the number of triggers that are available as templates for Azure Functions. Let’s have a look at that.</p>
<h2 class="heading-2" id="_idParaDest-333">Listing Azure Functions templates</h2>
<p class="normal">There are several templates in the Azure portal<a id="_idIndexMarker1154"/> that you can use to create Azure Functions. The number of templates that you can choose from is updated continuously. The following are just a few of them:</p>
<ul>
<li class="bulletList"><strong class="keyWord">Blob Trigger</strong>: You may want to process something for a file as soon as the file is uploaded to your blob storage. This can be a good use case for Azure Functions.</li>
<li class="bulletList"><strong class="keyWord">Cosmos DB Trigger</strong>: You may want to synchronize data that arrives in a Cosmos DB database with a processing method. Cosmos DB was discussed in detail in <em class="italic">Chapter 12</em>, <em class="italic">Choosing Your Data Storage in the Cloud</em>.</li>
<li class="bulletList"><strong class="keyWord">Event Grid Trigger</strong>: This is a good way to manage Azure events. Functions can be triggered so that they manage each event.</li>
<li class="bulletList"><strong class="keyWord">Event Hub Trigger</strong>: With this trigger, you can build functions that are linked to any system that sends data to Azure Event Hubs.</li>
<li class="bulletList"><strong class="keyWord">HTTP Trigger</strong>: This trigger is useful for building serverless APIs and web app events.</li>
<li class="bulletList"><strong class="keyWord">IoT Hub Trigger</strong>: When your application is connected to devices using IoT Hub, you can use this trigger whenever a new event is received by one of the devices.</li>
<li class="bulletList"><strong class="keyWord">Queue Trigger</strong>: You can handle queue processing using a function-as-a-service solution.</li>
<li class="bulletList"><strong class="keyWord">Service Bus Queue Trigger</strong>: This is another messaging service that can be a trigger for functions. Azure Service Bus was covered in more detail in <em class="italic">Chapter 11</em>, <em class="italic">Applying a Microservice Architecture to Your Enterprise Application</em>.</li>
<li class="bulletList"><strong class="keyWord">Timer Trigger</strong>: This is commonly used with functions and is where you specify time triggers so that you can continuously process data from your system.</li>
</ul>
<div><p class="normal">You can find the complete list of triggers<a id="_idIndexMarker1155"/> and bindings available for Azure Functions at <a href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-triggers-bindings">https://docs.microsoft.com/en-us/azure/azure-functions/functions-triggers-bindings</a>.</p>
</div>
<p class="normal">With a solid understanding of how<a id="_idIndexMarker1156"/> to program Azure Functions in C#, let’s now ensure their longevity and performance. In the upcoming section, we will uncover the best practices and tools necessary for the effective management and monitoring of your serverless architecture.</p>
<h1 class="heading-1" id="_idParaDest-334">Maintaining Azure Functions</h1>
<p class="normal">Once you have created and programmed<a id="_idIndexMarker1157"/> your function, you need to monitor and maintain it. To do this, you can use a variety of tools, all of which you can find in the Azure portal. These tools will help you solve problems due to the amount of information you will be able to collect with them.</p>
<p class="normal">The first option when it comes to monitoring your function is using the <strong class="keyWord">Monitor</strong> menu inside the Azure Functions interface in the Azure portal. There, you will be able to check all your function executions, including successful results and failures:</p>
<figure class="mediaobject"><img alt="" role="presentation" src="img/B19820_16_07.png"/></figure>
<p class="packt_figref">Figure 16.7: Monitoring a function</p>
<p class="normal">It will take about 5 minutes for any results to be available. The date shown in the grid is in UTC time.</p>
<p class="normal">By clicking on <strong class="screenText">Run query in Application Insights</strong>, the same interface<a id="_idIndexMarker1158"/> allows you to connect to this tool. This will take you to a world of almost infinite options that you can use to analyze<a id="_idIndexMarker1159"/> your function data. Application Insights is an excellent option for <strong class="keyWord">Application Performance Management</strong> (<strong class="keyWord">APM</strong>):</p>
<figure class="mediaobject"><img alt="" role="presentation" src="img/B19820_16_08.png"/></figure>
<p class="packt_figref">Figure 16.8: Monitoring using Application Insights</p>
<p class="normal">Beyond the query interface, you can also check all the performance issues of your function using the Application Insights interface in the Azure portal. There, you can analyze and filter all the requests that have been received by your solution and check their performance and dependencies. You can also trigger alerts when something abnormal happens to one of your endpoints.</p>
<p class="normal">You can find this resource in the Azure<a id="_idIndexMarker1160"/> portal by selecting your function resource and searching for <strong class="keyWord">Application Insights</strong>.</p>
<figure class="mediaobject"><img alt="" role="presentation" src="img/B19820_16_09.png"/></figure>
<p class="packt_figref">Figure 16.9: Monitoring using Application Insights live metrics</p>
<p class="normal">As a software architect, you will find a good daily helper for your projects in this tool. Please remember that Application Insights works on several other Azure services, such as Web Apps and Virtual Machines. This means<a id="_idIndexMarker1161"/> that you can monitor the health of your system and maintain it using the wonderful features provided by Azure.</p>
<h1 class="heading-1" id="_idParaDest-335">Azure Durable Functions</h1>
<p class="normal">If you decide to delve deeper<a id="_idIndexMarker1162"/> into the usage of serverless, you may consider Azure Durable Functions as a good option for designing orchestration scenarios. Azure Durable Functions let us write stateful workflows, managing the state behind the scenes. To do so, you<a id="_idIndexMarker1163"/> will have to write an <strong class="keyWord">orchestrator function</strong>, which is basically a procedure that defines the workflow that you want to run. You may<a id="_idIndexMarker1164"/> also need some <strong class="keyWord">entity functions</strong> to enable the reading of small pieces of state.</p>
<p class="normal">The following are some application patterns where this solution can be used; however, it is important to remember that it is not suitable for all applications:</p>
<ul>
<li class="bulletList"><strong class="keyWord">Function chaining</strong>: When you need to execute a sequence of functions in a particular order.</li>
<li class="bulletList"><strong class="keyWord">Async HTTP APIs</strong>: A good way to solve long-running operations with external clients, where you will have the opportunity to get a status API because of the orchestrator function. There is a sample code of this pattern as soon as you create an orchestrator function in Visual Studio.</li>
<li class="bulletList"><strong class="keyWord">Fan-out/fan-in</strong>: The ability to run multiple functions in parallel and wait for them to finish to conclude work in an aggregate function.</li>
<li class="bulletList"><strong class="keyWord">Monitors</strong>: A way to monitor a process without using a timer trigger, enabling configured intervals to monitor many instances of a process.</li>
<li class="bulletList"><strong class="keyWord">Human interaction</strong>: A way to automate a process even when you need human interaction, but you need to monitor the response after a period.</li>
<li class="bulletList"><strong class="keyWord">Aggregator</strong>: A way to address event data over a period into a single entity.</li>
</ul>
<p class="normal">When it comes to pricing, we should keep in mind that Azure Durable Functions are billed the same way common Azure Functions are. The only concern you must consider is that orchestrator functions might replay several times throughout the lifetime of an orchestration, and you will be billed for each replay.</p>
<p class="normal">Once we have covered the possibilities presented by Azure Durable Functions, it is also important to evaluate the roadmap of Azure Functions. The reason why we keep writing about this arises from the changes Azure Functions has suffered since its creation. Considering that a serverless application based on Azure Functions can be the kernel of your solution, this is a very important topic that needs to be discussed. Let’s check it out now.</p>
<h1 class="heading-1" id="_idParaDest-336">Azure Functions roadmap</h1>
<p class="normal">The structure of Azure Functions<a id="_idIndexMarker1165"/> has changed since it was rolled out in 2016. The number of people using the tool and the changes related to .NET caused some compatibility problems that saw Microsoft come up with a new way of delivering the deployment of functions. This new way is called the isolated process model, and it has been available since .NET 5. It is also important to mention that the currently supported available runtime versions for Azure Functions are v1 and v4. </p>
<p class="normal">According to the current roadmap, using the isolated process model is the only way to run Azure Functions in .NET 8 and future versions. There is a plan to have the in-process model for .NET 8, but no date has been confirmed yet.</p>
<figure class="mediaobject"><img alt="thumbnail image 1 captioned A diagram showing the change in release patterns after parity. .NET 8 has an in-process model option on a delay after the isolated worker model. All subsequent updates use the isolated worker model." src="img/B19820_16_10.png"/></figure>
<p class="packt_figref">Figure 16.10: Azure Functions roadmap</p>
<p class="normal">As a software architect, you must keep<a id="_idIndexMarker1166"/> an eye on the roadmaps provided so that you can decide on the best implementation for your solution.</p>
<p class="normal">When implementing an Azure function using the isolated process model, you will have access to the startup of the function in a <code class="inlineCode">Program.cs</code> file. This means that you will have to configure and create the instance of your function:</p>
<pre class="programlisting code"><code class="hljs-code"> var host = new HostBuilder()
    .ConfigureFunctionsWorkerDefaults()
    .ConfigureServices(services =&gt;
    {
        services.AddApplicationInsightsTelemetryWorkerService();
        services.ConfigureFunctionsApplicationInsights();
    })
    .Build();
</code></pre>
<p class="normal">It is worth mentioning<a id="_idIndexMarker1167"/> that to do so, you will need <code class="inlineCode">Microsoft.Azure.Functions.Worker.Extensions</code> packages. You can<a id="_idIndexMarker1168"/> find a very good guide to doing this at <a href="https://docs.microsoft.com/en-us/azure/azure-functions/dotnet-isolated-process-guide">https://docs.microsoft.com/en-us/azure/azure-functions/dotnet-isolated-process-guide</a>.</p>
<h1 class="heading-1" id="_idParaDest-337">The decision to use serverless and Azure Functions</h1>
<p class="normal">Even with the benefits presented during<a id="_idIndexMarker1169"/> this chapter, there is always<a id="_idIndexMarker1170"/> a question about why one would use a serverless function over having it as part of a bigger web application. </p>
<p class="normal">If you think exclusively about HTTP Trigger functions, this question is more difficult to answer because you can create a Web API application that generally solves the problems in this scenario.</p>
<p class="normal">However, there are some use cases where an Azure Function is truly the best option. Let’s list them to help you with this decision in your scenario:</p>
<ul>
<li class="bulletList"><strong class="keyWord">When you need to execute a periodic task</strong>: Azure Functions with <em class="italic">Timer Trigger</em> is, for sure, a great option. Using Cron expressions, you will be able to set different periods<a id="_idIndexMarker1171"/> to have your function running. You can check out more details at <a href="https://learn.microsoft.com/en-us/azure/azure-functions/functions-bindings-timer">https://learn.microsoft.com/en-us/azure/azure-functions/functions-bindings-timer</a>.</li>
<li class="bulletList"><strong class="keyWord">When you want to execute a task after some data changes</strong>: By using triggers like <em class="italic">Blob Trigger</em>, <em class="italic">Queue Trigger</em>, or <em class="italic">CosmosDB Trigger</em>, you can monitor data changes and subsequently execute a specific task in response to these changes, which<a id="_idIndexMarker1172"/> may be useful in some scenarios. There is a great example of how to use it at <a href="https://learn.microsoft.com/en-us/azure/azure-functions/functions-create-cosmos-db-triggered-function">https://learn.microsoft.com/en-us/azure/azure-functions/functions-create-cosmos-db-triggered-function</a>.</li>
<li class="bulletList"><strong class="keyWord">When you want to execute a task after some event happens on devices or another system</strong>: Again, without needing to pool data, you can use <em class="italic">Event Grid Trigger</em>, <em class="italic">Event Hub Trigger</em>, <em class="italic">IoT Hub Trigger</em>, or <em class="italic">Service Bus Queue Trigger</em> to track an event and start a task with the information provided by it. You can check<a id="_idIndexMarker1173"/> out more information about it at <a href="https://learn.microsoft.com/en-us/azure/azure-functions/functions-bindings-event-hubs-trigger">https://learn.microsoft.com/en-us/azure/azure-functions/functions-bindings-event-hubs-trigger</a>.</li>
</ul>
<p class="normal">To make this decision easier, in <em class="italic">Chapter 21</em>, <em class="italic">Case Study</em>, you will find the complete tutorial to implement the architecture presented below.</p>
<p class="normal">To give users a great experience, all the emails that are sent by the application will be queued asynchronously, thereby preventing significant delays in the system’s responses.</p>
<figure class="mediaobject"><img alt="Diagram  Description automatically generated" src="img/B19820_16_11.png"/></figure>
<p class="packt_figref">Figure 16.11: Architectural design for sending emails</p>
<p class="normal">The great thing about this design is that although you have a solution with different components, you cannot recognize some computational characteristics, like the amount of memory used, the number of CPUs designed for this process, or even the storage needed to guarantee the solution quality. This is what we call serverless in its essential meaning – a solution where<a id="_idIndexMarker1174"/> the focus is not on where<a id="_idIndexMarker1175"/> the code runs.</p>
<h1 class="heading-1" id="_idParaDest-338">Summary</h1>
<p class="normal">In this chapter, we looked at some of the advantages of developing functionality with serverless Azure Functions. You can use it as a guideline to check the different types of triggers that are available in Azure Functions and to plan how to monitor them. We also saw how to program and maintain Azure Functions.</p>
<p class="normal">In the next chapter, we will discuss the current news related to ASP.NET Core MVC.</p>
<h1 class="heading-1" id="_idParaDest-339">Questions</h1>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1">What are Azure Functions?</li>
<li class="numberedList">What are the programming options for Azure Functions?</li>
<li class="numberedList">What are the plans that can be used with Azure Functions?</li>
<li class="numberedList">How can you deploy Azure Functions with Visual Studio?</li>
<li class="numberedList">What triggers can you use to develop Azure Functions?</li>
<li class="numberedList">What is the difference between Azure Functions v1, v2, v3, and v4?</li>
<li class="numberedList">How does Application Insights help us to maintain and monitor Azure Functions?</li>
<li class="numberedList">What are Azure Durable Functions?</li>
</ol>
<h1 class="heading-1" id="_idParaDest-340">Further reading</h1>
<p class="normal">If you want to learn more about creating Azure functions, check out the following links:</p>
<ul>
<li class="bulletList">Azure Functions scale and hosting: <a href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-scale">https://docs.microsoft.com/en-us/azure/azure-functions/functions-scale</a></li>
<li class="bulletList"><em class="italic">Microsoft Azure For .NET Developers [Video], by Trevoir Williams: </em><a href="https://www.packtpub.com/product/microsoft-azure-for-net-developers-video/9781835465059">https://www.packtpub.com/product/microsoft-azure-for-net-developers-video/9781835465059</a></li>
<li class="bulletList"><em class="italic">Azure Serverless Computing Cookbook - Third Edition, by Praveen Kumar Sreeram: </em><a href="https://www.packtpub.com/product/azure-serverless-computing-cookbook-third-edition/9781800206601">https://www.packtpub.com/product/azure-serverless-computing-cookbook-third-edition/9781800206601</a></li>
<li class="bulletList">Azure Functions runtime overview: <a href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-versions">https://docs.microsoft.com/en-us/azure/azure-functions/functions-versions</a></li>
<li class="bulletList">An overview of Azure Event Grid: <a href="https://docs.microsoft.com/en-us/azure/event-grid/">https://docs.microsoft.com/en-us/azure/event-grid/</a></li>
<li class="bulletList">Timer trigger for Azure Functions: <a href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-bindings-timer ">https://docs.microsoft.com/en-us/azure/azure-functions/functions-bindings-timer</a></li>
<li class="bulletList">The <em class="italic">Application Insights</em> section of the book <em class="italic">Azure for Architects</em>, by Ritesh Modi: <a href="https://subscription.packtpub.com/book/virtualization_and_cloud/9781788397391/12/ch12lvl1sec95/application-insights ">https://subscription.packtpub.com/book/virtualization_and_cloud/9781788397391/12/ch12lvl1sec95/application-insights</a></li>
<li class="bulletList">The <em class="italic">Monitoring Azure Functions using the Application Insights</em> section of the book <em class="italic">Azure Serverless Computing Cookbook</em>, by Praveen Kumar Sreeram: <a href="https://subscription.packtpub.com/book/virtualization_and_cloud/9781788390828/6/06lvl1sec34/monitoring-azure-functions-using-application-insights">https://subscription.packtpub.com/book/virtualization_and_cloud/9781788390828/6/06lvl1sec34/monitoring-azure-functions-using-application-insights</a></li>
<li class="bulletList">Get started with Azure Queue storage using .NET: <a href="https://docs.microsoft.com/en-us/azure/storage/queues/storage-dotnet-how-to-use-queues">https://docs.microsoft.com/en-us/azure/storage/queues/storage-dotnet-how-to-use-queues</a></li>
<li class="bulletList">Azure Functions triggers and bindings concepts: <a href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-triggers-bindings">https://docs.microsoft.com/en-us/azure/azure-functions/functions-triggers-bindings</a></li>
<li class="bulletList">Azure Queue Storage bindings for Azure Functions: <a href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-bindings-storage-queue">https://docs.microsoft.com/en-us/azure/azure-functions/functions-bindings-storage-queue</a></li>
<li class="bulletList">Azure emulator for local Azure Storage Development: <a href="https://docs.microsoft.com/en-us/azure/storage/common/storage-use-azurite">https://docs.microsoft.com/en-us/azure/storage/common/storage-use-azurite</a></li>
<li class="bulletList">Azure Durable Functions: <a href="https://docs.microsoft.com/en-us/azure/azure-functions/durable/   ">https://docs.microsoft.com/en-us/azure/azure-functions/durable/</a></li>
</ul>
<p class="normal"><a href="https://docs.microsoft.com/en-us/azure/azure-functions/durable/   "/></p>
<p class="normal"><a href="https://docs.microsoft.com/en-us/azure/azure-functions/durable/   "/></p>
<h1 class="heading-1">Learn more on Discord</h1>
<p class="normal">To join the Discord community for this book – where you can share feedback, ask questions to the authors, and learn about new releases – follow the QR code below:</p>
<p class="normal"><a href="https://packt.link/SoftwareArchitectureCSharp12Dotnet8">https://packt.link/SoftwareArchitectureCSharp12Dotnet8</a></p>
<p class="normal"><img alt="" role="presentation" src="img/QR_Code175081751210902046.png"/></p>
</div>
</body></html>