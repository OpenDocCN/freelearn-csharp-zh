<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">Inventory UIs</h1>
                </header>
            
            <article>
                
<p>In this chapter, we will cover the following topics:</p>
<ul>
<li>Creating a simple 2-D mini-game - SpaceGirl</li>
<li>Displaying single object pickups with carrying and not-carrying text</li>
<li>Displaying single object pickups with carrying and not-carrying icons</li>
<li>Displaying multiple pickups of the same object with multiple status icons</li>
<li>Using panels to visually outline the inventory UI area and individual items</li>
<li>Creating a C# inventory slot display UI scripted component</li>
<li>Generalizing multiple icon displays using UI Grid Layout Groups (with scrollbars!)</li>
<li>Displaying multiple pickups of different objects as a list of text via a dynamic <kbd>List&lt;&gt;</kbd> of scripted PickUp objects</li>
<li>Displaying multiple pickups of different objects as text totals via a dynamic <kbd>Dictionary&lt;&gt;</kbd> of PickUp objects and enum pickup types</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Introduction</h1>
                </header>
            
            <article>
                
<p>Many games involve the player collecting items or choosing from a selection of items. Examples are collecting keys to open doors, collecting ammo for weapons, and choosing from a collection of spells to cast.</p>
<p>The recipes in this chapter provide a range of solutions for displaying to the player whether they are carrying an item or not, whether they are allowed more than one of an item, and how many they have.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">The big picture</h1>
                </header>
            
            <article>
                
<p>The two parts of software design for implementing inventories relate to, first, how we choose to represent the data about inventory items (that is, the data types and structures to store the data) and, second, how we choose to display information about inventory items to the player (the UI).</p>
<p>Also, whilst not strictly inventory items, player properties such as lives left, health, and time remaining can also be designed around the same concepts that we present in this chapter.</p>
<p>We need to first think about the nature of different inventory items for any particular game:</p>
<ul>
<li>Single items:
<ul>
<li>Examples: the only key for a level, our suit of magic armor</li>
<li>Data type: <kbd><span class="CodeInTextPACKT">bool</span></kbd> (Boolean – <kbd>true</kbd>/<kbd>false</kbd>)</li>
<li>UI: nothing (if not carried) or text/image to show being carried
<ul>
<li>Or perhaps, if we wish to highlight to the player that there is an <strong>option</strong> to carry this item, then we could display a text <kbd><span class="CodeInTextPACKT">string</span></kbd> saying <kbd>no key</kbd>/<kbd>key</kbd>, or two images, one showing an empty key outline and the second showing a full-color key.</li>
</ul>
</li>
</ul>
</li>
<li>Continuous item:
<ul>
<li>Examples: time left, health, shield strength</li>
<li>Data type: <kbd><span class="CodeInTextPACKT">float</span></kbd> (for example, 0.00-1.00) or <kbd><span class="CodeInTextPACKT">int</span></kbd> (Integer) scale<br/>
(for example, 0% to 100%)</li>
<li>UI: text number or image progress bar/pie chart</li>
</ul>
</li>
<li>Two or more of same item
<ul>
<li>Examples: lives left, or number of arrows or bullets left</li>
<li>Data type: <kbd><span class="CodeInTextPACKT">int</span></kbd> (Integer – whole numbers)</li>
<li>UI: text count or images</li>
</ul>
</li>
</ul>
<ul>
<li style="font-size: 1em">Collection of related items
<ul>
<li>Examples: keys of different colors to open correspondingly colored doors, potions of different strength with different titles</li>
<li>Data structure: a <kbd><span class="CodeInTextPACKT">struct</span></kbd> or <kbd><span class="CodeInTextPACKT">class</span></kbd> for the general item type (for example, class <kbd><span class="CodeInTextPACKT">Key</span></kbd> (color/cost/doorOpenTagString), stored as an array or <kbd>List&lt;&gt;</kbd></li>
<li>UI: text list or list/grid arrangement of icons</li>
</ul>
</li>
<li>Collection of different items
<ul>
<li>Examples: keys, potions, weapons, tools, all in the same inventory system</li>
<li>Data structure: <kbd>List&lt;&gt;</kbd> or <kbd>Dictionary&lt;&gt;</kbd> or array of objects, which can be instances of different class for each item type</li>
</ul>
</li>
</ul>
<p>Each of the preceding representations and UI display methods are illustrated by the recipes in <span>this chapter. In addition, in the</span> chapter <span>we'll learn how to create and use custom</span> <span class="KeyWordPACKT"><span class="packt_screen">Sorting Layers</span> in order</span> <span>to have complete control over which objects appear on top of or below other objects – something that is pretty important when scene content can contain background images, pickups, player characters, and so on.</span></p>
<p>These recipes demonstrate a range of C# data representations for inventory items and a range of Unity UI interface components for displaying the status and contents of player inventories at runtime. Inventory UI needs good quality graphical assets for a high-quality result. Some sources of assets that you might wish to explore include the following sites:</p>
<ul>
<li>The graphics for our SpaceGirl mini-game are from Space Cute art by Daniel Cook; he generously publishes lots of 2D art for game developers to use:
<ul>
<li><span class="URLPACKT"><span><a href="http://www.lostgarden.com/">http://www.lostgarden.com/</a></span></span></li>
<li><span class="URLPACKT"><span><a href="http://www.lostgarden.com/search?q=planet+cute">http://www.lostgarden.com/search?q=planet+cute</a></span></span></li>
</ul>
</li>
<li>Sethbyrd-lots of fun 2D graphics:
<ul>
<li><span class="URLPACKT"><span><a href="http://www.sethbyrd.com/">http://www.sethbyrd.com/</a></span></span></li>
</ul>
</li>
<li>Royalty-free art for 2D games:
<ul>
<li><span class="URLPACKT"><span><a href="http://www.gameart2d.com/freebies.html">http://www.gameart2d.com/freebies.html</a></span></span></li>
</ul>
</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Creating a simple 2D mini-game – SpaceGirl</h1>
                </header>
            
            <article>
                
<p class="mce-root"><span>This recipe shows how to create the 2D Space Girl mini-game, on which all the recipes</span> of <span>this chapter are based.</span></p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/0fb94072-acb7-423d-871d-da25d88ec6f4.png" style="width:24.17em;height:6.67em;"/></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p style="color: black">For this recipe, we have prepared the images you need in a folder named <span class="CodeInTextPACKT">Sprites</span> in the <kbd><span class="CodeInTextPACKT">03_01</span></kbd> folder. We have also provided the completed game as a Unity package in this folder, named <kbd><span class="CodeInTextPACKT">Simple2DGame_SpaceGirl</span></kbd>.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<p>To create the simple 2D <span>Space Girl </span>mini-game<span class="ItalicsPACKT">,</span> follow these steps:</p>
<ol>
<li>Create a new, empty 2D project.</li>
<li>Import the supplied folder <kbd><span class="CodeInTextPACKT">Sprites</span></kbd> into your project.</li>
<li>Since it's a 2D project, each sprite image should be of type <strong><span class="KeyWordPACKT">Sprite (2D and UI)</span></strong>. Check this by selecting the sprite in the <span class="KeyWordPACKT"><span class="packt_screen">Project</span></span> panel, then, in the <strong>Inspector</strong>, check property <strong>Texture</strong> <span class="KeyWordPACKT">Type</span>. If you need to change the type, change it from this drop-down menu, then click the <strong>Apply</strong> button.</li>
<li>Set the Unity Player screen size to <kbd><span class="ScreenTextPACKT">800 x 600</span></kbd>: choose this resolution from the drop-down menu on the <span class="KeyWordPACKT">Game</span> panel. If <kbd><span class="ScreenTextPACKT">800 x 600</span></kbd> isn't an offered resolution, the click the plus sign <strong>+</strong> button and create this as a new resolution for the panel.</li>
<li>Display the <strong>Tags</strong> <span class="KeyWordPACKT">and</span> <strong>Layers</strong> properties for the current Unity project. Choose menu <span class="KeyWordPACKT"><span class="packt_screen">Edit</span> | <span class="packt_screen">Project Settings</span> | <span class="packt_screen">Tags and Layers</span></span>. Alternatively, if you are already editing a GameObject, then you can select the <strong>Add Layer...</strong> menu from the <span class="KeyWordPACKT">Layer</span> drop-down menu at the top of the <span class="KeyWordPACKT">Inspector</span> panel, next to the <span class="KeyWordPACKT">Static</span> <kbd>true</kbd>/<kbd>false</kbd> toggle.</li>
</ol>
<ol start="6">
<li>Use the expand/contract triangle tools to contract <strong>Tags and Layers</strong>, and to expand <strong>Sorting Layers</strong>. Use the plus sign <span class="ScreenTextPACKT"><span class="packt_screen">+</span></span> button to add two new sorting layers, as shown in the screenshot: first, add one named <kbd><span class="KeyWordPACKT">Background</span></kbd>, and next, add one named <kbd><span class="KeyWordPACKT">Foreground</span></kbd>. The sequence is important since Unity will draw items in layers<br/>
further down this list on top of items earlier in the list. You can rearrange the layer sequence by clicking and dragging the <span class="KeyWordPACKT">position control: </span>the wide equals sign (<span class="ScreenTextPACKT"><span class="packt_screen">=</span></span>) icon to the left of the word <span class="KeyWordPACKT">Layer</span> in each row:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/163362cf-7579-4d18-aaeb-1ee90007781f.png"/></div>
<ol start="7">
<li>Drag the <kbd><span class="CodeInTextPACKT">background_blue</span></kbd> <span>sprite </span>from the <span class="ScreenTextPACKT">Project</span> panel (in the <kbd>Sprites</kbd> folder) into either the <strong><span class="ScreenTextPACKT">Game</span></strong> or <strong><span class="ScreenTextPACKT">Hierarchy</span></strong> panel to create a GameObject for the current scene. Set the <kbd><span class="KeyWordPACKT">Position</span></kbd> of this GameObject to (<kbd>0</kbd>,<kbd>0</kbd>,<kbd>0</kbd>). It should completely cover the Game panel (at resolution <kbd><span class="ScreenTextPACKT">800 x 600</span></kbd>).</li>
<li>Set the <strong>Sorting Layer</strong> of GameObject <span class="CodeInTextPACKT">background-blue</span> to <strong><span class="ScreenTextPACKT">Background</span></strong> (in the <strong><span class="ScreenTextPACKT">Sprite Renderer</span></strong> component):</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/b621c9a4-4585-4ce1-91e8-606e55b7fcb5.png"/></div>
<ol start="9">
<li>Drag sprite <span class="CodeInTextPACKT">star</span> from the <strong><span class="ScreenTextPACKT">Project</span></strong> panel (in the <kbd>Sprites</kbd> folder) into either the <strong><span class="ScreenTextPACKT">Game</span></strong> or <strong><span class="ScreenTextPACKT">Hierarchy</span></strong> panel to create a GameObject for the current scene:
<ul>
<li>Create a new tag, <span class="packt_screen">Star</span>, and assign this tag to GameObject <span class="KeyWordPACKT">star</span> (tags are created in the same way we created sorting layers).</li>
<li>Set the <span class="ScreenTextPACKT"><span class="packt_screen">Sorting Layer</span></span> of GameObject <span class="CodeInTextPACKT">star</span> to <span class="ScreenTextPACKT">Foreground</span> (in the <span class="ScreenTextPACKT">Sprite Renderer</span> component).</li>
<li>Add to GameObject <span class="CodeInTextPACKT">star</span> a <span class="packt_screen">Box Collider 2D</span> (<span class="ScreenTextPACKT"><span class="packt_screen">Add</span> <span class="packt_screen">Component</span></span> | <span class="ScreenTextPACKT"><span class="packt_screen">Physics 2D</span></span> | <span class="ScreenTextPACKT"><span class="packt_screen">Box Collider 2D</span></span>) and check <span class="CodeInTextPACKT"><span class="packt_screen">Is Trigger</span></span>, as shown in the screenshot:</li>
</ul>
</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/ee263562-8258-4402-b467-879532053a6a.png"/></div>
<ol start="10">
<li>Drag the <span class="CodeInTextPACKT">girl1</span> <span>sprite </span>from the <strong><span class="KeyWordPACKT">Project</span></strong> panel (in the <kbd>Sprites</kbd> folder) into either the <strong><span class="KeyWordPACKT">Game</span></strong> or <strong><span class="KeyWordPACKT">Hierarchy</span></strong> panel to create a GameObject for the player's character in the current scene. Rename this GameObject <kbd><span class="CodeInTextPACKT">player-girl1</span></kbd>.</li>
<li>Set the <span class="KeyWordPACKT">Sorting Layer</span> of GameObject <kbd><span class="CodeInTextPACKT">player-girl1</span></kbd> to <span class="KeyWordPACKT">Foreground</span>.</li>
<li>Add a <span class="KeyWordPACKT"><span class="packt_screen">Physics</span> |</span> <span class="KeyWordPACKT"><span class="packt_screen">Box Collider 2D</span></span> component <span>to GameObject </span><kbd><span class="CodeInTextPACKT">player-girl1</span></kbd><span> </span>.</li>
<li>Add <span>a </span><span class="ScreenTextPACKT"><span class="packt_screen">Physics 2D</span></span><span> | </span><span class="ScreenTextPACKT"><span class="packt_screen">Rigid Body 2D</span></span><span> component </span>to GameObject <kbd><span class="CodeInTextPACKT">player-girl1</span></kbd> . Set its <span class="KeyWordPACKT">Gravity Scale</span> to zero (so it isn't falling down the screen due to simulated gravity), as shown in the screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/464d268b-9a25-45cf-9ba0-4742586b04d3.png" style="width:19.83em;height:16.67em;"/></div>
<ol start="14">
<li>Create a new folder for your scripts named <kbd>_<span class="CodeInTextPACKT">Scripts</span></kbd>.</li>
<li>Create the following C# Script <span class="CodeInTextPACKT">PlayerMove</span> (in the <kbd>_Scripts</kbd> folder) and add an instance as a component to GameObject <span class="packt_screen">player-girl1</span> in the <strong><span class="ScreenTextPACKT">Hierarchy</span></strong>:</li>
</ol>
<pre style="color: black;padding-left: 60px">using UnityEngine; 
using System.Collections; 

public class PlayerMove : MonoBehaviour { 
  public float speed = 10; 
  private Rigidbody2D rigidBody2D;<br/>  private Vector2 newVelocity;<br/><br/>void Awake(){ <br/>rigidBody2D = GetComponent&lt;Rigidbody2D&gt;(); <br/>} <br/><br/>void Update() {<br/>  float xMove = Input.GetAxis("Horizontal");<br/>  float yMove = Input.GetAxis("Vertical");<br/><br/>  float xSpeed = xMove * speed;<br/>  float ySpeed = yMove * speed;<br/><br/>  newVelocity = new Vector2(xSpeed, ySpeed);<br/>}<br/><br/>void FixedUpdate() {<br/>  rigidBody2D.velocity = newVelocity;<br/>}<br/><br/>}</pre>
<ol start="16">
<li>Save the scene (name it <span class="ScreenTextPACKT">Main Scene</span> and save it into a new folder named <span class="CodeInTextPACKT">_Scenes</span>).</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p style="color: black">You have created a player character in the scene using the <span class="CodeInTextPACKT">girl1 <span>sprite</span></span>, and added a scripted component instance of class <kbd><span class="CodeInTextPACKT">PlayerMove</span></kbd>. You have also created a star GameObject (a pickup), tagged <span class="CodeInTextPACKT">Star</span> and with a 2D box collider that will trigger a collision when the player's character hits it. When you run the game, the <kbd><span class="CodeInTextPACKT">player-girl1</span></kbd> character should move around using <kbd><span class="CodeInTextPACKT">W A S D</span></kbd>, the arrow keys, or joystick. There is a <kbd>newVelocity</kbd> <span>variable,</span> which is updated each frame in the <kbd>Update()</kbd> <span>method </span>based on the inputs. This <kbd>Vector2</kbd> value is then applied in the <kbd>FixedUpdate()</kbd> <span>method </span>to become the new velocity for the GameObject. </p>
<p style="color: black">Unity maps user inputs such as key presses, arrow keys, and game controller controls to its <kbd><span class="CodeInTextPACKT">Input</span></kbd> class. Two special properties of the <span class="CodeInTextPACKT">Input</span> class are the Horizontal and Vertical axes – accessed via the <kbd><span class="CodeInTextPACKT">Input.GetAxis</span></kbd><span class="CodeInTextPACKT">("<kbd>Horizontal</kbd>")</span> and <kbd><span class="CodeInTextPACKT">Input.GetAxis</span></kbd><span class="CodeInTextPACKT">("<kbd>Vertical</kbd>")</span> methods.</p>
<div class="packt_tip"><strong>Managing your input mapping:</strong> You can manage the mapping from different user input methods (keys, mouse, controllers, and so on) to the axes through menu: <span class="KeyWordPACKT"><strong>Edit</strong> | <strong>Project Settings</strong> | <strong>Input</strong></span></div>
<p style="color: black">Currently, nothing will happen if the <kbd><span class="CodeInTextPACKT">player-SpaceGirl</span></kbd> character hits a star because that has yet to be scripted.</p>
<p style="color: black">You have added a background (GameObject <span class="CodeInTextPACKT">background-blue</span>) to the scene, which will be behind everything since it is in the rearmost sorting layer, <strong><span class="ScreenTextPACKT">Background</span></strong>. Items you want to appear in front of the background (the player character and the star, so far) are placed on the <span><strong>Foreground</strong> </span>sorting layer.</p>
<div class="packt_infobox">We can learn more about Unity tags and layers at <a href="http://docs.unity3d.com/Manual/class-TagManager.html"><span class="URLPACKT">http://docs.unity3d.com/Manual/class-TagManager.html</span></a><span class="URLPACKT">.</span></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Displaying single object pickups with carrying and not-carrying text</h1>
                </header>
            
            <article>
                
<p style="color: black">Often the simplest inventory situation is to display text to tell players whether they are carrying a single item (or not). We'll add the ability <span>to detect collisions with GameObject tagged </span><strong><span class="ScreenTextPACKT">Star</span></strong> to the SpaceGirl mini-game, and display an on-screen message stating whether a star has been collected or not:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/47cd6ba6-5511-4d54-bcc3-8b980049f26c.png" style="width:28.42em;height:5.08em;"/></div>
<p style="color: black">At the end of the recipe, in the <em>There's more...</em> section, we'll learn to adapt this recipe to maintain an <strong><span class="KeyWordPACKT">Integer</span></strong> total of how many stars have been collected, for a version of the game with lots of stars to collect.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p style="color: black">For this recipe, we have prepared a folder named <span class="CodeInTextPACKT">Fonts</span> in the <kbd><span class="CodeInTextPACKT">03_02</span></kbd> folder.</p>
<p style="color: black">This recipe assumes that you are starting with the <kbd><span class="CodeInTextPACKT">Simple2Dgame_SpaceGirl</span></kbd> <span>project that was </span>set up from the first recipe in this chapter. So, make a copy of that project, and work on this copy.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<p style="color: black">To display text to inform the user about the status of carrying a single object pickup, follow these steps:</p>
<ol>
<li>Start with a new copy of the <span class="CodeInTextPACKT"><kbd>Simple2Dgame_SpaceGirl</kbd> <span>mini-game</span></span>.</li>
<li>Add a <span class="KeyWordPACKT">UI Text</span> object (<span class="KeyWordPACKT"><strong>Create</strong> | <strong>UI</strong> | <strong>Text</strong></span>). Rename it <span class="CodeInTextPACKT">Text-carrying-star</span>. Change its text to <span class="CodeInTextPACKT">Carrying star: false</span>.</li>
<li>Import the provided <span class="CodeInTextPACKT">Fonts</span> folder into your project.</li>
</ol>
<ol start="4">
<li>In the <strong><span class="ScreenTextPACKT">Inspector</span></strong> panel, set the font of <span class="CodeInTextPACKT">Text-carrying-star</span> to <span class="ScreenTextPACKT"><strong>Xolonium-Bold</strong></span>, and set its color to yellow. Center the text horizontally and vertically, set its <strong><span class="ScreenTextPACKT">Height</span></strong> to <kbd><span class="CodeInTextPACKT">50</span></kbd>, and set the <strong><span class="ScreenTextPACKT">Font Size</span></strong> to <kbd><span class="CodeInTextPACKT">32</span></kbd>.</li>
</ol>
<ol start="5">
<li>Edit its <span class="ScreenTextPACKT">Rect Transform</span>, and while holding down <em><span class="KeyPACKT">Shift</span></em> + <em><span class="KeyPACKT">Alt</span></em> (to set pivot and position), choose the <span class="KeyWordPACKT">top-stretch</span> box:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/93d7b082-58ea-4ac2-b06c-417d0d24aec4.png"/></div>
<ol start="6">
<li>Your text should now be positioned at the middle top of the <strong><span class="KeyWordPACKT">Game</span></strong> panel, and its width should stretch to match that of the whole panel, as shown in the screenshot in the introduction to this recipe.</li>
<li>Create the following C# script class <kbd><span class="CodeInTextPACKT">PlayerInventory</span></kbd> in the <span class="CodeInTextPACKT"><kbd>_Scripts</kbd> <span>folder</span>:<br/></span></li>
</ol>
<pre style="color: black;padding-left: 60px">using UnityEngine; 

public class PlayerInventory : MonoBehaviour { 
   private PlayerInventoryDisplay playerInventoryDisplay; 
   private bool carryingStar = false;  

   void Awake() { 
         playerInventoryDisplay = GetComponent&lt;PlayerInventoryDisplay&gt;(); 
   } 

   void Start() { 
         playerInventoryDisplay.OnChangeCarryingStar( carryingStar); 
   }  

   void OnTriggerEnter2D(Collider2D hit) { 
         if (hit.CompareTag("Star")) { 
               carryingStar = true; 
               playerInventoryDisplay.OnChangeCarryingStar( carryingStar); 
               Destroy(hit.gameObject); 
         } 
   } 
} </pre>
<ol start="8">
<li>Create the following C# script class <kbd><span class="CodeInTextPACKT">PlayerInventoryDisplay</span></kbd> in the <span class="CodeInTextPACKT"><kbd>_Scripts</kbd> <span>folder:</span></span></li>
</ol>
<pre style="color: black;padding-left: 60px">using UnityEngine; 
using UnityEngine.UI;

[RequireComponent(typeof(PlayerInventory))] 
public class PlayerInventoryDisplay : MonoBehaviour  { 
   public Text starText; 
   public void OnChangeCarryingStar(bool carryingStar) { 
         string starMessage = "no star :-("; 
         if(carryingStar) 
               starMessage = "Carrying star :-)"; 
         starText.text = starMessage; 
   } 
} </pre>
<ol start="9">
<li>Add an instance of script-class <kbd><span class="CodeInTextPACKT">PlayerInventoryDisplay</span></kbd> to the <span class="CodeInTextPACKT"><span class="packt_screen">player-SpaceGirl</span></span> <span>GameObject </span>in the <strong><span class="KeyWordPACKT">Hierarchy</span></strong>.</li>
</ol>
<div class="packt_infobox">Note, since the <kbd><span class="CodeInTextPACKT">PlayerInventoryDisplay</span></kbd> <span>class </span>contains <kbd><span class="CodeInTextPACKT">RequireComponent(),</span></kbd> then an instance of script class <kbd><span class="CodeInTextPACKT">PlayerInventory</span></kbd> will be automatically added to GameObject <kbd><span class="CodeInTextPACKT">player-SpaceGirl</span>.</kbd></div>
<ol start="10">
<li>From the <strong><span class="KeyWordPACKT">Hierarchy</span></strong> view, select the <span class="CodeInTextPACKT"><kbd>player-SpaceGirl</kbd> <span>GameObject</span></span>. Then, from the <strong><span class="KeyWordPACKT">Inspector</span></strong>, access the <span class="KeyWordPACKT"><span class="packt_screen">Player Inventory Display</span> <span class="packt_screen">(Script)</span></span> component and populate the <strong><span class="KeyWordPACKT">Star Text</span></strong> public field with GameObject <span class="CodeInTextPACKT"><span class="packt_screen">Text-carrying-star</span></span>, as shown in the screenshot.</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/4cc4e685-d15a-4492-a65b-abf72bd68271.png" style="width:37.83em;height:18.75em;"/></div>
<ol start="11">
<li>When you play the scene, after moving the character into the star, the star should disappear, and the onscreen <strong><span class="KeyWordPACKT">UI Text</span></strong> message should change to <span class="ScreenTextPACKT"><span class="packt_screen">Carrying star :-)</span></span>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/8914a461-ea47-40b9-a487-b01e209ea333.png" style="width:31.92em;height:6.92em;"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p style="color: black">You created a <strong><span class="KeyWordPACKT">UI Text</span></strong> GameObject <span class="CodeInTextPACKT">Text-carrying-star</span> to display to the player a text message stating whether or not a star is being carried. You created two script classes, and an instance of each was added as a component to the player's <kbd><span class="CodeInTextPACKT">player-SpaceGirl</span></kbd> character GameObject:</p>
<ul>
<li>Script-class <kbd><span class="CodeInTextPACKT">PlayerInventory</span></kbd> detects player-star collisions, updates internal variables saying whether a star is carried, and asks for the UI display to be updated each time a collision is detected.</li>
</ul>
<ul>
<li>Script-class <kbd><span class="CodeInTextPACKT">PlayerInventoryDisplay</span></kbd> handles the communication to the user by updating the text message displayed by the <span class="CodeInTextPACKT"><span class="packt_screen">Text-carrying-star</span></span> <span class="KeyWordPACKT">UI Text</span> GameObject.</li>
</ul>
<p style="color: black">A game design pattern (best practice approach) called the <strong><span class="KeyWordPACKT">Model-View-Controller</span> pattern</strong> (<strong><span class="KeyWordPACKT">MVC</span></strong>) separates the code that updates the UI from the code that changes player and game variables such as score and inventory item lists. Although this recipe has only one variable and one method for updating the UI, well-structured game architectures scale up to cope with more complex games, so it is often worth the effort of a little more code and an extra script class, even at this game-beginning stage, if we want our final game architecture to be well structured and maintainable.</p>
<p style="color: black">One additional advantage of this design pattern is that the method in which the information is communicated to the user via the UI can be changed (for example, from text to an icon – see the next recipe!), without any change to the code in script class <kbd><span class="CodeInTextPACKT">PlayerInventory</span></kbd>.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">The PlayerInventory script class</h1>
                </header>
            
            <article>
                
<p style="color: black">The <kbd><span class="CodeInTextPACKT">playerInventoryDisplay</span></kbd> variable is a reference to an instance object of class <kbd><span class="CodeInTextPACKT">PlayerInventoryDisplay</span></kbd>.</p>
<p style="color: black">The <span class="CodeInTextPACKT">bool</span> variable <span class="CodeInTextPACKT">carryingStar</span> represents whether or not the player is carrying the star at any point in time; it is initialized to <span class="ScreenTextPACKT"><span class="packt_screen">false</span></span>.</p>
<p style="color: black"><kbd>Method <span class="CodeInTextPACKT">Awake()</span></kbd> caches a reference to the sibling component <kbd><span class="CodeInTextPACKT">playerInventoryDisplay</span></kbd>.</p>
<p style="color: black">When the scene begins, via the <span class="CodeInTextPACKT"><kbd>Start()</kbd> </span>method, we call the <span class="CodeInTextPACKT"><kbd>OnChangeCarryingStar(...)</kbd> </span>method of script component <kbd><span class="CodeInTextPACKT">playerInventoryDisplay</span></kbd>, passing in the initial value of <kbd><span class="CodeInTextPACKT">carryingStar</span></kbd> (which is false). This ensures that we are not relying on text typed into the <strong><span class="KeyWordPACKT">UI Text</span></strong> object <span class="CodeInTextPACKT">Text-carrying-star</span> at <strong>D<span class="KeyWordPACKT">esign-Time</span></strong>, so that the UI seen by the user is always set by our <strong>R<span class="KeyWordPACKT">un-Time</span></strong> methods. This avoids problems where the words to be displayed to the user are changed in code and not in the <strong><span class="KeyWordPACKT">Inspector</span></strong> panel – which leads to a mismatch between the onscreen text when the scene first runs and after it has been updated from a script.</p>
<div class="packt_infobox">A golden rule in Unity game design is to avoid duplicating content in more than one place, and, therefore, we avoid having to maintain two or more copies of the same content. Each duplicate is an opportunity for maintenance issues when some, but not all, copies of a value are changed.<br/>
Maximizing use of prefabs is another example of this principle in action. This is also know as the DRY principal – don't repeat yourself.</div>
<p style="color: black">Each time the player's character collides with any object that has its <span class="KeyWordPACKT">Is <strong>Trigger</strong></span> set to <span class="CodeInTextPACKT">true</span>, an <kbd><span class="CodeInTextPACKT">OnTriggerEnter2D()</span></kbd> event message is sent to both objects involved in the collision. The <kbd><span class="CodeInTextPACKT">OnTriggerEnter2D()</span></kbd> message is passed as a parameter that is a reference to the <kbd><span class="CodeInTextPACKT">Collider2D</span></kbd> component inside the object just collided with.</p>
<p style="color: black">Our player's <kbd><span class="CodeInTextPACKT">OnTriggerEnter2D()</span></kbd> method tests the <span class="CodeInTextPACKT">tag</span> string of the object collided with to see whether it has the <span class="KeyWordPACKT"><strong>Star</strong> <span>value</span></span>. Since the GameObject <span class="KeyWordPACKT">star</span> we created has its trigger set, and has the tag <strong><span class="KeyWordPACKT">Star</span></strong>, the <span class="CodeInTextPACKT">if</span> statement inside this method will detect a collision with the <span class="KeyWordPACKT">star</span> and complete the following three actions:</p>
<ul>
<li>The Boolean (flag) variable <kbd><span class="CodeInTextPACKT">carryingStar</span></kbd> is set to <span class="CodeInTextPACKT">true</span></li>
<li>The method <span class="CodeInTextPACKT"><strong>OnChangeCarryingStar(...)</strong> </span>of script component <strong><span class="CodeInTextPACKT">playerInventoryDisplay</span></strong> is called, passing in the updated value of <strong><span class="CodeInTextPACKT">carryingStar</span></strong></li>
<li>The GameObject just collided with is destroyed – that is, the <span class="KeyWordPACKT">star</span></li>
</ul>
<div class="packt_infobox"><br/>
Boolean variables are often referred to as flags.<br/>
The use of a bool (true/false) variable to represent whether some feature of the game state is true or false is very common. Programmers often refer to these variables as flags. So, programmers might refer to the carryingStar variable as the star-carrying flag.</div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">The PlayerInventoryDisplay script class</h1>
                </header>
            
            <article>
                
<p style="color: black">The public <kbd><span class="CodeInTextPACKT">Text</span></kbd> variable <kbd><span class="CodeInTextPACKT">starText</span></kbd> is a reference to the <strong><span class="KeyWordPACKT">UI Text</span></strong> object <span class="CodeInTextPACKT">Text-carrying-star</span>. Its value has been set via drag-and-drop at <span class="KeyWordPACKT">design time</span>.</p>
<p style="color: black">The <kbd><span class="CodeInTextPACKT">OnChangeCarryingStar</span></kbd><span class="CodeInTextPACKT">(carryingStar) </span>method updates the text property of <span class="CodeInTextPACKT">starText</span> with the value of string variable <kbd><span class="CodeInTextPACKT">starMessage</span></kbd>. This method takes an input bool argument <kbd><span class="CodeInTextPACKT">carryingStar</span></kbd>. The default value of string <kbd><span class="CodeInTextPACKT">starMessage</span></kbd> tells the user that the player is not carrying the star, but an <span class="CodeInTextPACKT">if </span>statement tests the value of <kbd><span class="CodeInTextPACKT">carryingStar</span></kbd>, and, if that is true, then the message is changed to inform the player that they are carrying the star.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">There's more...</h1>
                </header>
            
            <article>
                
<p style="color: black">Here are some details you won't want to miss.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Collecting multiple items and display total number carried</h1>
                </header>
            
            <article>
                
<p style="color: black">Often there are pickups that the player can collect more than one of. In such situations, we can use an Integer to represent the total number collected, and use a UI Text object to display this total to the user. Let's modify the recipe to allow SpaceGirl to collect lots of stars!</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/8897c7a4-4a47-4947-ba46-a95155071af0.png"/></div>
<p style="color: black">To convert this recipe to one that shows the total number of stars collected, do the following:</p>
<ol>
<li>Make three or four more copies of the <strong><span class="KeyWordPACKT">star</span></strong> GameObject and spread them around the scene. This gives the player several stars to collect rather than just one.</li>
</ol>
<div class="packt_tip">Use keyboard shortcut <em><span class="CodeInTextPACKT">Ctrl</span></em> + <em><span class="CodeInTextPACKT">D</span></em> (Windows) or <em><span class="CodeInTextPACKT">CMD</span></em> + <em><span class="CodeInTextPACKT">D</span></em> (Mac) to quickly duplicate GameObjects.</div>
<ol start="2">
<li>Change the contents of the C# script class <kbd><span class="CodeInTextPACKT">PlayerInventory</span></kbd> to contain the following:</li>
</ol>
<pre style="color: black;padding-left: 60px">using UnityEngine; 
public class PlayerInventory : MonoBehaviour { 
   private PlayerInventoryDisplay playerInventoryDisplay; 
   private int totalStars = 0; 

   void Awake() { 
         playerInventoryDisplay = GetComponent&lt;PlayerInventoryDisplay&gt;(); 
   }  

   void Start() { 
        playerInventoryDisplay.OnChangeStarTotal(totalStars); 
   } 

   void OnTriggerEnter2D(Collider2D hit) { 
         if (hit.CompareTag("Star")) { 
            totalStars++; 
            playerInventoryDisplay.OnChangeCarryingStar(totalStars); 
            Destroy(hit.gameObject); 
         } 
   } 
} </pre>
<ol start="3">
<li>Change the contents of C# script class <kbd><span class="CodeInTextPACKT">PlayerInventoryDisplay</span></kbd> to contain the following:</li>
</ol>
<pre style="color: black;padding-left: 60px">using UnityEngine; 
using UnityEngine.UI; 

[RequireComponent(typeof(PlayerInventoryTotal))] 
public class PlayerInventoryDisplay : MonoBehaviour { 
   public Text starText; 
   public void OnChangeStarTotal(int numStars) { 
         string starMessage = "total stars = " + numStars; 
         starText.text = starMessage; 
   } 
}</pre>
<p style="color: black">As you can see, in <kbd><span class="CodeInTextPACKT">PlayerInventory</span></kbd> we now increment <span class="CodeInTextPACKT">totalStars</span> by 1 each time a star <span class="CodeInTextPACKT">GameObject</span> is collided with. In <kbd><span class="CodeInTextPACKT">PlayerInventoryDisplay</span></kbd> we display on screen a simple text message of <span class="CodeInTextPACKT">"total stars = "</span> followed by the integer total received by the method <kbd><span class="CodeInTextPACKT">OnChangeStarTotal(...)</span>./</kbd></p>
<p style="color: black">Now when you run the game you should see the total stars start at zero, and increase by 1 each time the player's character hits a star.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Alternative – combining all the responsibilities into a single script</h1>
                </header>
            
            <article>
                
<p style="color: black">The separation of the player inventory (what they are carrying) and how to display the inventory to the user is an example of a game design pattern (best practice approach) called the <strong><span class="KeyWordPACKT">Model-View-Controller</span></strong> (<strong><span class="KeyWordPACKT">MVC</span></strong>) whereby we separate the code that updates the UI from the code that changes player and game variables such as score and inventory item lists. Although this recipe has only one variable and one method to update the UI, well-structured game architectures scale up to cope with more complex games, so it is often worth the effort of a little more code and an extra script class, even at this game's development, if we want our final game architecture to be well structured and maintainable.</p>
<p style="color: black">However, for <em>very simple games</em> we may choose to combine both status and display of that status in a single script class. For an example of this approach for this recipe, remove script components <kbd><span class="CodeInTextPACKT">PlayerInventory</span></kbd> and <kbd><span class="CodeInTextPACKT">PlayerInventoryDisplay</span></kbd> and create the following C# script class <kbd><span class="CodeInTextPACKT">PlayerInventoryCombined</span></kbd> and add an instance to GameObject <kbd><span class="CodeInTextPACKT">player-SpaceGirl</span></kbd> in the <strong><span class="KeyWordPACKT">Hierarchy</span></strong>:</p>
<pre style="color: black">using UnityEngine.UI; 
public class PlayerInventoryCombined : MonoBehaviour { 
   public Text starText; 
   private bool carryingStar = false; 

   void Start() { 
         UpdateStarText(); 
   } 

   void OnTriggerEnter2D(Collider2D hit) { 
         if (hit.CompareTag("Star")){ 
               carryingStar = true; 
               UpdateStarText(); 
               Destroy(hit.gameObject); 
         } 
   } 

   private void UpdateStarText() { 
         string starMessage = "no star :-("; 
         if (carryingStar) 
            starMessage = "Carrying star :-)"; 
         starText.text = starMessage; 
   } 
} </pre>
<div class="packt_infobox">There is no difference in the experience of the player, and the change is simply in the architectural structure of our game code.</div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Displaying single object pickups with carrying and not-carrying icons</h1>
                </header>
            
            <article>
                
<p style="color: black">Graphic icons are an effective way to inform the player that they are carrying an item. In this recipe, if no star is being carried, a gray-filled icon in a blocked-off circle is displayed <span>in the top-left of the screen:</span></p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/8325bea3-24c1-47ee-bf4c-acff231a4674.png"/></div>
<p style="color: black">Then, after a star has been picked up, a yellow-filled star icon is displayed. In many cases, icons are clearer (they don't require reading and thinking about) and can also be smaller onscreen than text messages that indicate player status and inventory items.</p>
<p style="color: black">This recipe also illustrates the benefits of the MVC design pattern described in the previous recipe – we are changing how to communicate to the user (using the <strong><span class="KeyWordPACKT">View</span></strong> via icons rather than text), but we can use, with no changes required, script class <span class="CodeInTextPACKT">PlayerInventory</span> (the <strong><span class="KeyWordPACKT">Model-Controller</span></strong>), which detects player-star collisions and maintains the Boolean flag that tells us whether a star is being carried or not.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p style="color: black">This recipe assumes that you are starting with the <span class="CodeInTextPACKT">Simple2Dgame_SpaceGirl</span> <span>project </span>set up in the first recipe in this chapter.</p>
<p style="color: black">For this recipe, we have prepared a folder named <kbd><span class="CodeInTextPACKT">_Scripts</span></kbd> in the <kbd><span class="CodeInTextPACKT">03_03</span></kbd> folder.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<p style="color: black">To toggle carrying and not-carrying icons for a single object pickup, follow these steps:</p>
<ol>
<li>Start with a new copy of the <span class="CodeInTextPACKT"><kbd>Simple2Dgame_SpaceGirl</kbd> <span>mini-game</span></span>.</li>
<li>Import the <kbd><span class="CodeInTextPACKT">_Scripts</span></kbd> <span>folder </span>from the provided files (this contains a copy of the script class <kbd><span class="CodeInTextPACKT">PlayerInventory</span></kbd> from the previous recipe, which we can use unchanged for this recipe).</li>
<li>Add to the scene a <strong><span class="KeyWordPACKT">UI Image</span></strong> object (<span class="KeyWordPACKT"><strong>Create</strong> | <strong>UI</strong> | <strong>Image</strong></span>). Rename it <kbd><span class="CodeInTextPACKT">Image-star-icon</span></kbd>.
<ul>
<li>With <span class="CodeInTextPACKT">Image-star-icon</span> selected in the <strong><span class="KeyWordPACKT">Hierarchy</span></strong>, drag the <kbd><span class="ScreenTextPACKT">icon_nostar_100</span></kbd> <span>sprite </span>(in the <kbd>Sprites</kbd> folder) from the <strong><span class="KeyWordPACKT">Project</span></strong> panel into the <strong><span class="KeyWordPACKT">Source Image</span></strong> field in the <strong><span class="KeyWordPACKT">Inspector</span></strong> (in the <span class="KeyWordPACKT">Image (Script)</span> component).</li>
</ul>
</li>
<li>Click on the <span class="KeyWordPACKT"><strong>Set Native Size</strong></span> button for the <strong><span class="KeyWordPACKT">Image</span></strong> component. This will resize the <strong><span class="ScreenTextPACKT">UI Image</span></strong> to fit the physical pixel width and height of the <span class="ScreenTextPACKT"><kbd>icon_nostar_100</kbd> <span>sprite file</span>:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/eb577c82-34fe-48a1-8ca4-bb647df529bb.png" style="width:38.25em;height:18.25em;"/></div>
<ol start="5">
<li>Position the image icon at the <span class="KeyWordPACKT">top</span> and <span class="KeyWordPACKT">left</span> of the <span class="ScreenTextPACKT">Game</span> panel, in <span class="KeyWordPACKT">Rect</span> <span class="ScreenTextPACKT">Transform.</span> Choose the <span class="ScreenTextPACKT">top-left</span> box component while holding down <em><span class="CodeInTextPACKT">SHIFT</span></em> and <em><span class="CodeInTextPACKT">ALT</span></em> (to set pivot and position).</li>
<li>Create the following C# Script class <span class="CodeInTextPACKT">PlayerInventoryDisplay</span> and add an instance to GameObject <span class="CodeInTextPACKT">player-SpaceGirl</span> in the <span class="ScreenTextPACKT">Hierarchy</span>:</li>
</ol>
<pre style="color: black;padding-left: 60px">using UnityEngine; 
using UnityEngine.UI;

[RequireComponent(typeof(PlayerInventory))] 
public class PlayerInventoryDisplay : MonoBehaviour  { 
   public Image imageStarGO; 
   public Sprite iconNoStar; 
   public Sprite iconStar;

   public void OnChangeCarryingStar(bool carryingStar) { 
        if (carryingStar) 
            imageStarGO.sprite = iconStar; 
        else 
            imageStarGO.sprite = iconNoStar; 
    } 
} </pre>
<ol start="7">
<li>From the <span class="KeyWordPACKT">Hierarchy</span> view, select the GameObject <span class="CodeInTextPACKT">player-SpaceGirl</span>. Then, from the <span class="KeyWordPACKT">Inspector</span>, access the <span class="KeyWordPACKT">PlayerInventoryDisplay (Script)</span> component and populate the <span class="KeyWordPACKT">Star Image</span> public field with <span class="KeyWordPACKT">UI Image</span> object <span class="CodeInTextPACKT">Image-star-icon</span>.</li>
<li>Populate the <span class="KeyWordPACKT">Icon No Star</span> public field from the <span class="KeyWordPACKT">Project</span> panel with the <span class="CodeInTextPACKT"><kbd>icon_nostar_100</kbd> <span>sprite</span></span>, and then populate the <span class="KeyWordPACKT">Icon Star</span> public field from the <span class="KeyWordPACKT">Project</span> panel with the <span class="CodeInTextPACKT"><kbd>icon_star_100</kbd> sprite</span>, as shown in the screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/60355ab6-8a60-44ee-be1f-69d1b0ed20d8.png"/></div>
<ol start="9">
<li>Play the scene. You should see the no star icon (a gray-filled icon in a blocked-off circle) in the top left until you pick up the star, at which point it will change to show the carrying star icon (yellow-filled star).</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p style="color: black">In the script class <kbd><span class="CodeInTextPACKT">PlayerInventoryDisplay</span></kbd> the <span class="CodeInTextPACKT">Image</span> variable <kbd><span class="CodeInTextPACKT">imageStarGO</span></kbd> is a reference to the <span class="KeyWordPACKT">UI Image</span> object <kbd><span class="ScreenTextPACKT">Image-star-icon</span></kbd>. The s<span class="CodeInTextPACKT">prite</span> variables <kbd><span class="CodeInTextPACKT">iconStar</span></kbd> and <kbd><span class="CodeInTextPACKT">iconNoStar</span></kbd> are references to the <span class="CodeInTextPACKT">Sprite</span> files in the <span class="ScreenTextPACKT">Project</span> panel - the sprites to tell the player whether or not a star is being carried.</p>
<p style="color: black">Each time method <kbd>OnChangeCarryingStar(carryingStar)</kbd> is invoked by the <kbd><span class="CodeInTextPACKT">PlayerInventory</span></kbd> object, this method uses an <span class="CodeInTextPACKT"><kbd>if</kbd> </span>statement to set the <strong><span class="KeyWordPACKT">UI Image</span></strong> to the sprite that corresponds to the value of the bool argument received.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Displaying multiple pickups of the same object with multiple status icons</h1>
                </header>
            
            <article>
                
<p style="color: black">If there is a small, fixed total number of an item to be collected rather than text totals, an effective UI approach is to display placeholder icons (empty or grayed out pictures) to show the user how many of the item remain to be collected, and each time an item is picked up, a placeholder icon is replaced by a full color collected icon.</p>
<p style="color: black">In this recipe, we use gray-filled star icons as the placeholders and yellow-filled star icons to indicate each collected star, as shown in the screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/458361ac-c050-4586-969e-e298a1fd8d5c.png" style="width:25.58em;height:7.50em;"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p style="color: black">This recipe assumes that you are starting with the <kbd><span class="CodeInTextPACKT">Simple2Dgame_SpaceGirl</span></kbd> <span>project </span>set up in the first recipe in this chapter.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<p style="color: black">To display multiple inventory icons for multiple pickups of same type of object, follow these steps:</p>
<ol>
<li>Start with a new copy of the <span class="CodeInTextPACKT"><kbd>Simple2Dgame_SpaceGirl</kbd> <span>mini-game</span></span>.</li>
<li>Create C# Script class <kbd><span class="CodeInTextPACKT">PlayerInventory</span></kbd> in the <span class="CodeInTextPACKT"><kbd>_Scripts</kbd> <span>folder</span></span>:</li>
</ol>
<pre style="color: black;padding-left: 60px">using UnityEngine; 

public class PlayerInventory : MonoBehaviour { 
   private PlayerInventoryDisplay playerInventoryDisplay; 
   private int totalStars = 0; 

   void Awake() { 
         playerInventoryDisplay = GetComponent&lt;PlayerInventoryDisplay&gt;(); 
   }  

   void Start() { 
        playerInventoryDisplay.OnChangeStarTotal(totalStars); 
   }  

   void OnTriggerEnter2D(Collider2D hit) { 
         if (hit.CompareTag("Star")) { 
            totalStars++; 
            playerInventoryDisplay.OnChangeCarryingStar(totalStars); 
            Destroy(hit.gameObject); 
         } 
   } 
} </pre>
<ol start="3">
<li>Select the GameObject <span class="ScreenTextPACKT"><span class="packt_screen">star</span></span> in the <strong><span class="ScreenTextPACKT">Hierarchy</span></strong> panel and make three more copies of this GameObject. There are now four <span class="ScreenTextPACKT"><span class="packt_screen">star</span></span> GameObjects in the scene. Move these new <span class="ScreenTextPACKT"><span class="packt_screen">star</span></span> GameObjects to different parts of the screen.</li>
<li>Add the following C# Script <kbd><span class="CodeInTextPACKT">PlayerInventoryDisplay</span></kbd> to the GameObject <kbd><span class="CodeInTextPACKT">player-SpaceGirl</span></kbd> in the <span class="ScreenTextPACKT"><strong>Hierarchy</strong>:</span></li>
</ol>
<pre style="color: black;padding-left: 60px">using UnityEngine; 
using System.Collections; 
using UnityEngine.UI; 

public class PlayerInventoryDisplay : MonoBehaviour { 
    public Image[] starPlaceholders; 
    public Sprite iconStarYellow; 
    public Sprite iconStarGrey;

    public void OnChangeStarTotal(int starTotal){ 
       for (int i = 0;i &lt; starPlaceholders.Length; ++i){ 
          if (i &lt; starTotal) 
              starPlaceholders[i].sprite = iconStarYellow; 
          else 
             starPlaceholders[i].sprite = iconStarGrey; 
        } 
    } 
}</pre>
<ol start="5">
<li>Select the <span class="KeyWordPACKT">Canvas</span> in the <span class="KeyWordPACKT">Hierarchy</span> panel and add a new <span class="KeyWordPACKT">UI Image</span> object (<span class="KeyWordPACKT"><span class="packt_screen">Create</span> | <span class="packt_screen">UI</span> | <span class="packt_screen">Image</span></span>). Rename it <span class="ScreenTextPACKT">Image-star0</span>.</li>
<li>Select <span class="ScreenTextPACKT">Image-star0</span> in the <span class="KeyWordPACKT">Hierarchy</span> panel.</li>
<li>From the <span class="KeyWordPACKT">Project</span> panel, drag the sprite <kbd><span class="CodeInTextPACKT">icon_star_grey_100</span></kbd> (in the Sprites folder) into the <span class="KeyWordPACKT">Source Image</span> field in the <span class="KeyWordPACKT">Inspector</span> for the <span class="KeyWordPACKT">Image (Script)</span> component.</li>
<li>Click on the <span class="KeyWordPACKT">Set Native Size</span> button for this for the <span class="KeyWordPACKT">Image (Script)</span> component. This will resize the UI <span class="ScreenTextPACKT">Image</span> to fit the physical pixel width and height of sprite file <kbd><span class="CodeInTextPACKT">icon_star_grey_100</span></kbd>.</li>
<li>Now we will position our icon at the <span class="KeyWordPACKT">top-left</span> of the <span class="ScreenTextPACKT">Game</span> panel. Edit the <span class="KeyWordPACKT">UI Image's Rect Transform</span> component, and while holding down <span class="CodeInTextPACKT"><em>Shift</em></span> + <em><span class="CodeInTextPACKT">Alt</span></em> (to set pivot and position), choose the <span class="ScreenTextPACKT">top-left</span> box. The <span class="KeyWordPACKT">UI Image</span> should now be positioned at the top left of the <span class="KeyWordPACKT">Game</span> panel.</li>
<li>Make three more copies of <span class="ScreenTextPACKT"><span class="packt_screen">Image-star0</span></span> in the <span class="KeyWordPACKT">Hierarchy</span> panel, naming them <span class="ScreenTextPACKT"><span class="packt_screen">Image-star1</span></span>, <span class="ScreenTextPACKT"><span class="packt_screen">Image-star2</span></span>, and <span class="ScreenTextPACKT"><span class="packt_screen">Image-star3</span></span>.</li>
<li>In the <span class="KeyWordPACKT">Inspector</span> panel, change the <span class="ScreenTextPACKT"><span class="packt_screen">Pos X</span></span> position (in the <span class="KeyWordPACKT">Rect Transform</span> component) of <span class="ScreenTextPACKT"><span class="packt_screen">Image-star1</span></span> to <kbd><span class="CodeInTextPACKT">100</span></kbd>, of <span class="ScreenTextPACKT"><span class="packt_screen">Image-star2</span></span> to <kbd><span class="CodeInTextPACKT">200</span></kbd>, and of <span class="ScreenTextPACKT"><span class="packt_screen">Image-star3</span></span> to <kbd>3<span class="CodeInTextPACKT">00</span></kbd>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/1aae7d83-99c9-4d6b-81b8-8072835d454e.png"/></div>
<ol start="12">
<li>In the <strong>Hierarchy</strong>, select the GameObject <span class="packt_screen">player-SpaceGirl</span>. Then, from the <strong><span class="KeyWordPACKT">Inspector</span></strong>, access the <span class="KeyWordPACKT"><strong>Player Inventory Display</strong> (Script)</span> component and set the <span class="KeyWordPACKT">Size</span> property of the public field <span class="ScreenTextPACKT"><span class="packt_screen">Star Placeholders</span></span> to <kbd><span class="CodeInTextPACKT">4</span></kbd>.</li>
<li>Next, populate the <span class="KeyWordPACKT"><span class="packt_screen">Element 0/1/2/3</span></span> array values of public field <strong><span class="KeyWordPACKT">Star Placeholders</span></strong> with <strong><span class="KeyWordPACKT">UI Image</span></strong> objects <span class="packt_screen"><span class="ScreenTextPACKT">Image-star0/1/2/3</span></span>.</li>
</ol>
<ol start="14">
<li>Now, populate the <span class="KeyWordPACKT">Icon <strong>Star Yellow</strong></span> and <strong><span class="KeyWordPACKT">Icon Star Grey</span></strong> public fields from the <span class="KeyWordPACKT">Project</span> panel with sprite <kbd><span class="CodeInTextPACKT">icon_star_100</span></kbd> and <kbd><span class="CodeInTextPACKT">icon_star_grey_100</span></kbd>, as shown in the screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/3265c7b4-d3d7-423f-b3c8-7db0511c8d5c.png" style="width:36.75em;height:26.58em;"/></div>
<ol start="15">
<li>Now, when you play the scene, you should see the sequence of four gray placeholder star icons initially, and each time you collide with a star, the next icon at the top should turn yellow.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p style="color: black">Four <strong><span class="KeyWordPACKT">UI Image</span></strong> objects <span class="ScreenTextPACKT"><span class="packt_screen">Image-star0/1/2/3</span></span> have been created at the top of the screen — initialized with the gray placeholder icon. The gray and yellow icon sprite files have been resized to be 100 x 100 pixels, making their horizontal arrangement positioning at <span class="KeyWordPACKT">design time</span> easier, since their positions are (0,0), (100,0), (200,0), and (300,0). In a more complicated game screen, or one where real estate is precious, the actual size of the icons would probably be smaller – a decision to be made by the game graphic designer.</p>
<p style="color: black">In script class <span class="CodeInTextPACKT"><kbd>PlayerInventory</kbd>,</span> the <span class="CodeInTextPACKT">int</span> variable <kbd><span class="CodeInTextPACKT">totalStars</span></kbd> represents how many stars have been collected so far; it is initialized to zero. The variable <kbd><span class="CodeInTextPACKT">playerInventoryDisplay</span></kbd> is a reference to the scripted component that manages our inventory display – this variable is cached before the scene begins in the <kbd><span class="CodeInTextPACKT">Awake()</span></kbd> method.</p>
<p style="color: black">The <kbd><span class="CodeInTextPACKT">Start()</span></kbd> method that runs at the beginning of the scene, calls the <kbd><span class="CodeInTextPACKT">OnChangeStarTotal(...)</span></kbd> method of the <kbd><span class="CodeInTextPACKT">PlayerInventoryDisplay</span></kbd> component to ensure that the icons on screen are displayed to match the starting value of <span class="CodeInTextPACKT">totalStars</span>.</p>
<p style="color: black">In the <kbd><span class="CodeInTextPACKT">OnTriggerEnter2D()</span></kbd> method, the <span class="CodeInTextPACKT">totalStars</span> counter is incremented by 1 each time the player's character hits an object tagged <span class="ScreenTextPACKT"><span class="packt_screen">Star</span></span>. As well as destroying the hit GameObject, the <kbd><span class="CodeInTextPACKT">OnChangeStarTotal(...)</span></kbd> method of the <kbd><span class="CodeInTextPACKT">PlayerInventoryDisplay</span></kbd> component is called, passing the new star total integer.</p>
<p style="color: black">The <span class="CodeInTextPACKT"><kbd>OnChangeStarTotal(...)</kbd> </span>method of script class <kbd><span class="CodeInTextPACKT">PlayerInventoryDisplay</span></kbd> has references to the four <strong><span class="KeyWordPACKT">UI Images</span></strong>, and loops through each item in the array of Image references, setting the given number of images to yellow, and the remaining to gray. This method is public, allowing it to be called from an instance of script class <kbd><span class="CodeInTextPACKT">PlayerInventory</span></kbd>.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">There's more...</h1>
                </header>
            
            <article>
                
<p style="color: black">Here are some details you don't want to miss:</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Revealing icons for multiple object pickups by changing the size of a tiled image</h1>
                </header>
            
            <article>
                
<p style="color: black">Another approach that could be taken to show increasing numbers of images is to make use of tiled images. The same visual effect as in the previous recipe can also be achieved by making use of a tiled gray star image of width 400 (showing four copies of the gray star icon), behind a tiled yellow star image, whose width is 100 times the number of stars collected.</p>
<p style="color: black">If the yellow-starred image is less wide that the gray starred imaged beneath then we'll see gray stars for any remaining locations. For example, if we are carrying 3 stars, we'll make the width of the yellow-starred image 3 x 100 = 300 pixels wide. This will show 3 yellow stars and reveal 100 pixels, that is, 1 gray star, from the gray starred image beneath it.</p>
<p style="color: black">To display grey and yellow star icons for multiple object pickups using tiled images, let's adapt our recipe to illustrate this technique by following these steps:</p>
<ol>
<li>In the <strong><span class="KeyWordPACKT">Hierarchy</span></strong> panel, delete the entire <strong><span class="KeyWordPACKT">Canvas</span></strong> GameObject (and therefore delete all four <strong><span class="KeyWordPACKT">UI Images</span></strong>).</li>
<li>Add to your scene a new <strong><span class="KeyWordPACKT">UI Image</span></strong> object (<span class="KeyWordPACKT"><strong>Create</strong> | <strong>UI</strong> | <strong>Image</strong></span>). Rename the GameObject <span class="ScreenTextPACKT"><span class="packt_screen">Image-stars-gray</span></span>.</li>
<li>Ensure <span class="ScreenTextPACKT"><span class="packt_screen">Image-stars-gray</span></span> is selected in the <strong><span class="KeyWordPACKT">Hierarchy</span></strong>. From the <strong><span class="KeyWordPACKT">Project</span></strong> panel, drag sprite <kbd><span class="CodeInTextPACKT">icon_star_grey_100</span></kbd> (in the Sprites folder) into the <strong><span class="KeyWordPACKT">Source Image</span></strong> field in the <strong><span class="KeyWordPACKT">Inspector</span></strong> (in the <strong><span class="KeyWordPACKT">Image (Script)</span></strong> component).</li>
<li>Click on the <strong><span class="KeyWordPACKT">Set Native Size</span></strong> button for this for the <span class="KeyWordPACKT">Image (Script)</span> component. This will resize the <strong><span class="KeyWordPACKT">UI Image</span></strong> to fit the physical pixel width and height of sprite file <kbd><span class="ScreenTextPACKT">icon_star_grey_100</span></kbd><span class="ScreenTextPACKT">.</span></li>
<li>Now position the icon at the <strong><span class="KeyWordPACKT">top</span></strong> and <strong><span class="KeyWordPACKT">left</span></strong> of the screen. Edit the <span class="KeyWordPACKT"><strong>UI Image's</strong> <strong>Rect</strong></span> <strong><span class="KeyWordPACKT">Transform</span></strong> component, and while holding down <em><span class="CodeInTextPACKT">Shift</span></em> + <em><span class="CodeInTextPACKT">Alt</span></em> (to set pivot and position), choose the <span class="ScreenTextPACKT"><span class="packt_screen">top-left</span></span> box. The <span class="KeyWordPACKT">UI Image</span> should now be positioned at the top left of the <strong><span class="ScreenTextPACKT">Game</span></strong> panel.</li>
<li>In the <span class="packt_screen"><span class="ScreenTextPACKT">Inspector</span></span> panel, change the <strong><span class="ScreenTextPACKT">Width</span></strong> (in the <span class="ScreenTextPACKT">Rect Transform</span> component) of <span class="ScreenTextPACKT"><span class="packt_screen">Image-stars-grey</span></span> to <kbd>400</kbd>. Also, set the <strong><span class="ScreenTextPACKT">Image Type</span></strong> (in the <strong><span class="ScreenTextPACKT">Image (Script)</span></strong> component) to <strong>Tiled</strong>, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/6007c4cf-2c62-4bbc-824a-dcd34e83b481.png"/></div>
<div class="packt_infobox">For a simple game like this, we are choosing simplicity over memory efficiency. You'll see a notice suggesting using an advanced texture with Wrap mode repeat and a cleared packing tag. While more memory efficient, it's more complicated to do for small, simple tiling such as in this recipe.</div>
<ol start="7">
<li>Make a copy of <span class="packt_screen"><span class="ScreenTextPACKT">I</span><span class="ScreenTextPACKT">mage-stars-grey</span></span> in the <strong><span class="KeyWordPACKT">Hierarchy</span></strong> panel, naming the copy <strong><span class="ScreenTextPACKT">Image-stars-yellow</span></strong>.</li>
<li>With <span class="ScreenTextPACKT"><span class="packt_screen">Image-stars-yellow</span></span> selected in <span class="KeyWordPACKT">Hierarchy</span> panel, from the <strong><span class="KeyWordPACKT">Project</span></strong> panel, drag the sprite <kbd><span class="CodeInTextPACKT">icon_star_100</span></kbd> (in the <kbd>Sprites</kbd> folder) into the <strong><span class="KeyWordPACKT">Source Image</span></strong> field in the <span class="KeyWordPACKT">Inspector</span> (in the <strong><span class="KeyWordPACKT">Image (Script)</span></strong> component).</li>
<li>Set the width of <span class="ScreenTextPACKT"><span class="packt_screen">Image-stars-yellow</span></span> to <span class="CodeInTextPACKT">0</span> (in the <strong><span class="KeyWordPACKT">Rect Transform</span></strong> component). So, now we have the yellow stars tiled image above the grey tiled image, but since its width is zero, we don't see any of the yellow stars yet.</li>
<li>Replace the existing C# script <kbd><span class="CodeInTextPACKT">PlayerInventoryDisplay</span></kbd> with the following code:</li>
</ol>
<pre style="color: black;padding-left: 60px">using UnityEngine; 
using UnityEngine.UI; 

[RequireComponent(typeof(PlayerInventory))] 
public class PlayerInventoryDisplay : MonoBehaviour { 
   public Image iconStarsYellow; 
<br/>   public void OnChangeStarTotal(int starTotal) { 
         float newWidth = 100 * starTotal; 
        iconStarsYellow.rectTransform.SetSizeWithCurrentAnchors( RectTransform.Axis.Horizontal, newWidth ); 
   } 
} </pre>
<ol start="11">
<li>From the <strong><span class="KeyWordPACKT">Hierarch</span><span class="KeyWordPACKT">y</span></strong> view, select the GameObject <span class="ScreenTextPACKT"><span class="packt_screen">player-SpaceGirl</span></span>. Then, from the <strong><span class="KeyWordPACKT">Inspector</span></strong>, access the <span class="KeyWordPACKT"><strong>Player Inventory Display</strong> <strong>(Script)</strong></span> component and populate the <span class="KeyWordPACKT">Icons Stars Yellow</span> public field with <span class="KeyWordPACKT">UI Image</span> object <span class="ScreenTextPACKT"><span class="packt_screen">Image-stars-yellow</span></span>.</li>
</ol>
<p style="color: black"><span class="KeyWordPACKT">UI Image</span> <span class="ScreenTextPACKT"><span class="packt_screen">Image-stars-gray</span></span> is a tiled image, wide enough (<kbd>400px</kbd>) for the gray sprite <kbd><span class="CodeInTextPACKT">icon_star_grey_100</span></kbd> to be shown four times. <span class="KeyWordPACKT">UI Image</span> <span class="ScreenTextPACKT"><span class="packt_screen">Image-stars-yellow</span></span> is a tiled image, above the grey one, initially with width set to <span class="KeyWordPACKT">zero</span>, so no yellow stars can be seen.</p>
<p style="color: black">Each time a star is picked up, a call is made from the <kbd><span class="CodeInTextPACKT">PlayerInventory</span></kbd> scripted object to the <kbd>OnChangeStarTotal()</kbd> method of the script component <kbd><span class="CodeInTextPACKT">PlayerInventoryDisplay</span></kbd>, passing the new integer number of stars collected. By multiplying this by the width of the yellow sprite image (100 px), we get the correct width to set for <strong><span class="KeyWordPACKT">UI Image</span></strong> <span class="ScreenTextPACKT"><span class="packt_screen">Image-stars-yellow</span></span> so that the corresponding number of yellow stars will now be seen by the user. Any stars that remain to be collected will still be seen as the grey stars that are not yet covered up.</p>
<p style="color: black">The actual task of changing the width of <span class="KeyWordPACKT">UI Image</span> <span class="ScreenTextPACKT"><span class="packt_screen">Image-stars-yellow</span></span> is completed by calling the <span class="CodeInTextPACKT"><kbd>SetSizeWithCurrentAnchors(...)</kbd> </span>method. The first parameter is the axis, so we pass the constant <kbd><span class="CodeInTextPACKT">RectTransform.Axis.Horizontal</span></kbd> so that it will be the width that is changed. The second parameter is the new size for that axis, so we pass a value that is 100 times the number of stars collected so far (the variable <kbd><span class="CodeInTextPACKT">newWidth</span></kbd>).</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Using panels to visually outline the inventory UI area and individual items</h1>
                </header>
            
            <article>
                
<p style="color: black">We see four kinds of objects when playing a game:</p>
<ul>
<li>GameObjects that have some visual elements, such as 2D and 3D objects.</li>
<li>UI elements located in <span class="KeyWordPACKT"><strong>World Space</strong>,</span> so they appear next to GameObjects in the scene.</li>
<li>UI elements located in <span class="KeyWordPACKT"><strong>Screen Space</strong> - <strong>Camera</strong>,</span> so they appear at a fixed distance from the camera (but can be obscured by GameObjects closer to the camera than these UI elements).</li>
<li>UI elements located in <span class="KeyWordPACKT"><strong>Screen Space</strong> - <strong>Overlay</strong>.</span> These always appear above the other three kinds of visual element, and are perfect for <strong><span class="KeyWordPACKT">Head Up Display</span></strong> (<strong>HUD</strong>) elements, such as inventories.</li>
</ul>
<p style="color: black">Sometimes we want to visually make it clear which elements are part of the UI HUD and which are visual objects in the scene. Unity <strong><span class="KeyWordPACKT">UI Panels</span></strong> with an opaque or translucent background image are a simple and effective way to achieve this.</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/63f5bed4-4c57-4ebc-b0a7-e53313067b05.png" style="width:32.17em;height:11.25em;"/></div>
<p style="color: black">Panels can also be used to display locations (slots) with shaped or colored backgrounds indicating where items may be placed, or how many may be collected. As shown in the screenshot, in this recipe we'll create a panel with some title text, and three inventory slots, two of which will be filled with star icons, communicating to the player that there is one more star that could be collected/carried.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p style="color: black">This recipe assumes that you are starting with the <kbd><span class="CodeInTextPACKT">Simple2Dgame_SpaceGirl</span></kbd> <span>project </span>set up in the first recipe in this chapter. The font you need can be found in the <kbd><span class="CodeInTextPACKT">03_02</span></kbd> folder.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<p style="color: black">To use panels to visually outline the inventory area and individual items, follow these steps:</p>
<ol>
<li>Start with a new copy of the <span class="CodeInTextPACKT"><kbd>Simple2Dgame_SpaceGirl</kbd> <span>mini-game</span></span>.</li>
<li>In the <strong><span class="ScreenTextPACKT">Hierarchy</span></strong> panel, create a <strong><span class="KeyWordPACKT">UI Panel</span></strong> (<strong><span class="ScreenTextPACKT">Create</span></strong> | <strong><span class="ScreenTextPACKT">UI</span></strong> | <strong><span class="ScreenTextPACKT">Panel</span></strong>) and rename it <span class="ScreenTextPACKT"><span class="packt_screen">Panel-background</span></span>.</li>
<li>Let's now position <span class="ScreenTextPACKT"><span class="packt_screen">Panel-background</span></span> at the top of the <span class="KeyWordPACKT">Game</span> panel, stretching the horizontal width of the canvas. Edit the UI <strong><span class="ScreenTextPACKT">Image's</span> <span class="ScreenTextPACKT">Rect Transform</span></strong> component, and while holding down <em><span class="KeyPACKT">Shift</span></em> + <em><span class="KeyPACKT">Alt</span></em> (to set pivot and position), choose the <span class="ScreenTextPACKT"><span class="packt_screen">top-stretch</span></span> box.</li>
</ol>
<ol start="4">
<li>The panel will still be taking up the whole game window. Now, in the <strong><span class="ScreenTextPACKT">Inspector</span></strong>, change the <strong><span class="ScreenTextPACKT">Height</span></strong> (in the <strong><span class="KeyWordPACKT">Rect Transform</span></strong> component) of <span class="ScreenTextPACKT"><span class="packt_screen">Panel-background</span></span> to 100.</li>
<li>Add a UI <span class="ScreenTextPACKT">Text</span> object (<strong><span class="ScreenTextPACKT">Create</span></strong> | <strong><span class="ScreenTextPACKT">UI</span></strong> | <strong><span class="ScreenTextPACKT">Text</span></strong>), rename it <strong><span class="ScreenTextPACKT">Text-inventory</span></strong>. For its <span class="KeyWordPACKT">Text (Script)</span> component, change the text to <span class="ScreenTextPACKT">Inventory</span>.</li>
<li>In the <span class="ScreenTextPACKT">Hierarchy</span> panel, child <strong><span class="KeyWordPACKT">UI Text</span></strong> object <strong><span class="ScreenTextPACKT">Text-inventory</span></strong> to panel <span class="packt_screen">Panel-background</span>.</li>
<li>In the <strong><span class="ScreenTextPACKT">Inspector</span> panel</strong>, also set the font of <span class="ScreenTextPACKT">Text-inventory</span> to <span class="ScreenTextPACKT">Xolonium-Bold</span> (the <span class="CodeInTextPACKT">Fonts</span> folder). Center the text horizontally, for <span class="KeyWordPACKT">Alignment</span> choose vertical center, set its <strong><span class="ScreenTextPACKT">Height</span></strong> to <span class="CodeInTextPACKT">50</span>, and set the <strong><span class="ScreenTextPACKT">Font Size</span></strong> to <span class="CodeInTextPACKT">23</span>.</li>
<li>Edit the <strong><span class="ScreenTextPACKT">Rect Transform</span></strong> of <span class="ScreenTextPACKT"><span class="packt_screen">Text-inventory</span></span>, and while holding down <em><span class="KeyPACKT">Shift</span></em> + <em><span class="KeyPACKT">Alt</span></em> (to set pivot and position), choose the <span class="ScreenTextPACKT"><span class="packt_screen">top-stretch</span></span> box. The text should now be positioned at the <span class="packt_screen">top-center</span> of the <span class="ScreenTextPACKT">UI Panel</span> object <span class="ScreenTextPACKT"><span class="packt_screen">Panel-background</span>,</span> and its width should stretch to match that of the whole panel.</li>
<li>The text should now be positioned at the <span class="packt_screen">top-center</span> of the <span class="ScreenTextPACKT">UI Panel</span> object <span class="ScreenTextPACKT"><span class="packt_screen">Panel-background</span></span> and its width should stretch to match that of the whole panel.</li>
<li>Create a new <span class="KeyWordPACKT">UI Panel</span> (<strong><span class="ScreenTextPACKT">Create</span></strong> | <strong><span class="ScreenTextPACKT">UI</span></strong> | <strong><span class="ScreenTextPACKT">Panel</span></strong>) and rename it <span class="ScreenTextPACKT"><span class="packt_screen">Panel-inventory-slot</span></span>.</li>
<li>Edit the <span class="ScreenTextPACKT">Rect Transform</span> of <span class="ScreenTextPACKT">Panel-inventory-slot</span>, and while holding down <em><span class="KeyPACKT">Shift</span></em> + <em><span class="KeyPACKT">Alt</span></em> (to set pivot and position), choose the <span class="ScreenTextPACKT"><span class="packt_screen">top-center</span></span> box. Set both the <span class="ScreenTextPACKT">Width</span> and <span class="ScreenTextPACKT">Height</span> to <kbd>70</kbd>, and the <span class="ScreenTextPACKT"><span class="packt_screen">Pos Y</span></span> to <kbd>-30</kbd>. See the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/b23be950-c43f-4e56-bbab-fe05e6f2afaa.png"/></div>
<ol start="12">
<li>Ensure GameObject <span class="packt_screen"><span class="ScreenTextPACKT">P</span><span class="ScreenTextPACKT">anel-inventory</span></span><span class="ScreenTextPACKT">-slot</span> is selected in the Hierarchy. In the <span class="ScreenTextPACKT"><span class="packt_screen">Image (Script)</span></span> component change the <span class="ScreenTextPACKT">Source Image</span> from the <strong><span class="KeyWordPACKT">UI Panel</span></strong> default of <span class="ScreenTextPACKT">Background</span> to the circular <strong><span class="ScreenTextPACKT">Knob</span></strong> image (this is one of the built-in images that come as part of the Unity UI system). As shown in the following screenshot, you should now see a circle centered below the title text in our inventory HUD rectangle. This circle visually tells the user that there is space in the inventory for an item to be collected:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/5f4728fd-bf47-449b-8682-12ab388f57e3.png" style="width:34.33em;height:7.58em;"/></div>
<ol start="13">
<li>Imagine the player has collected a star. Let's now add (inside our inventory slot circle panel) a yellow star icon image. Add to the scene a <span class="KeyWordPACKT">UI Image</span> object (<span class="KeyWordPACKT"><strong>Create</strong> | <strong>UI</strong> | <strong>Image</strong></span>). Rename it <span class="ScreenTextPACKT">Image-icon</span>. Child GameObject <strong><span class="ScreenTextPACKT">Image-icon</span></strong> to the panel <span class="ScreenTextPACKT"><span class="packt_screen">Panel-inventory-slot</span></span>.</li>
</ol>
<div class="packt_infobox">Child GameObjects can be hidden making the GameObject <strong>inactive</strong>. By creating a new <strong>UI Image</strong> GameObject for our star icon, and adding it as a child of our <span class="packt_screen">Panel-inventory-slot</span> GameObject, we can now display the star icon when the <strong>Image</strong> is enabled and hide it by making it inactive. This is a general approach, which means as long as we have a reference to the <strong>Image</strong> GameObject, we don't have to do extra work swapping images as we had to do in some of the previous recipes. This means we can begin to write more general-purpose code that will work with different inventory panels for keys, stars, money, and so on.</div>
<ol start="14">
<li>With <span class="ScreenTextPACKT">Image-ic</span><span class="ScreenTextPACKT">on</span> selected in the <strong><span class="KeyWordPACKT">Hierarchy</span></strong>, drag the sprite <kbd><span class="ScreenTextPACKT">icon_star_100</span></kbd> (in the <kbd>Sprites</kbd> folder) from the <strong><span class="KeyWordPACKT">Project</span></strong> panel into the <strong><span class="KeyWordPACKT">Source Image</span></strong> field in the <span class="KeyWordPACKT">Inspector</span> (in the <span class="KeyWordPACKT"><strong>Image (Script</strong>)</span> component).</li>
</ol>
<ol start="15">
<li>Edit the <strong><span class="ScreenTextPACKT">Rect Transform</span></strong> of <span class="ScreenTextPACKT"><span class="packt_screen">Image-icon</span></span>, and while holding down <em><span class="KeyPACKT">Shift</span></em> + <em><span class="KeyPACKT">Alt</span></em> (to set pivot and position), choose the <span class="ScreenTextPACKT">stretch-stretch</span> box. The star icon should now be stretched the perfect size to fit inside the <kbd>70x70</kbd> parent panel, so we see a star inside the circle.</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/f48f5552-6b5b-4003-9eee-087f33cab456.png" style="width:36.33em;height:13.50em;"/></div>
<ol start="16">
<li>Save and run the scene and play the game. You should see a clearly defined rectangle at the top of the screen, with the title text <span class="packt_screen">Inventory</span>. Inside the inventory rectangular area you can see a circular slot, currently showing a star.</li>
<li>Let's display 3 slots to the player. First, change the <span class="ScreenTextPACKT"><span class="packt_screen">Pos X</span></span> horizontal position of panel <span class="ScreenTextPACKT"><span class="packt_screen">Panel-inventory-slot</span></span> to <span class="packt_screen">-70</span>. This moves it left of center, making space for the next one, and allowing us to center the three slots when we've finished.</li>
<li>Duplicate panel <span class="ScreenTextPACKT"><span class="packt_screen">Panel-inventory-slot</span></span>, renaming (if necessary) the copy to panel <span class="ScreenTextPACKT"><span class="packt_screen">Panel-inventory-slot (1)</span></span>. Set the <span class="ScreenTextPACKT"><span class="packt_screen">Pos X</span></span> of this copy to <span class="ScreenTextPACKT">0</span>.</li>
<li>Duplicate panel <span class="ScreenTextPACKT"><span class="packt_screen">Panel-inventory-slot</span></span> again, renaming (if necessary) the copy to panel <span class="ScreenTextPACKT"><span class="packt_screen">Panel-inventory-slot</span> <span class="packt_screen">(2)</span></span>. Set the <span class="ScreenTextPACKT"><span class="packt_screen">Pos X</span></span> of this copy to <span class="ScreenTextPACKT"><span class="packt_screen">70</span></span>. Now select the child Image-star-icon of this third panel and make it inactive (at the top of the <strong>Inspector</strong> uncheck its active checkbox, to the left of the GameObject name) . The star for this panel should now be hidden, and only the circle background of the slot's panel is visible.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p style="color: black">We have created one simple panel (<span class="ScreenTextPACKT"><span class="packt_screen">Panel-background</span></span>) with title UI Text as a child GameObject at the top of the game canvas, which shows a grayish background rectangle and the title text Inventory. This indicates to the player that this part of the screen is where the inventory HUD will be displayed.</p>
<p style="color: black">To illustrate how this might be used to indicate a player carrying stars, we added a smaller panel for one slot in the inventory with a circular background image, and in that added a star icon a child GameObject. We then duplicated the slot panel two more times, positioning them 70 pixels apart. We then disabled (make inactive) the star icon of the third slot, so that the an empty slot circle is shown.</p>
<p style="color: black">Our scene presents to the user a display indicating two out of a possible three stars are being carried. This recipe is a good start for a more general-purpose approach to creating inventory UIs in Unity, and we'll build from it in some of the following recipes in this chapter.</p>
<div class="packt_infobox">We'll learn how to limit the player's movement to prevent their character moving into the rectangle of HUD items like this in <a href="eb0ea442-6350-4a86-9e16-708b80d8762f.xhtml" target="_blank"/><a href="eb0ea442-6350-4a86-9e16-708b80d8762f.xhtml">Chapter 12</a>, Controlling and Choosing Positions.</div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Creating a C# inventory slot UI display scripted component</h1>
                </header>
            
            <article>
                
<p style="color: black">In the previous recipe, we started to work with UI panels and images to create a more general-purpose GameObject for displaying inventory slots, and images to indicate what is stored in them. In this recipe, we look at taking things a little further with the graphics, and also create a C# script class to work with each inventory slot object.</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/459b3abb-fd0c-4247-8bc3-772238db3426.png" style="width:39.83em;height:14.83em;"/></div>
<p style="color: black">As we can see in the screenshot, in this recipe we'll create the UI (and scripts) for an inventory that has three locations for stars, and three more for keys, using colored and gray icons to indicate how many have been collected.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p style="color: black">This recipe adapts the previous one. So, make a copy of the project for the previous recipe and work on this copy.</p>
<p style="color: black">For this recipe, we have prepared a folder named <kbd><span class="CodeInTextPACKT">_Scripts</span></kbd> in the <kbd>03_06</kbd> folder.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<p style="color: black">To create a C# inventory slot display script component, follow these steps:</p>
<ol>
<li>Import the <kbd>_Scripts</kbd> folder from the provided files (this contains a copy of the script class <kbd>PlayerInventory</kbd> from one of the previous recipes, which we can use unchanged for this recipe).</li>
<li>Delete two of the three inventory slot GameObjects: <span class="ScreenTextPACKT"><span class="packt_screen">Panel-inventory-slot (1)</span></span> and <span class="ScreenTextPACKT"><span class="packt_screen">(2)</span></span>. So, only <span class="ScreenTextPACKT">Panel-inventory-slot</span> remains.</li>
<li>First we'll create a panel for three star slots. In the <strong><span class="ScreenTextPACKT">Hierarchy</span></strong> panel, create a <span class="KeyWordPACKT">UI Panel</span> (<strong><span class="ScreenTextPACKT">Create</span></strong> | <strong><span class="ScreenTextPACKT">UI</span></strong> | <strong><span class="ScreenTextPACKT">Panel</span></strong>) and rename it <span class="packt_screen">Panel-stars</span>.</li>
<li>We'll now position <span class="ScreenTextPACKT"><span class="packt_screen">Panel-stars</span></span> at the top-left of the <strong><span class="KeyWordPACKT">Game</span></strong> panel, and make it fit within the left side of our general inventory rectangle. Edit the UI <strong><span class="ScreenTextPACKT">Image's</span> <span class="ScreenTextPACKT">Rect Transform</span></strong> component, and while holding down <em><span class="KeyPACKT">SHIFT</span></em> and <em><span class="KeyPACKT">ALT</span></em> (to set pivot and position), choose the <span class="ScreenTextPACKT"><span class="packt_screen">top-left</span></span> box. Now set the <span class="ScreenTextPACKT"><span class="packt_screen">Heigh</span>t</span> to <span class="ScreenTextPACKT"><span class="packt_screen">60</span></span> and the <span class="ScreenTextPACKT"><span class="packt_screen">Width</span></span> to <span class="ScreenTextPACKT"><span class="packt_screen">300</span></span>. We'll now nudge this away from the top-left corner by setting <span class="ScreenTextPACKT"><span class="packt_screen">Pos X</span></span> to <span class="ScreenTextPACKT">10</span> and <span class="ScreenTextPACKT"><span class="packt_screen">Pos Y</span></span> to <span class="ScreenTextPACKT">-30</span>.</li>
<li>Add a <strong><span class="KeyWordPACKT">UI Text</span></strong> object (<strong><span class="ScreenTextPACKT">Create</span></strong> | <strong><span class="ScreenTextPACKT">UI</span></strong> | <strong><span class="ScreenTextPACKT">Text</span></strong>) and rename it <span class="ScreenTextPACKT"><span class="packt_screen">Text-title</span></span>. For its <span class="KeyWordPACKT"><strong>Text</strong> <strong>(Script)</strong></span> component, change the text to <span class="ScreenTextPACKT">Stars</span>. Child this <span class="KeyWordPACKT">UI Text</span> object to the panel <span class="ScreenTextPACKT">Panel-stars</span>.</li>
<li>Edit the <strong><span class="ScreenTextPACKT">Rect Transform</span></strong> of <span class="ScreenTextPACKT"><span class="packt_screen">Text-title</span></span>, and while holding down <em><span class="KeyPACKT">Shift</span></em> + <em><span class="KeyPACKT">Alt</span></em> (to set pivot and position), choose the <span class="ScreenTextPACKT">left-middle</span> box. The text should now be positioned at the <span class="ScreenTextPACKT"><span class="packt_screen">left-middle</span></span> of the <strong><span class="ScreenTextPACKT">UI Panel</span></strong> object <span class="ScreenTextPACKT"><span class="packt_screen">Panel-stars</span></span>.</li>
<li>In the <strong><span class="ScreenTextPACKT">Inspector</span></strong> panel, also set the font of <span class="ScreenTextPACKT"><span class="packt_screen">Text-title</span></span> to <strong><span class="ScreenTextPACKT">Xolonium-Bold</span></strong> (the <kbd><span class="CodeInTextPACKT">Fonts</span></kbd> folder). Center the text horizontally, <span class="ScreenTextPACKT"><span class="packt_screen">center-align</span></span> the text vertically, set its <strong><span class="ScreenTextPACKT">Height</span></strong> to <kbd><span class="CodeInTextPACKT">50</span></kbd>, and set the <strong><span class="ScreenTextPACKT">Font Size</span></strong> to <kbd><span class="CodeInTextPACKT">32</span></kbd>. Choose a <span class="ScreenTextPACKT"><span class="packt_screen">yellow</span></span> text color. Set <strong><span class="KeyWordPACKT">Vertical-overflow</span></strong> to <span class="ScreenTextPACKT">Overflow</span>, and set <strong><span class="KeyWordPACKT">Alignment</span></strong> vertical to center. We'll now nudge this away from the very left edge by setting <span class="ScreenTextPACKT"><span class="packt_screen">Pos X</span></span> to <span class="ScreenTextPACKT"><span class="packt_screen">10</span></span>.</li>
<li>Child the existing GameObject <span class="ScreenTextPACKT"><span class="packt_screen">Panel-inventory-slot</span></span> to <span class="ScreenTextPACKT"><span class="packt_screen">Panel-stars</span></span><span class="CodeInTextPACKT">.</span> Edit its <strong><span class="ScreenTextPACKT">Rect Transform</span></strong>, and while holding down <em><span class="KeyPACKT">Shift</span></em> + <em><span class="KeyPACKT">Alt</span></em> (to set pivot and position), choose the <span class="ScreenTextPACKT">left-middle</span> box.</li>
</ol>
<ol start="9">
<li>Resize <span class="ScreenTextPACKT"><span class="packt_screen">Panel-inventory-slot</span></span> to <span class="ScreenTextPACKT"><span class="packt_screen">Width</span></span> and <span class="ScreenTextPACKT"><span class="packt_screen">Height</span></span> <kbd>50 x 50</kbd> pixels. Set its <span class="ScreenTextPACKT"><span class="packt_screen">Pos X</span></span> to 140. It should now appear to the right of the yellow <span class="ScreenTextPACKT">Stars</span> text:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/771c225c-f450-410d-9ca0-69e8e0bbb1d6.png"/></div>
<ol start="10">
<li>Rename GameObject <span class="ScreenTextPACKT"><span class="packt_screen">Image-icon</span></span> as <span class="ScreenTextPACKT"><span class="packt_screen">Image-icon-grey</span></span>. Then duplicate this GameObject, naming the copy <span class="ScreenTextPACKT"><span class="packt_screen">Image-icon-color</span></span>. Both should be child GameObjects of <span class="ScreenTextPACKT"><span class="packt_screen">Panel-inventory-slot</span></span>. In the Hierarchy the sequence should be that the first child is <span class="ScreenTextPACKT"><span class="packt_screen">Image-icon-grey</span></span> and the second child is <span class="ScreenTextPACKT"><span class="packt_screen">Image-icon-color</span>.</span> If this isn't the order, then swap them.</li>
<li>Select <span class="ScreenTextPACKT"><span class="packt_screen">Image-icon-grey</span></span>, and drag the sprite <kbd><span class="ScreenTextPACKT">icon_star_grey_100</span></kbd> (in the <kbd>Sprites</kbd> folder) from the <strong><span class="KeyWordPACKT">Project</span></strong> panel into the <strong><span class="KeyWordPACKT">Source Image</span></strong> field in the <strong><span class="KeyWordPACKT">Inspector</span></strong> (in the <strong><span class="KeyWordPACKT">Image (Script)</span></strong> component). Now, if you disable GameObject <strong><span class="ScreenTextPACKT"><span class="packt_screen">Image-icon-color</span></span></strong> you should see the grey star icon inside the slot panel circle.</li>
<li>Create the following C# Script <kbd><span class="CodeInTextPACKT">PickupUI</span></kbd> (in the <kbd>_Scripts</kbd> folder) and add an instance as a component to GameObject of <span class="ScreenTextPACKT"><span class="packt_screen">Panel-inventory-slot</span></span> in the <strong><span class="ScreenTextPACKT">Hierarchy</span></strong>:</li>
</ol>
<pre style="color: black;padding-left: 60px">using UnityEngine; 
using System.Collections; 

public class PickupUI : MonoBehaviour { 
   public GameObject iconColor; 
   public GameObject iconGrey; 
<br/>   void Awake() { 
         DisplayEmpty(); 
   }  
<br/>   public void DisplayColorIcon() { 
         iconColor.SetActive(true); 
         iconGrey.SetActive(false); 
   }  

   public void DisplayGreyIcon() { 
         iconColor.SetActive(false); 
         iconGrey.SetActive(true); 
   } 

   public void DisplayEmpty() { 
         iconColor.SetActive(false); 
         iconGrey.SetActive(false); 
   } 
} </pre>
<ol start="13">
<li>Select <span class="packt_screen"><span class="ScreenTextPACKT">Panel-inven</span><span class="ScreenTextPACKT">tory-slot</span></span> in the <strong><span class="ScreenTextPACKT">Hierarchy</span></strong>. In the Inspector, for the <span class="ScreenTextPACKT"><span class="packt_screen">Pickup UI (Script)</span></span> component, populate the <strong><span class="KeyWordPACKT">Icon Color</span></strong> public field by dragging <span class="ScreenTextPACKT"><span class="packt_screen">Image-icon-color</span></span> from the Hierarchy. Likewise, populate the <span class="KeyWordPACKT">Icon Grey</span> public field by dragging <span class="ScreenTextPACKT"><span class="packt_screen">Image-icon-grey</span></span> from the Hierarchy. Now the scripted component <strong><span class="KeyWordPACKT">PickupUI</span></strong> in <span class="ScreenTextPACKT"><span class="packt_screen">Panel-inventory-slot</span></span> has references to the colored and grey icons for this inventory slot GameObject.</li>
<li>Duplicate GameObject <span class="ScreenTextPACKT"><span class="packt_screen">Panel-inventory-slot</span></span> and for the new duplicate GameObject set its <span class="ScreenTextPACKT"><span class="packt_screen">Pos X</span></span> to 190.</li>
<li>Duplicate GameObject <span class="ScreenTextPACKT"><span class="packt_screen">Panel-inventory-slot</span> second time</span> and for the new duplicate GameObject, set its <span class="ScreenTextPACKT"><span class="packt_screen">Pos X</span></span> to 240. You should now see all three star inventory icons lined up nicely spaced to the right of the yellow <span class="ScreenTextPACKT"><span class="packt_screen">Stars</span></span> title text:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/09799173-3394-4936-9deb-7fa15d9db835.png"/></div>
<ol start="16">
<li>Add the following C# Script <span class="CodeInTextPACKT"><span class="packt_screen">PlayerInventoryDisplay</span></span> to the GameObject <span class="ScreenTextPACKT"><span class="packt_screen">player-SpaceGirl</span></span> in the <strong><span class="KeyWordPACKT">Hierarchy</span></strong>:</li>
</ol>
<pre style="color: black;padding-left: 60px">using UnityEngine; 
using System.Collections; 
using UnityEngine.UI; 

[RequireComponent(typeof(PlayerInventory))] 
public class PlayerInventoryDisplay : MonoBehaviour  { 
   public PickupUI[] slots = new PickupUI[1]; <br/>   public void OnChangeStarTotal(int starTotal) { 
       int numInventorySlots = slots.Length; 
       for(int i = 0; i &lt; numInventorySlots; i++){ 
             PickupUI slot = slots[i]; 
             if(i &lt; starTotal) 
                   slot.DisplayColorIcon(); 
             else 
                   slot.DisplayGreyIcon(); 
       } 
   } 
} </pre>
<ol start="17">
<li>From the <strong><span class="KeyWordPACKT">Hierarchy</span></strong>, select the GameObject <span class="ScreenTextPACKT"><span class="packt_screen">player-SpaceGirl</span></span>. Then do the following in the <strong><span class="KeyWordPACKT">Inspector</span></strong> for the <strong><span class="KeyWordPACKT">Player Inventory Display (Script)</span></strong> component:
<ul>
<li>Set the <span class="ScreenTextPACKT"><span class="packt_screen">Size</span></span> of public array <span class="ScreenTextPACKT"><span class="packt_screen">slots</span></span> to 3.</li>
<li>Populate the <span class="KeyWordPACKT"><strong>Element</strong> <strong>0</strong></span> public field with the <span class="packt_screen">GameObject <span class="ScreenTextPACKT">Panel-inventory-slot</span></span>.</li>
<li>Populate the <strong><span class="KeyWordPACKT">Element 1</span></strong> public field with the <span class="packt_screen">GameObject <span class="ScreenTextPACKT">Panel-inventory-slot (1)</span></span>.</li>
<li>Populate the <strong><span class="KeyWordPACKT">Element 2</span></strong> public field with the <span class="packt_screen">GameObject <span class="ScreenTextPACKT">Panel-inventory-slot (2)</span></span><span class="ScreenTextPACKT">:</span></li>
</ul>
</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/a27617fe-ad95-4be5-a3cb-da340e4b4b39.png"/></div>
<ol start="18">
<li>Finally, make two more copies of GameObject <span class="ScreenTextPACKT"><span class="packt_screen">star</span></span> in the scene and move them around. So, there are now three GameObjects tagged <span class="ScreenTextPACKT"><span class="packt_screen">Star</span></span> for the player to collect.</li>
<li>When you run the game and the player's character hits each <span class="ScreenTextPACKT"><span class="packt_screen">star</span></span> GameObject, it should be removed from the scene, and the next free inventory star icon should change from grey to yellow.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>We have created a panel (<span class="ScreenTextPACKT"><span class="packt_screen">Panel-stars</span></span>) in which to display the large title text Stars and three inventory slot panels to show how many stars can be collected, and how many have been collected at any point in the game. Each star panel-slot is a <strong>UI Panel</strong> with a circular Knob background image, and then two children, one showing a grey icon image and a second showing a colored icon image. When the colored icon image GameObject is disabled it will be hidden, and so reveal the grey icon. When both colored and grey images are disabled, then an empty circle will be shown, which could, perhaps, be used to indicate to the user that a general-purpose location is empty and available in the inventory.</p>
<p>The script class <kbd><span class="CodeInTextPACKT">PickupUI</span></kbd> has two public variables that are references to the grey and colored icon for the GameObject it relates to. Before the scene starts (method <kbd><span class="CodeInTextPACKT">Awake()</span></kbd>), the script hides the grey and colored icons and displays an empty circle. This script class declares three public methods (public so that they can be invoked from another scripted object when the game is running). These methods hide/reveal the appropriate icons to display the related inventory panel UI object as either empty, grey, or colored. The methods are clearly named <kbd><span class="CodeInTextPACKT">DisplayEmpty()</span></kbd>, <span class="CodeInTextPACKT"><kbd>DisplayGreyIcon(</kbd>),</span> and <kbd><span class="CodeInTextPACKT">DisplayColorIcon()</span></kbd>.</p>
<p>The script class <kbd><span class="CodeInTextPACKT">PlayerInventory</span></kbd> maintains an integer total <kbd><span class="CodeInTextPACKT">starTotal</span></kbd> of how many stars have been collected (initialized to zero). Each time the player character collides with an object, then if that object is tagged <span class="ScreenTextPACKT">Star,</span> the method <kbd><span class="CodeInTextPACKT">AddStar()</span></kbd> is invoked. This method increments the total and sends a message <span>passing the new total </span>to method<span> </span><kbd><span class="CodeInTextPACKT">OnChangeStarTotal(...)</span></kbd> of its sibling scripted component <kbd><span class="CodeInTextPACKT">PlayerInventoryDisplay</span></kbd> .</p>
<p>The script-class <kbd><span class="CodeInTextPACKT">PlayerInventoryDisplay</span></kbd> has a public array of references to <span class="ScreenTextPACKT"><span class="packt_screen">PickupUI</span></span> objects, and the single public method <kbd><span class="CodeInTextPACKT">OnChangeStarTotal(...)</span></kbd>. This method loops through its array of <span class="ScreenTextPACKT"><span class="packt_screen">PickupUI</span></span> scripted objects, setting them to display color icons while the loop counter is less than the number of stars carried, and thereafter setting them to display grey icons. This results in the color icons being displayed to match the number of stars being carried.</p>
<div class="packt_infobox">Note: It might seem that we could make our code simpler by assuming that slots are always displaying grey (no star) and just changing one slot to yellow each time a yellow star is picked up. But this would lead to problems if something happens in the game (for example, hitting a black hole or being shot by an alien) that makes us drop one or more stars. The C# script class PlayerInventoryDisplay makes no assumptions about which slots may or may not have been displayed grey or yellow or empty previously. Each time it is called, it ensures that an appropriate number of yellow stars are displayed, and all other slots are displayed with grey stars.</div>
<p>The UI Panel GameObjects slots for the three stars have a PickupUI scripted component added, and each is linked to its grey and colored icons.</p>
<p>Several star GameObjects are added to the scene (all tagged <span class="ScreenTextPACKT">Star</span>). The array of PickupUI object references in the <kbd><span class="CodeInTextPACKT">PlayerInventoryDisplay</span></kbd> scripted component in GameObject player-SpaceGirl is populated with references to the PickupUI scripted components in the three the UI Panels for each star.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">There's more...</h1>
                </header>
            
            <article>
                
<p>Here are some details you won't want to miss.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Modifying the game for a second inventory panel for keys</h1>
                </header>
            
            <article>
                
<p>We have created a great display panel for the collection of star objects. Now we can reuse that work, to create a second panel to display the collection of key objects in the game.</p>
<p>To modify the game to make a second inventory panel for key collection, do the following:</p>
<ol>
<li>Duplicate GameObject <span class="ScreenTextPACKT"><span class="packt_screen">Panel-stars</span></span>, naming the copy <span class="ScreenTextPACKT"><span class="packt_screen">Panel-keys</span></span>.</li>
<li>With Panel-keys selected in the Hierarchy, do the following:
<ul>
<li>Change the <strong><span class="KeyWordPACKT">Text (Script)</span></strong> of child <strong><span class="KeyWordPACKT">Text-title</span></strong> from <span class="ScreenTextPACKT"><span class="packt_screen">Stars</span></span> to <span class="ScreenTextPACKT"><span class="packt_screen">Keys</span></span>.</li>
<li>In the <span class="KeyWordPACKT"><strong>Rect Transform</strong>,</span> choose top-right, set <span class="KeyWordPACKT"><span class="packt_screen">Pos X</span></span> to <span class="ScreenTextPACKT">-10</span> (to move away from the right edge) and <span class="KeyWordPACKT"><span class="packt_screen">Pos Y</span></span> to <span class="ScreenTextPACKT">-30</span> (to vertically align with <span class="KeyWordPACKT">Panel-keys</span>).</li>
<li>For each <span class="KeyWordPACKT">Image-icon-grey</span> GameObject that is a child of all three panel-inventory-slots, change the <span class="KeyWordPACKT"><strong>Image (Script)</strong> Source Image</span> to: <span class="ScreenTextPACKT"><span class="packt_screen">icon_key_grey_100</span>.</span></li>
<li>For each <span class="KeyWordPACKT">Image-icon-color</span> GameObject that is a child of all three panel-inventory-slots, change the <span class="KeyWordPACKT"><strong>Image (Script)</strong> Source Image</span> to: <span class="ScreenTextPACKT"><span class="packt_screen">icon_key_green_100</span>.</span></li>
<li>For all of the <strong><span class="KeyWordPACKT">Image-icon-grey</span></strong> GameObjects and the <span class="KeyWordPACKT">Image-icon-color</span> GameObjects that are children of all three panel-inventory-slots, in the <strong>Rect Transform</strong> set the <span class="KeyWordPACKT">Scale</span> to <span class="ScreenTextPACKT">(<span class="packt_screen">0.75, 0.75, 1)</span></span>. This is to make the key images fit fully inside the background panel circle images.</li>
</ul>
</li>
<li><span class="ScreenTextPACKT"><span>Remove from GameObject <span class="packt_screen">player-SpaceGirl</span> script components: <span class="packt_screen">PlayerInventory</span> and <span class="packt_screen">PlayerInventoryDisplay</span>.</span></span></li>
<li>Create the following C# Script <span class="CodeInTextPACKT">PlayerInventoryKeys</span> in the <kbd>_Scripts</kbd> folder:</li>
</ol>
<pre style="padding-left: 60px">using UnityEngine; 

public class PlayerInventoryKeys : MonoBehaviour { 
   private int starTotal = 0; 
   private int keyTotal = 0; 
   private PlayerInventoryDisplayKeys playerInventoryDisplay; 

   void Awake() { 
         playerInventoryDisplay = GetComponent&lt;PlayerInventoryDisplayKeys&gt;(); 
   } 

   void Start() { 
         playerInventoryDisplay.OnChangeStarTotal(starTotal); 
         playerInventoryDisplay.OnChangeKeyTotal(keyTotal); 
   } 

   void OnTriggerEnter2D(Collider2D hit) { 
         if(hit.CompareTag("Star")){ 
               AddStar(); 
               Destroy(hit.gameObject); 
         } 
 
         if(hit.CompareTag("Key")){ 
               AddKey(); 
               Destroy(hit.gameObject); 
         } 
   } 

   private void AddStar() { 
         starTotal++; 
         playerInventoryDisplay.OnChangeStarTotal(starTotal); 
   } 

   private void AddKey() { 
         keyTotal++; 
         playerInventoryDisplay.OnChangeKeyTotal(keyTotal); 
   } 
} </pre>
<ol start="5">
<li>Add the following C# script <kbd><span class="CodeInTextPACKT">PlayerInventoryDisplayKeys</span></kbd> to GameObject <span class="ScreenTextPACKT"><span class="packt_screen">player-SpaceGirl</span></span> in the <strong><span class="KeyWordPACKT">Hierarchy</span></strong>:</li>
</ol>
<pre style="padding-left: 60px">using UnityEngine; 

[RequireComponent(typeof(PlayerInventoryKeys))] 
public class PlayerInventoryDisplayKeys : MonoBehaviour  { 
   public PickupUI[] slotsStars = new PickupUI[1]; 
   public PickupUI[] slotsKeys = new PickupUI[1]; 

   public void OnChangeStarTotal(int starTotal) { 
         int numInventorySlots = slotsStars.Length; 
         for(int i = 0; i &lt; numInventorySlots; i++){ 
               PickupUI slot = slotsStars[i]; 
               if(i &lt; starTotal) 
                     slot.DisplayColorIcon(); 
               else 
                     slot.DisplayGreyIcon(); 
         } 
   } 

   public void OnChangeKeyTotal(int keyTotal) { 
         int numInventorySlots = slotsKeys.Length; 
         for(int i = 0; i &lt; numInventorySlots; i++){ 
               PickupUI slot = slotsKeys[i]; 
               if(i &lt; keyTotal) 
                     slot.DisplayColorIcon(); 
               else 
                     slot.DisplayGreyIcon(); 
         } 
   } 
}</pre>
<ol start="6">
<li>With the GameObject <span class="ScreenTextPACKT"><span class="packt_screen">player-SpaceGirl</span></span> selected in the <strong><span class="KeyWordPACKT">Hierarchy</span></strong>, for its <span class="ScreenTextPACKT"><span class="packt_screen">PlayerInventoryDisplayKeys</span></span> scripted component, set both <span class="ScreenTextPACKT"><span class="packt_screen">slotsKeys</span></span> and <span class="ScreenTextPACKT"><span class="packt_screen">slotsStars</span></span> to 3 (making the size of each of these arrays 3). Then drag the corresponding inventory-slot GameObjects from the Hierarchy to populate these arrays.</li>
<li>Create a new GameObject <span class="ScreenTextPACKT"><span class="packt_screen">key</span></span> by dragging a copy of the sprite image <span class="ScreenTextPACKT"><span class="packt_screen">icon-key-green-100</span></span> from the <strong><span class="KeyWordPACKT">Project</span></strong> panel into the scene. Then add a <strong><span class="KeyWordPACKT">Box Collider</span></strong> component (<strong><span class="KeyWordPACKT">Physics 2</span>D</strong>) and tick its <span class="ScreenTextPACKT"><span class="packt_screen">Is Trigger</span></span> setting. In its <strong><span class="KeyWordPACKT">Sprite Renderer</span></strong> component, set the <span class="KeyWordPACKT">Sorting Layer</span> to <span class="KeyWordPACKT">Foreground</span>. Create a new <span class="KeyWordPACKT"><strong>Tag</strong>:</span> <span class="ScreenTextPACKT"><span class="packt_screen">Key</span></span>, and add this tag to this GameObject.</li>
<li>Make two duplicates of GameObject <span class="ScreenTextPACKT">key</span>, moving them to different locations in the scene (so the player can see all three stars and all three keys).</li>
</ol>
<p>As you can see, we have duplicated and adjusted the visual <span class="KeyWordPACKT">UI Panel</span> and components of for star carrying inventory to give us a second one for key carrying inventory. Likewise, we have added code to detect collisions with objects tagged <span class="ScreenTextPACKT">Key</span>, and added to the inventory display script to update the UI Panel for keys when notified that a change has occurred in the number of keys being carried.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Using UI Grid Layout Groups to automatically populate a panel</h1>
                </header>
            
            <article>
                
<p>The recipes in this chapter up to this point have been hand-crafted for each situation. While this is fine, more general and automated approaches to inventory UIs can sometimes save time and effort but still achieve visual and usability results of equal quality.</p>
<p>There can be a lot of dragging slots from the <strong><span class="ScreenTextPACKT">Hierarchy</span></strong> panel into arrays, such as in the previous recipe for the scripted component <kbd><span class="CodeInTextPACKT">PlayerInventoryDisplay</span></kbd>. This takes a bit of work (and mistakes might be made when dragging items in the wrong order or the same item twice). Also, if we change the number of slots, then we may have to do this all over again or try to remember to drag more slots if we increase the number. A better way of doing things is to make the first task of the script class <kbd><span class="CodeInTextPACKT">PlayerInventoryDisplay</span></kbd> when the scene begins to create at <strong>R<span class="KeyWordPACKT">un-Time</span></strong> as many as required of the panels for grey-color star (or key or whatever) icon GameObjects as children of <span class="CodeInTextPACKT">Panel-slot-grid</span>, and then populate the array of the display scripted component at the same time.</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/a6686d9a-4236-4253-9ef5-006f2b585f64.png" style="width:18.92em;height:4.25em;"/></div>
<div class="CDPAlignCenter CDPAlign"/>
<p>In this recipe, we will begin to explore a more engineered approach to inventory UIs by exploiting the automated sizing and layouts offered by Unity's Grid Layout Group component. Some enhancements at the end of this recipe include adding an interactive scrollbar, as show in the screenshot.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>This recipe adapts the previous one. So, make a copy of the project for the previous recipe, and work on this copy.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<p>To automatically populate a panel using UI Grid Layout Groups to follow these steps:</p>
<ol>
<li>Create a new folder named <span class="CodeInTextPACKT">Prefabs</span>. In this folder, create a new empty prefab named <span class="CodeInTextPACKT">panel-inventory-slot</span>.</li>
<li>From the <strong><span class="ScreenTextPACKT">Hierarchy</span></strong> panel<span class="ScreenTextPACKT">,</span> drag the GameObject <span class="ScreenTextPACKT"><span class="packt_screen">Panel-inventory-slot</span></span> into your new empty prefab named <span class="ScreenTextPACKT">panel-inventory-slot</span>. This prefab should now turn blue, showing it is populated.</li>
<li>In the <strong><span class="ScreenTextPACKT">Hierarchy</span></strong> panel<span class="ScreenTextPACKT">,</span> delete the three GameObjects <span class="ScreenTextPACKT"><span class="packt_screen">Panel-inventory-slot / (1) / (2)</span></span>.</li>
<li>Un-child <span class="KeyWordPACKT">Text-title</span> from <span class="KeyWordPACKT">Panel-stars</span>. Set the <span class="KeyWordPACKT"><span class="packt_screen">Pos-X</span></span> position of <strong><span class="KeyWordPACKT">Panel-stars</span></strong>. To 130 - so that the panel is now to the right of the text <span class="ScreenTextPACKT">Stars</span>.</li>
</ol>
<ol start="5">
<li>With the panel <span class="CodeInTextPACKT">Panel-stars</span> selected in the <span class="ScreenTextPACKT">Hierarchy</span> panel, add a grid layout group component (<strong><span class="ScreenTextPACKT">Add Component</span></strong> | <strong><span class="ScreenTextPACKT">Layout</span></strong> | <strong><span class="ScreenTextPACKT">Grid Layout Group</span></strong>). Set <strong><span class="ScreenTextPACKT">Cell Size</span></strong> to <kbd><span class="CodeInTextPACKT">50</span> x <span class="CodeInTextPACKT">50</span></kbd> and <span class="ScreenTextPACKT">Spacing</span> to <kbd><span class="CodeInTextPACKT">5</span> x <span class="CodeInTextPACKT">5</span></kbd>. Also, set the <strong><span class="ScreenTextPACKT">Child Alignment</span></strong> to <span class="packt_screen"><span class="ScreenTextPACKT">Middle Center</span></span> (so our icons will have even spacing at the far left and right), as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/2e21a36d-acf0-42c1-b3e4-ddd7eddde586.png"/></div>
<ol start="6">
<li>Replace the C# script <kbd><span class="CodeInTextPACKT">PlayerInventoryDisplay</span></kbd> in GameObject <span class="ScreenTextPACKT"><span class="packt_screen">player-SpaceGirl</span></span> with the following code:</li>
</ol>
<pre style="padding-left: 60px">using UnityEngine; 
using System.Collections; 
using UnityEngine.UI; 

[RequireComponent(typeof(PlayerInventory))] 
public class PlayerInventoryDisplay : MonoBehaviour  { 
   const int NUM_INVENTORY_SLOTS = 5; 
   public GameObject panelSlotGrid; 
   public GameObject starSlotPrefab; 
   private PickupUI[] slots = new PickupUI[NUM_INVENTORY_SLOTS]; 

   void Awake() {
         float width = 50 + (NUM_INVENTORY_SLOTS * 50); 
         panelSlotGrid.GetComponent&lt;RectTransform&gt;().SetSizeWithCurrentAnchors( RectTransform.Axis.Horizontal, width ); 
 
         for(int i=0; i &lt; NUM_INVENTORY_SLOTS; i++){ 
               GameObject starSlotGO = (GameObject) 
               Instantiate(starSlotPrefab); 
               starSlotGO.transform.SetParent(panelSlotGrid.transform); 
               starSlotGO.transform.localScale = new Vector3(1,1,1); 
               slots[i] = starSlotGO.GetComponent&lt;PickupUI&gt;(); 
         } 
   } 

   public void OnChangeStarTotal(int starTotal) { 
         for(int i = 0; i &lt; NUM_INVENTORY_SLOTS; i++){ 
               PickupUI slot = slots[i]; 
               if(i &lt; starTotal) 
                     slot.DisplayColorIcon(); 
               else 
                     slot.DisplayGreyIcon(); 
         } 
   } 
} </pre>
<ol start="7">
<li>Ensure GameObject <strong><span class="packt_screen"><span class="ScreenTextPACKT">pla</span><span class="ScreenTextPACKT">yer-girl1</span></span> </strong>is selected in the <strong><span class="ScreenTextPACKT">Hierarchy.</span></strong> Then drag from the <strong>Project</strong> panel GameObject <strong><span class="ScreenTextPACKT"><span class="packt_screen">Panel-stars</span></span></strong> into the <strong><span class="ScreenTextPACKT">Player Inventory Display (Script)</span></strong> variable <strong><span class="ScreenTextPACKT"><span class="packt_screen">Panel-slot-grid</span></span></strong>, in the <strong><span class="ScreenTextPACKT">Inspector</span></strong>.</li>
<li>With GameObject <span class="ScreenTextPACKT"><span class="packt_screen">player-girl1</span></span> <span>selected in the <strong><span class="ScreenTextPACKT">Hierarchy</span></strong>, drag from the <strong><span class="ScreenTextPACKT">Project</span></strong></span> panel prefab <span class="packt_screen"><span class="ScreenTextPACKT">panel-inventory-slot</span></span> <span>into <strong><span class="ScreenTextPACKT">Player Inventory Display (Script)</span></strong> the variable <span class="ScreenTextPACKT"><span class="packt_screen">Star Slot Prefab</span></span>, in the <span class="ScreenTextPACKT"><span class="packt_screen">Inspector</span></span></span>. Steps 7 and 8 are illustrated in this screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/b8eacab9-2256-4253-86be-776158d1e19b.png" style="width:38.92em;height:22.33em;"/></div>
<ol start="9">
<li>Edit the script class <kbd><span class="CodeInTextPACKT">PlayerInventoryDisplay</span></kbd> to set the constant <kbd><span class="CodeInTextPACKT">NUM_INVENTORY_SLOTS</span></kbd> to have 10 or 15 slots. So some can only be seen when using the horizontal scroll bar.</li>
<li>Save the scene and play the game. As you pick up stars, you should see more of the grey stars change to yellow in the inventory display.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>We took one of the panels that contained the <span class="ScreenTextPACKT"><span class="packt_screen">Knob</span></span> circle background, and children GameObjects of grey and colored star images, and used it to create a <strong><span class="KeyWordPACKT">Prefab</span></strong> <span class="ScreenTextPACKT"><span class="packt_screen">panel-inventory-slot</span></span>. We then removed the star panel GameObjects from the scene since our script class <span class="ScreenTextPACKT">PlayerInventoryDisplay</span> will create as many of these as needed when the scene begins. This approach saves a lot of drag and dropping, saving <strong>D<span class="KeyWordPACKT">esign-Time</span></strong> effort, and eliminating one possible source of sequence/object reference errors when the design of a scene is changed.</p>
<p>The C# script class <kbd><span class="CodeInTextPACKT">PlayerInventoryDisplay</span></kbd> has two properties:</p>
<ul>
<li>A constant integer (<kbd><span class="CodeInTextPACKT">NUM_INVENTORY_SLOTS</span></kbd>) defining the number of slots in our inventory, which for this game we set to 5.</li>
<li><span>A</span> <kbd>(<span class="CodeInTextPACKT">slots</span>)</kbd> <span>array </span>of references to <kbd><span class="CodeInTextPACKT">PickupUI</span></kbd> scripted components. Each of these will become a reference to the scripted component in each of the five <kbd><span class="CodeInTextPACKT">Panel-inventory-slot</span></kbd> GameObjects in our <kbd><span class="CodeInTextPACKT">Panel-stars</span></kbd>.</li>
</ul>
<p>The <kbd><span class="CodeInTextPACKT">Awake()</span></kbd> <span class="CodeInTextPACKT">method</span> is used to create instances of the prefab in <kbd><span class="CodeInTextPACKT">PlayerInventoryDispay</span></kbd> so that we know this will be executed before the <kbd><span class="CodeInTextPACKT">Start()</span></kbd> method in <kbd><span class="CodeInTextPACKT">PlayerInventory</span></kbd> since no <kbd><span class="CodeInTextPACKT">Start()</span></kbd> method is executed in a scene until all <kbd><span class="CodeInTextPACKT">Awake()</span></kbd> methods for all GameObjects in the scene have been completed. The <kbd><span class="CodeInTextPACKT">Awake()</span></kbd> method first calculates the width of the <span class="ScreenTextPACKT"><span class="packt_screen">Panel-stars</span></span> (50 + (50 * number of inventory slots)). Next, the panel is resized to have that width, using the <kbd><span class="CodeInTextPACKT">SetSizeWithCurrentAnchors()</span></kbd> method. Then a loop runs for the number of slots in the inventory, each time creating a new star slot GameObject from the prefab, childing the new GameObject to <span class="ScreenTextPACKT"><span class="packt_screen">Panel-stars</span></span>, and adding a reference to the icon slot GameObject in array <span class="CodeInTextPACKT">slots</span>. When the <kbd><span class="CodeInTextPACKT">OnChangeStarTotal(...)</span></kbd> method is passed the number of stars we are carrying, it loops through each of the five slots. While the current slot is less than our star total, a yellow star is displayed by the calling of the <kbd><span class="CodeInTextPACKT">DisplayYellow()</span></kbd> method of the current slot (<span class="CodeInTextPACKT">PickupUI</span> scripted component). Once the loop counter is equal to or larger than our star total, then all remaining slots are made to display a grey star via the method <kbd><span class="CodeInTextPACKT">DisplayGrey()</span></kbd>.</p>
<p>Our player character GameObject, <span class="CodeInTextPACKT">player-girl1,</span> has a very simple basic <kbd><span class="CodeInTextPACKT">PlayerInventory</span></kbd> script. This just detects collisions with objects tagged <span class="CodeInTextPACKT">Star</span>, and when this happens, it removes the star GameObject collided with and calls its <kbd><span class="CodeInTextPACKT">AddStar()</span></kbd> method of its <span class="CodeInTextPACKT"><kbd>playerInventoryMode</kbd>l</span> scripted component. Each time the <kbd><span class="CodeInTextPACKT">AddStar()</span></kbd> method is called, it increments (adds 1) to the total umber of stars being carried, and then calls the <kbd><span class="CodeInTextPACKT">OnChangeStarTotal(...)</span></kbd> method of the scripted component <kbd><span class="CodeInTextPACKT">playerInventoryDisplay</span></kbd>. Also, when the scene starts, an initial call is made to the <kbd><span class="CodeInTextPACKT">OnChangeStarTotal(...)</span></kbd> method so that the UI display for the inventory is set up to show that we are initially carrying no stars.</p>
<p>The public array has been made private and no longer needs to be populated through manual drag-and-drop. When you run the game, it will play just the same as before, with the population of the array of images in our inventory grid panel now automated. The <kbd><span class="CodeInTextPACKT">Awake()</span></kbd> method creates new instances of the prefab (as many as defined by constant <kbd><span class="CodeInTextPACKT">NUM_INVENTORY_SLOTS</span></kbd>) and immediately childed them to <span class="CodeInTextPACKT">Panel-slot-grid</span>. Since we have a grid layout group component, their placement is automatically neat and tidy in our panel.</p>
<div class="packt_infobox">The scale property of the transform component of GameObjects is reset when a GameObject changes its parent (to keep the child size to relative to the parent size). So, it is a good idea to always reset the local scale of GameObjects to (1,1,1) immediately after they have been childed to another GameObject. We do this in the <span class="CodeInTextPACKT">for </span>loop of <span class="CodeInTextPACKT">starSlotGO</span> immediately following the <kbd><span class="CodeInTextPACKT">SetParent(...)</span></kbd> statement.</div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">There's more...</h1>
                </header>
            
            <article>
                
<p>Here are some details you won't want to miss.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Automatically infer number of inventory slots based on number of GameObjects tagged Star</h1>
                </header>
            
            <article>
                
<p>Rather than having to manually change Integer constant <kbd><span class="CodeInTextPACKT">NUM_INVENTORY_SLOTS</span></kbd> in the script class <span class="ScreenTextPACKT"><span class="packt_screen">PlayerInventoryDisplay</span></span> to match the number of GameObjects created in the scene for the player to collect, let's have our script count how many GameObjects are tagged <span class="ScreenTextPACKT"><span class="packt_screen">Star</span></span>, and use this to size and populate our array of references to inventory UI panel slots.</p>
<p>We just need to change from a constant to a variable for our array size, and set that variable before anything else in our <kbd><span class="CodeInTextPACKT">Awake()</span></kbd> method. The statement <kbd><span class="CodeInTextPACKT">GameObject.FindGameObjectsWithTag("Star")</span></kbd> gets an array of references to all GameObjects with tag <span class="ScreenTextPACKT">Star</span>, and its length is the array size we want:</p>
<p> </p>
<ol>
<li>Replace the C# Script <kbd><span class="CodeInTextPACKT">PlayerInventoryDisplay</span></kbd> in the GameObject <span class="ScreenTextPACKT"><span class="packt_screen">player-SpaceGirl</span></span> with the following code:</li>
</ol>
<pre style="padding-left: 60px">using UnityEngine; 
using System.Collections; 
using UnityEngine.UI; 

[RequireComponent(typeof(PlayerInventory))] 
public class PlayerInventoryDisplay : MonoBehaviour  { 
   private int numInventorySlots; 
   private PickupUI[] slots; 
   public GameObject panelSlotGrid; 
   public GameObject starSlotPrefab; 

   void Awake() { 
         GameObject[] gameObjectsTaggedStar = GameObject.FindGameObjectsWithTag("Star"); 
         numInventorySlots = gameObjectsTaggedStar.Length; 
         slots = new PickupUI[numInventorySlots]; 
         float width = 50 + (numInventorySlots * 50); 
         panelSlotGrid.GetComponent&lt;RectTransform&gt;().SetSizeWithCurrentAnchors( RectTransform.Axis.Horizontal, width);  

         for(int i=0; i &lt; numInventorySlots; i++){ 
               GameObject starSlotGO = (GameObject) 
               Instantiate(starSlotPrefab); 
               starSlotGO.transform.SetParent(panelSlotGrid.transform); 
               starSlotGO.transform.localScale = new Vector3(1,1,1); 
               slots[i] = starSlotGO.GetComponent&lt;PickupUI&gt;(); 
         } 
   } 

   public void OnChangeStarTotal(int starTotal) { 
         for(int i = 0; i &lt; numInventorySlots; i++){ 
               PickupUI slot = slots[i]; 
               if(i &lt; starTotal) 
                     slot.DisplayColorIcon(); 
               else 
                     slot.DisplayGreyIcon(); 
         } 
   } 
} </pre>
<ol start="2">
<li>Add or remove some of the duplicates of GameObject <span class="ScreenTextPACKT"><span class="packt_screen">star</span></span> so the total is no longer 5.</li>
<li>Run the scene. You should see the size and contents of <span class="ScreenTextPACKT"><span class="packt_screen">Panel-star</span></span> change to match the number of GameObjects tagged <span class="ScreenTextPACKT"><span class="packt_screen">Star</span></span> when the scene begins.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Add a horizontal scrollbar to the inventory slot display</h1>
                </header>
            
            <article>
                
<p>How could we cope with many inventory slots, more than fit in the space provided? One solution is to add a scroll bar so that the user can scroll left and right, viewing five at a time, say, as shown in the following screenshot.</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/bd08f7cb-d510-4704-a666-ae4c35851bf4.png"/></p>
<p>Let's add a horizontal scroll bar to our game. This can be achieved without any C# code changes, all through the Unity 5 UI system.</p>
<p>To implement a horizontal scrollbar for our inventory display, we need to do the following:</p>
<ol>
<li>Increase the height of <span class="CodeInTextPACKT">Panel-background</span> to 110 pixels.</li>
<li>In the <strong><span class="KeyWordPACKT">Inspector</span> p</strong>anel, set the <strong><span class="KeyWordPACKT">Child Alignment</span></strong> property of component <span class="KeyWordPACKT"><strong>Grid Layout</strong> <strong>Group (Script)</strong></span> of <kbd><span class="CodeInTextPACKT">Panel-slot-grid</span></kbd> to Upper Left. Then, move this panel to the right a little so that the inventory icons are centered on screen.</li>
<li>Add a <strong><span class="KeyWordPACKT">UI Panel</span></strong> to the <strong><span class="KeyWordPACKT">Canvas</span></strong> and name it <kbd><span class="CodeInTextPACKT">Panel-scroll-container</span></kbd>, and tint it red by setting the <span class="KeyWordPACKT">Color</span> property of its <strong><span class="KeyWordPACKT">Image (Script)</span></strong> component to red.</li>
<li>In the <strong><span class="ScreenTextPACKT">Hierarchy</span></strong> panel, drag <kbd><span class="CodeInTextPACKT">Panel-slot-grid</span></kbd> so that it is now childed to <kbd><span class="CodeInTextPACKT">Panel-scroll-container</span></kbd>.</li>
</ol>
<ol start="5">
<li>Size and position <span class="CodeInTextPACKT">Panel-scroll-container</span> so that it is just behind our <span class="CodeInTextPACKT">Panel-slot-grid</span>. Set its <strong><span class="KeyWordPACKT">Rect Transform</span></strong> to top-left, <strong><span class="KeyWordPACKT">Pos X</span></strong> to 130, <strong><span class="KeyWordPACKT">Pos Y</span></strong> to -30, <strong><span class="KeyWordPACKT">Width</span></strong> to 300 and <strong><span class="KeyWordPACKT">Height</span></strong> to 60. So, you should now see a red rectangle behind the <kbd><span class="CodeInTextPACKT">Panel-slot-grid</span></kbd> inventory panel.</li>
<li>Add a <strong><span class="KeyWordPACKT">UI Mask</span></strong> to <kbd><span class="CodeInTextPACKT">Panel-scroll-container</span></kbd> so now you should only be able to see the parts of <kbd><span class="CodeInTextPACKT">Panel-slot-grid</span></kbd> that fit within the rectangle of this red-tinted panel.</li>
</ol>
<div class="packt_infobox">One workflow is to to temporarily set this mask component as inactive so that you can see and work on the unseen parts of Panel-slot-grid if required.</div>
<ol start="7">
<li>Add a <strong><span class="KeyWordPACKT">UI Scrollbar</span></strong> to the <strong><span class="KeyWordPACKT">Canvas</span></strong> and name it <span class="CodeInTextPACKT">Scrollbar-horizontal</span>. Move it to be just below the red-tinted <kbd><span class="CodeInTextPACKT">Panel-scroll-container</span></kbd>, and resize it to be the same width as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/182db6c2-84fe-4f49-8d34-059a66ab1206.png"/></div>
<ol start="8">
<li>Add a UI <strong><span class="ScreenTextPACKT">Scroll Rect</span></strong> component to <span class="CodeInTextPACKT">Panel-scroll-container</span>. Uncheck the <strong><span class="KeyWordPACKT">Vertical</span></strong> property of this <strong><span class="ScreenTextPACKT">Scroll Rect</span></strong> component.</li>
<li>In the <strong><span class="ScreenTextPACKT">Inspector</span></strong> panel, drag <span class="ScreenTextPACKT"><span class="packt_screen">Scrolbar-horizontal</span></span> to the Horizontal Scrollbar property of the <span class="ScreenTextPACKT">Scroll Rect</span> component of <span class="ScreenTextPACKT"><span class="packt_screen">Panel-scroll-container</span></span>.</li>
</ol>
<ol start="10">
<li>In the <strong><span class="ScreenTextPACKT">Inspector</span></strong> panel, drag <span class="ScreenTextPACKT"><span class="packt_screen">Panel-slot-grid</span></span> to the <strong>Content</strong> property of the <strong><span class="ScreenTextPACKT">Scroll Rect</span></strong> component of <span class="ScreenTextPACKT">Panel-scroll-container</span>, as shown in the following screenshot:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/0933e74d-c4e7-4adc-8fc0-3c74e413459d.png"/></p>
<ol start="11">
<li>Now, ensure the <span class="ScreenTextPACKT">mask</span> component of <span class="ScreenTextPACKT"><span class="packt_screen">Panel-scroll-container</span></span> is set as active so that we don't see the overflow of <span class="ScreenTextPACKT"><span class="packt_screen">Panel-slot-grid</span></span> and uncheck this <span class="ScreenTextPACKT">mask</span> components option to <strong><span class="ScreenTextPACKT">Show Mask Graphic</span></strong> (so that we don't see the red rectangle any more).</li>
</ol>
<p>You should now have a working scrollable inventory system.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Automatically changing the grid cell size based on the number of slots in the inventory</h1>
                </header>
            
            <article>
                
<p>Consider a situation where we wish to change the number of slots. An alternative to using something like scrollbars is to change the cell size in the <strong><span class="ScreenTextPACKT">Grid Layout Group</span></strong> component. We can automate this through code so that the cell size is changed to ensure that <kbd><span class="CodeInTextPACKT">NUM_INVENTORY_SLOTS</span></kbd> will fit along the width of our panel at the top of the canvas.</p>
<p>To implement the automated resizing of the <span class="ScreenTextPACKT"><strong>Grid Layout Group</strong></span> cell size for this recipe, we need to do the following:</p>
<ul>
<li>Comment-out the third statement in method <kbd><span class="CodeInTextPACKT">Awake()</span></kbd>:</li>
</ul>
<pre style="padding-left: 60px">// panelSlotGrid.GetComponent&lt;RectTransform&gt;().SetSizeWithCurrentAnchors( <br/>// RectTransform.Axis.Horizontal, width);</pre>
<ul>
<li>Add the following method <span class="CodeInTextPACKT">Start()</span> to the C# Script <span class="CodeInTextPACKT">PlayerInventoryDisplay</span> in GameObject <span class="CodeInTextPACKT">player-SpaceGirl</span> with the following code:</li>
</ul>
<pre style="padding-left: 60px">void Start() { 
  float panelWidth = panelSlotGrid.GetComponent&lt;RectTransform&gt;().rect.width; 
  print ("slotGrid.GetComponent&lt;RectTransform&gt;().rect = " + panelSlotGrid.GetComponent&lt;RectTransform&gt;().rect); 
   
  GridLayoutGroup gridLayoutGroup = panelSlotGrid.GetComponent&lt;GridLayoutGroup&gt;(); 
  float xCellSize = panelWidth / NUM_INVENTORY_SLOTS; 
  xCellSize -= gridLayoutGroup.spacing.x; 
  gridLayoutGroup.cellSize = new Vector2(xCellSize, xCellSize); 
} </pre>
<p>We write our code in the <kbd><span class="CodeInTextPACKT">Start()</span></kbd> method, rather than adding to code in the <span class="CodeInTextPACKT">Awake()</span> method, to ensure that the <kbd><span class="ScreenTextPACKT">RectTransform</span></kbd> of GameObject <span class="CodeInTextPACKT">Panel-slot-grid</span> has finished sizing (in this recipe, it stretches based on the width of the <span class="ScreenTextPACKT">Game</span> panel). While we can't know the sequence in which <strong><span class="ScreenTextPACKT">Hierarchy</span></strong> GameObjects are created when a scene begins, we can rely on the Unity behavior that every GameObject sends the <span class="CodeInTextPACKT"><kbd>Awake()</kbd> </span>message, and only after all corresponding <kbd><span class="CodeInTextPACKT">Awake()</span></kbd> methods have finished executing all objects, and then sends the <span class="CodeInTextPACKT">Start()</span> message. So, any code in the <kbd><span class="CodeInTextPACKT">Start()</span></kbd> method can safely assume that every GameObject has been initialized.</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/6e42b39d-5b56-4795-ba2b-11d31af8a0a9.png" style="width:39.58em;height:9.17em;"/></p>
<p>The screenshot above shows the value of <kbd><span class="CodeInTextPACKT">NUM_INVENTORY_SLOTS</span></kbd> having been changed to 15, and the cell size, having been corresponding, changed, so that all 15 now fit horizontally in our panel. Note that the spacing between cells is subtracted from the calculated available with divided by the number of slots <kbd>(<span class="CodeInTextPACKT">xCellSize -= gridLayoutGroup.spacing.x</span></kbd>) since that spacing is needed between each item displayed as well.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Displaying multiple pickups of different objects as a list of text via a dynamic List&lt;&gt; of scripted PickUp objects</h1>
                </header>
            
            <article>
                
<p>When working with different kinds of pickups, one approach is to use a C# <span class="KeyWordPACKT">List</span> to maintain a flexible-length data structure of the items currently in the inventory. In this recipe, we will show you how, each time an item is picked up, a new object is added to such a <span class="KeyWordPACKT">List</span> collection. An iteration through the <span class="KeyWordPACKT">List</span> is how the text display of items is generated each time the inventory changes. We introduce a very simple <span class="CodeInTextPACKT">PickUp</span> script class, demonstrating how information about a pickup can be stored in a scripted component, extracted upon collision, and stored in our <span class="KeyWordPACKT">List</span>.</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/5509c6f0-ae2d-43c5-843f-983801722e55.png"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>This recipe assumes that you are starting with the <kbd><span class="CodeInTextPACKT">Simple2Dgame_SpaceGirl</span></kbd> <span>project we </span>set up in the first recipe in this chapter. The font you need can be found in the <kbd><span class="CodeInTextPACKT">03_02</span></kbd> folder.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<p>To display inventory total text for multiple pickups of different object types, follow these steps:</p>
<ol>
<li>Start with a new copy of the <kbd><span class="CodeInTextPACKT">Simple2Dgame_SpaceGirl <span>mini-game</span></span></kbd>.</li>
<li>Edit the tags, changing S<span class="ScreenTextPACKT">tar</span> to <span class="ScreenTextPACKT">Pickup</span>. Ensure that the <span class="ScreenTextPACKT">star</span> GameObject now has the <span class="ScreenTextPACKT"><span class="packt_screen">Pickup </span></span><span>tag</span>.</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/04aa78bc-5251-4ad1-b83d-4f02763715c0.png"/></div>
<ol start="3">
<li>Add the following C# Script <strong><span class="CodeInTextPACKT">PickUp</span></strong> to the GameObject <span class="CodeInTextPACKT">star</span> in the <span class="KeyWordPACKT">Hierarchy</span>:</li>
</ol>
<pre style="padding-left: 60px">using UnityEngine; 
using System.Collections; 

public class PickUp : MonoBehaviour { 
  public string description; 
}</pre>
<ol start="4">
<li>In the <span class="KeyWordPACKT">Inspector</span>, change the description property of component <span class="KeyWordPACKT">Pick Up (Script)</span> of GameObject <span class="ScreenTextPACKT">star</span> to the text <kbd><span class="CodeInTextPACKT">star</span></kbd>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/550c9efa-2e77-4c2f-b811-f2f922175e86.png" style="width:47.75em;height:17.75em;"/></div>
<ol start="5">
<li>Select the GameObject <span class="ScreenTextPACKT">star</span> in the <span class="KeyWordPACKT">Hierarchy</span> panel and make a copy of this GameObject, renaming the copy <span class="ScreenTextPACKT">heart</span>.</li>
</ol>
<ol start="6">
<li>In the <span class="KeyWordPACKT">Inspector</span><span class="ScreenTextPACKT">,</span> change the description property of component <span class="KeyWordPACKT"><kbd>Pick Up</kbd> (Script)</span> of GameObject <span class="ScreenTextPACKT">heart</span> to the text <span class="CodeInTextPACKT">heart</span>. Also, drag the health heart image from the <span class="KeyWordPACKT">Project</span> panel (in the Sprites folder) into the <span class="KeyWordPACKT">Sprite</span> property of GameObject <span class="ScreenTextPACKT">heart</span>. The player should now see the heart image on screen for this pickup item.</li>
<li>Select the GameObject <span class="ScreenTextPACKT">star</span> in the <strong><span class="KeyWordPACKT">Hierarchy</span></strong> panel and make a copy of this GameObject, renaming the copy <span class="ScreenTextPACKT">key</span>.</li>
<li>In the <span class="KeyWordPACKT">Inspector</span><span class="ScreenTextPACKT">,</span> change the description property of component <span class="KeyWordPACKT">Pick Up (Script)</span> of GameObject <span class="ScreenTextPACKT">key</span> to the text <span class="CodeInTextPACKT">key.</span> Also, drag the <span class="CodeInTextPACKT"><kbd>icon_key_green_100</kbd> <span>image</span><span> from </span></span>the <span class="KeyWordPACKT">Project</span> panel (in the Sprites folder) into the <span class="KeyWordPACKT">Sprite</span> property of GameObject <span class="ScreenTextPACKT">key</span>. The player should now see the key image on screen for this pickup item.</li>
<li>Make another one or two copies of each pickup GameObject and arrange them around the screen, so there are two or three each of <span class="ScreenTextPACKT">star</span>, <span class="ScreenTextPACKT">heart</span>, and <span class="ScreenTextPACKT">key</span> pickup GameObjects.</li>
<li>Create the following C# Script <kbd><span class="CodeInTextPACKT">PlayerInventory</span></kbd> in the <kbd>_Scripts</kbd> folder.</li>
</ol>
<pre style="padding-left: 60px">using UnityEngine; 
using System.Collections; 
using UnityEngine.UI; 
using System.Collections.Generic; 

public class PlayerInventory : MonoBehaviour { 
   private PlayerInventoryDisplay playerInventoryDisplay; 
   private List&lt;PickUp&gt; inventory = new List&lt;PickUp&gt;(); 

   void Awake() { 
         playerInventoryDisplay = GetComponent&lt;PlayerInventoryDisplay&gt;(); 
   } 

   void Start() { 
         playerInventoryDisplay.OnChangeInventory(inventory); 
   } 

   void OnTriggerEnter2D(Collider2D hit) { 
         if(hit.CompareTag("Pickup")){ 
               PickUp item = hit.GetComponent&lt;PickUp&gt;(); 
               inventory.Add( item ); 
               playerInventoryDisplay.OnChangeInventory(inventory); 
               Destroy(hit.gameObject); 
         } 
   } 
} <q><br/></q></pre>
<ol start="11">
<li>Add a <span class="KeyWordPACKT">UI Text</span> object (<span class="KeyWordPACKT"><strong>Create</strong> | <strong>UI</strong> | <strong>Text</strong></span>). Rename it <span class="KeyWordPACKT">Text-inventory-list</span>. Change its text to <span class="packt_screen"><span class="ScreenTextPACKT">the quick brown fox jumped over the lazy dog the quick brown fox jumped over the lazy dog</span></span>, or another long list of nonsense words, to test the overflow settings you'll change in the next step.</li>
<li>In the <span class="KeyWordPACKT">Text (Script)</span> component, ensure that <strong><span class="KeyWordPACKT">Horizontal Overflow</span></strong> is set to <span class="ScreenTextPACKT">Wrap</span>, and set <strong><span class="ScreenTextPACKT">Vertical Overflow</span></strong> to <span class="KeyWordPACKT"><strong>Overflow</strong>.</span> This will ensure that the text will wrap onto a second or third line (if needed) and not be hidden if there are lots of pickups.</li>
<li>In the <strong><span class="KeyWordPACKT">Inspector</span></strong> panel, set its font to <strong><span class="KeyWordPACKT">Xolonium-Bold</span></strong> (folder <span class="CodeInTextPACKT">Fonts</span>) and set its color to yellow. For the <strong><span class="KeyWordPACKT">Alignment</span></strong> property, center the text horizontally and ensure that the text is top aligned vertically, set the <strong><span class="KeyWordPACKT">Font Size</span></strong> to <span class="CodeInTextPACKT"><kbd>28</kbd>,</span> and choose a yellow text <span class="KeyWordPACKT">Color</span>.</li>
<li>Edit its <strong><span class="KeyWordPACKT">Rect Transform</span></strong> and set its <strong><span class="KeyWordPACKT">Height</span></strong> to <span class="CodeInTextPACKT">50</span>. Then, while holding down <span class="KeyPACKT"><em>Shift</em> +</span> <span class="KeyPACKT"><em>Alt</em></span> (to set pivot and position), choose the <span class="ScreenTextPACKT">top-stretch</span> box. The text should now be positioned at the middle top of the <strong><span class="KeyWordPACKT">Game</span></strong> panel, and its width should stretch to match that of the whole panel.</li>
<li>Your text should now appear at the top of the game panel.</li>
<li>Add the following C# Script <kbd><span class="CodeInTextPACKT">PlayerInventoryDisplay</span></kbd> to GameObject <span class="ScreenTextPACKT"><span class="packt_screen">player-girl1</span></span> in the <strong><span class="KeyWordPACKT">Hierarchy</span></strong>:</li>
</ol>
<pre style="padding-left: 60px">using UnityEngine; 
using System.Collections; 
using UnityEngine.UI; 
using System.Collections.Generic; 

[RequireComponent(typeof(PlayerInventory))] 
public class PlayerInventoryDisplay : MonoBehaviour { 
   public Text inventoryText; 

   public void OnChangeInventory(List&lt;PickUp&gt; inventory) { 
         // (1) clear existing display 
         inventoryText.text = ""; 

         // (2) build up new set of items  
         string newInventoryText = "carrying: "; 
         int numItems = inventory.Count; 
         for(int i = 0; i &lt; numItems; i++){ 
               string description = inventory[i].description; 
               newInventoryText += " [" + description+ "]"; 
         } 

         // if no items in List then set string to message saying inventory is empty 
         if(numItems &lt; 1) 
               newInventoryText = "(empty inventory)"; 

         // (3) update screen display 
         inventoryText.text = newInventoryText; 
   } 
} </pre>
<ol start="17">
<li>From the <strong><span class="KeyWordPACKT">Hierar</span><span class="KeyWordPACKT">chy</span></strong>, select the GameObject <span class="ScreenTextPACKT"><span class="packt_screen">player-girl1</span></span>. Then, from the <strong><span class="KeyWordPACKT">Inspector</span></strong>, access the <strong><span class="KeyWordPACKT">Player Inventory Display (Script)</span></strong> component and populate <span class="KeyWordPACKT">the <strong>Inventory Text</strong></span> public field with the <strong><span class="KeyWordPACKT">UI Text</span></strong> object <span class="ScreenTextPACKT"><span class="packt_screen">Text-inventory-lis</span>t</span>.</li>
<li>Play the game. Each time you pick up a star or key or heart, the updated list of what you are carrying should be displayed in the form <span class="ScreenTextPACKT"><span class="packt_screen">carrying [key] [heart]</span>.</span></li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...k</h1>
                </header>
            
            <article>
                
<p>In the script class <kbd><span class="CodeInTextPACKT">PlayerInventory</span></kbd>, the variable <span class="CodeInTextPACKT">inventory</span> is a C# <span class="KeyWordPACKT">List&lt;&gt;.</span> This is a flexible data structure that can be sorted, searched, and dynamically (at runtime, when the game is being played) have items added to and removed from it. The <kbd><span class="CodeInTextPACKT">&lt;PickUp&gt;</span></kbd> in pointy brackets means that variable <span class="CodeInTextPACKT">inventory</span> will contain a list of <kbd><span class="CodeInTextPACKT">PickUp</span></kbd> objects. For this recipe, our <kbd><span class="CodeInTextPACKT">PickUp</span></kbd> class just has a single field, a string description, but we'll add more sophisticated data items in <kbd><span class="CodeInTextPACKT">PickUp</span></kbd> classes in later recipes. This variable <span class="CodeInTextPACKT">inventory</span> is initialized to be a new, empty C# List of <kbd><span class="CodeInTextPACKT">PickUp</span></kbd> objects.</p>
<p>Before the scene starts, the <kbd><span class="CodeInTextPACKT">Awake()</span></kbd> method of script class <span class="CodeInTextPACKT">Player</span> caches a reference to the <kbd><span class="CodeInTextPACKT">PlayerInventoryDisplay</span></kbd> scripted component.</p>
<p>When the scene starts the <kbd><span class="CodeInTextPACKT">Start()</span></kbd> method invokes the <kbd><span class="CodeInTextPACKT">OnChangeInventory(...)</span></kbd> method of the <kbd><span class="CodeInTextPACKT">PlayerInventoryDisplay</span></kbd> scripted component. This is so the text displayed to the user at the beginning of the scene corresponds to the initial value of the variable <span class="CodeInTextPACKT">inventory</span> (which might, for some games, not be empty. For example, a player might start a game with some money, or a basic weapon, or a map).</p>
<p>When the <kbd><span class="CodeInTextPACKT">OnTriggerEnter2D(...)</span></kbd> method detects collisions with items tagged <span class="CodeInTextPACKT">Pickup</span>, the <kbd><span class="CodeInTextPACKT">PickUp</span></kbd> object component of the item hit is added to our <span class="CodeInTextPACKT">inventory</span> list. A call is also made to the <kbd><span class="CodeInTextPACKT">OnChangeInventory(...)</span></kbd> method of <kbd><span class="CodeInTextPACKT">playerInventoryDisplay</span></kbd> to update out inventory display to the player, passing the updated <span class="CodeInTextPACKT">inventory</span> <span class="ScreenTextPACKT">List</span> as a parameter.</p>
<p>The script class <kbd><span class="CodeInTextPACKT">playerInventoryDisplay</span></kbd> has a public variable, linked to the <span class="KeyWordPACKT">UI Text</span> object <span class="ScreenTextPACKT"><span class="packt_screen">Text-inventory-list</span></span>. The <kbd><span class="CodeInTextPACKT">OnChangeInventory(...)</span></kbd> method first sets the UI text to empty, and then loops through the inventory list, building up a string of each items description in square brackets (<span class="packt_screen"><span class="ScreenTextPACKT">[key]</span>, <span class="ScreenTextPACKT">[heart]</span></span>, and so on). If there were no items in the list, then the string is set to the text <span class="CodeInTextPACKT">(empty inventory)</span>. Finally, the text property of the <strong><span class="KeyWordPACKT">UI Text</span></strong> <span class="ScreenTextPACKT"><span class="packt_screen">object Text-inventory-list</span></span> is set to the value of this string representation of what is inside the variable <span class="CodeInTextPACKT">inventory</span>.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">There's more...</h1>
                </header>
            
            <article>
                
<p>Here are some details you won't want to miss.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Order items in the inventory list alphabetically</h1>
                </header>
            
            <article>
                
<p>It would be nice to alphabetically sort the words in the <span class="CodeInTextPACKT">inventory</span> list, both for neatness and consistency (so, in a game, if we pick up a key and a heart, it will look the same regardless of the order they are picked up in), but also so that items of the same type will be listed together so that we can easily see how many of each item we are carrying.</p>
<p>To implement alphabetical sorting of the items in the <span class="CodeInTextPACKT">inventory</span> list, we need to do the following:</p>
<ol>
<li>Add the following C# code to the beginning of method <kbd><span class="CodeInTextPACKT">OnChangeInventory(...)</span></kbd> in the script class <kbd><span class="CodeInTextPACKT">PlayerInventoryDisplay</span></kbd>:</li>
</ol>
<pre style="padding-left: 60px">public void OnChangeInventory(List&lt;PickUp&gt; inventory){ 
    inventory.Sort( 
        delegate(PickUp p1, PickUp p2){ 
           return p1.description.CompareTo(p2.description); 
        } 
    ); 

   // rest of the method as before ... 
} </pre>
<ol start="2">
<li>You should now see all the items listed in alphabetic sequence.</li>
</ol>
<div class="packt_infobox">This C# code takes advantage of the C# <span class="CodeInTextPACKT">List.Sort(...)</span> method, a feature of collections whereby each item can be compared to the next, and they are swapped if in the wrong order (if the <span class="CodeInTextPACKT">CompareTo(...)</span> methods returns false). Learn more at<a href="https://msdn.microsoft.com/en-us/library/3da4abas(v=vs.110).aspx"> https://msdn.microsoft.com/en-us/library/3da4abas(v=vs.110).aspx</a>.<a href="https://msdn.microsoft.com/en-us/library/3da4abas(v=vs.110).aspx"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Displaying multiple pickups of different objects as text totals via a dynamic Dictionary&lt;&gt; of PickUp objects and enum pickup types</h1>
                </header>
            
            <article>
                
<p>While the previous recipe worked fine, any old text might have been typed into the description for a pickup or perhaps mistyped (<span class="ScreenTextPACKT"><span class="packt_screen">star</span>, <span class="packt_screen">Sstar</span>, <span class="packt_screen">starr</span></span>, and so on). A much better way of restricting game properties to one of a predefined (enumerated) list of possible values is to use C# enums. As well as removing the chance of mistyping a string, it also means that we can write code to appropriately deal with the predefined set of possible values. In this recipe, we will improve our general purpose <kbd><span class="CodeInTextPACKT">PickUp</span></kbd> class by introducing three possible pickup types (Star, Heart, and Key), and write inventory display code that counts the number of each type of pickup being carried and displays these totals via a <strong><span class="KeyWordPACKT">UI Text</span></strong> object on screen. We also switch from using a <strong><span class="KeyWordPACKT">List</span></strong> to using a <strong><span class="KeyWordPACKT">Dictionary</span></strong>, since the Dictionary data structure is designed specifically for key-value pairs, perfect for associating a numeric total with an enumerated pickup type.</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/19a086e7-1556-47f7-b1f6-2bf25d6e5daf.png" style="width:15.83em;height:4.58em;"/></div>
<p>In this recipe, we will also manage the additional complexity by separating the controller (user collection event) logic from the stored inventory data, by introducing an inventory manager scripted class. Our player controller is then simplified to just two methods (Awake, getting a reference to the inventory manager, and <kbd>OnTriggerEnter2D</kbd>, responding to collisions by communicating with the inventory manager).</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>This recipe adapts the previous one. So, make a copy of the project for the previous recipe, and work on this copy.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<p>To display multiple pickups of different objects as text totals via a dynamic <span class="CodeInTextPACKT">Dictionary</span>, follow these steps:</p>
<ol>
<li>Replace the content of the script class <kbd><span class="CodeInTextPACKT">PickUp</span></kbd> with the following code:</li>
</ol>
<pre style="padding-left: 60px">using UnityEngine; 

public class PickUp : MonoBehaviour { 
   public enum PickUpType { 
         Star, Key, Heart 
   } 

   public PickUpType type; 
} </pre>
<ol start="2">
<li>Remove the instance of the script class <kbd><span class="CodeInTextPACKT">PlayerInventory</span></kbd> from the GameObject <kbd><span class="ScreenTextPACKT">player-SpaceGirl</span></kbd>.</li>
<li>Create a new C# script class <kbd><span class="CodeInTextPACKT">PlayerController</span></kbd> containing the following code, and add an instance as a component to GameObject <kbd><span class="ScreenTextPACKT">player-gi</span><span class="ScreenTextPACKT">rl1</span></kbd>:</li>
</ol>
<pre style="padding-left: 60px">using UnityEngine; 

public class PlayerController : MonoBehaviour { 
   private InventoryManager inventoryManager; 

   void Awake() { 
         inventoryManager = GetComponent&lt;InventoryManager&gt;(); 
   } 

   void OnTriggerEnter2D(Collider2D hit) { 
         if(hit.CompareTag("Pickup")){ </pre>
<p class="mce-root" style="padding-left: 60px"><kbd>PickUp item = hit.GetComponent&lt;PickUp&gt; ();</kbd></p>
<pre style="padding-left: 60px">               inventoryManager.Add(item); 
               Destroy(hit.gameObject); 
         } 
   } 
} </pre>
<ol start="4">
<li>Replace the content of script class <kbd><span class="CodeInTextPACKT">PlayerInventoryDisplay</span></kbd> with the following code:</li>
</ol>
<pre style="padding-left: 60px">using UnityEngine; 
using UnityEngine.UI; 
using System.Collections.Generic; 

[RequireComponent(typeof(PlayerController))] 
[RequireComponent(typeof(InventoryManager))] 
public class PlayerInventoryDisplay : MonoBehaviour { 
   public Text inventoryText; 

   public void OnChangeInventory(Dictionary&lt;PickUp.PickUpType, int&gt; inventory) { 
         inventoryText.text = ""; 
         string newInventoryText = "carrying: "; 

         foreach (var item in inventory) { 
               int itemTotal = item.Value; 
               string description = item.Key.ToString(); 
               newInventoryText += " [ " + description + " " + itemTotal + " ]"; 
         } 

         int numItems = inventory.Count; 
         if (numItems &lt; 1) 
               newInventoryText = "(empty inventory)"; 

         inventoryText.text = newInventoryText; 
   } 
} </pre>
<ol start="5">
<li>Add an instance of the following C# Script <kbd><span class="CodeInTextPACKT">InventoryManager</span></kbd> to the GameObject <kbd><span class="ScreenTextPACKT">player-SpaceGirl</span></kbd> in the <span class="ScreenTextPACKT">Hierarchy</span>:</li>
</ol>
<pre style="padding-left: 60px">using UnityEngine; 
using System.Collections.Generic; 

public class InventoryManager : MonoBehaviour { 
   private PlayerInventoryDisplay playerInventoryDisplay; 
   private Dictionary&lt;PickUp.PickUpType, int&gt; items = new Dictionary&lt;PickUp.PickUpType, int&gt;(); 

   void Awake() { 
         playerInventoryDisplay = GetComponent&lt;PlayerInventoryDisplay&gt;(); 
   } 

   void Start() { 
         playerInventoryDisplay.OnChangeInventory(items); 
   } 

   public void Add(PickUp pickup) { 
         PickUp.PickUpType type = pickup.type; 
         int oldTotal = 0; 

         if(items.TryGetValue(type, out oldTotal)) 
               items[type] = oldTotal + 1; 
         else 
               items.Add (type, 1); 

         playerInventoryDisplay.OnChangeInventory(items); 
   } 
} </pre>
<ol start="6">
<li>In the <strong><span class="ScreenTextPACKT">Hierarchy</span></strong> (or <strong><span class="ScreenTextPACKT">Sce</span><span class="ScreenTextPACKT">ne</span></strong>) panel, select <em>each pickup</em> GameObject in turn, and choose from the drop-down menu its corresponding <strong><span class="ScreenTextPACKT">Type</span></strong> in the <strong><span class="ScreenTextPACKT">Inspector</span></strong> panel. As you can see, public variables that are of an <span class="CodeInTextPACKT">enum</span> type are automatically restricted to the set of possible values as a combo-box drop-down menu in the <strong><span class="ScreenTextPACKT">Inspector</span></strong> panel.</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/5bc6bcee-c71a-4fcf-b13e-46beb373366f.png"/></div>
<ol start="7">
<li>Play the game. First, you should see a message on screen stating the inventory is empty, and then as you pick up one or more items of each pickup type, you'll see text totals of each type you have collected.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>Each pickup GameObject in the scene has a scripted component of the class <kbd><span class="CodeInTextPACKT">PickUp</span></kbd>. The <kbd><span class="CodeInTextPACKT">PickUp</span></kbd> object for each <kbd><span class="CodeInTextPACKT">Pickup</span></kbd> GameObject has a single property, a pickup type, which has to be one of the enumerated set of <span class="CodeInTextPACKT"><kbd>Star</kbd>, <kbd>Key</kbd>, or <kbd>Heart</kbd></span>. The use of an enumerated type means that the value has to be one of these three listed values, so there can be no misspelling/mistyping errors that could have happened with a general text string type, as in the previous recipe.</p>
<p>Previously, the script class <span class="CodeInTextPACKT"><kbd>PlayerInventory</kbd></span> script had two sets of responsibilities:</p>
<ul>
<li>Maintain the internal record of items being carried</li>
<li>Detect collisions, update the state, and ask the display class to inform the player visually of the changed items being carried</li>
</ul>
<p>In this recipe, we separate these two set of responsibilities into separate script classes:</p>
<ul>
<li>The script class <span class="CodeInTextPACKT">InventoryManager</span> will maintain the internal record of items being carried (and ask the display class to inform the player visually each time there is a change to the items being carried).</li>
<li>The script class <kbd><span class="CodeInTextPACKT">Player</span></kbd> will detect collisions, and ask the <kbd><span class="CodeInTextPACKT">InventoryManager</span></kbd> to update what is being carried.</li>
</ul>
<p>The addition of this extra software layer both separates the p<span class="CodeInTextPACKT">layer</span> collision detection behavior from how the inventory is internally stored, and also prevents any single script class from becoming too complex by attempting to handle too many different responsibilities. This recipe is an example of the <span class="KeyWordPACKT">low coupling</span> of the <strong>Model-View-Controller</strong> (<strong><span>MVC</span></strong>) design pattern. We have designed our code to not rely on or make too many assumptions about other parts of the game so that the likelihood of a change in some other part of our game breaking our inventory display code is reduced. The display (view) is separated from the logical representation of what we are carrying (inventory manager model), and changes to the model are made by public methods called from the player (controller).</p>
<p>The <span class="CodeInTextPACKT">Player</span> script class gets a reference to the <span class="CodeInTextPACKT"><kbd>InventoryManager</kbd></span> component via its <span class="CodeInTextPACKT">Awake()</span> method, and each time the player's character collides with a pickup GameObject, it calls the <kbd><span class="CodeInTextPACKT">Add(...)</span></kbd> method of the inventory manager, passing the <span class="CodeInTextPACKT">PickUp</span> object of the object collided with.</p>
<p>In the script class <span class="CodeInTextPACKT"><kbd>InventoryManager</kbd>,</span> the inventory being carried by the player is being represented by a C# <strong><span class="KeyWordPACKT">Dictionary</span></strong>. A Dictionary is made up of a sequence of <em>key-value pairs</em>, where the <span class="KeyWordPACKT">key</span> is one of the possible <kbd><span class="CodeInTextPACKT">PickUp.PickUpType</span></kbd> enumerated <strong>values</strong>, and the <span class="KeyWordPACKT">value</span> is an integer total of how many of that type of pickup is being carried. The Dictionary is declared stating what type will be used for a key, and then what type (or script class) will be stored as the value for that key. Here is the statement declaring our Dictionary variable items:</p>
<pre>items = new Dictionary&lt;PickUp.PickUpType, int&gt;() </pre>
<p>C# dictionaries provide a <kbd><span class="CodeInTextPACKT">TryGetValue(...)</span></kbd> method, which receives parameters of a key and is passed a reference to a variable the same data type as the value for the <span class="CodeInTextPACKT">Dictionary</span>. When the <kbd><span class="CodeInTextPACKT">Add(...)</span></kbd> method of the inventory manager is called, the type of the <span class="CodeInTextPACKT">PickUp</span> object is tested to see if a total for this type is already in <span class="CodeInTextPACKT">Dictionary</span> <span class="CodeInTextPACKT">items</span>. If an item total is found inside the <span class="CodeInTextPACKT">Dictionary</span> for the given type, then the value for this item in the <span class="CodeInTextPACKT">Dictionary</span> is incremented. If no entry is found for the given type, then a new element is added to the <span class="CodeInTextPACKT">Dictionary</span> with a total of 1.</p>
<div class="mce-root packt_infobox"><strong>TryGetValue call-by-reference parameter<br/>
<br/></strong> Note the use of the C# <kbd><span class="KeyWordPACKT">out</span></kbd> <span>keyword </span>before the parameter <kbd>oldTotal</kbd> in this statement:<br/>
<kbd>items.TryGetValue(type, out oldTotal)</kbd><br/>
indicates that a reference to the actual variable <span class="CodeInTextPACKT">oldTotal</span> is being passed to method <span class="CodeInTextPACKT"><kbd>TryGetValue(...)</kbd>,</span> not just a copy of its value. This means that the method can change the value of the variable.</div>
<p>The method returns true if an entry is found in the Dictionary for the given type, and if so, sets the value of <span class="CodeInTextPACKT">oldTotal</span> to the value against this key.</p>
<p>The last action of the <kbd><span class="CodeInTextPACKT">Add(...)</span></kbd> method is to call the <kbd><span class="CodeInTextPACKT">OnChangeInventory(...)</span></kbd> method of the <kbd><span class="CodeInTextPACKT">PlayerInventoryDisplay</span></kbd> scripted component of the player GameObject to update the text totals displayed on screen.</p>
<p>The method <kbd><span class="CodeInTextPACKT">OnChangeInventory(...)</span></kbd> of the script class <kbd><span class="CodeInTextPACKT">PlayerInventoryDisplay</span></kbd> first initializes the string variable <kbd><span class="CodeInTextPACKT">newInventoryText</span></kbd>, and then iterates through each item in the <span class="CodeInTextPACKT">Dictionary</span>, appending to <kbd><span class="CodeInTextPACKT">newInventoryText</span></kbd> a string of the type name and total for the current item. Finally, the text property of the <span class="ScreenTextPACKT">UI Text</span> object is updated with the completed text inside <span class="CodeInTextPACKT"><kbd>newInventoryText</kbd>,</span> showing the pickup totals to the player.</p>
<p>Learn more about using C# lists and dictionaries in Unity in the Unity Technologies tutorial at <a href="https://unity3d.com/learn/tutorials/modules/intermediate/scripting/lists-and-dictionaries"><span class="URLPACKT">https://unity3d.com/learn/tutorials/modules/intermediate/scripting/lists-and-dictionaries</span></a><span class="URLPACKT">.</span></p>


            </article>

            
        </section>
    </body></html>