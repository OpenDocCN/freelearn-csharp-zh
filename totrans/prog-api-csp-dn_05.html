<html><head></head><body>
  <div id="_idContainer038">
   <h1 class="chapter-number" id="_idParaDest-67">
    <a id="_idTextAnchor067">
    </a>
    <span class="koboSpan" id="kobo.1.1">
     5
    </span>
   </h1>
   <h1 id="_idParaDest-68">
    <a id="_idTextAnchor068">
    </a>
    <span class="koboSpan" id="kobo.2.1">
     Data Validation
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.3.1">
     Sending data from your API to the database only to find out that the input is invalid is unnecessarily expensive.
    </span>
    <span class="koboSpan" id="kobo.3.2">
     Far better is to test the data on the way in to make sure it meets basic criteria.
    </span>
    <span class="koboSpan" id="kobo.3.3">
     This preliminary set of tests (known as validation) examines the input data to make sure it meets the minimum criteria and that it is
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.4.1">
      formatted properly.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.5.1">
     In this chapter, you will learn
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.6.1">
      the following:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.7.1">
      How to validate
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.8.1">
       input data
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.9.1">
      How to respond to
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.10.1">
       invalid data
      </span>
     </span>
    </li>
   </ul>
   <h1 id="_idParaDest-69">
    <a id="_idTextAnchor069">
    </a>
    <span class="koboSpan" id="kobo.11.1">
     Technical requirements
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.12.1">
     For this chapter, create
    </span>
    <a id="_idIndexMarker094">
    </a>
    <span class="koboSpan" id="kobo.13.1">
     a new branch off the existing
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.14.1">
      data transfer object
     </span>
    </strong>
    <span class="koboSpan" id="kobo.15.1">
     (
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.16.1">
      DTO
     </span>
    </strong>
    <span class="koboSpan" id="kobo.17.1">
     ) branch (so that we start with valid data).
    </span>
    <span class="koboSpan" id="kobo.17.2">
     You will need
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.18.1">
      the following:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.19.1">
        Visual Studio
       </span>
      </strong>
     </span>
    </li>
    <li>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.20.1">
        AutoMapper
       </span>
      </strong>
     </span>
    </li>
    <li>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.21.1">
        FluentValidation
       </span>
      </strong>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.22.1">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.23.1">
      FluentValidation
     </span>
    </strong>
    <span class="koboSpan" id="kobo.24.1">
     library is
    </span>
    <a id="_idIndexMarker095">
    </a>
    <span class="koboSpan" id="kobo.25.1">
     a powerful tool for creating validators that we will use throughout this chapter.
    </span>
    <span class="koboSpan" id="kobo.25.2">
     You can install it in various ways, but the easiest is as a NuGet package.
    </span>
    <span class="koboSpan" id="kobo.25.3">
     You’ll also want the package for ASP.NET, as shown in
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.26.1">
       Figure 5
      </span>
     </em>
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.27.1">
       .1
      </span>
     </em>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.28.1">
      :
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer033">
     <span class="koboSpan" id="kobo.29.1">
      <img alt="Figure 5.1 – NuGet installation" src="image/B21998_05_1.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.30.1">
     Figure 5.1 – NuGet installation
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.31.1">
     You can
    </span>
    <a id="_idIndexMarker096">
    </a>
    <span class="koboSpan" id="kobo.32.1">
     find the complete documentation for
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.33.1">
      FluentValidation
     </span>
    </strong>
    <span class="koboSpan" id="kobo.34.1">
     at
    </span>
    <a href="https://docs.fluentvalidation.net/en/latest/index.html#">
     <span class="koboSpan" id="kobo.35.1">
      https://docs.fluentvalidation.net/en/latest/index.html#
     </span>
    </a>
    <span class="koboSpan" id="kobo.36.1">
     .
    </span>
    <span class="koboSpan" id="kobo.36.2">
     I will provide detailed steps as we
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.37.1">
      go along.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.38.1">
     The code files for this chapter can be found in the GitHub repository
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.39.1">
      here:
     </span>
    </span>
    <a href="https://github.com/PacktPublishing/Programming-APIs-with-C-Sharp-and-.NET/tree/main/Chapter05">
     <span class="No-Break">
      <span class="koboSpan" id="kobo.40.1">
       https://github.com/PacktPublishing/Programming-APIs-with-C-Sharp-and-.NET/tree/main/Chapter05
      </span>
     </span>
    </a>
   </p>
   <h1 id="_idParaDest-70">
    <a id="_idTextAnchor070">
    </a>
    <span class="koboSpan" id="kobo.41.1">
     Tuning your API
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.42.1">
     Now that we have the fundamentals for our program, we want to validate the data that is coming in, both to
    </span>
    <a id="_idIndexMarker097">
    </a>
    <span class="koboSpan" id="kobo.43.1">
     speed things up and to protect against malicious data.
    </span>
    <span class="koboSpan" id="kobo.43.2">
     We can do that with validation, but first, we need to make a couple of changes to give us good code to
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.44.1">
      work with.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-71">
    <a id="_idTextAnchor071">
    </a>
    <span class="koboSpan" id="kobo.45.1">
     Paging
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.46.1">
     Remember that
    </span>
    <a id="_idIndexMarker098">
    </a>
    <span class="koboSpan" id="kobo.47.1">
     we are simulating an automobile buying and selling application.
    </span>
    <span class="koboSpan" id="kobo.47.2">
     There can be literally hundreds of cars in our database.
    </span>
    <span class="koboSpan" id="kobo.47.3">
     We need to add paging to our
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.48.1">
      Get
     </span>
    </strong>
    <span class="koboSpan" id="kobo.49.1">
     endpoint so that when we get the list of vehicles, they don’t all come down at once.
    </span>
    <span class="koboSpan" id="kobo.49.2">
     This will also give us something
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.50.1">
      to validate.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.51.1">
     To facilitate this, we need to know
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.52.1">
      the following:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.53.1">
      How big the page is – that is, the number of cars on
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.54.1">
       each page
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.55.1">
      The index of the page the client wants
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.56.1">
       to see
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.57.1">
     We’ll accomplish this by modifying our
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.58.1">
      Get
     </span>
    </strong>
    <span class="koboSpan" id="kobo.59.1">
     endpoint to take two
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.60.1">
      additional parameters:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.61.1">
        pageOffset
       </span>
      </strong>
     </span>
    </li>
    <li>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.62.1">
        pageSize
       </span>
      </strong>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.63.1">
     Both of
    </span>
    <a id="_idIndexMarker099">
    </a>
    <span class="koboSpan" id="kobo.64.1">
     these are
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.65.1">
      int
     </span>
    </strong>
    <span class="koboSpan" id="kobo.66.1">
     data types, as
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.67.1">
      shown here:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.68.1">
[HttpGet]
public async Task&lt;IEnumerable&lt;Car&gt;&gt; Get([FromRoute] bool showDeleted, int pageNumber, int pageSize )</span></pre>
   <p>
    <span class="koboSpan" id="kobo.69.1">
     The first new parameter (
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.70.1">
      pageNumber
     </span>
    </strong>
    <span class="koboSpan" id="kobo.71.1">
     ) will tell
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.72.1">
      Get
     </span>
    </strong>
    <span class="koboSpan" id="kobo.73.1">
     which page it is on, and the second (
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.74.1">
      pageSize
     </span>
    </strong>
    <span class="koboSpan" id="kobo.75.1">
     ) will tell how many rows to get.
    </span>
    <span class="koboSpan" id="kobo.75.2">
     Let’s look at an example in Postman, as shown in
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.76.1">
       Figure 5
      </span>
     </em>
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.77.1">
       .2
      </span>
     </em>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.78.1">
      :
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer034">
     <span class="koboSpan" id="kobo.79.1">
      <img alt="Figure 5.2 – Paging" src="image/B21998_05_2.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.80.1">
     Figure 5.2 – Paging
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.81.1">
     Here, we have set
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.82.1">
      pageNumber
     </span>
    </strong>
    <span class="koboSpan" id="kobo.83.1">
     to
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.84.1">
      0
     </span>
    </strong>
    <span class="koboSpan" id="kobo.85.1">
     , indicating we want to start at the beginning of the list, and
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.86.1">
      pageSize
     </span>
    </strong>
    <span class="koboSpan" id="kobo.87.1">
     to
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.88.1">
      3
     </span>
    </strong>
    <span class="koboSpan" id="kobo.89.1">
     , indicating we want only three records.
    </span>
    <span class="koboSpan" id="kobo.89.2">
     As a result, the API will extract the first three records.
    </span>
    <span class="koboSpan" id="kobo.89.3">
     If we set
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.90.1">
      pageNumber
     </span>
    </strong>
    <span class="koboSpan" id="kobo.91.1">
     to
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.92.1">
      3
     </span>
    </strong>
    <span class="koboSpan" id="kobo.93.1">
     , we will get records
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.94.1">
      10
     </span>
    </strong>
    <span class="koboSpan" id="kobo.95.1">
     ,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.96.1">
      11
     </span>
    </strong>
    <span class="koboSpan" id="kobo.97.1">
     , and
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.98.1">
      12
     </span>
    </strong>
    <span class="koboSpan" id="kobo.99.1">
     (that is, start at the fourth page and get the next
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.100.1">
      three records).
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.101.1">
     One enhancement you might want to make to reduce confusion for the user is to subtract 1 from the page number to get the offset.
    </span>
    <span class="koboSpan" id="kobo.101.2">
     This will allow the user to enter Page 1 for
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.102.1">
      offset 0.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-72">
    <a id="_idTextAnchor072">
    </a>
    <span class="koboSpan" id="kobo.103.1">
     Validation
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.104.1">
     It is a best practice to validate the incoming properties on your endpoint
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.105.1">
      before
     </span>
    </em>
    <span class="koboSpan" id="kobo.106.1">
     executing the
    </span>
    <a id="_idIndexMarker100">
    </a>
    <span class="koboSpan" id="kobo.107.1">
     associated method.
    </span>
    <span class="koboSpan" id="kobo.107.2">
     This not only increases the performance of the API, but it also protects you from some forms of hacking (for
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.108.1">
      example, injection).
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.109.1">
     Our recommendation is to use the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.110.1">
      FluentValidation
     </span>
    </strong>
    <span class="koboSpan" id="kobo.111.1">
     NuGet package, which you can install as shown in the
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.112.1">
      Technical requirements
     </span>
    </em>
    <span class="koboSpan" id="kobo.113.1">
     section at the start of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.114.1">
      this chapter.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.115.1">
     Once installed, you have many options as to how to capture errors.
    </span>
    <span class="koboSpan" id="kobo.115.2">
     Let’s look at
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.116.1">
      a few.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-73">
    <a id="_idTextAnchor073">
    </a>
    <span class="koboSpan" id="kobo.117.1">
     Capturing errors
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.118.1">
     You’ll
    </span>
    <a id="_idIndexMarker101">
    </a>
    <span class="koboSpan" id="kobo.119.1">
     remember that our
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.120.1">
      Car
     </span>
    </strong>
    <span class="koboSpan" id="kobo.121.1">
     object (defined in
    </span>
    <a href="B21998_03.xhtml#_idTextAnchor038">
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.122.1">
        Chapter 3
       </span>
      </em>
     </span>
    </a>
    <span class="koboSpan" id="kobo.123.1">
     ) looks
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.124.1">
      like this:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.125.1">
public class Car
{
    public int id { get; set; }
    public string name { get; set; }
    public string mpg { get; set; }
    public string cylinders { get; set; }
    public string displacement { get; set; }
    public string horsepower { get; set; }
    public string weight { get; set; }
    public string acceleration { get; set; }
    public string model_year { get; set; }
    public string origin { get; set; }
    public string? </span><span class="koboSpan" id="kobo.125.2">is_deleted { get; set;}
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.126.1">
     Let’s also say that cars must not be deleted.
    </span>
    <span class="koboSpan" id="kobo.126.2">
     You can create a validator for that pretty quickly.
    </span>
    <span class="koboSpan" id="kobo.126.3">
     First, add a
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.127.1">
       Using
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.128.1">
      statement:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.129.1">
Using FluentValidation</span></pre>
   <p>
    <span class="koboSpan" id="kobo.130.1">
     Next, create a class that derives
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.131.1">
      from
     </span>
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.132.1">
       AbstractValidator
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.133.1">
      :
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.134.1">
public class </span><strong class="source-inline"><span class="koboSpan" id="kobo.135.1">CarDtoValidator</span></strong><span class="koboSpan" id="kobo.136.1"> : AbstractValidator&lt;Car&gt;</span></pre>
   <p>
    <span class="koboSpan" id="kobo.137.1">
     Finally, put your
    </span>
    <a id="_idIndexMarker102">
    </a>
    <span class="koboSpan" id="kobo.138.1">
     validation rules in the constructor for that class.
    </span>
    <span class="koboSpan" id="kobo.138.2">
     Each rule is created by using the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.139.1">
      RuleFor
     </span>
    </strong>
    <span class="koboSpan" id="kobo.140.1">
     keyword and a lambda expression that indicates which property you want to validate and the validation rule.
    </span>
    <span class="koboSpan" id="kobo.140.2">
     Our simple example will look
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.141.1">
      like this:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.142.1">
using Cars.Data.DTOs;
using FluentValidation;
namespace Cars.Validators
{
    public class </span><strong class="source-inline"><span class="koboSpan" id="kobo.143.1">CarDtoValidator</span></strong><span class="koboSpan" id="kobo.144.1"> : AbstractValidator&lt;CarDto&gt;
    {
        public </span><strong class="source-inline"><span class="koboSpan" id="kobo.145.1">CarDtoValidator()</span></strong><span class="koboSpan" id="kobo.146.1">
        {
            RuleFor(x =&gt; x.Is_Deleted).Equal("0");
        }
    }
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.147.1">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.148.1">
      Equal
     </span>
    </strong>
    <span class="koboSpan" id="kobo.149.1">
     operator is
    </span>
    <a id="_idIndexMarker103">
    </a>
    <span class="koboSpan" id="kobo.150.1">
     one of many that you can find on the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.151.1">
      FluentValidation
     </span>
    </strong>
    <span class="koboSpan" id="kobo.152.1">
     documentation
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.153.1">
      page:
     </span>
    </span>
    <a href="https://docs.fluentvalidation.net/en/latest/built-in-validators.html">
     <span class="No-Break">
      <span class="koboSpan" id="kobo.154.1">
       https://docs.fluentvalidation.net/en/latest/built-in-validators.html
      </span>
     </span>
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.155.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.156.1">
     We’ll test the data and then either compare it to what is valid and return an error if appropriate, or, more commonly, we’ll throw an exception if the data
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.157.1">
      fails validation.
     </span>
    </span>
   </p>
   <h3>
    <span class="koboSpan" id="kobo.158.1">
     Testing the return value
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.159.1">
     There are
    </span>
    <a id="_idIndexMarker104">
    </a>
    <span class="koboSpan" id="kobo.160.1">
     a number of ways to deal with a validation error.
    </span>
    <span class="koboSpan" id="kobo.160.2">
     One is to return an error to the calling method.
    </span>
    <span class="koboSpan" id="kobo.160.3">
     Thus, to validate a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.161.1">
      Car
     </span>
    </strong>
    <span class="koboSpan" id="kobo.162.1">
     object, conceptually you want
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.163.1">
      the following:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.164.1">
CarDto car = new CarDto();
CarDtoValidator carDtoValidator = new CarDtoValidator ();
carDtoValidator.Validate(car);</span></pre>
   <p>
    <span class="koboSpan" id="kobo.165.1">
     In our
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.166.1">
      insert
     </span>
    </strong>
    <span class="koboSpan" id="kobo.167.1">
     method, we’ll check to make sure
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.168.1">
      CarDto
     </span>
    </strong>
    <span class="koboSpan" id="kobo.169.1">
     is valid (in this case, that it is
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.170.1">
      not deleted):
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.171.1">
[HttpPost]
 public async Task&lt;ActionResult&lt;Car&gt;&gt; Insert([FromBody] CarDto 
 carAsDto)
 {
     try
     {
         if (carAsDto == null)
         {
             return BadRequest("No car was provided");
         }
         CarDtoValidator validator = new CarDtoValidator();
</span><strong class="bold"><span class="koboSpan" id="kobo.172.1">         var result = validator.Validate(carAsDto);</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.173.1">         if (!result.IsValid)</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.174.1">         {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.175.1">             return BadRequest(result.Errors);</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.176.1">         }</span></strong><span class="koboSpan" id="kobo.177.1">
         var carToInsert = _mapper.Map&lt;Car&gt;(carAsDto);
         var insertedCar = await _carService.Insert(carToInsert);
         var insertedCarDto = _mapper.Map&lt;CarDto&gt;(insertedCar);
         var location = $"https://localhost:5001/car/
         {insertedCarDto.Id}";
         return Created(location, insertedCarDto);
     }
     catch (Exception e)
     {
         return StatusCode(StatusCodes.Status500InternalServerError);
     }
 }</span></pre>
   <p>
    <span class="koboSpan" id="kobo.178.1">
     Let’s take
    </span>
    <a id="_idIndexMarker105">
    </a>
    <span class="koboSpan" id="kobo.179.1">
     a look at returning an error code for data that fails our
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.180.1">
      validation check.
     </span>
    </span>
   </p>
   <h3>
    <span class="koboSpan" id="kobo.181.1">
     Returning an error
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.182.1">
     If we
    </span>
    <a id="_idIndexMarker106">
    </a>
    <span class="koboSpan" id="kobo.183.1">
     now send
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.184.1">
      CarDto
     </span>
    </strong>
    <span class="koboSpan" id="kobo.185.1">
     to the endpoint using Postman but set
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.186.1">
      Is_Deleted
     </span>
    </strong>
    <span class="koboSpan" id="kobo.187.1">
     to
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.188.1">
      1
     </span>
    </strong>
    <span class="koboSpan" id="kobo.189.1">
     , we will get an error as shown in
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.190.1">
       Figure 5
      </span>
     </em>
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.191.1">
       .3
      </span>
     </em>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.192.1">
      :
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer035">
     <span class="koboSpan" id="kobo.193.1">
      <img alt="Figure 5.3 – Validation error" src="image/B21998_05_3.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.194.1">
     Figure 5.3 – Validation error
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.195.1">
     Notice that
    </span>
    <a id="_idIndexMarker107">
    </a>
    <span class="koboSpan" id="kobo.196.1">
     the return HTTP value is
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.197.1">
      400 – Bad Request
     </span>
    </strong>
    <span class="koboSpan" id="kobo.198.1">
     .
    </span>
    <span class="koboSpan" id="kobo.198.2">
     This makes sense as the DTO passed in was
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.199.1">
      not valid.
     </span>
    </span>
   </p>
   <h3>
    <span class="koboSpan" id="kobo.200.1">
     Adding a custom message
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.201.1">
     This input is
    </span>
    <a id="_idIndexMarker108">
    </a>
    <span class="koboSpan" id="kobo.202.1">
     great and provides a lot of information, but the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.203.1">
      1
     </span>
    </strong>
    <span class="koboSpan" id="kobo.204.1">
     value that is in the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.205.1">
      Is_Deleted
     </span>
    </strong>
    <span class="koboSpan" id="kobo.206.1">
     field has meaning; specifically that the record is already deleted.
    </span>
    <span class="koboSpan" id="kobo.206.2">
     This fails the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.207.1">
      validation check.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.208.1">
     We can make the error clearer with a custom message.
    </span>
    <span class="koboSpan" id="kobo.208.2">
     Return to
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.209.1">
      CarDtoValidator
     </span>
    </strong>
    <span class="koboSpan" id="kobo.210.1">
     and modify the rule
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.211.1">
      as follows:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.212.1">
RuleFor(x =&gt; x.Is_Deleted).Equal("0").</span><strong class="bold"><span class="koboSpan" id="kobo.213.1">WithMessage</span></strong><span class="koboSpan" id="kobo.214.1">("Car must not be deleted");</span></pre>
   <p>
    <span class="koboSpan" id="kobo.215.1">
     You can see a new error message in
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.216.1">
       Figure 5
      </span>
     </em>
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.217.1">
       .4
      </span>
     </em>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.218.1">
      :
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer036">
     <span class="koboSpan" id="kobo.219.1">
      <img alt="Figure 5.4 – Custom error message" src="image/B21998_05_4.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.220.1">
     Figure 5.4 – Custom error message
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.221.1">
     Custom
    </span>
    <a id="_idIndexMarker109">
    </a>
    <span class="koboSpan" id="kobo.222.1">
     messages provide vital information to your client.
    </span>
    <span class="koboSpan" id="kobo.222.2">
     They help avoid confusion and make immediately clear what is wrong with the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.223.1">
      submitted data.
     </span>
    </span>
   </p>
   <h3>
    <span class="koboSpan" id="kobo.224.1">
     Chaining
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.225.1">
     If you
    </span>
    <a id="_idIndexMarker110">
    </a>
    <span class="koboSpan" id="kobo.226.1">
     want to validate more than one aspect of a property, you can chain tests using the
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.227.1">
       dot
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.228.1">
      operator:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.229.1">
RuleFor(x=&gt; x.Is_Deleted).NotEmpty().Equal("0").WithMessage("Car must not be deleted");</span></pre>
   <p>
    <span class="koboSpan" id="kobo.230.1">
     This test ensures that the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.231.1">
      Is_Deleted
     </span>
    </strong>
    <span class="koboSpan" id="kobo.232.1">
     field is not empty and also verifies that its value is equal to
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.233.1">
      0
     </span>
    </strong>
    <span class="koboSpan" id="kobo.234.1">
     , and returns an error message if the submitted value is
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.235.1">
      not valid.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.236.1">
     The default is that even if the first test (
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.237.1">
      NotEmpty
     </span>
    </strong>
    <span class="koboSpan" id="kobo.238.1">
     ) fails, the second test will run (
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.239.1">
      Equal("0"
     </span>
    </strong>
    <span class="koboSpan" id="kobo.240.1">
     ).
    </span>
    <span class="koboSpan" id="kobo.240.2">
     You can prevent this by
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.241.1">
      using
     </span>
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.242.1">
       CascadeMode
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.243.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.244.1">
     If you do not want the second test (
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.245.1">
      NotEmpty
     </span>
    </strong>
    <span class="koboSpan" id="kobo.246.1">
     ) to run if the first test (
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.247.1">
      Is_Deleted
     </span>
    </strong>
    <span class="koboSpan" id="kobo.248.1">
     ) fails, use
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.249.1">
      CascadeMode.Stop
     </span>
    </strong>
    <span class="koboSpan" id="kobo.250.1">
     as
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.251.1">
      shown here:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.252.1">
RuleFor(x=&gt; x.Is_Deleted)</span><strong class="bold"><span class="koboSpan" id="kobo.253.1">.Cascade(CascadeMode.Stop).</span></strong><span class="koboSpan" id="kobo.254.1">NotEmpty().Equal("0").WithMessage("Car must not be deleted");</span></pre>
   <p>
    <span class="koboSpan" id="kobo.255.1">
     This now
    </span>
    <a id="_idIndexMarker111">
    </a>
    <span class="koboSpan" id="kobo.256.1">
     works like
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.257.1">
      &amp;&amp;
     </span>
    </strong>
    <span class="koboSpan" id="kobo.258.1">
     in C# – that is, if the first test fails the second is never evaluated.
    </span>
    <span class="koboSpan" id="kobo.258.2">
     The two values for
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.259.1">
      CascadeMode
     </span>
    </strong>
    <span class="koboSpan" id="kobo.260.1">
     are
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.261.1">
      Stop
     </span>
    </strong>
    <span class="koboSpan" id="kobo.262.1">
     and
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.263.1">
      Continue
     </span>
    </strong>
    <span class="koboSpan" id="kobo.264.1">
     , with the latter being
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.265.1">
      the default.
     </span>
    </span>
   </p>
   <h3>
    <span class="koboSpan" id="kobo.266.1">
     Throwing an exception
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.267.1">
     As an
    </span>
    <a id="_idIndexMarker112">
    </a>
    <span class="koboSpan" id="kobo.268.1">
     alternative to validating and then checking the result, you can call
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.269.1">
      ValidateAndThrow
     </span>
    </strong>
    <span class="koboSpan" id="kobo.270.1">
     .
    </span>
    <span class="koboSpan" id="kobo.270.2">
     With this terser expression each of your rules will be evaluated, and if one fails, an exception will
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.271.1">
      be thrown:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.272.1">
CarDtoValidator validator = new CarDtoValidator();
//var result = validator.Validate(carAsDto);
//if (!result.IsValid)
//{
//    return BadRequest(result.Errors);
//}
</span><strong class="bold"><span class="koboSpan" id="kobo.273.1">validator.ValidateAndThrow(carAsDto);</span></strong></pre>
   <p>
    <span class="koboSpan" id="kobo.274.1">
     The exception that is thrown is of type
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.275.1">
      ValidationException
     </span>
    </strong>
    <span class="koboSpan" id="kobo.276.1">
     , so you can test for that in your
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.277.1">
      catch
     </span>
    </strong>
    <span class="koboSpan" id="kobo.278.1">
     blocks.
    </span>
    <span class="koboSpan" id="kobo.278.2">
     In addition, that exception has an
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.279.1">
      Errors
     </span>
    </strong>
    <span class="koboSpan" id="kobo.280.1">
     property, which has the error message for your
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.281.1">
      failed attempt.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.282.1">
     In the next code snippet, you can see how to set up to throw an exception if the validation fails.
    </span>
    <span class="koboSpan" id="kobo.282.2">
     We create the validator and then call
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.283.1">
      ValidateAndThrow
     </span>
    </strong>
    <span class="koboSpan" id="kobo.284.1">
     , passing in the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.285.1">
      Dto
     </span>
    </strong>
    <span class="koboSpan" id="kobo.286.1">
     object.
    </span>
    <span class="koboSpan" id="kobo.286.2">
     You
    </span>
    <a id="_idIndexMarker113">
    </a>
    <span class="koboSpan" id="kobo.287.1">
     can then catch that exception and examine
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.288.1">
      the errors:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.289.1">
try
{
    if (carAsDto == null)
    {
        return BadRequest("No car was provided");
    }
    CarDtoValidator validator = new CarDtoValidator();
    </span><strong class="bold"><span class="koboSpan" id="kobo.290.1">validator.ValidateAndThrow(carAsDto);</span></strong><span class="koboSpan" id="kobo.291.1">
   //…
}
</span><strong class="bold"><span class="koboSpan" id="kobo.292.1">catch(ValidationException e)</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.293.1">{</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.294.1">    IEnumerable&lt;ValidationFailure&gt; errors = e.Errors;</span></strong><span class="koboSpan" id="kobo.295.1">
    return BadRequest(errors);
}
catch (Exception e)
{
    return StatusCode(StatusCodes.Status500InternalServerError);
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.296.1">
     To save you the time and effort of creating custom validators for common scenarios,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.297.1">
      FluentValidation
     </span>
    </strong>
    <span class="koboSpan" id="kobo.298.1">
     provides a number of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.299.1">
      built-in validators.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-74">
    <a id="_idTextAnchor074">
    </a>
    <span class="koboSpan" id="kobo.300.1">
     Built-in validators
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.301.1">
     There is a cornucopia of built-in validators in addition to the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.302.1">
      Equal
     </span>
    </strong>
    <span class="koboSpan" id="kobo.303.1">
     and
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.304.1">
      NotEmpty
     </span>
    </strong>
    <span class="koboSpan" id="kobo.305.1">
     validators
    </span>
    <a id="_idIndexMarker114">
    </a>
    <span class="koboSpan" id="kobo.306.1">
     we’ve seen so far.
    </span>
    <span class="koboSpan" id="kobo.306.2">
     I won’t provide a comprehensive list (see the documentation) but one of the most interesting is the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.307.1">
      PredicateValidator
     </span>
    </strong>
    <span class="koboSpan" id="kobo.308.1">
     validator.
    </span>
    <span class="koboSpan" id="kobo.308.2">
     This passes the value of the property to a delegate, which can use custom validation logic.
    </span>
    <span class="koboSpan" id="kobo.308.3">
     This is accomplished with the keyword
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.309.1">
      Must
     </span>
    </strong>
    <span class="koboSpan" id="kobo.310.1">
     keyword, as
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.311.1">
      shown here:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.312.1">
RuleFor(car =&gt; car.Is_Deleted)</span><strong class="bold"><span class="koboSpan" id="kobo.313.1">.Must</span></strong><span class="koboSpan" id="kobo.314.1">(isDeleted =&gt; isDeleted == "0").WithMessage("Car must have value zero");</span></pre>
   <p>
    <span class="koboSpan" id="kobo.315.1">
     If this validation fails, the issue is displayed in the results as shown in
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.316.1">
       Figure 5
      </span>
     </em>
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.317.1">
       .5
      </span>
     </em>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.318.1">
      :
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer037">
     <span class="koboSpan" id="kobo.319.1">
      <img alt="Figure 5.5 – PredicateValidator error" src="image/B21998_05_5.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.320.1">
     Figure 5.5 – PredicateValidator error
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.321.1">
     There is a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.322.1">
      RegularExpression
     </span>
    </strong>
    <span class="koboSpan" id="kobo.323.1">
     validator that uses the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.324.1">
      Matches
     </span>
    </strong>
    <span class="koboSpan" id="kobo.325.1">
     keyword (instead of
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.326.1">
      Must
     </span>
    </strong>
    <span class="koboSpan" id="kobo.327.1">
     ), but one of my favorites is
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.328.1">
      EmailValidator
     </span>
    </strong>
    <span class="koboSpan" id="kobo.329.1">
     , which ensures that the value submitted is a valid email.
    </span>
    <span class="koboSpan" id="kobo.329.2">
     Similarly, there is a
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.330.1">
       CreditCard
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.331.1">
      validator:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.332.1">
RuleFor(cc =&gt; cc.CreditCard).CreditCard();</span></pre>
   <p>
    <span class="koboSpan" id="kobo.333.1">
     There are
    </span>
    <a id="_idIndexMarker115">
    </a>
    <span class="koboSpan" id="kobo.334.1">
     quite a few more, such as
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.335.1">
      NotNull
     </span>
    </strong>
    <span class="koboSpan" id="kobo.336.1">
     ,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.337.1">
      NotEmpty
     </span>
    </strong>
    <span class="koboSpan" id="kobo.338.1">
     ,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.339.1">
      Equal
     </span>
    </strong>
    <span class="koboSpan" id="kobo.340.1">
     ,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.341.1">
      NotEqual
     </span>
    </strong>
    <span class="koboSpan" id="kobo.342.1">
     , and
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.343.1">
      so forth.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.344.1">
     The best place to see a complete list of built-in validators and how to use them is in the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.345.1">
      FluentValidation
     </span>
    </strong>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.346.1">
      documentation:
     </span>
    </span>
    <a href="https://docs.fluentvalidation.net/en/latest/index.html#">
     <span class="No-Break">
      <span class="koboSpan" id="kobo.347.1">
       https://docs.fluentvalidation.net/en/latest/index.html#
      </span>
     </span>
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.348.1">
      .
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-75">
    <a id="_idTextAnchor075">
    </a>
    <span class="koboSpan" id="kobo.349.1">
     Summary
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.350.1">
     In this chapter, you saw how to use
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.351.1">
      FluentValidation
     </span>
    </strong>
    <span class="koboSpan" id="kobo.352.1">
     to validate input properties before executing code for
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.353.1">
      the API.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.354.1">
     You saw how to create rules, how to chain them, and how to ensure that a second rule in a chain is not evaluated if the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.355.1">
      first fails.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.356.1">
     You learned two ways of dealing with errors – testing the return error or throwing an exception – and you saw how to create a custom
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.357.1">
      error message.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.358.1">
     In the next chapter, we will turn our attention to Azure Functions – a critical part of programming APIs in .NET.
    </span>
    <span class="koboSpan" id="kobo.358.2">
     Following that, we will look at Durable Azure Functions and what they add to
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.359.1">
      Azure Functions.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-76">
    <a id="_idTextAnchor076">
    </a>
    <span class="koboSpan" id="kobo.360.1">
     You try it
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.361.1">
     Create a set of rules for the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.362.1">
      Car
     </span>
    </strong>
    <span class="koboSpan" id="kobo.363.1">
     class (or another class you create) and throw an exception if a validation rule is violated.
    </span>
    <span class="koboSpan" id="kobo.363.2">
     Ensure that the failure of the validation
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.364.1">
      is handled.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.365.1">
     As a bonus, create a predicate (
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.366.1">
      must
     </span>
    </strong>
    <span class="koboSpan" id="kobo.367.1">
     ) custom rule and test
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.368.1">
      against that.
     </span>
    </span>
   </p>
  </div>
 </body></html>