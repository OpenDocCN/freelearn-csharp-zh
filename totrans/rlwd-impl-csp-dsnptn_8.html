<html><head></head><body>
<div id="sbo-rt-content"><div id="_idContainer123">
<h1 class="chapter-number" id="_idParaDest-153"><a id="_idTextAnchor152"/>8</h1>
<h1 id="_idParaDest-154"><a id="_idTextAnchor153"/>Now You Know Some Patterns, What Next?</h1>
<p>Over the course of writing this book, I asked a few friends, colleagues, and at least one of my many archenemies for input.  Invariably, they would ask about a pattern they had studied in school or used on a project wondering why it wasn’t included in this wonderful tome.  The short answer to their question: the goal of the book is to focus on patterns that you can add quickly to your coding arsenal. Patterns that have a quick return on your investment of time and money.  </p>
<p>Many of the patterns I chose to omit are very similar to the ones I included in this book.  The patterns that made the cut were strictly my own preferences.  These patterns have proven the most useful to me during my 25 years of experience as a celebrated and award-winning software engineer using C#. </p>
<p>By the end of this chapter, we will have covered the following topics:</p>
<ul>
<li>The GoF patterns we didn’t cover will be discussed very briefly.</li>
<li>Patterns outside of <strong class="bold">object-oriented programming</strong> (<strong class="bold">OOP</strong>). There are patterns that are not applicable to OOP—for example, patterns designed to describe database or network structure.</li>
<li>How to create your own patterns. The GoF book documents a format for creating your own patterns.</li>
</ul>
<p>Please note that I am only using diagrams. There is no code for this chapter. Likewise, there aren’t any technical requirements.</p>
<h1 id="_idParaDest-155"><a id="_idTextAnchor154"/>Patterns we didn’t discuss</h1>
<p>I didn’t cover all 23 patterns in the GoF book. I only covered about half. A number of factors went into deciding what to include and what to leave <a id="_idIndexMarker559"/>for a tacit discussion in this chapter. Some of the patterns are more troublesome than they are worth. The <strong class="bold">Memento pattern</strong> solves a problem <a id="_idIndexMarker560"/>that can easily be solved with a few .NET features. Some patterns were not included because they are very similar to <a id="_idIndexMarker561"/>another pattern we covered. Some are patterns you are never likely to need. The <strong class="bold">Interpreter pattern</strong> is only useful if you are <a id="_idIndexMarker562"/>inventing a new programming language. This is rarely done anymore owing to the popularity of <strong class="bold">domain-specific languages</strong> (<strong class="bold">DSLs</strong>). Tools exist for the construction of DSLs that preclude the need for the Interpreter pattern.</p>
<p>Here are the patterns from the original GoF book we didn’t cover in this book:</p>
<ul>
<li>Prototype</li>
<li>Adapter</li>
<li>Flyweight</li>
<li>Chain of Responsibility</li>
<li>Proxy</li>
<li>Interpreter</li>
<li>Mediator</li>
<li>Memento</li>
<li>State</li>
<li>Template Method</li>
<li>Visitor</li>
</ul>
<p>I’ll discuss each of these patterns at a high level in the following sections.</p>
<h2 id="_idParaDest-156"><a id="_idTextAnchor155"/>Prototype</h2>
<p>Making copies of objects can be tricky but if your object is flat, with no composition and just a few fields, it’s no <a id="_idIndexMarker563"/>problem at all. However, making a deep copy of a <a id="_idIndexMarker564"/>complicated object that was built using composition and inheritance—and it’s got a few layers of each—is harder. <em class="italic">Deep copying</em> refers to making <a id="_idIndexMarker565"/>an exact copy of an object from the highest level to the lowest level. The first step is to instantiate a new object from the same class. Then, you need to copy the values from all the properties and fields into the new object. You can only do this if every field or property in the object you want to copy is <strong class="source-inline">public</strong>. This includes all the objects used to compose the object you’re copying. Even if you manage to do this, the copy you create is subsequently of the dependent class used to make the copy.</p>
<p>Let’s look at it another way. You’re beginning a project with the <em class="italic">Transylvanian Historical Society</em>. Your job is to copy, brick by brick, a castle owned by one Vlad von Dracula. The castle’s copy will be a museum in another town. There’s a catch: the castle’s drawbridge is up and you’re not allowed inside.</p>
<p>It isn’t hard to make a copy of the outside parts of the castle you can see, but it is impossible to duplicate the interior—especially that creepy crypt in the basement. That is, unless you had inside help. A man named Renfield offers his help. He has full knowledge of the castle’s interior because he never leaves its walls. If you can get Renfield to help you from the inside, making a copy of the castle isn’t going to be difficult.</p>
<p>Prototype is a Creational pattern that enables you to copy an <a id="_idIndexMarker566"/>object brick by brick. It works by delegating the copy job to the object itself. In short, it’s an inside job. The copy operation itself is called <strong class="bold">cloning</strong>. An object <a id="_idIndexMarker567"/>capable of cloning itself is called a prototype.</p>
<p>Have a look at the following diagram:</p>
<div>
<div class="IMG---Figure" id="_idContainer110">
<img alt="Figure 8.1: The Prototype pattern is used when you want to be able to make deep copies of an object. " height="515" src="image/B18605_Figure_8.1.jpg" width="1477"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.1: The Prototype pattern is used when you want to be able to make deep copies of an object.</p>
<p>Let’s review the Prototype pattern diagram by the numbers displayed on it, as follows:</p>
<ol>
<li>The <strong class="source-inline">Prototype</strong> interface defines the method that will perform the cloning operation.</li>
<li>The <strong class="source-inline">ConcretePrototype</strong> implements the Prototype interface and provides the implementation of the <strong class="source-inline">Clone</strong> method. If your object structure is complicated, this <a id="_idIndexMarker568"/>method is positioned to be able to see everything <a id="_idIndexMarker569"/>inside the object where it lives. This method might be refactored so that its name is <em class="italic">Renfield</em>. He’s the guy inside the castle who can help you clone it. The <strong class="source-inline">Clone</strong> method likewise can provide you with details needed to copy the object without losing any blood.</li>
</ol>
<p>The Prototype pattern can be very useful if you need a bunch of classes copied from a small set of objects defined by concrete subclasses. Think back to our bicycle factory. Let’s say there are half a dozen bicycle configurations that are very popular. Let’s further presume that Phoebe’s robots need a new instance of the <strong class="source-inline">bicycle</strong> object in order to manufacture a physical bicycle. In this case, a <strong class="source-inline">bicycle</strong> object is instantiated, the bicycle is manufactured, and the object is destroyed.</p>
<p>It would make <a id="_idIndexMarker570"/>sense in these circumstances to make a collection of “master copies” of the <a id="_idIndexMarker571"/>popular bicycle models and configurations. These masters could be cloned instead of the software needing to run an expensive builder method to generate a new bicycle conforming to a commonly ordered configuration.</p>
<h2 id="_idParaDest-157"><a id="_idTextAnchor156"/>Adapter</h2>
<p>I keep two sets of wrenches in the back of my Jeep. One set is a common 3/8” mechanical ratchet set. One time I was driving home through Oklahoma from vacation in the Ozark mountain range. We had opted to take a scenic route by driving the back roads through a forested area of the state. We were cruising along, and I ran over a board in the middle <a id="_idIndexMarker572"/>of the road. It was unavoidable. I immediately <a id="_idIndexMarker573"/>switched my car’s display to the tires, and over the course of a few miles, I could see the pressure in one tire gradually decreasing. I had a nail in one of my tires. I pulled over at the first opportunity and found some level ground so that I could safely jack my car and change the tire.</p>
<p>My wife and two girls were with me. We had to take all the luggage out of the car to get to the jack. If you’ve ever tried to change a tire with factory-supplied tools, then you understand I was hot, frustrated, and stuck on the side of the road. A pickup truck pulled up behind us, and the driver, wearing a cowboy hat, jeans, and a t-shirt, offered to help us out. I could see an array of expensive power tools in the back of his truck. I accepted his offer. We loosened the tire’s lug nuts with his power wrench, and in minutes, we were back on the road. I vowed the first thing I’d do when I got home was to get me the same kit he had.</p>
<p>The minute I brought my new power wrench home, I wanted to use it on more than just changing a tire. After all, flat tires don’t happen all the time. I wanted to use it with my other ratchet set. Unfortunately, the 3/8” sockets from my other set don’t work with the ½” power tool. If you’re not familiar with these tools, check out the following screenshot: </p>
<div>
<div class="IMG---Figure" id="_idContainer111">
<img alt="Figure 8.2:  My power impact wrench can only use the socket wrench sockets if I use an adapter. " height="1013" src="image/B18605_Figure_8.2.jpg" width="1134"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.2:  My power impact wrench can only use the socket wrench sockets if I use an adapter.</p>
<p>The power wrench is like a normal wrench, except that the drive square is bigger on the power tool. The drive <a id="_idIndexMarker574"/>square is the part of the tool where you attach the <a id="_idIndexMarker575"/>sockets, which have a square hole in them. There’s no way a 3/8” socket can fit onto a ½” drive square. That is, it didn’t fit until I found an adapter. An adapter lets me use one interface—such as a 3/8” socket—with a different interface, such as the drive square of a ½” power socket tool.</p>
<p>The Adapter pattern does the same thing for your classes. An adapter implementation allows two classes with <a id="_idIndexMarker576"/>different interfaces to be used together. If my wrench problem were expressed in <strong class="bold">Unified Modeling Language</strong> (<strong class="bold">UML</strong>), it might look like this: </p>
<div>
<div class="IMG---Figure" id="_idContainer112">
<img alt="Figure 8.3: A class structure following the Adapter pattern is used to allow a class following one interface to work seamlessly with a different interface. " height="534" src="image/B18605_Figure_8.3.jpg" width="1379"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.3: A class structure following the Adapter pattern is used to allow a class following one interface to work seamlessly with a different interface.</p>
<p>Let’s break this down, as follows:</p>
<ol>
<li value="1">The power wrench is the client and we need a way to attach the smaller 3/8” sockets to the ½” drive square. To do this, we need an adapter.</li>
<li>The adapter should <a id="_idIndexMarker577"/>be described with an interface to <a id="_idIndexMarker578"/>prevent tight coupling. This interface calls for an <strong class="source-inline">AttachSocket</strong> method, which is implemented in the concrete adapter class.</li>
<li>The concrete adapter class implements the interface and contains a method that accepts something from the client that can be adapted. </li>
<li>The <strong class="source-inline">ThreeEighthsInchSocket</strong> class represents the incompatible interface you’d like to connect to your client.</li>
</ol>
<p>In short, the adapter implements the client interface—<strong class="source-inline">ISocketWrenchAdapter</strong> in this example. It also wraps the class with which we are interfacing—in this case, <strong class="source-inline">ThreeEighthsInchSocket</strong>. The adapter receives the drive square from the power tool when it calls the <strong class="source-inline">AttachSocket</strong> method in the adapter class. The internals of this method perform the logical operations needed to convert that input into something the adaptee can use. In software parlance, the <a id="_idIndexMarker579"/>client would be making a call to the adapter class. The <a id="_idIndexMarker580"/>method called would provide conversion logic that converts what was passed into the method so as to be compatible with the adaptee.</p>
<p>This can be a very useful pattern when you need to leverage third-party or legacy with new work.</p>
<h2 id="_idParaDest-158"><a id="_idTextAnchor157"/>Flyweight</h2>
<p>Have you ever had a thought that keeps you awake at night? Or maybe you have a thought that wakes you up? You’re sound asleep and then you awake with a jolt. Your half-slumbering brain just figured out what’s wrong with line 37.</p>
<p>Late one night in a fit <a id="_idIndexMarker581"/>of heuristic frenzy, Kitty wonders what would happen if one day, demand for Bumble Bikes exploded. What if the small company was inundated with thousands of orders? The robotic <a id="_idIndexMarker582"/>manufacturing system Phoebe built instantiates a bicycle object each time it builds a bicycle. Each bicycle object takes up space in the server’s <strong class="bold">random-access memory</strong> (<strong class="bold">RAM</strong>). Kitty decides to try a simulation using a development <a id="_idIndexMarker583"/>server. After a few load tests, she determines she can load 1,000 instances of a bicycle object complete with the bridged painter system. Once the object count goes above 1,000 concurrent objects, the server starts to slow down. Once she reaches 2,000 objects in memory, the system nearly grinds to a halt and is unusable.</p>
<p>One obvious solution to this problem is to order more RAM for the server. Of course, this makes it a hardware problem. We are software developers. Maybe there is a way to solve this problem by strictly using software patterns. Maybe a small adjustment will prevent us from having to ask the pointy-haired boss for several thousand dollars in upgrades.</p>
<p>The Flyweight pattern is used to move some of the shared elements of each object’s state into one shared object. Sometimes, you <a id="_idIndexMarker584"/>can shift a large amount of data out of memory and into one shared object. You see this anywhere you have a high object count. For example, if you use C# with Unity to develop game software, your game might have hundreds, or even thousands, of enemies. Maybe you’re leveraging a homemade particle system with thousands of shiny moving particles, or maybe you’re doing a factory simulation where thousands of bicycles are being manufactured by a small cadre of robots.</p>
<p>Consider the following diagram: </p>
<div>
<div class="IMG---Figure" id="_idContainer113">
<img alt="Figure 8.4: The Flyweight pattern entails shifting duplicated state variables into a separate object that can be shared to reduce memory footprint.  " height="905" src="image/B18605_Figure_8.4.jpg" width="1391"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.4: The Flyweight pattern entails shifting duplicated state variables into a separate object that can be shared to reduce memory footprint. </p>
<p>Let’s break it down <a id="_idIndexMarker585"/>by the numbers in the diagram, as follows:</p>
<ol>
<li value="1">Here, we have <a id="_idIndexMarker586"/>a <strong class="source-inline">Bicycle</strong> class with all its parts. For our simulation, we’re just going to make road bikes. The ordering system lets customers customize the bicycle frame with a special paint job, or pick from one of the standard colors. The seat can also be swapped out for one of several models. However, the rest of the properties offer no customization options. They will be the same for every road bike we build.</li>
<li>Now, watch what happens if we shift the parts of the state that don’t vary into a separate class. Here, our <strong class="source-inline">Bicycle</strong> class only contains those properties that might be different between each bicycle we make.</li>
<li>The elements of state that are common for all objects are called the extrinsic state and are represented in the <strong class="source-inline">BicycleFlyweightCommonState</strong> class. It’s a bit of a mouthful, but I wanted to be sure you recognized which part was the flyweight. We can make one instance of this class and share it with all 1 million of the <strong class="source-inline">Bicycle</strong> classes in Phoebe’s simulation.</li>
</ol>
<p>Let’s say the <strong class="source-inline">Bicycle</strong> class weighs in at 16 <strong class="bold">kilobytes</strong> (<strong class="bold">KB</strong>) of memory usage upon instantiation. If Phoebe wants to generate 1 million of them, that’s going to consume 16 <strong class="bold">gigabytes</strong> (<strong class="bold">GB</strong>) of memory. Once we shift the repeated state to the flyweight object, we chop out 14 KB for one <a id="_idIndexMarker587"/>object. Since we only instantiate it once, the memory footprint <a id="_idIndexMarker588"/>comprises only the intrinsic state. We instantiate 1 million bicycle objects at 2 KB, or total consumption is 2 GB plus the negligible 14 KB for a single instance of the extrinsic state in the flyweight class. That’s a nearly 8X reduction! I don’t know about you, but I would strut for a week if I could reduce my software’s memory footprint by 8X just by rearranging some classes!</p>
<h2 id="_idParaDest-159"><a id="_idTextAnchor158"/>Chain of Responsibility</h2>
<p>The success of Bumble Bikes isn’t owed entirely to Kitty’s designs nor Phoebe’s brilliant robotics. Bumble Bikes also has <a id="_idIndexMarker589"/>a focus on quality and <strong class="bold">quality assurance</strong> (<strong class="bold">QA</strong>) is completely automated. A system of cameras <a id="_idIndexMarker590"/>does a series of inspections using <strong class="bold">artificial intelligence</strong> (<strong class="bold">AI</strong>) via OpenCV. The inspection begins with the frame, then moves to the <a id="_idIndexMarker591"/>handlebars, the drivetrain components, the <a id="_idIndexMarker592"/>brakes, the wheels, the tires, and finally the seat. The logic used by the AI to perform the inspection is not contained in a single method. That would <a id="_idIndexMarker593"/>violate the <strong class="bold">single-responsibility principle</strong> (<strong class="bold">SRP</strong>). Instead, each inspection’s logic is encapsulated within a separate method for each inspection. The inspection happens sequentially, beginning with the frame. If any of the inspections fail, the bicycle is flagged as a defect and set aside for remediation performed by a human bicycle mechanic. </p>
<p>You can see an overview of the QA checks in the following diagram:</p>
<div>
<div class="IMG---Figure" id="_idContainer114">
<img alt="Figure 8.5: Sequential quality assurance checks on a bicycle are one example of Chain of Responsibility.  " height="925" src="image/B18605_Figure_8.5.jpg" width="833"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.5: Sequential quality assurance checks on a bicycle are one example of Chain of Responsibility. </p>
<p>This sequentially <a id="_idIndexMarker594"/>ordered set of inspections uses <a id="_idIndexMarker595"/>the Chain of Responsibility pattern. If any of the inspections fail, the remainder of the inspections is not run. This is how Toyota makes cars. If a defect is found on the assembly line, everything stops until the problem is corrected. </p>
<p>The pattern itself takes on the form seen here: </p>
<div>
<div class="IMG---Figure" id="_idContainer115">
<img alt="Figure 8.6: The Chain of Responsibility pattern is used anytime you need a stateful sequence of events.  " height="1019" src="image/B18605_Figure_8.6.jpg" width="1379"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.6: The Chain of Responsibility pattern is used anytime you need a stateful sequence of events. </p>
<p>Let’s break it down, as follows:</p>
<ol>
<li value="1">An interface, usually called <strong class="source-inline">IHandler</strong>, defines two methods. The <strong class="source-inline">Handle</strong> method defines the <a id="_idIndexMarker596"/>method signature for the <a id="_idIndexMarker597"/>implementation of the inspection logic. The <strong class="source-inline">Next</strong> method allows us to move to the next inspection, assuming the current step passes.</li>
<li>An abstract handler class defines the next handler, which is a common property among the concrete classes.</li>
<li>The concrete classes inherit from <strong class="source-inline">Handler</strong> and implement their inspection logic with the <strong class="source-inline">Handle</strong> method, which overrides the base class method. Similarly, the <strong class="source-inline">Next</strong> method <a id="_idIndexMarker598"/>overrides the base and is <a id="_idIndexMarker599"/>used to pass the torch on to the next runner or, in our case, pass the current inspection and move to the next.</li>
</ol>
<p>Flowchart logic has been around since the Turing machine. It should come as no surprise there is a pattern to encapsulate this universal concept.</p>
<h2 id="_idParaDest-160"><a id="_idTextAnchor159"/>Proxy </h2>
<p>One day, Kitty and Phoebe <a id="_idIndexMarker600"/>get a call from Dr. Eloise Swanson. Dr. Swanson has started <a id="_idIndexMarker601"/>a new business called <em class="italic">U.S. Robots and Mechanical Men</em>. Her company’s newest product is a high-end <strong class="bold">software development kit</strong> (<strong class="bold">SDK</strong>) for robotic control. Dr. Swanson had studied Phoebe’s designs while in <a id="_idIndexMarker602"/>graduate school at the <strong class="bold">Massachusetts Institute of Technology</strong> (<strong class="bold">MIT</strong>) and thought Bumble Bikes would make a <a id="_idIndexMarker603"/>good partner for beta testing.</p>
<p>The SDK was very effective and easy to use. However, it wasn’t a drop-in replacement for the software Kitty and Phoebe had written. First, there’s no way an SDK can fully replace custom-tailored software for any business. The second problem was bloat because the SDK was designed to work with any robotic system. A great deal of code was used to account for every possibility.</p>
<p>Kitty and Phoebe found that the SDK was a good fit to control their painting robots.  However, it was only needed when a custom paint job was ordered that had never done before. Once a paint job was performed, it was cataloged and the color formula could be reused. The SDK from <em class="italic">U.S. Robots</em> made much shorter work of the paint jobs, at the cost of slow initialization and a large memory footprint. If the girls were to couple their code to the SDK, which of course they wouldn’t, all their work would be slowed down by an expensive initialization process they would rarely use.</p>
<p>The solution is to lazy load the SDK objects only when they are needed. The P roxy pattern allows you to define and use a placeholder for an object. The proxy could then load the big, slow SDK classes only when they were needed. The rest of the production process would remain unhampered.</p>
<p>Let’s examine the structure of the Proxy pattern in the following diagram: </p>
<div>
<div class="IMG---Figure" id="_idContainer116">
<img alt="Figure 8.7: The Proxy pattern can substitute a simple object for a more complicated one until the complicated one is actually needed.  " height="756" src="image/B18605_Figure_8.7.jpg" width="1435"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.7: The Proxy pattern can substitute a simple object for a more complicated one until the complicated one is actually needed. </p>
<p>Breaking it down will help us understand further, so we’ll do just that:</p>
<ol>
<li value="1">We have this <a id="_idIndexMarker604"/>SDK from a third-party vendor. We know tightly coupling to <a id="_idIndexMarker605"/>a third-party vendor’s SDK is a bad idea in the first place. In this case, the SDK has a method we want to use, but its containing class has a big, slow constructor, and the object is rarely used. We need a way to lazily load this object only when it is needed while also preventing a tight coupling.</li>
<li>We create an interface to prevent tight coupling. Our client software can require the interface, and any changes in the future are fine as long as we can keep the interface.</li>
<li>Then, we create a wrapper that holds the SDK instance. The wrapper holds an instance of <strong class="source-inline">BigSlowButVeryUsefulPaintService</strong>, which might take several minutes to instantiate. That’s a long time, considering we only need one method. Our wrapper instantiates <strong class="source-inline">BigSlowButVeryUsefulPaintService</strong>, then calls the expensive <strong class="source-inline">InitializeSystem</strong> method only when it is really needed. Since we bore the instantiation cost, we can store the instance in a private property and use it again if the need <a id="_idIndexMarker606"/>arises. That might sound like a singleton, but singletons ensure <a id="_idIndexMarker607"/>only one instance is ever created. Here, we are just reusing what we have already made, which isn’t quite the same thing.</li>
</ol>
<p>Remember, usese the Proxy pattern anytime you need a placeholder for a third-party, legacy, or overly expensive object. This will to prevent tight coupling and defer expensive operations that might happen on instantiation for when they are needed.</p>
<h2 id="_idParaDest-161"><a id="_idTextAnchor160"/>Interpreter</h2>
<p>The Interpreter pattern is one you will likely never need.  This pattern is used when you have a custom language you need to interpret that can be expressed using <strong class="bold">abstract syntax trees </strong>(<strong class="bold">ASTs</strong>).  With the rise in popularity of <strong class="bold">domain-specific languages</strong> (<strong class="bold">DSLs</strong>), entire toolkits, such as JetBrains Meta Programming System and Visual Studio Enterprise’s Modeling SDK, make creating a custom language interpreter a relatively simple project.</p>
<p>Since DSLs are well beyond the scope of a book on patterns, I will list a reference to the DSL tools I’ve mentioned here in the <em class="italic">Further reading</em> section at the end of the chapter.</p>
<h2 id="_idParaDest-162"><a id="_idTextAnchor161"/>Mediator</h2>
<p>It isn’t difficult to imagine a future for Bumble Bikes where their automated manufacturing system might expand and become more complex. Right now, we have the <a id="_idIndexMarker608"/>Builder pattern controlling the robotics that build <a id="_idIndexMarker609"/>bicycles and wheelchairs. There are two physical factories, and each factory specializes in just a few products. All that could change in the future.</p>
<p>I worked for an aircraft manufacturer on a joint venture with another aircraft manufacturer. Our company made the powerplant (engine) and assembled the final aircraft. The partner company built the body of the aircraft. Other partner companies supplied avionics, which are the electronic flight-control systems present in modern aircraft. Another company still manufactures military components that I’m not allowed to talk about.</p>
<p>Imagine if Bumble Bikes had a slew of manufacturing operations like that. Even if they were all collocated in one plant, the level of signal communications between all the different robotic manufacturing systems could become very chaotic. If each system were to communicate with all the other systems directly, we’d very quickly find ourselves in trouble.</p>
<p>If you’ve ever created a large web application using HTML and JavaScript, you have run into a similar <a id="_idIndexMarker610"/>problem. You have dozens of different pieces of code modifying the <strong class="bold">Document Object Model</strong> (<strong class="bold">DOM</strong>) in response to potentially <a id="_idIndexMarker611"/>hundreds of signals emanating from <a id="_idIndexMarker612"/>user interactions, timers, <strong class="bold">Representational State Transfer</strong> (<strong class="bold">REST</strong>) <strong class="bold">application programming interface</strong> (<strong class="bold">API</strong>) calls, third-party SDKs such as jQuery, and third-party advertising sites injecting code into your site for monetization. When a system such as this reaches critical mass in terms of signal complexity, it becomes slow and nearly impossible to debug and maintain.</p>
<p>Let’s consider one more example: a natural disaster such as a hurricane or tornado. What if all the <strong class="bold">first responders</strong> (<strong class="bold">FRs</strong>) were able to contact each other directly? Every firefighter could radio every policeman, who could radio every <strong class="bold">emergency medical service</strong> (<strong class="bold">EMS</strong>) unit. The EMS responders could talk directly to triage nurses and Red Cross volunteers. All this happens on one big open communication channel. What are your odds of surviving a disaster in this environment? Open direct communications can sometimes be a good thing, but I think we all realize it doesn’t scale. Now, imagine hundreds of objects in a piece of software that all have direct access to all the other objects on the stack. You see the problem, right?</p>
<p>What’s needed in all these <a id="_idIndexMarker613"/>circumstances is some form of dispatcher: a central hub for <a id="_idIndexMarker614"/>communications. The Mediator pattern embodies this role. A mediator acts as a central hub for all communications and routes requests to the objects that need them in a controlled manner. Let’s examine the diagram shown here:</p>
<div>
<div class="IMG---Figure" id="_idContainer117">
<img alt="Figure 8.8: The Mediator pattern involves a single centralized object that directs calls between objects. " height="586" src="image/B18605_Figure_8.8.jpg" width="1379"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.8: The Mediator pattern involves a single centralized object that directs calls between objects.</p>
<p>By the numbers in the diagram, it works like this:</p>
<ol>
<li value="1">This is a base class for the colleague objects.</li>
<li>You have a bunch of colleague objects that need a centralized way to communicate. Here, I just have four, which is probably no cause to run to the Mediator pattern. But imagine 400 objects all communicating directly with each other! Like I said before, direct communications don’t scale!</li>
<li>We make an interface called <strong class="source-inline">IMediator</strong>, which sounds cool when you say it out loud. This, as usual, prevents tight coupling.</li>
<li>Now for the good part. A central object based on the <strong class="source-inline">IMediator</strong> interface contains instances of all the objects and has defined communications channels between them in the form of methods that I called <strong class="source-inline">ReactWithX</strong>, where X is the number corresponding with the object sending the signal. <strong class="source-inline">ReactWith1</strong> calls an appropriate method on <strong class="source-inline">Colleague1</strong>, and so on.</li>
</ol>
<p>This pattern is designed to simplify the communications process, but it usually results in a very large object with <a id="_idIndexMarker615"/>lots of internalized component instances and methods <a id="_idIndexMarker616"/>for communicating. You have to weigh the complexity of the <strong class="source-inline">Mediator</strong> class against the benefits of the centralization it offers. On the one hand, as a developer, it’s nice to have one class where you can drop a breakpoint in your IDE. Like a lion scoping out the local watering hole, eventually, all message traffic passes through this one class, making it simpler to find bugs.</p>
<p>On the downside, the class itself can become unwieldy.</p>
<h2 id="_idParaDest-163"><a id="_idTextAnchor162"/>Memento</h2>
<p>Have you ever saved a game or used undo in your favorite editor? If so, then you’ve likely interacted <a id="_idIndexMarker617"/>with the Memento pattern. The best analogy for a <a id="_idIndexMarker618"/>memento is a cool but outdated technology. When I was in grade school, the hottest camera was called a Polaroid. Most cameras back then involved a roll of film. You would shoot your pictures on the camera, then take the film to a drug store to be developed. It took about a week to get your pictures back. However, with a Polaroid, you could take your pictures, which were ejected from the camera and self-developed within a few minutes. The development process seemed to go a little faster if you shook the picture, which gave rise to a popular song lyric, and accompanying dance move, “Shake it like a Polaroid picture”.</p>
<p>Back then, we called these pictures <em class="italic">snapshots</em>. This term is used today in conjunction with the Memento pattern. A snapshot, like a Polaroid picture, is a representation of an event or place <a id="_idIndexMarker619"/>at a particular point in time. So it is with software as well: a snapshot represents the state of an object at a point in time. Like a photo, a software snapshot can be saved as a memento—something to remind you of that one time when your object was in that state.</p>
<p>Text editors such as your IDE or Microsoft Word are constantly tracking the state of your documents and saving mementos as you type. When you hit <em class="italic">Ctrl</em>/<em class="italic">Command + Z</em> on your keyboard, you can go back sequentially to earlier and earlier mementos.</p>
<p>At first glance, this seems easy. All you’d need to do is create a <strong class="source-inline">List&lt;&gt;</strong> object to hold, say, the last 100 state changes your user has made. Maybe you store a memento every 30 seconds or so. That’s easy. It’s that easy only if every object in your state and every object used in inheritance and composition has 100% public properties. If the entire state is public, you wouldn’t need a pattern for this.</p>
<p>The real impediment here is the same one we encountered with the Prototype pattern earlier. We were trying <a id="_idIndexMarker620"/>to copy Count Dracula’s castle, but we weren’t <a id="_idIndexMarker621"/>allowed inside the front gate. Making a shallow copy of the outside of the castle is straightforward, to make a full copy of the whole castle requires an inside actor. This is equally true in the Memento pattern. In the memento’s case, the inside actor is a nested class. The nested class has access to the outer class’s state and can store our suggested <strong class="source-inline">List&lt;&gt;</strong> object containing our undo history. Let’s look at the diagram shown here: </p>
<div>
<div class="IMG---Figure" id="_idContainer118">
<img alt="Figure 8.9: The Memento pattern. " height="556" src="image/B18605_Figure_8.9.jpg" width="1444"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.9: The Memento pattern.</p>
<p>Since the most familiar example is a text editor, I used that for the diagram. Let’s review the numbered parts of the diagram, as follows:</p>
<ol>
<li value="1">This class represents the <strong class="source-inline">DocumentEditor</strong> class, which is our client. The memento pattern calls this the originator since this is where the stored state comes from.</li>
<li>When the editor needs to save an undo state—or, for that matter, a file—it can use the <strong class="source-inline">Memento</strong> class for storage. Note that all the internals are private. The <strong class="source-inline">Memento</strong> class is nested inside the originator; it is defined <em class="italic">inside</em> the <strong class="source-inline">DocumentEditor</strong> class as a nested class. Besides being locked down, you should consider <strong class="source-inline">Memento</strong> classes immutable: once you create them, you should never <a id="_idIndexMarker622"/>change them. The private properties are set <a id="_idIndexMarker623"/>via the constructor and subsequently never modified. This means when you implement, there should not be any setter accessor methods for these properties.</li>
<li>There isn’t a standard way to draw internal classes in UML, so I put the <strong class="source-inline">Caretaker</strong> class outside the dashed box as a visual clue that there’s something different about this class. Remember, <strong class="source-inline">Memento</strong> is inside the <strong class="source-inline">DocumentEditor</strong>, and not via composition. The <strong class="source-inline">Caretaker</strong> class, in turn, contains the <strong class="source-inline">DocumentEditor</strong> object inside the <strong class="source-inline">Originator</strong> field. The <strong class="source-inline">Caretaker</strong> class, then is responsible for creating and restoring mementos, as well as the undo history.</li>
</ol>
<p>The Memento pattern can be difficult to get right, and you might go a long way in your career without needing it. Even if you land a job at a company that makes a document editor, chances are you’ll be using one of the many excellent third-party <strong class="bold">user interface</strong> (<strong class="bold">UI</strong>) controls, such as those from Telerik, that have already implemented this for you.</p>
<p>The other point worth mentioning is that you can achieve a nearly identical effect using C#’s serialization libraries. Usually, saving the application state also entails persistence. Good editors let you undo the last 100 changes. Great editors let you do that between editing sessions. You can turn off your laptop, fly across the world, boot back up, and your undo history is still available because it’s serialized (saved) to a file somewhere on your hard drive.</p>
<p>The .NET Framework gives us a slew of serialization options, including <strong class="source-inline">System.Runtime.Serialization</strong>, <strong class="source-inline">System.Runtime.Serialization.Json</strong>, and <strong class="source-inline">System.Text.Json.Serialization</strong>. Each contains a set of classes designed to make serializing <a id="_idIndexMarker624"/>your objects to files fairly trivial. However, you’ll still <a id="_idIndexMarker625"/>have problems with private properties. Thankfully, Microsoft has supplied us with the <strong class="source-inline">DataContractSerializer</strong> class that helps you get around this limitation without resorting to an intricate class structure or worrying about the memento’s immutability.</p>
<h2 id="_idParaDest-164"><a id="_idTextAnchor163"/>State</h2>
<p>I’ll confess looking back at the last eight chapters, I probably should have covered this pattern. You’ll use it, especially if you work in game development with Unity 3D. If you’re not familiar with this <a id="_idIndexMarker626"/>tool kit, it’s essentially a game engine capable of creating AAA games for <a id="_idIndexMarker627"/>consoles, PC, Mac, mobile, and the web. I taught game development with Unity for many years at a local college and so I have a soft spot for it, despite never having worked as a professional game developer. The Unity 3D game engine uses a finite state machine to control the animation of your game characters. It uses a visual editor to define the states and the animation to use when the game character’s state changes.</p>
<p>The State pattern entails changing an object’s behavior based on changes to its internal state. An object’s state is conceptually just the values of all its properties at a point in time. If you make a game where you run around the countryside fighting zombies, you might define your zombies with different behaviors. Most of the time, they’re just shambling around randomly looking for fresh BRAINS!</p>
<p>When something with a brain comes into view, the zombie’s behavior changes. It shambles towards the brain-toting organism while hissing “BRAINS!” over and over. Once the zombie is within arm’s reach, its behavior changes again. The zombie attacks!</p>
<p>We have one object with three behaviors, all controlled by the internal state. When we put the behaviors and states together, we form what’s called a finite-state machine. It is finite because zombies have a finite number of behaviors. In this case, the number is 3. The finite state machine can be diagrammed as shown here: </p>
<div>
<div class="IMG---Figure" id="_idContainer119">
<img alt="Figure 8.11: A finite state machine representing zombie behavior in a video game.  " height="696" src="image/B18605_Figure_8.10.jpg" width="637"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.11: A finite state machine representing zombie behavior in a video game. </p>
<p>This state diagram <a id="_idIndexMarker628"/>shows the transitions between the different states. The zombie <a id="_idIndexMarker629"/>can’t randomly attack a victim that is too far away. It has to see the victim and close the distance first. A diagram of the pattern appears here:</p>
<div>
<div class="IMG---Figure" id="_idContainer120">
<img alt="Figure 8.12: The State pattern.  " height="799" src="image/B18605_Figure_8.11.jpg" width="1379"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.12: The State pattern. </p>
<p>Let’s break it down, as follows:</p>
<ol>
<li value="1">The <strong class="source-inline">IState</strong> interface defines the behaviors that are possible. Our zombie can patrol, close distance to a visible victim, and attack.</li>
<li>The <strong class="source-inline">Context</strong> class holds a reference to an object implementing the <strong class="source-inline">IState</strong> interface, which is used to communicate with concrete state objects.</li>
<li>Concrete state objects contain state-specific methods.</li>
</ol>
<p>The context object <a id="_idIndexMarker630"/>can be used to change the state by swapping concrete state objects <a id="_idIndexMarker631"/>held in the private state property. This means the context can enforce any logic for state transitions.</p>
<p>I didn’t include the State pattern earlier because it is very similar to the Strategy pattern covered in <a href="B18605_05.xhtml#_idTextAnchor089"><em class="italic">Chapter 5</em></a><em class="italic"> </em>. Kitty and Phoebe used the Strategy pattern to create a navigation system for bicycles. The behavior of the system changed depending on what type of terrain the user requested. </p>
<h2 id="_idParaDest-165"><a id="_idTextAnchor164"/>Template Method</h2>
<p>The Template Method pattern is very similar to the Strategy pattern, which we covered in <a href="B18605_05.xhtml#_idTextAnchor089"><em class="italic">Chapter 5</em></a>. This is a <a id="_idIndexMarker632"/>behavioral pattern that allows <a id="_idIndexMarker633"/>you to define the structure of an algorithm but defer the implementation to subclasses that override the actual logic but not the structure.</p>
<p>In <a href="B18605_05.xhtml#_idTextAnchor089"><em class="italic">Chapter 5</em></a><em class="italic"> </em>, Phoebe designed a navigational computer for bicycles. It used the Strategy pattern to compute navigational routes depending on whether the rider wanted a route via paved roads, unpaved gravel roads, or extreme terrain. We could have done the same thing with the Template Method pattern, which is why I didn’t feel the need to cover both.</p>
<p>The structure can be seen in the following diagram: </p>
<div>
<div class="IMG---Figure" id="_idContainer121">
<img alt="Figure 8.13: The Template pattern.  " height="729" src="image/B18605_Figure_8.12.jpg" width="1035"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.13: The Template pattern. </p>
<p>Let’s look at the numbered parts, as follows:</p>
<ol>
<li value="1">The abstract template class defines the structure of a class that forms an algorithm. The steps to the algorithm are defined as abstract and can be overridden by a concrete implementation in a child class. The steps, however, are called in a method within the template class. In my example, I called it <strong class="source-inline">ExecuteTemplate()</strong>, which is not overridden. <strong class="source-inline">ExecuteTemplate()</strong> calls the steps in order, and this never changes. The template defines overrideable logic, but the structure is consistent each time the template is used.</li>
<li>These are the <a id="_idIndexMarker634"/>concrete classes that override the <a id="_idIndexMarker635"/>algorithm steps. Note the <strong class="source-inline">AlgoImplementationA</strong> class overrides all the steps in the parent class. The <strong class="source-inline">AlgoImplementationB</strong> class just overrides a few.</li>
</ol>
<p>This pattern allows you to make very flexible algorithm implementations using nothing more than common household inheritance.</p>
<h2 id="_idParaDest-166"><a id="_idTextAnchor165"/>Visitor</h2>
<p>The Visitor pattern is another Behavioral pattern designed to help you “bolt on” new behaviors to existing <a id="_idIndexMarker636"/>objects. Its motivations are focused on SOLID principles (head back to <a href="B18605_02.xhtml#_idTextAnchor036"><em class="italic">Chapter 2</em></a> if you need an explanation of this acronym). The open-closed <a id="_idIndexMarker637"/>principle is honored because you are adding behavior without modifying existing classes. The SRP is honored because usually, the behavior you are adding is new and may have little to nothing to do with the purpose of the original class.</p>
<p>The idea behind the name comes from the idea that an object encapsulating new behavior can visit an existing, established class, allowing it to perform the new behavior. You’re literally teaching an old dog object new tricks.</p>
<p>Imagine a world where your body has an ability slot. You can slot in a new behavior as easily as slotting a memory card into a camera. Need to learn to fly a helicopter to escape evil secret agents? Slot the card with flight training and you can instantly fly any civilian or military aircraft! Do you need to cook like a 5-star chef? Slot a card with cooking skills and you’ll be able to defeat Gordon Ramsay or Bobby Flay in any cooking competition! Do you need moves at the nightclub? Slot a card with nightclub skills and you’ll dance the night away! Just be careful with that last one. There’s no telling what other skills might be on the card.</p>
<p>Let’s shake that last example off and look at the following diagram: </p>
<div>
<div class="IMG---Figure" id="_idContainer122">
<img alt="Figure 8.14: The Visitor pattern. " height="672" src="image/B18605_Figure_8.13.jpg" width="991"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.14: The Visitor pattern.</p>
<p>Let’s break it down, as follows:</p>
<ol>
<li value="1">Our <strong class="source-inline">Visitor</strong> interface defines a set of methods required to implement a new superpower you <a id="_idIndexMarker638"/>wish to confer on an existing object graph. We’re <a id="_idIndexMarker639"/>fortunate that C# supports method overloading. Method overloading refers to a language’s ability to reuse method names as long as the method signature is different. If you’re not sure what this means, check out <a href="B18605_Appendix_1.xhtml#_idTextAnchor178"><em class="italic">Appendix 1</em></a> at the end of this book. We cover it there. Not every OOP language supports this capability, but C# does. Our interface defines several methods with the same name but with different argument types.</li>
<li>A second interface called the <strong class="source-inline">Element</strong> interface defines how visitors are accepted. If you want new abilities in our future world, you’ll have to get a slot added to your skull so that we have someplace to insert our ability cards. Likewise, your class will need an additional method based on this interface. You don’t need to change any existing methods or logic in the class. You just need to add a method to accept visitors.</li>
<li>Concrete visitor classes implement our interface and provide the new behavioral logic. Note that we did not use the <strong class="source-inline">IElement</strong> interface as the argument type. The concrete object type passed in determines which method is run based on method overloading.</li>
<li>These are your existing classes implementing the <strong class="source-inline">Element</strong> interface.</li>
</ol>
<p>A few things come to mind when I think of the Visitor pattern in C#. First, it feels a lot like the Decorator <a id="_idIndexMarker640"/>pattern, but with a focus on object graphs instead of individual <a id="_idIndexMarker641"/>classes. Maybe that’s just me? </p>
<p>Another similar pattern is the Composite pattern covered in <a href="B18605_05.xhtml#_idTextAnchor089"><em class="italic">Chapter 5</em></a>, and again in <em class="italic">Chapters 7</em> and <em class="italic">8</em>. Kitty and Phoebe used the Composite pattern to perform a set of calculations for weight and cost on a graph of objects used to comprise a bicycle drivetrain. Tom improved the design by weaving the Composite pattern into the object graph at design time. The difference is that the Composite pattern operates from outside the objects in the graph whereas the Visitor pattern is inserting new behavior.</p>
<p>Finally, the first time I read about the Visitor pattern, I immediately thought of extension methods. Extension methods are unique to C#. They allow you to add behaviors to existing classes using a separate class file. They are not an implementation of the Visitor pattern, but if your needs are simple, you might want to start with extension methods. If extension methods come up short, then try the more complex Visitor pattern.</p>
<h1 id="_idParaDest-167"><a id="_idTextAnchor166"/>Patterns beyond the realm of OOP</h1>
<p>The field of OOP was really just the start. There are patterns beyond the realm of OOP that you have very likely heard of,  but perhaps didn’t know were codified patterns.</p>
<h2 id="_idParaDest-168"><a id="_idTextAnchor167"/>Software architecture patterns</h2>
<p>An obvious area for finding more patterns is within the domain of software architecture. It may seem like we’ve been talking about software architecture this whole time. We have. However, <a id="_idIndexMarker642"/>software architecture isn’t bound to OOP. Every pattern in this book relies on using C# because it is an OOP  language. Software architecture patterns span every language and really help us define systems, not just enhance the structure of our code. Let’s look at some examples you have probably heard of before now.</p>
<h3>Client-server pattern</h3>
<p>We actually covered this one—we just <a id="_idIndexMarker643"/>didn’t call it out <a id="_idIndexMarker644"/>as a pattern. This pattern involves <strong class="bold">peer-to-peer</strong> (<strong class="bold">P2P</strong>) architecture <a id="_idIndexMarker645"/>consisting of a server, and usually many clients. The clients make requests to the server and do something with the result. This is pretty much how the internet works.</p>
<h3>Microservices pattern</h3>
<p>The Microservices pattern entails breaking large, monolithic applications into small, self-contained but <a id="_idIndexMarker646"/>interdependent services. The <a id="_idIndexMarker647"/>idea is to take the SRP to its ultimate implementation. Imagine a REST API with a handful of endpoints that together serve only one purpose such as password reset. Instead of password reset being built into a bigger API that does dozens of other things, the password reset becomes a microservice.</p>
<p>The idea is that it is easier to maintain tiny single-purpose APIs. The trade-off comes from the latency introduced between interdependent system calls and the resulting complexity of your network topology.</p>
<h3>Model-View-Controller (MVC) pattern</h3>
<p>Surely you’ve heard <a id="_idIndexMarker648"/>of this one! You <a id="_idIndexMarker649"/>see it in web applications when you split the application code into three layers, as follows:</p>
<ul>
<li>A model layer that contains <a id="_idIndexMarker650"/>code that represents the data model, usually <a id="_idIndexMarker651"/>via an <strong class="bold">object-relational mapper</strong> (<strong class="bold">ORM</strong>).</li>
<li>A view <a id="_idIndexMarker652"/>layer that represents <a id="_idIndexMarker653"/>the <strong class="bold">user experience</strong> (<strong class="bold">UX</strong>).</li>
<li>A controller layer that represents the logic needed to accept requests from the view and <a id="_idIndexMarker654"/>process data <a id="_idIndexMarker655"/>returned from <a id="_idIndexMarker656"/>the model layer. This <a id="_idIndexMarker657"/>configuration embodies the ideals behind the <strong class="bold">separation of concerns</strong> (<strong class="bold">SoC</strong>).</li>
</ul>
<h3>Publish-subscribe (pub-sub) pattern</h3>
<p>This is another popular pattern you’ll see in many guises. Sometimes you’ll see object-level implementations <a id="_idIndexMarker658"/>such as <a id="_idIndexMarker659"/>what we saw in the Observer pattern covered in <a href="B18605_05.xhtml#_idTextAnchor089"><em class="italic">Chapter 5</em></a><em class="italic"> </em>. You’ll also see higher-level architectural implementations in software such as Redis, RabbitMQ, and Apache Kafka.</p>
<p>In every case, the idea is to allow communication from a central source. Messages are sent to a publisher who in turn publishes the messages to relevant subscribers. This is vital to distributed architectures.</p>
<h3>Command Query Responsibility Segregation (CQRS) pattern</h3>
<p>This pattern is meant to solve the situation that arises when database queries for data occur far <a id="_idIndexMarker660"/>more frequently than database updates. If you have a reporting <a id="_idIndexMarker661"/>system where reports are generated but rarely subsequently modified, this is a good pattern to learn. Its solution generally entails segregating data that rarely changes but is commonly queried into a separate database called a data warehouse. This can boost performance on reads and writes because the responsibilities are segregated. The trade-off comes from the implementation cost, which often involves standing up a separate database server to handle the segregated loads.</p>
<h2 id="_idParaDest-169"><a id="_idTextAnchor168"/>Data access patterns</h2>
<p>Data access patterns occur wherever you have traditional code interacting with a relational, or even <a id="_idIndexMarker662"/>non-relational, database. Since relational databases have been around since 1970 and are largely unchanged and completely ubiquitous, it shouldn’t be surprising that they have their own set of patterns. I cut my teeth with a book by Clifton Nock titled <em class="italic">Data Access Patterns: Database Interactions in Object-Oriented Applications</em>. I’ll list the book’s details in the <em class="italic">Further reading</em> section at the end of the chapter.</p>
<p>Here are just a few patterns from that book you’ll probably recognize.</p>
<h3>ORM</h3>
<p>Ever heard of <strong class="bold">Entity Framework</strong> (<strong class="bold">EF</strong>)? As a C# developer, you’d have to have lived beneath <a id="_idIndexMarker663"/>some sort <a id="_idIndexMarker664"/>of highly academic rock to have never heard of Microsoft’s flagship ORM. An ORM’s job is to map data between relational <a id="_idIndexMarker665"/>structures in <strong class="bold">Structured Query Language</strong> (<strong class="bold">SQL</strong>) databases such as SQL Server to objects in C#. If a pattern <a id="_idIndexMarker666"/>is a solution to a problem that occurs frequently, this might be the most important pattern in software development.</p>
<p>Implementations of this pattern, usually encapsulated in a third-party library, or in our case, within the .NET Framework, allow developers to work solely with C# objects. With an ORM, you never need to create or update table structures in your application’s database. You never need to figure out complicated joins or concatenate long SQL statements in your code. You create a set of objects that represent your database structure. You then query those model classes and work with data operations to manipulate your database.</p>
<p>The upside is if you don’t know—or don’t like—SQL, you never need to work with it directly. The trade-off is in application performance. EF code is known to run significantly slower at scale than direct connections to the database. It also adds one more layer of dependencies to your application. It’s just one more thing that can go wrong. If you’re sensing I’m not a fan, you’d be right. I like ORMs for small projects with a limited number of users. For example, if you’re making an app for internal use and you have limited time to create it, using an ORM might help you get the job done more quickly.</p>
<p>If on the other hand you are making an application for a large user base, eschewing the convenience of an <a id="_idIndexMarker667"/>ORM in favor of implementing our <a id="_idIndexMarker668"/>next pattern directly gives you tremendous control over performance by allowing you to leverage the full capabilities of your database software.</p>
<h3>Active Domain Object</h3>
<p>The <strong class="bold">Active Domain Object</strong> (<strong class="bold">ADO</strong>) pattern is a fun one because when you see ADO, you probably <a id="_idIndexMarker669"/>think of either Microsoft’s <strong class="bold">ActiveX Data Objects</strong> (<strong class="bold">ADO</strong>) or ADO’s older cousin <strong class="bold">Data Access Object</strong> (<strong class="bold">DAO</strong>). Then <a id="_idIndexMarker670"/>again, that might only be if you’re over <a id="_idIndexMarker671"/>35 years old. It’s been a good while since those <a id="_idIndexMarker672"/>technologies were front and center. </p>
<p>The ADO pattern encapsulates data access and relevant object implementations. Their aim is to remove any direct interaction with the database outside the pattern implementation. Sound familiar? That’s pretty much what Microsoft ADO and DAO were designed to do. I doubt this is a coincidence.</p>
<p>Most developers don’t use this pattern, having generally moved to working with ORMs such as EF. However, if you have SQL skills, you can often make a more performant application by accessing the database directly via native drivers.</p>
<h3>Demand cache</h3>
<p>My wife and kids do this all the time. Just kidding, but not really. There are quite a few cache patterns. A demand cache is embodied by a cache that is populated lazily “on demand”. The main force at <a id="_idIndexMarker673"/>play here is you don’t know when the data <a id="_idIndexMarker674"/>will be needed, but you would like to only pay the price of retrieving the data once.</p>
<p>My application includes a demand cache as part of a web application. Some of the queries in my application return large recordsets or include considerable processing that can take several seconds to complete. That doesn’t sound bad, but for a web application, it is an eternity. My demand cache method checks the cache (which in my case is Redis) first when data is requested. If it’s there, the data is served from the cache. If it isn’t <a id="_idIndexMarker675"/>there, I retrieve and cache it. The first customer to <a id="_idIndexMarker676"/>request the data pays the performance penalty, but every customer after that gets the data very quickly.</p>
<h3>Transaction</h3>
<p>This is another ubiquitous <a id="_idIndexMarker677"/>data processing term that is really a pattern. In database lingo, a transaction refers to multiple SQL statements that must be <a id="_idIndexMarker678"/>completed as a unit. For example, if you have an automatic teller machine and you want to withdraw money from one account and add it to another, you need this to occur as one unit of work—a transaction.</p>
<p>You withdraw $100 from account A and add $100 to account B. If either SQL statement fails, you need to consider the whole transaction a failure and roll back all the changes entirely.</p>
<h3>Optimistic and pessimistic lock</h3>
<p>Nothing drives application developers crazier than dealing with locks in the database. An optimistic lock takes <a id="_idIndexMarker679"/>place in order to prevent missing <a id="_idIndexMarker680"/>database updates. You find this pattern used in <strong class="bold">inventory management systems</strong> (<strong class="bold">IMSs</strong>) where up-to-the-second, on-hand stock data is vital to <a id="_idIndexMarker681"/>selling that inventory. Last <a id="_idIndexMarker682"/>weekend, I bought a new clothes dryer at a popular store. My wife picked out the perfect dryer and the sign above the dryer said, “Order now and you’ll <a id="_idIndexMarker683"/>receive it in 3 days”. The salesman went to enter the order and found the units were not only out of stock, but the manufacturer wasn’t accepting back orders.</p>
<p>The sign assumed stock at the warehouse and was based on stale information. Now, replace the sign with a database query. The sales application queries to see if any dryers are in stock. At the exact same moment, at a store across town, someone else has just purchased the same model of dryer.</p>
<p>How can the clerk at the first store know whether there really is a dryer available? The optimistic lock pattern entails creating a version number on each row in a database table. The database in this scenario will optimistically assume the dryer is available if the row version number hasn’t changed since the transaction started and doesn’t lock the database row for update.</p>
<p>By contrast, in the same scenario, a pessimistic lock will prevent the clerk’s sale from going through if the second clerk’s transaction was in the middle of updating the inventory row data.</p>
<h1 id="_idParaDest-170"><a id="_idTextAnchor169"/>Creating your own patterns</h1>
<p>Do you think you have an idea for your own design pattern? The GoF book presents a boilerplate documentation framework for publishing your own patterns. I won’t duplicate it fully here, but I will outline it for you. It involves four essential elements, as follows:</p>
<ol>
<li value="1">Name and classification</li>
<li>The problem description</li>
<li>The solution description</li>
<li>Consequences of using the pattern</li>
</ol>
<p>Let’s talk a little about each section.</p>
<h2 id="_idParaDest-171"><a id="_idTextAnchor170"/>Name and classification</h2>
<p>Every pattern needs a name that describes the pattern. Most of the patterns out there have names that make <a id="_idIndexMarker684"/>you think of general words from normal language. The word <em class="italic">memento</em> refers to a physical object that invokes memories <a id="_idIndexMarker685"/>of times past. The word <em class="italic">singleton</em> invokes the idea there’s a <a id="_idIndexMarker686"/>single thing. Come up with a short, memorable name that invokes the idea behind the pattern.</p>
<p>You also need a classification. In this book, we observed the three classifications in the GoF book: Creational patterns, Structural patterns, and Behavioral patterns. You saw in the previous sections that other knowledge domains that use patterns have their own lists of classifications. Maybe your pattern fits into an existing classification. If not, you’ll need to invent a new classification.</p>
<p>It is also possible your <a id="_idIndexMarker687"/>pattern might have an alias; an “<strong class="bold">also known as</strong>” (<strong class="bold">AKA</strong>) name. The Decorator pattern is also known as a wrapper. Document any aliases for your <a id="_idIndexMarker688"/>pattern if any exist.</p>
<h2 id="_idParaDest-172"><a id="_idTextAnchor171"/>The problem description</h2>
<p>This section of your documentation describes the problem your pattern aims to solve. When the GoF describe <a id="_idIndexMarker689"/>the problem, they break it into several smaller sections, as outlined here:</p>
<ul>
<li><em class="italic">Intent</em> refers to the <a id="_idIndexMarker690"/>overall goal of your pattern.</li>
<li><em class="italic">Motivation</em>/<em class="italic">Forces</em> outlines why someone would use your pattern. This is deeper than “because it’s cool” or because it solves a particular problem. When we discussed antipatterns in the first chapter, we described a set of forces that caused the <a id="_idIndexMarker691"/>antipattern to come into being. In this section, we’re looking for similar driving factors around why your new pattern is relevant and useful.</li>
<li><em class="italic">Applicability</em> lists the context for the pattern. Make a short list of situations where the pattern is useful.</li>
</ul>
<p>While it isn’t necessary to fill in every single niche, you’ll recognize elements we’ve used in this book.</p>
<h2 id="_idParaDest-173"><a id="_idTextAnchor172"/>The solution description</h2>
<p>When describing the solution, you need to describe the elements used to construct the design. Expound on the <a id="_idIndexMarker692"/>relationships between the elements. Describe how the elements collaborate, and make sure to explain the responsibilities of each element. You might consider breaking this section into smaller chunks as well, as follows:</p>
<ul>
<li><em class="italic">Participants</em> list classes, objects, interfaces, enumerations, and so on that participate in the pattern solution.</li>
<li><em class="italic">Collaboration</em> describes how the participants collaborate.</li>
<li><em class="italic">Structure</em> will contain UML diagrams of a generic form of the pattern, and perhaps a diagram of a more real-life concrete use case. This is the format I have used in every pattern I covered in this book. I find the generic diagrams less useful by themselves. If a concrete example follows, developers can look at both diagrams and more easily relate them to their work.</li>
<li><em class="italic">Implementation</em> contains a description of how to implement the pattern. In this book, I’ve used numbered diagrams to describe how the pieces fit together.</li>
<li><em class="italic">Sample Code</em> or <em class="italic">Pseudocode</em> mostly speaks for itself. I would recommend real-world examples instead of class A inheriting from class B, which uses class C in composition. That’s <a id="_idIndexMarker693"/>too abstract. If you want people to use your pattern, find ways to make it relevant to their work.</li>
</ul>
<h2 id="_idParaDest-174"><a id="_idTextAnchor173"/>Consequences of using the pattern</h2>
<p>You should always discuss the positive outcomes and trade-offs that come with using your pattern. Most <a id="_idIndexMarker694"/>patterns have defenders and detractors. If you read up on patterns on the internet, you’ll see a healthy debate about how some patterns might be antipatterns. We presented such a case when we discussed the Singleton pattern in <a href="B18605_03.xhtml#_idTextAnchor063"><em class="italic">Chapter 3</em></a>. The more complex a pattern, the more likely it is to have trade-offs. The Template Method pattern is extremely simple. I doubt whoever came up with that one lost any sleep over thinking about possible negative outcomes. In contrast, the Façade pattern presented in <a href="B18605_04.xhtml#_idTextAnchor078"><em class="italic">Chapter 4</em></a><em class="italic"> </em> presents a trade-off between the complexity of the third-party framework and ease of use for developers that don’t need everything the third-party framework exposes.</p>
<h1 id="_idParaDest-175"><a id="_idTextAnchor174"/>Not everybody likes patterns</h1>
<p>We demonstrated in <a href="B18605_03.xhtml#_idTextAnchor063"><em class="italic">Chapter 3</em></a>’s coverage of the Singleton pattern that not everybody agrees that patterns are a positive contribution to the field of software development. The usual argument is design patterns are simply workarounds for incapable, inefficient, or incomplete OOP languages. Academic literature has shown as many as 17 of the 23 patterns within the GoF book become unnecessary when you use languages such as <strong class="bold">List Processing</strong> (<strong class="bold">LISP</strong>) or Dylan. What? Who even uses those?</p>
<p>Another group of <a id="_idIndexMarker695"/>academic detractors advocates switching your paradigm from OOP to <strong class="bold">aspect-oriented programming</strong> (<strong class="bold">AOP</strong>) as a solution to all your problems. As you’re hopefully aware, OOP aims to solve problems by modeling things in the real world. AOP aims to model behavior as crosscutting concerns. AOP is not supposed to be a competitor with OOP, yet some arguments place it that way.</p>
<p>The bottom line is there will always be a debate that says “If you would only switch to language X, framework Y, or paradigm Z, all your pattern problems will be solved!” My retort to that is to remind you to beware of the Golden Hammer!</p>
<h1 id="_idParaDest-176"><a id="_idTextAnchor175"/>Summary</h1>
<p>Patterns are everywhere. There is a field called biomimicry that aims to study technology inspired by patterns in nature. It’s difficult to talk about software development anymore without bringing up <strong class="bold">artificial intelligence</strong> (<strong class="bold">AI</strong>), whose main job is to find patterns in massive amounts of data using techniques called <strong class="bold">machine learning</strong> (<strong class="bold">ML</strong>). The software industry has been humming along now since 1843 when Ada Lovelace wrote what most consider to be the first computer program. In that time, we have collectively run into the same challenges and frustrations over and over again. Eventually, we got smart enough to start writing things down and talking about them.</p>
<p>We’ve been learning patterns, which at their core are really just a way of communicating our best ideas as they relate to organizing and optimizing our code.</p>
<p>In this chapter, we briefly covered the patterns from the original GoF book that we didn’t cover in the earlier chapters as part of this book’s story. I left these patterns out for one or two reasons in each case, as follows:</p>
<ul>
<li>If a pattern was remarkably similar to another pattern already covered, I didn’t cover it. The State pattern is very similar to the Strategy pattern. The Strategy pattern fit my story, so that’s the one I used.</li>
<li>If a pattern was very complicated and rarely used, I didn’t cover it. The Memento pattern is a good example. There are easier ways to handle the use case of representing snapshots of objects such as .NET’s serialization features that negate the need for a complicated Memento pattern implementation.</li>
</ul>
<p>We went beyond GoF patterns, and even beyond OOP patterns to list some common and highly familiar patterns in other domains of software and database architecture. We concluded with a synopsis of how you might go about documenting your own patterns should you ever discover a new one. I left you in this chapter with a final warning. You’re going to be tempted to close this book and run through the office like a crazy person yelling “PATTERNS!” everywhere you go. Don’t laugh. I’ve seen it happen. If you do this, expect some eye rolls. Not everybody thinks patterns are a good idea, and sometimes they are right. Patterns themselves can easily succumb to the Golden Hammer antipattern. Remember—patterns are here to simplify and improve your software. If they make things slower or more complicated, you must abandon them in those cases. Patterns are tools, not dogma.</p>
<p>There’s just one loose end to tie up.</p>
<h1 id="_idParaDest-177"><a id="_idTextAnchor176"/>Sundance Square – Fort Worth, Texas</h1>
<p>It was a hot spring day in Fort Worth, Texas. And it was the last day of the MS-150 bicycle rally. The MS-150 is an event that generates millions of dollars per year toward research into a cure for <strong class="bold">multiple sclerosis</strong> (<strong class="bold">MS</strong>). Thousands of cyclists in the Dallas area ride in the 150-mile, 2-day event. Most of the local bike shops have tents set up in Sundance Square, a shopping and entertainment district in the heart of Fort Worth. Bumble Bikes, being a platinum sponsor, has a large tent set up at the finish line.</p>
<p>Tom, Lexi, and Karina are working the tent, giving water and high-fives to the intrepid few that cross the finish line. While upward of 3,000 riders start the rally, fewer than 10% actually finish. Most quit along the way when their knees give out or their equipment breaks. Tom and Lexi are watching keenly for a group of riders who they fully expect to finish dead last. It’s a rally, not a race. The people who ride aren’t competing against each other—they’re competing with themselves to see if they have what it takes to complete the course. They start in Plano on day 1 and pedal 75 miles to Texas Motor Speedway where local <strong class="bold">National Association for Stock Car Auto Racing</strong> (<strong class="bold">NASCAR</strong>) races are held. The next day they start again but first, they do a lap on the speedway, then ride 75 more miles into Fort Worth.</p>
<p>“<em class="italic">There they are!</em>”Lexi yells as she squints toward the top of a hill in the distance. <em class="italic">Team Bumbles</em> is cresting the hill, all riding brand new Hillcrest bicycles: Kitty, Phoebe, and most of the Bumble Bikes employees, along with Kitty and Phoebe’s father.</p>
<p>10 years have passed since his diagnosis. The chemotherapy and steroids had been ineffective in treating the disease. In fact, the steroids had caused a severe case of osteoporosis. The doctors had given up, saying there was nothing further that could be done. Kitty and Phoebe had prayed countless times, ultimately joined by an informal coalition of local churches.</p>
<p>The wheelchairs Kitty and Phoebe built were extremely helpful. They had built and distributed over 1,000 wheelchairs free of charge to children’s hospitals all over the world. Bicycle and wheelchair sales at Bumble Bikes grew steadily until it became the number 3 bicycle manufacturer in the world, and the only company to produce its products in the <strong class="bold">United States</strong> (<strong class="bold">US</strong>). MegaBikeCorp, the company where Kitty and Phoebe interned all those years ago, was ranked at number 19.</p>
<p>Their father had been using his <em class="italic">Texas Tank</em> for many years. The design had proved too expensive to mass produce, so they only made one. As much as he loved his <em class="italic">Tank</em>, every day he made it a practice to try to stand up. Most days he fell down. Until one day, he didn’t.</p>
<p>As suddenly as it had started, one day it stopped. The doctors could not explain it. They had run out of ideas years ago. Kitty and Phoebe knew their prayers had been answered.</p>
<p>It took years of physical therapy. Electrical shock therapy was needed to get their father’s voice box working again after the disease had nearly destroyed the muscles in his throat. He took shots in the stomach every day for 2 years to cure the osteoporosis. He took short walks—a few blocks at first, but later it was a few miles. Month after month, and year after year, he got a little stronger. He traded his <em class="italic">Texas Tank</em> for one of Bumble Bikes’ new electric bicycles with a motor. Tom was happy to take the <em class="italic">Tank</em> off his hands. The new electric bike offered a motor to assist with pedaling. The motor didn’t do all the work—it just helped.</p>
<p>Eventually, he was able to ride a normal bicycle again, and today, he had ridden it 75 miles to the finish line with his daughters and a small armada of handicapped riders. Bumble Bikes had produced a hand-cranked bicycle for riders who couldn’t use their legs and invited any rider who didn’t have such a bicycle to ride with <em class="italic">Team Bumbles</em>.</p>
<p>Everyone in the square stopped what they were doing and cheered as they saw the <em class="italic">back of the pack</em>, followed by a police escort crossing the line. It had been a very long road, not just because 75 miles is a long way to ride a bicycle in 1 day. The finish line meant so much more than the end of the rally. Most importantly, they crossed it as a family.</p>
<h1 id="_idParaDest-178"><a id="_idTextAnchor177"/>Further reading</h1>
<ul>
<li><a href="https://www.redhat.com/architect/14-software-architecture-patterns">https://www.redhat.com/architect/14-software-architecture-patterns</a></li>
<li><em class="italic">Nock, Clifton. Data Access Patterns: Database Interactions in Object-Oriented Applications. Boston: Addison-Wesley, 2004.</em></li>
<li>The companion website for this book: <a href="https://csharppatterns.dev">https://csharppatterns.dev</a></li>
</ul>
</div>
</div>


<div id="sbo-rt-content"><div id="_idContainer165">
<h1 id="_idParaDest-179"><a id="_idTextAnchor178"/>Appendix 1: <a id="_idTextAnchor179"/>A Brief Review of OOP Principles in C#</h1>
<p>The landscape of programming languages contains hundreds of choices. If you’re reading this book, you have probably come across C# at some point along your journey. For some, C# is the only language they’ve ever learned. For others, it’s the third or fourth. Maybe you develop in C# every day and have for many years, or maybe you’ve just picked it up, and it’s now your new best friend.</p>
<p>I realize that readers will be coming to this book with different levels of experience, different backgrounds, and different career objectives. I used to have a very popular video series published on LinkedIn Learning that was designed to teach C# to beginners. To be honest, this has always been my favorite audience. Teaching software development to newbies is like teaching magic in a jaded world sadly short of vision. I get to see <em class="italic">Aha!</em> moments nearly every week with my students at Southern Methodist University, where I teach at the Full Stack Code boot camp.</p>
<p>One of the things that excited me about the prospect of writing this book is this book helps you take the next step. Either you’ve just learned how to code or maybe you’ve been using the same magic tricks for many years with success, but you realize there’s still more to learn. Patterns are a great next step. Learning patterns makes you better at almost everything else in programming.</p>
<p>The problem here is that I don’t know where you are in your journey. If you’re a student of mine from SMU, you’ve learned JavaScript really well and you want to take the next step. C# is radically different from JavaScript. Jumping into this book from only knowing JavaScript would be hard, but not impossible. If you’re self-taught, you’ve probably focused on what I call “survival skills.” They include basic OOP plus how to work with a database and probably web technologies. If you’re in a university, and you’re learning how to code, your textbooks are likely not very illuminating. I know. I’ve taught at colleges and universities for 25 years. Usually, I write my own material because of the dearth of good books out there.</p>
<p>No matter where you are right now, or where you came from, this chapter is here to orient you. Originally, I had intended this to be the second chapter of this book. My editor wisely suggested we get into working with patterns as quickly as possible. She suggested an appendix, which we’ve mentioned throughout the book. You’ll either get a good review or a crash course in C#.</p>
<p>In this appendix, you can expect to learn the following:</p>
<ul>
<li>A quick background on C# and how the language can be defined along a number of lines of taxonomy. That sounds fancy, but you’ll see it’s fairly basic.</li>
<li>The syntax mechanics of C# with enough length and detail to get you through this book. Since this book mainly deals with plain old C# objects (POCOs) and a few common types from .NET Framework such as Lists, this section is possible. </li>
<li>How to set up the projects in the book using three common IDEs in Windows. There are two project types we use: command-line projects and libraries.</li>
<li>How to clone the sample code projects covered in the book.</li>
</ul>
<p>Let’s get started!</p>
<h1 id="_idParaDest-180"><a id="_idTextAnchor180"/>Technical requirements</h1>
<p>This appendix is largely an overview of basic topics rather than a collection of projects. With that said, at the end of the appendix, you are guided in the use of the three most popular C# IDEs on the market today. You’ll have a choice to make. Regardless of which IDE you choose, you’ll need a computer running the Windows operating system. I’m using Windows 10. The projects used in this book probably work fine on a Mac or in Linux, but I didn’t test them there, so your mileage might vary.</p>
<p>To follow the IDE tutorials at the end of this chapter, you’ll need the following:</p>
<ul>
<li>One of these IDEs:<ul><li>Visual Studio</li>
<li><strong class="bold">Visual Studio Code</strong> (<strong class="bold">VS Code</strong>)</li>
<li>JetBrains Rider</li>
</ul></li>
<li>.NET Core 6 SDK</li>
</ul>
<p>You can find the completed project files for this chapter on GitHub at <a href="https://github.com/Kpackt/Real-World-Implementation-of-C-Design-Patterns/tree/main/appendix-1">https://github.com/Kpackt/Real-World-Implementation-of-C-Design-Patterns/tree/main/appendix-1</a>.</p>
<h1 id="_idParaDest-181"><a id="_idTextAnchor181"/>A quick background of C#</h1>
<p>Let me <a id="_idIndexMarker696"/>just say it out loud right off the bat: C# is a knock-off of Java. If you know Java, but not C#, you’re going to have a very easy time. Now, pretend I didn’t lead with that and allow me to slip on my corduroy sport coat. The one with the patches on the elbows. I have a tobacco pipe in the front pocket of the jacket sticking up so that you can see it. Naturally, in this day and age, nobody would dream of putting tobacco or anything else into it. That’d be wrong. But I need to look as much like a college professor as possible, so I can go all historical on you for a bit.</p>
<p>The C# language is Microsoft’s flagship language product for corporate and game programming. It was designed by Anders Hjlsberg in the year 2000 AD. Some of my students claim I am ancient, so I figured I’d clarify by stating that it is, in fact, AD and not BC. The <a id="_idIndexMarker697"/>language was submitted and approved as a standardized language via the <strong class="bold">European Computer Manufacturers Association</strong> (<strong class="bold">ECMA</strong>). You might know this is as the same body that standardized JavaScript, which is really called ECMAScript. Many languages are standardized. This simply means that there is an open specification available for the language and that it is possible for others to create a competing implementation of a language based on the specification. C# is Microsoft’s implementation. There is an open source competitor called Mono that used to be popular in several arenas, including cross-platform mobile and game development.</p>
<p>When Microsoft introduced C#, it also released .NET Framework and Visual Studio. .NET Framework is a massive set of libraries that provides a language support infrastructure for C# along with other Microsoft languages. Each language supported can compile its code <a id="_idIndexMarker698"/>into an intermediate format. The intermediate form at, called <strong class="bold">Microsoft Intermediate Language</strong> (<strong class="bold">MSIL</strong>), can then execute using the .NET runtime. This makes the overall language architecture very similar to Java, which compiles to an intermediate form called bytecode, which is then executed on<a id="_idIndexMarker699"/> a <strong class="bold">Java Virtual Machine</strong> (<strong class="bold">JVM</strong>).</p>
<p>The stated design goals for the language include the following:</p>
<ul>
<li>A <a id="_idIndexMarker700"/>simple, general-purpose, object-oriented language</li>
<li>Support for a strong, statically typed variable system</li>
<li>Automatic bounds checking on array types and the detection of uninitialized variables</li>
<li>Automated garbage collection</li>
<li>Source code portability; code should be executable in a variety of environments without changing the code significantly and without recompiling</li>
</ul>
<p>Let’s expand on these ideas.</p>
<h2 id="_idParaDest-182"><a id="_idTextAnchor182"/>C# is a general-purpose language</h2>
<p>Pretty much <a id="_idIndexMarker701"/>everyone has heard of an invention created by Richard Clyburn in 1842. I present you with an adjustable wrench in <em class="italic">Figure A.1</em>:</p>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><img alt="Figure A1.1: An adjustable wrench. You can use this for almost any wrenching job. If you’re in a jam, you can also use it to open bottles and drive nails. It’s a general-purpose tool just like the C# language, which can be used to make almost any kind of software " height="228" src="image/Figure_A1.1_B18605.png" width="761"/></p>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A1.1: An adjustable wrench. You can use this for almost any wrenching job. If you’re in a jam, you can also use it to open bottles and drive nails. It’s a general-purpose tool just like the C# language, which can be used to make almost any kind of software</p>
<p>We call them <em class="italic">crescent wrenches</em> in the US, while many other countries refer to them as <em class="italic">spanners</em>. This wrench is a general-purpose wrench. It can be used for a variety of tasks befitting a wrench from the loosening and tightening of metal fasteners on your IKEA furniture to installing a new engine in your ‘57 Chevy, to installing a new garbage disposal for your kitchen sink.</p>
<p>Now consider the wrench in <em class="italic">Figure A1.2</em>:</p>
<div>
<div class="IMG---Figure" id="_idContainer125">
<img alt="Figure A1.2: This is a basin wrench. It’s only good for one thing: tightening down fastening nuts on faucet hardware under a sink. It is a special-purpose tool just like SQL is a special-purpose language. Both can only be used for one purpose " height="215" src="image/B18605_Figure_A1.2.jpg" width="640"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A1.2: This is a basin wrench. It’s only good for one thing: tightening down fastening nuts on faucet hardware under a sink. It is a special-purpose tool just like SQL is a special-purpose language. Both can only be used for one purpose</p>
<p>You might have never encountered one of these before. This odd-looking contraption is called a <em class="italic">basin wrench</em>. It has only one job. It is used to tighten the faucet coupling when installing a new kitchen or bathroom sink. The wrench head pivots across 180 degrees, so you can maneuver it around all the pipes. The long handle helps you deal with the sink bowl that protrudes downward, blocking your access were you to attempt this with a general-purpose wrench.</p>
<p>Likewise, there exist a few special-purpose languages, the most popular being <strong class="bold">Structured Query Language</strong> (<strong class="bold">SQL</strong>). SQL is <a id="_idIndexMarker702"/>only used to query relational databases. You can’t make a video game or an operating system with it.</p>
<p>On the other hand, C# is a general-purpose language. It can be used to make just about anything from line-of-business software to AAA video games. And yes, someone did once try to make an operating system with C# <a id="_idIndexMarker703"/>called <em class="italic">SharpOS,</em> showing us that it is possible to write an operating system with C#.</p>
<p>The <a id="_idIndexMarker704"/>biggest reason to choose C# as your main language of choice is the flexibility. Coupled with .NET Framework, you have thousands of building blocks. You can use them to build whatever software you might need.</p>
<h2 id="_idParaDest-183"><a id="_idTextAnchor183"/>C# is purely and fully object-oriented</h2>
<p>There<a id="_idIndexMarker705"/> are two major paradigms that you’ll see in programming languages: OOP and functional programming languages. Perhaps a third paradigm<a id="_idIndexMarker706"/> occurs when it is possible to mix the two within a <a id="_idIndexMarker707"/>single language. Let’s cover the differences:</p>
<table class="No-Table-Style _idGenTablePara-1" id="table001-1">
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><strong class="bold">OOP</strong></p>
</td>
<td class="No-Table-Style">
<p><strong class="bold">Functional programming</strong></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p>Code is organized into classes as the primary building block of your program.</p>
</td>
<td class="No-Table-Style">
<p>Code is organized into distinct functions, which use their arguments in place of properties.</p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p>Methods often have side effects. They can change the state of the object from within the method.</p>
</td>
<td class="No-Table-Style">
<p>Pure functions never have side effects.</p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p>In OOP, we have support for mutable and immutable objects.</p>
</td>
<td class="No-Table-Style">
<p>Function programming never supports mutable variables. If you want to change something, you have to create a new variable.</p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p>Data is stored in properties within the object and is prioritized from a design perspective above methods that often serve only to mutate the state of the object.</p>
</td>
<td class="No-Table-Style">
<p>The design goals are focused on functions. They take immutable inputs and produce an output.</p>
</td>
</tr>
</tbody>
</table>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A1.3: The difference between OOP and functional programming.</p>
<p>Some<a id="_idIndexMarker708"/> languages, such as C# and Java, are strictly object-oriented. Languages such as Haskell and F# are strictly functional, while languages such as JavaScript, Python, and PHP can support either or both paradigms. The <a id="_idIndexMarker709"/>original <strong class="bold">Gang of Four</strong> (<strong class="bold">GoF</strong>) software design patterns, which are the focus of this book, were built around OOP using a language<a id="_idIndexMarker710"/> called <em class="italic">SmallTalk</em>. Naturally, we’ll keep our focus strictly on OOP.</p>
<h2 id="_idParaDest-184"><a id="_idTextAnchor184"/>C# uses a static, strong type system </h2>
<p>There are<a id="_idIndexMarker711"/> three schools of thought with respect to type systems. First, let me tell you what I mean<a id="_idIndexMarker712"/> by a <strong class="bold">type system</strong>. Programming languages share a common purpose: they all take some sort of input and turn it into some sort of output. The input and output for the program <a id="_idIndexMarker713"/>are called <strong class="bold">data</strong>. There are three basic types of data as far as your computer is concerned.  </p>
<p><strong class="bold">Strings</strong> are<a id="_idIndexMarker714"/> alphanumeric data – think letters and numbers. If you can type it on your keyboard, it is alphanumeric.</p>
<p>The second type of data is <strong class="bold">numbers</strong>. I think<a id="_idIndexMarker715"/> you know what this means. While numbers can be alphanumeric strings, you can’t use strings to do math. This distinction is at the heart of a strong type system, so remember this for just a moment.</p>
<p>The third basic type of <a id="_idIndexMarker716"/>data is <strong class="bold">booleans</strong>. Booleans are binary, meaning they can have a value of either true or false. Sometimes, the value is expressed as 0 (false) and 1 (true), or 0 (false) and not 0 (true).</p>
<p>The three basic types are <a id="_idIndexMarker717"/>called <strong class="bold">primitive data types</strong>. In a <strong class="bold">strong type system</strong>, you have to <a id="_idIndexMarker718"/>tell your program what kind of data you will be using when you declare a variable or create a function.</p>
<p>Beyond primitive types, C# supports the ability to create your own types as objects. Like primitives, these types are strong. They are also static. A <strong class="bold">static type system</strong> means that when you say you are going to use a variable to<a id="_idIndexMarker719"/> hold a string, you can never change the variable to any other type. It is static, meaning it can never change its type.</p>
<p>While C# and many other languages use a strong and static type of system, other languages do not. JavaScript took the opposite approach. JavaScript uses a weak and dynamic type of system. In such a system, it is perfectly fine and normal to create a variable and assign a value of any type. Let’s say we create a variable called <em class="italic">foo</em> and set it equal to “this is a string.”</p>
<p>The<a id="_idIndexMarker720"/> very next line can assign a value of 9 to the variable of <em class="italic">foo</em>. The fact that you didn’t have to declare a type with the variable indicates a <strong class="bold">weak type system</strong>. The<a id="_idIndexMarker721"/> fact you can change the type any time you’d like indicates a dynamic type system. JavaScript is incredibly powerful and flexible, but it also feels very foreign for developers who learn a strong static system leading to the idea that JavaScript is a “toy language” and not for serious work. This is, of course, wholly false.</p>
<p>The third type of system that you’ll encounter is called duck typing. Likely the most famous system using duck typing is Python. In Python, you see the middle ground between strong static typing in C# and the weak dynamic system in JavaScript.</p>
<p>In Python, you don’t declare a type with your variables. However, the Python interpreter observes how the variable is used, and it infers a strong type. This kind of system is called duck typing because the designers who created this type of system claimed “If it walks like a <a id="_idIndexMarker722"/>duck and quacks like a duck, it’s a duck.”</p>
<p>Later versions of C# support also duck typing, so we’ll see some examples later.</p>
<h2 id="_idParaDest-185"><a id="_idTextAnchor185"/>C# has automatic bounds checking and detection for uninitialized variables</h2>
<p>C# was created to correct <a id="_idIndexMarker723"/>deficiencies in other languages. You hear that for <a id="_idIndexMarker724"/>pretty much every new language created in the last 20 years. Some group hates the way something works in C or Java, so they make a new language. Usually, they are an amalgamation of the so-called good parts of other languages. If you don’t believe me, read up on Apple’s <em class="italic">Swift</em> language, the <em class="italic">Rust</em> language, or the <em class="italic">Golang</em> languages created by Google. C# isn’t any different.</p>
<p>Studies have shown that the lack of bounds checking and uninitialized variables are both major sources of software bugs. Really, then, the objective here is to create a language that makes it harder for developers to make mistakes. In the next few features, we’ll discuss embodying this goal.</p>
<p>Bounds checking refers to arrays. An array is a<a id="_idIndexMarker725"/> special type that allows you to store multiple values in a single variable. Since C# is strongly typed, array elements must all be of the same type. You can have an array of strings, an array of numbers, or an array of objects. Furthermore, in C# when you define an array, you must tell your program how many elements you will put into the array. Once you set it, the size is fixed and you can’t change it without jumping through some proverbial hoops.</p>
<p>Uninitialized variables are not just representative of sloppy work – in some programming languages they can be dangerous. The C programming language comes to mind here. C went through some drastic changes over the last 10 years, but back when I was your age, the mantra of C was “With great power comes great responsibility.” I think that’s also Spiderman’s mantra. Maybe Peter Parker should have been a coder instead of a photographer.</p>
<p>In C, as in most languages, a variable is just a pointer to an address in memory. Computer memory is a lot like an apartment complex. In fact, older versions of C# and Visual Basic called their memory models “apartment threading.” Apartments are containers for you and your stuff. Some apartments are small and economical (unless you live in New York City, in which case they are simply small). Others are larger and more expensive. Regardless of their size, shape, and decor, their function is to hold you and your stuff.</p>
<p>Each apartment in an apartment complex has an apartment address number. So, you can effectively say <em class="italic">I want to put my stuff in apartment 122</em>. If you get a raise at work, and you decide to upgrade, you can move your stuff into apartment 300, which is larger. The address tells us where your stuff is located, and the manager of your apartment building knows how big each apartment is and how much it costs. </p>
<p>Computer<a id="_idIndexMarker726"/> memory works the same way. There are registers of <a id="_idIndexMarker727"/>addresses (such as the apartment complex) that can be told to store stuff of varying sizes. We can extend our analogy to say the apartment manager is the computer running your program. It knows where the containers are since it keeps a list of each apartment’s address and how much space each apartment occupies.</p>
<p>The addresses are not simple numbers such as 122 or 300. They are a bit more complicated and are not easy to work with. So, instead of dealing with addresses, we can give our apartments, or containers, a straightforward human-sounding name that describes how your variable is being used in your program.</p>
<p>When you create a container, such as an apartment, of a defined size (small and cheap versus big and expensive), it has an address. But instead of using that, you use whatever name you think is easy to use and remember.</p>
<p>Now imagine an apartment that was built as part of the building, but it is full of construction debris and trash left over from when it was built. Nobody has ever rented the apartment, so nobody has ever cleaned up the mess. This is an uninitialized variable. If someone wanted to rent the apartment and move in on the same day, that is, access the address, they would find it’s full of trash. When a running program with a strong static type system encounters trash that it doesn’t expect, the program crashes. If you have ever encountered <a id="_idIndexMarker728"/>a <strong class="bold">blue screen of death</strong> (<strong class="bold">BSOD</strong>) in Windows, you know what this looks like. Uninitialized variables will have whatever junk was left over from the last time that memory address was used. Back in the day, a major headache of working with C was manually allocating and deallocating memory. If you did it wrong, things crashed in the least graceful way possible. What the C developers really need is some way to handle garbage collection.</p>
<h2 id="_idParaDest-186"><a id="_idTextAnchor186"/>C# supports automated garbage collection</h2>
<p>The nightmare scenario<a id="_idIndexMarker729"/> we just covered shows the need for language improvements. C# is meant to be simple and useful. In C, back when C# was conceived, we were manually allocating memory addresses. This meant executing a statement that defined your allocation using a hexadecimal value. Most humans are doing well working in base 10. Our old environments had us mentally converting decimal (base 10) numbers into base 8 (octal) and base 16 (hexadecimal) to do our memory allocations. Then, we used that memory, and when we were done, we needed to remember to deallocate the memory. In our apartment metaphor, this would entail moving out of the apartment and giving it thorough cleaning in the process. The apartment should be move-in ready when we deallocate.</p>
<p>What if we had a language that handled allocation and deallocation automatically? We do. C# has a garbage collection system that handles everything for you. You create a variable, and the details are taken care of by the .NET runtime. When your variable goes out of scope, it gets marked for cleanup and, ultimately, the garbage collection process in the runtime deallocates and cleans up the memory for you. As you can imagine, the manual allocation and deallocation of memory in a system that had no safety net was also a major source of bugs.</p>
<h2 id="_idParaDest-187"><a id="_idTextAnchor187"/>C# code is highly portable</h2>
<p>The C# language <a id="_idIndexMarker730"/>specification aims at having portable code. In the earliest versions of C# and .NET, we weren’t very portable. Windows was all we had. You couldn’t run C# code on a Mac, Linux, or a phone. Gaming consoles were also out.</p>
<p>The open source community created Mono, an open source version of C# designed to run on Linux operating systems, but it has always been several years behind Microsoft’s implementation in C#. Eventually, Mono became a very popular way for C# developers to leverage their language skills to create mobile applications for the Android and iPhone platforms using Mono alongside a framework called Xamarin.</p>
<p>A game development engine called Unity 3D<a id="_idIndexMarker731"/> also leveraged Mono and brought a AAA quality game engine to the mass market. Up until then, game engines such as Unreal were strictly in-house. The only way to develop a quality game was to work at a company that could afford the very expensive SDKs. Unity 3D busted the game development industry wide open, and they used C#/Mono to do it.</p>
<p>As time moved on, Microsoft made each iteration of the language more portable. We saw a big shift when Microsoft announced its Azure cloud platform. They wisely understood most IT professionals were never going to use a system that limited them to Microsoft products. Linux owns the majority share of web servers. When cloud computing started to reach critical mass in terms of popularity, we saw a huge proliferation of open source compatibility introduced into Microsoft’s landscapes including .NET Core, which allows us to compile and run C#, or any .NET language, to run on nearly any type of hardware environment making your code truly portable. The portability comes from the .NET runtime. Let me explain what that means.</p>
<p>There are a few different ways any given programming language is able to execute code. First, there is code that can be compiled into native machine code. For this, you need a language such as C, C,++, or Rust. Programs that can be compiled this way run on “the bare metal,” making them very fast in terms of execution, but the languages required for this are typically more demanding to use. C and C++ require you to keep tabs on your memory utilization, which is the primary source of bugs written in these tools. Rust aims to eliminate memory errors with very strict compile time restrictions. Using these languages can be frustrating, and your time to market is usually slower, especially when adopting these languages for the first time. There’s a trade-off between developer productivity and the performance of the software when it runs for the users.</p>
<p>The second <a id="_idIndexMarker732"/>camp is languages that use interpreters. Usually, these languages are scripting languages such as Python, PERL, and Lua. These languages are built around developer productivity and, typically, sacrifice execution speed and efficiency.</p>
<p>The third group is sort of in-between. All .NET languages, in a similar fashion to Java, compile to an intermediary binary format. Java calls this byte code. C# and other .NET languages <a id="_idIndexMarker733"/>call it <strong class="bold">Common Intermediate Language</strong> (<strong class="bold">CIL</strong>). These binary formats execute faster and more efficiently than an interpreted language, but they do require a runtime to execute the intermediate form.</p>
<p>It is important to remember how the published version of code in any given language might perform. On the whole, compiled C# code is generally slower than the “bare metal” compiled languages, but not by much.</p>
<h1 id="_idParaDest-188"><a id="_idTextAnchor188"/>Language mechanics in C#</h1>
<p>We’ve <a id="_idIndexMarker734"/>mentioned already that C# is strictly an <strong class="bold">object-oriented programming</strong> (<strong class="bold">OOP</strong>) language. OOP languages<a id="_idIndexMarker735"/> support a set of abstract features, which you need to understand before we can continue. Firstly, OOP languages organize code differently than procedural languages. In OOP, we model elements from the real-world using code. The real-world elements are described using <strong class="bold">properties</strong>, <strong class="bold">methods</strong>, and <strong class="bold">events</strong>.</p>
<p>For example, if I were modeling a circle, I might give it a set of properties as seen in Figure A1.3:</p>
<div>
<div class="IMG---Figure" id="_idContainer126">
<img alt="Figure A1.4: A circle, like anything else, can be represented by describing it as a set of properties " height="425" src="image/B18605_Figure_A1.3.jpg" width="1650"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A1.4: A circle, like anything else, can be represented by describing it as a set of properties</p>
<p>Using these properties, I can describe any circle I might want to draw on the screen in my program.</p>
<p>Effectively, properties<a id="_idIndexMarker736"/> are variables that belong to the circle. They contain the data that describes the circle. When describing a variable that belongs to an object, you refer to these as <em class="italic">properties</em>, <em class="italic">member variables</em>, or <em class="italic">members</em>.</p>
<p>Additionally, objects <a id="_idIndexMarker737"/>describe the actions they might perform. When we talk about functions in the context of OOP, we call them methods. We could say our circle object has a method called <strong class="source-inline">draw()</strong> that draws the circle to the screen given the properties that describe it. We could also add a method to resize the circle. Methods are the same thing as functions, so we can pass in arguments. Our resize method will need to know the new radius of the circle. It might be called this way: <strong class="source-inline">resize(100)</strong>. This would change the radius of the circle from 200 to 100. </p>
<p>Objects<a id="_idIndexMarker738"/> also commonly have a specialized set of methods designed to respond to events. Events can be described as <em class="italic">things that happen</em> while your program is running. Common examples might include the user clicking on the circle, hovering a cursor over the circle, right-clicking on the circle with your mouse, long-tapping the circle on a touch screen, or the passage of time. Maybe you want the circle to disappear after 10 seconds.</p>
<p>It isn’t necessary for an object to have all of these pieces. Some objects only represent data using properties. Some are just used for constants and methods, such as the <strong class="source-inline">Math</strong> class in C#. However, most of the time, there is a mixture.</p>
<p>In addition to <a id="_idIndexMarker739"/>objects being organized with properties and methods, there are a few other buzzwords to learn:</p>
<ul>
<li>Encapsulation</li>
<li>Composition</li>
<li>Inheritance</li>
<li>Polymorphism</li>
<li>Open recursion</li>
</ul>
<p>All of this sounds horribly complicated, but don’t worry, that’s what I’m here for. We’ll touch on all of these concepts within this chapter. </p>
<p>OOP first surfaced in the 1980s with the Ada programming language. Ada<a id="_idIndexMarker740"/> was named for programming pioneer August a Ada King, Countess of Lovelace. You’ve probably heard of her as Ada Lovelace. The language that bears her name was created under contract for the US <strong class="bold">Department of Defense</strong> (<strong class="bold">DoD</strong>) and <a id="_idIndexMarker741"/>was designed to replace over 450 disparate programming languages that were in use at the DoD at the time. As you can imagine, it had some big shoes to fill. The Ada language is to programming what the Tucker automobile was to the American automotive industry. The 1948 Tucker automobile was the first to offer standard seat belts, a water-cooled aluminum engine, disk brakes, fuel injection, and an independent suspension. These are all standard features of modern cars, and we’d be hard-pressed to consider buying a car today without them. However, they didn’t exist on cars designed and built in the 1940s, or certainly not all on one car.</p>
<p>The original <a id="_idIndexMarker742"/>Ada language supported object orientation, design by contract, strong typing, an explicit syntax for concurrency, tasks, message passing, encapsulation using private and protected classes, and code safety enforced by a compiler. Sound familiar? Many modern languages, including C#, include these features out of the box owing largely to the virtues embodied in Ada.</p>
<p>OOP became<a id="_idIndexMarker743"/> popular because it allows you to organize your software in a way that makes sense and is easy to comprehend. Developers who learn OOP first have trouble switching away from it. Having worked with both kinds of thinking for many years, I believe OOP is the best way to create large-scale software projects because it forces you to think a certain way. The main tenets of OOP, some of which are covered in SOLID principles, are like a built-in way to make your software maintainable, testable, and extensible in the safest way possible. I believe it is important to use an object-oriented language when you initially learn patterns. The original work on patterns was based on Java, which is remarkably similar to C#. Many of the ideas presented in this book won’t work or must be shoehorned into working with non-object-oriented, multi-paradigm, or dynamic languages. For example, JavaScript ES5 is considered object-oriented, but objects are dynamic. By this, I mean you can change the structure of any object, including those internally supported by the language at any time while your code is running. You can even alter all instances of an object owing to JavaScript’s use of prototype inheritance. JavaScript is weakly typed, and the list of types it supports is limited. Classes and encapsulation simply don’t exist in ES5. It is difficult to study patterns in a language such as this because patterns require a foundational set of restrictive rules, which don’t fully exist in many other languages.</p>
<p>By choosing to work with C#, you align yourself with all the key tenets of developing software with well-known, battle-tested patterns.</p>
<h2 id="_idParaDest-189"><a id="_idTextAnchor189"/>Variables in C#</h2>
<p>I consider <a id="_idIndexMarker744"/>the simplest <a id="_idIndexMarker745"/>definition of a variable to be as follows:</p>
<p><em class="italic">A variable is a named container that holds data in computer memory.</em></p>
<p>When you learn a programming language, you need to know whether the language is strongly or weakly typed.</p>
<p>In a <strong class="bold">strongly typed</strong> language, also<a id="_idIndexMarker746"/> referred to as a statically typed language, you<a id="_idIndexMarker747"/> must define your <a id="_idIndexMarker748"/>variables’ data type. You have to tell your program what kind of data you are storing in any given variable. </p>
<p>In a <strong class="bold">weakly typed language</strong>, you <a id="_idIndexMarker749"/>don’t need to declare a type because, effectively, there is only one type: everything is an object.</p>
<p>Here is a great way to think of it. Data can have a shape, as can a container. Containers also have a definite size. You cannot fit one pound of sugar into a container designed to hold no more than a quarter of a pound. However, you can fit that same pound of sugar into a 5-gallon bucket with room to spare.</p>
<p>C# is statically typed with support <a id="_idIndexMarker750"/>for <strong class="bold">implicit typing</strong>, also known as <strong class="bold">duck typing</strong>. In a<a id="_idIndexMarker751"/> strongly typed language such as C#, you would see something like this:</p>
<p><strong class="source-inline">int myNumber = 5;</strong></p>
<p>Here, we’re creating a variable called <strong class="source-inline">myNumber</strong>, of type <strong class="source-inline">int</strong>, and setting it to an initial value of <strong class="source-inline">5</strong>. </p>
<p>Implicit typing allows us to make a small change:</p>
<p><strong class="source-inline">var myNumber = 5;</strong></p>
<p>Instead of the type declaration appearing before the name, you use a one-size-fits-all keyword, <strong class="source-inline">var</strong>. The compiler will see these statements as identical. The compiler can figure out what type your variable is supposed to be based on its initial assignment. Here, we see an initial assignment of 5, so the compiler will assume you meant this to be an integer (<strong class="source-inline">int</strong>). If that’s not what you wanted, you can give the compiler a hint. Let’s say we really wanted <strong class="source-inline">myNumber</strong> to be the <strong class="source-inline">decimal</strong> type. Since there is no mathematical difference between 5 and 5.0, the compiler gets it wrong and, eventually, you get red wavy lines in your code indicating you have a problem. How can you specify the type and still use the <strong class="source-inline">var</strong> keyword syntax? Behold:</p>
<p><strong class="source-inline">var myNumber = 5d;</strong></p>
<p>We add a <em class="italic">d</em> as a <a id="_idIndexMarker752"/>suffix to the <a id="_idIndexMarker753"/>number. Just like that, the compiler now knows you want this to be a decimal. But I’m getting ahead of myself.</p>
<h3>Signed numeric types delineated by memory size usage</h3>
<p>C# supports signed and unsigned<a id="_idIndexMarker754"/> numeric types. Numbers in <a id="_idIndexMarker755"/>programming languages are handled in memory using a mathematical operation on binary numbers called two’s complement as seen in Figure A1.4:</p>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"> </p>
<div>
<div class="IMG---Figure" id="_idContainer127">
<img alt="Figure A1.5: Integer representation on computers happens using a mathematical concept called two’s-complement. One year, I went to the office Halloween party as an integer. I had this figure printed on a t-shirt. The best costumes are the ones you have to explain " height="517" src="image/B18605_Figure_A1.4.jpg" width="1078"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A1.5: Integer representation on computers happens using a mathematical concept called two’s-complement. One year, I went to the office Halloween party as an integer. I had this figure printed on a t-shirt. The best costumes are the ones you have to explain</p>
<p>If you’re a math geek, check out the Wikipedia page for this topic provided in the further reading section. </p>
<p>For the rest of us, this concept can be explained simply. Any variable that’s meant to store a number will have a minimum and maximum size for the number. For example, a common 32-bit integer (<strong class="source-inline">int32</strong>) has a range of -2,147,483,648 at the minimum end and a maximum value of 2,147,483,647. We had to chop one off the maximum to account for zero. The size ranges are dictated by two’s complement given the amount of memory space used. The range I just showed you represents the capacity for a <strong class="bold">signed</strong> type, meaning <a id="_idIndexMarker756"/>it supports numbers less than zero. If you don’t care about negative values, C# allows you to use <strong class="bold">unsigned</strong> types<a id="_idIndexMarker757"/> that extend the range from 0 to 4,294,967,295.</p>
<p>C# allows you to control <a id="_idIndexMarker758"/>memory usage by selecting from a myriad of signed and unsigned ranges. In other words, signed numeric types are delineated by memory size usage. I think this is a point that most developers forget or ignore since most of us, when we need an integer, just use <strong class="source-inline">int</strong>. I used an analogy earlier:</p>
<p><em class="italic">You cannot fit one pound of sugar into a container designed to hold no more than a quarter of a pound. You can, however, fit that same pound of sugar into a 5-gallon bucket with room to spare.</em></p>
<p>There is a lot of wasted space in the 5-gallon bucket. You can control the waste by selecting a type that has a range that is compatible with how it’s used. Think about how many times have you either seen or done this:</p>
<p><strong class="source-inline">int myAge = 54;</strong></p>
<p>That’s a huge waste of space. First, a person’s age can’t be a negative number. It makes sense to change this to the following:</p>
<p><strong class="source-inline">uint myAge = 54;</strong></p>
<p>Here, we’re using the<a id="_idIndexMarker759"/> unsigned version of the 32-bit integer. See if you can pick a more appropriate type from the following table:</p>
<table class="No-Table-Style _idGenTablePara-1" id="table002">
<colgroup>
<col/>
<col/>
<col/>
<col/>
<col/>
</colgroup>
<tbody>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><strong class="bold">Type</strong></p>
</td>
<td class="No-Table-Style">
<p><strong class="bold">Description</strong></p>
</td>
<td class="No-Table-Style">
<p><strong class="bold">Minimum</strong></p>
</td>
<td class="No-Table-Style">
<p><strong class="bold">Maximum</strong></p>
</td>
<td class="No-Table-Style">
<p><strong class="bold">Bits</strong></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><strong class="source-inline">bool</strong></p>
</td>
<td class="No-Table-Style">
<p>Boolean</p>
</td>
<td class="No-Table-Style">
<p>False (0)</p>
</td>
<td class="No-Table-Style">
<p>True (1)</p>
</td>
<td class="No-Table-Style">
<p>1</p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><strong class="source-inline">byte</strong></p>
</td>
<td class="No-Table-Style">
<p>Unsigned byte</p>
</td>
<td class="No-Table-Style">
<p>0</p>
</td>
<td class="No-Table-Style">
<p>255</p>
</td>
<td class="No-Table-Style">
<p>8</p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><strong class="source-inline">sbyte</strong></p>
</td>
<td class="No-Table-Style">
<p>Signed byte</p>
</td>
<td class="No-Table-Style">
<p>-128</p>
</td>
<td class="No-Table-Style">
<p>127</p>
</td>
<td class="No-Table-Style">
<p>8</p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><strong class="source-inline">short</strong></p>
</td>
<td class="No-Table-Style">
<p>Signed short integer</p>
</td>
<td class="No-Table-Style">
<p>-32,768</p>
</td>
<td class="No-Table-Style">
<p>32,767</p>
</td>
<td class="No-Table-Style">
<p>16</p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><strong class="source-inline">ushort</strong></p>
</td>
<td class="No-Table-Style">
<p>Unsigned short integer</p>
</td>
<td class="No-Table-Style">
<p>0</p>
</td>
<td class="No-Table-Style">
<p>65,535</p>
</td>
<td class="No-Table-Style">
<p>16</p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><strong class="source-inline">int</strong></p>
</td>
<td class="No-Table-Style">
<p>Signed integer</p>
</td>
<td class="No-Table-Style">
<p>-2,147,483,648</p>
</td>
<td class="No-Table-Style">
<p>2,147,483,647</p>
</td>
<td class="No-Table-Style">
<p>32</p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><strong class="source-inline">uint</strong></p>
</td>
<td class="No-Table-Style">
<p>Unsigned integer</p>
</td>
<td class="No-Table-Style">
<p>0</p>
</td>
<td class="No-Table-Style">
<p>4,294,967,295</p>
</td>
<td class="No-Table-Style">
<p>32</p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><strong class="source-inline">long</strong></p>
</td>
<td class="No-Table-Style">
<p>Signed long integer</p>
</td>
<td class="No-Table-Style">
<p>-9e18</p>
</td>
<td class="No-Table-Style">
<p>9e18</p>
</td>
<td class="No-Table-Style">
<p>64</p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><strong class="source-inline">ulong</strong></p>
</td>
<td class="No-Table-Style">
<p>Unsigned long integer</p>
</td>
<td class="No-Table-Style">
<p>0</p>
</td>
<td class="No-Table-Style">
<p>1.8e19</p>
</td>
<td class="No-Table-Style">
<p>64</p>
</td>
</tr>
</tbody>
</table>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A1.6: A list of C# integer types with ranges and how much memory each consumes.</p>
<p>As you can see, as we move down the chart, we use more and more memory. A bit is the smallest thing a <a id="_idIndexMarker760"/>computer can work with. A 64-bit integer can only be understood using the term <em class="italic">±9 kajillion</em> or <em class="italic">18 kajillion</em> depending on whether it’s signed.</p>
<p>Why would we use a 32-bit unsigned integer with a maximum value of 8 billion for a person’s age? Either we don’t know about numeric type delineations or we’re simply lazy, which is one of those debilitating forces we talked about in <a href="B18605_01.xhtml#_idTextAnchor016"><em class="italic">Chapter 1</em></a>. We’ve just broken a window that leads us into a big ball of mud. We should be using an unsigned byte that has a minimum value of 0 and a maximum value of 255. Most normal humans, aside from Elvis, who is living on a secret island in Hawaii, and Chuck Norris, who is obviously immortal, don’t live past 100 years. When you consider the earth is about 4.5 billion years old, you begin to see the folly of this common practice. If you do this, you’re in good company. Microsoft does it too throughout its C# documentation. I am tempted to quip writers make bad coders, but I’d be shooting myself in the foot if I did. I won’t fault you if you don’t immediately change all your production code from <strong class="source-inline">int</strong> to <strong class="source-inline">byte</strong> so long as you now realize you’re wasting a lot of memory.</p>
<p><em class="italic">Figure A1.7</em> shows us all the<a id="_idIndexMarker761"/> valid integer types. There are similar names and ranges for floating-point numbers and text types. All of these types are <a id="_idIndexMarker762"/>considered <strong class="bold">primitives</strong>. Primitives are what you think they are based on the name. In many C-based languages, these are usually simple structures. C# doesn’t treat them that way. C# and, by extension, .NET Framework treat them as objects. The keywords in <em class="italic">Table 1</em> are primitive aliases to the real objects from .NET Framework. The objects have different names from the list of keywords presented in <em class="italic">Figure A1.6</em>. The example you’ve most likely encountered is the <strong class="source-inline">int</strong> keyword mapping to the <strong class="source-inline">Int32</strong> class. </p>
<p>The real list turns out to be something like the list in <em class="italic">Figure A1.7</em>:</p>
<table class="No-Table-Style _idGenTablePara-1" id="table003">
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><strong class="bold">Alias/primitive keyword</strong></p>
</td>
<td class="No-Table-Style">
<p><strong class="bold">.NET type</strong></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><strong class="source-inline">bool</strong></p>
</td>
<td class="No-Table-Style">
<p>System.Boolean</p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><strong class="source-inline">byte</strong></p>
</td>
<td class="No-Table-Style">
<p>System.Byte</p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><strong class="source-inline">sbyte</strong></p>
</td>
<td class="No-Table-Style">
<p>System.Sbyte</p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><strong class="source-inline">short</strong></p>
</td>
<td class="No-Table-Style">
<p>System.Int16</p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><strong class="source-inline">ushort</strong></p>
</td>
<td class="No-Table-Style">
<p>System.Uint16</p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><strong class="source-inline">int</strong></p>
</td>
<td class="No-Table-Style">
<p>System.Int32</p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><strong class="source-inline">uint</strong></p>
</td>
<td class="No-Table-Style">
<p>System.Uint32</p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><strong class="source-inline">long</strong></p>
</td>
<td class="No-Table-Style">
<p>System.Int64</p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><strong class="source-inline">ulong</strong></p>
</td>
<td class="No-Table-Style">
<p>System.UInt64</p>
</td>
</tr>
</tbody>
</table>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A1.7: The full list of C# integer ranges with the alias in the first column and the real implementation class in the second column.</p>
<p>C# allows for aliases, and often the <a id="_idIndexMarker763"/>alias points to the same class name expressed with an uppercase letter. All the primitive types are in the .NET <strong class="source-inline">System</strong> object. Almost every project you create in Visual Studio has a <strong class="source-inline">using System</strong> statement at the top. This is why you can see strings being created in several different ways.</p>
<p>A string defined using all lowercase characters works because of the alias:</p>
<p><strong class="source-inline">var string foo = "bar";</strong></p>
<p>A string defined with a capitalized <strong class="source-inline">String</strong> keyword works because of the <strong class="source-inline">using System</strong> statement that is likely at the top of your project:</p>
<p><strong class="source-inline">var String bar = "baz"; </strong></p>
<p>Of course, you can also write the following:</p>
<p><strong class="source-inline">var System.String fooBarBaz = "foo bar baz";</strong></p>
<p>Honestly, I’ve never seen anybody do this. Years ago, when I taught introductory programming courses in C# at a nearby college, the difference between <strong class="source-inline">String</strong> and <strong class="source-inline">string</strong> was a widely asked question, especially coming from students who had previously studied Java. Java lacked these kinds of aliases.</p>
<h3>Separate character and string classes with different quotation marks used for each</h3>
<p>This point is short, but worth mentioning if you are coming from another language, or if you switch languages frequently. C# has separate class types for strings and characters. The string type<a id="_idIndexMarker764"/> is <strong class="source-inline">System.String</strong>. It’s an alias that is used far more frequently, which is just <strong class="source-inline">string</strong>. The character type, which is <a id="_idIndexMarker765"/>a single character string, is created using the <strong class="source-inline">System.Char</strong> class or just <strong class="source-inline">char</strong>. The quotation marks used in the assignment of values matter, too. Many languages, such as JavaScript and Python, allow you to use single and double quotes interchangeably. In C#, strings are denoted with double quotes, while characters are assigned using single quotes. They are not interchangeable.</p>
<h3>Collections</h3>
<p>JavaScript has <strong class="source-inline">Arrays</strong> (a.k.a. what I’m hoping I get at work for writing a book). Python has <strong class="source-inline">Lists</strong>. Java has <strong class="source-inline">ArrayLists</strong>. C# has a broad<a id="_idIndexMarker766"/> set of <strong class="bold">Collections</strong>. C# has arrays such as JavaScript, but they are more limited. You have to set the number of items you are putting into the array in advance, and once set, that number can’t be easily changed. A more useful form of array in C# is the .NET List class.</p>
<p>List classes are like arrays, except you can add and remove items any time you need to. They are a lot more flexible. Lists are strongly typed, like everything else in C#. This means all the items in the List have to be the same type. C# has a system for this called <strong class="bold">Generics</strong>. I won’t get <a id="_idIndexMarker767"/>into the details of generics here, as it would take more time and room than we have. Just know that generics are denoted in C# with angle brackets (<strong class="source-inline">&lt;&gt;</strong>). In the book, you’ll see references to <strong class="source-inline">List&lt;&gt;</strong>. This indicates a generic list, and once again, that just means you can put anything into the list as long as everything you put into it is of the same type. If you wanted to create a list of strings, it might look like this:</p>
<pre class="source-code">var myStrings = new List&lt;string&gt;();
myStrings.add("foo");
myStrings.add("bar");</pre>
<p>To use these generic collections, you have to add a statement at the top of your class file like this:</p>
<pre class="source-code">using System.Collections.Generic;</pre>
<p>Generic collections are some of the most versatile and widely used classes in .NET Framework. You will definitely encounter them early and often.</p>
<h2 id="_idParaDest-190"><a id="_idTextAnchor190"/>Classes</h2>
<p>So far, my assumptions regarding your exposure to OOP have presupposed you know what a class is and its purpose. Just in case that’s an invalid assumption, let’s clear it up now. A <em class="italic">class</em> can be <a id="_idIndexMarker768"/>thought of as a blueprint for a house. The blueprint describes everything you need to know to build the house. You can use the blueprint to make as many houses as you need, and as you build them, you can change the individual properties on each house. It isn’t necessary that they all be the same size or color, or that they all have a certain number of windows. You can alter any of these properties when you build the house.</p>
<p>In most OOP languages, the class is the main form for defining how objects are constructed. There are even special methods called constructors, which run when an object is instantiated, which is to say when you create an instance of an object using the new keyword.</p>
<p>Here is the example of the <strong class="source-inline">Person</strong> class I used earlier. This time, I added all the parts so that I can show them to you:</p>
<pre class="source-code">using System;
namespace MyProject;
class Person
{
  public string Name { get; set; }
  public byte Age { get; set; }
  public Person()
  {
    Name = string.Empty;
    Age = 0;
  }
  public Person(string name){
  {
    Name = name;
    Age = 0;
  }
  public Person(string name, int age)
  {
    Name = name;
    Age = age;
  }
  public override string ToString()
  {
    return "Person: " + Name + " " + Age;
  }
}</pre>
<p>A class has a<a id="_idIndexMarker769"/> few main parts:</p>
<ul>
<li>Using statements to define dependencies</li>
<li>The namespace</li>
<li>The class name</li>
<li>Constructors</li>
<li>Properties</li>
<li>Methods</li>
</ul>
<p>Let’s go over each part.</p>
<h3>Using statements</h3>
<p>The <strong class="source-inline">using</strong> keyword has <a id="_idIndexMarker770"/>a double meaning in C#. When you see it at the top of a <a id="_idIndexMarker771"/>class, it refers to the class’ dependencies. This is common in most languages. In Java and Python, the word is <strong class="source-inline">import</strong>. In JavaScript, it’s either <strong class="source-inline">require</strong> or <strong class="source-inline">import</strong> depending on which convention you use. In C#, the keyword is <strong class="source-inline">using</strong>. The statement signals to the compiler that some of the classes we’re going to reference in this class exist in other parts of our project, or even outside our project, which is the case when we use third-party libraries.</p>
<p>For example, in order to use the <strong class="source-inline">Console.WriteLine</strong> method, which prints text to the console, first, we must declare that we will be using the <strong class="source-inline">System</strong> namespace. We do this with the following statement:</p>
<pre class="source-code">using System;</pre>
<p>The <strong class="source-inline">Console</strong> object is in the <strong class="source-inline">System</strong> namespace. The <strong class="source-inline">using</strong> statement tells the compiler we’ll be using classes from that namespace. That last statement makes for a natural segue into the next topic.</p>
<h3>Namespaces</h3>
<p>Namespaces<a id="_idIndexMarker772"/> are a way of organizing your code in C#. If you’re coming from <a id="_idIndexMarker773"/>Java, you’ve used packages. In Python, they’re called modules. In JavaScript, you export objects you want to expose in modular code. In C#, a namespace appears at the top of your class files. Usually, it corresponds to the name of your project. If you create folders inside your project to break up your code, usually, the namespace mirrors the folder structure.</p>
<p>In the preceding sample code, we have a namespace called <strong class="source-inline">MyProject</strong>, which would be the name of the C# project. If I made a folder called helpers to hold some helper objects, the namespace in those folders would be <strong class="source-inline">MyProject.helpers</strong>.</p>
<p>Namespaces are not an absolute requirement. Most IDEs put them in automatically, so you’ll usually see them. Five years ago, when I last worked with the Unity 3D game engine, the IDE didn’t put namespaces in the class code automatically. It’s possible to work without namespaces, but it’s rare. Visual Studio and Rider add the namespace automatically when you create the class. In VS Code, everything is manual, so you might have to add it yourself.</p>
<h3>The class name</h3>
<p>The line that<a id="_idIndexMarker774"/> names the class is not difficult to spot:</p>
<pre class="source-code">class Person</pre>
<p>You just use the keyword class followed by the name of the class. By convention, class names use the Pascal case convention, which means each word in the class name is represented by a capital letter. If we wanted to create a class to represent a floor manager at a retail outlet, we would call it <strong class="source-inline">FloorManager</strong>.</p>
<p>Classes, like properties and methods, can use access modifiers to define how they can be accessed. We’ll talk more about this later.</p>
<h3>Constructors and instantiation</h3>
<p>A constructor<a id="_idIndexMarker775"/> is a special method designed to run when you <strong class="bold">instantiate</strong> the class. Semantically, a class is not an object. A class<a id="_idIndexMarker776"/> is a blueprint used to<a id="_idIndexMarker777"/> create objects. Simply put, class is your code. When your code runs, it<a id="_idIndexMarker778"/> creates instances of objects through a process <a id="_idIndexMarker779"/>called <em class="italic">instantiation</em>: <strong class="source-inline">Create an instance</strong> = <strong class="source-inline">instantiation</strong>. See? It’s a fancy word every software developer needs to understand. Instantiation happens when you put the <strong class="source-inline">new</strong> keyword in front of a constructor method. This is why there is always a parenthesis at the end of your <strong class="source-inline">new</strong> statement. The constructor returns the instance of the object set up per any code in the constructor. If you don’t supply a constructor, the .NET compiler adds an empty one when you compile.</p>
<p>There are defining rules that govern the constructors. First, the constructor’s method name must match the name of the class. Second, you can’t define a return type since it is fixed to returning an instance of the class it is constructing.</p>
<p>C# allows you to have multiple overloaded constructors. This means you can have more than one constructor as long as the type and number of arguments are different. Our code example from earlier features three constructors:</p>
<pre class="source-code">public Person()
  {
    Name = string.Empty;
    Age = 0;
  }
  public Person(string name){
  {
    Name = name;
    Age = 0;
  }
  public Person(string name, int age)
  {
    Name = name;
    Age = age;
  }</pre>
<p>Note the following:</p>
<ul>
<li>All of the <a id="_idIndexMarker780"/>constructors are named <strong class="source-inline">Person</strong> because that is the <a id="_idIndexMarker781"/>name of the class. They must match the name of the class or they aren’t valid constructors.</li>
<li>There is no return type specified. The return type would be between the public keyword and the name of the constructor method.</li>
<li>Even though all three functions have the same name because they have different numbers of arguments, it’s legal. The first constructor has zero arguments, the second has one, and the third has two. This is called <em class="italic">method overloading</em> and is a form of polymorphism.</li>
</ul>
<p>Constructors are a very useful way to establish the initial state of your object the instant the object is created. I often say that the number one job of a software developer is to make sure no object within your program is capable of entering an invalid state.</p>
<p>In the preceding example, the<a id="_idIndexMarker782"/> constructor is syntactic overkill. C# will initialize the age property<a id="_idIndexMarker783"/> to 0 automatically. I initialize strings to empty strings because I don’t like the ambiguity of dealing with null values. Sometimes, your language of choice, in this case, C#, will try to handle things such as initialization for you. Relying on automatic language features will lead to mental laziness, one of the destructive forces I talk about in <a href="B18605_01.xhtml#_idTextAnchor016"><em class="italic">Chapter 1</em></a> that leads to chaotic, unmaintainable code. If you don’t believe me, go to YouTube and find videos on JavaScript’s automatic semicolon insertion “feature.” You need to remember that your code is a set of instructions to be executed by one of the dumbest things on planet earth. Computers take everything literally, and if your instructions contain any ambiguity, bad comedy always ensues. Granted, some people call that job security, and everybody needs good war stories to tell. It’s like that one time someone on the team pasted an incomplete SQL update statement into SSMS pointed to a production database and updated all the customer records to one account. A system with a million users a day was down for 7 hours. To be clear, no, it wasn’t me. If it were, I would never speak of it. I’m making a point. That painful experience happened because someone was too lazy to do their job the right way. Personally, I’d rather do things right and keep my weekends free. When I write code, I am always explicit and intentional. It keeps me out of trouble. Always pay attention to your object’s state and write your code to guard against invalid states. Your constructors are the first line of defense. The second line of defense is encapsulation, which we’ll talk about shortly.</p>
<h3>Properties</h3>
<p>Objects consist of state variables and<a id="_idIndexMarker784"/> functions capable of doing work on those state variables. This is a fancy way of saying an object is like a marriage between two common programming concepts: variables and functions. Classes are designed to represent real-world objects. Any object in the real world is defined by its descriptive properties. What color is it? Is it bigger than a breadbox? Physical objects are further defined by what they can do. A car can go, a dog can bark, and so on.</p>
<p>For now, let’s focus on the objects’ descriptors. It’s easy to call them properties. A basketball has properties such as its circumference, its orange color, its black lines, and how much air it is holding. These are properties of the basketball. In C# classes, properties look like this:</p>
<pre class="source-code">public string Name { get; set; }</pre>
<p>The word <strong class="source-inline">public</strong> is an access modifier. We described this earlier in the appendix.  </p>
<p>Every property has a name. This property’s name is <strong class="source-inline">Name</strong>, and it is defined as a string.  The part that says <strong class="source-inline">{ get; set; }</strong> makes it an auto-implemented property, which is an easy form of encapsulation that I’ll explain later.</p>
<p>You access a property <a id="_idIndexMarker785"/>on an instantiated object using dot notation. For example, to set the <strong class="source-inline">Name</strong> property on a <strong class="source-inline">Person</strong> object, you instantiate and then set it like this:</p>
<pre class="source-code">var somebody = new Person();
somebody.Name = "Bruce";</pre>
<p>Access modifiers define the availability of properties, methods, and even classes in C#.</p>
<h3>Methods</h3>
<p>Methods<a id="_idIndexMarker786"/> are functions attached to objects. Since C# is strictly object-oriented, we <a id="_idIndexMarker787"/>should probably always refer to them as methods rather than functions, but the words are effectively synonymous. Even the strongest adherent to OOP will occasionally slip and say <em class="italic">function</em>. With that out of the way, there are a few things to remember with respect to methods in C#. First, they follow the same rules as variables in that they are strongly typed. They need any arguments passed in to be typed as well as the return value to be typed. Like variables, the method names need to be unique within scope.</p>
<p>C# uses C-like method signatures common to all C-based languages. A method signature consists of the parts of the method that define it as unique:</p>
<ul>
<li>The name of the function</li>
<li>The number and types of arguments</li>
<li>The type of the return value</li>
</ul>
<p>In the preceding example, we have this method:</p>
<pre class="source-code">public override string ToString()
{
  return "Person: " + Name + " " + Age;
}</pre>
<p>In this method signature, we can see this method is public. It can be accessed by any class in our program. We can see that its name is <strong class="source-inline">ToString</strong> and that it takes no arguments. Furthermore, we can see this method is expected to return a string.</p>
<p>This one has <a id="_idIndexMarker788"/>an extra keyword stuck between the access modifier and the return type. It says <strong class="source-inline">override</strong>. The <strong class="source-inline">ToString()</strong> method is on every object in C# because that method is in the Object base class. It is always inherited from the base class in every object you make. The base class implementation isn’t very useful. It is very common to override the function with something more useful. That is what’s happening in the preceding example. We’ve changed the implementation in the base class by overriding the implementation with our own. We do this in plenty of places within the projects covered in this book.</p>
<h1 id="_idParaDest-191"><a id="_idTextAnchor191"/>Encapsulation</h1>
<p>This <a id="_idIndexMarker789"/>concept entails one of the most important aspects of OOP: the maintenance of the object’s state.</p>
<p>Earlier, in <em class="italic">Figure A1.3</em>, I presented a circle with a set of properties with values that describe the circle you’re seeing. As your program runs, it’s likely those properties will change in response to events within that program. If you take a snapshot of that circle at any point in time during your program’s execution, you can talk about its current state. It’s currently sporting a radius of 200 pixels, with a line color of black, and fill color of dark gray. Let’s create some code to represent our circle in the simplest way possible, without any encapsulation, so we can see it added later:</p>
<pre class="source-code">public class Circle
{
  ushort centerX;
  ushort centerY;
  ushort radius;
  byte lineWidth;
  string lineColor;
  string fillColor;
}</pre>
<p>In this listing, we create a <strong class="source-inline">Circle</strong> class, and within it, we define the fields based on our earlier discussion. Note that I did not say properties. Properties and fields are different in C#. Fields are simply member variables. These fields are wide open. Effectively, any other class can directly modify the fields at any time. Why is this bad? Remember, it’s all about guarding the state. It really doesn’t make sense to have a negative radius, which is why I used an unsigned short. Likewise, graphics coordinate systems on a computer are usually strictly positive, with 0,0 located in the upper-left corner of the screen. To that end, I used unsigned shorts here because we don’t need values beneath zero, and the upper value seems reasonable. So far, I’ve done everything right, except I haven’t guarded the state beyond limiting invalid values based on types.</p>
<p>Let’s imagine that you’re working on a program<a id="_idIndexMarker790"/> such as <em class="italic">Adobe Illustrator</em> or the open source program <em class="italic">Inkscape</em>. These <a id="_idIndexMarker791"/>programs deal with vector graphics, and they most definitely need a structure to handle a circle. Both programs are pretty big in terms of lines of code and the number of classes. I realize neither program is written in C#, but if they were, imagine all the different objects each program would have flying around at any given moment. If any one of them has the ability to, at any time, modify the properties of our circle object, finding and debugging odd behavior changes in the circle becomes nigh impossible. Usually, lack of encapsulation is caused by the cardinal sin of sloth, a lack of imagination, or both.</p>
<p>Our program could change any of these properties at any time. Encapsulation aims to prevent you from entering your object into an invalid state. For example, what if I try to specify a negative number for the radius? That doesn’t really make sense.</p>
<p>To protect our <a id="_idIndexMarker792"/>object from entering an invalid state, we can hide the properties behind <a id="_idIndexMarker793"/>access modifiers. Access modifiers are keywords that define “who or what” is allowed to make changes to an object’s state. In an ideal program, the object should always solely be in charge of its own state. A different object in the program shouldn’t be directly manipulating the radius. Aside from access problems, there’s nothing policing the type of data being passed in, other than our strongly typed variable system. To improve things, let’s start with the radius. Earlier, I mentioned that I thought <strong class="source-inline">ushort</strong> was an appropriate type because being unsigned, it doesn’t support negative values. Further, I think the next lowest unsigned type, byte, which tops out at 256, is too small. I can easily see needing the ability to make a circle larger than 256 pixels in diameter. But 65K is probably too big. Let’s say I want to limit the maximum radius to 1,000 pixels. This is probably smart because, in a large graphical composition, we might have thousands of circles and we should be thinking about our memory consumption. We can hide the radius field behind a special function that checks to see whether the radius you are setting is valid, in this case, a number between 0 and 1,000.  </p>
<p>There are two steps at play here. First, you have to hide the radius with an access modifier. The most common access modifiers are listed as follows:</p>
<ul>
<li><strong class="bold">Public</strong>: Anything <a id="_idIndexMarker794"/>can access the property or method.</li>
<li><strong class="bold">Private</strong>: Only this <a id="_idIndexMarker795"/>object can access the property or method.</li>
<li><strong class="bold">Protected</strong>: Only this<a id="_idIndexMarker796"/> object and its descendants can access the property or method. More on this after we talk about inheritance.</li>
</ul>
<p>You’ll find these available in most object-oriented languages. C# has a few additional access modifiers:</p>
<ul>
<li><strong class="bold">Internal</strong>: Anything <a id="_idIndexMarker797"/>within the same assembly can access the property or method.</li>
<li><strong class="bold">Protected internal</strong>: The <a id="_idIndexMarker798"/>property or method can only be accessed by code within the assembly wherein it was declared or from a subclass of the class where it was created.</li>
<li><strong class="bold">Private protected</strong>: The <a id="_idIndexMarker799"/>property or method can be accessed by subclasses that are declared within the same assembly.</li>
</ul>
<p>You can visualize this using the following table:</p>
<div>
<div class="IMG---Figure" id="_idContainer128">
<img alt="Figure A1.8: Relative access levels by the caller’s location. " height="301" src="image/B18605_Figure_A1.5.jpg" width="976"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A1.8: Relative access levels by the caller’s location.</p>
<p>Let’s go back to <a id="_idIndexMarker800"/>improving the <strong class="source-inline">Circle</strong> class. The first improvement we’ll make is adding a private access modifier to the radius field. I’ll also move <strong class="source-inline">radius</strong> to the top just so that it is easier to see for this discussion:</p>
<pre class="source-code">public class Circle
{
  private ushort radius;
  ushort centerX;
  ushort centerY;
  byte lineWidth;
  string lineColor;
  string fillColor;
}</pre>
<p>The private access modifier tells us that only methods in “this particular object” are allowed to change the radius. That’s perfect, except now the radius field is totally hidden. There isn’t any way to set it from the outside, and we’ll, of course, need to do that at some point. Let’s change the access modifier to something more permissive:</p>
<pre class="source-code">public class Circle
{
  private ushort radius;
  ushort centerX;
  ushort centerY;
  byte lineWidth;
  string lineColor;
  string fillColor;
}</pre>
<p>OK. Now we’re back to where we started. The public access modifier means that anything can alter the radius. That’s not good! Dagnabbit!</p>
<p>We need private back, but we need it to be a little better. We need accessor methods to allow us to get and set the field’s value from outside this object, but in a manner we control. When I do this, I use a common convention of renaming the field so that it starts with an underscore. This is done so that we can easily remember it’s a private backing field:</p>
<pre class="source-code"> private ushort _radius;</pre>
<p>Next, let’s add an <a id="_idIndexMarker801"/>accessor method that allows us to get the radius. The <strong class="source-inline">get</strong> method is commonly called a <em class="italic">getter</em>. We don’t need any restrictions on this one:</p>
<pre class="source-code"> public ushort getRadius()
 {
  return _radius;
 }</pre>
<p>Next, let’s deal with the real problem at hand, which is controlling how the radius is set. Another accessor method can be used:</p>
<pre class="source-code"> public void setRadius(int newRadius)
 {
  if(newRadius &gt;= 0 &amp;&amp; newRadius &lt;= 1000)
  {
    _radius = newRadius;
  }
  else
  {
    throw new Exception("The radius must be between 0 
    and 1000.");
  }
 }
}</pre>
<p>Now we have a <strong class="source-inline">set</strong> method, commonly<a id="_idIndexMarker802"/> called a <em class="italic">setter</em>, that can set the value. Note that its access modifier is public, which we just learned means anything can access it. This setter method contains code that checks to see whether the new radius conforms to the required range. If it does, it goes ahead and changes the radius to the new value. The object is now in command of its own state. You can’t just randomly set the value to an invalid number. You have to <em class="italic">ask</em> the object to change its radius value, and it doesn’t automatically say <em class="italic">OK</em> – it checks to make sure you didn’t pass something that doesn’t make sense.</p>
<p>Additionally, accessor methods can be used to define a read-only property. By simply neglecting to create a public setter method, you limit the ability to set the value of the private field to other methods within this class.</p>
<h2 id="_idParaDest-192"><a id="_idTextAnchor192"/>C# auto-implemented properties</h2>
<p>If you’re a C# veteran, you’re no doubt yelling at this book right now. Don’t do that. First, it makes you<a id="_idIndexMarker803"/> look crazy unless you have your earbuds in, then at least people around you will think you’re just yelling at your mother-in-law. Second, this book is very sensitive. You might hurt its feelings. I get it. The earlier example is definitely not how we usually make accessor methods in C# – at least not these days. Back when I was your age, gas was 35 cents per gallon, and that’s exactly how we did it. I like showing it to you that way because I think just throwing <strong class="source-inline">int foo { get; set; }</strong> at someone without explaining how it works is kind of mean, which is to say that’s how the average C# book might cover it. As we all know, <em class="italic">mean</em> is the average. Was that a math pun? Yes, I think it was.</p>
<p>Modern C# has a different syntax for defining properties predicated on the idea that most properties are really fields. But if you leave them as fields, your OOP professor will give you a B because you didn’t encapsulate them. We can’t have that. I could climb back up on my soapbox and decry their existence, but I have a page count I need to stay under, so let’s just see how they work and you can decide whether they are a good idea or not.</p>
<p>If you want to say your <a id="_idIndexMarker804"/>class is fully encapsulated, but you don’t need any logic to control state, your code winds up with a lot of boilerplate code like this:</p>
<pre class="source-code">public class Student {
  private string _firstName;
  private string _lastName;
  private int _age;
  public string getFirstName(){
    return _firstName;
  }
  public void setFirstName(string firstName){
    _firstName = firstName;
  }
  public string getlastName(){
    return _lastName;
  }
  public void setLastName(string lastName){
    _lastName = lastName;
  }
  public int getAge(){
    return _age;
  }
  public void setAge(int age){
    if(age &gt; -1 &amp;&amp; age &lt; 970){
      _age = age;
    } else {
      throw new Exception("Age must be between 0 and 
      970 years");
    }
  }
}</pre>
<p>That’s a lot of code that doesn’t do anything. It only exists in the service of calling the class members <em class="italic">encapsulated</em>. In this case, there might not be a need to control the first and last name fields. I can’t think of any restrictions you might put on the kind of data, aside from it being a required field within a user interface. Let’s say the boilerplate is legitimate but we want to be modern and use auto-implemented properties. Your code can be reduced to this:</p>
<pre class="source-code">public class Student {
  public string FirstName {get; set;}
  public string LastName {get; set;}</pre>
<p>Auto-implemented properties allow you to use this shortened syntax if you don’t have logic to put in the getter and setter methods.</p>
<h2 id="_idParaDest-193"><a id="_idTextAnchor193"/>Accessor logic with backing variables</h2>
<p>The real power of <a id="_idIndexMarker805"/>encapsulation happens when you use the accessor methods to control the state of your object. Your biggest job as a developer is making sure your object is incapable of entering into an invalid state. For example, take <strong class="source-inline">Age</strong>. A negative number in the age property doesn’t make sense. Neither does a billion years. The oldest human lifespan ever recorded that I know of was Methuselah, in the Old Testament, who live to be about 970 years old. Since there is no accessor logic, I can make the age 100 years or 1,000,000,000 years. If I want the controlling logic to limit the input values, I need to create something like this:</p>
<pre class="source-code">  private int _age;</pre>
<p>Here, we create a private backing variable called <strong class="source-inline">_age</strong>. We need this to hold the value since the property is now under the control of accessor logic. It is common to name private variables beginning with an underscore.</p>
<p>Next, we add the logic. We don’t really need anything special on the getter:</p>
<pre class="source-code">  public int Age {
    get =&gt; _age;</pre>
<p>The setter is where the magic happens:</p>
<pre class="source-code">    set {
      if(value &gt; -1 &amp;&amp; value &lt; 970){
        _age = value;
      } else {
        throw new Exception("Age must be between 0 and 
        970 years");
      }
    }
  }
}</pre>
<p>Then, we make the <a id="_idIndexMarker806"/>property with the auto-implemented method syntax, but this time, there’s more to it. Essentially, the syntax for the getter is a fat-arrow function that returns the <strong class="source-inline">_age</strong> backing variable. The setter is straightforward except for the value variable. Where does that come from? It’s magic. It’s part of the language for use in this scenario. It holds the value of whatever was passed into the setter.</p>
<h1 id="_idParaDest-194"><a id="_idTextAnchor194"/>Inheritance</h1>
<p>C# is a statically compiled <a id="_idIndexMarker807"/>language that supports a classical inheritance model. By statically compiled, I mean the structure of your objects can’t change unless you stop your running program, alter the source code for the class, recompile, and rerun. You can contrast C#’s static nature with a language designed to be dynamic: JavaScript. </p>
<p>JavaScript breaks from a great many conventions, not the least of which is that it uses prototypes for inheritance instead of classes. For that matter, it doesn’t support encapsulation. It is based heavily on the idea of Lambda functions, which was also novel when JavaScript was invented. JavaScript uses lexical scope instead of the more conventional block scope we find in C#. In short, JavaScript is really weird when compared with C# if C# is the only language you know.</p>
<p>Now that we’ve established there’s more than one way to do inheritance, let’s switch back over to how it works in C#.</p>
<p>Let’s suppose you are<a id="_idIndexMarker808"/> writing software to track the faculty and student body at a school, or university. You need to model a student class – maybe something like this: </p>
<pre class="source-code">public class Student
{
    public string FirstName { get; set; }
    public string LastName { get; set; }
    public string EmailAddress { get; set; }
    public float GradePointAverage { get; set; }
    public List&lt;Course&gt; Courses { get; set; }
    public void Study()
    {
        Console.WriteLine("I am studying");
    }
    public void TakeTest()
    {
        Console.WriteLine("I am taking a test!");
    }
    
    public void DoHomework()
    {
        Console.WriteLine("I am doing homework.");
    }
    
    public void AskParentsForMoney()
    {
        Console.WriteLine("Hey Dad, do you have a 
        minute?");
    }
}</pre>
<p>Additionally, you <a id="_idIndexMarker809"/>need to model a <strong class="source-inline">professor</strong> class – maybe something like this:</p>
<pre class="source-code">public class Professor
{
    public string FirstName { get; set; }
    public string LastName { get; set; }
    public string EmailAddress { get; set; }
    public bool HasTenure {get; set;
    public List&lt;Course&gt; Courses { get; set; }
    
    public void GradeTest()
    {
        Console.WriteLine("I am grading a test.");
    }
    
    public void TeachClass()
    {
        Console.WriteLine("I am teaching a class.");
    }
    public void BegForResearchFunding()
    {
        Console.WriteLine("Hey National Science Foundation, 
        do you have a minute?");
    }
}</pre>
<p>We have a problem <a id="_idIndexMarker810"/>here. There are a lot of properties that are redundant since they are used in both classes. OOAD would have us redesign these two classes by abstracting the common properties into a superclass. This leaves only those elements that are unique to the <strong class="source-inline">Student</strong> and <strong class="source-inline">Professor</strong> classes. The obvious targets for hoisting to the superclass are the following common properties:</p>
<ul>
<li><strong class="source-inline">FirstName</strong></li>
<li><strong class="source-inline">LastName</strong></li>
<li><strong class="source-inline">Email</strong></li>
<li><strong class="source-inline">Courses</strong></li>
</ul>
<p>Less obvious targets for hoisting include the <strong class="source-inline">AskParentsForMoney()</strong> method in the student class and the <strong class="source-inline">BegForResearchFunding()</strong> method in the professor class. They effectively do the same thing. The only difference is who is being asked to part with cash.</p>
<p>Let’s make a superclass:</p>
<pre class="source-code">public abstract class Person
{
    public string FirstName { get; set; }
    public string LastName { get; set; }
    public string EmailAddress { get; set; }
    public List&lt;Course&gt; Courses { get; set; }
    public void BegForMoney(string who)
    {
        Console.WriteLine("Hey " + who + ", do you have a 
        minute?");
    }
}</pre>
<p>I’ve dubbed the superclass <strong class="source-inline">Person</strong>. It has the common elements between the student and the professor. Now, let’s make the <strong class="source-inline">Student</strong> class inherit from the <strong class="source-inline">Person</strong> class. To signal inheritance, I’ll add a colon followed by the superclass on the first line:</p>
<pre class="source-code">public class Student : Person
{</pre>
<p>Now I’ll only keep the <a id="_idIndexMarker811"/>properties that aren’t defined in the superclass. There is just one:</p>
<pre class="source-code">    public float GradePointAverage { get; set; }</pre>
<p>The same goes for methods. I only need those that are not in the superclass:</p>
<pre class="source-code">    public void Study()
    {
        Console.WriteLine("I am studying");
    }
    public void TakeTest()
    {
        Console.WriteLine("I am taking a test!");
    }
    
    public void DoHomework()
    {
        Console.WriteLine("I am doing homework.");
    }
    
}</pre>
<p>I can do the same thing with the <strong class="source-inline">Professor</strong> class:</p>
<pre class="source-code">public class Professor : Person
{
    public bool HasTenure { get; set; }
    
    public void GradeTest()
    {
        Console.WriteLine("I am grading a test.");
    }
    
    public void TeachClass()
    {
        Console.WriteLine("I am teaching a class.");
    }
}</pre>
<p>Now, the class<a id="_idIndexMarker812"/> only contains the properties and methods unique to the <strong class="source-inline">Professor</strong> class. The common properties and methods are in the <strong class="source-inline">Person</strong> superclass.</p>
<p>The key to understanding inheritance is to vocalize the relationship between <strong class="source-inline">Person</strong>, <strong class="source-inline">Student</strong>, and <strong class="source-inline">Professor</strong>. We can say a <strong class="source-inline">Student</strong> <em class="italic">IS A</em> <strong class="source-inline">Person</strong> (debatable in their freshman and sophomore years), and we can say a <strong class="source-inline">Professor</strong> <em class="italic">IS A</em> <strong class="source-inline">Person</strong> (debatable after they get tenure). This vocalization both defines and illustrates the relationship between the superclass, sometimes called the parent class, and its descendants, called subclasses or children.  </p>
<p>This leads us to a question: would it ever make sense to instantiate the <strong class="source-inline">Person</strong> class? The answer is no. <strong class="source-inline">Person</strong> is designed to be a parent class. It isn’t intended to be used directly. Classes that are not meant to be instantiated are<a id="_idIndexMarker813"/> called <strong class="bold">abstract classes</strong>. I’ve already put that in the class – I just didn’t call it out. The first line of the <strong class="source-inline">Person</strong> class was this:</p>
<pre class="source-code">public abstract class Person</pre>
<p>The <strong class="source-inline">abstract</strong> keyword will prevent direct instantiation.</p>
<p>Just remember that<a id="_idIndexMarker814"/> inheritance is a vital part of your OOP toolbox. Inheritance is like eggs. It’s part of a balanced breakfast, but a really good breakfast has some fiber in it too. Let’s get some metaphorical fiber in our code by learning about interfaces. Interfaces do nothing to lessen your risk of heart disease like a good bowl of low-sugar oatmeal does. Using them might lower your stress levels later when you discover how flexible your code will be once you incorporate them, which is just as good. If you eat low-sugar oatmeal <em class="italic">and</em> use interfaces in your code, maybe you’ll give Elvis a run for his money in terms of lifespan. </p>
<h1 id="_idParaDest-195"><a id="_idTextAnchor195"/>Interfaces</h1>
<p>An <strong class="bold">interface</strong> defines<a id="_idIndexMarker815"/> all or part of the structure a class must take by defining the public method signatures and properties that must be present in the class. This is a powerful tool that allows you to create a specification for an object’s behavior. The power of interfaces is multiplied by the fact that you are not limited to implementing a single interface versus using subclassing where you are only allowed a single parent.</p>
<p>Interfaces serve to loosely define behavior or type. Here’s a shout-out to all the <em class="italic">Unity 3D</em> developers in the crowd: imagine creating a video game where the player battles zombies and ancient creatures conjured by the imagination of H.P. Lovecraft – oh, and cats because cats are scary. Each monster could have its own class. You could create an interface to define behaviors such as fighting, running, eating humans, and more. Such a video game might look like <em class="italic">Figure A1.9</em>:</p>
<div>
<div class="IMG---Figure" id="_idContainer129">
<img alt="Figure A1.9: A terrible video game design that masterfully uses interfaces to map behaviors to characters in the game. " height="775" src="image/B18605_Figure_A1.6.jpg" width="1378"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A1.9: A terrible video game design that masterfully uses interfaces to map behaviors to characters in the game.</p>
<p>With these interfaces, you could define behaviors on objects that don’t necessarily fit together in an inheritance chain and wind up with game code that is very easy to extend.  </p>
<p>The key <a id="_idIndexMarker816"/>benefit to interfaces versus inheritance is flexibility. In <a href="B18605_02.xhtml#_idTextAnchor036"><em class="italic">Chapter 2</em></a>, we learn about SOLID principles and we learn about techniques for avoiding tightly coupling your classes together. If you define a property on a class with a type of <strong class="source-inline">Monster</strong>, then only <strong class="source-inline">Monster</strong> or a subclass of <strong class="source-inline">Monster</strong> will work. Your class is tightly coupled to <strong class="source-inline">Monster</strong>. If you define it by an interface, such as <strong class="source-inline">IEatHumans</strong>, you can pass any object that implements the interface as long as all you need are the methods defined by that interface.</p>
<h2 id="_idParaDest-196"><a id="_idTextAnchor196"/>Defining interfaces</h2>
<p>Practically speaking, if <a id="_idIndexMarker817"/>next week the game director decides to add a new monster to the game, we don’t have to reshuffle our object hierarchy if the new monster doesn’t happen to fit the structure we’ve created. We just make a new class and use the interfaces to define its structure. Let’s code out what we have in <em class="italic">Figure A1.9 </em>in C#, so we can see what this looks like in code instead of just a diagram. There are three interfaces used by the four characters:</p>
<ol>
<li><strong class="source-inline">IRun</strong></li>
<li><strong class="source-inline">IFight</strong></li>
<li><strong class="source-inline">IEatHumans</strong></li>
</ol>
<p>Let’s <a id="_idIndexMarker818"/>start with the <strong class="source-inline">IRun</strong> interface. Making interfaces is pretty easy. All you need to do is specify the basics of the method signature – specifically, the return type, the name of the method, and the names and types of the arguments: </p>
<pre class="source-code">public interface IRun
{
    void Jog();
    void Sprint();
}</pre>
<p>That was easy. What we’ve done here is to specify that any class implementing this interface must have two methods, both of which have a <strong class="source-inline">void</strong> return type. One must be called <strong class="source-inline">Jog()</strong>, which takes no arguments, and the other must be called <strong class="source-inline">Sprint()</strong>, which also takes no arguments. If you’re using a good IDE, any class you create that implements an interface will mark your code with red squiggles until you meet all the requirements of the interfaces. Let’s do <strong class="source-inline">IFight</strong> next:</p>
<pre class="source-code">public interface IFight
{
    void Attack();
}</pre>
<p><strong class="source-inline">IFight</strong> says any class that implements this interface must have a method called <strong class="source-inline">Attack()</strong>, which returns <strong class="source-inline">void</strong> and takes no arguments:</p>
<pre class="source-code">public interface IEatHumans
{
    void Chomp();
}</pre>
<p><strong class="source-inline">IEatHumans</strong> requires the implementing class to have a method called <strong class="source-inline">Chomp()</strong>, which takes no <a id="_idIndexMarker819"/>arguments and returns <strong class="source-inline">void</strong>. Interfaces are easy. Let’s look at how they’re used.</p>
<h2 id="_idParaDest-197"><a id="_idTextAnchor197"/>Implementing interfaces</h2>
<p>First, let’s <a id="_idIndexMarker820"/>make a class for <strong class="source-inline">HelplessVictim</strong>. The class implements the <strong class="source-inline">IRun</strong> interface. The syntax is the same as it is for inheritance. We use a colon to indicate the interface implementation, which would be the same if we were inheriting from a superclass:</p>
<pre class="source-code">public class HelplessVictim : IRun
{
    public void Jog()
    {
        throw new NotImplementedException();
    }
    public void Sprint()
    {
        throw new NotImplementedException();
    }
}</pre>
<p>To satisfy<a id="_idIndexMarker821"/> the interface, we must implement two methods, <strong class="source-inline">Jog()</strong> and <strong class="source-inline">Sprint()</strong>, exactly as specified in the interface. That’s nice. What if we need to implement more than one interface? It’s not possible for a class to have two parent classes. C# mercifully doesn’t support multiple inheritance, which is the leading cause of clinical insanity among C++ programmers. However, classes can implement as many interfaces as you’d like. Let’s make the <strong class="source-inline">AncientTerror</strong> class, which implements three interfaces – <strong class="source-inline">IRun</strong>, <strong class="source-inline">IFight</strong>, and <strong class="source-inline">IEatHumans</strong>:</p>
<pre class="source-code">public class AncientTerror : IRun, IFight, IEatHumans
{
    public void Chomp()
    {
        throw new NotImplementedException();
    }
    public void Attack()
    {
        throw new NotImplementedException();
    }
    public void Jog()
    {
        throw new NotImplementedException();
    }
    public void Sprint()
    {
        throw new NotImplementedException();
    }
}</pre>
<p><strong class="source-inline">IRun</strong> requires the same <strong class="source-inline">Jog()</strong> and <strong class="source-inline">Sprint()</strong> methods to be implemented. Note that it isn’t necessary to have the exact same implementation for the different classes. The instance methods simply have to conform to the interface. <strong class="source-inline">IFight</strong> requires the addition of a method called <strong class="source-inline">Attack()</strong>, which returns <strong class="source-inline">void</strong> and takes no arguments. <strong class="source-inline">IEatHumans</strong> requires us to add a <strong class="source-inline">Chomp()</strong> method per the interface.</p>
<p>I’ll save <a id="_idIndexMarker822"/>the scariest monsters, the zombie and the house cat, as an exercise in the questions section at the end. Challenge yourself and see whether you can come up with the basic implementation for these remaining two classes!</p>
<h1 id="_idParaDest-198"><a id="_idTextAnchor198"/>IDEs for C# development</h1>
<p>Whenever <a id="_idIndexMarker823"/>I work in a new or unfamiliar language, the first thing I want to know about is the tools used to work in that language. Good tools make learning and working with the language much easier. Microsoft realized this, and when they released the C# language and the accompanying .NET runtime, they also released Visual Studio – an IDE written specifically for use with C# and another very popular programming language called Visual Basic.</p>
<p>Visual Basic<a id="_idIndexMarker824"/> was Visual Studio’s predecessor. During the 1990s, Visual Basic was the most widely used development language product from Microsoft. The company also sold an IDE geared for C++ development called Visual C++, and briefly and ineffectively dabbled in Java with Visual J++. Of these toolkits, Visual Basic was by far the most important. At the time, Visual C++ was used by “serious” developers. Microsoft Windows is written in C and C++, so naturally, the tooling in Visual C++ was first and foremost designed to support that effort. Corporate software really became possible and mainstream with the BASIC language. In fact, the BASIC language formed the cornerstone of Microsoft itself. Bill Gates bought the rights for a BASIC compiler, and along with<a id="_idIndexMarker825"/> the <strong class="bold">Microsoft Disk Operating System</strong> (<strong class="bold">MS-DOS</strong>), he formed what would become one of the largest software companies in the world.</p>
<p>Visual Basic <a id="_idIndexMarker826"/>was designed by Alan Cooper. Cooper was a visionary. The Visual Basic UI was the first WYSIWYG design platform for computer software. Before the World Wide Web, we built software that ran solely on the desktop, and Visual Basic was the innovation that drove the industry.</p>
<p>But that’s enough history. Today, there are three important IDEs I want to tell you about. Chances are you’ve used one of them already. These tools include the following:</p>
<ul>
<li>Visual Studio</li>
<li>VS Code</li>
<li>Rider</li>
</ul>
<p>There are other IDEs out there, but these three are the most popular, complete, and frankly, important. If you use a Mac, it is worth mentioning that Visual Studio for Mac is not a port of Visual Studio. Earlier, I mentioned the open source version of C# called Mono. The team that developed Mono created an IDE<a id="_idIndexMarker827"/> called <em class="italic">Monodevelop</em>. It looks a lot like Apple’s X-Code IDE, and it was designed to allow Linux developers to write C# programs. <em class="italic">Monodevelop</em> was open source and was ultimately forked to become <em class="italic">Xamarin Studio</em>. <em class="italic">Xamarin Studio</em> is an IDE geared toward mobile development. Microsoft <a id="_idIndexMarker828"/>bought out Xamarin several years ago. A separate fork of the technology became Visual Studio for Mac. I mention it because it looks nothing like the IDEs we’ll be covering, so if you’re on a Mac, my screenshots won’t help much.</p>
<p>To learn patterns, you only need a fraction of the functionality these IDEs provide. In this section, I wanted to walk you through creating the two project types found in this book: the command-line project and the library project.</p>
<p>Command-line programs<a id="_idIndexMarker829"/> are the simplest programs you can make that will actually run. They have no user interface and are run from, you guessed it, the command line. Libraries are code projects used to house objects meant to be shared between projects. In <a href="B18605_03.xhtml#_idTextAnchor063"><em class="italic">Chapter 3</em></a>, I create a shared library that is used across many other chapters because they share a lot of the same code, as typing the same classes over and over would get very tedious.</p>
<p>Let’s take a look at these IDEs starting with Visual Studio.</p>
<h2 id="_idParaDest-199"><a id="_idTextAnchor199"/>Visual Studio</h2>
<p>Visual Studio<a id="_idIndexMarker830"/> needs no<a id="_idIndexMarker831"/> further introduction. You can get a copy at <a href="https://www.visualstudio.com">https://www.visualstudio.com</a>. The IDE comes in<a id="_idIndexMarker832"/> three editions:</p>
<ul>
<li>Visual Studio Community</li>
<li>Visual Studio Professional</li>
<li>Visual Studio Enterprise</li>
</ul>
<p>The first two are effectively identical except for how they are licensed. The Community Edition is free<a id="_idIndexMarker833"/> assuming you meet the licensing requirements. These things tend to change over time, so I’m not going to try to quote those requirements here. Review the Visual Studio website to see whether you qualify for a free license.</p>
<p>Visual Studio Professional<a id="_idIndexMarker834"/> is the paid version of the same tool. If you work for a company with a certain number of developers, or that makes a certain amount of revenue, you need to buy a subscription.</p>
<p>Visual Studio Enterprise<a id="_idIndexMarker835"/> is a more expensive version of the paid editions and ships with a myriad of extra features not present in the Professional Edition.</p>
<p>Any of these editions will be fine for use with this book. I’ll be demonstrating the Community Edition, which, again, is indistinguishable from the Professional Edition.</p>
<h3>Creating a command-line project</h3>
<p>Having<a id="_idIndexMarker836"/> downloaded, installed, registered, and launched the IDE, you are greeted with a screen that looks something like <em class="italic">Figure A1.10:</em></p>
<div>
<div class="IMG---Figure" id="_idContainer130">
<img alt="Figure A1.10: The opening screen for Visual Studio 2022. " height="631" src="image/B18605_Figure_A1.7.jpg" width="1378"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A1.10: The opening screen for Visual Studio 2022.</p>
<p>Click on the <strong class="bold">Create a new project</strong> button in the lower-right corner of the window. Doing this presents you with <em class="italic">Figure A1.11</em>:</p>
<div>
<div class="IMG---Figure" id="_idContainer131">
<img alt="Figure A1.11: Create a new project in Visual Studio using this dialog. " height="628" src="image/B18605_Figure_A1.8.jpg" width="1378"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A1.11: Create a new project in Visual Studio using this dialog.</p>
<p>You’re <a id="_idIndexMarker837"/>looking for the <em class="italic">Console App</em> project in C#. If you did a full install of Visual Studio, beware that the tool might show you Visual Basic projects as well as C#. Make sure you pick the C# version of the project template. Note that the icons on the templates denote the language they use, as shown in <em class="italic">Figure A1.12</em>:</p>
<div>
<div class="IMG---Figure" id="_idContainer132">
<img alt="Figure A1.12: Watch the icons on the project templates; it is easy to accidentally generate a new project in the wrong language. " height="921" src="image/B18605_Figure_A1.9.jpg" width="1288"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A1.12: Watch the icons on the project templates; it is easy to accidentally generate a new project in the wrong language.</p>
<p>If you don’t <a id="_idIndexMarker838"/>see the <strong class="bold">Console App</strong> project template, you can search for it using the search dialog at the top, as shown in <em class="italic">Figure A.13</em>:</p>
<div>
<div class="IMG---Figure" id="_idContainer133">
<img alt="Figure A1.13: You can search for the console app template if you don’t see it listed. " height="628" src="image/B18605_Figure_A1.10.jpg" width="1378"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A1.13: You can search for the console app template if you don’t see it listed.</p>
<p>Click on <a id="_idIndexMarker839"/>the <strong class="bold">Console App</strong> template, and click on <strong class="bold">Next</strong> in the lower-right corner of the dialog. This takes you to a dialog titled <strong class="bold">Configure your new project</strong>, as shown in <em class="italic">Figure A1.14</em>:</p>
<div>
<div class="IMG---Figure" id="_idContainer134">
<img alt="Figure A1.14: Configuring your new project by giving it a name and location " height="633" src="image/B18605_Figure_A1.11.jpg" width="1378"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A1.14: Configuring your new project by giving it a name and location</p>
<p>This dialog<a id="_idIndexMarker840"/> allows you to name your project and specify its location on your hard drives. You can also choose to name your solution differently than your project. A solution is a collection of projects bound into one set of files. This allows you to work on multiple related projects in a convenient way. Maybe you have a web application and a related command-line program that belong together. A solution allows you to store the related projects together. If you are storing related projects together, you might not want to name the solution the same as the project. For the exercises in this book, it doesn’t matter.</p>
<p>We’re going to name the project <strong class="source-inline">BicycleConsoleApp</strong>. We’re going to name the solution <strong class="source-inline">BicycleSolution</strong>. Use a location on your computer that is convenient. The checkbox at the bottom specifies a folder structure. You can just leave it unchecked. Your project configuration should resemble <em class="italic">Figure A1.15</em>. Click on the <strong class="bold">Next</strong> button in the lower-right corner of the dialog:</p>
<div>
<div class="IMG---Figure" id="_idContainer135">
<img alt="Figure A1.15: The Additional information dialog lets you set the framework for the project. " height="631" src="image/B18605_Figure_A1.12.jpg" width="1379"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A1.15: The Additional information dialog lets you set the framework for the project.</p>
<p>The <strong class="bold">Additional information</strong> dialog allows you to pick the .NET Framework type that you’ll use for development. The default at the time of this writing is <strong class="bold">.NET 6.0 (Long-term support)</strong>. Just accept the defaults as they are and click on the <strong class="bold">Create</strong> button. This will complete project creation, and you’ll see the full IDE, as shown in <em class="italic">Figure A1.16</em>:</p>
<div>
<div class="IMG---Figure" id="_idContainer136">
<img alt="Figure A1.16: The new project is created and ready in Visual Studio. " height="634" src="image/B18605_Figure_A1.13.jpg" width="1379"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A1.16: The new project is created and ready in Visual Studio.</p>
<p>Your <a id="_idIndexMarker841"/>project is ready! You can start developing your code.</p>
<h3>Adding a new class</h3>
<p>Once your <a id="_idIndexMarker842"/>project has been created, you’ll be needing to add new classes. To add a class, right-click on the <strong class="source-inline">BicycleConsoleApp</strong> project, and you’ll find a context menu. Find the <strong class="bold">Add</strong> option and hover over it. A second menu expands. Find <strong class="bold">Class...</strong> at the bottom of the menu and click on it. You can see the menu layout in <em class="italic">Figure A1.17</em>:</p>
<div>
<div class="IMG---Figure" id="_idContainer137">
<img alt="Figure A1.17: The menu item for adding a class accessed from Solution Explorer in Visual Studio. " height="614" src="image/B18605_Figure_A1.14.jpg" width="1379"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A1.17: The menu item for adding a class accessed from Solution Explorer in Visual Studio.</p>
<p>The next step is <a id="_idIndexMarker843"/>to specify what you wish to add using the dialog in <em class="italic">Figure A1.18</em>. In this case, we’re adding a class. Note there is also an option for adding an interface. You’ll need both, but right now, let’s focus on adding a class:</p>
<div>
<div class="IMG---Figure" id="_idContainer138">
<img alt="Figure A1.18: The Add New Item dialog in Visual Studio can be used to add anything, including classes and interfaces. " height="615" src="image/B18605_Figure_A1.15.jpg" width="1379"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A1.18: The Add New Item dialog in Visual Studio can be used to add anything, including classes and interfaces.</p>
<p>Click on <strong class="bold">Class</strong>, then give the file a name that matches the name of the class you want to create. Usually, I honor the age-old Java convention of having one class per file. Click on the <strong class="bold">Add</strong> button, and the class will be created and added to your project.</p>
<p>To add an <a id="_idIndexMarker844"/>interface, follow the same procedure, but select <strong class="bold">Interface</strong> instead of <strong class="bold">Class</strong>. By convention, C# interfaces always start with the letter I (as in “Interface”), so name your file the same as what you plan to name your interface.</p>
<h3>Adding a library project to the solution</h3>
<p>When you <a id="_idIndexMarker845"/>created the command-line app project, Visual Studio also created a solution. Solutions are containers for projects. Even if you only have one project, it will be inside a solution. You can add more projects to the solution. This is a handy way of keeping related projects together.</p>
<p>Library projects are used to house reusable code designed to be accessible between projects. In <em class="italic">Chapters 3–5</em> of this book, I use a library for common classes like those that model the basic parts of the bicycle classes we’re building in those chapters. In the real world, you generally put your business logic in a library. When you do this, you can leverage that logic in a web application, a mobile application, and a desktop application without repeating your code in three places.</p>
<p>Creating a library project is easy. Right-click on the solution in the solution explorer. Locate the <strong class="bold">Add</strong> option, hover over it, and click on <strong class="bold">New Project</strong>. A new project dialog appears, as shown in <em class="italic">Figure A1.19</em>:</p>
<div>
<div class="IMG---Figure" id="_idContainer139">
<img alt="Figure A1.19: The context menu in Visual Studio used to add a new project to the solution. " height="615" src="image/B18605_Figure_A1.16.jpg" width="1379"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A1.19: The context menu in Visual Studio used to add a new project to the solution.</p>
<p>Locate<a id="_idIndexMarker846"/> the <strong class="bold">Class Library</strong> project template. If you don’t see it, type the term <strong class="source-inline">Library</strong> into the search box at the top of the dialog. Make sure the class library template is using the C# language and not some other language such as Visual Basic or F#. Click on the <strong class="bold">Class Library</strong> project option, and click on the button labeled <strong class="bold">Next</strong> near the bottom-right corner of the dialog. You’re taken to another dialog asking for your project name and its location. Let’s call the project <strong class="source-inline">BicycleLibrary</strong>. The location should be defaulting to the location of the solution and, by extension, the console app project we just made. Click on the <strong class="bold">Next</strong> button.</p>
<p>The next dialog allows you to select the .NET runtime for your project. Generally, you want these to match. We picked .NET 6.0 for the console app, so we should pick the same thing here. Click on the <strong class="bold">Create</strong> button, and Visual Studio will generate the project’s files for you.</p>
<h3>Linking the library project to the console project</h3>
<p>Before you can<a id="_idIndexMarker847"/> use the library, you must create a reference to it in the <strong class="source-inline">BicycleConsoleApp</strong> project. To create the reference, right-click on the <strong class="bold">Dependencies</strong> option in the console app, and then click on <strong class="bold">Add Project Reference</strong>. This reveals a dialog, as shown in <em class="italic">Figure A1.20</em>:</p>
<div>
<div class="IMG---Figure" id="_idContainer140">
<img alt="Figure A1.20: The menu used to add project dependencies to a project in Visual Studio. " height="617" src="image/B18605_Figure_A1.17.jpg" width="1379"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A1.20: The menu used to add project dependencies to a project in Visual Studio.</p>
<p>The <strong class="bold">Projects</strong> option is at the top of the dialog and is probably already selected. You should see the name of your library project in the list. Click on the checkbox next to the library project you just made, and then click on <strong class="bold">OK</strong>.</p>
<p>Your library <a id="_idIndexMarker848"/>is now available within your console app project.</p>
<h3>Referencing the library</h3>
<p>When you created the library project, Visual Studio created a file called <strong class="source-inline">Class1.cs</strong>. Let’s add a<a id="_idIndexMarker849"/> method to that class and then see how to reference it in the console app.</p>
<p>Open the <strong class="source-inline">Class1.cs</strong> file in the class library project. Add this code:</p>
<pre class="source-code">namespace BicycleLib;
public class Class1
{
  <strong class="bold">public string SayHello()</strong>
<strong class="bold">    {</strong>
<strong class="bold">        return "Hello from the Bicycle Library!";</strong>
<strong class="bold">    }</strong>
}</pre>
<p>Save the file.</p>
<p>Now, open the <strong class="source-inline">Program.cs</strong> file in the console app project. You should see a “Hello World” program. Replace the starter code with this:</p>
<pre class="source-code">using System;
using BicycleLibrary;
var test = new Class1();
Console.WriteLine(test.SayHello());</pre>
<p>Notice that as <a id="_idIndexMarker850"/>you type the code (type it, don’t copy and paste – copy and paste teaches you nothing!), you’ll find that IntelliSense is giving you hints on the method you added in the library. Effectively, you are using the code in the library as if it were part of the console app project!</p>
<p>There’s just one thing left to do: build the project.</p>
<h3>Building and running the console project</h3>
<p>C# applications are <a id="_idIndexMarker851"/>compiled. If you’re used to an interpreted<a id="_idIndexMarker852"/> language such as JavaScript or Python, you might not be familiar with this step. The C# compiler, code-named <strong class="bold">Roslyn</strong>, has been <a id="_idIndexMarker853"/>interacting with you this whole time. The compiler checks your code in Visual Studio as you write it. It flags mistakes and underlines things you should fix. Additionally, it gives you the IntelliSense for your code completion. A distinct difference from what you’re seeing in Visual Studio is that this tool uses the compiler and a feature of the .NET called <strong class="bold">introspection</strong>. This means Roslyn can literally see the classes and code <a id="_idIndexMarker854"/>within your project. This makes your Intellisense hints extremely accurate. If you’ve seen code completion in other editors such as Sublime Text or VS Code, the hints you are getting are not nearly as accurate. Those are coming from, at best, depending on which editor we’re talking about, an index of the code you have in place so far. When you type <strong class="source-inline">foo</strong>, where <strong class="source-inline">foo</strong> is any given object, an augmented text editor will probably give you every possible option that could come after that dot. Really good editors might use probability or AI to narrow the field. Visual Studio only shows you viable options based on introspection. The latest versions of Visual Studio are starting to include AI features. When AI is combined with IntelliSense, the results are frightening. You can expect Visual Studio to write entire blocks of code for you, not just boilerplate; the actual methods in your code.  </p>
<p>Better code hints and early warnings about code mistakes are among the benefits of working with compiled languages. The compiler doesn’t allow the most common types of mistakes, so you find and fix them early because you must. The product of a compiled language is also generally faster in terms of execution speed.</p>
<p>Building in<a id="_idIndexMarker855"/> Visual Studio is very simple, and there are a <a id="_idIndexMarker856"/>few ways to do it. The most straightforward is to run your program. To do this, just click on the green arrow in the toolbar. <em class="italic">Figure A1.21</em> shows the location of the <strong class="bold">Run</strong> button. Unfortunately, <em class="italic">Figure A1.21</em> isn’t in color. The book editor’s bosses muttered something about budgets and money not growing on trees. I haven’t met the boss of bosses at Packt, but I suspect they used to hang out with my father (God rest his soul) <em class="italic">A LOT</em>. The good news is you really can’t miss it in the IDE:</p>
<div>
<div class="IMG---Figure" id="_idContainer141">
<img alt="Figure A1.21: Locate the green triangle in the IDE; this is the Run button. " height="615" src="image/B18605_Figure_A1.18.jpg" width="1379"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A1.21: Locate the green triangle in the IDE; this is the Run button.</p>
<p>When you <a id="_idIndexMarker857"/>click on the <strong class="bold">Run</strong> button, your program builds, and<a id="_idIndexMarker858"/> it is then executed with an attached debugger. You’ll see your running program, as shown in <em class="italic">Figure A1.22</em>:</p>
<div>
<div class="IMG---Figure" id="_idContainer142">
<img alt="Figure A1.22: The program runs in a window. " height="613" src="image/B18605_Figure_A1.19.jpg" width="1379"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A1.22: The program runs in a window.</p>
<p>To stop the program, press your computer’s <em class="italic">Any</em> key in the running console app window: </p>
<div>
<div class="IMG---Figure" id="_idContainer143">
<img alt="Figure A1.23: Press the Any key to exit Visual Studio’s program run; if your computer doesn’t have an Any key like mine, you can use the spacebar. " height="282" src="image/B18605_Figure_A1.20.jpg" width="1433"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A1.23: Press the Any key to exit Visual Studio’s program run; if your computer doesn’t have an Any key like mine, you can use the spacebar.</p>
<p>The <em class="italic">Any</em> key is common on older keyboards. It does limit your ability to write code using the letter <em class="italic">H</em>. Since I live in Texas, I just use <em class="italic">J</em> instead. It’s a small price to pay for being able to quickly exit from your running programs.</p>
<p>If your <a id="_idIndexMarker859"/>computer doesn’t have an <em class="italic">Any</em> key, just press the <a id="_idIndexMarker860"/>spacebar. Note that the pause message isn’t part of your program, and it won’t be there if you publish your application. This is Visual Studio pausing the application. Console apps tend to run and exit in under a second. If something goes wrong, the program will finish, display an error, then kill the window before you have a chance to see anything. So, Visual Studio does you a solid and freezes the window before the program exits so that you can inspect it. Your program should have run without any errors.</p>
<p>This concludes our brief tour of Visual Studio. If you’re interested in a video walk-through that coaches you through setting up a Visual Studio development environment in Windows, you’ll find links for this at <a href="https://csharppatterns.dev">https://csharppatterns.dev</a>.</p>
<h2 id="_idParaDest-200"><a id="_idTextAnchor200"/>VS Code</h2>
<p>VS Code <a id="_idIndexMarker861"/>bears a<a id="_idIndexMarker862"/> similar name to Visual Studio but is an entirely different beast. Rather than being a full-fledged IDE, VS Code is really an augmented text editor rather than a true IDE. We just covered Microsoft’s Gold Standard for editing tools. Why should I even talk about VS Code? The answer: VS Code currently has over 50% of the market share, making it the most popular tool used by most developers every day. There are some good reasons for this:</p>
<ul>
<li>VS Code takes a fraction of the space as Visual Studio, which all-in requires nearly 45 GB of space. You can reduce the footprint of Visual Studio, but VS Code is still going to boast a smaller footprint.</li>
<li>VS Code launches very quickly. Visual Studio doesn’t. You can use VS Code to quickly look at a repository you pulled off GitHub or some folder a colleague shared with you. Launching Visual Studio is a commitment. If you’re on a less powerful computer, you can likely catch up on your emails, take a quick peek at social media, get some coffee, and call your mother before you get the IDE’s opening screen. By the way, call your mother! She misses you.</li>
<li>VS Code works with nearly any programming language. Naturally, it works well with Microsoft-supported languages and other popular languages such as Golang or Rust. Also, you’ll find extensions that allow you to use it with oddball languages. The original GoF book used the SmallTalk programming language, which is offered by two extension vendors. You can find Ada, Haskell, and many more. Visual Studio is mainly used for mainstream work in Microsoft language products.</li>
<li>VS Code has a consistent user experience across all operating systems. Visual Studio is a Windows-only program. It won’t run in Linux. Visual Studio Mac is a completely different program and looks nothing like the Windows version. This consistency makes the tool a popular choice for schools, universities, and code boot camps like the one I teach at Southern Methodist University.</li>
</ul>
<p>VS Code has a lot going for it. Like Visual Studio, VS Code<a id="_idIndexMarker863"/> can also be downloaded at <a href="https://www.visualstudio.com">https://www.visualstudio.com</a>.</p>
<p>If VS Code is going to be your editor of choice, you’re going to need to install the .NET Core SDK to give you the tools and compilers to work with C#.</p>
<h3>Installing .NET Core</h3>
<p>You need <a id="_idIndexMarker864"/>the .NET Core SDK if you are going to work with VS Code. You can download it from <a href="https://dotnet.microsoft.com/en-us/download">https://dotnet.microsoft.com/en-us/download</a>. Naturally, that web address might change after this book is published, in which case you’ll have to be resourceful. Installing it is straightforward.</p>
<p>With VS Code and .NET Core SDK installed, you’re ready to get started. If you read the steps for setting up a project in Visual Studio, the steps for VS Code are very different.</p>
<h3>Creating a new solution</h3>
<p>Visual Studio creates<a id="_idIndexMarker865"/> a project and a solution in one step. This is VS Code. Each step is performed separately, and it is all done from the command line. Technically speaking, VS Code isn’t really involved. You use the <strong class="source-inline">dotnet</strong> command-line tool that was installed when you installed the .NET Core SDK. You can do all of this in Windows Terminal. </p>
<p>Since Windows Terminal comes with Windows 11, there is nothing further to install. If you’ve never used it, click on <strong class="bold">Start</strong>, and then search for <strong class="source-inline">Terminal</strong>, as shown in <em class="italic">Figure A1.24</em>. Launch the app. If you’re still using Windows 10, search for <strong class="source-inline">PowerShell</strong> instead of <strong class="source-inline">Terminal</strong>:</p>
<div>
<div class="IMG---Figure" id="_idContainer144">
<img alt="Figure A1.24: Most of the project setup work with VS Code happens in the Terminal window. " height="667" src="image/B18605_Figure_A1.21.jpg" width="1379"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A1.24: Most of the project setup work with VS Code happens in the Terminal window.</p>
<p>With Terminal (or PowerShell) open, type this command:</p>
<pre class="source-code">dotnet new sln -o BicycleSolution</pre>
<p>Here, <strong class="source-inline">-o</strong> is <a id="_idIndexMarker866"/>for <em class="italic">output</em>. This tells the command to create a folder for the solution. In addition to creating the folder, the command generates a set of files in the <strong class="source-inline">BicycleSolution</strong> folder. Let’s take a look. Type this:</p>
<pre class="source-code">cd BicyleSolution</pre>
<p>Then, type in this:</p>
<pre class="source-code">dir</pre>
<p>The <strong class="source-inline">dir</strong> (directory) command will list all the files in the current working directory. You should see something like <em class="italic">Figure A1.25</em>:</p>
<div>
<div class="IMG---Figure" id="_idContainer145">
<img alt="Figure A1.25: The result of our new solution command. " height="631" src="image/B18605_Figure_A1.22.jpg" width="1379"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A1.25: The result of our new solution command.</p>
<p>We have a <a id="_idIndexMarker867"/>solution, but there’s nothing in it. We need some projects to make the solution useful.</p>
<h3>Creating a command-line project</h3>
<p>Next, we’ll add a<a id="_idIndexMarker868"/> console application to the current solution folder. First, <strong class="source-inline">cd</strong> into the <strong class="source-inline">BicycleSolution</strong> folder. Going forward, the commands I’m giving you are based on the assumption that your present working directory is the <strong class="source-inline">BicycleSolution</strong> folder.</p>
<p>To add the console app to the solution, type this command into the Terminal window:</p>
<pre class="source-code">dotnet new console -o BicycleConsoleApp</pre>
<p>This creates a new console app. Again, <strong class="source-inline">-o</strong> is for output. This tells the command what to call the project. The <strong class="source-inline">dotnet</strong> command generates the boilerplate files for the console app project, as shown in <em class="italic">Figure A1.27</em>: </p>
<div>
<div class="IMG---Figure" id="_idContainer146">
<img alt="Figure A1.27: Our command generated your file structure for the command-line project. " height="631" src="image/B18605_Figure_A1.23.jpg" width="1379"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A1.27: Our command generated your file structure for the command-line project.</p>
<p>Once you have <a id="_idIndexMarker869"/>the app created, you need to add it to your solution using this command:</p>
<pre class="source-code">dotnet sln add BicycleConsoleApp/BicycleConsoleApp.csproj</pre>
<p>The result of the command can be seen in <em class="italic">Figure A1.28</em>:</p>
<div>
<div class="IMG---Figure" id="_idContainer147">
<img alt="Figure A1.28: The console app was successfully added to the solution. " height="633" src="image/B18605_Figure_A1.24.jpg" width="1379"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A1.28: The console app was successfully added to the solution.</p>
<p>There won’t be<a id="_idIndexMarker870"/> a visible change to the folder structure. The command alters the <strong class="source-inline">BicycleSolution.sln</strong> file to include the <strong class="source-inline">BicycleConsoleApp</strong> project. Your command-line project is ready to use.</p>
<h3>Creating a library project</h3>
<p>Library projects <a id="_idIndexMarker871"/>are used to house reusable code designed to be accessible between projects. In <em class="italic">Chapters 3–5</em> of this book, I use a library for common classes like those that model the basic parts of the bicycle classes we’re building in those chapters. In the real world, you generally put your business logic in a library. When you do this, you can leverage that logic in a web application, a mobile application, and a desktop application without repeating your code in three places.</p>
<p>To create a library project in your solution folder, type the following command into your Terminal window:</p>
<pre class="source-code">dotnet new classlib -o BicycleLibrary</pre>
<p>As before, the command creates a new project within the current solution. The <strong class="source-inline">-o</strong> switch tells the command what to name the output, which, in this case, is the name of the library project. Having created the library project, you need to add the project to your solution using this command:</p>
<pre class="source-code">dotnet sln add BicycleLibrary/BicycleLibrary.csproj</pre>
<p>Use the <strong class="source-inline">dir</strong> command to confirm that your folder structure looks like mine in <em class="italic">Figure A1.29</em>:</p>
<div>
<div class="IMG---Figure" id="_idContainer148">
<img alt="Figure A1.29: The project structure after creating the solution, the console app, and the library project. " height="631" src="image/B18605_Figure_A1.25.jpg" width="1379"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A1.29: The project structure after creating the solution, the console app, and the library project.</p>
<p>Now that you<a id="_idIndexMarker872"/> have the library project, you need to set up a reference between the console app and the library project.</p>
<h3>Linking the library to the console project</h3>
<p>To link<a id="_idIndexMarker873"/> the console project to the library project, type in this command:</p>
<pre class="source-code">dotnet add BicycleConsoleApp/BicycleConsoleApp.csproj reference BicycleLibrary/BicycleLibrary.csproj</pre>
<p>The library is linked to the console app project. We’ve spent a lot of time in the Terminal window. It’s time to start working in VS Code.</p>
<h3>Launching VS Code and adding the C# extension</h3>
<p>Adding a <a id="_idIndexMarker874"/>class or an interface is easy in VS Code. You can launch VS Code from the Terminal window we’ve been using by typing in the following:</p>
<pre class="source-code">code .</pre>
<p>You read it correctly: type in <strong class="source-inline">code</strong>, add a space and a period, and then press <em class="italic">Enter</em>. This command launches VS Code with the solution folder loaded. You’ll be greeted by your usual security warning, as shown in <em class="italic">Figure A1.30</em>:</p>
<div>
<div class="IMG---Figure" id="_idContainer149">
<img alt="Figure A1.30: Do you trust the files you just made? " height="331" src="image/B18605_Figure_A1.26.jpg" width="737"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A1.30: Do you trust the files you just made?</p>
<p>Assuming you<a id="_idIndexMarker875"/> trust your own work, click on <strong class="bold">Yes</strong>. If you don’t, briefly close this book and ponder deeply on this. Consider whether it’s better to live in a beautiful boring secure world where no harm will ever come to you; a world filled with beautiful flowers whose aroma reminds you of<a id="_idIndexMarker876"/> only the best moments of your life. Or would you rather live in a world filled with high adventure and the possibility of total ruin? Pirate ships are safe hiding in port. But they are not meant to stay there! This is your moment! Go for it! Click on the <strong class="bold">Yes, I trust the authors</strong> button! I promise that if you do, you’ll turn a corner in your life. Grow a spine already and click on the button! Side note: my attorney wants me to remind you the author is not responsible for malware, computer damage, damage to your reputation, or pirate attacks resulting from clicking on this button.</p>
<p>With your personal issues resolved, if you had them, let’s continue. </p>
<p>I have mentioned that VS Code isn’t considered a full-fledged IDE. It is meant as a general-purpose coding tool and doesn’t assume anything about how you will use it. As such, VS Code doesn’t come with C# support baked in. Naturally, Microsoft has a plugin to help you with C#. You’ll probably be prompted to install the plugin as soon as the project opens. In case you aren’t, you can install it by following the steps shown in <em class="italic">Figure A1.30</em>:</p>
<div>
<div class="IMG---Figure" id="_idContainer150">
<img alt="Figure A1.30: Microsoft makes a free extension for VS Code that makes working with C# more enjoyable. " height="667" src="image/B18605_Figure_A1.27.jpg" width="1378"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A1.30: Microsoft makes a free extension for VS Code that makes working with C# more enjoyable.</p>
<p>First, click on the <strong class="bold">Extensions</strong> button <a id="_idIndexMarker877"/>in the menu on the left-hand side of the interface (1). Then, search for this extension in the search bar (2):</p>
<pre class="source-code">@id:ms-dotnettools.csharp</pre>
<p>This will narrow the list to a single extension. Click on it, and then click on the install button. VS Code is now fully aware of the C# language and the structure of your project.</p>
<h3>Adding a class or interface</h3>
<p>Right-click <a id="_idIndexMarker878"/>on the <strong class="source-inline">BicycleConsoleApp</strong> folder in the explorer view<a id="_idIndexMarker879"/> and click on <strong class="bold">New File</strong>, as shown in <em class="italic">Figure A1.31</em>: </p>
<div>
<div class="IMG---Figure" id="_idContainer151">
<img alt="Figure A1.31: Right-click on the explorer area, and click on New File to create a new file. " height="633" src="image/B18605_Figure_A1.28.jpg" width="1308"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A1.31: Right-click on the explorer area, and click on New File to create a new file.</p>
<p>Once you<a id="_idIndexMarker880"/> click on <strong class="bold">New File</strong>, just type in the name of the file you want to create. Be<a id="_idIndexMarker881"/> sure to include the <strong class="source-inline">.cs</strong> extension. For example, I’m calling my file <strong class="source-inline">Class1.cs</strong>. If you’re creating an interface, it is standard practice to begin the filename with a capital I (as in “Interface”).</p>
<h3>Adding code to the BicycleLibrary project </h3>
<p>Let’s add a <a id="_idIndexMarker882"/>method to the <strong class="source-inline">BicycleLibrary</strong> project so that we can verify it is linked and working correctly. </p>
<p>Find the <strong class="source-inline">Class1.cs</strong> file in the <strong class="source-inline">BicycleLibrary</strong> project. This file was generated for you when you created the project. Click on the file, and it will open in the editor. Add the following code:</p>
<pre class="source-code">namespace BicycleLibrary;
public class Class1
{
  <strong class="bold">public string SayHello()</strong>
<strong class="bold">    {</strong>
<strong class="bold">        return "Hello from the Bicycle Library!";</strong>
<strong class="bold">    }</strong>
}</pre>
<p>Be sure to save the file! Compare your project with mine, as shown in <em class="italic">Figure A1.32</em>:</p>
<div>
<div class="IMG---Figure" id="_idContainer152">
<img alt="Figure S1.32: The library code has been added to Class1.cs in the BicycleLibrary project. " height="631" src="image/B18605_Figure_A1.29.jpg" width="1378"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure S1.32: The library code has been added to Class1.cs in the BicycleLibrary project.</p>
<p>Next, let’s<a id="_idIndexMarker883"/> switch to the <strong class="source-inline">Program.cs</strong> file in the <strong class="source-inline">BicycleConsoleApp</strong> project. Replace the line <strong class="source-inline">dotnet</strong> generated with the following:</p>
<pre class="source-code">using System;
using BicycleLibrary;
var test = new Class1();
Console.WriteLine(test.SayHello());</pre>
<p>As you type, IntelliSense will show you the library method we added to the <strong class="source-inline">BicycleLibrary</strong> project as if it was within the <strong class="source-inline">BicycleConsoleApp</strong> project. Check your work against <em class="italic">Figure A1.33</em>:</p>
<div>
<div class="IMG---Figure" id="_idContainer153">
<img alt="Figure A1.33: The updated Program.cs file with our test code. " height="631" src="image/B18605_Figure_A1.30.jpg" width="1378"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A1.33: The updated Program.cs file with our test code.</p>
<p>Our mission<a id="_idIndexMarker884"/> has been accomplished! There is just one thing left to do: build the project.</p>
<h3>Building and running the console project</h3>
<p>We could <a id="_idIndexMarker885"/>switch back to our Terminal window, but VS Code <a id="_idIndexMarker886"/>has an integrated Terminal window. Using it is more convenient than constantly switching windows.</p>
<p>To activate it, use the keyboard shortcut <em class="italic">Ctrl</em> + <em class="italic">`</em> (control + backtick). Additionally, you can click on <strong class="bold">View</strong> and then <strong class="bold">Terminal</strong> from the main menu, as shown in <em class="italic">Figure A1.34</em>:</p>
<div>
<div class="IMG---Figure" id="_idContainer154">
<img alt="Figure A1.34: You can open the integrated Terminal window in VS Code using this menu item, or Ctrl + ` as a keyboard shortcut. " height="629" src="image/B18605_Figure_A1.31.jpg" width="1378"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A1.34: You can open the integrated Terminal window in VS Code using this menu item, or Ctrl + ` as a keyboard shortcut.</p>
<p>Running the project <a id="_idIndexMarker887"/>will build the project and then execute the <strong class="source-inline">BicycleConsoleApp</strong> project’s<a id="_idIndexMarker888"/> executable file, which consists of the code in the <strong class="source-inline">Program.cs</strong> file. To run the program in the Terminal window, enter this command:</p>
<pre class="source-code">dotnet run –-project .\BicycleConsoleApp\BicycleConsoleApp.csproj</pre>
<p>You’ll see the program being built, and the command-line project will run. You should see the “Hello from the Bicycle Library!” message in the Terminal window just like you see it in <em class="italic">Figure A1.35</em>:</p>
<div>
<div class="IMG---Figure" id="_idContainer155">
<img alt="Figure A1.35: This is the result of our test run. " height="632" src="image/B18605_Figure_A1.32.jpg" width="1378"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A1.35: This is the result of our test run.</p>
<p>This concludes <a id="_idIndexMarker889"/>our brief tour of VS Code. If you’re interested in a video <a id="_idIndexMarker890"/>walk-through that coaches you through setting up a VS Code development environment in Windows, you’ll find links for this at <a href="https://csharppatterns.dev">https://csharppatterns.dev</a>.</p>
<h2 id="_idParaDest-201"><a id="_idTextAnchor201"/>Rider</h2>
<p>JetBrains Rider <a id="_idIndexMarker891"/>is the most recent addition to the world <a id="_idIndexMarker892"/>of C# IDEs. JetBrains is known for making amazing IDEs for Java (<em class="italic">IntelliJ Idea</em>), Python (<em class="italic">Pycharm</em>), PHP (<em class="italic">PHPStorm</em>), and JavaScript (<em class="italic">WebStorm</em>) among others. They also built Google’s IDE for Android Development, <em class="italic">Android Studio</em>. In addition to IDEs, the company has a very popular add-in product for Visual Studio called <em class="italic">Resharper</em>. The tools in <em class="italic">Resharper</em> give<a id="_idIndexMarker893"/> you many similar features you’ll find in <em class="italic">Visual Studio Enterprise</em> at a fraction of the cost.</p>
<p>I used Rider to create this book, mainly because of the code formatting and refactoring tools available in the program. Also, I use several of their other IDEs regularly, and I have my keyboard shortcuts configured to be common in every language IDE I use. This is purely a personal preference. I knew I could produce this book more quickly with Rider.</p>
<p>Rider is not a free product. There is a lower-cost version available for solo developers, and the same product is sold at a higher rate for use in companies. Check out <a href="https://www.jetbrains.com/rider">https://www.jetbrains.com/rider</a> for more information if you’re interested in using this tool.</p>
<p>Since I used Rider to create the book, I think it would be strange if I didn’t at least show you around. Let’s do this exercise one more time using Rider.</p>
<h3>Creating a command-line project</h3>
<p>When you launch Rider, you are<a id="_idIndexMarker894"/> greeted with the <strong class="bold">Welcome</strong> screen dialog. Click on the <strong class="bold">New Project</strong> button in the upper-right portion of the dialog box, as shown in <em class="italic">Figure A1.36</em>:</p>
<div>
<div class="IMG---Figure" id="_idContainer156">
<img alt="Figure A1.36: The welcoming screen in Rider with the New Project button highlighted. " height="667" src="image/B18605_Figure_A1.33.jpg" width="1379"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A1.36: The welcoming screen in Rider with the New Project button highlighted.</p>
<p>Clicking on the button gives you another dialog, as shown in <em class="italic">Figure A1.37</em>:</p>
<div>
<div class="IMG---Figure" id="_idContainer157">
<img alt="Figure A1.37: Project creation in Rider. " height="667" src="image/B18605_Figure_A1.34.jpg" width="1379"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A1.37: Project creation in Rider.</p>
<p>With Rider, everything<a id="_idIndexMarker895"/> is on one screen. Find the <strong class="bold">Console Application</strong> template in the list on the left-hand side and click on it. Set the solution name to <strong class="source-inline">BicycleSolution</strong> and <strong class="source-inline">ProjectName</strong> to <strong class="source-inline">BicycleConsoleApp</strong>. Click on the <strong class="bold">Create</strong> button and your project will be generated. The full IDE will appear, and you’ll find your project hierarchy in the explorer panel on the left-hand side of the IDE window.</p>
<h3>Adding a class or interface</h3>
<p>Adding a class is<a id="_idIndexMarker896"/> the same as it is in the other two IDEs we’ve talked about so <a id="_idIndexMarker897"/>far. Right-click on the <strong class="source-inline">BicycleSolution</strong> project. A context menu appears, as shown in <em class="italic">Figure A1.38:</em></p>
<div>
<div class="IMG---Figure" id="_idContainer158">
<img alt="Figure A1.38: The ability to add a class or interface to your project can be found in the context menu when you right-click on the project. " height="667" src="image/B18605_Figure_A1.35.jpg" width="1379"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A1.38: The ability to add a class or interface to your project can be found in the context menu when you right-click on the project.</p>
<p>Hover over the <strong class="bold">Add</strong> menu<a id="_idIndexMarker898"/> item, and then find <strong class="bold">Class/Interface</strong> in the <a id="_idIndexMarker899"/>sub-menu. Click on it. You will see a small dialog asking you to name the class or interface. There are a few more possibilities evident in the list, but this book is only concerned with classes and interfaces. Choose the <strong class="bold">Class</strong> option and name your class whatever you would like. As soon as you press <em class="italic">Enter</em>, you’ll see the class file added to your project.</p>
<p>When you need an interface, follow the same procedure, but instead of <strong class="bold">Class</strong>, select <strong class="bold">Interface</strong>. Don’t forget that in C#, the name convention for interfaces stipulates naming the interface starting with the letter I (as in “Interface”).</p>
<p>Next, we’ll look at adding a library project to our solution so that we can maximize code reuse between projects.</p>
<h3>Creating a library project</h3>
<p>Library<a id="_idIndexMarker900"/> projects are used to house reusable code designed to be accessible between projects. In <em class="italic">Chapters 3–5</em> of this book, I use a library for common classes like those that model the basic parts of the bicycle classes we’re building in those chapters. In the real world, you generally put your business logic in a library. When you do this, you can leverage that logic in a web application, a mobile application, and a desktop application without repeating your code in three places.</p>
<p>Right-click<a id="_idIndexMarker901"/> on the <strong class="source-inline">BicycleSolution</strong> in the explorer menu. Hover over the <strong class="bold">Add</strong> option and select <strong class="bold">New Project...</strong>. You can see this in <em class="italic">Figure A1.39</em>:</p>
<div>
<div class="IMG---Figure" id="_idContainer159">
<img alt="Figure A1.39: Adding a project to the solution in Rider is done by right-clicking on the solution, then hovering over Add, and then clicking on New Project. " height="636" src="image/B18605_Figure_A1.36.jpg" width="1379"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A1.39: Adding a project to the solution in Rider is done by right-clicking on the solution, then hovering over Add, and then clicking on New Project.</p>
<p>You get the same project dialog we started with. Locate the <strong class="bold">Class Library</strong> template and click on it. Then, fill in the name for the project as <strong class="source-inline">BicycleLibrary</strong>. Your project should match mine, as shown in <em class="italic">Figure A1.40</em>:</p>
<div>
<div class="IMG---Figure" id="_idContainer160">
<img alt="Figure A1.40: Set up your new library project as shown. " height="637" src="image/B18605_Figure_A1.37.jpg" width="1379"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A1.40: Set up your new library project as shown.</p>
<p>Click on the <strong class="bold">Create</strong> button, and<a id="_idIndexMarker902"/> you’ll find a new project added to the solution. Your explorer pane should look something like <em class="italic">Figure A1.41</em>:</p>
<div>
<div class="IMG---Figure" id="_idContainer161">
<img alt="Figure A1.41: The explorer pane shows both projects in our solution. " height="667" src="image/B18605_Figure_A1.38.jpg" width="1379"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A1.41: The explorer pane shows both projects in our solution.</p>
<p>Before we can use the library in our console app project, we need to link the two projects with a reference.</p>
<h3>Linking the library project to the console project</h3>
<p>In the <a id="_idIndexMarker903"/>explorer pane, locate the <strong class="source-inline">BicycleConsoleApp</strong> project and right-click on the <strong class="source-inline">Dependencies</strong> item in the project hierarchy. A context menu appears, as shown in<em class="italic"> Figure A1.42</em>:</p>
<div>
<div class="IMG---Figure" id="_idContainer162">
<img alt="Figure A1.42: The context menu is displayed when you  right-click on the Dependencies item in the explorer pane. " height="637" src="image/B18605_Figure_A1.39.jpg" width="1379"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A1.42: The context menu is displayed when you right-click on the Dependencies item in the explorer pane.</p>
<p>Click on <strong class="bold">Add Reference</strong>. A dialog appears like the one in <em class="italic">Figure A1.43</em>:</p>
<div>
<div class="IMG---Figure" id="_idContainer163">
<img alt="Figure A1.43: The Add Reference dialog in Rider. " height="667" src="image/B18605_Figure_A1.40.jpg" width="1379"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A1.43: The Add Reference dialog in Rider.</p>
<p>You should see<a id="_idIndexMarker904"/> the library project listed. Check the box next to the library, and then click on <strong class="bold">Add</strong>. You can now reference the library project from your console app project. Let’s try it out.</p>
<h3>Testing the linked library</h3>
<p>Open<a id="_idIndexMarker905"/> the <strong class="source-inline">Class1.cs</strong> file in the <strong class="source-inline">BicycleLibrary</strong> project. Add this code:</p>
<pre class="source-code">namespace BicycleLibrary;
public class Class1
{
  <strong class="bold">public string SayHello()</strong>
<strong class="bold">    {</strong>
<strong class="bold">        return "Hello from the Bicycle Library!";</strong>
<strong class="bold">    }</strong>
}</pre>
<p>That’s the third time I’ve typed in the same code. Thank goodness the English language doesn’t require authors to be DRY.</p>
<p>Next, open the <strong class="source-inline">Program1.cs</strong> file in the <strong class="source-inline">BicycleConsoleApp</strong> project. Change the code in that file to this:</p>
<pre class="source-code">using System;
using BicycleLibrary;
var test = new Class1();
Console.WriteLine(test.SayHello());</pre>
<p>As you type <a id="_idIndexMarker906"/>the code, you should see the code hints showing you that you have access to the library. Once the code has been entered, we’re ready to run a test.</p>
<h3>Building and running the console project</h3>
<p>As with Visual<a id="_idIndexMarker907"/> Studio, you’re looking for a big green arrow that <a id="_idIndexMarker908"/>indicates the <strong class="bold">Run</strong> button in the toolbar. You can see this button highlighted, alas, not in color, in <em class="italic">Figure A1.44</em>.</p>
<p>When you click on the <strong class="bold">Run</strong> button, your project builds and runs with an attached debugger just as it does in Visual Studio. Unlike Visual Studio, your program runs within Rider’s integrated Terminal just like it did in VS Code. You can see the result of my run in <em class="italic">Figure A1.44</em>:</p>
<div>
<div class="IMG---Figure" id="_idContainer164">
<img alt="Figure A1.44: The completed run of our test program in Rider; the Terminal window has been pointed out. " height="638" src="image/B18605_Figure_A1.41.jpg" width="1379"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A1.44: The completed run of our test program in Rider; the Terminal window has been pointed out.</p>
<p>This concludes<a id="_idIndexMarker909"/> our brief tour of <em class="italic">Rider</em>. If you’re interested in a <a id="_idIndexMarker910"/>video walk-through that coaches you through setting up a <em class="italic">Rider</em> development environment in Windows, you’ll find links at <a href="https://csharppatterns.dev">https://csharppatterns.dev</a>.</p>
<h1 id="_idParaDest-202"><a id="_idTextAnchor202"/>Summary</h1>
<p>This appendix was meant to be a short summary of working with C#. I almost didn’t include it in the book. There are many other places you can get training and orientation for the language. I felt, though, having taught C# for decades that I might be able to more concisely, yet thoroughly, get you up to speed if you’re coming from a different language, have limited experience with C#, or if it’s been a while and you’re a little rusty.</p>
<p>Along the way, we learned the following:</p>
<ul>
<li>C# is a standardized general-purpose, strictly OOP language.</li>
<li>C# uses a strong, static type system.</li>
<li>C# is designed with features designed to limit the most common problems found in C and C++ development such as bounds checking, effortless memory allocation, and automated garbage collection.</li>
<li>C# supports many different kinds of numeric types, including signed and unsigned variants.</li>
<li>How to make auto-implemented properties and methods and work with encapsulation.</li>
<li>How to use the basic building blocks of OOP in C#, including inheritance and working with interfaces.</li>
</ul>
<p>At the end of all that we were treated to a basic tutorial on the three most popular IDE choices for C#: Visual Studio, VS Code, and Rider. I called this appendix concise. I wouldn’t call it short, but consider the size of most C# books that only orient you in Visual Studio, and I think you’ll agree this is a bargain. If you have found yourself wanting more, head over to <a href="https://csharppatterns.dev">https://csharppatterns.dev</a> where I have links to additional resources.</p>
<h1 id="_idParaDest-203"><a id="_idTextAnchor203"/>Further reading</h1>
<ul>
<li><em class="italic">C# Object-Oriented Programming for Beginners in C# and .NET</em> by Praveenkumar Bouna.</li>
<li><em class="italic">Visual Studio Code for C# Developers</em> by Praveenkumar Bouna.</li>
<li><em class="italic">Hands-On Visual Studio 2022</em> by Hector Uriel Perez Rojas and Miguel Angel Teheran Garcia.</li>
<li><a href="https://csharppatterns.dev">https://csharppatterns.dev</a> has links to additional resources.</li>
</ul>
</div>
</div>


<div id="sbo-rt-content"><div id="_idContainer188">
<h1 id="_idParaDest-204"><a id="_idTextAnchor204"/>Appendix 2: <a id="_idTextAnchor205"/>A Primer on the Unified Modeling Language (UML)</h1>
<p>You don’t have to look hard to realize that designing software is a lot like designing anything else. In <a href="B18605_01.xhtml#_idTextAnchor016"><em class="italic">Chapter 1</em></a>, <em class="italic">There’s a Big Ball of Mud on Your Plate of Spaghetti</em>, we talked about the underpinning of software patterns coming from a pioneer in the field of architecture – not software architecture, but the traditions, engineering, and design practices involved in the architecture of buildings and cities. In 1977, Christopher Alexander documented a pattern language designed to form the basis for the best practices for building towns. His book described 253 patterns that were presented as the paragon of architectural design. The book broke everything down into objects.</p>
<p><strong class="bold">Object-Oriented Analysis and Design</strong> (<strong class="bold">OOAD</strong>), a practice that is adjunctive to <strong class="bold">Object-Oriented Programming</strong> (<strong class="bold">OOP</strong>), involves the design of an object structure separate from the exercise of writing code. This is usually the job of a software architect or a senior developer. Software architects are similar to architects of buildings: they design the structure of an application. This can be done before the implementation team, which is the team that is going to build what the architect designs, picks the programming language for a project.</p>
<p>OOAD makes use of a set of documentation conventions codified as the <strong class="bold">Unified Modeling Language</strong> (<strong class="bold">UML</strong>). It sounds like a programming language, but it isn’t. Instead, it is a standard for creating diagrams that explains the structure and relationships between components in a software system. </p>
<p>Think of it this way. If you are a musical composer, you can write your notes in a musical score. You can do this without ever touching an instrument. If you are skillful in composition, you can write entire orchestral works on paper using sheet music notation. You can then hand your sheet music to an orchestra and a conductor, and assuming the orchestra comprises competent musicians, they should be able to play your music. Architects are like composers. Programmers are musicians, and the team lead or lead developer is the conductor.</p>
<p>Throughout this book, UML class diagrams are used to convey the structure of the pattern code to be implemented in our real-world projects. If you’ve never worked with the UML before, you’re going to need a short primer. This appendix is designed to be that primer. It isn’t a substitute for a graduate-level OOAD course, or even for reading a whole book on UML. I’m just going to cover the diagram conventions for the one type of diagram we use throughout the book so that you can understand the diagrams, and how they are converted to code.</p>
<p>Again, UML isn’t a coding language; it’s a specification for diagramming your code. There are 14 types of diagram in the UML 2.5 specification. We only need one; the most common among the different diagrams is the <em class="italic">class diagram</em>. </p>
<h1 id="_idParaDest-205"><a id="_idTextAnchor206"/>Technical requirements</h1>
<p>There are many tools for drawing UML diagrams, and although I have presented many such diagrams, I’ve taken the tool used to make them for granted. In the real world, this exercise often happens on a whiteboard. A whiteboard is fine for ephemeral drawings that get erased later. For this book, my diagrams need to be a bit more permanent, so here’s what I’m using:</p>
<ul>
<li>A computer running the <strong class="bold">Windows</strong> operating system. I’m using <strong class="bold">Windows 10</strong>. Honestly, this doesn’t matter, since diagramming tools are plentiful for all operating systems, and there are many that will work in your browser.</li>
<li>A diagramming tool. I’m using <strong class="bold">Microsoft Visio</strong>. </li>
</ul>
<p>There are quite a few UML tools on the market. Here is a short list of tools I’ve used over the years:</p>
<ul>
<li><strong class="bold">Microsoft Visio</strong></li>
<li><strong class="bold">StarUML</strong></li>
<li><strong class="bold">Altova UModel</strong></li>
<li><strong class="bold">Dia</strong></li>
<li><strong class="bold">Umbrello</strong></li>
<li><strong class="bold">Umlet</strong></li>
<li><strong class="bold">Omnigraffle</strong> (<strong class="bold">Mac</strong> only)</li>
</ul>
<p>There are many more on the web. I tend to prefer apps that run on my computer versus browser-based solutions.</p>
<h1 id="_idParaDest-206"><a id="_idTextAnchor207"/>The structure of a class diagram</h1>
<p>Class diagrams<a id="_idIndexMarker911"/> consist of several types of structures, and a set of connecting lines that express the relationship between the structures. The structures<a id="_idIndexMarker912"/> are as follows:</p>
<ul>
<li>A class (obviously)</li>
<li>An interface</li>
<li>An enumeration</li>
<li>Packages (expanded and collapsed)</li>
</ul>
<p>Connecting lines between the structures show how those structures are related. The relationships we can express include the following:</p>
<ul>
<li>Inheritance</li>
<li>Interface realization</li>
<li>Composition</li>
<li>Association</li>
<li>Dependency</li>
<li>Aggregation</li>
<li>Directed association</li>
</ul>
<p>The last possible element on a UML diagram are the notes. Notes are just what you think they are. Sometimes, an architect needs to add a little more information than what the standard UML allows. Notes let you do that. You shouldn’t use them to write an epistle. Short notes in implementation logic are what you see most commonly.</p>
<p>To understand the patterns in this book, you need to understand class diagrams. Every pattern in this book is expressed with at least one UML diagram. The most important patterns are covered with two diagrams each.</p>
<p>Let’s take a look<a id="_idIndexMarker913"/> at the parts of a UML diagram. They aren’t that hard to decipher once you realize the meaning of all the diagram’s pieces. Let’s start with the structures.</p>
<h2 id="_idParaDest-207"><a id="_idTextAnchor208"/>Classes</h2>
<p>A class diagram<a id="_idIndexMarker914"/> is a visual representation of an object’s class. Let’s say our program requires us to model a circle like the one in <em class="italic">Figure A2.1</em>:</p>
<div>
<div class="IMG---Figure" id="_idContainer166">
<img alt="Figure A2.1: This is not a UML diagram of a circle.  " height="375" src="image/B18605_Figure_A2.01.jpg" width="1650"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A2.1: This is not a UML diagram of a circle. </p>
<p>If we want to model this in UML, the class diagram would look like <em class="italic">Figure A2.2</em>.</p>
<div>
<div class="IMG---Figure" id="_idContainer167">
<img alt="Figure A2.2: This is an example of a UML diagram. The class name, Circle, is at the top, followed by a list of properties, a dividing line, and a list of methods. The + indicates that they’re all public.  " height="372" src="image/B18605_Figure_A2.02.jpg" width="790"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A2.2: This is an example of a UML diagram. The class name, Circle, is at the top, followed by a list of properties, a dividing line, and a list of methods. The + indicates that they’re all public. </p>
<p>That’s not too difficult, right? It is a box split into three sections. </p>
<p>The top section contains the name of the class. The class is simply the codified version of what I put in my UML diagram. Understanding these details is central to the coverage in <a href="B18605_03.xhtml#_idTextAnchor063"><em class="italic">Chapter 3</em></a><em class="italic">, Getting Creative with Creational Patterns,</em> of creation patterns. These are patterns that revolve around object creation.</p>
<p>The middle box in <em class="italic">Figure A2.2</em> contains<a id="_idIndexMarker915"/> a list of the properties that are members of the class. Note they do not have types. Some people put types in the diagram. I was taught not to because that is an implementation detail. The architect simply designs; they don’t constrain the builder any more than necessary. The programmer that implements the diagram picks the types. If it happens that you are the architect and the developer, feel free to specify the types if that is helpful.</p>
<p>Beneath the list of properties, we draw a line to separate the properties section from the next section. Visio made this a dashed line for my drawings. The dashed line has no significance. It can be solid or whatever line style that appeals to you.</p>
<p>The bottom box in <em class="italic">Figure A2.2</em> is a list of methods. It doesn’t include details on how to implement the methods, or what they do – just the names, and any arguments.</p>
<p>You might have noticed there are <strong class="source-inline">+</strong> signs in the diagrams. These refer to your access modifiers. As with types, some architects put them in and some don’t. Others put them in when it is vitally important – when the class just won’t work unless that detail is honored. I succumbed to the temptation to make a cute diagram to show you what the access modifiers look like in <em class="italic">Figure A2.3</em>.</p>
<div>
<div class="IMG---Figure" id="_idContainer168">
<img alt="Figure A2.3: Access modifiers.  " height="204" src="image/B18605_Figure_A2.03.jpg" width="1122"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A2.3: Access modifiers. </p>
<p>The plus sign (<strong class="bold">+</strong>) denotes a public property or method. The minus sign (<strong class="bold">-</strong>) denotes a private property or method, and the hashtag (<strong class="bold">#</strong>) indicates that the property is protected. C# supports a few more access modifiers, such as <strong class="source-inline">internal</strong>, but they are unique to C#, so UML won’t have a symbol for them. If you don’t understand these access modifiers, refer to <a href="B18605_Appendix_1.xhtml#_idTextAnchor178"><em class="italic">Appendix 1</em></a>.</p>
<p>That’s it! UML class diagrams<a id="_idIndexMarker916"/> are very simple in nature. We’re not done yet though. UML diagrams can show different levels of detail. This really depends on your preferences and the audience for your diagrams. When I studied OOAD in graduate school, my instructor wanted me to put as few implementation details in the diagram as I could. This habit has stuck with me. I’ve seen other people diagram everything to the smallest detail. I’ve never been one for micromanaging, so I’m going to stick with leaving as much as possible up to the developer.</p>
<h3>Abstract classes</h3>
<p>Abstract classes are classes<a id="_idIndexMarker917"/> we aren’t allowed to instantiate<a id="_idIndexMarker918"/> directly. You can only instantiate subclasses of an abstract class. Diagramming them requires one tiny change to the diagram. Here’s an example in <em class="italic">Figure A2.4</em>.</p>
<div>
<div class="IMG---Figure" id="_idContainer169">
<img alt="Figure A2.4: When diagramming abstract classes, type the name of the class in italics.  " height="527" src="image/B18605_Figure_A2.04.jpg" width="531"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A2.4: When diagramming abstract classes, type the name of the class in italics. </p>
<p>Here, we can see that the <strong class="source-inline">Shape</strong> class is abstract and the <strong class="source-inline">Circle</strong> class is not. To specify a class as abstract, you need to type the name of the class in the top box in italics. Watch out for this! Sometimes, it can be hard to see, especially if your diagramming tool uses a cute font that makes italics difficult to spot.</p>
<h3>Diagramming required types</h3>
<p>There are times when you absolutely<a id="_idIndexMarker919"/> must define a property type, method argument, or return type because the implementation absolutely requires it. In those cases, you can specify the types in a diagram, as I have in <em class="italic">Figure A2.5</em>.</p>
<div>
<div class="IMG---Figure" id="_idContainer170">
<img alt="Figure A2.5: You can specify particular types using a colon followed by the type.  " height="498" src="image/B18605_Figure_A2.05.jpg" width="1164"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A2.5: You can specify particular types using a colon followed by the type. </p>
<p>The <strong class="source-inline">Image</strong> class has a property<a id="_idIndexMarker920"/> here that absolutely must be of type <strong class="source-inline">Shape</strong>. It’s represented with a colon separating the property name and its type. Likewise, I can specify a return type for a method. The <strong class="source-inline">Image</strong> class has a method called <strong class="source-inline">GetCircle()</strong> that must return <strong class="source-inline">Circle</strong>. It is similarly specified with a colon and the type after the method signature is defined.</p>
<h3>Constructors</h3>
<p>A constructor<a id="_idIndexMarker921"/> is a special method<a id="_idIndexMarker922"/> that is called when an object is instantiated. <a href="B18605_Appendix_1.xhtml#_idTextAnchor178"><em class="italic">Appendix 1</em></a> covers this in detail if you’re not sure what I mean. A constructor must have the same name as the class where it is defined. For a lot of people, just seeing a method with the same name as the class is enough. It can also be drawn more formally, as shown in <em class="italic">Figure A2.6</em>. </p>
<div>
<div class="IMG---Figure" id="_idContainer171">
<img alt="Figure A2.6: Constructors in a UML diagram are difficult to miss.  " height="216" src="image/B18605_Figure_A2.06.jpg" width="1269"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A2.6: Constructors in a UML diagram are difficult to miss. </p>
<p>You can’t miss it. It’s the method with the obnoxious <strong class="source-inline">&lt;&lt;constructor&gt;&gt;</strong> in front of it. Since obnoxious things<a id="_idIndexMarker923"/> are very pedagogical, this<a id="_idIndexMarker924"/> is the convention I’ll be using.</p>
<h3>Don’t diagram every tiny detail</h3>
<p>In the world of web design, designers<a id="_idIndexMarker925"/> use a trick when dealing with their clients that has been around for centuries. When working with initial designs, the objective is to get the layout right and not focus on copy. The difficulty arises when you try to put fake copy in a web page design. Your clients will focus on what the copy says, and they’ll try to word-smith the text on the page. The objective is to get buy-in on the design, but that can’t happen because all the stakeholders are wrapped up in what the placeholder text says.</p>
<p>To get around this, designers use <em class="italic">lorem ipsum</em> text. <em class="italic">Lorem ipsum</em> are words from a famous book on ethics attributed to the Roman statesman and poet Marcus Tullius Cicero. The text looks like this:</p>
<p class="author-quote">“Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.”</p>
<p>This text is placed in a design draft as a placeholder for the actual copy. Since the text is unintelligible, anyone looking at the design with this text in place isn’t tempted to critique the content. They focus on the design.</p>
<p>In UML, when you want to do this, you can use empty, or nearly empty, classes to encourage stakeholders, namely the developers, to focus on the pattern design instead of what you’ve named the properties.</p>
<p>I do this a lot within this book. The projects aren’t real, and the code doesn’t really matter beyond being pedagogical. We’re here to learn the patterns. You can expect to see a lot of diagrams like <em class="italic">Figure A2.7</em>.</p>
<div>
<div class="IMG---Figure" id="_idContainer172">
<img alt="Figure A2.7: When designing with patterns, it is normal to see classes without all the details filled in. The point is to design and critique the structure, not the content.  " height="479" src="image/B18605_Figure_A2.07.jpg" width="1320"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A2.7: When designing with patterns, it is normal to see classes without all the details filled in. The point is to design and critique the structure, not the content. </p>
<p>In the <strong class="source-inline">Person</strong> and <strong class="source-inline">Teacher</strong> classes, I used placeholders. In the <strong class="source-inline">Student</strong> class, I didn’t specify anything. Both notations<a id="_idIndexMarker926"/> are valid. When you have the structure down, you can choose to either fill in the missing properties, methods, and relationships or leave them as implementation details for the developers.</p>
<p>If you choose the former, be careful. When you’re first getting used to working with UML, it is tempting to use it as a tool to specify minutiae. Resist this temptation. If you don’t, your diagrams will become so complicated that they lose their meaning.</p>
<h2 id="_idParaDest-208"><a id="_idTextAnchor209"/>Interfaces</h2>
<p>Interfaces <a id="_idIndexMarker927"/>are extremely important <a id="_idIndexMarker928"/>to OOAD and pattern diagramming. Drawing them is not very different from drawing classes. They look the same except for an obnoxious <strong class="source-inline">&lt;&lt;Interface&gt;&gt;</strong> expressed in the title box on the diagram. You can see one in <em class="italic">Figure A2.7</em>.</p>
<div>
<div class="IMG---Figure" id="_idContainer173">
<img alt="Figure A2.7: An interface in UML.  " height="276" src="image/B18605_Figure_A2.08.jpg" width="1160"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A2.7: An interface in UML. </p>
<p>Some languages only allow you to implement methods in interfaces. Interfaces in C# can specify public properties<a id="_idIndexMarker929"/> in addition to the usual public methods, so it is legitimate to see properties<a id="_idIndexMarker930"/> defined on an interface. To reiterate: all properties in methods in an interface have to be public. You’ll only ever see <strong class="source-inline">+</strong> symbols for the access modifiers.</p>
<h2 id="_idParaDest-209"><a id="_idTextAnchor210"/>Enumerations</h2>
<p>Enumerations refer to a finite<a id="_idIndexMarker931"/> set of values that rarely change. For example, the list<a id="_idIndexMarker932"/> of states in the United States hasn’t changed in 70 years. The days of the week haven’t changed in thousands of years. These are good candidates for enumerations. Let’s look at a quick example:</p>
<pre class="source-code">public enum DaysOfWeek { Mon, Tue, Wed, Thur, Fri, Sat, Sun };</pre>
<p>They can be used as types, with the effect of preventing spurious data from being passed into a property or variable: </p>
<pre class="source-code">var dayOff = DaysOfWeek.Wednesday;</pre>
<p>This is better than just making it a string:</p>
<pre class="source-code">var dayOff = "Wednesday";</pre>
<p>I set the variable to “<strong class="source-inline">Wednesday"</strong>, but as my <strong class="source-inline">enum</strong> reveals, my program is expecting a very specific value. The <strong class="source-inline">"Wednesday"</strong> string isn’t right. I could easily set any value as long as it is a string. If my class needs a day of the week, and I use an enumeration as the type, it would be impossible to pass in <em class="italic">Bruceday</em> as a day of the week. <em class="italic">Bruceday</em> only occurs in my house where every day is a beautiful, beautiful <em class="italic">Bruceday</em>. I’ve been trying to standardize it as an internationally recognized day off for years. I figured it was a lock when country superstar Alan Jackson recorded, “It’s Bruceday Somewhere.” At the last minute, he changed the title to “It’s Five O’Clock Somewhere.” I think it was a mistake. Apparently, you have to be a Nordic or Greek god, a main sequence star, or a planetary body before you are taken seriously.</p>
<p>An enumeration, like interfaces, features an obnoxious notation added to the title box, as seen in <em class="italic">Figure A2.8</em>.</p>
<div>
<div class="IMG---Figure" id="_idContainer174">
<img alt="Figure A2.8: An enumeration in UML.  " height="445" src="image/B18605_Figure_A2.09.jpg" width="931"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A2.8: An enumeration in UML. </p>
<p>When you draw<a id="_idIndexMarker933"/> an enumeration, the properties represent the values that go<a id="_idIndexMarker934"/> into the enumeration. Enumerations don’t have methods, so there won’t be anything in the lower part of the diagram. There aren’t any access modifiers either. Just the contents are shown.</p>
<h2 id="_idParaDest-210"><a id="_idTextAnchor211"/>Packages</h2>
<p>Packages are collections<a id="_idIndexMarker935"/> of the preceding<a id="_idIndexMarker936"/> structures. In C#, you would call it a namespace. There are two ways to draw packages: expanded and collapsed. Expanded packages are drawn with a rectangle around the classes and structures that belong to that namespace. They are used to show the contents of the package.</p>
<p>Collapsed packages don’t show the contents. They are just a representation of the namespace. You can see an example of both expanded and collapsed packages in <em class="italic">Figure A2.9</em>.</p>
<div>
<div class="IMG---Figure" id="_idContainer175">
<img alt="Figure A2.9: Expanded and collapsed packages in UML.  " height="392" src="image/B18605_Figure_A2.10.jpg" width="1092"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A2.9: Expanded and collapsed packages in UML. </p>
<p>I only used the expanded package<a id="_idIndexMarker937"/> once in the book to express a dependency<a id="_idIndexMarker938"/> on a third-party library.</p>
<h1 id="_idParaDest-211"><a id="_idTextAnchor212"/>Connectors</h1>
<p>In business, one<a id="_idIndexMarker939"/> of the most important factors to success is the relationships between the people you work with. The same can be said of a system of classes, interfaces, enumerations, and packages. In addition to the structures in a class diagram, the diagrams perhaps more importantly express the relationships between the structures, using a standardized set of lines and symbols. These lines connect structures together. Let’s look at the relationships expressed in UML class diagrams.</p>
<h2 id="_idParaDest-212"><a id="_idTextAnchor213"/>Inheritance</h2>
<p>Inheritance<a id="_idIndexMarker940"/> between two classes<a id="_idIndexMarker941"/> is presented with a solid line with an open triangular arrow on one end. For example, if I have a class called <strong class="source-inline">Person</strong>, and another class called <strong class="source-inline">Student</strong> that inherits from <strong class="source-inline">Person</strong>, the diagram would look like <em class="italic">Figure A2.10</em>.</p>
<div>
<div class="IMG---Figure" id="_idContainer176">
<img alt="Figure A2.10: Inheritance is represented with a solid line with an empty triangular arrow pointing to the based class.  " height="490" src="image/B18605_Figure_A2.11.jpg" width="593"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A2.10: Inheritance is represented with a solid line with an empty triangular arrow pointing to the based class. </p>
<p>The arrow should point from the inheriting class to the base class. You are expressing that a student <strong class="bold">IS A</strong> person. As a best practice, the base classes<a id="_idIndexMarker942"/> are always drawn above<a id="_idIndexMarker943"/> the subclasses, so the arrows should always be pointing up.</p>
<h2 id="_idParaDest-213"><a id="_idTextAnchor214"/>Interface realization</h2>
<p>We discussed interfaces in <a href="B18605_Appendix_1.xhtml#_idTextAnchor178"><em class="italic">Appendix 1</em></a> if you’re not<a id="_idIndexMarker944"/> sure what these are about. Interfaces<a id="_idIndexMarker945"/> are the most flexible way to pass around dependencies without tightly coupling two objects together. This makes them very important to our study of patterns.</p>
<p>When a class implements an interface, you draw a dashed line from the class implementing the interface to the interface itself. The end of the line has a hollow arrow pointing to the interface, as shown in <em class="italic">Figure A2.11</em>.</p>
<div>
<div class="IMG---Figure" id="_idContainer177">
<img alt="Figure A2.11: An interface realization line is dashed, with a hollow arrow pointing from the implementing class to the interface.  " height="566" src="image/B18605_Figure_A2.12.jpg" width="667"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A2.11: An interface realization line is dashed, with a hollow arrow pointing from the implementing class to the interface. </p>
<h2 id="_idParaDest-214"><a id="_idTextAnchor215"/>Composition</h2>
<p>Composition refers<a id="_idIndexMarker946"/> to creating an object<a id="_idIndexMarker947"/> out of other objects. You are expressing a relationship by saying <strong class="bold">HAS A</strong>. To make a car object, you might need an engine object and a hood ornament object. You would say a car <em class="italic">has a</em> hood ornament, and you would be expressing composition. See <em class="italic">Figure A.12</em> for an example of composition.</p>
<div>
<div class="IMG---Figure" id="_idContainer178">
<img alt="Figure A2.12: Composition in UML is shown using a solid line, with a diamond on the end of the containing class.  " height="496" src="image/B18605_Figure_A2.13.jpg" width="1180"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A2.12: Composition in UML is shown using a solid line, with a diamond on the end of the containing class. </p>
<p>In UML, composition is expressed<a id="_idIndexMarker948"/> as a solid line drawn between classes, with a filled diamond<a id="_idIndexMarker949"/> on one end. The diamond should be pointing to the class that has whatever you’re putting into it. In our <strong class="bold">Car</strong> example, a car has an engine, so the line would go from the engine to the car and the diamond would be pointing to the <strong class="source-inline">Car</strong> class.</p>
<h2 id="_idParaDest-215"><a id="_idTextAnchor216"/>Association</h2>
<p>Association between two classes <a id="_idIndexMarker950"/>indicates that they interact<a id="_idIndexMarker951"/> with each other. A <strong class="source-inline">driver</strong> object interacts with a <strong class="source-inline">car</strong> object. The driver puts gas in the car. The car transports the driver to another place. To draw an association in UML, you use a solid line with no arrow, as seen in <em class="italic">Figure A2.13</em>.</p>
<div>
<div class="IMG---Figure" id="_idContainer179">
<img alt="Figure A2.13: Associations show objects that interact with each other.  " height="168" src="image/B18605_Figure_A2.14.jpg" width="1256"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A2.13: Associations show objects that interact with each other. </p>
<h2 id="_idParaDest-216"><a id="_idTextAnchor217"/>Aggregation</h2>
<p>Aggregations<a id="_idIndexMarker952"/> are a type of association involving multiplicity. A <strong class="source-inline">warehouse</strong> object<a id="_idIndexMarker953"/> will have a relationship with inventory items expressed as “An order has many inventory items.” Don’t confuse it with composition. Not only does it seem like the same thing, but the symbols are also nearly identical. Aggregation is an empty diamond on a solid line, as seen in <em class="italic">Figure A2.14</em>.</p>
<div>
<div class="IMG---Figure" id="_idContainer180">
<img alt="Figure A2.14: Aggregation is an empty diamond on a solid line.  " height="166" src="image/B18605_Figure_A2.15.jpg" width="1176"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A2.14: Aggregation is an empty diamond on a solid line. </p>
<p>Aggregation and composition are different. Composition refers to the construction of an object from other objects. Aggregation refers to a relationship where there is a one-to-one, one-to-many, or many-to-many relationship between objects, but the objects can stand alone. If we had a <strong class="source-inline">CollegeCourse</strong> object, we could express aggregation with <strong class="source-inline">student</strong> objects. There are many students in one class. If the college cancels the class, the students don’t instantly vanish. You can have a student without a class.</p>
<h2 id="_idParaDest-217"><a id="_idTextAnchor218"/>Directed association</h2>
<p>A directed association<a id="_idIndexMarker954"/> shows a container<a id="_idIndexMarker955"/> relationship. A <strong class="source-inline">spaceship</strong> object is related to <strong class="source-inline">passenger</strong> objects in this way. Passengers are contained within the spaceship. Note that the spaceship is not composed of passengers, so it’s not the same thing as composition. A directed association can be diagramed as seen in <em class="italic">Figure A2.15</em>.</p>
<div>
<div class="IMG---Figure" id="_idContainer181">
<img alt="Figure A2.15: Directed association between two classes.  " height="169" src="image/B18605_Figure_A2.16.jpg" width="1102"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A2.15: Directed association between two classes. </p>
<p>The line is solid and the arrowhead is two lines rather than a triangle.</p>
<h2 id="_idParaDest-218"><a id="_idTextAnchor219"/>Dependency</h2>
<p>When one class depends<a id="_idIndexMarker956"/> on another, you will find yourself changing<a id="_idIndexMarker957"/> both classes when modifications are needed. If you change one, you have to change the other. Imagine an electrical plug and an electrical socket. They are truly designed to be physically dependent on one another. If you had to change the design for the plug, you’d probably have to change the socket design too, and vice versa. A dependency relationship between two classes is something we usually strive to avoid, even though they are unavoidable. That might sound very Zen, but I’m referring to a relationship between two classes. A dependency is expressed using a dashed line with a non-triangular arrowhead on the end, as seen in <em class="italic">Figure A.16</em>.</p>
<div>
<div class="IMG---Figure" id="_idContainer182">
<img alt="Figure A2.16: Dependencies between classes are drawn with a dashed line and an angular arrowhead pointing from the dependent to the dependence.  " height="169" src="image/B18605_Figure_A2.17.jpg" width="1102"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A2.16: Dependencies between classes are drawn with a dashed line and an angular arrowhead pointing from the dependent to the dependence. </p>
<p>These relationships can be vocalized as A <strong class="bold">depends on</strong> B changing as little as possible. I added the last part to remind me of the SOLID principle discussed in <a href="B18605_02.xhtml#_idTextAnchor036"><em class="italic">Chapter 2</em></a><em class="italic">,</em> <em class="italic">Prepping for Practical Real-World Applications of Patterns in C# </em>. The O in SOLID refers to the open-closed principle. Classes<a id="_idIndexMarker958"/> should be open for extension but closed for modification. Dependencies are unavoidable, but when you see them in the diagram, scrutinize them and implement them with care.</p>
<h1 id="_idParaDest-219"><a id="_idTextAnchor220"/>Notes</h1>
<p>Notes<a id="_idIndexMarker959"/> are just what you think they are. Sometimes, an architect needs to add a little more information than what standard UML allows. Notes let you do that. You can see an example in <em class="italic">Figure A2.17</em>.</p>
<div>
<div class="IMG---Figure" id="_idContainer183">
<img alt="Figure A2.17: This is what a note looks like in UML.  " height="376" src="image/B18605_Figure_A2.18.jpg" width="1279"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A2.17: This is what a note looks like in UML. </p>
<p>You shouldn’t use them<a id="_idIndexMarker960"/> to write an epistle. Short notes in implementation logic are what you see most commonly.</p>
<h1 id="_idParaDest-220"><a id="_idTextAnchor221"/>Best practices</h1>
<p>UML class diagrams<a id="_idIndexMarker961"/> are easy to create and understand, or at least they should be. Unfortunately, many diagrams fall victim to the same forces I covered in <a href="B18605_01.xhtml#_idTextAnchor016"><em class="italic">Chapter 1</em></a>. They can be a Golden Hammer, and they can grow uncontrollably to become too complicated to be useful. Software succumbs to these forces slowly over time. Sometimes, it takes years to make a repository full of spaghetti. Diagrams tend to fall apart over the space of days. UML is a plan. If your plan is a messy disaster, how can your software be anything else?</p>
<p>To curb the tide of these destructive forces, I’m going to give you four hints to keep your diagrams useful, easy to read, and hopefully, keep you out of analysis paralysis.</p>
<h2 id="_idParaDest-221"><a id="_idTextAnchor222"/>Less is more – don’t try to put everything in one big diagram</h2>
<p>UML diagrams are meant to be used by the development team, but they are often shared with other project stakeholders. If you go to a meeting with a diagram that looks like the guidance system schematic for the Patriot missile system, you shouldn’t expect to be well received. The developers won’t appreciate you and management will not think highly of you. The UML for the project in <a href="B18605_06.xhtml#_idTextAnchor110"><em class="italic">Chapter 6</em></a><em class="italic">, Step Away from the IDE! Designing with Patterns Before You Code,</em> and <a href="B18605_07.xhtml#_idTextAnchor136"><em class="italic">Chapter 7</em></a>, <em class="italic">Nothing Left but the Typing: Implementing the Wheelchair Project</em>, could easily become way too big if you try to diagram the entire project in one diagram. Check out <em class="italic">Figure A2.18</em>. Even if I printed it on a plotter 3 feet wide by 2 feet tall, the diagram would still be hard to read.</p>
<div>
<div class="IMG---Figure" id="_idContainer184">
<img alt="Figure A2.18: Don’t do this! This diagram covers the entire project presented in Chapter 7. It is too big, too complicated, and it won’t fit on one page.  " height="1149" src="image/B18605_Figure_A2.19.jpg" width="1379"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A2.18: Don’t do this! This diagram covers the entire project presented in <a href="B18605_07.xhtml#_idTextAnchor136"><em class="italic">Chapter 7</em></a>. It is too big, too complicated, and it won’t fit on one page. </p>
<p>It’s better to break the system<a id="_idIndexMarker962"/> down into small parts and diagram those. You’ll see this done in <a href="B18605_07.xhtml#_idTextAnchor136"><em class="italic">Chapter 7</em></a><em class="italic"> </em>. Make diagrams of small systems and keep them simple. As a rule, I try to keep to one or two pages at most. If the diagram won’t fit on two standard sheets of paper, it is probably too big, and you will need to find a way to break it down into smaller pieces. </p>
<h2 id="_idParaDest-222"><a id="_idTextAnchor223"/>Don’t cross the lines</h2>
<p>In the classic movie <em class="italic">Ghostbusters</em>, the heroes of the story invent a dangerous, high-tech proton accelerator<a id="_idIndexMarker963"/> that fires a stream of energy capable of trapping and holding ghosts. In the movie, the chief scientist who invented the technology warns his comrades to never cross the streams, meaning they should never let the bolts of energy from two proton packs cross one another. Try to imagine all life as you know it instantly coming to an end as all the atomic particles in your body explode at the speed of light. They called it a <em class="italic">total protonic reversal</em>. That’s bad.</p>
<p>Now, apply the same caution to crossing lines in your UML diagrams. Crossed lines are ambiguous. The best you can do is to make it look like a circuit diagram and have one line hop over another. You can see an example in <em class="italic">Figure A2.19</em>.</p>
<div>
<div class="IMG---Figure" id="_idContainer185">
<img alt="Figure A2.19: The connector between Class D and Class E crosses the line between Class C and Class A.  " height="894" src="image/B18605_Figure_A2.20.jpg" width="858"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A2.19: The connector between Class D and Class E crosses the line between Class C and Class A. </p>
<p>You’re not sure where they originate and where they terminate. If there is no way to draw a class diagram without crossing lines, it is probably too big.</p>
<p>This doesn’t apply <a id="_idIndexMarker964"/>if the lines are going to the same place. Class B and Class C are both inheriting from Class A. Technically, their lines join rather than cross. When this happens, I make an effort to join the lines together so that they look like one line.</p>
<h2 id="_idParaDest-223"><a id="_idTextAnchor224"/>The most direct path for lines leads to a mess</h2>
<p>This best practice is baked into the better UML diagramming tools you’ll find online. Even Visio does it by default. Drawing straight lines between classes leads to a messy diagram. You can see what I mean in <em class="italic">Figure A2.20</em>.</p>
<div>
<div class="IMG---Figure" id="_idContainer186">
<img alt="Figure A2.20: Circuitous lines with right angles instantly make a diagram look better.  " height="913" src="image/B18605_Figure_A2.21.jpg" width="1221"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A2.20: Circuitous lines with right angles instantly make a diagram look better. </p>
<p>It is better to draw a more circuitous line that is easy to follow and, as we already noted, doesn’t cross other lines.</p>
<h2 id="_idParaDest-224"><a id="_idTextAnchor225"/>Parents go above children</h2>
<p>When you are diagramming<a id="_idIndexMarker965"/> any sort of inheritance or interface implementation, you should always draw the parent element above, or at least higher than, the child element, as depicted in <em class="italic">Figure A2.21</em>.</p>
<div>
<div class="IMG---Figure" id="_idContainer187">
<img alt="Figure A2.21: Parent elements should always be above child elements, which means your arrows should always point up.  " height="389" src="image/B18605_Figure_A2.22.jpg" width="1650"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure A2.21: Parent elements should always be above child elements, which means your arrows should always point up. </p>
<p>This makes your diagram easier to follow as long as you are consistent.</p>
<h2 id="_idParaDest-225"><a id="_idTextAnchor226"/>Keep your diagrams neat</h2>
<p>Spend time keeping your diagrams tidy. I’d give you the same advice for your code. Clean up things you aren’t using anymore. Correct your spelling. Details matter! I would add that you should pick fonts that are easy to read. Fonts in your diagram should show italics very well so that you can always<a id="_idIndexMarker966"/> see abstract classes.</p>
<h1 id="_idParaDest-226"><a id="_idTextAnchor227"/>Summary</h1>
<p>This appendix covered the UML. While it sounds like a programming language, it is really a standard way of drawing diagrams to represent structures and patterns of code. We only need 1 of the 14 recognized UML documents to get through this book, but the one we do use is used quite extensively.</p>
<p>The class diagram shows the structures of a system along with the relationships between those structures. The structures may be classes, interfaces, enumerations, and packages. Common relationships include inheritance, interface realization, composition, association, and more. Notes can be added to a diagram to add more details but should be kept concise.</p>
<p>We learned the best practices for UML class diagrams, including keeping a diagram as legible as possible. Avoid clutter in the diagram that comes from trying to define every single possible relationship between structures. Focus instead on those that are vital to the implementation of the diagram. A good diagram isn’t necessarily one that definitely conforms to the standards of UML. A good diagram is one that communicates quickly, with just enough detail to allow a developer to successfully implement the intent of the diagram, without micromanaging every detail.</p>
<h1 id="_idParaDest-227"><a id="_idTextAnchor228"/>Further reading</h1>
<p>Baumann, Henriette, Patrick Grassle, and Philippe Baumann. <em class="italic">UML 2.0 in action: A project-based tutorial</em>. Packt Publishing, 2005.</p>
</div>
</div>
</body></html>