- en: Optimizing Our Game for Deployment
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 优化我们的游戏以进行部署
- en: In the last chapter, we planned and implemented audio and visual effects into
    our game to enhance overall gameplay. Specifically, we added audio to key events
    in our combat system and added lighting and particle special effects. We started
    with an overview of Unity's audio system, then planned and implemented our game's
    audio. We then shifted to an introduction to lights and shadows in Unity and covered
    select special effects in Unity. We concluded by adding a point light to our cherry
    trees and a special effect to our spawn pads.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一章中，我们计划和实现了音频和视觉效果到我们的游戏中，以增强整体游戏体验。具体来说，我们在战斗系统的关键事件中添加了音频，并添加了照明和粒子特效。我们从Unity音频系统的概述开始，然后计划和实现了我们的游戏音频。然后转向Unity中灯光和阴影的介绍，并涵盖了Unity中的选择特效。最后，我们在樱桃树上添加了一个点光源，并在出生点添加了一个特效。
- en: 'This chapter has two areas of focus: optimization and deployment. In the optimization
    sections, you will learn how to diagnose your Unity game for performance problems
    and how to optimize scripts and graphics rendering. In the deployment section,
    you will learn about the Unity build process, how to create a standalone player,
    and how to deploy your game to multiple platforms.'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 本章有两个重点领域：优化和部署。在优化部分，你将学习如何诊断你的Unity游戏性能问题，以及如何优化脚本和图形渲染。在部署部分，你将了解Unity的构建过程，如何创建独立玩家，以及如何将你的游戏部署到多个平台。
- en: 'Specifically, in this chapter, we will cover the following topics:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 具体来说，在本章中，我们将涵盖以下主题：
- en: Using the Profiler window
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用Profiler窗口
- en: Optimizing scripts
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 优化脚本
- en: Optimizing graphics rendering
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 优化图形渲染
- en: Additional optimizations
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 额外的优化
- en: Creating builds
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建构建
- en: Using the Profiler window
  id: totrans-9
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用Profiler窗口
- en: 'Unity has a native tool that helps us to examine how our game performs. This
    is a Profiler tool and is accessible via the Window | Profiler top menu option.
    As you can see in the following illustration, there are 13 components available
    in the Profiler window:'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: Unity有一个本机工具帮助我们检查游戏性能。这是一个Profiler工具，可以通过Window | Profiler顶级菜单选项访问。正如你在以下插图中所见，Profiler窗口中有13个组件可用：
- en: '![](img/e01a6986-68e0-4657-9a31-83799dcfe526.png)'
  id: totrans-11
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e01a6986-68e0-4657-9a31-83799dcfe526.png)'
- en: Profiler Components
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: Profiler组件
- en: 'The individual Profiler names provide a clear indication of what performance
    measure is being analyzed. In order to fully explore the Profiler window, let''s
    get it up and running with the following steps:'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 单个Profiler名称清楚地表明正在分析的性能度量。为了完全探索Profiler窗口，让我们按照以下步骤启动它：
- en: Open your Unity game project. Alternatively, you can download the Starting-Chapter-13 Unity project
    available from the publisher's companion site.
  id: totrans-14
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开你的Unity游戏项目。或者，你也可以从出版商的配套网站上下载可用的Starting-Chapter-13 Unity项目。
- en: Using the top menu, select Window | Profiler. Depending on your system, this
    can open the Profiler in a new window or as a tab.
  id: totrans-15
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用顶级菜单，选择Window | Profiler。根据你的系统，这可以打开Profiler在新窗口或作为标签页。
- en: In the Profiler window or tab, use the Add Profiler button to add any Profilers
    not loaded by default. The Profilers that are already loaded will appear in gray
    and the unloaded Profilers will appear in black.
  id: totrans-16
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在Profiler窗口或标签页中，使用添加Profiler按钮添加任何默认未加载的Profiler。已加载的Profiler将以灰色显示，未加载的Profiler将以黑色显示。
- en: Put your game in game mode.
  id: totrans-17
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将你的游戏置于游戏模式。
- en: 'Scroll through the Profilers and, using the *x* in the top-right corner of
    the Profiler box, close the Profilers that provide little or no data on your game.
    For example, the Network Operations and Network Messages Profilers are not applicable
    to the Cucumber Man game. You might leave the following Profilers in your Profiler
    window:'
  id: totrans-18
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 滚动Profiler，并使用Profiler框右上角的*x*关闭提供少量或无数据的Profiler。例如，网络操作和网络消息Profiler不适用于Cucumber
    Man游戏。你可以在Profiler窗口中保留以下Profiler：
- en: CPU Usage
  id: totrans-19
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: CPU使用情况
- en: GPU Usage
  id: totrans-20
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: GPU使用情况
- en: Rendering
  id: totrans-21
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 渲染
- en: Memory
  id: totrans-22
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 内存
- en: Audio
  id: totrans-23
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 音频
- en: Physics
  id: totrans-24
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 物理引擎
- en: UI
  id: totrans-25
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 用户界面
- en: Global Illumination
  id: totrans-26
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 全局照明
- en: Let your game run for at least a minute or more, then exit the game. It does
    not matter whether you play the game while it is running or just sit back and
    watch the cucumber beetles search for and eat cucumbers. You will have the Profiler
    data available to you even after the game stops.
  id: totrans-27
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让你的游戏运行至少一分钟或更长时间，然后退出游戏。无论你在游戏运行时玩游戏还是只是坐下来观看瓜蚜虫寻找和吃黄瓜，你都可以在游戏停止后获得Profiler数据。
- en: We can examine each Profiler to help determine how our game is performing and
    identify any performance problems. Let's look at the GPU Usage Profiler by clicking
    on it in the Profiler window. When we select a Profiler, detailed information
    is provided in the bottom section of the Profiler window.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
- en: 'By reviewing the detailed information provided, such as the GPU Usage information
    shown here, we can determine component-level performance. In the following example,
    we can see that our `Camera.Renderer` takes the greatest draw on the GPU. We can
    also drill down to greater fidelity by clicking the gray triangles to the left
    of each component:'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/f7968f26-4cbf-4403-b0b9-ab3157beb81f.png)'
  id: totrans-30
  prefs: []
  type: TYPE_IMG
- en: Getting more out of the Profilers
  id: totrans-31
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The Profiler window has several controls, segmented into left, center, and
    right sections of the interface. As you can see from the following screenshot,
    the Add Profiler drop-down button consumes the left-most section of the Profiler
    window''s tool bar. We can use that button to add additional Profilers to the
    window:'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/f2a02fb2-5b96-403a-8f77-88ee4cbdb1fd.png)'
  id: totrans-33
  prefs: []
  type: TYPE_IMG
- en: Profiler Toolbar
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
- en: 'The center section of the interface contains four functions, detailed here:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
- en: 'Record: This button is enabled by default and is used to record or not record
    the active game''s Profile information. When troubleshooting a specific section
    of your game, this button makes it easy to start and stop recording.'
  id: totrans-36
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Deep Profile: This function, when enabled, will Profile all script usage including
    function calls.'
  id: totrans-37
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Profile Editor: This function allows you to toggle the profiling of the Profiler.'
  id: totrans-38
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Editor: You can use this function to designate an IP address for the Profiler
    and log data to be sent. The default is for it to be sent to the editor.'
  id: totrans-39
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The right-most section of the Profiler window's tool bar includes controls to
    Clear, Load, and Save the Profiler information. If you selected a frame, the frame
    information will be displayed. You also have the ability to step through the frames
    using navigational buttons in this section.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
- en: Don't be surprised if your game performance is noticeably impacted when using
    the profiling tools.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
- en: Optimizing scripts
  id: totrans-42
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Unity games run several frames per second and many of our scripts are executed
    each frame. Even uncomplicated games, such as the Cucumber Man, can have several
    scripts running every frame, causing the computer's CPU to stay very busy. The
    goal is to ensure our scripts are not causing any unnecessary CPU load.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
- en: 'Our game has 145 scripts, but most of them are part of the standard asset package
    and are not assigned to any game objects. The scripts we want to review are the
    ones we put in the `Assets` | `Custom Scripts` folder. Reviewing that folder reveals
    that there are only 14 scripts:'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
- en: BeetleManager
  id: totrans-45
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: BeetleNPC
  id: totrans-46
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: BeetlePatrol
  id: totrans-47
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: CameraFollower
  id: totrans-48
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: CherryControl
  id: totrans-49
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: CherryManager
  id: totrans-50
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: CucumberManager
  id: totrans-51
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: CucumberManManager
  id: totrans-52
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: HealthManager
  id: totrans-53
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: PlayerController
  id: totrans-54
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: PlayerMotor
  id: totrans-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: PointsManager
  id: totrans-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: ThrowCherry
  id: totrans-57
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: VictoryManager
  id: totrans-58
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Our goal is to reduce the number of instructions the CPU has to execute, especially
    when we are dealing with several executions per frame and multiple frames per
    second. Here are some things to check when reviewing your Unity scripts:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的目标是减少CPU需要执行的指令数量，尤其是在我们每帧处理多个执行并且每秒多个帧的情况下。在审查你的Unity脚本时，以下是一些需要检查的事项：
- en: Ensure all function calls are necessary.
  id: totrans-60
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 确保所有函数调用都是必要的。
- en: As appropriate, move function calls out of the `Update()` method.
  id: totrans-61
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 根据需要，将函数调用移出`Update()`方法。
- en: As appropriate, move statements out of loops to limit the number of times they
    are executed.
  id: totrans-62
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 根据需要，将语句移出循环以限制它们执行的次数。
- en: Use NPCs only as needed. Our game is relatively simple and we do not have hoards
    of cucumber beetles. You might try an experiment where there are 10,000 cucumber
    beetles in your game. Since each one of them has AI-associated code, the CPU will
    be very busy.
  id: totrans-63
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 只在需要时使用NPC。我们的游戏相对简单，我们没有成群的黄瓜甲虫。你可能尝试一个实验，在你的游戏中放置10,000个黄瓜甲虫。由于每个甲虫都有与AI相关的代码，CPU将会非常忙碌。
- en: Optimized code example
  id: totrans-64
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 优化代码示例
- en: 'The following script is not optimized. Review the script to see what can be
    done to optimize it. Then, review the information provided after the script:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 以下脚本未经过优化。请审查脚本，看看可以采取哪些措施来优化它。然后，审查脚本之后提供的信息：
- en: '[PRE0]'
  id: totrans-66
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Hopefully you were able to spot the inefficient, unoptimized component of the
    script. In the preceding example, all the statements other than the variable declarations
    occur in the `Update()` method. Consider the optimized version of the following
    script:'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 希望你能够发现脚本中低效、未优化的部分。在上面的例子中，除了变量声明之外的所有语句都发生在`Update()`方法中。考虑以下脚本的优化版本：
- en: '[PRE1]'
  id: totrans-68
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: In the optimized version of this script, the `GetComponent()` method call and
    the `currentCucumberCount` variable initialization are moved over to the `Awake()`
    method. Those statements only need to run once. Putting them inside the `Update()`
    method would have caused undue strain on the CPU.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 在此脚本的优化版本中，`GetComponent()`方法调用和`currentCucumberCount`变量初始化被移动到`Awake()`方法。这些语句只需要运行一次。将它们放在`Update()`方法中会给CPU带来不必要的压力。
- en: It is important for a game's overall performance to have optimized scripts.
    Checking for script optimization at the end of a project is a good idea. Ideally,
    you will ensure your scripts are optimized as your write, as opposed to reviewing
    them later.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 对于游戏的整体性能来说，拥有经过优化的脚本非常重要。在项目结束时检查脚本优化是一个好主意。理想情况下，你将在编写脚本时确保它们已经优化，而不是在之后进行审查。
- en: Optimizing graphics rendering
  id: totrans-71
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 优化图形渲染
- en: Three graphics rendering concepts that should be explored when aiming to enhance
    game performance are occlusion culling, lighting, and mesh renderers. Each of
    these concepts are covered in the following sections.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 当试图提高游戏性能时，应该探索以下三个图形渲染概念：遮挡消除、照明和网格渲染器。这些概念将在以下各节中介绍。
- en: Occlusion culling
  id: totrans-73
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 漏洞消除
- en: Cameras are a critical game object in our Unity games. They allow the player
    to see the game environment. Unity works diligently during gameplay to render
    objects within a camera's frustum. Graphics rendering can represent a tremendous
    performance issue. It is therefore important that we pay special attention to
    our camera's occlusion culling parameter. When enabled, Unity will not render
    objects that are occluded, or not seen by the camera. An example would be objects
    inside a building. If the camera can currently only see the external walls of
    the building, then none of the objects inside those walls can be seen. So, it
    makes sense to not render those. We only want to render what is absolutely necessary
    to help ensure our game has smooth gameplay and no lag.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的Unity游戏中，摄像机是一个关键的游戏对象。它们允许玩家看到游戏环境。Unity在游戏过程中勤奋地渲染摄像机视锥体内的对象。图形渲染可能代表一个巨大的性能问题。因此，我们特别关注摄像机的遮挡消除参数非常重要。当启用时，Unity将不会渲染被遮挡的对象，或者摄像机看不到的对象。一个例子是建筑物内的对象。如果摄像机目前只能看到建筑物的外部墙壁，那么那些墙壁内的所有对象都看不到。因此，不渲染这些对象是有意义的。我们只想渲染绝对必要的对象，以确保我们的游戏具有流畅的游戏体验和没有延迟。
- en: Lighting
  id: totrans-75
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 照明
- en: When we create our scenes in Unity, we have three options for lighting. We can
    use real-time dynamic light, the baked lighting approach, or a mixture of real-time
    and baked. Our games perform more efficiently with baked lighting compared to
    real-time dynamic lighting, so if performance is a concern, try using baked lighting
    where you can.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们在Unity中创建场景时，我们有三种光照选项。我们可以使用实时动态光、烘焙光照方法或实时与烘焙的混合。与实时动态光照相比，烘焙光照可以使游戏性能更优，所以如果性能是关注点，尝试在可能的情况下使用烘焙光照。
- en: Area lights are distinct from the other types of light in that they can only
    be baked. This means that real-time rendering will not take place during gameplay.
    The reason for this is to conduct all the processing regarding area lights prior
    to gameplay. This processing, if accomplished in a game in real time, would likely
    result in sufficient lag.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 区域光源与其他类型的光源不同，它们只能烘焙。这意味着在游戏过程中不会进行实时渲染。这样做的原因是在游戏开始之前完成所有关于区域光源的处理。如果在游戏中实时完成这些处理，很可能会产生足够的延迟。
- en: Mesh renderer
  id: totrans-78
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 网格渲染器
- en: The mesh renderer component of a game object can be viewed in the Inspector
    panel. There are multiple settings that can be adjusted to enhance performance.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 游戏对象的网格渲染器组件可以在检查器面板中查看。有多个可调整的设置，可以用来提高性能。
- en: The Cast Shadows setting can be set to On, Off, Two-Sided, or Shadows Only.
    The default is On, so you should disable this for all objects that do not need
    to cast shadows.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 投影阴影设置可以设置为开启、关闭、双面或仅阴影。默认设置为开启，所以你应该为所有不需要投射阴影的对象禁用此设置。
- en: The receive shadows is a toggle that tells Unity whether you want that object
    to receive shadows or not. As you would expect, this takes extra processing to
    display during the game. So, if you do not need an object to receive shadows,
    deselect this for greater performance.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 接收阴影是一个切换选项，用于告诉Unity是否希望该对象接收阴影。正如你所预期的那样，这需要额外的处理来在游戏过程中显示。因此，如果你不需要对象接收阴影，取消选择此选项以获得更好的性能。
- en: Additional optimizations
  id: totrans-82
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 额外的优化
- en: Two additional areas where you can optimize your game is with level of detail
    and using static colliders. Both of these concepts are discussed in the sections
    that follow.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以在两个额外的区域优化你的游戏：级别细节和使用静态碰撞体。这两个概念将在接下来的章节中讨论。
- en: Level of detail
  id: totrans-84
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 级别细节
- en: Level of detail refers to how much detail is rendered on any given game object.
    The greater the number of polygons, the greater the level of detail your game
    objects will have. In order to reduce render times, you should consider what elements
    of detail need to be part of the 3D model and which ones can simply be included
    in the texture.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 级别细节指的是在任意游戏对象上渲染的细节程度。多边形数量越多，游戏对象的细节级别就越高。为了减少渲染时间，你应该考虑哪些细节元素需要包含在3D模型中，哪些可以简单地包含在纹理中。
- en: There are also **level of detail** (**LOD**) models. This is when you use multiple
    models of the same object in a game, each with a different level of detail. Think
    about a game where the player stands on the coast, looking at the horizon. A ship
    that is 12 miles away does not need the same level of detail as when it is just
    a few yards away.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，还有**级别细节**（**LOD**）模型。这是在游戏中使用同一对象的多个模型，每个模型具有不同的细节级别。想象一下，玩家站在海岸上，望着地平线。距离12英里的船不需要与距离仅几码时的同样细节级别。
- en: Static colliders
  id: totrans-87
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 静态碰撞体
- en: Static colliders are game objects with a collider but without a rigidbody. As
    the name suggests, these game objects do not move. Because the physics engine
    knows these objects will not move, pre-calculations can be made to make the game
    more efficient.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 静态碰撞体是具有碰撞器但没有刚体的游戏对象。正如其名所示，这些游戏对象不会移动。因为物理引擎知道这些对象不会移动，可以预先计算以使游戏更高效。
- en: So, to increase efficiency, you should strive to use static colliders when possible.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，为了提高效率，你应该尽可能使用静态碰撞体。
- en: Creating builds
  id: totrans-90
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建构建
- en: Creating a build for your game is not complicated when you are working on your
    own projects. You essentially ensure your assets (for example, 3D models, textures,
    animations, and scripts) are on your computer and you use Unity to create the
    build. This process is much more complicated when you are working on large and
    distributed teams.  This section covers the individual developer where all assets
    are on a single computer.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 当您在自己的项目上工作时，为您的游戏创建构建并不复杂。您本质上确保您的资产（例如，3D 模型、纹理、动画和脚本）在您的计算机上，并使用 Unity 创建构建。当您在大型和分布式团队上工作时，这个过程要复杂得多。本节涵盖了单个开发者，其中所有资产都在一台计算机上。
- en: Understanding the Unity build process
  id: totrans-92
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 理解 Unity 构建过程
- en: 'The Unity build process seems pretty easy. We can simply select File | Build
    & Run from the top menu and get great results. Unity actually does a lot of work
    to create a build. Here are the basic steps the Unity game engine takes to create
    a build of your game:'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: Unity 的构建过程看起来相当简单。我们只需从顶部菜单中选择文件 | 构建 & 运行，就能得到很好的结果。Unity 实际上做了很多工作来创建构建。以下是
    Unity 游戏引擎创建游戏构建的基本步骤：
- en: Generates a blank build copy of your game
  id: totrans-94
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 生成一个空白构建副本的游戏
- en: Sequences through the scene list, optimizing them before integrating them with
    the build
  id: totrans-95
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按顺序遍历场景列表，在将其集成到构建之前对其进行优化
- en: Calculates and stores data regarding what assets are needed for each scene
  id: totrans-96
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 计算并存储有关每个场景需要哪些资产的数据
- en: There are additional aspects of the build process that we should be aware of.
    For example, if we assign the EditorOnly tag to a game object, it will not be
    integrated into the build.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 构建过程中还有一些额外的方面我们应该注意。例如，如果我们将 EditorOnly 标签分配给一个游戏对象，它将不会集成到构建中。
- en: 'Once you have completed your game, you can select the Build & Run or Build
    Settings options from the File pull-down menu:'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦您完成了您的游戏，您可以从文件下拉菜单中选择构建 & 运行或构建设置选项：
- en: '![](img/ec3ce22c-4007-433c-a364-4c7f5c7ab74b.png)'
  id: totrans-99
  prefs: []
  type: TYPE_IMG
  zh: '![](img/ec3ce22c-4007-433c-a364-4c7f5c7ab74b.png)'
- en: Build settings
  id: totrans-100
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 构建设置
- en: 'We access the Build Settings dialog window via the File | Build & Run top menu
    option. With that interface open, displayed as follows, we can make several decisions
    regarding our build:'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 我们通过文件 | 构建 & 运行顶部菜单选项访问构建设置对话框窗口。当该界面打开时，显示如下，我们可以就我们的构建做出几个决定：
- en: '![](img/42684fa6-03d7-4485-829e-baaf079cc427.png)'
  id: totrans-102
  prefs: []
  type: TYPE_IMG
  zh: '![](img/42684fa6-03d7-4485-829e-baaf079cc427.png)'
- en: The top section of the Build Settings interface lists the Scenes that will be
    included in the build. You can use the Add Open Scenes button to quickly add those
    scenes to the build. You can also select and deselect scenes to ensure you only
    include the scenes needed for the build.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 构建设置界面的顶部列出了将包含在构建中的场景。您可以使用添加打开场景按钮快速将这些场景添加到构建中。您还可以选择和取消选择场景，以确保您只包含构建所需的场景。
- en: In the next section of the Build Settings interface,  you'll select a platform.
    Each of the platform options is covered in the next few sections.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 在构建设置界面的下一部分，您将选择一个平台。接下来的几个部分将涵盖每个平台选项。
- en: PC, Mac, and Linux standalone
  id: totrans-105
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: PC、Mac 和 Linux 独立平台
- en: 'For this platform group, you will need to select Mac OS X, Windows, or Linux.
    As you can see from the following screenshot, each operating system selection
    has its own set of options:'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 对于这个平台组，您需要选择 Mac OS X、Windows 或 Linux。正如您可以从下面的截图中所见，每个操作系统选择都有自己的选项集：
- en: '![](img/ee2912fb-21d4-497c-8eab-3ceaf213ff37.png)'
  id: totrans-107
  prefs: []
  type: TYPE_IMG
  zh: '![](img/ee2912fb-21d4-497c-8eab-3ceaf213ff37.png)'
- en: For Mac OS X, you will decide whether this is a development build or not. If
    it is, you will have the additional options of Autoconnect Profiler, Script Debugging,
    and Scripts Only Build.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 对于 Mac OS X，您将决定这是一个开发构建还是不是。如果是，您将拥有自动连接分析器、脚本调试和仅脚本构建的附加选项。
- en: For Windows, you will select whether it is a 32-bit or 64-bit build and select
    whether you want to copy the PDB files. You will also decide whether this is a
    development build or not. If it is, you will have the additional options of Autoconnect
    Profiler, Script Debugging, and Scripts Only Build.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 对于 Windows，您将选择它是 32 位还是 64 位构建，并选择是否要复制 PDB 文件。您还将决定这是否是一个开发构建。如果是，您将拥有自动连接分析器、脚本调试和仅脚本构建的附加选项。
- en: For Linux, you will select whether it is a 32-bit, 64-bit, or Universal build.
    You will also decide whether this is a development build or not. If it is, you
    will have the additional options of Autoconnect Profiler, Script Debugging, and
    Scripts Only Build. Lastly, you will select whether your build will support Headless
    Mode.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 对于Linux，您将选择它是32位、64位还是通用构建。您还将决定这是否是一个开发版本。如果是，您将拥有额外的选项，包括自动连接分析器、脚本调试和仅脚本构建。最后，您将选择您的构建是否支持无头模式。
- en: Headless mode refers to a server-based game that does not contain visual elements.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 无头模式指的是不包含视觉元素的基于服务器的游戏。
- en: iOS
  id: totrans-112
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: iOS
- en: When developing for iOS devices (iPad, iPad Pro, iPad Mini, iPhone, iPod Touch)
    you need to have Xcode installed on your computer. Xcode is also required for
    developing for macOS devices.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 当为iOS设备（iPad、iPad Pro、iPad Mini、iPhone、iPod Touch）开发时，您需要在您的计算机上安装Xcode。开发macOS设备也需要Xcode。
- en: You can obtain the latest version of Xcode here: [https://developer.apple.com/develop/](https://developer.apple.com/develop/).
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以在此处获取Xcode的最新版本：[https://developer.apple.com/develop/](https://developer.apple.com/develop/)。
- en: 'Using the Build Settings interface, you can identify your version of Xcode
    and decide whether you want to run it as a release or in debug mode. You can decide
    whether you want your Xcode project to directly reference the Unity iOS runtime
    library from the Unity Editor''s install location. This is accomplished by selecting
    the Symlink Unity libraries checkbox. You should not use this for your final build:'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 使用构建设置界面，您可以识别您的Xcode版本并决定是否以发布或调试模式运行它。您可以决定是否希望您的Xcode项目直接从Unity编辑器的安装位置引用Unity
    iOS运行时库。这通过选择“链接Unity库”复选框来完成。您不应该在最终构建中使用此选项：
- en: '![](img/7b3beafd-3f06-4156-b0c3-b6d5c1909a2c.png)'
  id: totrans-116
  prefs: []
  type: TYPE_IMG
  zh: '![](img/7b3beafd-3f06-4156-b0c3-b6d5c1909a2c.png)'
- en: You will also decide whether this is a development build or not. If it is, you
    will have the additional options of Autoconnect Profiler, Script Debugging, and
    Scripts Only Build.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 您还将决定这是否是一个开发版本。如果是，您将拥有额外的选项，包括自动连接分析器、脚本调试和仅脚本构建。
- en: tvOS
  id: totrans-118
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: tvOS
- en: 'As you can see here, the options for tvOS are the same as iOS:'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 如您在此处所见，tvOS的选项与iOS相同：
- en: '![](img/39e877b4-fe9b-42cf-969b-939340b924c0.png)'
  id: totrans-120
  prefs: []
  type: TYPE_IMG
  zh: '![](img/39e877b4-fe9b-42cf-969b-939340b924c0.png)'
- en: Android
  id: totrans-121
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Android
- en: 'When developing for Android devices, you have several Texture Compression options
    to choose from. You can also identify 16-bit, 32-bit, or 32-bit half resolution
    as the ETC2 fallback. You can use the internal Build System or Gradle, which is
    a build tool used in Android Studio and elsewhere:'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 当为Android设备开发时，您可以从多个纹理压缩选项中进行选择。您还可以将16位、32位或32位半分辨率识别为ETC2回退。您可以使用内部构建系统或Gradle，Gradle是Android
    Studio和其他地方使用的构建工具：
- en: '![](img/8a0c9d51-6aca-4b79-9af1-5072d1b6f30a.png)'
  id: totrans-123
  prefs: []
  type: TYPE_IMG
  zh: '![](img/8a0c9d51-6aca-4b79-9af1-5072d1b6f30a.png)'
- en: You will also decide whether this is a development build or not. If it is, you
    will have the additional options of Autoconnect Profiler, Script Debugging, and
    Scripts Only Build.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 您还将决定这是否是一个开发版本。如果是，您将拥有额外的选项，包括自动连接分析器、脚本调试和仅脚本构建。
- en: You can learn more about developing for Android devices here: [https://developer.android.com/](https://developer.android.com/).
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以在此处了解更多关于为Android设备开发的信息：[https://developer.android.com/](https://developer.android.com/)。
- en: HTML 5/WebGL
  id: totrans-126
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: HTML 5/WebGL
- en: 'When developing for HTML 5/Web GL, you will decide whether this is a Development
    Build or not. If it is, you will have the additional options of Autoconnect Profiler and
    Scripts Only Build:'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 当开发HTML 5/Web GL时，您将决定这是否是一个开发版本。如果是，您将拥有额外的选项，包括自动连接分析器和仅脚本构建：
- en: '![](img/af3bdee8-929d-4e05-afb1-84925ccfc556.png)'
  id: totrans-128
  prefs: []
  type: TYPE_IMG
  zh: '![](img/af3bdee8-929d-4e05-afb1-84925ccfc556.png)'
- en: Facebook
  id: totrans-129
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Facebook
- en: 'When developing a Unity game that will be published on Facebook, you will need
    the Facebook SDK and an App ID. For Target Platform, you can select Gameroom (Windows)
    or WebGL:'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 当开发将在Facebook上发布的Unity游戏时，您将需要Facebook SDK和一个App ID。对于目标平台，您可以选择Gameroom（Windows）或WebGL：
- en: '![](img/a985aa8d-b02b-458f-8ee7-4466f6d05ede.png)'
  id: totrans-131
  prefs: []
  type: TYPE_IMG
  zh: '![](img/a985aa8d-b02b-458f-8ee7-4466f6d05ede.png)'
- en: You will also decide whether this is a development build or not. If it is, you
    will have the additional options of Autoconnect Profiler and Scripts Only Build.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 您还将决定这是否是一个开发版本。如果是，您将拥有额外的选项，包括自动连接分析器和仅脚本构建。
- en: Consult the following URL for instructions on how to register and configure
    a Facebook app: [https://developers.facebook.com/docs/apps/register](https://developers.facebook.com/docs/apps/register).
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 有关如何注册和配置Facebook应用的说明，请参阅以下URL：[https://developers.facebook.com/docs/apps/register](https://developers.facebook.com/docs/apps/register)。
- en: Xbox One
  id: totrans-134
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Xbox One
- en: Access to the Xbox One player is handled through the Microsoft ID@Xbox program.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: Xbox One玩家的访问通过Microsoft ID@Xbox计划处理。
- en: Visit the following link to learn how to develop games for Xbox One: [https://www.xbox.com/en-US/developers](https://www.xbox.com/en-US/developers).
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 访问以下链接了解如何为Xbox One开发游戏：[https://www.xbox.com/en-US/developers](https://www.xbox.com/en-US/developers)。
- en: PlayStation 4 and PlayStation Vita
  id: totrans-137
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: PlayStation 4和PlayStation Vita
- en: Access to PlayStation 4 and PlayStation Vita players is handled through Dev
    NET and requires a Unity Plus or Unity Pro license.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: PlayStation 4和PlayStation Vita玩家的访问通过Dev NET处理，需要Unity Plus或Unity Pro许可证。
- en: Player Settings
  id: totrans-139
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 玩家设置
- en: Using the  Edit | Project Settings | Player menu option, you have access to
    the Unity Player Settings in the Inspector panel. In this context, the term player
    does not refer to the person playing the game, but to the software that runs the
    game.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 使用Edit | Project Settings | Player菜单选项，你可以在检查器面板中访问Unity玩家设置。在这个上下文中，术语玩家并不指玩游戏的人，而是指运行游戏的软件。
- en: 'As you can see in the following screenshot, there are data fields for the name
    of the company and the game''s title. Icons and cursors are also uploaded here:'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 如以下截图所示，有公司名称和游戏标题的数据字段。图标和光标也在此上传：
- en: '![](img/12d6aca0-86c6-4c3b-bf5b-1e0bcb93ac76.png)'
  id: totrans-142
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/12d6aca0-86c6-4c3b-bf5b-1e0bcb93ac76.png)'
- en: 'Beneath the general settings area of the PlayerSettings interface are six buttons.
    As you can see in the following image, there is one button for each of the platforms
    that Unity can generate a player for. This does not include Xbox or PlayStation
    players:'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 在PlayerSettings界面的一般设置区域下方有六个按钮。如图所示，每个平台都有一个按钮，Unity可以为它生成玩家。这不包括Xbox或PlayStation玩家：
- en: '![](img/53aae3d3-9d7d-458c-b997-96deac20defe.png)'
  id: totrans-144
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/53aae3d3-9d7d-458c-b997-96deac20defe.png)'
- en: 'For each of the platforms, there is a set of player configuration settings
    sections. This includes the following:'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 对于每个平台，都有一组玩家配置设置部分。这包括以下内容：
- en: Resolution and Presentation
  id: totrans-146
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 分辨率和展示
- en: Icon
  id: totrans-147
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 图标
- en: Splash Image
  id: totrans-148
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 启动图像
- en: Debugging and crash reporting
  id: totrans-149
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 调试和崩溃报告
- en: Other Settings
  id: totrans-150
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 其他设置
- en: Not every settings section will be applicable to all platform types. Also, the
    Other Settings content varies based on the platform you are developing for.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 并非每个设置部分都适用于所有平台类型。此外，其他设置内容根据你正在为哪个平台开发而有所不同。
- en: If you are developing for multiple platforms, you will need to review the settings
    for each platform type.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你正在为多个平台开发，你需要审查每种平台类型的设置。
- en: Summary
  id: totrans-153
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: In this chapter, we focused on optimization and deployment. We learned how to
    diagnose Unity games for performance problems and how to optimize scripts and
    graphic rendering. We also explored how to deploy our Unity games, including learning
    about the Unity build process, how to create a standalone player, and how to deploy
    games to multiple platforms.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们专注于优化和部署。我们学习了如何诊断Unity游戏中的性能问题，以及如何优化脚本和图形渲染。我们还探讨了如何部署我们的Unity游戏，包括了解Unity构建过程、如何创建独立玩家以及如何将游戏部署到多个平台。
- en: In [Chapter 14](e8f846b8-9476-4203-9e96-83d8556c62b5.xhtml), *Virtual Reality*, we
    will examine Unity's capabilities with regards to virtual reality. We will start
    with a quick introduction to virtual reality including hardware requirements,
    and then look at how to create a virtual reality game using the Unity game engine.
    We will also look at the available starter content from the Unity Asset Store.
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 在[第14章](e8f846b8-9476-4203-9e96-83d8556c62b5.xhtml)“虚拟现实”中，我们将探讨Unity在虚拟现实方面的能力。我们将从虚拟现实的快速介绍开始，包括硬件要求，然后看看如何使用Unity游戏引擎创建虚拟现实游戏。我们还将查看Unity资产商店中可用的起始内容。
