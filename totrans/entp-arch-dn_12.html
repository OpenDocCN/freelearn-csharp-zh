<html><head></head><body>
<div id="_idContainer142">
<h1 class="chapter-number" id="_idParaDest-252"><a id="_idTextAnchor446"/><span class="koboSpan" id="kobo.1.1">12</span></h1>
<h1 id="_idParaDest-253"><a id="_idTextAnchor447"/><span class="koboSpan" id="kobo.2.1">Externalization of Business Rules</span></h1>
<p><span class="koboSpan" id="kobo.3.1">After the two preceding chapters detailing the Master Data Management and Business Process Management parts of a utopic information system, this chapter will end with the third and last part of such an ideal system, which is the </span><strong class="bold"><span class="koboSpan" id="kobo.4.1">Business Rules Management System</span></strong><span class="koboSpan" id="kobo.5.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.6.1">BRMS</span></strong><span class="koboSpan" id="kobo.7.1">). </span><span class="koboSpan" id="kobo.7.2">We have already discussed briefly business rules in the previous chapters because the data referential may contain some validation rules that are associated with a given business entity, and the business process may also embed some business rules to orient the workflow and decide which branch of the process should be executed, depending on the context. </span><span class="koboSpan" id="kobo.7.3">But in the perfectly ideal system that we envision, a centralized system should be responsible for all the business rules, and that is the subject of </span><span class="No-Break"><span class="koboSpan" id="kobo.8.1">this chapter.</span></span></p>
<p><span class="koboSpan" id="kobo.9.1">We will start by explaining in more detail what a BRMS is and what implementing such a solution requires in terms of business rules management, deployment, and architecture of the stream of data in the system. </span><span class="koboSpan" id="kobo.9.2">Then, we will show the first example of business rules management using a</span><a id="_idIndexMarker697"/><span class="koboSpan" id="kobo.10.1"> standard called </span><strong class="bold"><span class="koboSpan" id="kobo.11.1">DMN</span></strong><span class="koboSpan" id="kobo.12.1"> (short for, </span><strong class="bold"><span class="koboSpan" id="kobo.13.1">Decision Model and Notation</span></strong><span class="koboSpan" id="kobo.14.1">), inside a </span><span class="No-Break"><span class="koboSpan" id="kobo.15.1">business process.</span></span></p>
<p><span class="koboSpan" id="kobo.16.1">Unlike the previous two, we will end this chapter (and the series of three chapters on the different parts of an ideal information system) without providing application examples of our sample information system. </span><span class="koboSpan" id="kobo.16.2">The reason behind this is that authorization management is one of the best examples of business rules management, but the subject is so complex that it needs a complete chapter to </span><span class="No-Break"><span class="koboSpan" id="kobo.17.1">understand it.</span></span><a id="_idTextAnchor448"/></p>
<h1 id="_idParaDest-254"><a id="_idTextAnchor449"/><span class="koboSpan" id="kobo.18.1">Business Rules Management Systems</span></h1>
<p><span class="koboSpan" id="kobo.19.1">A </span><strong class="bold"><span class="koboSpan" id="kobo.20.1">Business Rules Management System</span></strong><span class="koboSpan" id="kobo.21.1"> (we will abbreviate into </span><strong class="bold"><span class="koboSpan" id="kobo.22.1">BRMS</span></strong><span class="koboSpan" id="kobo.23.1"> from now on) is a piece of software that </span><a id="_idIndexMarker698"/><span class="koboSpan" id="kobo.24.1">deals with computations and decisions that can be applied to data, in order to output results that have a higher business value. </span><span class="koboSpan" id="kobo.24.2">There are lots of concepts in that definition, and we are going to explain them one at </span><span class="No-Break"><span class="koboSpan" id="kobo.25.1">a time</span><a id="_idTextAnchor450"/><span class="koboSpan" id="kobo.26.1">.</span></span></p>
<h2 id="_idParaDest-255"><a id="_idTextAnchor451"/><span class="koboSpan" id="kobo.27.1">How does a BRMS handle business rules?</span></h2>
<p><span class="koboSpan" id="kobo.28.1">A </span><a id="_idIndexMarker699"/><span class="koboSpan" id="kobo.29.1">business rule can, for example, calculate the total price of an order line, using the tax-excluding price of an article, the number of articles, and the applicable tax rate. </span><span class="koboSpan" id="kobo.29.2">Another example of its application would be to decide whether a piece of document created in an invoicing process should be given an electronic signature or not. </span><span class="koboSpan" id="kobo.29.3">In this case, the business rules output a Boolean value, stating whether the result is true or false. </span><span class="koboSpan" id="kobo.29.4">Business rules can call each other. </span><span class="koboSpan" id="kobo.29.5">In the previous example, we may have to decide how the document will be presented to someone for signature, who will sign if the initial signee is considered absent after several notifications, how many such notifications will be sent and on which channels, and so on – all these are </span><span class="No-Break"><span class="koboSpan" id="kobo.30.1">business rules.</span></span></p>
<p><span class="koboSpan" id="kobo.31.1">As its name suggests, a BRMS manages business rules. </span><span class="koboSpan" id="kobo.31.2">But what this entails is not so obvious. </span><span class="koboSpan" id="kobo.31.3">In one way, you could consider that a BRMS is the MDM of business rules – it can store them, together with their old versions. </span><span class="koboSpan" id="kobo.31.4">It can allow some people to read them, some to write them, or reject others that have no authorization whatsoever on certain business rules. </span><span class="koboSpan" id="kobo.31.5">It can group and categorize business rules in order to specify their research. </span><span class="koboSpan" id="kobo.31.6">All this is done by an MDM on its referenced business entity, but a BRMS has one more responsibility that an MDM does not have, which is the execution of the business rule. </span><span class="koboSpan" id="kobo.31.7">Indeed, a business rule takes input to calculate an output, and it is the main responsibility of a BRMS to </span><span class="No-Break"><span class="koboSpan" id="kobo.32.1">do so.</span></span></p>
<p><span class="koboSpan" id="kobo.33.1">However, responsibility does not mean the BRMS executes everything. </span><span class="koboSpan" id="kobo.33.2">Most of the time, it will delegate the enforcement of the rule, as it does not own the data that is addressed by a business rule or the service that executes a business action in a way defined by the output of the rule. </span><span class="koboSpan" id="kobo.33.3">That may sound counter-intuitive, but a BRMS can even delegate responsibility for the execution of the rule (which is to calculate the output of the rule from its input). </span><span class="koboSpan" id="kobo.33.4">This is the case, for example, where an MDM service validates its incoming data with a rule coming from the BRMS. </span><span class="koboSpan" id="kobo.33.5">Some local cache of the rules expressions is also possible since it does not introduce lots of coupling. </span><span class="koboSpan" id="kobo.33.6">Nonetheless, the responsibility of the validation rule remains in the BRMS, since if somebody changes the rule in the BRMS editor, then it will apply (maybe after a small delay, if the cache is not immediately invalidated for performance reasons) to all servers using this rule, among which is the MDM of </span><span class="No-Break"><span class="koboSpan" id="kobo.34.1">our example.</span></span></p>
<p><span class="koboSpan" id="kobo.35.1">To summarize, the primary responsibilities of a BRMS are to store, expose, and execute business rules. </span><span class="koboSpan" id="kobo.35.2">It is responsible for the right execution of the rules and, thus, either executes them internally or trusts other applications to execute the rules that it provides them. </span><span class="koboSpan" id="kobo.35.3">This is often the case, as external applications are the ones that have access to the input data necessary to execute the rule. </span><span class="koboSpan" id="kobo.35.4">Also, they will be – most of the time – the ones that use the output of the rule to adjust their </span><span class="No-Break"><span class="koboSpan" id="kobo.36.1">behavior accordingl</span><a id="_idTextAnchor452"/><span class="koboSpan" id="kobo.37.1">y.</span></span></p>
<h2 id="_idParaDest-256"><a id="_idTextAnchor453"/><span class="koboSpan" id="kobo.38.1">Additional characteristics of a BRMS</span></h2>
<p><span class="koboSpan" id="kobo.39.1">We often talk</span><a id="_idIndexMarker700"/><span class="koboSpan" id="kobo.40.1"> about the “secondary responsibilities” of a service for features that are not absolutely necessary but still remain important. </span><span class="koboSpan" id="kobo.40.2">In the case of BRMS, there are several </span><span class="No-Break"><span class="koboSpan" id="kobo.41.1">such responsibilities.</span></span></p>
<p><span class="koboSpan" id="kobo.42.1">First and foremost, a BRMS should have high performance, both in execution time and in its capacity to withstand a high volume of requests. </span><span class="koboSpan" id="kobo.42.2">Indeed, rule execution is one of the few cases where a cache is difficult to apply. </span><span class="koboSpan" id="kobo.42.3">When retrieving an image from a URL, there is a great chance that it is not going to change from one call to another one a few seconds after; thus, it is really worth keeping a cache, as this will avoid a network roundtrip and server request handling and drastically improve performance. </span><span class="koboSpan" id="kobo.42.4">This is not the case for business rules, as their main function is to be calculated from varying input and provide an output that depends </span><span class="No-Break"><span class="koboSpan" id="kobo.43.1">on them.</span></span></p>
<p><span class="koboSpan" id="kobo.44.1">Sure, the rule expression can be cached (and rules may not change that frequently), but when you do so, the caller has to be able to execute the rule from its textual expression itself, which may be overly complex and necessitate a rule-execution engine. </span><span class="koboSpan" id="kobo.44.2">If the rule is shared among many services, many instances of the engine will have to be kept in synchronization with the BRMS, so it is not efficient. </span><span class="koboSpan" id="kobo.44.3">So, we come back to the engine being in only one place, which is the BRMS </span><span class="No-Break"><span class="koboSpan" id="kobo.45.1">server itself.</span></span></p>
<p><span class="koboSpan" id="kobo.46.1">In this case, the engine’s moving parts may be cached, or at least kept in RAM, which will provide a quick execution. </span><span class="koboSpan" id="kobo.46.2">However, caching the results depending on the input is, most of the time, not efficient, as there are so many possible values. </span><span class="koboSpan" id="kobo.46.3">To use our preceding example, there is absolutely no need to cache the result of a calculation of an invoice line total price, as there is almost no chance that another call will come back quickly for the same article, with the same quantity and tax rate. </span><span class="koboSpan" id="kobo.46.4">If you add that some rules may be based on ever-changing data (such as stock market values), it can become absolutely impossible to arrange some way of caching. </span><span class="koboSpan" id="kobo.46.5">So, we basically fall back to the need for an engine that can output values as quickly as possible. </span><span class="koboSpan" id="kobo.46.6">This requirement should of course be supported in case of high volumes. </span><span class="koboSpan" id="kobo.46.7">As business data (as opposed to reporting data) tends to be volatile, business rules will be called </span><span class="No-Break"><span class="koboSpan" id="kobo.47.1">very often.</span></span></p>
<p><span class="koboSpan" id="kobo.48.1">The other “secondary” feature of a good BRMS is robustness. </span><span class="koboSpan" id="kobo.48.2">When they are used in the industry (which is not very often because they are complex applications), it is because they are a very important part of the business processes. </span><span class="koboSpan" id="kobo.48.3">For instance, a BRMS is used by insurance companies to calculate risk, or by mobile phone companies to calculate the price to be paid from data about the conversations (the duration, numbers called, time of the day, etc.) and the contract (a discount for certain numbers, prepaid amount per month, consumption in the month, etc.). </span><span class="koboSpan" id="kobo.48.4">Because of the cost of a BRMS, they are generally used for core business functions, where important decisions (in our examples, accepting a contract and sending the correct invoice to a customer) are made based on their output. </span><span class="koboSpan" id="kobo.48.5">The </span><a id="_idIndexMarker701"/><span class="koboSpan" id="kobo.49.1">robustness of calculations is, thus, an important aspect because no one would work with a system that can miscalculate from time </span><span class="No-Break"><span class="koboSpan" id="kobo.50.1">to time.</span></span></p>
<p><span class="koboSpan" id="kobo.51.1">For the same reason, traceability is generally an important feature of a BRMS. </span><span class="koboSpan" id="kobo.51.2">It can, of course, delegate this to calling services because a BRMS mostly works for other services. </span><span class="koboSpan" id="kobo.51.3">But even if the responsibility is shared, there should be logs that record whether a rule has been applied to certain context data, providing output that clarifies why a certain rule was made. </span><span class="koboSpan" id="kobo.51.4">Even if logs are better suited to the calling application, it is a good idea that the version of the BRMS set of rules is kept somewhere and that the rule engine versions are immutable. </span><span class="koboSpan" id="kobo.51.5">This allows you, if necessary, to go back in time, re-execute business rules calculation on the then-used version of the BRMS engine, and understand why an output value </span><span class="No-Break"><span class="koboSpan" id="kobo.52.1">was wrong.</span></span></p>
<p><span class="koboSpan" id="kobo.53.1">Finally, as explained previously, a BRMS is often used in conjunction with other services and is useless by itself. </span><span class="koboSpan" id="kobo.53.2">Its low-level characteristics make its integration and good capacity for interoperation of paramount importance. </span><span class="koboSpan" id="kobo.53.3">An implementation should normally come with at least some APIs and, if possible, SDKs for as many languages as possible, making it easy to interact with all possible </span><span class="No-Break"><span class="koboSpan" id="kobo.54.1">software applicati</span><a id="_idTextAnchor454"/><span class="koboSpan" id="kobo.55.1">ons.</span></span></p>
<h2 id="_idParaDest-257"><a id="_idTextAnchor455"/><span class="koboSpan" id="kobo.56.1">Actual use of BRMS</span></h2>
<p><span class="koboSpan" id="kobo.57.1">As </span><a id="_idIndexMarker702"/><span class="koboSpan" id="kobo.58.1">was hinted previously, the actual use of BRMS in the field is very low. </span><span class="koboSpan" id="kobo.58.2">The cost of implementation is such that only a few very particular cases of business rule execution are actually worth deploying a dedicated server for. </span><span class="koboSpan" id="kobo.58.3">Also, as we saw, the externalization of a rule comes with a high toll on performance, as either the application that knows the data has to send it to the BRMS and wait for the output to follow its flow, or it has to dynamically execute a business rule expression sent by the BRMS, and maybe cached internally. </span><span class="koboSpan" id="kobo.58.4">In this case, the speed of execution is still lower than when the rule is compiled into an application. </span><span class="koboSpan" id="kobo.58.5">Sure, the coupling between the application and the rule is then maximal, there is no centralized sharing of the rule, and the many uses can diverge. </span><span class="koboSpan" id="kobo.58.6">However, the performance issue can be so significant that these reasons are not </span><span class="No-Break"><span class="koboSpan" id="kobo.59.1">as important.</span></span></p>
<p><span class="koboSpan" id="kobo.60.1">Also, let’s not </span><a id="_idIndexMarker703"/><span class="koboSpan" id="kobo.61.1">underestimate habitual factors as well – since developers have spent most of their careers taking business rules from use cases and translating them into code put in an application, it is an effort to change this way of thinking, extract the business rule, and place it somewhere else. </span><span class="koboSpan" id="kobo.61.2">And with what results? </span><span class="koboSpan" id="kobo.61.3">A large performance drop and code that is more difficult to read and maintain. </span><span class="koboSpan" id="kobo.61.4">This means that the business rule should </span><strong class="bold"><span class="koboSpan" id="kobo.62.1">really</span></strong><span class="koboSpan" id="kobo.63.1"> change very often for externalization to become an option, but this is rarely the case. </span><span class="koboSpan" id="kobo.63.2">In the previous example with the computation of a VAT-net amount, how often does the tax rate change? </span><span class="koboSpan" id="kobo.63.3">If, like in France, this is more in terms of years or even decades, that means that there is absolutely no problem whatsoever in implementing the rule right in the code, since there will be many versions of the application released before the next change of VAT rate. </span><span class="koboSpan" id="kobo.63.4">Of course, that does not mean that the tax rate should be hardcoded in many places. </span><span class="koboSpan" id="kobo.63.5">But a careful developer will place it in a </span><strong class="source-inline"><span class="koboSpan" id="kobo.64.1">CommonBusinessValues</span></strong><span class="koboSpan" id="kobo.65.1"> class, in a </span><strong class="source-inline"><span class="koboSpan" id="kobo.66.1">public static readonly</span></strong><span class="koboSpan" id="kobo.67.1"> member, and everything will be fine and ready for </span><span class="No-Break"><span class="koboSpan" id="kobo.68.1">an update.</span></span></p>
<p><span class="koboSpan" id="kobo.69.1">This means that, indeed, in 99.99% of the cases, business rules will be concretely implemented, like in the following C# example, by means </span><span class="No-Break"><span class="koboSpan" id="kobo.70.1">of code:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.71.1">
public decimal GetPrice(decimal unitPrice, int quantity, decimal taxRate)
{
    return (unitPrice * quantity) * (1 + taxRate);
}</span></pre> <p><span class="koboSpan" id="kobo.72.1">Also, lots of other business rules will be scattered all over </span><span class="No-Break"><span class="koboSpan" id="kobo.73.1">the code:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.74.1">
if (Document.Type == DocumentTypes.INVOICE)
{
    SendForDigitalSignature(Document);
}</span></pre> <p><span class="koboSpan" id="kobo.75.1">As a side note, it is better to use string values or even dedicated code structures instead of enumerations for this kind of value, as this </span><span class="No-Break"><span class="koboSpan" id="kobo.76.1">eases evolution.</span></span></p>
<p><span class="koboSpan" id="kobo.77.1">In fact, there</span><a id="_idIndexMarker704"/><span class="koboSpan" id="kobo.78.1"> are so many business rules everywhere in a code base that it is difficult to spot all of them. </span><span class="koboSpan" id="kobo.78.2">But this is not what is most important. </span><span class="koboSpan" id="kobo.78.3">The real challenge is for the architect/product owner/developer to know, when creating the application, which ones should be externalized, which ones should be centralized, and which should be simply left in the code, even in duplicates, because they will never change. </span><span class="koboSpan" id="kobo.78.4">Beware, though, that some things that are thought to never change sometimes evolve over time! </span><span class="koboSpan" id="kobo.78.5">For example, you could say that the rule about net price will always be stable; net price will always be the tax-free price multiplied by one plus the tax rate. </span><span class="koboSpan" id="kobo.78.6">Well, yes, until the government decides to apply multiple tax rates that apply differently to the sub-parts of a product. </span><span class="koboSpan" id="kobo.78.7">And if you have in your Product Information Management software some articles that are composed of a hardware part and an installation service, for example, you may end up with the first part taxed at 5.5% and the second part taxed at 20%. </span><span class="koboSpan" id="kobo.78.8">If the calculation has been written in a centralized function, this is not so bad. </span><span class="koboSpan" id="kobo.78.9">But if it has been duplicated in hundreds of places in the code (which can be the case with business rules that everyone assumes are constant and immutable), you will face some difficulty, not only because it will take ages for the change to be realized, but also because the one instance you forget will most likely be the one your most important </span><span class="No-Break"><span class="koboSpan" id="kobo.79.1">customer uses.</span></span></p>
<p><span class="koboSpan" id="kobo.80.1">In short, externalizing a business rule in a dedicated BRMS is 99.99% of the time overkill, and the cost is not justified. </span><span class="koboSpan" id="kobo.80.2">But you can go a very long way simply by putting the business rule in a function. </span><span class="koboSpan" id="kobo.80.3">And most of the time, the only difficulty there is simply realizing you are </span><span class="No-Break"><span class="koboSpan" id="kobo.81.1">implementi</span><a id="_idTextAnchor456"/><span class="koboSpan" id="kobo.82.1">ng one!</span></span></p>
<h2 id="_idParaDest-258"><a id="_idTextAnchor457"/><span class="koboSpan" id="kobo.83.1">Examples of a BRMS</span></h2>
<p><span class="koboSpan" id="kobo.84.1">Let’s say that </span><a id="_idIndexMarker705"/><span class="koboSpan" id="kobo.85.1">you are indeed in this very particular 0.01% case where you actually could gain business value from implementing a dedicated BRMS. </span><span class="koboSpan" id="kobo.85.2">You would, thus, need a piece of software to do this for you, since, as you can imagine from the required secondary features, this kind of server is quite a complex piece of code. </span><span class="koboSpan" id="kobo.85.3">At the </span><a id="_idIndexMarker706"/><span class="koboSpan" id="kobo.86.1">time of writing, there were only two serious contenders for BRMS servers – Drools (open source) and </span><strong class="bold"><span class="koboSpan" id="kobo.87.1">Operational Decision </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.88.1">Manager</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.89.1"> (</span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.90.1">ODM</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.91.1">).</span></span></p>
<p><span class="koboSpan" id="kobo.92.1">The most used open source </span><a id="_idIndexMarker707"/><span class="koboSpan" id="kobo.93.1">BRMS is Drools (</span><a href="https://www.drools.org/"><span class="koboSpan" id="kobo.94.1">https://www.drools.org/</span></a><span class="koboSpan" id="kobo.95.1">). </span><span class="koboSpan" id="kobo.95.2">It contains a core engine to calculate rules (including some functions such as rule chaining), which is sometimes called an inference engine, as it infers results from a data context and a set of rules. </span><span class="koboSpan" id="kobo.95.3">It also contains an application to create and manipulate rules (with a web editor). </span><span class="koboSpan" id="kobo.95.4">Drools is written in Java and can be interoperated with other platforms, but </span><span class="No-Break"><span class="koboSpan" id="kobo.96.1">not natively.</span></span></p>
<p><span class="koboSpan" id="kobo.97.1">ODM, from IBM, is </span><a id="_idIndexMarker708"/><span class="koboSpan" id="kobo.98.1">a proprietary decision management system that was created to extract the important business rules from legacy COBOL code, in an effort to modernize the information systems on the z/OS platform. </span><span class="koboSpan" id="kobo.98.2">Although it can manipulate rules, it is mostly organized around the concepts of decisions </span><span class="No-Break"><span class="koboSpan" id="kobo.99.1">on events.</span></span></p>
<p><span class="koboSpan" id="kobo.100.1">As you can see, the landscape is far from being as complicated as in other fields of IT – for example, Big Data, where a single book could not even describe all the software applications, platforms, and servers that are available, mostly all doing the same things while pretending to be radically different from their competitors. </span><span class="koboSpan" id="kobo.100.2">This has the merit of clarity – if you need to implement a BRMS in your information system and you want to reduce costs, Drools will be your </span><span class="No-Break"><span class="koboSpan" id="kobo.101.1">first choice.</span></span></p>
<p><span class="koboSpan" id="kobo.102.1">Of course, there are some lesser-known alternatives. </span><span class="koboSpan" id="kobo.102.2">Lots of BPMN engines implement their own language for workflow decisions. </span><span class="koboSpan" id="kobo.102.3">Windows Workflow Foundation did so, but it is not supported anymore. </span><span class="koboSpan" id="kobo.102.4">PowerApps has some expression capability that can be used for business rule execution, but it can only be mutualized, so it is not a real BRMS system. </span><span class="koboSpan" id="kobo.102.5">Another solution, although it involves additional work, is to implement your own BRMS. </span><span class="koboSpan" id="kobo.102.6">If you do not need advanced features, you can build one quite quickly if you use an existing expression execution engine. </span><span class="koboSpan" id="kobo.102.7">Lots of scripting languages are available, and you can even use C# inside C# with expression trees, dynamic code generation, and other advanced, but still </span><span class="No-Break"><span class="koboSpan" id="kobo.103.1">accessible, features.</span></span></p>
<p><span class="koboSpan" id="kobo.104.1">In short, you have a choice of software, even if it is not as plethoric as in some other fields of IT. </span><span class="koboSpan" id="kobo.104.2">However, as you are certainly used to now, business/IT alignment is about reducing coupling, so the choice of software implementation is normally not such an important subject (in the sense it could harm the application evolution) as long as there is a standard norm, widely accepted specification, or even just an organization-wide pivotal format that can serve as a level of indirection between functional dependency and technical implementation. </span><span class="koboSpan" id="kobo.104.3">And the great news is that there is a standard for business rules, which is </span><strong class="bold"><span class="koboSpan" id="kobo.105.1">Decision Modeling Notation</span></strong><span class="koboSpan" id="kobo.106.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.107.1">DMN</span></strong><span class="koboSpan" id="kobo.108.1">) 1.0. </span><span class="koboSpan" id="kobo.108.2">This will be our topic of discussion in the next section of </span><span class="No-Break"><span class="koboSpan" id="kobo.109.1">th</span><a id="_idTextAnchor458"/><span class="koboSpan" id="kobo.110.1">is chapter.</span></span></p>
<h1 id="_idParaDest-259"><a id="_idTextAnchor459"/><span class="koboSpan" id="kobo.111.1">The DMN standard</span></h1>
<p><span class="koboSpan" id="kobo.112.1">DMN is a</span><a id="_idIndexMarker709"/><span class="koboSpan" id="kobo.113.1"> standard that defines decision trees and decision tables, which are the two main concepts concerning business rule implementation. </span><span class="koboSpan" id="kobo.113.2">In the upcoming sections, we will show how it works and how usefu</span><a id="_idTextAnchor460"/><span class="koboSpan" id="kobo.114.1">l it </span><span class="No-Break"><span class="koboSpan" id="kobo.115.1">can be.</span></span></p>
<h2 id="_idParaDest-260"><a id="_idTextAnchor461"/><span class="koboSpan" id="kobo.116.1">The origin and principle of DMN</span></h2>
<p><span class="koboSpan" id="kobo.117.1">The DMN standard</span><a id="_idIndexMarker710"/><span class="koboSpan" id="kobo.118.1"> is in version 1.0 and was published by the </span><strong class="bold"><span class="koboSpan" id="kobo.119.1">OMG</span></strong><span class="koboSpan" id="kobo.120.1"> (short for, </span><strong class="bold"><span class="koboSpan" id="kobo.121.1">Object Management Group</span></strong><span class="koboSpan" id="kobo.122.1">) in September 2015. </span><span class="koboSpan" id="kobo.122.2">At </span><a id="_idIndexMarker711"/><span class="koboSpan" id="kobo.123.1">the time of writing, the latest validated version is numbered 1.3 and was published in February 2021. </span><span class="koboSpan" id="kobo.123.2">Version 1.5 has existed since June 2023, but it is considered a beta version currently. </span><span class="koboSpan" id="kobo.123.3">Thus, we will discuss only </span><span class="No-Break"><span class="koboSpan" id="kobo.124.1">version 1.3.</span></span></p>
<p><span class="koboSpan" id="kobo.125.1">Note that OMG is also the consortium behind the BPMN 2.0 standard, which works in conjunction with the DMN standard. </span><span class="koboSpan" id="kobo.125.2">As expressed by OMG as soon as the first version was launched (</span><a href="https://www.omg.org/spec/DMN/1.0/About-DMN"><span class="koboSpan" id="kobo.126.1">https://www.omg.org/spec/DMN/1.0/About-DMN</span></a><span class="koboSpan" id="kobo.127.1">): “</span><em class="italic"><span class="koboSpan" id="kobo.128.1">DMN notation is designed to be useable alongside the standard BPMN business process notation.</span></em><span class="koboSpan" id="kobo.129.1">” And there is a type of task that exists in BPMN that directly relates to </span><span class="No-Break"><span class="koboSpan" id="kobo.130.1">business rules:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer121">
<span class="koboSpan" id="kobo.131.1"><img alt="Figure 12.1 – A business rule task" src="image/B21293_12_1.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.132.1">Figure 12.1 – A business rule task</span></p>
<p><span class="koboSpan" id="kobo.133.1">The idea behind </span><a id="_idIndexMarker712"/><span class="koboSpan" id="kobo.134.1">this type of task is that there are complex business rules that decide how a BPMN business process should behave (mostly, which path in the gateways should be taken) and that a way to handle such a decision should be made possible. </span><span class="koboSpan" id="kobo.134.2">Indeed, imagine a (not so) complicated process like </span><span class="No-Break"><span class="koboSpan" id="kobo.135.1">the following:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer122">
<span class="koboSpan" id="kobo.136.1"><img alt="Figure 12.2  – An example of a process with several rules" src="image/B21293_12_2.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.137.1">Figure 12.2  – An example of a process with several rules</span></p>
<p><span class="koboSpan" id="kobo.138.1">For now, it is not too bad because there are only three types of contracts. </span><span class="koboSpan" id="kobo.138.2">But this is typically the kind of scenario that has many chances to scale (never underestimate the creativity of </span><a id="_idIndexMarker713"/><span class="koboSpan" id="kobo.139.1">salespersons and marketing people). </span><span class="koboSpan" id="kobo.139.2">What if there are ten types of contract in the future, maybe with a third criterion to take into account? </span><span class="koboSpan" id="kobo.139.3">The process will become more and more complex and, soon, illegible, which would be a big problem, since business processes should always remain a helpful tool for teams and, specifically, not something that makes it more complicated for them </span><span class="No-Break"><span class="koboSpan" id="kobo.140.1">to work.</span></span></p>
<p><span class="koboSpan" id="kobo.141.1">DMN proposes a solution, which is to externalize the decision rules in a dedicated place, in order to free up the design of the process itself. </span><span class="koboSpan" id="kobo.141.2">In the previous example, we would externalize the decision table </span><span class="No-Break"><span class="koboSpan" id="kobo.142.1">like this:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer123">
<span class="koboSpan" id="kobo.143.1"><img alt="Figure 12.3 – A decision table" src="image/B21293_12_3.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.144.1">Figure 12.3 – A decision table</span></p>
<p><span class="koboSpan" id="kobo.145.1">This would allow us to draw the process in a much simpler way, as follows (note the icon in the second task, which corresponds to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.146.1">Business </span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.147.1">rule</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.148.1"> type):</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer124">
<span class="koboSpan" id="kobo.149.1"><img alt="Figure 12.4 – A simplified BPMN process" src="image/B21293_12_4.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.150.1">Figure 12.4 – A simplified BPMN process</span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.151.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.152.1">Sadly, since there is no standardization of how data is collected in the different tasks of a BPMN process, there can be no standardized way either to call a DMN model. </span><span class="koboSpan" id="kobo.152.2">But it’s worth keeping informed about any updates to the norms at </span><a href="https://www.omg.org/dmn/"><span class="koboSpan" id="kobo.153.1">https://www.omg.org/dmn/</span></a><span class="koboSpan" id="kobo.154.1"> since this is bound to change at some point in </span><span class="No-Break"><span class="koboSpan" id="kobo.155.1">the future.</span></span></p>
<p><span class="koboSpan" id="kobo.156.1">The best part is</span><a id="_idIndexMarker714"/><span class="koboSpan" id="kobo.157.1"> that now that this logic has been decoupled from the business process itself, we could evolve to a much more complex definition of the type of contract, such as the following, without having to change anything on the </span><span class="No-Break"><span class="koboSpan" id="kobo.158.1">process itself:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer125">
<span class="koboSpan" id="kobo.159.1"><img alt="Figure 12.5 – An extended decision table" src="image/B21293_12_5.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.160.1">Figure 12.5 – An extended decision table</span></p>
<p><span class="koboSpan" id="kobo.161.1">This time, we also take into account the age of the author to issue some special contract that must be signed by the author’s parents. </span><span class="koboSpan" id="kobo.161.2">This is done by using a very simple expression here (</span><strong class="bold"><span class="koboSpan" id="kobo.162.1">&lt;18</span></strong><span class="koboSpan" id="kobo.163.1">), but the </span><strong class="source-inline"><span class="koboSpan" id="kobo.164.1">FEEL</span></strong><span class="koboSpan" id="kobo.165.1"> expression language allows for much more sophisticated expressions (if you want to delve into more on this subject, </span><a href="https://kiegroup.github.io/dmn-feel-handbook/#dmn-feel-handbook"><span class="koboSpan" id="kobo.166.1">https://kiegroup.github.io/dmn-feel-handbook/#dmn-feel-handbook</span></a><span class="koboSpan" id="kobo.167.1"> is a great starting point). </span><span class="koboSpan" id="kobo.167.2">You also may have spotted that the </span><strong class="bold"><span class="koboSpan" id="kobo.168.1">Hit policy</span></strong><span class="koboSpan" id="kobo.169.1"> dropdown at the top of the preceding screenshot now is set on the </span><strong class="bold"><span class="koboSpan" id="kobo.170.1">First</span></strong><span class="koboSpan" id="kobo.171.1"> mode (the first rule that matches in the table), whereas the previous screenshot showed the </span><strong class="bold"><span class="koboSpan" id="kobo.172.1">Unique</span></strong><span class="koboSpan" id="kobo.173.1"> value – this allows us to specify a condition on the author’s age in the first line of the table and simply let the second line to contain no value. </span><span class="koboSpan" id="kobo.173.2">I also cleaned the decision table for </span><strong class="source-inline"><span class="koboSpan" id="kobo.174.1">AdditionalEdition</span></strong><span class="koboSpan" id="kobo.175.1">, since the result was common for any author as long as the book is a new edition of an </span><span class="No-Break"><span class="koboSpan" id="kobo.176.1">existing one.</span></span></p>
<p><span class="koboSpan" id="kobo.177.1">Having these tables to externalize potentially complex rules is already a great advantage, but DMN also comes with a graphical way to represent the decision </span><span class="No-Break"><span class="koboSpan" id="kobo.178.1">process itself:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer126">
<span class="koboSpan" id="kobo.179.1"><img alt="Figure 12.6 – An example decision graph" src="image/B21293_12_6.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.180.1">Figure 12.6 – An example decision graph</span></p>
<p><span class="koboSpan" id="kobo.181.1">In our example, the </span><a id="_idIndexMarker715"/><span class="koboSpan" id="kobo.182.1">diagram is very simple, since we use only two inputs (author and book information) in order to create a decision (the type of contract), possibly using a “knowledge source,” which would be our referential of contracts, although we did not relate to any such use in the simple example previously. </span><span class="koboSpan" id="kobo.182.2">However, these diagrams could be much more advanced and show hierarchical decisions if necessary. </span><span class="koboSpan" id="kobo.182.3">We could imagine that the type of contract decided on is then itself used to decide the content of a customized contract, depending on the regions of diffusion of the work, and that sales statistics are used to decide on a proposed amount for </span><span class="No-Break"><span class="koboSpan" id="kobo.183.1">the contract:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer127">
<span class="koboSpan" id="kobo.184.1"><img alt="Figure 12.7 – An extended decision graph" src="image/B21293_12_7.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.185.1">Figure 12.7 – An extended decision graph</span></p>
<p><span class="koboSpan" id="kobo.186.1">To give an idea of the XML structure of a DML file, here is the (shortened) content corresponding to this first example above, where you will easily recognize the first part with the decision </span><a id="_idIndexMarker716"/><span class="koboSpan" id="kobo.187.1">rules (starting at </span><strong class="source-inline"><span class="koboSpan" id="kobo.188.1">&lt;decision&gt;</span></strong><span class="koboSpan" id="kobo.189.1">) and the second part corresponding to the diagram (starting </span><span class="No-Break"><span class="koboSpan" id="kobo.190.1">at </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.191.1">&lt;dmndi:DMNDI&gt;</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.192.1">):</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.193.1">
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;definitions      id="definitions_065qkmh" name="definitions" namespace="http://camunda.org/schema/1.0/dmn" exporter="dmn-js (https://demo.bpmn.io/dmn)" exporterVersion="15.0.0"&gt;
  &lt;decision id="decision_1u2xbtg" name="Type of contract"&gt;
    &lt;informationRequirement id="InformationRequirement_1i0e44v"&gt;
      &lt;requiredInput href="#InputData_0wi3jz6" /&gt;
    &lt;/informationRequirement&gt;
    &lt;informationRequirement id="InformationRequirement_0g0syf3"&gt;
      &lt;requiredInput href="#InputData_1jz546j" /&gt;
    &lt;/informationRequirement&gt;
    &lt;decisionTable id="decisionTable_0cwlzw4" biodi:annotationsWidth="400"&gt;
      &lt;input id="input1" label="Author"&gt;
        &lt;inputExpression id="inputExpression1" typeRef="string"&gt;
          &lt;text&gt;&lt;/text&gt;
        &lt;/inputExpression&gt;
      &lt;/input&gt;
      &lt;input id="InputClause_1hfsajf" label="Book"&gt;
        &lt;inputExpression id="LiteralExpression_00wz5lk" typeRef="string"&gt;
          &lt;text&gt;&lt;/text&gt;
        &lt;/inputExpression&gt;
      &lt;/input&gt;
      &lt;output id="output1" label="Contract" name="" typeRef="string" /&gt;
      &lt;rule id="DecisionRule_05kn45x"&gt;
        &lt;inputEntry id="UnaryTests_19ou6i4"&gt;
          &lt;text&gt;"New"&lt;/text&gt;
        &lt;/inputEntry&gt;
        &lt;inputEntry id="UnaryTests_0l88vr8"&gt;
          &lt;text&gt;"New"&lt;/text&gt;
        &lt;/inputEntry&gt;
        &lt;outputEntry id="LiteralExpression_05irfs8"&gt;
          &lt;text&gt;"New"&lt;/text&gt;
        &lt;/outputEntry&gt;
      &lt;/rule&gt;
      &lt;!-- Some rules removed --&gt;
      &lt;rule id="DecisionRule_1sg8k57"&gt;
        &lt;inputEntry id="UnaryTests_1yjyvpp"&gt;
          &lt;text&gt;"Existing"&lt;/text&gt;
        &lt;/inputEntry&gt;
        &lt;inputEntry id="UnaryTests_0qo517n"&gt;
          &lt;text&gt;"AddEdition"&lt;/text&gt;
        &lt;/inputEntry&gt;
        &lt;outputEntry id="LiteralExpression_0ymlni0"&gt;
          &lt;text&gt;"AdditionalEdition"&lt;/text&gt;
        &lt;/outputEntry&gt;
      &lt;/rule&gt;
    &lt;/decisionTable&gt;
  &lt;/decision&gt;
  &lt;inputData id="InputData_0wi3jz6" name="Author history" /&gt;
  &lt;inputData id="InputData_1jz546j" name="Books history for the author" /&gt;
  &lt;dmndi:DMNDI&gt;
    &lt;dmndi:DMNDiagram id="DMNDiagram_1r90cap"&gt;
      &lt;dmndi:DMNShape id="DMNShape_15dfipm" dmnElementRef="decision_1u2xbtg"&gt;
        &lt;dc:Bounds height="80" width="180" x="330" y="200" /&gt;
      &lt;/dmndi:DMNShape&gt;
      &lt;dmndi:DMNShape id="DMNShape_14d6htu" dmnElementRef="InputData_0wi3jz6"&gt;
        &lt;dc:Bounds height="45" width="125" x="257" y="337" /&gt;
      &lt;/dmndi:DMNShape&gt;
      &lt;dmndi:DMNEdge id="DMNEdge_1a3apwq" dmnElementRef="InformationRequirement_1i0e44v"&gt;
        &lt;di:waypoint x=»320» y=»337» /&gt;
        &lt;di:waypoint x=»390» y=»300» /&gt;
        &lt;di:waypoint x=»390» y=»280» /&gt;
      &lt;/dmndi:DMNEdge&gt;
      &lt;dmndi:DMNShape id=»DMNShape_0s4bzo1» dmnElementRef=»InputData_1jz546j»&gt;
        &lt;dc:Bounds height="45" width="125" x="457" y="337" /&gt;
      &lt;/dmndi:DMNShape&gt;
      &lt;dmndi:DMNEdge id="DMNEdge_0ng7t96" dmnElementRef="InformationRequirement_0g0syf3"&gt;
        &lt;di:waypoint x="520" y="337" /&gt;
        &lt;di:waypoint x="450" y="300" /&gt;
        &lt;di:waypoint x="450" y="280" /&gt;
      &lt;/dmndi:DMNEdge&gt;
    &lt;/dmndi:DMNDiagram&gt;
  &lt;/dmndi:DMNDI&gt;
&lt;/definitions&gt;</span></pre> <p><span class="koboSpan" id="kobo.194.1">All the graphs</span><a id="_idIndexMarker717"/><span class="koboSpan" id="kobo.195.1"> shown previously were designed using the great tool provided by Camunda at </span><a href="https://demo.bpmn.io/dmn"><span class="koboSpan" id="kobo.196.1">https://demo.bpmn.io/dmn</span></a><span class="koboSpan" id="kobo.197.1">. </span><span class="koboSpan" id="kobo.197.2">Now that you have an introductory knowledge of what DMN is about, let’s see how we can put the stan</span><a id="_idTextAnchor462"/><span class="koboSpan" id="kobo.198.1">dard </span><span class="No-Break"><span class="koboSpan" id="kobo.199.1">to work.</span></span></p>
<h2 id="_idParaDest-261"><a id="_idTextAnchor463"/><span class="koboSpan" id="kobo.200.1">Implementations</span></h2>
<p><span class="koboSpan" id="kobo.201.1">The </span><a id="_idIndexMarker718"/><span class="koboSpan" id="kobo.202.1">Business Rules Execution System landscape is quite small. </span><span class="koboSpan" id="kobo.202.2">The go-to implementation of DMN has been and remains the Java open source project called Drools. </span><span class="koboSpan" id="kobo.202.3">Drools is a BRMS that supports its own rules language but also DMN, and since DMN is the standard, all servers using Drools are based on it. </span><span class="koboSpan" id="kobo.202.4">You can use Drools directly in your Java applications, or even with some bridges to other platforms. </span><span class="koboSpan" id="kobo.202.5">In particular, there has been a Drools .NET implementation, and some projects such as </span><a href="https://github.com/adamecr/Common.DMN.Engine"><span class="koboSpan" id="kobo.203.1">https://github.com/adamecr/Common.DMN.Engine</span></a><span class="koboSpan" id="kobo.204.1"> can help with that, but the maintenance of such projects is questionable, and I’d rather show you another way that – in my opinion – is more suitable to what we are trying to achieve, which is an aligned and adaptable </span><span class="No-Break"><span class="koboSpan" id="kobo.205.1">information system.</span></span></p>
<p><span class="koboSpan" id="kobo.206.1">To do so, we</span><a id="_idIndexMarker719"/><span class="koboSpan" id="kobo.207.1"> will get closer to a service-oriented architecture by using a BRMS server that exposes the business rule runtime through REST APIs. </span><span class="koboSpan" id="kobo.207.2">Sure, the performance will not be as strong as with an embedded library but remember that, first, “premature optimization is the root of all evil” and, second, that most calls of the business rules are not executed with high frequency (and when they need to be, we will show at the end of the chapter how we can adapt). </span><span class="koboSpan" id="kobo.207.3">Kogito has already been cited in the previous chapter, but we did not show a complete example of BPMN with it because, as was explained, this would be overkill for most cases, especially our sample </span><strong class="source-inline"><span class="koboSpan" id="kobo.208.1">DemoEditor</span></strong><span class="koboSpan" id="kobo.209.1"> information system. </span><span class="koboSpan" id="kobo.209.2">What is interesting is that Kogito also supports DMN, and that is why we are going to use it here – or, rather, use JBPM, which is the product that Kogito is </span><span class="No-Break"><span class="koboSpan" id="kobo.210.1">based on.</span></span></p>
<p><span class="koboSpan" id="kobo.211.1">In fact, Kogito is the cloud-native derivative of JBPM, a product maintained under the JBoss umbrella. </span><span class="koboSpan" id="kobo.211.2">Since we are not going to deploy in the cloud, instead keeping a Docker-based deployment of our applications to satisfy either SaaS or on-premise conditions, we will simply use JBPM in the following example. </span><span class="koboSpan" id="kobo.211.3">Still, keep in mind for your needs that Kogito may be a better alternative, particularly since it offers some functions that could be compared to a light MDM, exposing entities directly by REST APIs generated dynamically. </span><span class="koboSpan" id="kobo.211.4">If you want to go in this direction and see how a fully integrated cloud-oriented approach suits you, you can start with Docker images of Kogito, available </span><span class="No-Break"><span class="koboSpan" id="kobo.212.1">at </span></span><a href="https://github.com/kiegroup/kogito-images"><span class="No-Break"><span class="koboSpan" id="kobo.213.1">https://github.com/kiegroup/kogito-images</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.214.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.215.1">The JBoss JBPM server that we are going to exploit is an all-in-one application, providing a frontend and a backend to design and operate BPMN workflows with DMN-based business rules. </span><span class="koboSpan" id="kobo.215.2">It works with Maven projects containing some Java code for the unit tests, and possibly for the exposition of the entities, but it can operate with simple standard files in DMN for </span><span class="No-Break"><span class="koboSpan" id="kobo.216.1">our example.</span></span></p>
<p><span class="koboSpan" id="kobo.217.1">In the next section, we will explain how to operate a sample business rule engine in JBPM 7.74, using the Drools engine and a DMN definition of two business decisions with several parameters. </span><span class="koboSpan" id="kobo.217.2">For more information about how this works precisely, head over to </span><a href="https://docs.jboss.org/drools/release/7.74.1.Final/drools-docs/html_single/"><span class="koboSpan" id="kobo.218.1">https://docs.jboss.org/drools/release/7.74.1.Final/drools-docs/html_single/</span></a><span class="koboSpan" id="kobo.219.1">. </span><span class="koboSpan" id="kobo.219.2">The reason why we use a sample provided by JBoss is that designing from scratch an example on the subject of </span><strong class="source-inline"><span class="koboSpan" id="kobo.220.1">DemoEditor</span></strong><span class="koboSpan" id="kobo.221.1"> would take up a whole chapter. </span><span class="koboSpan" id="kobo.221.2">In addition, it would be a completely artificial exercise, since a DMN rule engine, just like a BPMN engine in the previous chapter, would simply be overkill for our functional needs. </span><span class="koboSpan" id="kobo.221.3">It is essential that I respect the principal rule I have been repeating over and over since the beginning of this book, which is that the technical aspects should be completely defined by the </span><a id="_idIndexMarker720"/><span class="koboSpan" id="kobo.222.1">functional needs. </span><span class="koboSpan" id="kobo.222.2">Although I – like most of us who are passionate about technology – would love to integrate a full-blown Kogito server in our sample information system, the truth is that it would not be suitable for our needs. </span><span class="koboSpan" id="kobo.222.3">The implementation of the business workflows and most business rules will simply be in dedicated .NET services. </span><span class="koboSpan" id="kobo.222.4">Only a particular case of business rules would be treated with a dedicated external service that strongly resembles a BRMS, namely the authorization rules. </span><span class="koboSpan" id="kobo.222.5">But I am anticipating the last section of this chapter, and for now, we are going to show how we can take advantage of a DMN-based BRMS in a business/IT-aligned cont</span><a id="_idTextAnchor464"/><span class="koboSpan" id="kobo.223.1">ext, </span><span class="No-Break"><span class="koboSpan" id="kobo.224.1">using JBPM.</span></span></p>
<h2 id="_idParaDest-262"><a id="_idTextAnchor465"/><span class="koboSpan" id="kobo.225.1">An example of DMN use</span></h2>
<p><span class="koboSpan" id="kobo.226.1">Simple </span><a id="_idIndexMarker721"/><span class="koboSpan" id="kobo.227.1">exercises such as the one that follows are really where Docker stands out because it will save us the hassle of installing Java and Maven, getting the right dependencies, updating versions, and so on. </span><span class="koboSpan" id="kobo.227.2">Provided you have Docker installed on your machine (and if this is not the case, you really should, as this tool is now part of your basic toolset, just like a web browser and a text editor), you can simply enter the </span><span class="No-Break"><span class="koboSpan" id="kobo.228.1">following commands:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.229.1">
docker run -d --name jbpm-console -p 8080:8080 quay.io/kiegroup/business-central-workbench-showcase:latest
docker run -d --name jbpm-bre -p 8180:8080 --link jbpm-console:kie-wb quay.io/kiegroup/kie-server-showcase:latest</span></pre> <p><span class="koboSpan" id="kobo.230.1">Note that the </span><strong class="source-inline"><span class="koboSpan" id="kobo.231.1">latest</span></strong><span class="koboSpan" id="kobo.232.1"> tag, at the time of writing, was the </span><strong class="source-inline"><span class="koboSpan" id="kobo.233.1">7.74.1.Final</span></strong><span class="koboSpan" id="kobo.234.1"> version. </span><span class="koboSpan" id="kobo.234.2">It is generally recommended to use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.235.1">latest</span></strong><span class="koboSpan" id="kobo.236.1"> tag as much as possible, but if you ever encounter a functional problem replaying the example, give it a try using this precise version, even if it is not the latest anymore. </span><span class="koboSpan" id="kobo.236.2">The first Docker command will start a container based on the image containing everything that is needed to design, build, test, and deploy projects, including the BPMN and DMN assets. </span><span class="koboSpan" id="kobo.236.3">This is where we will manipulate the DMN model. </span><span class="koboSpan" id="kobo.236.4">If you want to get some more information about this image, the reference page is </span><a href="https://quay.io/repository/kiegroup/business-central-workbench-showcase"><span class="koboSpan" id="kobo.237.1">https://quay.io/repository/kiegroup/business-central-workbench-showcase</span></a><span class="koboSpan" id="kobo.238.1">. </span><span class="koboSpan" id="kobo.238.2">The second Docker command runs a container onto which the project will be deployed and that will act as a separate business rule execution engine, or a simple runtime if you prefer to think of it that way. </span><span class="koboSpan" id="kobo.238.3">The reference page for this second image </span><span class="No-Break"><span class="koboSpan" id="kobo.239.1">is </span></span><a href="https://quay.io/repository/kiegroup/kie-server-showcase"><span class="No-Break"><span class="koboSpan" id="kobo.240.1">https://quay.io/repository/kiegroup/kie-server-showcase</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.241.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.242.1">Once everything has started (you should allow for some time – up to one minute – for the completion of the startup routine), you can access the console by navigating to </span><strong class="source-inline"><span class="koboSpan" id="kobo.243.1">http://localhost:8080/business-central</span></strong><span class="koboSpan" id="kobo.244.1">, where you will be able to connect with the default credentials, </span><strong class="source-inline"><span class="koboSpan" id="kobo.245.1">admin</span></strong><span class="koboSpan" id="kobo.246.1">/</span><strong class="source-inline"><span class="koboSpan" id="kobo.247.1">admin</span></strong><span class="koboSpan" id="kobo.248.1"> (the documentation cited previously</span><a id="_idIndexMarker722"/><span class="koboSpan" id="kobo.249.1"> provides other credentials for users with different authorization profiles, as well as how to set up </span><span class="No-Break"><span class="koboSpan" id="kobo.250.1">production-ready authorization).</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer128">
<span class="koboSpan" id="kobo.251.1"><img alt="Figure 12.8 – The JPBM login page" src="image/B21293_12_8.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.252.1">Figure 12.8 – The JPBM login page</span></p>
<p><span class="koboSpan" id="kobo.253.1">Once connected, you will be presented with the welcome page interface, which you can return to at any time by clicking on </span><strong class="bold"><span class="koboSpan" id="kobo.254.1">Business Central</span></strong><span class="koboSpan" id="kobo.255.1">, or the home icon in the top-left part of </span><span class="No-Break"><span class="koboSpan" id="kobo.256.1">the screen.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer129">
<span class="koboSpan" id="kobo.257.1"><img alt="Figure 12.9 – The JPBM welcome page" src="image/B21293_12_9.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.258.1">Figure 12.9 – The JPBM welcome page</span></p>
<p><span class="koboSpan" id="kobo.259.1">In the </span><strong class="bold"><span class="koboSpan" id="kobo.260.1">Design</span></strong><span class="koboSpan" id="kobo.261.1"> section, click on </span><strong class="bold"><span class="koboSpan" id="kobo.262.1">Projects</span></strong><span class="koboSpan" id="kobo.263.1">. </span><span class="koboSpan" id="kobo.263.2">This will bring you to an interface in which you can manage</span><a id="_idIndexMarker723"/><span class="koboSpan" id="kobo.264.1"> your </span><span class="No-Break"><span class="koboSpan" id="kobo.265.1">JBPM projects:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer130">
<span class="koboSpan" id="kobo.266.1"><img alt="Figure 12.10 – A list of JPBM spaces" src="image/B21293_12_10.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.267.1">Figure 12.10 – A list of JPBM spaces</span></p>
<p><span class="koboSpan" id="kobo.268.1">Spaces are used to organize work and separate groups of projects from one another. </span><span class="koboSpan" id="kobo.268.2">In this simple tryout of the technology, simply select the existing </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.269.1">MySpace</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.270.1"> space.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer131">
<span class="koboSpan" id="kobo.271.1"><img alt="Figure 12.11 – A JPBM space without any project" src="image/B21293_12_11.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.272.1">Figure 12.11 – A JPBM space without any project</span></p>
<p><span class="koboSpan" id="kobo.273.1">The space just</span><a id="_idIndexMarker724"/><span class="koboSpan" id="kobo.274.1"> created is, of course, empty for now. </span><span class="koboSpan" id="kobo.274.2">We are going to use one of the embedded examples to illustrate how JBPMN works and what we are particularly interested in right now, namely the DMN rules engine. </span><span class="koboSpan" id="kobo.274.3">To do so, click on </span><strong class="bold"><span class="koboSpan" id="kobo.275.1">Try Samples</span></strong><span class="koboSpan" id="kobo.276.1">, which will bring you to the </span><span class="No-Break"><span class="koboSpan" id="kobo.277.1">following interface:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer132">
<span class="koboSpan" id="kobo.278.1"><img alt="Figure 12.12 – Choosing sample projects" src="image/B21293_12_12.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.279.1">Figure 12.12 – Choosing sample projects</span></p>
<p><span class="koboSpan" id="kobo.280.1">There, select </span><a id="_idIndexMarker725"/><span class="koboSpan" id="kobo.281.1">the </span><strong class="bold"><span class="koboSpan" id="kobo.282.1">Traffic_Violation</span></strong><span class="koboSpan" id="kobo.283.1"> sample project and click on </span><strong class="bold"><span class="koboSpan" id="kobo.284.1">OK</span></strong><span class="koboSpan" id="kobo.285.1">. </span><span class="koboSpan" id="kobo.285.2">You should receive a message stating that the project has been correctly imported, and you will land on a page that shows the assets contained by the </span><span class="No-Break"><span class="koboSpan" id="kobo.286.1">sample project:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer133">
<span class="koboSpan" id="kobo.287.1"><img alt="Figure 12.13 – Assets of the traffic violation JBPM sample" src="image/B21293_12_13.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.288.1">Figure 12.13 – Assets of the traffic violation JBPM sample</span></p>
<p><span class="koboSpan" id="kobo.289.1">Of course, the asset</span><a id="_idIndexMarker726"/><span class="koboSpan" id="kobo.290.1"> that interests us most is the DMN model. </span><span class="koboSpan" id="kobo.290.2">Click on the </span><strong class="bold"><span class="koboSpan" id="kobo.291.1">Traffic Violation</span></strong><span class="koboSpan" id="kobo.292.1"> asset to analyze it, and you will be led to the following interface, which shows the main part of the DMN model, the </span><span class="No-Break"><span class="koboSpan" id="kobo.293.1">decision graph:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer134">
<span class="koboSpan" id="kobo.294.1"><img alt="Figure 12.14 – A sample DMN decision graph" src="image/B21293_12_14.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.295.1">Figure 12.14 – A sample DMN decision graph</span></p>
<p><span class="koboSpan" id="kobo.296.1">If you have a</span><a id="_idIndexMarker727"/><span class="koboSpan" id="kobo.297.1"> driver’s license, the understanding of this example should be self-explanatory – the violation of the speed limit provides data to calculate the associated fine. </span><span class="koboSpan" id="kobo.297.2">Then, depending on the fine and additional context on the driver, another decision is taken, regarding whether a suspension of the driver’s license should </span><span class="No-Break"><span class="koboSpan" id="kobo.298.1">be invoked.</span></span></p>
<p><span class="koboSpan" id="kobo.299.1">If you now click on the menu on the left, on the </span><strong class="bold"><span class="koboSpan" id="kobo.300.1">Decision Table</span></strong><span class="koboSpan" id="kobo.301.1"> entry of the </span><strong class="bold"><span class="koboSpan" id="kobo.302.1">Fine</span></strong><span class="koboSpan" id="kobo.303.1"> section, you will be shown the following table that describes the conditions of application of </span><span class="No-Break"><span class="koboSpan" id="kobo.304.1">the decision:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer135">
<span class="koboSpan" id="kobo.305.1"><img alt="Figure 12.15 – A sample DMN decision table" src="image/B21293_12_141.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.306.1">Figure 12.15 – A sample DMN decision table</span></p>
<p><span class="koboSpan" id="kobo.307.1">Now, go back</span><a id="_idIndexMarker728"/><span class="koboSpan" id="kobo.308.1"> to the project by using the breadcrumbs menu at the top, and then click </span><strong class="bold"><span class="koboSpan" id="kobo.309.1">Deploy</span></strong><span class="koboSpan" id="kobo.310.1"> in the top menu </span><span class="No-Break"><span class="koboSpan" id="kobo.311.1">that appears:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer136">
<span class="koboSpan" id="kobo.312.1"><img alt="Figure 12.16 – The JBPM build and deploy menu" src="image/B21293_12_15.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.313.1">Figure 12.16 – The JBPM build and deploy menu</span></p>
<p><span class="koboSpan" id="kobo.314.1">After a bit of time, you should see a message stating that the build is successful, and then a second one, like the one shown in the following figure, that explains that everything is now ready to exploit the </span><span class="No-Break"><span class="koboSpan" id="kobo.315.1">decision engine:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer137">
<span class="koboSpan" id="kobo.316.1"><img alt="Figure 12.17 – The JBPM deployment success notification" src="image/B21293_12_16.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.317.1">Figure 12.17 – The JBPM deployment success notification</span></p>
<p><span class="koboSpan" id="kobo.318.1">If you care to take a look at the deployment results, you can activate the </span><strong class="bold"><span class="koboSpan" id="kobo.319.1">Menu</span></strong><span class="koboSpan" id="kobo.320.1">/</span><strong class="bold"><span class="koboSpan" id="kobo.321.1">Execution Servers</span></strong><span class="koboSpan" id="kobo.322.1"> command and watch how servers are configured and deployment units are organized on them. </span><span class="koboSpan" id="kobo.322.2">You can then start and stop execution servers from this console, or even </span><span class="No-Break"><span class="koboSpan" id="kobo.323.1">remove deployments:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer138">
<span class="koboSpan" id="kobo.324.1"><img alt="Figure 12.18 – The JBPM servers management interface" src="image/B21293_12_18.0.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.325.1">Figure 12.18 – The JBPM servers management interface</span></p>
<p><span class="koboSpan" id="kobo.326.1">Since everything </span><a id="_idIndexMarker729"/><span class="koboSpan" id="kobo.327.1">is now set up and deployed, we are able to exploit the </span><span class="No-Break"><span class="koboSpan" id="kobo.328.1">b</span><a id="_idTextAnchor466"/><span class="koboSpan" id="kobo.329.1">usiness rules.</span></span></p>
<h2 id="_idParaDest-263"><a id="_idTextAnchor467"/><span class="koboSpan" id="kobo.330.1">Calling the business rule runtime</span></h2>
<p><span class="koboSpan" id="kobo.331.1">Checking </span><a id="_idIndexMarker730"/><span class="koboSpan" id="kobo.332.1">how effective the engine is, is simply a matter of calling a REST API that has been exposed dynamically for us to consume. </span><span class="koboSpan" id="kobo.332.2">In order to do so, and since the engine is (logically) exposed through a </span><strong class="source-inline"><span class="koboSpan" id="kobo.333.1">POST</span></strong><span class="koboSpan" id="kobo.334.1"> verb, we need a tool a bit more advanced than a simple web browser, such as Postman. </span><span class="koboSpan" id="kobo.334.2">To access the API, you will have to use the port number that was associated with the second Docker container we ran – in our example, </span><strong class="source-inline"><span class="koboSpan" id="kobo.335.1">8180</span></strong><span class="koboSpan" id="kobo.336.1">. </span><span class="koboSpan" id="kobo.336.2">The rest of the URL is composed </span><span class="No-Break"><span class="koboSpan" id="kobo.337.1">like this:</span></span></p>
<ul>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.338.1">/kie-server</span></strong><span class="koboSpan" id="kobo.339.1"> corresponds to the application server of the rules execution engine (or </span><strong class="bold"><span class="koboSpan" id="kobo.340.1">BRE</span></strong><span class="koboSpan" id="kobo.341.1"> for </span><strong class="bold"><span class="koboSpan" id="kobo.342.1">Business </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.343.1">Rules Execution</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.344.1">)</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.345.1">/services/rest</span></strong><span class="koboSpan" id="kobo.346.1"> indicates that we will be accessing the </span><span class="No-Break"><span class="koboSpan" id="kobo.347.1">REST APIs</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.348.1">/server/containers</span></strong><span class="koboSpan" id="kobo.349.1"> is linked to the fact that BRE servers are exposed through containers, each deployment unit being separate from </span><span class="No-Break"><span class="koboSpan" id="kobo.350.1">the others</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.351.1">/traffic-violation_1.0.0-SNAPSHOT</span></strong><span class="koboSpan" id="kobo.352.1"> is the identity of the project that we have chosen to deploy in </span><span class="No-Break"><span class="koboSpan" id="kobo.353.1">this unit</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.354.1">/dmn</span></strong><span class="koboSpan" id="kobo.355.1"> corresponds to the resource we are interested in this project, namely the decision </span><span class="No-Break"><span class="koboSpan" id="kobo.356.1">management system</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.357.1">The content of </span><a id="_idIndexMarker731"/><span class="koboSpan" id="kobo.358.1">the body should be adjusted to </span><strong class="source-inline"><span class="koboSpan" id="kobo.359.1">raw</span></strong><span class="koboSpan" id="kobo.360.1">/</span><strong class="source-inline"><span class="koboSpan" id="kobo.361.1">json</span></strong><span class="koboSpan" id="kobo.362.1"> and contain the </span><span class="No-Break"><span class="koboSpan" id="kobo.363.1">following data:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.364.1">
{
    "model-namespace": "https://github.com/kiegroup/drools/kie-dmn/_60B01F4D-E407-43F7-848E-258723B5FAC8",
    "dmn-context": {
        "Driver": {
            "Points": 15
        },
        "Violation": {
            "Type": "speed",
            "Actual Speed": 135,
            "Speed Limit": 100
        }
    }
}</span></pre> <p><strong class="source-inline"><span class="koboSpan" id="kobo.365.1">model-namespace</span></strong><span class="koboSpan" id="kobo.366.1"> corresponds to the unique identifier of the project, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.367.1">dmn-context</span></strong><span class="koboSpan" id="kobo.368.1"> indicates the values that should be fed to the rules engine for execution. </span><span class="koboSpan" id="kobo.368.2">The interface should look like </span><span class="No-Break"><span class="koboSpan" id="kobo.369.1">the following:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer139">
<span class="koboSpan" id="kobo.370.1"><img alt="Figure 12.19 – A sample Postman call" src="image/B21293_12_19.0.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.371.1">Figure 12.19 – A sample Postman call</span></p>
<p><span class="koboSpan" id="kobo.372.1">In order for this to </span><a id="_idIndexMarker732"/><span class="koboSpan" id="kobo.373.1">work, you need to go to the </span><strong class="bold"><span class="koboSpan" id="kobo.374.1">Authorization</span></strong><span class="koboSpan" id="kobo.375.1"> tab, choose the </span><strong class="bold"><span class="koboSpan" id="kobo.376.1">Basic authentication</span></strong><span class="koboSpan" id="kobo.377.1"> mode, and instruct Postman to use </span><strong class="source-inline"><span class="koboSpan" id="kobo.378.1">kieserver</span></strong><span class="koboSpan" id="kobo.379.1"> as the username and </span><strong class="source-inline"><span class="koboSpan" id="kobo.380.1">kieserver1!</span></strong><span class="koboSpan" id="kobo.381.1"> as the password (these are the default values that, of course, would change if working </span><span class="No-Break"><span class="koboSpan" id="kobo.382.1">in production):</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer140">
<span class="koboSpan" id="kobo.383.1"><img alt="Figure 12.20 – Postman authentication settings" src="image/B21293_12_20.0.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.384.1">Figure 12.20 – Postman authentication settings</span></p>
<p><span class="koboSpan" id="kobo.385.1">Finally, after sending</span><a id="_idIndexMarker733"/><span class="koboSpan" id="kobo.386.1"> the message to the server, the complete response is </span><span class="No-Break"><span class="koboSpan" id="kobo.387.1">the following:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.388.1">
{
  "type" : "SUCCESS",
  "msg" : "OK from container 'traffic-violation_1.0.0-SNAPSHOT'",
  "result" : {
    "dmn-evaluation-result" : {
      "messages" : [ ],
      "model-namespace" : "https://github.com/kiegroup/drools/kie-dmn/_A4BCA8B8-CF08-433F-93B2-A2598F19ECFF",
      "model-name" : "Traffic Violation",
      "decision-name" : [ ],
      "dmn-context" : {
        "Violation" : {
          "Type" : "speed",
          "Speed Limit" : 100,
          "Actual Speed" : 115
        },
        "Driver" : {
          "Points" : 15
        },
        "Fine" : {
          "Points" : 3,
          "Amount" : 500
        },
        "Should the driver be suspended?" </span><span class="koboSpan" id="kobo.388.2">: "No"
      },
      "decision-results" : {
        "_4055D956-1C47-479C-B3F4-BAEB61F1C929" : {
          "messages" : [ ],
          "decision-id" : "_4055D956-1C47-479C-B3F4-BAEB61F1C929",
          "decision-name" : "Fine",
          "result" : {
            "Points" : 3,
            "Amount" : 500
          },
          "status" : "SUCCEEDED"
        },
        "_8A408366-D8E9-4626-ABF3-5F69AA01F880" : {
          "messages" : [ ],
          "decision-id" : "_8A408366-D8E9-4626-ABF3-5F69AA01F880",
          "decision-name" : "Should the driver be suspended?",
          "result" : "No",
          "status" : "SUCCEEDED"
        }
      }
    }
  }
}</span></pre> <p><span class="koboSpan" id="kobo.389.1">What interests us in particular is how </span><strong class="source-inline"><span class="koboSpan" id="kobo.390.1">dmn-context</span></strong><span class="koboSpan" id="kobo.391.1"> has been completed, with the results of the </span><a id="_idIndexMarker734"/><span class="koboSpan" id="kobo.392.1">decision. </span><span class="koboSpan" id="kobo.392.2">In our case, the fine will be 3 points and 500 units of money, and the result of the driver’s license suspension decision will be negative. </span><span class="koboSpan" id="kobo.392.3">But change </span><strong class="source-inline"><span class="koboSpan" id="kobo.393.1">Actual Speed</span></strong><span class="koboSpan" id="kobo.394.1"> to </span><strong class="source-inline"><span class="koboSpan" id="kobo.395.1">135</span></strong><span class="koboSpan" id="kobo.396.1"> in the body of the request, send it again, and watch the impact on </span><span class="No-Break"><span class="koboSpan" id="kobo.397.1">the results:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.398.1">
        "Fine" : {
          "Points" : 7,
          "Amount" : 1000
        },
        "Should the driver be suspended?" </span><span class="koboSpan" id="kobo.398.2">: "Yes"</span></pre> <p><span class="koboSpan" id="kobo.399.1">The engine is, thus, ready to be used in any information system that can handle REST APIs (which is any platform on earth, except for a few very exotic exceptions). </span><span class="koboSpan" id="kobo.399.2">Note there is also everything you need inside the JBPM platform to perform tests on the decisions that have been built. </span><span class="koboSpan" id="kobo.399.3">A test with Postman was preferred because it is closer to how the BRE would be exploited by another application, but if you click on the </span><strong class="source-inline"><span class="koboSpan" id="kobo.400.1">Violation Scenarios</span></strong><span class="koboSpan" id="kobo.401.1"> asset, you will be brought to this nice interface, where you can execute preliminary tests in order to make sure everything works fine </span><span class="No-Break"><span class="koboSpan" id="kobo.402.1">before deployment:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer141">
<span class="koboSpan" id="kobo.403.1"><img alt="Figure 12.21 – A JBPM-integrated automatic test interface" src="image/B21293_12_21.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.404.1">Figure 12.21 – A JBPM-integrated automatic test interface</span></p>
<p><span class="koboSpan" id="kobo.405.1">Also, if you want to understand better how to create your own project (which is outside of the scope of this book, where we focus only on how to use existing projects to correctly structure an information system), the best starting point is the code source of the example used previously, which can be found at </span><a href="https://github.com/kiegroup/kie-wb-playground/tree/main/traffic-violation"><span class="koboSpan" id="kobo.406.1">https://github.com/kiegroup/kie-wb-playground/tree/main/traffic-violation</span></a><span class="koboSpan" id="kobo.407.1">. </span><span class="koboSpan" id="kobo.407.2">You can also follow the detailed instructions on how to build this project from the console, as explained </span><span class="No-Break"><span class="koboSpan" id="kobo.408.1">at </span></span><a href="https://docs.jboss.org/drools/release/7.51.0.Final/drools-docs/html_single/#dmn-gs-new-project-creating-proc_getting-started-decision-services"><span class="No-Break"><span class="koboSpan" id="kobo.409.1">https://docs.jboss.org/drools/release/7.51.0.Final/drools-docs/html_single/#dmn-gs-new-project-creating-proc_getting-started-decision-services</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.410.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.411.1">Finally, we will </span><a id="_idIndexMarker735"/><span class="koboSpan" id="kobo.412.1">complete this example with a very simple (thanks to Docker) clean-out procedure (be aware that this will erase all data associated with </span><span class="No-Break"><span class="koboSpan" id="kobo.413.1">the exercise):</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.414.1">
docker rm -fv jbpm-console
docker rm -fv jbpm-bre</span></pre> <p><span class="koboSpan" id="kobo.415.1">Everything should be reverted to the state the test machine was in before creating this example, which leaves us with the conclusion</span><a id="_idTextAnchor468"/><span class="koboSpan" id="kobo.416.1"> of </span><span class="No-Break"><span class="koboSpan" id="kobo.417.1">this chapter.</span></span></p>
<h1 id="_idParaDest-264"><a id="_idTextAnchor469"/><span class="koboSpan" id="kobo.418.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.419.1">In this chapter, we showed what a Business Rules Management System does, how useful it can be in an information system, and how we can implement one, starting with a functional example and demonstrating afterward another example relating to authorizations, which are one of the most used sets of business rules in </span><span class="No-Break"><span class="koboSpan" id="kobo.420.1">software applications.</span></span></p>
<p><span class="koboSpan" id="kobo.421.1">Just like BPMN engines, BRMS engines are not used very often. </span><span class="koboSpan" id="kobo.421.2">In fact, business rules are – in the great majority of cases – implemented in code expressions or compiled into applications. </span><span class="koboSpan" id="kobo.421.3">This is absolutely normal because a BRMS represents an important investment, and implementing such complex applications really needs a strong business case, where business rules change very frequently, they are associated with high regulatory or marketing constraints (such as the necessity to trace all business rules and their changes), there is capacity to simulate the effects of new versions of sets of business rules, and so on. </span><span class="koboSpan" id="kobo.421.4">It is clear, then, that this approach is currently limited to very rare contexts. </span><span class="koboSpan" id="kobo.421.5">Things may, of course, change in the future, with the longed-for industrialization of information system designs, but currently, BPMNs and BRMSs are efforts that are almost </span><span class="No-Break"><span class="koboSpan" id="kobo.422.1">always overkill.</span></span></p>
<p><span class="koboSpan" id="kobo.423.1">And since two of the three parts of the ideal system are not worth using by most organizations, that means that this system remains utopic. </span><span class="koboSpan" id="kobo.423.2">Moreover, even a centralized MDM approach is complicated. </span><span class="koboSpan" id="kobo.423.3">The MDM practices per se are applicable to every business domain, so there is no problem with data referential – they are not very complicated to set up, as we will see in practice in </span><a href="B21293_16.xhtml#_idTextAnchor588"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.424.1">Chapter 16</span></em></span></a><span class="koboSpan" id="kobo.425.1"> and the upcoming chapters and they bring lots of business value and advantages. </span><span class="koboSpan" id="kobo.425.2">However, the ideal system aims for a generic MDM, dynamically adjusting to every entity in the business context of an application. </span><span class="koboSpan" id="kobo.425.3">This additional sophistication is also out of context for now, although static code generation for data referential is becoming a viable option, as will be shown at the end of </span><a href="B21293_19.xhtml#_idTextAnchor634"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.426.1">Chapter 19</span></em></span></a><span class="No-Break"><span class="koboSpan" id="kobo.427.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.428.1">In addition, we have shown that the three responsibilities of an ideal information system are, ultimately, quite interrelated with </span><span class="No-Break"><span class="koboSpan" id="kobo.429.1">each other:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.430.1">MDM uses business rules in its validation </span><span class="No-Break"><span class="koboSpan" id="kobo.431.1">of data</span></span></li>
<li><span class="koboSpan" id="kobo.432.1">A BRMS needs data from MDM to apply business rules and decide their </span><span class="No-Break"><span class="koboSpan" id="kobo.433.1">output value</span></span></li>
<li><span class="koboSpan" id="kobo.434.1">A BPMN serves mainly as a collector of data to feed MDM, while also consuming data </span><span class="No-Break"><span class="koboSpan" id="kobo.435.1">from MDM</span></span></li>
<li><span class="koboSpan" id="kobo.436.1">A BPMN also uses business rules to know where to go in the different gateways (and sometimes to calculate some additional data during a </span><span class="No-Break"><span class="koboSpan" id="kobo.437.1">given task)</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.438.1">All this proves that, technically, this assembly of three generic servers for MDM, BPM, and BRMS is not so feasible, and neither achieves a perfect decoupling. </span><span class="koboSpan" id="kobo.438.2">So, why did we bother in </span><a href="B21293_05.xhtml#_idTextAnchor164"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.439.1">Chapter 5</span></em></span></a><span class="koboSpan" id="kobo.440.1"> and the last three chapters to discuss such an ideal system? </span><span class="koboSpan" id="kobo.440.2">Again, the answer lies in the business/IT alignment. </span><span class="koboSpan" id="kobo.440.3">The ideal system is not something that can be realized in practice in information systems today (and certainly for at least a few more decades), but it has the great advantage of forcing an architect to think in terms of three generic, always applicable, functional responsibilities. </span><span class="koboSpan" id="kobo.440.4">Even if you use a unique software application, knowing how to separate the data management, the business rules management, and the business process execution provides a great step toward decoupling your information system (which is not achieved at all with </span><em class="italic"><span class="koboSpan" id="kobo.441.1">n</span></em><span class="koboSpan" id="kobo.442.1">-tier architecture, for example). </span><span class="koboSpan" id="kobo.442.2">As you will see in the upcoming chapters, constructing an information system with these principles in mind will help us achieve a very complex goal, which is to be able to modify important functional rules and behaviors very easily, in most cases without any significant impact on </span><span class="No-Break"><span class="koboSpan" id="kobo.443.1">the implementation.</span></span></p>
<p><span class="koboSpan" id="kobo.444.1">In the next chapter, as explained in the introduction, we will show a particular use case – yet very important application – of business rules management, which is using rules to determine and enforce authorization in a software application. </span><span class="koboSpan" id="kobo.444.2">Although we have shown a few examples in this chapter, the most complete description of how to use a BRMS will happen in the next chapter, by applying dedicated authorization management policies to our good old sample </span><span class="No-Break"><span class="koboSpan" id="kobo.445.1">information system.</span></span></p>
</div>
</body></html>