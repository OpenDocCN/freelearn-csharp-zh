<html xml:lang="en-US" xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops">
<head>
<meta charset="utf-8"/>
<meta content="packt" name="generator"/>
<title>1 Introduction</title>
<link href="../styles/stylesheet1.css" rel="stylesheet" type="text/css"/>
<link href="../styles/stylesheet2.css" rel="stylesheet" type="text/css"/>
<!-- kobo-style -->
<style id="koboSpanStyle" type="text/css" xmlns="http://www.w3.org/1999/xhtml">.koboSpan { -webkit-text-combine: inherit; }</style>
</head>
<body>
<section class="level1 pkt" data-number="2" id="introduction">
<h1 data-number="2"><span class="koboSpan" id="kobo.1.1" xmlns="http://www.w3.org/1999/xhtml">1 Introduction</span></h1>
<section class="level2" data-number="2.1" id="before-you-begin-join-our-book-community-on-discord">
<h2 data-number="2.1"><span class="koboSpan" id="kobo.2.1" xmlns="http://www.w3.org/1999/xhtml">Before you begin: Join our book community on Discord</span></h2>
<p><span class="koboSpan" id="kobo.3.1" xmlns="http://www.w3.org/1999/xhtml">Give your feedback straight to the author himself and chat to other early readers on our Discord server (find the "architecting-aspnet-core-apps-3e" channel under EARLY ACCESS SUBSCRIPTION).</span></p>
<p><a href="https://packt.link/EarlyAccess"><span class="koboSpan" id="kobo.4.1" xmlns="http://www.w3.org/1999/xhtml">https://packt.link/EarlyAccess</span></a></p>
<p><span class="koboSpan" id="kobo.5.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Qr code Description automatically generated" src="../media/file0.png" style="width:10em"/></span></p>
<p><span class="koboSpan" id="kobo.6.1" xmlns="http://www.w3.org/1999/xhtml">The goal of this book is not to create yet another design pattern book; instead, the chapters are organized according to scale and topic, allowing you to start small with a solid foundation and build slowly upon it, just like you would build a program.Instead of a guide covering a few ways of applying a design pattern, we will explore the thought processes behind the systems we are designing from a software engineer’s point of view.This is not a magic recipe book; from experience, there is no magical recipe when designing software; there are only your logic, knowledge, experience, and analytical skills. </span><span class="koboSpan" id="kobo.6.2" xmlns="http://www.w3.org/1999/xhtml">Let’s define “experience” as </span><em><span class="koboSpan" id="kobo.7.1" xmlns="http://www.w3.org/1999/xhtml">your past successes and failures</span></em><span class="koboSpan" id="kobo.8.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.8.2" xmlns="http://www.w3.org/1999/xhtml">And don’t worry, you will fail during your career, but don’t get discouraged by it. </span><span class="koboSpan" id="kobo.8.3" xmlns="http://www.w3.org/1999/xhtml">The faster you fail, the faster you can recover and learn, leading to successful products. </span><span class="koboSpan" id="kobo.8.4" xmlns="http://www.w3.org/1999/xhtml">Many techniques covered in this book should help you achieve success. </span><span class="koboSpan" id="kobo.8.5" xmlns="http://www.w3.org/1999/xhtml">Everyone has failed and made mistakes; you aren’t the first and certainly won’t be the last. </span><span class="koboSpan" id="kobo.8.6" xmlns="http://www.w3.org/1999/xhtml">To paraphrase a well-known saying by Roosevelt: </span><em><span class="koboSpan" id="kobo.9.1" xmlns="http://www.w3.org/1999/xhtml">the people that never fail are the ones who never do anything</span></em><span class="koboSpan" id="kobo.10.1" xmlns="http://www.w3.org/1999/xhtml">.At a high level:</span></p>
<ul>
<li><span class="koboSpan" id="kobo.11.1" xmlns="http://www.w3.org/1999/xhtml">This book explores basic patterns, unit testing, architectural principles, and some ASP.NET Core mechanisms.</span></li>
<li><span class="koboSpan" id="kobo.12.1" xmlns="http://www.w3.org/1999/xhtml">Then, we move up to the component scale, exploring patterns oriented toward small chunks of software and individual units.</span></li>
<li><span class="koboSpan" id="kobo.13.1" xmlns="http://www.w3.org/1999/xhtml">After that, we move to application-scale patterns and techniques, exploring ways to structure an application.</span></li>
<li><span class="koboSpan" id="kobo.14.1" xmlns="http://www.w3.org/1999/xhtml">Some subjects covered throughout the book could have a book of their own, so after this book, you should have plenty of ideas about where to continue your journey into software architecture.</span></li>
</ul>
<p><span class="koboSpan" id="kobo.15.1" xmlns="http://www.w3.org/1999/xhtml">Here are a few pointers about this book that are worth mentioning:</span></p>
<ul>
<li><span class="koboSpan" id="kobo.16.1" xmlns="http://www.w3.org/1999/xhtml">The chapters are organized to start with small-scale patterns and then progress to higher-level ones, making the learning curve easier.</span></li>
<li><span class="koboSpan" id="kobo.17.1" xmlns="http://www.w3.org/1999/xhtml">Instead of giving you a recipe, the book focuses on the thinking behind things and shows the evolution of some techniques to help you understand why the shift happened.</span></li>
<li><span class="koboSpan" id="kobo.18.1" xmlns="http://www.w3.org/1999/xhtml">Many use cases combine more than one design pattern to illustrate alternate usage so you can understand and use the patterns efficiently. </span><span class="koboSpan" id="kobo.18.2" xmlns="http://www.w3.org/1999/xhtml">This also shows that design patterns are not beasts to tame but tools to use, manipulate, and bend to your will.</span></li>
<li><span class="koboSpan" id="kobo.19.1" xmlns="http://www.w3.org/1999/xhtml">As in real life, no textbook solution can solve all our problems; real problems are always more complicated than what’s explained in textbooks. </span><span class="koboSpan" id="kobo.19.2" xmlns="http://www.w3.org/1999/xhtml">In this book, I aim to show you how to mix and match patterns to think “architecture” instead of giving you step-by-step instructions to reproduce.</span></li>
</ul>
<p><span class="koboSpan" id="kobo.20.1" xmlns="http://www.w3.org/1999/xhtml">The rest of the introduction chapter introduces the concepts we explore throughout the book, including refreshers on a few notions. </span><span class="koboSpan" id="kobo.20.2" xmlns="http://www.w3.org/1999/xhtml">We also touch on .NET, its tooling, and some technical requirements.In this chapter, we cover the following topics:</span></p>
<ul>
<li><span class="koboSpan" id="kobo.21.1" xmlns="http://www.w3.org/1999/xhtml">What is a design pattern?</span></li>
<li><span class="koboSpan" id="kobo.22.1" xmlns="http://www.w3.org/1999/xhtml">Anti-patterns and code smell.</span></li>
<li><span class="koboSpan" id="kobo.23.1" xmlns="http://www.w3.org/1999/xhtml">Understanding the web – request/response.</span></li>
<li><span class="koboSpan" id="kobo.24.1" xmlns="http://www.w3.org/1999/xhtml">Getting started with .NET.</span></li>
</ul>
</section>
<section class="level2" data-number="2.2" id="what-is-a-design-pattern">
<h2 data-number="2.2"><span class="koboSpan" id="kobo.25.1" xmlns="http://www.w3.org/1999/xhtml">What is a design pattern?</span></h2>
<p><span class="koboSpan" id="kobo.26.1" xmlns="http://www.w3.org/1999/xhtml">Since you just purchased a book about design patterns, I guess you have some idea of what design patterns are, but let’s make sure that we are on the same page.</span><strong><span class="koboSpan" id="kobo.27.1" xmlns="http://www.w3.org/1999/xhtml">Abstract definition</span></strong><span class="koboSpan" id="kobo.28.1" xmlns="http://www.w3.org/1999/xhtml">: A design pattern is a proven technique that we can use to solve a specific problem.In this book, we apply different patterns to solve various problems and leverage some open-source tools to go further, faster! </span><span class="koboSpan" id="kobo.28.2" xmlns="http://www.w3.org/1999/xhtml">Abstract definitions make people sound smart, but understanding concepts requires more practice, and there is no better way to learn than by experimenting with something, and design patterns are no different.If that definition does not make sense to you yet, don’t worry. </span><span class="koboSpan" id="kobo.28.3" xmlns="http://www.w3.org/1999/xhtml">You should have enough information by the end of the book to correlate the multiple practical examples and explanations with that definition, making it crystal clear.I like to compare programming to playing with LEGO® because what you have to do is very similar: put small pieces together to create something bigger. </span><span class="koboSpan" id="kobo.28.4" xmlns="http://www.w3.org/1999/xhtml">Therefore, if you lack imagination or skills, possibly because you are too young, your castle might not look as good as someone with more experience. </span><span class="koboSpan" id="kobo.28.5" xmlns="http://www.w3.org/1999/xhtml">With that analogy in mind, a design pattern is a plan to assemble a solution that fits one or more scenarios, like the tower of a castle. </span><span class="koboSpan" id="kobo.28.6" xmlns="http://www.w3.org/1999/xhtml">Once you designed a single tower, you can build multiple by following the same steps. </span><span class="koboSpan" id="kobo.28.7" xmlns="http://www.w3.org/1999/xhtml">Design patterns act as that tower plan and give you the tools to assemble reliable pieces to improve your masterpiece (program).However, instead of snapping LEGO® blocks together, you nest code blocks and interweave objects in a virtual environment!Before going into more detail, well-thought-out applications of design patterns should improve your application designs. </span><span class="koboSpan" id="kobo.28.8" xmlns="http://www.w3.org/1999/xhtml">That is true whether designing a small component or a whole system. </span><span class="koboSpan" id="kobo.28.9" xmlns="http://www.w3.org/1999/xhtml">However, be careful: throwing patterns into the mix just to use them can lead to the opposite result: over-engineering. </span><span class="koboSpan" id="kobo.28.10" xmlns="http://www.w3.org/1999/xhtml">Instead, aim to write the least amount of readable code that solves your issue or automates your process.As we have briefly mentioned, design patterns apply to different software engineering levels, and in this book, we start small and grow to a cloud-scale! </span><span class="koboSpan" id="kobo.28.11" xmlns="http://www.w3.org/1999/xhtml">We follow a smooth learning curve, starting with simpler patterns and code samples that bend good practices to focus on the patterns—finally ending with more advanced topics and good practices.Of course, some subjects are overviews more than deep dives, like automated testing, because no one can fit it all in a single book. </span><span class="koboSpan" id="kobo.28.12" xmlns="http://www.w3.org/1999/xhtml">Nonetheless, I’ve done my best to give you as much information about architecture-related subjects as possible to ensure the proper foundations are in place for you to get as much as possible out of the more advanced topics, and I sincerely hope you’ll find this book a helpful and enjoyable read.Let’s start with the opposite of design patterns because it is essential to identify wrong ways of doing things to avoid making those mistakes or to correct them when you see them. </span><span class="koboSpan" id="kobo.28.13" xmlns="http://www.w3.org/1999/xhtml">Of course, knowing the right way to overcome specific problems using design patterns is also crucial.</span></p>
</section>
<section class="level2" data-number="2.3" id="anti-patterns-and-code-smells">
<h2 data-number="2.3"><span class="koboSpan" id="kobo.29.1" xmlns="http://www.w3.org/1999/xhtml">Anti-patterns and code smells</span></h2>
<p><span class="koboSpan" id="kobo.30.1" xmlns="http://www.w3.org/1999/xhtml">Anti-patterns and code smells are bad architectural practices or tips about possible bad design. </span><span class="koboSpan" id="kobo.30.2" xmlns="http://www.w3.org/1999/xhtml">Learning about best practices is as important as learning about bad ones, which is where we start. </span><span class="koboSpan" id="kobo.30.3" xmlns="http://www.w3.org/1999/xhtml">The book highlights multiple anti-patterns and code smells to help you get started. </span><span class="koboSpan" id="kobo.30.4" xmlns="http://www.w3.org/1999/xhtml">Next, we briefly explore the first few.</span></p>
<section class="level3" data-number="2.3.1" id="anti-patterns">
<h3 data-number="2.3.1"><span class="koboSpan" id="kobo.31.1" xmlns="http://www.w3.org/1999/xhtml">Anti-patterns</span></h3>
<p><span class="koboSpan" id="kobo.32.1" xmlns="http://www.w3.org/1999/xhtml">An </span><strong><span class="koboSpan" id="kobo.33.1" xmlns="http://www.w3.org/1999/xhtml">anti-pattern</span></strong><span class="koboSpan" id="kobo.34.1" xmlns="http://www.w3.org/1999/xhtml"> is the opposite of a design pattern: it is a proven flawed technique that will most likely cause you trouble and cost you time and money (and probably give you headaches).An anti-pattern is a pattern that seems a good idea and seems to be the solution you were looking for, but it causes more harm than good. </span><span class="koboSpan" id="kobo.34.2" xmlns="http://www.w3.org/1999/xhtml">Some anti-patterns started as legitimate design patterns and were labelled anti-patterns later. </span><span class="koboSpan" id="kobo.34.3" xmlns="http://www.w3.org/1999/xhtml">Sometimes, it is a matter of opinion, and sometimes the classification can be influenced by the programming language or technologies.Let’s look at an example next. </span><span class="koboSpan" id="kobo.34.4" xmlns="http://www.w3.org/1999/xhtml">We will explore some other anti-patterns throughout the book.</span></p>
<section class="level4" data-number="2.3.1.1" id="anti-pattern-god-class">
<h4 data-number="2.3.1.1"><span class="koboSpan" id="kobo.35.1" xmlns="http://www.w3.org/1999/xhtml">Anti-pattern – God Class</span></h4>
<p><span class="koboSpan" id="kobo.36.1" xmlns="http://www.w3.org/1999/xhtml">A </span><strong><span class="koboSpan" id="kobo.37.1" xmlns="http://www.w3.org/1999/xhtml">God class</span></strong><span class="koboSpan" id="kobo.38.1" xmlns="http://www.w3.org/1999/xhtml"> is a class that handles too many things. </span><span class="koboSpan" id="kobo.38.2" xmlns="http://www.w3.org/1999/xhtml">Typically, this class serves as a central entity which many other classes inherit or use within the application it is the class that knows and manages everything in the system; it is </span><em><span class="koboSpan" id="kobo.39.1" xmlns="http://www.w3.org/1999/xhtml">the</span></em><span class="koboSpan" id="kobo.40.1" xmlns="http://www.w3.org/1999/xhtml"> class. </span><span class="koboSpan" id="kobo.40.2" xmlns="http://www.w3.org/1999/xhtml">On the other hand, it is also the class that nobody wants to update, which breaks the application every time somebody touches it: </span><strong><span class="koboSpan" id="kobo.41.1" xmlns="http://www.w3.org/1999/xhtml">it is an evil class</span></strong><span class="koboSpan" id="kobo.42.1" xmlns="http://www.w3.org/1999/xhtml">!The best way to fix this is to segregate responsibilities and allocate them to multiple classes rather than concentrating them in a single class. </span><span class="koboSpan" id="kobo.42.2" xmlns="http://www.w3.org/1999/xhtml">We look at how to split responsibilities throughout the book, which helps create more robust software.If you have a personal project with a </span><em><span class="koboSpan" id="kobo.43.1" xmlns="http://www.w3.org/1999/xhtml">God class</span></em><span class="koboSpan" id="kobo.44.1" xmlns="http://www.w3.org/1999/xhtml"> at its core, start by reading the book and then try to apply the principles and patterns you learn to divide that class into multiple smaller classes that interact together. </span><span class="koboSpan" id="kobo.44.2" xmlns="http://www.w3.org/1999/xhtml">Try to organize those new classes into cohesive units, modules, or assemblies.To help fix God classes, we dive into architectural principles in </span><em><span class="koboSpan" id="kobo.45.1" xmlns="http://www.w3.org/1999/xhtml">Chapter 3</span></em><span class="koboSpan" id="kobo.46.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.47.1" xmlns="http://www.w3.org/1999/xhtml">Architectural Principles</span></em><span class="koboSpan" id="kobo.48.1" xmlns="http://www.w3.org/1999/xhtml">, opening the way to concepts such as responsibility segregation.</span></p>
</section>
</section>
<section class="level3" data-number="2.3.2" id="code-smells">
<h3 data-number="2.3.2"><span class="koboSpan" id="kobo.49.1" xmlns="http://www.w3.org/1999/xhtml">Code smells</span></h3>
<p><span class="koboSpan" id="kobo.50.1" xmlns="http://www.w3.org/1999/xhtml">A </span><strong><span class="koboSpan" id="kobo.51.1" xmlns="http://www.w3.org/1999/xhtml">code smell</span></strong><span class="koboSpan" id="kobo.52.1" xmlns="http://www.w3.org/1999/xhtml"> is an indicator of a possible problem. </span><span class="koboSpan" id="kobo.52.2" xmlns="http://www.w3.org/1999/xhtml">It points to areas of your design that could benefit from a redesign. </span><span class="koboSpan" id="kobo.52.3" xmlns="http://www.w3.org/1999/xhtml">By “code smell,” we mean “code that stinks” or “code that does not smell right.”It is important to note that a code smell only indicates the possibility of a problem; it does not mean a problem exists. </span><span class="koboSpan" id="kobo.52.4" xmlns="http://www.w3.org/1999/xhtml">Code smells are usually good indicators, so it is worth analyzing your software’s “smelly” parts.An excellent example is when a method requires many comments to explain its logic. </span><span class="koboSpan" id="kobo.52.5" xmlns="http://www.w3.org/1999/xhtml">That often means that the code could be split into smaller methods with proper names, leading to more readable code and allowing you to get rid of those pesky comments.Another note about comments is that they don’t evolve, so what often happens is that the code described by a comment changes, but the comment remains the same. </span><span class="koboSpan" id="kobo.52.6" xmlns="http://www.w3.org/1999/xhtml">That leaves a false or obsolete description of a block of code that can lead a developer astray.The same is also true with method names. </span><span class="koboSpan" id="kobo.52.7" xmlns="http://www.w3.org/1999/xhtml">Sometimes, the method’s name and body tell a different story, leading to the same issues. </span><span class="koboSpan" id="kobo.52.8" xmlns="http://www.w3.org/1999/xhtml">Nevertheless, this happens less often than orphan or obsolete comments since programmers tend to read and write code better than spoken language comments. </span><span class="koboSpan" id="kobo.52.9" xmlns="http://www.w3.org/1999/xhtml">Nonetheless, keep that in mind when reading, writing, or reviewing code.</span></p>
<section class="level4" data-number="2.3.2.1" id="code-smell-control-freak">
<h4 data-number="2.3.2.1"><span class="koboSpan" id="kobo.53.1" xmlns="http://www.w3.org/1999/xhtml">Code smell – Control Freak</span></h4>
<p><span class="koboSpan" id="kobo.54.1" xmlns="http://www.w3.org/1999/xhtml">An excellent example of a code smell is using the </span><code><span class="koboSpan" id="kobo.55.1" xmlns="http://www.w3.org/1999/xhtml">new</span></code><span class="koboSpan" id="kobo.56.1" xmlns="http://www.w3.org/1999/xhtml"> keyword. </span><span class="koboSpan" id="kobo.56.2" xmlns="http://www.w3.org/1999/xhtml">This indicates a hardcoded dependency where the creator controls the new object and its lifetime. </span><span class="koboSpan" id="kobo.56.3" xmlns="http://www.w3.org/1999/xhtml">This is also known as the </span><strong><span class="koboSpan" id="kobo.57.1" xmlns="http://www.w3.org/1999/xhtml">Control Freak anti-pattern</span></strong><span class="koboSpan" id="kobo.58.1" xmlns="http://www.w3.org/1999/xhtml">, but I prefer to box it as a code smell instead of an anti-pattern since the </span><code><span class="koboSpan" id="kobo.59.1" xmlns="http://www.w3.org/1999/xhtml">new</span></code><span class="koboSpan" id="kobo.60.1" xmlns="http://www.w3.org/1999/xhtml"> keyword is not intrinsically wrong.At this point, you may be wondering how it is possible not to use the </span><code><span class="koboSpan" id="kobo.61.1" xmlns="http://www.w3.org/1999/xhtml">new</span></code><span class="koboSpan" id="kobo.62.1" xmlns="http://www.w3.org/1999/xhtml"> keyword in object-oriented programming, but rest assured, we will cover that and expand on the control freak code smell in </span><em><span class="koboSpan" id="kobo.63.1" xmlns="http://www.w3.org/1999/xhtml">Chapter 7</span></em><span class="koboSpan" id="kobo.64.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.65.1" xmlns="http://www.w3.org/1999/xhtml">Deep Dive into Dependency Injection</span></em><span class="koboSpan" id="kobo.66.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</section>
<section class="level4" data-number="2.3.2.2" id="code-smell-long-methods">
<h4 data-number="2.3.2.2"><span class="koboSpan" id="kobo.67.1" xmlns="http://www.w3.org/1999/xhtml">Code smell – Long Methods</span></h4>
<p><span class="koboSpan" id="kobo.68.1" xmlns="http://www.w3.org/1999/xhtml">The </span><strong><span class="koboSpan" id="kobo.69.1" xmlns="http://www.w3.org/1999/xhtml">long methods</span></strong><span class="koboSpan" id="kobo.70.1" xmlns="http://www.w3.org/1999/xhtml"> code smell is when a method extends to more than 10 to 15 lines of code. </span><span class="koboSpan" id="kobo.70.2" xmlns="http://www.w3.org/1999/xhtml">That is a good indicator that you should think about that method differently. </span><span class="koboSpan" id="kobo.70.3" xmlns="http://www.w3.org/1999/xhtml">Having comments that separate multiple code blocks is a good indicator of a method that may be too long.Here are a few examples of what the case might be:</span></p>
<ul>
<li><span class="koboSpan" id="kobo.71.1" xmlns="http://www.w3.org/1999/xhtml">The method contains complex logic intertwined in multiple conditional statements.</span></li>
<li><span class="koboSpan" id="kobo.72.1" xmlns="http://www.w3.org/1999/xhtml">The method contains a big </span><code><span class="koboSpan" id="kobo.73.1" xmlns="http://www.w3.org/1999/xhtml">switch</span></code><span class="koboSpan" id="kobo.74.1" xmlns="http://www.w3.org/1999/xhtml"> block.</span></li>
<li><span class="koboSpan" id="kobo.75.1" xmlns="http://www.w3.org/1999/xhtml">The method does too many things.</span></li>
<li><span class="koboSpan" id="kobo.76.1" xmlns="http://www.w3.org/1999/xhtml">The method contains duplications of code.</span></li>
</ul>
<p><span class="koboSpan" id="kobo.77.1" xmlns="http://www.w3.org/1999/xhtml">To fix this, you could do the following:</span></p>
<ul>
<li><span class="koboSpan" id="kobo.78.1" xmlns="http://www.w3.org/1999/xhtml">Extract one or more private methods.</span></li>
<li><span class="koboSpan" id="kobo.79.1" xmlns="http://www.w3.org/1999/xhtml">Extract some code to new classes.</span></li>
<li><span class="koboSpan" id="kobo.80.1" xmlns="http://www.w3.org/1999/xhtml">Reuse the code from external classes.</span></li>
<li><span class="koboSpan" id="kobo.81.1" xmlns="http://www.w3.org/1999/xhtml">If you have a lot of conditional statements or a huge </span><code><span class="koboSpan" id="kobo.82.1" xmlns="http://www.w3.org/1999/xhtml">switch</span></code><span class="koboSpan" id="kobo.83.1" xmlns="http://www.w3.org/1999/xhtml"> block, you could leverage a design pattern such as the Chain of Responsibility, or CQRS, which you will learn about in </span><em><span class="koboSpan" id="kobo.84.1" xmlns="http://www.w3.org/1999/xhtml">Chapter 10</span></em><span class="koboSpan" id="kobo.85.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.86.1" xmlns="http://www.w3.org/1999/xhtml">Behavioral Patterns</span></em><span class="koboSpan" id="kobo.87.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><em><span class="koboSpan" id="kobo.88.1" xmlns="http://www.w3.org/1999/xhtml">Chapter 14</span></em><span class="koboSpan" id="kobo.89.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.90.1" xmlns="http://www.w3.org/1999/xhtml">Mediator and CQRS Design Patterns</span></em><span class="koboSpan" id="kobo.91.1" xmlns="http://www.w3.org/1999/xhtml">.</span></li>
</ul>
<p><span class="koboSpan" id="kobo.92.1" xmlns="http://www.w3.org/1999/xhtml">Usually, each problem has one or more solutions; you need to spot the problem and then find, choose, and implement one of the solutions. </span><span class="koboSpan" id="kobo.92.2" xmlns="http://www.w3.org/1999/xhtml">Let’s be clear: a method containing 16 lines does not necessarily need refactoring; it could be OK. </span><span class="koboSpan" id="kobo.92.3" xmlns="http://www.w3.org/1999/xhtml">Remember that a code smell indicates that there </span><em><span class="koboSpan" id="kobo.93.1" xmlns="http://www.w3.org/1999/xhtml">might</span></em><span class="koboSpan" id="kobo.94.1" xmlns="http://www.w3.org/1999/xhtml"> be a problem, not that there necessarily </span><em><span class="koboSpan" id="kobo.95.1" xmlns="http://www.w3.org/1999/xhtml">is</span></em><span class="koboSpan" id="kobo.96.1" xmlns="http://www.w3.org/1999/xhtml"> one—apply common sense.</span></p>
</section>
</section>
</section>
<section class="level2" data-number="2.4" id="understanding-the-web-requestresponse">
<h2 data-number="2.4"><span class="koboSpan" id="kobo.97.1" xmlns="http://www.w3.org/1999/xhtml">Understanding the web – request/response</span></h2>
<p><span class="koboSpan" id="kobo.98.1" xmlns="http://www.w3.org/1999/xhtml">Before going any further, it is imperative to understand the basic concept of the web. </span><span class="koboSpan" id="kobo.98.2" xmlns="http://www.w3.org/1999/xhtml">The idea behind HTTP 1.X is that a client sends an HTTP request to a server, and then the server responds to that client. </span><span class="koboSpan" id="kobo.98.3" xmlns="http://www.w3.org/1999/xhtml">That can sound trivial if you have web development experience. </span><span class="koboSpan" id="kobo.98.4" xmlns="http://www.w3.org/1999/xhtml">However, it is one of the most important web programming concepts, irrespective of whether you are building web APIs, websites, or complex cloud applications.Let’s reduce an HTTP request lifetime to the following:</span></p>
<ol>
<li><span class="koboSpan" id="kobo.99.1" xmlns="http://www.w3.org/1999/xhtml">The communication starts.</span></li>
<li><span class="koboSpan" id="kobo.100.1" xmlns="http://www.w3.org/1999/xhtml">The client sends a request to the server.</span></li>
<li><span class="koboSpan" id="kobo.101.1" xmlns="http://www.w3.org/1999/xhtml">The server receives the request.</span></li>
<li><span class="koboSpan" id="kobo.102.1" xmlns="http://www.w3.org/1999/xhtml">The server does something with the request, like executing code/logic.</span></li>
<li><span class="koboSpan" id="kobo.103.1" xmlns="http://www.w3.org/1999/xhtml">The server responds to the client.</span></li>
<li><span class="koboSpan" id="kobo.104.1" xmlns="http://www.w3.org/1999/xhtml">The communication ends.</span></li>
</ol>
<p><span class="koboSpan" id="kobo.105.1" xmlns="http://www.w3.org/1999/xhtml">After that cycle, the server is no longer aware of the client. </span><span class="koboSpan" id="kobo.105.2" xmlns="http://www.w3.org/1999/xhtml">Moreover, if the client sends another request, the server is unaware that it responded to a request earlier for that same client because </span><strong><span class="koboSpan" id="kobo.106.1" xmlns="http://www.w3.org/1999/xhtml">HTTP is stateless</span></strong><span class="koboSpan" id="kobo.107.1" xmlns="http://www.w3.org/1999/xhtml">.There are mechanisms for creating a sense of persistence between requests for the server to be “aware” of its clients. </span><span class="koboSpan" id="kobo.107.2" xmlns="http://www.w3.org/1999/xhtml">The most well-known of these is cookies.If we dig deeper, an HTTP request comprises a header and an optional body. </span><span class="koboSpan" id="kobo.107.3" xmlns="http://www.w3.org/1999/xhtml">Then, requests are sent using a specific method. </span><span class="koboSpan" id="kobo.107.4" xmlns="http://www.w3.org/1999/xhtml">The most common HTTP methods are </span><code><span class="koboSpan" id="kobo.108.1" xmlns="http://www.w3.org/1999/xhtml">GET</span></code><span class="koboSpan" id="kobo.109.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><code><span class="koboSpan" id="kobo.110.1" xmlns="http://www.w3.org/1999/xhtml">POST</span></code><span class="koboSpan" id="kobo.111.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.111.2" xmlns="http://www.w3.org/1999/xhtml">On top of those, extensively used by web APIs, we can add </span><code><span class="koboSpan" id="kobo.112.1" xmlns="http://www.w3.org/1999/xhtml">PUT</span></code><span class="koboSpan" id="kobo.113.1" xmlns="http://www.w3.org/1999/xhtml">, </span><code><span class="koboSpan" id="kobo.114.1" xmlns="http://www.w3.org/1999/xhtml">DELETE</span></code><span class="koboSpan" id="kobo.115.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><code><span class="koboSpan" id="kobo.116.1" xmlns="http://www.w3.org/1999/xhtml">PATCH</span></code><span class="koboSpan" id="kobo.117.1" xmlns="http://www.w3.org/1999/xhtml"> to that list.Although not every HTTP method accepts a body, can respond with a body, or should be idempotent, here is a quick reference table:</span></p>
<table>
<tbody>
<tr class="odd">
<td><strong><span class="koboSpan" id="kobo.118.1" xmlns="http://www.w3.org/1999/xhtml">Method</span></strong></td>
<td><strong><span class="koboSpan" id="kobo.119.1" xmlns="http://www.w3.org/1999/xhtml">Request has body</span></strong></td>
<td><strong><span class="koboSpan" id="kobo.120.1" xmlns="http://www.w3.org/1999/xhtml">Response has body</span></strong></td>
<td><strong><span class="koboSpan" id="kobo.121.1" xmlns="http://www.w3.org/1999/xhtml">Idempotent</span></strong></td>
</tr>
<tr class="even">
<td><code><span class="koboSpan" id="kobo.122.1" xmlns="http://www.w3.org/1999/xhtml">GET</span></code></td>
<td><span class="koboSpan" id="kobo.123.1" xmlns="http://www.w3.org/1999/xhtml">No*</span></td>
<td><span class="koboSpan" id="kobo.124.1" xmlns="http://www.w3.org/1999/xhtml">Yes</span></td>
<td><span class="koboSpan" id="kobo.125.1" xmlns="http://www.w3.org/1999/xhtml">Yes</span></td>
</tr>
<tr class="odd">
<td><code><span class="koboSpan" id="kobo.126.1" xmlns="http://www.w3.org/1999/xhtml">POST</span></code></td>
<td><span class="koboSpan" id="kobo.127.1" xmlns="http://www.w3.org/1999/xhtml">Yes</span></td>
<td><span class="koboSpan" id="kobo.128.1" xmlns="http://www.w3.org/1999/xhtml">Yes</span></td>
<td><span class="koboSpan" id="kobo.129.1" xmlns="http://www.w3.org/1999/xhtml">No</span></td>
</tr>
<tr class="even">
<td><code><span class="koboSpan" id="kobo.130.1" xmlns="http://www.w3.org/1999/xhtml">PUT</span></code></td>
<td><span class="koboSpan" id="kobo.131.1" xmlns="http://www.w3.org/1999/xhtml">Yes</span></td>
<td><span class="koboSpan" id="kobo.132.1" xmlns="http://www.w3.org/1999/xhtml">No</span></td>
<td><span class="koboSpan" id="kobo.133.1" xmlns="http://www.w3.org/1999/xhtml">Yes</span></td>
</tr>
<tr class="odd">
<td><code><span class="koboSpan" id="kobo.134.1" xmlns="http://www.w3.org/1999/xhtml">PATCH</span></code></td>
<td><span class="koboSpan" id="kobo.135.1" xmlns="http://www.w3.org/1999/xhtml">Yes</span></td>
<td><span class="koboSpan" id="kobo.136.1" xmlns="http://www.w3.org/1999/xhtml">Yes</span></td>
<td><span class="koboSpan" id="kobo.137.1" xmlns="http://www.w3.org/1999/xhtml">No</span></td>
</tr>
<tr class="even">
<td><code><span class="koboSpan" id="kobo.138.1" xmlns="http://www.w3.org/1999/xhtml">DELETE</span></code></td>
<td><span class="koboSpan" id="kobo.139.1" xmlns="http://www.w3.org/1999/xhtml">May</span></td>
<td><span class="koboSpan" id="kobo.140.1" xmlns="http://www.w3.org/1999/xhtml">May</span></td>
<td><span class="koboSpan" id="kobo.141.1" xmlns="http://www.w3.org/1999/xhtml">Yes</span></td>
</tr>
</tbody>
</table>
<blockquote>
<p><span class="koboSpan" id="kobo.142.1" xmlns="http://www.w3.org/1999/xhtml">* Sending a body with a </span><code><span class="koboSpan" id="kobo.143.1" xmlns="http://www.w3.org/1999/xhtml">GET</span></code><span class="koboSpan" id="kobo.144.1" xmlns="http://www.w3.org/1999/xhtml"> request is not forbidden by the HTTP specifications, but the semantics of such a request are not defined either. </span><span class="koboSpan" id="kobo.144.2" xmlns="http://www.w3.org/1999/xhtml">It is best to avoid sending </span><code><span class="koboSpan" id="kobo.145.1" xmlns="http://www.w3.org/1999/xhtml">GET</span></code><span class="koboSpan" id="kobo.146.1" xmlns="http://www.w3.org/1999/xhtml"> requests with a body.</span></p>
</blockquote>
<p><span class="koboSpan" id="kobo.147.1" xmlns="http://www.w3.org/1999/xhtml">An </span><strong><span class="koboSpan" id="kobo.148.1" xmlns="http://www.w3.org/1999/xhtml">idempotent</span></strong><span class="koboSpan" id="kobo.149.1" xmlns="http://www.w3.org/1999/xhtml"> request is a request that always yields the same result, whether it is sent once or multiple times. </span><span class="koboSpan" id="kobo.149.2" xmlns="http://www.w3.org/1999/xhtml">For example, sending the same </span><code><span class="koboSpan" id="kobo.150.1" xmlns="http://www.w3.org/1999/xhtml">POST</span></code><span class="koboSpan" id="kobo.151.1" xmlns="http://www.w3.org/1999/xhtml"> request multiple times should create multiple similar entities, while sending the same </span><code><span class="koboSpan" id="kobo.152.1" xmlns="http://www.w3.org/1999/xhtml">DELETE</span></code><span class="koboSpan" id="kobo.153.1" xmlns="http://www.w3.org/1999/xhtml"> request multiple times should delete a single entity. </span><span class="koboSpan" id="kobo.153.2" xmlns="http://www.w3.org/1999/xhtml">The status code of an idempotent request may vary, but the server state should remain the same. </span><span class="koboSpan" id="kobo.153.3" xmlns="http://www.w3.org/1999/xhtml">We explore those concepts in more depth in </span><em><span class="koboSpan" id="kobo.154.1" xmlns="http://www.w3.org/1999/xhtml">Chapter 4</span></em><span class="koboSpan" id="kobo.155.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.156.1" xmlns="http://www.w3.org/1999/xhtml">Model-View-Controller</span></em><span class="koboSpan" id="kobo.157.1" xmlns="http://www.w3.org/1999/xhtml">.Here is an example of a </span><code><span class="koboSpan" id="kobo.158.1" xmlns="http://www.w3.org/1999/xhtml">GET</span></code><span class="koboSpan" id="kobo.159.1" xmlns="http://www.w3.org/1999/xhtml"> request:</span></p>
<div class="C0-SHConPACKT">
<pre><code><span class="koboSpan" id="kobo.160.1" xmlns="http://www.w3.org/1999/xhtml">GET http: //www.forevolve.com/ HTTP/1.1
Host: www.forevolve.com
Connection: keep-alive
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64)
AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.110 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9,fr-CA;q=0.8,fr;q=0.7
Cookie: ...</span></code></pre>
</div>
<p><span class="koboSpan" id="kobo.161.1" xmlns="http://www.w3.org/1999/xhtml">The HTTP header comprises a list of key/value pairs representing metadata that a client wants to send to the server. </span><span class="koboSpan" id="kobo.161.2" xmlns="http://www.w3.org/1999/xhtml">In this case, I queried my blog using the </span><code><span class="koboSpan" id="kobo.162.1" xmlns="http://www.w3.org/1999/xhtml">GET</span></code><span class="koboSpan" id="kobo.163.1" xmlns="http://www.w3.org/1999/xhtml"> method and Google Chrome attached some additional information to the request. </span><span class="koboSpan" id="kobo.163.2" xmlns="http://www.w3.org/1999/xhtml">I replaced the </span><code><span class="koboSpan" id="kobo.164.1" xmlns="http://www.w3.org/1999/xhtml">Cookie</span></code><span class="koboSpan" id="kobo.165.1" xmlns="http://www.w3.org/1999/xhtml"> header’s value with </span><code><span class="koboSpan" id="kobo.166.1" xmlns="http://www.w3.org/1999/xhtml">...</span></code><span class="koboSpan" id="kobo.167.1" xmlns="http://www.w3.org/1999/xhtml"> because it can be pretty large and that information is irrelevant to this sample. </span><span class="koboSpan" id="kobo.167.2" xmlns="http://www.w3.org/1999/xhtml">Nonetheless, cookies are passed back and forth like any other HTTP header.</span></p>
<blockquote>
<p><strong><span class="koboSpan" id="kobo.168.1" xmlns="http://www.w3.org/1999/xhtml">Important note about cookies</span></strong></p>
<blockquote>
<p><span class="koboSpan" id="kobo.169.1" xmlns="http://www.w3.org/1999/xhtml">The client sends cookies, and the server returns them for every request-response cycle. </span><span class="koboSpan" id="kobo.169.2" xmlns="http://www.w3.org/1999/xhtml">This could kill your bandwidth or slow down your application if you pass too much information back and forth (cookies or otherwise). </span><span class="koboSpan" id="kobo.169.3" xmlns="http://www.w3.org/1999/xhtml">One good example would be a serialized identity cookie that is very large.</span></p>
</blockquote>
<blockquote>
<p><span class="koboSpan" id="kobo.170.1" xmlns="http://www.w3.org/1999/xhtml">Another example, unrelated to cookies but that created such a back-and-forth, was the good old Web Forms </span><code><span class="koboSpan" id="kobo.171.1" xmlns="http://www.w3.org/1999/xhtml">ViewState</span></code><span class="koboSpan" id="kobo.172.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.172.2" xmlns="http://www.w3.org/1999/xhtml">This was a hidden field sent with every request. </span><span class="koboSpan" id="kobo.172.3" xmlns="http://www.w3.org/1999/xhtml">That field could become very large when left unchecked.</span></p>
</blockquote>
<blockquote>
<p><span class="koboSpan" id="kobo.173.1" xmlns="http://www.w3.org/1999/xhtml">Nowadays, with high-speed internet, it is easy to forget about those issues, but they can significantly impact the user experience of someone on a slow network.</span></p>
</blockquote>
</blockquote>
<p><span class="koboSpan" id="kobo.174.1" xmlns="http://www.w3.org/1999/xhtml">When the server decides to respond to the request, it returns a header and an optional body, following the same principles as the request. </span><span class="koboSpan" id="kobo.174.2" xmlns="http://www.w3.org/1999/xhtml">The first line indicates the request’s status: whether it was successful. </span><span class="koboSpan" id="kobo.174.3" xmlns="http://www.w3.org/1999/xhtml">In our case, the status code was </span><code><span class="koboSpan" id="kobo.175.1" xmlns="http://www.w3.org/1999/xhtml">200</span></code><span class="koboSpan" id="kobo.176.1" xmlns="http://www.w3.org/1999/xhtml">, which indicates success. </span><span class="koboSpan" id="kobo.176.2" xmlns="http://www.w3.org/1999/xhtml">Each server can add more or less information to its response. </span><span class="koboSpan" id="kobo.176.3" xmlns="http://www.w3.org/1999/xhtml">You can also customize the response with code.Here is the response to the previous request:</span></p>
<div class="C0-SHConPACKT">
<pre><code><span class="koboSpan" id="kobo.177.1" xmlns="http://www.w3.org/1999/xhtml">HTTP/1.1 200 OK
Server: GitHub.com
Content-Type: text/html; charset=utf-8
Last-Modified: Wed, 03 Oct 2018 21:35:40 GMT
ETag: W/"5bb5362c-f677"
Access-Control-Allow-Origin: *
Expires: Fri, 07 Dec 2018 02:11:07 GMT
Cache-Control: max-age=600
Content-Encoding: gzip
X-GitHub-Request-Id: 32CE:1953:F1022C:1350142:5C09D460
Content-Length: 10055
Accept-Ranges: bytes
Date: Fri, 07 Dec 2018 02:42:05 GMT
Via: 1.1 varnish
Age: 35
Connection: keep-alive
X-Served-By: cache-ord1737-ORD
X-Cache: HIT
X-Cache-Hits: 2
X-Timer: S1544150525.288285,VS0,VE0
Vary: Accept-Encoding
X-Fastly-Request-ID: 98a36fb1b5642c8041b88ceace73f25caaf07746
&lt;Response body truncated for brevity&gt;</span></code></pre>
</div>
<p><span class="koboSpan" id="kobo.178.1" xmlns="http://www.w3.org/1999/xhtml">Now that the browser has received the server’s response, it renders the HTML webpage. </span><span class="koboSpan" id="kobo.178.2" xmlns="http://www.w3.org/1999/xhtml">Then, for each resource, it sends another HTTP call to its URI and loads it. </span><span class="koboSpan" id="kobo.178.3" xmlns="http://www.w3.org/1999/xhtml">A resource is an external asset, such as an image, a JavaScript file, a CSS file, or a font.After the response, the server is no longer aware of the client; the communication has ended. </span><span class="koboSpan" id="kobo.178.4" xmlns="http://www.w3.org/1999/xhtml">It is essential to understand that to create a pseudo-state between each request, we need to use an external mechanism. </span><span class="koboSpan" id="kobo.178.5" xmlns="http://www.w3.org/1999/xhtml">That mechanism could be the </span><em><span class="koboSpan" id="kobo.179.1" xmlns="http://www.w3.org/1999/xhtml">session-state</span></em><span class="koboSpan" id="kobo.180.1" xmlns="http://www.w3.org/1999/xhtml"> leveraging cookies, simply using cookies, or some other ASP.NET Core mechanisms, or we could create a stateless application. </span><span class="koboSpan" id="kobo.180.2" xmlns="http://www.w3.org/1999/xhtml">I recommend going stateless whenever possible. </span><span class="koboSpan" id="kobo.180.3" xmlns="http://www.w3.org/1999/xhtml">We write primarily stateless applications in the book.</span></p>
<blockquote>
<p><strong><span class="koboSpan" id="kobo.181.1" xmlns="http://www.w3.org/1999/xhtml">Note</span></strong></p>
<blockquote>
<p><span class="koboSpan" id="kobo.182.1" xmlns="http://www.w3.org/1999/xhtml">If you want to learn more about session and state management, I left a link in the </span><em><span class="koboSpan" id="kobo.183.1" xmlns="http://www.w3.org/1999/xhtml">Further reading</span></em><span class="koboSpan" id="kobo.184.1" xmlns="http://www.w3.org/1999/xhtml"> section at the end of the chapter.</span></p>
</blockquote>
</blockquote>
<p><span class="koboSpan" id="kobo.185.1" xmlns="http://www.w3.org/1999/xhtml">As you can imagine, the backbone of the internet is its networking stack. </span><span class="koboSpan" id="kobo.185.2" xmlns="http://www.w3.org/1999/xhtml">The </span><strong><span class="koboSpan" id="kobo.186.1" xmlns="http://www.w3.org/1999/xhtml">Hypertext Transfer Protocol</span></strong><span class="koboSpan" id="kobo.187.1" xmlns="http://www.w3.org/1999/xhtml"> (</span><strong><span class="koboSpan" id="kobo.188.1" xmlns="http://www.w3.org/1999/xhtml">HTTP</span></strong><span class="koboSpan" id="kobo.189.1" xmlns="http://www.w3.org/1999/xhtml">) is the highest layer of that stack (layer 7). </span><span class="koboSpan" id="kobo.189.2" xmlns="http://www.w3.org/1999/xhtml">HTTP is an application layer built on the </span><strong><span class="koboSpan" id="kobo.190.1" xmlns="http://www.w3.org/1999/xhtml">Transmission Control Protocol</span></strong><span class="koboSpan" id="kobo.191.1" xmlns="http://www.w3.org/1999/xhtml"> (</span><strong><span class="koboSpan" id="kobo.192.1" xmlns="http://www.w3.org/1999/xhtml">TCP</span></strong><span class="koboSpan" id="kobo.193.1" xmlns="http://www.w3.org/1999/xhtml">). </span><span class="koboSpan" id="kobo.193.2" xmlns="http://www.w3.org/1999/xhtml">TCP (layer 4) is the transport layer, which defines how data is moved over the network (for instance, the transmission of data, the amount of transmitted data, and error checking). </span><span class="koboSpan" id="kobo.193.3" xmlns="http://www.w3.org/1999/xhtml">TCP uses the </span><strong><span class="koboSpan" id="kobo.194.1" xmlns="http://www.w3.org/1999/xhtml">Internet Protocol</span></strong><span class="koboSpan" id="kobo.195.1" xmlns="http://www.w3.org/1999/xhtml"> (</span><strong><span class="koboSpan" id="kobo.196.1" xmlns="http://www.w3.org/1999/xhtml">IP</span></strong><span class="koboSpan" id="kobo.197.1" xmlns="http://www.w3.org/1999/xhtml">) layer to reach the computer it tries to talk to. </span><span class="koboSpan" id="kobo.197.2" xmlns="http://www.w3.org/1999/xhtml">IP (layer 3) represents the network layer, which handles packet IP addressing.A packet is a chunk of data that is transmitted over the wire. </span><span class="koboSpan" id="kobo.197.3" xmlns="http://www.w3.org/1999/xhtml">We could send a large file directly from a source to a destination machine, but that is not practical, so the network stack breaks down large items into smaller packets. </span><span class="koboSpan" id="kobo.197.4" xmlns="http://www.w3.org/1999/xhtml">For example, the source machine breaks a file into multiple packets, sends them to the target machine, and then the target reassembles them back into the source file. </span><span class="koboSpan" id="kobo.197.5" xmlns="http://www.w3.org/1999/xhtml">This process allows numerous senders to use the same wire instead of waiting for the first transmission to be done. </span><span class="koboSpan" id="kobo.197.6" xmlns="http://www.w3.org/1999/xhtml">If a packet gets lost in transit, the source machine can also send only that packet back to the target machine.Rest assured, you don’t need to understand every detail behind networking to program web applications, but it is always good to know that HTTP uses TCP/IP and chunks big payloads into smaller packets. </span><span class="koboSpan" id="kobo.197.7" xmlns="http://www.w3.org/1999/xhtml">Moreover, HTTP/1 limits the number of parallel requests a browser can open simultaneously. </span><span class="koboSpan" id="kobo.197.8" xmlns="http://www.w3.org/1999/xhtml">This knowledge can help you optimize your apps. </span><span class="koboSpan" id="kobo.197.9" xmlns="http://www.w3.org/1999/xhtml">For example, a high number of assets to load, their size, and the order in which they are sent to the browser can increase the page load time, the perceived page load time, or the paint time.To conclude this subject and not dig too deep into networking, HTTP/1 is older but foundational. </span><span class="koboSpan" id="kobo.197.10" xmlns="http://www.w3.org/1999/xhtml">HTTP/2 is more efficient and supports streaming multiple assets using the same TCP connection. </span><span class="koboSpan" id="kobo.197.11" xmlns="http://www.w3.org/1999/xhtml">It also allows the server to send assets to the client before it requests the resources, called a server push.If you find HTTP interesting, HTTP/2 is an excellent place to start digging deeper, as well as the HTTP/3 proposed standard that uses the QUIC transport protocol instead of HTTP (RFC 9114). </span><span class="koboSpan" id="kobo.197.12" xmlns="http://www.w3.org/1999/xhtml">ASP.NET Core 7.0+ supports HTTP/3, which is enabled by default in ASP.NET Core 8.0.Next, let’s quickly explore .NET.</span></p>
</section>
<section class="level2" data-number="2.5" id="getting-started-with-.net">
<h2 data-number="2.5"><span class="koboSpan" id="kobo.198.1" xmlns="http://www.w3.org/1999/xhtml">Getting started with .NET</span></h2>
<p><span class="koboSpan" id="kobo.199.1" xmlns="http://www.w3.org/1999/xhtml">A bit of history: .NET Framework 1.0 was first released in 2002. </span><span class="koboSpan" id="kobo.199.2" xmlns="http://www.w3.org/1999/xhtml">.NET is a managed framework that compiles your code into an </span><strong><span class="koboSpan" id="kobo.200.1" xmlns="http://www.w3.org/1999/xhtml">Intermediate Language</span></strong><span class="koboSpan" id="kobo.201.1" xmlns="http://www.w3.org/1999/xhtml"> (</span><strong><span class="koboSpan" id="kobo.202.1" xmlns="http://www.w3.org/1999/xhtml">IL</span></strong><span class="koboSpan" id="kobo.203.1" xmlns="http://www.w3.org/1999/xhtml">) named </span><strong><span class="koboSpan" id="kobo.204.1" xmlns="http://www.w3.org/1999/xhtml">Microsoft Intermediate Language</span></strong><span class="koboSpan" id="kobo.205.1" xmlns="http://www.w3.org/1999/xhtml"> (</span><strong><span class="koboSpan" id="kobo.206.1" xmlns="http://www.w3.org/1999/xhtml">MSIL</span></strong><span class="koboSpan" id="kobo.207.1" xmlns="http://www.w3.org/1999/xhtml">). </span><span class="koboSpan" id="kobo.207.2" xmlns="http://www.w3.org/1999/xhtml">That IL code is then compiled into native code and executed by the </span><strong><span class="koboSpan" id="kobo.208.1" xmlns="http://www.w3.org/1999/xhtml">Common Language Runtime</span></strong><span class="koboSpan" id="kobo.209.1" xmlns="http://www.w3.org/1999/xhtml"> (</span><strong><span class="koboSpan" id="kobo.210.1" xmlns="http://www.w3.org/1999/xhtml">CLR</span></strong><span class="koboSpan" id="kobo.211.1" xmlns="http://www.w3.org/1999/xhtml">). </span><span class="koboSpan" id="kobo.211.2" xmlns="http://www.w3.org/1999/xhtml">The CLR is now known simply as the </span><strong><span class="koboSpan" id="kobo.212.1" xmlns="http://www.w3.org/1999/xhtml">.NET runtime</span></strong><span class="koboSpan" id="kobo.213.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.213.2" xmlns="http://www.w3.org/1999/xhtml">After releasing several versions of .NET Framework, Microsoft never delivered on the promise of an interoperable stack. </span><span class="koboSpan" id="kobo.213.3" xmlns="http://www.w3.org/1999/xhtml">Moreover, many flaws were built into the core of .NET Framework, tying it to Windows.Mono, an open-source project, was developed by the community to enable .NET code to run on non-Windows OSes. </span><span class="koboSpan" id="kobo.213.4" xmlns="http://www.w3.org/1999/xhtml">Mono was used and supported by Xamarin, acquired by Microsoft in 2016. </span><span class="koboSpan" id="kobo.213.5" xmlns="http://www.w3.org/1999/xhtml">Mono enabled .NET code to run on other OSes like Android and iOS. </span><span class="koboSpan" id="kobo.213.6" xmlns="http://www.w3.org/1999/xhtml">Later, Microsoft started to develop an official cross-platform .NET SDK and runtime they named .NET Core.The .NET team did a magnificent job building ASP.NET Core from the ground up, cutting out compatibility with the older .NET Framework versions. </span><span class="koboSpan" id="kobo.213.7" xmlns="http://www.w3.org/1999/xhtml">That brought its share of problems at first, but .NET Standard alleviated the interoperability issues between the old .NET and the new .NET.After years of improvements and two major versions in parallel (Core and Framework), Microsoft reunified most .NET technologies into .NET 5+ and the promise of a shared </span><strong><span class="koboSpan" id="kobo.214.1" xmlns="http://www.w3.org/1999/xhtml">Base Class Library</span></strong><span class="koboSpan" id="kobo.215.1" xmlns="http://www.w3.org/1999/xhtml"> (</span><strong><span class="koboSpan" id="kobo.216.1" xmlns="http://www.w3.org/1999/xhtml">BCL</span></strong><span class="koboSpan" id="kobo.217.1" xmlns="http://www.w3.org/1999/xhtml">). </span><span class="koboSpan" id="kobo.217.2" xmlns="http://www.w3.org/1999/xhtml">With .NET 5, .NET Core simply became .NET while ASP.NET Core remained ASP.NET Core. </span><span class="koboSpan" id="kobo.217.3" xmlns="http://www.w3.org/1999/xhtml">There is no .NET “Core” 4, to avoid any potential confusion with .NET Framework 4.X.New major versions of .NET release every year now. </span><span class="koboSpan" id="kobo.217.4" xmlns="http://www.w3.org/1999/xhtml">Even-number releases are </span><strong><span class="koboSpan" id="kobo.218.1" xmlns="http://www.w3.org/1999/xhtml">Long-Term Support</span></strong><span class="koboSpan" id="kobo.219.1" xmlns="http://www.w3.org/1999/xhtml"> (</span><strong><span class="koboSpan" id="kobo.220.1" xmlns="http://www.w3.org/1999/xhtml">LTS</span></strong><span class="koboSpan" id="kobo.221.1" xmlns="http://www.w3.org/1999/xhtml">) releases with free support for 3 years, and odd-number releases (Current) have free support for only 18 months.The good thing behind this book is that the architectural principles and design patterns covered should remain relevant in the future and are not tightly coupled with the versions of .NET you are using. </span><span class="koboSpan" id="kobo.221.2" xmlns="http://www.w3.org/1999/xhtml">Minor changes to the code samples should be enough to migrate your knowledge and code to new versions.Next, let’s cover some key information about the .NET ecosystem.</span></p>
<section class="level3" data-number="2.5.1" id="net-sdk-versus-runtime">
<h3 data-number="2.5.1"><span class="koboSpan" id="kobo.222.1" xmlns="http://www.w3.org/1999/xhtml">.NET SDK versus runtime</span></h3>
<p><span class="koboSpan" id="kobo.223.1" xmlns="http://www.w3.org/1999/xhtml">You can install different binaries grouped under SDKs and runtimes. </span><span class="koboSpan" id="kobo.223.2" xmlns="http://www.w3.org/1999/xhtml">The SDK allows you to build and run .NET programs, while the runtime only allows you to run .NET programs.As a developer, you want to install the SDK on your deployment environment. </span><span class="koboSpan" id="kobo.223.3" xmlns="http://www.w3.org/1999/xhtml">On the server, you want to install the runtime. </span><span class="koboSpan" id="kobo.223.4" xmlns="http://www.w3.org/1999/xhtml">The runtime is lighter, while the SDK contains more tools, including the runtime.</span></p>
</section>
<section class="level3" data-number="2.5.2" id="net-5-versus-.net-standard">
<h3 data-number="2.5.2"><span class="koboSpan" id="kobo.224.1" xmlns="http://www.w3.org/1999/xhtml">.NET 5+ versus .NET Standard</span></h3>
<p><span class="koboSpan" id="kobo.225.1" xmlns="http://www.w3.org/1999/xhtml">When building .NET projects, there are multiple types of projects, but basically, we can separate them into two categories:</span></p>
<ul>
<li><span class="koboSpan" id="kobo.226.1" xmlns="http://www.w3.org/1999/xhtml">Applications</span></li>
<li><span class="koboSpan" id="kobo.227.1" xmlns="http://www.w3.org/1999/xhtml">Libraries</span></li>
</ul>
<p><span class="koboSpan" id="kobo.228.1" xmlns="http://www.w3.org/1999/xhtml">Applications target a version of .NET, such as </span><code><span class="koboSpan" id="kobo.229.1" xmlns="http://www.w3.org/1999/xhtml">net5.0</span></code><span class="koboSpan" id="kobo.230.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><code><span class="koboSpan" id="kobo.231.1" xmlns="http://www.w3.org/1999/xhtml">net6.0</span></code><span class="koboSpan" id="kobo.232.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.232.2" xmlns="http://www.w3.org/1999/xhtml">Examples of that would be an ASP.NET application or a console application.Libraries are bundles of code compiled together, often distributed as a NuGet package. </span><span class="koboSpan" id="kobo.232.3" xmlns="http://www.w3.org/1999/xhtml">.NET Standard class library projects allow sharing code between .NET 5+, and .NET Framework projects. </span><span class="koboSpan" id="kobo.232.4" xmlns="http://www.w3.org/1999/xhtml">.NET Standard came into play to bridge the compatibility gap between .NET Core and .NET Framework, which eased the transition. </span><span class="koboSpan" id="kobo.232.5" xmlns="http://www.w3.org/1999/xhtml">Things were not easy when .NET Core 1.0 first came out.With .NET 5 unifying all the platforms and becoming the future of the unified .NET ecosystem, .NET Standard is no longer needed. </span><span class="koboSpan" id="kobo.232.6" xmlns="http://www.w3.org/1999/xhtml">Moreover, app and library authors should target the base </span><strong><span class="koboSpan" id="kobo.233.1" xmlns="http://www.w3.org/1999/xhtml">Target Framework Moniker</span></strong><span class="koboSpan" id="kobo.234.1" xmlns="http://www.w3.org/1999/xhtml"> (</span><strong><span class="koboSpan" id="kobo.235.1" xmlns="http://www.w3.org/1999/xhtml">TFM</span></strong><span class="koboSpan" id="kobo.236.1" xmlns="http://www.w3.org/1999/xhtml">), for example, </span><code><span class="koboSpan" id="kobo.237.1" xmlns="http://www.w3.org/1999/xhtml">net8.0</span></code><span class="koboSpan" id="kobo.238.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.238.2" xmlns="http://www.w3.org/1999/xhtml">You can also target </span><code><span class="koboSpan" id="kobo.239.1" xmlns="http://www.w3.org/1999/xhtml">netstandard2.0</span></code><span class="koboSpan" id="kobo.240.1" xmlns="http://www.w3.org/1999/xhtml"> or </span><code><span class="koboSpan" id="kobo.241.1" xmlns="http://www.w3.org/1999/xhtml">netstandard2.1</span></code><span class="koboSpan" id="kobo.242.1" xmlns="http://www.w3.org/1999/xhtml"> when needed, for example, to share code with .NET Framework. </span><span class="koboSpan" id="kobo.242.2" xmlns="http://www.w3.org/1999/xhtml">Microsoft also introduced OS-specific TFMs with .NET 5+, allowing code to use OS-specific APIs like </span><code><span class="koboSpan" id="kobo.243.1" xmlns="http://www.w3.org/1999/xhtml">net8.0-android</span></code><span class="koboSpan" id="kobo.244.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><code><span class="koboSpan" id="kobo.245.1" xmlns="http://www.w3.org/1999/xhtml">net8.0-tvos</span></code><span class="koboSpan" id="kobo.246.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.246.2" xmlns="http://www.w3.org/1999/xhtml">You can also target multiple TFMs when needed.</span></p>
<blockquote>
<p><strong><span class="koboSpan" id="kobo.247.1" xmlns="http://www.w3.org/1999/xhtml">Note</span></strong></p>
<blockquote>
<p><span class="koboSpan" id="kobo.248.1" xmlns="http://www.w3.org/1999/xhtml">I’m sure we will see .NET Standard libraries stick around for a while. </span><span class="koboSpan" id="kobo.248.2" xmlns="http://www.w3.org/1999/xhtml">All projects will not just migrate from .NET Framework to .NET 5+ magically, and people will want to continue sharing code between the two.</span></p>
</blockquote>
</blockquote>
<p><span class="koboSpan" id="kobo.249.1" xmlns="http://www.w3.org/1999/xhtml">The next versions of .NET are built over .NET 5+, while .NET Framework 4.X will stay where it is today, receiving only security patches and minor updates. </span><span class="koboSpan" id="kobo.249.2" xmlns="http://www.w3.org/1999/xhtml">For example, .NET 8 is built over .NET 7, iterating over .NET 6 and 5.Next, let’s look at some tools and code editors.</span></p>
</section>
<section class="level3" data-number="2.5.3" id="visual-studio-code-versus-visual-studio-versus-the-command-line-interface">
<h3 data-number="2.5.3"><span class="koboSpan" id="kobo.250.1" xmlns="http://www.w3.org/1999/xhtml">Visual Studio Code versus Visual Studio versus the command-line interface</span></h3>
<p><span class="koboSpan" id="kobo.251.1" xmlns="http://www.w3.org/1999/xhtml">How can one of these projects be created? </span><span class="koboSpan" id="kobo.251.2" xmlns="http://www.w3.org/1999/xhtml">.NET Core comes with the </span><code><span class="koboSpan" id="kobo.252.1" xmlns="http://www.w3.org/1999/xhtml">dotnet</span></code> <strong><span class="koboSpan" id="kobo.253.1" xmlns="http://www.w3.org/1999/xhtml">command-line interface</span></strong><span class="koboSpan" id="kobo.254.1" xmlns="http://www.w3.org/1999/xhtml"> (</span><strong><span class="koboSpan" id="kobo.255.1" xmlns="http://www.w3.org/1999/xhtml">CLI</span></strong><span class="koboSpan" id="kobo.256.1" xmlns="http://www.w3.org/1999/xhtml">), which exposes multiple commands, including </span><code><span class="koboSpan" id="kobo.257.1" xmlns="http://www.w3.org/1999/xhtml">new</span></code><span class="koboSpan" id="kobo.258.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.258.2" xmlns="http://www.w3.org/1999/xhtml">Running the </span><code><span class="koboSpan" id="kobo.259.1" xmlns="http://www.w3.org/1999/xhtml">dotnet new</span></code><span class="koboSpan" id="kobo.260.1" xmlns="http://www.w3.org/1999/xhtml"> command in a terminal generates a new project.To create an empty class library, we can run the following commands:</span></p>
<div class="C0-SHConPACKT">
<pre><code><span class="koboSpan" id="kobo.261.1" xmlns="http://www.w3.org/1999/xhtml">md MyProject
cd MyProject
dotnet new classlib</span></code></pre>
</div>
<p><span class="koboSpan" id="kobo.262.1" xmlns="http://www.w3.org/1999/xhtml">That would generate an empty class library in the newly created </span><code><span class="koboSpan" id="kobo.263.1" xmlns="http://www.w3.org/1999/xhtml">MyProject</span></code><span class="koboSpan" id="kobo.264.1" xmlns="http://www.w3.org/1999/xhtml"> directory.The </span><code><span class="koboSpan" id="kobo.265.1" xmlns="http://www.w3.org/1999/xhtml">-h</span></code><span class="koboSpan" id="kobo.266.1" xmlns="http://www.w3.org/1999/xhtml"> option helps discover available commands and their options. </span><span class="koboSpan" id="kobo.266.2" xmlns="http://www.w3.org/1999/xhtml">For example, you can use </span><code><span class="koboSpan" id="kobo.267.1" xmlns="http://www.w3.org/1999/xhtml">dotnet -h</span></code><span class="koboSpan" id="kobo.268.1" xmlns="http://www.w3.org/1999/xhtml"> to find the available SDK commands or </span><code><span class="koboSpan" id="kobo.269.1" xmlns="http://www.w3.org/1999/xhtml">dotnet new -h</span></code><span class="koboSpan" id="kobo.270.1" xmlns="http://www.w3.org/1999/xhtml"> to find out about options and available templates.It is fantastic that .NET now has the </span><code><span class="koboSpan" id="kobo.271.1" xmlns="http://www.w3.org/1999/xhtml">dotnet</span></code><span class="koboSpan" id="kobo.272.1" xmlns="http://www.w3.org/1999/xhtml"> CLI. </span><span class="koboSpan" id="kobo.272.2" xmlns="http://www.w3.org/1999/xhtml">The CLI enables us to automate our workflows in </span><strong><span class="koboSpan" id="kobo.273.1" xmlns="http://www.w3.org/1999/xhtml">continuous integration</span></strong><span class="koboSpan" id="kobo.274.1" xmlns="http://www.w3.org/1999/xhtml"> (</span><strong><span class="koboSpan" id="kobo.275.1" xmlns="http://www.w3.org/1999/xhtml">CI</span></strong><span class="koboSpan" id="kobo.276.1" xmlns="http://www.w3.org/1999/xhtml">) pipelines while developing locally or through any other process.The CLI also makes it easier to write documentation that anyone can follow; writing a few commands in a terminal is way easier and faster than installing programs like Visual Studio and emulators.</span><strong><span class="koboSpan" id="kobo.277.1" xmlns="http://www.w3.org/1999/xhtml">Visual Studio Code</span></strong><span class="koboSpan" id="kobo.278.1" xmlns="http://www.w3.org/1999/xhtml"> is my favourite text editor. </span><span class="koboSpan" id="kobo.278.2" xmlns="http://www.w3.org/1999/xhtml">I don’t use it much for .NET coding, but I still do to reorganize projects, when it’s CLI time, or for any other task that is easier to complete using a text editor, such as writing documentation using Markdown, writing JavaScript or TypeScript, or managing JSON, YAML, or XML files. </span><span class="koboSpan" id="kobo.278.3" xmlns="http://www.w3.org/1999/xhtml">To create a C# project, a Visual Studio solution, or to add a NuGet package using Visual Studio Code, open a terminal and use the CLI.As for </span><strong><span class="koboSpan" id="kobo.279.1" xmlns="http://www.w3.org/1999/xhtml">Visual Studio</span></strong><span class="koboSpan" id="kobo.280.1" xmlns="http://www.w3.org/1999/xhtml">, my favourite C# IDE, it uses the CLI under the hood to create the same projects, making it consistent between tools and just adding a user interface on top of the </span><code><span class="koboSpan" id="kobo.281.1" xmlns="http://www.w3.org/1999/xhtml">dotnet new</span></code><span class="koboSpan" id="kobo.282.1" xmlns="http://www.w3.org/1999/xhtml"> CLI command.You can create and install additional </span><code><span class="koboSpan" id="kobo.283.1" xmlns="http://www.w3.org/1999/xhtml">dotnet</span></code> <code><span class="koboSpan" id="kobo.284.1" xmlns="http://www.w3.org/1999/xhtml">new</span></code><span class="koboSpan" id="kobo.285.1" xmlns="http://www.w3.org/1999/xhtml"> project templates in the CLI or even create global tools. </span><span class="koboSpan" id="kobo.285.2" xmlns="http://www.w3.org/1999/xhtml">You can also use another code editor or IDE if you prefer. </span><span class="koboSpan" id="kobo.285.3" xmlns="http://www.w3.org/1999/xhtml">Those topics are beyond the scope of this book.</span></p>
<section class="level4" data-number="2.5.3.1" id="an-overview-of-project-templates">
<h4 data-number="2.5.3.1"><span class="koboSpan" id="kobo.286.1" xmlns="http://www.w3.org/1999/xhtml">An overview of project templates</span></h4>
<p><span class="koboSpan" id="kobo.287.1" xmlns="http://www.w3.org/1999/xhtml">Here is an example of the templates that are installed (</span><code><span class="koboSpan" id="kobo.288.1" xmlns="http://www.w3.org/1999/xhtml">dotnet</span></code> <code><span class="koboSpan" id="kobo.289.1" xmlns="http://www.w3.org/1999/xhtml">new --list</span></code><span class="koboSpan" id="kobo.290.1" xmlns="http://www.w3.org/1999/xhtml">):</span></p>
<figure>
<span class="koboSpan" id="kobo.291.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Figure 1.1: Project templates" src="../media/file1.png"/></span><figcaption aria-hidden="true"><span class="koboSpan" id="kobo.292.1" xmlns="http://www.w3.org/1999/xhtml">Figure 1.1: Project templates</span></figcaption>
</figure>
<p><span class="koboSpan" id="kobo.293.1" xmlns="http://www.w3.org/1999/xhtml">A study of all the templates is beyond the scope of this book, but I’d like to visit the few that are worth mentioning, some of which we will use later:</span></p>
<ul>
<li><code><span class="koboSpan" id="kobo.294.1" xmlns="http://www.w3.org/1999/xhtml">dotnet new console</span></code><span class="koboSpan" id="kobo.295.1" xmlns="http://www.w3.org/1999/xhtml"> creates a console application</span></li>
<li><code><span class="koboSpan" id="kobo.296.1" xmlns="http://www.w3.org/1999/xhtml">dotnet new classlib</span></code><span class="koboSpan" id="kobo.297.1" xmlns="http://www.w3.org/1999/xhtml"> creates a class library</span></li>
<li><code><span class="koboSpan" id="kobo.298.1" xmlns="http://www.w3.org/1999/xhtml">dotnet new xunit</span></code><span class="koboSpan" id="kobo.299.1" xmlns="http://www.w3.org/1999/xhtml"> creates an xUnit test project</span></li>
<li><code><span class="koboSpan" id="kobo.300.1" xmlns="http://www.w3.org/1999/xhtml">dotnet new web</span></code><span class="koboSpan" id="kobo.301.1" xmlns="http://www.w3.org/1999/xhtml"> creates an empty web project</span></li>
<li><code><span class="koboSpan" id="kobo.302.1" xmlns="http://www.w3.org/1999/xhtml">dotnet new mvc</span></code><span class="koboSpan" id="kobo.303.1" xmlns="http://www.w3.org/1999/xhtml"> scaffolds an MVC application</span></li>
<li><code><span class="koboSpan" id="kobo.304.1" xmlns="http://www.w3.org/1999/xhtml">dotnet new webapi</span></code><span class="koboSpan" id="kobo.305.1" xmlns="http://www.w3.org/1999/xhtml"> scaffolds a web API application</span></li>
</ul>
</section>
<section class="level4" data-number="2.5.3.2" id="running-and-building-your-program">
<h4 data-number="2.5.3.2"><span class="koboSpan" id="kobo.306.1" xmlns="http://www.w3.org/1999/xhtml">Running and building your program</span></h4>
<p><span class="koboSpan" id="kobo.307.1" xmlns="http://www.w3.org/1999/xhtml">If you are using Visual Studio, you can always hit the play button, or </span><em><span class="koboSpan" id="kobo.308.1" xmlns="http://www.w3.org/1999/xhtml">F5</span></em><span class="koboSpan" id="kobo.309.1" xmlns="http://www.w3.org/1999/xhtml">, and run your app. </span><span class="koboSpan" id="kobo.309.2" xmlns="http://www.w3.org/1999/xhtml">If you are using the CLI, you can use one of the following commands (and more). </span><span class="koboSpan" id="kobo.309.3" xmlns="http://www.w3.org/1999/xhtml">Each of them also offers different options to control their behaviour. </span><span class="koboSpan" id="kobo.309.4" xmlns="http://www.w3.org/1999/xhtml">Add the </span><code><span class="koboSpan" id="kobo.310.1" xmlns="http://www.w3.org/1999/xhtml">-h</span></code><span class="koboSpan" id="kobo.311.1" xmlns="http://www.w3.org/1999/xhtml"> flag with any command to get help on that command, such as </span><code><span class="koboSpan" id="kobo.312.1" xmlns="http://www.w3.org/1999/xhtml">dotnet build -h</span></code><span class="koboSpan" id="kobo.313.1" xmlns="http://www.w3.org/1999/xhtml">:</span></p>
<table>
<tbody>
<tr class="odd">
<td><strong><span class="koboSpan" id="kobo.314.1" xmlns="http://www.w3.org/1999/xhtml">Command</span></strong></td>
<td><strong><span class="koboSpan" id="kobo.315.1" xmlns="http://www.w3.org/1999/xhtml">Description</span></strong></td>
</tr>
<tr class="even">
<td><code><span class="koboSpan" id="kobo.316.1" xmlns="http://www.w3.org/1999/xhtml">dotnet restore</span></code></td>
<td><span class="koboSpan" id="kobo.317.1" xmlns="http://www.w3.org/1999/xhtml">Restore the dependencies (a.k.a. </span><span class="koboSpan" id="kobo.317.2" xmlns="http://www.w3.org/1999/xhtml">NuGet packages) based on the </span><code><span class="koboSpan" id="kobo.318.1" xmlns="http://www.w3.org/1999/xhtml">.csproj</span></code><span class="koboSpan" id="kobo.319.1" xmlns="http://www.w3.org/1999/xhtml"> or </span><code><span class="koboSpan" id="kobo.320.1" xmlns="http://www.w3.org/1999/xhtml">.sln</span></code><span class="koboSpan" id="kobo.321.1" xmlns="http://www.w3.org/1999/xhtml"> file present in the current dictionary.</span></td>
</tr>
<tr class="odd">
<td><code><span class="koboSpan" id="kobo.322.1" xmlns="http://www.w3.org/1999/xhtml">dotnet build</span></code></td>
<td><span class="koboSpan" id="kobo.323.1" xmlns="http://www.w3.org/1999/xhtml">Build the application based on the </span><code><span class="koboSpan" id="kobo.324.1" xmlns="http://www.w3.org/1999/xhtml">.csproj</span></code><span class="koboSpan" id="kobo.325.1" xmlns="http://www.w3.org/1999/xhtml"> or </span><code><span class="koboSpan" id="kobo.326.1" xmlns="http://www.w3.org/1999/xhtml">.sln</span></code><span class="koboSpan" id="kobo.327.1" xmlns="http://www.w3.org/1999/xhtml"> file present in the current dictionary. </span><span class="koboSpan" id="kobo.327.2" xmlns="http://www.w3.org/1999/xhtml">It implicitly runs the </span><code><span class="koboSpan" id="kobo.328.1" xmlns="http://www.w3.org/1999/xhtml">restore</span></code><span class="koboSpan" id="kobo.329.1" xmlns="http://www.w3.org/1999/xhtml"> command first.</span></td>
</tr>
<tr class="even">
<td><code><span class="koboSpan" id="kobo.330.1" xmlns="http://www.w3.org/1999/xhtml">dotnet run</span></code></td>
<td><span class="koboSpan" id="kobo.331.1" xmlns="http://www.w3.org/1999/xhtml">Run the current application based on the </span><code><span class="koboSpan" id="kobo.332.1" xmlns="http://www.w3.org/1999/xhtml">.csproj</span></code><span class="koboSpan" id="kobo.333.1" xmlns="http://www.w3.org/1999/xhtml"> file present in the current dictionary. </span><span class="koboSpan" id="kobo.333.2" xmlns="http://www.w3.org/1999/xhtml">It implicitly runs the </span><code><span class="koboSpan" id="kobo.334.1" xmlns="http://www.w3.org/1999/xhtml">build</span></code><span class="koboSpan" id="kobo.335.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><code><span class="koboSpan" id="kobo.336.1" xmlns="http://www.w3.org/1999/xhtml">restore</span></code><span class="koboSpan" id="kobo.337.1" xmlns="http://www.w3.org/1999/xhtml"> commands first.</span></td>
</tr>
<tr class="odd">
<td><code><span class="koboSpan" id="kobo.338.1" xmlns="http://www.w3.org/1999/xhtml">dotnet watch run</span></code></td>
<td><span class="koboSpan" id="kobo.339.1" xmlns="http://www.w3.org/1999/xhtml">Watch for file changes. </span><span class="koboSpan" id="kobo.339.2" xmlns="http://www.w3.org/1999/xhtml">When a file has changed, the CLI updates the code from that file using the hot-reload feature. </span><span class="koboSpan" id="kobo.339.3" xmlns="http://www.w3.org/1999/xhtml">When that is impossible, it rebuilds the application and then reruns it (equivalent to executing the </span><code><span class="koboSpan" id="kobo.340.1" xmlns="http://www.w3.org/1999/xhtml">run</span></code><span class="koboSpan" id="kobo.341.1" xmlns="http://www.w3.org/1999/xhtml"> command again). </span><span class="koboSpan" id="kobo.341.2" xmlns="http://www.w3.org/1999/xhtml">If it is a web application, the page should refresh automatically.</span></td>
</tr>
<tr class="even">
<td><code><span class="koboSpan" id="kobo.342.1" xmlns="http://www.w3.org/1999/xhtml">dotnet test</span></code></td>
<td><span class="koboSpan" id="kobo.343.1" xmlns="http://www.w3.org/1999/xhtml">Run the tests based on the </span><code><span class="koboSpan" id="kobo.344.1" xmlns="http://www.w3.org/1999/xhtml">.csproj</span></code><span class="koboSpan" id="kobo.345.1" xmlns="http://www.w3.org/1999/xhtml"> or </span><code><span class="koboSpan" id="kobo.346.1" xmlns="http://www.w3.org/1999/xhtml">.sln</span></code><span class="koboSpan" id="kobo.347.1" xmlns="http://www.w3.org/1999/xhtml"> file present in the current directory. </span><span class="koboSpan" id="kobo.347.2" xmlns="http://www.w3.org/1999/xhtml">It implicitly runs the </span><code><span class="koboSpan" id="kobo.348.1" xmlns="http://www.w3.org/1999/xhtml">build</span></code><span class="koboSpan" id="kobo.349.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><code><span class="koboSpan" id="kobo.350.1" xmlns="http://www.w3.org/1999/xhtml">restore</span></code><span class="koboSpan" id="kobo.351.1" xmlns="http://www.w3.org/1999/xhtml"> commands first. </span><span class="koboSpan" id="kobo.351.2" xmlns="http://www.w3.org/1999/xhtml">We cover testing in the next chapter.</span></td>
</tr>
<tr class="odd">
<td><code><span class="koboSpan" id="kobo.352.1" xmlns="http://www.w3.org/1999/xhtml">dotnet watch test</span></code></td>
<td><span class="koboSpan" id="kobo.353.1" xmlns="http://www.w3.org/1999/xhtml">Watch for file changes. </span><span class="koboSpan" id="kobo.353.2" xmlns="http://www.w3.org/1999/xhtml">When a file has changed, the CLI reruns the tests (equivalent to executing the </span><code><span class="koboSpan" id="kobo.354.1" xmlns="http://www.w3.org/1999/xhtml">test</span></code><span class="koboSpan" id="kobo.355.1" xmlns="http://www.w3.org/1999/xhtml"> command again).</span></td>
</tr>
<tr class="even">
<td><code><span class="koboSpan" id="kobo.356.1" xmlns="http://www.w3.org/1999/xhtml">dotnet publish</span></code></td>
<td><span class="koboSpan" id="kobo.357.1" xmlns="http://www.w3.org/1999/xhtml">Publish the current application, based on the </span><code><span class="koboSpan" id="kobo.358.1" xmlns="http://www.w3.org/1999/xhtml">.csproj</span></code><span class="koboSpan" id="kobo.359.1" xmlns="http://www.w3.org/1999/xhtml"> or </span><code><span class="koboSpan" id="kobo.360.1" xmlns="http://www.w3.org/1999/xhtml">.sln</span></code><span class="koboSpan" id="kobo.361.1" xmlns="http://www.w3.org/1999/xhtml"> file present in the current directory, to a directory or remote location, such as a hosting provider. </span><span class="koboSpan" id="kobo.361.2" xmlns="http://www.w3.org/1999/xhtml">It implicitly runs the </span><code><span class="koboSpan" id="kobo.362.1" xmlns="http://www.w3.org/1999/xhtml">build</span></code><span class="koboSpan" id="kobo.363.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><code><span class="koboSpan" id="kobo.364.1" xmlns="http://www.w3.org/1999/xhtml">restore</span></code><span class="koboSpan" id="kobo.365.1" xmlns="http://www.w3.org/1999/xhtml"> commands first.</span></td>
</tr>
<tr class="odd">
<td><code><span class="koboSpan" id="kobo.366.1" xmlns="http://www.w3.org/1999/xhtml">dotnet pack</span></code></td>
<td><span class="koboSpan" id="kobo.367.1" xmlns="http://www.w3.org/1999/xhtml">Create a NuGet package based on the </span><code><span class="koboSpan" id="kobo.368.1" xmlns="http://www.w3.org/1999/xhtml">.csproj</span></code><span class="koboSpan" id="kobo.369.1" xmlns="http://www.w3.org/1999/xhtml"> or </span><code><span class="koboSpan" id="kobo.370.1" xmlns="http://www.w3.org/1999/xhtml">.sln</span></code><span class="koboSpan" id="kobo.371.1" xmlns="http://www.w3.org/1999/xhtml"> file present in the current directory. </span><span class="koboSpan" id="kobo.371.2" xmlns="http://www.w3.org/1999/xhtml">It implicitly runs the </span><code><span class="koboSpan" id="kobo.372.1" xmlns="http://www.w3.org/1999/xhtml">build</span></code><span class="koboSpan" id="kobo.373.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><code><span class="koboSpan" id="kobo.374.1" xmlns="http://www.w3.org/1999/xhtml">restore</span></code><span class="koboSpan" id="kobo.375.1" xmlns="http://www.w3.org/1999/xhtml"> commands first. </span><span class="koboSpan" id="kobo.375.2" xmlns="http://www.w3.org/1999/xhtml">You don’t need a </span><code><span class="koboSpan" id="kobo.376.1" xmlns="http://www.w3.org/1999/xhtml">.nuspec</span></code><span class="koboSpan" id="kobo.377.1" xmlns="http://www.w3.org/1999/xhtml"> file.</span></td>
</tr>
<tr class="even">
<td><code><span class="koboSpan" id="kobo.378.1" xmlns="http://www.w3.org/1999/xhtml">dotnet clean</span></code></td>
<td><span class="koboSpan" id="kobo.379.1" xmlns="http://www.w3.org/1999/xhtml">Clean the build(s) output of a project or solution based on the </span><code><span class="koboSpan" id="kobo.380.1" xmlns="http://www.w3.org/1999/xhtml">.csproj</span></code><span class="koboSpan" id="kobo.381.1" xmlns="http://www.w3.org/1999/xhtml"> or </span><code><span class="koboSpan" id="kobo.382.1" xmlns="http://www.w3.org/1999/xhtml">.sln</span></code><span class="koboSpan" id="kobo.383.1" xmlns="http://www.w3.org/1999/xhtml"> file present in the current directory.</span></td>
</tr>
</tbody>
</table>
</section>
</section>
<section class="level3" data-number="2.5.4" id="technical-requirements">
<h3 data-number="2.5.4"><span class="koboSpan" id="kobo.384.1" xmlns="http://www.w3.org/1999/xhtml">Technical requirements</span></h3>
<p><span class="koboSpan" id="kobo.385.1" xmlns="http://www.w3.org/1999/xhtml">Throughout the book, we will explore and write code. </span><span class="koboSpan" id="kobo.385.2" xmlns="http://www.w3.org/1999/xhtml">I recommend installing Visual Studio, Visual Studio Code, or both to help with that. </span><span class="koboSpan" id="kobo.385.3" xmlns="http://www.w3.org/1999/xhtml">I use Visual Studio and Visual Studio Code. </span><span class="koboSpan" id="kobo.385.4" xmlns="http://www.w3.org/1999/xhtml">Other alternatives are Visual Studio for Mac, Riders, or any other text editor you choose.Unless you install Visual Studio, which comes with the .NET SDK, you may need to install it. </span><span class="koboSpan" id="kobo.385.5" xmlns="http://www.w3.org/1999/xhtml">The SDK comes with the CLI we explored earlier and the build tools for running and testing your programs. </span><span class="koboSpan" id="kobo.385.6" xmlns="http://www.w3.org/1999/xhtml">Look at the </span><code><span class="koboSpan" id="kobo.386.1" xmlns="http://www.w3.org/1999/xhtml">README.md</span></code><span class="koboSpan" id="kobo.387.1" xmlns="http://www.w3.org/1999/xhtml"> file in the GitHub repository for more information and links to those resources.The source code of all chapters is available for download on GitHub at the following address: </span><a href="https://adpg.link/net6"><span class="koboSpan" id="kobo.388.1" xmlns="http://www.w3.org/1999/xhtml">https://adpg.link/net6</span></a><span class="koboSpan" id="kobo.389.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</section>
</section>
<section class="level2" data-number="2.6" id="summary">
<h2 data-number="2.6"><span class="koboSpan" id="kobo.390.1" xmlns="http://www.w3.org/1999/xhtml">Summary</span></h2>
<p><span class="koboSpan" id="kobo.391.1" xmlns="http://www.w3.org/1999/xhtml">This chapter looked at design patterns, anti-patterns, and code smells. </span><span class="koboSpan" id="kobo.391.2" xmlns="http://www.w3.org/1999/xhtml">We also explored a few of them. </span><span class="koboSpan" id="kobo.391.3" xmlns="http://www.w3.org/1999/xhtml">We then moved on to a recap of a typical web application’s request/response cycle.We continued by exploring .NET essentials, such as SDK versus runtime and app targets versus .NET Standard. </span><span class="koboSpan" id="kobo.391.4" xmlns="http://www.w3.org/1999/xhtml">We then dug a little more into the .NET CLI, where I laid down a list of essential commands, including </span><code><span class="koboSpan" id="kobo.392.1" xmlns="http://www.w3.org/1999/xhtml">dotnet build</span></code><span class="koboSpan" id="kobo.393.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><code><span class="koboSpan" id="kobo.394.1" xmlns="http://www.w3.org/1999/xhtml">dotnet watch run</span></code><span class="koboSpan" id="kobo.395.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.395.2" xmlns="http://www.w3.org/1999/xhtml">We also covered how to create new projects. </span><span class="koboSpan" id="kobo.395.3" xmlns="http://www.w3.org/1999/xhtml">This has set us up to explore the different possibilities we have when building our .NET applications.In the next two chapters, we explore automated testing and architectural principles. </span><span class="koboSpan" id="kobo.395.4" xmlns="http://www.w3.org/1999/xhtml">These are foundational chapters for building robust, flexible, and maintainable applications.</span></p>
</section>
<section class="level2" data-number="2.7" id="questions">
<h2 data-number="2.7"><span class="koboSpan" id="kobo.396.1" xmlns="http://www.w3.org/1999/xhtml">Questions</span></h2>
<p><span class="koboSpan" id="kobo.397.1" xmlns="http://www.w3.org/1999/xhtml">Let’s take a look at a few practice questions:</span></p>
<ol>
<li><span class="koboSpan" id="kobo.398.1" xmlns="http://www.w3.org/1999/xhtml">Can we add a body to a </span><code><span class="koboSpan" id="kobo.399.1" xmlns="http://www.w3.org/1999/xhtml">GET</span></code><span class="koboSpan" id="kobo.400.1" xmlns="http://www.w3.org/1999/xhtml"> request?</span></li>
<li><span class="koboSpan" id="kobo.401.1" xmlns="http://www.w3.org/1999/xhtml">Why are long methods a code smell?</span></li>
<li><span class="koboSpan" id="kobo.402.1" xmlns="http://www.w3.org/1999/xhtml">Is it true that .NET Standard should be your default target when creating libraries?</span></li>
<li><span class="koboSpan" id="kobo.403.1" xmlns="http://www.w3.org/1999/xhtml">What is a code smell?</span></li>
</ol>
</section>
<section class="level2" data-number="2.8" id="further-reading">
<h2 data-number="2.8"><span class="koboSpan" id="kobo.404.1" xmlns="http://www.w3.org/1999/xhtml">Further reading</span></h2>
<p><span class="koboSpan" id="kobo.405.1" xmlns="http://www.w3.org/1999/xhtml">Here are some links to consolidate what has been learned in the chapter:</span></p>
<ul>
<li><span class="koboSpan" id="kobo.406.1" xmlns="http://www.w3.org/1999/xhtml">Overview of how .NET is versioned: </span><a href="https://adpg.link/n52L"><span class="koboSpan" id="kobo.407.1" xmlns="http://www.w3.org/1999/xhtml">https://adpg.link/n52L</span></a></li>
<li><span class="koboSpan" id="kobo.408.1" xmlns="http://www.w3.org/1999/xhtml">.NET CLI overview: </span><a href="https://adpg.link/Lzx3"><span class="koboSpan" id="kobo.409.1" xmlns="http://www.w3.org/1999/xhtml">https://adpg.link/Lzx3</span></a></li>
<li><span class="koboSpan" id="kobo.410.1" xmlns="http://www.w3.org/1999/xhtml">Custom templates for </span><code><span class="koboSpan" id="kobo.411.1" xmlns="http://www.w3.org/1999/xhtml">dotnet</span></code> <code><span class="koboSpan" id="kobo.412.1" xmlns="http://www.w3.org/1999/xhtml">new</span></code><span class="koboSpan" id="kobo.413.1" xmlns="http://www.w3.org/1999/xhtml">: </span><a href="https://adpg.link/74i2"><span class="koboSpan" id="kobo.414.1" xmlns="http://www.w3.org/1999/xhtml">https://adpg.link/74i2</span></a></li>
<li><span class="koboSpan" id="kobo.415.1" xmlns="http://www.w3.org/1999/xhtml">Session and state management in ASP.NET Core: </span><a href="https://adpg.link/Xzgf"><span class="koboSpan" id="kobo.416.1" xmlns="http://www.w3.org/1999/xhtml">https://adpg.link/Xzgf</span></a></li>
</ul>
</section>
</section>
</body>
</html>
