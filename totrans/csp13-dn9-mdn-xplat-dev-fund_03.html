<html><head></head><body><div id="book-content"><div id="sbo-rt-content"><div id="_idContainer228" class="Basic-Text-Frame">
    <h1 class="chapterNumber">3</h1>
    <h1 id="_idParaDest-181" class="chapterTitle">Controlling Flow, Converting Types, and Handling Exceptions</h1>
    <p class="normal">This chapter is all about writing code that performs simple operations on variables, makes decisions, performs pattern matching, and repeats statements or blocks. You will also learn how to work with arrays to store multiple values, how to convert variable or expression values from one type to another, how to handle exceptions, and how to check for overflows in number variables.</p>
    <p class="normal">This chapter covers the following topics:</p>
    <ul>
      <li class="bulletList">Operating on variables</li>
      <li class="bulletList">Understanding selection statements</li>
      <li class="bulletList">Understanding iteration statements</li>
      <li class="bulletList">Storing multiple values in an array</li>
      <li class="bulletList">Casting and converting between types</li>
      <li class="bulletList">Handling exceptions</li>
      <li class="bulletList">Checking for overflow</li>
    </ul>
    <h1 id="_idParaDest-182" class="heading-1">Operating on variables</h1>
    <p class="normal"><strong class="keyWord">Operators</strong> apply simple <a id="_idIndexMarker294"/>operations such as <a id="_idIndexMarker295"/>addition and multiplication to <strong class="keyWord">operands</strong> such as <a id="_idIndexMarker296"/>variables and literal values. Operators return a new value that is the result of the operation and can be assigned to a variable, and they can also affect the operands.</p>
    <h2 id="_idParaDest-183" class="heading-2">Understanding binary operators</h2>
    <p class="normal">Most operators are <strong class="keyWord">binary</strong>, meaning that<a id="_idIndexMarker297"/> they work on two operands, as shown in the <a id="_idIndexMarker298"/>following pseudocode:</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">var</span> resultOfOperation = firstOperand <span class="hljs-keyword">operator</span> secondOperand;
</code></pre>
    <p class="normal">Examples of binary operators include adding and multiplying, as shown in the following code:</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-built_in">int</span> x = <span class="hljs-number">5</span>;
<span class="hljs-built_in">int</span> y = <span class="hljs-number">3</span>;
<span class="hljs-built_in">int</span> resultOfAdding = x + y;
<span class="hljs-built_in">int</span> resultOfMultiplying = x * y;
</code></pre>
    <h2 id="_idParaDest-184" class="heading-2">Understanding unary operators</h2>
    <p class="normal">Some operators are <strong class="keyWord">unary</strong>, meaning they <a id="_idIndexMarker299"/>work on a single operand and can be applied <a id="_idIndexMarker300"/>before or after the operand, as shown in the following pseudocode:</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">var</span> resultOfOperationAfter = onlyOperand <span class="hljs-keyword">operator</span>;
<span class="hljs-keyword">var</span> resultOfOperationBefore = <span class="hljs-keyword">operator</span> onlyOperand;
</code></pre>
    <p class="normal">Examples of unary operators include incrementors and retrieving a type or its size in bytes, as shown in the following code:</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-built_in">int</span> x = <span class="hljs-number">5</span>;
<span class="hljs-built_in">int</span> postfixIncrement = x++;
<span class="hljs-built_in">int</span> prefixIncrement = ++x;
Type theTypeOfAnInteger = <span class="hljs-keyword">typeof</span>(<span class="hljs-built_in">int</span>);
<span class="hljs-built_in">string</span> nameOfVariable = <span class="hljs-keyword">nameof</span>(x);
<span class="hljs-built_in">int</span> howManyBytesInAnInteger = <span class="hljs-keyword">sizeof</span>(<span class="hljs-built_in">int</span>);
</code></pre>
    <h2 id="_idParaDest-185" class="heading-2">Understanding ternary operators</h2>
    <p class="normal">A <strong class="keyWord">ternary</strong> operator works on three <a id="_idIndexMarker301"/>operands, as shown in the following<a id="_idIndexMarker302"/> pseudocode:</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">var</span> resultOfOperation = firstOperand firstOperator
  secondOperand secondOperator thirdOperand;
</code></pre>
    <p class="normal">An example of a ternary operator is the conditional operator <code class="inlineCode">?:</code>, which acts like a simplified <code class="inlineCode">if</code> statement. The first operand is a Boolean expression, the second operand is a value to return if it is <code class="inlineCode">true</code>, and the third operand is a value to return if it is <code class="inlineCode">false</code>, as shown in the following code:</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment">// Syntax of conditional operator.</span>
<span class="hljs-keyword">var</span> result = boolean_expression ? value_if_true : value_if_false;
<span class="hljs-comment">// Example of conditional operator.</span>
<span class="hljs-built_in">string</span> result = x &gt; <span class="hljs-number">3</span> ? <span class="hljs-string">"Greater than 3"</span> : <span class="hljs-string">"Less than or equal to 3"</span>;
<span class="hljs-comment">// Equivalent using an if statement.</span>
<span class="hljs-built_in">string</span> result;
<span class="hljs-keyword">if</span> (x &gt; <span class="hljs-number">3</span>)
{
  result = <span class="hljs-string">"Greater than 3"</span>;
}
<span class="hljs-keyword">else</span>
{
  result = <span class="hljs-string">"Less than or equal to 3"</span>;
}
</code></pre>
    <p class="normal">More experienced C# developers adopt ternary operators as much as possible because they are concise and can result in cleaner code once you are used to reading them.</p>
    <h2 id="_idParaDest-186" class="heading-2">Exploring unary operators</h2>
    <p class="normal">Two common unary operators <a id="_idIndexMarker303"/>are used to increment, <code class="inlineCode">++</code>, and decrement, <code class="inlineCode">--</code>, a number. Let us<a id="_idIndexMarker304"/> write some example code to show how they work:</p>
    <ol>
      <li class="numberedList" value="1">If you’ve completed the previous chapters, then you will already have a <code class="inlineCode">cs13net9</code> folder. If not, then you’ll need to create it.</li>
      <li class="numberedList">Use your preferred code editor to create a new solution and project, as defined in the following list:<ul>
          <li class="bulletList level-2">Project template: <strong class="screenText">Console App</strong> / <code class="inlineCode">console</code></li>
          <li class="bulletList level-2">Project file and folder: <code class="inlineCode">Operators</code></li>
          <li class="bulletList level-2">Solution file and folder: <code class="inlineCode">Chapter03</code></li>
          <li class="bulletList level-2"><strong class="screenText">Do not use top-level statements</strong>: Cleared</li>
          <li class="bulletList level-2"><strong class="screenText">Enable native AOT publish</strong>: Cleared</li>
        </ul>
      </li>
      <li class="numberedList">In <code class="inlineCode">Operators.csproj</code>, add a new <code class="inlineCode">&lt;ItemGroup&gt;</code> section to statically import <code class="inlineCode">System.Console</code> for all C# files using the <code class="inlineCode">implicit usings</code> .NET SDK feature, as shown in the following markup:
        <pre class="programlisting code-one"><code class="hljs-code">&lt;ItemGroup&gt;
  &lt;Using Include=<span class="hljs-string">"</span><span class="hljs-string">System.Console"</span> Static=<span class="hljs-string">"true"</span> /&gt;
&lt;/ItemGroup&gt;
</code></pre>
      </li>
      <li class="numberedList">In <code class="inlineCode">Program.cs</code>, delete the existing statements and then declare two integer variables named <code class="inlineCode">a</code> and <code class="inlineCode">b</code>; set <code class="inlineCode">a</code> to <code class="inlineCode">3</code>, increment <code class="inlineCode">a</code> while assigning the result to <code class="inlineCode">b</code>, and then output their values, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-meta">#region Exploring unary operators</span>
<span class="hljs-built_in">int</span> a = <span class="hljs-number">3</span>;
<span class="hljs-built_in">int</span> b = a++;
WriteLine(<span class="hljs-string">$"a is </span><span class="hljs-subst">{a}</span><span class="hljs-string">, b is </span><span class="hljs-subst">{b}</span><span class="hljs-string">"</span>);
<span class="hljs-meta">#endregion</span>
</code></pre>
      </li>
    </ol>
    <div class="packt_tip-one">
      <p class="normal"><strong class="keyWord">Good Practice</strong>: I recommend wrapping the statements for each section in <code class="inlineCode">#region</code> and <code class="inlineCode">#endregion</code> (as shown in the preceding code) so that you can easily collapse the sections. But I will not show this in future code tasks to save space.</p>
    </div>
    <ol>
      <li class="numberedList" value="5">Before running<a id="_idIndexMarker305"/> the console app, ask yourself a question: what do you think the value of <code class="inlineCode">b</code> will be when output? Once you’ve thought <a id="_idIndexMarker306"/>about that, run the code and compare your prediction against the actual result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">a is 4, b is 3
</code></pre>
      </li>
    </ol>
    <div class="note-one">
      <p class="normal">The variable <code class="inlineCode">b</code> has the value <code class="inlineCode">3</code> because the <code class="inlineCode">++</code> operator executes <em class="italic">after</em> the assignment; this<a id="_idIndexMarker307"/> is known as a <strong class="keyWord">postfix operator</strong>. If you need to increment <em class="italic">before</em> the assignment, then <a id="_idIndexMarker308"/>use the <strong class="keyWord">prefix operator</strong>.</p>
    </div>
    <ol>
      <li class="numberedList" value="6">Copy and paste the statements, and then modify them to rename the variables and use the prefix operator, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-built_in">int</span> c = <span class="hljs-number">3</span>;
<span class="hljs-built_in">int</span> d = ++c; <span class="hljs-comment">// Prefix means increment c before assigning it.</span>
WriteLine(<span class="hljs-string">$"c is </span><span class="hljs-subst">{c}</span><span class="hljs-string">, d is </span><span class="hljs-subst">{d}</span><span class="hljs-string">"</span>);
</code></pre>
      </li>
      <li class="numberedList">Rerun the code and note the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">a is 4, b is 3
c is 4, d is 4
</code></pre>
      </li>
    </ol>
    <div class="packt_tip-one">
      <p class="normal"><strong class="keyWord">Good Practice</strong>: Due to the confusion between the prefix and postfix for the increment and decrement operators when combined with an assignment, the Swift programming language designers decided to drop support for this operator in version 3. My recommendation for usage in C# is to never combine the use of the <code class="inlineCode">++</code> and <code class="inlineCode">--</code> operators <a id="_idIndexMarker309"/>with an assignment operator, <code class="inlineCode">=</code>. Perform the operations as separate statements.</p>
    </div>
    <h2 id="_idParaDest-187" class="heading-2">Exploring binary arithmetic operators</h2>
    <p class="normal">Increment and decrement are unary arithmetic operators. Other arithmetic operators are usually binary and <a id="_idIndexMarker310"/>allow you to perform arithmetic operations on two<a id="_idIndexMarker311"/> numbers, as the following shows:</p>
    <ol>
      <li class="numberedList" value="1">Add statements to declare and assign values to two integer variables named <code class="inlineCode">e</code> and <code class="inlineCode">f</code>, and then apply the five common binary arithmetic operators to the two numbers, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-built_in">int</span> e = <span class="hljs-number">11</span>;
<span class="hljs-built_in">int</span> f = <span class="hljs-number">3</span>;
WriteLine(<span class="hljs-string">$"e is </span><span class="hljs-subst">{e}</span><span class="hljs-string">, f is </span><span class="hljs-subst">{f}</span><span class="hljs-string">"</span>);
WriteLine(<span class="hljs-string">$"e + f = </span><span class="hljs-subst">{e + f}</span><span class="hljs-string">"</span>);
WriteLine(<span class="hljs-string">$"e - f = </span><span class="hljs-subst">{e - f}</span><span class="hljs-string">"</span>);
WriteLine(<span class="hljs-string">$"e * f = </span><span class="hljs-subst">{e * f}</span><span class="hljs-string">"</span>);
WriteLine(<span class="hljs-string">$"e / f = </span><span class="hljs-subst">{e / f}</span><span class="hljs-string">"</span>);
WriteLine(<span class="hljs-string">$"e % f = </span><span class="hljs-subst">{e % f}</span><span class="hljs-string">"</span>);
</code></pre>
      </li>
      <li class="numberedList">Run the code and note the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">e is 11, f is 3
e + f = 14
e - f = 8
e * f = 33
e / f = 3
e % f = 2
</code></pre>
      </li>
    </ol>
    <p class="normal-one">To understand the divide <code class="inlineCode">/</code> and modulo <code class="inlineCode">%</code> operators when applied to integers, you need to think back to primary school. Imagine you have eleven sweets and three friends.</p>
    <p class="normal-one">How can you divide the sweets between your friends? You can give three sweets to<a id="_idIndexMarker312"/> each of your friends, and there will be two left over. Those two sweets are the <strong class="keyWord">modulus</strong>, also known <a id="_idIndexMarker313"/>as the <strong class="keyWord">remainder</strong> after dividing. If you had <a id="_idIndexMarker314"/>twelve sweets, then each friend would get four of them, and there would be none left over, so the remainder would be zero.</p>
    <ol>
      <li class="numberedList" value="3">Add statements to <a id="_idIndexMarker315"/>declare and assign a value to a <code class="inlineCode">double</code> variable named <code class="inlineCode">g</code> to show the difference between whole-number and real-number divisions, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-built_in">double</span> g = <span class="hljs-number">11.0</span>;
WriteLine(<span class="hljs-string">$"g is </span><span class="hljs-subst">{g:N1}</span><span class="hljs-string">, f is </span><span class="hljs-subst">{f}</span><span class="hljs-string">"</span>);
WriteLine(<span class="hljs-string">$"g / f = </span><span class="hljs-subst">{g / f}</span><span class="hljs-string">"</span>);
</code></pre>
      </li>
      <li class="numberedList">Run the code and note the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">g is 11.0, f is 3
g / f = 3.6666666666666665
</code></pre>
      </li>
    </ol>
    <p class="normal">If the first operand is a floating-point number, such as <code class="inlineCode">g</code> with the value <code class="inlineCode">11.0</code>, then the divide operator returns a floating-point value, such as <code class="inlineCode">3.6666666666665</code>, rather than a whole number.</p>
    <h2 id="_idParaDest-188" class="heading-2">Assignment operators</h2>
    <p class="normal">You have already been using the <a id="_idIndexMarker316"/>most common assignment operator, <code class="inlineCode">=</code>.</p>
    <p class="normal">To make your code more<a id="_idIndexMarker317"/> concise, you can combine the assignment operator with other operators like arithmetic operators, as shown in the following code:</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-built_in">int</span> p = <span class="hljs-number">6</span>;
p += <span class="hljs-number">3</span>; <span class="hljs-comment">// Equivalent to: p = p + 3;</span>
p -= <span class="hljs-number">3</span>; <span class="hljs-comment">// Equivalent to: p = p - 3;</span>
p *= <span class="hljs-number">3</span>; <span class="hljs-comment">// Equivalent to: p = p * 3;</span>
p /= <span class="hljs-number">3</span>; <span class="hljs-comment">// Equivalent to: p = p / 3;</span>
</code></pre>
    <h2 id="_idParaDest-189" class="heading-2">Null-coalescing operators</h2>
    <p class="normal">Related operators to the<a id="_idIndexMarker318"/> assignment operators are the null-coalescing operators. Sometimes, you want to either assign a variable to a result or, if the variable is <code class="inlineCode">null</code>, assign an alternative value.</p>
    <p class="normal">You can do this using the<a id="_idIndexMarker319"/> null-coalescing operators, <code class="inlineCode">??</code> or <code class="inlineCode">??=</code>, as shown in the following code:</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-built_in">string</span>? authorName = GetAuthorName(); <span class="hljs-comment">// A fictional function.</span>
<span class="hljs-comment">// The maxLength variable will be the length of authorName if it is</span>
<span class="hljs-comment">// not null, or 30 if authorName is null.</span>
<span class="hljs-built_in">int</span> maxLength = authorName?.Length ?? <span class="hljs-number">30</span>;
<span class="hljs-comment">// The authorName variable will be "unknown" if authorName was null.</span>
authorName ??= <span class="hljs-string">"unknown"</span>;
</code></pre>
    <h2 id="_idParaDest-190" class="heading-2">Exploring logical operators</h2>
    <p class="normal">Logical operators operate on Boolean<a id="_idIndexMarker320"/> values, so they return either <code class="inlineCode">true</code> or <code class="inlineCode">false</code>. Let’s explore binary logical operators that operate on two Boolean values, traditionally<a id="_idIndexMarker321"/> named <code class="inlineCode">p</code> and <code class="inlineCode">q</code> in mathematics:</p>
    <ol>
      <li class="numberedList" value="1">In <code class="inlineCode">Program.cs</code>, add statements to declare two Boolean variables, <code class="inlineCode">p</code> and <code class="inlineCode">q</code>, with values of <code class="inlineCode">true</code> and <code class="inlineCode">false</code>, and then output truth tables showing the results of applying AND, OR, and XOR (exclusive OR) logical operators, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-built_in">bool</span> p = <span class="hljs-literal">true</span>;
<span class="hljs-built_in">bool</span> q = <span class="hljs-literal">false</span>;
WriteLine(<span class="hljs-string">$"AND  | p     | q    "</span>);
WriteLine(<span class="hljs-string">$"p    | </span><span class="hljs-subst">{p &amp; p,</span><span class="hljs-number">-5</span><span class="hljs-subst">}</span><span class="hljs-string"> | </span><span class="hljs-subst">{p &amp; q,</span><span class="hljs-number">-5</span><span class="hljs-subst">}</span><span class="hljs-string"> "</span>);
WriteLine(<span class="hljs-string">$"q    | </span><span class="hljs-subst">{q &amp; p,</span><span class="hljs-number">-5</span><span class="hljs-subst">}</span><span class="hljs-string"> | </span><span class="hljs-subst">{q &amp; q,</span><span class="hljs-number">-5</span><span class="hljs-subst">}</span><span class="hljs-string"> "</span>);
WriteLine();
WriteLine(<span class="hljs-string">$"OR   | p     | q    "</span>);
WriteLine(<span class="hljs-string">$"p    | </span><span class="hljs-subst">{p | p,</span><span class="hljs-number">-5</span><span class="hljs-subst">}</span><span class="hljs-string"> | </span><span class="hljs-subst">{p | q,</span><span class="hljs-number">-5</span><span class="hljs-subst">}</span><span class="hljs-string"> "</span>);
WriteLine(<span class="hljs-string">$"q    | </span><span class="hljs-subst">{q | p,</span><span class="hljs-number">-5</span><span class="hljs-subst">}</span><span class="hljs-string"> | </span><span class="hljs-subst">{q | q,</span><span class="hljs-number">-5</span><span class="hljs-subst">}</span><span class="hljs-string"> "</span>);
WriteLine();
WriteLine(<span class="hljs-string">$"XOR  | p     | q    "</span>);
WriteLine(<span class="hljs-string">$"p    | </span><span class="hljs-subst">{p ^ p,</span><span class="hljs-number">-5</span><span class="hljs-subst">}</span><span class="hljs-string"> | </span><span class="hljs-subst">{p ^ q,</span><span class="hljs-number">-5</span><span class="hljs-subst">}</span><span class="hljs-string"> "</span>);
WriteLine(<span class="hljs-string">$"q    | </span><span class="hljs-subst">{q ^ p,</span><span class="hljs-number">-5</span><span class="hljs-subst">}</span><span class="hljs-string"> | </span><span class="hljs-subst">{q ^ q,</span><span class="hljs-number">-5</span><span class="hljs-subst">}</span><span class="hljs-string"> "</span>);
</code></pre>
      </li>
    </ol>
    <div class="note-one">
      <p class="normal">Remember that <code class="inlineCode">,-5</code> means left-align within a five-width column.</p>
    </div>
    <ol>
      <li class="numberedList" value="2">Run the code and <a id="_idIndexMarker322"/>note the results, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">AND  | p     | q
p    | True  | False
q    | False | False
OR   | p     | q
p    | True  | True
q    | True  | False
XOR  | p     | q
p    | False | True
q    | True  | False
</code></pre>
      </li>
    </ol>
    <p class="normal">For the AND <code class="inlineCode">&amp;</code> logical operator, both <a id="_idIndexMarker323"/>operands must be <code class="inlineCode">true</code> for the result to be <code class="inlineCode">true</code>. For the OR <code class="inlineCode">|</code> logical operator, either operand can be <code class="inlineCode">true</code> for the result to be <code class="inlineCode">true</code>. For the XOR <code class="inlineCode">^</code> logical operator, either operand can be <code class="inlineCode">true</code> (but not both!) for the result to be <code class="inlineCode">true</code>.</p>
    <h2 id="_idParaDest-191" class="heading-2">Exploring conditional logical operators</h2>
    <p class="normal">Conditional logical operators are<a id="_idIndexMarker324"/> like logical operators, but you use two <a id="_idIndexMarker325"/>symbols instead of one, for example, <code class="inlineCode">&amp;&amp;</code> instead of <code class="inlineCode">&amp;</code>, or <code class="inlineCode">||</code> instead of <code class="inlineCode">|</code>.</p>
    <p class="normal">In <em class="chapterRef">Chapter 4</em>, <em class="italic">Writing, Debugging, and Testing Functions</em>, you will learn about functions in more detail, but I need to introduce functions now to explain conditional logical operators, also known as short-circuiting Boolean operators.</p>
    <p class="normal">A function executes statements and then returns a value. That value could be a Boolean value like <code class="inlineCode">true</code> that is used in a Boolean operation. Let’s make use of conditional logical operators:</p>
    <ol>
      <li class="numberedList" value="1">At the bottom of <code class="inlineCode">Program.cs</code>, write statements to declare a function that writes a message<a id="_idIndexMarker326"/> to the console and returns <code class="inlineCode">true</code>, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword">static</span><span class="hljs-function"> </span><span class="hljs-built_in">bool</span><span class="hljs-function"> </span><span class="hljs-title">DoStuff</span><span class="hljs-function">()</span>
{
  WriteLine(<span class="hljs-string">"I am doing some stuff."</span>);
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
}
</code></pre>
      </li>
    </ol>
    <div class="note-one">
      <p class="normal">Local functions can be anywhere within the statements in <code class="inlineCode">Program.cs</code> that use the top-level program feature but it is good practice to put them at the bottom of the file.</p>
    </div>
    <ol>
      <li class="numberedList" value="2">After the previous <code class="inlineCode">WriteLine</code> statements, perform an AND <code class="inlineCode">&amp;</code> operation on the <code class="inlineCode">p</code> and <code class="inlineCode">q</code> variables, and the result of calling the function, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">WriteLine();
<span class="hljs-comment">// Note that DoStuff() returns true.</span>
WriteLine(<span class="hljs-string">$"p &amp; DoStuff() = </span><span class="hljs-subst">{p &amp; DoStuff()}</span><span class="hljs-string">"</span>);
WriteLine(<span class="hljs-string">$"q &amp; DoStuff() = </span><span class="hljs-subst">{q &amp; DoStuff()}</span><span class="hljs-string">"</span>);
</code></pre>
      </li>
      <li class="numberedList">Run the code, view the result, and note that the function was called twice, once for <code class="inlineCode">p</code> and once for <code class="inlineCode">q</code>, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">I am doing some stuff.
p &amp; DoStuff() = True
I am doing some stuff.
q &amp; DoStuff() = False
</code></pre>
      </li>
      <li class="numberedList">Copy and paste the three statements and then change the <code class="inlineCode">&amp;</code> operators into <code class="inlineCode">&amp;&amp;</code> operators, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">WriteLine();
WriteLine(<span class="hljs-string">$"p &amp;&amp; DoStuff() = </span><span class="hljs-subst">{p &amp;&amp; DoStuff()}</span><span class="hljs-string">"</span>);
WriteLine(<span class="hljs-string">$"q &amp;&amp; DoStuff() = </span><span class="hljs-subst">{q &amp;&amp; DoStuff()}</span><span class="hljs-string">"</span>);
</code></pre>
      </li>
      <li class="numberedList">Run the code, view the<a id="_idIndexMarker327"/> result, and note that the function does run when combined with the <code class="inlineCode">p</code> variable. It does not run when combined with the <code class="inlineCode">q</code> variable because the <code class="inlineCode">q</code> variable is <code class="inlineCode">false</code> so the result will be <code class="inlineCode">false</code> anyway, so it does not need to execute the function, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">I am doing some stuff.
p &amp;&amp; DoStuff() = True
q &amp;&amp; DoStuff() = False // DoStuff function was not executed!
</code></pre>
        <div class="packt_tip-one">
          <p class="normal"><strong class="keyWord">Good Practice</strong>: Now you can see why the conditional logical operators are described as being short-circuiting. They can make your apps more efficient, but they can also introduce subtle bugs in cases where you assume that the function will always be called. It is safest to avoid them when used in combination with functions that cause side effects.</p>
        </div>
      </li>
    </ol>
    <h2 id="_idParaDest-192" class="heading-2">Exploring bitwise and binary shift operators</h2>
    <p class="normal">Bitwise operators compare the bits in<a id="_idIndexMarker328"/> the binary representation of a number. Each bit, either the <code class="inlineCode">0</code> (zero) or <code class="inlineCode">1</code> (one) value, is compared individually to the bit in the same column.</p>
    <p class="normal">Binary shift operators <a id="_idIndexMarker329"/>can perform some common arithmetic calculations much faster <a id="_idIndexMarker330"/>than traditional operators, for example, any multiplication by a factor of 2.</p>
    <p class="normal">Let’s explore bitwise and binary shift operators:</p>
    <ol>
      <li class="numberedList" value="1">In <code class="inlineCode">Program.cs</code>, add statements to declare two integer variables named <code class="inlineCode">x</code> and <code class="inlineCode">y</code> with values <code class="inlineCode">10</code> and <code class="inlineCode">6</code>, and then output the results of applying AND, OR, and XOR bitwise<a id="_idIndexMarker331"/> operators, as shown in the following <a id="_idIndexMarker332"/>code:
        <pre class="programlisting code-one"><code class="hljs-code">WriteLine();
<span class="hljs-built_in">int</span> x = <span class="hljs-number">10</span>;
<span class="hljs-built_in">int</span> y = <span class="hljs-number">6</span>;
WriteLine(<span class="hljs-string">$"Expression | Decimal |   Binary"</span>);
WriteLine(<span class="hljs-string">$"-------------------------------"</span>);
WriteLine(<span class="hljs-string">$"x          | </span><span class="hljs-subst">{x,</span><span class="hljs-number">7</span><span class="hljs-subst">}</span><span class="hljs-string"> | </span><span class="hljs-subst">{x:B8}</span><span class="hljs-string">"</span>);
WriteLine(<span class="hljs-string">$"y          | </span><span class="hljs-subst">{y,</span><span class="hljs-number">7</span><span class="hljs-subst">}</span><span class="hljs-string"> | </span><span class="hljs-subst">{y:B8}</span><span class="hljs-string">"</span>);
WriteLine(<span class="hljs-string">$"x &amp; y      | </span><span class="hljs-subst">{x &amp; y,</span><span class="hljs-number">7</span><span class="hljs-subst">}</span><span class="hljs-string"> | </span><span class="hljs-subst">{x &amp; y:B8}</span><span class="hljs-string">"</span>);
WriteLine(<span class="hljs-string">$"x | y      | </span><span class="hljs-subst">{x | y,</span><span class="hljs-number">7</span><span class="hljs-subst">}</span><span class="hljs-string"> | </span><span class="hljs-subst">{x | y:B8}</span><span class="hljs-string">"</span>);
WriteLine(<span class="hljs-string">$"x ^ y      | </span><span class="hljs-subst">{x ^ y,</span><span class="hljs-number">7</span><span class="hljs-subst">}</span><span class="hljs-string"> | </span><span class="hljs-subst">{x ^ y:B8}</span><span class="hljs-string">"</span>);
</code></pre>
      </li>
    </ol>
    <div class="note-one">
      <p class="normal">Remember that <code class="inlineCode">,7</code> means right-align in a seven-width column and <code class="inlineCode">:B8</code> means format in binary with eight digits.</p>
    </div>
    <ol>
      <li class="numberedList" value="2">Run the code <a id="_idIndexMarker333"/>and note the results, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">Expression | Decimal |   Binary
-------------------------------
x          |      10 | 00001010
y          |       6 | 00000110
x &amp; y      |       2 | 00000010
x | y      |      14 | 00001110
x ^ y      |      12 | 00001100
</code></pre>
        <div class="note-one">
          <p class="normal">For <code class="inlineCode">x &amp; y</code>, only the 2-bit column is set. For <code class="inlineCode">x | y</code>, the 8-, 4-, and 2-bit columns are set. For <code class="inlineCode">x ^ y</code>, the 8- and 4-bit columns are set.</p>
        </div>
      </li>
    </ol>
    <ol>
      <li class="numberedList" value="3">In <code class="inlineCode">Program.cs</code>, add statements to output the results of applying the left-shift operator to move<a id="_idIndexMarker334"/> the bits of the variable <code class="inlineCode">x</code> by three columns, multiplying <code class="inlineCode">x</code> by 8, and <a id="_idIndexMarker335"/>right-shifting the bits of the variable <code class="inlineCode">y</code> by one column, as shown in the following <a id="_idIndexMarker336"/>code:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-comment">// Left-shift x by three bit columns.</span>
WriteLine(<span class="hljs-string">$"x &lt;&lt; 3     | </span><span class="hljs-subst">{x &lt;&lt; </span><span class="hljs-number">3</span><span class="hljs-subst">,</span><span class="hljs-number">7</span><span class="hljs-subst">}</span><span class="hljs-string"> | </span><span class="hljs-subst">{x &lt;&lt; </span><span class="hljs-number">3</span><span class="hljs-subst">:B8}</span><span class="hljs-string">"</span>);
<span class="hljs-comment">// Multiply x by 8.</span>
WriteLine(<span class="hljs-string">$"x * 8      | </span><span class="hljs-subst">{x * </span><span class="hljs-number">8</span><span class="hljs-subst">,</span><span class="hljs-number">7</span><span class="hljs-subst">}</span><span class="hljs-string"> | </span><span class="hljs-subst">{x * </span><span class="hljs-number">8</span><span class="hljs-subst">:B8}</span><span class="hljs-string">"</span>);
<span class="hljs-comment">// Right-shift y by one bit column.</span>
WriteLine(<span class="hljs-string">$"y &gt;&gt; 1     | </span><span class="hljs-subst">{y &gt;&gt; </span><span class="hljs-number">1</span><span class="hljs-subst">,</span><span class="hljs-number">7</span><span class="hljs-subst">}</span><span class="hljs-string"> | </span><span class="hljs-subst">{y &gt;&gt; </span><span class="hljs-number">1</span><span class="hljs-subst">:B8}</span><span class="hljs-string">"</span>);
</code></pre>
      </li>
      <li class="numberedList">Run the code and note the results, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">x &lt;&lt; 3     |      80 | 01010000
x * 8      |      80 | 01010000
y &gt;&gt; 1     |       3 | 00000011
</code></pre>
      </li>
    </ol>
    <p class="normal">The <code class="inlineCode">80</code> result is because the bits in it were shifted three columns to the left, so the 1 bits moved into the 64- and 16-bit columns, and 64 + 16 = 80. This is the equivalent of multiplying by 8, but CPUs can perform a bit-shift faster. The <code class="inlineCode">3</code> result is because the 1 bits in <code class="inlineCode">y</code> were shifted one column into the 2- and 1-bit columns.</p>
    <div class="packt_tip">
      <p class="normal"><strong class="keyWord">Good Practice</strong>: Remember that when operating on integer values, the <code class="inlineCode">&amp;</code> and <code class="inlineCode">|</code> symbols are bitwise operators, and when operating on Boolean values like <code class="inlineCode">true</code> and <code class="inlineCode">false</code>, the <code class="inlineCode">&amp;</code> and <code class="inlineCode">|</code> symbols are logical operators.</p>
    </div>
    <h2 id="_idParaDest-193" class="heading-2">Miscellaneous operators</h2>
    <p class="normal"><code class="inlineCode">nameof</code> and <code class="inlineCode">sizeof</code> are convenient operators when working with types:</p>
    <ul>
      <li class="bulletList"><code class="inlineCode">nameof</code> returns the short <a id="_idIndexMarker337"/>name (without the namespace) of a variable, type, or member as a <code class="inlineCode">string</code> value, which is useful when outputting exception <a id="_idIndexMarker338"/>messages.</li>
      <li class="bulletList"><code class="inlineCode">sizeof</code> returns the size in bytes of simple types, which is useful for determining the efficiency of<a id="_idIndexMarker339"/> data storage. Technically, the <code class="inlineCode">sizeof</code> operator requires an unsafe code block, but the sizes of value types with a C# alias, like <code class="inlineCode">int</code> and <code class="inlineCode">double</code>, are hardcoded as constants by the compiler so they do not need an unsafe block.</li>
    </ul>
    <p class="normal">For example:</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-built_in">int</span> age = <span class="hljs-number">50</span>;
WriteLine(<span class="hljs-string">$"The </span><span class="hljs-subst">{</span><span class="hljs-keyword">nameof</span><span class="hljs-subst">(age)}</span><span class="hljs-string"> variable uses </span><span class="hljs-subst">{</span><span class="hljs-keyword">sizeof</span><span class="hljs-subst">(</span><span class="hljs-built_in">int</span><span class="hljs-subst">)}</span><span class="hljs-string"> bytes of memory."</span>);
</code></pre>
    <p class="normal">There are many other operators; for example, the dot between a variable and its members is called the <strong class="keyWord">member access operator</strong> and the round brackets at the end of a function or method<a id="_idIndexMarker340"/> name are called the <strong class="keyWord">invocation operator</strong>, as shown<a id="_idIndexMarker341"/> in the following code:</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-built_in">int</span> age = <span class="hljs-number">50</span>;
<span class="hljs-comment">// How many operators in the following statement?</span>
<span class="hljs-built_in">char</span> firstDigit = age.ToString()[<span class="hljs-number">0</span>];
<span class="hljs-comment">// There are four operators:</span>
<span class="hljs-comment">// = is the assignment operator</span>
<span class="hljs-comment">// . is the member access operator</span>
<span class="hljs-comment">// () is the invocation operator</span>
<span class="hljs-comment">// [] is the indexer access operator</span>
</code></pre>
    <h1 id="_idParaDest-194" class="heading-1">Understanding selection statements</h1>
    <p class="normal">Every application needs to be able to select from choices and branch along different code paths. The two <a id="_idIndexMarker342"/>selection statements in C# are <code class="inlineCode">if</code> and <code class="inlineCode">switch</code>. You can use <code class="inlineCode">if</code> for all your code, but <code class="inlineCode">switch</code> can simplify your code in some common scenarios, such as when there is a single variable that can have multiple values that each require different processing.</p>
    <h2 id="_idParaDest-195" class="heading-2">Branching with the if statement</h2>
    <p class="normal">The <code class="inlineCode">if</code> statement determines which<a id="_idIndexMarker343"/> branch to follow by<a id="_idIndexMarker344"/> evaluating a Boolean expression. If the expression is <code class="inlineCode">true</code>, then the block executes. The <code class="inlineCode">else</code> block is optional, and it executes if the <code class="inlineCode">if</code> expression is <code class="inlineCode">false</code>. The <code class="inlineCode">if</code> statement can be nested.</p>
    <p class="normal">The <code class="inlineCode">if</code> statement can be combined with other <code class="inlineCode">if</code> statements as <code class="inlineCode">else if</code> branches, as shown in the following code:</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">if</span> (expression1)
{
  <span class="hljs-comment">// Executes if expression1 is true.</span>
}
<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (expression2)
{
  <span class="hljs-comment">// Executes if expression1 is false and expression2 is true.</span>
}
<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (expression3)
{
  <span class="hljs-comment">// Executes if expression1 and expression2 are false</span>
  <span class="hljs-comment">// and expression3 is true.</span>
}
<span class="hljs-keyword">else</span>
{
  <span class="hljs-comment">// Executes if all expressions are false.</span>
}
</code></pre>
    <p class="normal">Each <code class="inlineCode">if</code> statement’s Boolean expression is independent of the others and, unlike <code class="inlineCode">switch</code> statements, does not need to reference a single value.</p>
    <p class="normal">Let’s write some code to <a id="_idIndexMarker345"/>explore selection statements like <code class="inlineCode">if</code>:</p>
    <ol>
      <li class="numberedList" value="1">Use your preferred <a id="_idIndexMarker346"/>code editor to add a new <strong class="screenText">Console App </strong>/ <code class="inlineCode">console</code> project named <code class="inlineCode">SelectionStatements</code> to the <code class="inlineCode">Chapter03</code> solution.</li>
    </ol>
    <div class="note-one">
      <p class="normal">Remember to statically import <code class="inlineCode">System.Console</code> in your project file. If you are using Visual Studio, then configure the startup project to be the current selection.</p>
    </div>
    <ol>
      <li class="numberedList" value="2">In <code class="inlineCode">Program.cs</code>, delete the existing statements and then add statements to check if a password is at least eight characters long, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-built_in">string</span> password = <span class="hljs-string">"ninja"</span>;
<span class="hljs-keyword">if</span> (password.Length &lt; <span class="hljs-number">8</span>)
{
  WriteLine(<span class="hljs-string">"Your password is too short. Use at least 8 chars."</span>);
}
<span class="hljs-keyword">else</span>
{
  WriteLine(<span class="hljs-string">"Your password is strong."</span>);
}
</code></pre>
      </li>
      <li class="numberedList">Run the code and note the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">Your password is too short. Use at least 8 chars.
</code></pre>
      </li>
    </ol>
    <h3 id="_idParaDest-196" class="heading-3">Why you should always use braces with if statements</h3>
    <p class="normal">As there is only a single statement<a id="_idIndexMarker347"/> inside each block, the<a id="_idIndexMarker348"/> preceding code could be written without the curly braces, as shown in the following code:</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">if</span> (password.Length &lt; <span class="hljs-number">8</span>)
  WriteLine(<span class="hljs-string">"Your password is too short. Use at least 8 chars."</span>);
<span class="hljs-keyword">else</span>
  WriteLine(<span class="hljs-string">"Your password is strong."</span>);
</code></pre>
    <p class="normal">This style of <code class="inlineCode">if</code> statement should be <a id="_idIndexMarker349"/>avoided because it can introduce serious bugs. An infamous example is the #gotofail bug in Apple’s iPhone iOS operating system. For 18 months after Apple’s iOS 6 was released, in September 2012, it had a bug due to an <code class="inlineCode">if</code> statement without braces in its <strong class="keyWord">Secure Sockets Layer</strong> (<strong class="keyWord">SSL</strong>) encryption code. This meant that any user running<a id="_idIndexMarker350"/> Safari, the device’s web browser, who tried to connect to secure websites, such as their bank, was not properly secure because an important check was being accidentally skipped.</p>
    <p class="normal">Just because you can leave out the curly braces, doesn’t mean you should. Your code is not “more efficient” without them; instead, it is harder to read, less maintainable, and, potentially, more dangerous.</p>
    <h3 id="_idParaDest-197" class="heading-3">Pattern matching with the if statement</h3>
    <p class="normal">A feature introduced with C# 7 and later is pattern matching. The <code class="inlineCode">if</code> statement can use the <code class="inlineCode">is</code> keyword in<a id="_idIndexMarker351"/> combination with declaring a local variable to make your code safer. It is important to note that a single expression, for example, <code class="inlineCode">o is int i</code>, does two things:</p>
    <ol>
      <li class="numberedList" value="1">Checks the type of the data in a variable named <code class="inlineCode">o</code>.</li>
      <li class="numberedList">If the type check is <code class="inlineCode">true</code>, then it assigns the value to the variable named <code class="inlineCode">i</code>.</li>
    </ol>
    <div class="note">
      <p class="normal"><strong class="keyWord">More Information</strong>: You can learn more about the <code class="inlineCode">is</code> operator at the following link: <a href="https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/operators/is"><span class="url">https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/operators/is</span></a>. You will use this technique in later chapters, so keep this in mind.</p>
    </div>
    <p class="normal">Let’s see it in action:</p>
    <ol>
      <li class="numberedList" value="1">Add statements so that if the value stored in the variable named <code class="inlineCode">o</code> is an <code class="inlineCode">int</code>, then the value is <a id="_idIndexMarker352"/>assigned to the local variable named <code class="inlineCode">i</code>, which can then be used inside the <code class="inlineCode">if</code> statement. This is safer than using the variable named <code class="inlineCode">o</code> because we know for sure that <code class="inlineCode">i</code> is an <code class="inlineCode">int</code> variable and not something else, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-comment">// Add and remove the "" to change between string and int.</span>
<span class="hljs-built_in">object</span> o = <span class="hljs-string">"3"</span>;
<span class="hljs-built_in">int</span> j = <span class="hljs-number">4</span>;
<span class="hljs-keyword">if</span> (o <span class="hljs-keyword">is</span> <span class="hljs-built_in">int</span> i)
{
  WriteLine(<span class="hljs-string">$"</span><span class="hljs-subst">{i}</span><span class="hljs-string"> x </span><span class="hljs-subst">{j}</span><span class="hljs-string"> = </span><span class="hljs-subst">{i * j}</span><span class="hljs-string">"</span>);
}
<span class="hljs-keyword">else</span>
{
  WriteLine(<span class="hljs-string">"</span><span class="hljs-string">o is not an int so it cannot multiply!"</span>);
}
</code></pre>
      </li>
      <li class="numberedList">Run the code and view the results, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">o is not an int so it cannot multiply!
</code></pre>
      </li>
      <li class="numberedList">Delete the double-quote characters around the <code class="inlineCode">"3"</code> value so that the value stored in the variable named <code class="inlineCode">o</code> is an <code class="inlineCode">int</code> type instead of a <code class="inlineCode">string</code> type.</li>
      <li class="numberedList">Rerun the code to view the results, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">3 x 4 = 12
</code></pre>
      </li>
    </ol>
    <h2 id="_idParaDest-198" class="heading-2">Branching with the switch statement</h2>
    <p class="normal">The <code class="inlineCode">switch</code> statement is different from the <code class="inlineCode">if</code> statement because <code class="inlineCode">switch</code> compares a single expression against a list <a id="_idIndexMarker353"/>of multiple possible <code class="inlineCode">case</code> statements. Every <code class="inlineCode">case</code> statement is related to the single <a id="_idIndexMarker354"/>expression. Every <code class="inlineCode">case</code> section must end with one of the following:</p>
    <ul>
      <li class="bulletList">The <code class="inlineCode">break</code> keyword (like <code class="inlineCode">case 1</code> in the following code).</li>
      <li class="bulletList">The <code class="inlineCode">goto</code> <code class="inlineCode">case</code> keywords (like <code class="inlineCode">case 2</code> in the following code).</li>
      <li class="bulletList">They should have no statements (like <code class="inlineCode">case 3</code> in the following code).</li>
      <li class="bulletList">The <code class="inlineCode">goto</code> keyword that references a named label (like <code class="inlineCode">case 5</code> in the following code).</li>
      <li class="bulletList">The <code class="inlineCode">return</code> keyword to leave the current function (not shown in the code).</li>
    </ul>
    <p class="normal">Let’s write some code to explore the <code class="inlineCode">switch</code> statements:</p>
    <ol>
      <li class="numberedList" value="1">Type the following code for a <code class="inlineCode">switch</code> statement. You should note that the penultimate statement is a label that can be jumped to, and the first statement generates a random number between 1 and 6 (the number 7 in the code is an exclusive upper bound). The <code class="inlineCode">switch</code> statement branches are based on the value of this random number, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-comment">// Inclusive lower bound but exclusive upper bound.</span>
<span class="hljs-built_in">int</span> number = Random.Shared.Next(minValue: <span class="hljs-number">1</span>, maxValue: <span class="hljs-number">7</span>);
WriteLine(<span class="hljs-string">$"My random number is </span><span class="hljs-subst">{number}</span><span class="hljs-string">"</span>);
<span class="hljs-keyword">switch</span> (number)
{
  <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:
    WriteLine(<span class="hljs-string">"One"</span>);
    <span class="hljs-keyword">break</span>; <span class="hljs-comment">// Jumps to end of switch statement.</span>
  <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:
    WriteLine(<span class="hljs-string">"Two"</span>);
    <span class="hljs-keyword">goto</span> <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>;
  <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>: <span class="hljs-comment">// Multiple case section.</span>
  <span class="hljs-keyword">case</span> <span class="hljs-number">4</span>:
    WriteLine(<span class="hljs-string">"Three or four"</span>);
    <span class="hljs-keyword">goto</span> <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>;
  <span class="hljs-keyword">case</span> <span class="hljs-number">5</span>:
    <span class="hljs-keyword">goto</span> A_label;
  <span class="hljs-literal">default</span>:
    WriteLine(<span class="hljs-string">"Default"</span>);
    <span class="hljs-keyword">break</span>;
} <span class="hljs-comment">// End of switch statement.</span>
WriteLine(<span class="hljs-string">"After end of switch"</span>);
A_label:
WriteLine(<span class="hljs-string">$"After A_label"</span>);
</code></pre>
      </li>
    </ol>
    <div class="packt_tip-one">
      <p class="normal"><strong class="keyWord">Good Practice</strong>: You can use the <code class="inlineCode">goto</code> keyword to jump to another case or a label. The <code class="inlineCode">goto</code> keyword is frowned upon by most programmers but can be a good solution to code logic in some scenarios. However, you should use it sparingly, if at all. To see how often Microsoft uses <code class="inlineCode">goto</code> in the .NET base class libraries, use the following link: <a href="https://github.com/search?q=%22goto%20%22+repo%3Adotnet%2Fruntime+language%3AC%23&amp;type=code&amp;ref=advsearch"><span class="url">https://github.com/search?q=%22goto%20%22+repo%3Adotnet%2Fruntime+language%3AC%23&amp;type=code&amp;ref=advsearch</span></a>.</p>
    </div>
    <ol>
      <li class="numberedList" value="2">Run the code<a id="_idIndexMarker355"/> multiple times to see what happens in<a id="_idIndexMarker356"/> various cases of random numbers, as shown in the following example output:
        <pre class="programlisting con-one"><code class="hljs-con">// First random run.
My random number is 4
Three or four
One
After end of switch
After A_label
// Second random run.
My random number is 2
Two
One
After end of switch
After A_label
// Third random run.
My random number is 6
Default
After end of switch
After A_label
// Fourth random run.
My random number is 1
One
After end of switch
After A_label
// Fifth random run.
My random number is 5
After A_label
</code></pre>
      </li>
    </ol>
    <div class="packt_tip">
      <p class="normal"><strong class="keyWord">Good Practice</strong>: The <code class="inlineCode">Random</code> class that we used to generate a random number has a <code class="inlineCode">Next</code> method that allows you to specify an inclusive lower bound and an exclusive upper bound and will generate a pseudo-random number. Instead of creating a new instance of <code class="inlineCode">Random</code> that is not thread-safe, since .NET 6, you can use a <code class="inlineCode">Shared</code> instance that is thread-safe so it can be used concurrently from any thread.</p>
    </div>
    <p class="normal">Now let’s take a small diversion <a id="_idIndexMarker357"/>from the <code class="inlineCode">switch</code> keyword to review how to add a new item to a project using <a id="_idIndexMarker358"/>Visual Studio because, in the next code task, you need to add a new class file to your project and I haven’t shown you how to do that yet.</p>
    <h3 id="_idParaDest-199" class="heading-3">Adding a new item to a project using Visual Studio</h3>
    <p class="normal">Visual Studio version 17.6 <a id="_idIndexMarker359"/>or later has an optional simplified dialog box for adding a new item to a project. After navigating to <strong class="screenText">Project</strong> | <strong class="screenText">Add New Item…</strong>, or right-clicking on a project in <strong class="screenText">Solution Explorer</strong> and selecting <strong class="screenText">Add</strong> | <strong class="screenText">New Item…</strong>, you will see the traditional dialog box, as shown in <em class="italic">Figure 3.1</em>:</p>
    <figure class="mediaobject"><img src="../Images/B22322_03_01.png" alt="" width="878" height="379"/></figure>
    <p class="packt_figref">Figure 3.1: Add New Item dialog box in normal view</p>
    <p class="normal">If you click the <strong class="screenText">Show Compact View</strong> button, then it switches to a simplified dialog box, as shown in <em class="italic">Figure 3.2</em>:</p>
    <figure class="mediaobject"><img src="../Images/B22322_03_02.png" alt="" width="878" height="259"/></figure>
    <p class="packt_figref">Figure 3.2: Add New Item dialog box in compact view</p>
    <p class="normal">To revert to the normal <a id="_idIndexMarker360"/>dialog box, click the <strong class="screenText">Show All Templates</strong> button.</p>
    <h3 id="_idParaDest-200" class="heading-3">Pattern matching with the switch statement</h3>
    <p class="normal">Like the <code class="inlineCode">if</code> statement, the <code class="inlineCode">switch</code> statement supports pattern matching in C# 7 and later. The <code class="inlineCode">case</code> values no longer need to be literal values; they can be patterns.</p>
    <p class="normal">In C# 7 and later, your code <a id="_idIndexMarker361"/>can more concisely branch, based on the subtype of a class, and you can declare and assign a local variable to safely use it. Additionally, <code class="inlineCode">case</code> statements can include a <code class="inlineCode">when</code> keyword to perform more specific pattern matching.</p>
    <p class="normal">Let’s see an example of pattern matching with the <code class="inlineCode">switch</code> statement using a custom class hierarchy of animals with different properties:</p>
    <div class="note">
      <p class="normal">You will learn more details about defining classes in <em class="chapterRef">Chapter 5</em>, <em class="italic">Building Your Own Types with Object-Oriented Programming</em>. For now, you should be able to get the idea from reading the code.</p>
    </div>
    <ol>
      <li class="numberedList" value="1">In the <code class="inlineCode">SelectionStatements</code> project, add a new class file named <code class="inlineCode">Animals.cs</code>:<ul>
          <li class="bulletList level-2">In Visual Studio, navigate to <strong class="screenText">Project</strong> | <strong class="screenText">Add New Item…</strong> or press <em class="keystroke">Ctrl</em> + <em class="keystroke">Shift</em> + <em class="keystroke">A</em>, type the name, and then click <strong class="screenText">Add</strong>.</li>
          <li class="bulletList level-2">In VS Code, click the <strong class="screenText">New File…</strong> button and type the name.</li>
          <li class="bulletList level-2">In Rider, right-click on the project and select <strong class="screenText">Add</strong> | <strong class="screenText">Class/Interface…</strong>.</li>
        </ul>
      </li>
      <li class="numberedList">In <code class="inlineCode">Animals.cs</code>, delete any existing statements, and then define three classes, a base class, <code class="inlineCode">Animal</code>, and two inherited classes, <code class="inlineCode">Cat</code> and <code class="inlineCode">Spider</code>, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword">class</span> <span class="hljs-title">Animal</span> <span class="hljs-comment">// This is the base type for all animals.</span>
{
  <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span>? Name;
  <span class="hljs-keyword">public</span> DateTime Born;
  <span class="hljs-keyword">public</span> <span class="hljs-built_in">byte</span> Legs;
}
<span class="hljs-keyword">class</span> <span class="hljs-title">Cat</span> : <span class="hljs-title">Animal</span> <span class="hljs-comment">// This is a subtype of animal.</span>
{
  <span class="hljs-keyword">public</span> <span class="hljs-built_in">bool</span> IsDomestic;
}
<span class="hljs-keyword">class</span> <span class="hljs-title">Spider</span> : <span class="hljs-title">Animal</span> <span class="hljs-comment">// This is another subtype of animal.</span>
{
  <span class="hljs-keyword">public</span> <span class="hljs-built_in">bool</span> IsVenomous;
}
</code></pre>
      </li>
    </ol>
    <div class="note-one">
      <p class="normal">Since this section is about pattern matching and not the most common way to define a class with fields, it is not important how the data types are declared. The <code class="inlineCode">Name</code> property has been declared nullable and the other two properties are not. You could make the <code class="inlineCode">Name</code> not-nullable and make the other two nullable and the pattern-matching example is unaffected.</p>
    </div>
    <ol>
      <li class="numberedList" value="3">In <code class="inlineCode">Program.cs</code>, add statements<a id="_idIndexMarker362"/> to declare an array of nullable animals, and then show a message based on what type and attributes each animal has, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword">var</span> animals = <span class="hljs-keyword">new</span> Animal?[]
{
  <span class="hljs-keyword">new</span> Cat { Name = <span class="hljs-string">"Karen"</span>, Born = <span class="hljs-keyword">new</span>(year: <span class="hljs-number">2022</span>, month: <span class="hljs-number">8</span>,
    day: <span class="hljs-number">23</span>), Legs = <span class="hljs-number">4</span>, IsDomestic = <span class="hljs-literal">true</span> },
  <span class="hljs-literal">null</span>,
  <span class="hljs-keyword">new</span> Cat { Name = <span class="hljs-string">"Mufasa"</span>, Born = <span class="hljs-keyword">new</span>(year: <span class="hljs-number">1994</span>, month: <span class="hljs-number">6</span>,
    day: <span class="hljs-number">12</span>) },
  <span class="hljs-keyword">new</span> Spider { Name = <span class="hljs-string">"Sid Vicious"</span>, Born = DateTime.Today,
    IsVenomous = <span class="hljs-literal">true</span>},
  <span class="hljs-keyword">new</span> Spider { Name = <span class="hljs-string">"Captain Furry"</span>, Born = DateTime.Today }
};
<span class="hljs-keyword">foreach</span> (Animal? animal <span class="hljs-keyword">in</span> animals)
{
  <span class="hljs-built_in">string</span> message;
  <span class="hljs-keyword">switch</span> (animal)
  {
    <span class="hljs-keyword">case</span> Cat fourLeggedCat <span class="hljs-keyword">when</span> fourLeggedCat.Legs == <span class="hljs-number">4</span>:
      message = <span class="hljs-string">$"The cat named </span><span class="hljs-subst">{fourLeggedCat.Name}</span><span class="hljs-string"> has four legs."</span>;
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> Cat wildCat <span class="hljs-keyword">when</span> wildCat.IsDomestic == <span class="hljs-literal">false</span>:
      message = <span class="hljs-string">$"The non-domestic cat is named </span><span class="hljs-subst">{wildCat.Name}</span><span class="hljs-string">."</span>;
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> Cat cat:
      message = <span class="hljs-string">$"The cat is named </span><span class="hljs-subst">{cat.Name}</span><span class="hljs-string">."</span>;
      <span class="hljs-keyword">break</span>;
    <span class="hljs-literal">default</span>: <span class="hljs-comment">// default is always evaluated last.</span>
      message = <span class="hljs-string">$"</span><span class="hljs-subst">{animal.Name}</span><span class="hljs-string"> is a </span><span class="hljs-subst">{animal.GetType().Name}</span><span class="hljs-string">."</span>;
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> Spider spider <span class="hljs-keyword">when</span> spider.IsVenomous:
      message = <span class="hljs-string">$"The </span><span class="hljs-subst">{spider.Name}</span><span class="hljs-string"> spider is venomous. Run!"</span>;
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-literal">null</span>:
      message = <span class="hljs-string">"The animal is null."</span>;
      <span class="hljs-keyword">break</span>;
  }
  WriteLine(<span class="hljs-string">$"switch statement: </span><span class="hljs-subst">{message}</span><span class="hljs-string">"</span>);
}
</code></pre>
      </li>
    </ol>
    <div class="packt_tip-one">
      <p class="normal"><strong class="keyWord">Good Practice:</strong> Always put the <code class="inlineCode">default</code> at the end of a <code class="inlineCode">switch</code> statement. I wrote the preceding <code class="inlineCode">switch</code> statement with the <code class="inlineCode">default</code> in the middle of the set of branches deliberately to show that the compiler will accept this, and will always move it to the end <a id="_idIndexMarker363"/>of the set of branches for you.</p>
    </div>
    <div class="note-one">
      <p class="normal">The <code class="inlineCode">case</code> statement shown in the following code:</p>
      <p class="normal"><code class="inlineCode">case Cat fourLeggedCat when fourLeggedCat.Legs == 4:</code></p>
      <p class="normal">can also be written using the more concise property pattern-matching syntax, as shown in the following code:</p>
      <p class="normal"><code class="inlineCode">case Cat { Legs: 4 } fourLeggedCat:</code></p>
    </div>
    <ol>
      <li class="numberedList" value="4">Run the code and note that the array named <code class="inlineCode">animals</code> is declared to contain the <code class="inlineCode">Animal?</code> type, so it could be any subtype of <code class="inlineCode">Animal</code>, such as <code class="inlineCode">Cat</code> or <code class="inlineCode">Spider</code>, or a <code class="inlineCode">null</code> value. In this code, we create four instances of <code class="inlineCode">Animal</code> of different types with different properties, and one <code class="inlineCode">null</code> one, so the result will be five messages <a id="_idIndexMarker364"/>that describe each of the animals, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">switch statement: The cat named Karen has four legs.
switch statement: The animal is null.
switch statement: The non-domestic cat is named Mufasa.
switch statement: The Sid Vicious spider is venomous. Run!
switch statement: Captain Furry is a Spider.
</code></pre>
      </li>
    </ol>
    <h3 id="_idParaDest-201" class="heading-3">Simplifying switch statements with switch expressions</h3>
    <p class="normal">In C# 8 or later, you can simplify <code class="inlineCode">switch</code> statements using <strong class="keyWord">switch expressions</strong>.</p>
    <p class="normal">Most <code class="inlineCode">switch</code> statements are very simple, yet they require a lot of typing. <code class="inlineCode">switch</code> expressions are designed <a id="_idIndexMarker365"/>to simplify the code you need to type while still expressing the same intent in scenarios where all cases<a id="_idIndexMarker366"/> return a value to set a single variable. <code class="inlineCode">switch</code> expressions use a lambda, <code class="inlineCode">=&gt;</code>, to indicate a return value.</p>
    <p class="normal">Let’s implement the previous code that used a <code class="inlineCode">switch</code> statement using a <code class="inlineCode">switch</code> expression so that you can compare the two styles:</p>
    <ol>
      <li class="numberedList" value="1">In <code class="inlineCode">Program.cs</code>, at the bottom and inside the <code class="inlineCode">foreach</code> loop, add statements to set the message based on what type and attributes the animal has, using a <code class="inlineCode">switch</code> expression, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">message = animal <span class="hljs-keyword">switch</span>
{
  Cat fourLeggedCat <span class="hljs-keyword">when</span> fourLeggedCat.Legs == <span class="hljs-number">4</span>
    =&gt; <span class="hljs-string">$"The cat named </span><span class="hljs-subst">{fourLeggedCat.Name}</span><span class="hljs-string"> has four legs."</span>,
  Cat wildCat <span class="hljs-keyword">when</span> wildCat.IsDomestic == <span class="hljs-literal">false</span>
    =&gt; <span class="hljs-string">$"The non-domestic cat is named </span><span class="hljs-subst">{wildCat.Name}</span><span class="hljs-string">."</span>,
  Cat cat
    =&gt; <span class="hljs-string">$"The cat is named </span><span class="hljs-subst">{cat.Name}</span><span class="hljs-string">."</span>,
  Spider spider <span class="hljs-keyword">when</span> spider.IsVenomous
    =&gt; <span class="hljs-string">$"The </span><span class="hljs-subst">{spider.Name}</span><span class="hljs-string"> spider is venomous. Run!"</span>,
  <span class="hljs-literal">null</span>
    =&gt; <span class="hljs-string">"The animal is null."</span>,
  _
    =&gt; <span class="hljs-string">$"</span><span class="hljs-subst">{animal.Name}</span><span class="hljs-string"> is a </span><span class="hljs-subst">{animal.GetType().Name}</span><span class="hljs-string">."</span>
};
WriteLine(<span class="hljs-string">$"switch expression: </span><span class="hljs-subst">{message}</span><span class="hljs-string">"</span>);
</code></pre>
      </li>
    </ol>
    <div class="note-one">
      <p class="normal">The main differences are the removal of the <code class="inlineCode">case</code> and <code class="inlineCode">break</code> keywords. The underscore character <code class="inlineCode">_</code> is used to<a id="_idIndexMarker367"/> represent the default return value. It is known as a <strong class="keyWord">discard</strong> and you<a id="_idIndexMarker368"/> can read more about it at<a id="_idIndexMarker369"/> the following link: <a href="https://learn.microsoft.com/en-us/dotnet/csharp/fundamentals/functional/discards"><span class="url">https://learn.microsoft.com/en-us/dotnet/csharp/fundamentals/functional/discards</span></a>.</p>
    </div>
    <ol>
      <li class="numberedList" value="2">Run the code, and note that the result is the same as before, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">switch statement: The cat named Karen has four legs.
switch expression: The cat named Karen has four legs.
switch statement: The animal is null.
switch expression: The animal is null.
switch statement: The non-domestic cat is named Mufasa.
switch expression: The non-domestic cat is named Mufasa.
switch statement: The Sid Vicious spider is venomous. Run!
switch expression: The Sid Vicious spider is venomous. Run!
switch statement: Captain Furry is a Spider.
switch expression: Captain Furry is a Spider.
</code></pre>
      </li>
    </ol>
    <h1 id="_idParaDest-202" class="heading-1">Understanding iteration statements</h1>
    <p class="normal">Iteration statements repeat a<a id="_idIndexMarker370"/> block of statements either while a condition is <code class="inlineCode">true</code> (<code class="inlineCode">while</code> and <code class="inlineCode">for</code> statements) or for each item in a collection (<code class="inlineCode">foreach</code> statement). The choice of which statement to use is based on a combination of ease of understanding to solve the logic problem and personal preference.</p>
    <h2 id="_idParaDest-203" class="heading-2">Looping with the while statement</h2>
    <p class="normal">The <code class="inlineCode">while</code> statement <a id="_idIndexMarker371"/>evaluates a Boolean expression and continues to loop while it is true. Let’s explore iteration statements:</p>
    <ol>
      <li class="numberedList" value="1">Use your preferred code editor to add a new <strong class="screenText">Console App </strong>/ <code class="inlineCode">console</code> project named <code class="inlineCode">IterationStatements</code> to the <code class="inlineCode">Chapter03</code> solution.</li>
      <li class="numberedList">In <code class="inlineCode">Program.cs</code>, delete the existing statements, and then add statements to define a <code class="inlineCode">while</code> statement that loops while an integer variable has a value less than 10, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-built_in">int</span> x = <span class="hljs-number">0</span>;
<span class="hljs-keyword">while</span> (x &lt; <span class="hljs-number">10</span>)
{
  WriteLine(x);
  x++;
}
</code></pre>
      </li>
      <li class="numberedList">Run the code and view the results, which should be the numbers 0 to 9, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">0
1
2
3
4
5
6
7
8
9
</code></pre>
      </li>
    </ol>
    <h2 id="_idParaDest-204" class="heading-2">Looping with the do statement</h2>
    <p class="normal">The <code class="inlineCode">do</code> statement is like <code class="inlineCode">while</code>, except<a id="_idIndexMarker372"/> the Boolean expression is checked at the bottom of the block instead of the top, which means that the block always executes at least once, as the following shows:</p>
    <ol>
      <li class="numberedList" value="1">Type statements to define a <code class="inlineCode">do</code> loop, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-built_in">string</span>? actualPassword = <span class="hljs-string">"Pa$$w0rd"</span>;
<span class="hljs-built_in">string</span>? password;
<span class="hljs-keyword">do</span>
{
  Write(<span class="hljs-string">"Enter your password: "</span>);
  password = ReadLine();
}
<span class="hljs-keyword">while</span> (password != actualPassword);
WriteLine(<span class="hljs-string">"Correct!"</span>);
</code></pre>
      </li>
      <li class="numberedList">Run the code, and note that you are prompted to enter your password repeatedly until you enter it correctly, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">Enter your password: password
Enter your password: 12345678
Enter your password: ninja
Enter your password: correct horse battery staple
Enter your password: Pa$$w0rd
Correct!
</code></pre>
      </li>
      <li class="numberedList">As an optional challenge, add statements so that the user can only make three attempts before an error message is displayed.</li>
      <li class="numberedList">At this point, you might want to comment out the code for this section so you do not have to<a id="_idIndexMarker373"/> keep entering a password every time you run the console app!</li>
    </ol>
    <h2 id="_idParaDest-205" class="heading-2">Looping with the for statement</h2>
    <p class="normal">The <code class="inlineCode">for</code> statement is like <code class="inlineCode">while</code>, except that it is<a id="_idIndexMarker374"/> more succinct. It combines:</p>
    <ul>
      <li class="bulletList">An optional <strong class="keyWord">initializer expression</strong>, which<a id="_idIndexMarker375"/> executes once at the start of the loop.</li>
      <li class="bulletList">An optional <strong class="keyWord">conditional expression</strong>, which <a id="_idIndexMarker376"/>executes on every iteration at the start of the loop to check whether the looping should continue. If the expression returns <code class="inlineCode">true</code> or it is missing, the loop will execute again.</li>
      <li class="bulletList">An optional<strong class="keyWord"> iterator expression</strong>, which<a id="_idIndexMarker377"/> executes on every loop at the bottom of the statement. This is often used to increment a counter variable.</li>
    </ul>
    <p class="normal">The <code class="inlineCode">for</code> statement is commonly used with an integer counter. Let’s explore some code:</p>
    <ol>
      <li class="numberedList" value="1">Type a <code class="inlineCode">for</code> statement to output the numbers 1 to 10, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> y = <span class="hljs-number">1</span>; y &lt;= <span class="hljs-number">10</span>; y++)
{
  WriteLine(y);
}
</code></pre>
      </li>
      <li class="numberedList">Run the code to view the result, which should be the numbers 1 to 10.</li>
      <li class="numberedList">Add another <code class="inlineCode">for</code> statement to output the numbers 0 to 10, incrementing by 3, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> y = <span class="hljs-number">0</span>; y &lt;= <span class="hljs-number">10</span>; y += <span class="hljs-number">3</span>)
{
  WriteLine(y);
}
</code></pre>
      </li>
      <li class="numberedList">Run the code to view the result, which should be the numbers 0, 3, 6, and 9.</li>
      <li class="numberedList">Optionally, experiment with changing the initializer expression, conditional expression, or iterator expression to see their effects. Only change one thing at a <a id="_idIndexMarker378"/>time so that you can clearly see the effect produced.</li>
    </ol>
    <h2 id="_idParaDest-206" class="heading-2">Looping with the foreach statement</h2>
    <p class="normal">The <code class="inlineCode">foreach</code> statement<a id="_idIndexMarker379"/> is a bit different from the previous three iteration statements.</p>
    <p class="normal">It is used to perform a block of statements on each item in a sequence, for example, an array or collection. Each item is usually read-only, and if the sequence structure is modified during iteration, for example, by adding or removing an item, then an exception will be thrown.</p>
    <p class="normal">Try the following example:</p>
    <ol>
      <li class="numberedList" value="1">Type statements to create an array of string variables and then output the length of each one, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-built_in">string</span>[] names = { <span class="hljs-string">"Adam"</span>, <span class="hljs-string">"Barry"</span>, <span class="hljs-string">"Charlie"</span> };
<span class="hljs-keyword">foreach</span> (<span class="hljs-built_in">string</span> name <span class="hljs-keyword">in</span> names)
{
  WriteLine(<span class="hljs-string">$"</span><span class="hljs-subst">{name}</span><span class="hljs-string"> has </span><span class="hljs-subst">{name.Length}</span><span class="hljs-string"> characters."</span>);
}
</code></pre>
      </li>
      <li class="numberedList">Run the code and view the results, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">Adam has 4 characters.
Barry has 5 characters.
Charlie has 7 characters.
</code></pre>
      </li>
    </ol>
    <h3 id="_idParaDest-207" class="heading-3">Understanding how foreach works internally</h3>
    <p class="normal">A developer who defines a type that represents multiple items, like an array or collection, should make sure that a<a id="_idIndexMarker380"/> programmer can use the <code class="inlineCode">foreach</code> statement to enumerate through the type’s items.</p>
    <p class="normal">Technically, the <code class="inlineCode">foreach</code> statement will work on any type that follows these rules:</p>
    <ul>
      <li class="bulletList">The type must have a method named <code class="inlineCode">GetEnumerator</code> that returns an object.</li>
      <li class="bulletList">The returned object must have a property named <code class="inlineCode">Current</code> and a method named <code class="inlineCode">MoveNext</code>.</li>
      <li class="bulletList">The <code class="inlineCode">MoveNext</code> method must change the value of <code class="inlineCode">Current</code> and return <code class="inlineCode">true</code> if there are more items to enumerate through or return <code class="inlineCode">false</code> if there are no more items.</li>
    </ul>
    <p class="normal">There are interfaces named <code class="inlineCode">IEnumerable</code> and <code class="inlineCode">IEnumerable&lt;T&gt;</code> that formally define these rules, but technically, the compiler does not require the type to implement these interfaces.</p>
    <p class="normal">The compiler turns the <code class="inlineCode">foreach</code> statement in the preceding example into something like the following pseudocode:</p>
    <pre class="programlisting code"><code class="hljs-code">IEnumerator e = names.GetEnumerator();
<span class="hljs-keyword">while</span> (e.MoveNext())
{
  <span class="hljs-built_in">string</span> name = (<span class="hljs-built_in">string</span>)e.Current; <span class="hljs-comment">// Current is read-only!</span>
  WriteLine(<span class="hljs-string">$"</span><span class="hljs-subst">{name}</span><span class="hljs-string"> has </span><span class="hljs-subst">{name.Length}</span><span class="hljs-string"> characters."</span>);
}
</code></pre>
    <p class="normal">Due to the use of an iterator and its read-only <code class="inlineCode">Current</code> property, the variable declared in a <code class="inlineCode">foreach</code> statement cannot be used to modify the value of the current item.</p>
    <h1 id="_idParaDest-208" class="heading-1">Storing multiple values in an array</h1>
    <p class="normal">When you need to store multiple values of the same type, you can declare an <strong class="keyWord">array</strong>. For example, you may do this when<a id="_idIndexMarker381"/> you need to store four names in a <code class="inlineCode">string</code> array.</p>
    <h2 id="_idParaDest-209" class="heading-2">Working with single-dimensional arrays</h2>
    <p class="normal">The code that you will<a id="_idIndexMarker382"/> write next will allocate memory for an array for storing four <code class="inlineCode">string</code> values. It will then store <code class="inlineCode">string</code> values at index positions 0 to 3 (arrays usually have a lower bound of zero, so the index of the last item is one less than the length of the array).</p>
    <p class="normal">We could visualize the array like this:</p>
    <table id="table001-2" class="table-container">
      <tbody>
        <tr>
          <td class="table-cell">
            <p class="normal">0</p>
          </td>
          <td class="table-cell">
            <p class="normal">1</p>
          </td>
          <td class="table-cell">
            <p class="normal">2</p>
          </td>
          <td class="table-cell">
            <p class="normal">3</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal">Kate</p>
          </td>
          <td class="table-cell">
            <p class="normal">Jack</p>
          </td>
          <td class="table-cell">
            <p class="normal">Rebecca</p>
          </td>
          <td class="table-cell">
            <p class="normal">Tom</p>
          </td>
        </tr>
      </tbody>
    </table>
    <p class="packt_figref">Table 3.1: Visualization of an array of four string values</p>
    <div class="packt_tip">
      <p class="normal"><strong class="keyWord">Good Practice</strong>: Do not assume that <a id="_idIndexMarker383"/>all arrays count from zero. The most common type of array in .NET is <strong class="keyWord">szArray</strong>, a single-dimensional zero-indexed array, and these use the normal <code class="inlineCode">[]</code> syntax. But .NET also has <strong class="keyWord">mdArray</strong>, a multi-dimensional array, and these<a id="_idIndexMarker384"/> do not have to have a lower bound of zero. These are rarely used, but you should know they exist.</p>
    </div>
    <p class="normal">Finally, it will loop through each item in the array using a <code class="inlineCode">for</code> statement.</p>
    <p class="normal">Let’s look at how to use an array:</p>
    <ol>
      <li class="numberedList" value="1">Use your preferred code editor to add a new <strong class="screenText">Console App</strong> / <code class="inlineCode">console</code> project named <code class="inlineCode">Arrays</code> to the <code class="inlineCode">Chapter03</code> solution.</li>
      <li class="numberedList">In <code class="inlineCode">Program.cs</code>, delete the existing statements and then type statements to declare and use an array of <code class="inlineCode">string</code> values, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-built_in">string</span>[] names; <span class="hljs-comment">// This can reference any size array of strings.</span>
<span class="hljs-comment">// Allocate memory for four strings in an array.</span>
names = <span class="hljs-keyword">new</span> <span class="hljs-built_in">string</span>[<span class="hljs-number">4</span>];
<span class="hljs-comment">// Store items at these index positions.</span>
names[<span class="hljs-number">0</span>] = <span class="hljs-string">"Kate"</span>;
names[<span class="hljs-number">1</span>] = <span class="hljs-string">"Jack"</span>;
names[<span class="hljs-number">2</span>] = <span class="hljs-string">"Rebecca"</span>;
names[<span class="hljs-number">3</span>] = <span class="hljs-string">"Tom"</span>;
<span class="hljs-comment">// Loop through the names.</span>
<span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>; i &lt; names.Length; i++)
{
  <span class="hljs-comment">// Output the item at index position i.</span>
  WriteLine(<span class="hljs-string">$"</span><span class="hljs-subst">{names[i]}</span><span class="hljs-string"> is at position </span><span class="hljs-subst">{i}</span><span class="hljs-string">."</span>);
}
</code></pre>
      </li>
      <li class="numberedList">Run the code and note the <a id="_idIndexMarker385"/>result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">Kate is at position 0.
Jack is at position 1.
Rebecca is at position 2.
Tom is at position 3.
</code></pre>
      </li>
    </ol>
    <p class="normal">Arrays are always of a fixed size at the time of memory allocation, so you need to decide how many items you want to store before instantiating them.</p>
    <p class="normal">An alternative to defining the array in three steps as above is to use array initializer syntax:</p>
    <ol>
      <li class="numberedList" value="1">Before the <code class="inlineCode">for</code> loop, add a statement to declare, allocate memory, and instantiate the values of a similar array, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-comment">// Alternative syntax for creating and initializing an array.</span>
<span class="hljs-built_in">string</span>[] names2 = { <span class="hljs-string">"Kate"</span>, <span class="hljs-string">"Jack"</span>, <span class="hljs-string">"Rebecca"</span>, <span class="hljs-string">"Tom"</span> };
</code></pre>
      </li>
      <li class="numberedList">Change the <code class="inlineCode">for</code> loop to use <code class="inlineCode">names2</code>, run the console app, and note that the results are the same.</li>
    </ol>
    <h2 id="_idParaDest-210" class="heading-2">Working with multi-dimensional arrays</h2>
    <p class="normal">Instead of a single-dimension <a id="_idIndexMarker386"/>array for storing a row of string values (or any other data type), what if we want to store a grid of values? Or a cube? Or even higher dimensions?</p>
    <p class="normal">We could visualize a two-dimensional array, aka a grid, of <code class="inlineCode">string</code> values like this:</p>
    <table id="table002-2" class="table-container">
      <tbody>
        <tr>
          <td class="table-cell"/>
          <td class="table-cell">
            <p class="normal">0</p>
          </td>
          <td class="table-cell">
            <p class="normal">1</p>
          </td>
          <td class="table-cell">
            <p class="normal">2</p>
          </td>
          <td class="table-cell">
            <p class="normal">3</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal">0</p>
          </td>
          <td class="table-cell">
            <p class="normal">Alpha</p>
          </td>
          <td class="table-cell">
            <p class="normal">Beta</p>
          </td>
          <td class="table-cell">
            <p class="normal">Gamma</p>
          </td>
          <td class="table-cell">
            <p class="normal">Delta</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal">1</p>
          </td>
          <td class="table-cell">
            <p class="normal">Anne</p>
          </td>
          <td class="table-cell">
            <p class="normal">Ben</p>
          </td>
          <td class="table-cell">
            <p class="normal">Charlie</p>
          </td>
          <td class="table-cell">
            <p class="normal">Doug</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal">2</p>
          </td>
          <td class="table-cell">
            <p class="normal">Aardvark</p>
          </td>
          <td class="table-cell">
            <p class="normal">Bear</p>
          </td>
          <td class="table-cell">
            <p class="normal">Cat</p>
          </td>
          <td class="table-cell">
            <p class="normal">Dog</p>
          </td>
        </tr>
      </tbody>
    </table>
    <p class="packt_figref">Table 3.2: Visualization of a two-dimensional array</p>
    <p class="normal">Let’s look at how to use multi-dimensional arrays:</p>
    <ol>
      <li class="numberedList" value="1">At the bottom of <code class="inlineCode">Program.cs</code>, add statements to declare and instantiate a two-dimensional array of <code class="inlineCode">string</code> values, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-built_in">string</span>[,] grid1 = <span class="hljs-comment">// Two dimensional array.</span>
{
  { <span class="hljs-string">"Alpha"</span>, <span class="hljs-string">"Beta"</span>, <span class="hljs-string">"Gamma"</span>, <span class="hljs-string">"Delta"</span> },
  { <span class="hljs-string">"</span><span class="hljs-string">Anne"</span>, <span class="hljs-string">"Ben"</span>, <span class="hljs-string">"Charlie"</span>, <span class="hljs-string">"Doug"</span> },
  { <span class="hljs-string">"Aardvark"</span>, <span class="hljs-string">"Bear"</span>, <span class="hljs-string">"Cat"</span>, <span class="hljs-string">"Dog"</span> }
};
</code></pre>
      </li>
      <li class="numberedList">We can discover the lower and upper bounds of this array using helpful methods, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">WriteLine(<span class="hljs-string">$"1st dimension, lower bound: </span><span class="hljs-subst">{grid1.GetLowerBound(</span><span class="hljs-number">0</span><span class="hljs-subst">)}</span><span class="hljs-string">"</span>);
WriteLine(<span class="hljs-string">$"1st dimension, upper bound: </span><span class="hljs-subst">{grid1.GetUpperBound(</span><span class="hljs-number">0</span><span class="hljs-subst">)}</span><span class="hljs-string">"</span>);
WriteLine(<span class="hljs-string">$"2nd dimension, lower bound: </span><span class="hljs-subst">{grid1.GetLowerBound(</span><span class="hljs-number">1</span><span class="hljs-subst">)}</span><span class="hljs-string">"</span>);
WriteLine(<span class="hljs-string">$"2nd dimension, upper bound: </span><span class="hljs-subst">{grid1.GetUpperBound(</span><span class="hljs-number">1</span><span class="hljs-subst">)}</span><span class="hljs-string">"</span>);
</code></pre>
      </li>
      <li class="numberedList">Run the code<a id="_idIndexMarker387"/> and note the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">1st dimension, lower bound: 0
1st dimension, upper bound: 2
2nd dimension, lower bound: 0
2nd dimension, upper bound: 3
</code></pre>
      </li>
      <li class="numberedList">We can then use these values in nested <code class="inlineCode">for</code> statements to loop through the <code class="inlineCode">string</code> values, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> row = <span class="hljs-number">0</span>; row &lt;= grid1.GetUpperBound(<span class="hljs-number">0</span>); row++)
{
  <span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> col = <span class="hljs-number">0</span>; col &lt;= grid1.GetUpperBound(<span class="hljs-number">1</span>); col++)
  {
    WriteLine(<span class="hljs-string">$"Row </span><span class="hljs-subst">{row}</span><span class="hljs-string">, Column </span><span class="hljs-subst">{col}</span><span class="hljs-string">: </span><span class="hljs-subst">{grid1[row, col]}</span><span class="hljs-string">"</span>);
  }
}
</code></pre>
      </li>
      <li class="numberedList">Run the code and note the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">Row 0, Column 0: Alpha
Row 0, Column 1: Beta
Row 0, Column 2: Gamma
Row 0, Column 3: Delta
Row 1, Column 0: Anne
Row 1, Column 1: Ben
Row 1, Column 2: Charlie
Row 1, Column 3: Doug
Row 2, Column 0: Aardvark
Row 2, Column 1: Bear
Row 2, Column 2: Cat
Row 2, Column 3: Dog
</code></pre>
      </li>
    </ol>
    <p class="normal">You must supply a value for every row and every column when it is instantiated, or you will get compile errors. If you need to indicate a missing <code class="inlineCode">string</code> value, then use <code class="inlineCode">string.Empty</code>. Or if you declare the array to be nullable <code class="inlineCode">string</code> values by using <code class="inlineCode">string?[]</code>, then you can also use <code class="inlineCode">null</code> for a missing value.</p>
    <p class="normal">If you cannot use the array initialization<a id="_idIndexMarker388"/> syntax, perhaps because you are loading values from a file or database, then you can separate the declaration of the array dimension and the allocation of memory from the assignment of values, as shown in the following code:</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment">// Alternative syntax for declaring and allocating memory</span>
<span class="hljs-comment">// for a multi-dimensional array.</span>
<span class="hljs-built_in">string</span>[,] grid2 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">string</span>[<span class="hljs-number">3</span>,<span class="hljs-number">4</span>]; <span class="hljs-comment">// Allocate memory.</span>
grid2[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] = <span class="hljs-string">"Alpha"</span>; <span class="hljs-comment">// Assign values.</span>
grid2[<span class="hljs-number">0</span>, <span class="hljs-number">1</span>] = <span class="hljs-string">"Beta"</span>;
<span class="hljs-comment">// And so on.</span>
grid2[<span class="hljs-number">2</span>, <span class="hljs-number">3</span>] = <span class="hljs-string">"Dog"</span>;
</code></pre>
    <p class="normal">When declaring the size of the dimensions, you specify the length, not the upper bound. The expression <code class="inlineCode">new string[3,4]</code> means the array can have 3 items in its first dimension (0) with an upper bound of 2, and the array can have 4 items in its second dimension (1) with an upper bound of 3.</p>
    <h2 id="_idParaDest-211" class="heading-2">Working with jagged arrays</h2>
    <p class="normal">If you need a multi-dimensional <a id="_idIndexMarker389"/>array but the number of items stored in each dimension is different, then you can define an array of arrays, aka a jagged array.</p>
    <p class="normal">We could visualize a jagged array as shown in <em class="italic">Figure 3.3</em>:</p>
    <figure class="mediaobject"><img src="../Images/B22322_03_03.png" alt="" width="686" height="354"/></figure>
    <p class="packt_figref">Figure 3.3: Visualization of a jagged array</p>
    <p class="normal">Let’s look at how to use a<a id="_idIndexMarker390"/> jagged array:</p>
    <ol>
      <li class="numberedList" value="1">At the bottom of <code class="inlineCode">Program.cs</code>, add statements to declare and instantiate an array of arrays of <code class="inlineCode">string</code> values, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-built_in">string</span>[][] jagged = <span class="hljs-comment">// An array of string arrays.</span>
{
  <span class="hljs-keyword">new</span>[] { <span class="hljs-string">"Alpha"</span>, <span class="hljs-string">"Beta"</span>, <span class="hljs-string">"Gamma"</span> },
  <span class="hljs-keyword">new</span>[] { <span class="hljs-string">"Anne"</span>, <span class="hljs-string">"Ben"</span>, <span class="hljs-string">"Charlie"</span>, <span class="hljs-string">"Doug"</span> },
  <span class="hljs-keyword">new</span>[] { <span class="hljs-string">"Aardvark"</span>, <span class="hljs-string">"Bear"</span> }
};
</code></pre>
      </li>
      <li class="numberedList">We can discover the lower and upper bounds of the array of arrays, and then each array with it, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">WriteLine(<span class="hljs-string">"Upper bound of the array of arrays is: {0}"</span>,
  jagged.GetUpperBound(<span class="hljs-number">0</span>));
<span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> array = <span class="hljs-number">0</span>; array &lt;= jagged.GetUpperBound(<span class="hljs-number">0</span>); array++)
{
  WriteLine(<span class="hljs-string">"Upper bound of array {0} is: {1}"</span>,
    arg0: array,
    arg1: jagged[array].GetUpperBound(<span class="hljs-number">0</span>));
}
</code></pre>
      </li>
      <li class="numberedList">Run the code and note the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">Upper bound of the array of arrays is: 2
Upper bound of array 0 is: 2
Upper bound of array 1 is: 3
Upper bound of array 2 is: 1
</code></pre>
      </li>
      <li class="numberedList">We can then use these <a id="_idIndexMarker391"/>values in nested <code class="inlineCode">for</code> statements to loop through the <code class="inlineCode">string</code> values, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> row = <span class="hljs-number">0</span>; row &lt;= jagged.GetUpperBound(<span class="hljs-number">0</span>); row++)
{
  <span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> col = <span class="hljs-number">0</span>; col &lt;= jagged[row].GetUpperBound(<span class="hljs-number">0</span>); col++)
  {
    WriteLine(<span class="hljs-string">$"Row </span><span class="hljs-subst">{row}</span><span class="hljs-string">, Column </span><span class="hljs-subst">{col}</span><span class="hljs-string">: </span><span class="hljs-subst">{jagged[row][col]}</span><span class="hljs-string">"</span>);
  }
}
</code></pre>
      </li>
      <li class="numberedList">Run the code and note the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">Row 0, Column 0: Alpha
Row 0, Column 1: Beta
Row 0, Column 2: Gamma
Row 1, Column 0: Anne
Row 1, Column 1: Ben
Row 1, Column 2: Charlie
Row 1, Column 3: Doug
Row 2, Column 0: Aardvark
Row 2, Column 1: Bear
</code></pre>
      </li>
    </ol>
    <h2 id="_idParaDest-212" class="heading-2">List pattern matching with arrays</h2>
    <p class="normal">Earlier in this chapter, you saw how an individual object supports pattern matching against its type and<a id="_idIndexMarker392"/> properties. Pattern matching also works with arrays and collections.</p>
    <p class="normal">Introduced with C# 11, list pattern matching works with any type that has a public <code class="inlineCode">Length</code> or <code class="inlineCode">Count</code> property and has an indexer using an <code class="inlineCode">int</code> or <code class="inlineCode">System.Index</code> parameter. You will learn about indexers in <em class="chapterRef">Chapter 5</em>, <em class="italic">Building Your Own Types with Object-Oriented Programming</em>.</p>
    <p class="normal">When you define multiple list patterns in the same <code class="inlineCode">switch</code> expression, you must order them so that the more specific one comes first, or the compiler will complain because a more general pattern will match the more specific pattern too, and make the more specific one unreachable.</p>
    <p class="normal"><em class="italic">Table 3.3</em> shows examples of list pattern matching, assuming a list of <code class="inlineCode">int</code> values:</p>
    <table id="table003-2" class="table-container">
      <tbody>
        <tr>
          <td class="table-cell">
            <p class="normal"><strong class="keyWord">Example</strong></p>
          </td>
          <td class="table-cell">
            <p class="normal"><strong class="keyWord">Description</strong></p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">[]</code></p>
          </td>
          <td class="table-cell">
            <p class="normal">Matches an empty array or collection.</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">[..]</code></p>
          </td>
          <td class="table-cell">
            <p class="normal">Matches an array or collection with any number of items, including zero, so <code class="inlineCode">[..]</code> must come after <code class="inlineCode">[]</code> if you need to switch on both.</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">[_]</code></p>
          </td>
          <td class="table-cell">
            <p class="normal">Matches a list with any single item.</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">[int item1]</code> or</p>
            <p class="normal"><code class="inlineCode">[var item1]</code></p>
          </td>
          <td class="table-cell">
            <p class="normal">Matches a list with any single item and can use the value in the return expression by referring to <code class="inlineCode">item1</code>.</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">[7, 2]</code></p>
          </td>
          <td class="table-cell">
            <p class="normal">Matches exactly a list of two items with those values in that order.</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">[_, _]</code></p>
          </td>
          <td class="table-cell">
            <p class="normal">Matches a list with any two items.</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">[var item1, var item2]</code></p>
          </td>
          <td class="table-cell">
            <p class="normal">Matches a list with any two items and can use the values in the return expression by referring to <code class="inlineCode">item1</code> and <code class="inlineCode">item2</code>.</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">[_, _, _]</code></p>
          </td>
          <td class="table-cell">
            <p class="normal">Matches a list with any three items.</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">[var item1, ..]</code></p>
          </td>
          <td class="table-cell">
            <p class="normal">Matches a list with one or more items. Can refer to the value of the first item in its return expression by referring to <code class="inlineCode">item1</code>.</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">[var firstItem, .., var lastItem]</code></p>
          </td>
          <td class="table-cell">
            <p class="normal">Matches a list with two or more items. Can refer to the value of the first and last item in its return expression by referring to <code class="inlineCode">firstItem</code> and <code class="inlineCode">lastItem</code>.</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">[.., var lastItem]</code></p>
          </td>
          <td class="table-cell">
            <p class="normal">Matches a list with one or more items. Can refer to the value of the last item in its return expression by referring to <code class="inlineCode">lastItem</code>.</p>
          </td>
        </tr>
      </tbody>
    </table>
    <p class="packt_figref">Table 3.3: Examples of list pattern matching</p>
    <p class="normal">Let’s see some examples in code:</p>
    <ol>
      <li class="numberedList" value="1">At the bottom of <code class="inlineCode">Program.cs</code>, add statements to define some arrays of <code class="inlineCode">int</code> values, and then pass them to a <a id="_idIndexMarker393"/>method that returns descriptive text depending on the pattern that matches best, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-built_in">int</span>[] sequentialNumbers = { <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>, <span class="hljs-number">10</span> };
<span class="hljs-built_in">int</span>[] oneTwoNumbers = { <span class="hljs-number">1</span>, <span class="hljs-number">2</span> };
<span class="hljs-built_in">int</span>[] oneTwoTenNumbers = { <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">10</span> };
<span class="hljs-built_in">int</span>[] oneTwoThreeTenNumbers = { <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">10</span> };
<span class="hljs-built_in">int</span>[] primeNumbers = { <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">7</span>, <span class="hljs-number">11</span>, <span class="hljs-number">13</span>, <span class="hljs-number">17</span>, <span class="hljs-number">19</span>, <span class="hljs-number">23</span>, <span class="hljs-number">29</span> };
<span class="hljs-built_in">int</span>[] fibonacciNumbers = { <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">8</span>, <span class="hljs-number">13</span>, <span class="hljs-number">21</span>, <span class="hljs-number">34</span>, <span class="hljs-number">55</span>, <span class="hljs-number">89</span> };
<span class="hljs-built_in">int</span>[] emptyNumbers = { }; <span class="hljs-comment">// Or use Array.Empty&lt;int&gt;()</span>
<span class="hljs-built_in">int</span>[] threeNumbers = { <span class="hljs-number">9</span>, <span class="hljs-number">7</span>, <span class="hljs-number">5</span> };
<span class="hljs-built_in">int</span>[] sixNumbers = { <span class="hljs-number">9</span>, <span class="hljs-number">7</span>, <span class="hljs-number">5</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">10</span> };
WriteLine(<span class="hljs-string">$"</span><span class="hljs-subst">{</span><span class="hljs-keyword">nameof</span><span class="hljs-subst">(sequentialNumbers)}</span><span class="hljs-string">: </span><span class="hljs-subst">{CheckSwitch(sequentialNumbers)}</span><span class="hljs-string">"</span>);
WriteLine(<span class="hljs-string">$"</span><span class="hljs-subst">{</span><span class="hljs-keyword">nameof</span><span class="hljs-subst">(oneTwoNumbers)}</span><span class="hljs-string">: </span><span class="hljs-subst">{CheckSwitch(oneTwoNumbers)}</span><span class="hljs-string">"</span>);
WriteLine(<span class="hljs-string">$"</span><span class="hljs-subst">{</span><span class="hljs-keyword">nameof</span><span class="hljs-subst">(oneTwoTenNumbers)}</span><span class="hljs-string">: </span><span class="hljs-subst">{CheckSwitch(oneTwoTenNumbers)}</span><span class="hljs-string">"</span>);
WriteLine(<span class="hljs-string">$"</span><span class="hljs-subst">{</span><span class="hljs-keyword">nameof</span><span class="hljs-subst">(oneTwoThreeTenNumbers)}</span><span class="hljs-string">: </span><span class="hljs-subst">{CheckSwitch(oneTwoThreeTenNumbers)}</span><span class="hljs-string">"</span>);
WriteLine(<span class="hljs-string">$"</span><span class="hljs-subst">{</span><span class="hljs-keyword">nameof</span><span class="hljs-subst">(primeNumbers)}</span><span class="hljs-string">: </span><span class="hljs-subst">{CheckSwitch(primeNumbers)}</span><span class="hljs-string">"</span>);
WriteLine(<span class="hljs-string">$"</span><span class="hljs-subst">{</span><span class="hljs-keyword">nameof</span><span class="hljs-subst">(fibonacciNumbers)}</span><span class="hljs-string">: </span><span class="hljs-subst">{CheckSwitch(fibonacciNumbers)}</span><span class="hljs-string">"</span>);
WriteLine(<span class="hljs-string">$"</span><span class="hljs-subst">{</span><span class="hljs-keyword">nameof</span><span class="hljs-subst">(emptyNumbers)}</span><span class="hljs-string">: </span><span class="hljs-subst">{CheckSwitch(emptyNumbers)}</span><span class="hljs-string">"</span>);
WriteLine(<span class="hljs-string">$"</span><span class="hljs-subst">{</span><span class="hljs-keyword">nameof</span><span class="hljs-subst">(threeNumbers)}</span><span class="hljs-string">: </span><span class="hljs-subst">{CheckSwitch(threeNumbers)}</span><span class="hljs-string">"</span>);
WriteLine(<span class="hljs-string">$"</span><span class="hljs-subst">{</span><span class="hljs-keyword">nameof</span><span class="hljs-subst">(sixNumbers)}</span><span class="hljs-string">: </span><span class="hljs-subst">{CheckSwitch(sixNumbers)}</span><span class="hljs-string">"</span>);
<span class="hljs-keyword">static</span><span class="hljs-function"> </span><span class="hljs-built_in">string</span><span class="hljs-function"> </span><span class="hljs-title">CheckSwitch</span><span class="hljs-function">(</span><span class="hljs-built_in">int</span><span class="hljs-params">[] values</span><span class="hljs-function">)</span> =&gt; values <span class="hljs-keyword">switch</span>
{
  [] =&gt; <span class="hljs-string">"Empty array"</span>,
  [<span class="hljs-meta">1, 2, _, 10</span>] =&gt; <span class="hljs-string">"Contains 1, 2, any single number, 10."</span>,
  [<span class="hljs-meta">1, 2, .., 10</span>] =&gt; <span class="hljs-string">"Contains 1, 2, any range including empty, 10."</span>,
  [<span class="hljs-meta">1, 2</span>] =&gt; <span class="hljs-string">"Contains 1 then 2."</span>,
  [<span class="hljs-meta">int item1, int item2, int item3</span>] =&gt;
    <span class="hljs-string">$"Contains </span><span class="hljs-subst">{item1}</span><span class="hljs-string"> then </span><span class="hljs-subst">{item2}</span><span class="hljs-string"> then </span><span class="hljs-subst">{item3}</span><span class="hljs-string">."</span>,
  [<span class="hljs-meta">0, _</span>] =&gt; <span class="hljs-string">"Starts with 0, then one other number."</span>,
  [<span class="hljs-meta">0, ..</span>] =&gt; <span class="hljs-string">"Starts with 0, then any range of numbers."</span>,
  [<span class="hljs-meta">2, .. int[</span>] others] =&gt; <span class="hljs-string">$"Starts with 2, then </span><span class="hljs-subst">{others.Length}</span><span class="hljs-string"> more numbers."</span>,
  [..] =&gt; <span class="hljs-string">"Any items in any order."</span>, <span class="hljs-comment">// &lt;-- Note the trailing comma for easier re-ordering.</span>
  <span class="hljs-comment">// Use Alt + Up or Down arrow to move statements.</span>
};
</code></pre>
      </li>
    </ol>
    <div class="note-one">
      <p class="normal">In C# 6, Microsoft added support<a id="_idIndexMarker394"/> for expression-bodied function members. The <code class="inlineCode">CheckSwitch</code> function above uses this syntax. In C#, lambdas are the use of the <code class="inlineCode">=&gt;</code> character to indicate a return value from a function. I will properly introduce this in <em class="chapterRef">Chapter 4, Writing, Debugging, and Testing Functions</em>.</p>
    </div>
    <ol>
      <li class="numberedList" value="2">Run the code and note the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">sequentialNumbers: Contains 1, 2, any range including empty, 10.
oneTwoNumbers: Contains 1 then 2.
oneTwoTenNumbers: Contains 1, 2, any range including empty, 10.
oneTwoThreeTenNumbers: Contains 1, 2, any single number, 10.
primeNumbers: Starts with 2, then 9 more numbers.
fibonacciNumbers: Starts with 0, then any range of numbers.
emptyNumbers: Empty array
threeNumbers: Contains 9 then 7 then 5.
sixNumbers: Any items in any order.
</code></pre>
      </li>
    </ol>
    <div class="note">
      <p class="normal">You can learn more about list <a id="_idIndexMarker395"/>pattern matching at the following link: <a href="https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/operators/patterns#list-patterns"><span class="url">https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/operators/patterns#list-patterns</span></a>.</p>
    </div>
    <h2 id="_idParaDest-213" class="heading-2">Trailing commas</h2>
    <p class="normal">The trailing comma after the last item in the <code class="inlineCode">switch</code> expression is optional and the compiler will not complain about it.</p>
    <p class="normal">Most languages, including C#, allow<a id="_idIndexMarker396"/> the code style of trailing commas. When multiple items are separated by commas (for example, when declaring an anonymous object, an array, collection initializers, enums, and switch expressions), C# allows you to have the trailing comma after the last item. This makes it easy to rearrange the order of the items without having to keep adding and removing commas.</p>
    <p class="normal">You can read a discussion about allowing trailing commas for <code class="inlineCode">switch</code> expressions back in 2018 at the following link: <a href="https://github.com/dotnet/csharplang/issues/2098"><span class="url">https://github.com/dotnet/csharplang/issues/2098</span></a>.</p>
    <p class="normal">Even JSON serializers have an option to allow this because it is so common to use, as discussed at the following link: <a href="https://learn.microsoft.com/en-us/dotnet/api/system.text.json.jsonserializeroptions.allowtrailingcommas"><span class="url">https://learn.microsoft.com/en-us/dotnet/api/system.text.json.jsonserializeroptions.allowtrailingcommas</span></a>.</p>
    <h2 id="_idParaDest-214" class="heading-2">Understanding inline arrays</h2>
    <p class="normal">Inline arrays were introduced with C# 12; they <a id="_idIndexMarker397"/>are an advanced feature used by the .NET runtime team to improve performance. You are unlikely to use them yourself unless you are a public library author, but you will automatically benefit from others’ use of them.</p>
    <div class="note">
      <p class="normal"><strong class="keyWord">More Information</strong>: You can learn more about inline arrays at the following link: <a href="https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/proposals/csharp-12.0/inline-arrays"><span class="url">https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/proposals/csharp-12.0/inline-arrays</span></a>.</p>
    </div>
    <h2 id="_idParaDest-215" class="heading-2">Summarizing arrays</h2>
    <p class="normal">We use slightly different<a id="_idIndexMarker398"/> syntax to declare different types of arrays, as shown in <em class="italic">Table 3.4</em>:</p>
    <table id="table004-2" class="table-container">
      <tbody>
        <tr>
          <td class="table-cell">
            <p class="normal"><strong class="keyWord">Type of array</strong></p>
          </td>
          <td class="table-cell">
            <p class="normal"><strong class="keyWord">Declaration syntax</strong></p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal">One dimension</p>
          </td>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">datatype[]</code>, for example, <code class="inlineCode">string[]</code></p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal">Two dimensions</p>
          </td>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">string[,]</code></p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal">Three dimensions</p>
          </td>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">string[,,]</code></p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal">Ten dimensions</p>
          </td>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">string[,,,,,,,,,]</code></p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal">Array of arrays, aka two-dimensional jagged array</p>
          </td>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">string[][]</code></p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal">Array of arrays of arrays, aka three-dimensional jagged array</p>
          </td>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">string[][][]</code></p>
          </td>
        </tr>
      </tbody>
    </table>
    <p class="packt_figref">Table 3.4: Summary of array declaration syntax</p>
    <p class="normal">Arrays are useful for temporarily storing multiple items, but collections are a more flexible option when adding and removing items dynamically. You don’t need to worry about collections right now, as we will cover them in <em class="chapterRef">Chapter 8</em>, <em class="italic">Working with Common .NET Types</em>.</p>
    <p class="normal">You can convert any sequence of items into an array using the <code class="inlineCode">ToArray</code> extension method, which we will cover in <em class="chapterRef">Chapter 11</em>, <em class="italic">Querying and Manipulating Data Using LINQ</em>.</p>
    <div class="note">
      <p class="normal"><strong class="keyWord">Good Practice</strong>: If you <a id="_idIndexMarker399"/>do not need to dynamically add and remove items, then you should use an array instead of a collection like <code class="inlineCode">List&lt;T&gt;</code> because arrays are more efficient in memory use and the items are stored contiguously, which can improve performance.</p>
    </div>
    <h1 id="_idParaDest-216" class="heading-1">Casting and converting between types</h1>
    <p class="normal">You will often need to convert values of variables <a id="_idIndexMarker400"/>between different types. For example, data input is often entered as text in the console, so it is initially stored in a variable of the <code class="inlineCode">string</code> type, but it then needs to be converted into a date/time, number, or some other data type, depending on how it should be stored and processed.</p>
    <p class="normal">Sometimes you will need to convert between number types, like between an integer and a floating point, before performing calculations.</p>
    <p class="normal">Converting is also<a id="_idIndexMarker401"/> known as <strong class="keyWord">casting</strong>, and it has two varieties: <strong class="keyWord">implicit</strong> and <strong class="keyWord">explicit</strong>. Implicit casting<a id="_idIndexMarker402"/> happens automatically, and it is safe, meaning<a id="_idIndexMarker403"/> that you will not lose any<a id="_idIndexMarker404"/> information.</p>
    <p class="normal">Explicit casting must be performed <a id="_idIndexMarker405"/>manually because it may lose information, for example, the precision of a number. By explicitly casting, you are telling the C# compiler that you understand and accept the risk.</p>
    <h2 id="_idParaDest-217" class="heading-2">Casting numbers implicitly and explicitly</h2>
    <p class="normal">Implicitly casting an <code class="inlineCode">int</code> variable<a id="_idIndexMarker406"/> into a <code class="inlineCode">double</code> variable<a id="_idIndexMarker407"/> is safe because no information can be lost, as the following shows:</p>
    <ol>
      <li class="numberedList" value="1">Use your preferred code editor to add a new <strong class="screenText">Console App</strong> / <code class="inlineCode">console</code> project named <code class="inlineCode">CastingConverting</code> to the <code class="inlineCode">Chapter03</code> solution.</li>
      <li class="numberedList">In <code class="inlineCode">Program.cs</code>, delete the existing statements, then type statements to declare and assign an <code class="inlineCode">int</code> variable and a <code class="inlineCode">double</code> variable, and then implicitly cast the integer’s value when assigning it to the <code class="inlineCode">double</code> variable, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-built_in">int</span> a = <span class="hljs-number">10</span>;
<span class="hljs-built_in">double</span> b = a; <span class="hljs-comment">// An int can be safely cast into a double.</span>
WriteLine(<span class="hljs-string">$"a is </span><span class="hljs-subst">{a}</span><span class="hljs-string">, b is </span><span class="hljs-subst">{b}</span><span class="hljs-string">"</span>);
</code></pre>
      </li>
      <li class="numberedList">Type statements to declare and assign a <code class="inlineCode">double</code> variable and an <code class="inlineCode">int</code> variable, and then implicitly cast the <code class="inlineCode">double</code> value when assigning it to the <code class="inlineCode">int</code> variable, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-built_in">double</span> c = <span class="hljs-number">9.8</span>;
<span class="hljs-built_in">int</span> d = c; <span class="hljs-comment">// Compiler gives an error if you do not explicitly cast.</span>
WriteLine(<span class="hljs-string">$"c is </span><span class="hljs-subst">{c}</span><span class="hljs-string">, d is </span><span class="hljs-subst">{d}</span><span class="hljs-string">"</span>);
</code></pre>
      </li>
      <li class="numberedList">Run the code and note the error message, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">Error: (6,9): error CS0266: Cannot implicitly convert type 'double' to 'int'. An explicit conversion exists (are you missing a cast?)
</code></pre>
      </li>
    </ol>
    <p class="normal-one">This error message will also appear in the Visual Studio <strong class="screenText">Error List</strong>, VS Code <strong class="screenText">PROBLEMS</strong> window, or Rider <strong class="screenText">Problems</strong> window.</p>
    <p class="normal-one">You cannot implicitly cast a <code class="inlineCode">double</code> variable into an <code class="inlineCode">int</code> variable because it is potentially unsafe and could lose data, like the value after the decimal point. You must explicitly cast a <code class="inlineCode">double</code> variable into an <code class="inlineCode">int</code> variable using a pair of round brackets around the type you want to cast the <code class="inlineCode">double</code> type into. The <a id="_idIndexMarker408"/>pair of round brackets is the <strong class="keyWord">cast operator</strong>. Even then, you must be aware that the part after the decimal point will be trimmed off without warning because you have chosen to perform<a id="_idIndexMarker409"/> an explicit cast and therefore understand the consequences.</p>
    <ol>
      <li class="numberedList" value="5">Modify the assignment statement for the <code class="inlineCode">d</code> variable to explicitly cast the variable <code class="inlineCode">c</code> into an <code class="inlineCode">int</code>, and add a comment to explain what will happen, as shown highlighted in the following code:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-built_in">double</span> c = <span class="hljs-number">9.8</span>;
<span class="hljs-built_in">int</span> d = (<span class="hljs-built_in">int</span>)c; <span class="hljs-comment">// Compiler gives an error if you do not explicitly cast.</span>
WriteLine(<span class="hljs-string">$"c is </span><span class="hljs-subst">{c}</span><span class="hljs-string">, d is </span><span class="hljs-subst">{d}</span><span class="hljs-string">"</span>); <span class="code-highlight"><strong class="hljs-comment-slc">// d loses the .8 part.</strong></span>
</code></pre>
      </li>
      <li class="numberedList">Run the code to view the results, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">a is 10, b is 10
c is 9.8, d is 9
</code></pre>
      </li>
    </ol>
    <p class="normal-one">We must perform a similar operation when converting values between larger integers and smaller integers. Again, be aware that you might lose information because any value too big will have its bits copied and then be interpreted in ways that you might not expect!</p>
    <ol>
      <li class="numberedList" value="7">Enter statements to declare<a id="_idIndexMarker410"/> and assign a <code class="inlineCode">long</code> (64-bit) integer variable to an <code class="inlineCode">int</code> (32-bit) integer variable, both using a small value that will work and a too-large value that will not, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-built_in">long</span> e = <span class="hljs-number">10</span>;
<span class="hljs-built_in">int</span> f = (<span class="hljs-built_in">int</span>)e;
WriteLine(<span class="hljs-string">$"e is </span><span class="hljs-subst">{e:N0}</span><span class="hljs-string">, f is </span><span class="hljs-subst">{f:N0}</span><span class="hljs-string">"</span>);
e = <span class="hljs-built_in">long</span>.MaxValue;
f = (<span class="hljs-built_in">int</span>)e;
WriteLine(<span class="hljs-string">$"e is </span><span class="hljs-subst">{e:N0}</span><span class="hljs-string">, f is </span><span class="hljs-subst">{f:N0}</span><span class="hljs-string">"</span>);
</code></pre>
      </li>
      <li class="numberedList">Run the code to view the results, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">e is 10, f is 10
e is 9,223,372,036,854,775,807, f is -1
</code></pre>
      </li>
      <li class="numberedList">Modify the value of <code class="inlineCode">e</code> to 5 billion, as<a id="_idIndexMarker411"/> shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">e = 5_000_000_000;
</code></pre>
      </li>
      <li class="numberedList">Run the code to view <a id="_idIndexMarker412"/>the results, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">e is 5,000,000,000, f is 705,032,704
</code></pre>
      </li>
    </ol>
    <div class="note">
      <p class="normal">Five billion cannot fit into a 32-bit integer, so it overflows (wraps around) to about 705 million. It is all to do with the binary representation of integer numbers. You will see more examples of integer overflow and how to handle it later in this chapter.</p>
    </div>
    <h2 id="_idParaDest-218" class="heading-2">How negative numbers are represented in binary</h2>
    <p class="normal">You might have wondered why <code class="inlineCode">f</code> had the value <code class="inlineCode">-1</code> in the previous code. Negative, aka signed, numbers use<a id="_idIndexMarker413"/> the first bit to represent negativity. If the bit is <code class="inlineCode">0</code> (zero), then it is a positive number. If the bit is <code class="inlineCode">1</code> (one), then it is a negative number.</p>
    <p class="normal">Let’s write some code to illustrate this:</p>
    <ol>
      <li class="numberedList" value="1">Enter statements to output the maximum value for an <code class="inlineCode">int</code> in decimal and binary number formats, then output the values <code class="inlineCode">8</code> to <code class="inlineCode">-8</code>, decrementing by one, and finally, output the minimum value for an <code class="inlineCode">int</code>, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">WriteLine(<span class="hljs-string">"{0,12} {1,34}"</span>, <span class="hljs-string">"</span><span class="hljs-string">Decimal"</span>, <span class="hljs-string">"Binary"</span>);
WriteLine(<span class="hljs-string">"{0,12} {0,34:B32}"</span>, <span class="hljs-built_in">int</span>.MaxValue);
<span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = <span class="hljs-number">8</span>; i &gt;= <span class="hljs-number">-8</span>; i--)
{
  WriteLine(<span class="hljs-string">"{0,12} {0,34:B32}"</span>, i);
}
WriteLine(<span class="hljs-string">"{0,12} {0,34:B32}"</span>, <span class="hljs-built_in">int</span>.MinValue);
</code></pre>
      </li>
    </ol>
    <div class="note-one">
      <p class="normal">Note that <code class="inlineCode">,12</code> and <code class="inlineCode">,34</code> mean right-align within those column widths. <code class="inlineCode">:B32</code> means format as binary padded with leading zeros to a width of 32.</p>
    </div>
    <ol>
      <li class="numberedList" value="2">Run the code to view<a id="_idIndexMarker414"/> the results, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">     Decimal                             Binary
  2147483647   01111111111111111111111111111111
           8   00000000000000000000000000001000
           7   00000000000000000000000000000111
           6   00000000000000000000000000000110
           5   00000000000000000000000000000101
           4   00000000000000000000000000000100
           3   00000000000000000000000000000011
           2   00000000000000000000000000000010
           1   00000000000000000000000000000001
           0   00000000000000000000000000000000
          -1   11111111111111111111111111111111
          -2   11111111111111111111111111111110
          -3   11111111111111111111111111111101
          -4   11111111111111111111111111111100
          -5   11111111111111111111111111111011
          -6   11111111111111111111111111111010
          -7   11111111111111111111111111111001
          -8   11111111111111111111111111111000
 -2147483648   10000000000000000000000000000000
</code></pre>
      </li>
      <li class="numberedList">Note that all the positive binary number representations start with <code class="inlineCode">0</code> and all the negative binary number representations start with <code class="inlineCode">1</code>. The decimal value <code class="inlineCode">-1</code> is represented by all ones in binary. That is why when you have an integer too large to fit in a 32-bit integer, it becomes <code class="inlineCode">-1</code>. But it’s not always the case that the result of this type of casting is <code class="inlineCode">-1</code>. When casting from a wider integer data type to a narrower integer data type, the most significant extra bits get truncated. For example, if you’re <a id="_idIndexMarker415"/>casting from a 32-bit integer to a 16-bit integer, the 16 <strong class="keyWord">most significant bits (MSBs)</strong> of the 32-bit integer will be truncated. The <strong class="keyWord">least significant bits (LSBs)</strong> represent <a id="_idIndexMarker416"/>the result of the casting. For instance, if you’re casting to a 16-bit integer, the 16 least significant bits of the<a id="_idIndexMarker417"/> original value will represent the result after casting.</li>
      <li class="numberedList">Enter statements to show an example of a <code class="inlineCode">long</code> integer that, when cast to an <code class="inlineCode">int</code>, gets truncated to a non-minus-one value, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-built_in">long</span> r = <span class="hljs-number">0b</span>_101000101010001100100111010100101010;
<span class="hljs-built_in">int</span> s = (<span class="hljs-built_in">int</span>) r;
Console.WriteLine(<span class="hljs-string">$"</span><span class="hljs-subst">{r,</span><span class="hljs-number">38</span><span class="hljs-subst">:B38}</span><span class="hljs-string"> = </span><span class="hljs-subst">{r}</span><span class="hljs-string">"</span>);
Console.WriteLine(<span class="hljs-string">$"</span><span class="hljs-subst">{s,</span><span class="hljs-number">38</span><span class="hljs-subst">:B32}</span><span class="hljs-string"> = </span><span class="hljs-subst">{s}</span><span class="hljs-string">"</span>);
</code></pre>
      </li>
      <li class="numberedList">Run the code to view the results, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">00101000101010001100100111010100101010 = 43657622826
      00101010001100100111010100101010 = 707949866
</code></pre>
      </li>
    </ol>
    <div class="note">
      <p class="normal"><strong class="keyWord">More Information</strong>: If you are interested in learning more about how signed numbers can be represented in computer systems, then you can read the following article: <a href="https://en.wikipedia.org/wiki/Signed_number_representations"><span class="url">https://en.wikipedia.org/wiki/Signed_number_representations</span></a>.</p>
    </div>
    <h2 id="_idParaDest-219" class="heading-2">Converting with the System.Convert type</h2>
    <p class="normal">You can only cast between similar types, for example, between whole numbers like <code class="inlineCode">byte</code>, <code class="inlineCode">int</code>, and <code class="inlineCode">long</code>, or between a <a id="_idIndexMarker418"/>class and its subclasses. You cannot cast a <code class="inlineCode">long</code> to a <code class="inlineCode">string</code> or a <code class="inlineCode">byte</code> to a <code class="inlineCode">DateTime</code>.</p>
    <p class="normal">An alternative to using the cast operator is to use the <code class="inlineCode">System.Convert</code> type. The <code class="inlineCode">System.Convert</code> type can convert to and from all the C# number types, as well as Booleans, strings, and date and time values.</p>
    <p class="normal">Let’s write some code to see this in action:</p>
    <ol>
      <li class="numberedList" value="1">At the top of <code class="inlineCode">Program.cs</code>, statically import the <code class="inlineCode">System.Convert</code> class, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword">using</span> <span class="hljs-keyword">static</span> System.Convert; <span class="hljs-comment">// To use the ToInt32 method.</span>
</code></pre>
      </li>
    </ol>
    <div class="note-one">
      <p class="normal">Alternatively, add an entry to <code class="inlineCode">CastingConverting.csproj</code>, as shown in the following markup: <code class="inlineCode">&lt;Using Include="System.Convert" Static="true" /&gt;</code>.</p>
    </div>
    <ol>
      <li class="numberedList" value="2">At the bottom of <code class="inlineCode">Program.cs</code>, type statements to declare and assign a value to a <code class="inlineCode">double</code> variable, convert it into an integer, and then write both values to the console, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-built_in">double</span> g = <span class="hljs-number">9.8</span>;
<span class="hljs-built_in">int</span> h = ToInt32(g); <span class="hljs-comment">// A method of System.Convert.</span>
WriteLine(<span class="hljs-string">$"g is </span><span class="hljs-subst">{g}</span><span class="hljs-string">, h is </span><span class="hljs-subst">{h}</span><span class="hljs-string">"</span>);
</code></pre>
      </li>
      <li class="numberedList">Run the code and view the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">g is 9.8, h is 10
</code></pre>
      </li>
    </ol>
    <div class="note-one">
      <p class="normal">An important difference between casting and converting is that converting rounds the <code class="inlineCode">double</code> value <code class="inlineCode">9.8</code> up to <code class="inlineCode">10</code> instead of trimming the part after the decimal point. Another is that <a id="_idIndexMarker419"/>casting can allow overflows while converting will throw an exception.</p>
    </div>
    <h3 id="_idParaDest-220" class="heading-3">Rounding numbers and the default rounding rules</h3>
    <p class="normal">You have now<a id="_idIndexMarker420"/> seen that the cast operator trims the decimal part of a real number and that the <code class="inlineCode">System.Convert</code> method rounds up or down. However, what is the rule for rounding?</p>
    <p class="normal">In British primary schools for<a id="_idIndexMarker421"/> children aged 5 to 11, pupils are taught to round <em class="italic">up</em> if the decimal part is .5 or higher and round <em class="italic">down</em> if the decimal part is less. Of course, these terms only make sense because, at that age, the pupils are only dealing with positive numbers. With negative numbers, these terms become confusing and should be avoided. This is why the .NET API uses the <code class="inlineCode">enum</code> values <code class="inlineCode">AwayFromZero</code>, <code class="inlineCode">ToZero</code>, <code class="inlineCode">ToEven</code>, <code class="inlineCode">ToPositiveInfinity</code>, and <code class="inlineCode">ToNegativeInfinity</code> for improved clarity.</p>
    <p class="normal">Let’s explore if C# follows the same primary school rule:</p>
    <ol>
      <li class="numberedList" value="1">Type statements to declare and assign an array of <code class="inlineCode">double</code> values, convert each of them into an integer, and then write the result to the console, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-built_in">double</span>[,] doubles = {
  { <span class="hljs-number">9.49</span>, <span class="hljs-number">9.5</span>, <span class="hljs-number">9.51</span> },
  { <span class="hljs-number">10.49</span>, <span class="hljs-number">10.5</span>, <span class="hljs-number">10.51</span> },
  { <span class="hljs-number">11.49</span>, <span class="hljs-number">11.5</span>, <span class="hljs-number">11.51</span> },
  { <span class="hljs-number">12.49</span>, <span class="hljs-number">12.5</span>, <span class="hljs-number">12.51</span> } ,
  { <span class="hljs-number">-12.49</span>, <span class="hljs-number">-12.5</span>, <span class="hljs-number">-12.51</span> },
  { <span class="hljs-number">-11.49</span>, <span class="hljs-number">-11.5</span>, <span class="hljs-number">-11.51</span> },
  { <span class="hljs-number">-10.49</span>, <span class="hljs-number">-10.5</span>, <span class="hljs-number">-10.51</span> },
  { <span class="hljs-number">-9.49</span>, <span class="hljs-number">-9.5</span>, <span class="hljs-number">-9.51</span> }
};
WriteLine(<span class="hljs-string">$"| double | ToInt32 | double | ToInt32 | double | ToInt32 |"</span>);
<span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> x = <span class="hljs-number">0</span>; x &lt; <span class="hljs-number">8</span>; x++)
{
  <span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> y = <span class="hljs-number">0</span>; y &lt; <span class="hljs-number">3</span>; y++)
  {
    Write(<span class="hljs-string">$"| </span><span class="hljs-subst">{doubles[x, y],</span><span class="hljs-number">6</span><span class="hljs-subst">}</span><span class="hljs-string"> | </span><span class="hljs-subst">{ToInt32(doubles[x, y]),</span><span class="hljs-number">7</span><span class="hljs-subst">}</span><span class="hljs-string"> "</span>);
  }
  WriteLine(<span class="hljs-string">"|"</span>);
}
WriteLine();
</code></pre>
      </li>
      <li class="numberedList">Run the<a id="_idIndexMarker422"/> code and view the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">| double | ToInt32 | double | ToInt32 | double | ToInt32 |
|   9.49 |       9 |    9.5 |      10 |   9.51 |      10 |
|  10.49 |      10 |   10.5 |      10 |  10.51 |      11 |
|  11.49 |      11 |   11.5 |      12 |  11.51 |      12 |
|  12.49 |      12 |   12.5 |      12 |  12.51 |      13 |
| -12.49 |     -12 |  -12.5 |     -12 | -12.51 |     -13 |
| -11.49 |     -11 |  -11.5 |     -12 | -11.51 |     -12 |
| -10.49 |     -10 |  -10.5 |     -10 | -10.51 |     -11 |
|  -9.49 |      -9 |   -9.5 |     -10 |  -9.51 |     -10 |
</code></pre>
      </li>
    </ol>
    <p class="normal">We have shown that<a id="_idIndexMarker423"/> the rule for rounding in C# is subtly different from the primary school rule:</p>
    <ul>
      <li class="bulletList">It always rounds <em class="italic">toward zero</em> if the decimal part is less than the midpoint .5.</li>
      <li class="bulletList">It always rounds <em class="italic">away from zero</em> if the decimal part is more than the midpoint .5.</li>
      <li class="bulletList">It will round <em class="italic">away from zero</em> if the decimal part is the midpoint .5 and the non-decimal part is <em class="italic">odd</em>, but it will round <em class="italic">toward zero</em> if the non-decimal part is <em class="italic">even</em>.</li>
    </ul>
    <p class="normal">This rule is known as <strong class="keyWord">Banker’s rounding</strong>, and it is preferred because it reduces bias by alternating <a id="_idIndexMarker424"/>when it rounds toward or away from zero. Sadly, other languages such as JavaScript use the primary school rule.</p>
    <h3 id="_idParaDest-221" class="heading-3">Taking control of rounding rules</h3>
    <p class="normal">You can take control of<a id="_idIndexMarker425"/> the rounding rules by using the <code class="inlineCode">Round</code> method of the <code class="inlineCode">Math</code> class:</p>
    <ol>
      <li class="numberedList" value="1">Type statements to round each of the <code class="inlineCode">double</code> values using the “away from zero” rounding rule, also known as rounding “up,” and then write the result to the console, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword">foreach</span> (<span class="hljs-built_in">double</span> n <span class="hljs-keyword">in</span> doubles)
{
  WriteLine(format:
    <span class="hljs-string">"</span><span class="hljs-string">Math.Round({0}, 0, MidpointRounding.AwayFromZero) is {1}"</span>,
    arg0: n,
    arg1: Math.Round(<span class="hljs-keyword">value</span>: n, digits: <span class="hljs-number">0</span>,
            mode: MidpointRounding.AwayFromZero));
}
</code></pre>
        <div class="note-one">
          <p class="normal">You can use a <code class="inlineCode">foreach</code> statement to enumerate all the items in a multi-dimensional array.</p>
        </div>
      </li>
    </ol>
    <ol>
      <li class="numberedList" value="2">Run the code and view the result, as shown in the following partial output:
        <pre class="programlisting code-one"><code class="hljs-code">Math.Round(<span class="hljs-number">9.49</span>, <span class="hljs-number">0</span>, MidpointRounding.AwayFromZero) <span class="hljs-keyword">is</span> <span class="hljs-number">9</span>
Math.Round(<span class="hljs-number">9.5</span>, <span class="hljs-number">0</span>, MidpointRounding.AwayFromZero) <span class="hljs-keyword">is</span> <span class="hljs-number">10</span>
Math.Round(<span class="hljs-number">9.51</span>, <span class="hljs-number">0</span>, MidpointRounding.AwayFromZero) <span class="hljs-keyword">is</span> <span class="hljs-number">10</span>
Math.Round(<span class="hljs-number">10.49</span>, <span class="hljs-number">0</span>, MidpointRounding.AwayFromZero) <span class="hljs-keyword">is</span> <span class="hljs-number">10</span>
Math.Round(<span class="hljs-number">10.5</span>, <span class="hljs-number">0</span>, MidpointRounding.AwayFromZero) <span class="hljs-keyword">is</span> <span class="hljs-number">11</span>
Math.Round(<span class="hljs-number">10.51</span>, <span class="hljs-number">0</span>, MidpointRounding.AwayFromZero) <span class="hljs-keyword">is</span> <span class="hljs-number">11</span>
...
</code></pre>
      </li>
    </ol>
    <div class="packt_tip">
      <p class="normal"><strong class="keyWord">Good Practice</strong>: For every programming language that you use, check its rounding rules. They may not work the way you expect! You can read more about <code class="inlineCode">Math.Round</code> at the following link: <a href="https://learn.microsoft.com/en-us/dotnet/api/system.math.round"><span class="url">https://learn.microsoft.com/en-us/dotnet/api/system.math.round</span></a>.</p>
    </div>
    <h2 id="_idParaDest-222" class="heading-2">Converting from any type to a string</h2>
    <p class="normal">The most<a id="_idIndexMarker426"/> common conversion is from any type into a <code class="inlineCode">string</code> variable for outputting as human-readable text, so all types have a method named <code class="inlineCode">ToString</code> that they inherit from the <code class="inlineCode">System.Object</code> class.</p>
    <p class="normal">The <code class="inlineCode">ToString</code> method converts the current value of any variable into a textual representation. Some types can’t be sensibly represented as text, so they return their namespace and type name instead.</p>
    <p class="normal">Let’s convert some types into a <code class="inlineCode">string</code>:</p>
    <ol>
      <li class="numberedList" value="1">Type statements to declare some variables, convert them to their <code class="inlineCode">string</code> representation, and write them to the console, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-built_in">int</span> number = <span class="hljs-number">12</span>;
WriteLine(number.ToString());
<span class="hljs-built_in">bool</span> boolean = <span class="hljs-literal">true</span>;
WriteLine(boolean.ToString());
DateTime now = DateTime.Now;
WriteLine(now.ToString());
<span class="hljs-built_in">object</span> me = <span class="hljs-keyword">new</span>();
WriteLine(me.ToString());
</code></pre>
      </li>
      <li class="numberedList">Run the code and view the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">12
True
08/28/2024 17:33:54
System.Object
</code></pre>
      </li>
    </ol>
    <div class="note-one">
      <p class="normal">Passing any object to the <code class="inlineCode">WriteLine</code> method implicitly converts it into a <code class="inlineCode">string</code>, so it is not necessary to explicitly call <code class="inlineCode">ToString</code>. We are doing so here just to emphasize what is happening. Explicitly calling <code class="inlineCode">ToString</code> does avoid a boxing operation, so if you are developing games with Unity, then that can help you avoid memory garbage collection issues.</p>
    </div>
    <h2 id="_idParaDest-223" class="heading-2">Converting from a binary object to a string</h2>
    <p class="normal">When you have a binary object like an image or video that you want to either store or transmit, you sometimes do not want to send the raw bits because you do not know how those bits<a id="_idIndexMarker427"/> could be misinterpreted, for example, by the network protocol transmitting them or another operating system that is reading the stored binary object.</p>
    <p class="normal">The safest thing to do is to convert the binary object into a <code class="inlineCode">string</code> of safe characters. Programmers call this <strong class="keyWord">Base64</strong> encoding. Base64 is <a id="_idIndexMarker428"/>an encoding scheme that converts arbitrary bytes into text using a specific set of 64 characters. It’s widely used for data transfer and has long been supported through various methods.</p>
    <p class="normal">The <code class="inlineCode">Convert</code> type has a pair of methods, <code class="inlineCode">ToBase64String</code> and <code class="inlineCode">FromBase64String</code>, that perform this conversion for you. Let’s see them in action:</p>
    <ol>
      <li class="numberedList" value="1">Type statements to create an array of bytes randomly populated with byte values, write each byte nicely formatted to the console, and then write the same bytes converted into Base64 to the console, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-comment">// Allocate an array of 128 bytes.</span>
<span class="hljs-built_in">byte</span>[] binaryObject = <span class="hljs-keyword">new</span> <span class="hljs-built_in">byte</span>[<span class="hljs-number">128</span>];
<span class="hljs-comment">// Populate the array with random bytes.</span>
Random.Shared.NextBytes(binaryObject);
WriteLine(<span class="hljs-string">"Binary Object as bytes:"</span>);
<span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> index = <span class="hljs-number">0</span>; index &lt; binaryObject.Length; index++)
{
  Write(<span class="hljs-string">$"</span><span class="hljs-subst">{binaryObject[index]:X2}</span><span class="hljs-string"> "</span>);
}
WriteLine();
<span class="hljs-comment">// Convert the array to Base64 string and output as text.</span>
<span class="hljs-built_in">string</span> encoded = ToBase64String(binaryObject);
WriteLine(<span class="hljs-string">$"Binary Object as Base64: </span><span class="hljs-subst">{encoded}</span><span class="hljs-string">"</span>);
</code></pre>
      </li>
    </ol>
    <div class="note-one">
      <p class="normal">By default, an <code class="inlineCode">int</code> value would output assuming decimal notation, that is, Base10. You can use format codes such as <code class="inlineCode">:X2</code> to format the value using hexadecimal notation.</p>
    </div>
    <ol>
      <li class="numberedList" value="2">Run the code and view <a id="_idIndexMarker429"/>the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">Binary Object as bytes:
EB 53 8B 11 9D 83 E6 4D 45 85 F4 68 F8 18 55 E5 B8 33 C9 B6 F4 00 10 7F CB 59 23 7B 26 18 16 30 00 23 E6 8F A9 10 B0 A9 E6 EC 54 FB 4D 33 E1 68 50 46 C4 1D 5F B1 57 A1 DB D0 60 34 D2 16 93 39 3E FA 0B 08 08 E9 96 5D 64 CF E5 CD C5 64 33 DD 48 4F E8 B0 B4 19 51 CA 03 6F F4 18 E3 E5 C7 0C 11 C7 93 BE 03 35 44 D1 6F AA B0 2F A9 CE D5 03 A8 00 AC 28 8F A5 12 8B 2E BE 40 C4 31 A8 A4 1A
Binary Object as Base64: 61OLEZ2D5k1FhfRo+BhV5bgzybb0ABB/y1kjeyYYFjAAI+aPqRCwqebsVPtNM+FoUEbEHV+xV6Hb0GA00haTOT76CwgI6ZZdZM/lzcVkM91IT+iwtBlRygNv9Bjj5ccMEceTvgM1RNFvqrAvqc7VA6gArCiPpRKLLr5AxDGopBo=
</code></pre>
      </li>
    </ol>
    <h2 id="_idParaDest-224" class="heading-2">Base64 for URLs</h2>
    <p class="normal">Base64 is useful, but some of the characters it uses, like <code class="inlineCode">+</code> and <code class="inlineCode">/</code>, are problematic for certain uses, such as<a id="_idIndexMarker430"/> query strings in URLs, where these characters have special meanings.</p>
    <p class="normal">To address this issue, the Base64Url scheme was created. It is similar to Base64 but uses a slightly different set of characters, making it suitable for contexts like URLs.</p>
    <div class="note">
      <p class="normal"><strong class="keyWord">More Information</strong>: You can learn more about the Base64Url scheme at the following link: <a href="https://base64.guru/standards/base64url"><span class="url">https://base64.guru/standards/base64url</span></a>.</p>
    </div>
    <p class="normal">.NET 9 introduces the new <code class="inlineCode">Base64Url</code> class, which offers a range of optimized methods for encoding and decoding data using the <code class="inlineCode">Base64Url</code> scheme. For example, you can<a id="_idIndexMarker431"/> convert some arbitrary bytes into Base64Url, as shown in the following code:</p>
    <pre class="programlisting code"><code class="hljs-code">ReadOnlySpan&lt;byte&gt; bytes = ...;
string encoded = Base64Url.EncodeToString(bytes);
</code></pre>
    <h2 id="_idParaDest-225" class="heading-2">Parsing from strings to numbers or dates and times</h2>
    <p class="normal">The second most <a id="_idIndexMarker432"/>common conversion is from strings to numbers or date and time values.</p>
    <p class="normal">The opposite of <code class="inlineCode">ToString</code> is <code class="inlineCode">Parse</code>. Only a few types have a <code class="inlineCode">Parse</code> method, including all the number types and <code class="inlineCode">DateTime</code>.</p>
    <p class="normal">Let’s see <code class="inlineCode">Parse</code> in action:</p>
    <ol>
      <li class="numberedList" value="1">At the top of <code class="inlineCode">Program.cs</code>, import the namespace for working with cultures, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword">using</span> System.Globalization; <span class="hljs-comment">// To use CultureInfo.</span>
</code></pre>
      </li>
      <li class="numberedList">At the bottom of <code class="inlineCode">Program.cs</code>, add statements to parse an integer and a date and time value from strings, and then write the result to the console, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-comment">// Set the current culture to make sure date parsing works.</span>
CultureInfo.CurrentCulture = CultureInfo.GetCultureInfo(<span class="hljs-string">"en-US"</span>);
<span class="hljs-built_in">int</span> friends = <span class="hljs-built_in">int</span>.Parse(<span class="hljs-string">"27"</span>);
DateTime birthday = DateTime.Parse(<span class="hljs-string">"4 June 1980"</span>);
WriteLine(<span class="hljs-string">$"I have </span><span class="hljs-subst">{friends}</span><span class="hljs-string"> friends to invite to my party."</span>);
WriteLine(<span class="hljs-string">$"My birthday is </span><span class="hljs-subst">{birthday}</span><span class="hljs-string">."</span>);
WriteLine(<span class="hljs-string">$"My birthday is </span><span class="hljs-subst">{birthday:D}</span><span class="hljs-string">."</span>);
</code></pre>
      </li>
      <li class="numberedList">Run the code and view the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">I have 27 friends to invite to my party.
My birthday is 6/4/1980 12:00:00 AM.
My birthday is Wednesday, June 4, 1980.
</code></pre>
      </li>
    </ol>
    <p class="normal-one">By default, a date and time value outputs with the short date and time format. You can use format codes such as <code class="inlineCode">D</code> to output only the date part using<a id="_idIndexMarker433"/> the long date format.</p>
    <div class="packt_tip-one">
      <p class="normal"><strong class="keyWord">Good Practice</strong>: Use the standard date and time format specifiers, as shown at the following link: <a href="https://learn.microsoft.com/en-us/dotnet/standard/base-types/standard-date-and-time-format-strings#table-of-format-specifiers"><span class="url">https://learn.microsoft.com/en-us/dotnet/standard/base-types/standard-date-and-time-format-strings#table-of-format-specifiers</span></a>.</p>
    </div>
    <h2 id="_idParaDest-226" class="heading-2">Avoiding Parse exceptions by using the TryParse method</h2>
    <p class="normal">One problem<a id="_idIndexMarker434"/> with the <code class="inlineCode">Parse</code> method is that it gives<a id="_idIndexMarker435"/> errors if the <code class="inlineCode">string</code> cannot be converted:</p>
    <ol>
      <li class="numberedList" value="1">Type a statement to attempt to parse a string containing letters into an integer variable, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-built_in">int</span> count = <span class="hljs-built_in">int</span>.Parse(<span class="hljs-string">"abc"</span>);
</code></pre>
      </li>
      <li class="numberedList">Run the code and view the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">Unhandled Exception: System.FormatException: Input string was not in a correct format.
</code></pre>
      </li>
    </ol>
    <p class="normal">As well as the preceding exception message, you will see a stack trace. I have not included stack traces in this book because they take up too much space.</p>
    <p class="normal">To avoid errors, you can use the <code class="inlineCode">TryParse</code> method instead. <code class="inlineCode">TryParse</code> attempts to convert the input <code class="inlineCode">string</code> and returns <code class="inlineCode">true</code> if it can convert it and <code class="inlineCode">false</code> if it cannot. Exceptions are a relatively expensive operation so they should be avoided when possible.</p>
    <p class="normal">The <code class="inlineCode">out</code> keyword is required to allow the <code class="inlineCode">TryParse</code> method to set the <code class="inlineCode">count</code> variable when the conversion <a id="_idIndexMarker436"/>works.</p>
    <p class="normal">Let’s see <code class="inlineCode">TryParse</code> in <a id="_idIndexMarker437"/>action:</p>
    <ol>
      <li class="numberedList" value="1">Replace the <code class="inlineCode">int</code> <code class="inlineCode">count</code> declaration with statements to use the <code class="inlineCode">TryParse</code> method and ask the user to input a count for the number of eggs, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">Write(<span class="hljs-string">"How many eggs are there? "</span>);
<span class="hljs-built_in">string</span>? input = ReadLine();
<span class="hljs-keyword">if</span> (<span class="hljs-built_in">int</span>.TryParse(input, <span class="hljs-keyword">out</span> <span class="hljs-built_in">int</span> count))
{
  WriteLine(<span class="hljs-string">$"There are </span><span class="hljs-subst">{count}</span><span class="hljs-string"> eggs."</span>);
}
<span class="hljs-keyword">else</span>
{
  WriteLine(<span class="hljs-string">"I could not parse the input."</span>);
}
</code></pre>
      </li>
      <li class="numberedList">Run the code, enter <code class="inlineCode">12</code>, and view the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">How many eggs are there? 12
There are 12 eggs.
</code></pre>
      </li>
      <li class="numberedList">Run the code, enter <code class="inlineCode">twelve</code>, and view the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">How many eggs are there? twelve
I could not parse the input.
</code></pre>
      </li>
    </ol>
    <p class="normal">You can also use methods of the <code class="inlineCode">System.Convert</code> type to convert <code class="inlineCode">string</code> values into other types; however, like<a id="_idIndexMarker438"/> the <code class="inlineCode">Parse</code> method, it gives an error if it cannot <a id="_idIndexMarker439"/>convert.</p>
    <h2 id="_idParaDest-227" class="heading-2">Understanding the Try method naming convention</h2>
    <p class="normal">.NET uses a standard signature for all methods that follow the <code class="inlineCode">Try</code> naming convention. For any method<a id="_idIndexMarker440"/> named <code class="inlineCode">Something</code> that returns a value of a specific type, its matching <code class="inlineCode">TrySomething</code> method must return a <code class="inlineCode">bool</code> to indicate success or failure and use an <code class="inlineCode">out</code> parameter in place of the return value. For example:</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment">// A method that might throw an exception.</span>
<span class="hljs-built_in">int</span> number = <span class="hljs-built_in">int</span>.Parse(<span class="hljs-string">"123"</span>);
<span class="hljs-comment">// The Try equivalent of the method.</span>
<span class="hljs-built_in">bool</span> success = <span class="hljs-built_in">int</span>.TryParse(<span class="hljs-string">"123"</span>, <span class="hljs-keyword">out</span> <span class="hljs-built_in">int</span> number);
<span class="hljs-comment">// Trying to create a Uri for a Web API.</span>
<span class="hljs-built_in">bool</span> success = Uri.TryCreate(<span class="hljs-string">"https://localhost:5000/api/customers"</span>,
  UriKind.Absolute, <span class="hljs-keyword">out</span> Uri serviceUrl);
</code></pre>
    <h1 id="_idParaDest-228" class="heading-1">Handling exceptions</h1>
    <p class="normal">You’ve seen several scenarios where errors have occurred when converting types. Some languages <a id="_idIndexMarker441"/>return error codes when something goes wrong. .NET uses exceptions that are richer and designed only for failure reporting. When this happens, we say <em class="italic">a runtime exception has been thrown</em>.</p>
    <p class="normal">Other systems might use return values that could have multiple uses. For example, if the return value is a positive number, it might represent the count of rows in a table, or if the return value is a negative number, it might represent some error code.</p>
    <p class="normal">Some third-party libraries make it easier to define “result” types that can indicate errors as well as successes. Many .NET developers prefer to use them instead of throwing exceptions. You can learn more about this in an optional online section at the end of this chapter.</p>
    <p class="normal">When an exception is thrown, the thread is suspended, and if the calling code has defined a <code class="inlineCode">try-catch</code> statement, then it is given a chance to handle the exception. If the current method does not handle it, then its calling method is given a chance, and so on up the call stack.</p>
    <p class="normal">As you have seen, the default behavior of a console app is to output a message about the exception, including a stack trace, and then stop running the code. The application is terminated. This is better than allowing the code to continue executing in a potentially corrupt state. Your code should only catch and handle exceptions that it understands and can properly fix.</p>
    <div class="packt_tip">
      <p class="normal"><strong class="keyWord">Good Practice</strong>: Avoid writing code that will throw an exception whenever possible, perhaps by performing <code class="inlineCode">if</code> statement checks. Sometimes you can’t, and sometimes it is best to allow the exception to be caught by a higher-level component that is calling your code. You will learn how to do this in <em class="chapterRef">Chapter 4</em>, <em class="italic">Writing, Debugging, and Testing Functions</em>.</p>
    </div>
    <div class="note">
      <p class="normal">In .NET 9, exception<a id="_idIndexMarker442"/> handling uses a new implementation based on the NativeAOT exception handling model. This improves exception handling performance by 2 to 4 times in the .NET team’s benchmarks. </p>
    </div>
    <h2 id="_idParaDest-229" class="heading-2">Wrapping error-prone code in a try block</h2>
    <p class="normal">When you know that a statement <a id="_idIndexMarker443"/>can cause an error, you should wrap that statement in a <code class="inlineCode">try</code> block. For example, parsing from text to a number can cause an error. Any statements <a id="_idIndexMarker444"/>in the <code class="inlineCode">catch</code> block will be executed only if an exception is thrown by a statement in the <code class="inlineCode">try</code> block.</p>
    <p class="normal">We don’t have to do anything inside the <code class="inlineCode">catch</code> block. Let’s see this in action:</p>
    <ol>
      <li class="numberedList" value="1">Use your preferred code editor to add a new <strong class="screenText">Console App </strong>/ <code class="inlineCode">console</code> project named <code class="inlineCode">HandlingExceptions</code> to the <code class="inlineCode">Chapter03</code> solution.</li>
      <li class="numberedList">In <code class="inlineCode">Program.cs</code>, delete any existing statements, and then type statements to <a id="_idIndexMarker445"/>prompt the user to enter their age and then write their age to the console, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">WriteLine(<span class="hljs-string">"Before parsing"</span>);
Write(<span class="hljs-string">"What is your age? "</span>);
<span class="hljs-built_in">string</span>? input = ReadLine();
<span class="hljs-keyword">try</span>
{
  <span class="hljs-built_in">int</span> age = <span class="hljs-built_in">int</span>.Parse(input);
  WriteLine(<span class="hljs-string">$"You are </span><span class="hljs-subst">{age}</span><span class="hljs-string"> years old."</span>);
}
<span class="hljs-keyword">catch</span>
{
}
WriteLine(<span class="hljs-string">"After parsing"</span>);
</code></pre>
      </li>
    </ol>
    <p class="normal">You will see the following compiler message: <code class="inlineCode">Warning CS8604 Possible null reference argument for parameter 's' in 'int int.Parse(string s)'</code>.</p>
    <p class="normal">By default, in .NET 6 or later projects, Microsoft enables nullable reference types, so you<a id="_idIndexMarker446"/> will see many more compiler warnings like this. In production code, you should add code to check for <code class="inlineCode">null</code> and handle that possibility appropriately, as shown in the following code:</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">if</span> (input <span class="hljs-keyword">is</span> <span class="hljs-literal">null</span>)
{
  WriteLine(<span class="hljs-string">"You did not enter a value so the app has ended."</span>);
  <span class="hljs-keyword">return</span>; <span class="hljs-comment">// Exit the app.</span>
}
</code></pre>
    <p class="normal">In this book, I will not give instructions to add these <code class="inlineCode">null</code> checks every time because the code samples are not designed to be production-quality, and having <code class="inlineCode">null</code> checks everywhere will clutter the code and use up valuable pages.</p>
    <p class="normal">You will probably see hundreds more examples of potentially <code class="inlineCode">null</code> variables throughout the code samples in this book. Those warnings are safe to ignore for the book code examples. You only need to pay attention to similar warnings when you write your own production code. You will see more about null handling in <em class="chapterRef">Chapter 6</em>,<em class="chapterRef"> </em><em class="italic">Implementing Interfaces and Inheriting Classes</em>.</p>
    <p class="normal">In this case, it is impossible <a id="_idIndexMarker447"/>for <code class="inlineCode">input</code> to be <code class="inlineCode">null</code> because the user must press <em class="keystroke">Enter</em> for <code class="inlineCode">ReadLine</code> to return, and if they have not typed any characters at that point, then the <code class="inlineCode">ReadLine</code> method will return an empty <code class="inlineCode">string</code>. Let’s tell the compiler that it does not need to show us this warning:</p>
    <ol>
      <li class="numberedList" value="1">To disable the compiler warning, change <code class="inlineCode">input</code> to <code class="inlineCode">input!</code>, as shown highlighted in the following code:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-built_in">int</span> age = <span class="hljs-built_in">int</span>.Parse(input<span class="code-highlight"><strong class="hljs-slc">!</strong></span>);
</code></pre>
      </li>
    </ol>
    <div class="note-one">
      <p class="normal">An exclamation mark, <code class="inlineCode">!</code>, after an <a id="_idIndexMarker448"/>expression is called the <strong class="keyWord">null-forgiving operator</strong> and it disables the compiler warning. The <strong class="keyWord">null-forgiving operator</strong> has no effect at runtime. If the expression could evaluate to <code class="inlineCode">null</code> at runtime, perhaps because we assigned it in another way, then an exception would be thrown.</p>
    </div>
    <p class="normal-one">This code includes <a id="_idIndexMarker449"/>two messages to indicate <em class="italic">before</em> parsing and <em class="italic">after</em> parsing to make the flow through the code clearer. These will be especially useful as the example code grows more complex.</p>
    <ol>
      <li class="numberedList" value="2">Run the code, enter <code class="inlineCode">49</code>, and view the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">Before parsing
What is your age? 49
You are 49 years old.
After parsing
</code></pre>
      </li>
      <li class="numberedList">Run the code, enter <code class="inlineCode">Kermit</code>, and view the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">Before parsing
What is your age? Kermit
After parsing
</code></pre>
      </li>
    </ol>
    <p class="normal">When the code was executed, the error exception was caught, the default message and stack trace were not output, and the console app continued running. This is better<a id="_idIndexMarker450"/> than the default behavior, but it might be useful to see the type of error that occurred.</p>
    <div class="packt_tip">
      <p class="normal"><strong class="keyWord">Good Practice</strong>: You should never use an empty <code class="inlineCode">catch</code> statement like this in production code because it “swallows” exceptions and hides potential problems. You should at least log the exception if you cannot or do not want to handle it properly, or <a id="_idIndexMarker451"/>rethrow it so that higher-level code can decide instead. You will learn about logging in <em class="chapterRef">Chapter 4</em>,<em class="chapterRef"> </em><em class="italic">Writing, Debugging, and Testing Functions</em>.</p>
    </div>
    <h2 id="_idParaDest-230" class="heading-2">Catching all exceptions</h2>
    <p class="normal">To get information about any type of exception that might occur, you can declare a variable of type <code class="inlineCode">System.Exception</code> to the <code class="inlineCode">catch</code> block:</p>
    <ol>
      <li class="numberedList" value="1">Add an exception <a id="_idIndexMarker452"/>variable declaration to the <code class="inlineCode">catch</code> block and use it to write information about the exception to the console, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword">catch</span> (Exception ex)
{
  WriteLine(<span class="hljs-string">$"</span><span class="hljs-subst">{ex.GetType()}</span><span class="hljs-string"> says </span><span class="hljs-subst">{ex.Message}</span><span class="hljs-string">"</span>);
}
</code></pre>
      </li>
      <li class="numberedList">Run the code, enter <code class="inlineCode">Kermit</code> again, and view the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">Before parsing
What is your age? Kermit
System.FormatException says Input string was not in a correct format.
After parsing
</code></pre>
      </li>
    </ol>
    <h2 id="_idParaDest-231" class="heading-2">Catching specific exceptions</h2>
    <p class="normal">Now that we know which <a id="_idIndexMarker453"/>specific type of exception occurred, we can improve our code by catching just that type of exception and customizing the message that we display to the user. You can think of this as a form of testing:</p>
    <ol>
      <li class="numberedList" value="1">Leave the existing <code class="inlineCode">catch</code> block and, above it, add a new <code class="inlineCode">catch</code> block for the format <a id="_idIndexMarker454"/>exception type, as shown in the following highlighted code:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="code-highlight"><strong class="hljs-keyword-slc">catch</strong><strong class="hljs-slc"> (FormatException)</strong></span>
<span class="code-highlight"><strong class="hljs-slc">{</strong></span>
<span class="code-highlight"><strong class="hljs-slc">  WriteLine(</strong><strong class="hljs-string-slc">"</strong><strong class="hljs-string-slc">The age you entered is not a valid number format."</strong><strong class="hljs-slc">);</strong></span>
<span class="code-highlight"><strong class="hljs-slc">}</strong></span>
<span class="hljs-keyword">catch</span> (Exception ex)
{
  WriteLine(<span class="hljs-string">$"</span><span class="hljs-subst">{ex.GetType()}</span><span class="hljs-string"> says </span><span class="hljs-subst">{ex.Message}</span><span class="hljs-string">"</span>);
}
</code></pre>
      </li>
      <li class="numberedList">Run the code, enter <code class="inlineCode">Kermit</code> again, and view the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">Before parsing
What is your age? Kermit
The age you entered is not a valid number format.
After parsing
</code></pre>
      </li>
    </ol>
    <p class="normal-one">The reason we want to leave the more general <code class="inlineCode">catch</code> below is that there might be other types of exceptions that can occur.</p>
    <ol>
      <li class="numberedList" value="3">Run the code, enter <code class="inlineCode">9876543210</code>, and view the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">Before parsing
What is your age? 9876543210
System.OverflowException says Value was either too large or too small for an Int32.
After parsing
</code></pre>
      </li>
    </ol>
    <p class="normal-one">Let’s add another <code class="inlineCode">catch</code> block for this type of exception.</p>
    <ol>
      <li class="numberedList" value="4">Leave the existing <code class="inlineCode">catch</code> blocks, and add a new <code class="inlineCode">catch</code> block for the overflow <a id="_idIndexMarker455"/>exception type, as shown in the following highlighted code:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="code-highlight"><strong class="hljs-keyword-slc">catch</strong><strong class="hljs-slc"> (OverflowException)</strong></span>
<span class="code-highlight"><strong class="hljs-slc">{</strong></span>
<span class="code-highlight"><strong class="hljs-slc">  WriteLine(</strong><strong class="hljs-string-slc">"Your age is a valid number format but it is either too big or small."</strong><strong class="hljs-slc">);</strong></span>
<span class="code-highlight"><strong class="hljs-slc">}</strong></span>
<span class="hljs-keyword">catch</span> (FormatException)
{
  WriteLine(<span class="hljs-string">"The age you entered is not a valid number format."</span>);
}
</code></pre>
      </li>
      <li class="numberedList">Run the code, enter <code class="inlineCode">9876543210</code>, and view the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">Before parsing
What is your age? 9876543210
Your age is a valid number format but it is either too big or small.
After parsing
</code></pre>
      </li>
    </ol>
    <p class="normal">The order in which you catch exceptions is important. The correct order is related to the inheritance hierarchy of the exception types. You will learn about inheritance in <em class="chapterRef">Chapter 5</em>,<em class="chapterRef"> </em><em class="italic">Building Your Own Types with Object-Oriented Programming</em>. However, don’t worry too much about this—the compiler will give you build errors if you get exceptions in the wrong order anyway.</p>
    <div class="packt_tip">
      <p class="normal"><strong class="keyWord">Good Practice</strong>: Avoid over-catching exceptions. They should often be allowed to propagate up the call stack to be handled at a level where more information is known about the circumstances that could change the logic of how they should be handled. You will learn about this in <em class="chapterRef">Chapter 4</em>,<em class="chapterRef"> </em><em class="italic">Writing, Debugging, and Testing Functions</em>.</p>
    </div>
    <h2 id="_idParaDest-232" class="heading-2">Catching with filters</h2>
    <p class="normal">You can also add filters to a <code class="inlineCode">catch</code> statement <a id="_idIndexMarker456"/>using the <code class="inlineCode">when</code> keyword, as shown in the following <a id="_idIndexMarker457"/>code:</p>
    <pre class="programlisting code"><code class="hljs-code">Write(<span class="hljs-string">"Enter an amount: "</span>);
<span class="hljs-built_in">string</span> amount = ReadLine()!;
<span class="hljs-keyword">if</span> (<span class="hljs-built_in">string</span>.IsNullOrEmpty(amount)) <span class="hljs-keyword">return</span>;
<span class="hljs-keyword">try</span>
{
  <span class="hljs-built_in">decimal</span> amountValue = <span class="hljs-built_in">decimal</span>.Parse(amount);
  WriteLine(<span class="hljs-string">$"Amount formatted as currency: </span><span class="hljs-subst">{amountValue:C}</span><span class="hljs-string">"</span>);
}
<span class="hljs-keyword">catch</span> (FormatException) <span class="hljs-keyword">when</span> (amount.Contains(<span class="hljs-string">'$'</span>))
{
  WriteLine(<span class="hljs-string">"Amounts cannot use the dollar sign!"</span>);
}
<span class="hljs-keyword">catch</span> (FormatException)
{
  WriteLine(<span class="hljs-string">"Amounts must only contain digits!"</span>);
}
</code></pre>
    <div class="packt_tip">
      <p class="normal"><strong class="keyWord">Good Practice</strong>: The <code class="inlineCode">Contains</code> method on the <code class="inlineCode">string</code> type has overloads for both a <code class="inlineCode">string</code> value that is passed using double-quotes and a <code class="inlineCode">char</code> value that is passed using single-quotes. When you want to check for one character, like a dollar, it is more efficient to use the <code class="inlineCode">char</code> overload as in the preceding code.</p>
    </div>
    <h1 id="_idParaDest-233" class="heading-1">Checking for overflow</h1>
    <p class="normal">Earlier, we saw that when<a id="_idIndexMarker458"/> casting between number types, it was possible to lose information, for example, when casting from a <code class="inlineCode">long</code> variable to an <code class="inlineCode">int</code> variable. If the value stored in a type is too big, it will overflow.</p>
    <h2 id="_idParaDest-234" class="heading-2">Throwing overflow exceptions with the checked statement</h2>
    <p class="normal">The <code class="inlineCode">checked</code> statement tells .NET to throw an exception when an overflow happens instead of allowing it to <a id="_idIndexMarker459"/>happen silently, which is done by default for performance reasons.</p>
    <p class="normal">We will set the initial value of <a id="_idIndexMarker460"/>an <code class="inlineCode">int</code> variable to its maximum value minus one. Then, we will increment it several times, outputting its value each time. Once it gets above its maximum value, it overflows to its minimum value and continues incrementing from there.</p>
    <p class="normal">Let’s see this in action:</p>
    <ol>
      <li class="numberedList" value="1">In <code class="inlineCode">Program.cs</code>, type statements to declare and assign an integer to one less than its maximum possible value, and then increment it and write its value to the console three times, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-built_in">int</span> x = <span class="hljs-built_in">int</span>.MaxValue - <span class="hljs-number">1</span>;
WriteLine(<span class="hljs-string">$"Initial value: </span><span class="hljs-subst">{x}</span><span class="hljs-string">"</span>);
x++;
WriteLine(<span class="hljs-string">$"After incrementing: </span><span class="hljs-subst">{x}</span><span class="hljs-string">"</span>);
x++;
WriteLine(<span class="hljs-string">$"After incrementing: </span><span class="hljs-subst">{x}</span><span class="hljs-string">"</span>);
x++;
WriteLine(<span class="hljs-string">$"After incrementing: </span><span class="hljs-subst">{x}</span><span class="hljs-string">"</span>);
</code></pre>
      </li>
      <li class="numberedList">Run the code and view the result that shows the value overflowing silently and wrapping around to large negative values, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">Initial value: 2147483646
After incrementing: 2147483647
After incrementing: -2147483648
After incrementing: -2147483647
</code></pre>
      </li>
      <li class="numberedList">Now, let’s get the compiler to warn us about the overflow by wrapping the statements using a <code class="inlineCode">checked</code> statement block, as shown highlighted in the following code:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="code-highlight"><strong class="hljs-slc">checked</strong></span>
<span class="code-highlight"><strong class="hljs-slc">{</strong></span>
  <span class="hljs-built_in">int</span> x = <span class="hljs-built_in">int</span>.MaxValue - <span class="hljs-number">1</span>;
  WriteLine(<span class="hljs-string">$"Initial value: </span><span class="hljs-subst">{x}</span><span class="hljs-string">"</span>);
  x++;
  WriteLine(<span class="hljs-string">$"After incrementing: </span><span class="hljs-subst">{x}</span><span class="hljs-string">"</span>);
  x++;
  WriteLine(<span class="hljs-string">$"After incrementing: </span><span class="hljs-subst">{x}</span><span class="hljs-string">"</span>);
  x++;
  WriteLine(<span class="hljs-string">$"After incrementing: </span><span class="hljs-subst">{x}</span><span class="hljs-string">"</span>);
<span class="code-highlight"><strong class="hljs-slc">}</strong></span>
</code></pre>
      </li>
      <li class="numberedList">Run the code and <a id="_idIndexMarker461"/>view the result that shows the overflow being checked and causing an exception<a id="_idIndexMarker462"/> to be thrown, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">Initial value: 2147483646
After incrementing: 2147483647
Unhandled Exception: System.OverflowException: Arithmetic operation resulted in an overflow.
</code></pre>
      </li>
      <li class="numberedList">Just like any other exception, we should wrap these statements in a <code class="inlineCode">try</code> statement block and display a nicer error message for the user, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword">try</span>
{
  <span class="hljs-comment">// previous code goes here</span>
}
<span class="hljs-keyword">catch</span> (OverflowException)
{
  WriteLine(<span class="hljs-string">"The code overflowed but I caught the exception."</span>);
}
</code></pre>
      </li>
      <li class="numberedList">Run the code and view the result, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">Initial value: 2147483646
After incrementing: 2147483647
The code overflowed but I caught the exception.
</code></pre>
      </li>
    </ol>
    <h2 id="_idParaDest-235" class="heading-2">Disabling compiler overflow checks with the unchecked statement</h2>
    <p class="normal">The previous section was about the default overflow behavior at <em class="italic">runtime</em> and how to use the <code class="inlineCode">checked</code> statement to change <a id="_idIndexMarker463"/>that behavior. This section is about <em class="italic">compile-time</em> overflow behavior <a id="_idIndexMarker464"/>and how to use the <code class="inlineCode">unchecked</code> statement to change that behavior.</p>
    <p class="normal">A related keyword is <code class="inlineCode">unchecked</code>. This keyword switches off overflow checks performed by the compiler within a block of code. Let’s see how to do this:</p>
    <ol>
      <li class="numberedList" value="1">Type the following statement at the end of the previous statements. The compiler will not compile this statement because it knows it will overflow:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-built_in">int</span> y = <span class="hljs-built_in">int</span>.MaxValue + <span class="hljs-number">1</span>;
</code></pre>
      </li>
      <li class="numberedList">Hover your mouse pointer over the error, and note that a compile-time check is shown as an error message, as shown in <em class="italic">Figure 3.4</em>:</li>
    </ol>
    <figure class="mediaobject"><img src="../Images/B22322_03_04.png" alt="" width="812" height="207"/></figure>
    <p class="packt_figref">Figure 3.4: A compile-time check for integer overflow</p>
    <ol>
      <li class="numberedList" value="3">To disable compile-time checks, wrap the statement in an <code class="inlineCode">unchecked</code> block, write the <a id="_idIndexMarker465"/>value of <code class="inlineCode">y</code> to the console, decrement it, and repeat, as shown in the following <a id="_idIndexMarker466"/>code:
        <pre class="programlisting code-one"><code class="hljs-code"><span class="code-highlight"><strong class="hljs-keyword-slc">unchecked</strong></span>
<span class="code-highlight"><strong class="hljs-slc">{</strong></span>
  <span class="hljs-built_in">int</span> y = <span class="hljs-built_in">int</span>.MaxValue + <span class="hljs-number">1</span>;
<span class="code-highlight"><strong class="hljs-slc">  WriteLine(</strong><strong class="hljs-string-slc">$"Initial value: </strong><strong class="hljs-subst-slc">{y}</strong><strong class="hljs-string-slc">"</strong><strong class="hljs-slc">);</strong></span>
<span class="code-highlight"><strong class="hljs-slc">  y--;</strong></span>
<span class="code-highlight"><strong class="hljs-slc">  WriteLine(</strong><strong class="hljs-string-slc">$"After decrementing: </strong><strong class="hljs-subst-slc">{y}</strong><strong class="hljs-string-slc">"</strong><strong class="hljs-slc">);</strong></span>
<span class="code-highlight"><strong class="hljs-slc">  y--;</strong></span>
<span class="code-highlight"><strong class="hljs-slc">  WriteLine(</strong><strong class="hljs-string-slc">$"After decrementing: </strong><strong class="hljs-subst-slc">{y}</strong><strong class="hljs-string-slc">"</strong><strong class="hljs-slc">);</strong></span>
<span class="code-highlight"><strong class="hljs-slc">}</strong></span>
</code></pre>
      </li>
      <li class="numberedList">Run the code and view the results, as shown in the following output:
        <pre class="programlisting con-one"><code class="hljs-con">Initial value: -2147483648
After decrementing: 2147483647
After decrementing: 2147483646
</code></pre>
      </li>
    </ol>
    <p class="normal">Of course, it would be rare that you would want to explicitly switch off a check like this because it allows an overflow to occur. But perhaps you can think of a scenario where you might want that behavior.</p>
    <h1 id="_idParaDest-236" class="heading-1">Practicing and exploring</h1>
    <p class="normal">Test your knowledge and understanding by answering some questions, getting some hands-on practice, and exploring this chapter’s topics with deeper research.</p>
    <h2 id="_idParaDest-237" class="heading-2">Exercise 3.1 – Online material</h2>
    <p class="normal">Online material can be extra content written by me for this book, or it can be references to content created by Microsoft or third parties.</p>
    <h3 id="_idParaDest-238" class="heading-3">Returning result types versus throwing exceptions</h3>
    <p class="normal">In .NET programming, handling errors often revolves around two primary mechanisms: exceptions and result types. Learn more about result types by reading the following online section:</p>
    <p class="normal"><a href="https://github.com/markjprice/cs13net9/blob/main/docs/ch03-result-types.md"><span class="url">https://github.com/markjprice/cs13net9/blob/main/docs/ch03-result-types.md</span></a></p>
    <h3 id="_idParaDest-239" class="heading-3">C# 101 notebooks</h3>
    <p class="normal">Use the links to notebooks and videos at the following link to see interactive examples of C# using Polyglot Notebooks:</p>
    <p class="normal"><a href="https://github.com/dotnet/csharp-notebooks#c-101"><span class="url">https://github.com/dotnet/csharp-notebooks#c-101</span></a></p>
    <h2 id="_idParaDest-240" class="heading-2">Exercise 3.2 – Practice exercises</h2>
    <p class="normal">Practice exercises go deeper into the topics for this chapter.</p>
    <h3 id="_idParaDest-241" class="heading-3">Loops and overflow</h3>
    <p class="normal">What will happen if this code executes?</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-built_in">int</span> max = <span class="hljs-number">500</span>;
<span class="hljs-keyword">for</span> (<span class="hljs-built_in">byte</span> i = <span class="hljs-number">0</span>; i &lt; max; i++)
{
  WriteLine(i);
}
</code></pre>
    <p class="normal">Create a console app in <code class="inlineCode">Chapter03</code> named <code class="inlineCode">Exercise_LoopsAndOverflow</code> and enter the preceding code. Run the console app and view the output. What happens?</p>
    <p class="normal">What code could you add (don’t change any of the preceding code) to warn us about the problem?</p>
    <h3 id="_idParaDest-242" class="heading-3">Practice loops and operators</h3>
    <p class="normal">FizzBuzz is a group game for children to teach them about division. Players take turns to count incrementally, replacing any number divisible by 3 with the word <em class="italic">fizz</em>, any number divisible by 5 with the word <em class="italic">buzz</em>, and any number divisible by both with <em class="italic">fizzbuzz</em>.</p>
    <p class="normal">Create a console app in <code class="inlineCode">Chapter03</code> named <code class="inlineCode">Exercise_FizzBuzz</code> that outputs a simulated FizzBuzz game that counts up to 100. The output should look something like <em class="italic">Figure 3.5</em>:</p>
    <figure class="mediaobject"><img src="../Images/B22322_03_05.png" alt="A screenshot of a computer  Description automatically generated" width="878" height="214"/></figure>
    <p class="packt_figref">Figure 3.5: A simulated FizzBuzz game output</p>
    <h2 id="_idParaDest-243" class="heading-2">Practice exception handling</h2>
    <p class="normal">Create a console app in <code class="inlineCode">Chapter03</code> named <code class="inlineCode">Exercise_Exceptions</code> that asks the user for two numbers in the range 0–255 and then divides the first number by the second:</p>
    <pre class="programlisting con"><code class="hljs-con">Enter a number between 0 and 255: 100
Enter another number between 0 and 255: 8
100 divided by 8 is 12
</code></pre>
    <p class="normal">Write exception handlers to catch any thrown errors, as shown in the following output:</p>
    <pre class="programlisting con"><code class="hljs-con">Enter a number between 0 and 255: apples
Enter another number between 0 and 255: bananas
FormatException: Input string was not in a correct format.
</code></pre>
    <h2 id="_idParaDest-244" class="heading-2">Exercise 3.3 – Test your knowledge</h2>
    <p class="normal">Answer the following questions:</p>
    <ol>
      <li class="numberedList" value="1">What happens when you divide an <code class="inlineCode">int</code> variable by <code class="inlineCode">0</code>?</li>
      <li class="numberedList">What happens when you divide a <code class="inlineCode">double</code> variable by <code class="inlineCode">0</code>?</li>
      <li class="numberedList">What happens when you overflow an <code class="inlineCode">int</code> variable, that is, set it to a value beyond its range?</li>
      <li class="numberedList">What is the difference between <code class="inlineCode">x = y++;</code> and <code class="inlineCode">x = ++y;</code>?</li>
      <li class="numberedList">What is the difference between <code class="inlineCode">break</code>, <code class="inlineCode">continue</code>, and <code class="inlineCode">return</code> when used inside a loop statement?</li>
      <li class="numberedList">What are the three parts of a <code class="inlineCode">for</code> statement and which of them are required?</li>
      <li class="numberedList">What is the difference between the <code class="inlineCode">=</code> and <code class="inlineCode">==</code> operators?</li>
      <li class="numberedList">Does the following statement compile?
        <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword">for</span> ( ; ; ) ;
</code></pre>
      </li>
      <li class="numberedList">What does the underscore (<code class="inlineCode">_</code>) represent in a <code class="inlineCode">switch</code> expression?</li>
      <li class="numberedList">What interface must an object “implement” to be enumerated over by using the <code class="inlineCode">foreach</code> statement?</li>
    </ol>
    <h3 id="_idParaDest-245" class="heading-3">Test your knowledge of operators</h3>
    <p class="normal">What are the values of <code class="inlineCode">x</code> and <code class="inlineCode">y</code> after the following statements execute? Create a console app in <code class="inlineCode">Chapter03</code> named <code class="inlineCode">Ch03Ex03Operators</code> to test your assumptions:</p>
    <ol>
      <li class="numberedList" value="1">Increment and addition operators:
        <pre class="programlisting code-one"><code class="hljs-code">x = <span class="hljs-number">3</span>;
y = <span class="hljs-number">2</span> + ++x;
</code></pre>
      </li>
      <li class="numberedList">Binary shift operators:
        <pre class="programlisting code-one"><code class="hljs-code">x = <span class="hljs-number">3</span> &lt;&lt; <span class="hljs-number">2</span>;
y = <span class="hljs-number">10</span> &gt;&gt; <span class="hljs-number">1</span>;
</code></pre>
      </li>
      <li class="numberedList">Bitwise operators:
        <pre class="programlisting code-one"><code class="hljs-code">x = <span class="hljs-number">10</span> &amp; <span class="hljs-number">8</span>;
y = <span class="hljs-number">10</span> | <span class="hljs-number">7</span>;
</code></pre>
      </li>
    </ol>
    <h2 id="_idParaDest-246" class="heading-2">Exercise 3.4 – Explore topics</h2>
    <p class="normal">Use the links on the following page to learn about the topics covered in this chapter in more detail:</p>
    <p class="normal"><a href="https://github.com/markjprice/cs13net9/blob/main/docs/book-links.md#chapter-3---controlling-flow-converting-types-and-handling-exceptions"><span class="url">https://github.com/markjprice/cs13net9/blob/main/docs/book-links.md#chapter-3---controlling-flow-converting-types-and-handling-exceptions</span></a></p>
    <h1 id="_idParaDest-247" class="heading-1">Summary</h1>
    <p class="normal">In this chapter, you learned how to:</p>
    <ul>
      <li class="bulletList">Use operators to perform simple tasks.</li>
      <li class="bulletList">Use branch and loop statements to implement logic.</li>
      <li class="bulletList">Work with single- and multi-dimensional arrays.</li>
      <li class="bulletList">Convert between types.</li>
      <li class="bulletList">Catch exceptions and handle integer overflow.</li>
    </ul>
    <p class="normal">You are now ready to learn how to reuse blocks of code by defining functions, how to pass values into them and get values back, and how to track down bugs in your code and squash them using debugging and testing tools!</p>
  </div>
</div></div></body></html>