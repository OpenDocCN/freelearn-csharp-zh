<html><head></head><body>
        

                            
                    <h1 class="header-title">Deploying</h1>
                
            
            
                
<p class="mce-root">In this chapter, we will look at the following recipes:</p>
<ul>
<li>Creating a free Azure Cloud subscription</li>
<li>Creating an ASP.NET Core web application to use the library from NuGet</li>
<li>Deploying the application to Azure Cloud</li>
</ul>


            

            
        
    

        

                            
                    <h1 class="header-title">Technical requirements</h1>
                
            
            
                
<p>Readers should have a basic knowledge of C#. They should also have a basic knowledge of using Visual Studio, installing packages using NuGet, and referencing libraries within projects from other projects.</p>
<p class="mce-root">The code files for this chapter can be found on GitHub:<br/>
<a href="https://github.com/PacktPublishing/DotNET-Standard-2-Cookbook/tree/master/Chapter12/Chapter12.Azure.WebAppCore">https://github.com/PacktPublishing/DotNET-Standard-2-Cookbook/tree/master/Chapter12/Chapter12.Azure.WebAppCore</a></p>
<p class="mce-root">Check out the following video to see the code in action:<br/>
<a href="https://goo.gl/syvoGK">https://goo.gl/syvoGK</a></p>


            

            
        
    

        

                            
                    <h1 class="header-title">Introduction</h1>
                
            
            
                
<p>In this chapter, we will be working with a library we worked on in the previous chapter. In that chapter, we created a library and submitted it at NuGet. We will be using the same library with an ASP.NET core application and deploying it to Azure and testing it.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Creating a free Azure Cloud subscription</h1>
                
            
            
                
<p>In this recipe, we will create an Azure free account for you. This will help you to deploy the application at Azure. We will be using Visual Studio tools for Azure to deploy our project. At the time of writing this book, Microsoft allows you to create one free account worth USD 200; it is also freely available for one year.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>Make sure you have a valid credit card before you start this process. The credit card is only required for validation purposes.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<ol>
<li>Open your preferred browser.</li>
<li>Type <kbd>azure.microsoft.com</kbd>, and press <em>Enter:</em></li>
</ol>
<div><img class="alignnone size-full wp-image-900 image-border" src="img/d783f6f6-3bff-419c-a159-cc6f3fea431f.png" style="width:150.00em;height:87.42em;"/></div>
<ol start="3">
<li>Now, click on the Free Account green button in the top right-hand corner, or click the Start free button at the left-hand side.</li>
<li>After that, you will get a screen of information.</li>
<li>Again, click on the Start free button.</li>
<li>You will then be requested to sign in using a Microsoft account or any other account.</li>
<li>After sign in, you will be asked to give payment information. Follow the instructions and you are good to go with a new Azure account.</li>
<li>After all that has been completed, you will be presented with the Azure Portal.</li>
<li>Or else, type <kbd>portal.azure.com</kbd> in the address bar, and press <em>Enter</em>.</li>
<li>You should be presented with the Azure Portal and should see a screen similar to this:</li>
</ol>
<div><img class="alignnone size-full wp-image-902 image-border" src="img/64a53679-6302-4709-80b7-dffb905f5017.png" style="width:150.00em;height:61.92em;"/></div>
<p>Azure Portal</p>


            

            
        
    

        

                            
                    <h1 class="header-title">How it works...</h1>
                
            
            
                
<p>The steps are straightforward and all you need to do is follow the instructions from the Azure Portal on creating a new subscription.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Creating an ASP.NET core web application to use the library from NuGet</h1>
                
            
            
                
<p>In this recipe, we will create an ASP.NET core web application, and then we will install the .NET Standard 2.0 library we uploaded at NuGet in the previous chapter.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>Make sure you have the latest version of Visual Studio 2017 installed and updated, and also make sure you have completed the previous chapter.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<ol>
<li>Open Visual Studio 2017.</li>
<li>Click File | New | Project and select Web in the right-hand pane under Visual C#. </li>
<li>Select ASP.NET Core Web Application in the right-hand pane:</li>
</ol>
<div><img class="alignnone size-full wp-image-903 image-border" src="img/30d03149-771d-4e4d-8f7a-aee357ececfe.png" style="width:57.17em;height:39.67em;"/></div>
<ol start="4">
<li>Now, in the Name: textbox, type <kbd>Chapter12.Azure.WebAppCore</kbd>, and, under the Location: textbox, select a proper location and leave the other fields as they are:</li>
</ol>
<div><img class="alignnone size-full wp-image-904 image-border" src="img/8323e168-9ff2-448e-ab5b-322e4ae2217f.png" style="width:42.83em;height:8.92em;"/></div>
<ol start="5">
<li>Click OK.</li>
</ol>
<ol start="6">
<li>In the New ASP.NET Core Web Application dialog box, select Empty and leave the other fields as they are:</li>
</ol>
<div><img class="alignnone size-full wp-image-905 image-border" src="img/2b88c6c4-e3bc-44af-8013-682216552b0c.png" style="width:44.00em;height:28.58em;"/></div>
<ol start="7">
<li>Click OK.</li>
<li>The Solution Explorer (<em>Ctrl</em> + <em>Alt</em> + <em>L</em>) should look like this:</li>
</ol>
<div><img class="alignnone size-full wp-image-906 image-border" src="img/2684ec47-922a-420c-ab0a-e2b0abdb42b1.png" style="width:30.42em;height:17.33em;"/></div>
<ol start="9">
<li>Now, right-click on the Dependencies label.</li>
<li>Select <kbd>Manage NuGet Packages</kbd><strong>.</strong></li>
<li>Click Browse and, in the search box, type the Package ID you have selected while uploading.</li>
<li>In this case, <kbd>Packt_DotNetStandard_CookBook_Chap1</kbd>, and press <em>Enter</em>:</li>
</ol>
<div><img class="alignnone size-full wp-image-907 image-border" src="img/5172a21c-e7b3-429c-a94e-54f327d272c4.png" style="width:54.50em;height:17.08em;"/></div>
<ol start="13">
<li>Now, click on the package.</li>
<li>Click the Install button in the right-hand pane:</li>
</ol>
<div><img class="alignnone size-full wp-image-908 image-border" src="img/8a06cd2b-0f15-4990-b2b7-1b833098f503.png" style="width:150.00em;height:50.33em;"/></div>
<ol start="15">
<li>Click OK in the confirmation dialog box.</li>
</ol>
<div><img class="alignnone size-full wp-image-909 image-border" src="img/08cccc37-a72b-4352-87e6-d8bc96099569.png" style="width:29.08em;height:16.50em;"/></div>
<ol start="16">
<li>After a successful installation, the output window should look like this:</li>
</ol>
<div><img class="alignnone size-full wp-image-910 image-border" src="img/8062d9a7-e09e-4739-ae6f-847f4ec8b910.png" style="width:158.92em;height:35.00em;"/></div>
<ol start="17">
<li>Now, in the Solution Explorer, expand the Dependencies | NuGet  tab and you should see our library there:</li>
</ol>
<div><img class="alignnone size-full wp-image-911 image-border" src="img/ad592a4c-8417-485b-83b3-802c583b38a8.png" style="width:24.50em;height:20.50em;"/></div>
<ol start="18">
<li>Now, double-click on the <kbd>Startup.cs</kbd> button to reach the code window.</li>
<li>Scroll up till you see the <kbd>using</kbd> directives.</li>
<li>Add the following directive at the end of the <kbd>using</kbd> directives:</li>
</ol>
<pre>      using Chapter11.Packaging.CalcLib;</pre>
<ol start="21">
<li>Now, scroll down till you reach the <kbd>app.Run()</kbd> method inside the <kbd>Configure()</kbd> method.</li>
<li>Replace the code with this:</li>
</ol>
<pre>      var calculator = new Calculator();<br/>      var answer = calculator.Add(10, 50);<br/><br/>      await context.Response.WriteAsync($"Answer for 10+50 <br/>          is {answer}");</pre>
<ol start="23">
<li>Press <em>F5</em> to debug.</li>
<li>You should get an output like this:</li>
</ol>
<div><img class="alignnone size-full wp-image-912 image-border" src="img/5f015a64-c3f9-461e-b705-57a4ff3596cf.png" style="width:39.58em;height:7.58em;"/></div>


            

            
        
    

        

                            
                    <h1 class="header-title">How it works...</h1>
                
            
            
                
<p>In steps 1 to 9, we created an ASP.NET core project. We selected an empty project for this recipe. After that, in steps 10 to 17, we installed the library created in the previous chapter. We used the NuGet Package Manager to install it and we also confirmed that the library was successfully installed.</p>
<p>In step 20, we referenced the library using a <kbd>using</kbd> directive. Finally, in step 22, we created an instance of the <kbd>Calculator</kbd> class and stored it in a variable. Finally, we sent the output to the browser using the <kbd>WriteAsync()</kbd> method. In step 24, we tested our application in the browser.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Deploying the application to Azure Cloud</h1>
                
            
            
                
<p>In this recipe, we will look at deploying our application to Azure. We will be using Visual Studio 2017 to deploy the application to an Azure App Service.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>Make sure you have an Azure account. If not, you can create a free account at <kbd>azure.microsoft.com</kbd>. Also, make sure you have completed the previous recipe. We will need Visual Studio 2017, with its latest updates. Let's get going. </p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<ol>
<li>Open Visual Studio 2017.</li>
<li>Now, open the solution from the previous recipe. Click File | Open | Open Project/Solution, or press <em>Ctrl</em> + <em>Shift</em> + <em>O</em>, and select the <kbd>Chapter12.Azure.WebAppCore</kbd> solution. </li>
</ol>
<ol start="3">
<li>The Solution Explorer (<em>Ctrl</em> + <em>Alt</em> + <em>L</em>) should look like this:</li>
</ol>
<div><img class="alignnone size-full wp-image-913 image-border" src="img/74e11b86-37e8-45a2-b93f-8e7c80d45b16.png" style="width:29.67em;height:17.00em;"/></div>
<ol start="4">
<li>Now, right-click on <kbd>Chapter12.Azure.WebAppCore</kbd> and select Publish.</li>
<li>In the Pick a publish target window, select App Service in the left-hand pane and Create New in the right-hand pane:</li>
</ol>
<div><img class="alignnone size-full wp-image-914 image-border" src="img/39770eaf-b519-45be-84bd-4b3099427816.png" style="width:49.00em;height:16.58em;"/></div>
<ol start="6">
<li>Click Publish.</li>
</ol>
<ol start="7">
<li>Now, in the Create App Service screen, supply a proper App Name, and select a Resource Group and a Hosting Plan:</li>
</ol>
<div><img class="alignnone size-full wp-image-915 image-border" src="img/6759df1d-8e62-490d-9de3-2c2e10786abf.png" style="width:55.58em;height:34.08em;"/></div>
<ol start="8">
<li>Click Create.</li>
<li>This will deploy your application to Azure.</li>
<li>If everything goes well, you should see this in the browser:</li>
</ol>
<div><img class="alignnone size-full wp-image-916 image-border" src="img/793f7aa3-f6e4-4456-b151-468099bbd94e.png" style="width:51.58em;height:7.83em;"/></div>


            

            
        
    

        

                            
                    <h1 class="header-title">How it works...</h1>
                
            
            
                
<p>In steps 1, 2 and 3, we opened the existing solution that we created in the previous recipe. We performed a quick build to check for any syntax errors and to confirm that everything is fine. In step 5, we used Visual Studio tools to publish the application to Azure. In this case, we selected a new App Service. In the next screen, at step 7, we had to use the Azure subscription bound with your login. This should be the account you created in the previous recipe. You can select an existing Resource Group here, or you can create a new one by clicking the New link. You will see a dialog box similar to this:</p>
<div><img class="alignnone size-full wp-image-917 image-border" src="img/be0bfcff-20f9-4d37-9402-5db9198e56c2.png" style="width:26.08em;height:8.00em;"/></div>
<p>You will have to give a name for your Resource Group and click OK. A Resource Group is a way of categorizing your resources in Azure. And again, you can select a new Hosting Plan by clicking on the New link. Again, you should see a screen such as this to select your new plan:</p>
<div><img class="alignnone size-full wp-image-918 image-border" src="img/ccda37dc-0f67-47ed-a5b7-3594e278b250.png" style="width:31.58em;height:23.75em;"/></div>
<p>The Location and Size drop-down lists give you different options to select. Location will help you to select a region close to your customers. This will help you to access your website quickly. Also, Size will tell you the processor and RAM you are going to use for this App Service. Finally, you hit the Create button and Visual Studio will take care of the process. This will include uploading your files to Azure, opening the browser, and showing the final result. In the Azure Portal, your App Service should appear in the list like this:</p>
<div><img class="alignnone size-full wp-image-919 image-border" src="img/70949f05-25f9-424f-b0f7-93c403b8219c.png" style="width:60.92em;height:33.08em;"/></div>
<p>As you can see, Visual Studio has done a great job of doing all the hard work for you.</p>
<p> </p>
<p> </p>


            

            
        
    </body></html>