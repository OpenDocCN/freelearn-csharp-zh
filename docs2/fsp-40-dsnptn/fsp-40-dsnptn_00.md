# 前言

遵循设计模式是编写更好程序的一种众所周知的方法，它捕获并重用了许多应用程序中常见的许多高级抽象。本书将鼓励你通过完全拥抱函数优先的 F# 范式来发展一种地道的 F# 编码技能集。它还将帮助你利用这个强大的工具来编写简洁、无错误和跨平台的代码。

《F# 4.0 设计模式》将从帮助你培养一种函数式思维方式开始。我们将向你展示函数优先范式的好处以及如何使用它来获得最佳结果。本书将帮助你掌握主要函数式设计模式的知识，这些模式与传统“四人帮”模式之间的关系并不直接。

我们将带你了解 F# 中的模式匹配、不可变数据类型和序列。我们还将揭示高级函数式模式，查看多态函数，查看典型数据处理技术，并学习通过增强和泛化调整代码。最后，我们还将探讨高级技术，以帮助你写出无瑕疵的代码。此外，我们将探讨范式转向函数优先如何影响面向对象宇宙的设计原则和模式，并以函数代码故障排除的具体细节结束本书。

通过阅读本书，你将实现以下目标：

+   获得使用主要函数式设计模式的知识

+   在函数式方法下重新调整一些命令式和面向对象的原则

+   增强你在构建和组合一阶和更高阶函数方面的信心

+   学习如何有效地使用核心语言的模式匹配

+   学习如何使用嵌入式代数数据类型代替自定义类型，以增加效果和代码简洁性

+   通过观察特定库函数背后的模式，轻松导航和使用 F# 核心库

+   识别和衡量序列和具体化数据结构之间资源消耗的差异

+   掌握编写通用多态代码

# 本书涵盖的内容

第一章 ，《开始函数式思考》将帮助你培养一种通常与函数范式相关的编程方式。它将为你提供知识、关键概念以及与 F# 编程语言函数优先特性相关的技能目标列表。

第二章 ，《解构 F# 的起源和设计》将帮助你了解 F# 当代设计的起源，F# 的演变过程，以及它在 .NET 生态系统中的地位。

第三章，*基本函数*，帮助你获得 F#惯用用法的基础。它为你提供了对函数范式基石——函数概念——的 360 度回顾。你将学习如何将任何解决方案表示为一系列通过少量组合子连接起来的函数。本章为你准备吸收主要主题——F#惯用用法的模式。

第四章，*基本模式匹配*，使你对语言机制有一个良好的掌握，该机制被置于语言的核心以处理任何数据转换-F#模式匹配。本章涵盖了基本模式匹配功能，将数据分解和主动模式留到后续章节。

第五章，*代数数据类型*，展示了如何使用 F#标准代数数据类型（元组、区分联合和记录）作为开发自定义类型的更好替代方案。它涵盖了这些类型的组合、等价性、比较、分解和增强。

第六章，*序列——数据处理模式的核心*，使你熟悉函数编程中最基本的结构之一，即序列。序列是几个基本函数模式的基础，如惰性评估、序列生成器和不确定长度的序列。本章还奠定了数据转换模式分类法的蓝图。

第七章，*高级技术：函数回顾*，基于已经覆盖的函数、模式匹配和序列的语言使用模式。它向读者介绍了 F#的递归、折叠、记忆化和传递继续等模式。

第八章，*数据处理——数据转换模式*，继续深入挖掘我们在与序列相关联时开始揭示的数据转换模式。你得到了 F# 4.0 核心库捕获的多态数据转换模式的完整分类法。现在你已完全准备好，在高度优化的高质量库函数组合的帮助下，设计蓝图，大多数情况下避免自定义实现。

第九章，*更多数据处理*，通过 F#查询表达式和类型提供者帮助的数据解析，增加了由 F#核心库定义的数据转换模式。

第十章，*类型增强和泛型计算*，涵盖了基于相反类型转换的两种 F#使用模式——代码泛化和代码特殊化。你将看到通过应用这些模式可能获得的益处。

第十一章，*F# 专家技巧*，探讨了真正高级的 F#模式。我们将了解 F#类型提供者、并发和响应式编程的使用，并以元编程结束。

第十二章，*F# 和面向对象原则/设计模式*，将本书对设计模式的理解与面向对象范式的理解联系起来。我们将看到，在以函数优先的范式中，著名的面向对象设计原则和特定模式可能会发生变化、减少，或者实际上在功能优先的范式中不再存在。

第十三章，*功能代码故障排除*，是主要主题的重要补充，展示了如何以探索式风格进行开发，F#代码开发中的问题性质如何从运行时显著转移到编译时，以及如何解决一些典型问题。

# 本书所需条件

对于本书的读者来说，最友好的开发平台是 Visual Studio 2015，因为书中的一些材料，正如书名所示，是针对 F# v4.0 或更高版本的。如果你已经拥有 Visual Studio 2015 专业版或更高版本，你无需额外努力即可开始。

否则，你可以从[`www.visualstudio.com/vs/community/`](https://www.visualstudio.com/vs/community/)安装免费的 Visual Studio 2015 社区版。

对于 Windows 平台上的其他选项，请访问 fsharp.org：[`fsharp.org/use/windows/`](http://fsharp.org/use/windows/)。

本书的一些代码示例在 Linux 和 Mac 上也能有限地运行。有关相应的安装说明，请访问[`fsharp.org/use/linux/`](http://fsharp.org/use/linux/)和[`fsharp.org/use/mac/`](http://fsharp.org/use/mac/)。

对硬件的要求由上述开发环境的版本决定。

# 本书面向的对象

这本书是为网页程序员和.NET 开发者（C#开发者和 F#开发者）所写。因此，如果你有基本的 F#编程和开发性能关键型应用的经验，那么这本书适合你。对于 F#的绝对初学者来说，理解曲线可能会相当陡峭，但通过学习 F#（[`fsharp.org/learn.html`](http://fsharp.org/learn.html)）的一个或多个入门课程，可能会使它更容易接受。

# 惯例

在这本书中，您将找到许多文本样式，用于区分不同类型的信息。以下是一些这些样式的示例及其含义的解释。

代码元素，如语言关键字、运算符、表达式和值名称，如下所示：“为了定义递归函数，`let` 绑定可以扩展为 `rec` 修饰符”，“文字`"$42"`绑定到值`total`”。

代码块设置如下：

```cs
type OrderType = Sale | Refund
type Transaction = Transaction of OrderType * decimal
```

当我们希望您注意代码块中的特定部分时，相关的行或项目将以粗体显示：

```cs

// Imperative monolithic solution a-la C/C++ 

#load "HugeNumber.fs" 

let number = hugeNumber.ToCharArray()

```

网址显示为[`jet.com`](https://jet.com)。

### 注意

警告或重要提示以如下框中显示。

### 小贴士

小贴士和技巧如下所示。

**新术语**和**重要词汇**以粗体显示。屏幕上显示的单词，例如在菜单或对话框中，在文本中显示如下：“点击**下一个**按钮将您带到下一屏幕。”

# 读者反馈

我们欢迎读者的反馈。告诉我们您对这本书的看法——您喜欢或不喜欢什么。读者反馈对我们很重要，因为它帮助我们开发出您真正能从中获得最大价值的标题。要发送一般反馈，请简单地发送电子邮件至 feedback@packtpub.com，并在邮件主题中提及书籍的标题。如果您在某个主题领域有专业知识，并且您对撰写或为书籍做出贡献感兴趣，请参阅我们的作者指南[www.packtpub.com/authors](http://www.packtpub.com/authors)。

# 客户支持

现在，您已成为 Packt 书籍的骄傲拥有者，我们有一些事情可以帮助您充分利用您的购买。

## 下载示例代码

您可以从您的账户下载这本书的示例代码文件。[`www.packtpub.com`](http://www.packtpub.com) 。如果您在其他地方购买了这本书，您可以访问[`www.packtpub.com/support`](http://www.packtpub.com/support)并注册，以便将文件直接通过电子邮件发送给您。

您可以通过以下步骤下载代码文件：

1.  使用您的电子邮件地址和密码登录或注册我们的网站。

1.  将鼠标指针悬停在顶部的**支持**选项卡上。

1.  点击**代码下载与勘误**。

1.  在**搜索**框中输入书籍的名称。

1.  选择您想要下载代码文件的书籍。

1.  从下拉菜单中选择您购买这本书的地方。

1.  点击**代码下载**。

文件下载完成后，请确保您使用最新版本的软件解压缩或提取文件夹。

+   WinRAR / 7-Zip for Windows

+   Zipeg / iZip / UnRarX for Mac

+   7-Zip / PeaZip for Linux

该书的代码包也托管在 GitHub 上，网址为[`github.com/PacktPublishing/Fsharp-4.0-Design-Patterns`](https://github.com/PacktPublishing/Fsharp-4.0-Design-Patterns)。我们还有其他来自我们丰富图书和视频目录的代码包，可在[`github.com/PacktPublishing/`](https://github.com/PacktPublishing/)找到。请查看它们！

## 勘误

尽管我们已经尽一切努力确保我们内容的准确性，但错误仍然可能发生。如果您在我们的书中发现错误——可能是文本或代码中的错误——如果您能向我们报告，我们将不胜感激。这样做可以节省其他读者的挫败感，并帮助我们改进本书的后续版本。如果您发现任何勘误，请通过访问[`www.packtpub.com/submit-errata`](http://www.packtpub.com/submit-errata)，选择您的书籍，点击**勘误提交表单**链接，并输入您的勘误详情来报告它们。一旦您的勘误得到验证，您的提交将被接受，勘误将被上传到我们的网站或添加到该标题下**勘误**部分的现有勘误列表中。

要查看之前提交的勘误表，请访问[`www.packtpub.com/books/content/support`](https://www.packtpub.com/books/content/support)，并在搜索字段中输入书籍名称。所需信息将在**勘误**部分显示。

## 侵权

在互联网上，版权材料侵权是一个跨所有媒体的持续问题。在 Packt，我们非常重视我们版权和许可证的保护。如果您在互联网上发现我们作品的任何非法副本，请立即提供位置地址或网站名称，以便我们可以寻求补救措施。

请通过版权@packtpub.com 与我们联系，并提供疑似侵权材料的链接。

我们感谢您在保护我们作者和我们为您提供有价值内容的能力方面的帮助。

## 询问

如果您在这本书的任何方面遇到问题，您可以通过 questions@packtpub.com 联系我们，我们将尽力解决问题。
