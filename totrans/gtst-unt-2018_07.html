<html><head></head><body>
        

                            
                    <h1 class="header-title">Implementing Our Player Character</h1>
                
            
            
                
<p class="mce-root">In <a href="04be4d7b-8c85-4d9e-baf2-43965183f99f.xhtml" target="_blank">Chapter 6</a>, <em>Creating and Importing 3D Objects for Our Game</em>, we worked on our game environment and added several assets to our game project. We added and planted our cherry trees and prepared six areas for our cucumber patches. We also learned how to import assets from the Unity Asset Store, as well as from third-party sources. </p>
<p class="mce-root">In this chapter, we will incorporate our game's player character, the Cucumber Man. We will import the character, review the controls, examine the animations, and make the necessary configuration changes to fully use our character in the game. By the end of the chapter, you will be able to start testing the game in game-mode.</p>
<p class="mce-root">We will look at the following topics in this chapter:</p>
<ul>
<li class="mce-root">Working with Unity's standard asset package</li>
<li class="mce-root">Importing the game character</li>
<li class="mce-root">Configuring the player controller</li>
<li class="mce-root">Fine-tuning our character</li>
<li class="mce-root">Animating our player character</li>
<li class="mce-root">Terraforming the terrain for our Cucumber Man</li>
</ul>


            

            
        
    

        

                            
                    <h1 class="header-title">Working with Unity's standard asset package</h1>
                
            
            
                
<p class="mce-root">The game character, the player character, the user-controlled player—these are all terms that are used to refer to our game's main character, the Cucumber Man, which the human player will control. In Unity, we refer to this as the player character. In order to have a player character, we need a controller. In our case, we will use a third-person controller. A third-person controller is a framework used to control a character from the perspective of a third-person camera.</p>
<p class="mce-root">The Unity standard asset package includes a <kbd>ThirdPersonController</kbd> asset package. The package, as you can see in the following screenshot, contains <kbd>Animation</kbd>, <kbd>Materials</kbd>, <kbd>Models</kbd>, <kbd>Scripts</kbd>, <kbd>Textures</kbd>, and <kbd>Prefabs</kbd>:</p>
<div><img height="163" width="172" src="img/df791783-4107-4924-8b90-e6d3568081bb.png"/></div>
<p class="mce-root">This section demonstrates how to use a character created by Unity. It will not be incorporated into the <em>Cucumber Beetle</em> game. By going through the following steps, you will become familiar with the process of using the <kbd>ThirdPersonCharacter</kbd> provided by Unity:</p>
<ol start="1">
<li>Launch Unity.</li>
<li>From the top menu, select Assets | Import Package | Characters. </li>
<li>You will be presented with the Import Unity Package dialog window. Click the Import button.</li>
</ol>
<p> </p>
<ol start="4">
<li>In the Project panel, you will see <kbd>Standard Assets</kbd>. Navigate to <kbd>Standard Assets</kbd> | Characters | <kbd>ThirdPersonCharacter</kbd> | <kbd>Prefabs</kbd> and drag the <kbd>ThirdPersonController</kbd> prefab to the Hierarchy panel. </li>
<li>Double-click on the <kbd>ThirdPersonController</kbd> in the Hierarchy panel to autofocus on the controller in the Scene view. As shown in the following screenshot, the character is encased in a capsule controller: </li>
</ol>
<div><img height="308" width="298" src="img/505dbb78-134d-4d8e-9f68-e28a76e8c775.png"/></div>
<ol start="6">
<li>In the hierarchy pane, drag the Main Camera so that it is subordinate to the <kbd>ThirdPersonController</kbd>. This is required so that the camera follows the player character during gameplay.</li>
</ol>
<p> </p>
<ol start="7">
<li>In the Scene view, use the transform tools to position the camera above and behind the character. With the camera selected, your Camera Preview window, in the Scene view, should look similar to the following screenshot:</li>
</ol>
<div><img height="212" width="284" src="img/55b3c344-7a16-49d9-b80f-94f236c9c962.png"/></div>
<p class="mce-root">Now you can put the game into game-mode and navigate the game world using your keyboard and mouse. As you will see, the default character can move around the world, and the camera will follow.</p>
<p class="mce-root">Using the provided <kbd>ThirdPersonController</kbd> is great for testing purposes, but you would not want to deploy a game using these standard assets. Although Unity Technologies permits commercial use of their standard assets, using them erodes the uniqueness of your game, so it is recommended that they only be used for testing.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Importing the game character</h1>
                
            
            
                
<p class="mce-root">We will use a custom third-person character controller for our <em>Cucumber Beetle</em> game. First, we should make sure there are no conflicting assets in your game project. Let's start by launching Unity and opening your game project based on the work you did in <a href="04be4d7b-8c85-4d9e-baf2-43965183f99f.xhtml" target="_blank">Chapter 6</a>, <em>Creating and Importing 3D Objects for our Game</em>. Alternatively, you can load the <kbd>Starting-Chapter-07</kbd> Unity project available from the publisher's companion site. Once your project is loaded in Unity, delete any of the following listed items from the Hierarchy panel:</p>
<ul>
<li>Camera (you will retain the main camera you first explored in <a href="101c3b96-a362-4913-925c-f22503f0f8a1.xhtml" target="_blank">Chapter 5</a>, <em>Lights, Cameras, and Shadows</em>)</li>
<li><kbd>ThirdPersonController</kbd></li>
</ul>
<p class="mce-root">Once the unnecessary assets are deleted, your Hierarchy panel should contain only the assets listed in the following Hierarchy panel screenshot:</p>
<div><img height="140" width="193" src="img/aab4afc4-f11e-4f35-8d28-64f1904a8f10.png"/></div>
<p class="mce-root">You are now ready to import the asset package for our game's player character, the Cucumber Man. Go through the following steps to import the package:</p>
<ol start="1">
<li>Download the <kbd>CucumberMan_Controller.unitypackage</kbd> file from the publisher's companion website</li>
<li>In Unity, with your game project open, select Assets | Import Package | Custom Package from the top menu</li>
<li>Navigate to the location of the asset package you downloaded in step 1 and click the Open button</li>
<li>When presented with the Import Asset Package dialog window, click the Import button</li>
</ol>
<p class="mce-root">As you will notice, the Cucumber Man asset package contains several assets related to the Cucumber Man, including a Controller, Scripts, Prefabs, and other assets. In the next section, we will add the Cucumber Man to our game.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Configuring a player controller</h1>
                
            
            
                
<p class="mce-root">So, far we have taken a lot of time to shape our world and populate it with cherry trees and spawn points, and prepare it for cucumber patches. We have been creating the game world for our player character, the Cucumber Man, to exist in. It is now time to add our Cucumber Man to our game.</p>
<p class="mce-root">Here are the steps to add the Cucumber Man to our game and to configure the controller:</p>
<ol>
<li>In the Project panel, select Prefabs. </li>
<li>Drag the <kbd>CucumberMan</kbd> prefab to the Hierarchy panel. Use the following screenshot as a reference to ensure that you are dragging the highlighted prefab illustrated in the following screenshot. Note that the subordinate <kbd>Cucumbor_Man</kbd> has been intentionally misspelled to help ensure the <kbd>CucumberMan</kbd> prefab is used:</li>
</ol>
<div><img height="139" width="183" src="img/d4f1a2d7-7709-406e-8413-8132c76ea5fc.png"/></div>
<ol start="3">
<li>In the Hierarchy panel, select Main Camera.</li>
<li>With the Main Camera selected, click the Add Component button in the Inspector panel.</li>
<li>Select Scripts | Camera Follower to add the Camera Follower script to the Main Camera.</li>
<li>In the Camera Follower component of the Main Camera, in the Inspector panel, change the Movement Smoothness to <kbd>5</kbd>.</li>
<li>In the Camera Follower component of the Main Camera, change the Rotation Smoothness to <kbd>5</kbd>.</li>
<li>In the Hierarchy panel, click the gray triangle to the left of <kbd>CucumberMan</kbd>. This will expose the subordinate components.</li>
<li>Reselect the Main Camera in the Hierarchy panel. </li>
<li>Click the GameObject under <kbd>CucumberMan</kbd> in the Hierarchy panel and drag it to the Follow Target field in the Camera Follower component of the Main Camera.</li>
<li>Ensure that the Can Follow checkbox is checked.</li>
</ol>
<p class="mce-root">Your Camera Follower component of the main camera should look identical to the following image. If it is not identical, please revisit steps 6 through 11:</p>
<div><img height="100" width="284" src="img/b13bd611-bd03-4a18-a7f2-7b585df67ed1.png"/></div>
<p class="mce-root">Next, we will edit the Player Motor (Script) component of the <kbd>CucumberMan</kbd>. Follow these important steps to properly configure the Player Motor (Script) component:</p>
<ol>
<li>In the Hierarchy panel, select the <kbd>CucumberMan</kbd></li>
<li>Expand, if necessary, the Player Motor (Script) component of the <kbd>CucumberMan</kbd> in the Inspector panel</li>
<li>Drag the Main Camera from the Hierarchy panel to the Cam field in the Player Motor (Script) component of <kbd>CucumberMan</kbd> in the Inspector panel</li>
</ol>
<p class="mce-root">Next, let's position the Cucumber Man to a logical start location for our game. Where you place the Cucumber Man is up to you. It is recommended that it be placed on one of the respawn points. Once you know where you want the character to start each game, follow these steps:</p>
<ol>
<li>In the Hierarchy panel, select <kbd>CucumberMan</kbd>.</li>
<li>Using the transform tools, move the character to one of the spawn points.</li>
<li>Zoom in and ensure the character's feet are on or slightly above the ground. We still have one more step to make the Cucumber Man our game's playable character.</li>
<li>With the <kbd>CucumberMan</kbd> still selected, select the Tag drop-down menu in the Inspector panel and select Player. This will make it easier for us to reference collisions. You will learn more about this in <a href="fdacd7a8-63fe-454d-9d50-f9f40070e484.xhtml" target="_blank">Chapter 10</a>, <em>Scripting Our Points System.</em></li>
</ol>
<p class="mce-root">You can now put the game into game-mode and test the player character. You can use the keyboard keys listed in the following table to control the Cucumber Man:</p>
<table>
<tbody>
<tr>
<td><strong>Keyboard Key</strong></td>
<td><strong>Action</strong></td>
</tr>
<tr>
<td><em>W</em></td>
<td>Walk Up</td>
</tr>
<tr>
<td><em>A</em></td>
<td>Walk Left</td>
</tr>
<tr>
<td><em>S</em></td>
<td>Walk Down</td>
</tr>
<tr>
<td><em>D</em></td>
<td>Walk Right</td>
</tr>
<tr>
<td><em>E</em></td>
<td>Throw</td>
</tr>
<tr>
<td>Left-Hand <em>Shift</em> Key</td>
<td>Run</td>
</tr>
<tr>
<td>Spacebar</td>
<td>Jump</td>
</tr>
</tbody>
</table>
<p> </p>
<p class="mce-root">In the next section, we will fine-tune the Cucumber Man.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Fine-tuning our character</h1>
                
            
            
                
<p class="mce-root">Now that the Cucumber Man is in our game, we can start experimenting with the character to ensure it looks and behaves the way we want. In this section, we will look at the following refinements to our Cucumber Man:</p>
<ul>
<li>Motor controls</li>
<li>Scale</li>
<li>Capsule Collider</li>
<li>Input controls</li>
</ul>


            

            
        
    

        

                            
                    <h1 class="header-title">Fine-tuning the motor controls</h1>
                
            
            
                
<p class="mce-root">You can put the game into game-mode and use the keyboard inputs detailed in the previous section to experiment with the Cucumber Man's movements. One of the things you might have noticed is that the player character does not seem to move very fast. Of course, this is relative to the size of our terrain and the character's size. Let's look at how to increase the speed of our character by reviewing the associated script.</p>
<p class="mce-root">The following code snippet is from the <kbd>PlayerMotor.cs</kbd> script that you imported with the Cucumber Man. This snippet is the first part of the script, not the entire script. As you can see, there are variables for <kbd>JumpPower</kbd>, <kbd>MoveSpeed</kbd>, and <kbd>RunSpeed</kbd>. Those variables are created in the code and their values can be controlled in the Unity editor:</p>
<pre>using System.Collections;<br/>using System.Collections.Generic;<br/>using UnityEngine;<br/>using UnityStandardAssets.CrossPlatformInput;<br/><br/>[RequireComponent(typeof(Rigidbody))]<br/>public class PlayerMotor : MonoBehaviour {<br/><br/>  float horizontal, vertical;<br/>  Rigidbody m_Rigidbody;<br/><br/>  public float JumpPower;<br/>  public float MoveSpeed, RunSpeed;<br/><br/>  private float currentJumpPower = 0;<br/>  private float currentMoveSpeed = 0;<br/><br/>  // Use this for initialization<br/>  void Start () <br/>  {<br/>    m_Rigidbody = GetComponent&lt;Rigidbody&gt;();<br/>    currentMoveSpeed = MoveSpeed;<br/>  // m_Cam = Camera.main.transform;<br/>    m_Animator = GetComponent&lt;Animator&gt;(); <br/>}<br/>. . .</pre>
<p class="mce-root">The following screenshot is from the Cucumber Man's Inspector panel. Here, you can see that we have the ability to update the values for Jump Power, Move Speed, Run Speed, Stationary Turn Speed, and Moving Turn Speed:</p>
<div><img height="144" width="364" src="img/db8cc907-ccca-4757-994f-5493576e1d28.png"/></div>
<p class="mce-root">Using the Player Motor (Script) component of the Cucumber Man, you can experiment with the values to have the player character's movements respond the way you want them to. You can always refer back to the previous screenshot to reset your values.</p>
<p>You can experiment with the Player Motor (Script) parameters while in game-mode. Any changes made in game-mode are not retained when leaving game-mode. This is a great way of experimenting without impacting any saved settings.</p>
<p class="mce-root">Here is a typical set of parameters for the Cucumber Man's motor controls:</p>
<div><img height="169" width="422" src="img/9fb3e019-ba3f-4b33-81c1-ff587bc6158b.png"/></div>
<p class="mce-root">We also have the option of editing the Move Speed Multiplier variable to impact all of the motor speed values. You can set this manually in the Inspector panel as well as programmatically. To set the multiplier manually, simply edit the value in the Player Motor (Script) component of the <kbd>CucumberMan</kbd> in the Inspector panel. To change this value programmatically, you can edit the <kbd>PlayerMotor.cs</kbd> script. The following code snippet is from that script, and represents the later section of that script:</p>
<pre>. . . <br/>Animator m_Animator;<br/>[SerializeField] float m_MoveSpeedMultiplier = 1f;<br/>public void OnAnimatorMove()<br/>{<br/>   // we implement this function to override the default root motion.<br/>   // this allows us to modify the positional speed before it's applied.<br/>  if (m_IsGrounded &amp;&amp; Time.deltaTime &gt; 0)<br/>  {<br/>     Vector3 v = (m_Animator.deltaPosition * m_MoveSpeedMultiplier) / Time.deltaTime;<br/><br/>     // we preserve the existing y part of the current velocity.<br/>     v.y = m_Rigidbody.velocity.y;<br/>     m_Rigidbody.velocity = v;<br/>  }<br/>}<br/>. . . </pre>
<p class="mce-root">As you can see in the previous code snippet, <kbd>m_MoveSpeedMultiplier</kbd> is set to <kbd>1</kbd>. You can change that value directly in the script as an alternative method to using the Unity editor.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Fine-tuning scale</h1>
                
            
            
                
<p class="mce-root">Our Cucumber Man has a Transform that includes Scale values for X, Y, and Z. By default, these are all set to 1. We can easily change the size of our Cucumber Man by decreasing or increasing the scale values. With this approach, you can create copies of the Cucumber Man that are cucumber babies or cucumber giants. </p>
<p class="mce-root">The following screenshot shows three copies of the Cucumber Man. Starting from the left and moving to the right, each Cucumber Man is larger than the last: </p>
<div><img height="265" width="390" src="img/a9d127a7-7258-4e59-9ed4-9a197be57913.png"/></div>
<p class="mce-root">Here is a look at the transform settings for each Cucumber Man in the preceding screenshot:</p>
<table style="width: 572px;height: 300px">
<tbody>
<tr>
<td/>
<td colspan="3">
<div><strong>Transform Scale setting</strong></div>
</td>
</tr>
<tr>
<td><strong>Cucumber Man version</strong></td>
<td>
<div><strong>X</strong></div>
</td>
<td>
<div><strong>Y</strong></div>
</td>
<td>
<div><strong>Z</strong></div>
</td>
</tr>
<tr>
<td>
<p>Cucumber Baby</p>
</td>
<td>
<p class="CDPAlignCenter CDPAlign">0.5</p>
</td>
<td>
<p class="CDPAlignCenter CDPAlign">.5</p>
</td>
<td>
<p class="CDPAlignCenter CDPAlign">.5</p>
</td>
</tr>
<tr>
<td>
<p>Cucumber Man</p>
</td>
<td>
<p class="CDPAlignCenter CDPAlign">1</p>
</td>
<td>
<p class="CDPAlignCenter CDPAlign">1</p>
</td>
<td>
<p class="CDPAlignCenter CDPAlign">1</p>
</td>
</tr>
<tr>
<td>
<p>Cucumber Giant</p>
</td>
<td>
<p class="CDPAlignCenter CDPAlign">2</p>
</td>
<td>
<p class="CDPAlignCenter CDPAlign">2</p>
</td>
<td>
<p class="CDPAlignCenter CDPAlign">2</p>
</td>
</tr>
</tbody>
</table>
<p> </p>
<p>For our game, we will only have one Cucumber Man, and we want him to be larger than the beetles and smaller than the cherry trees. The default scale of one results in the Cucumber Man's height being ideal. This is evident by his relative size compared to the cherry trees, as indicated in the following screenshot:</p>
<div><img height="281" width="348" src="img/d4563ff9-066d-4af8-a1e8-fca0360f0448.png"/></div>
<p>In <a href="28e6a940-f5d3-49ba-8778-a0b533b4a83e.xhtml">Chapter 8</a>, <em>Implementing our Non-Player Character</em>, we will inspect the scale of our Cucumber Beetles and ensure they are appropriately scaled in relation to the size of our Cucumber Man.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Fine-tuning the Capsule Collider</h1>
                
            
            
                
<p>Capsule Colliders have the shape of a pill—that is, a cylinder with rounded ends. We can view the Capsule Collider by selecting our character in the Hierarchy panel or the Scene view and then reviewing the Capsule Collider component in the Inspector panel. As shown in the following screenshot, we can edit the Capsule Collider by clicking the Edit Collider button:</p>
<div><img height="345" width="570" src="img/f009a0cc-64e1-4b47-9687-a1f46c36b927.png"/></div>
<p>Here is a brief description of each of the Capsule Collider component parameters:</p>
<ul>
<li><strong>Is Trigger</strong>: When we enable this option, the physics engine will ignore the Capsule Collider</li>
<li><strong>Material</strong>: We can assign how the Capsule Collider interacts with other colliding game objects</li>
<li><strong>Center</strong>: There are X, Y, and Z fields to identify the center of the capsule relative to itself</li>
<li><strong>Radius</strong>: The radius of the collider's width</li>
<li><strong>Height</strong>: The collider's height</li>
<li><strong>Direction</strong>: The orientation of the capsule lengthwise</li>
</ul>
<p>For greater precision, the Capsule Collider should receive a height adjustment so that the Cucumber Man fits within it, as shown in the following screenshot:</p>
<div><img height="271" width="198" src="img/ee28a0c5-72c2-4564-8466-a96895701203.png"/></div>
<p>Make any refinements required to ensure that your Cucumber Man's Capsule Collider resembles the preceding screenshot. Once you complete your refinements, be sure to save your work.</p>
<p>All changes to the <em>Cucumber Man</em> game detailed in this chapter will be incorporated in the <kbd>Starting-Chapter-08.zip</kbd> file available at the beginning of <a href="28e6a940-f5d3-49ba-8778-a0b533b4a83e.xhtml" target="_blank">Chapter 8</a>, <em>Implementing Our Non-Player Characters</em>. </p>


            

            
        
    

        

                            
                    <h1 class="header-title">Changing and refining input controls </h1>
                
            
            
                
<p>When we develop games using Unity, we have several options for gathering user input during gameplay. Here is a list of those input options:</p>
<ul>
<li>Keyboard</li>
<li>Mouse</li>
<li>Joystick</li>
<li>Touchscreen</li>
<li>Mobile device movement sensors</li>
<li>Microphone</li>
<li>Camera</li>
</ul>
<p class="mce-root">As we stated previously in this chapter, we will be using the keyboard as our sole input device for the <em>Cucumber Man</em> game. Let's take a look at where you can make changes to the input controls for your game if you want to experiment or simply want to change the way users interact with the game. We will use Unity's input manager for this.</p>
<p>The input manager for your game project is accessible, as illustrated in the following screenshot, by selecting the Edit | Project Settings | Input drop-down menu selection:</p>
<div><img height="451" width="432" src="img/3d617c6a-2b07-4ab9-a734-4d71a02d6ad1.png"/></div>
<p class="mce-root">This results in the input manager being displayed in the Inspector panel. There, you will find the relevant virtual axes for the game. In the following screenshot, the horizontal virtual axis and vertical virtual axis are displayed side by side. You can see how the keyboard's <em>W</em>, <em>A</em>, <em>S</em>, and <em>D</em> keys are set for controlling horizontal and vertical movement. For example, the <em>W</em> key is identified in the vertical virtual axis and is assigned to the Alt Positive Button, which means it is an alternative button for moving forward. While the primary Negative and Positive buttons are listed as using the left and right arrow keys for horizontal movement, and the down and up arrow keys are used for vertical navigation, we will implement the <em>W</em>, <em>A</em>, <em>S</em>, and <em>D</em> keys as our default method of moving the Cucumber Man character through the game world:</p>
<div><img height="486" width="1500" class="aligncenter size-full wp-image-612 image-border" src="img/b3447707-7225-4171-8bf9-9d09610324b9.png"/></div>
<p>The input manager enables us to determine all of our input controls, and is where you can set your mouse, keyboard, and joystick inputs. An additional setting available in the input manager is for the jump functionality. As shown in the following screenshot, the jump functionality has the keyboard's space bar as the positive input device. You will note that there is no Negative Button assigned as it is assumed that the character can only jump up, not down:</p>
<div><img height="240" width="364" src="img/8bdc64f7-8be1-4171-be62-201d0192d44a.png"/></div>


            

            
        
    

        

                            
                    <h1 class="header-title">Animating our player character</h1>
                
            
            
                
<p>Your Cucumber Man character controller package includes the necessary assets to support the character's six animations. In this section, we will look at the Cucumber Man's animations, which are listed as follows:</p>
<ul>
<li>Idle</li>
<li>Walk</li>
<li>Run</li>
<li>Jump</li>
<li>Throw</li>
<li>Die</li>
</ul>


            

            
        
    

        

                            
                    <h1 class="header-title">Reviewing the player controller script</h1>
                
            
            
                
<p>There are a couple of areas in Unity in which we can review the Cucumber Man's animations. Let's first look at the Player Controller (Script) component of the <kbd>CucumberMan</kbd> Controller object. When you select the CucumberMan controller in the hierarchy pane, you should see the Player Controller (Script) component in the Inspector panel. You might need to click the expand button to the left of the component in order to reveal the component's details. </p>
<p>As shown in the following screenshot, each of our character's animations has a state associated with it:</p>
<div><img height="131" width="408" src="img/2b91652b-7a7f-45dc-b063-a2c2adaea618.png"/></div>
<p>Now, let's review the <kbd>PlayerController.cs</kbd> script. You can access this file by selecting the All Scripts button in the Project panel, under Favorites. Then, scroll to the PlayerController (Script) in the Project panel. The first 14 lines of the script are shown in the following code fragment:</p>
<pre>using System.Collections;<br/>using System.Collections.Generic;<br/>using UnityEngine;<br/><br/>public class PlayerController : MonoBehaviour {<br/><br/>  public string RunState, WalkState, IdleState, JumpState, DieState, ThrowState;<br/>  bool isWalking, isRunning, isJumping, isIdle, isDie, forward,left,right,back;<br/>  Animator mAnim;<br/>  // Use this for initialization<br/>  void Start () {<br/>    mAnim = GetComponent&lt;Animator&gt;();<br/>    isIdle = true;<br/>   }</pre>
<p class="mce-root">The first three lines simply identify the namespaces we want to use in our script. These are <kbd>System.Collections</kbd>, <kbd>System.Collections.Generic</kbd>, and <kbd>UnityEngine</kbd>. Next, we have the class declaration for our <kbd>PlayerController</kbd> class. The next three lines of code are our variable definitions. As you can see, there is a public string for each of our six animations: <kbd>RunState</kbd>, <kbd>WalkState</kbd>, <kbd>IdleState</kbd>, <kbd>JumpState</kbd>, <kbd>DieState</kbd>, and <kbd>ThrowState</kbd>. There are also several <kbd>boolean</kbd> (<kbd>bool</kbd>) variables including <kbd>isWalking</kbd>, <kbd>isRunning</kbd>, <kbd>isJumping</kbd>, <kbd>isIdle</kbd>, and <kbd>isDie</kbd>. We also identify <kbd>mAnim</kbd> as our animator. We will see how each of these is used later in the script.</p>
<p>The <kbd>Start()</kbd> method sets our initial state of <kbd>isIdle</kbd> to true and gets a reference to our Animator with the <kbd>mAnim = GetComponent&lt;Animator&gt;();</kbd> statement.</p>
<p>The largest method of our <kbd>PlayerController.cs</kbd> script is the <kbd>Update()</kbd> method. The <kbd>Update()</kbd> method is called once per frame. This method is provided in the following code segments, with ellipses (...) to reflect areas where code was removed for brevity. You can refer to the full script in Unity. The first code segment sets the appropriate states to true or false. For example, when the user presses the <em>W</em> key and the player is not currently running, the <kbd>isWalking</kbd> variable is set to true and the <kbd>mAnim.SetBool</kbd> is passed two parameters (<kbd>WalkState</kbd> and <kbd>true</kbd>). Similar actions are taken for the <em>A</em>, <em>S</em>, and <em>D</em> keys:</p>
<pre>. . . <br/>void Update () {<br/>  //Down states<br/>  if( Input.GetKeyDown(KeyCode.W))<br/>  {<br/>    if( !isRunning )<br/>    {<br/>      isWalking = true;<br/>      isIdle = false;<br/>      forward = true;<br/>      mAnim.SetBool(WalkState, true);<br/>      mAnim.SetBool(IdleState, false);<br/>      }<br/>   }<br/>   if( Input.GetKeyDown(KeyCode.A))<br/>   {<br/>      . . . <br/>   }<br/>   if( Input.GetKeyDown(KeyCode.S))<br/>   {<br/>      . . . <br/>   }<br/>   if( Input.GetKeyDown(KeyCode.D))<br/>   {<br/>      . . .<br/>   }<br/>. . . </pre>
<p>The next code snippet from the <kbd>Update()</kbd> method, shown in the following snippet, handles the running animation when the left <em>Shift</em> key is pressed. In this instance, the animation is changed from the <kbd>WalkState</kbd> to the <kbd>RunState</kbd>:</p>
<pre>. . . <br/>if( Input.GetKeyDown(KeyCode.LeftShift))<br/>{<br/>  if( isWalking )<br/>  {<br/>    isRunning = true;<br/>    mAnim.SetBool(RunState, true);<br/>    mAnim.SetBool(WalkState, false);<br/>  }<br/>}<br/>. . . </pre>
<p>The next segment of code, provided in the following snippet, shows how detecting the spacebar input results in the <kbd>Jump()</kbd> animation running and the <kbd>Throw()</kbd> animation running when the <em>E</em> key is detected:</p>
<pre>. . . <br/>if( Input.GetKeyDown(KeyCode.Space))<br/>{<br/>  Jump();<br/>}<br/><br/>if( Input.GetKeyDown(KeyCode.E))<br/>{<br/>  Throw();<br/>}<br/>. . . </pre>


            

            
        
    

        

                            
                    <h1 class="header-title">Reviewing the Animator component</h1>
                
            
            
                
<p>There is one final component in the <kbd>CucumberMan</kbd> Controller object to review: the Animator component. As you can see in the following screenshot, the Animator component has two key properties: Controller and Avatar:</p>
<div><img src="img/b9681e3c-10cc-420c-bfe0-b78a4572f54f.png"/></div>
<p>The controller points to the <kbd>CucumberMan.controller</kbd> file. The file's <kbd>.controller</kbd> file extension will not be displayed in the component interface, but it is a reference to that file. You can navigate to that file in the project pane. It is located under Assets | Cucumber Man. When you double-click that file, it opens in an Animator window, as shown in the following screenshot:</p>
<div><img height="678" width="1018" class="aligncenter size-full wp-image-613 image-border" src="img/13db6093-95f2-4755-8a81-71d478e98dcc.png"/></div>
<p>Here, you can see each of the states, one for each animation, along with the possible transitions between them. Each state is labeled with a <kbd>CM_</kbd> prefix to indicate the <kbd>CucumberMan</kbd>. These states are listed as follows:</p>
<ul>
<li>CM_Idle</li>
<li>CM_Walk</li>
<li>CM_Run</li>
<li>CM_Jump</li>
<li>CM_Throw</li>
<li>CM_Die</li>
</ul>
<p>If the layout of the Animator window is jumbled or unclear, you can rearrange the objects in the Animator window so they are easy to understand. You accomplish this by clicking on a state, dragging it to where you want it, and releasing the mouse button. The following graphic shows one possible organizational approach to the Cucumber Man's states and transitions. Your approach can differ, if you like:</p>
<div><img height="628" width="1217" class="aligncenter size-full wp-image-614 image-border" src="img/a27a9bf3-58c1-4a63-8e89-84f8e5050d58.png"/></div>
<p>You can leave these transitions as they have been provided to you, or, if you want to, you can make changes using the Animator window.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Previewing the animations</h1>
                
            
            
                
<p>You have the option of previewing individual animations without putting the game into game-mode. In the Project panel, select Assets | Cucumber Man and you will see the individual animations listed. For example, click the <kbd>CucumberMan_Throw</kbd> animation. This is the <kbd>CucumberMan_Throw.fbx</kbd> file that is part of the package you imported earlier in this chapter. </p>
<p>With the animation selected, the Inspector panel gives you access to the Model, Rig, and Animations tabs. Although you do not need to make any changes here, it is worth your time to explore the various features. When you select the Animations tab, you have access to a preview of the animation at the bottom the Inspector panel, as illustrated in the following screenshot:</p>
<div><img height="347" width="450" src="img/c3cb6d83-6385-486a-93e0-2ce83cebd820.png"/></div>
<p>You can click the play button in the top-left corner of the animation preview window to play the animation. The animation will play and loop until you stop the animation. </p>
<p>You can preview each animation by playing the game as well. This is true for all of the animations, except the die animation; we will have to write a script to evoke that animation. We will do this in <a href="7098e2ac-1871-4cb2-98ba-36f3acdb0515.xhtml" target="_blank">Chapter 11</a>, <em>Scripting Victory and Defeat</em>.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Terraforming the terrain for our Cucumber Man</h1>
                
            
            
                
<p>As you play-test the game, it is advisable to have the Cucumber Man walk, run, and jump where you want the player to be able to do these actions when they play the game. This is a step that is often overlooked or given insufficient attention. Think back to the games you play or have played in the past. Has your character ever been stuck or unable to get to a certain area? Odds are that some of that was a result of inadequate testing.</p>
<p>It is recommend that you work on this. The terrain might be, for example, too steep for the character to climb. Use the skills you learned in <a href="f9370800-eaf9-4593-8a9c-8252c85e22ac.xhtml" target="_blank">Chapter 4</a>, <em>Creating Our Terrain</em>, to modify your terrain so that the player character can navigate your game world the way you want it to.</p>
<p>The time you spend on this important step will help ensure the non-player characters, our Cucumber Beetles, can get to the areas you want them to. You will be prompted to check for this in the next <a href="28e6a940-f5d3-49ba-8778-a0b533b4a83e.xhtml" target="_blank">Chapter 8</a>, <em>Implementing Our Non-Player Characters</em>.</p>
<p>Now is a great time to save your scene and your project. Remember, save early and save often!</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Summary</h1>
                
            
            
                
<p class="mce-root">In this chapter, we incorporated our game's player character, the Cucumber Man. We imported the character, reviewed the controls, examined the animations, and made the necessary configuration changes to fully use our character in the game.</p>
<p class="mce-root">In <a href="28e6a940-f5d3-49ba-8778-a0b533b4a83e.xhtml" target="_blank">Chapter 8</a>, <em>Implementing Our Non-Player Characters</em>, we will implement our non-player characters, the Cucumber Beetles. We will import and review the assets associated with the beetles and start scripting parts of our game that are specific to the beetles. This will include randomizing the location of cucumber plants and cucumbers.</p>


            

            
        
    </body></html>