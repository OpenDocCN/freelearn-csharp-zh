<html><head></head><body>
        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Setting Up the .NET Test Environment</h1>
                
            
            <article>
                
<p class="calibre2">In this chapter, we'll explore setting up your development environment. We'll be covering both C# and .NET. In the following chapter, we will focus on setting up a JavaScript and React environment. We'll delve into more examples, starting with the classic code kata entitled <em class="calibre12">FizzBuzz,</em> and then into more real-world samples from the <em class="calibre12">Speaker Meet</em> site.</p>
<p class="calibre2">In this chapter, you will gain an understanding of:</p>
<ul class="calibre7">
<li class="calibre8">Installing your IDE</li>
<li class="calibre8">How to set up your testing framework</li>
<li class="calibre8">Writing your first tests in C#</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Installing the .NET Core SDK</h1>
                
            
            <article>
                
<p class="calibre2">Before you get started with the development environments, you will want to install the .NET Core SDK. You'll need to navigate to the .NET Core download page on the Microsoft website (<a href="https://www.microsoft.com/net/download/core" class="calibre10">https://www.microsoft.com/net/download/core</a>). Select the proper installer for your system. For Windows machines, the <kbd class="calibre11">.exe</kbd> download is recommended.</p>
<p class="calibre2">Follow the onscreen instructions for the install wizard to install the .NET Core SDK.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Getting set up with VS Code</h1>
                
            
            <article>
                
<p class="calibre2">One benefit of choosing VS Code for your development is that it is an excellent IDE for both .NET and JavaScript. To get started using VS Code, you must first download the IDE. </p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Downloading the IDE</h1>
                
            
            <article>
                
<p class="calibre2"><span>Visit the VS Code website (</span><a href="https://code.visualstudio.com/" class="calibre10">https://code.visualstudio.com/</a><span>) and choose the proper version for your operating system:</span></p>
<div class="cdpaligncenter"><img src="../images/00005.jpeg" class="calibre24"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Installing the VS Code</h1>
                
            
            <article>
                
<p class="calibre2">Follow the instructions in the wizard to install the VS Code:</p>
<div class="cdpaligncenter"><img src="../images/00006.jpeg" class="calibre25"/></div>
<p class="calibre2">Be sure to read and accept the <span>License Agreement</span>:</p>
<div class="cdpaligncenter"><img src="../images/00007.jpeg" class="calibre26"/></div>
<p class="calibre2">Choose a location on your hard drive to install VS Code. The default path is usually acceptable:</p>
<div class="cdpaligncenter"><img src="../images/00008.jpeg" class="calibre27"/></div>
<p class="calibre2">Choose to create a Start menu folder for the application, select a location, or choose to not create a Start menu folder:</p>
<div class="cdpaligncenter"><img src="../images/00009.jpeg" class="calibre28"/></div>
<p class="calibre2">Select additional tasks. The default should be fine for our purposes, as shown in the following screenshot:</p>
<div class="cdpaligncenter"><img src="../images/00010.jpeg" class="calibre29"/></div>
<p class="calibre2">Review your installation settings and click on <span>Install</span>:</p>
<div class="cdpaligncenter"><img src="../images/00011.jpeg" class="calibre30"/></div>
<p class="calibre2">Once the install is finished, you're OK to launch the application:</p>
<div class="cdpaligncenter"><img src="../images/00012.jpeg" class="calibre31"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Adding extensions</h1>
                
            
            <article>
                
<p class="calibre2">VS Code is a fairly lightweight and bare-bones IDE. You'll need to install C# to get started. When you launched VS Code for the first time, your browser should have opened to the <span>Getting Started</span> page on the VS Code website. If it didn't, go there now (<a href="https://code.visualstudio.com/docs" class="calibre10">https://code.visualstudio.com/docs</a>).</p>
<p class="calibre2">There are a variety of useful extensions that you can install from the marketplace. For now, all you will need is C#. At the time of writing, C# was listed near the top of the <span>Top Extensions</span> list. Click on the C# tile (or find it by searching in the marketplace) to learn more about this extension.</p>
<p class="calibre2">You should see that the installation instructions direct you to launch VS Code Quick Open (<em class="calibre12">Ctrl</em>-<em class="calibre12">P</em>) and paste the following command:</p>
<pre class="calibre19">ext install csharp</pre>
<p class="calibre2">From within VS Code, paste the command into the <span>Quick Open</span> section and press <em class="calibre12">Enter</em>. Find the C# version powered by OmniSharp and choose <span>Install</span>. Once the C# extension is installed, you will need to reload VS Code to activate the C# extension (choose <span>reload</span>).</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Creating a project in VS Code</h1>
                
            
            <article>
                
<p class="calibre2">Now that your VS Code IDE is properly installed with the C# extension enabled, you are ready to create your first project.</p>
<p class="calibre2">With VS Code open, choose <span>Open Folder</span> from the <span>File</span> menu. Choose a location that is easily accessible. Many developers will create a <kbd class="calibre11">Development</kbd> folder on the root of their drive. Whatever convention you're used to will be fine. You now need to create an <em class="calibre12"><span>MSTest</span></em> project.</p>
<p class="calibre2">Create a new folder named <kbd class="calibre11">Sample</kbd>. Open the <span>Integrated Terminal</span> window from the <span>View</span> menu or by using the shortcut keys (<em class="calibre12">Ctrl</em> + <em class="calibre12">`</em>). From within the Terminal window, type <kbd class="calibre11">dotnet new mstest</kbd> and hit <em class="calibre12">Enter</em>. Now, you need to restore your packages by typing <kbd class="calibre11">dotnet restore</kbd> into the Terminal window and hitting <em class="calibre12">Enter</em>.</p>
<p class="calibre2">You should now see a file named <kbd class="calibre11">UnitTest1.cs</kbd> within the <kbd class="calibre11">Sample</kbd> folder. If you open the file, it should look something like this:</p>
<pre class="calibre19">using Microsoft.VisualStudio.TestTools.UnitTesting;<br class="title-page-name"/><br class="title-page-name"/>namespace Sample<br class="title-page-name"/>{<br class="title-page-name"/>  [TestClass]<br class="title-page-name"/>  public class UnitTest1<br class="title-page-name"/>  {<br class="title-page-name"/>    [TestMethod]<br class="title-page-name"/>    public void TestMethod1()<br class="title-page-name"/>    {<br class="title-page-name"/>    }<br class="title-page-name"/>  }<br class="title-page-name"/>}</pre>
<p class="calibre2">Change the first test method to an <kbd class="calibre11">ItExists</kbd> test. Do this by changing the name to <kbd class="calibre11">ItExists</kbd> and trying to declare an instance to a class that does not yet exist:</p>
<pre class="calibre19">var sampleClass = new SampleClass();</pre>
<p class="calibre2">You should see that your sample application will not compile and you will have received the error message, <kbd class="calibre11">The type or namespace 'SampleClass' could not be found (are you missing a using directive or an assembly reference?)</kbd>.</p>
<p class="calibre2">Now that you have a test failure (remember, failing to compile counts as a failing test in this instance), it's safe to move on to the <em class="calibre12">Green</em> step in our <em class="calibre12">red, green, refactor</em> cycle. Make the test pass by creating a definition for <kbd class="calibre11">SampleClas<em class="calibre12">s</em></kbd>. Feel free to create the class in the same file as your unit tests, just to get you started. This can always be extracted and moved to a more appropriate location later:</p>
<pre class="calibre19">public class SampleClass<br class="title-page-name"/>{<br class="title-page-name"/>}</pre>
<p class="calibre2">Now that you've made the change, run the <kbd class="calibre11">test</kbd> command <kbd class="calibre11">dotnet test</kbd><em class="calibre12"> </em>and see the results:</p>
<pre class="calibre19"><strong class="calibre1">Total tests: 1. Passed: 1. Failed: 0. Skipped: 0.</strong></pre>
<p class="calibre2">Continue exploring VS Code and growing your new class through tests. The C# and .NET examples throughout the rest of the book will be using Visual Studio Community. If you prefer, you may choose to stick with VS Code.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Setting up Visual Studio Community</h1>
                
            
            <article>
                
<p class="calibre2">Most C# and .NET developers will be familiar with Visual Studio. There are a variety of versions available, ranging from free to many thousands of dollars annually. As of this writing, the Enterprise version was the most fully featured version, offering some of the best features for tests and testing. For our purposes, we'll be using Visual Studio Community. This is a free, fully featured development environment that should suit us well.</p>
<p class="calibre2">The Community edition does have some very important caveats. There are limitations to the software license and the use of the Community edition, based on the terms of the license agreement. Please make sure to read the terms before deciding to use Visual Studio Community edition to develop software that you intend to sell. The current terms can be found at <a href="https://www.visualstudio.com/license-terms/mlt553321/" class="calibre10">https://www.visualstudio.com/license-terms/mlt553321/</a>.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Downloading Visual Studio Community</h1>
                
            
            <article>
                
<p class="calibre2">To get started, download Visual Studio Community (<a href="https://www.visualstudio.com/downloads/" class="calibre10">https://www.visualstudio.com/downloads/</a>). Feel free to explore and compare the different versions of Visual Studio while you're there:</p>
<div class="cdpaligncenter"><img src="../images/00013.jpeg" class="calibre32"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Installing Visual Studio Community</h1>
                
            
            <article>
                
<p class="calibre2">The wizard for installing Visual Studio Community is a little different from the install wizard for VS Code. Of course, to get started, you'll need to read and agree to the license agreement.</p>
<p class="calibre2">At a minimum, you'll want to choose ASP.NET and web development and .NET Core cross-platform development if you plan to follow along with the book. We've also chosen to include ASP.NET MVC 4, .NET Framework 4.6.2 development tools, and .NET Framework 4.7 development tools from the right pane, or from the <em class="calibre12"><span>Individual components</span></em> tab<em class="calibre12">.</em> You might want to explore other components and/or language packs, as well.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Switching to xUnit</h1>
                
            
            <article>
                
<p class="calibre2">MSTest has long shipped with Visual Studio. There are a few other options when it comes to testing frameworks for C# and .NET. Many of these frameworks have feature parity and differ only slightly in their choices of attributes, assertions, and exception handling. Among the top contenders for testing frameworks is xUnit. Many developers actually prefer this to MSTest and would argue that it is more feature-rich and has stronger community support. Arguments aside, we'll be using xUnit for our C# and .NET tests from here on out.</p>
<p class="calibre2">Feel free to stick with MSTest if you prefer. Just know that you'll need to account for the semantic differences (such as <em class="calibre12">TestMethod</em> vs <em class="calibre12">Fact</em>) and slight differences in functionality.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Code katas</h1>
                
            
            <article>
                
<p class="calibre2">What is a code kata? Code katas are nothing more than repeatable exercises. Generally, these exercises are meant to take no more than 20 minutes to complete. Most code katas are directed at a specific classification of a problem to solve. We'll be utilizing the classic example, FizzBuzz, as a way to get you more comfortable with TDD using xUnit.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">FizzBuzz</h1>
                
            
            <article>
                
<p class="calibre2">The rules of FizzBuzz are quite simple. If the number provided is divisible by 3, then you must return <kbd class="calibre11">Fizz</kbd>. If the number supplied is divisible by 5, then you must return <kbd class="calibre11">Buzz</kbd>. If the number is divisible by both 3 and 5, then you must return <kbd class="calibre11">FizzBuzz</kbd>. If it is divisible by neither 3 nor 5, then simply return the number itself.</p>
<p class="calibre2">There are a plethora of options in which to solve the problem. It can be solved in nearly every programming language, in a variety of different ways. What's important here is to practice the techniques of solving the problem simply and effectively.</p>
<p class="calibre2">Let's get started.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Creating the test project</h1>
                
            
            <article>
                
<p class="calibre2">Within Visual Studio Community, create an xUnit test project by choosing <span>New</span> | <span>Project</span> from the <span>File</span> menu or by using the shortcut keys (<em class="calibre12">Ctrl </em>- <em class="calibre12">Shift </em>- <em class="calibre12">N</em>). Under <span>.NET Core,</span> choose <span>xUnit Test Project</span>. Give your project the name <kbd class="calibre11">CodeKata</kbd> and click on <span>OK</span>. You will see a filename <kbd class="calibre11">UnitTest1.cs</kbd>. This file is fine to get you started. Let's create our first test.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">The Given3ThenFizz test</h1>
                
            
            <article>
                
<p class="calibre2">The first test method in the <kbd class="calibre11">UnitTest1.cs</kbd> file is named <kbd class="calibre11">Test1</kbd>. Let's change the name of this method to <kbd class="calibre11">Given3ThenFizz</kbd> and write our first test:</p>
<pre class="calibre19">[Fact]<br class="title-page-name"/>public void Given3ThenFizz()<br class="title-page-name"/>{<br class="title-page-name"/>  // Arrange<br class="title-page-name"/>  // Act<br class="title-page-name"/>  var result = FizzBuzz(3);<br class="title-page-name"/><br class="title-page-name"/>  // Assert <br class="title-page-name"/>  Assert.Equal("Fizz", result);<br class="title-page-name"/>}</pre>
<p class="calibre2">Note that the <kbd class="calibre11">Fact</kbd> attribute and <kbd class="calibre11">Assert.Equal</kbd> assertion differ only slightly from our previous MSTest example. We're leaving the <kbd class="calibre11">Arrange</kbd><em class="calibre12">,</em> <kbd class="calibre11">Act</kbd><em class="calibre12">,</em> and <kbd class="calibre11">Assert</kbd> comments in place, and recommend you do the same. These comments will help you as you get started. They'll also serve to help describe the process to any developers that come behind you in the future.</p>
<p class="calibre2">Now, run the test to see whether it passes by selecting <span>Run</span> | <span>All Tests</span> from the <span>Test</span> menu, or by using the shortcut keys (<em class="calibre12">Ctrl</em> + <em class="calibre12">R</em>, <em class="calibre12">A</em>). You should see a compilation error. Let's resolve the error by creating a <kbd class="calibre11">FizzBuzz</kbd> method preceding our <kbd class="calibre11">test</kbd> class. Once you've created the <kbd class="calibre11">FizzBuzz</kbd> method, rerun your test to see it pass. Remember, based on the third law of TDD, you should only write enough code to make it pass:</p>
<pre class="calibre19">private object FizzBuzz(int value)<br class="title-page-name"/>{<br class="title-page-name"/>  return "Fizz";<br class="title-page-name"/>}</pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">The Given5ThenBuzz test</h1>
                
            
            <article>
                
<p class="calibre2">Our next requirements state that we must return <kbd class="calibre11">Buzz</kbd> when 5 is supplied. Let's write that test:</p>
<pre class="calibre19">[Fact]<br class="title-page-name"/>public void Given5ThenBuzz()<br class="title-page-name"/>{<br class="title-page-name"/>  // Arrange<br class="title-page-name"/>  // Act<br class="title-page-name"/>  var result = FizzBuzz(5);<br class="title-page-name"/><br class="title-page-name"/>  // Assert<br class="title-page-name"/>  Assert.Equal("Buzz", result);<br class="title-page-name"/>}</pre>
<p class="calibre2">How might we make that test pass? Perhaps a simple ternary operator? Let's take a look at what that might look like:</p>
<pre class="calibre19">private object FizzBuzz(int value)<br class="title-page-name"/>{<br class="title-page-name"/>  return value == 3 ? "Fizz" : "Buzz";<br class="title-page-name"/>}</pre>
<p class="calibre2">You might see a problem with our algorithm already. That's OK! We're not done yet. We've only gotten as far as the tests have guided us, and so far we're passing all of our tests. Let’s move on to the next most interesting test.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">The Given15ThenFizzBuzz test</h1>
                
            
            <article>
                
<p class="calibre2">You might want to write a test method entitled <kbd class="calibre11">GivenDivisibleBy3and5ThenFizzBuzz</kbd>, but that may be too large of a leap at this point. We know that the first such number divisible by 3 and 5 is 15, so it might make more sense to start with this:</p>
<pre class="calibre19">[Fact]<br class="title-page-name"/>public void Given15ThenFizzBuzz()<br class="title-page-name"/>{<br class="title-page-name"/>  // Arrange  <br class="title-page-name"/>  // Act<br class="title-page-name"/>  var result = FizzBuzz(15);<br class="title-page-name"/><br class="title-page-name"/>  // Assert<br class="title-page-name"/>  Assert.Equal("FizzBuzz", result);<br class="title-page-name"/>}</pre>
<p class="calibre2">How would you choose to make this test pass? Would you use an <em class="calibre12">if/else</em> statement? Perhaps a <em class="calibre12">switch</em> statement? We’ll leave this one as an exercise for the reader. Feel free to make this test pass in any way that you're comfortable with implementing. Remember to run your tests along the way to ensure you don't introduce a breaking change. If you do experience a test failure, feel free to ignore a test (<em class="calibre12">Ignore</em> attribute in MSTest, <em class="calibre12">Skip</em> parameter in xUnit), but only one test, while you fix your error(s).</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">The Given1Then1 test</h1>
                
            
            <article>
                
<p class="calibre2">We've covered <kbd class="calibre11">Fizz</kbd>. We've covered <kbd class="calibre11">Buzz</kbd>. And, we've covered <kbd class="calibre11">FizzBuzz</kbd>. Now we must account for numbers that are divisible by neither 3 nor 5.  Remember, in the event that a number is divisible by neither 3 nor 5, we simply return the number supplied. Let's take a look at this test:</p>
<pre class="calibre19">[Fact]<br class="title-page-name"/>public void Given1Then1()<br class="title-page-name"/>{<br class="title-page-name"/>  // Arrange<br class="title-page-name"/>  // Act <br class="title-page-name"/>  var result = FizzBuzz(1);<br class="title-page-name"/><br class="title-page-name"/>  // Assert <br class="title-page-name"/>  Assert.Equal(1, result);<br class="title-page-name"/>}</pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Theories</h1>
                
            
            <article>
                
<p class="calibre2">This is great! Things are going quite smoothly. Hopefully, you're starting to get the hang of Test-Driven Development. Now, let's look into a slightly more advanced test method using the <kbd class="calibre11">Theory</kbd> and <kbd class="calibre11">InlineData</kbd> attributes.</p>
<p class="calibre2">Looking back at our tests, we see that we have a <kbd class="calibre11">test</kbd> method named <kbd class="calibre11">Given15ThenFizzBuzz</kbd>. While this is fine, it's a little too specific. Remember, our requirement was that, if the number is divisible by 3 and 5, then we should return <kbd class="calibre11">FizzBuzz</kbd>. Let's ensure we didn't take too big a leap in logic by writing a new test. This time, we’ll supply a number of values, expecting the same results:</p>
<pre class="calibre19">[Theory]<br class="title-page-name"/>[InlineData(0)]<br class="title-page-name"/>[InlineData(15)]<br class="title-page-name"/>[InlineData(30)]<br class="title-page-name"/>[InlineData(45)]<br class="title-page-name"/>public void GivenDivisibleBy3And5ThenFizzBuzz(int number)<br class="title-page-name"/>{<br class="title-page-name"/>  // Arrange<br class="title-page-name"/>  // Act<br class="title-page-name"/>  var result = FizzBuzz(number);<br class="title-page-name"/><br class="title-page-name"/>  // Assert<br class="title-page-name"/>  Assert.Equal("FizzBuzz", result);<br class="title-page-name"/>}</pre>
<p class="calibre2">When you run the test suite, you should now see four new passed test results. If you do experience a failure, the results pane in the <span>Test Explorer</span> window should provide a detailed explanation as to which test failed.</p>
<p class="calibre2">Now, do the same thing for <kbd class="calibre11">Fizz</kbd> and <kbd class="calibre11">Buzz</kbd> by creating two more test cases using <kbd class="calibre11">Theories</kbd> and <kbd class="calibre11">InlineData</kbd>. Go ahead and add <kbd class="calibre11">GivenDivisibleBy3ThenFizz</kbd>, <kbd class="calibre11">GivenDivisibleBy5ThenBuzz</kbd>, and <kbd class="calibre11">GivenNotDivisibleBy3or5ThenNumber</kbd>. Be sure to run your test suite after adding each test and <kbd class="calibre11">InlineData</kbd> value, fixing any failures along the way.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Solution to the FizzBuzz Problem</h1>
                
            
            <article>
                
<p class="calibre2">What we came up with looks something like this:</p>
<pre class="calibre19">private object FizzBuzz(int value)<br class="title-page-name"/>{<br class="title-page-name"/>  if (value % 15 == 0)<br class="title-page-name"/>    return "FizzBuzz";<br class="title-page-name"/><br class="title-page-name"/>  if (value % 5 == 0)<br class="title-page-name"/>    return "Buzz";<br class="title-page-name"/><br class="title-page-name"/>  if (value % 3 == 0)<br class="title-page-name"/>    return "Fizz";<br class="title-page-name"/><br class="title-page-name"/>  return value;<br class="title-page-name"/>}</pre>
<p class="calibre2">Don't worry if you chose to solve the problem a different way. The important thing is that you gained knowledge and understanding during this exercise. Additionally, you now have a comprehensive set of tests and you're comfortable refactoring and/or adding functionality.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">What is Speaker Meet?</h1>
                
            
            <article>
                
<p class="calibre2">We're using the <em class="calibre12">Speaker Meet</em> application as a case study in Test-Driven Development. Speaker Meet is a website dedicated to connecting technology speakers, user groups, and conferences. Anyone who has helped organize a user group or tech conference knows it’s often difficult to find speakers. And as technology speakers, it's often difficult to coordinate speaking engagements outside your immediate area. Speaker Meet helps bring technology speakers and communities together.</p>
<p class="calibre2">At the time of writing, the application is still in development, but it is a terrific platform to explore TDD concepts and principles as they relate to real-world applications. Speaker Meet consists of a RESTful API in .NET with a <strong class="calibre1">Single Page Application</strong> (<strong class="calibre1">SPA</strong>) in JavaScript, utilizing the React library.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Web API project</h1>
                
            
            <article>
                
<p class="calibre2">For our first exercise, we'll be creating a new API endpoint. This new endpoint will return a list of speakers based on a supplied search term. We'll be utilizing this endpoint in our React examples in a later chapter.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Listing Speakers (API)</h1>
                
            
            <article>
                
<p class="calibre2">A list of Speakers will be returned from the database by accessing the back-end API. Before starting on writing the code, a set of requirements must first be established. It's difficult to know where to begin if an agreed upon set of functionality hasn't been defined.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Requirements</h1>
                
            
            <article>
                
<p class="calibre2"><span>Below are the requirements, you might expect to receive from a business analyst or product owner. These are often a good starting point for a broader conversation. If something is not clear, it's best to resolve any ambiguity before you begin.</span></p>
<pre class="calibre19"><strong class="calibre1">As a</strong> conference organizer <br class="title-page-name"/> <strong class="calibre1">I want</strong> to search for available speakers <br class="title-page-name"/> <strong class="calibre1">So that</strong> I may contact them about my conference <br class="title-page-name"/><br class="title-page-name"/><strong class="calibre1">Given</strong> I am a conference organizer <br class="title-page-name"/> <strong class="calibre1">And Given</strong> a speaker in mind <br class="title-page-name"/> <strong class="calibre1">When</strong> I search for speakers by name <br class="title-page-name"/> <strong class="calibre1">Then</strong> I receive speakers with a matching first name <br class="title-page-name"/><br class="title-page-name"/><strong class="calibre1">Given</strong> I am a conference organizer <br class="title-page-name"/> <strong class="calibre1">And Given</strong> a speaker in mind <br class="title-page-name"/> <strong class="calibre1">When</strong> I search for speakers by name <br class="title-page-name"/> <strong class="calibre1">Then</strong> I receive speakers with a matching last name </pre>
<p class="calibre2">Upon speaking with our product owner, we determined that by the requirement of <em class="calibre12">matching</em>, what was truly desired was a <em class="calibre12">starts-with</em> match. If a conference organizer were to search for the string "Jos," the results for <em class="calibre12">Josh</em>, <em class="calibre12">Joshua</em>, <em class="calibre12">Joseph</em>, should be returned by the search routine.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">A new test file</h1>
                
            
            <article>
                
<p class="calibre2">We’ll start by creating a new test file. Let's name this file <kbd class="calibre11">SpeakerControllerSearchTests.cs</kbd>. Now, create the first test, <kbd class="calibre11">ItExists</kbd>:</p>
<pre class="calibre19">[Fact]<br class="title-page-name"/>public void ItExists()<br class="title-page-name"/>{<br class="title-page-name"/>  var controller = new SpeakerController();<br class="title-page-name"/>}</pre>
<p class="calibre2">To make this compile, you'll need to create a Web API controller called <kbd class="calibre11">SpeakerMeetController</kbd>. Add a new ASP.NET Core Web Application project to your solution. Give your project a name of <kbd class="calibre11">SpeakerMeet.API</kbd> and choose the Web API template to get started. Add a reference to this project from your test project and add the appropriate using statement.</p>
<p class="calibre2">Now, let's ensure that there is a <kbd class="calibre11">Search</kbd> endpoint available. Let's create another test:</p>
<pre class="calibre19">[Fact]<br class="title-page-name"/>public void ItHasSearch()<br class="title-page-name"/>{<br class="title-page-name"/>  // Arrange<br class="title-page-name"/>  var controller = new SpeakerController();<br class="title-page-name"/><br class="title-page-name"/>  // Act<br class="title-page-name"/>  controller.Search("Jos");<br class="title-page-name"/>}</pre>
<p class="calibre2">Make this test pass by creating a <kbd class="calibre11">Search</kbd> method that accepts a string.</p>
<p class="calibre2">Let's confirm that the <kbd class="calibre11">Search</kbd> action result returns an <kbd class="calibre11">OkObjectResult</kbd>:</p>
<pre class="calibre19">[Fact]<br class="title-page-name"/>public void ItReturnsOkObjectResult()<br class="title-page-name"/>{<br class="title-page-name"/>  // Arrange<br class="title-page-name"/>  var controller = new SpeakerController();<br class="title-page-name"/><br class="title-page-name"/>  // Act<br class="title-page-name"/>  var result = controller.Search("Jos");<br class="title-page-name"/><br class="title-page-name"/>  // Assert<br class="title-page-name"/>  Assert.NotNull(result);<br class="title-page-name"/>  Assert.IsType&lt;OkObjectResult&gt;(result);<br class="title-page-name"/>}</pre>
<p class="calibre2">Note the multiple <kbd class="calibre11">Asserts</kbd>. While we want to limit our tests to a single <kbd class="calibre11">Act</kbd>, sometimes it is acceptable, even necessary, to have multiple <kbd class="calibre11">Asserts</kbd>.</p>
<p class="calibre2">Once the <kbd class="calibre11">ItReturnsOkObjectResult</kbd> test passes, you should delete the <kbd class="calibre11">ItExists</kbd> and <kbd class="calibre11">ItHasSearch</kbd> tests. Remember, we want to finish the <em class="calibre12">red, green, refactor</em> cycle and keep our code neat and clean. This includes the test suite, so if you have tests that are no longer valid or add no value, then you should feel free to remove them. You don't want to have to maintain more code than is required. This will help your test suite stay relevant and run nice and fast.</p>
<p class="calibre2">Now, let’s test that the result is a collection of speakers:</p>
<pre class="calibre19">[Fact]<br class="title-page-name"/>public void ItReturnsCollectionOfSpeakers()<br class="title-page-name"/>{<br class="title-page-name"/>  // Arrange<br class="title-page-name"/>  var controller = new SpeakerController();<br class="title-page-name"/><br class="title-page-name"/>  // Act<br class="title-page-name"/>  var result = controller.Search("Jos") as OkObjectResult;<br class="title-page-name"/><br class="title-page-name"/>  // Assert<br class="title-page-name"/>  Assert.NotNull(result);<br class="title-page-name"/>  Assert.NotNull(result.Value); <br class="title-page-name"/>  Assert.IsType&lt;List&lt;Speaker&gt;&gt;(result.Value);<br class="title-page-name"/>}</pre>
<p class="calibre2">We're starting to get a little redundant here. Now is a good time to refactor our tests to make them cleaner. Let's extract the creation of the <kbd class="calibre11">SpeakerController</kbd> and initialize this value in the constructor. Be sure to remove the creation in your tests and use this new instance:</p>
<pre class="calibre19">private readonly SpeakerController _controller;<br class="title-page-name"/><br class="title-page-name"/>public SpeakerControllerSearchTests()<br class="title-page-name"/>{<br class="title-page-name"/>  _controller = new SpeakerController();<br class="title-page-name"/>}</pre>
<p class="calibre2">Finally, we're ready to start testing the value of the results. Let's write a test entitled <kbd class="calibre11">GivenExactMatchThenOneSpeakerInCollection</kbd>:</p>
<pre class="calibre19">[Fact]<br class="title-page-name"/>public void GivenExactMatchThenOneSpeakerInCollection()<br class="title-page-name"/>{<br class="title-page-name"/>  // Arrange<br class="title-page-name"/>  // Act<br class="title-page-name"/>  var result = _controller.Search("Joshua") as OkObjectResult;<br class="title-page-name"/><br class="title-page-name"/>  // Assert<br class="title-page-name"/>  var speakers = ((IEnumerable&lt;Speaker&gt;)result.Value).ToList();<br class="title-page-name"/>  Assert.Equal(1, speakers.Count);<br class="title-page-name"/>}</pre>
<p class="calibre2">To get this test to work, we'll need to hard-code some data. Don't worry, we're building this application slowly. The hard-coded data will be removed at a later point:</p>
<pre class="calibre19">[Fact]<br class="title-page-name"/>public void GivenExactMatchThenOneSpeakerInCollection()<br class="title-page-name"/>{<br class="title-page-name"/>  // Arrange<br class="title-page-name"/>  // Act<br class="title-page-name"/>  var result = _controller.Search("Joshua") as OkObjectResult;<br class="title-page-name"/><br class="title-page-name"/>  // Assert  <br class="title-page-name"/>  var speakers = ((IEnumerable&lt;Speaker&gt;)result.Value).ToList();<br class="title-page-name"/>  Assert.Equal(1, speakers.Count);<br class="title-page-name"/>  Assert.Equal("Joshua", speakers[0].Name);<br class="title-page-name"/>}</pre>
<p class="calibre2">Ensure that our search string is not case-sensitive:</p>
<pre class="calibre19">[Theory]<br class="title-page-name"/>[InlineData("Joshua")]<br class="title-page-name"/>[InlineData("joshua")]<br class="title-page-name"/>[InlineData("JoShUa")]<br class="title-page-name"/>public void GivenCaseInsensitveMatchThenSpeakerInCollection (string searchString)<br class="title-page-name"/>{<br class="title-page-name"/>  // Arrange<br class="title-page-name"/>  // Act<br class="title-page-name"/>  var result = _controller.Search(searchString) as OkObjectResult;<br class="title-page-name"/><br class="title-page-name"/>  // Assert<br class="title-page-name"/>  var speakers = ((IEnumerable&lt;Speaker&gt;)result.Value).ToList();<br class="title-page-name"/>  Assert.Equal(1, speakers.Count);<br class="title-page-name"/>  Assert.Equal("Joshua", speakers[0].Name);<br class="title-page-name"/>}</pre>
<p class="calibre2">Next, we need to test to verify that, if the string provided does not match any of our data, then an empty collection is returned:</p>
<pre class="calibre19">[Fact]<br class="title-page-name"/>public void GivenNoMatchThenEmptyCollection()<br class="title-page-name"/>{<br class="title-page-name"/>  // Arrange<br class="title-page-name"/>  // Act<br class="title-page-name"/>  var result = _controller.Search("ZZZ") as OkObjectResult;<br class="title-page-name"/><br class="title-page-name"/>  // Assert<br class="title-page-name"/>  var speakers = ((IEnumerable&lt;Speaker&gt;)result.Value).ToList();<br class="title-page-name"/>  Assert.Equal(0, speakers.Count);<br class="title-page-name"/>}</pre>
<p class="calibre2">And finally, we'll test that any speaker that begins with our search string will be returned:</p>
<pre class="calibre19">[Fact]<br class="title-page-name"/>public void Given3MatchThenCollectionWith3Speakers()<br class="title-page-name"/>{<br class="title-page-name"/>  // Arrange<br class="title-page-name"/>  // Act <br class="title-page-name"/>  var result = _controller.Search("jos") as OkObjectResult;<br class="title-page-name"/><br class="title-page-name"/>  // Assert  <br class="title-page-name"/>  var speakers = ((IEnumerable&lt;Speaker&gt;)result.Value).ToList();<br class="title-page-name"/>  Assert.Equal(3, speakers.Count);<br class="title-page-name"/>  Assert.True(speakers.Any(s =&gt; s.Name == "Josh"));<br class="title-page-name"/>  Assert.True(speakers.Any(s =&gt; s.Name == "Joshua"));<br class="title-page-name"/>  Assert.True(speakers.Any(s =&gt; s.Name == "Joseph"));<br class="title-page-name"/>}</pre>
<p class="calibre2">Here's what the code we came up with looks like. Your implementation may vary somewhat:</p>
<pre class="calibre19">using System;<br class="title-page-name"/>using System.Collections.Generic;<br class="title-page-name"/>using System.Linq;<br class="title-page-name"/>using Microsoft.AspNetCore.Mvc;<br class="title-page-name"/><br class="title-page-name"/>namespace SpeakerMeet.Api.Controllers<br class="title-page-name"/>{<br class="title-page-name"/>  [Route("api/[controller]")]<br class="title-page-name"/>  public class SpeakerController : Controller<br class="title-page-name"/>  {<br class="title-page-name"/>    [Route("search")]<br class="title-page-name"/>    public IActionResult Search(string searchString)<br class="title-page-name"/>    {<br class="title-page-name"/>      var hardCodedSpeakers = new List&lt;Speaker&gt;<br class="title-page-name"/>      {<br class="title-page-name"/>        new Speaker{Name = "Josh"},<br class="title-page-name"/>        new Speaker{Name = "Joshua"},<br class="title-page-name"/>        new Speaker{Name = "Joseph"},<br class="title-page-name"/>        new Speaker{Name = "Bill"},<br class="title-page-name"/>      };<br class="title-page-name"/> <br class="title-page-name"/>      var speakers = hardCodedSpeakers.Where(x =&gt; x.Name.StartsWith(searchString, StringComparison.OrdinalIgnoreCase)).ToList();<br class="title-page-name"/><br class="title-page-name"/>      return Ok(speakers);<br class="title-page-name"/>    }<br class="title-page-name"/>  }<br class="title-page-name"/><br class="title-page-name"/>  public class Speaker<br class="title-page-name"/>  {<br class="title-page-name"/>    public string Name { get; set; }<br class="title-page-name"/>  }<br class="title-page-name"/>}</pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Summary</h1>
                
            
            <article>
                
<p class="calibre2">You should now feel quite comfortable with your .NET development environment. The .NET Core SDK should now be installed and your IDE configured. You've had some exposure to unit tests and continuous test runners in Visual Studio and VS Code. </p>
<p class="calibre2">In <a href="part0095.html#2QJ5E0-d186949d2da74f5c95dd1712efae1195" class="calibre10">Chapter 3</a>, <em class="calibre12">Setting Up the JavaScript Environment</em>, we'll focus on getting our JavaScript environment set up.</p>


            </article>

            
        </section>
    </body></html>