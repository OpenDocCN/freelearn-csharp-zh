<html><head></head><body><div class="chapter" title="Chapter&#xA0;11.&#xA0;Creating a Mobile Application in Visual Studio"><div class="titlepage"><div><div><h1 class="title"><a id="ch11"/>Chapter 11. Creating a Mobile Application in Visual Studio</h1></div></div></div><p>Visual Studio is the tour de force of <span class="strong"><strong>integrated development environments</strong></span> (<span class="strong"><strong>IDEs</strong></span>). There is no doubt about that. You as a<a class="indexterm" id="id861"/> developer are able to be as versatile as you like by creating applications for a wide range of platforms. One of these platforms is mobile development. Developers are starting to create mobile applications, but don't want to use a different IDE. With Visual Studio 2015, you don't have to. It will <a class="indexterm" id="id862"/>allow you to create Android and (now with <span class="strong"><strong>Xamarin</strong></span>) iOS applications too. This chapter will therefore take a look at the following concepts:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Installing Xamarin and other required components</li><li class="listitem" style="list-style-type: disc">Creating an Android Visual Studio project using Apache Cordova</li><li class="listitem" style="list-style-type: disc">Creating an iOS application using Xamarin Forms</li></ul></div><div class="section" title="Introduction"><div class="titlepage"><div><div><h1 class="title"><a id="ch11lvl1sec78"/>Introduction</h1></div></div></div><p>If you have not heard about Xamarin, we encourage you to do a Google search for this tool. Traditionally, developers needed to use<a class="indexterm" id="id863"/> <span class="strong"><strong>Xcode</strong></span> or <span class="strong"><strong>NetBeans</strong></span> to create iOS and Android applications. The challenge for <a class="indexterm" id="id864"/>developers was that it meant learning a new programming language. If you, for example, created an application that you wanted to deploy to iOS, Android, and Windows, you needed to know Objective-C or Swift, Java, and a .NET language.</p><p>This also created additional challenges for development, because it meant having to maintain multiple code bases. If a change was to be made in the Windows version of the application, it also had to be made to the iOS and Android code base. Sometimes companies would manage different development teams for each platform. You can imagine the complications involved in managing a change across multiple teams on multiple platforms. This is especially true if you are dealing with a large code base.</p><p>Xamarin solves this problem by allowing .NET developers to use standard .NET libraries to create iOS and Android applications using Visual Studio. You, as a .NET developer, can now use the skills you already have to accomplish this. In a nutshell, you would create a shared library for your applications and then have different facades for the different platforms. A second option is to use Xamarin Forms to create one Visual Studio project and target all three platforms. This makes it very easy for developers to target multiple platforms.</p></div></div>
<div class="section" title="Installing Xamarin and other required components"><div class="titlepage"><div><div><h1 class="title"><a id="ch11lvl1sec79"/>Installing Xamarin and other required components</h1></div></div></div><p>Xamarin can be installed<a class="indexterm" id="id865"/> during custom Visual Studio installation. For now, let's assume that <a class="indexterm" id="id866"/>Xamarin has not been installed and that you need to do that now, after you have installed Visual Studio.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch11lvl2sec188"/>Getting ready</h2></div></div></div><p>One thing to be aware of if you want to target iOS is that you will need to use a Mac to build your iOS applications.</p></div><div class="section" title="How to do it…"><div class="titlepage"><div><div><h2 class="title"><a id="ch11lvl2sec189"/>How to do it…</h2></div></div></div><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">In the <span class="strong"><strong>Control Panel</strong></span>, click on <span class="strong"><strong>Programs and Features</strong></span>. Right-click on your Visual Studio installation and click on <span class="strong"><strong>Change</strong></span>:<div class="mediaobject"><img alt="How to do it…" src="graphics/B05391_11_01.jpg"/></div></li><li class="listitem">This will display the Visual Studio installer for you. Here you can modify your current Visual Studio installation by adding and removing components at will. Notice that we have selected <span class="strong"><strong>C#/.NET (Xamarin v4.0.3)</strong></span> and <span class="strong"><strong>HTML/JavaScript (Apache Cordova) Update 8.1</strong></span> to install. If you have no interest in using <a class="indexterm" id="id867"/>Xamarin, then leave off the Xamarin component and just keep the Apache Cordova option selected. This will still allow you to create Android applications using Apache Cordova instead of using<a class="indexterm" id="id868"/> Xamarin. Similarly, if you have no interest in Apache Cordova and simply want to create Android applications and iOS applications using Visual Studio, select the Xamarin component to install. The rest of the installation is straightforward:<div class="mediaobject"><img alt="How to do it…" src="graphics/B05391_11_02.jpg"/></div></li><li class="listitem">There is also a second step we need to take if we want to use Xamarin to target iOS applications. We have <a class="indexterm" id="id869"/>to install the required software on <a class="indexterm" id="id870"/>a Mac. Head on over to Xamarin's website <a class="indexterm" id="id871"/>on your Mac. The URL is <a class="ulink" href="https://www.xamarin.com/">https://www.xamarin.com/</a>. Click on the <span class="strong"><strong>Products</strong></span> dropdown and select <span class="strong"><strong>Xamarin Platform</strong></span> from the list:<div class="mediaobject"><img alt="How to do it…" src="graphics/B05391_11_03.jpg"/></div></li><li class="listitem">You can also access<a class="indexterm" id="id872"/> the required page by going to <a class="ulink" href="https://www.xamarin.com/platform">https://www.xamarin.com/platform</a>. Clicking on the <span class="strong"><strong>Download now for free</strong></span> button will install something called Xamarin Studio on your Mac. You need to be aware that when installed on a Mac, Xamarin Studio cannot create Windows Apps. It will only allow you to create iOS and Android apps on a Mac. Along with Xamarin Studio, you will also get the Xamarin Mac Agent (previously called the Xamarin Build Host). This is a required component so that you can link your PC to your Mac in order to build your iOS application. Lastly, the PC and Mac must also be able to connect to each other over a network (more on this later):<div class="mediaobject"><img alt="How to do it…" src="graphics/B05391_11_04.jpg"/></div></li><li class="listitem">After downloading the installer <a class="indexterm" id="id873"/>on the Mac, the installation is <a class="indexterm" id="id874"/>straightforward. Just follow the screen prompts to complete the installation:<div class="mediaobject"><img alt="How to do it…" src="graphics/B05391_11_05.jpg"/></div></li></ol></div></div><div class="section" title="How it works…"><div class="titlepage"><div><div><h2 class="title"><a id="ch11lvl2sec190"/>How it works…</h2></div></div></div><p>The steps we took previously<a class="indexterm" id="id875"/> when installing Xamarin and Apache Cordova will allow us to do the following:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Install Apache Cordova</strong></span>: If you only <a class="indexterm" id="id876"/>want to target Android, iOS, and Windows but don't want to use Xamarin</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Install Xamarin</strong></span>: If you want to target Android, iOS, Windows, or all three and use a single solution to do so</li></ul></div><p>Visual Studio is extremely flexible and offers developers a wide variety of choice.</p></div></div>
<div class="section" title="Creating an Android Visual Studio project using Apache Cordova"><div class="titlepage"><div><div><h1 class="title"><a id="ch11lvl1sec80"/>Creating an Android Visual Studio project using Apache Cordova</h1></div></div></div><p>Creating an <a class="indexterm" id="id877"/>Android application using <a class="indexterm" id="id878"/>Apache Cordova is extremely easy. This recipe, however, will only show you how to get started.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch11lvl2sec191"/>Getting ready</h2></div></div></div><p>You will need to have Apache Cordova installed as part of the custom installation options during Visual Studio setup. To see how to do this, refer to the <span class="emphasis"><em>Installing Xamarin and other required components</em></span> recipe in this chapter.</p></div><div class="section" title="How to do it…"><div class="titlepage"><div><div><h2 class="title"><a id="ch11lvl2sec192"/>How to do it…</h2></div></div></div><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">From the<a class="indexterm" id="id879"/> <span class="strong"><strong>New Project</strong></span> dialog<a class="indexterm" id="id880"/> screen, select <span class="strong"><strong>Apache Cordova Apps</strong></span> and select the <span class="strong"><strong>Blank App (Apache Cordova)</strong></span> as the template to use. Choose a location for your project and click on the <span class="strong"><strong>OK</strong></span> button:<div class="mediaobject"><img alt="How to do it…" src="graphics/B05391_11_06.jpg"/></div></li><li class="listitem">Once Visual Studio has created your application, you will notice that it has a very specific structure to it. From the project, you will notice that you can target Android, iOS, Windows, or Windows Phone 8.1. This is the framework you will be using to create your Android application:<div class="mediaobject"><img alt="How to do it…" src="graphics/B05391_11_07.jpg"/></div></li><li class="listitem">When you are<a class="indexterm" id="id881"/> ready to debug, you can choose an emulator from the <span class="strong"><strong>Debug</strong></span> menu. This will deploy<a class="indexterm" id="id882"/> your application to the selected emulator and allow you to test your application:<div class="mediaobject"><img alt="How to do it…" src="graphics/B05391_11_08.jpg"/></div></li></ol></div></div><div class="section" title="How it works…"><div class="titlepage"><div><div><h2 class="title"><a id="ch11lvl2sec193"/>How it works…</h2></div></div></div><p>Being able to target <a class="indexterm" id="id883"/>different mobile <a class="indexterm" id="id884"/>devices from a single solution using Visual Studio allows developers the freedom to experiment and find what solution fits them and their development style the best.</p></div></div>
<div class="section" title="Creating an iOS application using Xamarin Forms"><div class="titlepage"><div><div><h1 class="title"><a id="ch11lvl1sec81"/>Creating an iOS application using Xamarin Forms</h1></div></div></div><p>Many developers want to try their hand at writing an iOS application. The big drawback has always been learning a new<a class="indexterm" id="id885"/> programming language and a new IDE. For some, it is probably not an issue as they want to learn something new. But for many .NET developers, being able to stick to an IDE and programming <a class="indexterm" id="id886"/>language they know is immensely empowering. Well, this is exactly what Xamarin Forms and Visual Studio achieve. It gives .NET developers the ability to use Visual Studio to write applications that can be run cross-platform easily, without having a separate code base for each.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch11lvl2sec194"/>Getting ready</h2></div></div></div><p>You will need to have a Mac running OS X. You will only need this for debugging iOS applications.</p></div><div class="section" title="How to do it…"><div class="titlepage"><div><div><h2 class="title"><a id="ch11lvl2sec195"/>How to do it…</h2></div></div></div><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">In Visual Studio 2015, create a new project. From the installed templates, choose <span class="strong"><strong>Cross-Platform</strong></span> and select <span class="strong"><strong>Blank App (Xamarin.Forms.Portable)</strong></span>. This will allow us to<a class="indexterm" id="id887"/> create an application that will be cross-platform and not specific to a single platform (Android or iOS, for example):<div class="mediaobject"><img alt="How to do it…" src="graphics/B05391_11_09.jpg"/></div></li><li class="listitem">Project creation <a class="indexterm" id="id888"/>can take a few minutes to complete. Along the way, you might see a message telling you that <span class="strong"><strong>Developer Mode</strong></span> is not enabled for Windows 10 (assuming you are running Windows 10):<div class="mediaobject"><img alt="How to do it…" src="graphics/B05391_11_10.jpg"/></div></li><li class="listitem">Enabling this is <a class="indexterm" id="id889"/>easy enough. You can click on the <span class="strong"><strong>settings for developers</strong></span> link in the message<a class="indexterm" id="id890"/> that popped up, or you can type in <code class="literal">Developer mode</code> in the <span class="strong"><strong>Find a setting</strong></span> search box in Windows 10 <span class="strong"><strong>Settings</strong></span>:<div class="mediaobject"><img alt="How to do it…" src="graphics/B05391_11_11.jpg"/></div></li><li class="listitem">Clicking on the <span class="strong"><strong>Developer mode</strong></span> option will display the <span class="strong"><strong>Use developer features </strong></span>confirmation<a class="indexterm" id="id891"/> dialog. Just<a class="indexterm" id="id892"/> click on <span class="strong"><strong>Yes</strong></span> to continue:<div class="mediaobject"><img alt="How to do it…" src="graphics/B05391_11_12.jpg"/></div></li><li class="listitem">After the project is created, you will be presented with a <span class="strong"><strong>Get started with Xamarin.Forms</strong></span> screen:<div class="mediaobject"><img alt="How to do it…" src="graphics/B05391_11_13.jpg"/></div></li><li class="listitem">Looking at your <a class="indexterm" id="id893"/><span class="strong"><strong>Solution Explorer</strong></span> you will notice that several projects have been created. We<a class="indexterm" id="id894"/> will only focus on the iOS project:<div class="mediaobject"><img alt="How to do it…" src="graphics/B05391_11_14.jpg"/></div></li><li class="listitem">Taking a look at the debug targets, you will notice that as you change your target to Droid, for <a class="indexterm" id="id895"/>example, the Android project is set as the start-up project. The same happens if you set it to iOS:<div class="mediaobject"><img alt="How to do it…" src="graphics/B05391_11_15.jpg"/></div></li><li class="listitem">As it stands now, before you can go ahead and debug your iOS application, you need to connect Visual Studio to the Xamarin Mac Agent on your Mac. In Visual Studio, hover <a class="indexterm" id="id896"/>over the <span class="strong"><strong>Xamarin Mac Agent</strong></span> button on the iOS toolbar. It will show as disconnected:<div class="mediaobject"><img alt="How to do it…" src="graphics/B05391_11_16.jpg"/></div><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note40"/>Note</h3><p>See the <span class="emphasis"><em>Installing Xamarin and other required components</em></span> recipe earlier in this chapter for how to install the Xamarin Mac Agent.</p></div></div></li><li class="listitem">To connect to the Xamarin Mac Agent, click on this button. The <span class="strong"><strong>Xamarin Mac Agent Instructions</strong></span> window will be displayed. You can follow the instructions on this screen, which are as follows:<div class="mediaobject"><img alt="How to do it…" src="graphics/B05391_11_17.jpg"/></div></li><li class="listitem">On your Mac, open up<a class="indexterm" id="id897"/> <span class="strong"><strong>System Preferences</strong></span>. Look for<a class="indexterm" id="id898"/> and click on the <span class="strong"><strong>Sharing</strong></span> icon:<div class="mediaobject"><img alt="How to do it…" src="graphics/B05391_11_18.jpg"/></div></li><li class="listitem">This will display the<a class="indexterm" id="id899"/> <span class="strong"><strong>Sharing</strong></span> window. Select <a class="indexterm" id="id900"/><span class="strong"><strong>Remote Login</strong></span> from the menu on the left and, under <span class="strong"><strong>Only these users</strong></span>, select or add your current Mac user to this list:<div class="mediaobject"><img alt="How to do it…" src="graphics/B05391_11_19.jpg"/></div></li><li class="listitem">When you have added<a class="indexterm" id="id901"/> your current Mac user to<a class="indexterm" id="id902"/> the <span class="strong"><strong>Remote Login</strong></span> list, click the back button to return to the previous screen. Then look for and click on <span class="strong"><strong>Network</strong></span>:<div class="mediaobject"><img alt="How to do it…" src="graphics/B05391_11_18.jpg"/></div></li><li class="listitem">This will open up the<a class="indexterm" id="id903"/> <span class="strong"><strong>Network</strong></span> screen. Look where it shows the current status as <span class="strong"><strong>Connected</strong></span>. Underneath<a class="indexterm" id="id904"/> that, you will see an IP address. Make a note of the IP address displayed, because you will need to use it to connect Visual Studio to the Xamarin Mac Agent:<div class="mediaobject"><img alt="How to do it…" src="graphics/B05391_11_20.jpg"/></div><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note41"/>Note</h3><p>Just note that I have purposefully masked my IP address in the screenshot.</p></div></div></li><li class="listitem">Back in Windows, in <a class="indexterm" id="id905"/>Visual Studio <a class="indexterm" id="id906"/>click <span class="strong"><strong>OK</strong></span> to dismiss the <span class="strong"><strong>Xamarin Mac Agent Instructions</strong></span> screen. The <span class="strong"><strong>Xamarin Mac Agent</strong></span> screen will now be visible. At the bottom of this screen, click on the <span class="strong"><strong>Add Mac…</strong></span> button:<div class="mediaobject"><img alt="How to do it…" src="graphics/B05391_11_21.jpg"/></div></li><li class="listitem">This will display the <a class="indexterm" id="id907"/><span class="strong"><strong>Add Mac</strong></span> screen, where<a class="indexterm" id="id908"/> you need to enter the IP address you noted from the <span class="strong"><strong>Network</strong></span> screen in your Mac's <span class="strong"><strong>System Preferences</strong></span>. Click on the <span class="strong"><strong>Add</strong></span> button:<div class="mediaobject"><img alt="How to do it…" src="graphics/B05391_11_22.jpg"/></div><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note42"/>Note</h3><p>Just note that I have <a class="indexterm" id="id909"/>purposefully masked my IP address in the screenshot.</p></div></div></li><li class="listitem">You will now be <a class="indexterm" id="id910"/>asked to provide the username and password for the Mac user you added on the <span class="strong"><strong>Remote Login</strong></span> screen earlier. Click on the <span class="strong"><strong>Login</strong></span> button:<div class="mediaobject"><img alt="How to do it…" src="graphics/B05391_11_23.jpg"/></div><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note43"/>Note</h3><p>Just note that I have<a class="indexterm" id="id911"/> purposefully masked IP addresses and GUID in the screenshot.</p></div></div></li><li class="listitem">After clicking <span class="strong"><strong>Login</strong></span>, you <a class="indexterm" id="id912"/>should automatically be connected to your Xamarin Mac Agent from Visual Studio:<div class="mediaobject"><img alt="How to do it…" src="graphics/B05391_11_24.jpg"/></div></li><li class="listitem">You can now select the iOS device you want to debug on. As you can see, there are a wide variety <a class="indexterm" id="id913"/>of iOS devices to choose from:<div class="mediaobject"><img alt="How to do it…" src="graphics/B05391_11_25.jpg"/></div></li><li class="listitem">For the purposes<a class="indexterm" id="id914"/> of this recipe, we have just chosen an <span class="strong"><strong>iPhone 4S iOS 9.3</strong></span>. Click on the <span class="strong"><strong>Debug</strong></span> button to start the app:<div class="mediaobject"><img alt="How to do it…" src="graphics/B05391_11_26.jpg"/></div></li><li class="listitem">This will now build your application and send that information over the network connection to<a class="indexterm" id="id915"/> the Xamarin Mac Agent. This will then fire up the simulator on your Mac. The first time<a class="indexterm" id="id916"/> you do this, it might take a few minutes to spin up the simulator, but once it is done, successive debug sessions will go much quicker:<div class="mediaobject"><img alt="How to do it…" src="graphics/B05391_11_27.jpg"/></div></li><li class="listitem">After the simulator is <a class="indexterm" id="id917"/>started on the <a class="indexterm" id="id918"/>Mac, the Xamarin application will be launched:<div class="mediaobject"><img alt="How to do it…" src="graphics/B05391_11_28.jpg"/></div></li><li class="listitem">When the Xamarin splash<a class="indexterm" id="id919"/> screen <a class="indexterm" id="id920"/>closes, you will see the <span class="strong"><strong>Welc</strong></span><span class="strong"><strong>ome to Xamarin Forms!</strong></span> text:<div class="mediaobject"><img alt="How to do it…" src="graphics/B05391_11_29.jpg"/></div></li><li class="listitem">Back in Visual Studio, stop debugging. You will notice that the app closes in the simulator app <a class="indexterm" id="id921"/>on the Mac, and that debugging stops in Visual Studio. The simulator, however, remains open on <a class="indexterm" id="id922"/>your Mac.<p>Now let's change some text. Look at the portable project in your Visual Studio solution. This is the shared project that all the other projects in the solution will use. In the portable project, click on the <code class="literal">App.cs</code> file:</p><div class="mediaobject"><img alt="How to do it…" src="graphics/B05391_11_30.jpg"/></div></li><li class="listitem">The default code is <a class="indexterm" id="id923"/>displayed. Here you can see the <code class="literal">Welcome to Xamarin Forms!</code> text we saw in the application we<a class="indexterm" id="id924"/> debugged earlier:<div class="mediaobject"><img alt="How to do it…" src="graphics/B05391_11_31.jpg"/></div></li><li class="listitem">Change the code to look as follows. All we are doing is adding the date and time. A few things to note here are:<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">We are using the standard .NET <code class="literal">DateTime</code> library here</li><li class="listitem" style="list-style-type: disc">We are using string interpolation to create our text to display on the form:<div class="informalexample"><pre class="programlisting">MainPage = new ContentPage
{
    Content = new StackLayout
    {
        VerticalOptions = LayoutOptions.Center,
        Children = {
            new Label { HorizontalTextAlignment = TextAlignment.Center,
                Text = $"Welcome to Xamarin Forms! The date is {DateTime.Now}"
            }
        }
    }
};</pre></div></li></ul></div></li><li class="listitem">When you have done that, debug your application again. When the simulator displays your iOS<a class="indexterm" id="id925"/> application on the Mac, you<a class="indexterm" id="id926"/> will see that the date and time are shown:<div class="mediaobject"><img alt="How to do it…" src="graphics/B05391_11_32.jpg"/></div></li></ol></div></div><div class="section" title="How it works…"><div class="titlepage"><div><div><h2 class="title"><a id="ch11lvl2sec196"/>How it works…</h2></div></div></div><p>One thing to note is that we are not doing anything different here than we would do in any other standard .NET application. We are writing C# code and compiling it to run on an iOS operating system. We can also easily change the application to debug on any iOS device. We didn't need to<a class="indexterm" id="id927"/> learn Objective-C or Swift (although Swift is an awesome language and well worth learning). We also didn't need to<a class="indexterm" id="id928"/> get to grips with learning a new IDE (Xcode, which is used to develop iOS and Mac applications). We didn't have to tweak any constraints, modify any playground elements, or learn how to use any new controls. Xamarin Forms and Visual Studio take care of all of this for us out of the box. Best of all, Xamarin is now free with Visual Studio. There is no reason why you shouldn't try your hand at writing an iOS application.</p></div></div></body></html>