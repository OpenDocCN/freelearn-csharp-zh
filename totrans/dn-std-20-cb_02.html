<html><head></head><body>
        

                            
                    <h1 class="header-title">Primitives, Collections, LINQ, and More</h1>
                
            
            
                
<p class="mce-root">In this chapter, we will be covering the following recipes:</p>
<ul>
<li>Building a .NET Standard 2.0 library that uses primitives</li>
<li>Building a .NET console application to use the library</li>
<li>Creating collections</li>
<li>Building a WPF application to use the library</li>
<li>Describing our library with Reflections</li>
<li>Building a .NET Core console application to use the library</li>
<li>Building a .NET Standard 2.0 library that uses LINQ</li>
<li>Building an ASP.NET MVC application to use the library</li>
</ul>


            

            
        
    

        

                            
                    <h1 class="header-title">Technical requirements</h1>
                
            
            
                
<p>Readers should have a basic knowledge of C#. They should also have a basic knowledge of using Visual Studio, installing packages using NuGet, and referencing libraries within projects from other projects.</p>
<p class="mce-root">The code files for this chapter can be found on GitHub:<br/>
<a href="https://github.com/PacktPublishing/DotNET-Standard-2-Cookbook/tree/master/Chapter02">https://github.com/PacktPublishing/DotNET-Standard-2-Cookbook/tree/master/Chapter02</a></p>
<p class="mce-root">Check out the following video to see the code in action:<br/>
<a href="https://goo.gl/BiXiAM">https://goo.gl/BiXiAM</a></p>


            

            
        
    

        

                            
                    <h1 class="header-title">Introduction</h1>
                
            
            
                
<p>When you look at C# as a language, there are things we need to look at first: what C# can do, how it supports our day-to-day programming requirements, and how it helps us to solve a problem. In this chapter, we will be mainly looking at primitive data types, collections, and LINQ features supported in C#. In the full .NET Framework, using these features is not a problem, but when it comes to cross-platform and code shared across flavors of the .NET Framework, it does becomes a concern. </p>
<p>Each recipe will go through building a .NET Standard 2.0 library and how to use it with an application that uses a flavor of the .NET Framework. </p>


            

            
        
    

        

                            
                    <h1 class="header-title">Building a .NET Standard 2.0 library that uses primitives</h1>
                
            
            
                
<p>In this recipe, we will have a look at C# primitives and their usage in a .NET Standard 2.0 library. Primitives are one of the core parts of the framework. These types are defined in the .NET Framework itself and not in the C# language specification.</p>
<p>We will be building a .NET Standard 2.0 library that uses primitives in the .NET Framework and use it in the next recipe. </p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready </h1>
                
            
            
                
<p>As mentioned, primitive data types are defined under .NET Framework itself and it's not language specific. It means you can use these data types across all languages supported under .NET Framework. It doesn't mean you can use these primitives under different flavors of .NET Framework. For example, if a data type is defined under .NET Framework version 4.6.1, and it's not defined under .NET Core 2.0, your code will fail under .NET Core 2.0. </p>
<p>Also, make sure you have the latest version of Visual Studio, which is 2017 at the time of writing.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<ol>
<li>Open Visual Studio 2017.</li>
<li>Click File | New | Project and, in the New Project template dialog box, select Visual Studio Solutions under the Other Project Types node in the left-hand pane and select Blank Solution in the right-hand pane.<br/></li>
<li>In the Name: text box, type <kbd>Chapter2.Primitives</kbd> as the name of the solution. Select a preferred location under the Location: drop-down list or click the Browse... button and select a location. Leave the defaults as they are.</li>
</ol>
<div><img class="alignnone size-full wp-image-571 image-border" src="img/c20399d7-b2e9-46c0-bb99-3574accc4395.png" style="width:97.00em;height:14.17em;"/><br/>
<br/></div>
<ol start="4">
<li>Click OK. </li>
<li>Now, in the Solution Explorer (or press <em>Ctrl</em> + <em>Alt</em> + <em>L</em>), select Chapter2.Primitives. Right-click and, select Add | New Project<strong>.</strong></li>
<li>In the Add New Project dialog box, expand the Visual C# node and select .NET Standard in the left-hand pane. </li>
</ol>
<ol start="7">
<li>In the right-hand pane, select Class Library (.NET Standard):</li>
</ol>
<div><img class="alignnone size-full wp-image-572 image-border" src="img/2f43e866-6234-4fdb-bdc5-dbe41ad92b7c.png" style="width:97.58em;height:67.58em;"/></div>
<ol start="8">
<li>Now, in the Name: text box, type <kbd>Chapter2.Primitives.PrimitiveLib</kbd> and leave the Location: text box as it is:</li>
</ol>
<div><img src="img/54e2fecb-0500-48be-95d4-ac805bbfefea.png"/></div>
<ol start="9">
<li>Click OK.</li>
</ol>
<ol start="10">
<li>Now, the Solution Explorer should look like this: </li>
</ol>
<div><img class="alignnone size-full wp-image-573 image-border" src="img/61ea9ea7-b0e1-4993-b1ae-81438b4c9e0c.png" style="width:24.25em;height:11.75em;"/></div>
<ol start="11">
<li>Click on Class1.cs and press <em>F2</em> to rename it. Type <kbd>Helpers.cs</kbd> as the new name. </li>
<li>Select Yes in the confirmation dialog box for renaming. </li>
<li>Now, double-click on <kbd>Helpers.cs</kbd> to open its code window. </li>
<li>Type the following code in between the curly brackets of the <kbd>Helpers</kbd><strong> </strong>class: </li>
</ol>
<pre class="mce-root">      public char WhatIsMyGrade(int yourMarks)<br/>      {<br/>          var grade = 'F';<br/>          if (yourMarks &gt;= 85)<br/>              grade = 'A';<br/>          else if (yourMarks &gt;= 65)<br/>               grade = 'B';<br/>          else if (yourMarks &gt;= 55)<br/>               grade = 'C';<br/>          else if (yourMarks &gt;= 35)<br/>               grade = 'S';<br/><br/>          return grade;<br/>      }</pre>
<ol start="15">
<li>Press <em>Ctrl</em> + <em>Shift</em> + <em>B</em> to build your code. </li>
<li>Again, type the following code next to the ending curly bracket from step 14:</li>
</ol>
<pre class="mce-root">      public double CmToInches(double cm)<br/>      {<br/>          var oneCmToInches = 0.393700787;<br/>    <br/>          return oneCmToInches * cm; <br/>      }</pre>
<ol start="17">
<li>Let's build our code to check that everything is fine. Click Build | Build Solution or press <em>Ctrl</em> + <em>Shift</em> + <em>B</em> and the solution should build successfully. Let's test our class library in the next recipe. </li>
<li>Click File | Save All, or press <em>Ctrl</em> + <em>Shift</em> + <em>S,</em> to save the solution and the class library project. </li>
</ol>


            

            
        
    

        

                            
                    <h1 class="header-title">How it works...</h1>
                
            
            
                
<p>Let's have a look at what we have achieved so far. From steps 1 to 4, we opened Visual Studio 2017 and created a blank solution. Blank solutions are a very good foundation for a project that has multiple projects. In steps 5 to 10, we added a new project to the blank solution. In step 7, we used an existing base .NET Standard 2.0 project template and gave it a proper name in step 8. </p>
<p>In steps 11 and 12, we changed the default <kbd>Class1.cs</kbd> to a meaningful name. These names are very important and it helps a developer to understand what the code is for inside that file. In this case, we chose <kbd>Chapter2.Primitives.PrimitiveLib</kbd> as the project name. The first two sections provide the solution name and, at the end, there is the actual project name. </p>
<p>In step 14, we created code that includes a public method. The method takes an <kbd>int</kbd> type variable as the parameter. <kbd>int</kbd> is a primitive data type that is supported in the framework itself, so we have used it inside a .NET Standard library. It means the code can be shared across .NET Framework, .NET Core, and Mono running applications. </p>
<p>The data type <kbd>int</kbd> is an alias for <kbd>System.Int32</kbd> and these are the primitive types supported under .NET that can be used and shared in a .NET Standard 2.0 library: </p>
<ul>
<li><kbd>Boolean</kbd></li>
<li><kbd>Byte</kbd></li>
<li><kbd>SByte</kbd></li>
<li><kbd>Int16</kbd></li>
<li><kbd>UInt16</kbd></li>
<li><kbd>Int32</kbd></li>
<li><kbd>UInt32</kbd></li>
<li><kbd>Int64</kbd></li>
<li><kbd>UInt64</kbd></li>
<li><kbd>IntPtr</kbd></li>
<li><kbd>UIntPtr</kbd></li>
<li><kbd>Char</kbd></li>
<li><kbd>Double</kbd></li>
<li><kbd>Single</kbd></li>
</ul>
<p>The code takes a <kbd>char</kbd> variable and each <kbd>if</kbd> statement validates the marks sent through the <kbd>yourMarks</kbd> parameter in the method. Finally, the method returns a <kbd>char</kbd> value as the grade and then we confirmed all the syntax was correct and built successfully in step 15. In step 16, we created another method that converts centimeters to inches. The input parameter is another primitive type called <kbd>double</kbd>, which<strong> </strong>is also an alias for <kbd>System.Double</kbd>. This is because C# represents all primitives as objects. Inside the code, one variable already converts centimeters into inches and is stored as <kbd>oneCmToInches</kbd><strong>. </strong>In the last line, we return the inches as <kbd>double</kbd>, converted from centimeters given in the parameter of the method. </p>
<p>In step 17, we did another build to check all code for syntax and finally did a save all. </p>


            

            
        
    

        

                            
                    <h1 class="header-title">A .NET console application to use the library</h1>
                
            
            
                
<p>In this recipe we are going to do two things. First, we will be opening Visual Studio and doing a quick build of the previously built solution for the .NET Standard 2.0 library. Finally, we will be adding a .NET console application to use the library. This console application will be using .NET Framework 4.6.1 as the base framework under Windows. </p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>Make sure you have completed the previous recipe that builds the .NET Standard 2.0 library. We will be using it in this recipe. Open Visual Studio 2017 and prepare for the project. Click Build | Build Solution, or press <em>Ctrl</em> + <em>Shift</em> + <em>B</em>,<strong> </strong>and the solution should build successfully. Everything's ready for testing our class library. </p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<ol>
<li>Open Visual Studio 2017.</li>
<li>Now open the solution from the previous recipe. Click File | Open | Open Project/Solution, or press <em>Ctrl</em> + <em>Shift</em> + <em>O</em>, and select the Chapter2.Primitives solution. </li>
<li>Now click on the Chapter2.Library solution label. Click File | Add | New Project.</li>
<li>In the Add New Project template dialog box, expand the Visual C# node in the left-hand pane. </li>
<li>Select Windows Classic Desktop and then Console App (.NET Framework) in the right-hand pane:</li>
</ol>
<div><img class="alignnone size-full wp-image-574 image-border" src="img/a39cf4fe-46b0-4d02-a64a-9d0809d710ea.png" style="width:97.75em;height:67.50em;"/></div>
<ol start="6">
<li>Now, in the Name: text box, type <kbd>Chapter2.Primitives.PrimitivesConsole</kbd> and leave the Location: text box as it is.</li>
</ol>
<div><img class="alignnone size-full wp-image-575 image-border" src="img/13e8f526-ea8e-4513-94f5-3a39811fee8b.png" style="width:96.83em;height:9.00em;"/></div>
<ol start="7">
<li>Click OK.</li>
<li>After adding the new project, the Solution Explorer (<em>Ctrl</em> + <em>Alt</em> + <em>L</em>) should look like this:</li>
</ol>
<div><img class="alignnone size-full wp-image-576 image-border" src="img/a6ba892c-9cf2-4c16-9014-163008c00383.png" style="width:28.00em;height:21.33em;"/></div>
<ol start="9">
<li>Click on the References label in the Chapter2.Primitives.PrimitivesConsole<strong> </strong>project node. Right-click and select Add | Add Reference.</li>
</ol>
<ol start="10">
<li>In the Reference Manager, select Projects in the left-hand pane and check the Chapter2.Primitives.PrimitiveLib<strong> </strong>in the right-hand pane:</li>
</ol>
<div><img class="alignnone size-full wp-image-577 image-border" src="img/8a4442e5-962a-4e15-9ba0-e1dd14a478c6.png" style="width:81.17em;height:29.00em;"/></div>
<ol start="11">
<li>Click OK to add the reference to the selected project. </li>
<li>Now, in the newly added console application project, double-click on Program.cs to open the code window.</li>
<li>Scroll up and add the following <kbd>using</kbd> directive:</li>
</ol>
<pre class="mce-root">      using Chapter2.Primitives.PrimitiveLib;</pre>
<ol start="14">
<li>Now, scroll down and in between the curly braces of the <kbd>Main()</kbd> method, type the following code: </li>
</ol>
<pre class="mce-root">      var myHelper = new Helpers();<br/>      var myGrade = myHelper.WhatIsMyGrade(65);<br/>      Console.WriteLine($"You are current grade is {myGrade}");<br/><br/>      Console.ReadLine();</pre>
<ol start="15">
<li>Now press <em>F5</em> to debug the code. </li>
</ol>
<ol start="16">
<li>You should see output like this: </li>
</ol>
<div><img class="alignnone size-full wp-image-578 image-border" src="img/f99be648-880f-4319-bc7b-b5a44a781a70.png" style="width:30.50em;height:8.67em;"/></div>
<ol start="17">
<li>Now, press any key to exit the console, click just before the <kbd>Console.ReadLine()</kbd> line, and press <em>Enter</em> to add some new code. </li>
<li>Let's type the following code now: </li>
</ol>
<pre class="mce-root">      var cm = 15;<br/>      var inches = myHelper.CmToInches(cm);<br/>      Console.WriteLine($"{cm} centimeters in inches are {inches}");</pre>
<ol start="19">
<li>Press <em>F5</em> to see the output and you should see the following: </li>
</ol>
<div><img class="alignnone size-full wp-image-579 image-border" src="img/853b0f62-feaf-4c03-a40f-043f8f36ffa5.png" style="width:30.92em;height:13.92em;"/></div>
<ol start="20">
<li>Now that we have successfully tested the library, change some values and see how it works. </li>
</ol>


            

            
        
    

        

                            
                    <h1 class="header-title">How it works...</h1>
                
            
            
                
<p>In steps 1 to 7, we opened an existing Visual Studio solution and added a new project to it. The newly added project is a .NET-based console application. In steps 9 to 11, we added the reference to the .NET Standard 2.0 library project. This is an important step. To use the functionality in the library, you must add the project as a reference.</p>
<p>In step 13, we added code to use the libraries' first method. The first line of code will define a variable to hold the instance of the <kbd>Helpers()</kbd> class. The <kbd>var</kbd> keyword helps you to create a local variable without giving an explicit type. It simply tells the compiler to get the type of variable from the expression on the right-hand side of the initialization statement. For example, see the following:  </p>
<pre>var myInteger = 10;</pre>
<p>This is the same as the following:</p>
<pre>int myInteger = 10; </pre>
<p>The second line of code saves the return value from the <kbd>WhatIsMyGrade()</kbd> method. The next line will display the output to the console window. The last line will tell the console to wait till a key is pressed. In steps 14 and 15, we see the output of the code we wrote.</p>
<p>In step 17, we are testing the second method inside the <kbd>Helpers()</kbd> class inside the .NET Standard 2.0 library we created. In the first line, we created a variable that stores a default value that needs to be converted. In the second line, it stores the converted output in a variable. Again, we have used the <kbd>var</kbd> keyword to store the variable, which will automatically store the value with the type returned from the method, in this case to a <kbd>System.Double</kbd>. The third line will display the output to the console window. In steps 18 and 19, we executed the console application. </p>


            

            
        
    

        

                            
                    <h1 class="header-title">Creating collections</h1>
                
            
            
                
<p>There are three kind of collections supported inside the .NET Framework. In this recipe, we will be focusing on using these collections inside a .NET Standard 2.0 library. In general, collections are used to manage groups of related objects. Creating arrays of objects is a way of grouping related objects. But our focus is on using these collections, which is the second method of grouping related objects.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>These are the three kinds of collections we have in .NET Framework: </p>
<ul>
<li><kbd>System.Collections.Generic</kbd> Classes</li>
<li><kbd>System.Collections.Concurrent</kbd> Classes</li>
<li><kbd>System.Collections</kbd> Classes</li>
</ul>
<p>Let's have a look at these and their usage inside a .NET Standard 2.0 library. </p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<ol>
<li>Open Visual Studio 2017.</li>
<li>Click File | New | Project and, in the New Project template dialog box, select Visual Studio Solutions under the Other Project Types node in the left-hand pane, and then Blank Solution in the right-hand pane.<br/></li>
<li>In the Name: text box, type <kbd>Chapter2.Collections</kbd> as the name of the solution. Select a preferred location under the Location: drop-down list or click the Browse... button and select a location. Leave the defaults as is they are:</li>
</ol>
<div><img class="alignnone size-full wp-image-580 image-border" src="img/80f7e6d9-3b59-40d2-bb73-d424abf4ba74.png" style="width:96.92em;height:13.83em;"/><br/>
<br/></div>
<ol start="4">
<li>Click OK. </li>
<li>Now, in the Solution Explorer (or press <em>Ctrl</em> + <em>Alt</em> + <em>L</em>), select Chapter2.Collections. Right-click and select Add | New Project.</li>
<li>In the Add New Project dialog box, expand the Visual C# node and select .NET Standard in the left-hand pane. </li>
</ol>
<ol start="7">
<li>In the right-hand pane, select Class Library (.NET Standard):</li>
</ol>
<div><img src="img/eb794e35-3680-4d29-888f-895b453ccd3d.png"/></div>
<ol start="8">
<li>Now, in the Name: text box type <kbd>Chapter2.Collections.CollectionsLib</kbd> and leave the Location: text box, as it is:</li>
</ol>
<div><img src="img/069f3d1e-745e-46e8-b167-ff7754aa9a8e.png"/></div>
<ol start="9">
<li>Click OK.</li>
</ol>
<ol start="10">
<li>Now, the Solution Explorer should look like this:</li>
</ol>
<div><img src="img/12f5b8f1-dbfb-40bf-a472-d3b7d5dd5bd2.png" style="width:29.08em;height:10.83em;"/></div>
<ol start="11">
<li>Click on the Class1.cs and press <em>F2</em> to rename it. Type <kbd>LittleShop.cs</kbd> as the new name. </li>
<li>Select Yes in the confirmation dialog box for renaming. </li>
<li>Now double-click on <kbd>LittleShop.cs</kbd> to open its code window. </li>
<li>At the top of the code window, move the cursor (or click the mouse) at the last line of the <kbd>using</kbd> directives and add the following <kbd>using</kbd> directive: </li>
</ol>
<pre class="mce-root">      using System.Collections.Generic;</pre>
<ol start="15">
<li>Type the following code in between the curly brackets of the <kbd>LittleShop</kbd><strong> </strong>class: </li>
</ol>
<pre class="mce-root">      public List&lt;string&gt; GetFruitsList()<br/>      {<br/>          var fruitsList = new List&lt;string&gt;();<br/>    <br/>          fruitsList.Add("Apples");<br/>          fruitsList.Add("Grapes");<br/>          fruitsList.Add("Mangoes");<br/>          fruitsList.Add("Oranges");<br/>          fruitsList.Add("Pineapples");<br/><br/>          return fruitsList;<br/>       }</pre>
<ol start="16">
<li>Let's press <em>Ctrl</em> + <em>Shift</em> + <em>B</em> for a quick build and check for any syntax errors. </li>
<li>Now type the following code at the end of the <kbd>using</kbd> directives at the top of your code window: </li>
</ol>
<pre class="mce-root">      using System.Collections;</pre>
<ol start="18">
<li> At the end of the <kbd>GetFruitsList()</kbd> method, add the following code: </li>
</ol>
<pre class="mce-root">      public ArrayList GetShopItems()<br/>      {<br/>          var shopItems = new ArrayList();<br/>          shopItems.Add("Fruits");<br/>          shopItems.Add("Vegetables");<br/>          shopItems.Add("Chocolates");<br/><br/>          return shopItems;<br/>       }</pre>
<ol start="19">
<li>Let's quickly hit a quick <em>Ctrl</em> + B to debug and check for syntax errors. </li>
<li>Now we are good to go and test the library. </li>
</ol>


            

            
        
    

        

                            
                    <h1 class="header-title">How it works...</h1>
                
            
            
                
<p>Let's see what's going on behind the scenes. From steps 1 to 4, we created the base for the project. This base will help you to create the .NET Standard 2.0 library and the project that will be using that library. A blank solution is always a good starting point for any sort of project. In steps 5 to 10, we added the .NET Standard 2.0 library project to the blank solution and gave it a meaningful name. In steps 11 to 13, we changed the default class template name to a meaningful name. </p>
<p>In step 14, we created a reference to the <kbd>System.Collections.Generics</kbd> namespace. This will give you access to all the collections available under this namespace. In step 15, we used one generic collection object known as <kbd>List&lt;T&gt;</kbd>. In the next few lines, we added some string objects to the variable created. Finally, we returned the list collection, which is the same return type as the <kbd>GetFruitsList()</kbd> method. Then, in step 16, we did a quick build, and this will help us to check the syntax of the code. It's good practice to do a quick build for syntax checking. </p>
<p>Again, in step 17, we added another reference to the <kbd>System.Collections</kbd> namespace. Then, in step 18, we added a <kbd>public</kbd> method that returns an <kbd>ArrayList()</kbd>, which contains in  <kbd>System.Collections</kbd> namespace. In the first line of the <kbd>GetShopItems()</kbd> method, we are creating an instance of the <kbd>ArrayList()</kbd> object, and, in the next few lines, we are adding a string object to the <kbd>ArrayList()</kbd> using its <kbd>Add()</kbd> method. Finally, in the last line, we are returning the array list stored in the variable. Then, in step 19, we did a quick build, and this will help us to check the syntax of the code. It's good practice to do a quick build for syntax checking. </p>
<p>The last kind is the <kbd>System.Collections.Concurrent</kbd><strong> </strong>namespace. This namespace contains collections that are thread safe. It means multiple threads can safely add or remove items from these collections. </p>


            

            
        
    

        

                            
                    <h1 class="header-title">A WPF application to use the library</h1>
                
            
            
                
<p>In this recipe, we will be creating a Windows Presentation Foundation application to use the .NET Standard 2.0 library we created in the previous recipe. We will be continuing to build the application from the previous solution we created. Windows Presentation Foundation is a UI framework that works under .NET Framework and runs in a Windows OS. </p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>Open Visual Studio 2017 and prepare for the project. Make sure you have completed building the .NET Standard 2.0 library in the preview build. Open that project if it's not already open and click Build | Build Solution, or press <em>Ctrl</em> + <em>Shift</em> + <em>B</em>,<strong> </strong>and the solution should build successfully. Everything's ready for testing our class library. </p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<ol>
<li>Open Visual Studio 2017.</li>
<li>Now open the solution from the previous recipe. Click File | Open | Open Project/Solution, or press <em>Ctrl</em> + <em>Shift</em> + <em>O</em>, and select the Chapter2.Collections solution. </li>
<li>Now, click on the Chapter2.Collections solution label. Click File | Add | New Project.</li>
<li>In the Add New Project template dialog box, expand the Visual C# node in the left-hand pane. </li>
</ol>
<ol start="5">
<li>Select Windows Classic Desktop and then WPF App (.NET Framework) in the right-hand pane:</li>
</ol>
<div><img class="alignnone size-full wp-image-581 image-border" src="img/1f8418ff-babb-41b1-94cd-cb36decccbe8.png" style="width:97.58em;height:67.42em;"/></div>
<ol start="6">
<li>In the Name: text box, type <kbd>Chapter2.Collections.WPFLittleShop</kbd> as the name of the project and leave the Location: text box as it is:</li>
</ol>
<div><img src="img/d9de6ce8-85ad-4159-a2b1-40aaab20827f.png"/></div>
<ol start="7">
<li>Click OK.</li>
<li>Now, the Solution Explorer (press <em>Ctrl</em> + <em>Alt</em> + <em>L</em> to open) should look like this:</li>
</ol>
<div><img src="img/686e8ecb-694e-4ae7-a79a-845b5f6f61a7.png" style="width:21.00em;height:18.42em;"/></div>
<ol start="9">
<li>Now, double-click on the MainWindow.xaml to open the designer view. </li>
<li>Open the Tool Box by pressing <em>Ctrl</em> + <em>Alt</em> + <em>X</em> and drag and drop two Buttons and two List Boxes to the main window. </li>
<li>Place them as shown: </li>
</ol>
<div><img class="alignnone size-full wp-image-602 image-border" src="img/a25fcb29-fdb4-4db5-a4ac-fd2678e31701.png" style="width:31.42em;height:23.67em;"/></div>
<ol start="12">
<li> Now, open the Properties window, or press <em>F4</em>, and change the following properties: <br/>
<table>
<tbody>
<tr>
<td><strong>Controler</strong></td>
<td><strong>Property</strong></td>
<td><strong>Value</strong></td>
</tr>
<tr>
<td>Button <em>(first from the left)</em></td>
<td>Name</td>
<td><kbd>FruitsButton</kbd></td>
</tr>
<tr>
<td>Button <em>(first from the left)</em></td>
<td>Content</td>
<td><kbd>Get Fruits</kbd></td>
</tr>
<tr>
<td>Button <em>(second from the left)</em></td>
<td>Name</td>
<td><kbd>ItemsButton</kbd></td>
</tr>
<tr>
<td>Button <em>(second from the left)</em></td>
<td>Content</td>
<td><kbd>Get Items</kbd></td>
</tr>
<tr>
<td>ListBox (first from the left) </td>
<td>Name</td>
<td><kbd>FruitsList</kbd></td>
</tr>
<tr>
<td>ListBox (second from the left)</td>
<td>Name</td>
<td><kbd>ItemsList</kbd></td>
</tr>
</tbody>
</table>
</li>
<li> After applying the previous properties, the MainWindow should look like this:</li>
</ol>
<div><img class="alignnone size-full wp-image-604 image-border" src="img/770fe6a7-65a2-4452-9df6-d5cb18b0f62f.png" style="width:32.08em;height:21.67em;"/></div>
<ol start="14">
<li>Now, in the Solution Explorer (or press <em>Ctrl</em> + <em>Alt</em> + <em>L</em>), expand the<strong> </strong>Chapter2.Collections.WPFLittleShop project tree. </li>
<li>Right-click on the References label and select Add Reference.</li>
<li>In the Reference Manager dialog box, expand the Projects node in the left-hand pane. </li>
<li>Click on Solution. </li>
</ol>
<ol start="18">
<li>Now, check Chapter2.Collections.CollectionsLib in the right-hand pane:</li>
</ol>
<div><img class="alignnone size-full wp-image-605 image-border" src="img/aecd3e1c-474b-41c4-a86e-c414f0ba4d72.png" style="width:81.33em;height:31.17em;"/></div>
<ol start="19">
<li>Click OK.</li>
<li>Double-click on the Get Fruits button. </li>
<li>You will see the <kbd>FruitsButton_Click()</kbd> method. </li>
<li>Scroll up the code window and add the following <kbd>using</kbd> directive at the end of all the <kbd>using</kbd> directives: </li>
</ol>
<pre class="mce-root">      using Chapter2.Collections.CollectionsLib;</pre>
<ol start="23">
<li>Again, scroll down and inside the <kbd>FruitsButton_Click()</kbd> method, write the following code: </li>
</ol>
<pre class="mce-root">      var littleShop = new LittleShop();<br/>      var fruits = littleShop.GetFruitsList();<br/>      <br/>      foreach (var fruit in fruits)<br/>      {<br/>          FruitsList.Items.Add(fruit);<br/>      }<br/><br/>      FruitsList.Items.Add("--------");<br/>      FruitsList.Items.Add($"Item Count: {fruits.Count}");<br/>      FruitsList.Items.Add($"Capacity: {fruits.Capacity}");</pre>
<ol start="24">
<li>Switch back to the <kbd>MainWindow.xaml</kbd> design view by clicking on its tab or just double-clicking on the <kbd>MainWindow.xaml</kbd> label in the Solution Explorer. </li>
<li>Select the Get Items button and double-click on it. </li>
</ol>
<ol start="26">
<li>Now type the following code inside the <kbd>ItemsButton_Click()</kbd> event method:</li>
</ol>
<pre class="mce-root">      var littleShop = new LittleShop();<br/>      var items = littleShop.GetShopItems();<br/><br/>      for (int i=0; i&lt;items.Count; i++)<br/>      {<br/>          ItemsList.Items.Add(items[i]);<br/>      }<br/><br/>      ItemsList.Items.Add("--------");<br/>      ItemsList.Items.Add($"Item Count: {items.Count}");<br/>      ItemsList.Items.Add($"Capacity: {items.Capacity}");</pre>
<ol start="27">
<li>Let's press <em>F5</em> and debug the code.</li>
<li>Press the Get Fruits and Get Items buttons.</li>
<li>You should see output like this:</li>
</ol>
<div><img class="alignnone size-full wp-image-606 image-border" src="img/f23c37d3-b1e1-4b54-85dc-4f697f724814.png" style="width:35.25em;height:18.58em;"/></div>


            

            
        
    

        

                            
                    <h1 class="header-title">How it works...</h1>
                
            
            
                
<p class="mce-root">Now we have a working WPF application that uses a .NET Standard 2.0 library as its source. Let's have a look at the steps we followed. In steps 1 to 7, we opened the previously built .NET Standard 2.0 library project and the solution. After that, we added a Windows Presentation Foundation project to the solution. As you know, WPF is a UI framework that runs on top of the .NET Framework. </p>
<p>From steps 9 to 13, we just created the user interface for our application. Then, in step 12, we changed some default properties of the controls we added. Giving meaningful names is a very good practice as it helps you to build readable code. In step 20, we just double-clicked on a control, in this case the button, to open the code windows. By default, Visual Studio chooses an event for us. Mainly, it chooses a commonly used event and, in this case, it's the click event of the button. </p>
<p>In step 22, we referenced the .NET Standard 2.0 library to the code. This will allow you to access its available methods in the WPF application. In step 23, we have the actual running code for the button click event. In the first line, we created an instance of <kbd>LittleShop()</kbd> and stored it in a variable. Then we used the <kbd>GetFruitsList()</kbd> method to get the list of fruits and stored it in a variable. Then we looped through all the available items in the <kbd>fruits</kbd> variable. </p>
<pre>foreach (var fruit in fruits)<br/>{<br/>    FruitsList.Items.Add(fruit);<br/>}</pre>
<p>In the previous code for the <kbd>fruits</kbd><strong> </strong>variable, there is a <kbd>List</kbd> collection. <kbd>foreach</kbd> will loop through each item inside the <kbd>List</kbd> collection stored in the <kbd>fruits</kbd> variable. And inside the loop, a <kbd>FruitsList</kbd> list box control adds each item in the <kbd>fruits</kbd> collection, which is stored in the <kbd>fruit</kbd> variable. </p>
<pre>FruitsList.Items.Add("--------");<br/>FruitsList.Items.Add($"Item Count: {fruits.Count}");<br/>FruitsList.Items.Add($"Capacity: {fruits.Capacity}");</pre>
<p class="mce-root">After we have added each item to the list box (<kbd>FruitsList</kbd>), we have added a string that displays the number of items in the <kbd>List</kbd> collection. We have used the <kbd>Count</kbd> property in the <kbd>List</kbd> collection to get that information. And, in the last line of code, we picked the <kbd>Capacity</kbd> of the <kbd>List</kbd> collection. The capacity property gets or sets the total number of elements the internal data structure can hold without resizing. </p>
<p>In step 26, we created an instance of the <kbd>LittleShop()</kbd> class and used the <kbd>GetShopItems()</kbd> method to get the items returned as an <kbd>ArrayList()</kbd>. Then we used a <kbd>for</kbd> loop to get the items inside the second list box. The rest is the same as we did with the <kbd>List</kbd> collection. </p>


            

            
        
    

        

                            
                    <h1 class="header-title">Describing our library with Reflections</h1>
                
            
            
                
<p>In this recipe, we will be building a class object that will have two public methods. After using a console application, we will be describing this class object using Reflections. A Reflection gives you the ability to read its own metadata of finding assemblies, type, and module information at runtime. </p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>Make sure we have Visual Studio 2017 and all the updates installed. We will be starting with a blank solution. A blank solution is a very good starting point for any scale of project. Let's build our .NET Standard 2.0 library. </p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<ol>
<li>Open Visual Studio 2017.</li>
<li>Click File | New | Project and, in the New Project template dialog box, select Visual Studio Solutions under the Other Project Types node in the left-hand pane and then Blank Solution in the right-hand pane.<br/></li>
<li>In the Name: text box, type <kbd>Chapter2.Reflections</kbd> as the name of the solution. Select a preferred location under the Location: drop-down list or click Browse... button and select a location. Leave the defaults as they are:</li>
</ol>
<div><img src="img/e94bbb65-3bb2-41c2-818d-80a471fe8c5e.png"/><br/></div>
<ol start="4">
<li>Click OK. </li>
<li>Now, in the Solution Explorer (or press <em>Ctrl</em> + <em>Alt</em> + <em>L</em>), select Chapter2.Reflections. Right-click and select Add | New Project.</li>
<li>In the Add New Project dialog box, expand the Visual C# node and select .NET Standard in the left-hand pane. </li>
</ol>
<ol start="7">
<li>In the right-hand pane, select Class Library (.NET Standard):</li>
</ol>
<div><img src="img/44ee992e-3c96-460b-adf5-2b95ce49e9ee.png"/></div>
<ol start="8">
<li>Now, in the Name: text box, type <kbd>Chapter2.Reflections.CalculatorLib</kbd> and leave the Location: text box as it is:</li>
</ol>
<div><img src="img/c63ec722-e6e0-4e42-bd53-566d5c1a8a8e.png"/></div>
<ol start="9">
<li>Click OK.</li>
</ol>
<ol start="10">
<li>Now, the Solution Explorer (press <em>Ctrl</em> + <em>Alt</em> + <em>L</em> to open) should look like this: </li>
</ol>
<div><img src="img/60c4ef83-e10d-4baf-ae96-95467761eabb.png" style="width:31.00em;height:18.08em;"/></div>
<ol start="11">
<li>Select <kbd>Class1.cs</kbd> in the project tree and press <em>F2</em>. </li>
<li>Rename <kbd>Class1.cs</kbd> as <kbd>Calculator.cs</kbd>, also making sure that you have done the same to the class name itself:</li>
</ol>
<pre class="mce-root">      using System;<br/><br/>      namespace Chapter2.Reflections.CalculatorLib<br/>      {<br/>          public class Calculator<br/>          {<br/>          }<br/>      }</pre>
<ol start="13">
<li>Now, the Solution Explorer should look like this: </li>
</ol>
<div><img src="img/fd4c25cd-b407-4be3-b2af-f3d0f11846dc.png" style="width:26.75em;height:16.92em;"/></div>
<ol start="14">
<li>In the code window, and in between the curly brackets of the <kbd>Calculator</kbd> class, write the following code: </li>
</ol>
<pre class="mce-root">      public int Add(int number1, int number2)<br/>      {<br/>          return number1 + number2; <br/>      }<br/><br/>      public int Subtract(int number1, int number2)<br/>      {<br/>          return number1 - number2;<br/>      }</pre>
<ol start="15">
<li>Let's do a quick build by pressing <em>Ctrl</em> + <em>Shift</em> + <em>B</em>. </li>
</ol>


            

            
        
    

        

                            
                    <h1 class="header-title">How it works...</h1>
                
            
            
                
<p>From steps 1 to 4, we created a blank solution. Then, from steps 5 to 9, we added a .NET Standard 2.0 library to the blank solution. In step 12, we renamed the existing <kbd>Class1.cs</kbd> that came with the template to something more meaningful. We also renamed the class name to match the filename. This is good practice and is also the default behavior of Visual Studio when you create a brand new class. We changed the name to <kbd>Calculator.cs</kbd> and the class name to <kbd>Calculator</kbd>. </p>
<p>In step 14, we added two simple methods to the <kbd>Calculator</kbd> class. The first method adds the given integers and the second method subtracts one integer from another. Finally, we did a quick build to check for syntax errors. </p>


            

            
        
    

        

                            
                    <h1 class="header-title">A .NET Core console application to use the library</h1>
                
            
            
                
<p>Let's have a look at using Reflections in this recipe. We have built a small .NET Standard 2.0 library in the last recipe. Now we will be creating a .NET Core-based console application and use reflections to describe our library. We will be using the <kbd>System.Reflection</kbd> namespace and a few of its classes </p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready </h1>
                
            
            
                
<p>Let's make sure you have completed the previous recipe and, if not, complete it and come back to this one. Open Visual Studio 2017 and locate and open the previously built .NET Standard library. </p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<ol>
<li>Open Visual Studio 2017.</li>
<li>Now open the solution from the previous recipe. Click File | Open | Open Project/Solution, or press <em>Ctrl</em> + <em>Shift</em> + <em>O</em>, and select the <kbd>Chapter2.Reflections</kbd> solution. </li>
<li>Press <em>Ctrl</em> + <em>Shift</em> + <em>B</em> for a quick build to check that everything is fine. </li>
<li>Now click on the Chapter2.Reflections solution label. Click File | Add | New Project.</li>
<li>In the Add New Project template dialog box, expand the Visual C# node in the left-hand pane. </li>
</ol>
<ol start="6">
<li>Select .NET Core and then Console App (.NET Core) in the right-hand pane:</li>
</ol>
<div><img class="alignnone size-full wp-image-582 image-border" src="img/0c898c7e-73d5-4051-9a68-deb0c32f76d1.png" style="width:97.50em;height:67.42em;"/></div>
<ol start="7">
<li>Now, in the Name: text box, type <kbd>Chapter2.Reflections.ReflectCore</kbd> as the name of the project. The rest of the fields should be left as defaults:</li>
</ol>
<div><img class="alignnone size-full wp-image-583 image-border" src="img/3dfeac57-0137-4b0b-9179-7d09eb06ca14.png" style="width:97.08em;height:9.08em;"/></div>
<ol start="8">
<li>Click OK.</li>
</ol>
<ol start="9">
<li>Now, the Solution Explorer (press <em>Ctrl</em> + <em>Alt</em> + <em>L</em>) should look like this: </li>
</ol>
<div><img class="alignnone size-full wp-image-584 image-border" src="img/dcbb6288-addc-4e9a-94a9-5f073c78ddcb.png" style="width:23.92em;height:17.75em;"/></div>
<ol start="10">
<li>Right-click on the Dependencies label in the Chapter2.Reflections.CalculatorLib.</li>
<li>Select Add Reference.</li>
<li>In the Reference Manager, click on the Projects label in the right-hand pane. </li>
<li>Check the Chapter2.Reflections.CalculatorLib<strong> </strong>project in the left-hand pane.</li>
<li>Click OK.</li>
<li>Now, double-click on Program.cs to open the code window. </li>
<li>In the code window, scroll to the top of the screen. </li>
<li>Next to the last line of the <kbd>using</kbd> directives, add this <kbd>using</kbd> directive: </li>
</ol>
<pre class="mce-root">      using System.Reflection;<br/>      using Chapter2.Reflections.CalculatorLib;</pre>
<ol start="18">
<li>Again, scroll down until you reach the <kbd>Main()</kbd> method and write the following code in between the curly brackets of the <kbd>Main()</kbd> method: </li>
</ol>
<pre class="mce-root">      MemberInfo info = typeof(Calculator);<br/>      Console.WriteLine($"Assembly Name: {info.Name}");<br/>      Console.WriteLine($"Module Name: {info.Module.Name}");<br/>      Console.WriteLine();<br/><br/>      var calculator = new Calculator();<br/>      var typeObject = calculator.GetType();<br/>      var methods = typeObject.GetRuntimeMethods();<br/><br/>      foreach (var method in methods)<br/>      {<br/>          Console.WriteLine($"Method name : {method.Name}, <br/>          ---&gt; Return type : {method.ReturnType}");<br/>      }<br/><br/>      Console.ReadLine();</pre>
<ol start="19">
<li>Let's hit <em>F5</em> and see the output: </li>
</ol>
<div><img class="alignnone size-full wp-image-585 image-border" src="img/cc88f0b5-378c-44a2-85fe-0c8740cca464.png" style="width:67.17em;height:27.83em;"/></div>
<ol start="20">
<li>Press any key to exit. </li>
</ol>


            

            
        
    

        

                            
                    <h1 class="header-title">How it works...</h1>
                
            
            
                
<p>Let's have a look at the steps and try to understand. In steps 1 to 3, we opened an existing solution that contained the .NET Standard 2.0 library. We did a quick build to check that all the syntax was OK and the project is compiling without any issues. In steps 4 to 8, we added a .NET Core console-based application to the project and gave it a proper name. </p>
<p>In steps 10 to 14, we added a reference to the .NET Standard 2.0 library project from our .NET Core console application. In step 17, we added two namespaces to the <kbd>Program.cs</kbd> code. One is for accessing reflection classes, which are contained in the <kbd>System.Reflection</kbd> namespace. The other one is the .NET Standard 2.0 library itself. </p>
<p>In step 18, we added code to the <kbd>Program.cs</kbd>, <kbd>Main()</kbd> method:</p>
<pre>MemberInfo info = typeof(Calculator);<br/>Console.WriteLine($"Assembly Name: {info.Name}");<br/>Console.WriteLine($"Module Name: {info.Module.Name}");<br/>Console.WriteLine();</pre>
<p>In the first line of code we have stored a <kbd>Calculator</kbd><strong> </strong>class type into a variable named <kbd>info</kbd>, which is a type of <kbd>System.Reflections.MemberInfo()</kbd>. In the second line of code, we have accessed the of the assembly class name using a <kbd>Name</kbd> property, while again we have accessed the module name using a <kbd>Module.Name</kbd> property. The <kbd>Member Info()</kbd> class allows you to get information about the attributes of a member and provides access to member metadata:</p>
<pre>var calculator = new Calculator();<br/>var typeObject = calculator.GetType();<br/>var methods = typeObject.GetRuntimeMethods();<br/><br/>foreach (var method in methods)<br/>{<br/>    Console.WriteLine($"Method name : {method.Name}, <br/>    ---&gt; Return type : {method.ReturnType}");<br/>}<br/><br/>Console.ReadLine();</pre>
<p>In the preceding few lines of code, we have created an instance of the <kbd>Calculator()</kbd> class established inside the .NET Standard 2.0 library. In the second line, we stored the type of class. In the third line, we have a variable named methods to store all the available runtime methods inside that class. Since <kbd>GetRuntimeMethods()</kbd> is a collection, we can easily use a <kbd>foreach</kbd> statement to iterate through the collections. And finally, inside the <kbd>foreach()</kbd> statement we have output the name and the return type of each method available inside the <kbd>Calculator()</kbd> class. </p>
<p>At the end, we waited for the user to press any key to exit the console application. </p>
<p>In step <em>19</em>, in the output, you might have noticed that apart from the two public methods we have created, there are several more methods. These are coming from the base <kbd>Object</kbd> class itself. </p>


            

            
        
    

        

                            
                    <h1 class="header-title">Building a .NET Standard 2.0 library that uses LINQ</h1>
                
            
            
                
<p>In this recipe, we will be using LINQ inside our .NET Standard 2.0 library. LINQ stands for .NET Language-Integrated Query. LINQ defines a set of general purpose standard query operators: list, select, sort, and projection operators in any .NET-based programming language. The standard query operators allow queries to be applied to any <kbd>IEnumerable&lt;T&gt;</kbd>—based information source. </p>
<p>We will be building a .NET Standard 2.0 library that utilizes LINQ and use the library in the next recipe. </p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>Let's get prepared by opening Visual Studio 2017 and creating a .NET Standard 2.0 library-based project. We can start with a blank solution and later on add the library project. </p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<ol>
<li>Open Visual Studio 2017.</li>
<li>Click File | New | Project and, in the New Project template dialog box, select Visual Studio Solutions under the Other Project Types node in the left-hand pane and then Blank Solution in the right-hand pane.<br/></li>
<li>In the Name: text box, type <kbd>Chapter2.Linq</kbd> as the name of the solution. Select a preferred location under the Location: drop-down list or click the Browse... button and select a location. Leave the defaults as they are:</li>
</ol>
<div><img src="img/e4c790ae-563b-4ade-ae31-7783318dcab0.png"/><br/></div>
<ol start="4">
<li>Click OK. </li>
<li>Now, in the Solution Explorer (or press <em>Ctrl</em> + <em>Alt</em> + <em>L</em>), select Chapter2.Linq. Right-click and select Add | New Project.</li>
<li>In the Add New Project dialog box, expand the Visual C# node and select .NET Standard in the left-hand pane. </li>
<li>In the right-hand pane, select Class Library (.NET Standard).</li>
</ol>
<div><img src="img/2c7235a4-bef0-48a6-9177-339bafacb4ac.png"/></div>
<ol start="8">
<li>Now, in the Name: text box, type <kbd>Chapter2.Linq.QueriesLib</kbd> and leave the Location: text box as it is:</li>
</ol>
<div><img src="img/46570710-4850-4efd-be6d-5b3f7a2723ff.png"/></div>
<ol start="9">
<li>Click OK.</li>
</ol>
<ol start="10">
<li>Now, the Solution Explorer (press <em>Ctrl</em> + <em>Alt</em> + <em>L</em> to open) should look like this: </li>
</ol>
<div><img class="alignnone size-full wp-image-586 image-border" src="img/4446b8fd-d524-4b9c-8d92-2dfedb849cbe.png" style="width:25.50em;height:12.33em;"/></div>
<ol start="11">
<li>Select Class1.cs in the project tree and press <em>F2</em>. </li>
<li>Rename <kbd>Class1.cs</kbd> as <kbd>TelephoneBook.cs</kbd>, also making sure that you have done the same to the class name itself. </li>
<li>Answer Yes in the confirmation dialog box for renaming. </li>
<li>Now, the Solution Explorer should look like this:</li>
</ol>
<div><img class="alignnone size-full wp-image-587 image-border" src="img/93a2abd6-f0bd-4ca6-b21b-c5b4e582a334.png" style="width:26.92em;height:13.17em;"/></div>
<ol start="15">
<li>Double-click the TelephoneBook.cs file to open the code window.</li>
<li>Now, scroll up to the top of the code window and add the following code next to the last line of the <kbd>using</kbd> directives: </li>
</ol>
<pre class="mce-root">      using System.Collections.Generic;<br/>      using System.Linq;</pre>
<ol start="17">
<li>Again, scroll down till you reach the open curly bracket of the <kbd>TelephoneBook</kbd> class and add the following code: </li>
</ol>
<pre class="mce-root">      private List&lt;string&gt; _contactList;</pre>
<ol start="18">
<li> Now, in the next line, add the following code as the <kbd>constructor</kbd> method: </li>
</ol>
<pre class="mce-root">      public TelephoneBook()<br/>      {<br/><br/>          _contactList = new List&lt;string&gt;();<br/><br/>          _contactList.Add("Lenna Paprocki");<br/>          _contactList.Add("Donette Foller");<br/>          _contactList.Add("Simona Morasca");<br/>          _contactList.Add("Mitsue Tollner");<br/>          _contactList.Add("Leota Dilliard");<br/>          _contactList.Add("Sage Wieser");<br/>          _contactList.Add("Kris Marrier");<br/>          _contactList.Add("Minna Amigon");<br/>          _contactList.Add("Abel Maclead");<br/>          _contactList.Add("Kiley Caldarera");<br/>          _contactList.Add("Graciela Ruta");<br/><strong>      </strong>}</pre>
<ol start="19">
<li>Next to the constructor, add the following code:</li>
</ol>
<pre class="mce-root">      public List&lt;string&gt; GetContacts() <br/>      {<br/>          return _contactList;<br/>      }</pre>
<ol start="20">
<li>Again, add this code block at the end of the <kbd>GetContacts()</kbd> method:</li>
</ol>
<pre class="mce-root">      public List&lt;string&gt; GetContactsByLastName(string lastName)<br/>      {<br/>          var contacts = _contactList.Where(<br/>          c =&gt; c.Contains(lastName)).ToList();<br/>          return contacts;<br/>      }</pre>
<ol start="21">
<li>Finally, add the following code block at the end of the <kbd>GetContactsByLastName()</kbd> method: </li>
</ol>
<pre class="mce-root">      public List&lt;string&gt; GetSortedContacts(bool ascending = true)<br/>      {<br/>          var sorted = _contactList.OrderBy(c =&gt; c).ToList();<br/><br/>          if (!ascending)<br/>          {<br/>              sorted = _contactList.OrderByDescending(c =&gt; c).ToList();<br/>          }<br/><br/>          return sorted;<br/>      }</pre>
<ol start="22">
<li>Now that we are done with adding code to the .NET Standard 2.0 library, let's hit <em>Ctrl</em> + <em>Shift</em> + <em>B</em> for a quick build and check for syntax errors. </li>
</ol>


            

            
        
    

        

                            
                    <h1 class="header-title">How it works...</h1>
                
            
            
                
<p class="mce-root">From steps 1 to 4, we created a blank solution using Visual Studio 2017 and gave it a location and a proper meaningful name. Then, from steps 5 to 9, we added a new .NET Standard 2.0 library to the blank solution. As usual, we gave it a proper and meaningful name. </p>
<p>In steps 12 and 13, we renamed the default <kbd>Class1.cs</kbd> template to <kbd>TelephoneBook.cs</kbd>. It's a good practice to keep both the class and filename the same. This is more readable and understandable when you come back to your code. In step 16, we added two namespaces to the code. <kbd>System.Collections.Generic</kbd> will get you the <kbd>List&lt;T&gt;</kbd> class used in the code and <kbd>System.Linq</kbd> gives you more control over those generic collections by allowing the LINQ functionality. </p>
<p>In step 17, we introduced a private variable type of <kbd>List&lt;string&gt;</kbd>. In step 18, we initiated the variable and added some data to the list.  Everything is done inside the constructor of the <kbd>TelephoneBook()</kbd> class. In step 19, we created a method that returns the list of contacts. It has one line of code that returns the populated list. </p>
<p>Again, in step 20, we created a method that takes a string as a parameter. The parameter is the last name and we have used LINQ queries in this line: </p>
<pre>var contacts = _contactList.Where(c =&gt; c.Contains(lastName)).ToList();</pre>
<p>We have used a <kbd>Where</kbd> clause to filter down the list and used an inline function to pass the <kbd>lastName</kbd> parameter to the operation. Finally, we output the result as a list and returned the result at the end of the method. </p>
<p>In step 21, we created a method that ordered the list using LINQ. The <kbd>GetSortedContacts()</kbd><strong> </strong>takes one Boolean parameter and it is optional. C# has supported optional parameters since C# 4.0. </p>
<pre>var sorted = _contactList.OrderBy(c =&gt; c).ToList();</pre>
<p>The previous line of code uses the <kbd>OrderBy()</kbd> method in the list to order the list in ascending order and pass it as a list. If we need it in descending order, just pass the method parameter as <kbd>false</kbd>. </p>


            

            
        
    

        

                            
                    <h1 class="header-title">An ASP.NET MVC application to use the library</h1>
                
            
            
                
<p>In this recipe, we will be creating an ASP.NET MVC application to use the .NET Standard 2.0 library. This was created in the previous recipe. ASP.NET MVC applications run in Windows-based systems under IIS and use the full .NET Framework. We will be starting with an empty ASP.NET MVC project, before moving to its components and use of the library. </p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>Locate the previously built .NET Standard 2.0 library and make sure it builds without any errors. It is also assumed you have basic knowledge of MVC-based ASP.NET applications and are familiar with the terms Models, Views, and Controllers. </p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<ol>
<li>Open Visual Studio 2017.</li>
<li>Now, open the solution from the previous recipe. Click File | Open | <strong>Open Project/Solution</strong>, or press <em>Ctrl</em> + <em>Shift</em> + <em>O</em>, and select the Chapter2.Linq solution. </li>
<li>Press <em>Ctrl</em> + <em>Shift</em> + <em>B</em> for a quick build to check that everything is fine. </li>
<li>Now, click on the Chapter2.Linq solution label. Click File | Add | New Project.</li>
<li>In the Add New Project template dialog box, expand the Visual C# node in the left-hand pane. </li>
<li>Select Web and then ASP.NET Web Application (.NET Framework) in the right-hand pane:</li>
</ol>
<div><img class="alignnone size-full wp-image-588 image-border" src="img/20a27ff5-8440-47b4-9efd-d52f03e50785.png" style="width:97.92em;height:67.75em;"/></div>
<ol start="7">
<li>Now, in the Name: text box, type <kbd>Chapter2.Linq.QueriesMVC</kbd> as the name and leave the Location: text box at its default value:</li>
</ol>
<div><img class="alignnone size-full wp-image-589 image-border" src="img/abf53291-f64e-4a65-86f4-81520db37cf4.png" style="width:96.67em;height:9.00em;"/></div>
<ol start="8">
<li>In the New ASP.NET Web Application dialog box, select Empty from the template list.</li>
</ol>
<ol start="9">
<li>Select MVC as the Add folders and core references for: option:</li>
</ol>
<div><img class="alignnone size-full wp-image-590 image-border" src="img/8cddcabf-0bb7-45e7-b831-8569d4a9dc36.png" style="width:45.25em;height:29.50em;"/></div>
<ol start="10">
<li>Leave the rest as it is and click OK to create the default ASP.NET MVC Web Application template. </li>
</ol>
<ol start="11">
<li>Now, Solution Explorer should look like this:</li>
</ol>
<div><img class="alignnone size-full wp-image-591 image-border" src="img/6e9e4007-12da-496d-a4df-d884af83963b.png" style="width:28.25em;height:34.83em;"/></div>
<ol start="12">
<li>Now, right-click on the Controllers folder inside the Chapter2.Linq.QueriesMVC project. </li>
<li>Select Add | Controller. </li>
</ol>
<ol start="14">
<li>In the Add Scaffold dialog box, select MVC 5 Controller - Empty:</li>
</ol>
<div><img class="alignnone size-full wp-image-592 image-border" src="img/844d157d-f6a6-4d5a-9ce4-67c67e954f4b.png" style="width:97.58em;height:55.75em;"/></div>
<ol start="15">
<li>Click Add.</li>
</ol>
<ol start="16">
<li>In the Add Controller dialog box, type <kbd>HomeController</kbd> as the name of the controller:</li>
</ol>
<div><img class="alignnone size-full wp-image-593 image-border" src="img/8a1937df-7064-41f2-8a42-6d206c147b2a.png" style="width:40.83em;height:7.92em;"/></div>
<ol start="17">
<li>Click Add.</li>
<li>Now, the Solution Explorer (press <em>Ctrl</em> + <em>Alt</em> + <em>L</em>) should look like this:</li>
</ol>
<div><img class="alignnone size-full wp-image-594 image-border" src="img/070304a9-3490-43c0-9ef5-b6e8bed16785.png" style="width:21.25em;height:29.67em;"/></div>
<ol start="19">
<li>Now, right-click on the References label and select Add Reference.</li>
<li>In the Reference Manager, select Projects and check Chapter2.Linq.QueriesLib from the list:</li>
</ol>
<div><img class="alignnone size-full wp-image-595 image-border" src="img/d012a394-ca29-4efa-bada-2018e2ca7894.png" style="width:47.25em;height:18.50em;"/></div>
<ol start="21">
<li>Click OK. </li>
<li>Now, double-click on HomeController.cs in the Controllers folder. </li>
<li>In the code window for HomeController.cs, scroll up and add the following code at the last line of the <kbd>using</kbd> directives: </li>
</ol>
<pre class="mce-root">      using Chapter2.Linq.QueriesLib;</pre>
<ol start="24">
<li>Inside the <kbd>Index()</kbd> action, before the <kbd>return</kbd> keyword, add the following code: </li>
</ol>
<pre class="mce-root">      var telephoneBook = new TelephoneBook();<br/><br/>      ViewBag.Contacts = telephoneBook.GetContacts();</pre>
<ol start="25">
<li>Right-click on the method name of the <kbd>Index()</kbd> method and select Add View:</li>
</ol>
<div><img src="img/a88b630b-98ca-45b6-8a5a-cb71f46d38c6.png" style="width:36.08em;height:9.67em;"/></div>
<ol start="26">
<li>In the Add View dialog box, leave the defaults and click Add:</li>
</ol>
<div><img class="alignnone size-full wp-image-596 image-border" src="img/09bdfcf0-0e0c-46ca-9c1e-c5f3dbad7a10.png" style="width:36.50em;height:20.33em;"/></div>
<ol start="27">
<li>You will be presented with an <kbd>Index.cshtml</kbd> code window with the default template. </li>
<li>Change the code <kbd>&lt;h2&gt;Index&lt;/h2&gt;</kbd><strong> </strong>as follows:</li>
</ol>
<pre class="mce-root">      &lt;h2&gt;Contacts&lt;/h2&gt;</pre>
<ol start="29">
<li>Now move the cursor to the bottom of the code window and add this code:</li>
</ol>
<pre class="mce-root">      &lt;ul&gt;<br/>          @foreach(var contact in ViewBag.Contacts as List&lt;string&gt;)<br/>          {<br/>              &lt;li&gt;@contact&lt;/li&gt;<br/>          }<br/>      &lt;/ul&gt;</pre>
<ol start="30">
<li>Let's press <em>F5</em> and test the code. </li>
</ol>
<ol start="31">
<li>By default, the browser will load <kbd>http://localhost:portnumber/Home/</kbd> and here is the output: </li>
</ol>
<div><img class="alignnone size-full wp-image-597 image-border" src="img/773addf4-9c10-4293-80a7-9438d60fb097.png" style="width:35.33em;height:21.08em;"/></div>
<ol start="32">
<li>Now let's close the browser and switch back to the <kbd>HomeController.cs</kbd> code window.</li>
<li>Right after the end curly bracket of the <kbd>Index()</kbd> action method, add the following code: </li>
</ol>
<pre class="mce-root">      public ActionResult Search(string ln)<br/>      {<br/><br/>          var telephoneBook = new TelephoneBook();<br/><br/>          if (string.IsNullOrEmpty(ln))<br/>          {<br/>              ViewBag.Contacts = telephoneBook.GetContacts();<br/>          }<br/>          else<br/>          {<br/>              ViewBag.Contacts =<br/>              telephoneBook.GetContactsByLastName(ln);<br/>          }<br/><br/>          return View();<br/>      }</pre>
<ol start="34">
<li>Right-click on the method name of the <kbd>Search()</kbd> action and select Add View.</li>
<li>Follow steps <em>26</em> and <em>27</em> to add the <kbd>Search.chtml</kbd> view. </li>
<li>In the <kbd>Search.chtml</kbd> code window, change the code <kbd>&lt;h2&gt;Search&lt;/h2&gt;</kbd> to the following : </li>
</ol>
<pre class="mce-root">      &lt;h2&gt;Search Results - Contacts&lt;/h2&gt;</pre>
<ol start="37">
<li>Add the following code to <kbd>Search.chtml</kbd> after the <kbd>&lt;h2&gt;</kbd> tags:</li>
</ol>
<pre class="mce-root">      &lt;ul&gt;<br/>          @foreach (var contact in ViewBag.Contacts as List&lt;string&gt;)<br/>          {<br/>              &lt;li&gt;@contact&lt;/li&gt;<br/>          }<br/>      &lt;/ul&gt;</pre>
<ol start="38">
<li>Let's press <em>F5</em> and debug the current code. </li>
<li>Type <kbd>http://localhost:portnumber/Home/Search</kbd><em> </em>in the browser address bar and press <em>Enter</em>:</li>
</ol>
<div><img class="alignnone size-full wp-image-598 image-border" src="img/54913537-199c-43db-aa32-cd640d0d1616.png" style="width:42.25em;height:26.08em;"/></div>
<ol start="40">
<li>Now again, type <kbd>http://localhost:portnumber/Home/Search?ln=Marrier</kbd> in the address bar and press <em>Enter</em>: </li>
</ol>
<div><img class="alignnone size-full wp-image-599 image-border" src="img/cdda6873-2d9b-44f4-be7d-ef88c4be9987.png" style="width:45.17em;height:20.67em;"/></div>
<ol start="41">
<li>Close the browser and switch back to the <kbd>HomeController.cs</kbd> code window.</li>
<li>Add the following code after the <kbd>Search()</kbd> action method: </li>
</ol>
<pre class="mce-root">      public ActionResult SortedContacts(bool asc = true)<br/>      {<br/>          var telephoneBook = new TelephoneBook();<br/>    <br/>          ViewBag.Contacts = telephoneBook.GetSortedContacts(asc);<br/><br/>          return View();<br/>      }</pre>
<ol start="43">
<li>Right-click on the method name of the <kbd>SortedContacts()</kbd> action and select Add View.</li>
<li>Follow steps <em>26</em> and <em>27</em> to add the <kbd>SortedContacts.chtml</kbd> view. </li>
</ol>
<ol start="45">
<li>Now, in the <kbd>SortedContacts.chtml</kbd>, change <kbd>&lt;h2&gt;SortedContacts&lt;/h2&gt;</kbd> to <kbd>&lt;h2&gt;Sorted Contacts&lt;/h2&gt;</kbd>.</li>
<li>At the end of the <kbd>&lt;h2&gt;</kbd> tags add the following code.</li>
</ol>
<pre class="mce-root">      &lt;ul&gt;<br/>          @foreach (var contact in ViewBag.Contacts as List&lt;string&gt;)<br/>          {<br/>              &lt;li&gt;@contact&lt;/li&gt;<br/>          }<br/>      &lt;/ul&gt;</pre>
<ol start="47">
<li>Press <em>F5</em> to debug the current code. </li>
<li>Type<em> </em><kbd>http://localhost:portnumber/Home/SortedContacts</kbd> in the address bar of the browser and press <em>Enter</em>:</li>
</ol>
<div><img class="alignnone size-full wp-image-600 image-border" src="img/1dabb79c-f045-4a7e-913c-27d2bedec8d3.png" style="width:43.33em;height:26.25em;"/></div>
<ol start="49">
<li>Again, type <kbd>http://localhost:51084/Home/SortedContacts?asc=false</kbd> in the address bar and press <em>Enter</em>:</li>
</ol>
<div><img class="alignnone size-full wp-image-601 image-border" src="img/026b9e17-9f8b-4341-bb56-85b280144ba5.png" style="width:43.00em;height:26.00em;"/></div>
<ol start="50">
<li>Close the browser. </li>
</ol>


            

            
        
    

        

                            
                    <h1 class="header-title">How it works...</h1>
                
            
            
                
<p>Let's have a look at the completed steps. From steps 1 to 3, we opened an existing solution, which was completed in the previous recipe. Then we did a quick build for syntax checking. From steps 4 to 6, we have added an ASP.NET Web Application project to the existing solution. In step 7, we gave it a proper name.</p>
<p>Later on, in steps 8 and 9, we decided what sort of ASP.NET Web Application it should be. In this case, we have selected MVC empty template. In steps 13 to 15, we have added a Controller to the MVC application. We have selected an empty MVC 5 Controller.</p>
<p>In steps 19 to 21, we added the reference from the .NET Standard 2.0 library. In step 23, we referenced it at the code level. In step 24, in the first line of code, we created an instance of the <kbd>TelephoneBook()</kbd> class. In the second line, we invoked the <kbd>GetContacts()</kbd> method and stored it in <kbd>ViewBag.Contacts</kbd>. <kbd>ViewBag</kbd> is used to send data from the Controller to the View.</p>
<p>From steps 25 to 27, we added a View to the Controllers action method. In step 28, we changed existing code in the <kbd>View</kbd> template created for us by Visual Studio. Then, we looped through the contacts using Razor syntax. In steps 30 and 31, we tested the code in the browser.</p>
<p>From steps 31 to 50, we created views and tested other methods found in the <kbd>TelephoneBook()</kbd> class.</p>


            

            
        
    </body></html>