<html><head></head><body>
        

                            
                    <h1 class="header-title">Functional Programming</h1>
                
            
            
                
<p class="mce-root">In this chapter, we will be looking at these recipes:</p>
<ul>
<li>Creating a .NET Standard 2.0 library</li>
<li>Creating a .NET Core console application to use the library</li>
<li>Creating a .NET Standard 2.0 library that uses tuples</li>
<li>Creating a Razor Pages web application to use the library</li>
<li>Creating a .NET Standard 2.0 library that uses delegates and lambda expressions</li>
<li>Creating a .NET console application to use the library</li>
</ul>


            

            
        
    

        

                            
                    <h1 class="header-title">Technical requirements</h1>
                
            
            
                
<p>Readers should have a basic knowledge of C#. They should also have a basic knowledge of using Visual Studio, installing packages using NuGet, and referencing libraries within projects from other projects.</p>
<p class="mce-root">The code files for this chapter can be found on GitHub:<br/>
<a href="https://github.com/PacktPublishing/DotNET-Standard-2-Cookbook/tree/master/Chapter04">https://github.com/PacktPublishing/DotNET-Standard-2-Cookbook/tree/master/Chapter04</a></p>
<p class="mce-root">Check out the following video to see the code in action:<br/>
<a href="https://goo.gl/yeUdkd">https://goo.gl/yeUdkd</a></p>


            

            
        
    

        

                            
                    <h1 class="header-title">Introduction</h1>
                
            
            
                
<p>This chapter talks about the functional programming capabilities of C# and how to use them for a .NET Standard 2.0 library. Let's look at a definition of functional programming:<br/>
<br/>
<q>"Functional programming is a style that treats computation as the evaluation of mathematical functions and avoids changing state and mutable data."</q></p>
<p>Simply put, it means you will be able to use functions as inputs and outputs for other functions. You can also assign them to variables and store them in collections. Have a look at the following code, which explains what we just talked about:</p>
<pre>Func&lt;int, int&gt; addNumbers = n =&gt; n + 1;<br/>var answer = addNumbers(1);<br/><br/>answer // 2<br/><br/>var range = Enumerable.Range(1, 5);<br/>var answers = range.Select(addNumbers);<br/>answers // 2, 3, 4, 5, 6</pre>
<p>Again, when we follow the functional paradigm, we must avoid state mutation. This means that when an object is created, it never changes; variables should never be reassigned. Functional programming has been around for quite a while and C# supports it very well. Although, if you are looking at functional programming, F# is also a good choice.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Creating a .NET Standard 2.0 library</h1>
                
            
            
                
<p>In this recipe, we will be looking at the basics of functional programming using C# inside a .NET Standard 2.0 library.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>Let's get ready and open Visual Studio 2017. You should also check to see whether it's updated to the latest version.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<ol>
<li>Open Visual Studio 2017.</li>
<li>Click File | New | Project to create a project. </li>
<li>In the New Project dialog box, expand the Other Project Types node in the left-hand pane and select Visual Studio Solutions. In the right-hand pane, select Blank Solution<strong>.</strong></li>
<li>In the Name: textbox, type <kbd>Chapter4.Functions</kbd> and, in the Location: textbox, select a path from the drop-down box or click on the Browse... button to locate a path:</li>
</ol>
<div><img class="alignnone size-full wp-image-688 image-border" src="img/df12a8b7-e54b-47d9-b334-ec3f7871e555.png" style="width:48.00em;height:8.08em;"/></div>
<ol start="5">
<li>Click OK.</li>
<li>Now, your Solution Explorer (<em>Ctrl</em> + <em>Alt</em> + <em>L</em>) should look like this:</li>
</ol>
<div><img class="alignnone size-full wp-image-689 image-border" src="img/4b394f95-c5b0-419e-a5dd-0206b9f30d2f.png" style="width:33.92em;height:10.00em;"/></div>
<ol start="7">
<li>Now, right-click on the <kbd>Chapter4.Functions</kbd> label in the Solution Explorer and select Add  | New Project<strong>.</strong></li>
<li>In the New Project dialog box, expand the Visual C# node.</li>
</ol>
<ol start="9">
<li>Select .NET Standard in the left-hand pane and Class Library (.NET Standard) in the right-hand pane:</li>
</ol>
<div><img class="alignnone size-full wp-image-690 image-border" src="img/3cc92569-210f-4dc1-b96c-d4c3efc24a03.png" style="width:156.58em;height:108.75em;"/></div>
<ol start="10">
<li>Now, in the Name: textbox, type <kbd>Chapter4.Functions.FuncLib</kbd>. Leave the other defaults as they are and click OK:</li>
</ol>
<div><img class="alignnone size-full wp-image-691 image-border" src="img/650f77a2-9643-42e1-8953-2f35241d01ea.png" style="width:155.33em;height:14.75em;"/></div>
<ol start="11">
<li>Now, the Solution Explorer (<em>Ctrl</em> + <em>Alt</em> + <em>L</em>) should look like this:</li>
</ol>
<div><img class="alignnone size-full wp-image-692 image-border" src="img/b9dd5e0e-7d25-42c5-bfd4-d696a32b1e94.png" style="width:22.25em;height:10.25em;"/></div>
<ol start="12">
<li>Now, select <kbd>Class1.cs</kbd> in the Solution Explorer and press <em>F2</em> to rename the file <kbd>Helper.cs</kbd>.</li>
<li>Answer Yes in the confirmation dialog box that asks to rename the class name as well.</li>
<li>Now, double-click on the <kbd>Helper.cs</kbd> label in the Solution Explorer.</li>
<li>In the code window for <kbd>Helper.cs</kbd>, type the following code in between the curly brackets of the class:</li>
</ol>
<pre>      public Func&lt;int, int&gt; AddOne = n =&gt; n + 1;<br/>      <br/>      public Func&lt;int, bool&gt; IsZero = n =&gt; n == 0;</pre>
<ol start="16">
<li>Let's press <em>Ctrl</em> + <em>Shift</em> + <em>B</em> for a quick build to check that all the syntax is correct.</li>
</ol>


            

            
        
    

        

                            
                    <h1 class="header-title">How it works...</h1>
                
            
            
                
<p>In steps 1 to 5, we added a blank solution. This is the base of the coding we are adding in this recipe and the next. After that, we added a .NET Standard 2.0 library in steps 7 to 11. In steps 12 and 13, we renamed the default class generated by the template. You can always delete this default class template and add a new class to the project with the new name.</p>
<p>In step 15, we added code to the <kbd>Helper</kbd> class. In the first line, we created a function that takes a number as an integer and returns an integer as the output. Before the output, we added 1 to the input. <kbd>Func&lt;&gt;</kbd>  is used to create the function. The first <kbd>int</kbd> is taken as the input and the last one as the output. You can add many parameters to this, but the last one is always taken as the output type. For example:</p>
<pre>Func&lt;string, string, int&gt;</pre>
<p>The preceding function takes two <kbd>string</kbd> inputs and returns an <kbd>int</kbd> as the output. And in the step 15, the second line of code checks whether the input number is zero and returns a Boolean value as the output. If the number is zero, it always returns <kbd>true</kbd>, or else it returns <kbd>false</kbd>.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Creating a .NET Core console application to use the library</h1>
                
            
            
                
<p>In this recipe, we will be creating a .NET Core 2.0 console application to use the library we built in the previous recipe.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>Make sure you have completed the previous recipe that built the .NET Standard 2.0 library. If you have completed it, locate it, and open it using Visual Studio 2017. Perform a quick build to check for the syntax using <em>Ctrl</em> + <em>Shift</em> + <em>B</em>.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<ol>
<li>Open Visual Studio 2017.</li>
<li>Now open the solution that we built from the previous recipe.</li>
<li>The Solution Explorer should look like this:</li>
</ol>
<div><img class="alignnone size-full wp-image-693 image-border" src="img/761cb57a-41cb-429f-a655-cf3c1b0080e1.png" style="width:25.83em;height:11.75em;"/></div>
<ol start="4">
<li>Press <em>Ctrl</em> + <em>Shift</em> + <em>B</em> for a quick build to check the syntax.</li>
<li>Now, let's select the solution name and right-click.</li>
<li>From the menu, select Add | New Project.</li>
<li>In the New Project dialog box, expand the Visual C# node and select .NET Core in the left-hand pane.</li>
<li>In the right-hand pane, select Console App (.NET Core):</li>
</ol>
<div><img class="alignnone size-full wp-image-694 image-border" src="img/4a680020-6fa9-4d11-9f8f-ff9854711b8d.png" style="width:46.00em;height:31.83em;"/></div>
<ol start="9">
<li>In the Name: textbox, type <kbd>Chapter4.Functions.CoreConsoleApp</kbd> and leave the defaults as they are:</li>
</ol>
<div><img class="alignnone size-full wp-image-695 image-border" src="img/f5fc2991-5dd5-45ef-902e-54a455812e45.png" style="width:46.33em;height:4.33em;"/></div>
<ol start="10">
<li>Now, the Solution Explorer should look like this:</li>
</ol>
<div><img class="alignnone size-full wp-image-696 image-border" src="img/67176e37-d2f9-4d6b-aedd-1cc7cf960dda.png" style="width:25.00em;height:15.42em;"/></div>
<ol start="11">
<li>Now, select the <kbd>Chapter4.Functions.CoreConsoleApp</kbd> label in the Solution Explorer.</li>
<li>Right-click on the Dependencies label and select Add Reference.</li>
<li>In the Reference Manager dialog box, in the left-hand pane, select Projects.</li>
<li>In the right-hand pane, check <kbd>Chapter4.Functions.Funclib</kbd> in the list:</li>
</ol>
<div><img class="alignnone size-full wp-image-697 image-border" src="img/3fd74c7b-ea5e-4805-a1f2-bb296a3f87fc.png" style="width:48.00em;height:17.33em;"/></div>
<ol start="15">
<li>Click OK.</li>
<li>Now, double-click on the <kbd>Program.cs</kbd> label to open the code window.</li>
<li>In the code window, scroll up till you see the <kbd>using</kbd> directives.</li>
</ol>
<ol start="18">
<li>Add the following <kbd>using</kbd> directive at the end of all the <kbd>using</kbd> directives:</li>
</ol>
<pre>      using System.Linq;<br/>      using Chapter4.Functions.FuncLib;</pre>
<ol start="19">
<li>Now, scroll down to the main method and replace the default code that was generated from the template with the following:</li>
</ol>
<pre>      var helper = new Helper();<br/><br/>      Console.WriteLine(helper.AddOne(5));<br/><br/>      int[] numbers = new int[] { 1, 0, 10, 0, 5, 0 };<br/>      Console.WriteLine($"We have found {numbers.Count(helper.IsZero)} <br/>          zeros.");<br/><br/>      Console.ReadLine();</pre>
<ol start="20">
<li>Now, make sure the <kbd>Chapter4.Functions.CoreConsoleApp</kbd> project is set as the start up project and then press <em>F5</em> to execute.</li>
<li>You should see output like this:</li>
</ol>
<div><img class="alignnone size-full wp-image-698 image-border" src="img/64568cb1-970c-44c9-bd2c-83fa9f2f64ef.png" style="width:25.75em;height:7.17em;"/></div>


            

            
        
    

        

                            
                    <h1 class="header-title">How it works...</h1>
                
            
            
                
<p>In steps 1 to 5, we opened the previous solution from the recipe that built the .NET Standard 2.0 library. Then, we performed a quick build to check for syntax errors. This is very good practice; check for syntax on previously built code before we go further. Then, in steps 6 to 10, we added a .NET Core 2.0 console application to the project. In steps 12 to 14, we added the library we built as a dependency to the .NET Core 2.0 console application.</p>
<p>You must add this reference to use the library's functionality in the console application. Then, we added two <kbd>using</kbd> statements in step 18. The first one will allow you to use LINQ capabilities in the code and the second one will allow you to use the available methods from the library.</p>
<p>Then, in step 19, we added code to use the methods from the library. In the first line, we created an instance of the <kbd>Helper</kbd> class and stored it in a variable. Then, we used the <kbd>AddOne</kbd> function and wrote the output to the console. In the third line, we created an integer array and stored a few numbers. Finally, we used the count function available in LINQ to use the function we created. The count function will go through each number in the array, pass it to our <kbd>IsZero</kbd> function, and return the output.</p>
<p>At the end, in step 21, we executed the application to see the output.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Creating a .NET Standard 2.0 library that uses tuples</h1>
                
            
            
                
<p>In this recipe, we will be using C# tuples with our library. Tuples allow you to combine the assignment of multiple variables of varying types in a single statement. For example, you can do this in a single line of code:</p>
<pre>(string firstName, string lastName, int yearsOfExperience) = ("Fiqri", "Ismail", 15);</pre>
<p>Let's have a look at using tuples in a .NET Standard 2.0 library.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>Let's launch Visual Studio 2017 and make sure it's updated to the latest version. We will require C# 7.0 to complete this recipe.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<ol>
<li>Open Visual Studio 2017.</li>
<li>Click File | New | Project<strong> </strong>to create a project. </li>
</ol>
<ol start="3">
<li>In the New Project dialog box, expand the Other Project Types node in the left-hand pane and select Visual Studio Solutions. In the right-hand pane, select Blank Solution<strong>.</strong></li>
</ol>
<ol start="4">
<li>In the Name: textbox, type <kbd>Chapter4.Tuples</kbd> and, in the Location: textbox, select a path from the drop-down box or click on the Browse... button to locate a path:</li>
</ol>
<div><img class="alignnone size-full wp-image-699 image-border" src="img/b3f541e2-3dad-4fa8-8bc3-2655eb663fe3.png" style="width:155.75em;height:26.58em;"/></div>
<ol start="5">
<li>Click OK.</li>
<li>Now, your Solution Explorer (<em>Ctrl</em> + <em>Alt</em> + <em>L</em>) should look like this:</li>
</ol>
<div><img class="alignnone size-full wp-image-700 image-border" src="img/a0b6f493-e522-49cc-ab25-9f4ed0466b0f.png" style="width:57.75em;height:17.67em;"/></div>
<ol start="7">
<li>Now, right-click on the <kbd>Chapter4.Tuples</kbd> label in the Solution Explorer and select Add | New Project<strong>.</strong></li>
<li>In the New Project dialog box, expand the Visual C# node.</li>
</ol>
<ol start="9">
<li>Select .NET Standard in the left-hand pane and Class Library (.NET Standard) in the right-hand pane:</li>
</ol>
<div><img class="alignnone size-full wp-image-701 image-border" src="img/4199963e-871c-4e27-9ecb-2c051bc3afe5.png" style="width:156.33em;height:107.83em;"/></div>
<ol start="10">
<li>Now, in the Name: textbox, type <kbd>Chapter4.Tuples.TupleLib</kbd>, leave the other defaults as they are, and click OK:</li>
</ol>
<div><img class="alignnone size-full wp-image-702 image-border" src="img/713fc22a-2a69-4810-8385-71c507b1579e.png" style="width:155.25em;height:13.58em;"/></div>
<ol start="11">
<li>Now, the Solution Explorer (<em>Ctrl</em> + <em>Alt</em> + <em>L</em>) should look like this:</li>
</ol>
<div><img class="alignnone size-full wp-image-703 image-border" src="img/9024199f-b49e-48c8-933a-9d4f7cf03449.png" style="width:26.67em;height:12.08em;"/></div>
<ol start="12">
<li>Now, select <kbd>Class1.cs</kbd> in the Solution Explorer and press <em>F2</em> to rename the file <kbd>Employee.cs</kbd>.</li>
<li>Answer Yes in the confirmation dialog box that asks to rename the class name as well.</li>
<li>Now, double-click on the <kbd>Employee.cs</kbd> label in the Solution Explorer.</li>
<li>In the code window, add the following code in between the curly brackets of the <kbd>Employee</kbd> class:</li>
</ol>
<pre>      public (string, string, int) GetBasicDetails()<br/>      {<br/><br/>          string firstName = "Fiqri";<br/>          string lastName = "Ismail";<br/>          int experience = 15;<br/><br/>          return (firstName, lastName, experience);<br/>      }</pre>
<ol start="16">
<li> Press <em>Ctrl</em> + <em>Shift</em> + <em>B</em> for a quick build to check syntax.</li>
</ol>


            

            
        
    

        

                            
                    <h1 class="header-title">How it works...</h1>
                
            
            
                
<p>We have created a blank solution in steps 1 to 5 and assigned it a proper name. In steps 6 to 10, we added a new project to the solution. We selected a .NET Standard 2.0 library template as the starting point of the project and then we gave it a proper name. In steps 11 and 12, we renamed the default <kbd>Class1.cs</kbd> to something more meaningful. This class was generated from the template itself. You can rename it or you can delete that file and add a new one.</p>
<p>In step 15, we created a method that returns two string types and an integer type. This was possible because of tuples. In that method, we assigned the variables and returned them in a sequence to match the return type of the method. Finally, we performed a quick build to confirm the syntax was correct.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Creating a Razor Pages web application to use the library</h1>
                
            
            
                
<p>In this recipe, we will be building a Razor Pages web application to use the .NET Standard 2.0 library created in the previous recipe. A Razor Pages web application is a slimmer version of the MVC framework. You can tell it's the successor to good old <kbd>.aspx</kbd> web form pages. This was an addition after .NET Core 2.0.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>Make sure you have the latest version of Visual Studio 2017 and .NET Core 2.0 installed, and that you have access to the solution we built in the previous recipe. Do a quick <em>Ctrl</em> + <em>Shift</em> + <em>B</em> to check that everything is intact and working.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<ol>
<li>Open Visual Studio 2017.</li>
<li>Now open the solution that we built from the previous recipe.</li>
<li>The Solution Explorer should look like this:</li>
</ol>
<div><img class="alignnone size-full wp-image-704 image-border" src="img/f677fce4-2d25-4260-ba5a-e2a40a112821.png" style="width:24.00em;height:10.83em;"/></div>
<ol start="4">
<li>Press <em>Ctrl</em> + <em>Shift</em> + <em>B</em> for a quick build to check the syntax.</li>
<li>Now, let's select the solution name and right-click.</li>
<li>From the menu, select Add | New Project.</li>
<li>In the New Project dialog box, expand the Visual C# node and select .NET Core in the left-hand pane.</li>
<li>In the right-hand pane, select ASP.NET Core Web Application:</li>
</ol>
<div><img class="alignnone size-full wp-image-705 image-border" src="img/940630cc-e081-43c9-94c6-7084983d27b4.png" style="width:156.58em;height:108.33em;"/></div>
<ol start="9">
<li>In the Name: textbox, type <kbd>Chapter4.Tuples.CoreRazorWebApp</kbd> and leave the defaults as they are:</li>
</ol>
<div><img class="alignnone size-full wp-image-706 image-border" src="img/791921f9-dd98-4170-8a0a-3c7e07320a1a.png" style="width:155.17em;height:14.17em;"/></div>
<ol start="10">
<li>Click OK.</li>
<li>Now, in the New ASP.NET Core Web Application dialog box, select Web Application in the templates list (make sure you have selected .NET Core and ASP.NET Core 2.0 from the drop-down lists):</li>
</ol>
<div><img class="alignnone size-full wp-image-707 image-border" src="img/eb316942-5828-433f-aa7e-03f81bc732e7.png" style="width:130.08em;height:84.58em;"/></div>
<ol start="12">
<li>Leave the defaults as they are and click OK.</li>
</ol>
<ol start="13">
<li>Now, the Solution Explorer should look like this:</li>
</ol>
<div><img class="alignnone size-full wp-image-708 image-border" src="img/33848027-4921-43ca-8d71-f61081f360ff.png" style="width:24.25em;height:24.00em;"/></div>
<ol start="14">
<li>Now, select the <kbd>Chapter4.Tuples.CoreRazorWebApp</kbd> label in the Solution Explorer.</li>
<li>Right-click on the Dependencies label and select Add Reference.</li>
<li>In the Reference Manager dialog box, in the left-hand pane, select Projects.</li>
<li>In the right-hand pane, check <kbd>Chapter4.Tuples.TupleLib</kbd> in the list:</li>
</ol>
<div><img class="alignnone size-full wp-image-709 image-border" src="img/8c62794d-fde2-4e3a-8ef8-5c026df1824b.png" style="width:130.92em;height:49.25em;"/></div>
<ol start="18">
<li>Click OK.</li>
<li>Now expand the Pages node.</li>
<li>Right-click on the Pages label and select Add | Razor Page.</li>
<li>In the Add Scaffold dialog box, select Razor Page from the template list:</li>
</ol>
<div><img class="alignnone size-full wp-image-710 image-border" src="img/1435bdca-0a84-43b6-bf2d-206ee1831830.png" style="width:43.42em;height:21.42em;"/></div>
<ol start="22">
<li>Click Add.</li>
<li>In the Add Razor Page dialog box, type <kbd>Employee</kbd> in the Razor Page name: textbox:</li>
</ol>
<div><img class="alignnone size-full wp-image-711 image-border" src="img/ef52928d-995f-4e16-ace1-09270ddd2f0a.png" style="width:33.75em;height:16.75em;"/></div>
<ol start="24">
<li>Click Add.</li>
<li>By default, Visual Studio will present you with the <kbd>Employee.chtml.cs</kbd> file. If not, you can always expand the node for the <kbd>Employee.chtml</kbd> file and double-click on the <kbd>Employee.chtml.cs</kbd> label.</li>
<li>Now scroll up till you reach the <kbd>using</kbd> directives.</li>
<li>At the end of the <kbd>using</kbd> directive, add the reference to our library:</li>
</ol>
<pre>      using Chapter4.Tuples.TupleLib;</pre>
<ol start="28">
<li>Now scroll down till you reach the <kbd>OnGet()</kbd> method.</li>
<li>Add the following code in between the curly brackets of the <kbd>OnGet()</kbd> method:</li>
</ol>
<pre>      var employee = new Employee();<br/><br/>      (string FirstName, string LastName, int YearsOfExperience) <br/>          newEmployee = employee.GetBasicDetails();<br/><br/>      ViewData["FirstName"] = newEmployee.FirstName;<br/>      ViewData["LastName"] = newEmployee.LastName;<br/>      ViewData["YearsOfExperience "] = newEmployee.YearsOfExperience;</pre>
<ol start="30">
<li>Now click on the <kbd>Employee.cshtml</kbd> tab to enter the Razor Page.</li>
<li>Add the following code at the end of the page:</li>
</ol>
<pre>      &lt;p&gt;<br/>          &lt;h2&gt;@ViewData["FirstName"] @ViewData["LastName"]&lt;/h2&gt; <br/>          &lt;h3&gt;(@ViewData["YearsOfExperience "] years of experience)<br/>          &lt;/h3&gt;<br/>      &lt;/p&gt;</pre>
<ol start="32">
<li>Now save your work.</li>
<li>Press <em>F5</em> to execute the application.</li>
</ol>
<ol start="34">
<li>The browser will display the default index page as follows:</li>
</ol>
<div><img class="alignnone size-full wp-image-712 image-border" src="img/98dd83f3-b9a9-4229-b777-546628725f0a.png" style="width:125.00em;height:96.83em;"/></div>
<ol start="35">
<li>Click on the address bar. At the end of the URL, type <kbd>Employee</kbd> and press <em>Enter</em>. (The entire URL should look like this: <kbd>localhost:&lt;yourportnumber&gt;/Employee</kbd>):</li>
</ol>
<div><img class="alignnone size-full wp-image-713 image-border" src="img/f46c6a0f-6d6f-4235-9da7-1a7b058df6cd.png" style="width:150.00em;height:47.33em;"/></div>
<ol start="36">
<li>Now close the browser.</li>
</ol>


            

            
        
    

        

                            
                    <h1 class="header-title">How it works...</h1>
                
            
            
                
<p>In steps 1 to 5, we opened the solution from the previous recipe. We also performed a quick build to check for syntax. Then, in steps 6 to 13, we added an ASP.NET Core Web application to the solution. In steps 14 to 16, we added the reference to the library we built in the previous recipe. This will allow you to use the available functionality from the library in your ASP.NET Core Web application project.</p>
<p>In steps 20 to 24, we added a new Razor Page to the project. A Razor Page contains two files. One is a <kbd>.chtml</kbd> file, which contains the look and feel, and the other file contains the code for that Razor file. This is similar to an <kbd>.aspx</kbd> page and the code behind the file in an ASP.NET Web Forms application.</p>
<p>In step 27, we added reference code to our library. Then, in step 29, we added code to use the functionality from the library. In the first line of code, we created an instance of the <kbd>Employee</kbd> class and stored it in a variable. Then, in the second line, we used the <kbd>GetBasicDetails()</kbd> method to access employee details using tuples. Finally, we stored those values in the <kbd>ViewData</kbd> helper class.</p>
<p>In step 31, we used the <kbd>ViewData</kbd> helper class to display the values to the user. In this step, we used HTML markup and Razor syntax to display the information. Finally, in steps 33 to 36, we executed the application and tested it in the default browser.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Creating a .NET Standard 2.0 library that uses delegates and lambda expressions</h1>
                
            
            
                
<p>In this recipe, we will be using another functionality available in C#. These are called delegates and lambda expressions. What is a delegate in C#? As per the Microsoft documentation, it says:</p>
<p><q>"A delegate is a type that represents references to methods with a particular parameter list and return type."</q></p>
<p>Simply put, delegates are used to pass methods as arguments to other methods, and a lambda expression is an anonymous function that you can use to create delegates or expression tree types.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>Make sure Visual Studio 2017 is installed and updated to the latest version.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<ol>
<li>Open Visual Studio 2017.</li>
<li>Click File | New | Project<strong> </strong>to create a project. </li>
<li>In the New Project dialog box, expand the Other Project Types node in the left-hand pane and select Visual Studio Solutions. In the right-hand pane, select Blank Solution<strong>.</strong></li>
<li>In the Name: textbox, type <kbd>Chapter4.Delegates</kbd> and, in the Location: textbox, select a path from the drop-down box or click on the Browse... button to locate a path:</li>
</ol>
<div><img src="img/8313c0ba-8270-4ed8-9d1f-3fdca77f9032.png"/></div>
<ol start="5">
<li>Click OK.</li>
</ol>
<ol start="6">
<li>Now, your Solution Explorer (<em>Ctrl</em> + <em>Alt</em> + <em>L</em>) should look like this:</li>
</ol>
<div><img class="alignnone size-full wp-image-714 image-border" src="img/1eb9e934-c032-4e77-8d90-877fc8e64800.png" style="width:28.17em;height:8.25em;"/></div>
<ol start="7">
<li>Now, right-click on the <kbd>Chapter4.Delegates</kbd> label in the Solution Explorer and select Add | New Project<strong>.</strong></li>
<li>In the New Project dialog box, expand the Visual C# node.</li>
<li>Select .NET Standard in the left-hand pane and Class Library (.NET Standard) in the right-hand pane:</li>
</ol>
<div><img src="img/0cd7d6ae-bd4f-4923-a150-b2725bfc2577.png" style="width:74.00em;height:51.33em;"/></div>
<ol start="10">
<li>Now, in the Name: textbox, type <kbd>Chapter4.Delegates.DelegateLib</kbd>. Leave the other defaults as they are and click OK:</li>
</ol>
<div><img src="img/d14e3acc-9a71-44bf-b314-0770de567fd8.png"/></div>
<ol start="11">
<li>Now, the Solution Explorer (<em>Ctrl</em> + <em>Alt</em> + <em>L</em>) should look like this:</li>
</ol>
<div><img class="alignnone size-full wp-image-715 image-border" src="img/cba687dc-513d-47fd-8a5f-ca424807dd5b.png" style="width:28.58em;height:12.83em;"/></div>
<ol start="12">
<li>Now, select <kbd>Class1.cs</kbd> in the Solution Explorer and press <em>F2</em> to rename the file <kbd>Calculator.cs</kbd>.</li>
<li>Answer Yes in the confirmation dialog box that asks to rename the class name as well.</li>
<li>Now, select the <kbd>Calculators.cs</kbd> label and double-click on it to open the code window.</li>
<li>Add the following <kbd>using</kbd> directive to the top of the code:</li>
</ol>
<pre>      using System.Linq;</pre>
<ol start="16">
<li>Now, scroll down in between the curly brackets of the <kbd>Calculator</kbd> class and add the following code:</li>
</ol>
<pre>      public delegate string Message(string msg);<br/>      public string AddTwoNumbers(int n1, int n2, Message msg)<br/>      {<br/>          return msg($"The answer is : {n1 + n2}");<br/>      }</pre>
<ol start="17">
<li>Now, next to the end curly bracket of the <kbd>AddTwoNumbers()</kbd> method, add the following code:</li>
</ol>
<pre>      public string CountScoresMoreThan80(int[] scores)<br/>      {<br/>          var count = scores.Where(s =&gt; s &gt; 80).Count();<br/><br/>          return $"There are {count} scores more than 80";<br/>      }</pre>
<ol start="18">
<li>Perform a quick build by pressing <em>Ctrl</em> + <em>Shift</em> + <em>B</em> and confirm that all the syntax is correct.</li>
</ol>


            

            
        
    

        

                            
                    <h1 class="header-title">How it works...</h1>
                
            
            
                
<p>We created a blank solution in steps 1 to 5. In steps 7 to 10, we added a .NET Standard 2.0 Class Library project to the solution. We have given a meaningful name to the project in these steps. We renamed the default class name generated from the template in steps 12 and 13. We added a <kbd>using</kbd> statement for LINQ in step 14. This is necessary to explain the lambda expressions using LINQ.</p>
<p>In step 16, we added code to create a delegate and a method to use that delegate as a parameter. The delegate <kbd>Message</kbd> takes a parameter as a <kbd>string</kbd> and returns the output as a <kbd>string</kbd>. Then, we added a method to add two numbers and return the answer as a string with a message. As you can see, there are three parameters for the <kbd>AddTwoNumbers()</kbd> method. The first two are integers and the last parameter is the delegate we created.</p>
<p>In step 17, we created another method to count the occurrences of numbers in an array of integers. In the first line of the <kbd>CountScoresMoreThan80()</kbd> method, we used the <kbd>Where()</kbd> method that comes with LINQ. Inside the <kbd>Where()</kbd> method, we used a lambda expression to check for numbers that are greater than <kbd>80</kbd>. We then used the <kbd>Count()</kbd> method to count the occurrences filtered with the <kbd>Where()</kbd> method and returned the answer as a <kbd>string</kbd>. </p>
<p>Finally, we performed a quick build to confirm the syntax is correct.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Creating a .NET console application to use the library</h1>
                
            
            
                
<p>In this recipe, we will be building a .NET console-based application to test our library. We will be using the full .NET Framework, which is available for Windows only.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>Make sure you have located the solution built in the previous recipe and done a quick <em>Ctrl</em> + <em>Shift</em> + <em>B</em> to build the solution. We are all set to test the library, so let's get started.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<ol>
<li>Open Visual Studio 2017.</li>
<li>Now, open the solution that we built from the previous recipe.</li>
<li>The Solution Explorer should look like this:</li>
</ol>
<div><img class="alignnone size-full wp-image-716 image-border" src="img/0b218e00-6639-45a5-b2ff-4fd982785b19.png" style="width:26.92em;height:12.33em;"/></div>
<ol start="4">
<li>Press <em>Ctrl</em> + <em>Shift</em> + <em>B</em> for a quick build to check the syntax.</li>
<li>Now, let's select the solution name and right-click.</li>
<li>From the menu, select Add | New Project.</li>
<li>In the New Project dialog box, expand the Visual C# node and select Windows Classic Desktop in the left-hand pane.</li>
</ol>
<ol start="8">
<li>In the right-hand pane, select Console App (.NET Framework):</li>
</ol>
<div><img class="alignnone size-full wp-image-717 image-border" src="img/743786fa-77b3-4bdd-85bd-97ee65353f39.png" style="width:156.33em;height:108.33em;"/></div>
<ol start="9">
<li>In the Name: textbox, type <kbd>Chapter4.Delegates.ConsoleApp</kbd> and leave the defaults as they are:</li>
</ol>
<div><img class="alignnone size-full wp-image-718 image-border" src="img/ce9e1137-9891-4f69-96b3-4b61e53ade81.png" style="width:155.50em;height:14.50em;"/></div>
<ol start="10">
<li>Now, the Solution Explorer should look like this:</li>
</ol>
<div><img class="alignnone size-full wp-image-719 image-border" src="img/02bd0871-6722-47ce-97e7-19e2ad2ac6d7.png" style="width:25.00em;height:17.83em;"/></div>
<ol start="11">
<li>Now, select the <kbd>Chapter4.Delegates.ConsoleApp</kbd> label in the Solution Explorer.</li>
<li>Right-click on the References label and select Add Reference.</li>
<li>In the Reference Manager dialog box, in the left-hand pane, select Projects.</li>
<li>In the right-hand pane, check <kbd>Chapter4.Delegates.DelegateLib</kbd> in the list:</li>
</ol>
<div><img class="alignnone size-full wp-image-720 image-border" src="img/c94b548e-792e-44b6-9605-615a3a386bdb.png" style="width:50.67em;height:21.00em;"/></div>
<ol start="15">
<li>Click OK.</li>
<li>Now double-click on the <kbd>Program.cs</kbd> label to open the code window.</li>
<li>In the code window, scroll up till you see the <kbd>using</kbd> directives.</li>
<li>Add the following <kbd>using</kbd> directive at the end of all the <kbd>using</kbd> directives:</li>
</ol>
<pre>      using Chapter4.Delegates.DelegateLib;</pre>
<ol start="19">
<li>Now, next to the end curly bracket of the <kbd>Main()</kbd> method, add the following code:</li>
</ol>
<pre>      static string DelegateMessage(string msg)<br/>      {<br/>          return msg;<br/>      }</pre>
<ol start="20">
<li>Now, scroll down to the <kbd>Main()</kbd> method and add the following code in between the curly brackets of the <kbd>Main()</kbd> method:</li>
</ol>
<pre>      var calculator = new Calculator();<br/><br/>      Calculator.Message message = DelegateMessage;<br/>      Console.WriteLine(calculator.AddTwoNumbers(10, 20, message));<br/><br/>      int[] scores = new int[] { 10, 90, 50, 85, 30, 100, 45, 60 };<br/>      Console.WriteLine(calculator.CountScoresMoreThan80(scores));<br/><br/>      Console.ReadLine();</pre>
<ol start="21">
<li>Let's press <em>F5</em> to execute the program.</li>
<li>You should see output similar to this:</li>
</ol>
<div><img class="alignnone size-full wp-image-721 image-border" src="img/b1c6b6d1-9842-4c3e-8877-31bf3a43aa82.png" style="width:98.33em;height:11.08em;"/></div>
<ol start="23">
<li>Press <em>Enter</em> to close the console window.</li>
</ol>


            

            
        
    

        

                            
                    <h1 class="header-title">How it works...</h1>
                
            
            
                
<p>In steps 1 to 5, we opened the solution from the previous recipe and perform a quick build. This will make sure the code syntax is correct. If the build fails, you might have to check for any typos and correct them. This is always a good practice to make sure your code builds successfully before you close a solution or send it to source control. In steps 6 to 10, we added a new project to the solution. We have selected a console application template, which supports the full .NET Framework under Windows.</p>
<p>Then, in steps 12 to 15, we added the reference to the .NET Standard 2.0 library from our console application. This will allow you to access all the available functionality in the library for the console application. In step 18, we added the reference to the library. We have used a <kbd>using</kbd> statement for it. Then, in step 19, we added a method to use with the delegate in the library.</p>
<p>In step 20, in the first line, we created an instance of the Calculator class and stored it in a variable, and then, in the second line, used the delegate inside the class and assigned it from the method created in step 19. Then, we used the <kbd>AddTwoNumbers()</kbd> method with two integer values and the delegate variable as the parameters and printed the output to the console window. In the fourth line, we created an integer array, stored a few values, used the <kbd>CountScoresMoreThan80()</kbd> method, passed the integer array as the parameter, and printed the output to the console.</p>
<p>Finally, in steps 21 and 22, we executed the code and checked the output.</p>


            

            
        
    </body></html>