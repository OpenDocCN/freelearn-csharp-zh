<html><head></head><body>
		<div id="_idContainer595">
			<p><a id="_idTextAnchor201"/></p>
			<h1 id="_idParaDest-196"><em class="italic"><a id="_idTextAnchor202"/>Chapter 11</em>: Working with Microsoft Game Dev, Azure Cloud, PlayFab, and Unity</h1>
			<p>This is the last chapter of this book. In the previous chapters, we have learned about the various modules that can be used to develop games with the Unity engine, such as the UI module, the physics module, and the animation module, and also covered some advanced topics – for example, Unity's rendering pipelines and the new Data-Oriented Technology Stack. Also, in <a href="B17146_10_Final_ASB_ePub.xhtml#_idTextAnchor181"><em class="italic">Chapter 10</em></a>, <em class="italic">Serialization System and Assets Management in Unity and Azure</em>, we not only discussed Unity's serialization system and assets management but also covered some knowledge related to Microsoft Azure Cloud. </p>
			<p>This chapter will continue to explore <strong class="bold">Microsoft Game Dev</strong> (previously known as Microsoft Game Stack), the <strong class="bold">Microsoft Azure cloud</strong>, and <strong class="bold">Microsoft Azure PlayFab</strong> because the tools needed in modern game development are not limited to game engines; other tools and services such as the cloud are increasingly used in game development.</p>
			<p>The following key topics will be included in our learning path:</p>
			<ul>
				<li>Introducing Microsoft Game Dev, Microsoft Azure Cloud, and Azure PlayFab</li>
				<li><a id="_idTextAnchor203"/>Setting up Azure PlayFab for a Unity project</li>
				<li>Signing up and logging in players using Azure PlayFab in Unity</li>
				<li>Implementing a leaderboard using Azure PlayFab in Unity</li>
			</ul>
			<p>By the end of this chapter, you will understand what Microsoft Game Dev, Microsoft Azure Cloud, and Microsoft Azure PlayFab are and how to set up Azure PlayFab in a Unity project and use Azure PlayFab's API to implement registration, login, and leaderboard functions in Unity.</p>
			<p>Sounds exciting! Now, let's get started!</p>
			<h1 id="_idParaDest-197"><a id="_idTextAnchor204"/>Technical requirements  </h1>
			<p>You can find the example project that will be used in this chapter, namely <strong class="source-inline">Chapter11-AzurePlayFabAndUnity</strong>, in the following GitHub repository: <a href="https://github.com/PacktPublishing/Game-Development-with-Unity-for-.NET-Developers">https://github.com/PacktPublishing/Game-Development-with-Unity-for-.NET-Developers</a>. </p>
			<h1 id="_idParaDest-198"><a id="_idTextAnchor205"/>Introducing Microsoft Game Dev, Microsoft Azure Cloud, and Azure PlayFab</h1>
			<p>We have learned how to use the Unity engine to develop games. However, modern game development requires not only game engines but also other tools, such as cloud services. </p>
			<h2 id="_idParaDest-199"><a id="_idTextAnchor206"/>Microsoft Game Dev</h2>
			<p>In 2019, Microsoft announced <a id="_idIndexMarker981"/>Microsoft Game Stack, now known as Microsoft Game Dev, which aims to provide game developers with the tools and services they need to easily create and operate games:</p>
			<div>
				<div id="_idContainer549" class="IMG---Figure">
					<img src="image/Figure_11.01_B17146.jpg" alt="Figure 11.1 – Microsoft Game Dev products (from the Game Dev website)&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.1 – Microsoft Game Dev products (from the Game Dev website)</p>
			<p>These tools and services in <a id="_idIndexMarker982"/>Microsoft Game Dev include not only DirectX, Visual Studio, Xbox Services, App Center, and Havok, which are commonly used by game developers to complete game development and content creation, but also cloud-based services such as Microsoft Azure Cloud and Azure PlayFab, which all come together to form a powerful ecosystem that every game developer can use, as shown in <em class="italic">Figure 11.1</em>.</p>
			<p>The Microsoft Azure cloud<a id="_idIndexMarker983"/> and Azure PlayFab are important parts of Microsoft Game Dev. Not only are more and <a id="_idIndexMarker984"/>more modern games requiring multiplayer support but it is also becoming more common for single-player games to store player data in the cloud. Therefore, the cloud is becoming more and more important in game development. </p>
			<p>At the Game Developers Conference in March 2022, Microsoft announced a new program, <strong class="bold">ID@Azure</strong>, designed <a id="_idIndexMarker985"/>to help game developers develop games using the Microsoft Azure cloud and Azure PlayFab services. Any game developer can apply to join the program, whether they are an independent game developer or a game studio. After joining the program, you can get up to $5,000 in Azure credits, so you can access many cloud services, get a free Azure PlayFab Standard Plan, get expert support, and so on. </p>
			<p class="callout-heading">Note</p>
			<p class="callout">If you are interested in the<a id="_idIndexMarker986"/> ID@Azure program, you can find more information at <a href="https://aka.ms/idazure">https://aka.ms/idazure</a>.</p>
			<p>Now that you have an understanding of what Microsoft Game Dev is, let's move on to exploring what the Microsoft Azure cloud and Azure PlayFab are.</p>
			<h2 id="_idParaDest-200"><a id="_idTextAnchor207"/>Microsoft Azure Cloud</h2>
			<p>Microsoft Azure is a <a id="_idIndexMarker987"/>cloud computing service platform where you can find the following services:</p>
			<ul>
				<li><strong class="bold">Cloud computing</strong> services, such <a id="_idIndexMarker988"/>as Azure App Service, Azure Functions, and Azure Virtual Machines</li>
				<li><strong class="bold">Database</strong> services, such<a id="_idIndexMarker989"/> as Cosmos DB, Azure SQL Database, and Azure Cache for Redis</li>
				<li><strong class="bold">Storage</strong> services, such <a id="_idIndexMarker990"/>as an Azure Storage account and Data Lake Storage</li>
				<li><strong class="bold">Networking</strong> services, such <a id="_idIndexMarker991"/>as Azure Application Gateway, Azure Firewall, and Azure Load Balancer</li>
				<li><strong class="bold">Analytics</strong> services, such<a id="_idIndexMarker992"/> as Azure Data Factory and Azure Synapse Analytics</li>
				<li><strong class="bold">Security</strong> services, such <a id="_idIndexMarker993"/>as Azure Defender and Azure DDoS Protection</li>
				<li><strong class="bold">AI</strong> services, such as <a id="_idIndexMarker994"/>Azure Cognitive Services and Azure Bot Service</li>
			</ul>
			<p>In the game industry, game servers are usually deployed in data centers as close as possible to players, which not only reduces network latency but also meets data sovereignty requirements in certain countries and regions:</p>
			<div>
				<div id="_idContainer550" class="IMG---Figure">
					<img src="image/Figure_11.02_B17146.jpg" alt="Figure 11.2 – The Microsoft Azure global infrastructure&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.2 – The Microsoft Azure global infrastructure</p>
			<p>According to data from Microsoft, the Microsoft Azure cloud covers 140 countries and regions around the world, and the number of available areas is more than any other cloud platform. The huge global coverage helps game developers quickly deploy game services for target countries or regions.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">You can find more information about the <a id="_idIndexMarker995"/>Microsoft Azure Global Infrastructure at <a href="https://infrastructuremap.microsoft.com/explore">https://infrastructuremap.microsoft.com/explore</a>.</p>
			<p>In addition to using Azure data centers to host games, game developers can also develop games using Azure virtual machines on the Microsoft Azure cloud. A new Azure Game Development Virtual Machine was announced at the Game Developers Conference in March 2022, which is customized for game developers and pre-installed with tools such as the Microsoft Game Development Kit, Visual Studio 2019 Community Edition, and Blender to enable game production on the cloud.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">If you are interested in the <a id="_idIndexMarker996"/>Azure Game Development Virtual Machine, you can find more information at <a href="https://aka.ms/gamedevvmdocs">https://aka.ms/gamedevvmdocs</a>.</p>
			<h2 id="_idParaDest-201"><a id="_idTextAnchor208"/>Azure PlayFab</h2>
			<p>PlayFab is a complete<a id="_idIndexMarker997"/> backend service for building and operating real-time games. In early 2018, Microsoft acquired PlayFab. Now, PlayFab has joined the Azure family and changed its name to Azure PlayFab, becoming a part of Azure. Azure PlayFab combines the Azure cloud with PlayFab; the Azure cloud brings reliability, global-scale accessibility, and enterprise-grade security, while PlayFab provides game developers with a complete game backend service.</p>
			<p>As a complete backend service solution, Azure PlayFab mainly provides the following functions for<a id="_idIndexMarker998"/> game developers to develop games:</p>
			<ul>
				<li>Built-in authentication that game developers can use to enable player registration, login, and even track players across devices</li>
				<li>The ability to create dynamically scaled multiplayer servers and manage player data on the cloud</li>
				<li>The ability to easily implement a leaderboard on the backend server<p class="callout-heading">Note</p><p class="callout">Azure PlayFab also provides other <a id="_idIndexMarker999"/>services for maintaining and operating games, such as <strong class="bold">Liveops</strong> (short for <strong class="bold">Live Operations</strong>) and data analytics services, which can be used to manage game content, such as making updates to a game without releasing a new version, and reporting and analyzing game data daily. They are beyond what we need here, but if you're interested, you can find out more at <a href="https://docs.microsoft.com/en-us/gaming/playfab">https://docs.microsoft.com/en-us/gaming/playfab</a>.</p></li>
			</ul>
			<p>In the rest of this chapter, we will integrate Azure PlayFab into a Unity project to implement player registration, login, data saving, loading, and a leaderboard. </p>
			<p>Let's move on!</p>
			<h1 id="_idParaDest-202"><a id="_idTextAnchor209"/>Setting up Azure PlayFab for a Unity project</h1>
			<p>In <a id="_idIndexMarker1000"/>this example, we will add player registration, login, data saving, loading, and <a id="_idIndexMarker1001"/>leaderboard functions to a <em class="italic">Flappy Bird</em>-style game in Unity:</p>
			<div>
				<div id="_idContainer551" class="IMG---Figure">
					<img src="image/Figure_11.03_B17146.jpg" alt="Figure 11.3 – The Unity project&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.3 – The Unity project</p>
			<p>Next, we will first create a new Azure PlayFab account, set up a game studio and a game title in Azure PlayFab, and then set up the Azure PlayFab SDK in this Unity project.</p>
			<h2 id="_idParaDest-203"><a id="_idTextAnchor210"/>Creating a new Azure PlayFab account</h2>
			<p>First of all, we<a id="_idIndexMarker1002"/> need a new Azure PlayFab account. To create a new Azure Playfab account, let's perform the following steps:</p>
			<ol>
				<li>Visit the home page of Microsoft <a id="_idIndexMarker1003"/>Azure PlayFab at <a href="https://playfab.com/">https://playfab.com/</a> and click the <strong class="bold">SIGN UP</strong> button at the upper-right corner to open the sign-up page:</li>
			</ol>
			<div>
				<div id="_idContainer552" class="IMG---Figure">
					<img src="image/Figure_11.04_B17146.jpg" alt="Figure 11.4 – The home page of Azure PlayFab&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.4 – The home page of Azure PlayFab</p>
			<ol>
				<li value="2">Enter your<a id="_idIndexMarker1004"/> email address and password on the sign-up page and click the <strong class="bold">Create a free account</strong> button:</li>
			</ol>
			<div>
				<div id="_idContainer553" class="IMG---Figure">
					<img src="image/Figure_11.05_B17146.jpg" alt="Figure 11.5 – Creating a free account&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.5 – Creating a free account</p>
			<ol>
				<li value="3">You will then receive a verification email from Azure PlayFab to verify your email address; click <strong class="bold">VERIFY YOUR EMAIL ADDRESS</strong>:</li>
			</ol>
			<div>
				<div id="_idContainer554" class="IMG---Figure">
					<img src="image/Figure_11.06_B17146.jpg" alt="Figure 11.6 – An email address verification from Azure PlayFab&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.6 – An email address verification from Azure PlayFab</p>
			<ol>
				<li value="4">After the email <a id="_idIndexMarker1005"/>address verification is complete, you can log in with the Azure PlayFab account you just created, and you can see your game studio and a game title already set up in the Azure PlayFab developer portal, also known as <strong class="bold">Game Manager</strong> in Azure PlayFab:</li>
			</ol>
			<div>
				<div id="_idContainer555" class="IMG---Figure">
					<img src="image/Figure_11.07_B17146.jpg" alt="Figure 11.7 – My Game Studio in Azure PlayFab&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.7 – My Game Studio in Azure PlayFab</p>
			<p>Now that we have created a new Azure PlayFab account, we can start looking at how to set up a game studio and a game title in Azure PlayFab.</p>
			<h2 id="_idParaDest-204"><a id="_idTextAnchor211"/>Setting up a game studio and a game title in Azure PlayFab</h2>
			<p>After <a id="_idIndexMarker1006"/>creating an <a id="_idIndexMarker1007"/>Azure PlayFab account, the next<a id="_idIndexMarker1008"/> task is to set up your<a id="_idIndexMarker1009"/> own game studio and game title:</p>
			<ol>
				<li value="1">The default game studio is called <strong class="bold">My Game Studio</strong>, which doesn't make much sense, so you can click <strong class="bold">...</strong> | <strong class="bold">Studio settings</strong> on the right to open the <strong class="bold">Edit Studio</strong> page: </li>
			</ol>
			<div>
				<div id="_idContainer556" class="IMG---Figure">
					<img src="image/Figure_11.08_B17146.jpg" alt=""/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.8 – Opening the Edit Studio page</p>
			<ol>
				<li value="2">On the <strong class="bold">Edit Studio</strong> page, change the game studio name to <strong class="source-inline">UnityBook</strong> and click the <strong class="bold">Save studio</strong> button to save:</li>
			</ol>
			<div>
				<div id="_idContainer557" class="IMG---Figure">
					<img src="image/Figure_11.09_B17146.jpg" alt="Figure 11.9 – Changing the studio name to UnityBook&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.9 – Changing the studio name to UnityBook</p>
			<ol>
				<li value="3">Similarly, the default game title is <strong class="bold">My Game</strong>, which also doesn't make much sense. As shown in the following figure, you can click the gear button and then <strong class="bold">Edit title info</strong> to open the <strong class="bold">Edit Title</strong> page:</li>
			</ol>
			<div>
				<div id="_idContainer558" class="IMG---Figure">
					<img src="image/Figure_11.10_B17146.jpg" alt="Figure 11.10 – Opening the Edit Title page&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.10 – Opening the Edit Title page</p>
			<ol>
				<li value="4">On<a id="_idIndexMarker1010"/> the <strong class="bold">Edit Title Information</strong> page, you can <a id="_idIndexMarker1011"/>set various information about<a id="_idIndexMarker1012"/> the title here, such as name, genre, and <a id="_idIndexMarker1013"/>player modes. Let's change the title name to <strong class="source-inline">Chapter11-AzurePlayfabAndUnity</strong> and click <strong class="bold">Save title</strong> to save:</li>
			</ol>
			<div>
				<div id="_idContainer559" class="IMG---Figure">
					<img src="image/Figure_11.11_B17146.jpg" alt="Figure 11.11 – Changing the title name &#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.11 – Changing the title name </p>
			<p>Now that we have set up a game studio and a game title in Azure PlayFab, let's turn our attention to setting up the Azure PlayFab SDK in the Unity project!</p>
			<h2 id="_idParaDest-205"><a id="_idTextAnchor212"/>Setting up the Azure PlayFab SDK in the Unity project</h2>
			<p>In <a id="_idIndexMarker1014"/>order to access the API in Azure PlayFab from <a id="_idIndexMarker1015"/>Unity, we need to import the Azure PlayFab SDK into the Unity project first:</p>
			<ol>
				<li value="1">You can find the Azure PlayFab SDK at <a href="https://docs.microsoft.com/en-us/gaming/playfab/sdks/unity3d/">https://docs.microsoft.com/en-us/gaming/playfab/sdks/unity3d/</a>. Here, you can also find the link to the Unity PlayFab SDK GitHub repository, as shown in <em class="italic">Figure 11.12</em>:</li>
			</ol>
			<div>
				<div id="_idContainer560" class="IMG---Figure">
					<img src="image/Figure_11.12_B17146.jpg" alt="Figure 11.12 – The Azure PlayFab SDK download links&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.12 – The Azure PlayFab SDK download links</p>
			<ol>
				<li value="2">Drag and drop the <strong class="source-inline">UnitySDK</strong> package you just downloaded into the Unity Editor. The <strong class="bold">Import Unity Package</strong> window will pop up, where you can preview the contents of the package, and then click the <strong class="bold">Import</strong> button to import it into this Unity project:</li>
			</ol>
			<div>
				<div id="_idContainer561" class="IMG---Figure">
					<img src="image/Figure_11.13_B17146.jpg" alt="Figure 11.13 – Importing the Azure PlayFab SDK&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.13 – Importing the Azure PlayFab SDK</p>
			<ol>
				<li value="3">Once the <a id="_idIndexMarker1016"/>SDK has been imported, you <a id="_idIndexMarker1017"/>will find the PlayFab menu in the Unity Editor toolbar. Then, you can click on <strong class="bold">PlayFab</strong> &gt; <strong class="bold">MakePlayFabSharedSettings</strong> to open the <strong class="bold">PlayFabSharedSettings</strong> window, where you need to configure settings to connect this Unity project to the game title in Azure PlayFab: </li>
			</ol>
			<div>
				<div id="_idContainer562" class="IMG---Figure">
					<img src="image/Figure_11.14_B17146.jpg" alt="Figure 11.14 – The PlayFab SDK has been imported&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.14 – The PlayFab SDK has been imported</p>
			<ol>
				<li value="4">In the <strong class="bold">Play Fab Shared Settings</strong> window, you should provide the game title ID and the developer secret key of your game title, as shown in <em class="italic">Figure 11.15</em>:    </li>
			</ol>
			<div>
				<div id="_idContainer563" class="IMG---Figure">
					<img src="image/Figure_11.15_B17146.jpg" alt="Figure 11.15 – The Play Fab Shared Settings window&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.15 – The Play Fab Shared Settings window</p>
			<ol>
				<li value="5">In order to <a id="_idIndexMarker1018"/>find out the game title ID <a id="_idIndexMarker1019"/>and the developer secret key, you need to go back to the developer portal of Azure PlayFab, where you can find the game title ID on the game title item:</li>
			</ol>
			<div>
				<div id="_idContainer564" class="IMG---Figure">
					<img src="image/Figure_11.16_B17146.jpg" alt="Figure 11.16 – The game title ID&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.16 – The game title ID</p>
			<ol>
				<li value="6">The developer secret key is tightly coupled to the game title in Azure PlayFab, so on the developer portal, you first need to click on the title item to open the overview page of the game title. As shown in the following figure, you need to click on the gear button and then click <strong class="bold">Title settings</strong> to open the settings page of the game title:</li>
			</ol>
			<div>
				<div id="_idContainer565" class="IMG---Figure">
					<img src="image/Figure_11.17_B17146.jpg" alt="Figure 11.17 – The Overview page of the game title&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.17 – The Overview page of the game title</p>
			<ol>
				<li value="7">In the <a id="_idIndexMarker1020"/>settings page of the game title, select<a id="_idIndexMarker1021"/> the <strong class="bold">Secret Keys</strong> tab to switch to the secret keys settings, where you can find the default developer secret key:</li>
			</ol>
			<div>
				<div id="_idContainer566" class="IMG---Figure">
					<img src="image/Figure_11.18_B17146.jpg" alt="Figure 11.18 – The Secret Keys page&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.18 – The Secret Keys page</p>
			<ol>
				<li value="8">Go back<a id="_idIndexMarker1022"/> to the <strong class="bold">Play Fab Shared Settings</strong> window<a id="_idIndexMarker1023"/> in Unity, and use the title ID and the developer secret key you just got from the Azure PlayFab developer portal to set the title ID and the developer secret key. </li>
			</ol>
			<p>Now that we have set up the Azure PlayFab SDK for this Unity project, you should now have an understanding of Azure PlayFab, including the Azure PlayFab developer portal, (which is also called Game Manager), how to set up a game studio and a game title, and how to import Azure PlayFab's SDK into a Unity project and connect the game title in Azure PlayFab to the project. Next, let's move on to exploring how to register and log in a player via Azure PlayFab.</p>
			<h1 id="_idParaDest-206"><a id="_idTextAnchor213"/>Signing up and logging in players using Azure PlayFab in Unity</h1>
			<p>In the demo project mentioned in the <em class="italic">Technical requirements</em> section, you can find the signup and login UI panel in <strong class="bold">AzurePlayFabIntegration folder</strong> | <strong class="bold">StartScene</strong>, which we will use to implement the signup and login functionality:</p>
			<div>
				<div id="_idContainer567" class="IMG---Figure">
					<img src="image/Figure_11.19_B17146.jpg" alt="Figure 11.19 – The signup tab (left) and the login tab (right) on the UI panel&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.19 – The signup tab (left) and the login tab (right) on the UI panel</p>
			<p>As shown in <em class="italic">Figure 11.19</em>, like many common signup and login pages, the signup and login UI panels in our example also have two tabs, namely the signup tab and the login tab, which can be switched by clicking the red reminder text on the panel. The signup tab requires the player to provide a username, email, and password to create a new player account in Azure PlayFab, while the login tab only requires the player to provide the email and password to log in.</p>
			<h2 id="_idParaDest-207"><a id="_idTextAnchor214"/>Signing up players in Azure PlayFab </h2>
			<p>Next, let's take <a id="_idIndexMarker1024"/>a look at how to implement the signup <a id="_idIndexMarker1025"/>function first:</p>
			<ol>
				<li value="1">Create a new folder in the <strong class="source-inline">AzurePlayFabIntegration</strong> folder and name it <strong class="source-inline">Scripts</strong>: </li>
			</ol>
			<div>
				<div id="_idContainer568" class="IMG---Figure">
					<img src="image/Figure_11.20_B17146.jpg" alt="Figure 11.20 – Creating a Scripts folder&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.20 – Creating a Scripts folder</p>
			<ol>
				<li value="2">Create a new C# script in the <strong class="source-inline">Scripts</strong> folder, name it <strong class="source-inline">AzurePlayFabAccountManager</strong>, and add the following code:<p class="source-code">using System.Text;</p><p class="source-code">using System.Security.Cryptography;</p><p class="source-code">using UnityEngine;</p><p class="source-code">using UnityEngine.UI;</p><p class="source-code">using PlayFab;</p><p class="source-code">using PlayFab.ClientModels;</p><p class="source-code">public class AzurePlayFabAccountManager :</p><p class="source-code">  MonoBehaviour</p><p class="source-code">{</p><p class="source-code">    [SerializeField]</p><p class="source-code">    private InputField _userName, _email, _password;</p><p class="source-code">    [SerializeField]</p><p class="source-code">    private Text _message;</p><p class="source-code">    public void OnSignUpButtonClick()</p><p class="source-code">    {</p><p class="source-code">        var userRequest = new</p><p class="source-code">          <strong class="bold">RegisterPlayFabUserRequest</strong></p><p class="source-code">        {</p><p class="source-code">            Username = _userName.text,</p><p class="source-code">            Email = _email.text,</p><p class="source-code">            Password = Encrypt(_password.text)</p><p class="source-code">        };</p><p class="source-code">        <strong class="bold">PlayFabClientAPI.RegisterPlayFabUser</strong>(userRequest,</p><p class="source-code">          OnRegisterSuccess, OnError);</p><p class="source-code">    }</p><p class="source-code">  public void</p><p class="source-code">   OnRegisterSuccess(RegisterPlayFabUserResult result)</p><p class="source-code">    {</p><p class="source-code">        _message.text = "created a new account!";</p><p class="source-code">        var displayNameRequest = new</p><p class="source-code">          UpdateUserTitleDisplayNameRequest</p><p class="source-code">        {</p><p class="source-code">            DisplayName = result.Username</p><p class="source-code">        };</p><p class="source-code">           PlayFabClientAPI.</p><p class="source-code">             UpdateUserTitleDisplayName(display</p><p class="source-code">             NameRequest, OnUpdateDisplayNameSuccess, </p><p class="source-code">             OnError);</p><p class="source-code">    }</p><p class="source-code">    public void OnError(PlayFabError error)</p><p class="source-code">    {</p><p class="source-code">        _message.text = error.ErrorMessage;</p><p class="source-code">    }</p><p class="source-code">    private static string Encrypt(string input)</p><p class="source-code">    {</p><p class="source-code">        var md5 = new MD5CryptoServiceProvider();</p><p class="source-code">        var bytes = Encoding.UTF8.GetBytes(input);</p><p class="source-code">        bytes = md5.ComputeHash(bytes);</p><p class="source-code">        return Encoding.UTF8.GetString(bytes);</p><p class="source-code">    }</p><p class="source-code">}</p></li>
			</ol>
			<p>This is quite a long script; let's break down the code as follows:</p>
			<ul>
				<li>We<a id="_idIndexMarker1026"/> add <strong class="source-inline">System.Security.Cryptography</strong> and the <strong class="source-inline">System.Text</strong> namespace <a id="_idIndexMarker1027"/>with the <strong class="source-inline">using</strong> keyword to encrypt the password in the <strong class="source-inline">Encrypt</strong> method.</li>
				<li>We add <strong class="source-inline">PlayFab</strong> and the <strong class="source-inline">PlayFab.ClientModels</strong> namespace with the <strong class="source-inline">using</strong> keyword to access the API that Azure PlayFab offers.</li>
				<li>In the <strong class="source-inline">fields</strong> section, we reference three <strong class="source-inline">InputField</strong> UI elements to provide the username, email address, and password. Also, we get a reference to the <strong class="source-inline">Text</strong> UI element to display the message from Azure PlayFab.</li>
				<li>We create a new instance of <strong class="source-inline">RegisterPlayFabUserRequest</strong> and call <strong class="source-inline">PlayFabClientAPI.RegisterPlayFabUser</strong> to register this user in Azure PlayFab.</li>
				<li>We also have two callbacks – <strong class="source-inline">OnRegisterSuccess</strong>, which is called when the result is received, and <strong class="source-inline">OnError</strong>, which is called when an error occurs. </li>
				<li>In <strong class="source-inline">OnRegisterSuccess</strong>, we create a new instance of <strong class="source-inline">UpdateUserTitleDisplayNameRequest</strong> and call  <strong class="source-inline">PlayFabClientAPI.UpdateUserTitleDisplayName</strong> to update the user's display name with the username at registration; otherwise, the user's display name is an empty string by default. Also, you can use this method to allow the user to change the account's display name in the future.</li>
			</ul>
			<ol>
				<li value="3">Drag and drop <strong class="source-inline">AzurePlayFabAccountManager.cs</strong> onto the <strong class="bold">SignupAndLogin</strong> GameObject in the scene, and assign the UI elements to the corresponding fields, as shown in <em class="italic">Figure 11.21</em>:</li>
			</ol>
			<div>
				<div id="_idContainer569" class="IMG---Figure">
					<img src="image/Figure_11.21_B17146.jpg" alt="Figure 11.21 – Setting up AzurePlayFabAccountManager&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.21 – Setting up AzurePlayFabAccountManager</p>
			<ol>
				<li value="4">Select <a id="_idIndexMarker1028"/>the <strong class="bold">Sign up and log in</strong> button in the UI panel<a id="_idIndexMarker1029"/> to open the <strong class="bold">Inspector</strong> window of this button. In the <strong class="bold">Inspector</strong> window, first, click the <strong class="bold">+</strong> button at the bottom of the <strong class="bold">On Click()</strong> section, then select the GameObject that <strong class="source-inline">AzurePlayFabAccountManager</strong> is attached to, and finally, select the method defined in the <strong class="source-inline">AzurePlayFabAccountManager</strong> class that will be called when the button is clicked, namely <strong class="source-inline">OnSignUpButtonClick</strong>, as shown in <em class="italic">Figure 11.22</em>:</li>
			</ol>
			<div>
				<div id="_idContainer570" class="IMG---Figure">
					<img src="image/Figure_11.22_B17146.jpg" alt=""/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.22 – Setting up the sign-up button</p>
			<ol>
				<li value="5">Run the game, and enter the username, email address, and password in the <strong class="bold">Sign up and login</strong> UI panel, and then click the <strong class="bold">Sign up and login</strong> button to send a <strong class="source-inline">register user</strong> request to Azure PlayFab. As shown in the following figure, a new account is created:</li>
			</ol>
			<div>
				<div id="_idContainer571" class="IMG---Figure">
					<img src="image/Figure_11.23_B17146.jpg" alt="Figure 11.23 – A new account is created&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.23 – A new account is created</p>
			<ol>
				<li value="6">Let's go <a id="_idIndexMarker1030"/>back to the dashboard of the game title in <a id="_idIndexMarker1031"/>Azure PlayFab. In the dashboard, you can see that there is a new API call and a new user has been created. Then, we can also click the <strong class="bold">Players</strong> button to open the <strong class="bold">Players</strong> page for more information:</li>
			</ol>
			<div>
				<div id="_idContainer572" class="IMG---Figure">
					<img src="image/Figure_11.24_B17146.jpg" alt="Figure 11.24 – The dashboard of the game title&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.24 – The dashboard of the game title</p>
			<ol>
				<li value="7">Take a look at the player list on the <strong class="bold">Players</strong> page; you can see the new account we just created. There is also some information about the account, such as the last login <a id="_idIndexMarker1032"/>time, the time the account was created, and <a id="_idIndexMarker1033"/>which country the player logged in from:</li>
			</ol>
			<div>
				<div id="_idContainer573" class="IMG---Figure">
					<img src="image/Figure_11.25_B17146.jpg" alt="Figure 11.25 – The Players page&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.25 – The Players page</p>
			<p>Now that we've implemented the registration function, it's time to implement the login function for the players who have accounts. </p>
			<h2 id="_idParaDest-208"><a id="_idTextAnchor215"/>Logging in players in Azure PlayFab</h2>
			<p>By taking the<a id="_idIndexMarker1034"/> following steps, we will require players to <a id="_idIndexMarker1035"/>provide an email and password to log in, and if the login is successful, they will jump to our <em class="italic">Flappy Bird</em>-style game scene:</p>
			<ol>
				<li value="1">Go back to the <strong class="source-inline">AzurePlayFabAccountManager</strong> script and add the following code:<p class="source-code">// ... pre-existing code ...</p><p class="source-code">using <strong class="bold">UnityEngine.SceneManagement</strong>;</p><p class="source-code">//... pre-existing code ...</p><p class="source-code">    public void OnLoginButtonClick()</p><p class="source-code">    {</p><p class="source-code">        var userRequest = new</p><p class="source-code">          <strong class="bold">LoginWithEmailAddressRequest</strong></p><p class="source-code">        {</p><p class="source-code">            Email = _email.text,</p><p class="source-code">            Password = Encrypt(_password.text)</p><p class="source-code">        };</p><p class="source-code">        PlayFabClientAPI.</p><p class="source-code">          <strong class="bold">LoginWithEmailAddress</strong>(userRequest,</p><p class="source-code">  OnLoginSuccess, OnError);</p><p class="source-code">    }</p><p class="source-code">    public void OnLoginSuccess(LoginResult result)</p><p class="source-code">    {</p><p class="source-code">        _message.text = "login successful!";</p><p class="source-code">        StartGame();</p><p class="source-code">    }</p><p class="source-code">    private static void StartGame()</p><p class="source-code">    {</p><p class="source-code">        <strong class="bold">SceneManager.LoadScene(1);</strong></p><p class="source-code">    }</p></li>
			</ol>
			<p>Let's break down the newly added code as follows:</p>
			<ul>
				<li>First of all, the <strong class="source-inline">UnityEngine.SceneManagement</strong> namespace is added with the <strong class="source-inline">using</strong> keyword. This is because if the player logs in successfully, we need to switch the scene from the login scene to the game scene, and the logic related to scene loading is defined in this namespace.</li>
				<li>We create a new instance of <strong class="source-inline">LoginWithEmailAddressRequest</strong> and call <strong class="source-inline">PlayFabClientAPI.LoginWithEmailAddress</strong> to log the player into Azure PlayFab. </li>
				<li>In addition <a id="_idIndexMarker1036"/>to using email to log in, Azure PlayFab<a id="_idIndexMarker1037"/> also offers multiple login methods, such as calling <strong class="source-inline">PlayFabClientAPI .LoginWithFacebook</strong> to log in with a Facebook access token, and calling <strong class="source-inline">PlayFabClientAPI.LoginWithGameCenter</strong> to log in with an iOS Game Center player identifier.</li>
				<li>The <strong class="source-inline">SceneManager.LoadScene</strong> method will be called when the player logs in successfully. The <strong class="source-inline">SceneManager.LoadScene</strong> method takes an <strong class="source-inline">int</strong> parameter, which is the index of the target scene. </li>
				<li>There are two scenes in this example – the first one is <strong class="source-inline">StartScene</strong>, with an index of <strong class="source-inline">0</strong>, which allows players to register or log in here; and the second is GameScene, with an index of <strong class="source-inline">1</strong>, which allows players to play the game, so we use an index of <strong class="source-inline">1</strong> to switch from <strong class="source-inline">StartScene</strong> to <strong class="source-inline">GameScene</strong>.</li>
			</ul>
			<ol>
				<li value="2">Select the <strong class="bold">Login</strong> button in the UI panel to open the <strong class="bold">Inspector</strong> window of this button. In the <strong class="bold">Inspector</strong> window, first, click the <strong class="bold">+</strong> button at the bottom of the <strong class="bold">On Click()</strong> section, then select the same GameObject that <strong class="source-inline">AzurePlayFabAccountManager</strong> is attached to, and finally, select the method defined in the <strong class="source-inline">AzurePlayFabAccountManager</strong> class that will be called <a id="_idIndexMarker1038"/>when the <strong class="bold">Login</strong> button is clicked; this time, it<a id="_idIndexMarker1039"/> is the <strong class="source-inline">OnLoginButtonClick</strong> method, as shown in <em class="italic">Figure 11.26</em>:</li>
			</ol>
			<div>
				<div id="_idContainer574" class="IMG---Figure">
					<img src="image/Figure_11.26_B17146.jpg" alt=""/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.26 – Setting up the Login button</p>
			<ol>
				<li value="3">Run the game, switch to the login tab, enter the email address and password, and then click the <strong class="bold">Login</strong> button to send a login user request to Azure PlayFab, as shown in the following figure:</li>
			</ol>
			<div>
				<div id="_idContainer575" class="IMG---Figure">
					<img src="image/Figure_11.27_B17146.jpg" alt="Figure 11.27 – The login tab&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.27 – The login tab</p>
			<ol>
				<li value="4">Then, if the player <a id="_idIndexMarker1040"/>logs in successfully, the game scene will be loaded and the game will <a id="_idIndexMarker1041"/>start, as shown in the following figure:</li>
			</ol>
			<div>
				<div id="_idContainer576" class="IMG---Figure">
					<img src="image/Figure_11.28_B17146.jpg" alt="Figure 11.28 – Playing the game&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.28 – Playing the game</p>
			<p>In this section, you learned how to use the Azure PlayFab API to register a user, how to update a user's display name in Azure PlayFab via the Azure PlayFab API, and how to use that to log into Azure PlayFab from a Unity game. Next, we will explore how to implement a leaderboard in a Unity game using Azure PlayFab.</p>
			<h1 id="_idParaDest-209"><a id="_idTextAnchor216"/>Implementing a leaderboard using Azure PlayFab in Unity</h1>
			<p>Most games today use leaderboards, which indicate who is the best performer in a game and increase gamer engagement with a game. In this section, we will be exploring how to implement a leaderboard using Azure PlayFab in our Unity project.</p>
			<h2 id="_idParaDest-210"><a id="_idTextAnchor217"/>Setting up a leaderboard in Azure PlayFab</h2>
			<p>In order to use <a id="_idIndexMarker1042"/>Azure PlayFab's leaderboard feature, we<a id="_idIndexMarker1043"/> first need to set up a leaderboard in the developer portal of Azure PlayFab:</p>
			<ol>
				<li value="1">Go back to the dashboard of the game title in Azure PlayFab. In the dashboard, you will find the <strong class="bold">Leaderboards</strong> option in the left column; click it to open the <strong class="bold">Leaderboards</strong> page:</li>
			</ol>
			<div>
				<div id="_idContainer577" class="IMG---Figure">
					<img src="image/Figure_11.29_B17146.jpg" alt="Figure 11.29 – The Leaderboards option&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.29 – The Leaderboards option</p>
			<ol>
				<li value="2">As shown in the<a id="_idIndexMarker1044"/> following figure, no <a id="_idIndexMarker1045"/>leaderboard has been created yet, so click the <strong class="bold">New leaderboard</strong> button to create a new leaderboard in Azure PlayFab:</li>
			</ol>
			<div>
				<div id="_idContainer578" class="IMG---Figure">
					<img src="image/Figure_11.30_B17146.jpg" alt="Figure 11.30 – Creating a new leaderboard&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.30 – Creating a new leaderboard</p>
			<ol>
				<li value="3">In the <strong class="bold">New Leaderboard</strong> settings panel, we will set up three properties for this leaderboard, namely <strong class="bold">Statistic name</strong>, <strong class="bold">Reset frequency</strong>, and <strong class="bold">Aggregation method</strong>, as shown in <em class="italic">Figure 11.31</em>:</li>
			</ol>
			<div>
				<div id="_idContainer579" class="IMG---Figure">
					<img src="image/Figure_11.31_B17146.jpg" alt="Figure 11.31 – Setting up a new leaderboard&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.31 – Setting up a new leaderboard</p>
			<p>Let's explain <a id="_idIndexMarker1046"/>these three properties<a id="_idIndexMarker1047"/> one by one:</p>
			<ul>
				<li><strong class="bold">Statistic name</strong> is the name of this leaderboard; we've named it <strong class="source-inline">UnityBookGame</strong> in this example.</li>
				<li><strong class="bold">Reset frequency</strong> determines how often the leaderboard should be reset. There are five options:<ul><li><strong class="bold">Manually</strong>: This is the default value, and we leave the reset frequency set to this so that the leaderboard doesn't reset automatically.</li><li><strong class="bold">Hourly</strong>: Automatically resets the leaderboard every hour.</li><li><strong class="bold">Daily</strong>: Automatically resets the leaderboard every day.</li><li><strong class="bold">Weekly</strong>: Automatically resets the leaderboard every week.</li><li><strong class="bold">Monthly</strong>: Automatically resets the leaderboard every month.</li></ul></li>
				<li><strong class="bold">Aggregation method</strong> determines how the scores from the players are saved. There are four options:<ul><li><strong class="bold">Last</strong>: This is the default option; it is always updated with a new value, regardless of whether it is higher or lower than the existing value.</li><li><strong class="bold">Minimum</strong>: Always use the lowest value.</li><li><strong class="bold">Maxmum</strong>: Always use the highest value. We choose this option to save the highest score of a player in our game.</li><li><strong class="bold">Sum</strong>: Add this value to the existing value.</li></ul></li>
			</ul>
			<ol>
				<li value="4">Click the <strong class="bold">Save</strong> button in the <strong class="bold">New Leaderboard</strong> settings panel; then, we have an empty <a id="_idIndexMarker1048"/>leaderboard set up in Azure<a id="_idIndexMarker1049"/> PlayFab:</li>
			</ol>
			<div>
				<div id="_idContainer580" class="IMG---Figure">
					<img src="image/Figure_11.32_B17146.jpg" alt="Figure 11.32 – A new empty leaderboard&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.32 – A new empty leaderboard</p>
			<ol>
				<li value="5">In order to allow the Unity game to post player statistics requests to Azure PlayFab, we also need to enable the <strong class="bold">Allow client to post player statistics</strong> option in Azure PlayFab. So, click the gear icon at the upper-left corner first, and then select the <strong class="bold">Title settings</strong> option to open the settings page of the game title, as shown in the following figure:</li>
			</ol>
			<div>
				<div id="_idContainer581" class="IMG---Figure">
					<img src="image/Figure_11.33_B17146.jpg" alt="Figure 11.33 – Open the Title settings page&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.33 – Open the Title settings page</p>
			<ol>
				<li value="6">On the <a id="_idIndexMarker1050"/>settings page, click on the <strong class="bold">API Features</strong> tab<a id="_idIndexMarker1051"/> to switch to the <strong class="bold">API Features</strong> settings:</li>
			</ol>
			<div>
				<div id="_idContainer582" class="IMG---Figure">
					<img src="image/Figure_11.34_B17146.jpg" alt=""/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.34 – The API Features settings</p>
			<ol>
				<li value="7">Scroll down to the <strong class="bold">ENABLE API FEATURES</strong> section, enable the <strong class="bold">Allow client to post player statistics</strong> option, and save, as shown in <em class="italic">Figure 11.35</em>:</li>
			</ol>
			<div>
				<div id="_idContainer583" class="IMG---Figure">
					<img src="image/Figure_11.35_B17146.jpg" alt=""/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.35 – Enable the Allow client to post player statistics option</p>
			<p>Now that we've created and set up a leaderboard in Azure PlayFab, let's move on to explore how to update the score of a player from Unity using the Azure PlayFab API.</p>
			<h2 id="_idParaDest-211"><a id="_idTextAnchor218"/>Updating the score of a player from Unity using the Azure PlayFab API</h2>
			<p>When a player completes a game and has a<a id="_idIndexMarker1052"/> higher score than before, we want to update the player's score on the leaderboard in Azure PlayFab. Let's perform the following steps to implement it:</p>
			<ol>
				<li value="1">Create a new C# script in the <strong class="source-inline">Scripts</strong> folder, name it <strong class="source-inline">AzurePlayFabLeaderboardManager</strong>, and add the following code:<p class="source-code">using System.Collections.Generic;</p><p class="source-code">using UnityEngine;</p><p class="source-code">using PlayFab;</p><p class="source-code">using PlayFab.ClientModels;</p><p class="source-code">public class AzurePlayFabLeaderboardManager :</p><p class="source-code">  MonoBehaviour</p><p class="source-code">{</p><p class="source-code">    public void UpdateLeaderboardInAzurePlayFab(int</p><p class="source-code">       score)</p><p class="source-code">    {</p><p class="source-code">        var scoreUpdate = new <strong class="bold">StatisticUpdate</strong></p><p class="source-code">        {</p><p class="source-code">            <strong class="bold">StatisticName = "UnityBookGame",</strong></p><p class="source-code">            Value = score</p><p class="source-code">        };</p><p class="source-code">        var scoreUpdateList = new</p><p class="source-code">          List&lt;StatisticUpdate&gt; { scoreUpdate };</p><p class="source-code">        var scoreRequest = new</p><p class="source-code">          <strong class="bold">UpdatePlayerStatisticsRequest</strong></p><p class="source-code">        {</p><p class="source-code">            Statistics = scoreUpdateList</p><p class="source-code">        };</p><p class="source-code">        <strong class="bold">PlayFabClientAPI.UpdatePlayerStatistics</strong></p><p class="source-code">          (scoreRequest, OnUpdateSuccess, OnError);</p><p class="source-code">    }</p><p class="source-code">    public void OnUpdateSuccess</p><p class="source-code">      (UpdatePlayerStatisticsResult result) </p><p class="source-code">    {</p><p class="source-code">        Debug.Log("Update Success!");</p><p class="source-code">    }</p><p class="source-code">    public void OnError(PlayFabError error) </p><p class="source-code">    {</p><p class="source-code">        Debug.LogError(error.ErrorMessage);</p><p class="source-code">    }</p><p class="source-code">}</p></li>
			</ol>
			<p>Let's break down the code, as follows:</p>
			<ul>
				<li>In <a id="_idIndexMarker1053"/>the <strong class="source-inline">UpdateLeaderboardInAzurePlayFab</strong> method, we create a new instance of the <strong class="source-inline">StatisticUpdate</strong> class, which encapsulates the data that needs to be updated for the leaderboard. Here, we provide the name of the leaderboard and the player's score.</li>
				<li>Then, we create a list of <strong class="source-inline">StatisticUpdate</strong> and add the instance of <strong class="source-inline">StatisticUpdate</strong> that we just created to it. </li>
				<li>After that, we create a new instance of the <strong class="source-inline">UpdatePlayerStatisticsRequest</strong> class, which encapsulates the <strong class="source-inline">StatisticUpdate</strong> list we used to update the leaderboard, and call <strong class="source-inline">PlayFabClientAPI.UpdatePlayerStatistics</strong> to update the leaderboard in Azure PlayFab.</li>
				<li>We also have two callbacks – <strong class="source-inline">OnUpdateSuccess</strong>, which is called when the result is received, and <strong class="source-inline">OnError</strong>, which is called when an error occurs. </li>
			</ul>
			<ol>
				<li value="2">Then, we need to make sure that the <strong class="source-inline">UpdateLeaderboardInAzurePlayFab</strong> method will be called when the game is over. So, let's open the example project's <strong class="bold">Game</strong> scene in the <strong class="bold">BasicGame</strong> | <strong class="bold">Scenes</strong> folder, as shown in <em class="italic">Figure 11.36</em>:</li>
			</ol>
			<div>
				<div id="_idContainer584" class="IMG---Figure">
					<img src="image/Figure_11.36_B17146.jpg" alt=""/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.36 – The example game scene</p>
			<ol>
				<li value="3">Create<a id="_idIndexMarker1054"/> a new GameObject in the <strong class="bold">Game</strong> scene, name it <strong class="source-inline">AzurePlayFabManager</strong>, and then drag and drop <strong class="source-inline">AzurePlayFabLeaderboardManager.cs</strong> onto it, as shown in <em class="italic">Figure 11.37</em>:</li>
			</ol>
			<div>
				<div id="_idContainer585" class="IMG---Figure">
					<img src="image/Figure_11.37_B17146.jpg" alt="Figure 11.37 – Setting up the GameObject&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.37 – Setting up the GameObject</p>
			<ol>
				<li value="4">Next, we need to modify an existing C# script in the example project. You can find the <strong class="source-inline">ExampleGameManager.cs</strong> file in the <strong class="bold">BasicGame</strong> &gt; <strong class="bold">Scripts</strong> folder; double-click it to open it, as shown in <em class="italic">Figure 11.38</em>:</li>
			</ol>
			<div>
				<div id="_idContainer586" class="IMG---Figure">
					<img src="image/Figure_11.38_B17146.jpg" alt=""/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.38 – The ExampleGameManager.cs file</p>
			<ol>
				<li value="5">Add<a id="_idIndexMarker1055"/> the following code to the <strong class="source-inline">ExampleGameManager</strong> class:<p class="source-code">// ... pre-existing code ...</p><p class="source-code">  [SerializeField]</p><p class="source-code">  <strong class="bold">private AzurePlayFabLeaderboardManager </strong></p><p class="source-code"><strong class="bold">    _azurePlayFabLeaderboardManager</strong>;</p><p class="source-code">// ... pre-existing code ...</p><p class="source-code">  public void GameOver()</p><p class="source-code">    {</p><p class="source-code">    <strong class="bold">_azurePlayFabLeaderboardManager.</strong></p><p class="source-code"><strong class="bold">      UpdateLeaderboardInAzurePlayFab(score);</strong></p><p class="source-code">    }</p></li>
			</ol>
			<p>Let's break down the added code, as follows:</p>
			<ul>
				<li>First, we add a new field to get the reference to the instance of <strong class="source-inline">AzurePlayFabLeaderboardManager</strong>.</li>
				<li>Then, we call the <strong class="source-inline">UpdateLeaderboardInAzurePlayFab</strong> method in <strong class="source-inline">GameOver</strong> to update the leaderboard.</li>
			</ul>
			<ol>
				<li value="6">Remember to assign the reference to the <strong class="source-inline">AzurePlayFabLeaderboardManager</strong> instance to the field we just added:</li>
			</ol>
			<div>
				<div id="_idContainer587" class="IMG---Figure">
					<img src="image/Figure_11.39_B17146.jpg" alt="Figure 11.39 – Assigning the reference to the field&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.39 – Assigning the reference to the field</p>
			<ol>
				<li value="7">Let's go<a id="_idIndexMarker1056"/> back to the <strong class="bold">Start</strong> scene and run the game in the Editor, using the player account we created in the previous section to log in and play. In the following screenshot, we have <strong class="bold">4</strong> points at the end of the game:</li>
			</ol>
			<div>
				<div id="_idContainer588" class="IMG---Figure">
					<img src="image/Figure_11.40_B17146.jpg" alt=""/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.40 – We have 4 points in the game</p>
			<ol>
				<li value="8">At the same time, go to the <strong class="bold">Leaderboard</strong> dashboard of Azure PlayFab, where you can see that the player's highest score is <strong class="bold">4</strong> points and they rank first:</li>
			</ol>
			<div>
				<div id="_idContainer589" class="IMG---Figure">
					<img src="image/Figure_11.41_B17146.jpg" alt="Figure 11.41 – The leaderboard in Azure PlayFab&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.41 – The leaderboard in Azure PlayFab</p>
			<p>We have <a id="_idIndexMarker1057"/>called the API to update the score of a player on the leaderboard in Azure PlayFab from Unity. Our next challenge will be to load the leaderboard data from it.</p>
			<h2 id="_idParaDest-212"><a id="_idTextAnchor219"/>Loading the leaderboard data from Azure PlayFab in Unity</h2>
			<p>In<a id="_idIndexMarker1058"/> the example project, you also can find <a id="_idIndexMarker1059"/>the leaderboard panel in <strong class="bold">BasicGame</strong> |  <strong class="bold">Scenes</strong> | <strong class="bold">GameScene</strong>, which we will use to display the top 10 players on the leaderboard loaded from Azure PlayFab. By default, this UI panel is not activated, so now, we can't see it in the <strong class="bold">Game</strong> view:</p>
			<div>
				<div id="_idContainer590" class="IMG---Figure">
					<img src="image/Figure_11.42_B17146.jpg" alt="Figure 11.42 – The leaderboard panel&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.42 – The leaderboard panel</p>
			<p>Before we<a id="_idIndexMarker1060"/> start exploring how to load leaderboard<a id="_idIndexMarker1061"/> information from Azure PlayFab, let's register more players and add more items to the <strong class="bold">UnityBookGame</strong> leaderboard, as shown in the following figure:</p>
			<div>
				<div id="_idContainer591" class="IMG---Figure">
					<img src="image/Figure_11.43_B17146.jpg" alt="Figure 11.43 – The UnityBookGame leaderboard&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.43 – The UnityBookGame leaderboard</p>
			<p>Then, our<a id="_idIndexMarker1062"/> first task is to call the Azure PlayFab API<a id="_idIndexMarker1063"/> in Unity to get leaderboard data. To do so, proceed as follows:</p>
			<ol>
				<li value="1">Go back to the <strong class="source-inline">AzurePlayFabLeaderboardManager</strong> script and add the code, as follows:<p class="source-code"> // ... pre-existing code ...</p><p class="source-code">    public void LoadLeaderboardDataFromAzurePlayFab()</p><p class="source-code">    {</p><p class="source-code">        var loadRequest = new <strong class="bold">GetLeaderboardRequest</strong></p><p class="source-code">        {</p><p class="source-code">            StatisticName = "<strong class="bold">UnityBookGame</strong>",</p><p class="source-code">            StartPosition = <strong class="bold">0</strong>,</p><p class="source-code">            MaxResultsCount = <strong class="bold">10</strong></p><p class="source-code">        };</p><p class="source-code">        PlayFabClientAPI.<strong class="bold">GetLeaderboard</strong>(loadRequest,</p><p class="source-code">          OnLoadSuccess, OnError);</p><p class="source-code">    }</p><p class="source-code">// ... pre-existing code ...</p><p class="source-code">    public void <strong class="bold">OnLoadSuccess</strong>(GetLeaderboardResult</p><p class="source-code">      result)</p><p class="source-code">    {</p><p class="source-code">        Debug.Log("Load Success!");</p><p class="source-code">    }</p></li>
			</ol>
			<p>Let's break down the added code, as follows:</p>
			<ul>
				<li>We<a id="_idIndexMarker1064"/> create a new method <a id="_idIndexMarker1065"/>and name it <strong class="source-inline">LoadLeaderboardDataFromAzurePlayFab</strong>. </li>
				<li>In the <strong class="source-inline">LoadLeaderboardDataFromAzurePlayFab</strong> method, we create a new instance of <strong class="source-inline">GetLeaderboardRequest</strong> and call <strong class="source-inline">PlayFabClientAPI.</strong> <strong class="source-inline">GetLeaderboard</strong> to retrieve up to <strong class="source-inline">10</strong> entries from the <strong class="source-inline">UnityBookGame</strong> leaderboard, starting at index <strong class="source-inline">0</strong>.</li>
				<li>We also add a new callback, <strong class="source-inline">OnLoadSuccess</strong>, which is called when the result is received to print "<strong class="source-inline">Load Success!</strong>" in the console window.</li>
			</ul>
			<ol>
				<li value="2">Then, go back to <strong class="source-inline">ExampleGameManager.cs</strong> and update the code as follows:<p class="source-code">public void GameOver()</p><p class="source-code">{</p><p class="source-code">  _azurePlayFabLeaderboardManager.</p><p class="source-code">    UpdateLeaderboardInAzurePlayFab(score);</p><p class="source-code">  <strong class="bold">_azurePlayFabLeaderboardManager.</strong></p><p class="source-code"><strong class="bold">    LoadLeaderboardDataFromAzurePlayFab();</strong></p><p class="source-code"> }</p></li>
			</ol>
			<p>The newly added code will get leaderboard information from Azure PlayFab when the game is over.</p>
			<ol>
				<li value="3">Run the game and take a look at the console window when the game is over; we successfully load leaderboard data from Azure PlayFab, as shown in the following screenshot:</li>
			</ol>
			<div>
				<div id="_idContainer592" class="IMG---Figure">
					<img src="image/Figure_11.44_B17146.jpg" alt="Figure 11.44 – Load Success!&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.44 – Load Success!</p>
			<p>Now that we've <a id="_idIndexMarker1066"/>received successful results <a id="_idIndexMarker1067"/>from Azure PlayFab, our next task is display this data in the leaderboard UI panel in our Unity project:</p>
			<ol>
				<li value="1">Go back to the <strong class="source-inline">AzurePlayFabLeaderboardManager</strong> script again and update the code, as follows:<p class="source-code">// ... pre-existing code ...</p><p class="source-code">    [SerializeField]</p><p class="source-code">    private GameObject _leaderboardUIPanel;</p><p class="source-code">    [SerializeField]</p><p class="source-code">    private List&lt;Text&gt; _itemsText;</p><p class="source-code">// ... pre-existing code ...</p><p class="source-code">    public void OnLoadSuccess(GetLeaderboardResult</p><p class="source-code">      result)</p><p class="source-code">    {</p><p class="source-code">        _leaderboardUIPanel.SetActive(true);</p><p class="source-code">        CreateRankingItemsInUnity(<strong class="bold">result.Leaderboard</strong>);</p><p class="source-code">    }</p><p class="source-code">    private void CreateRankingItemsInUnity</p><p class="source-code">      (List&lt;PlayerLeaderboardEntry&gt; items)</p><p class="source-code">    {</p><p class="source-code">        foreach(var item in items)</p><p class="source-code">        {</p><p class="source-code">            var itemText = _itemsText[item.Position];</p><p class="source-code"><strong class="bold">            itemText.text = $"{item.Position + 1}:</strong></p><p class="source-code"><strong class="bold">            {item.Profile.DisplayName} –</strong></p><p class="source-code"><strong class="bold">              {item.StatValue}";</strong></p><p class="source-code">        }</p><p class="source-code">    }</p></li>
			</ol>
			<p>Let's break <a id="_idIndexMarker1068"/>down the newly added<a id="_idIndexMarker1069"/> code, as follows:</p>
			<ul>
				<li>In the <strong class="source-inline">fields</strong> section, we reference the <strong class="source-inline">Leaderboard</strong> GameObject in the scene; this is because the leaderboard panel is not activated by default, and we want to activate it at the end of the game to display leaderboard information from Azure PlayFab. Additionally, we get a reference to the list of <strong class="source-inline">Text</strong> UI elements used to display each item on the leaderboard.</li>
				<li>In <strong class="source-inline">OnLoadSuccess</strong>, we activate the <strong class="source-inline">Leaderboard</strong> GameObject in the scene and receive the leaderboard information from Azure PlayFab. Then, call the <strong class="source-inline">CreateRankingItemsInUnity</strong> method, which takes <strong class="source-inline">List&lt;PlayerLeaderboardEntry&gt;</strong> as a parameter.</li>
				<li>In <strong class="source-inline">CreateRankingItemsInUnity</strong>, we update the <strong class="source-inline">Text</strong> UI elements to display information about each item, including the player's rank, display name, and score.</li>
			</ul>
			<ol>
				<li value="2">Don't forget to assign these UI elements to these newly added fields accordingly in the <strong class="source-inline">AzurePlayFabManager</strong> GameObject in the <strong class="bold">Game</strong> scene, as shown in <em class="italic">Figure 11.45</em>:</li>
			</ol>
			<div>
				<div id="_idContainer593" class="IMG---Figure">
					<img src="image/Figure_11.45_B17146.jpg" alt=""/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.45 – Assigning the UI elements to the newly added fields</p>
			<ol>
				<li value="3">Let's go back <a id="_idIndexMarker1070"/>to the <strong class="bold">Start</strong> scene and run<a id="_idIndexMarker1071"/> the game. In the following screenshot, we can see that the leaderboard UI panel appears at the end of the game and displays the ranking information for the top 10 players:</li>
			</ol>
			<div>
				<div id="_idContainer594" class="IMG---Figure">
					<img src="image/Figure_11.46_B17146.jpg" alt="Figure 11.46 – The leaderboard in Unity&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.46 – The leaderboard in Unity</p>
			<p>By reading this section, you should now know how to set up a leaderboard in Azure PlayFab, how to update leaderboard data from a Unity game using the Azure PlayFab API, and how to use the Azure PlayFab API to get leaderboard data from Azure PlayFab and display it in Unity.</p>
			<h1 id="_idParaDest-213"><a id="_idTextAnchor220"/>Summary</h1>
			<p>This chapter is the last chapter of the book and the final level of our long adventure. Along the way, you've learned a lot of different topics on how to develop games with the Unity game engine, which may include areas you're familiar with, such as how to implement UI in Unity using the MVVM architectural pattern, or there may be content that you have never touched upon before, such as rendering pipelines and related mathematical knowledge. I hope you enjoyed the journey and are ready for the new challenges ahead.</p>
			<p>In addition to the Unity engine itself, this chapter also focuses on Microsoft Game Dev, the Microsoft Azure cloud, and Azure PlayFab. We discussed what they are and why we should consider using them in game development. Then, we used an example project to demonstrate how to create a new Azure PlayFab developer account, set up the Azure PlayFab SDK in the Unity project, and implement the registration, login and leaderboard functions in Unity through the Azure PlayFab API.</p>
			<p>By reading this chapter and this book, I hope that you now understand that the knowledge required for game development is not limited to how to use a game engine; it also involves knowledge of programming, computer graphics, and even cloud services. </p>
			<p>While this chapter is the end of the book, this book is only the beginning of your game developer journey. Keep learning, and keep growing!</p>
		</div>
	</body></html>