<html><head></head><body>
		<div id="_idContainer116">
			<h1 id="_idParaDest-206" class="chapter-number"><a id="_idTextAnchor315"/>10</h1>
			<h1 id="_idParaDest-207"><a id="_idTextAnchor316"/>Accelerating App Development with Template Studio</h1>
			<p>Starting a new project from scratch can be daunting. What are the best practices for application architecture and project layout? <strong class="bold">Template Studio for WinUI</strong> is an open source project <a id="_idIndexMarker719"/>that began as <strong class="bold">Windows Template Studio</strong> for<a id="_idIndexMarker720"/> UWP and WPF applications. Each version of Template Studio is an extension for Visual Studio. It now supports WinUI, and variations have <a id="_idIndexMarker721"/>been created that will also<a id="_idIndexMarker722"/> generate <strong class="bold">.NET MAUI</strong> and <strong class="bold">Uno </strong><span class="No-Break"><strong class="bold">Platform</strong></span><span class="No-Break"> projects.</span></p>
			<p>In this chapter, we will cover the <span class="No-Break">following topics:</span></p>
			<ul>
				<li>Discover what Template Studio is and how it can help developers create new WinUI projects while following best patterns <span class="No-Break">and practices</span></li>
				<li>Review the history of Windows Template Studio and <span class="No-Break">UWP applications</span></li>
				<li>Create a new project with Template Studio for WinUI and the <span class="No-Break">MVVM Toolkit</span></li>
				<li>Learn about other variations of <span class="No-Break">Template Studio</span></li>
			</ul>
			<p>By the end of this chapter, you will understand the origins of the current Template Studio extensions for Visual Studio. You’ll also have enough familiarity with Template Studio for WinUI to choose it when starting your next WinUI 3 project. You will also know where you can go to suggest enhancements, submit issues, or improve the project by submitting your own changes to the open <span class="No-Break">source project.</span></p>
			<h1 id="_idParaDest-208"><a id="_idTextAnchor317"/>Technical requirements</h1>
			<p>To follow along with the examples in this chapter, please refer to the <em class="italic">Technical requirements</em> section of <a href="B20908_02.xhtml#_idTextAnchor044"><span class="No-Break"><em class="italic">Chapter 2</em></span></a>, <em class="italic">Configuring the Development Environment and Creating </em><span class="No-Break"><em class="italic">the Project</em></span><span class="No-Break">.</span></p>
			<p>The source code for this chapter is available on GitHub <span class="No-Break">here: </span><a href="https://github.com/PacktPublishing/Learn-WinUI-3-Second-Edition/tree/master/Chapter10"><span class="No-Break">https://github.com/PacktPublishing/Learn-WinUI-3-Second-Edition/tree/master/Chapter10</span></a></p>
			<h1 id="_idParaDest-209"><a id="_idTextAnchor318"/>Overview of Template Studio for WinUI</h1>
			<p>Template Studio for WinUI <a id="_idIndexMarker723"/>is an open source extension for Visual Studio that enhances the experience of creating a new WinUI 3 project. Microsoft currently has three versions of the Template Studio <span class="No-Break">extension available:</span></p>
			<ul>
				<li><strong class="bold">Template Studio for WinUI (C#)</strong> – This is<a id="_idIndexMarker724"/> the extension we will use in this chapter. There are also plans for a C++ version of Template Studio <span class="No-Break">for WinUI.</span></li>
				<li><strong class="bold">Template Studio for WPF</strong> – The <a id="_idIndexMarker725"/>WPF version of Template Studio is similar to the WinUI extension. It creates a .NET <span class="No-Break">WPF project.</span></li>
				<li><strong class="bold">Template Studio for UWP</strong> – This<a id="_idIndexMarker726"/> version is the updated extension that was originally named Windows <span class="No-Break">Template Studio.</span></li>
			</ul>
			<p>The code and documentation for the Template Studio projects<a id="_idIndexMarker727"/> are available on GitHub: <a href="https://github.com/microsoft/TemplateStudio">https://github.com/microsoft/TemplateStudio</a>. The team also maintains a release roadmap on GitHub that you can <span class="No-Break">monitor: </span><a href="https://github.com/microsoft/TemplateStudio/blob/main/docs/roadmap.md"><span class="No-Break">https://github.com/microsoft/TemplateStudio/blob/main/docs/roadmap.md</span></a><span class="No-Break">.</span></p>
			<p>Creating a new project with one of the Template Studio extensions launches an enhanced wizard-style experience where you can select the type of project you want to create and the design pattern to follow (such as MVVM). You can also select some pre-defined pages and other features to include in your project, as well as a unit test project. We will step through the full experience and discuss the options in the <span class="No-Break">next section.</span></p>
			<p>Template Studio for WinUI is installed like any other Visual Studio extension. If you aren’t familiar with the process, you can either download the <strong class="bold">VSIX</strong> package<a id="_idIndexMarker728"/> from the Visual Studio Marketplace (<a href="https://marketplace.visualstudio.com/items?itemName=TemplateStudio.TemplateStudioForWinUICs">https://marketplace.visualstudio.com/items?itemName=TemplateStudio.TemplateStudioForWinUICs</a>) or you can search for and add it in the <strong class="bold">Manage Extensions</strong> dialog box in <span class="No-Break">Visual </span><span class="No-Break"><a id="_idIndexMarker729"/></span><span class="No-Break">Studio.</span></p>
			<div>
				<div id="_idContainer097" class="IMG---Figure">
					<img src="image/B20908_10_01.jpg" alt="Figure 10.1 – Template Studio for WinUI in Visual Studio Marketplace"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.1 – Template Studio for WinUI in Visual Studio Marketplace</p>
			<p>We’ll be using the <strong class="bold">Manage Extensions</strong> dialog to install the extension in this chapter. For detailed information on managing extensions in Visual Studio, see this documentation on Microsoft <span class="No-Break">Learn: </span><a href="https://learn.microsoft.com/visualstudio/ide/finding-and-using-visual-studio-extensions"><span class="No-Break">https://learn.microsoft.com/visualstudio/ide/finding-and-using-visual-studio-extensions</span></a><span class="No-Break">.</span></p>
			<p class="callout-heading">Note</p>
			<p class="callout">If you’re curious about the inner workings of a Visual Studio extension package, or VSIX, you can read more about them on Microsoft <span class="No-Break">Learn: </span><a href="https://learn.microsoft.com/visualstudio/extensibility/anatomy-of-a-vsix-package"><span class="No-Break">https://learn.microsoft.com/visualstudio/extensibility/anatomy-of-a-vsix-package</span></a></p>
			<p>The <a id="_idIndexMarker730"/>code that is generated by the extension continues to guide you as you proceed to build out the newly created project. There are <em class="italic">TODO</em> comments with guidance about where you add your own code and helpful links to documentation that explains the concepts and controls used in the code. The extension is updated frequently to reflect the latest WinUI features, practices, and recommendations for <span class="No-Break">Windows developers.</span></p>
			<p>Contributions to the Template Studio projects on GitHub are all reviewed to ensure they follow good coding style, fluent design, and helpful <span class="No-Break">comments throughout.</span></p>
			<p>Now that we have reviewed some basics of Template Studio for WinUI, let’s dive right in and create a new project with <span class="No-Break">the extension.</span></p>
			<h1 id="_idParaDest-210"><a id="_idTextAnchor319"/>Starting a new WinUI project with Template Studio</h1>
			<p>In this section, we <a id="_idIndexMarker731"/>are going to create a new WinUI<a id="_idIndexMarker732"/> project with Template Studio for WinUI. We’ll install the extension, create the project with several pages and features selected, and then run the project to explore what is provided before we add any of our own code. In the next section, we’ll dive a little deeper into the generated code to see where we would start extending and enhancing the project if we were building a <span class="No-Break">production application:</span></p>
			<ol>
				<li>To start, open Visual Studio and select <strong class="bold">Continue without code</strong> to open the IDE without loading <span class="No-Break">a solution:</span></li>
			</ol>
			<div>
				<div id="_idContainer098" class="IMG---Figure">
					<img src="image/B20908_10_02.jpg" alt="Figure 10.2 – The Visual Studio 2022 launch dialog"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.2 – The Visual Studio 2022 launch dialog</p>
			<ol>
				<li value="2">In<a id="_idIndexMarker733"/> the <a id="_idIndexMarker734"/>menu, select <strong class="bold">Extensions</strong> | <strong class="bold">Manage Extensions</strong> to open the <strong class="bold">Manage </strong><span class="No-Break"><strong class="bold">Extensions</strong></span><span class="No-Break"> dialog:</span></li>
			</ol>
			<div>
				<div id="_idContainer099" class="IMG---Figure">
					<img src="image/B20908_10_03.jpg" alt="Figure 10.3 – The Manage Extensions dialog in Visual Studio"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.3 – The Manage Extensions dialog in Visual Studio</p>
			<ol>
				<li value="3">In<a id="_idIndexMarker735"/> the <strong class="bold">Search</strong> field, search for <strong class="source-inline">template studio</strong>. In <a id="_idIndexMarker736"/>the list of search results, select <strong class="bold">Download</strong> on <strong class="bold">Template Studio for </strong><span class="No-Break"><strong class="bold">WinUI (C#)</strong></span><span class="No-Break">:</span></li>
			</ol>
			<div>
				<div id="_idContainer100" class="IMG---Figure">
					<img src="image/B20908_10_04.jpg" alt="Figure 10.4 – Installing Template Studio for WinUI from Manage Extensions"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.4 – Installing Template Studio for WinUI from Manage Extensions</p>
			<p class="list-inset">You will<a id="_idIndexMarker737"/> need to restart Visual Studio<a id="_idIndexMarker738"/> to complete the <span class="No-Break">extension’s installation.</span></p>
			<ol>
				<li value="4">After the installation completes, launch Visual Studio and select <strong class="bold">Create a </strong><span class="No-Break"><strong class="bold">new project</strong></span><span class="No-Break">.</span></li>
				<li>On the <strong class="bold">Create a new project</strong> screen, if you don’t see <strong class="bold">Template Studio for WinUI</strong> in the list of templates, search for <strong class="source-inline">template studio</strong>. The new project template should appear first in the list <span class="No-Break">of results:</span></li>
			</ol>
			<div>
				<div id="_idContainer101" class="IMG---Figure">
					<img src="image/B20908_10_05.jpg" alt="Figure 10.5 – Selecting Template Studio for WinUI to create a new project"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.5 – Selecting Template Studio for WinUI to create a new project</p>
			<ol>
				<li value="6">Select <strong class="bold">Next</strong> and, on<a id="_idIndexMarker739"/> the <strong class="bold">Configure your new project</strong> screen, give <a id="_idIndexMarker740"/>the project a name such <span class="No-Break">as </span><span class="No-Break"><strong class="source-inline">TemplateStudioSampleApp</strong></span><span class="No-Break">.</span></li>
				<li>Click <strong class="bold">Create</strong> to continue. Instead of the Visual Studio IDE immediately loading, you will be presented with the Template <span class="No-Break">Studio wizard:</span></li>
			</ol>
			<div>
				<div id="_idContainer102" class="IMG---Figure">
					<img src="image/B20908_10_06.jpg" alt="Figure 10.6 – The first page of the Template Studio for WinUI wizard"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.6 – The first page of the Template Studio for WinUI wizard</p>
			<p class="list-inset">The first <a id="_idIndexMarker741"/>page of the wizard prompts you <a id="_idIndexMarker742"/>to select a project type. The choices are <strong class="bold">Navigation Pane</strong>, <strong class="bold">Menu Bar</strong>, or <strong class="bold">Blank</strong>. You can select <strong class="bold">Details</strong> on any of the choices to read more about each option. Select the <strong class="bold">Navigation Pane</strong> option. This layout leverages the <strong class="source-inline">NavigationView</strong> control that we discussed in <a href="B20908_05.xhtml#_idTextAnchor114"><span class="No-Break"><em class="italic">Chapter 5</em></span></a>, <em class="italic">Exploring WinUI Controls</em>. It’s also the navigation method used in the WinUI 3 <span class="No-Break">Gallery app.</span></p>
			<ol>
				<li value="8">Select <strong class="bold">Next</strong> to continue. On the <strong class="bold">Design pattern</strong> screen, the only available option is <strong class="bold">MVVM Toolkit</strong>. Some versions of Template Studio offer other MVVM frameworks or a <strong class="bold">Code Behind</strong> option. For WinUI 3, we only have <span class="No-Break">one choice:</span></li>
			</ol>
			<div>
				<div id="_idContainer103" class="IMG---Figure">
					<img src="image/B20908_10_07.jpg" alt="Figure 10.7 – The Design pattern screen"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.7 – The Design pattern screen</p>
			<p class="list-inset">You’ll also<a id="_idIndexMarker743"/> notice that the right pane <a id="_idIndexMarker744"/>contains the <strong class="bold">Your project details</strong> heading and the options that have been selected so far. When you’re more familiar with Template Studio, you will be able to review these options and click <strong class="bold">Create</strong> to finish the wizard without visiting each screen if you’re satisfied with the <span class="No-Break">default selections.</span></p>
			<ol>
				<li value="9">Click <strong class="bold">Next</strong> and review the <span class="No-Break"><strong class="bold">Pages</strong></span><span class="No-Break"> screen:</span></li>
			</ol>
			<div>
				<div id="_idContainer104" class="IMG---Figure">
					<img src="image/B20908_10_08.jpg" alt="Figure 10.8 – The Pages screen in Template Studio for WinUI"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.8 – The Pages screen in Template Studio for WinUI</p>
			<p class="list-inset">By default, one <strong class="bold">Blank</strong> page has been selected. The default name of this page is <strong class="bold">Main</strong>. You can<a id="_idIndexMarker745"/> change the names of any pages<a id="_idIndexMarker746"/> in the <strong class="bold">Your project </strong><span class="No-Break"><strong class="bold">details</strong></span><span class="No-Break"> panel.</span></p>
			<ol>
				<li value="10">Let’s select several other page types to review in the next section. Select <strong class="bold">Data Grid</strong>, <strong class="bold">List Details</strong>, <strong class="bold">Web View</strong>, and <strong class="bold">Settings</strong>. You can select more if <span class="No-Break">you like:</span></li>
			</ol>
			<div>
				<div id="_idContainer105" class="IMG---Figure">
					<img src="image/B20908_10_09.jpg" alt="Figure 10.9 – Selecting several additional pages for our project"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.9 – Selecting several additional pages for our project</p>
			<p class="list-inset">Any of the<a id="_idIndexMarker747"/> pages can be renamed<a id="_idIndexMarker748"/> except for <strong class="bold">Settings</strong>. We’ll leave the <span class="No-Break">default names.</span></p>
			<ol>
				<li value="11">Click <strong class="bold">Next</strong> to move on to the <span class="No-Break"><strong class="bold">Features</strong></span><span class="No-Break"> screen:</span></li>
			</ol>
			<div>
				<div id="_idContainer106" class="IMG---Figure">
					<img src="image/B20908_10_010.jpg" alt="Figure 10.10 – Exploring the Features screen of Template Studio for WinUI"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.10 – Exploring the Features screen of Template Studio for WinUI</p>
			<p class="list-inset">The default <a id="_idIndexMarker749"/>selections on the <strong class="bold">Features</strong> screen <a id="_idIndexMarker750"/>are <strong class="bold">Settings Storage</strong>, <strong class="bold">MSIX Packaging</strong>, and <strong class="bold">Theme Selection</strong>. We’ll leave those defaults selected. If you want to include the Windows App SDK dependencies with your project, you can select <strong class="bold">Self-Contained</strong>. This is useful if you are going to distribute your app manually with <a id="_idIndexMarker751"/>an <strong class="bold">xcopy deployment</strong>. We’ll discuss deployment options in <a href="B20908_14.xhtml#_idTextAnchor582"><span class="No-Break"><em class="italic">Chapter 14</em></span></a>, <em class="italic">Packaging and Deploying WinUI Applications</em>. The other unselected option is <strong class="bold">App Notifications</strong>. We have already explored notifications in <a href="B20908_08.xhtml#_idTextAnchor197"><span class="No-Break"><em class="italic">Chapter 8</em></span></a>, <em class="italic">Add</em><em class="italic">ing</em><em class="italic"> Windows Notifications to WinUI Applications</em>. If you want to learn more about any of the features, <span class="No-Break">select </span><span class="No-Break"><strong class="bold">Details</strong></span><span class="No-Break">.</span></p>
			<ol>
				<li value="12">Click <strong class="bold">Next</strong> to move on to the final step of the <span class="No-Break">wizard, </span><span class="No-Break"><strong class="bold">Testing</strong></span><span class="No-Break">:</span></li>
			</ol>
			<div>
				<div id="_idContainer107" class="IMG---Figure">
					<img src="image/B20908_10_011.jpg" alt="Figure 10.11 – The Testing screen of the Template Studio for WinUI wizard"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.11 – The Testing screen of the Template Studio for WinUI wizard</p>
			<ol>
				<li value="13">The only<a id="_idIndexMarker752"/> option on the <strong class="bold">Testing</strong> screen is <strong class="bold">MSTest</strong>. Select it to add a unit test project to <span class="No-Break">your solution.</span></li>
				<li>We’ve reached<a id="_idIndexMarker753"/> the end of the wizard. Select <strong class="bold">Create</strong> to create the solution and launch the Visual <span class="No-Break">Studio IDE:</span></li>
			</ol>
			<div>
				<div id="_idContainer108" class="IMG---Figure">
					<img src="image/B20908_10_012.jpg" alt="Figure 10.12 – Visual Studio with our new solution loaded"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.12 – Visual Studio with our new solution loaded</p>
			<ol>
				<li value="15">The <a id="_idIndexMarker754"/>markdown file named <strong class="source-inline">README.md</strong> will <a id="_idIndexMarker755"/>be opened by default. If you want to view a formatted preview of the markdown, you can select the <strong class="bold">Preview</strong> button at the top of the <span class="No-Break">editor window:</span></li>
			</ol>
			<div>
				<div id="_idContainer109" class="IMG---Figure">
					<img src="image/B20908_10_013.jpg" alt="Figure 10.13 – Viewing the formatted README file"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.13 – Viewing the formatted README file</p>
			<p class="list-inset">The <a id="_idIndexMarker756"/>solution contains three projects: <strong class="bold">TemplateStudioSampleApp</strong>, <strong class="bold">TemplateStudioSampleApp.Core</strong>, and <strong class="bold">TemplateStudioSampleApp.Tests.MSTest</strong>. We’ll discuss the purpose and contents of <a id="_idIndexMarker757"/>each of these projects in the <span class="No-Break">next section:</span></p>
			<div>
				<div id="_idContainer110" class="IMG---Figure">
					<img src="image/B20908_10_14.jpg" alt="Figure 10.14 – Viewing the projects in Solution Explorer"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.14 – Viewing the projects in Solution Explorer</p>
			<ol>
				<li value="16">It’s<a id="_idIndexMarker758"/> finally time to run the application. Start <a id="_idIndexMarker759"/>debugging and ensure that there are no compile-time or runtime errors when <span class="No-Break">launching it:</span></li>
			</ol>
			<div>
				<div id="_idContainer111" class="IMG---Figure">
					<img src="image/B20908_10_15.jpg" alt="Figure 10.15 – Running the TemplateStudioSampleApp solution"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.15 – Running the TemplateStudioSampleApp solution</p>
			<p class="list-inset">Everything should run as expected, and you can try navigating to each page with the <strong class="source-inline">NavigationView</strong> controls on the left. The <strong class="bold">Settings</strong> button will always appear at the bottom of the <span class="No-Break">navigation bar.</span></p>
			<p>Now that we have a working application, let’s take some time to understand what’s been generated <span class="No-Break">for us.</span></p>
			<h1 id="_idParaDest-211"><a id="_idTextAnchor320"/>Exploring the code generated by Template Studio</h1>
			<p>It’s time to review the contents of the newly generated <strong class="bold">TemplateStudioSampleApp</strong> solution. There is a lot of code created for us in the three projects, so we won’t be exploring every file. We’ll discuss each folder, explore a few of the important files, and make some minor code changes along the way. Each project has its own <strong class="source-inline">README.md</strong> file with an overview of the project and <span class="No-Break">its purpose.</span></p>
			<h2 id="_idParaDest-212"><a id="_idTextAnchor321"/>Exploring the Core project</h2>
			<p>The <strong class="bold">TemplateStudioSampleApp.Core</strong> project is a class library project targeting .NET 7. This <a id="_idIndexMarker760"/>is where you would place any code that is intended to be shared across projects. The project contains <span class="No-Break">four folders:</span></p>
			<ul>
				<li><strong class="source-inline">Contracts</strong>: Interfaces for the services in the project are kept here in a <strong class="source-inline">Services</strong> subfolder. Any new interfaces needed in this project should be <span class="No-Break">created here.</span></li>
				<li><strong class="source-inline">Helpers</strong>: This folder contains a <strong class="source-inline">Json</strong> helper class with methods to convert between <strong class="bold">JSON</strong> strings and .NET objects. Add your own common helper classes to <span class="No-Break">this folder.</span></li>
				<li><strong class="source-inline">Models</strong>: There are some sample model classes in this folder that are used to populate company and order data on the <strong class="source-inline">DataGridPage</strong> and <span class="No-Break"><strong class="source-inline">ListDetailPage</strong></span><span class="No-Break"> views.</span></li>
				<li><strong class="source-inline">Services</strong>: This folder contains <strong class="source-inline">FileService</strong> and <strong class="source-inline">SampleDataService</strong> classes. The <strong class="source-inline">FileService</strong> class reads and writes files with classes in the .NET <strong class="source-inline">System.IO</strong> and <strong class="source-inline">System.Text</strong> namespaces. The <strong class="source-inline">SampleDataService</strong> creates static data to populate the model classes for the UI. Any other shared services can be <span class="No-Break">added here.</span></li>
			</ul>
			<p class="callout-heading">Note</p>
			<p class="callout">It’s possible that the Template Studio extensions may be updated to create .NET 8 libraries by the time this book <span class="No-Break">is published.</span></p>
			<p>Next, let’s explore the largest project in the <span class="No-Break">solution, </span><span class="No-Break"><strong class="bold">TemplateStudioSampleApp</strong></span><span class="No-Break">.</span></p>
			<h2 id="_idParaDest-213"><a id="_idTextAnchor322"/>Exploring the main project</h2>
			<p>The main <a id="_idIndexMarker761"/>project, <strong class="bold">TemplateStudioSampleApp</strong>, is the largest of the three projects in the solution. It contains all the user interface markup and logic. You will probably recognize the files in the root of the project, after working with other WinUI projects. <strong class="bold">App.xaml</strong>, <strong class="bold">MainWindow.xaml</strong>, and <strong class="bold">Package.appxmanifest</strong> are all there, along with C# code-behind files for each <span class="No-Break">XAML file.</span></p>
			<p>The contents of the <strong class="bold">Views</strong> and <strong class="bold">ViewModels</strong> folders also contain files that you would expect to find there. We have a corresponding <strong class="source-inline">Page</strong> and <strong class="source-inline">ViewModel</strong> class for each page that we selected when configuring the project with the Template Studio wizard. There are also <strong class="source-inline">ShellPage</strong> and <strong class="source-inline">ShellViewModel</strong> classes for handling the navigation between child pages. <strong class="bold">ShellPage.xaml</strong> contains the <strong class="source-inline">NavigationView</strong> control and is the direct child <span class="No-Break">of </span><span class="No-Break"><strong class="source-inline">MainWindow</strong></span><span class="No-Break">.</span></p>
			<p>Next, let’s go through the contents of the <span class="No-Break">remaining folders:</span></p>
			<ul>
				<li><strong class="source-inline">Activation</strong>: This folder contains the <span class="No-Break"><strong class="source-inline">ActivationHandler</strong></span><span class="No-Break">, </span><span class="No-Break"><strong class="source-inline">DefaultActivation</strong></span><strong class="source-inline"> Handler</strong>, and <strong class="source-inline">IActivationHandler</strong> classes. They are helpers that use the <strong class="source-inline">INavigationService</strong> to navigate to the selected page inside the <strong class="source-inline">Frame</strong> hosted within <strong class="source-inline">ShellPage</strong>. If you needed to change the default activation behavior, you would create a new handler that inherits <span class="No-Break">from </span><span class="No-Break"><strong class="source-inline">ActivationHandler</strong></span><span class="No-Break">.</span></li>
				<li><strong class="source-inline">Assets</strong>: This contains the graphical assets for the project. The <strong class="source-inline">Assets</strong> folder is present in every <span class="No-Break">WinUI project.</span></li>
				<li><strong class="source-inline">Behaviors</strong>: This folder contains an enum named <strong class="source-inline">NavigationViewHeaderMode</strong>, which specifies the appearance of the navigation bar, and <strong class="source-inline">NavigationViewHeaderBehavior</strong>, which contains the logic to implement these modes. The behavior class inherits from <strong class="source-inline">Behavior&lt;NavigationView&gt;</strong>. Any other custom WinUI behaviors would be <span class="No-Break">added here.</span></li>
				<li><strong class="source-inline">Contracts</strong>: This is where you keep your interfaces for the project. The two subfolders, <strong class="source-inline">Services</strong> and <strong class="source-inline">ViewModels</strong>, contain interfaces for eight existing classes in those corresponding <span class="No-Break">project folders.</span></li>
				<li><strong class="source-inline">Helpers</strong>: Any helper classes specific to this project are kept here. Some of the helpers provided by default include <strong class="source-inline">NavigationHelper</strong>, <strong class="source-inline">SettingsStorageExtensions</strong>, and <strong class="source-inline">TitleBarHelper</strong>. The <strong class="source-inline">SettingsStorageExtensions</strong> helper class leverages members of the <strong class="source-inline">Windows.Storage</strong> and <strong class="source-inline">Windows.Storage.Streams</strong> namespaces to read and write <span class="No-Break">user settings.</span></li>
				<li><strong class="source-inline">Models</strong>: The sample data models are kept in the <strong class="bold">Core</strong> project, but there’s also one model class in this project. The <strong class="source-inline">LocalSettingsOptions</strong> class stores the name and location of the settings file. Any other UI-specific model classes would be <span class="No-Break">added here.</span></li>
				<li><strong class="source-inline">Services</strong>: There are seven service classes in the <strong class="source-inline">Services</strong> folder. You can probably determine the purpose of each by its name: <span class="No-Break"><strong class="source-inline">ActivationService</strong></span><span class="No-Break">, </span><span class="No-Break"><strong class="source-inline">LocalSettings</strong></span><strong class="source-inline"> Service</strong>, <strong class="source-inline">NavigationService</strong>, <strong class="source-inline">NavigationViewService</strong>, <strong class="source-inline">PageService</strong>, <strong class="source-inline">ThemeSelectorService</strong>, and <strong class="source-inline">WebViewService</strong>. You should take some time to review the code in <span class="No-Break">these services.</span></li>
				<li><strong class="source-inline">Strings</strong>: This <a id="_idIndexMarker762"/>folder holds language-specific <strong class="source-inline">Resources.resw</strong> files to localize any string values displayed in your application. The English language resource file can be found in the <strong class="source-inline">en-us</strong> folder. For more information about localization, you should read <em class="italic">Localize your WinUI 3 app</em> on Microsoft <span class="No-Break">Learn: </span><a href="https://learn.microsoft.com/windows/apps/winui/winui3/localize-winui3-app"><span class="No-Break">https://learn.microsoft.com/windows/apps/winui/winui3/localize-winui3-app</span></a><span class="No-Break">.</span></li>
				<li><strong class="source-inline">Styles</strong>: This folder contains three files with XAML <strong class="source-inline">ResourceDictionary</strong> elements: <strong class="source-inline">FontSizes.xaml</strong>, <strong class="source-inline">TextBlock.xaml</strong>, and <strong class="source-inline">Thickness.xaml</strong>. Let’s look at the contents of <strong class="source-inline">FontSizes.xaml</strong> as <span class="No-Break">an example:</span><pre class="source-code">
&lt;ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/
      2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/
      2006/xaml"&gt;
    &lt;x:Double x:Key="LargeFontSize"&gt;24&lt;/x:Double&gt;
    &lt;x:Double x:Key="MediumFontSize"&gt;16&lt;/x:Double&gt;
&lt;/ResourceDictionary&gt;</pre><p class="list-inset">By centralizing how your app defines a <a id="_idIndexMarker763"/>large or medium font size, you can change this later without having to modify multiple XAML views. If you are using a <strong class="source-inline">TextBlock</strong> or <strong class="source-inline">RichTextBlock</strong>, the other option for <a id="_idIndexMarker764"/>font sizing is to use the <strong class="bold">XAML type ramp</strong> (discussed in <a href="B20908_07.xhtml#_idTextAnchor152"><span class="No-Break"><em class="italic">Chapter 7</em></span></a>, <em class="italic">Fluent Design System for Windows Applications</em>) defined in the XAML theme <span class="No-Break">resources: </span><a href="https://learn.microsoft.com/windows/apps/design/style/xaml-theme-resources#the-xaml-type-ramp"><span class="No-Break">https://learn.microsoft.com/windows/apps/design/style/xaml-theme-resources#the-xaml-type-ramp</span></a><span class="No-Break">.</span></p></li>			</ul>
			<p>Before we move on to explore the <strong class="bold">MSTest</strong> project, let’s look inside the <strong class="source-inline">App.xaml.cs</strong> file. Everything in here should look familiar to you. The project is using the <strong class="source-inline">IHostBuilder.ConfigureServices</strong> method to add the <strong class="source-inline">ActivationHandler</strong> and all services, views, and ViewModel classes to the DI container. The services and core services are added as singleton objects while all the other classes are added <span class="No-Break">with </span><span class="No-Break"><strong class="source-inline">AddTransient</strong></span><span class="No-Break">.</span></p>
			<p>The <strong class="source-inline">App</strong> class also has a handy helper method to fetch an instance from the <span class="No-Break">DI container:</span></p>
			<pre class="source-code">
public static T GetService&lt;T&gt;() T : class
{
    if ((App.Current as App)!.Host.Services.GetService
      (typeof(T)) is not T service)
    {
        throw new ArgumentException($"{typeof(T)} needs to
          be registered in ConfigureServices within
            App.xaml.cs.");
    }
    return service;
}</pre>			<p>This <a id="_idIndexMarker765"/>encapsulates some exception-handling logic in case the requested type cannot be found, reducing the need to repeat this code throughout <span class="No-Break">the application.</span></p>
			<p>Notice how each class has helpful comments with links to Microsoft Learn resources for any related APIs or other topics. The <strong class="source-inline">App</strong> class has links to .NET dependency injection, logging, and other <span class="No-Break">learning resources.</span></p>
			<p>Let’s finish this section with a quick look at the <strong class="bold">MSTest</strong> project that was created by <span class="No-Break">Template Studio.</span></p>
			<h2 id="_idParaDest-214"><a id="_idTextAnchor323"/>Exploring the MSTest project</h2>
			<p>The <strong class="bold">TemplateStudioSampleApp.Tests.MSTest</strong> project contains a single test class named <strong class="source-inline">TestClass</strong>, a <strong class="source-inline">README.md</strong> file, and <strong class="source-inline">Initialize</strong> and <strong class="source-inline">Usings</strong> classes. You should<a id="_idIndexMarker766"/> read the <strong class="source-inline">README.md</strong> file carefully. It contains information about the project, testing UI elements, dependency injection, and mocking. There are examples of how to leverage DI and mocks to test the <strong class="source-inline">SettingsViewModel</strong> without actually reading or writing any settings to <span class="No-Break">the filesystem.</span></p>
			<p>The <strong class="source-inline">TestClass</strong> contains examples of test initialization and cleanup at the class and test level, as well as two sample test methods: <strong class="source-inline">TestMethod</strong> <span class="No-Break">and </span><span class="No-Break"><strong class="source-inline">UITestMethod</strong></span><span class="No-Break">:</span></p>
			<pre class="source-code">
[TestMethod]
public void TestMethod()
{
    Assert.IsTrue(true);
}
[UITestMethod]
public void UITestMethod()
{
    Assert.AreEqual(0, new Grid().ActualWidth);
}</pre>			<p>Any test method decorated with the <strong class="source-inline">UITestMethod</strong> attribute will run on the UI thread. The generated code does not test any members of the <strong class="bold">TemplateStudioSampleApp</strong> or <strong class="bold">TemplateStudioSampleApp.Core</strong> projects yet. It’s up to you to <a id="_idIndexMarker767"/>add your own test methods to do that. You can get started by reading the Visual Studio unit testing documentation on Microsoft <span class="No-Break">Learn: </span><a href="https://learn.microsoft.com/visualstudio/test/getting-started-with-unit-testing"><span class="No-Break">https://learn.microsoft.com/visualstudio/test/getting-started-with-unit-testing</span></a><span class="No-Break">.</span></p>
			<p>In the next section, we will discuss some other Template Studio extensions created by Microsoft and one from a <span class="No-Break">third party.</span></p>
			<h1 id="_idParaDest-215"><a id="_idTextAnchor324"/>Template Studio extensions for other UI frameworks</h1>
			<p>We’ve <a id="_idIndexMarker768"/>taken a deep dive into the Template Studio for WinUI extension, but what about the UI frameworks? As we mentioned earlier in the chapter, Microsoft also maintains extensions for Template Studio for <a id="_idIndexMarker769"/>WPF and <a id="_idIndexMarker770"/>Template Studio for UWP. In fact, they even have<a id="_idIndexMarker771"/> a <strong class="bold">Microsoft Web Template Studio</strong> available: <a href="https://github.com/microsoft/WebTemplateStudio">https://github.com/microsoft/WebTemplateStudio</a>. It supports <strong class="bold">React</strong>, <strong class="bold">Angular</strong>, or <strong class="bold">Vue.js</strong> for<a id="_idIndexMarker772"/> the frontend <a id="_idIndexMarker773"/>and <strong class="bold">Node.js</strong>, <strong class="bold">Flask</strong>, <strong class="bold">Molecular</strong>, and <strong class="bold">ASP.NET Core</strong> as <a id="_idIndexMarker774"/>backend frameworks. If you’re interested in<a id="_idIndexMarker775"/> web <a id="_idIndexMarker776"/>development, you should check<a id="_idIndexMarker777"/> <span class="No-Break">it out.</span></p>
			<p>There is also an <a id="_idIndexMarker778"/>extension called <strong class="bold">MAUI App Accelerator</strong> (<a href="https://marketplace.visualstudio.com/items?itemName=MattLaceyLtd.MauiAppAccelerator">https://marketplace.visualstudio.com/items?itemName=MattLaceyLtd.MauiAppAccelerator</a>), which is a Template Studio version for .NET MAUI. We’ll remain focused on WinUI and WPF templates in this chapter. The final two we’ll review are Template Studio for WPF and the Template Studio-style wizard that comes with the Uno Platform extension for Visual Studio. Let’s start <span class="No-Break">with WPF.</span></p>
			<h2 id="_idParaDest-216"><a id="_idTextAnchor325"/>Template Studio for WPF</h2>
			<p>The Template Studio for<a id="_idIndexMarker779"/> WPF extension (<a href="https://marketplace.visualstudio.com/items?itemName=TemplateStudio.TemplateStudioForWPF">https://marketplace.visualstudio.com/items?itemName=TemplateStudio.TemplateStudioForWPF</a>) is similar to its WinUI counterpart. It has one additional step in the wizard (<strong class="bold">Services</strong>), and there are a few different options on some of the pages. One of the project types available to WPF developers is the <strong class="bold">Ribbon</strong> type. This creates a shell with a Microsoft Office-style ribbon control at the top in place of the standard menu control you would get in a <span class="No-Break"><strong class="bold">MenuBar</strong></span><span class="No-Break">-type project.</span></p>
			<p>The <strong class="bold">Design pattern</strong> screen allows you to select <strong class="bold">Code Behind</strong> or <strong class="bold">Prism</strong>, in addition to the <strong class="bold">MVVM Toolkit</strong> option. While the <strong class="bold">Page</strong> options are the same as WinUI, the <strong class="bold">Features</strong> screen has an option with the ability to show multiple views in separate windows. The <strong class="bold">Services</strong> screen has two identity-related options: <strong class="bold">Forced Login</strong> and <strong class="bold">Optional Login</strong>. Finally, the <strong class="bold">Testing</strong> screen has seven different options, rather than just <strong class="bold">MSTest</strong>. The additional<a id="_idIndexMarker780"/> testing <a id="_idIndexMarker781"/>frameworks provided <a id="_idIndexMarker782"/>are <strong class="bold">NUnit</strong>, <strong class="bold">xUnit</strong>, and <strong class="bold">Appium</strong> (for UI tests), and there are options to add test projects for the main project and the <strong class="bold">Core</strong> <span class="No-Break">library project.</span></p>
			<p>The generated projects have the same folder structure as the WinUI projects. Here’s an example of a generated WPF project with an empty <span class="No-Break">ribbon control:</span></p>
			<div>
				<div id="_idContainer112" class="IMG---Figure">
					<img src="image/B20908_10_16.jpg" alt="Figure 10.16 – A WPF project created by Template Studio"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.16 – A WPF project created by Template Studio</p>
			<p>Let’s finish up by taking a look at the Template Studio wizard provided by the Uno <span class="No-Break">Platform extension.</span></p>
			<h2 id="_idParaDest-217"><a id="_idTextAnchor326"/>Template Studio for Uno Platform</h2>
			<p><strong class="bold">Uno Platform</strong> (<a href="https://platform.uno/">https://platform.uno/</a>) is a <a id="_idIndexMarker783"/>UI framework that uses WinUI XAML and .NET code, and it<a id="_idIndexMarker784"/> can create applications to target virtually every available <a id="_idIndexMarker785"/>device platform today: Windows, iOS, Android, macOS, Tizen, web (with <strong class="bold">WebAssembly</strong>), and even Linux. The<a id="_idIndexMarker786"/> Uno Platform extension for Visual Studio (<a href="https://marketplace.visualstudio.com/items?itemName=unoplatform.uno-platform-addin-2022">https://marketplace.visualstudio.com/items?itemName=unoplatform.uno-platform-addin-2022</a>) includes a new project wizard that is based on the Template <span class="No-Break">Studio code.</span></p>
			<p>If you install the extension in Visual Studio and create a new project with the <strong class="bold">Uno Platform App</strong> template, clicking the <strong class="bold">Create</strong> button from the <strong class="bold">Configure your new project</strong> screen will launch <span class="No-Break">the wizard:</span></p>
			<div>
				<div id="_idContainer113" class="IMG---Figure">
					<img src="image/B20908_10_17.jpg" alt="Figure 10.17 – The Uno Platform new project screen"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.17 – The Uno Platform new project screen</p>
			<p>From here, you can<a id="_idIndexMarker787"/> simply select <strong class="bold">Create</strong> to accept all the defaults and generate a new solution. However, if you select the <strong class="bold">Customize</strong> button on the <strong class="bold">Default</strong> startup type, you will get the full <span class="No-Break">wizard experience:</span></p>
			<div>
				<div id="_idContainer114" class="IMG---Figure">
					<img src="image/B20908_10_18.jpg" alt="Figure 10.18 – The Uno Platform new project wizard"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.18 – The Uno Platform new project wizard</p>
			<p>From here, you can <a id="_idIndexMarker788"/>select from options in 10 different categories. Even though the wizard is styled a bit differently, you can see that it has the same origins as the Template Studio extensions. We will get into the details of each step of the wizard when we build an Uno Platform app in <a href="B20908_13.xhtml#_idTextAnchor570"><span class="No-Break"><em class="italic">Chapter 13</em></span></a>, <em class="italic">Take Your App Cross-Platform with Uno Platform</em>. If you create a new Uno Platform project with the defaults and run the <strong class="bold">UnoApp1.Wasm</strong> project, you’ll see your app running in the browser by <span class="No-Break">leveraging WebAssembly:</span></p>
			<div>
				<div id="_idContainer115" class="IMG---Figure">
					<img src="image/B20908_10_19.jpg" alt="Figure 10.19 – Running an Uno Platform app in the browser"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.19 – Running an Uno Platform app in the browser</p>
			<p>That’s very cool! Now let’s wrap up and review what we’ve learned in <span class="No-Break">this chapter.</span></p>
			<h1 id="_idParaDest-218"><a id="_idTextAnchor327"/>Summary</h1>
			<p>In this chapter, we learned how the Template Studio for WinUI extension can save time and promote good patterns and practices when starting a new WinUI project. We stepped through the creation of a new WinUI project with the wizard and explored the generated code in the new solution. Understanding the structure and purpose of the solution’s components will make it easier to extend it for your own projects. We wrapped things up by discussing the Template Studio extensions that are available for other UI frameworks such as WPF and <span class="No-Break">Uno Platform.</span></p>
			<p>In the next chapter, <a href="B20908_11.xhtml#_idTextAnchor330"><span class="No-Break"><em class="italic">Chapter 11</em></span></a>, <em class="italic">Debugging WinUI Apps with Visual Studio</em>, we will explore the tools and options provided by Visual Studio to make .NET and XAML developers’ <span class="No-Break">lives easier.</span></p>
			<h1 id="_idParaDest-219"><a id="_idTextAnchor328"/>Questions</h1>
			<ol>
				<li>Which unit test framework is used when creating a test project in Template Studio <span class="No-Break">for WinUI?</span></li>
				<li>Which project type in Template Studio for WinUI implements a <span class="No-Break"><strong class="source-inline">NavigationView</strong></span><span class="No-Break"> control?</span></li>
				<li>What was the previous name of Template Studio <span class="No-Break">for UWP?</span></li>
				<li>Which MVVM framework is used by Template Studio for WinUI when generating <span class="No-Break">a project?</span></li>
				<li>What file format is used for Visual <span class="No-Break">Studio extensions?</span></li>
				<li>Which Template Studio extension could you use to create a new project if you needed to include Linux as one of your <span class="No-Break">target platforms?</span></li>
				<li>Which folder contains all the interfaces for the main project generated by Template Studio <span class="No-Break">for WinUI?</span></li>
			</ol>
		</div>
	

		<div id="_idContainer117" class="Content">
			<h1 id="_idParaDest-220" lang="en-US" xml:lang="en-US"><a id="_idTextAnchor329"/>Part 3:Build and Deploy on Windows and Beyond</h1>
			<p>This part rounds out your WinUI knowledge by exploring techniques to debug, build, and deploy WinUI 3 applications. You will explore the extensive debugging tools Visual Studio has to offer WinUI developers. Then, you will see how you can host a web application inside a WinUI application, leveraging Blazor, Visual Studio Code, GitHub Actions, and the WebView2 control. We’ll also learn how to migrate a WinUI project to Uno Platform to run on multiple platforms, including Android and the web with WebAssembly. Finally, you’ll learn about the options to build and deploy WinUI applications with Visual Studio, the Microsoft Store, and Microsoft’s command-line installer, Windows Package <span class="No-Break">Manager (WinGet).</span></p>
			<p>This part has the <span class="No-Break">following chapters:</span></p>
			<ul>
				<li><a href="B20908_11.xhtml#_idTextAnchor330"><em class="italic">Chapter 11</em></a>, <em class="italic">Debugging WinUI Applications with Visual Studio</em></li>
				<li><a href="B20908_12.xhtml#_idTextAnchor454"><em class="italic">Chapter 12</em></a>, <em class="italic">Hosting a Blazor Application in WinUI</em></li>
				<li><a href="B20908_13.xhtml#_idTextAnchor570"><em class="italic">Chapter 13</em></a>, <em class="italic">Take Your App Cross-Platform with Uno Platform</em></li>
				<li><a href="B20908_14.xhtml#_idTextAnchor582"><em class="italic">Chapter 14</em></a>, <em class="italic">Packaging and Deploying WinUI Applications</em></li>
			</ul>
		</div>
		<div>
			<div id="_idContainer118">
			</div>
		</div>
		<div>
			<div id="_idContainer119" class="Basic-Graphics-Frame">
			</div>
		</div>
	</body></html>