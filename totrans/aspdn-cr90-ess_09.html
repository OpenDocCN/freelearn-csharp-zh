<html><head></head><body>
  <div id="_idContainer111">
   <h1 class="chapter-number" id="_idParaDest-145">
    <a id="_idTextAnchor146">
    </a>
    <span class="koboSpan" id="kobo.1.1">
     9
    </span>
   </h1>
   <h1 id="_idParaDest-146">
    <a id="_idTextAnchor147">
    </a>
    <span class="koboSpan" id="kobo.2.1">
     Managing Application Settings
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.3.1">
     In the dynamic world of web applications, the ability to adapt to different environments and requirements is crucial.
    </span>
    <span class="koboSpan" id="kobo.3.2">
     ASP.NET Core 9 provides a robust configuration system that allows developers to manage settings and behavior effectively.
    </span>
    <span class="koboSpan" id="kobo.3.3">
     This chapter will explore the importance of application settings, how to manage them using the configuration system, and how to make your applications adaptable
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.4.1">
      at runtime.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.5.1">
     In this chapter, we will focus on the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.6.1">
      following topics:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.7.1">
      Understanding
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.8.1">
       IConfiguration
      </span>
     </strong>
     <span class="koboSpan" id="kobo.9.1">
      concepts
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.10.1">
       and abstractions
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.11.1">
      Working with
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.12.1">
       configuration providers
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.13.1">
      Learning about the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.14.1">
       Options pattern
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.15.1">
      Working with dynamic configurations
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.16.1">
       and behaviors
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.17.1">
     ASP.NET Core 9 provides a robust configuration system that allows developers to effectively manage configurations and behaviors.
    </span>
    <span class="koboSpan" id="kobo.17.2">
     This chapter will explore the importance of application configurations, how to manage them using the configuration system, and how to make your applications adaptive
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.18.1">
      at runtime.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-147">
    <a id="_idTextAnchor148">
    </a>
    <span class="koboSpan" id="kobo.19.1">
     Technical requirements
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.20.1">
     To support the learning of this chapter, the following tools must be present in your
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.21.1">
      development environment:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.22.1">
       Docker
      </span>
     </strong>
     <span class="koboSpan" id="kobo.23.1">
      : The Docker engine must be installed on your operating system and have a SQL Server container running.
     </span>
     <span class="koboSpan" id="kobo.23.2">
      You can find more details about Docker and SQL Server containers in
     </span>
     <a href="B21788_05.xhtml#_idTextAnchor078">
      <span class="No-Break">
       <em class="italic">
        <span class="koboSpan" id="kobo.24.1">
         Chapter 5
        </span>
       </em>
      </span>
     </a>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.25.1">
       .
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.26.1">
       Postman
      </span>
     </strong>
     <span class="koboSpan" id="kobo.27.1">
      : This tool will be used to execute requests to APIs of the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.28.1">
       developed application.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.29.1">
       Redis Insight
      </span>
     </strong>
     <span class="koboSpan" id="kobo.30.1">
      : This tool is used to connect to a Redis server
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.31.1">
       database (
      </span>
     </span>
     <a href="https://redis.io/insight/">
      <span class="No-Break">
       <span class="koboSpan" id="kobo.32.1">
        https://redis.io/insight/
       </span>
      </span>
     </a>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.33.1">
       ).
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.34.1">
     You will also need access to an
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.35.1">
      Azure subscription.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.36.1">
     The code examples used in this chapter can be found in the book’s GitHub
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.37.1">
      repository:
     </span>
    </span>
    <a href="https://github.com/PacktPublishing/ASP.NET-Core-9.0-Essentials/tree/main/Chapter09">
     <span class="No-Break">
      <span class="koboSpan" id="kobo.38.1">
       https://github.com/PacktPublishing/ASP.NET-Core-9.0-Essentials/tree/main/Chapter09
      </span>
     </span>
    </a>
   </p>
   <h1 id="_idParaDest-148">
    <a id="_idTextAnchor149">
    </a>
    <span class="koboSpan" id="kobo.39.1">
     Understanding IConfiguration concepts and abstractions
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.40.1">
     In the dynamic world of web applications, the ability to adapt to different environments and requirements is crucial, in addition to security requirements that have become increasingly essential in applications that run on different
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.41.1">
      cloud providers.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.42.1">
     Most web applications have some type of configuration managed in files or classes, in order to centralize parameters that are used throughout the application flow.
    </span>
    <span class="koboSpan" id="kobo.42.2">
     With each change in configurations or even application behaviors, a new version of the software must be generated.
    </span>
    <span class="koboSpan" id="kobo.42.3">
     Furthermore, when working with remote teams, it is essential to maintain the correct management of configurations and sensitive data and not keep these parameters versioned in the application
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.43.1">
      version control.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.44.1">
     ASP.NET Core 9 provides powerful ways to manage application configurations in addition to enabling the use of other features, such as changing application behaviors without the need to generate new versions of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.45.1">
      the software.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.46.1">
     We will start learning about these resources via the fundamentals of configuration management through the
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.47.1">
       IConfiguration
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.48.1">
      interface.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-149">
    <a id="_idTextAnchor150">
    </a>
    <span class="koboSpan" id="kobo.49.1">
     IConfiguration interface
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.50.1">
     ASP.NET Core 9 has
    </span>
    <a id="_idIndexMarker704">
    </a>
    <span class="koboSpan" id="kobo.51.1">
     the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.52.1">
      IConfiguration
     </span>
    </strong>
    <span class="koboSpan" id="kobo.53.1">
     interface, which aims to provide a mechanism for managing application settings and configurations in a unified manner, allowing access to diverse configuration sources such as JSON files, environment variables,
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.54.1">
      and arguments.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.55.1">
     Among the main concepts regarding the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.56.1">
      IConfiguration
     </span>
    </strong>
    <span class="koboSpan" id="kobo.57.1">
     interface, we have
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.58.1">
      the following:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.59.1">
       Configuration sources
      </span>
     </strong>
     <span class="koboSpan" id="kobo.60.1">
      : Support multiple
     </span>
     <a id="_idIndexMarker705">
     </a>
     <span class="koboSpan" id="kobo.61.1">
      configuration sources, which can be combined and layered.
     </span>
     <span class="koboSpan" id="kobo.61.2">
      Common sources include JSON files (such as
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.62.1">
       appsettings.json
      </span>
     </strong>
     <span class="koboSpan" id="kobo.63.1">
      ), environment variables, command-line arguments, and
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.64.1">
       user secrets.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.65.1">
       Hierarchical configuration
      </span>
     </strong>
     <span class="koboSpan" id="kobo.66.1">
      : Configuration settings are organized in a hierarchical structure.
     </span>
     <span class="koboSpan" id="kobo.66.2">
      This
     </span>
     <a id="_idIndexMarker706">
     </a>
     <span class="koboSpan" id="kobo.67.1">
      means that settings can be nested into sections, making complex settings easier
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.68.1">
       to manage.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.69.1">
       Options pattern
      </span>
     </strong>
     <span class="koboSpan" id="kobo.70.1">
      : The Options pattern
     </span>
     <a id="_idIndexMarker707">
     </a>
     <span class="koboSpan" id="kobo.71.1">
      uses
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.72.1">
       IConfiguration
      </span>
     </strong>
     <span class="koboSpan" id="kobo.73.1">
      to bind configuration settings to strongly
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.74.1">
       typed objects.
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.75.1">
     In
    </span>
    <a href="B21788_05.xhtml#_idTextAnchor078">
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.76.1">
        Chapter 5
       </span>
      </em>
     </span>
    </a>
    <span class="koboSpan" id="kobo.77.1">
     , we used the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.78.1">
      appsettings.json
     </span>
    </strong>
    <span class="koboSpan" id="kobo.79.1">
     file to manage the connection string with the SQL Server database and retrieved the value of this configuration through the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.80.1">
      IConfiguration
     </span>
    </strong>
    <span class="koboSpan" id="kobo.81.1">
     interface, in the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.82.1">
      Program.cs
     </span>
    </strong>
    <span class="koboSpan" id="kobo.83.1">
     class.
    </span>
    <span class="koboSpan" id="kobo.83.2">
     This practice brings several benefits, such as
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.84.1">
      the following:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.85.1">
       Flexibility
      </span>
     </strong>
     <span class="koboSpan" id="kobo.86.1">
      :
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.87.1">
       IConfiguration
      </span>
     </strong>
     <span class="koboSpan" id="kobo.88.1">
      allows you to extract configuration values from multiple sources, offering flexibility
     </span>
     <a id="_idIndexMarker708">
     </a>
     <span class="koboSpan" id="kobo.89.1">
      in how you manage configurations across different environments (development,
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.90.1">
       test, production)
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.91.1">
       Centralized management
      </span>
     </strong>
     <span class="koboSpan" id="kobo.92.1">
      : Centralizes configuration management, making it easier to maintain and update
     </span>
     <a id="_idIndexMarker709">
     </a>
     <span class="koboSpan" id="kobo.93.1">
      settings without spreading them across
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.94.1">
       the application
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.95.1">
       Environment-specific settings
      </span>
     </strong>
     <span class="koboSpan" id="kobo.96.1">
      : Supports environment-specific configuration, allowing you to
     </span>
     <a id="_idIndexMarker710">
     </a>
     <span class="koboSpan" id="kobo.97.1">
      customize settings based on the environment in which the application
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.98.1">
       is running
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.99.1">
       Strongly typed configuration
      </span>
     </strong>
     <span class="koboSpan" id="kobo.100.1">
      : Through the
     </span>
     <a id="_idIndexMarker711">
     </a>
     <span class="koboSpan" id="kobo.101.1">
      Options pattern, it supports configuration settings linked to strongly typed classes, improving type safety and
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.102.1">
       reducing errors
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.103.1">
     The following code examples
    </span>
    <a id="_idIndexMarker712">
    </a>
    <span class="koboSpan" id="kobo.104.1">
     demonstrate a configuration defined in the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.105.1">
      appsettings.json
     </span>
    </strong>
    <span class="koboSpan" id="kobo.106.1">
     file; this value is then retrieved through the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.107.1">
      IConfiguration
     </span>
    </strong>
    <span class="koboSpan" id="kobo.108.1">
     interface, in the
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.109.1">
       Program.cs
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.110.1">
      file:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.111.1">
      The following is the content of the
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.112.1">
        appsettings.json
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.113.1">
       file:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.114.1">
{
  "ConnectionStrings": {
    "DefaultConnection": "Server=myServerAddress;
      Database=myDataBase;User Id=myUsername;
      Password=myPassword;"
  }
}</span></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.115.1">
      The following is the content of the
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.116.1">
        Program.cs
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.117.1">
       file:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.118.1">
var builder = WebApplication.CreateBuilder(args);
builder.Services.AddRazorPages();
string connectionString = </span><strong class="bold"><span class="koboSpan" id="kobo.119.1">builder.Configuration</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.120.1">  .GetConnectionString("DefaultConnection");</span></strong><span class="koboSpan" id="kobo.121.1">
builder.Services.AddDbContext&lt;MyDbContext&gt;(options =&gt;
  // options.UseSqlServer(connectionString));
  var app = builder.Build();
if (app.Environment.IsDevelopment())
{
    app.UseDeveloperExceptionPage();
}
app.UseStaticFiles();
app.UseRouting();
app.MapRazorPages();
app.Run();</span></pre>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.122.1">
     As we can
    </span>
    <a id="_idIndexMarker713">
    </a>
    <span class="koboSpan" id="kobo.123.1">
     see in the highlighted line of the previous code snippet, the connection string is obtained from the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.124.1">
      appsettings.json
     </span>
    </strong>
    <span class="koboSpan" id="kobo.125.1">
     file using the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.126.1">
      IConfiguration
     </span>
    </strong>
    <span class="koboSpan" id="kobo.127.1">
     interface, using the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.128.1">
      GetConnectionString
     </span>
    </strong>
    <span class="koboSpan" id="kobo.129.1">
     method and informing the configuration name
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.130.1">
      or key.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.131.1">
     As the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.132.1">
      IConfiguration
     </span>
    </strong>
    <span class="koboSpan" id="kobo.133.1">
     lifecycle considers the application lifecycle, all the complexity of obtaining settings through files such as
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.134.1">
      appsettings.json
     </span>
    </strong>
    <span class="koboSpan" id="kobo.135.1">
     or other data sources is abstracted, simply using the methods available in the interface to obtain the desired parameters throughout the ASP.NET Core
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.136.1">
      9 application.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.137.1">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.138.1">
      IConfiguration
     </span>
    </strong>
    <span class="koboSpan" id="kobo.139.1">
     interface is also available in the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.140.1">
      dependency injection container
     </span>
    </strong>
    <span class="koboSpan" id="kobo.141.1">
     (
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.142.1">
      DIC
     </span>
    </strong>
    <span class="koboSpan" id="kobo.143.1">
     ), allowing you
    </span>
    <a id="_idIndexMarker714">
    </a>
    <span class="koboSpan" id="kobo.144.1">
     to reference it in the constructor of any application class that will have its dependencies
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.145.1">
      resolved dynamically.
     </span>
    </span>
   </p>
   <p class="callout-heading">
    <span class="koboSpan" id="kobo.146.1">
     IConfiguration methods
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.147.1">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.148.1">
      IConfiguration
     </span>
    </strong>
    <span class="koboSpan" id="kobo.149.1">
     interface
    </span>
    <a id="_idIndexMarker715">
    </a>
    <span class="koboSpan" id="kobo.150.1">
     provides several extension methods that offer different ways to obtain configuration data in ASP.NET Core 9 applications.
    </span>
    <span class="koboSpan" id="kobo.150.2">
     See the following link for more
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.151.1">
      details:
     </span>
    </span>
    <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.extensions.configuration.iconfiguration?view=net-9.0">
     <span class="No-Break">
      <span class="koboSpan" id="kobo.152.1">
       https://learn.microsoft.com/en-us/dotnet/api/microsoft.extensions.configuration.iconfiguration?view=net-9.0
      </span>
     </span>
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.153.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.154.1">
     The process of obtaining configurations in JSON files is a standard model for use in ASP.NET Core 9 applications.
    </span>
    <span class="koboSpan" id="kobo.154.2">
     However, there are other ways of managing configurations, and for this possibility, there is the concept of providers, which we will explore in the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.155.1">
      next section.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-150">
    <a id="_idTextAnchor151">
    </a>
    <span class="koboSpan" id="kobo.156.1">
     Working with configuration providers
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.157.1">
     Configuration providers
    </span>
    <a id="_idIndexMarker716">
    </a>
    <span class="koboSpan" id="kobo.158.1">
     allow configurations to be obtained from various sources, such as JSON files, environment variables,
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.159.1">
      and more.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.160.1">
     Through configuration providers, we have greater flexibility and the ability to prepare our applications to run in different environments (such as development, test, or production) in an appropriate way without the need to implement string replacement logic in JSON files, in addition to bringing greater reliability
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.161.1">
      and security.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.162.1">
     Next, we will understand how to add other configuration providers to our ASP.NET Core
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.163.1">
      9 applications.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-151">
    <a id="_idTextAnchor152">
    </a>
    <span class="koboSpan" id="kobo.164.1">
     Adding configuration providers
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.165.1">
     Configuration providers
    </span>
    <a id="_idIndexMarker717">
    </a>
    <span class="koboSpan" id="kobo.166.1">
     are used to read configuration data from various sources.
    </span>
    <span class="koboSpan" id="kobo.166.2">
     This flexibility allows you to manage your application’s configuration settings in a consistent and
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.167.1">
      centralized manner.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.168.1">
     This makes it possible to use configuration sources such as databases and even
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.169.1">
      cloud services.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.170.1">
     In ASP.NET Core 9, there are already some configuration providers integrated by default, such as
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.171.1">
      the following:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.172.1">
       JSON configuration provider
      </span>
     </strong>
     <span class="koboSpan" id="kobo.173.1">
      : Reads
     </span>
     <a id="_idIndexMarker718">
     </a>
     <span class="koboSpan" id="kobo.174.1">
      configuration
     </span>
     <a id="_idIndexMarker719">
     </a>
     <span class="koboSpan" id="kobo.175.1">
      data from JSON files such
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.176.1">
       as
      </span>
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.177.1">
        appsettings.json
       </span>
      </strong>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.178.1">
       Environment variable configuration provider
      </span>
     </strong>
     <span class="koboSpan" id="kobo.179.1">
      : Reads configuration data from
     </span>
     <a id="_idIndexMarker720">
     </a>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.180.1">
       environment
      </span>
     </span>
     <span class="No-Break">
      <a id="_idIndexMarker721">
      </a>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.181.1">
       variables
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.182.1">
       Command-line configuration provider
      </span>
     </strong>
     <span class="koboSpan" id="kobo.183.1">
      : Reads
     </span>
     <a id="_idIndexMarker722">
     </a>
     <span class="koboSpan" id="kobo.184.1">
      configuration
     </span>
     <a id="_idIndexMarker723">
     </a>
     <span class="koboSpan" id="kobo.185.1">
      data from
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.186.1">
       command-line arguments
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.187.1">
       Memory configuration provider
      </span>
     </strong>
     <span class="koboSpan" id="kobo.188.1">
      : Allows
     </span>
     <a id="_idIndexMarker724">
     </a>
     <span class="koboSpan" id="kobo.189.1">
      you to add
     </span>
     <a id="_idIndexMarker725">
     </a>
     <span class="koboSpan" id="kobo.190.1">
      in-memory configuration data, useful for
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.191.1">
       unit testing
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.192.1">
     During the implementation of example applications in this book, we have constantly used the following method in the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.193.1">
      Program.cs
     </span>
    </strong>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.194.1">
      file:
     </span>
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.195.1">
       WebApplication.CreateBuilder(args);
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.196.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.197.1">
     This method creates an instance of a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.198.1">
      Builder
     </span>
    </strong>
    <span class="koboSpan" id="kobo.199.1">
     object, which represents a web application and allows us to add features such as services, middleware, and configurations.
    </span>
    <span class="koboSpan" id="kobo.199.2">
     It creates a web application builder with some default parameters, so there is no need to define the provider configuration to obtain configuration data from the
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.200.1">
       appsettings.json
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.201.1">
      file.
     </span>
    </span>
   </p>
   <p class="callout-heading">
    <span class="koboSpan" id="kobo.202.1">
     Default builder settings
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.203.1">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.204.1">
      CreateBuilder
     </span>
    </strong>
    <span class="koboSpan" id="kobo.205.1">
     method defines some standardized parameters for the builder that will be created.
    </span>
    <span class="koboSpan" id="kobo.205.2">
     You can learn more about these parameters by accessing the following
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.206.1">
      URL:
     </span>
    </span>
    <a href="https://learn.microsoft.com/en-us/aspnet/core/fundamentals/host/generic-host?view=aspnetcore-9.0#default-builder-settings">
     <span class="No-Break">
      <span class="koboSpan" id="kobo.207.1">
       https://learn.microsoft.com/en-us/aspnet/core/fundamentals/host/generic-host?view=aspnetcore-9.0#default-builder-settings
      </span>
     </span>
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.208.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.209.1">
     However, observe the following code example from the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.210.1">
      Program.cs
     </span>
    </strong>
    <span class="koboSpan" id="kobo.211.1">
     file where configuration providers are
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.212.1">
      explicitly added:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.213.1">
var builder = WebApplication.CreateBuilder(args);
 // Add configuration from environment variables
</span><strong class="bold"><span class="koboSpan" id="kobo.214.1">builder.Configuration.AddEnvironmentVariables();</span></strong><span class="koboSpan" id="kobo.215.1">
// Add configuration from command-line arguments
</span><strong class="bold"><span class="koboSpan" id="kobo.216.1">builder.Configuration.AddCommandLine(args);</span></strong><span class="koboSpan" id="kobo.217.1">
var app = builder.Build();
app.Run();</span></pre>
   <p>
    <span class="koboSpan" id="kobo.218.1">
     The preceding code uses two extension methods,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.219.1">
      AddEnvironmentVariables
     </span>
    </strong>
    <span class="koboSpan" id="kobo.220.1">
     and
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.221.1">
      AddCommandLine
     </span>
    </strong>
    <span class="koboSpan" id="kobo.222.1">
     , allowing the application to obtain configurations from different providers.
    </span>
    <span class="koboSpan" id="kobo.222.2">
     These extension methods are natively part of ASP.NET Core 9 applications.
    </span>
    <span class="koboSpan" id="kobo.222.3">
     For other types of providers, it may be necessary to add NuGet packages to have access to extension methods for
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.223.1">
      registering providers.
     </span>
    </span>
   </p>
   <p class="callout-heading">
    <span class="koboSpan" id="kobo.224.1">
     Built-in ASP.NET Core 9 configuration providers
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.225.1">
     ASP.NET Core 9
    </span>
    <a id="_idIndexMarker726">
    </a>
    <span class="koboSpan" id="kobo.226.1">
     offers several types of providers natively, as presented in the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.227.1">
      documentation:
     </span>
    </span>
    <a href="https://learn.microsoft.com/en-us/aspnet/core/fundamentals/configuration/?view=aspnetcore-9.0#configuration-providers">
     <span class="No-Break">
      <span class="koboSpan" id="kobo.228.1">
       https://learn.microsoft.com/en-us/aspnet/core/fundamentals/configuration/?view=aspnetcore-9.0#configuration-providers
      </span>
     </span>
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.229.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.230.1">
     In the
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.231.1">
      Working with dynamic configurations and behaviors
     </span>
    </em>
    <span class="koboSpan" id="kobo.232.1">
     section, we will use a provider to connect to a cloud resource that allows the management of configurations and behaviors in a dynamic and secure way.
    </span>
    <span class="koboSpan" id="kobo.232.2">
     For now, let’s understand some important fundamentals, such as creating
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.233.1">
      custom providers.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-152">
    <a id="_idTextAnchor153">
    </a>
    <span class="koboSpan" id="kobo.234.1">
     Creating a custom configuration provider
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.235.1">
     Creating a custom
    </span>
    <a id="_idIndexMarker727">
    </a>
    <span class="koboSpan" id="kobo.236.1">
     configuration provider in ASP.NET Core 9 allows you to load configuration data from sources not natively supported by the framework.
    </span>
    <span class="koboSpan" id="kobo.236.2">
     This can be useful for integrating with custom configuration stores, third-party services, or even
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.237.1">
      proprietary formats.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.238.1">
     We already understand configuration management in native provisions in ASP.NET Core 9; now, we will create our first
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.239.1">
      custom provider.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.240.1">
     To create a custom provider, you need to create
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.241.1">
      two classes:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.242.1">
       ConfigurationSource
      </span>
     </strong>
     <span class="koboSpan" id="kobo.243.1">
      : The
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.244.1">
       IConfigurationSource
      </span>
     </strong>
     <span class="koboSpan" id="kobo.245.1">
      interface represents a source of configuration data.
     </span>
     <span class="koboSpan" id="kobo.245.2">
      It is responsible for creating an instance of
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.246.1">
       IConfigurationProvider
      </span>
     </strong>
     <span class="koboSpan" id="kobo.247.1">
      , which will actually load the data.
     </span>
     <span class="koboSpan" id="kobo.247.2">
      Separating the source and provider interfaces allows for a clear delineation between where configuration data comes from and how it is loaded.
     </span>
     <span class="koboSpan" id="kobo.247.3">
      Through this approach, we benefit from encapsulating data source configurations and implementing best practices through
     </span>
     <a id="_idIndexMarker728">
     </a>
     <span class="koboSpan" id="kobo.248.1">
      the
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.249.1">
        Factory
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.250.1">
       pattern.
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.251.1">
       ConfigurationProvider
      </span>
     </strong>
     <span class="koboSpan" id="kobo.252.1">
      : The
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.253.1">
       ConfigurationProvider
      </span>
     </strong>
     <span class="koboSpan" id="kobo.254.1">
      class is an abstract base class that implements
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.255.1">
       IConfigurationProvider
      </span>
     </strong>
     <span class="koboSpan" id="kobo.256.1">
      .
     </span>
     <span class="koboSpan" id="kobo.256.2">
      It is responsible for the actual loading and providing of configuration data.
     </span>
     <span class="koboSpan" id="kobo.256.3">
      This class allows you to
     </span>
     <a id="_idIndexMarker729">
     </a>
     <span class="koboSpan" id="kobo.257.1">
      define how data is read, cached,
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.258.1">
       and accessed.
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.259.1">
     We will start creating a custom provider through the class responsible for creating a custom
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.260.1">
      provider instance:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.261.1">
using Microsoft.Extensions.Configuration;
public class CustomConfigurationSource :
  </span><strong class="bold"><span class="koboSpan" id="kobo.262.1">IConfigurationSource</span></strong><span class="koboSpan" id="kobo.263.1">
{
</span><strong class="bold"><span class="koboSpan" id="kobo.264.1">  public IConfigurationProvider Build</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.265.1">    (IConfigurationBuilder builder)</span></strong><span class="koboSpan" id="kobo.266.1">
    {
    return new CustomConfigurationProvider();
  }
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.267.1">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.268.1">
      IConfigurationSource
     </span>
    </strong>
    <span class="koboSpan" id="kobo.269.1">
     interface has only one method,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.270.1">
      Build()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.271.1">
     , which is responsible for returning a custom
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.272.1">
      provider instance.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.273.1">
     Despite being simple, this class allows for better separation of responsibilities, with the sole objective of providing an instance of the provider that will have all the necessary mechanisms for interacting with another
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.274.1">
      data source.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.275.1">
     Now, let’s look at the
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.276.1">
       CustomConfigurationProvider
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.277.1">
      class:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.278.1">
using Microsoft.Extensions.Configuration;
using System.Collections.Generic;
public class CustomConfigurationProvider :
  </span><strong class="bold"><span class="koboSpan" id="kobo.279.1">ConfigurationProvider</span></strong><span class="koboSpan" id="kobo.280.1">
{
  public override void </span><strong class="bold"><span class="koboSpan" id="kobo.281.1">Load</span></strong><span class="koboSpan" id="kobo.282.1">()
  {
    var data = new Dictionary&lt;string, string&gt;
    {
      { "MyCustomSetting:Key1", "Value1" },
      { " MyCustomSetting:Key2", "Value2" }
    };
    </span><strong class="bold"><span class="koboSpan" id="kobo.283.1">Data = data;</span></strong><span class="koboSpan" id="kobo.284.1">
  }
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.285.1">
     The custom
    </span>
    <a id="_idIndexMarker730">
    </a>
    <span class="koboSpan" id="kobo.286.1">
     provider implemented in the preceding code has an inheritance from the abstract
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.287.1">
      ConfigurationProvider
     </span>
    </strong>
    <span class="koboSpan" id="kobo.288.1">
     class, which already has some
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.289.1">
      utility implementations.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.290.1">
     For this provider, we are creating two configurations that will be managed by an object of type
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.291.1">
      Dictionary&lt;string, string&gt;
     </span>
    </strong>
    <span class="koboSpan" id="kobo.292.1">
     , allowing us to create configurations based on key and value
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.293.1">
      in memory.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.294.1">
     The logic for managing provided information must be implemented by overriding the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.295.1">
      Load
     </span>
    </strong>
    <span class="koboSpan" id="kobo.296.1">
     method, inherited from the
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.297.1">
       ConfigurationProvider
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.298.1">
      class.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.299.1">
     At the end of the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.300.1">
      Load
     </span>
    </strong>
    <span class="koboSpan" id="kobo.301.1">
     method, it is necessary to set the value of the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.302.1">
      Data
     </span>
    </strong>
    <span class="koboSpan" id="kobo.303.1">
     property, also inherited from the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.304.1">
      ConfigurationProvider
     </span>
    </strong>
    <span class="koboSpan" id="kobo.305.1">
     class.
    </span>
    <span class="koboSpan" id="kobo.305.2">
     The data type of the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.306.1">
      Data
     </span>
    </strong>
    <span class="koboSpan" id="kobo.307.1">
     property is
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.308.1">
      Dictionary&lt;string, string?&gt;
     </span>
    </strong>
    <span class="koboSpan" id="kobo.309.1">
     ; that is, representing a key-value pair.
    </span>
    <span class="koboSpan" id="kobo.309.2">
     Settings are persisted or serialized in string format.
    </span>
    <span class="koboSpan" id="kobo.309.3">
     However, even with this feature, it is possible to create strongly typed configurations.
    </span>
    <span class="koboSpan" id="kobo.309.4">
     We will cover this approach in the
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.310.1">
      Learning the Options
     </span>
    </em>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.311.1">
       pattern
      </span>
     </em>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.312.1">
      section.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.313.1">
     Of course, this is a simple and didactic example.
    </span>
    <span class="koboSpan" id="kobo.313.2">
     However, we can easily connect the custom provider to a SQL Server database, a storage account, or any other persistence resource.
    </span>
    <span class="koboSpan" id="kobo.313.3">
     In the book’s code repository, the link to which is in the
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.314.1">
      Technical requirements
     </span>
    </em>
    <span class="koboSpan" id="kobo.315.1">
     section, you can analyze another version of a custom provider where the data is persisted in a database.
    </span>
    <span class="koboSpan" id="kobo.315.2">
     However, the implementation principles are the same as those demonstrated in the previous
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.316.1">
      code snippets.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.317.1">
     For the new provider to be used, simply add the following code to the
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.318.1">
       Program.cs
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <strong class="bold">
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.319.1">
      file:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.320.1">
builder.Configuration.Add(new CustomConfigurationSource());</span></pre>
   <p>
    <span class="koboSpan" id="kobo.321.1">
     You can also use
    </span>
    <a id="_idIndexMarker731">
    </a>
    <span class="koboSpan" id="kobo.322.1">
     the extension method creation technique learned in
    </span>
    <a href="B21788_08.xhtml#_idTextAnchor132">
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.323.1">
        Chapter 8
       </span>
      </em>
     </span>
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.324.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.325.1">
     To obtain the settings through the new provider, simply use
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.326.1">
      Configuration
     </span>
    </strong>
    <span class="koboSpan" id="kobo.327.1">
     property methods, such as the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.328.1">
      GetValue&lt;T&gt;
     </span>
    </strong>
    <span class="koboSpan" id="kobo.329.1">
     method, and rename the desired configuration, as demonstrated in the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.330.1">
      following code:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.331.1">
string key1 = _configuration.GetValue&lt;string&gt;
  (" MyCustomSetting:Key1");
string key2 = _configuration.GetValue&lt;string&gt;
  (" MyCustomSetting:Key2");</span></pre>
   <p>
    <span class="koboSpan" id="kobo.332.1">
     As we can see, the creation of a custom provider does not change the development model already available in ASP.NET Core 9, bringing greater flexibility
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.333.1">
      and possibilities.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.334.1">
     Providers are an excellent abstraction for configuration management.
    </span>
    <span class="koboSpan" id="kobo.334.2">
     However, ASP.NET Core 9 provides other types, such as the Options pattern, which we will discuss in the next section, making the configuration management model in our applications even
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.335.1">
      more powerful.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-153">
    <a id="_idTextAnchor154">
    </a>
    <span class="koboSpan" id="kobo.336.1">
     Learning the Options pattern
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.337.1">
     ASP.NET Core 9 offers a
    </span>
    <a id="_idIndexMarker732">
    </a>
    <span class="koboSpan" id="kobo.338.1">
     good way to handle application configurations through the use of the Options pattern.
    </span>
    <span class="koboSpan" id="kobo.338.2">
     This pattern provides a robust mechanism for managing and accessing configuration settings in a strongly typed manner, improving the maintainability and testability of your code and organizing configuration settings into classes.
    </span>
    <span class="koboSpan" id="kobo.338.3">
     In this section, we will understand what the Options pattern is and how to
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.339.1">
      implement it.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-154">
    <a id="_idTextAnchor155">
    </a>
    <span class="koboSpan" id="kobo.340.1">
     What is the Options pattern?
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.341.1">
     Every application must
    </span>
    <a id="_idIndexMarker733">
    </a>
    <span class="koboSpan" id="kobo.342.1">
     interact with some type of configuration, and in the previous chapters, we used the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.343.1">
      IConfiguration
     </span>
    </strong>
    <span class="koboSpan" id="kobo.344.1">
     interface to obtain continuous information in the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.345.1">
      appsettings.json
     </span>
    </strong>
    <span class="koboSpan" id="kobo.346.1">
     file.
    </span>
    <span class="koboSpan" id="kobo.346.2">
     However, this is not the only way to interact with configurations in ASP.NET Core 9, which offers an implementation of the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.347.1">
      Options pattern.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.348.1">
     The Options pattern is a design pattern that uses classes to represent groups of related configurations, allowing you to link configuration sections from various configuration sources (such as JSON files, environment variables, and so on) to these classes, allowing access to configuration settings, type-safe configuration, leveraging IntelliSense, and
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.349.1">
      compile-time checking.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.350.1">
     In ASP.NET Core 9, the Options pattern has the following
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.351.1">
      class hierarchy:
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer095">
     <span class="koboSpan" id="kobo.352.1">
      <img alt="Figure 9.1 – Main Options pattern abstraction in ASP.NET Core 9" src="image/B21788_09_01.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.353.1">
     Figure 9.1 – Main Options pattern abstraction in ASP.NET Core 9
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.354.1">
     As we can see in
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.355.1">
       Figure 9
      </span>
     </em>
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.356.1">
      .1
     </span>
    </em>
    <span class="koboSpan" id="kobo.357.1">
     , there are
    </span>
    <a id="_idIndexMarker734">
    </a>
    <span class="koboSpan" id="kobo.358.1">
     several interfaces for abstracting the Options pattern, in addition to their respective implementations.
    </span>
    <span class="koboSpan" id="kobo.358.2">
     Let’s briefly understand the purpose of each of the interfaces represented in
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.359.1">
       Figure 9
      </span>
     </em>
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.360.1">
       .1
      </span>
     </em>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.361.1">
      :
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.362.1">
       IOptions&lt;T&gt;
      </span>
     </strong>
     <span class="koboSpan" id="kobo.363.1">
      : The basic interface used to retrieve configured options.
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.364.1">
       IOptions&lt;T&gt;
      </span>
     </strong>
     <span class="koboSpan" id="kobo.365.1">
      types are registered as singletons.
     </span>
     <span class="koboSpan" id="kobo.365.2">
      Then, when starting the application, the configurations are loaded into memory and made available throughout the application
     </span>
     <a id="_idIndexMarker735">
     </a>
     <span class="koboSpan" id="kobo.366.1">
      using
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.367.1">
       dependency injection
      </span>
     </strong>
     <span class="koboSpan" id="kobo.368.1">
      (
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.369.1">
       DI
      </span>
     </strong>
     <span class="koboSpan" id="kobo.370.1">
      ).
     </span>
     <span class="koboSpan" id="kobo.370.2">
      However, if any changes are made to the application so that they can be reflected, the application must
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.371.1">
       be restarted.
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.372.1">
       IOptionsSnapshot&lt;T&gt;
      </span>
     </strong>
     <span class="koboSpan" id="kobo.373.1">
      : A variation of
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.374.1">
       IOptions&lt;T&gt;
      </span>
     </strong>
     <span class="koboSpan" id="kobo.375.1">
      that provides a mechanism that updates configurations with each request.
     </span>
     <span class="koboSpan" id="kobo.375.2">
      This interface allows application settings to be updated in real time.
     </span>
     <span class="koboSpan" id="kobo.375.3">
      The lifecycle of this class is scoped; that is, the configurations are loaded with
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.376.1">
       each request.
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.377.1">
       IOptionsMonitor&lt;T&gt;:
      </span>
     </strong>
     <span class="koboSpan" id="kobo.378.1">
      An interface that allows you to monitor option changes and provides a way to receive notifications when options are updated.
     </span>
     <span class="koboSpan" id="kobo.378.2">
      The lifecycle of this interface is singleton, available when the application
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.379.1">
       is initialized.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.380.1">
      Classes that do not have the “
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.381.1">
       I
      </span>
     </strong>
     <span class="koboSpan" id="kobo.382.1">
      ” prefix represent the concrete implementation of
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.383.1">
       each
      </span>
     </span>
     <span class="No-Break">
      <a id="_idIndexMarker736">
      </a>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.384.1">
       interface.
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.385.1">
     The Options pattern offers an excellent option for manipulating configurations without the need to call strings but by creating strongly
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.386.1">
      typed configurations.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.387.1">
     Let’s understand how the Options pattern
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.388.1">
      is implemented.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-155">
    <a id="_idTextAnchor156">
    </a>
    <span class="koboSpan" id="kobo.389.1">
     Implementing the Options pattern
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.390.1">
     As we learned
    </span>
    <a id="_idIndexMarker737">
    </a>
    <span class="koboSpan" id="kobo.391.1">
     throughout the book’s chapters, it is a good practice to centrally manage configuration information, and in most of the code available in this book, we use basic configurations, such as a database
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.392.1">
      connection string.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.393.1">
     Although the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.394.1">
      IConfiguration
     </span>
    </strong>
    <span class="koboSpan" id="kobo.395.1">
     interface provides us with mechanisms for obtaining configurations, in some cases, this can affect the management and responsibilities of each class, which must know exactly the strings it wants to obtain from the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.396.1">
      configuration file.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.397.1">
     There are practices such as the use of constants; however, working with strongly typed classes to aggregate a set of information can be a
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.398.1">
      powerful resource.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.399.1">
     Let’s imagine the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.400.1">
      following context:
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.401.1">
     Imagine an e-commerce application, where we have different services and resources such as payment and shipping.
    </span>
    <span class="koboSpan" id="kobo.401.2">
     These resources have a set of distinct settings.
    </span>
    <span class="koboSpan" id="kobo.401.3">
     In this example, we would have approximately the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.402.1">
      following configurations:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.403.1">
       PaymentGatewayURL
      </span>
     </strong>
     <span class="koboSpan" id="kobo.404.1">
      : URL of the gateway responsible for processing
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.405.1">
       the payment
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.406.1">
       APIKey
      </span>
     </strong>
     <span class="koboSpan" id="kobo.407.1">
      : API key for using the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.408.1">
       payment gateway
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.409.1">
       Timeout
      </span>
     </strong>
     <span class="koboSpan" id="kobo.410.1">
      :
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.411.1">
       Timeout configuration
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.412.1">
       DefaultCarrier
      </span>
     </strong>
     <span class="koboSpan" id="kobo.413.1">
      : Default carrier for
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.414.1">
       delivering orders
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.415.1">
       FreeShippingThreshold
      </span>
     </strong>
     <span class="koboSpan" id="kobo.416.1">
      : Free shipping
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.417.1">
       threshold setting
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.418.1">
     When developing the e-commerce application, for each configuration, it would be necessary to use the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.419.1">
      IConfiguration
     </span>
    </strong>
    <span class="koboSpan" id="kobo.420.1">
     class to obtain data from the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.421.1">
      appsettings.json
     </span>
    </strong>
    <span class="koboSpan" id="kobo.422.1">
     file, for
    </span>
    <a id="_idIndexMarker738">
    </a>
    <span class="koboSpan" id="kobo.423.1">
     example.
    </span>
    <span class="koboSpan" id="kobo.423.2">
     Let’s look at the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.424.1">
      following code:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.425.1">
// Accessing settings directly using IConfiguration
</span><strong class="bold"><span class="koboSpan" id="kobo.426.1">string paymentGatewayURL =</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.427.1">  _configuration["PaymentGatewayURL"];</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.428.1">string apiKey = _configuration["APIKey"];</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.429.1">int timeout = _configuration.GetValue&lt;int&gt;("Timeout");</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.430.1">string defaultCarrier = _configuration["DefaultCarrier"];</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.431.1">decimal freeShippingThreshold =</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.432.1">  _configuration.GetValue&lt;decimal&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.433.1">  ("FreeShippingThreshold");</span></strong></pre>
   <p>
    <span class="koboSpan" id="kobo.434.1">
     The preceding settings would be available in the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.435.1">
      appsettings.json
     </span>
    </strong>
    <span class="koboSpan" id="kobo.436.1">
     file
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.437.1">
      as follows:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.438.1">
{
   "PaymentGatewayURL": "https://payment.aspnetcore9.com",
   "APIKey": "your-api-key",
   "Timeout": 30
   "DefaultCarrier": "UPS",
   "FreeShippingThreshold": 30.00
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.439.1">
     The implementation of the settings recovery code demonstrated is correct.
    </span>
    <span class="koboSpan" id="kobo.439.2">
     However, in more complex scenarios, it may be difficult to manage different types of configurations; there may be code duplications, which makes maintenance difficult, and if there is a typing error in the configuration key, for example, this problem will only be detected
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.440.1">
      at runtime.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.441.1">
     Fortunately, through the abstraction of the Options pattern in ASP.NET Core 9, we have the possibility of grouping configurations in a
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.442.1">
      simple way.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.443.1">
     Based on the preceding example, we
    </span>
    <a id="_idIndexMarker739">
    </a>
    <span class="koboSpan" id="kobo.444.1">
     basically have two types
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.445.1">
      of information:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.446.1">
        PaymentSettings
       </span>
      </strong>
     </span>
    </li>
    <li>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.447.1">
        PaymentGatewayURL
       </span>
      </strong>
     </span>
    </li>
    <li>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.448.1">
        APIKey
       </span>
      </strong>
     </span>
    </li>
    <li>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.449.1">
        Timeout
       </span>
      </strong>
     </span>
    </li>
    <li>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.450.1">
        ShipmentSettings
       </span>
      </strong>
     </span>
    </li>
    <li>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.451.1">
        DefaultCarrier
       </span>
      </strong>
     </span>
    </li>
    <li>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.452.1">
        FreeShippingThreshold
       </span>
      </strong>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.453.1">
     This way, we could group the configurations into two distinct classes, as shown in
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.454.1">
       Figure 9
      </span>
     </em>
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.455.1">
       .2
      </span>
     </em>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.456.1">
      :
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer096">
     <span class="koboSpan" id="kobo.457.1">
      <img alt="Figure 9.2 – Grouping configurations" src="image/B21788_09_02.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.458.1">
     Figure 9.2 – Grouping configurations
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.459.1">
     The preceding classes only have the properties that will reference the respective configurations in a grouped manner.
    </span>
    <span class="koboSpan" id="kobo.459.2">
     With this, we will have the following code defining
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.460.1">
      PaymentSettings
     </span>
    </strong>
    <span class="koboSpan" id="kobo.461.1">
     and
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.462.1">
       ShipingmentSettings
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.463.1">
      classes:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.464.1">
public class </span><strong class="bold"><span class="koboSpan" id="kobo.465.1">PaymentSettings</span></strong><span class="koboSpan" id="kobo.466.1">
{
    public string PaymentGatewayURL { get; set; }
    public string APIKey { get; set; }
    public int Timeout { get; set; }
}
public class </span><strong class="bold"><span class="koboSpan" id="kobo.467.1">Shippingettings</span></strong><span class="koboSpan" id="kobo.468.1">
{
    public string DefaultCarrier { get; set; }
    public decimal FreeShippingThreshold { get; set; }
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.469.1">
     The classes represented
    </span>
    <a id="_idIndexMarker740">
    </a>
    <span class="koboSpan" id="kobo.470.1">
     in the preceding code only aim to abstract a set of configurations, not having any types of implemented behaviors, but there may be methods
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.471.1">
      if necessary.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.472.1">
     However, the classes that will be used in the Options pattern must follow the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.473.1">
      following rules:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.474.1">
       Being non-abstract
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.475.1">
      Having public
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.476.1">
       read-and-write properties
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.477.1">
      Fields are disregarded
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.478.1">
       during binding
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.479.1">
     For this example, we will just keep the properties.
    </span>
    <span class="koboSpan" id="kobo.479.2">
     Additionally, we will change the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.480.1">
      appsettings.json
     </span>
    </strong>
    <span class="koboSpan" id="kobo.481.1">
     file, which will have the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.482.1">
      following code:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.483.1">
{
     "</span><strong class="bold"><span class="koboSpan" id="kobo.484.1">PaymentSettings</span></strong><span class="koboSpan" id="kobo.485.1">": {
      "PaymentGatewayURL":
        "https://payment.aspnetcore9.com",
      "APIKey": "your-api-key",
      "Timeout": 30
    },
    "</span><strong class="bold"><span class="koboSpan" id="kobo.486.1">ShippingSettings</span></strong><span class="koboSpan" id="kobo.487.1">": {
      "DefaultCarrier": "UPS",
      "FreeShippingThreshold": 30.00
    }
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.488.1">
     We can see in the
    </span>
    <a id="_idIndexMarker741">
    </a>
    <span class="koboSpan" id="kobo.489.1">
     preceding code that the settings are grouped by
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.490.1">
      PaymentSettings
     </span>
    </strong>
    <span class="koboSpan" id="kobo.491.1">
     and
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.492.1">
      ShippingSettings
     </span>
    </strong>
    <span class="koboSpan" id="kobo.493.1">
     , which are exactly the names of the classes, and respectively, the properties also have the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.494.1">
      same names.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.495.1">
     The Options pattern uses this convention to bind the settings with the class that will abstract this information in
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.496.1">
      the application.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.497.1">
     Now, let’s look at the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.498.1">
      Program.cs
     </span>
    </strong>
    <span class="koboSpan" id="kobo.499.1">
     file with the changes made to use the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.500.1">
      Options pattern:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.501.1">
using Microsoft.Extensions.Configuration;
using Microsoft.Extensions.DependencyInjection;
using Microsoft.Extensions.Hosting;
var builder = WebApplication.CreateBuilder(args);
</span><strong class="bold"><span class="koboSpan" id="kobo.502.1">builder.Services.Configure&lt;PaymentSettings&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.503.1">  (builder.Configuration.GetSection("PaymentSettings"));</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.504.1">builder.Services.Configure&lt;ShippingSettings&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.505.1">  (builder.Configuration.GetSection("ShippingSettings"));</span></strong><span class="koboSpan" id="kobo.506.1">
builder.Services.AddRazorPages();
builder.Services.AddSingleton&lt;EcommerceService&gt;();
var app = builder.Build();
if (app.Environment.IsDevelopment())
{
    app.UseDeveloperExceptionPage();
}
app.UseStaticFiles();
app.UseRouting();
app.MapRazorPages();
app.Run();</span></pre>
   <p>
    <span class="koboSpan" id="kobo.507.1">
     As you can see in the highlighted code lines in the preceding code block, the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.508.1">
      GetSection
     </span>
    </strong>
    <span class="koboSpan" id="kobo.509.1">
     method is used from the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.510.1">
      IConfiguration
     </span>
    </strong>
    <span class="koboSpan" id="kobo.511.1">
     interface, accessed through the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.512.1">
      Configuration
     </span>
    </strong>
    <span class="koboSpan" id="kobo.513.1">
     extension method.
    </span>
    <span class="koboSpan" id="kobo.513.2">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.514.1">
      GetSection
     </span>
    </strong>
    <span class="koboSpan" id="kobo.515.1">
     method is a generic implementation, where the type entered determines the return type.
    </span>
    <span class="koboSpan" id="kobo.515.2">
     The name of the section is entered as
    </span>
    <a id="_idIndexMarker742">
    </a>
    <span class="koboSpan" id="kobo.516.1">
     a parameter, which, in this case, is the desired
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.517.1">
      configuration group.
     </span>
    </span>
   </p>
   <p class="callout-heading">
    <span class="koboSpan" id="kobo.518.1">
     Extension methods
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.519.1">
     In the preceding code example, to facilitate understanding, we are registering the configuration classes using the Options pattern directly in the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.520.1">
      Program.cs
     </span>
    </strong>
    <span class="koboSpan" id="kobo.521.1">
     file.
    </span>
    <span class="koboSpan" id="kobo.521.2">
     However, it is good practice to create an extension method for registering classes that use the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.522.1">
      Options pattern.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.523.1">
     When executing these methods, the settings will be loaded into a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.524.1">
      PaymentSettings
     </span>
    </strong>
    <span class="koboSpan" id="kobo.525.1">
     or
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.526.1">
      ShipmentSettings
     </span>
    </strong>
    <span class="koboSpan" id="kobo.527.1">
     object and these will be instantiated as a singleton and available in every application through
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.528.1">
      the DIC.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.529.1">
     The following is an example of code where the configurations depend on a given
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.530.1">
      service class:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.531.1">
public class OrderService
{
    private readonly PaymentSettings _paymentSettings;
    private readonly IPaymentGateway _paymentGateway;
    public OrderService(</span><strong class="bold"><span class="koboSpan" id="kobo.532.1">IOptions&lt;PaymentSettings&gt;</span></strong><span class="koboSpan" id="kobo.533.1">
      paymentSettings, IPaymentGateway paymentGateway)
    {
        _paymentettings = paymentSettings.Value;
        _paymentGateway = paymentGateway;
    }
    public async Task&lt;IOrder&gt; Pay(decimal ammount)
    {
       var order = _paymentGateway(ammount,
        _paymentSettings.ApiKey,
        _paymentSettings.PaymentGatewayURL);
    // ..
</span><span class="koboSpan" id="kobo.533.2">    }
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.534.1">
     As we noted in the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.535.1">
      OrderService
     </span>
    </strong>
    <span class="koboSpan" id="kobo.536.1">
     implementation, we just injected an
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.537.1">
      IOptions
     </span>
    </strong>
    <span class="koboSpan" id="kobo.538.1">
     interface for the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.539.1">
      PaymentSettings
     </span>
    </strong>
    <span class="koboSpan" id="kobo.540.1">
     type.
    </span>
    <span class="koboSpan" id="kobo.540.2">
     With
    </span>
    <a id="_idIndexMarker743">
    </a>
    <span class="koboSpan" id="kobo.541.1">
     this, the dependency is resolved by the ASP.NET Core
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.542.1">
      9 DIC.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.543.1">
     Adopting the Options pattern offers several benefits, such as allowing the organization of configuration settings, grouping them into dedicated classes, and the use of strongly
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.544.1">
      typed configuration.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.545.1">
     In addition to improving maintenance and implementation quality, errors can also be detected during compilation time.
    </span>
    <span class="koboSpan" id="kobo.545.2">
     You can also benefit from using unit tests, which is an
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.546.1">
      excellent practice.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.547.1">
     The Options
    </span>
    <a id="_idIndexMarker744">
    </a>
    <span class="koboSpan" id="kobo.548.1">
     pattern in ASP.NET Core 9 is a powerful and flexible way to manage configuration settings, supporting environment-specific configurations and making it easier to manage configurations for different
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.549.1">
      deployment environments.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.550.1">
     Now that we have learned how to use the Options pattern to properly deal with application configurations, it is time to understand how to manage these configurations securely in a cloud environment, in addition to learning how to dynamically manipulate behaviors in
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.551.1">
      our applications.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-156">
    <a id="_idTextAnchor157">
    </a>
    <span class="koboSpan" id="kobo.552.1">
     Working with dynamic configurations and behaviors
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.553.1">
     In the ever-evolving landscape of web applications, maintaining flexibility and responsiveness is crucial.
    </span>
    <span class="koboSpan" id="kobo.553.2">
     As developers, we must ensure that our applications can adapt to changes quickly and securely.
    </span>
    <span class="koboSpan" id="kobo.553.3">
     Dynamic configurations
    </span>
    <a id="_idIndexMarker745">
    </a>
    <span class="koboSpan" id="kobo.554.1">
     and behavior management
    </span>
    <a id="_idIndexMarker746">
    </a>
    <span class="koboSpan" id="kobo.555.1">
     are key strategies that allow us to achieve this flexibility.
    </span>
    <span class="koboSpan" id="kobo.555.2">
     By managing configurations dynamically, we can update them without redeploying our applications.
    </span>
    <span class="koboSpan" id="kobo.555.3">
     Additionally, by implementing application behavior management using techniques such as
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.556.1">
      feature toggles
     </span>
    </strong>
    <span class="koboSpan" id="kobo.557.1">
     , we can
    </span>
    <a id="_idIndexMarker747">
    </a>
    <span class="koboSpan" id="kobo.558.1">
     control resource availability in real time, giving us the ability to effortlessly test, deploy, or roll
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.559.1">
      back features.
     </span>
    </span>
   </p>
   <p class="callout-heading">
    <span class="koboSpan" id="kobo.560.1">
     Feature toggles
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.561.1">
     Feature toggles
    </span>
    <a id="_idIndexMarker748">
    </a>
    <span class="koboSpan" id="kobo.562.1">
     or feature flags are a software development technique used to enable or disable specific functionality in a software application at runtime, facilitating
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.563.1">
      continuous integration and delivery
     </span>
    </strong>
    <span class="koboSpan" id="kobo.564.1">
     (
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.565.1">
      CI/CD
     </span>
    </strong>
    <span class="koboSpan" id="kobo.566.1">
     ) by allowing code changes to be merged into the main code
    </span>
    <a id="_idIndexMarker749">
    </a>
    <span class="koboSpan" id="kobo.567.1">
     base without immediately exposing new functionality to all users.
    </span>
    <span class="koboSpan" id="kobo.567.2">
     This technique helps in mitigating risks, conducting A/B testing, performing canary releases, and rolling back features without redeploying
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.568.1">
      the code.
     </span>
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.569.1">
     Access the following article to learn more
    </span>
    <a id="_idIndexMarker750">
    </a>
    <span class="koboSpan" id="kobo.570.1">
     about the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.571.1">
      technique:
     </span>
    </span>
    <a href="https://martinfowler.com/articles/feature-toggles.html">
     <span class="No-Break">
      <span class="koboSpan" id="kobo.572.1">
       https://martinfowler.com/articles/feature-toggles.html
      </span>
     </span>
    </a>
   </p>
   <p>
    <span class="koboSpan" id="kobo.573.1">
     Let’s delve into the details of dynamic configuration management and implement a
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.574.1">
      practical example.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-157">
    <a id="_idTextAnchor158">
    </a>
    <span class="koboSpan" id="kobo.575.1">
     Working with dynamic settings
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.576.1">
     Dynamic settings
    </span>
    <a id="_idIndexMarker751">
    </a>
    <span class="koboSpan" id="kobo.577.1">
     refer to the ability to modify application configurations at runtime without the need for redeployment.
    </span>
    <span class="koboSpan" id="kobo.577.2">
     This capability is essential for maintaining application uptime, ensuring quick responses to changes in requirements, and enhancing security by allowing rapid adjustments to
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.578.1">
      sensitive configurations.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.579.1">
     Modern applications must have
    </span>
    <a id="_idIndexMarker752">
    </a>
    <span class="koboSpan" id="kobo.580.1">
     dynamic configuration management mechanisms to guarantee the quality of the solution, in addition to benefits such as
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.581.1">
      the following:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.582.1">
       Zero downtime
      </span>
     </strong>
     <span class="koboSpan" id="kobo.583.1">
      : Update configurations without redeploying the application, ensuring continuous availability.
     </span>
     <span class="koboSpan" id="kobo.583.2">
      This is an important feature that allows us to bring reliability and a better experience
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.584.1">
       to users.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.585.1">
       Security
      </span>
     </strong>
     <span class="koboSpan" id="kobo.586.1">
      : Quickly update security settings and credentials in response
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.587.1">
       to threats.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.588.1">
       Flexibility
      </span>
     </strong>
     <span class="koboSpan" id="kobo.589.1">
      : Adjust settings in real time to accommodate changing
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.590.1">
       business requirements.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.591.1">
       Simplified deployments
      </span>
     </strong>
     <span class="koboSpan" id="kobo.592.1">
      : Reduce the complexity and risk associated with application deployments by decoupling configuration changes from code changes.
     </span>
     <span class="koboSpan" id="kobo.592.2">
      In scenarios with many environments, such as development, testing, and production, the application will have different configurations based on the resources of each environment.
     </span>
     <span class="koboSpan" id="kobo.592.3">
      Having the ability to abstract the management of application configurations improves quality, segregates responsibilities, and maintains continuous
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.593.1">
       delivery flow.
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.594.1">
     Several options are available to dynamically manage configurations in ASP.NET Core 9, including configuration files, environment variables, and cloud-based services such as
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.595.1">
      Azure App Configuration
     </span>
    </strong>
    <span class="koboSpan" id="kobo.596.1">
     .
    </span>
    <span class="koboSpan" id="kobo.596.2">
     Azure App Configuration
    </span>
    <a id="_idIndexMarker753">
    </a>
    <span class="koboSpan" id="kobo.597.1">
     stands out for its robust features and seamless integration with other
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.598.1">
      Azure services.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.599.1">
     Azure App Configuration
    </span>
    <a id="_idIndexMarker754">
    </a>
    <span class="koboSpan" id="kobo.600.1">
     is a service that provides a centralized way to manage configuration settings and feature flags.
    </span>
    <span class="koboSpan" id="kobo.600.2">
     It allows applications to dynamically adjust their behavior
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.601.1">
      without redeployment.
     </span>
    </span>
   </p>
   <p class="callout-heading">
    <span class="koboSpan" id="kobo.602.1">
     Azure App Configuration
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.603.1">
     Azure App Configuration is a powerful feature available in Microsoft Azure that allows us to manage configurations and feature toggles securely, supporting the deployment of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.604.1">
      cloud-native applications.
     </span>
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.605.1">
     For more details about
    </span>
    <a id="_idIndexMarker755">
    </a>
    <span class="koboSpan" id="kobo.606.1">
     Azure App Configuration, I suggest reading the rich documentation about the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.607.1">
      resource:
     </span>
    </span>
    <a href="https://learn.microsoft.com/en-us/azure/azure-app-configuration/">
     <span class="No-Break">
      <span class="koboSpan" id="kobo.608.1">
       https://learn.microsoft.com/en-us/azure/azure-app-configuration/
      </span>
     </span>
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.609.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.610.1">
     We won’t cover all the details of setting up and using Azure App Configuration in this book.
    </span>
    <span class="koboSpan" id="kobo.610.2">
     For now, we will use the main resources to exemplify the use of dynamic configurations in
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.611.1">
      our applications.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.612.1">
     Let’s create an application that interacts with Azure App Configuration and uses some patterns already learned in this chapter, such as the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.613.1">
      Options pattern.
     </span>
    </span>
   </p>
   <h3>
    <span class="koboSpan" id="kobo.614.1">
     Setting up Azure App Configuration
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.615.1">
     Azure App
    </span>
    <a id="_idIndexMarker756">
    </a>
    <span class="koboSpan" id="kobo.616.1">
     Configuration is a cloud-based service that provides a centralized repository for application configurations, enabling dynamic
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.617.1">
      configuration management.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.618.1">
     Let’s create an Azure App Configuration resource before creating an application.
    </span>
    <span class="koboSpan" id="kobo.618.2">
     You will need access to an Azure subscription, as described in the
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.619.1">
      Technical
     </span>
    </em>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.620.1">
       requirements
      </span>
     </em>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.621.1">
      section.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.622.1">
     With access to the Azure subscription, follow these steps to create an Azure App
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.623.1">
      Configuration resource:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.624.1">
      Navigate to the Azure portal (
     </span>
     <a href="https://portal.azure.com">
      <span class="koboSpan" id="kobo.625.1">
       https://portal.azure.com
      </span>
     </a>
     <span class="koboSpan" id="kobo.626.1">
      ), and in the search field, in the top bar, type
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.627.1">
       App Configuration
      </span>
     </strong>
     <span class="koboSpan" id="kobo.628.1">
      and click on the icon, as highlighted in
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.629.1">
        Figure 9
       </span>
      </em>
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.630.1">
        .3
       </span>
      </em>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.631.1">
       :
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer097">
     <span class="koboSpan" id="kobo.632.1">
      <img alt="Figure 9.3 – Accessing the App Configuration service" src="image/B21788_09_03.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.633.1">
     Figure 9.3 – Accessing the App Configuration service
    </span>
   </p>
   <ol>
    <li value="2">
     <span class="koboSpan" id="kobo.634.1">
      On the next screen, click on the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.635.1">
       + Create
      </span>
     </strong>
     <span class="koboSpan" id="kobo.636.1">
      option to add the new resource, as shown in
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.637.1">
        Figure 9
       </span>
      </em>
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.638.1">
        .4
       </span>
      </em>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.639.1">
       :
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer098">
     <span class="koboSpan" id="kobo.640.1">
      <img alt="Figure 9.4 – Creating a new App Configuration resource" src="image/B21788_09_04.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.641.1">
     Figure 9.4 – Creating a new App Configuration resource
    </span>
   </p>
   <ol>
    <li value="3">
     <span class="koboSpan" id="kobo.642.1">
      On the next screen, we must configure the parameters of the new resource.
     </span>
     <span class="koboSpan" id="kobo.642.2">
      We will keep the default
     </span>
     <a id="_idIndexMarker757">
     </a>
     <span class="koboSpan" id="kobo.643.1">
      settings.
     </span>
     <span class="koboSpan" id="kobo.643.2">
      Use the following parameter suggestions as
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.644.1">
       a reference:
      </span>
     </span>
     <ul>
      <li>
       <strong class="bold">
        <span class="koboSpan" id="kobo.645.1">
         Resource group
        </span>
       </strong>
       <span class="koboSpan" id="kobo.646.1">
        :
       </span>
       <strong class="source-inline">
        <span class="koboSpan" id="kobo.647.1">
         rg-aspnetcore8
        </span>
       </strong>
       <span class="koboSpan" id="kobo.648.1">
        .
       </span>
       <span class="koboSpan" id="kobo.648.2">
        Be sure to click the
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.649.1">
         Create new
        </span>
       </strong>
       <span class="koboSpan" id="kobo.650.1">
        button below the
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.651.1">
         Resource group
        </span>
       </strong>
       <span class="koboSpan" id="kobo.652.1">
        field to create the new
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.653.1">
         resource group.
        </span>
       </span>
      </li>
      <li>
       <strong class="bold">
        <span class="koboSpan" id="kobo.654.1">
         Location
        </span>
       </strong>
       <span class="koboSpan" id="kobo.655.1">
        :
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.656.1">
         East
        </span>
       </strong>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.657.1">
          US 2
         </span>
        </strong>
       </span>
      </li>
      <li>
       <strong class="bold">
        <span class="koboSpan" id="kobo.658.1">
         Resource name
        </span>
       </strong>
       <span class="koboSpan" id="kobo.659.1">
        :
       </span>
       <strong class="source-inline">
        <span class="koboSpan" id="kobo.660.1">
         &lt;Your
        </span>
       </strong>
       <span class="No-Break">
        <strong class="source-inline">
         <span class="koboSpan" id="kobo.661.1">
          Last Name&gt;-configuration
         </span>
        </strong>
       </span>
      </li>
      <li>
       <strong class="bold">
        <span class="koboSpan" id="kobo.662.1">
         Pricing
        </span>
       </strong>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.663.1">
          tier
         </span>
        </strong>
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.664.1">
         :
        </span>
       </span>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.665.1">
          Standard
         </span>
        </strong>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.666.1">
        Leave the
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.667.1">
         Create replicas
        </span>
       </strong>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.668.1">
         option unchecked.
        </span>
       </span>
      </li>
     </ul>
    </li>
    <li>
     <span class="koboSpan" id="kobo.669.1">
      Click on the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.670.1">
       Review + Create
      </span>
     </strong>
     <span class="koboSpan" id="kobo.671.1">
      button then the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.672.1">
       Create
      </span>
     </strong>
     <span class="koboSpan" id="kobo.673.1">
      button, and wait for the resource to
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.674.1">
       be created.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.675.1">
      When you finish creating the new resource, click the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.676.1">
       Go to resource
      </span>
     </strong>
     <span class="koboSpan" id="kobo.677.1">
      button, as shown in
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.678.1">
        Figure 9
       </span>
      </em>
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.679.1">
       .5
      </span>
     </em>
     <span class="koboSpan" id="kobo.680.1">
      , or access the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.681.1">
       App Configuration
      </span>
     </strong>
     <span class="koboSpan" id="kobo.682.1">
      list, as described in
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.683.1">
       step 1
      </span>
     </em>
     <span class="koboSpan" id="kobo.684.1">
      , and click on the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.685.1">
       created resource:
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer099">
     <span class="koboSpan" id="kobo.686.1">
      <img alt="Figure 9.5 – New App Configuration creation status" src="image/B21788_09_05.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.687.1">
     Figure 9.5 – New App Configuration creation status
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.688.1">
     Now that we have the configuration management resource created, it’s time to create and configure our application to interact with Azure
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.689.1">
      App Configuration.
     </span>
    </span>
   </p>
   <h4>
    <span class="koboSpan" id="kobo.690.1">
     Creating and connecting an application in Azure App Configuration
    </span>
   </h4>
   <p>
    <span class="koboSpan" id="kobo.691.1">
     For this example, an
    </span>
    <a id="_idIndexMarker758">
    </a>
    <span class="koboSpan" id="kobo.692.1">
     ASP.NET Core 9 MVC application will be created and connected to the Azure App Configuration service
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.693.1">
      created previously.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.694.1">
     Follow
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.695.1">
      these steps:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.696.1">
      Open the terminal, and in a folder of your choice, create a directory
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.697.1">
       named
      </span>
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.698.1">
        DynamicConfiguration
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.699.1">
       :
      </span>
     </span>
     <pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.700.1">mkdir DynamicConfiguration</span></strong></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.701.1">
      Now, access the directory with the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.702.1">
       following command:
      </span>
     </span>
     <pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.703.1">cd DynamicConfiguration</span></strong></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.704.1">
      Run the following command to create
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.705.1">
       the application:
      </span>
     </span>
     <pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.706.1">dotnet new mvc -n DynamicConfiguration -o .</span></strong></pre>
     <p class="list-inset">
      <span class="koboSpan" id="kobo.707.1">
       The previous command creates an MVC application with the name
      </span>
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.708.1">
        DynamicConfiguration
       </span>
      </strong>
      <span class="koboSpan" id="kobo.709.1">
       , defined with the
      </span>
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.710.1">
        -n
       </span>
      </strong>
      <span class="koboSpan" id="kobo.711.1">
       parameter and in the current directory, determined by the
      </span>
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.712.1">
        –o .
       </span>
      </strong>
      <span class="No-Break">
       <span class="koboSpan" id="kobo.713.1">
        parameter.
       </span>
      </span>
     </p>
    </li>
   </ol>
   <p>
    <span class="koboSpan" id="kobo.714.1">
     With the application created, we will simply prepare it to integrate with Azure App Configuration.
    </span>
    <span class="koboSpan" id="kobo.714.2">
     To do this, run the following command in the application directory to open Visual
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.715.1">
      Studio Code:
     </span>
    </span>
   </p>
   <pre class="console"><span class="koboSpan" id="kobo.716.1">
code .</span></pre>
   <p>
    <span class="koboSpan" id="kobo.717.1">
     Now, in the root of the project, create an
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.718.1">
      Options
     </span>
    </strong>
    <span class="koboSpan" id="kobo.719.1">
     folder and then create a file called
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.720.1">
      GlobalOptions.cs
     </span>
    </strong>
    <span class="koboSpan" id="kobo.721.1">
     .
    </span>
    <span class="koboSpan" id="kobo.721.2">
     This file must contain the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.722.1">
      following code:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.723.1">
namespace DynamicConfiguration.Options;
public class GlobalOptions
{
    public string Title { get; set; }
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.724.1">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.725.1">
      GlobalOptions
     </span>
    </strong>
    <span class="koboSpan" id="kobo.726.1">
     class
    </span>
    <a id="_idIndexMarker759">
    </a>
    <span class="koboSpan" id="kobo.727.1">
     has only one property called
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.728.1">
      Title
     </span>
    </strong>
    <span class="koboSpan" id="kobo.729.1">
     that will be obtained through Azure
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.730.1">
      App Configuration.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.731.1">
     When the application starts, it loads the settings as we learned previously, using files such as
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.732.1">
      appsettings.json
     </span>
    </strong>
    <span class="koboSpan" id="kobo.733.1">
     and environment variables, among other providers that can be configured.
    </span>
    <span class="koboSpan" id="kobo.733.2">
     However, for our classes, the details of obtaining the configurations are abstracted by ASP.NET Core 9, and, in this case, whatever the provider, when using the Options pattern, we will have the correct separation of responsibility, maintainability, flexibility,
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.734.1">
      and extensibility.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.735.1">
     Let’s change the code of the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.736.1">
      HomeController
     </span>
    </strong>
    <span class="koboSpan" id="kobo.737.1">
     class, in the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.738.1">
      Controllers
     </span>
    </strong>
    <span class="koboSpan" id="kobo.739.1">
     folder, and add the settings previously created using the Options pattern.
    </span>
    <span class="koboSpan" id="kobo.739.2">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.740.1">
      HomeController
     </span>
    </strong>
    <span class="koboSpan" id="kobo.741.1">
     class code will look like
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.742.1">
      the following:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.743.1">
public class HomeController : Controller
{
    private readonly ILogger&lt;HomeController&gt; _logger;
    </span><strong class="bold"><span class="koboSpan" id="kobo.744.1">private readonly GlobalOptions _globalOptions;</span></strong><span class="koboSpan" id="kobo.745.1">
    public HomeController(ILogger&lt;HomeController&gt; logger</span><strong class="bold"><span class="koboSpan" id="kobo.746.1">,</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.747.1">      IOptionsSnapshot&lt;GlobalOptions&gt; globalOptions</span></strong><span class="koboSpan" id="kobo.748.1">)
    {
        _logger = logger;
       </span><strong class="bold"><span class="koboSpan" id="kobo.749.1"> _globalOptions = globalOptions.Value;</span></strong><span class="koboSpan" id="kobo.750.1">
    }
    public IActionResult Index()
    {
      </span><strong class="bold"><span class="koboSpan" id="kobo.751.1">  ViewData["Title"] = _globalOptions.Title;</span></strong><span class="koboSpan" id="kobo.752.1">
        return View();
    }
    public IActionResult Privacy()
    {
        return View();
    }
    [ResponseCache(Duration = 0,
      Location = ResponseCacheLocation.None,
      NoStore = true)]
    public IActionResult Error()
    {
        return View(new ErrorViewModel {
          RequestId = Activity.Current?.Id ??
</span><span class="koboSpan" id="kobo.752.2">          HttpContext.TraceIdentifier });
    }
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.753.1">
     Simple
    </span>
    <a id="_idIndexMarker760">
    </a>
    <span class="koboSpan" id="kobo.754.1">
     changes were made to the class.
    </span>
    <span class="koboSpan" id="kobo.754.2">
     Let’s understand each
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.755.1">
      of them:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.756.1">
       GlobalOptions field
      </span>
     </strong>
     <span class="koboSpan" id="kobo.757.1">
      : A new field was created for the class that is of type
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.758.1">
       GlobalOptions
      </span>
     </strong>
     <span class="koboSpan" id="kobo.759.1">
      ,
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.760.1">
       created previously
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.761.1">
       Change in the constructor
      </span>
     </strong>
     <span class="koboSpan" id="kobo.762.1">
      : Configurations will be injected through the ASP.NET Core 9 DIC, and that is why we added a parameter of type
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.763.1">
       IOptionsSnapshot&lt;GlobalSettings&gt;
      </span>
     </strong>
     <span class="koboSpan" id="kobo.764.1">
      .
     </span>
     <span class="koboSpan" id="kobo.764.2">
      The purpose of using the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.765.1">
       IOptionsSnapshot&lt;&gt;
      </span>
     </strong>
     <span class="koboSpan" id="kobo.766.1">
      interface is to allow you to obtain configurations dynamically, as we learned in the
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.767.1">
       What is the Options pattern?
      </span>
     </em>
     <span class="koboSpan" id="kobo.768.1">
      section.
     </span>
     <span class="koboSpan" id="kobo.768.2">
      If another interface is used, such as
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.769.1">
       IOptions&lt;&gt;
      </span>
     </strong>
     <span class="koboSpan" id="kobo.770.1">
      , the parameters will be loaded, but
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.771.1">
       not dynamically.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.772.1">
       Changing the Index action
      </span>
     </strong>
     <span class="koboSpan" id="kobo.773.1">
      : We change the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.774.1">
       Index
      </span>
     </strong>
     <span class="koboSpan" id="kobo.775.1">
      action where we set the value of the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.776.1">
       Title
      </span>
     </strong>
     <span class="koboSpan" id="kobo.777.1">
      property in the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.778.1">
       ViewData
      </span>
     </strong>
     <span class="koboSpan" id="kobo.779.1">
      dictionary with the value of the configuration of the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.780.1">
       Title
      </span>
     </strong>
     <span class="koboSpan" id="kobo.781.1">
      property of the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.782.1">
       _globalOptions
      </span>
     </strong>
     <span class="koboSpan" id="kobo.783.1">
      object.
     </span>
     <span class="koboSpan" id="kobo.783.2">
      The
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.784.1">
       ViewData["Title"]
      </span>
     </strong>
     <span class="koboSpan" id="kobo.785.1">
      dictionary is used in the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.786.1">
       Views/Home/Index.cshtml
      </span>
     </strong>
     <span class="koboSpan" id="kobo.787.1">
      file to display the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.788.1">
       page title.
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.789.1">
     Now, let’s change the code on the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.790.1">
      Views/Home/Index.cshtml
     </span>
    </strong>
    <span class="koboSpan" id="kobo.791.1">
     page to display the title in the body of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.792.1">
      the page:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.793.1">
&lt;div class="text-center"&gt;
&lt;h1 class="display-4"&gt;Welcome </span><strong class="bold"><span class="koboSpan" id="kobo.794.1">@ViewData["Title"]</span></strong><span class="koboSpan" id="kobo.795.1">&lt;/h1&gt;
&lt;p&gt;Learn about &lt;a
  href="https://learn.microsoft.com/aspnet/core"&gt;
  building Web apps with ASP.NET Core&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;</span></pre>
   <p>
    <span class="koboSpan" id="kobo.796.1">
     As can be seen in the highlighted code, we are only rendering the value contained in the
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.797.1">
       ViewData["Title"]
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.798.1">
      dictionary.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.799.1">
     The application is prepared to render data obtained through configuration.
    </span>
    <span class="koboSpan" id="kobo.799.2">
     Now, it’s time to connect the application to Azure
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.800.1">
      App Configuration.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.801.1">
     First, open the terminal in the application directory and run the following command to add the NuGet package that contains the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.802.1">
      necessary SDK:
     </span>
    </span>
   </p>
   <pre class="console"><span class="koboSpan" id="kobo.803.1">
dotnet add package Microsoft.Azure.AppConfiguration.AspNetCore</span></pre>
   <p>
    <span class="koboSpan" id="kobo.804.1">
     Now, you will need to get the connection string containing the resource from Azure App Configuration.
    </span>
    <span class="koboSpan" id="kobo.804.2">
     Let’s
    </span>
    <a id="_idIndexMarker761">
    </a>
    <span class="koboSpan" id="kobo.805.1">
     execute the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.806.1">
      following steps:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.807.1">
      Access the Azure
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.808.1">
       portal (
      </span>
     </span>
     <a href="https://portal.azure.com">
      <span class="No-Break">
       <span class="koboSpan" id="kobo.809.1">
        https://portal.azure.com
       </span>
      </span>
     </a>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.810.1">
       ).
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.811.1">
      In the search field, in the top bar of the portal, type
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.812.1">
       App Configuration
      </span>
     </strong>
     <span class="koboSpan" id="kobo.813.1">
      and click on
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.814.1">
       the option.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.815.1">
      Then, in the list of configuration resources, click on the previously created resource with the name
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.816.1">
       &lt;Your
      </span>
     </strong>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.817.1">
        Last Name&gt;-configuration
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.818.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.819.1">
      In the side menu, look for the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.820.1">
       Access settings
      </span>
     </strong>
     <span class="koboSpan" id="kobo.821.1">
      option and copy the connection string as shown in
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.822.1">
        Figure 9
       </span>
      </em>
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.823.1">
        .6
       </span>
      </em>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.824.1">
       :
      </span>
     </span>
    </li>
   </ol>
   <p class="IMG---Figure">
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer100">
     <span class="koboSpan" id="kobo.825.1">
      <img alt="Figure 9.6 – Getting the connection string from App Configuration" src="image/B21788_09_06.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.826.1">
     Figure 9.6 – Getting the connection string from App Configuration
    </span>
   </p>
   <ol>
    <li value="5">
     <span class="koboSpan" id="kobo.827.1">
      Now, run the following command in the terminal, in the application directory.
     </span>
     <span class="koboSpan" id="kobo.827.2">
      The command uses a secret manager to store a secret named
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.828.1">
       ConnectionStrings:AppConfig
      </span>
     </strong>
     <span class="koboSpan" id="kobo.829.1">
      , which stores the connection string for your App Configuration store.
     </span>
     <span class="koboSpan" id="kobo.829.2">
      Replace the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.830.1">
       &lt;your_connection_string&gt;
      </span>
     </strong>
     <span class="koboSpan" id="kobo.831.1">
      placeholder with your App Configuration store’s connection string.
     </span>
     <span class="koboSpan" id="kobo.831.2">
      This is a good practice to prevent sensitive data, such as connection strings that are credentials or have passwords, from being persisted in version control, bringing vulnerabilities to
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.832.1">
       your application:
      </span>
     </span>
     <pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.833.1">dotnet user-secrets init</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.834.1">dotnet user-secrets set ConnectionStrings:AppConfig "&lt;your_connection_string&gt;"</span></strong></pre>
    </li>
   </ol>
   <p>
    <span class="koboSpan" id="kobo.835.1">
     With the definition of the secret that contains the App Configuration connection string, we will change the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.836.1">
      Program.cs
     </span>
    </strong>
    <span class="koboSpan" id="kobo.837.1">
     file to add the necessary services and middleware.
    </span>
    <span class="koboSpan" id="kobo.837.2">
     Let’s look at
    </span>
    <a id="_idIndexMarker762">
    </a>
    <span class="koboSpan" id="kobo.838.1">
     the changed
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.839.1">
       Program.cs
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.840.1">
      code:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.841.1">
using Microsoft.Extensions.Configuration
  .AzureAppConfiguration;
var builder = WebApplication.CreateBuilder(args);
</span><strong class="bold"><span class="koboSpan" id="kobo.842.1">Builder.Services.AddAzureAppConfiguration();</span></strong><span class="koboSpan" id="kobo.843.1">
var connectionString = </span><strong class="bold"><span class="koboSpan" id="kobo.844.1">builder.Configuration</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.845.1">  .GetConnectionString("AppConfig")</span></strong><span class="koboSpan" id="kobo.846.1">;
</span><strong class="bold"><span class="koboSpan" id="kobo.847.1">builder.Configuration.AddAzureAppConfiguration(options =&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.848.1">  {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.849.1">    options.Connect(connectionString)</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.850.1">    .Select("DynamicConfiguration:*", LabelFilter.Null)</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.851.1">    .ConfigureRefresh(refreshOptions =&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.852.1">    refreshOptions.Register("DynamicConfiguration:</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.853.1">      Sentinel", refreshAll: true));</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.854.1">  });</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.855.1">builder.Services.Configure&lt;GlobalOptions&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.856.1">  (builder.Configuration</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.857.1">  .GetSection("DynamicConfiguration:GlobalOptions"));</span></strong><span class="koboSpan" id="kobo.858.1">
builder.Services.AddControllersWithViews();
var app = builder.Build();
if (!app.Environment.IsDevelopment())
{
  app.UseExceptionHandler("/Home/Error");
  app.UseHsts();
}
// Middleware to refresh configuration
</span><strong class="bold"><span class="koboSpan" id="kobo.859.1">app.UseAzureAppConfiguration();</span></strong><span class="koboSpan" id="kobo.860.1">
app.UseHttpsRedirection();
app.UseStaticFiles();
app.UseRouting();
app.UseAuthorization();
app.MapControllerRoute(
name: "default",
pattern: "{controller=Home}/{action=Index}/{id?}");
app.Run();</span></pre>
   <p>
    <span class="koboSpan" id="kobo.861.1">
     The
    </span>
    <a id="_idIndexMarker763">
    </a>
    <span class="koboSpan" id="kobo.862.1">
     App Configuration SDK has excellent abstraction and is simple to integrate into the application.
    </span>
    <span class="koboSpan" id="kobo.862.2">
     Let’s understand the changes made to the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.863.1">
      preceding code:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.864.1">
       builder.Services.AddAzureAppConfiguration()
      </span>
     </strong>
     <span class="koboSpan" id="kobo.865.1">
      : This method registers the necessary services for Azure App Configuration to work within your ASP.NET Core
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.866.1">
       9 application.
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.867.1">
       builder.Configuration.GetConnectionString("AppConfig")
      </span>
     </strong>
     <span class="koboSpan" id="kobo.868.1">
      : This line of code gets the Azure Application Configuration connection string, previously obtained from the Azure portal and added to the application via a secret.
     </span>
     <span class="koboSpan" id="kobo.868.2">
      Note that getting the connection string is identical to getting it from
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.869.1">
       the appsettings.json
      </span>
     </strong>
     <span class="koboSpan" id="kobo.870.1">
      file.
     </span>
     <span class="koboSpan" id="kobo.870.2">
      The big difference in managing configurations through secrets is that they are only kept on the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.871.1">
       local machine.
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.872.1">
       builder.Configuration.AddAzureAppConfiguration
      </span>
     </strong>
     <span class="koboSpan" id="kobo.873.1">
      : This extension method adds Azure App Configuration as a configuration provider to
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.874.1">
       your application.
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.875.1">
       options.Connect(connectionString)
      </span>
     </strong>
     <span class="koboSpan" id="kobo.876.1">
      : Connects to the Azure application configuration instance using the previously obtained
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.877.1">
       connection string.
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.878.1">
       .Select("Dynamic Configuration:*", LabelFilter.Null)
      </span>
     </strong>
     <span class="koboSpan" id="kobo.879.1">
      : Specifies that all keys with the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.880.1">
       DynamicConfiguration:
      </span>
     </strong>
     <span class="koboSpan" id="kobo.881.1">
      prefix should be selected.
     </span>
     <span class="koboSpan" id="kobo.881.2">
      The
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.882.1">
       LabelFilter.Null
      </span>
     </strong>
     <span class="koboSpan" id="kobo.883.1">
      parameter indicates that only unlabeled configurations
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.884.1">
       are retrieved.
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.885.1">
       .ConfigureRefresh
      </span>
     </strong>
     <span class="koboSpan" id="kobo.886.1">
      : The
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.887.1">
       ConfigureRefresh
      </span>
     </strong>
     <span class="koboSpan" id="kobo.888.1">
      method registers keys that you want to monitor for changes in your application
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.889.1">
       configuration store.
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.890.1">
       refreshOptions.Register("Dynamic Configuration", updateAll: true)
      </span>
     </strong>
     <span class="koboSpan" id="kobo.891.1">
      : Registers a sentinel key (
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.892.1">
       DynamicConfiguration:Sentinel
      </span>
     </strong>
     <span class="koboSpan" id="kobo.893.1">
      ) that triggers an update.
     </span>
     <span class="koboSpan" id="kobo.893.2">
      When the value of this key changes, all settings will be updated (
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.894.1">
        refreshAll: true
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.895.1">
       ).
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.896.1">
       builder.Services.Configure&lt;GlobalOptions&gt;(builder.Configuration.GetSection("DynamicConfiguration: GlobalOptions"))
      </span>
     </strong>
     <span class="koboSpan" id="kobo.897.1">
      : This line of code binds the configuration created in Azure App Configuration and the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.898.1">
       GlobalOptions
      </span>
     </strong>
     <span class="koboSpan" id="kobo.899.1">
      class created previously.
     </span>
     <span class="koboSpan" id="kobo.899.2">
      With this, it will be possible to obtain the configuration through the DIC using the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.900.1">
       Options pattern.
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.901.1">
       UseAzureAppConfiguration
      </span>
     </strong>
     <span class="koboSpan" id="kobo.902.1">
      : Allows your application to use the application
     </span>
     <a id="_idIndexMarker764">
     </a>
     <span class="koboSpan" id="kobo.903.1">
      configuration middleware to update
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.904.1">
       configuration automatically.
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.905.1">
     In summary, the previous configurations, added to the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.906.1">
      Program.cs
     </span>
    </strong>
    <span class="koboSpan" id="kobo.907.1">
     file, allow the application to connect to Azure App Configuration via the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.908.1">
      connection string.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.909.1">
     The App Configuration SDK works with the concept of pooling.
    </span>
    <span class="koboSpan" id="kobo.909.2">
     In this case, when obtaining the configurations, a cache is made in the application’s memory, to avoid constant requests to the Azure service and optimize the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.910.1">
      application’s functioning.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.911.1">
     By default, the time the application queries Azure App Configuration for updates is 30 seconds.
    </span>
    <span class="koboSpan" id="kobo.911.2">
     It is possible to specify the refresh call time using the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.912.1">
      refreshOptions.SetCacheExpiration
     </span>
    </strong>
    <span class="koboSpan" id="kobo.913.1">
     method.
    </span>
    <span class="koboSpan" id="kobo.913.2">
     A
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.914.1">
      Sentinel
     </span>
    </strong>
    <span class="koboSpan" id="kobo.915.1">
     parameter was also configured, responsible for determining whether there were changes to
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.916.1">
      the settings.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.917.1">
     It is important as it prevents the SDK from analyzing each configuration individually, and if
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.918.1">
      Sentinel
     </span>
    </strong>
    <span class="koboSpan" id="kobo.919.1">
     has been changed, all configurations will
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.920.1">
      be updated.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.921.1">
     Now that we’ve
    </span>
    <a id="_idIndexMarker765">
    </a>
    <span class="koboSpan" id="kobo.922.1">
     learned how Azure App Configuration settings work, let’s create configuration keys in the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.923.1">
      Azure portal:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.924.1">
      In the Azure portal (
     </span>
     <a href="https://portal.azure.com">
      <span class="koboSpan" id="kobo.925.1">
       https://portal.azure.com
      </span>
     </a>
     <span class="koboSpan" id="kobo.926.1">
      ), in the App Configuration resource created previously, select the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.927.1">
       Configuration explorer
      </span>
     </strong>
     <span class="koboSpan" id="kobo.928.1">
      option, as shown in
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.929.1">
        Figure 9
       </span>
      </em>
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.930.1">
        .7
       </span>
      </em>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.931.1">
       :
      </span>
     </span>
    </li>
   </ol>
   <p class="IMG---Figure">
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer101">
     <span class="koboSpan" id="kobo.932.1">
      <img alt="Figure 9.7 – Accessing the Configuration explorer option of Azure App Configuration" src="image/B21788_09_07.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.933.1">
     Figure 9.7 – Accessing the Configuration explorer option of Azure App Configuration
    </span>
   </p>
   <ol>
    <li value="2">
     <span class="koboSpan" id="kobo.934.1">
      Then, click on the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.935.1">
       Create
      </span>
     </strong>
     <span class="koboSpan" id="kobo.936.1">
      |
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.937.1">
       Key-value
      </span>
     </strong>
     <span class="koboSpan" id="kobo.938.1">
      option, as shown in
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.939.1">
        Figure 9
       </span>
      </em>
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.940.1">
        .8
       </span>
      </em>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.941.1">
       :
      </span>
     </span>
    </li>
   </ol>
   <p class="IMG---Figure">
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer102">
     <span class="koboSpan" id="kobo.942.1">
      <img alt="Figure 9.8 – Adding a new configuration on Azure App Configuration" src="image/B21788_09_08.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.943.1">
     Figure 9.8 – Adding a new configuration on Azure App Configuration
    </span>
   </p>
   <p class="list-inset">
    <span class="koboSpan" id="kobo.944.1">
     A form will be displayed where we will enter the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.945.1">
      following parameters:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.946.1">
        Key
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.947.1">
       :
      </span>
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.948.1">
        DynamicConfiguration:Sentinel
       </span>
      </strong>
     </span>
    </li>
    <li>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.949.1">
        Value
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.950.1">
       :
      </span>
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.951.1">
        1
       </span>
      </strong>
     </span>
    </li>
   </ul>
   <ol>
    <li value="3">
     <span class="koboSpan" id="kobo.952.1">
      Leave the rest
     </span>
     <a id="_idIndexMarker766">
     </a>
     <span class="koboSpan" id="kobo.953.1">
      of the parameters at
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.954.1">
       their defaults.
      </span>
     </span>
    </li>
    <li>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.955.1">
       Click
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.956.1">
        Apply
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.957.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.958.1">
      Repeat
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.959.1">
       step 2
      </span>
     </em>
     <span class="koboSpan" id="kobo.960.1">
      and add another key with the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.961.1">
       following configuration:
      </span>
     </span>
     <ul>
      <li>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.962.1">
          Key
         </span>
        </strong>
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.963.1">
         :
        </span>
       </span>
       <span class="No-Break">
        <strong class="source-inline">
         <span class="koboSpan" id="kobo.964.1">
          DynamicConfiguration:GlobalOptions:Title
         </span>
        </strong>
       </span>
      </li>
      <li>
       <strong class="bold">
        <span class="koboSpan" id="kobo.965.1">
         Value
        </span>
       </strong>
       <span class="koboSpan" id="kobo.966.1">
        :
       </span>
       <strong class="source-inline">
        <span class="koboSpan" id="kobo.967.1">
         ASP.NET
        </span>
       </strong>
       <span class="No-Break">
        <strong class="source-inline">
         <span class="koboSpan" id="kobo.968.1">
          Core 9
         </span>
        </strong>
       </span>
      </li>
     </ul>
     <p class="list-inset">
      <span class="koboSpan" id="kobo.969.1">
       Note the
      </span>
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.970.1">
        DynamicConfiguration:GlobalOptions:Title
       </span>
      </strong>
      <span class="koboSpan" id="kobo.971.1">
       key.
      </span>
      <span class="koboSpan" id="kobo.971.2">
       This key represents a hierarchy following the pattern
      </span>
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.972.1">
        &lt;Group Settings&gt;:&lt;Section&gt;
       </span>
      </strong>
      <span class="koboSpan" id="kobo.973.1">
       .
      </span>
      <span class="koboSpan" id="kobo.973.2">
       In this case, it is the name of the previously created settings class, configuration, or desired property of the configuration
      </span>
      <span class="No-Break">
       <span class="koboSpan" id="kobo.974.1">
        class format.
       </span>
      </span>
     </p>
    </li>
   </ol>
   <p class="callout-heading">
    <span class="koboSpan" id="kobo.975.1">
     Labels in Azure App Configuration
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.976.1">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.977.1">
      Label
     </span>
    </strong>
    <span class="koboSpan" id="kobo.978.1">
     parameter in Azure Application Configuration is used to differentiate configuration settings based on different contexts
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.979.1">
      or environments.
     </span>
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.980.1">
     Labels allow you to separate configurations for different environments (for example, development,
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.981.1">
      staging, production).
     </span>
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.982.1">
     This approach brings benefits, such as
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.983.1">
      the following:
     </span>
    </span>
   </p>
   <p class="callout">
    <strong class="bold">
     <span class="koboSpan" id="kobo.984.1">
      • Flexibility
     </span>
    </strong>
    <span class="koboSpan" id="kobo.985.1">
     : Easily switch between different sets
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.986.1">
      of configurations
     </span>
    </span>
   </p>
   <p class="callout">
    <strong class="bold">
     <span class="koboSpan" id="kobo.987.1">
      • Isolation
     </span>
    </strong>
    <span class="koboSpan" id="kobo.988.1">
     : Keep settings for different environments or scenarios isolated
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.989.1">
      and organized
     </span>
    </span>
   </p>
   <p class="callout">
    <strong class="bold">
     <span class="koboSpan" id="kobo.990.1">
      • Testing
     </span>
    </strong>
    <span class="koboSpan" id="kobo.991.1">
     : Safely test new configurations without affecting
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.992.1">
      other environments
     </span>
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.993.1">
     Settings that do not have a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.994.1">
      Label
     </span>
    </strong>
    <span class="koboSpan" id="kobo.995.1">
     parameter will be treated as
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.996.1">
      default settings.
     </span>
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.997.1">
     To learn more about
    </span>
    <a id="_idIndexMarker767">
    </a>
    <span class="koboSpan" id="kobo.998.1">
     labels, visit the following
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.999.1">
      URL:
     </span>
    </span>
    <a href="https://learn.microsoft.com/en-us/azure/azure-app-configuration/howto-labels-aspnet-core">
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1000.1">
       https://learn.microsoft.com/en-us/azure/azure-app-configuration/howto-labels-aspnet-core
      </span>
     </span>
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1001.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1002.1">
     Now that the
    </span>
    <a id="_idIndexMarker768">
    </a>
    <span class="koboSpan" id="kobo.1003.1">
     application is integrated with Azure App Configuration, open the terminal and access the application directory.
    </span>
    <span class="koboSpan" id="kobo.1003.2">
     Then, run the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1004.1">
      following command:
     </span>
    </span>
   </p>
   <pre class="console"><span class="koboSpan" id="kobo.1005.1">
dotnet run</span></pre>
   <p>
    <span class="koboSpan" id="kobo.1006.1">
     Now, access the application URL available on your terminal via the following URL:
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1007.1">
      http://localhost:&lt;port&gt;
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1008.1">
     .
    </span>
    <span class="koboSpan" id="kobo.1008.2">
     In the example shown in
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.1009.1">
       Figure 9
      </span>
     </em>
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.1010.1">
      .9
     </span>
    </em>
    <span class="koboSpan" id="kobo.1011.1">
     , the URL is
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1012.1">
      http://localhost:5295
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1013.1">
     .
    </span>
    <span class="koboSpan" id="kobo.1013.2">
     We can also see in
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.1014.1">
       Figure 9
      </span>
     </em>
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.1015.1">
      .9
     </span>
    </em>
    <span class="koboSpan" id="kobo.1016.1">
     a welcome message with the value defined in the App
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1017.1">
      Configuration resource:
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer103">
     <span class="koboSpan" id="kobo.1018.1">
      <img alt="Figure 9.9 – Application getting settings from Azure App Configuration" src="image/B21788_09_09.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.1019.1">
     Figure 9.9 – Application getting settings from Azure App Configuration
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1020.1">
     As we can see, the configurations are being loaded directly from the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1021.1">
      Azure resource.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1022.1">
     With the application still running, access the Azure portal (
    </span>
    <a href="http://portal.azure.com">
     <span class="koboSpan" id="kobo.1023.1">
      http://portal.azure.com
     </span>
    </a>
    <span class="koboSpan" id="kobo.1024.1">
     ) and the Azure App
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1025.1">
      Configuration resource.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1026.1">
     Then, access
    </span>
    <a id="_idIndexMarker769">
    </a>
    <span class="koboSpan" id="kobo.1027.1">
     the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1028.1">
      Configuration explorer
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1029.1">
     option.
    </span>
    <span class="koboSpan" id="kobo.1029.2">
     We will change
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1030.1">
      the settings.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1031.1">
     To do this, in the settings display grid, click on the three dots (
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1032.1">
      ...
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1033.1">
     ) as shown in
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.1034.1">
       Figure 9
      </span>
     </em>
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.1035.1">
      .10
     </span>
    </em>
    <span class="koboSpan" id="kobo.1036.1">
     and
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1037.1">
      click
     </span>
    </span>
    <span class="No-Break">
     <strong class="bold">
      <span class="koboSpan" id="kobo.1038.1">
       Edit
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1039.1">
      :
     </span>
    </span>
   </p>
   <p class="IMG---Figure">
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer104">
     <span class="koboSpan" id="kobo.1040.1">
      <img alt="Figure 9.10 – Editing configurations" src="image/B21788_09_10.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.1041.1">
     Figure 9.10 – Editing configurations
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1042.1">
     Provide the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1043.1">
      following settings:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1044.1">
       DynamicConfiguration:GlobalOptions:Title
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1045.1">
      :
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1046.1">
       ASP.NET Core 9 With
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.1047.1">
        Dynamic config
       </span>
      </strong>
     </span>
    </li>
    <li>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.1048.1">
        DynamicConfiguration:Sentinel
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1049.1">
       :
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.1050.1">
        2
       </span>
      </strong>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.1051.1">
     Wait a few seconds, access the application again, and refresh the page.
    </span>
    <span class="koboSpan" id="kobo.1051.2">
     The page body message was changed, as shown in
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.1052.1">
       Figure 9
      </span>
     </em>
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.1053.1">
       .11
      </span>
     </em>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1054.1">
      :
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer105">
     <span class="koboSpan" id="kobo.1055.1">
      <img alt="Figure 9.11 – Application obtaining configurations dynamically" src="image/B21788_09_11.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.1056.1">
     Figure 9.11 – Application obtaining configurations dynamically
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1057.1">
     Despite being a simple implementation example, using a config server is a good practice in cloud-native applications, as suggested in The Twelve-Factor App methodology
    </span>
    <a id="_idIndexMarker770">
    </a>
    <span class="koboSpan" id="kobo.1058.1">
     (
    </span>
    <a href="https://12factor.net">
     <span class="koboSpan" id="kobo.1059.1">
      https://12factor.net
     </span>
    </a>
    <span class="koboSpan" id="kobo.1060.1">
     ), and ASP.NET Core 9 provides several extensibility mechanisms, such as the one we use when integrating with Azure’s App
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1061.1">
      Configuration feature.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1062.1">
     This approach in large application scenarios in production environments can bring several benefits by offering an immediate response to
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1063.1">
      certain changes.
     </span>
    </span>
   </p>
   <p class="callout-heading">
    <span class="koboSpan" id="kobo.1064.1">
     The Twelve-Factor App methodology
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.1065.1">
     The Twelve-Factor App methodology is a methodology used as a reference in creating
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1066.1">
      SaaS
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1067.1">
     (
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1068.1">
      Software as a Service
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1069.1">
     ) application
    </span>
    <a id="_idIndexMarker771">
    </a>
    <span class="koboSpan" id="kobo.1070.1">
     and has 12 factors, technology agnostic, that offer best practices for developing cloud-native solutions.
    </span>
    <span class="koboSpan" id="kobo.1070.2">
     One of the factors is related to configuration management, related to what we learned in this chapter, and you can learn more about this factor through the following
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1071.1">
      URL:
     </span>
    </span>
    <a href="https://12factor.net/config">
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1072.1">
       https://12factor.net/config
      </span>
     </span>
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1073.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1074.1">
     Managing configurations on a server such as Azure App Configuration brings several benefits, the most important being security.
    </span>
    <span class="koboSpan" id="kobo.1074.2">
     With the easy integration with ASP.NET Core 9 applications, we can allow our applications to change settings dynamically and even segregate them by environment.
    </span>
    <span class="koboSpan" id="kobo.1074.3">
     This approach is very important in a CI/CD process.
    </span>
    <span class="koboSpan" id="kobo.1074.4">
     We will talk more about CI/CD in
    </span>
    <a href="B21788_10.xhtml#_idTextAnchor162">
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.1075.1">
        Chapter 10
       </span>
      </em>
     </span>
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1076.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1077.1">
     Another approach that can be used to bring greater capacity to our applications in addition to improving user experience, among other benefits, is real-time behavior management, which we will learn about in the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1078.1">
      next section.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-158">
    <a id="_idTextAnchor159">
    </a>
    <span class="koboSpan" id="kobo.1079.1">
     Connecting an ASP.NET Core 9 application to Azure App Configuration
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.1080.1">
     Surely at some point, you
    </span>
    <a id="_idIndexMarker772">
    </a>
    <span class="koboSpan" id="kobo.1081.1">
     have already used a mechanism that dynamically changes the behavior of an application.
    </span>
    <span class="koboSpan" id="kobo.1081.2">
     Imagine a scenario where you install, for example, a messaging app that allows users to send videos, photos,
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1082.1">
      and audio.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1083.1">
     These media are automatically downloaded when you receive messages, which requires data consumption on your smartphone.
    </span>
    <span class="koboSpan" id="kobo.1083.2">
     In general, the first action we would take would be to disable the automatic media download option.
    </span>
    <span class="koboSpan" id="kobo.1083.3">
     This setting is found in a settings menu; however, this setting completely changes, in real time, the way the application
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1084.1">
      will behave.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1085.1">
     The aforementioned example is a simple concept of changing the behavior of applications in real time.
    </span>
    <span class="koboSpan" id="kobo.1085.2">
     Likewise, at some point, web applications may have their behavior dynamically managed, and their use
    </span>
    <a id="_idIndexMarker773">
    </a>
    <span class="koboSpan" id="kobo.1086.1">
     brings several benefits, such as
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1087.1">
      the following:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1088.1">
       Controlled releases
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1089.1">
      : Gradually release features to a subset of users to monitor performance and
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1090.1">
       user feedback
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1091.1">
       A/B testing
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1092.1">
      : Conduct experiments by rotating features for different groups of users to determine the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1093.1">
       best approach
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1094.1">
       Instant rollbacks
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1095.1">
      : Quickly disable a feature if it causes problems, without redeploying
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1096.1">
       the application
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.1097.1">
     The technique that allows changing the behavior of applications in real time is called feature toggles or
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1098.1">
      feature flags
     </span>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1099.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1100.1">
     Feature toggles, also known as feature flags, are a software development technique that allows you to enable or disable features in an application at runtime without deploying new code, bringing flexibility for better risk management and improving the deployment process, enabling teams to release resources to specific users or environments, and improving overall development and
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1101.1">
      operational efficiency.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1102.1">
     In terms of coding, a feature toggle can be represented as shown in
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.1103.1">
       Figure 9
      </span>
     </em>
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.1104.1">
       .12
      </span>
     </em>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1105.1">
      :
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer106">
     <span class="koboSpan" id="kobo.1106.1">
      <img alt="Figure 9.12 – Representation of the feature toggle concept" src="image/B21788_09_12.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.1107.1">
     Figure 9.12 – Representation of the feature toggle concept
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1108.1">
     As we can see in
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.1109.1">
       Figure 9
      </span>
     </em>
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.1110.1">
      .12
     </span>
    </em>
    <span class="koboSpan" id="kobo.1111.1">
     , the feature toggle is basically a decision point in the application’s source code.
    </span>
    <span class="koboSpan" id="kobo.1111.2">
     This decision point checks whether a certain value, called a toggle, is activated.
    </span>
    <span class="koboSpan" id="kobo.1111.3">
     To check
    </span>
    <a id="_idIndexMarker774">
    </a>
    <span class="koboSpan" id="kobo.1112.1">
     if a toggle is activated, we can obtain this value through a configuration file, environment variables, and even on a remote server, which is the most
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1113.1">
      recommended way.
     </span>
    </span>
   </p>
   <p class="callout-heading">
    <span class="koboSpan" id="kobo.1114.1">
     Single Responsibility Principle
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.1115.1">
     Implementing feature toggles in ASP.NET Core 9 should follow best practices to make your code cleaner, easier to maintain, and more scalable.
    </span>
    <span class="koboSpan" id="kobo.1115.2">
     When using feature toggles, it is bad practice to lump multiple behaviors into a single class, such as handling different features or switching between old and new logic within a service.
    </span>
    <span class="koboSpan" id="kobo.1115.3">
     This approach can lead to code that is difficult to understand and modify.
    </span>
    <span class="koboSpan" id="kobo.1115.4">
     A good practice is to follow the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1116.1">
      Single Responsibility Principle
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1117.1">
     (
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1118.1">
      SRP
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1119.1">
     ), which
    </span>
    <a id="_idIndexMarker775">
    </a>
    <span class="koboSpan" id="kobo.1120.1">
     means that each class should handle only one responsibility or feature.
    </span>
    <span class="koboSpan" id="kobo.1120.2">
     By keeping each class focused on one task, you reduce complexity and make your application easier to maintain
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1121.1">
      and extend.
     </span>
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.1122.1">
     Additionally, using factory methods with DI in ASP.NET Core 9 allows you to easily swap out different implementations based on feature toggles without breaking the SRP.
    </span>
    <span class="koboSpan" id="kobo.1122.2">
     If you need to add a new feature, you can simply create a new class for that feature, isolating the existing logic.
    </span>
    <span class="koboSpan" id="kobo.1122.3">
     To learn more about the
    </span>
    <a id="_idIndexMarker776">
    </a>
    <span class="koboSpan" id="kobo.1123.1">
     SRP, access the following
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1124.1">
      URL:
     </span>
    </span>
    <a href="https://learn.microsoft.com/en-us/dotnet/architecture/modern-web-apps-azure/architectural-principles#single-responsibility">
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1125.1">
       https://learn.microsoft.com/en-us/dotnet/architecture/modern-web-apps-azure/architectural-principles#single-responsibility
      </span>
     </span>
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1126.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1127.1">
     All the details
    </span>
    <a id="_idIndexMarker777">
    </a>
    <span class="koboSpan" id="kobo.1128.1">
     surrounding the use of the feature toggle technique and its respective benefits not only for development teams but also for management and complexity aspects go beyond the scope of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1129.1">
      this book.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1130.1">
     We already have a basic knowledge of using this technique, and now, it’s time to use it in an ASP.NET Core
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1131.1">
      9 application.
     </span>
    </span>
   </p>
   <h3>
    <span class="koboSpan" id="kobo.1132.1">
     Managing feature toggles with Azure App Configuration
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.1133.1">
     In the previous topic, we used the
    </span>
    <a id="_idIndexMarker778">
    </a>
    <span class="koboSpan" id="kobo.1134.1">
     Azure App Configuration feature for configuration management; however, this service also includes
    </span>
    <a id="_idIndexMarker779">
    </a>
    <span class="koboSpan" id="kobo.1135.1">
     feature flags, which you can use to enable or disable a feature.
    </span>
    <span class="koboSpan" id="kobo.1135.2">
     Through the UI in the Azure portal, we can create and manage the feature flags of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1136.1">
      our applications.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1137.1">
     Let’s make some changes to the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1138.1">
      DynamicConfiguration
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1139.1">
     project code, created previously, and add
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1140.1">
      feature toggles:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.1141.1">
      Open the terminal and go to the application directory.
     </span>
     <span class="koboSpan" id="kobo.1141.2">
      Then, run the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1142.1">
       following commands:
      </span>
     </span>
     <pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.1143.1">dotnet add package Microsoft.Azure.AppConfiguration.AspNetCore</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1144.1">dotnet add package Microsoft.FeatureManagement.AspNetCore</span></strong></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1145.1">
      These packages are necessary to incorporate the SDK for managing toggles in
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1146.1">
       the application.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1147.1">
      Open the
     </span>
     <a id="_idIndexMarker780">
     </a>
     <span class="koboSpan" id="kobo.1148.1">
      application in
     </span>
     <a id="_idIndexMarker781">
     </a>
     <span class="koboSpan" id="kobo.1149.1">
      Visual Studio Code, then we will edit the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1150.1">
       Program.cs
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1151.1">
      file, which will have the following
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1152.1">
       updated code:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.1153.1">
using DynamicConfiguration.Options;
using Microsoft.Extensions.Configuration
  .AzureAppConfiguration;
</span><strong class="bold"><span class="koboSpan" id="kobo.1154.1">using Microsoft.FeatureManagement;</span></strong><span class="koboSpan" id="kobo.1155.1">
var builder = WebApplication.CreateBuilder(args);
builder.Services.AddAzureAppConfiguration();
</span><strong class="bold"><span class="koboSpan" id="kobo.1156.1">builder.Services.AddFeatureManagement();</span></strong><span class="koboSpan" id="kobo.1157.1">
var connectionString = builder.Configuration
  .GetConnectionString("AppConfig");
builder.Configuration
  .AddAzureAppConfiguration(options =&gt;
{
  options.Connect(connectionString)
  .Select("DynamicConfiguration:*", LabelFilter.Null)
  .ConfigureRefresh(refreshOptions =&gt; refreshOptions
  .Register("DynamicConfiguration:Sentinel",
    refreshAll: true))
  .</span><strong class="bold"><span class="koboSpan" id="kobo.1158.1">UseFeatureFlags(featureFlagsOptions =&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1159.1">  {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1160.1">    featureFlagsOptions.CacheExpirationInterval =</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1161.1">    TimeSpan.FromSeconds(5);</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1162.1">  });</span></strong><span class="koboSpan" id="kobo.1163.1">
});
builder.Services.Configure&lt;GlobalOptions&gt;
  (builder.Configuration.GetSection(
    "DynamicConfiguration:GlobalOptions"));
builder.Services.AddControllersWithViews();
var app = builder.Build();
if (!app.Environment.IsDevelopment())
{
  app.UseExceptionHandler("/Home/Error");
  app.UseHsts();
}
// Middleware to refresh configuration
app.UseAzureAppConfiguration();
app.UseHttpsRedirection();
app.UseStaticFiles();
app.UseRouting();
app.UseAuthorization();
app.MapControllerRoute(
name: "default",
pattern: "{controller=Home}/{action=Index}/{id?}");
app.Run();</span></pre>
     <p class="list-inset">
      <span class="koboSpan" id="kobo.1164.1">
       Basically, we
      </span>
      <a id="_idIndexMarker782">
      </a>
      <span class="koboSpan" id="kobo.1165.1">
       make three
      </span>
      <a id="_idIndexMarker783">
      </a>
      <span class="koboSpan" id="kobo.1166.1">
       changes to the
      </span>
      <span class="No-Break">
       <strong class="source-inline">
        <span class="koboSpan" id="kobo.1167.1">
         Program.cs
        </span>
       </strong>
      </span>
      <span class="No-Break">
       <span class="koboSpan" id="kobo.1168.1">
        file:
       </span>
      </span>
     </p>
     <ul>
      <li>
       <strong class="source-inline">
        <span class="koboSpan" id="kobo.1169.1">
         using Microsoft.FeatureManagement
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1170.1">
        : Adding the namespaces necessary to add the SDK’s toggle
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.1171.1">
         management features.
        </span>
       </span>
      </li>
      <li>
       <strong class="source-inline">
        <span class="koboSpan" id="kobo.1172.1">
         builder.Services.AddFeatureManagement()
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1173.1">
        : Adding services to the
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.1174.1">
         application’s DIC.
        </span>
       </span>
      </li>
      <li>
       <strong class="source-inline">
        <span class="koboSpan" id="kobo.1175.1">
         .UseFeatureFlags
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1176.1">
        : We changed the connection settings with Azure App Configuration, informing us that the toggle management feature will be used.
       </span>
       <span class="koboSpan" id="kobo.1176.2">
        Additionally, a 5-second cache was defined using the
       </span>
       <span class="No-Break">
        <strong class="source-inline">
         <span class="koboSpan" id="kobo.1177.1">
          featureFlagsOptions.CacheExpirationInterval
         </span>
        </strong>
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.1178.1">
         standard.
        </span>
       </span>
      </li>
     </ul>
    </li>
   </ol>
   <p>
    <span class="koboSpan" id="kobo.1179.1">
     As part of the
    </span>
    <a id="_idIndexMarker784">
    </a>
    <span class="koboSpan" id="kobo.1180.1">
     Azure App Configuration
    </span>
    <a id="_idIndexMarker785">
    </a>
    <span class="koboSpan" id="kobo.1181.1">
     SDK, we can work with toggles directly in the code of controllers or services, using the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1182.1">
      IFeatureManager
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1183.1">
     interface, the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1184.1">
      FeatureGate
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1185.1">
     attribute, or
    </span>
    <a id="_idIndexMarker786">
    </a>
    <span class="koboSpan" id="kobo.1186.1">
     a
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1187.1">
      tag helper
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1188.1">
     directly in views.
    </span>
    <span class="koboSpan" id="kobo.1188.2">
     For this example, we will use a
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1189.1">
      tag helper.
     </span>
    </span>
   </p>
   <p class="callout-heading">
    <span class="koboSpan" id="kobo.1190.1">
     Using IFeatureManagement and the FeatureGate attribute
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.1191.1">
     In some cases, we can analyze
    </span>
    <a id="_idIndexMarker787">
    </a>
    <span class="koboSpan" id="kobo.1192.1">
     whether a toggle is activated or not through the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1193.1">
      IFeatureManagement
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1194.1">
     interface, which is injected into a class and provides us with methods to test the values, such as
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1195.1">
      the following:
     </span>
    </span>
   </p>
   <p class="callout">
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1196.1">
      public class MyController :
     </span>
    </strong>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1197.1">
       Controller
      </span>
     </strong>
    </span>
   </p>
   <p class="callout">
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1198.1">
      {
     </span>
    </strong>
   </p>
   <p class="callout">
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1199.1">
      private readonly
     </span>
    </strong>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1200.1">
       IFeatureManager _featureManager;
      </span>
     </strong>
    </span>
   </p>
   <p class="callout">
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1201.1">
      public
     </span>
    </strong>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1202.1">
       MyController(IFeatureManager featureManager)
      </span>
     </strong>
    </span>
   </p>
   <p class="callout">
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1203.1">
      {
     </span>
    </strong>
   </p>
   <p class="callout">
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1204.1">
      _featureManager =
     </span>
    </strong>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1205.1">
       featureManager;
      </span>
     </strong>
    </span>
   </p>
   <p class="callout">
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1206.1">
      }
     </span>
    </strong>
   </p>
   <p class="callout">
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1207.1">
      private async
     </span>
    </strong>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1208.1">
       Task MyMethod()
      </span>
     </strong>
    </span>
   </p>
   <p class="callout">
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1209.1">
      {
     </span>
    </strong>
   </p>
   <p class="callout">
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1210.1">
      if (await
     </span>
    </strong>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1211.1">
       _featureManager
      </span>
     </strong>
    </span>
   </p>
   <p class="callout">
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1212.1">
      .
     </span>
    </strong>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1213.1">
       IsEnableAsync("FeatureToggleName"))
      </span>
     </strong>
    </span>
   </p>
   <p class="callout">
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1214.1">
      {
     </span>
    </strong>
   </p>
   <p class="callout">
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1215.1">
     </span>
    </strong>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1216.1">
       Console.WriteLine("New Approach");
      </span>
     </strong>
    </span>
   </p>
   <p class="callout">
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1217.1">
      }
     </span>
    </strong>
   </p>
   <p class="callout">
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1218.1">
     </span>
    </strong>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1219.1">
       else
      </span>
     </strong>
    </span>
   </p>
   <p class="callout">
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1220.1">
      {
     </span>
    </strong>
   </p>
   <p class="callout">
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1221.1">
     </span>
    </strong>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1222.1">
       Console.WriteLine("Legacy Approach");
      </span>
     </strong>
    </span>
   </p>
   <p class="callout">
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1223.1">
      }
     </span>
    </strong>
   </p>
   <p class="callout">
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1224.1">
      }
     </span>
    </strong>
   </p>
   <p class="callout">
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1225.1">
      }
     </span>
    </strong>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.1226.1">
     In the same way, it is possible
    </span>
    <a id="_idIndexMarker788">
    </a>
    <span class="koboSpan" id="kobo.1227.1">
     to annotate an action or controller with the
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1228.1">
       FeatureGate
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1229.1">
      attribute:
     </span>
    </span>
   </p>
   <p class="callout">
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1230.1">
       using Microsoft.FeatureManagement.Mvc;
      </span>
     </strong>
    </span>
   </p>
   <p class="callout">
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1231.1">
      [
     </span>
    </strong>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1232.1">
       FeatureGate("FeatureToggleName)]
      </span>
     </strong>
    </span>
   </p>
   <p class="callout">
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1233.1">
      public class MyController :
     </span>
    </strong>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1234.1">
       Controller
      </span>
     </strong>
    </span>
   </p>
   <p class="callout">
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1235.1">
      {
     </span>
    </strong>
   </p>
   <p class="callout">
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1236.1">
      // ....
     </span>
    </strong>
   </p>
   <p class="callout">
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1237.1">
      }
     </span>
    </strong>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.1238.1">
     This way, it is possible to benefit from the use of toggle management with different implementations but the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1239.1">
      same concept.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1240.1">
     Let’s change the
    </span>
    <a id="_idIndexMarker789">
    </a>
    <span class="koboSpan" id="kobo.1241.1">
     application to use a
    </span>
    <a id="_idIndexMarker790">
    </a>
    <span class="koboSpan" id="kobo.1242.1">
     tag helper, which will use the feature toggle.
    </span>
    <span class="koboSpan" id="kobo.1242.2">
     Follow the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1243.1">
      next steps:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.1244.1">
      In Visual Studio Code, edit the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1245.1">
       Views/_ViewImports.cshtml
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1246.1">
      file and add the following code to the file, below the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1247.1">
       existing code:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.1248.1">
@addTagHelper *, Microsoft.FeatureManagement
  .AspNetCore</span></pre>
     <p class="list-inset">
      <span class="koboSpan" id="kobo.1249.1">
       This code adds a tag helper from the Azure App
      </span>
      <span class="No-Break">
       <span class="koboSpan" id="kobo.1250.1">
        Configuration SDK.
       </span>
      </span>
     </p>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1251.1">
      Then, open the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1252.1">
       Views/Home/Index.cstml
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1253.1">
      file and use the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1254.1">
       following code:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.1255.1">
&lt;div class="text-center"&gt;
&lt;h1 class="display-4"&gt;Welcome @ViewData["Title"]&lt;/h1&gt;
&lt;p&gt;Learn about &lt;a
  href="https://learn.microsoft.com/aspnet/core"&gt;
  building Web apps with ASP.NET Core&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
</span><strong class="bold"><span class="koboSpan" id="kobo.1256.1">&lt;feature name="NewFeature"&gt;</span></strong><span class="koboSpan" id="kobo.1257.1">
&lt;div style="background-color: silver;
  border: dotted 1px #000000"&gt;
&lt;h3&gt;New Feature using Toggles and
  the Azure App Configuration&lt;/h3&gt;
&lt;/div&gt;
</span><strong class="bold"><span class="koboSpan" id="kobo.1258.1">&lt;/feature&gt;</span></strong></pre>
     <p class="list-inset">
      <span class="koboSpan" id="kobo.1259.1">
       Note the use of the
      </span>
      <a id="_idIndexMarker791">
      </a>
      <span class="koboSpan" id="kobo.1260.1">
       feature tag, which will basically obtain information on whether a toggle is enabled.
      </span>
      <span class="koboSpan" id="kobo.1260.2">
       If yes, the new
      </span>
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.1261.1">
        div
       </span>
      </strong>
      <span class="koboSpan" id="kobo.1262.1">
       tag will be displayed on
      </span>
      <span class="No-Break">
       <span class="koboSpan" id="kobo.1263.1">
        the screen.
       </span>
      </span>
     </p>
     <p class="list-inset">
      <span class="koboSpan" id="kobo.1264.1">
       Now that everything
      </span>
      <a id="_idIndexMarker792">
      </a>
      <span class="koboSpan" id="kobo.1265.1">
       is configured in the application, let’s add the feature toggle in Azure
      </span>
      <span class="No-Break">
       <span class="koboSpan" id="kobo.1266.1">
        App Configuration.
       </span>
      </span>
     </p>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1267.1">
      Open the Azure portal (
     </span>
     <a href="https://portal.azure.com">
      <span class="koboSpan" id="kobo.1268.1">
       https://portal.azure.com
      </span>
     </a>
     <span class="koboSpan" id="kobo.1269.1">
      ) and access the App Configuration resource created in the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1270.1">
       previous section.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1271.1">
      Then, click on the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1272.1">
       Feature manager
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1273.1">
      menu,
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1274.1">
       Create
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1275.1">
      |
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1276.1">
       Feature flag
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1277.1">
      , as shown in
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.1278.1">
        Figure 9
       </span>
      </em>
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.1279.1">
        .13
       </span>
      </em>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1280.1">
       :
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer107">
     <span class="koboSpan" id="kobo.1281.1">
      <img alt="Figure 9.13 – Adding a new feature flag" src="image/B21788_09_13.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.1282.1">
     Figure 9.13 – Adding a new feature flag
    </span>
   </p>
   <ol>
    <li value="5">
     <span class="koboSpan" id="kobo.1283.1">
      On the next screen, set the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1284.1">
       New feature flag
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1285.1">
      field to the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1286.1">
       NewFeature
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1287.1">
      value and leave the rest at their
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1288.1">
       default values.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1289.1">
      Click on the
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.1290.1">
        Apply
       </span>
      </strong>
     </span>
     <span class="No-Break">
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1291.1">
       button.
      </span>
     </span>
     <p class="list-inset">
      <span class="koboSpan" id="kobo.1292.1">
       A new feature flag will be created and disabled, as shown in
      </span>
      <span class="No-Break">
       <em class="italic">
        <span class="koboSpan" id="kobo.1293.1">
         Figure 9
        </span>
       </em>
      </span>
      <span class="No-Break">
       <em class="italic">
        <span class="koboSpan" id="kobo.1294.1">
         .14
        </span>
       </em>
      </span>
      <span class="No-Break">
       <span class="koboSpan" id="kobo.1295.1">
        :
       </span>
      </span>
     </p>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer108">
     <span class="koboSpan" id="kobo.1296.1">
      <img alt="Figure 9.14 – Application using a disabled feature flag" src="image/B21788_09_14.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.1297.1">
     Figure 9.14 – Application using a disabled feature flag
    </span>
   </p>
   <p class="list-inset">
    <span class="koboSpan" id="kobo.1298.1">
     We did this
    </span>
    <a id="_idIndexMarker793">
    </a>
    <span class="koboSpan" id="kobo.1299.1">
     configuration on
    </span>
    <a id="_idIndexMarker794">
    </a>
    <span class="koboSpan" id="kobo.1300.1">
     purpose.
    </span>
    <span class="koboSpan" id="kobo.1300.2">
     Now, run the application again using the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1301.1">
      dotnet run
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1302.1">
     command, executed through the terminal in the application directory and you’ll see there is no changes on the application.
    </span>
    <span class="koboSpan" id="kobo.1302.2">
     The reason the new
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1303.1">
      Div
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1304.1">
     tag was not displayed is that we created the toggle as
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1305.1">
       Enabled= false
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1306.1">
      .
     </span>
    </span>
   </p>
   <ol>
    <li value="7">
     <span class="koboSpan" id="kobo.1307.1">
      Keep the application running, access the Azure portal again, and enable the toggle by clicking on the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1308.1">
       Enabled
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1309.1">
      column in the grid, as shown in
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.1310.1">
        Figure 9
       </span>
      </em>
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.1311.1">
        .15
       </span>
      </em>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1312.1">
       :
      </span>
     </span>
    </li>
   </ol>
   <p class="IMG---Figure">
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer109">
     <span class="koboSpan" id="kobo.1313.1">
      <img alt="Figure 9.15 – Enabling the feature flag" src="image/B21788_09_15.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.1314.1">
     Figure 9.15 – Enabling the feature flag
    </span>
   </p>
   <ol>
    <li value="8">
     <span class="koboSpan" id="kobo.1315.1">
      Access the application again, and we can see in
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.1316.1">
        Figure 9
       </span>
      </em>
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.1317.1">
       .16
      </span>
     </em>
     <span class="koboSpan" id="kobo.1318.1">
      that a new HTML element has been added to
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1319.1">
       the page:
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer110">
     <span class="koboSpan" id="kobo.1320.1">
      <img alt="Figure 9.16 – Application behavior changed at runtime" src="image/B21788_09_16.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.1321.1">
     Figure 9.16 – Application behavior changed at runtime
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1322.1">
     By understanding and implementing dynamic configurations and feature toggles, we can create robust, flexible, and responsive ASP.NET Core
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1323.1">
      9 applications.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1324.1">
     In this chapter, we have used Azure App Configuration as a feature flag manager.
    </span>
    <span class="koboSpan" id="kobo.1324.2">
     However, ASP.NET Core 9 has integrations with several other types of toggle management servers using the same techniques learned in
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1325.1">
      this chapter.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1326.1">
     The combination of configuration management techniques and feature flags is very powerful for different application contexts, mainly interacting with cloud resources in a scenario of continuous delivery of value through
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1327.1">
      automated mechanisms.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1328.1">
     We will discuss how to host our applications in cloud environments using automated processes in the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1329.1">
      next chapter.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-159">
    <a id="_idTextAnchor160">
    </a>
    <span class="koboSpan" id="kobo.1330.1">
     Summary
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.1331.1">
     In this chapter, we delved into good practices for managing application configurations by understanding the concepts and abstractions of the IConfiguration interface.
    </span>
    <span class="koboSpan" id="kobo.1331.2">
     We also worked with concepts related to the ASP.NET Core 9 configuration provider, along with the implementation of the Options pattern.
    </span>
    <span class="koboSpan" id="kobo.1331.3">
     Finally, we worked with changing application configurations and behavior in real time using Microsoft Azure’s Azure App Configurator to implement the concept of feature flags or feature toggles.
    </span>
    <span class="koboSpan" id="kobo.1331.4">
     Working with cloud resources is an important premise for Software Engineers and in the next chapter, we will explore how to deploy applications in a
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1332.1">
      Cloud environment.
     </span>
    </span>
   </p>
  </div>
 

  <div class="Content" id="_idContainer112">
   <h1 id="_idParaDest-160" lang="en-US" xml:lang="en-US">
    <a id="_idTextAnchor161">
    </a>
    <span class="koboSpan" id="kobo.1.1">
     Part 4: Hosting, Deploying, and Preparing to the Cloud
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.2.1">
     Modern applications are dynamic, and as software engineers, our work doesn’t end after synchronizing the latest code developed.
    </span>
    <span class="koboSpan" id="kobo.2.2">
     In a scenario where the market is constantly changing, it is necessary for applications to be dynamic enough to meet constant market demands.
    </span>
    <span class="koboSpan" id="kobo.2.3">
     Therefore, development teams must adapt to the new topics surrounding the modern development model.
    </span>
    <span class="koboSpan" id="kobo.2.4">
     ASP.NET Core 9 is prepared to provide high-quality solutions, suitable for cloud environments.
    </span>
    <span class="koboSpan" id="kobo.2.5">
     In this part, we will learn about aspects involving the continuous delivery of solutions through the understanding and implementation of application publishing flows in a cloud environment with the support of automated pipelines such as
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.3.1">
      Continuous Integration
     </span>
    </strong>
    <span class="koboSpan" id="kobo.4.1">
     (
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.5.1">
      CI
     </span>
    </strong>
    <span class="koboSpan" id="kobo.6.1">
     ) and
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.7.1">
      Continuous Delivery
     </span>
    </strong>
    <span class="koboSpan" id="kobo.8.1">
     (
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.9.1">
      CD
     </span>
    </strong>
    <span class="koboSpan" id="kobo.10.1">
     ), processes associated with the DevOps culture.
    </span>
    <span class="koboSpan" id="kobo.10.2">
     We will understand what a cloud-native mindset is and how to direct our solutions to a constantly
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.11.1">
      changing market.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.12.1">
     This part has the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.13.1">
      following chapters:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <a href="B21788_10.xhtml#_idTextAnchor162">
      <em class="italic">
       <span class="koboSpan" id="kobo.14.1">
        Chapter 10
       </span>
      </em>
     </a>
     <em class="italic">
      <span class="koboSpan" id="kobo.15.1">
       , Deploying and Hosting Applications
      </span>
     </em>
    </li>
    <li>
     <a href="B21788_11.xhtml#_idTextAnchor183">
      <em class="italic">
       <span class="koboSpan" id="kobo.16.1">
        Chapter 11
       </span>
      </em>
     </a>
     <em class="italic">
      <span class="koboSpan" id="kobo.17.1">
       , Cloud-Native Development with
      </span>
     </em>
     <em class="italic">
      <span class="koboSpan" id="kobo.18.1">
       ASP.NET Core 9
      </span>
     </em>
    </li>
   </ul>
  </div>
  <div>
   <div id="_idContainer113">
   </div>
  </div>
  <div>
   <div class="Basic-Graphics-Frame" id="_idContainer114">
   </div>
  </div>
 </body></html>