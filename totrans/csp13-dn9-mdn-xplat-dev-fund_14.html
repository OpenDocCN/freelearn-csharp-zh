<html><head></head><body><div><div><div><h1 class="chapterNumber">14</h1>
    <h1 id="_idParaDest-780" class="chapterTitle">Building Interactive Web Components Using Blazor</h1>
    <p class="normal">This chapter is about using Blazor to build interactive web user interface components. You will learn how to build Blazor components that can execute their C# and .NET code on the web server or in the web browser.</p>
    <p class="normal">When components execute on the server, Blazor uses SignalR to communicate necessary updates to the user interface in the browser.</p>
    <p class="normal">When components execute in the browser using WebAssembly, they must make HTTP calls to interact with data on the server. You will learn more about this in <em class="chapterRef">Chapter 15, Building and Consuming Web Services</em>.</p>
    <p class="normal">In this chapter, we will cover the following topics:</p>
    <ul>
      <li class="bulletList">Reviewing the Blazor Web App project template</li>
      <li class="bulletList">Building components using Blazor</li>
      <li class="bulletList">Defining forms using the EditForm component</li>
    </ul>
    <h1 id="_idParaDest-781" class="heading-1">Reviewing the Blazor Web App project template</h1>
    <p class="normal">Before .NET 8, there <a id="_idIndexMarker2049"/>were separate project templates for the different hosting models, for example, <strong class="screenText">Blazor Server App</strong>, <strong class="screenText">Blazor WebAssembly App</strong>, and <strong class="screenText">Blazor WebAssembly App Empty</strong>. .NET 8 introduced a unified project template, named <strong class="screenText">Blazor Web App</strong>,<strong class="screenText"> </strong>and a client-only project template, renamed <strong class="screenText">Blazor WebAssembly Standalone App</strong>. Avoid using the other legacy project templates unless you must use older .NET SDKs.</p>
    <h2 id="_idParaDest-782" class="heading-2">Creating a Blazor Web App project</h2>
    <p class="normal">Let’s look at the default template for a Blazor Web App project. Mostly, you will see <a id="_idIndexMarker2050"/>that it is the same as an ASP.NET Core Empty template, with a few key additions:</p>
    <ol>
      <li class="numberedList" value="1">Use your preferred code editor to open the <code class="inlineCode">ModernWeb</code> solution, and then add a new project, as defined in the following list:<ul>
          <li class="bulletList level-2">Project template: <strong class="screenText">Blazor Web App</strong><strong class="keyWord"> </strong>/ <code class="inlineCode">blazor --interactivity Auto</code></li>
          <li class="bulletList level-2">Solution file and folder: <code class="inlineCode">ModernWeb</code></li>
          <li class="bulletList level-2">Project file and folder: <code class="inlineCode">Northwind.Blazor</code></li>
          <li class="bulletList level-2"><strong class="screenText">Authentication type</strong>: None</li>
          <li class="bulletList level-2"><strong class="screenText">Configure for HTTPS</strong>: Selected</li>
          <li class="bulletList level-2"><strong class="screenText">Interactive render mode</strong>: Auto (Server and WebAssembly)</li>
          <li class="bulletList level-2"><strong class="screenText">Interactivity location</strong>: Per page/component</li>
          <li class="bulletList level-2"><strong class="screenText">Include sample pages</strong>: Selected</li>
          <li class="bulletList level-2"><strong class="screenText">Do not use top-level statements</strong>: Cleared</li>
        </ul>
      </li>
    </ol>
    <div><p class="normal">If you are using VS Code or Rider, then enter the following command at the command prompt or terminal: <code class="inlineCode">dotnet new blazor --interactivity Auto -o Northwind.Blazor</code></p>
    </div>
    <div><p class="normal"><strong class="keyWord">Good Practice</strong>: The default interactive render moder is <strong class="screenText">Server</strong>. We have explicitly chosen <strong class="screenText">Auto</strong> so that we can see both render modes in this project. We have also selected to include sample pages, which you will likely not want in a real-world project.</p>
    </div>
    <ol>
      <li class="numberedList" value="2">Note that two projects are created:<ul>
          <li class="bulletList level-2"><code class="inlineCode">Northwind.Blazor</code>: This is the main ASP.NET Core project that defines and runs static SSR, streaming, and server-side Blazor components. It also references and hosts your client-side WebAssembly Blazor components.</li>
          <li class="bulletList level-2"><code class="inlineCode">Northwind.Blazor.Client</code>: This is a Blazor WebAssembly project for any client-side components that you define. In the future, it might not need to be in a separate project, but for .NET 8 and .NET 9, it still does.</li>
        </ul>
      </li>
      <li class="numberedList">In the <code class="inlineCode">ModernWeb</code> folder, in <code class="inlineCode">Directory.Packages.props</code>, add an <code class="inlineCode">&lt;ItemGroup&gt;</code> to set version numbers for server-side hosting and defining <a id="_idIndexMarker2051"/>Blazor WebAssembly packages, as shown in the following markup:
        <pre class="programlisting code-one"><code class="hljs-code">&lt;ItemGroup Label="For Blazor."&gt;
  &lt;PackageVersion Include=
    "Microsoft.AspNetCore.Components.WebAssembly.Server"
    Version="9.0.0" /&gt;
  &lt;PackageVersion Include=
    "Microsoft.AspNetCore.Components.WebAssembly"
    Version="9.0.0" /&gt;
&lt;/ItemGroup&gt;
</code></pre>
      </li>
      <li class="numberedList">In <code class="inlineCode">Northwind.Blazor.csproj</code>, note that it is identical to an ASP.NET Core project that uses the Web SDK and targets .NET 9. Note also that it references the client-side project.</li>
      <li class="numberedList">In <code class="inlineCode">Northwind.Blazor.csproj</code>, delete the version number for the <code class="inlineCode">Microsoft.AspNetCore.Components.WebAssembly.Server</code> package that allows this project to host WebAssembly components, as shown in the following markup:
        <pre class="programlisting code-one"><code class="hljs-code">&lt;Project Sdk="Microsoft.NET.Sdk.Web"&gt;
  &lt;PropertyGroup&gt;
    &lt;TargetFramework&gt;net9.0&lt;/TargetFramework&gt;
    &lt;Nullable&gt;enable&lt;/Nullable&gt;
    &lt;ImplicitUsings&gt;enable&lt;/ImplicitUsings&gt;
  &lt;/PropertyGroup&gt;
  &lt;ItemGroup&gt;
    &lt;ProjectReference Include="..\Northwind.Blazor.Client\Northwind.Blazor.Client.csproj" /&gt;
    &lt;PackageReference Include="Microsoft.AspNetCore.Components.WebAssembly.Server" /&gt;
  &lt;/ItemGroup&gt;
&lt;/Project&gt;
</code></pre>
      </li>
      <li class="numberedList">In <code class="inlineCode">Northwind.Blazor.Client.csproj</code>, note that it is similar to an ASP.NET Core project but uses the Blazor WebAssembly SDK.</li>
      <li class="numberedList">In <code class="inlineCode">Northwind.Blazor.Client.csproj</code>, delete the version number for the <code class="inlineCode">Microsoft.AspNetCore.Components.WebAssembly</code> package that allows this <a id="_idIndexMarker2052"/>project to define WebAssembly components, as shown in the following markup:
        <pre class="programlisting code-one"><code class="hljs-code">&lt;Project Sdk="Microsoft.NET.Sdk.BlazorWebAssembly"&gt;
  &lt;PropertyGroup&gt;
    &lt;TargetFramework&gt;net9.0&lt;/TargetFramework&gt;
    &lt;ImplicitUsings&gt;enable&lt;/ImplicitUsings&gt;
    &lt;Nullable&gt;enable&lt;/Nullable&gt;
    &lt;NoDefaultLaunchSettingsFile&gt;true&lt;/NoDefaultLaunchSettingsFile&gt;
    &lt;StaticWebAssetProjectMode&gt;Default&lt;/StaticWebAssetProjectMode&gt;
  &lt;/PropertyGroup&gt;
  &lt;ItemGroup&gt;
    &lt;PackageReference Include="Microsoft.AspNetCore.Components.WebAssembly" /&gt;
  &lt;/ItemGroup&gt;
&lt;/Project&gt;
</code></pre>
      </li>
      <li class="numberedList">Build the <code class="inlineCode">Northwind.Blazor</code> and <code class="inlineCode">Northwind.Blazor.Client</code> projects.</li>
      <li class="numberedList">In <code class="inlineCode">Northwind.Blazor</code>, note that <code class="inlineCode">Program.cs</code> is almost identical to an ASP.NET Core project. One difference is the section that configures services, with its call to the <code class="inlineCode">AddRazorComponents</code> method, which we had in <a id="_idIndexMarker2053"/>our <code class="inlineCode">Northwind.Web</code> project. This section also calls to enable interactivity on the server and client sides, as shown highlighted in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">using Northwind.Blazor.Client.Pages;
using Northwind.Blazor.Components;
var builder = WebApplication.CreateBuilder(args);
// Add services to the container.
<strong class="hljs-slc">builder.Services.AddRazorComponents()</strong>
<strong class="hljs-slc">  .AddInteractiveServerComponents()</strong>
<strong class="hljs-slc">  .AddInteractiveWebAssemblyComponents();</strong>
var app = builder.Build();
</code></pre>
      </li>
      <li class="numberedList">Also note the section for configuring the HTTP pipeline, which calls the <code class="inlineCode">MapRazorComponents&lt;App&gt;</code> method. This configures a root application component that will be named <code class="inlineCode">App.razor</code>, as shown highlighted in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">// Configure the HTTP request pipeline.
if (app.Environment.IsDevelopment())
{
  app.UseWebAssemblyDebugging();
}
else
{
  app.UseExceptionHandler(
    "/Error", createScopeForErrors: true);
  // The default HSTS value is 30 days. You may want to change this for production scenarios, see https://aka.ms/aspnetcore-hsts.
  app.UseHsts();
}
app.UseHttpsRedirection();
app.UseAntiforgery();
app.MapStaticAssets();
<strong class="hljs-slc">app.MapRazorComponents&lt;App&gt;()</strong>
<strong class="hljs-slc">  .AddInteractiveServerRenderMode()</strong>
<strong class="hljs-slc">  .AddInteractiveWebAssemblyRenderMode()</strong>
<strong class="hljs-slc">  .AddAdditionalAssemblies(</strong>
<strong class="hljs-slc">    typeof(Northwind.Blazor.Client._Imports).Assembly);</strong>
app.Run();
</code></pre>
      </li>
      <li class="numberedList">In <code class="inlineCode">Northwind.Blazor</code>, note that the <code class="inlineCode">Components</code> folder and its subfolders, like <code class="inlineCode">Layout</code> and <code class="inlineCode">Pages</code>, use the same naming conventions that you <a id="_idIndexMarker2054"/>used in your <code class="inlineCode">Northwind.Web</code> project when enabling Blazor components.</li>
      <li class="numberedList">In <code class="inlineCode">Northwind.Blazor.Client</code>, in <code class="inlineCode">Program.cs</code>, note that it creates a <code class="inlineCode">WebAssemblyHostBuilder</code> instead of the normal <code class="inlineCode">WebApplication</code> builder, as shown highlighted in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">using Microsoft.AspNetCore.Components.WebAssembly.Hosting;
var builder = WebAssemblyHostBuilder.CreateDefault(args);
await builder.Build().RunAsync();
</code></pre>
      </li>
      <li class="numberedList">In <code class="inlineCode">Northwind.Blazor.Client</code>, in the <code class="inlineCode">Pages</code> folder, note that there is one Blazor component named <code class="inlineCode">Counter.razor</code>.</li>
    </ol>
    <h2 id="_idParaDest-783" class="heading-2">Reviewing Blazor routing, layouts, and navigation</h2>
    <p class="normal">Let’s <a id="_idIndexMarker2055"/>review how routing <a id="_idIndexMarker2056"/>is configured for <a id="_idIndexMarker2057"/>this Blazor project, the layouts, and the navigation menu:</p>
    <ol>
      <li class="numberedList" value="1">In the <code class="inlineCode">Northwind.Blazor</code> project folder, in the <code class="inlineCode">Components</code> folder, in <code class="inlineCode">App.razor</code>, note that it defines basic HTML page markup that references a local copy of Bootstrap for styling, as well as a few Blazor-specific elements, as shown highlighted in the following markup and noted in the list after the markup:
        <pre class="programlisting code-one"><code class="hljs-code">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
  &lt;meta charset="utf-8" /&gt;
  &lt;meta name="viewport"
        content="width=device-width, initial-scale=1.0 " /&gt;
  &lt;base href="/" /&gt;
  &lt;link rel="stylesheet"
        href="@Assets["bootstrap/bootstrap.min.css"]" /&gt;
  &lt;link rel="stylesheet" href="@Assets["app.css"]" /&gt;
  &lt;link rel="stylesheet"
        href="@Assets["Northwind.Blazor.styles.css"]" /&gt;
  <strong class="hljs-tag-slc">&lt;ImportMap /&gt;</strong>
  &lt;link rel="icon" type="image/png" href="favicon.png" /&gt;
  <strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">HeadOutlet</strong><strong class="hljs-tag-slc"> /&gt;</strong>
&lt;/head&gt;
&lt;body&gt;
  <strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">Routes</strong><strong class="hljs-tag-slc"> /&gt;</strong>
  <strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">script</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">src</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">"</strong><strong class="hljs-string-slc">_framework/blazor.web.js"</strong><strong class="hljs-tag-slc">&gt;&lt;/</strong><strong class="hljs-name-slc">script</strong><strong class="hljs-tag-slc">&gt;</strong>
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
      </li>
    </ol>
    <p class="normal-one">While reviewing the preceding markup, note the following:</p>
    <ul>
      <li class="bulletList level-2">Assets are referenced using the <code class="inlineCode">ComponentBase.Assets</code> property, which resolves the fingerprinted URL for a given asset. This should be used when you use <code class="inlineCode">MapStaticAssets</code> middleware in <code class="inlineCode">Program.cs</code>.</li>
      <li class="bulletList level-2">A <code class="inlineCode">&lt;ImportMap /&gt;</code> Blazor component to represent an import map element (<code class="inlineCode">&lt;script type="importmap"&gt;&lt;/script&gt;</code>) that defines the import map for module scripts. You can learn about import maps at the following link: <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/script/type/importmap">https://developer.mozilla.org/en-US/docs/Web/HTML/Element/script/type/importmap</a>.</li>
      <li class="bulletList level-2">A <code class="inlineCode">&lt;HeadOutlet /&gt;</code> Blazor component to inject additional content <a id="_idIndexMarker2058"/>into the <code class="inlineCode">&lt;head&gt;</code> section. This is one of the built-in components available in all Blazor projects. For example, in a Blazor <a id="_idIndexMarker2059"/>page component, use the <code class="inlineCode">&lt;PageTitle&gt;</code> component to set the <code class="inlineCode">&lt;title&gt;</code> of a web page.</li>
      <li class="bulletList level-2">A <code class="inlineCode">&lt;Routes /&gt;</code> Blazor component to define the custom routes in this <a id="_idIndexMarker2060"/>project. This component can be completely customized by the developer because it is part of the current project, in a file named <code class="inlineCode">Routes.razor</code>.</li>
      <li class="bulletList level-2">A script block for <code class="inlineCode">blazor.web.js</code> that manages communication back to the server for Blazor’s dynamic features, like downloading WebAssembly components in the background and later switching from server-side to client-side component execution.</li>
    </ul>
    <ol>
      <li class="numberedList" value="2">In the <code class="inlineCode">Components</code> folder, in <code class="inlineCode">Routes.razor</code>, note that a <code class="inlineCode">&lt;Router&gt;</code> enables routing for all Blazor components found in the current project assembly or the <code class="inlineCode">Northwind.Blazor.Client</code> project assembly (for WebAssembly components), and if a matching route is found, then <code class="inlineCode">RouteView</code> is executed, which sets the default layout for the component to <code class="inlineCode">MainLayout</code> and passes any route data parameters to the component. For that component, the first <code class="inlineCode">&lt;h1&gt;</code> element in it will be focused on, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">&lt;Router AppAssembly="@typeof(Program).Assembly"
  AdditionalAssemblies="new[] {
    typeof(Client._Imports).Assembly }"&gt;
  &lt;Found Context="routeData"&gt;
    &lt;RouteView RouteData="@routeData"
               DefaultLayout="@typeof(Layout.MainLayout)" /&gt;
    &lt;FocusOnNavigate RouteData="@routeData" Selector="h1" /&gt;
  &lt;/Found&gt;
&lt;/Router&gt;
</code></pre>
      </li>
      <li class="numberedList">In the <code class="inlineCode">Components</code> folder, in <code class="inlineCode">_Imports.razor</code>, note that this file imports some <a id="_idIndexMarker2061"/>useful <a id="_idIndexMarker2062"/>namespaces <a id="_idIndexMarker2063"/>for use in all your custom Blazor components, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">@using System.Net.Http
@using System.Net.Http.Json
@using Microsoft.AspNetCore.Components.Forms
@using Microsoft.AspNetCore.Components.Routing
@using Microsoft.AspNetCore.Components.Web
@using static Microsoft.AspNetCore.Components.Web.RenderMode
@using Microsoft.AspNetCore.Components.Web.Virtualization
@using Microsoft.JSInterop
@using Northwind.Blazor
@using Northwind.Blazor.Client
@using Northwind.Blazor.Components
</code></pre>
      </li>
      <li class="numberedList">In the <code class="inlineCode">Components\Layout</code> folder, in <code class="inlineCode">MainLayout.razor</code>, note that it defines <code class="inlineCode">&lt;div&gt;</code> for a sidebar containing a navigation menu that is implemented by the <code class="inlineCode">NavMenu.razor</code> component file in this project, as well as HTML5 elements like <code class="inlineCode">&lt;main&gt;</code> and <code class="inlineCode">&lt;article&gt;</code> for the content, with a <code class="inlineCode">&lt;div&gt;</code> to show unhandled errors, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">@inherits LayoutComponentBase
&lt;div class="page"&gt;
  &lt;div class="sidebar"&gt;
    &lt;NavMenu /&gt;
  &lt;/div&gt;
  &lt;main&gt;
    &lt;div class="top-row px-4"&gt;
      &lt;a href="https://learn.microsoft.com/aspnet/core/"
         target="_blank"&gt;About&lt;/a&gt;
    &lt;/div&gt;
    &lt;article class="content px-4"&gt;
      @Body
    &lt;/article&gt;
  &lt;/main&gt;
&lt;/div&gt;
&lt;div id="blazor-error-ui" data-nosnippet&gt;
    An unhandled error has occurred.
    &lt;a href="." class="reload"&gt;Reload&lt;/a&gt;
    &lt;span class="dismiss"&gt;<img src="img/11.png" alt="" width="14" height="14"/>&lt;/span&gt;
&lt;/div&gt;
</code></pre>
      </li>
      <li class="numberedList">In the <code class="inlineCode">Components\Layout</code> folder, in <code class="inlineCode">MainLayout.razor.css</code>, note that it contains <a id="_idIndexMarker2064"/>isolated CSS <a id="_idIndexMarker2065"/>styles for the component. Due to the naming convention, styles <a id="_idIndexMarker2066"/>defined in this file take priority over others defined elsewhere that might affect the component.</li>
    </ol>
    <div><p class="normal">Blazor components often need to provide their own CSS to apply styling or JavaScript for activities that cannot be performed purely in C#, like access to browser APIs. To ensure that this does not conflict with site-level CSS and JavaScript, Blazor supports CSS and JavaScript isolation. If you have a component named <code class="inlineCode">Home.razor</code>, simply create a CSS file named <code class="inlineCode">Home.razor.css</code>. The styles defined within this file will override any other styles in the project.</p>
    </div>
    <ol>
      <li class="numberedList" value="6">In the <code class="inlineCode">Components\Layout</code> folder, in <code class="inlineCode">NavMenu.razor</code>, note that it has three <a id="_idIndexMarker2067"/>menu items, <strong class="screenText">Home</strong>, <strong class="screenText">Counter</strong>, and <strong class="screenText">Weather</strong>. These menu links are created <a id="_idIndexMarker2068"/>by using a <a id="_idIndexMarker2069"/>component named <code class="inlineCode">NavLink</code>, as shown in the following markup:
        <pre class="programlisting code-one"><code class="hljs-code">&lt;div class="top-row ps-3 navbar navbar-dark"&gt;
  &lt;div class="container-fluid"&gt;
    &lt;a class="navbar-brand" href=""&gt;Northwind.Blazor&lt;/a&gt;
  &lt;/div&gt;
&lt;/div&gt;
&lt;input type="checkbox" title="Navigation menu"
       class="navbar-toggler" /&gt;
&lt;div class="nav-scrollable" onclick=
     "document.querySelector('.navbar-toggler').click()"&gt;
  &lt;nav class="flex-column"&gt;
    &lt;div class="nav-item px-3"&gt;
      &lt;NavLink class="nav-link" href=""
               Match="NavLinkMatch.All"&gt;
        &lt;span class="bi bi-house-door-fill-nav-menu"
              aria-hidden="true"&gt;&lt;/span&gt; Home
      &lt;/NavLink&gt;
    &lt;/div&gt;
    &lt;div class="nav-item px-3"&gt;
      &lt;NavLink class="nav-link" href="counter"&gt;
        &lt;span class="bi bi-plus-square-fill-nav-menu"
              aria-hidden="true"&gt;&lt;/span&gt; Counter
      &lt;/NavLink&gt;
    &lt;/div&gt;
    &lt;div class="nav-item px-3"&gt;
      &lt;NavLink class="nav-link" href="weather"&gt;
        &lt;span class="bi bi-list-nested-nav-menu"
              aria-hidden="true"&gt;&lt;/span&gt; Weather
      &lt;/NavLink&gt;
    &lt;/div&gt;
  &lt;/nav&gt;
&lt;/div&gt;
</code></pre>
      </li>
      <li class="numberedList">Note that <code class="inlineCode">NavMenu.razor</code> has its own isolated stylesheet named <code class="inlineCode">NavMenu.razor.css</code>.</li>
      <li class="numberedList">In <a id="_idIndexMarker2070"/>the <code class="inlineCode">Components\Pages</code> folder, in <code class="inlineCode">Home.razor</code>, note that it defines a component <a id="_idIndexMarker2071"/>that sets the page title, and then it renders a heading and a welcome <a id="_idIndexMarker2072"/>message, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">@page "/"
&lt;PageTitle&gt;Home&lt;/PageTitle&gt;
&lt;h1&gt;Hello, world!&lt;/h1&gt;
Welcome to your new app.
</code></pre>
      </li>
      <li class="numberedList">In the <code class="inlineCode">Components\Pages</code> folder, in <code class="inlineCode">Weather.razor</code>, note that it defines a component that fetches weather forecasts from an injected dependency weather service and then renders them in a table, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">@page "/weather"
@attribute [StreamRendering]
&lt;PageTitle&gt;Weather&lt;/PageTitle&gt;
	
&lt;h1&gt;Weather&lt;/h1&gt;
&lt;p&gt;This component demonstrates showing data.&lt;/p&gt;
@if (forecasts == null)
{
  &lt;p&gt;&lt;em&gt;Loading...&lt;/em&gt;&lt;/p&gt;
}
else
{
  &lt;table class="table"&gt;
    &lt;thead&gt;
      &lt;tr&gt;
        &lt;th&gt;Date&lt;/th&gt;
        &lt;th&gt;Temp. (C)&lt;/th&gt;
        &lt;th&gt;Temp. (F)&lt;/th&gt;
        &lt;th&gt;Summary&lt;/th&gt;
      &lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tbody&gt;
    @foreach (var forecast in forecasts)
    {
      &lt;tr&gt;
        &lt;td&gt;@forecast.Date.ToShortDateString()&lt;/td&gt;
        &lt;td&gt;@forecast.TemperatureC&lt;/td&gt;
        &lt;td&gt;@forecast.TemperatureF&lt;/td&gt;
        &lt;td&gt;@forecast.Summary&lt;/td&gt;
       &lt;/tr&gt;
    }
    &lt;/tbody&gt;
  &lt;/table&gt;
}
@code {
  private WeatherForecast[]? forecasts;
  protected override async Task OnInitializedAsync()
  {
    // Simulate asynchronous loading to demonstrate streaming rendering
    await Task.Delay(500);
    var startDate = DateOnly.FromDateTime(DateTime.Now);
    var summaries = new[] { "Freezing", "Bracing", "Chilly", "Cool",
      "Mild", "Warm", "Balmy", "Hot", "Sweltering", "Scorching" };
    forecasts = Enumerable.Range(1, 5).Select(index =&gt;
      new WeatherForecast
      {
        Date = startDate.AddDays(index),
        TemperatureC = Random.Shared.Next(-20, 55),
        Summary = summaries[Random.Shared.Next(summaries.Length)]
      }).ToArray();
  }
  private class WeatherForecast
  {
    public DateOnly Date { get; set; }
    public int TemperatureC { get; set; }
    public string? Summary { get; set; }
    public int TemperatureF =&gt; 32 + (int)(TemperatureC / 0.5556);
  }
}
</code></pre>
      </li>
      <li class="numberedList">In the <code class="inlineCode">Northwind.Blazor.Client</code> project, in the <code class="inlineCode">Pages</code> folder, in <code class="inlineCode">Counter.razor</code>, note that a Blazor page component is defined with a route <a id="_idIndexMarker2073"/>of <code class="inlineCode">/counter</code>, a render mode that will automatically switch between <a id="_idIndexMarker2074"/>Server and WebAssembly, which has a private field named <code class="inlineCode">currentCount</code> that <a id="_idIndexMarker2075"/>is incremented on each click of a button, as shown in the following markup:
        <pre class="programlisting code-one"><code class="hljs-code">@page "/counter"
@rendermode InteractiveAuto
&lt;PageTitle&gt;Counter&lt;/PageTitle&gt;
&lt;h1&gt;Counter&lt;/h1&gt;
&lt;p role="status"&gt;Current count: @currentCount&lt;/p&gt;
&lt;button class="btn btn-primary"
  @onclick="IncrementCount"&gt;Click me&lt;/button&gt;
@code {
  private int currentCount = 0;
  private void IncrementCount()
  {
    currentCount++;
  }
}
</code></pre>
      </li>
    </ol>
    <h2 id="_idParaDest-784" class="heading-2">How to define a routable page component</h2>
    <p class="normal">To create <a id="_idIndexMarker2076"/>a routable page component, add the <code class="inlineCode">@page</code> directive to the top of a component’s <code class="inlineCode">.razor</code> file, as shown in the following markup:</p>
    <pre class="programlisting code"><code class="hljs-code">@page "/customers"
</code></pre>
    <p class="normal">The preceding code is the equivalent of a mapped endpoint in <code class="inlineCode">Program.cs</code>, as shown in the following code:</p>
    <pre class="programlisting code"><code class="hljs-code">app.MapGet("/customers", () =&gt; ...);
</code></pre>
    <p class="normal">A page component can have multiple <code class="inlineCode">@page</code> directives to register multiple routes, as shown in the following code:</p>
    <pre class="programlisting code"><code class="hljs-code">@page "/weather"
@page "/forecast"
</code></pre>
    <p class="normal">The <code class="inlineCode">Router</code> component scans the assembly specifically in its <code class="inlineCode">AppAssembly</code> parameter for Blazor components with the <code class="inlineCode">@page</code> directive, registering their URL paths as endpoints.</p>
    <p class="normal">At runtime, a page component is merged with any specific layout that you have specified in the <code class="inlineCode">Routes.razor</code> file <code class="inlineCode">&lt;RouteView&gt;</code> component. By default, the Blazor Web <a id="_idIndexMarker2077"/>App project template defines <code class="inlineCode">MainLayout.razor</code> as the layout for page components.</p>
    <div><p class="normal"><strong class="keyWord">Good Practice</strong>: By convention, put routable page Blazor components in the <code class="inlineCode">Components\Pages</code> folder.</p>
    </div>
    <h2 id="_idParaDest-785" class="heading-2">How to navigate routes and pass route parameters</h2>
    <p class="normal">Microsoft provides a dependency service named <code class="inlineCode">NavigationManager</code> that understands <a id="_idIndexMarker2078"/>Blazor routing <a id="_idIndexMarker2079"/>and the <code class="inlineCode">NavLink</code> component. The <code class="inlineCode">NavigateTo</code> method is used to go to the specified URL.</p>
    <p class="normal">Blazor routes can include case-insensitive named parameters, and your code can most easily access the values passed by binding the parameter to a property in the code block, using the <code class="inlineCode">[Parameter]</code> attribute, as shown in the following markup:</p>
    <pre class="programlisting code"><code class="hljs-code">@page "/customers/{country}"
&lt;div&gt;Country parameter as the value: @Country&lt;/div&gt;
@code {
  [Parameter]
  public string Country { get; set; }
}
</code></pre>
    <p class="normal">The recommended way to handle a parameter that should have a default value when <a id="_idIndexMarker2080"/>it is missing is to <a id="_idIndexMarker2081"/>suffix the parameter with <code class="inlineCode">?</code> and use the null-coalescing operator in the <code class="inlineCode">OnParametersSet</code> method, as shown in the following markup:</p>
    <pre class="programlisting code"><code class="hljs-code">@page "/customers/{country?}"
&lt;div&gt;Country parameter as the value: @Country&lt;/div&gt;
@code {
  [Parameter]
  public string Country { get; set; }
  protected override void OnParametersSet()
  {
    // If the automatically set property is null, then
    // set its value to USA.
    Country = Country ?? "USA";
  }
}
</code></pre>
    <h2 id="_idParaDest-786" class="heading-2">How to use the navigation link component with routes</h2>
    <p class="normal">In HTML, you use the <code class="inlineCode">&lt;a&gt;</code> element to define navigation links, as shown in the following markup:</p>
    <pre class="programlisting code"><code class="hljs-code">&lt;a href="/customers"&gt;Customers&lt;/a&gt;
</code></pre>
    <p class="normal">In <a id="_idIndexMarker2082"/>Blazor, use the <code class="inlineCode">&lt;NavLink&gt;</code> component, as shown in the following markup:</p>
    <pre class="programlisting code"><code class="hljs-code">&lt;NavLink href="/customers"&gt;Customers&lt;/NavLink&gt;
</code></pre>
    <p class="normal">The <code class="inlineCode">NavLink</code> component is better than an anchor element because it automatically sets its class to <code class="inlineCode">active</code> if its <code class="inlineCode">href</code> is a match with the current location URL. If your CSS uses a different class name, then you can set the class name in the <code class="inlineCode">NavLink.ActiveClass</code> property.</p>
    <p class="normal">By default, in the matching algorithm, the <code class="inlineCode">href</code> is a path <em class="italic">prefix</em>, so if <code class="inlineCode">NavLink</code> has an <code class="inlineCode">href</code> of <code class="inlineCode">/customers</code>, as shown in the preceding code example, then it would match all the following paths and set them all to have the <code class="inlineCode">active</code> class style:</p>
    <pre class="programlisting code"><code class="hljs-code">/customers
/customers/USA
/customers/Germany/Berlin
</code></pre>
    <p class="normal">To ensure that the matching algorithm only performs matches on <em class="italic">all</em> of the text in the <a id="_idIndexMarker2083"/>path (in other words, there is only a match when the whole complete text matches and not when just part of the path matches), then set the <code class="inlineCode">Match</code> parameter to <code class="inlineCode">NavLinkMatch.All</code>, as shown in the following code:</p>
    <pre class="programlisting code"><code class="hljs-code">&lt;NavLink href="/customers" Match="NavLinkMatch.All"&gt;Customers&lt;/NavLink&gt;
</code></pre>
    <p class="normal">If you set other attributes, such as <code class="inlineCode">target</code>, they are passed through to the underlying <code class="inlineCode">&lt;a&gt;</code> element that is generated.</p>
    <h2 id="_idParaDest-787" class="heading-2">Understanding base component classes</h2>
    <p class="normal">The <code class="inlineCode">OnParametersSet</code> method is defined by the base class that components inherit <a id="_idIndexMarker2084"/>from by default, named <code class="inlineCode">ComponentBase</code>, as shown in the following code:</p>
    <pre class="programlisting code"><code class="hljs-code">using Microsoft.AspNetCore.Components;
public abstract class ComponentBase
  : IComponent, IHandleAfterRender, IHandleEvent
{
  // Members not shown.
}
</code></pre>
    <p class="normal"><code class="inlineCode">ComponentBase</code> has some useful methods that you can call and override, as shown in <em class="italic">Table 14.1</em>:</p>
    <table id="table001-13" class="table-container">
      <tbody>
        <tr>
          <td class="table-cell">
            <p class="normal"><strong class="keyWord">Method(s)</strong></p>
          </td>
          <td class="table-cell">
            <p class="normal"><strong class="keyWord">Description</strong></p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">InvokeAsync</code></p>
          </td>
          <td class="table-cell">
            <p class="normal">Call this method to execute a function on the associated renderer’s synchronization context.</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">OnAfterRender</code>,</p>
            <p class="normal"><code class="inlineCode">OnAfterRenderAsync</code></p>
          </td>
          <td class="table-cell">
            <p class="normal">Override these methods to invoke code after each time the component has been rendered.</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">OnInitialized</code>,</p>
            <p class="normal"><code class="inlineCode">OnInitializedAsync</code></p>
          </td>
          <td class="table-cell">
            <p class="normal">Override these methods to invoke code after the component has received its initial parameters from its parent in the render tree.</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">OnParametersSet</code>,</p>
            <p class="normal"><code class="inlineCode">OnParametersSetAsync</code></p>
          </td>
          <td class="table-cell">
            <p class="normal">Override these methods to invoke code after the component has received parameters and the values have been assigned to properties.</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">ShouldRender</code></p>
          </td>
          <td class="table-cell">
            <p class="normal">Override this method to indicate if the component should render.</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">StateHasChanged</code></p>
          </td>
          <td class="table-cell">
            <p class="normal">Call this method to cause the component to re-render.</p>
          </td>
        </tr>
      </tbody>
    </table>
    <p class="packt_figref">Table 14.1: Useful methods to override in ComponentBase</p>
    <p class="normal">As you <a id="_idIndexMarker2085"/>saw in <em class="chapterRef">Chapter 13</em>,<em class="chapterRef"> Building Websites Using ASP.NET Core</em>, Blazor components can have shared layouts. You would create a <code class="inlineCode">.razor</code> component file and make it explicitly inherit from <code class="inlineCode">LayoutComponentBase</code>, as shown in the following markup:</p>
    <pre class="programlisting code"><code class="hljs-code">@inherits LayoutComponentBase
&lt;div&gt;
  ...
  @Body
  ...
&lt;/div&gt;
</code></pre>
    <p class="normal">The base class has a property named <code class="inlineCode">Body</code> that you can render in the markup at the correct place within the layout.</p>
    <p class="normal">You can <a id="_idIndexMarker2086"/>set a default layout for components in the <code class="inlineCode">App.razor</code> file and its <code class="inlineCode">Router</code> component. To explicitly set a layout for a component, use the <code class="inlineCode">@layout</code> directive, as shown in the following markup:</p>
    <pre class="programlisting code"><code class="hljs-code">@page "/customers"
@layout AlternativeLayout
&lt;div&gt;
  ...
&lt;/div&gt;
</code></pre>
    <h2 id="_idParaDest-788" class="heading-2">Running the Blazor Web App project template</h2>
    <p class="normal">Now <a id="_idIndexMarker2087"/>that we have reviewed the project template and the important parts that are specific to the Blazor server, we can start the website and review its behavior:</p>
    <ol>
      <li class="numberedList" value="1">In the <code class="inlineCode">Northwind.Blazor</code> project, in the <code class="inlineCode">Properties</code> folder, in <code class="inlineCode">launchSettings.json</code>, for the <code class="inlineCode">https</code> profile, modify the <code class="inlineCode">applicationUrl</code> to use port <code class="inlineCode">5141</code> for HTTPS and port <code class="inlineCode">5140</code> for HTTP, as shown highlighted in the following markup:
        <pre class="programlisting code-one"><code class="hljs-code">"applicationUrl": "https://localhost:<strong class="hljs-string-slc">5141</strong>;http://localhost:<strong class="hljs-string-slc">5140</strong>",
</code></pre>
      </li>
      <li class="numberedList">Start the <code class="inlineCode">Northwind.Blazor</code> project using the <code class="inlineCode">https</code> launch profile.</li>
      <li class="numberedList">Start Chrome and navigate to <code class="inlineCode">https://localhost:5141/</code>.</li>
      <li class="numberedList">In the left navigation menu, click <strong class="screenText">Weather</strong> and then the <strong class="screenText">Click me</strong> button three times, and note that the label shows <strong class="screenText">3</strong>, as shown in <em class="italic">Figure 14.1</em>:</li>
    </ol>
    <figure class="mediaobject"><img src="img/B22322_14_01.png" alt="" width="812" height="252"/></figure>
    <p class="packt_figref">Figure 14.1: A Blazor Counter component using WebAssembly</p>
    <ol>
      <li class="numberedList" value="5">In the <a id="_idIndexMarker2088"/>left navigation menu, click <strong class="screenText">Weather</strong>, and note that for half a second, a <strong class="screenText">Loading…</strong> message appears, and then it is replaced by a table of five random weather forecasts, as shown in <em class="italic">Figure 14.2</em>:</li>
    </ol>
    <figure class="mediaobject"><img src="img/B22322_14_02.png" alt="" width="812" height="389"/></figure>
    <p class="packt_figref">Figure 14.2: Fetching weather data into a Blazor Web App using streaming</p>
    <ol>
      <li class="numberedList" value="6">Close Chrome and shut down the web server.</li>
    </ol>
    <p class="normal">Now that you’ve reviewed the sample Blazor components in the Blazor Web App project template, let’s dig in and build our own.</p>
    <h1 id="_idParaDest-789" class="heading-1">Building components using Blazor</h1>
    <p class="normal">In this section, we will build a component to list, create, and edit customers in the Northwind database.</p>
    <p class="normal">We will <a id="_idIndexMarker2089"/>build it over several steps:</p>
    <ol>
      <li class="numberedList" value="1">Make a Blazor component that renders the name of a country set as a parameter.</li>
      <li class="numberedList">Make it work as a routable page as well as a component.</li>
      <li class="numberedList">Implement the functionality to perform <strong class="keyWord">CRUD</strong> (<strong class="keyWord">create</strong>, <strong class="keyWord">read</strong>, <strong class="keyWord">update</strong> and <strong class="keyWord">delete</strong>) operations on customers in a database.</li>
    </ol>
    <h2 id="_idParaDest-790" class="heading-2">Defining and testing a simple Blazor component</h2>
    <p class="normal">We will <a id="_idIndexMarker2090"/>add the new component to the existing <a id="_idIndexMarker2091"/>Blazor Web App project:</p>
    <ol>
      <li class="numberedList" value="1">In the <code class="inlineCode">Northwind.Blazor</code> project, in the <code class="inlineCode">Components\Pages</code> folder, add a new file named <code class="inlineCode">Customers.razor</code>. In Visual Studio, the project item template is named <strong class="screenText">Razor Component</strong>. In Rider, the project item template is named <strong class="screenText">Blazor Component</strong>.</li>
    </ol>
    <div><p class="normal"><strong class="keyWord">Good Practice</strong>: Remember that Blazor component filenames must start with an uppercase letter; otherwise, you will have compile errors!</p>
    </div>
    <ol>
      <li class="numberedList" value="2">Add statements to output a heading for the <code class="inlineCode">Customers</code> component, and define a code block that defines a property to store the name of a country, as shown highlighted in the following markup:
        <pre class="programlisting code-one"><code class="hljs-code">&lt;h3&gt;
  Customers <strong class="hljs-slc">@(string.IsNullOrWhiteSpace(Country)</strong>
<strong class="hljs-slc">    ? "Worldwide" : "in " + Country)</strong>
&lt;/h3&gt;
@code {
<strong class="hljs-slc">  [Parameter]</strong>
<strong class="hljs-slc">  public string? Country { get; set; }</strong>
}
</code></pre>
      </li>
    </ol>
    <div><p class="normal">The <code class="inlineCode">@code</code> block can be anywhere in the file. Some developers prefer it at the top so that any properties defined in it are available while typing the markup below, and they can more easily reference them.</p>
    </div>
    <ol>
      <li class="numberedList" value="3">In the <code class="inlineCode">Components\Pages</code> folder, in <code class="inlineCode">Home.razor</code>, add statements to the bottom <a id="_idIndexMarker2092"/>of the file to instantiate the <code class="inlineCode">Customers</code> component twice, once with <code class="inlineCode">Germany</code> set as the <code class="inlineCode">Country</code> parameter <a id="_idIndexMarker2093"/>and once without setting the country, as shown in the following markup:
        <pre class="programlisting code-one"><code class="hljs-code">&lt;Customers Country="Germany" /&gt;
&lt;Customers /&gt;
</code></pre>
      </li>
      <li class="numberedList">Start the <code class="inlineCode">Northwind.Blazor</code> project using the <code class="inlineCode">https</code> launch profile.</li>
      <li class="numberedList">Start Chrome, navigate to <code class="inlineCode">https://localhost:5141/</code>, and note the <code class="inlineCode">Customers</code> components, as shown in <em class="italic">Figure 14.3</em>:</li>
    </ol>
    <figure class="mediaobject"><img src="img/B22322_14_03.png" alt="" width="812" height="252"/></figure>
    <p class="packt_figref">Figure 14.3: The Customers components with the Country parameter set to Germany, and not set</p>
    <ol>
      <li class="numberedList" value="6">Close Chrome and shut down the web server.</li>
    </ol>
    <h2 id="_idParaDest-791" class="heading-2">Using Bootstrap icons</h2>
    <p class="normal">In the <a id="_idIndexMarker2094"/>older Blazor project templates with .NET 7 and earlier, they included all Bootstrap icons. In the new project templates with .NET 8 and later, only three icons are defined using SVG. Let’s see how the Blazor team defined those icons, and then we’ll add some more for our own use:</p>
    <ol>
      <li class="numberedList" value="1">In the <code class="inlineCode">Components\Layout</code> folder, in <code class="inlineCode">NavMenu.razor.css</code>, find the text <code class="inlineCode">bi-house</code>, and note the three icons defined using SVG, as partially shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">.bi-house-door-fill-nav-menu {
    background-image: url("data:image/svg+xml,...");
}
.bi-plus-square-fill-nav-menu {
    background-image: url("data:image/svg+xml,...");
}
.bi-list-nested-nav-menu {
    background-image: url("data:image/svg+xml,...");
}
</code></pre>
      </li>
      <li class="numberedList">In your favorite browser, navigate to <a href="https://icon-sets.iconify.design/bi/">https://icon-sets.iconify.design/bi/</a>, and note that <strong class="screenText">Bootstrap Icons</strong> have an MIT license and contain more than 2,000 icons.</li>
      <li class="numberedList">There <a id="_idIndexMarker2095"/>are two input boxes on the web page, one labeled <strong class="screenText">Search Icons</strong> and one labeled <strong class="screenText">Filter Icons</strong>. In the <strong class="screenText">Filter Icons</strong> box, enter <code class="inlineCode">globe</code>, and note that six globe icons are found.</li>
      <li class="numberedList">Click the first globe, in the <strong class="screenText">CSS</strong> section, click the <strong class="screenText">CSS</strong> button, and note that you could click the <strong class="screenText">Copy to Clipboard</strong> button to copy and paste the definition of this icon for use in the CSS stylesheet; however, you do not need to because I have already created a CSS file for you to use, with five icons defined for you to use in your Blazor project.</li>
      <li class="numberedList">In your favorite browser, navigate to <a href="https://github.com/markjprice/cs13net9/blob/main/code/ModernWeb/Northwind.Blazor/Northwind.Blazor/wwwroot/icons.css">https://github.com/markjprice/cs13net9/blob/main/code/ModernWeb/Northwind.Blazor/Northwind.Blazor/wwwroot/icons.css</a>, download the file, and save it in your own project in its <code class="inlineCode">wwwroot</code> folder.</li>
      <li class="numberedList">In the <code class="inlineCode">Components</code> folder, in the <code class="inlineCode">App.razor</code> component, in the <code class="inlineCode">&lt;head&gt;</code>, add a <code class="inlineCode">&lt;link&gt;</code> element to reference the <code class="inlineCode">icons.css</code> stylesheet, as shown in the <a id="_idIndexMarker2096"/>following markup:
        <pre class="programlisting code-one"><code class="hljs-code">&lt;link rel="stylesheet" href="@Assets["icons.css"]" /&gt;
</code></pre>
      </li>
      <li class="numberedList">Save and close the file.</li>
    </ol>
    <h2 id="_idParaDest-792" class="heading-2">Making the component a routable page component</h2>
    <p class="normal">It is <a id="_idIndexMarker2097"/>simple to turn this component into a routable page component with a route parameter for the country:</p>
    <ol>
      <li class="numberedList" value="1">In the <code class="inlineCode">Components\Pages</code> folder, in the <code class="inlineCode">Customers.razor</code> component, add a statement at the top of the file to register <code class="inlineCode">/customers</code> as its route with an optional <code class="inlineCode">country</code> route parameter, as shown in the following markup:
        <pre class="programlisting code-one"><code class="hljs-code">@page "/customers/{country?}"
</code></pre>
      </li>
      <li class="numberedList">In the <code class="inlineCode">Components\Layout</code> folder, in <code class="inlineCode">NavMenu.razor</code>, at the bottom of the existing list item elements, add two list item elements for our routable page component, showing customers worldwide and in Germany that both use an icon of people, as shown in the following markup:
        <pre class="programlisting code-one"><code class="hljs-code">&lt;div class="nav-item px-3"&gt;
  &lt;NavLink class="nav-link" href="customers"
           Match="NavLinkMatch.All"&gt;
    &lt;span class="bi bi-globe" aria-hidden="true"&gt;&lt;/span&gt;
    Customers Worldwide
  &lt;/NavLink&gt;
&lt;/div&gt;
&lt;div class="nav-item px-3"&gt;
  &lt;NavLink class="nav-link" href="customers/Germany"&gt;
    &lt;span class="bi bi-globe-europe-africa"
          aria-hidden="true"&gt;&lt;/span&gt;
    Customers in Germany
  &lt;/NavLink&gt;
&lt;/div&gt;
</code></pre>
      </li>
      <li class="numberedList">In the <code class="inlineCode">Components\Pages</code> folder, in <code class="inlineCode">Home.razor</code>, remove the two <code class="inlineCode">&lt;Customers&gt;</code> components because we can test them using their navigation menu items from now on, and we want to keep the home page as simple as possible.</li>
      <li class="numberedList">Start the <code class="inlineCode">Northwind.Blazor</code> project using the <code class="inlineCode">https</code> launch profile.</li>
      <li class="numberedList">Start Chrome and navigate to <code class="inlineCode">https://localhost:5141/</code>.</li>
      <li class="numberedList">In the left navigation menu, click <strong class="screenText">Customers in Germany</strong>. Note that the <a id="_idIndexMarker2098"/>country name is correctly passed to the page component and that the component uses the same layout as the other page components, like <code class="inlineCode">Home.razor</code>. Also note the URL, <a href="https://localhost:5141/customers/Germany">https://localhost:5141/customers/Germany</a>, as shown in <em class="italic">Figure 14.4</em>:</li>
    </ol>
    <figure class="mediaobject"><img src="img/B22322_14_04.png" alt="" width="812" height="333"/></figure>
    <p class="packt_figref">Figure 14.4: Customers in Germany</p>
    <ol>
      <li class="numberedList" value="7">Close Chrome and shut down the web server.</li>
    </ol>
    <h2 id="_idParaDest-793" class="heading-2">Getting entities into a Blazor component</h2>
    <p class="normal">Now that <a id="_idIndexMarker2099"/>you have seen the minimum implementation of a Blazor page component, we can add some useful functionality to it. In this case, we will use the Northwind database context to fetch customers from the database:</p>
    <ol>
      <li class="numberedList" value="1">In <code class="inlineCode">Northwind.Blazor.csproj</code>, add a reference to the Northwind database context project for either SQL Server or SQLite, and globally import the namespace to work with Northwind entities, as shown in the following markup:
        <pre class="programlisting code-one"><code class="hljs-code">&lt;ItemGroup&gt;
  &lt;!-- change Sqlite to SqlServer if you prefer --&gt;
  &lt;ProjectReference Include="..\..\Northwind.DataContext.Sqlite
\Northwind.DataContext.Sqlite.csproj" /&gt;
&lt;/ItemGroup&gt;
&lt;ItemGroup&gt;
  &lt;Using Include="Northwind.EntityModels" /&gt;
&lt;/ItemGroup&gt;
</code></pre>
        <div><p class="normal"><strong class="keyWord">Warning!</strong> The relative path to the data context project is two directories up from the current project, so we must use <code class="inlineCode">..\..\</code>.</p>
        </div>
      </li>
    </ol>
    <ol>
      <li class="numberedList" value="2">Build the <code class="inlineCode">Northwind.Blazor</code> project.</li>
      <li class="numberedList">In <code class="inlineCode">Program.cs</code>, before the call to <code class="inlineCode">Build</code>, add a statement to register the Northwind database context in the dependency services collection, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">builder.Services.AddNorthwindContext(
  relativePath: @"..\..");
</code></pre>
      </li>
    </ol>
    <div><p class="normal">We need to explicitly set the <code class="inlineCode">relativePath</code> because the <code class="inlineCode">Northwind.db</code> file is in the <code class="inlineCode">ModernWeb</code> folder and the project runs in the <code class="inlineCode">ModernWeb\Northwind.Blazor\Northwind.Blazor</code> folder.</p>
    </div>
    <h2 id="_idParaDest-794" class="heading-2">Abstracting a service for a Blazor component</h2>
    <p class="normal">We could implement the Blazor component so that it directly calls the Northwind <a id="_idIndexMarker2100"/>database context to fetch the customers using an entity model. This would work if the Blazor component executes on the server. However, if the component ran in the browser using WebAssembly, then it would not work.</p>
    <p class="normal">We will now create a local dependency service to enable better reuse of the components:</p>
    <ol>
      <li class="numberedList" value="1">Use your preferred coding tool to add a new project, as defined in the following list:<ul>
          <li class="bulletList level-2">Project template: <strong class="screenText">Class Library</strong> / <code class="inlineCode">classlib</code></li>
          <li class="bulletList level-2">Project file and folder: <code class="inlineCode">Northwind.Blazor.Services</code></li>
          <li class="bulletList level-2">Solution file and folder: <code class="inlineCode">ModernWeb</code></li>
        </ul>
      </li>
      <li class="numberedList">In the <code class="inlineCode">Northwind.Blazor.Services.csproj</code> project file, add a project reference to the Northwind entity models library, as shown in the following markup:
        <pre class="programlisting code-one"><code class="hljs-code">&lt;ItemGroup&gt;
  &lt;!-- change Sqlite to SqlServer if you prefer --&gt;
  &lt;ProjectReference Include="..\Northwind.EntityModels.Sqlite\
Northwind.EntityModels.Sqlite.csproj" /&gt;
&lt;/ItemGroup&gt;
</code></pre>
      </li>
      <li class="numberedList">Build the <code class="inlineCode">Northwind.Blazor.Services</code> project.</li>
      <li class="numberedList">In the <code class="inlineCode">Northwind.Blazor.Services</code> project, rename <code class="inlineCode">Class1.cs</code> to <code class="inlineCode">INorthwindService.cs</code>.</li>
      <li class="numberedList">In <code class="inlineCode">INorthwindService.cs</code>, define a contract for a local service that abstracts CRUD operations, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">using Northwind.EntityModels; // To use Customer.
namespace Northwind.Blazor.Services;
public interface INorthwindService
{
  Task&lt;List&lt;Customer&gt;&gt; GetCustomersAsync();
  Task&lt;List&lt;Customer&gt;&gt; GetCustomersAsync(string country);
  Task&lt;Customer?&gt; GetCustomerAsync(string id);
  Task&lt;Customer&gt; CreateCustomerAsync(Customer c);
  Task&lt;Customer&gt; UpdateCustomerAsync(Customer c);
  Task DeleteCustomerAsync(string id);
}
</code></pre>
      </li>
      <li class="numberedList">In the <code class="inlineCode">Northwind.Blazor.csproj</code> project file, add a project reference to the services <a id="_idIndexMarker2101"/>class library, as shown highlighted in the following markup:
        <pre class="programlisting code-one"><code class="hljs-code">&lt;ItemGroup&gt;
  &lt;!-- change Sqlite to SqlServer if you prefer --&gt;
  &lt;ProjectReference Include="..\Northwind.DataContext.Sqlite
\Northwind.DataContext.Sqlite.csproj" /&gt;
<strong class="hljs-slc">  </strong><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">ProjectReference</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">Include</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">"</strong><strong class="hljs-string-slc">..\..\Northwind.Blazor.Services\</strong>
<strong class="hljs-string-slc">Northwind.Blazor.Services.csproj"</strong><strong class="hljs-tag-slc"> /&gt;</strong>
&lt;/ItemGroup&gt;
</code></pre>
      </li>
      <li class="numberedList">Build the <code class="inlineCode">Northwind.Blazor</code> project.</li>
      <li class="numberedList">In the <code class="inlineCode">Northwind.Blazor</code> project, add a new folder named <code class="inlineCode">Services</code>.</li>
      <li class="numberedList">In the <code class="inlineCode">Services</code> folder, add a new file named <code class="inlineCode">NorthwindServiceServerSide.cs</code>, and modify its contents to implement the <code class="inlineCode">INorthwindService</code> interface by using the Northwind database context, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">using Microsoft.EntityFrameworkCore; // To use ToListAsync&lt;T&gt;.
namespace Northwind.Blazor.Services;
public class NorthwindServiceServerSide : INorthwindService
{
  private readonly NorthwindContext _db;
  public NorthwindServiceServerSide(NorthwindContext db)
  {
    _db = db;
  }
  public Task&lt;List&lt;Customer&gt;&gt; GetCustomersAsync()
  {
    return _db.Customers.ToListAsync();
  }
  public Task&lt;List&lt;Customer&gt;&gt; GetCustomersAsync(string country)
  {
    return _db.Customers.Where(c =&gt; c.Country == country).ToListAsync();
  }
  public Task&lt;Customer?&gt; GetCustomerAsync(string id)
  {
    return _db.Customers.FirstOrDefaultAsync
      (c =&gt; c.CustomerId == id);
  }
  public Task&lt;Customer&gt; CreateCustomerAsync(Customer c)
  {
    _db.Customers.Add(c);
    _db.SaveChangesAsync();
    return Task.FromResult(c);
  }
  public Task&lt;Customer&gt; UpdateCustomerAsync(Customer c)
  {
    _db.Entry(c).State = EntityState.Modified;
    _db.SaveChangesAsync();
    return Task.FromResult(c);
  }
  public Task DeleteCustomerAsync(string id)
  {
    Customer? customer = _db.Customers.FirstOrDefaultAsync
      (c =&gt; c.CustomerId == id).Result;
    if (customer == null)
    {
      return Task.CompletedTask;
    }
    else
    {
      _db.Customers.Remove(customer);
      return _db.SaveChangesAsync();
    }
  }
}
</code></pre>
      </li>
      <li class="numberedList">In <code class="inlineCode">Program.cs</code>, import <a id="_idIndexMarker2102"/>the namespace for our service, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">using Northwind.Blazor.Services; // To use INorthwindService.
</code></pre>
      </li>
      <li class="numberedList">In <code class="inlineCode">Program.cs</code>, before the call to <code class="inlineCode">Build</code>, add a statement to register <code class="inlineCode">NorthwindServiceServerSide</code> as a transient service that implements the <code class="inlineCode">INorthwindService</code> interface, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">builder.Services.AddTransient&lt;INorthwindService,
  NorthwindServiceServerSide&gt;();
</code></pre>
      </li>
    </ol>
    <div><p class="normal">A transient service <a id="_idIndexMarker2103"/>is one that creates a new instance for each request. You can read more about the different lifetimes for services at the following link: <a href="https://learn.microsoft.com/en-us/dotnet/core/extensions/dependency-injection#service-lifetimes">https://learn.microsoft.com/en-us/dotnet/core/extensions/dependency-injection#service-lifetimes</a>.</p>
    </div>
    <ol>
      <li class="numberedList" value="12">In the <code class="inlineCode">Components</code> folder, in <code class="inlineCode">_Imports.razor</code>, import the namespace to work with the Northwind entities and our service so that Blazor components that we build do not need to import the namespaces individually, as shown in the following markup:
        <pre class="programlisting code-one"><code class="hljs-code">@using Northwind.Blazor.Services @* To use INorthwindService. *@
@using Northwind.EntityModels @* To use Northwind entities. *@
</code></pre>
      </li>
    </ol>
    <div><p class="normal">The <code class="inlineCode">_Imports.razor</code> file only applies to <code class="inlineCode">.razor</code> files. If you use code-behind <code class="inlineCode">.cs</code> files to implement component code, then they must have namespaces imported separately or use global <code class="inlineCode">usings</code> to implicitly import the namespaces.</p>
    </div>
    <ol>
      <li class="numberedList" value="13">In the <code class="inlineCode">Components\Pages</code> folder, in <code class="inlineCode">Customers.razor</code>, add statements to inject <a id="_idIndexMarker2104"/>the service, and then use it to output a table of all customers using synchronous database operations, as shown highlighted in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">@page "/customers/{country?}"
<strong class="hljs-slc">@inject INorthwindService _service</strong>
&lt;h3&gt;
  Customers @(string.IsNullOrWhiteSpace(Country)
    ? "Worldwide" : "in " + Country)
&lt;/h3&gt;
<strong class="hljs-slc">@if (customers is null)</strong>
<strong class="hljs-slc">{</strong>
<strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">p</strong><strong class="hljs-tag-slc">&gt;&lt;</strong><strong class="hljs-name-slc">em</strong><strong class="hljs-tag-slc">&gt;</strong><strong class="hljs-slc">Loading...</strong><strong class="hljs-tag-slc">&lt;/</strong><strong class="hljs-name-slc">em</strong><strong class="hljs-tag-slc">&gt;&lt;/</strong><strong class="hljs-name-slc">p</strong><strong class="hljs-tag-slc">&gt;</strong>
<strong class="hljs-slc">}</strong>
<strong class="hljs-slc">else</strong>
<strong class="hljs-slc">{</strong>
<strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">table</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">class</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">"table"</strong><strong class="hljs-tag-slc">&gt;</strong>
<strong class="hljs-slc">  </strong><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">thead</strong><strong class="hljs-tag-slc">&gt;</strong>
<strong class="hljs-slc">    </strong><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">tr</strong><strong class="hljs-tag-slc">&gt;</strong>
<strong class="hljs-slc">      </strong><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">th</strong><strong class="hljs-tag-slc">&gt;</strong><strong class="hljs-slc">Id</strong><strong class="hljs-tag-slc">&lt;/</strong><strong class="hljs-name-slc">th</strong><strong class="hljs-tag-slc">&gt;</strong>
<strong class="hljs-slc">      </strong><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">th</strong><strong class="hljs-tag-slc">&gt;</strong><strong class="hljs-slc">Company Name</strong><strong class="hljs-tag-slc">&lt;/</strong><strong class="hljs-name-slc">th</strong><strong class="hljs-tag-slc">&gt;</strong>
<strong class="hljs-slc">      </strong><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">th</strong><strong class="hljs-tag-slc">&gt;</strong><strong class="hljs-slc">Address</strong><strong class="hljs-tag-slc">&lt;/</strong><strong class="hljs-name-slc">th</strong><strong class="hljs-tag-slc">&gt;</strong>
<strong class="hljs-slc">      </strong><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">th</strong><strong class="hljs-tag-slc">&gt;</strong><strong class="hljs-slc">Phone</strong><strong class="hljs-tag-slc">&lt;/</strong><strong class="hljs-name-slc">th</strong><strong class="hljs-tag-slc">&gt;</strong>
<strong class="hljs-slc">      </strong><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">th</strong><strong class="hljs-tag-slc">&gt;&lt;/</strong><strong class="hljs-name-slc">th</strong><strong class="hljs-tag-slc">&gt;</strong>
<strong class="hljs-slc">    </strong><strong class="hljs-tag-slc">&lt;/</strong><strong class="hljs-name-slc">tr</strong><strong class="hljs-tag-slc">&gt;</strong>
<strong class="hljs-slc">  </strong><strong class="hljs-tag-slc">&lt;/</strong><strong class="hljs-name-slc">thead</strong><strong class="hljs-tag-slc">&gt;</strong>
<strong class="hljs-slc">  </strong><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">tbody</strong><strong class="hljs-tag-slc">&gt;</strong>
<strong class="hljs-slc">  @foreach (Customer c in customers)</strong>
<strong class="hljs-slc">  {</strong>
<strong class="hljs-slc">    </strong><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">tr</strong><strong class="hljs-tag-slc">&gt;</strong>
<strong class="hljs-slc">      </strong><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">td</strong><strong class="hljs-tag-slc">&gt;</strong><strong class="hljs-slc">@c.CustomerId</strong><strong class="hljs-tag-slc">&lt;/</strong><strong class="hljs-name-slc">td</strong><strong class="hljs-tag-slc">&gt;</strong>
<strong class="hljs-slc">      </strong><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">td</strong><strong class="hljs-tag-slc">&gt;</strong><strong class="hljs-slc">@c.CompanyName</strong><strong class="hljs-tag-slc">&lt;/</strong><strong class="hljs-name-slc">td</strong><strong class="hljs-tag-slc">&gt;</strong>
<strong class="hljs-slc">      </strong><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">td</strong><strong class="hljs-tag-slc">&gt;</strong>
<strong class="hljs-slc">        @c.Address</strong><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">br</strong><strong class="hljs-tag-slc">/&gt;</strong>
<strong class="hljs-slc">        @c.City</strong><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">br</strong><strong class="hljs-tag-slc">/&gt;</strong>
<strong class="hljs-slc">        @c.PostalCode</strong><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">br</strong><strong class="hljs-tag-slc">/&gt;</strong>
<strong class="hljs-slc">        @c.Country</strong>
<strong class="hljs-slc">      </strong><strong class="hljs-tag-slc">&lt;/</strong><strong class="hljs-name-slc">td</strong><strong class="hljs-tag-slc">&gt;</strong>
<strong class="hljs-slc">      </strong><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">td</strong><strong class="hljs-tag-slc">&gt;</strong><strong class="hljs-slc">@c.Phone</strong><strong class="hljs-tag-slc">&lt;/</strong><strong class="hljs-name-slc">td</strong><strong class="hljs-tag-slc">&gt;</strong>
<strong class="hljs-slc">      </strong><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">td</strong><strong class="hljs-tag-slc">&gt;</strong>
<strong class="hljs-slc">        </strong><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">a</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">class</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">"btn btn-info"</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">href</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">"editcustomer/@c.CustomerId"</strong><strong class="hljs-tag-slc">&gt;</strong>
<strong class="hljs-slc">          </strong><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">i</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">class</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">"</strong><strong class="hljs-string-slc">bi bi-pencil"</strong><strong class="hljs-tag-slc">&gt;&lt;/</strong><strong class="hljs-name-slc">i</strong><strong class="hljs-tag-slc">&gt;&lt;/</strong><strong class="hljs-name-slc">a</strong><strong class="hljs-tag-slc">&gt;</strong>
<strong class="hljs-slc">        </strong><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">a</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">class</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">"btn btn-danger"</strong>
<strong class="hljs-tag-slc">           </strong><strong class="hljs-attr-slc">href</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">"deletecustomer/@c.CustomerId"</strong><strong class="hljs-tag-slc">&gt;</strong>
<strong class="hljs-slc">          </strong><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">i</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">class</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">"bi bi-trash"</strong><strong class="hljs-tag-slc">&gt;&lt;/</strong><strong class="hljs-name-slc">i</strong><strong class="hljs-tag-slc">&gt;&lt;/</strong><strong class="hljs-name-slc">a</strong><strong class="hljs-tag-slc">&gt;</strong>
<strong class="hljs-slc">      </strong><strong class="hljs-tag-slc">&lt;/</strong><strong class="hljs-name-slc">td</strong><strong class="hljs-tag-slc">&gt;</strong>
<strong class="hljs-slc">    </strong><strong class="hljs-tag-slc">&lt;/</strong><strong class="hljs-name-slc">tr</strong><strong class="hljs-tag-slc">&gt;</strong>
<strong class="hljs-slc">  }</strong>
<strong class="hljs-slc">  </strong><strong class="hljs-tag-slc">&lt;/</strong><strong class="hljs-name-slc">tbody</strong><strong class="hljs-tag-slc">&gt;</strong>
<strong class="hljs-tag-slc">&lt;/</strong><strong class="hljs-name-slc">table</strong><strong class="hljs-tag-slc">&gt;</strong>
<strong class="hljs-slc">}</strong>
@code {
  [Parameter]
  public string? Country { get; set; }
<strong class="hljs-slc">  private IEnumerable</strong><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">Customer</strong><strong class="hljs-tag-slc">&gt;</strong><strong class="hljs-slc">? customers;</strong>
<strong class="hljs-slc">  protected override async Task OnParametersSetAsync()</strong>
<strong class="hljs-slc">  {</strong>
<strong class="hljs-slc">    if (string.IsNullOrWhiteSpace(Country))</strong>
<strong class="hljs-slc">    {</strong>
<strong class="hljs-slc">      customers = await _service.GetCustomersAsync();</strong>
<strong class="hljs-slc">    }</strong>
<strong class="hljs-slc">    else</strong>
<strong class="hljs-slc">    {</strong>
<strong class="hljs-slc">      customers = await _service.GetCustomersAsync(Country);</strong>
<strong class="hljs-slc">    }</strong>
<strong class="hljs-slc">  }</strong>
}
</code></pre>
      </li>
      <li class="numberedList">Start the <code class="inlineCode">Northwind.Blazor</code> project using the <code class="inlineCode">https</code> launch profile.</li>
      <li class="numberedList">Start Chrome and navigate to <code class="inlineCode">https://localhost:5141/</code>.</li>
      <li class="numberedList">In the <a id="_idIndexMarker2105"/>left navigation menu, click <strong class="screenText">Customers in Germany</strong>, and note that the table of customers loads from the database and renders in the web page, as shown in <em class="italic">Figure 14.5</em>:</li>
    </ol>
    <figure class="mediaobject"><img src="img/B22322_14_05.png" alt="" width="812" height="372"/></figure>
    <p class="packt_figref">Figure 14.5: The list of customers in Germany</p>
    <ol>
      <li class="numberedList" value="17">In the browser address bar, change <code class="inlineCode">Germany</code> to <code class="inlineCode">UK</code>, and note that the table of customers is filtered to only show UK customers.</li>
      <li class="numberedList">In the left navigation menu, click <strong class="screenText">Customers Worldwide</strong>, and note that the table of customers is unfiltered by country.</li>
      <li class="numberedList">Click any of the edit or delete buttons, and note that they return a message saying <strong class="screenText">Error: 404</strong> because we have not yet implemented that functionality. Also, note the link to edit the customer identified by the <a id="_idIndexMarker2106"/>five-character identifier <code class="inlineCode">ALFKI</code>, as shown in the following link: <code class="inlineCode">https://localhost:5141/editcustomer/ALFKI</code>.</li>
      <li class="numberedList">Close Chrome and shut down the web server.</li>
    </ol>
    <h2 id="_idParaDest-795" class="heading-2">Enabling streaming rendering</h2>
    <p class="normal">Now, let’s improve the rendering of the table of customers by making it happen after the <a id="_idIndexMarker2107"/>page has appeared to the visitor. We are already using an asynchronous operation to fetch the data, but this operation must finish before the web page response is sent back to the browser. This is why we never see the <strong class="screenText">Loading…</strong> message on the page. To see it, we must enable streaming rendering. But if you are fetching data from a local database, it might still happen too quickly. So to make sure we see it, we will also slow down the fetching of the data by adding a delay:</p>
    <ol>
      <li class="numberedList" value="1">In the <code class="inlineCode">Components\Pages</code> folder, at the top of <code class="inlineCode">Customers.razor</code>, add an attribute to enable streaming rendering, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">@attribute [StreamRendering]
</code></pre>
      </li>
      <li class="numberedList">In <code class="inlineCode">Customers.razor</code>, in the <code class="inlineCode">OnParametersSetAsync</code> method, add a statement to asynchronously delay for one second, as shown highlighted in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">protected override async Task OnParametersSetAsync()
{
  <strong class="hljs-keyword-slc">await</strong><strong class="hljs-slc"> Task.Delay(</strong><strong class="hljs-number-slc">1000</strong><strong class="hljs-slc">); </strong><strong class="hljs-comment-slc">// Delay for one second.</strong>
  ...
}
</code></pre>
      </li>
      <li class="numberedList">Start the <code class="inlineCode">Northwind.Blazor</code> project using the <code class="inlineCode">https</code> launch profile.</li>
      <li class="numberedList">Start Chrome and navigate to <code class="inlineCode">https://localhost:5141/</code>.</li>
      <li class="numberedList">In the left navigation menu, click <strong class="screenText">Customers in Germany</strong>, and note that the <strong class="screenText">Loading…</strong> message appears for a second and is then replaced by the table of customers.</li>
    </ol>
    <p class="normal">So far, the <a id="_idIndexMarker2108"/>component provides only a read-only table of customers. Now, we will extend it with full CRUD operations.</p>
    <h1 id="_idParaDest-796" class="heading-1">Defining forms using the EditForm component</h1>
    <p class="normal">Microsoft provides ready-made components to build forms. We will use them to provide <a id="_idIndexMarker2109"/>create, edit, and delete functionality for customers.</p>
    <p class="normal">Microsoft <a id="_idIndexMarker2110"/>provides the <code class="inlineCode">EditForm</code> component and several form elements, such as <code class="inlineCode">InputText</code>, to make it easier to use forms with Blazor.</p>
    <p class="normal"><code class="inlineCode">EditForm</code> can have a model set to bind it to an object with properties and event handlers for custom validation, as well as to recognize standard Microsoft validation attributes on the model class, as shown in the following code:</p>
    <pre class="programlisting code"><code class="hljs-code">&lt;EditForm Model="@customer" OnSubmit="ExtraValidation"&gt;
  &lt;DataAnnotationsValidator /&gt;
  &lt;ValidationSummary /&gt;
  &lt;InputText id="name" @bind-Value="customer.CompanyName" /&gt;
  &lt;button type="submit"&gt;Submit&lt;/button&gt;
&lt;/EditForm&gt;
@code {
  private Customer customer = new();
  private void ExtraValidation()
  {
    // Perform any extra validation you want.
  }
}
</code></pre>
    <p class="normal">As an alternative to a <code class="inlineCode">ValidationSummary</code> component, you can use the <code class="inlineCode">ValidationMessage</code> component to show a message next to an individual form element. To <a id="_idIndexMarker2111"/>bind the validation <a id="_idIndexMarker2112"/>message to a property, you use a lambda expression to select the property, as shown in the following code:</p>
    <pre class="programlisting code"><code class="hljs-code">&lt;ValidationMessage For="@(() =&gt; Customer.CompanyName)" /&gt;
</code></pre>
    <h2 id="_idParaDest-797" class="heading-2">Building a customer detail component</h2>
    <p class="normal">We will <a id="_idIndexMarker2113"/>create a component to show the details of a customer. This will only be a component, never a page, so it will not have a <code class="inlineCode">@page</code> directive:</p>
    <ol>
      <li class="numberedList" value="1">In the <code class="inlineCode">Northwind.Blazor</code> project, in the <code class="inlineCode">Components</code> folder, create a new file named <code class="inlineCode">CustomerDetail.razor</code>. (The Visual Studio project item template is named <strong class="screenText">Razor Component</strong>; the Rider project item template is named <strong class="screenText">Blazor Component</strong>.)</li>
      <li class="numberedList">Modify its contents to define a form to edit the properties of a customer, as shown in the following markup:
        <pre class="programlisting code-one"><code class="hljs-code">&lt;EditForm Model="@Customer" OnValidSubmit="@OnValidSubmit"&gt;
  &lt;DataAnnotationsValidator /&gt;
  &lt;div&gt;
    &lt;label class="form-label"&gt;Customer Id&lt;/label&gt;
    &lt;div&gt;
      &lt;InputText class="form-control"
                 @bind-Value="@Customer.CustomerId" /&gt;
      &lt;ValidationMessage For="@(() =&gt; Customer.CustomerId)" /&gt;
    &lt;/div&gt;
  &lt;/div&gt;
  &lt;div&gt;
    &lt;label class="form-label"&gt;Company Name&lt;/label&gt;
    &lt;div&gt;
      &lt;InputText class="form-control"
                 @bind-Value="@Customer.CompanyName" /&gt;
      &lt;ValidationMessage For="@(() =&gt; Customer.CompanyName)" /&gt;
    &lt;/div&gt;
  &lt;/div&gt;
  &lt;div&gt;
    &lt;label class="form-label"&gt;Address&lt;/label&gt;
    &lt;div&gt;
      &lt;InputText class="form-control"
                 @bind-Value="@Customer.Address" /&gt;
      &lt;ValidationMessage For="@(() =&gt; Customer.Address)" /&gt;
    &lt;/div&gt;
  &lt;/div&gt;
  &lt;div&gt;
    &lt;label class="form-label"&gt;Country&lt;/label&gt;
    &lt;div&gt;
      &lt;InputText class="form-control"
                 @bind-Value="@Customer.Country" /&gt;
      &lt;ValidationMessage For="@(() =&gt; Customer.Country)" /&gt;
    &lt;/div&gt;
  &lt;/div&gt;
  &lt;button type="submit" class="btn btn-@ButtonStyle"&gt;
    @ButtonText
  &lt;/button&gt;
&lt;/EditForm&gt;
@code {
  [Parameter]
  public Customer Customer { get; set; } = null!;
  [Parameter]
  public string ButtonText { get; set; } = "Save Changes";
  [Parameter]
  public string ButtonStyle { get; set; } = "info";
  [Parameter]
  public EventCallback OnValidSubmit { get; set; }
}
</code></pre>
      </li>
    </ol>
    <h2 id="_idParaDest-798" class="heading-2">Building customer create, edit, and delete components</h2>
    <p class="normal">Now, we <a id="_idIndexMarker2114"/>can create three routable <a id="_idIndexMarker2115"/>page components that use the component:</p>
    <ol>
      <li class="numberedList" value="1">In <a id="_idIndexMarker2116"/>the <code class="inlineCode">Components\Pages</code> folder, create a new file named <code class="inlineCode">CreateCustomer.razor</code>.</li>
      <li class="numberedList">In <code class="inlineCode">CreateCustomer.razor</code>, modify its contents to use the customer detail component to create a new customer, as shown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">@rendermode RenderMode.InteractiveServer
@page "/createcustomer"
@inject INorthwindService _service
@inject NavigationManager _navigation
&lt;h3&gt;Create Customer&lt;/h3&gt;
&lt;CustomerDetail ButtonText="Create Customer"
                Customer="@customer"
                OnValidSubmit="@Create" /&gt;
@code {
  private Customer customer = new();
  private async Task Create()
  {
    await _service.CreateCustomerAsync(customer);
    _navigation.NavigateTo("customers");
  }
}
</code></pre>
      </li>
      <li class="numberedList">In the <code class="inlineCode">Components\Pages</code> folder, in <code class="inlineCode">Customers.razor</code>, after the <code class="inlineCode">&lt;h3&gt;</code> element, add a <code class="inlineCode">&lt;div&gt;</code> element with a button to navigate to the create customer page component, as shown in the following markup:
        <pre class="programlisting code-one"><code class="hljs-code">&lt;div&gt;
  &lt;a class="btn btn-info" href="createcustomer"&gt;
  &lt;i class="bi bi-plus-square"&gt;&lt;/i&gt; Create New&lt;/a&gt;
&lt;/div&gt;
</code></pre>
      </li>
      <li class="numberedList">In <a id="_idIndexMarker2117"/>the <code class="inlineCode">Components\Pages</code> folder, create a new file named <code class="inlineCode">EditCustomer.razor</code>, and modify its contents to use the customer detail <a id="_idIndexMarker2118"/>component to edit and save changes to an existing customer, as s<a id="_idIndexMarker2119"/>hown in the following code:
        <pre class="programlisting code-one"><code class="hljs-code">@rendermode RenderMode.InteractiveServer
@page "/editcustomer/{customerid}"
@inject INorthwindService _service
@inject NavigationManager _navigation
&lt;h3&gt;Edit Customer&lt;/h3&gt;
&lt;CustomerDetail ButtonText="Update"
                Customer="@customer"
                OnValidSubmit="@Update" /&gt;
@code {
  [Parameter]
  public string CustomerId { get; set; } = null!;
  private Customer? customer = new();
  protected override async Task OnParametersSetAsync()
  {
    customer = await _service.GetCustomerAsync(CustomerId);
  }
  private async Task Update()
  {
    if (customer is not null)
    {
      await _service.UpdateCustomerAsync(customer);
    }
    _navigation.NavigateTo("customers");
  }
}
</code></pre>
      </li>
      <li class="numberedList">In the <code class="inlineCode">Components\Pages</code> folder, create a new file named <code class="inlineCode">DeleteCustomer.razor</code>, and modify its contents to use the customer detail <a id="_idIndexMarker2120"/>component <a id="_idIndexMarker2121"/>to show the customer that is about to be deleted, as shown in the <a id="_idIndexMarker2122"/>following code:
        <pre class="programlisting code-one"><code class="hljs-code">@rendermode RenderMode.InteractiveServer
@page "/deletecustomer/{customerid}"
@inject INorthwindService _service
@inject NavigationManager _navigation
&lt;h3&gt;Delete Customer&lt;/h3&gt;
&lt;div class="alert alert-danger"&gt;
  Warning! This action cannot be undone!
&lt;/div&gt;
&lt;CustomerDetail ButtonText="Delete Customer"
                ButtonStyle="danger"
                Customer="@customer"
                OnValidSubmit="@Delete" /&gt;
@code {
  [Parameter]
  public string CustomerId { get; set; } = null!;
  private Customer? customer = new();
  protected override async Task OnParametersSetAsync()
  {
    customer = await _service.GetCustomerAsync(CustomerId);
  }
  private async Task Delete()
  {
    if (customer is not null)
    {
      await _service.DeleteCustomerAsync(CustomerId);
    }
    _navigation.NavigateTo("customers");
  }
}
</code></pre>
      </li>
    </ol>
    <h2 id="_idParaDest-799" class="heading-2">Testing the customer components</h2>
    <p class="normal">Now, we can <a id="_idIndexMarker2123"/>test the customer components and how to use them to create, edit, and delete customers:</p>
    <ol>
      <li class="numberedList" value="1">Start the <code class="inlineCode">Northwind.Blazor</code> project using the <code class="inlineCode">https</code> launch profile.</li>
      <li class="numberedList">Start Chrome and navigate to <code class="inlineCode">https://localhost:5141/</code>.</li>
      <li class="numberedList">Navigate to <strong class="screenText">Customers Worldwide</strong> or <strong class="screenText">Customers in Germany</strong> and click the <strong class="screenText">+ Create New</strong> button.</li>
      <li class="numberedList">Enter an invalid <strong class="screenText">Customer Id</strong> like <code class="inlineCode">ABCDEF</code>, leave the textbox, and note the validation message, as shown in <em class="italic">Figure 14.6</em>:</li>
    </ol>
    <figure class="mediaobject"><img src="img/B22322_14_06.png" alt="" width="812" height="333"/></figure>
    <p class="packt_figref">Figure 14.6: Creating a new customer and entering an invalid customer ID</p>
    <ol>
      <li class="numberedList" value="5">Change <strong class="screenText">Customer Id</strong> to <code class="inlineCode">ABCDE</code>, enter values for the other textboxes like <code class="inlineCode">Alpha Corp</code>, <code class="inlineCode">Main Street</code>, and <code class="inlineCode">Germany</code>, and then click the <strong class="screenText">Create Customer</strong> button.</li>
      <li class="numberedList">When the list of customers appears, click <strong class="screenText">Customers in Germany</strong>, and scroll down to the bottom of the page to see the new customer.</li>
      <li class="numberedList">On the <strong class="screenText">ABCDE</strong> customer row, click the <strong class="screenText">Edit</strong> icon button, change the address <a id="_idIndexMarker2124"/>to something like <code class="inlineCode">Upper Avenue</code>, click the <strong class="screenText">Update</strong> button, and note that the customer record has been updated.</li>
      <li class="numberedList">On the <strong class="screenText">ABCDE</strong> customer row, click the <strong class="screenText">Delete</strong> icon button, note the warning, click the <strong class="screenText">Delete Customer</strong> button, and note that the customer record has been deleted.</li>
      <li class="numberedList">Close Chrome and shut down the web server.</li>
    </ol>
    <h1 id="_idParaDest-800" class="heading-1">Practicing and exploring</h1>
    <p class="normal">Test your knowledge and understanding by answering some questions, getting some hands-on practice, and exploring this chapter’s topics with deeper research.</p>
    <h2 id="_idParaDest-801" class="heading-2">Exercise 14.1 – Online material</h2>
    <p class="normal">Online material can be created by Microsoft or third parties, or it can be found in extra content for this book.</p>
    <h3 id="_idParaDest-802" class="heading-3">Enhancing Blazor apps</h3>
    <p class="normal">To learn how to enhance Blazor apps using AOT native publish and interop with JavaScript, as well as handle location-changing events, you can read an optional online-only section, found at the following link: <a href="https://github.com/markjprice/cs13net9/blob/main/docs/ch14-enhanced-blazor.md">https://github.com/markjprice/cs13net9/blob/main/docs/ch14-enhanced-blazor.md</a>.</p>
    <h3 id="_idParaDest-803" class="heading-3">Leveraging open source Blazor component libraries</h3>
    <p class="normal">To learn how to use some common Blazor open source components, I have written an online-only section for my <em class="italic">Apps and Services with .NET 8</em> companion book, found at the following link: <a href="https://github.com/markjprice/apps-services-net8/blob/main/docs/ch15-blazor-libraries.md">https://github.com/markjprice/apps-services-net8/blob/main/docs/ch15-blazor-libraries.md</a>.</p>
    <h2 id="_idParaDest-804" class="heading-2">Exercise 14.2 – Practice exercises</h2>
    <p class="normal">Practice exercises go deeper into the topics for this chapter. First, you will create a times table component, and then you will create a country navigation component.</p>
    <h3 id="_idParaDest-805" class="heading-3">Creating a times table component</h3>
    <p class="normal">In the <code class="inlineCode">Northwind.Blazor</code> project, create a routable page component that renders a times table, based on a parameter named <code class="inlineCode">Number</code>, and then test your component in two ways.</p>
    <p class="normal">First, do so by adding an instance of your component to the <code class="inlineCode">Home.razor</code> file, as shown in the following markup, to generate the 6 times table with a default size of 12 rows, or the 7 times table with a size of 10 rows:</p>
    <pre class="programlisting code"><code class="hljs-code">&lt;TimesTable Number="6" /&gt;
&lt;TimesTable Number="7" Size="10" /&gt;
</code></pre>
    <p class="normal">Second, do so by entering a path in the browser address bar, as shown in the following links:</p>
    <ul>
      <li class="bulletList"><code class="inlineCode">https://localhost:5141/timestable/6</code></li>
      <li class="bulletList"><a href="https://localhost:5141/timestable/7/10">https://localhost:5141/timestable/7/10</a></li>
    </ul>
    <h3 id="_idParaDest-806" class="heading-3">Creating a country navigation item</h3>
    <p class="normal">In the <code class="inlineCode">Northwind.Blazor</code> project, in the <code class="inlineCode">NavMenu</code> component, call the customer’s web service to get the list of country names and loop through them, creating a menu item for each country.</p>
    <p class="normal">Here’s an example:</p>
    <ol>
      <li class="numberedList" value="1">In the <code class="inlineCode">Northwind.Blazor</code> project, in <code class="inlineCode">INorthwindService.cs</code>, add the following code:
        <pre class="programlisting code-one"><code class="hljs-code">List&lt;string?&gt; GetCountries();
</code></pre>
      </li>
      <li class="numberedList">In <code class="inlineCode">NorthwindServiceServerSide.cs</code>, add the following code:
        <pre class="programlisting code-one"><code class="hljs-code">public List&lt;string?&gt; GetCountries()
{
  return _db.Customers.Select(c =&gt; c.Country)
    .Distinct().OrderBy(country =&gt; country).ToList();
}
</code></pre>
      </li>
      <li class="numberedList">In <code class="inlineCode">NavMenu.razor</code>, add the following markup:
        <pre class="programlisting code-one"><code class="hljs-code">@inject INorthwindService _service
...
@foreach(string? country in _service.GetCountries())
{
    string countryLink = "customers/" + country;
    &lt;div class="nav-item px-3"&gt;
        &lt;NavLink class="nav-link" href="@countryLink"&gt;
        &lt;span class="oi oi-people" aria-hidden="true"&gt;&lt;/span&gt;
        Customers in @country
        &lt;/NavLink&gt;
    &lt;/div&gt;
}
</code></pre>
      </li>
    </ol>
    <div><p class="normal">You cannot use <code class="inlineCode">&lt;NavLink class="nav-link" href="customers/@c"&gt;</code> because Blazor does not allow combined text and <code class="inlineCode">@</code> Razor expressions in components. That is why the code above creates a local variable to combine the text to make the country URL.</p>
    </div>
    <h2 id="_idParaDest-807" class="heading-2">Exercise 14.3 – Test your knowledge</h2>
    <p class="normal">Answer the following questions:</p>
    <ol>
      <li class="numberedList" value="1">What are the four Blazor render modes, and how are they different?</li>
      <li class="numberedList">In a Blazor Web App project, compared to an ASP.NET Core MVC project, what extra configuration is required?</li>
      <li class="numberedList">Why should you avoid the Blazor Server and Blazor Server Empty project templates?</li>
      <li class="numberedList">In a Blazor Web App project, what does the <code class="inlineCode">App.razor</code> file do?</li>
      <li class="numberedList">What is the main benefit of using the <code class="inlineCode">&lt;NavLink&gt;</code> component?</li>
      <li class="numberedList">How can you pass a value into a component?</li>
      <li class="numberedList">What is the main benefit of using the <code class="inlineCode">&lt;EditForm&gt;</code> component?</li>
      <li class="numberedList">How can you execute some statements when parameters are set?</li>
      <li class="numberedList">How can you execute some statements when a component appears?</li>
      <li class="numberedList">One of the benefits of Blazor is being able to implement client-side components using C# and .NET instead of JavaScript. Does a Blazor component need any JavaScript?</li>
    </ol>
    <h2 id="_idParaDest-808" class="heading-2">Exercise 14.4 – Explore topics</h2>
    <p class="normal">Use the links on the following page to learn more details about the topics covered in this chapter:</p>
    <p class="normal"><a href="https://github.com/markjprice/cs13net9/blob/main/docs/book-links.md#chapter-15---building-interactive-web-components-using-blazor">https://github.com/markjprice/cs13net9/blob/main/docs/book-links.md#chapter-15---building-interactive-web-components-using-blazor</a></p>
    <h1 id="_idParaDest-809" class="heading-1">Summary</h1>
    <p class="normal">In this chapter, you learned:</p>
    <ul>
      <li class="bulletList">About the concepts of Blazor components.</li>
      <li class="bulletList">How to build Blazor components that execute on the server side, using SignalR to update the user interface during interactivity.</li>
    </ul>
    <p class="normal">In the next chapter, you will learn how to build and consume services that use HTTP as the communication layer, aka web services. You will also learn how to build Blazor components that execute on the client side, using WebAssembly.</p>
  </div>
</div></div></body></html>