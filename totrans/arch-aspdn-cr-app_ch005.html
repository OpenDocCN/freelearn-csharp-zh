<html xml:lang="en-US" xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops">
<head>
<meta charset="utf-8"/>
<meta content="packt" name="generator"/>
<title>4 REST APIs</title>
<link href="../styles/stylesheet1.css" rel="stylesheet" type="text/css"/>
<link href="../styles/stylesheet2.css" rel="stylesheet" type="text/css"/>
<!-- kobo-style -->
<style id="koboSpanStyle" type="text/css" xmlns="http://www.w3.org/1999/xhtml">.koboSpan { -webkit-text-combine: inherit; }</style>
</head>
<body>
<section class="level1 pkt" data-number="5" id="rest-apis">
<h1 data-number="5"><span class="koboSpan" id="kobo.1.1" xmlns="http://www.w3.org/1999/xhtml">4 REST APIs</span></h1>
<section class="level2" data-number="5.1" id="before-you-begin-join-our-book-community-on-discord-3">
<h2 data-number="5.1"><span class="koboSpan" id="kobo.2.1" xmlns="http://www.w3.org/1999/xhtml">Before you begin: Join our book community on Discord</span></h2>
<p><span class="koboSpan" id="kobo.3.1" xmlns="http://www.w3.org/1999/xhtml">Give your feedback straight to the author himself and chat to other early readers on our Discord server (find the "architecting-aspnet-core-apps-3e" channel under EARLY ACCESS SUBSCRIPTION).</span></p>
<p><a href="https://packt.link/EarlyAccess"><span class="koboSpan" id="kobo.4.1" xmlns="http://www.w3.org/1999/xhtml">https://packt.link/EarlyAccess</span></a></p>
<p><span class="koboSpan" id="kobo.5.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Qr code Description automatically generated" src="../media/file19.png" style="width:10em"/></span></p>
<p><span class="koboSpan" id="kobo.6.1" xmlns="http://www.w3.org/1999/xhtml">This chapter delves into the heart of web application communication–REST APIs. </span><span class="koboSpan" id="kobo.6.2" xmlns="http://www.w3.org/1999/xhtml">In today's connected digital world, effective communication between different applications is paramount, and RESTful APIs play a pivotal role in facilitating this interaction.We start by exploring the basic fabric of the web: the HTTP protocol. </span><span class="koboSpan" id="kobo.6.3" xmlns="http://www.w3.org/1999/xhtml">We touch on the core HTTP methods such as GET, POST, PUT, and DELETE to see how they carry out CRUD (Create, Read, Update, Delete) operations in a RESTful context. </span><span class="koboSpan" id="kobo.6.4" xmlns="http://www.w3.org/1999/xhtml">We then turn our attention to HTTP status codes–the system's way of informing clients about the status of their requests–and HTTP headers.Since APIs evolve and managing these changes without disrupting existing clients is a significant challenge, we look at different strategies for API versioning and the trade-offs involved with each.Then we learn about the Data-Transfer Object (DTO) pattern. </span><span class="koboSpan" id="kobo.6.5" xmlns="http://www.w3.org/1999/xhtml">Packaging data into DTOs can provide many benefits, from reducing the number of calls to better encapsulation and improved performance when sending data over the network.Finally, we also explore the importance of defining clear and robust API contracts, which ensures API stability. </span><span class="koboSpan" id="kobo.6.6" xmlns="http://www.w3.org/1999/xhtml">We discuss techniques for designing and documenting these contracts, ensuring they serve as practical guides for API consumers.By the end of this chapter, you'll know how REST APIs work and will be ready to start building some using ASP.NET Core as we move further into our architectural journey in the next few chapters.In this chapter, we cover the following topics:</span></p>
<ul>
<li><span class="koboSpan" id="kobo.7.1" xmlns="http://www.w3.org/1999/xhtml">REST &amp; HTTP</span></li>
<li><span class="koboSpan" id="kobo.8.1" xmlns="http://www.w3.org/1999/xhtml">Data Transfer Object (DTO)</span></li>
<li><span class="koboSpan" id="kobo.9.1" xmlns="http://www.w3.org/1999/xhtml">API contracts</span></li>
</ul>
<p><span class="koboSpan" id="kobo.10.1" xmlns="http://www.w3.org/1999/xhtml">Let’s begin with REST.</span></p>
</section>
<section class="level2" data-number="5.2" id="rest-http">
<h2 data-number="5.2"><span class="koboSpan" id="kobo.11.1" xmlns="http://www.w3.org/1999/xhtml">REST &amp; HTTP</span></h2>
<p><strong><span class="koboSpan" id="kobo.12.1" xmlns="http://www.w3.org/1999/xhtml">REST</span></strong><span class="koboSpan" id="kobo.13.1" xmlns="http://www.w3.org/1999/xhtml">, or </span><strong><span class="koboSpan" id="kobo.14.1" xmlns="http://www.w3.org/1999/xhtml">Representational State Transfer</span></strong><span class="koboSpan" id="kobo.15.1" xmlns="http://www.w3.org/1999/xhtml">, is a way to create internet-based services, known as web services, web APIs, REST APIs, or RESTful APIs. </span><span class="koboSpan" id="kobo.15.2" xmlns="http://www.w3.org/1999/xhtml">Those services commonly use HTTP as their transport protocol. </span><span class="koboSpan" id="kobo.15.3" xmlns="http://www.w3.org/1999/xhtml">REST reuses well-known HTTP specifications instead of recreating new ways of exchanging data. </span><span class="koboSpan" id="kobo.15.4" xmlns="http://www.w3.org/1999/xhtml">For example, returning an HTTP status code </span><code><span class="koboSpan" id="kobo.16.1" xmlns="http://www.w3.org/1999/xhtml">200 OK</span></code><span class="koboSpan" id="kobo.17.1" xmlns="http://www.w3.org/1999/xhtml"> indicates success, while </span><code><span class="koboSpan" id="kobo.18.1" xmlns="http://www.w3.org/1999/xhtml">400 Bad Request</span></code><span class="koboSpan" id="kobo.19.1" xmlns="http://www.w3.org/1999/xhtml"> indicates failure.Here are some defining characteristics:</span></p>
<ul>
<li><strong><span class="koboSpan" id="kobo.20.1" xmlns="http://www.w3.org/1999/xhtml">Statelessness:</span></strong><span class="koboSpan" id="kobo.21.1" xmlns="http://www.w3.org/1999/xhtml"> In a RESTful system, every client-to-server request should contain all the details necessary for the server to comprehend and execute it. </span><span class="koboSpan" id="kobo.21.2" xmlns="http://www.w3.org/1999/xhtml">The server retains no information about the client's most recent HTTP request. </span><span class="koboSpan" id="kobo.21.3" xmlns="http://www.w3.org/1999/xhtml">This enhances both reliability and scalability.</span></li>
<li><strong><span class="koboSpan" id="kobo.22.1" xmlns="http://www.w3.org/1999/xhtml">Caching capabilities:</span></strong><span class="koboSpan" id="kobo.23.1" xmlns="http://www.w3.org/1999/xhtml"> Clients should be able to cache responses to enhance performance.</span></li>
<li><strong><span class="koboSpan" id="kobo.24.1" xmlns="http://www.w3.org/1999/xhtml">Simplicity and lose coupling:</span></strong><span class="koboSpan" id="kobo.25.1" xmlns="http://www.w3.org/1999/xhtml"> REST uses HTTP to ensure a simplified, decoupled architecture. </span><span class="koboSpan" id="kobo.25.2" xmlns="http://www.w3.org/1999/xhtml">This makes the development, maintenance, and scaling of REST APIs easier and facilitates their usage.</span></li>
<li><strong><span class="koboSpan" id="kobo.26.1" xmlns="http://www.w3.org/1999/xhtml">Resource identifiability:</span></strong><span class="koboSpan" id="kobo.27.1" xmlns="http://www.w3.org/1999/xhtml"> Each REST API endpoint is a distinct resource, enabling us to secure each piece of the system separately.</span></li>
<li><strong><span class="koboSpan" id="kobo.28.1" xmlns="http://www.w3.org/1999/xhtml">Interface as a contract:</span></strong><span class="koboSpan" id="kobo.29.1" xmlns="http://www.w3.org/1999/xhtml"> The REST API layer serves as an exchange contract or an abstraction. </span><span class="koboSpan" id="kobo.29.2" xmlns="http://www.w3.org/1999/xhtml">It effectively conceals the backend system's underlying implementation, fostering streamlined interactions.</span></li>
</ul>
<p><span class="koboSpan" id="kobo.30.1" xmlns="http://www.w3.org/1999/xhtml">While we could delve much deeper into the intricacies of REST APIs, the preceding characteristics serve as foundational knowledge, providing good enough knowledge to get started with RESTful services. </span><span class="koboSpan" id="kobo.30.2" xmlns="http://www.w3.org/1999/xhtml">Having navigated through these essentials, let's shift our focus toward understanding how REST APIs harness the power of HTTP.</span></p>
<section class="level3" data-number="5.2.1" id="http-methods">
<h3 data-number="5.2.1"><span class="koboSpan" id="kobo.31.1" xmlns="http://www.w3.org/1999/xhtml">HTTP methods</span></h3>
<p><span class="koboSpan" id="kobo.32.1" xmlns="http://www.w3.org/1999/xhtml">HTTP methods, also known as verbs, define the type of action a client can perform on a resource in a RESTful API. </span><span class="koboSpan" id="kobo.32.2" xmlns="http://www.w3.org/1999/xhtml">Each method represents a specific operation that defines the endpoint's intent on a resource. </span><span class="koboSpan" id="kobo.32.3" xmlns="http://www.w3.org/1999/xhtml">Here is a list of the most frequently used methods, what they are for, and their expected success status code:</span></p>
<table>
<tbody>
<tr class="odd">
<td><strong><span class="koboSpan" id="kobo.33.1" xmlns="http://www.w3.org/1999/xhtml">Method</span></strong></td>
<td><strong><span class="koboSpan" id="kobo.34.1" xmlns="http://www.w3.org/1999/xhtml">Typical role</span></strong></td>
<td><strong><span class="koboSpan" id="kobo.35.1" xmlns="http://www.w3.org/1999/xhtml">Success status code</span></strong></td>
</tr>
<tr class="even">
<td><code><span class="koboSpan" id="kobo.36.1" xmlns="http://www.w3.org/1999/xhtml">GET</span></code></td>
<td><span class="koboSpan" id="kobo.37.1" xmlns="http://www.w3.org/1999/xhtml">Retrieve a resource (read data).</span></td>
<td><span class="koboSpan" id="kobo.38.1" xmlns="http://www.w3.org/1999/xhtml">200 OK</span></td>
</tr>
<tr class="odd">
<td><code><span class="koboSpan" id="kobo.39.1" xmlns="http://www.w3.org/1999/xhtml">POST</span></code></td>
<td><span class="koboSpan" id="kobo.40.1" xmlns="http://www.w3.org/1999/xhtml">Create a new resource.</span></td>
<td><span class="koboSpan" id="kobo.41.1" xmlns="http://www.w3.org/1999/xhtml">201 CREATED</span></td>
</tr>
<tr class="even">
<td><code><span class="koboSpan" id="kobo.42.1" xmlns="http://www.w3.org/1999/xhtml">PUT</span></code></td>
<td><span class="koboSpan" id="kobo.43.1" xmlns="http://www.w3.org/1999/xhtml">Replace a resource.</span></td>
<td><span class="koboSpan" id="kobo.44.1" xmlns="http://www.w3.org/1999/xhtml">200 OK or 204 No Content</span></td>
</tr>
<tr class="odd">
<td><code><span class="koboSpan" id="kobo.45.1" xmlns="http://www.w3.org/1999/xhtml">DELETE</span></code></td>
<td><span class="koboSpan" id="kobo.46.1" xmlns="http://www.w3.org/1999/xhtml">Delete a resource.</span></td>
<td><span class="koboSpan" id="kobo.47.1" xmlns="http://www.w3.org/1999/xhtml">200 OK or 204 No Content</span></td>
</tr>
<tr class="even">
<td><code><span class="koboSpan" id="kobo.48.1" xmlns="http://www.w3.org/1999/xhtml">PATCH</span></code></td>
<td><span class="koboSpan" id="kobo.49.1" xmlns="http://www.w3.org/1999/xhtml">Partially update a resource.</span></td>
<td><span class="koboSpan" id="kobo.50.1" xmlns="http://www.w3.org/1999/xhtml">200 OK</span></td>
</tr>
</tbody>
</table>
<p><span class="koboSpan" id="kobo.51.1" xmlns="http://www.w3.org/1999/xhtml">Next, we explore the commonly used status codes.</span></p>
</section>
<section class="level3" data-number="5.2.2" id="http-status-code">
<h3 data-number="5.2.2"><span class="koboSpan" id="kobo.52.1" xmlns="http://www.w3.org/1999/xhtml">HTTP Status code</span></h3>
<p><span class="koboSpan" id="kobo.53.1" xmlns="http://www.w3.org/1999/xhtml">HTTP status codes are part of the HTTP response and provide the client with information about the success or failure of their request; the status of the request.Status codes touching similar subjects are grouped under the same broad “hundredth” categories:</span></p>
<ul>
<li><code><span class="koboSpan" id="kobo.54.1" xmlns="http://www.w3.org/1999/xhtml">1XX</span></code><span class="koboSpan" id="kobo.55.1" xmlns="http://www.w3.org/1999/xhtml"> (informational) codes indicate that the request was received and the process is continuing, such as </span><strong><span class="koboSpan" id="kobo.56.1" xmlns="http://www.w3.org/1999/xhtml">100 Continue</span></strong><span class="koboSpan" id="kobo.57.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><strong><span class="koboSpan" id="kobo.58.1" xmlns="http://www.w3.org/1999/xhtml">101 Switching Protocols</span></strong><span class="koboSpan" id="kobo.59.1" xmlns="http://www.w3.org/1999/xhtml">.</span></li>
<li><code><span class="koboSpan" id="kobo.60.1" xmlns="http://www.w3.org/1999/xhtml">2XX</span></code><span class="koboSpan" id="kobo.61.1" xmlns="http://www.w3.org/1999/xhtml"> (successful) codes indicate that the request was received successfully.</span></li>
<li><code><span class="koboSpan" id="kobo.62.1" xmlns="http://www.w3.org/1999/xhtml">3XX</span></code><span class="koboSpan" id="kobo.63.1" xmlns="http://www.w3.org/1999/xhtml"> (redirection) codes indicate that the client must take further action to complete the redirection request.</span></li>
<li><code><span class="koboSpan" id="kobo.64.1" xmlns="http://www.w3.org/1999/xhtml">4XX</span></code><span class="koboSpan" id="kobo.65.1" xmlns="http://www.w3.org/1999/xhtml"> (client error) codes indicate an error on the client's part, such as validation errors. </span><span class="koboSpan" id="kobo.65.2" xmlns="http://www.w3.org/1999/xhtml">The client sent an empty required field, for example.</span></li>
<li><code><span class="koboSpan" id="kobo.66.1" xmlns="http://www.w3.org/1999/xhtml">5XX</span></code><span class="koboSpan" id="kobo.67.1" xmlns="http://www.w3.org/1999/xhtml"> (server error) codes indicate that the server failed to fulfill an apparently valid request and that the client cannot do anything about it (retrying the request is not an option).</span></li>
</ul>
<p><span class="koboSpan" id="kobo.68.1" xmlns="http://www.w3.org/1999/xhtml">The following table explains some of the most common ones:</span></p>
<table>
<colgroup>
<col style="width: 50%"/>
<col style="width: 50%"/>
</colgroup>
<tbody>
<tr class="odd">
<td><strong><span class="koboSpan" id="kobo.69.1" xmlns="http://www.w3.org/1999/xhtml">Status code</span></strong></td>
<td><strong><span class="koboSpan" id="kobo.70.1" xmlns="http://www.w3.org/1999/xhtml">Role</span></strong></td>
</tr>
<tr class="even">
<td><strong><span class="koboSpan" id="kobo.71.1" xmlns="http://www.w3.org/1999/xhtml">200 OK</span></strong></td>
<td><span class="koboSpan" id="kobo.72.1" xmlns="http://www.w3.org/1999/xhtml">Indicates the request has succeeded. </span><span class="koboSpan" id="kobo.72.2" xmlns="http://www.w3.org/1999/xhtml">It usually includes data related to the resource in the response body.</span></td>
</tr>
<tr class="odd">
<td><strong><span class="koboSpan" id="kobo.73.1" xmlns="http://www.w3.org/1999/xhtml">201 CREATED</span></strong></td>
<td><span class="koboSpan" id="kobo.74.1" xmlns="http://www.w3.org/1999/xhtml">Indicates the has succeeded and the system created a resource. </span><span class="koboSpan" id="kobo.74.2" xmlns="http://www.w3.org/1999/xhtml">It should also include a </span><code><span class="koboSpan" id="kobo.75.1" xmlns="http://www.w3.org/1999/xhtml">Location</span></code><span class="koboSpan" id="kobo.76.1" xmlns="http://www.w3.org/1999/xhtml"> HTTP header pointing to the newly created resource and can include the new entity in the response body.</span></td>
</tr>
<tr class="even">
<td><strong><span class="koboSpan" id="kobo.77.1" xmlns="http://www.w3.org/1999/xhtml">202 ACCEPTED</span></strong></td>
<td><p><span class="koboSpan" id="kobo.78.1" xmlns="http://www.w3.org/1999/xhtml">Indicates the request has been accepted for processing but is not processed yet. </span><span class="koboSpan" id="kobo.78.2" xmlns="http://www.w3.org/1999/xhtml">We use this code for asynchronous operations.</span></p>
<p><span class="koboSpan" id="kobo.79.1" xmlns="http://www.w3.org/1999/xhtml">In an event-driven system (see </span><em><span class="koboSpan" id="kobo.80.1" xmlns="http://www.w3.org/1999/xhtml">Chapter 17</span></em><span class="koboSpan" id="kobo.81.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.82.1" xmlns="http://www.w3.org/1999/xhtml">Introduction to Microservices Architecture</span></em><span class="koboSpan" id="kobo.83.1" xmlns="http://www.w3.org/1999/xhtml">), this could mean that an event has been published, the current resource has completed its job (published the event), but to know more, the client needs to contact another resource, wait for a notification, just wait, or can’t know.</span></p></td>
</tr>
<tr class="odd">
<td><strong><span class="koboSpan" id="kobo.84.1" xmlns="http://www.w3.org/1999/xhtml">204 NO CONTENT</span></strong></td>
<td><span class="koboSpan" id="kobo.85.1" xmlns="http://www.w3.org/1999/xhtml">Indicates the request has succeeded with no content in the response body.</span></td>
</tr>
<tr class="even">
<td><strong><span class="koboSpan" id="kobo.86.1" xmlns="http://www.w3.org/1999/xhtml">302 FOUND</span></strong></td>
<td><span class="koboSpan" id="kobo.87.1" xmlns="http://www.w3.org/1999/xhtml">Indicates that the requested resource resides temporarily under a different URL specified in the </span><code><span class="koboSpan" id="kobo.88.1" xmlns="http://www.w3.org/1999/xhtml">Location</span></code><span class="koboSpan" id="kobo.89.1" xmlns="http://www.w3.org/1999/xhtml"> header. </span><span class="koboSpan" id="kobo.89.2" xmlns="http://www.w3.org/1999/xhtml">We commonly use this status code for redirection.</span></td>
</tr>
<tr class="odd">
<td><strong><span class="koboSpan" id="kobo.90.1" xmlns="http://www.w3.org/1999/xhtml">400 BAD REQUEST</span></strong></td>
<td><span class="koboSpan" id="kobo.91.1" xmlns="http://www.w3.org/1999/xhtml">Indicates that the server could not understand or process the request. </span><span class="koboSpan" id="kobo.91.2" xmlns="http://www.w3.org/1999/xhtml">This usually relates to a validation error like a bad input or a missing field.</span></td>
</tr>
<tr class="even">
<td><strong><span class="koboSpan" id="kobo.92.1" xmlns="http://www.w3.org/1999/xhtml">401 UNAUTHORIZED</span></strong></td>
<td><span class="koboSpan" id="kobo.93.1" xmlns="http://www.w3.org/1999/xhtml">Indicates that the request requires user authentication to access the resource.</span></td>
</tr>
<tr class="odd">
<td><strong><span class="koboSpan" id="kobo.94.1" xmlns="http://www.w3.org/1999/xhtml">403 FORBIDDEN</span></strong></td>
<td><span class="koboSpan" id="kobo.95.1" xmlns="http://www.w3.org/1999/xhtml">Indicates that the server understood the request but refused to authorize it. </span><span class="koboSpan" id="kobo.95.2" xmlns="http://www.w3.org/1999/xhtml">This usually means the client lacks the access rights for the resource (authorization).</span></td>
</tr>
<tr class="even">
<td><strong><span class="koboSpan" id="kobo.96.1" xmlns="http://www.w3.org/1999/xhtml">404 NOT FOUND</span></strong></td>
<td><span class="koboSpan" id="kobo.97.1" xmlns="http://www.w3.org/1999/xhtml">Indicates the resource does not exist or was not found. </span><span class="koboSpan" id="kobo.97.2" xmlns="http://www.w3.org/1999/xhtml">REST APIs often return this from valid endpoints.</span></td>
</tr>
<tr class="odd">
<td><strong><span class="koboSpan" id="kobo.98.1" xmlns="http://www.w3.org/1999/xhtml">409 CONFLICT</span></strong></td>
<td><span class="koboSpan" id="kobo.99.1" xmlns="http://www.w3.org/1999/xhtml">Indicates that the server cannot complete the request due to a conflict with the current state of the resource. </span><span class="koboSpan" id="kobo.99.2" xmlns="http://www.w3.org/1999/xhtml">A typical scenario would be that the entity has changed between its read operation ( </span><code><span class="koboSpan" id="kobo.100.1" xmlns="http://www.w3.org/1999/xhtml">GET</span></code><span class="koboSpan" id="kobo.101.1" xmlns="http://www.w3.org/1999/xhtml"> ) and the current update ( </span><code><span class="koboSpan" id="kobo.102.1" xmlns="http://www.w3.org/1999/xhtml">PUT</span></code><span class="koboSpan" id="kobo.103.1" xmlns="http://www.w3.org/1999/xhtml"> ) operation.</span></td>
</tr>
<tr class="even">
<td><strong><span class="koboSpan" id="kobo.104.1" xmlns="http://www.w3.org/1999/xhtml">500 INTERNAL SERVER ERROR</span></strong></td>
<td><span class="koboSpan" id="kobo.105.1" xmlns="http://www.w3.org/1999/xhtml">Indicates that an unhandled error occurred on the server side and prevented it from fulfilling the request.</span></td>
</tr>
</tbody>
</table>
<p><span class="koboSpan" id="kobo.106.1" xmlns="http://www.w3.org/1999/xhtml">Now that we covered the HTTP methods and status codes, we look at how to pass more metadata between the client and the server.</span></p>
</section>
<section class="level3" data-number="5.2.3" id="http-headers">
<h3 data-number="5.2.3"><span class="koboSpan" id="kobo.107.1" xmlns="http://www.w3.org/1999/xhtml">HTTP headers</span></h3>
<p><span class="koboSpan" id="kobo.108.1" xmlns="http://www.w3.org/1999/xhtml">REST APIs leverage HTTP headers to transmit clients’ information and describe their options and capabilities. </span><span class="koboSpan" id="kobo.108.2" xmlns="http://www.w3.org/1999/xhtml">Headers are part of both the request and the response.One well-known header is the </span><code><span class="koboSpan" id="kobo.109.1" xmlns="http://www.w3.org/1999/xhtml">Location</span></code><span class="koboSpan" id="kobo.110.1" xmlns="http://www.w3.org/1999/xhtml"> header, that we use for different purposes. </span><span class="koboSpan" id="kobo.110.2" xmlns="http://www.w3.org/1999/xhtml">For example:</span></p>
<ul>
<li><span class="koboSpan" id="kobo.111.1" xmlns="http://www.w3.org/1999/xhtml">After creating an entity (</span><code><span class="koboSpan" id="kobo.112.1" xmlns="http://www.w3.org/1999/xhtml">201 Created</span></code><span class="koboSpan" id="kobo.113.1" xmlns="http://www.w3.org/1999/xhtml">), the </span><code><span class="koboSpan" id="kobo.114.1" xmlns="http://www.w3.org/1999/xhtml">Location</span></code><span class="koboSpan" id="kobo.115.1" xmlns="http://www.w3.org/1999/xhtml"> header should point to the </span><code><span class="koboSpan" id="kobo.116.1" xmlns="http://www.w3.org/1999/xhtml">GET</span></code><span class="koboSpan" id="kobo.117.1" xmlns="http://www.w3.org/1999/xhtml"> endpoint where the client can access that new entity.</span></li>
<li><span class="koboSpan" id="kobo.118.1" xmlns="http://www.w3.org/1999/xhtml">After starting an asynchronous operation (</span><code><span class="koboSpan" id="kobo.119.1" xmlns="http://www.w3.org/1999/xhtml">202 Accepted</span></code><span class="koboSpan" id="kobo.120.1" xmlns="http://www.w3.org/1999/xhtml">), the </span><code><span class="koboSpan" id="kobo.121.1" xmlns="http://www.w3.org/1999/xhtml">Location</span></code><span class="koboSpan" id="kobo.122.1" xmlns="http://www.w3.org/1999/xhtml"> header could point to the status endpoint where you can poll for the state of the operation (has it completed, failed, or is it still ongoing).</span></li>
<li><span class="koboSpan" id="kobo.123.1" xmlns="http://www.w3.org/1999/xhtml">When a server wants to instruct a client to load another page (a redirection), the </span><code><span class="koboSpan" id="kobo.124.1" xmlns="http://www.w3.org/1999/xhtml">Location</span></code><span class="koboSpan" id="kobo.125.1" xmlns="http://www.w3.org/1999/xhtml"> header contains the destination URL. </span><span class="koboSpan" id="kobo.125.2" xmlns="http://www.w3.org/1999/xhtml">The following status codes are the most common for redirections: </span><code><span class="koboSpan" id="kobo.126.1" xmlns="http://www.w3.org/1999/xhtml">301 Moved Permanently</span></code><span class="koboSpan" id="kobo.127.1" xmlns="http://www.w3.org/1999/xhtml">, </span><code><span class="koboSpan" id="kobo.128.1" xmlns="http://www.w3.org/1999/xhtml">302 Found</span></code><span class="koboSpan" id="kobo.129.1" xmlns="http://www.w3.org/1999/xhtml">, </span><code><span class="koboSpan" id="kobo.130.1" xmlns="http://www.w3.org/1999/xhtml">303 See Other</span></code><span class="koboSpan" id="kobo.131.1" xmlns="http://www.w3.org/1999/xhtml">, </span><code><span class="koboSpan" id="kobo.132.1" xmlns="http://www.w3.org/1999/xhtml">307 Temporary Redirect</span></code><span class="koboSpan" id="kobo.133.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><code><span class="koboSpan" id="kobo.134.1" xmlns="http://www.w3.org/1999/xhtml">308 Permanent Redirect</span></code><span class="koboSpan" id="kobo.135.1" xmlns="http://www.w3.org/1999/xhtml">.</span></li>
</ul>
<p><span class="koboSpan" id="kobo.136.1" xmlns="http://www.w3.org/1999/xhtml">The </span><code><span class="koboSpan" id="kobo.137.1" xmlns="http://www.w3.org/1999/xhtml">Retry-After</span></code><span class="koboSpan" id="kobo.138.1" xmlns="http://www.w3.org/1999/xhtml"> header can also come in handy when mixed with </span><code><span class="koboSpan" id="kobo.139.1" xmlns="http://www.w3.org/1999/xhtml">202</span></code> <code><span class="koboSpan" id="kobo.140.1" xmlns="http://www.w3.org/1999/xhtml">Accepted</span></code><span class="koboSpan" id="kobo.141.1" xmlns="http://www.w3.org/1999/xhtml">, </span><code><span class="koboSpan" id="kobo.142.1" xmlns="http://www.w3.org/1999/xhtml">301 Moved Permanently</span></code><span class="koboSpan" id="kobo.143.1" xmlns="http://www.w3.org/1999/xhtml">, </span><code><span class="koboSpan" id="kobo.144.1" xmlns="http://www.w3.org/1999/xhtml">429 Too Many Requests</span></code><span class="koboSpan" id="kobo.145.1" xmlns="http://www.w3.org/1999/xhtml">, or </span><code><span class="koboSpan" id="kobo.146.1" xmlns="http://www.w3.org/1999/xhtml">503 Service Unavailable</span></code><span class="koboSpan" id="kobo.147.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.147.2" xmlns="http://www.w3.org/1999/xhtml">The </span><code><span class="koboSpan" id="kobo.148.1" xmlns="http://www.w3.org/1999/xhtml">ETag</span></code><span class="koboSpan" id="kobo.149.1" xmlns="http://www.w3.org/1999/xhtml"> header identifies the version of the entity and can be used in conjunction with </span><code><span class="koboSpan" id="kobo.150.1" xmlns="http://www.w3.org/1999/xhtml">If-Match</span></code><span class="koboSpan" id="kobo.151.1" xmlns="http://www.w3.org/1999/xhtml"> to avoid </span><em><span class="koboSpan" id="kobo.152.1" xmlns="http://www.w3.org/1999/xhtml">mid-air collisions</span></em><span class="koboSpan" id="kobo.153.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.153.2" xmlns="http://www.w3.org/1999/xhtml">The </span><code><span class="koboSpan" id="kobo.154.1" xmlns="http://www.w3.org/1999/xhtml">ETag</span></code><span class="koboSpan" id="kobo.155.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><code><span class="koboSpan" id="kobo.156.1" xmlns="http://www.w3.org/1999/xhtml">If-Match</span></code><span class="koboSpan" id="kobo.157.1" xmlns="http://www.w3.org/1999/xhtml"> headers form a sort of </span><em><span class="koboSpan" id="kobo.158.1" xmlns="http://www.w3.org/1999/xhtml">optimistic concurrency</span></em><span class="koboSpan" id="kobo.159.1" xmlns="http://www.w3.org/1999/xhtml"> method that prevents </span><em><span class="koboSpan" id="kobo.160.1" xmlns="http://www.w3.org/1999/xhtml">request two</span></em><span class="koboSpan" id="kobo.161.1" xmlns="http://www.w3.org/1999/xhtml"> from overwriting changes made by </span><em><span class="koboSpan" id="kobo.162.1" xmlns="http://www.w3.org/1999/xhtml">request one</span></em><span class="koboSpan" id="kobo.163.1" xmlns="http://www.w3.org/1999/xhtml"> when changes are happening simultaneously or not in the expected order; a.k.a. </span><span class="koboSpan" id="kobo.163.2" xmlns="http://www.w3.org/1999/xhtml">a way to manage conflicts. </span><span class="koboSpan" id="kobo.163.3" xmlns="http://www.w3.org/1999/xhtml">We can also add the following to the mix as an example of HTTP headers that describe a REST endpoint: </span><code><span class="koboSpan" id="kobo.164.1" xmlns="http://www.w3.org/1999/xhtml">Allow</span></code><span class="koboSpan" id="kobo.165.1" xmlns="http://www.w3.org/1999/xhtml">, </span><code><span class="koboSpan" id="kobo.166.1" xmlns="http://www.w3.org/1999/xhtml">Authorization</span></code><span class="koboSpan" id="kobo.167.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><code><span class="koboSpan" id="kobo.168.1" xmlns="http://www.w3.org/1999/xhtml">Cache-Control</span></code><span class="koboSpan" id="kobo.169.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.169.2" xmlns="http://www.w3.org/1999/xhtml">The list is very long, and it would help no one to enumerate all HTTP headers here.</span></p>
<blockquote>
<p><span class="koboSpan" id="kobo.170.1" xmlns="http://www.w3.org/1999/xhtml">This information should be enough theory to get you started with HTTP and REST. </span><span class="koboSpan" id="kobo.170.2" xmlns="http://www.w3.org/1999/xhtml">In case you want to know more, I left links to the MDN web docs about HTTP in the Further Reading section at the end of the chapter.</span></p>
</blockquote>
<p><span class="koboSpan" id="kobo.171.1" xmlns="http://www.w3.org/1999/xhtml">Next, we look at versioning because nothing stays the same forever; business needs change, and APIs must evolve with them.</span></p>
</section>
<section class="level3" data-number="5.2.4" id="versioning">
<h3 data-number="5.2.4"><span class="koboSpan" id="kobo.172.1" xmlns="http://www.w3.org/1999/xhtml">Versioning</span></h3>
<p><span class="koboSpan" id="kobo.173.1" xmlns="http://www.w3.org/1999/xhtml">Versioning is a crucial aspect of a REST API. </span><span class="koboSpan" id="kobo.173.2" xmlns="http://www.w3.org/1999/xhtml">Whether the version of the API is long-lived or transitory (during the decommissioning cycle of an old endpoint, for example), both ends of the pipe must know what to expect; what API contract to respect. </span><span class="koboSpan" id="kobo.173.3" xmlns="http://www.w3.org/1999/xhtml">Unless you are your only consumer, you’ll need a way for the API clients to query specific API versions when the contract changes.This section explores a few ways to think about our versioning strategy.</span></p>
<section class="level4" data-number="5.2.4.1" id="default-versioning-strategy">
<h4 data-number="5.2.4.1"><span class="koboSpan" id="kobo.174.1" xmlns="http://www.w3.org/1999/xhtml">Default versioning strategy</span></h4>
<p><span class="koboSpan" id="kobo.175.1" xmlns="http://www.w3.org/1999/xhtml">The default strategy is the first thing to consider when versioning an API. </span><span class="koboSpan" id="kobo.175.2" xmlns="http://www.w3.org/1999/xhtml">What happens when no version is specified? </span><span class="koboSpan" id="kobo.175.3" xmlns="http://www.w3.org/1999/xhtml">Will the endpoint return an error, the first or the latest version?If the API returns an error, you should implement that versioning strategy from day one so clients know a version is required. </span><span class="koboSpan" id="kobo.175.4" xmlns="http://www.w3.org/1999/xhtml">In this case, there is no real drawback. </span><span class="koboSpan" id="kobo.175.5" xmlns="http://www.w3.org/1999/xhtml">On the other hand, putting this strategy in place after the fact will break all clients that do not specify a version number, which might not be the best way to keep your consumers happy.The second way is always to return the first version. </span><span class="koboSpan" id="kobo.175.6" xmlns="http://www.w3.org/1999/xhtml">This method is an excellent way to preserve backward compatibility. </span><span class="koboSpan" id="kobo.175.7" xmlns="http://www.w3.org/1999/xhtml">You can add more endpoint versions without breaking your consumers.The opposite way is always to return the latest version. </span><span class="koboSpan" id="kobo.175.8" xmlns="http://www.w3.org/1999/xhtml">For consumers, this means specifying a version to consume or be up to date or break, and this might not be the best user experience to provide to your consumers. </span><span class="koboSpan" id="kobo.175.9" xmlns="http://www.w3.org/1999/xhtml">Nonetheless, many have opted for this default strategy.Another way to go is to pick any version as the default baseline for the API (like version 3.2, for example) or even choose a different version per endpoint. </span><span class="koboSpan" id="kobo.175.10" xmlns="http://www.w3.org/1999/xhtml">Say you default to 3.2, then deploy 4.0. </span><span class="koboSpan" id="kobo.175.11" xmlns="http://www.w3.org/1999/xhtml">Since the clients must opt-in to access the new API, they won’t break automatically and will have the time to update from 3.2 to 4.0 following their own roadmap. </span><span class="koboSpan" id="kobo.175.12" xmlns="http://www.w3.org/1999/xhtml">This is a good strategy to default to a well-known and stable API version before moving forward with breaking changes.</span></p>
<blockquote>
<p><span class="koboSpan" id="kobo.176.1" xmlns="http://www.w3.org/1999/xhtml">No matter what you choose, always think it through by weighing the pros and cons.</span></p>
</blockquote>
<p><span class="koboSpan" id="kobo.177.1" xmlns="http://www.w3.org/1999/xhtml">Next, we explore ways to define those versions.</span></p>
</section>
<section class="level4" data-number="5.2.4.2" id="versioning-strategy">
<h4 data-number="5.2.4.2"><span class="koboSpan" id="kobo.178.1" xmlns="http://www.w3.org/1999/xhtml">Versioning strategy</span></h4>
<p><span class="koboSpan" id="kobo.179.1" xmlns="http://www.w3.org/1999/xhtml">Of course, there are multiple ways to think this through. </span><span class="koboSpan" id="kobo.179.2" xmlns="http://www.w3.org/1999/xhtml">You can leverage URL patterns to define and include the API version, like </span><code><span class="koboSpan" id="kobo.180.1" xmlns="http://www.w3.org/1999/xhtml">https://localhost/v2/some-entities</span></code><span class="koboSpan" id="kobo.181.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.181.2" xmlns="http://www.w3.org/1999/xhtml">This strategy is easier to query from a browser, making it simple to know the version at a glance, but the endpoint is not pointing to a unique resource anymore (a key principle of REST), as each resource has one endpoint for each version. </span><span class="koboSpan" id="kobo.181.3" xmlns="http://www.w3.org/1999/xhtml">Nonetheless, this way of versioning an API is used extensively and is one of the most popular, if not </span><em><span class="koboSpan" id="kobo.182.1" xmlns="http://www.w3.org/1999/xhtml">the</span></em><span class="koboSpan" id="kobo.183.1" xmlns="http://www.w3.org/1999/xhtml"> most popular way of doing REST versioning, even if it violates one of its core principles (debatably).The other way is to use HTTP headers. </span><span class="koboSpan" id="kobo.183.2" xmlns="http://www.w3.org/1999/xhtml">You can use a custom header like </span><code><span class="koboSpan" id="kobo.184.1" xmlns="http://www.w3.org/1999/xhtml">api-version</span></code><span class="koboSpan" id="kobo.185.1" xmlns="http://www.w3.org/1999/xhtml"> or </span><code><span class="koboSpan" id="kobo.186.1" xmlns="http://www.w3.org/1999/xhtml">Accept-version</span></code><span class="koboSpan" id="kobo.187.1" xmlns="http://www.w3.org/1999/xhtml">, for example, or the standard </span><code><span class="koboSpan" id="kobo.188.1" xmlns="http://www.w3.org/1999/xhtml">Accept</span></code><span class="koboSpan" id="kobo.189.1" xmlns="http://www.w3.org/1999/xhtml"> header. </span><span class="koboSpan" id="kobo.189.2" xmlns="http://www.w3.org/1999/xhtml">This way allows resources to have unique endpoints (URI) while enabling multiple versions of each entity (multiple versions of each API contract describing the same entity).For example, a client could specify an HTTP header while calling the endpoint like this (custom header):</span></p>
<div class="C0-CodePACKT">
<pre><code><span class="koboSpan" id="kobo.190.1" xmlns="http://www.w3.org/1999/xhtml">GET https://localhost/some-entities
Accept-version: v2</span></code></pre>
</div>
<p><span class="koboSpan" id="kobo.191.1" xmlns="http://www.w3.org/1999/xhtml">Or like the following, by leveraging the </span><code><span class="koboSpan" id="kobo.192.1" xmlns="http://www.w3.org/1999/xhtml">Accept</span></code><span class="koboSpan" id="kobo.193.1" xmlns="http://www.w3.org/1999/xhtml"> header for </span><em><span class="koboSpan" id="kobo.194.1" xmlns="http://www.w3.org/1999/xhtml">content negotiation</span></em><span class="koboSpan" id="kobo.195.1" xmlns="http://www.w3.org/1999/xhtml">:</span></p>
<div class="C0-CodePACKT">
<pre><code><span class="koboSpan" id="kobo.196.1" xmlns="http://www.w3.org/1999/xhtml">GET https://localhost/some-entities
Accept: application/vnd.api.v2+json</span></code></pre>
</div>
<blockquote>
<p><span class="koboSpan" id="kobo.197.1" xmlns="http://www.w3.org/1999/xhtml">Different people are using different values for the </span><code><span class="koboSpan" id="kobo.198.1" xmlns="http://www.w3.org/1999/xhtml">Accept</span></code><span class="koboSpan" id="kobo.199.1" xmlns="http://www.w3.org/1999/xhtml"> headers, for example:</span></p>
</blockquote>
<ul>
<li><code><span class="koboSpan" id="kobo.200.1" xmlns="http://www.w3.org/1999/xhtml">application/vnd.myapplication.v2+json</span></code></li>
<li><code><span class="koboSpan" id="kobo.201.1" xmlns="http://www.w3.org/1999/xhtml">application/vnd.myapplication.entity.v2+json</span></code></li>
<li><code><span class="koboSpan" id="kobo.202.1" xmlns="http://www.w3.org/1999/xhtml">application/vnd.myapplication.api+json; version=2</span></code></li>
<li><code><span class="koboSpan" id="kobo.203.1" xmlns="http://www.w3.org/1999/xhtml">application/json; version=2</span></code></li>
</ul>
<p><span class="koboSpan" id="kobo.204.1" xmlns="http://www.w3.org/1999/xhtml">Whether you are using one way or another, you’ll most likely need to version your APIs at some point. </span><span class="koboSpan" id="kobo.204.2" xmlns="http://www.w3.org/1999/xhtml">Some people are strong advocates of one way or the other, but ultimately, you should decide on a case-by-case basis what best covers your needs and capacities: simplicity, formality, or a mix of both.</span></p>
</section>
</section>
<section class="level3" data-number="5.2.5" id="wrapping-up">
<h3 data-number="5.2.5"><span class="koboSpan" id="kobo.205.1" xmlns="http://www.w3.org/1999/xhtml">Wrapping up</span></h3>
<p><span class="koboSpan" id="kobo.206.1" xmlns="http://www.w3.org/1999/xhtml">With a method (verb), the client (and the endpoint) can express the intent to create, update, read, or delete an entity. </span><span class="koboSpan" id="kobo.206.2" xmlns="http://www.w3.org/1999/xhtml">With a status code, the endpoint can tell the client the state of the operation. </span><span class="koboSpan" id="kobo.206.3" xmlns="http://www.w3.org/1999/xhtml">Adding HTTP headers, clients, and servers can add more metadata to the request or response. </span><span class="koboSpan" id="kobo.206.4" xmlns="http://www.w3.org/1999/xhtml">Finally, by adding versioning, the REST API can evolve without breaking existing clients while giving them options to consume specific versions.With what we just covered, you should have more than what’s needed to follow along with the examples in this book and build a few REST APIs along the way. </span><span class="koboSpan" id="kobo.206.5" xmlns="http://www.w3.org/1999/xhtml">Next, we explore how those HTTP pieces create API contracts.</span></p>
</section>
</section>
<section class="level2" data-number="5.3" id="data-transfer-object-dto">
<h2 data-number="5.3"><span class="koboSpan" id="kobo.207.1" xmlns="http://www.w3.org/1999/xhtml">Data Transfer Object (DTO)</span></h2>
<p><span class="koboSpan" id="kobo.208.1" xmlns="http://www.w3.org/1999/xhtml">The Data Transfer Object (DTO) design pattern is a robust approach to managing and transferring data in a service-oriented architecture like REST APIs. </span><span class="koboSpan" id="kobo.208.2" xmlns="http://www.w3.org/1999/xhtml">The DTO pattern is about organizing the data to deliver it to API clients optimally. </span><span class="koboSpan" id="kobo.208.3" xmlns="http://www.w3.org/1999/xhtml">DTOs are an integral part of the API contract, that we explore next.</span></p>
<section class="level3" data-number="5.3.1" id="goal">
<h3 data-number="5.3.1"><span class="koboSpan" id="kobo.209.1" xmlns="http://www.w3.org/1999/xhtml">Goal</span></h3>
<p><span class="koboSpan" id="kobo.210.1" xmlns="http://www.w3.org/1999/xhtml">A DTO's objective is to </span><em><span class="koboSpan" id="kobo.211.1" xmlns="http://www.w3.org/1999/xhtml">control an endpoint's inputs and outputs</span></em><span class="koboSpan" id="kobo.212.1" xmlns="http://www.w3.org/1999/xhtml"> by loosely coupling the exposed API surface from the application’s inner workings. </span><span class="koboSpan" id="kobo.212.2" xmlns="http://www.w3.org/1999/xhtml">DTOs empower us to craft our web services the way we want the consumers to interact with them. </span><span class="koboSpan" id="kobo.212.3" xmlns="http://www.w3.org/1999/xhtml">So, no matter the underlying system, we can use DTOs to design endpoints that are easier to consume, maintain, and evolve.</span></p>
</section>
<section class="level3" data-number="5.3.2" id="design">
<h3 data-number="5.3.2"><span class="koboSpan" id="kobo.213.1" xmlns="http://www.w3.org/1999/xhtml">Design</span></h3>
<p><span class="koboSpan" id="kobo.214.1" xmlns="http://www.w3.org/1999/xhtml">Each DTO represents an entity with all the necessary properties. </span><span class="koboSpan" id="kobo.214.2" xmlns="http://www.w3.org/1999/xhtml">That entity is either an input or an output and allows crafting the interaction between the clients and the API.DTOs serve to loosely couple our domain from the data exposed over the API by adding a level of abstraction. </span><span class="koboSpan" id="kobo.214.3" xmlns="http://www.w3.org/1999/xhtml">This allows us to change the underlying domain model without affecting the data exposed to the API consumers and vice versa.Another way to use a DTO is by packaging related pieces of information together, allowing a client to make a single call to fetch all necessary data, thereby eliminating the need for multiple requests.Based on REST and HTTP, the flow of a request goes like the following: an HTTP request comes in, some code is executed (domain logic), and an HTTP response goes back to the client. </span><span class="koboSpan" id="kobo.214.4" xmlns="http://www.w3.org/1999/xhtml">The following diagram represents this flow:</span></p>
<figure>
<span class="koboSpan" id="kobo.215.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Figure 4.1: An HTTP request getting in and out of a REST API endpoint." src="../media/file20.png"/></span><figcaption aria-hidden="true"><span class="koboSpan" id="kobo.216.1" xmlns="http://www.w3.org/1999/xhtml">Figure 4.1: An HTTP request getting in and out of a REST API endpoint.</span></figcaption>
</figure>
<p><span class="koboSpan" id="kobo.217.1" xmlns="http://www.w3.org/1999/xhtml">Now, if we take that flow and change HTTP with DTO, we can see that a DTO can be part of the data contract as an input or an output:</span></p>
<figure>
<span class="koboSpan" id="kobo.218.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Figure 4.2: An input DTO hitting some domain logic, then the endpoint returning an output DTO" src="../media/file21.png"/></span><figcaption aria-hidden="true"><span class="koboSpan" id="kobo.219.1" xmlns="http://www.w3.org/1999/xhtml">Figure 4.2: An input DTO hitting some domain logic, then the endpoint returning an output DTO</span></figcaption>
</figure>
<p><span class="koboSpan" id="kobo.220.1" xmlns="http://www.w3.org/1999/xhtml">How can the HTTP request become an object? </span><span class="koboSpan" id="kobo.220.2" xmlns="http://www.w3.org/1999/xhtml">Most of the time:</span></p>
<ul>
<li><span class="koboSpan" id="kobo.221.1" xmlns="http://www.w3.org/1999/xhtml">We use deserialization or data binding for inputs.</span></li>
<li><span class="koboSpan" id="kobo.222.1" xmlns="http://www.w3.org/1999/xhtml">We use serialization for outputs.</span></li>
</ul>
<p><span class="koboSpan" id="kobo.223.1" xmlns="http://www.w3.org/1999/xhtml">Let’s look at a few examples.</span></p>
</section>
<section class="level3" data-number="5.3.3" id="conceptual-examples">
<h3 data-number="5.3.3"><span class="koboSpan" id="kobo.224.1" xmlns="http://www.w3.org/1999/xhtml">Conceptual examples</span></h3>
<p><span class="koboSpan" id="kobo.225.1" xmlns="http://www.w3.org/1999/xhtml">Conceptually, say that we are building a web application allowing people to register for events. </span><span class="koboSpan" id="kobo.225.2" xmlns="http://www.w3.org/1999/xhtml">We explore two use cases next.</span></p>
<section class="level4" data-number="5.3.3.1" id="registering-for-an-activity">
<h4 data-number="5.3.3.1"><span class="koboSpan" id="kobo.226.1" xmlns="http://www.w3.org/1999/xhtml">Registering for an activity</span></h4>
<p><span class="koboSpan" id="kobo.227.1" xmlns="http://www.w3.org/1999/xhtml">The first scenario we are exploring is a user registering for an activity. </span><span class="koboSpan" id="kobo.227.2" xmlns="http://www.w3.org/1999/xhtml">An activity is a sort of event in the system. </span><span class="koboSpan" id="kobo.227.3" xmlns="http://www.w3.org/1999/xhtml">We use an external payment gateway, so our application never handles financial data. </span><span class="koboSpan" id="kobo.227.4" xmlns="http://www.w3.org/1999/xhtml">Nevertheless, we must send transaction data to our backend to associate and complete the payment. </span><span class="koboSpan" id="kobo.227.5" xmlns="http://www.w3.org/1999/xhtml">The following diagram depicts the workflow:</span></p>
<figure>
<span class="koboSpan" id="kobo.228.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Figure 4.3: The DTOs implicated in an activity registration flow." src="../media/file22.png"/></span><figcaption aria-hidden="true"><span class="koboSpan" id="kobo.229.1" xmlns="http://www.w3.org/1999/xhtml">Figure 4.3: The DTOs implicated in an activity registration flow.</span></figcaption>
</figure>
<p><span class="koboSpan" id="kobo.230.1" xmlns="http://www.w3.org/1999/xhtml">The body of the request could look like the following JSON snippet:</span></p>
<div class="C0-CodePACKT">
<pre><code><span class="koboSpan" id="kobo.231.1" xmlns="http://www.w3.org/1999/xhtml">{
    "registrant": {
        "firstname": "John",
        "lastname": "Doe"
    },
    "activity": {
        "id": 123,
        "seats": 2
    },
    "payment": {
        "nonce": "abc123"
    }
}</span></code></pre>
</div>
<p><span class="koboSpan" id="kobo.232.1" xmlns="http://www.w3.org/1999/xhtml">Next, the following JSON snippet could represent the body of the response:</span></p>
<div class="C0-CodePACKT">
<pre><code><span class="koboSpan" id="kobo.233.1" xmlns="http://www.w3.org/1999/xhtml">{
    "status": "Success",
    "numberOfSeats": 2,
    "activityId": 123,
    "activityDate": "2023-06-03T20:00:00"
}</span></code></pre>
</div>
<p><span class="koboSpan" id="kobo.234.1" xmlns="http://www.w3.org/1999/xhtml">Of course, this is a very lightweight version of a registration system. </span><span class="koboSpan" id="kobo.234.2" xmlns="http://www.w3.org/1999/xhtml">The objective is to show that:</span></p>
<ol>
<li><span class="koboSpan" id="kobo.235.1" xmlns="http://www.w3.org/1999/xhtml">Three entities came in as an HTTP POST request (a registrant, an activity, and payment information).</span></li>
<li><span class="koboSpan" id="kobo.236.1" xmlns="http://www.w3.org/1999/xhtml">The system executed some business logic to register the person to the activity and to complete the financial transaction.</span></li>
<li><span class="koboSpan" id="kobo.237.1" xmlns="http://www.w3.org/1999/xhtml">The API returned mixed information to the client.</span></li>
</ol>
<blockquote>
<p><span class="koboSpan" id="kobo.238.1" xmlns="http://www.w3.org/1999/xhtml">This pattern is handy to input and output only what you need. </span><span class="koboSpan" id="kobo.238.2" xmlns="http://www.w3.org/1999/xhtml">If you are designing the user interface that consumes the API, outputting a well-thought DTO can ensure that the UI renders the next screen just by reading the response from the server, saving your UI to fetch more data, speeding up the process, and improving the user experience.</span></p>
</blockquote>
<p><span class="koboSpan" id="kobo.239.1" xmlns="http://www.w3.org/1999/xhtml">We explore fetching information about an activity registration next.</span></p>
</section>
<section class="level4" data-number="5.3.3.2" id="fetching-activity-registration-details">
<h4 data-number="5.3.3.2"><span class="koboSpan" id="kobo.240.1" xmlns="http://www.w3.org/1999/xhtml">Fetching activity registration details</span></h4>
<p><span class="koboSpan" id="kobo.241.1" xmlns="http://www.w3.org/1999/xhtml">In the same system, the user wants to review the details of an activity he registered using the preceding process. </span><span class="koboSpan" id="kobo.241.2" xmlns="http://www.w3.org/1999/xhtml">In this case, the flow goes like this:</span></p>
<ol>
<li><span class="koboSpan" id="kobo.242.1" xmlns="http://www.w3.org/1999/xhtml">The client sends the registration identifier over a </span><code><span class="koboSpan" id="kobo.243.1" xmlns="http://www.w3.org/1999/xhtml">GET</span></code><span class="koboSpan" id="kobo.244.1" xmlns="http://www.w3.org/1999/xhtml"> request.</span></li>
<li><span class="koboSpan" id="kobo.245.1" xmlns="http://www.w3.org/1999/xhtml">The system fetches the registrant information, the activity information, and the number of seats the user reserved for that activity.</span></li>
<li><span class="koboSpan" id="kobo.246.1" xmlns="http://www.w3.org/1999/xhtml">The server returns the data to the client.</span></li>
</ol>
<p><span class="koboSpan" id="kobo.247.1" xmlns="http://www.w3.org/1999/xhtml">The following diagram visually represents the use case:</span></p>
<figure>
<span class="koboSpan" id="kobo.248.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Figure 4.4: The DTOs implicated in fetching the info related to a registered activity." src="../media/file23.png"/></span><figcaption aria-hidden="true"><span class="koboSpan" id="kobo.249.1" xmlns="http://www.w3.org/1999/xhtml">Figure 4.4: The DTOs implicated in fetching the info related to a registered activity.</span></figcaption>
</figure>
<p><span class="koboSpan" id="kobo.250.1" xmlns="http://www.w3.org/1999/xhtml">In this case, the input would be part of the URL, like </span><code><span class="koboSpan" id="kobo.251.1" xmlns="http://www.w3.org/1999/xhtml">/registrations/123</span></code><span class="koboSpan" id="kobo.252.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.252.2" xmlns="http://www.w3.org/1999/xhtml">The output would be part of the response body, and could look like the following:</span></p>
<div class="C0-CodePACKT">
<pre><code><span class="koboSpan" id="kobo.253.1" xmlns="http://www.w3.org/1999/xhtml">{
    "registrant": {
        "firstname": "John",
        "lastname": "Doe"
    },
    "activity": {
        "id": 123,
        "name": "Super Cool Show",
        "date": "2023-06-03T20:00:00"
    },
    "numberOfSeats": 2
}</span></code></pre>
</div>
<p><span class="koboSpan" id="kobo.254.1" xmlns="http://www.w3.org/1999/xhtml">By creating that endpoint using a well-crafted output DTO, we condensed three HTTP requests into one: the registrant, the activity, and the registration (number of seats). </span><span class="koboSpan" id="kobo.254.2" xmlns="http://www.w3.org/1999/xhtml">This powerful technique applies to any technology, not just ASP.NET Core, and allows us to design APIs without connecting clients directly to our data (loose coupling).</span></p>
</section>
</section>
<section class="level3" data-number="5.3.4" id="conclusion-4">
<h3 data-number="5.3.4"><span class="koboSpan" id="kobo.255.1" xmlns="http://www.w3.org/1999/xhtml">Conclusion</span></h3>
<p><span class="koboSpan" id="kobo.256.1" xmlns="http://www.w3.org/1999/xhtml">A data transfer object (DTO) allows us to design an API endpoint with specialized input and output instead of exposing the domain or data model. </span><span class="koboSpan" id="kobo.256.2" xmlns="http://www.w3.org/1999/xhtml">Those DTOs shield our internal business logic, which improves our ability to design our APIs and also helps us make them more secure.</span></p>
<blockquote>
<p><span class="koboSpan" id="kobo.257.1" xmlns="http://www.w3.org/1999/xhtml">By defining DTOs, we can avoid a malicious actor trying to bind data that he should not have access to. </span><span class="koboSpan" id="kobo.257.2" xmlns="http://www.w3.org/1999/xhtml">For example, when using an input “Login DTO” that only contains a </span><code><span class="koboSpan" id="kobo.258.1" xmlns="http://www.w3.org/1999/xhtml">username</span></code><span class="koboSpan" id="kobo.259.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><code><span class="koboSpan" id="kobo.260.1" xmlns="http://www.w3.org/1999/xhtml">password</span></code><span class="koboSpan" id="kobo.261.1" xmlns="http://www.w3.org/1999/xhtml"> properties, a malicious user could not try to bind the </span><code><span class="koboSpan" id="kobo.262.1" xmlns="http://www.w3.org/1999/xhtml">IsAdmin</span></code><span class="koboSpan" id="kobo.263.1" xmlns="http://www.w3.org/1999/xhtml"> field available in our domain and database. </span><span class="koboSpan" id="kobo.263.2" xmlns="http://www.w3.org/1999/xhtml">There are other ways to mitigate this, but they are out of the scope of this chapter, yet, a DTO is a great candidate to mitigate this attack vector.</span></p>
</blockquote>
<p><span class="koboSpan" id="kobo.264.1" xmlns="http://www.w3.org/1999/xhtml">This separation between the presentation and the domain is a crucial element that leads to having multiple independent components instead of a bigger, more fragile one or leaking the internal data structure to the clients consuming the API.We explore building APIs in the next few chapters and explore some topics more in-depth in </span><em><span class="koboSpan" id="kobo.265.1" xmlns="http://www.w3.org/1999/xhtml">Section 4</span></em><span class="koboSpan" id="kobo.266.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.267.1" xmlns="http://www.w3.org/1999/xhtml">Designing at Application Scale</span></em><span class="koboSpan" id="kobo.268.1" xmlns="http://www.w3.org/1999/xhtml">.Using the DTO pattern helps us follow the SOLID principles in the following ways:</span></p>
<ul>
<li><strong><span class="koboSpan" id="kobo.269.1" xmlns="http://www.w3.org/1999/xhtml">S</span></strong><span class="koboSpan" id="kobo.270.1" xmlns="http://www.w3.org/1999/xhtml">: A DTO adds clear boundaries between the domain logic or the data and the API contract, dividing one model into several distinct responsibilities to help keep things isolated.</span></li>
<li><strong><span class="koboSpan" id="kobo.271.1" xmlns="http://www.w3.org/1999/xhtml">O</span></strong><span class="koboSpan" id="kobo.272.1" xmlns="http://www.w3.org/1999/xhtml">: N/A</span></li>
<li><strong><span class="koboSpan" id="kobo.273.1" xmlns="http://www.w3.org/1999/xhtml">L</span></strong><span class="koboSpan" id="kobo.274.1" xmlns="http://www.w3.org/1999/xhtml">: N/A</span></li>
<li><strong><span class="koboSpan" id="kobo.275.1" xmlns="http://www.w3.org/1999/xhtml">I</span></strong><span class="koboSpan" id="kobo.276.1" xmlns="http://www.w3.org/1999/xhtml">: A DTO is a smaller, specifically crafted model that serves a clear purpose. </span><span class="koboSpan" id="kobo.276.2" xmlns="http://www.w3.org/1999/xhtml">With a DTO, we now have two models (domain and API contract) and several classes (input DTO, output DTO, and domain or data entities) instead of a generic one (only the domain or data entity).</span></li>
<li><strong><span class="koboSpan" id="kobo.277.1" xmlns="http://www.w3.org/1999/xhtml">D</span></strong><span class="koboSpan" id="kobo.278.1" xmlns="http://www.w3.org/1999/xhtml">: N/A</span></li>
</ul>
<p><span class="koboSpan" id="kobo.279.1" xmlns="http://www.w3.org/1999/xhtml">Next, we look at how we can glue the pieces that we explored so far into API contracts.</span></p>
</section>
</section>
<section class="level2" data-number="5.4" id="api-contracts">
<h2 data-number="5.4"><span class="koboSpan" id="kobo.280.1" xmlns="http://www.w3.org/1999/xhtml">API contracts</span></h2>
<p><span class="koboSpan" id="kobo.281.1" xmlns="http://www.w3.org/1999/xhtml">API Contracts serve as an essential blueprint, outlining the rules of engagement between your API and its consumers. </span><span class="koboSpan" id="kobo.281.2" xmlns="http://www.w3.org/1999/xhtml">This includes available endpoints, HTTP methods they support, expected request formats, and potential response structures, including HTTP status codes.These contracts provide clarity, robustness, consistency, and interoperability, facilitating seamless system interactions, no matter the language they are built with. </span><span class="koboSpan" id="kobo.281.3" xmlns="http://www.w3.org/1999/xhtml">Moreover, well-documented API contracts are a reliable reference guide, helping developers understand and utilize your API effectively. </span><span class="koboSpan" id="kobo.281.4" xmlns="http://www.w3.org/1999/xhtml">Thus, designing comprehensive and clear API contracts is critical in building high-quality, maintainable, and user-friendly APIs.An API contract describes a REST API, so a consumer should know how to call an endpoint and what to expect from it in return. </span><span class="koboSpan" id="kobo.281.5" xmlns="http://www.w3.org/1999/xhtml">What an endpoint does or the capability it provides should be clear just by reading its contract.Each endpoint in a REST API should provide at least the following signature:</span></p>
<ul>
<li><span class="koboSpan" id="kobo.282.1" xmlns="http://www.w3.org/1999/xhtml">A Uniform Resource Identifier (URI) that indicates where to access it.</span></li>
<li><span class="koboSpan" id="kobo.283.1" xmlns="http://www.w3.org/1999/xhtml">An HTTP method that describes the type of operation it does.</span></li>
<li><span class="koboSpan" id="kobo.284.1" xmlns="http://www.w3.org/1999/xhtml">An input that defines what is needed for the operation to happen. </span><span class="koboSpan" id="kobo.284.2" xmlns="http://www.w3.org/1999/xhtml">For example, the input can be the HTTP body, URL parameters, query parameters, HTTP headers, or even a combination.</span></li>
<li><span class="koboSpan" id="kobo.285.1" xmlns="http://www.w3.org/1999/xhtml">An output that defines what the client should expect. </span><span class="koboSpan" id="kobo.285.2" xmlns="http://www.w3.org/1999/xhtml">A client should expect multiple output definitions since an endpoint will not return the same information if the request succeeds or fails.</span></li>
</ul>
<blockquote>
<p><span class="koboSpan" id="kobo.286.1" xmlns="http://www.w3.org/1999/xhtml">The input and output of an endpoint are often DTOs, making DTOs even more important.</span></p>
</blockquote>
<p><span class="koboSpan" id="kobo.287.1" xmlns="http://www.w3.org/1999/xhtml">There are multiple ways to define API contracts. </span><span class="koboSpan" id="kobo.287.2" xmlns="http://www.w3.org/1999/xhtml">For example, to define an API contract, we could do the following:</span></p>
<ul>
<li><span class="koboSpan" id="kobo.288.1" xmlns="http://www.w3.org/1999/xhtml">Open any text editor, such as MS Word or Notepad, and start writing a document describing our web APIs; this is probably the most tedious and least flexible way. </span><span class="koboSpan" id="kobo.288.2" xmlns="http://www.w3.org/1999/xhtml">I do not recommend this for many reasons.</span></li>
<li><span class="koboSpan" id="kobo.289.1" xmlns="http://www.w3.org/1999/xhtml">Writing specifications in Markdown files and saving those files within your project Git repository for easy discoverability. </span><span class="koboSpan" id="kobo.289.2" xmlns="http://www.w3.org/1999/xhtml">Very similar to MS Word, but more accessible for all team members to consume. </span><span class="koboSpan" id="kobo.289.3" xmlns="http://www.w3.org/1999/xhtml">This approach is better than Word, yet not optimal since you need to manually update those files when the API changes.</span></li>
<li><span class="koboSpan" id="kobo.290.1" xmlns="http://www.w3.org/1999/xhtml">Use an existing standard, such as the OpenAPI specification (formerly Swagger). </span><span class="koboSpan" id="kobo.290.2" xmlns="http://www.w3.org/1999/xhtml">This technique implies a learning curve, but the result should be easier to consume. </span><span class="koboSpan" id="kobo.290.3" xmlns="http://www.w3.org/1999/xhtml">Moreover, many tools allow us to create automation using the OpenAPI specs. </span><span class="koboSpan" id="kobo.290.4" xmlns="http://www.w3.org/1999/xhtml">This approach is starting to remove the need for manual intervention.</span></li>
<li><span class="koboSpan" id="kobo.291.1" xmlns="http://www.w3.org/1999/xhtml">Use a code-first approach and ASP.NET Core tooling to extract the OpenAPI specs from your code.</span></li>
<li><span class="koboSpan" id="kobo.292.1" xmlns="http://www.w3.org/1999/xhtml">Use any other tools that fit our requirements.</span></li>
</ul>
<blockquote>
<p><strong><span class="koboSpan" id="kobo.293.1" xmlns="http://www.w3.org/1999/xhtml">Tip</span></strong></p>
<blockquote>
<p><span class="koboSpan" id="kobo.294.1" xmlns="http://www.w3.org/1999/xhtml">Postman is a fantastic tool for building web APIs documentation, test suites, and experimenting with your APIs. </span><span class="koboSpan" id="kobo.294.2" xmlns="http://www.w3.org/1999/xhtml">It supports OpenAPI specifications, allows you to create mock servers, supports environments, and more.</span></p>
</blockquote>
</blockquote>
<p><span class="koboSpan" id="kobo.295.1" xmlns="http://www.w3.org/1999/xhtml">No matter the tools, there are two major trends in how to design the API contract of a REST API:</span></p>
<ul>
<li><span class="koboSpan" id="kobo.296.1" xmlns="http://www.w3.org/1999/xhtml">Design the contract first, then build the API (contract-first).</span></li>
<li><span class="koboSpan" id="kobo.297.1" xmlns="http://www.w3.org/1999/xhtml">Build the API, then extract the contract for the code (code-first).</span></li>
</ul>
<p><span class="koboSpan" id="kobo.298.1" xmlns="http://www.w3.org/1999/xhtml">To design the contract-first, one must adopt a tool to write the specifications, then code the API according to the specs.</span></p>
<blockquote>
<p><span class="koboSpan" id="kobo.299.1" xmlns="http://www.w3.org/1999/xhtml">I left a link in the </span><em><span class="koboSpan" id="kobo.300.1" xmlns="http://www.w3.org/1999/xhtml">Further Reading</span></em><span class="koboSpan" id="kobo.301.1" xmlns="http://www.w3.org/1999/xhtml"> section below about Open API.</span></p>
</blockquote>
<p><span class="koboSpan" id="kobo.302.1" xmlns="http://www.w3.org/1999/xhtml">On the other hand, to use a code-first approach and automatically extract the OpenAPI specifications from the API, we must ensure our endpoints are discoverable by the .NET </span><code><span class="koboSpan" id="kobo.303.1" xmlns="http://www.w3.org/1999/xhtml">ApiExplorer</span></code><span class="koboSpan" id="kobo.304.1" xmlns="http://www.w3.org/1999/xhtml">.No matter how you do it, in ASP.NET Core, we use classes and struct to represent the data contract of our REST APIs; whether it happens before or after you write the API contract does not matter. </span><span class="koboSpan" id="kobo.304.2" xmlns="http://www.w3.org/1999/xhtml">Since I prefer to write C# to YAML or JSON, we explore how to leverage Swagger to generate a data contract in a code-first manner next.</span></p>
<section class="level3" data-number="5.4.1" id="code-first-api-contract">
<h3 data-number="5.4.1"><span class="koboSpan" id="kobo.305.1" xmlns="http://www.w3.org/1999/xhtml">Code-first API Contract</span></h3>
<p><span class="koboSpan" id="kobo.306.1" xmlns="http://www.w3.org/1999/xhtml">In this example, we have a tiny API with two endpoints:</span></p>
<ul>
<li><span class="koboSpan" id="kobo.307.1" xmlns="http://www.w3.org/1999/xhtml">Read the specified entity.</span></li>
<li><span class="koboSpan" id="kobo.308.1" xmlns="http://www.w3.org/1999/xhtml">Create a new entity.</span></li>
</ul>
<p><span class="koboSpan" id="kobo.309.1" xmlns="http://www.w3.org/1999/xhtml">The code doesn’t do much and returns fake data, but it is enough to explore its data contract.</span></p>
<blockquote>
<p><span class="koboSpan" id="kobo.310.1" xmlns="http://www.w3.org/1999/xhtml">Remember that code is like playing LEGO® blocks, but we connect many tiny patterns used together to create our software and create value. </span><span class="koboSpan" id="kobo.310.2" xmlns="http://www.w3.org/1999/xhtml">Understanding and learning that skill will lead you beyond just being able to use some canned magic recipe, which limits you to what people share with you.</span></p>
</blockquote>
<p><span class="koboSpan" id="kobo.311.1" xmlns="http://www.w3.org/1999/xhtml">In this sample, we use the OpenAPI specification to describe our API. </span><span class="koboSpan" id="kobo.311.2" xmlns="http://www.w3.org/1999/xhtml">To save ourselves from writing JSON and go code-first instead, we leverage the SwagerGen package.</span></p>
<blockquote>
<p><span class="koboSpan" id="kobo.312.1" xmlns="http://www.w3.org/1999/xhtml">To use SwaggerGen, we must install the </span><code><span class="koboSpan" id="kobo.313.1" xmlns="http://www.w3.org/1999/xhtml">Swashbuckle.AspNetCore.SwaggerGen</span></code><span class="koboSpan" id="kobo.314.1" xmlns="http://www.w3.org/1999/xhtml"> NuGet package.</span></p>
</blockquote>
<p><span class="koboSpan" id="kobo.315.1" xmlns="http://www.w3.org/1999/xhtml">Here’s the </span><code><span class="koboSpan" id="kobo.316.1" xmlns="http://www.w3.org/1999/xhtml">Program.cs</span></code><span class="koboSpan" id="kobo.317.1" xmlns="http://www.w3.org/1999/xhtml"> file, without the endpoints, showing how to leverage SwaggerGen:</span></p>
<div class="C0-CodePACKT">
<pre><code><span class="koboSpan" id="kobo.318.1" xmlns="http://www.w3.org/1999/xhtml">var builder = WebApplication.CreateBuilder(args);
builder.Services.AddEndpointsApiExplorer();
builder.Services.AddSwaggerGen();
var app = builder.Build();
app.UseSwagger();
// Omitted endpoints
app.Run();</span></code></pre>
</div>
<p><span class="koboSpan" id="kobo.319.1" xmlns="http://www.w3.org/1999/xhtml">The highlighted lines are the only things we must do to use SwaggerGen in a project, which will generate the API contract in the OpenAPI specification for us. </span><span class="koboSpan" id="kobo.319.2" xmlns="http://www.w3.org/1999/xhtml">The JSON file is very long (113 lines), so I only pasted some snippets in the book for clarity. </span><span class="koboSpan" id="kobo.319.3" xmlns="http://www.w3.org/1999/xhtml">However, you can navigate to the </span><code><span class="koboSpan" id="kobo.320.1" xmlns="http://www.w3.org/1999/xhtml">/swagger/v1/swagger.json</span></code><span class="koboSpan" id="kobo.321.1" xmlns="http://www.w3.org/1999/xhtml"> URL to access the complete JSON code or open the </span><code><span class="koboSpan" id="kobo.322.1" xmlns="http://www.w3.org/1999/xhtml">swagger.json</span></code><span class="koboSpan" id="kobo.323.1" xmlns="http://www.w3.org/1999/xhtml"> file in the project.</span></p>
<blockquote>
<p><span class="koboSpan" id="kobo.324.1" xmlns="http://www.w3.org/1999/xhtml">I created the </span><code><span class="koboSpan" id="kobo.325.1" xmlns="http://www.w3.org/1999/xhtml">swagger.json</span></code><span class="koboSpan" id="kobo.326.1" xmlns="http://www.w3.org/1999/xhtml"> file in the project for convenience. </span><span class="koboSpan" id="kobo.326.2" xmlns="http://www.w3.org/1999/xhtml">The tool does not generate a physical file.</span></p>
</blockquote>
<p><span class="koboSpan" id="kobo.327.1" xmlns="http://www.w3.org/1999/xhtml">Let’s have a look at those endpoints.</span></p>
<section class="level4" data-number="5.4.1.1" id="the-first-endpoint">
<h4 data-number="5.4.1.1"><span class="koboSpan" id="kobo.328.1" xmlns="http://www.w3.org/1999/xhtml">The first endpoint</span></h4>
<p><span class="koboSpan" id="kobo.329.1" xmlns="http://www.w3.org/1999/xhtml">The code of the first endpoint that allows a client to read an entity looks like this:</span></p>
<div class="C0-CodePACKT">
<pre><code><span class="koboSpan" id="kobo.330.1" xmlns="http://www.w3.org/1999/xhtml">app.MapGet(
    "/{id:int}",
    (int id) =&gt; new ReadOneDto(
        id,
        "John Doe"
    )
);
public record class ReadOneDto(int Id, string Name);</span></code></pre>
</div>
<p><span class="koboSpan" id="kobo.331.1" xmlns="http://www.w3.org/1999/xhtml">Here’s the API contract we can extract from the preceding code:</span></p>
<table>
<tbody>
<tr class="odd">
<td><strong><span class="koboSpan" id="kobo.332.1" xmlns="http://www.w3.org/1999/xhtml">Contract segment</span></strong></td>
<td><strong><span class="koboSpan" id="kobo.333.1" xmlns="http://www.w3.org/1999/xhtml">Value</span></strong></td>
</tr>
<tr class="even">
<td><span class="koboSpan" id="kobo.334.1" xmlns="http://www.w3.org/1999/xhtml">HTTP Method</span></td>
<td><span class="koboSpan" id="kobo.335.1" xmlns="http://www.w3.org/1999/xhtml">GET</span></td>
</tr>
<tr class="odd">
<td><span class="koboSpan" id="kobo.336.1" xmlns="http://www.w3.org/1999/xhtml">URI</span></td>
<td><code><span class="koboSpan" id="kobo.337.1" xmlns="http://www.w3.org/1999/xhtml">/{id}</span></code><span class="koboSpan" id="kobo.338.1" xmlns="http://www.w3.org/1999/xhtml"> (for example, </span><code><span class="koboSpan" id="kobo.339.1" xmlns="http://www.w3.org/1999/xhtml">/123</span></code><span class="koboSpan" id="kobo.340.1" xmlns="http://www.w3.org/1999/xhtml"> )</span></td>
</tr>
<tr class="even">
<td><span class="koboSpan" id="kobo.341.1" xmlns="http://www.w3.org/1999/xhtml">Input</span></td>
<td><span class="koboSpan" id="kobo.342.1" xmlns="http://www.w3.org/1999/xhtml">The </span><code><span class="koboSpan" id="kobo.343.1" xmlns="http://www.w3.org/1999/xhtml">id</span></code><span class="koboSpan" id="kobo.344.1" xmlns="http://www.w3.org/1999/xhtml"> parameter</span></td>
</tr>
<tr class="odd">
<td><span class="koboSpan" id="kobo.345.1" xmlns="http://www.w3.org/1999/xhtml">Output</span></td>
<td><span class="koboSpan" id="kobo.346.1" xmlns="http://www.w3.org/1999/xhtml">An instance of the </span><code><span class="koboSpan" id="kobo.347.1" xmlns="http://www.w3.org/1999/xhtml">ReadOneDto</span></code><span class="koboSpan" id="kobo.348.1" xmlns="http://www.w3.org/1999/xhtml"> class.</span></td>
</tr>
</tbody>
</table>
<p><span class="koboSpan" id="kobo.349.1" xmlns="http://www.w3.org/1999/xhtml">Sending the following HTTP request (you can use the </span><code><span class="koboSpan" id="kobo.350.1" xmlns="http://www.w3.org/1999/xhtml">ReadOneEntity.http</span></code><span class="koboSpan" id="kobo.351.1" xmlns="http://www.w3.org/1999/xhtml"> file) results in the output that follows:</span></p>
<div class="C0-CodePACKT">
<pre><code><span class="koboSpan" id="kobo.352.1" xmlns="http://www.w3.org/1999/xhtml">GET /123 HTTP/1.1
Accept: application/json
Host: localhost:7000
Connection: keep-alive</span></code></pre>
</div>
<p><span class="koboSpan" id="kobo.353.1" xmlns="http://www.w3.org/1999/xhtml">The trimmed-down response is:</span></p>
<div class="C0-CodePACKT">
<pre><code><span class="koboSpan" id="kobo.354.1" xmlns="http://www.w3.org/1999/xhtml">HTTP/1.1 200 OK
Content-Type: application/json; charset=utf-8
Date: Sat, 03 Jun 2023 17:41:42 GMT
Server: Kestrel
Alt-Svc: h3=":7000"; ma=86400
Transfer-Encoding: chunked
 
{"id":123,"name":"John Doe"}</span></code></pre>
</div>
<p><span class="koboSpan" id="kobo.355.1" xmlns="http://www.w3.org/1999/xhtml">As we can see, when we query the API for the entity </span><code><span class="koboSpan" id="kobo.356.1" xmlns="http://www.w3.org/1999/xhtml">id=123</span></code><span class="koboSpan" id="kobo.357.1" xmlns="http://www.w3.org/1999/xhtml">, the endpoint returns that entity with a </span><code><span class="koboSpan" id="kobo.358.1" xmlns="http://www.w3.org/1999/xhtml">200 OK</span></code><span class="koboSpan" id="kobo.359.1" xmlns="http://www.w3.org/1999/xhtml"> status code, and the response body is a serialized instance of the </span><code><span class="koboSpan" id="kobo.360.1" xmlns="http://www.w3.org/1999/xhtml">ReadOneDto</span></code><span class="koboSpan" id="kobo.361.1" xmlns="http://www.w3.org/1999/xhtml"> class.</span></p>
<blockquote>
<p><span class="koboSpan" id="kobo.362.1" xmlns="http://www.w3.org/1999/xhtml">The </span><code><span class="koboSpan" id="kobo.363.1" xmlns="http://www.w3.org/1999/xhtml">.http</span></code><span class="koboSpan" id="kobo.364.1" xmlns="http://www.w3.org/1999/xhtml"> files are new to VS 2022 and allow us to write and execute HTTP requests from VS itself. </span><span class="koboSpan" id="kobo.364.2" xmlns="http://www.w3.org/1999/xhtml">I left a link in the </span><em><span class="koboSpan" id="kobo.365.1" xmlns="http://www.w3.org/1999/xhtml">Further Reading</span></em><span class="koboSpan" id="kobo.366.1" xmlns="http://www.w3.org/1999/xhtml"> section if you want to know more.</span></p>
</blockquote>
<p><span class="koboSpan" id="kobo.367.1" xmlns="http://www.w3.org/1999/xhtml">SwaggerGen generated the following OpenAPI specs for the first endpoint:</span></p>
<div class="C0-CodePACKT">
<pre><code><span class="koboSpan" id="kobo.368.1" xmlns="http://www.w3.org/1999/xhtml">"/{id}": {
  "get": {
    "parameters": [
      {
        "name": "id",
        "in": "path",
        "required": true,
        "schema": {
          "type": "integer",
          "format": "int32"
        }
      }
    ],
    "responses": {
      "200": {
        "description": "Success",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/ReadOneDto"
            }
          }
        }
      }
    }
  }
},</span></code></pre>
</div>
<p><span class="koboSpan" id="kobo.369.1" xmlns="http://www.w3.org/1999/xhtml">That snippet describes the endpoint and references our output model (highlighted line). </span><span class="koboSpan" id="kobo.369.2" xmlns="http://www.w3.org/1999/xhtml">The schemas are at the bottom of the JSON file. </span><span class="koboSpan" id="kobo.369.3" xmlns="http://www.w3.org/1999/xhtml">Here’s the schema that represents the </span><code><span class="koboSpan" id="kobo.370.1" xmlns="http://www.w3.org/1999/xhtml">ReadOneDto</span></code><span class="koboSpan" id="kobo.371.1" xmlns="http://www.w3.org/1999/xhtml">:</span></p>
<div class="C0-CodePACKT">
<pre><code><span class="koboSpan" id="kobo.372.1" xmlns="http://www.w3.org/1999/xhtml">"ReadOneDto": {
  "type": "object",
  "properties": {
    "id": {
      "type": "integer",
      "format": "int32"
    },
    "name": {
      "type": "string",
      "nullable": true
    }
  },
  "additionalProperties": false
}</span></code></pre>
</div>
<p><span class="koboSpan" id="kobo.373.1" xmlns="http://www.w3.org/1999/xhtml">As we can see from the highlighted lines, that schema has a property </span><code><span class="koboSpan" id="kobo.374.1" xmlns="http://www.w3.org/1999/xhtml">name</span></code><span class="koboSpan" id="kobo.375.1" xmlns="http://www.w3.org/1999/xhtml"> of type </span><code><span class="koboSpan" id="kobo.376.1" xmlns="http://www.w3.org/1999/xhtml">string</span></code><span class="koboSpan" id="kobo.377.1" xmlns="http://www.w3.org/1999/xhtml"> and a property </span><code><span class="koboSpan" id="kobo.378.1" xmlns="http://www.w3.org/1999/xhtml">id</span></code><span class="koboSpan" id="kobo.379.1" xmlns="http://www.w3.org/1999/xhtml"> of type </span><code><span class="koboSpan" id="kobo.380.1" xmlns="http://www.w3.org/1999/xhtml">integer</span></code><span class="koboSpan" id="kobo.381.1" xmlns="http://www.w3.org/1999/xhtml">, the same as our </span><code><span class="koboSpan" id="kobo.382.1" xmlns="http://www.w3.org/1999/xhtml">ReadOneDto</span></code><span class="koboSpan" id="kobo.383.1" xmlns="http://www.w3.org/1999/xhtml"> class. </span><span class="koboSpan" id="kobo.383.2" xmlns="http://www.w3.org/1999/xhtml">Fortunately, we don’t need to write that JSON since the tool generates it based on our code. </span><span class="koboSpan" id="kobo.383.3" xmlns="http://www.w3.org/1999/xhtml">Next, we look at the second endpoint.</span></p>
</section>
<section class="level4" data-number="5.4.1.2" id="the-second-endpoint">
<h4 data-number="5.4.1.2"><span class="koboSpan" id="kobo.384.1" xmlns="http://www.w3.org/1999/xhtml">The second endpoint</span></h4>
<p><span class="koboSpan" id="kobo.385.1" xmlns="http://www.w3.org/1999/xhtml">The code of the second endpoint that allows a client to create an entity looks like this:</span></p>
<div class="C0-CodePACKT">
<pre><code><span class="koboSpan" id="kobo.386.1" xmlns="http://www.w3.org/1999/xhtml">app.MapPost(
    "/",
    (CreateDto input) =&gt; new CreatedDto(
        Random.Shared.Next(int.MaxValue),
        input.Name
    )
);
public record class CreateDto(string Name);
public record class CreatedDto(int Id, string Name);</span></code></pre>
</div>
<p><span class="koboSpan" id="kobo.387.1" xmlns="http://www.w3.org/1999/xhtml">Here’s the API contract we can extract from the preceding code:</span></p>
<table>
<tbody>
<tr class="odd">
<td><strong><span class="koboSpan" id="kobo.388.1" xmlns="http://www.w3.org/1999/xhtml">Contract segment</span></strong></td>
<td><strong><span class="koboSpan" id="kobo.389.1" xmlns="http://www.w3.org/1999/xhtml">Value</span></strong></td>
</tr>
<tr class="even">
<td><span class="koboSpan" id="kobo.390.1" xmlns="http://www.w3.org/1999/xhtml">HTTP Method</span></td>
<td><span class="koboSpan" id="kobo.391.1" xmlns="http://www.w3.org/1999/xhtml">POST</span></td>
</tr>
<tr class="odd">
<td><span class="koboSpan" id="kobo.392.1" xmlns="http://www.w3.org/1999/xhtml">URI</span></td>
<td><code><span class="koboSpan" id="kobo.393.1" xmlns="http://www.w3.org/1999/xhtml">/</span></code></td>
</tr>
<tr class="even">
<td><span class="koboSpan" id="kobo.394.1" xmlns="http://www.w3.org/1999/xhtml">Input</span></td>
<td><span class="koboSpan" id="kobo.395.1" xmlns="http://www.w3.org/1999/xhtml">An instance of the </span><code><span class="koboSpan" id="kobo.396.1" xmlns="http://www.w3.org/1999/xhtml">CreateDto</span></code><span class="koboSpan" id="kobo.397.1" xmlns="http://www.w3.org/1999/xhtml"> class.</span></td>
</tr>
<tr class="odd">
<td><span class="koboSpan" id="kobo.398.1" xmlns="http://www.w3.org/1999/xhtml">Output</span></td>
<td><span class="koboSpan" id="kobo.399.1" xmlns="http://www.w3.org/1999/xhtml">An instance of the </span><code><span class="koboSpan" id="kobo.400.1" xmlns="http://www.w3.org/1999/xhtml">CreatedDto</span></code><span class="koboSpan" id="kobo.401.1" xmlns="http://www.w3.org/1999/xhtml"> class.</span></td>
</tr>
</tbody>
</table>
<p><span class="koboSpan" id="kobo.402.1" xmlns="http://www.w3.org/1999/xhtml">Sending the following HTTP request (you can use the </span><code><span class="koboSpan" id="kobo.403.1" xmlns="http://www.w3.org/1999/xhtml">CreateEntity.http</span></code><span class="koboSpan" id="kobo.404.1" xmlns="http://www.w3.org/1999/xhtml"> file) results in the output that follows:</span></p>
<div class="C0-CodePACKT">
<pre><code><span class="koboSpan" id="kobo.405.1" xmlns="http://www.w3.org/1999/xhtml">POST / HTTP/1.1
Content-Type: application/json
Host: localhost:7000
Accept: application/json
Connection: keep-alive
Content-Length: 28
 
{
    "name": "Jane Doe"
}</span></code></pre>
</div>
<p><span class="koboSpan" id="kobo.406.1" xmlns="http://www.w3.org/1999/xhtml">The trimmed-down response is:</span></p>
<div class="C0-CodePACKT">
<pre><code><span class="koboSpan" id="kobo.407.1" xmlns="http://www.w3.org/1999/xhtml">HTTP/1.1 200 OK
Content-Type: application/json; charset=utf-8
Date: Sat, 03 Jun 2023 17:59:25 GMT
Server: Kestrel
Alt-Svc: h3=":7000"; ma=86400
Transfer-Encoding: chunked
 
{"id":1624444431,"name":"Jane Doe"}</span></code></pre>
</div>
<p><span class="koboSpan" id="kobo.408.1" xmlns="http://www.w3.org/1999/xhtml">As we can see from the preceding request, the client sent a serialized instance of the </span><code><span class="koboSpan" id="kobo.409.1" xmlns="http://www.w3.org/1999/xhtml">CreateDto</span></code><span class="koboSpan" id="kobo.410.1" xmlns="http://www.w3.org/1999/xhtml"> class, set the name to Jane Doe, and received that same entity back but with a numeric </span><code><span class="koboSpan" id="kobo.411.1" xmlns="http://www.w3.org/1999/xhtml">id</span></code><span class="koboSpan" id="kobo.412.1" xmlns="http://www.w3.org/1999/xhtml"> property (an instance of the </span><code><span class="koboSpan" id="kobo.413.1" xmlns="http://www.w3.org/1999/xhtml">CreatedDto</span></code><span class="koboSpan" id="kobo.414.1" xmlns="http://www.w3.org/1999/xhtml"> class).The OpenAPI specs of our endpoint look like the following:</span></p>
<div class="C0-CodePACKT">
<pre><code><span class="koboSpan" id="kobo.415.1" xmlns="http://www.w3.org/1999/xhtml">"/": {
  "post": {
    "requestBody": {
      "content": {
        "application/json": {
          "schema": {
            "$ref": "#/components/schemas/CreateDto"
          }
        }
      },
      "required": true
    },
    "responses": {
      "200": {
        "description": "Success",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/CreatedDto"
            }
          }
        }
      }
    }
  }
}</span></code></pre>
</div>
<p><span class="koboSpan" id="kobo.416.1" xmlns="http://www.w3.org/1999/xhtml">The input and output schemas are:</span></p>
<div class="C0-CodePACKT">
<pre><code><span class="koboSpan" id="kobo.417.1" xmlns="http://www.w3.org/1999/xhtml">"CreateDto": {
  "type": "object",
  "properties": {
    "name": {
      "type": "string",
      "nullable": true
    }
  },
  "additionalProperties": false
},
"CreatedDto": {
  "type": "object",
  "properties": {
    "id": {
      "type": "integer",
      "format": "int32"
    },
    "name": {
      "type": "string",
      "nullable": true
    }
  },
  "additionalProperties": false
},</span></code></pre>
</div>
<p><span class="koboSpan" id="kobo.418.1" xmlns="http://www.w3.org/1999/xhtml">Similar to the first endpoint, SwaggerGen translates our C# classes into OpenAPI specs. </span><span class="koboSpan" id="kobo.418.2" xmlns="http://www.w3.org/1999/xhtml">Let’s wrap this up.</span></p>
</section>
</section>
<section class="level3" data-number="5.4.2" id="wrapping-up-1">
<h3 data-number="5.4.2"><span class="koboSpan" id="kobo.419.1" xmlns="http://www.w3.org/1999/xhtml">Wrapping up</span></h3>
<p><span class="koboSpan" id="kobo.420.1" xmlns="http://www.w3.org/1999/xhtml">Some ASP.NET Core templates come with SwaggerGen preconfigured. </span><span class="koboSpan" id="kobo.420.2" xmlns="http://www.w3.org/1999/xhtml">It also comes with the Swagger UI that lets you visually explore the API contract from your application and even query it. </span><span class="koboSpan" id="kobo.420.3" xmlns="http://www.w3.org/1999/xhtml">NSwag is another tool that offers similar features. </span><span class="koboSpan" id="kobo.420.4" xmlns="http://www.w3.org/1999/xhtml">Plenty of online documentation shows how to take advantage of those tools.Besides exploring tooling, we defined that an API contract is fundamental and promotes robustness and reliability. </span><span class="koboSpan" id="kobo.420.5" xmlns="http://www.w3.org/1999/xhtml">Each endpoint has the following pieces as part of the overall API contract:</span></p>
<ul>
<li><span class="koboSpan" id="kobo.421.1" xmlns="http://www.w3.org/1999/xhtml">The URI it is accessible from.</span></li>
<li><span class="koboSpan" id="kobo.422.1" xmlns="http://www.w3.org/1999/xhtml">The HTTP method that best defines the operation.</span></li>
<li><span class="koboSpan" id="kobo.423.1" xmlns="http://www.w3.org/1999/xhtml">An input.</span></li>
<li><span class="koboSpan" id="kobo.424.1" xmlns="http://www.w3.org/1999/xhtml">One or more outputs.</span></li>
</ul>
<blockquote>
<p><span class="koboSpan" id="kobo.425.1" xmlns="http://www.w3.org/1999/xhtml">A single URI can lead to multiple endpoints by combining different HTTP methods and inputs. </span><span class="koboSpan" id="kobo.425.2" xmlns="http://www.w3.org/1999/xhtml">For example, </span><code><span class="koboSpan" id="kobo.426.1" xmlns="http://www.w3.org/1999/xhtml">GET /api/entities</span></code><span class="koboSpan" id="kobo.427.1" xmlns="http://www.w3.org/1999/xhtml"> may return a list of entities, while </span><code><span class="koboSpan" id="kobo.428.1" xmlns="http://www.w3.org/1999/xhtml">POST /api/entities</span></code><span class="koboSpan" id="kobo.429.1" xmlns="http://www.w3.org/1999/xhtml"> may create a new entity. </span><span class="koboSpan" id="kobo.429.2" xmlns="http://www.w3.org/1999/xhtml">Using the entity's name in its plural form is a convention used by many.</span></p>
</blockquote>
<p><span class="koboSpan" id="kobo.430.1" xmlns="http://www.w3.org/1999/xhtml">We explore data transfer objects next to add more clarity to that pattern.</span></p>
</section>
</section>
<section class="level2" data-number="5.5" id="summary-3">
<h2 data-number="5.5"><span class="koboSpan" id="kobo.431.1" xmlns="http://www.w3.org/1999/xhtml">Summary</span></h2>
<p><span class="koboSpan" id="kobo.432.1" xmlns="http://www.w3.org/1999/xhtml">REST APIs facilitate communication between applications in today's interconnected digital world. </span><span class="koboSpan" id="kobo.432.2" xmlns="http://www.w3.org/1999/xhtml">We explored the HTTP protocol, HTTP methods, HTTP status codes, and HTTP headers. </span><span class="koboSpan" id="kobo.432.3" xmlns="http://www.w3.org/1999/xhtml">We then explored API versioning, the Data Transfer Objects (DTOs), and the importance of API contracts. </span><span class="koboSpan" id="kobo.432.4" xmlns="http://www.w3.org/1999/xhtml">Here are a few Key Takeaways:</span></p>
<ul>
<li><strong><span class="koboSpan" id="kobo.433.1" xmlns="http://www.w3.org/1999/xhtml">REST &amp; HTTP</span></strong><span class="koboSpan" id="kobo.434.1" xmlns="http://www.w3.org/1999/xhtml">: REST APIs are integral to web application communication. </span><span class="koboSpan" id="kobo.434.2" xmlns="http://www.w3.org/1999/xhtml">They use HTTP as their transport protocol, leveraging its methods, status codes, and headers to facilitate interaction between different applications.</span></li>
<li><strong><span class="koboSpan" id="kobo.435.1" xmlns="http://www.w3.org/1999/xhtml">HTTP Methods</span></strong><span class="koboSpan" id="kobo.436.1" xmlns="http://www.w3.org/1999/xhtml">: HTTP methods or verbs (GET, POST, PUT, DELETE, PATCH) define the type of action a client can perform on a resource in a RESTful API. </span><span class="koboSpan" id="kobo.436.2" xmlns="http://www.w3.org/1999/xhtml">Understanding these methods is crucial for carrying out CRUD operations.</span></li>
<li><strong><span class="koboSpan" id="kobo.437.1" xmlns="http://www.w3.org/1999/xhtml">HTTP Status Codes and Headers</span></strong><span class="koboSpan" id="kobo.438.1" xmlns="http://www.w3.org/1999/xhtml">: HTTP status codes inform clients about the success or failure of their requests. </span><span class="koboSpan" id="kobo.438.2" xmlns="http://www.w3.org/1999/xhtml">HTTP headers transmit additional information and describe clients' options and capabilities. </span><span class="koboSpan" id="kobo.438.3" xmlns="http://www.w3.org/1999/xhtml">Both are essential components of HTTP communication.</span></li>
<li><strong><span class="koboSpan" id="kobo.439.1" xmlns="http://www.w3.org/1999/xhtml">Versioning</span></strong><span class="koboSpan" id="kobo.440.1" xmlns="http://www.w3.org/1999/xhtml">: Managing changes in APIs without disrupting existing clients is a significant challenge. </span><span class="koboSpan" id="kobo.440.2" xmlns="http://www.w3.org/1999/xhtml">Different strategies for API versioning can help address this issue, but each comes with its own trade-offs.</span></li>
<li><strong><span class="koboSpan" id="kobo.441.1" xmlns="http://www.w3.org/1999/xhtml">Data Transfer Object (DTO)</span></strong><span class="koboSpan" id="kobo.442.1" xmlns="http://www.w3.org/1999/xhtml">: DTOs package data into a format that can provide many benefits, including reducing the number of HTTP calls, improving encapsulation, and enhancing performance when sending data over the network.</span></li>
<li><strong><span class="koboSpan" id="kobo.443.1" xmlns="http://www.w3.org/1999/xhtml">API Contracts</span></strong><span class="koboSpan" id="kobo.444.1" xmlns="http://www.w3.org/1999/xhtml">: Clear and robust API contracts ensure API stability. </span><span class="koboSpan" id="kobo.444.2" xmlns="http://www.w3.org/1999/xhtml">They serve as a blueprint for interaction between an API and its consumers, outlining available endpoints, supported HTTP methods, expected request formats, and potential response structures.</span></li>
<li><strong><span class="koboSpan" id="kobo.445.1" xmlns="http://www.w3.org/1999/xhtml">Practical Application</span></strong><span class="koboSpan" id="kobo.446.1" xmlns="http://www.w3.org/1999/xhtml">: Understanding these concepts is not only theoretically important but also practically helpful in building and working with REST APIs using ASP.NET Core or any other similar technology.</span></li>
</ul>
<p><span class="koboSpan" id="kobo.447.1" xmlns="http://www.w3.org/1999/xhtml">By now, you should have a solid understanding of REST APIs and be ready to explore how to implement one using ASP.NET Core. </span><span class="koboSpan" id="kobo.447.2" xmlns="http://www.w3.org/1999/xhtml">ASP.NET Core makes writing REST APIs using MVC or minimal APIs a breeze. </span><span class="koboSpan" id="kobo.447.3" xmlns="http://www.w3.org/1999/xhtml">MVC is a well-used pattern that is almost impossible to avoid. </span><span class="koboSpan" id="kobo.447.4" xmlns="http://www.w3.org/1999/xhtml">However, the new minimal API model makes the process leaner. </span><span class="koboSpan" id="kobo.447.5" xmlns="http://www.w3.org/1999/xhtml">Moreover, with application patterns like Request-EndPoint-Response (REPR) or Vertical Slice Architecture, we can organize our API per feature instead of by layer, leading to an improved organization. </span><span class="koboSpan" id="kobo.447.6" xmlns="http://www.w3.org/1999/xhtml">We cover those topics in </span><em><span class="koboSpan" id="kobo.448.1" xmlns="http://www.w3.org/1999/xhtml">Section 4</span></em><span class="koboSpan" id="kobo.449.1" xmlns="http://www.w3.org/1999/xhtml">: </span><em><span class="koboSpan" id="kobo.450.1" xmlns="http://www.w3.org/1999/xhtml">Application patterns</span></em><span class="koboSpan" id="kobo.451.1" xmlns="http://www.w3.org/1999/xhtml">.Next, we explore designing with ASP.NET Core, starting with Minimal APIs.</span></p>
</section>
<section class="level2" data-number="5.6" id="questions-3">
<h2 data-number="5.6"><span class="koboSpan" id="kobo.452.1" xmlns="http://www.w3.org/1999/xhtml">Questions</span></h2>
<p><span class="koboSpan" id="kobo.453.1" xmlns="http://www.w3.org/1999/xhtml">Let’s look at a few practice questions:</span></p>
<ol>
<li><span class="koboSpan" id="kobo.454.1" xmlns="http://www.w3.org/1999/xhtml">What is the most common status code sent in a REST API after creating an entity?</span></li>
<li><span class="koboSpan" id="kobo.455.1" xmlns="http://www.w3.org/1999/xhtml">If you introduce a default strategy that returns the lowest possible version when no version is specified, would it break existing clients?</span></li>
<li><span class="koboSpan" id="kobo.456.1" xmlns="http://www.w3.org/1999/xhtml">If you want to read data from the server, what HTTP method would you use?</span></li>
<li><span class="koboSpan" id="kobo.457.1" xmlns="http://www.w3.org/1999/xhtml">Can DTOs add flexibility and robustness to a system?</span></li>
<li><span class="koboSpan" id="kobo.458.1" xmlns="http://www.w3.org/1999/xhtml">Are DTOs part of an API contract?</span></li>
</ol>
</section>
<section class="level2" data-number="5.7" id="further-reading-3">
<h2 data-number="5.7"><span class="koboSpan" id="kobo.459.1" xmlns="http://www.w3.org/1999/xhtml">Further reading</span></h2>
<p><span class="koboSpan" id="kobo.460.1" xmlns="http://www.w3.org/1999/xhtml">Here are some links to build on what we have learned in the chapter:</span></p>
<ul>
<li><span class="koboSpan" id="kobo.461.1" xmlns="http://www.w3.org/1999/xhtml">HTTP request methods (MDN): </span><a href="https://adpg.link/MFWb"><span class="koboSpan" id="kobo.462.1" xmlns="http://www.w3.org/1999/xhtml">https://adpg.link/MFWb</span></a></li>
<li><span class="koboSpan" id="kobo.463.1" xmlns="http://www.w3.org/1999/xhtml">HTTP response status codes (MDN): </span><a href="https://adpg.link/34Jq"><span class="koboSpan" id="kobo.464.1" xmlns="http://www.w3.org/1999/xhtml">https://adpg.link/34Jq</span></a></li>
<li><span class="koboSpan" id="kobo.465.1" xmlns="http://www.w3.org/1999/xhtml">HTTP headers (MDN): </span><a href="https://adpg.link/Hx55"><span class="koboSpan" id="kobo.466.1" xmlns="http://www.w3.org/1999/xhtml">https://adpg.link/Hx55</span></a></li>
<li><span class="koboSpan" id="kobo.467.1" xmlns="http://www.w3.org/1999/xhtml">Use .http files in Visual Studio 2022: </span><a href="https://adpg.link/cbhv"><span class="koboSpan" id="kobo.468.1" xmlns="http://www.w3.org/1999/xhtml">https://adpg.link/cbhv</span></a></li>
<li><span class="koboSpan" id="kobo.469.1" xmlns="http://www.w3.org/1999/xhtml">OpenAPI specification: </span><a href="https://adpg.link/M4Uz"><span class="koboSpan" id="kobo.470.1" xmlns="http://www.w3.org/1999/xhtml">https://adpg.link/M4Uz</span></a></li>
</ul>
</section>
<section class="level2" data-number="5.8" id="answers">
<h2 data-number="5.8"><span class="koboSpan" id="kobo.471.1" xmlns="http://www.w3.org/1999/xhtml">Answers</span></h2>
<ol>
<li><span class="koboSpan" id="kobo.472.1" xmlns="http://www.w3.org/1999/xhtml">An API usually returns the status code </span><code><span class="koboSpan" id="kobo.473.1" xmlns="http://www.w3.org/1999/xhtml">201 Created</span></code><span class="koboSpan" id="kobo.474.1" xmlns="http://www.w3.org/1999/xhtml"> after creating a new entity.</span></li>
<li><span class="koboSpan" id="kobo.475.1" xmlns="http://www.w3.org/1999/xhtml">No, it will not break clients because they will either be using the lowest API version or have already specified a specific version.</span></li>
<li><span class="koboSpan" id="kobo.476.1" xmlns="http://www.w3.org/1999/xhtml">We typically use the HTTP GET method to read data from a REST API.</span></li>
<li><span class="koboSpan" id="kobo.477.1" xmlns="http://www.w3.org/1999/xhtml">Yes, Data Transfer Objects (DTOs) can add flexibility and robustness to a system. </span><span class="koboSpan" id="kobo.477.2" xmlns="http://www.w3.org/1999/xhtml">They allow you to control exactly what data you expose to the client and can reduce the amount of unnecessary data that needs to be sent over the network.</span></li>
<li><span class="koboSpan" id="kobo.478.1" xmlns="http://www.w3.org/1999/xhtml">Yes, DTOs are part of an API contract. </span><span class="koboSpan" id="kobo.478.2" xmlns="http://www.w3.org/1999/xhtml">They define the data format exchanged between the client and server, ensuring both sides understand the data being sent and received.</span></li>
</ol>
</section>
</section>
</body>
</html>
