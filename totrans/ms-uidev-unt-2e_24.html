<html><head></head><body>
<div><div><h1 class="chapter-number" id="_idParaDest-305"><a id="_idTextAnchor501" class="pcalibre pcalibre1 calibre6"/>19</h1>
<h1 id="_idParaDest-306" class="calibre5"><a id="_idTextAnchor502" class="pcalibre pcalibre1 calibre6"/>Working with IMGUI</h1>
<p class="calibre3"><a id="_idTextAnchor503" class="pcalibre pcalibre1 calibre6"/>The last UI system I will cover is <strong class="bold">IMGUI</strong> or <strong class="bold">Immediate Mode Graphical User Interface</strong>. The primary usage for IMGUI is to create tools that assist developers during development and debugging. While IMGUI can technically make runtime UI, it is strongly discouraged by Unity. So, for example, you can use it to make Editor extensions or debug menus that will run in your game’s view, and can be accessed when you play your game outside of the Editor. However, keep in mind these debug in-game menus are meant to be developer-facing, not player-facing. IMGUI is most commonly used for developing Editor UI extensions.</p>
<p class="calibre3">Since this book’s primary focus is on runtime, player-facing UI, I won’t delve too deep into this system; however, I’ll cover the very basics of making developer-facing with IMGUI.</p>
<p class="calibre3">In this chapter, I will discuss the following:</p>
<ul class="calibre16">
<li class="calibre14">A general overview of how to use IMGUI</li>
<li class="calibre14">The most commonly used IMGUI Controls</li>
<li class="calibre14">How to use IMGUI for Inspector UI</li>
<li class="calibre14">How to show debug frame rate text UI in your game</li>
<li class="calibre14">How to put a button on an Inspector component and import data to a ScriptableObject</li>
</ul>
<p class="calibre3">It is important to note that IMGUI is not a recommended system by Unity. When it comes to runtime UI, they recommend uGUI (which is what the majority of this book is about), and when it comes to Editor UI, they recommend UI Toolkit (which was covered in <a href="B18327_18.xhtml#_idTextAnchor481" class="pcalibre pcalibre1 calibre6"><em class="italic">Chapter 18</em></a>). So, learning IMGUI is not necessarily a required skill for anyone developing in Unity. It is especially not a required skill for non-programmers. However, it does give programmers a very quick way to build out UI to assist them in development, so the skills are not useless.</p>
<p class="calibre3">Let’s review some basic information about IMGUI.</p>
<h1 id="_idParaDest-307" class="calibre5"><a id="_idTextAnchor504" class="pcalibre pcalibre1 calibre6"/>Technical requirements</h1>
<p class="calibre3">You can find the relevant codes and asset files of this chapter here: <a href="https://github.com/PacktPublishing/Mastering-UI-Development-with-Unity-2nd-Edition/tree/main/Chapter%2019" class="pcalibre pcalibre1 calibre6">https://github.com/PacktPublishing/Mastering-UI-Development-with-Unity-2nd-Edition/tree/main/Chapter%2019</a></p>
<h1 id="_idParaDest-308" class="calibre5"><a id="_idTextAnchor505" class="pcalibre pcalibre1 calibre6"/>IMGUI overview</h1>
<p class="calibre3">As I stated earlier, IMGUI gives<a id="_idIndexMarker1189" class="pcalibre pcalibre1 calibre6"/> programmers a quick way to build out UI that can assist them in their development. This is because IMGUI is built exclusively via code. It is not connected to GameObjects, and all objects are rendered via calls to an <code>OnGUI()</code> or <code>OnInspectorGUI()</code> method. The <code>OnGUI()</code> method is called every frame, similar to the <code>Update()</code> method.</p>
<p class="calibre3">If you want your IMGUI to appear within your scene, you write all your UI building code in an <code>OnGUI()</code> method within a <code>MonoBehaviour</code> inheriting script. Because IMGUI items are created via code, any UI you create with it on a <code>MonoBehaviour</code> script will not render until the game is run.</p>
<p class="calibre3">If you want your UI to appear in an Editor window, you will write all your UI building code in an <code>OnGUI()</code> method within an <code>EditorWindow</code> inheriting script. If you want your UI to appear in the Inspector, you write all your UI building code in an <code>OnInspectorGUI()</code> method within an <code>Editor</code> inheriting script.</p>
<p class="calibre3">All IMGUI items are created by calling their unique method within an <code>OnGUI()</code> or <code>OnInspectorGUI()</code> method. Each of their unique methods can be positioned and sized using rectangular position. When positioning an object with rectangular position, you first create a new Rectangle using the <code>Rect()</code> method. The <code>Rect()</code> method takes four parameters: <code>x</code> position, <code>y</code> position, <code>width</code>, and <code>height</code>. So, for example, you can create a new rectangle with the following line of code:</p>
<pre class="source-code">
Rect rect = new Rect(10, 10, 50, 50);</pre> <p class="calibre3">This would create a rectangle at screen coordinate <code>(10, 10)</code> with a width and height of <code>50</code>.</p>
<p class="calibre3">Remember, screen coordinates put position <code>(0,0)</code> in the top-left corner of the screen.</p>
<p class="calibre3">You can also use <code>Vector2</code>s to specify the parameters. For example, you could do something like this to achieve the same results:</p>
<pre class="source-code">
Vector2 position = new Vector2(10, 10);
Vector2 dimensions = new Vector2(50, 50);
Rect rect = new Rect(position, dimensions);</pre> <p class="calibre3">Now that we know how to<a id="_idIndexMarker1190" class="pcalibre pcalibre1 calibre6"/> create IMGUI items, let’s review the types of items that you can draw using <code>OnGUI()</code>.</p>
<h1 id="_idParaDest-309" class="calibre5"><a id="_idTextAnchor506" class="pcalibre pcalibre1 calibre6"/>IMGUI Controls</h1>
<p class="calibre3">The items drawn <a id="_idIndexMarker1191" class="pcalibre pcalibre1 calibre6"/>using IMGUI are called <strong class="bold">Controls</strong>. While the term “Controls” may imply the item is interactable, not all <a id="_idIndexMarker1192" class="pcalibre pcalibre1 calibre6"/>Controls are interactable. There are multiple Controls available with the IMGUI system, but you can accomplish most of your IMGUI goals with the following:</p>
<ul class="calibre16">
<li class="calibre14"><code>Label</code></li>
<li class="calibre14"><code>Button</code></li>
<li class="calibre14"><code>RepeatButton</code></li>
<li class="calibre14"><code>TextField</code></li>
<li class="calibre14"><code>TextArea</code></li>
<li class="calibre14"><code>Toggle</code></li>
</ul>
<p class="callout-heading">Note</p>
<p class="callout">You can find a comprehensive list of all IMGUI controls here: <a href="https://docs.unity3d.com/2023.3/Documentation/Manual/gui-Controls.xhtml" class="pcalibre pcalibre1 calibre6">https://docs.unity3d.com/2023.3/Documentation/Manual/gui-Controls.xhtml</a>.</p>
<p class="calibre3">A <code>Label</code>, you call the <code>GUI.Label()</code>method. The <code>GUI.Label()</code> method has multiple overloads, but the primary <a id="_idIndexMarker1193" class="pcalibre pcalibre1 calibre6"/>ones you will use are the following:</p>
<pre class="source-code">
public static void Label(Rect position, string text);
public static void Label(Rect position, Texture image);</pre> <p class="calibre3">Where the first is used to define a text label, and the second is used to define an image label.</p>
<p class="calibre3">For example, the following code<a id="_idIndexMarker1194" class="pcalibre pcalibre1 calibre6"/> will display a text label and an image label in a scene, when it is attached to a GameObject and the <code>labelTexture</code> variable is assigned in the Inspector:</p>
<pre class="source-code">
public class Chapter19Labels : MonoBehaviour {
    public Texture2D labelTexture;
    private void OnGUI() {
        GUI.Label(new Rect(10, 10, 100, 50), "Text Label");
        GUI.Label(new Rect(10, 80, 50, 50), labelTexture);
    }
}</pre> <p class="calibre3">The labels will look as follows:</p>
<div><div><img alt="Figure 19.1: Using IMGUI Labels" src="img/B18327_19_01.jpg" class="calibre654"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 19.1: Using IMGUI Labels</p>
<p class="calibre3">A <code>Button</code>, you call the <code>GUI.Button()</code> method. The <code>GUI.Button()</code> method has multiple overloads, but the primary ones you will use are the following:</p>
<pre class="source-code">
public static bool Button(Rect position, string text);
public static bool Button(Rect position, Texture image);</pre> <p class="calibre3">Where the first will be used to <a id="_idIndexMarker1196" class="pcalibre pcalibre1 calibre6"/>define a text button, and the second will be used to define an image button.</p>
<p class="calibre3">To execute code when a button is clicked, you create the button within an <code>if</code> statement within the <code>OnGUI()</code> method.</p>
<p class="calibre3">For example, the following code will display a text button and an image button in a scene:</p>
<pre class="source-code">
public class Chapter19Buttons : MonoBehaviour {
    public Texture2D buttonTexture;
    private void OnGUI() {
        if (GUI.Button(new Rect(10, 10, 100, 50), "Text Button")) {
            Debug.Log("Text Button Clicked");
        }
        if (GUI.Button(new Rect(10, 80, 50, 50), buttonTexture)) {
            Debug.Log("Image Button Clicked");
        }
    }
}</pre> <p class="calibre3">Both buttons will write<a id="_idIndexMarker1197" class="pcalibre pcalibre1 calibre6"/> a message in the console each time they are clicked. The code must be attached to a GameObject and the <code>buttonTexture</code> variable must be assigned in the Inspector.</p>
<p class="calibre3">The buttons created by the preceding code will look as follows:</p>
<div><div><img alt="Figure 19.2: Using IMGUI Buttons" src="img/B18327_19_02.jpg" class="calibre655"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 19.2: Using IMGUI Buttons</p>
<p class="calibre3">If you want to create a button that calls a method as it is clicked and held, you can use a <code>Button</code>. You can replace all instances of <code>GUI.Button</code> in the preceding code with <code>GUI.RepeatButton</code> and achieve <a id="_idIndexMarker1199" class="pcalibre pcalibre1 calibre6"/>a similar result, except the button will execute the method as long as the button is held.</p>
<p class="calibre3">The <code>TextField</code> is used when you want only a single line of editable text, whereas <code>TextArea</code> is used when you want multiple lines. To create a <code>TextField</code> or <code>TextArea</code>, you call the <code>GUI.TextField()</code> and <code>GUI.TextArea()</code> methods, respectively. The <code>GUI.TextField()</code> method has multiple overloads, but the primary ones you will use are the following:</p>
<pre class="source-code">
public static string TextField(Rect position, string text);
public static string TextArea(Rect position, string text);</pre> <p class="calibre3">The first method creates a <code>TextField</code>, and the second creates a <code>TextArea</code>. In both cases, the <code>string</code> parameter is the text that will be displayed before the user begins editing the text. Note that the method returns a <code>string</code> type. You can get the value of what is entered by the user by assigning the constructed object to a <code>string</code> variable.</p>
<p class="calibre3">For example, the following code will display a <code>TextField</code> and <code>TextArea</code> you can interact with in your scene when it is attached to a GameObject:</p>
<pre class="source-code">
public class Chapter10TextFieldAndArea : MonoBehaviour {
    private string textFieldText = "Enter text";
    private string textAreaText = "Enter text";
    private void OnGUI() {
        textFieldText = GUI.TextField(new Rect(10, 10, 100, 50), textFieldText);
        textAreaText = GUI.TextArea(new Rect(10, 80, 100, 100), textAreaText);
    }
}</pre> <p class="calibre3">The items rendered in the <a id="_idIndexMarker1202" class="pcalibre pcalibre1 calibre6"/>scene appear as follows before the user starts editing the text:</p>
<div><div><img alt="Figure 19.3: Using the IMGUI TextField and TextArea Controls" src="img/B18327_19_03.jpg" class="calibre656"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 19.3: Using the IMGUI TextField and TextArea Controls</p>
<p class="calibre3"><code>Toggle</code>, you call the <code>GUI.Toggle()</code> method. The <code>GUI.Toggle()</code> method has multiple overloads, but the primary ones you<a id="_idIndexMarker1203" class="pcalibre pcalibre1 calibre6"/> will use are the following:</p>
<pre class="source-code">
public static bool Toggle(Rect position, bool value, string text);</pre> <p class="calibre3">Note that the method returns a <code>bool</code> type. You can get the value of the toggle by assigning the created object to a <code>bool</code> variable.</p>
<p class="calibre3">For example, the<a id="_idIndexMarker1204" class="pcalibre pcalibre1 calibre6"/> following code will create a toggle whose value is assigned to a Boolean variable whenever the toggle is clicked. This example, like the other examples, would need to be attached to a GameObject in your scene to render:</p>
<pre class="source-code">
public class Chapter19Toggle : MonoBehaviour {
    private bool toggleBool = true;
    private void OnGUI() {
        toggleBool = GUI.Toggle(new Rect(10, 10, 100, 50), toggleBool,"Toggle Me");
    }
}</pre> <p class="calibre3">The toggle will initially render in the scene as follows until the user interacts with it, in which case the toggle will turn on and off with each click.</p>
<div><div><img alt="Figure 19.4: Using the IMGUI Toggle Control" src="img/B18327_19_04.jpg" class="calibre657"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 19.4: Using the IMGUI Toggle Control</p>
<p class="calibre3">All the examples I have shown were in the scene. However, if you want to display your UI in an Editor window, your code will work similarly. You simply put your code in an <code>EditorWindow</code> inheriting script. (See the example covered in <a href="B18327_18.xhtml#_idTextAnchor481" class="pcalibre pcalibre1 calibre6"><em class="italic">Chapter 18</em></a>.) However, it is slightly different if you want to create IMGUI in your Inspector. Let’s look at that now.</p>
<h1 id="_idParaDest-310" class="calibre5"><a id="_idTextAnchor507" class="pcalibre pcalibre1 calibre6"/>IMGUI in the Inspector</h1>
<p class="calibre3">Using IMGUI to enhance your components works very similarly to the way it does with in-game IMGUI and <code>EditorWindow</code> IMGUI. However, there are some small changes. First, you write scripts that inherit from <code>Editor</code>. Second, you use the <code>OnInspectorGUI()</code> method, not the <code>OnGUI()</code> method. Third, if you want the Inspector to also contain all its usual data, you need to call the <code>DrawDefaultInspector()</code> method within your <code>OnInspectorGUI()</code> method. Lastly, if you want the IMGUI button to <a id="_idIndexMarker1205" class="pcalibre pcalibre1 calibre6"/>appear in line with the various default Inspector elements, you use the <code>GUILayout</code> base class, rather than the <code>GUI</code> base class. So, for example, you wouldn’t create a button with the following code:</p>
<pre class="source-code">
GUI.Button(new Rect(10, 10, 100, 50), "Text Button");</pre> <p class="calibre3">Instead, you’d create it with this:</p>
<pre class="source-code">
GUILayout.Button("Text Button");</pre> <p class="calibre3">Buttons created with <code>GUILayout</code> do not require a rectangular position and will automatically be positioned within the UI.</p>
<p class="calibre3">I will cover an example of this in the <em class="italic">Examples</em> section.</p>
<p class="calibre3">Now, you have enough basic background information to begin developing developer-facing UI with IMGUI. Let’s look at some basic examples to get you started on using the system.</p>
<h1 id="_idParaDest-311" class="calibre5"><a id="_idTextAnchor508" class="pcalibre pcalibre1 calibre6"/>Examples</h1>
<p class="calibre3">For the examples in this chapter, I will cover two types of IMGUI usages: one for an in-game debug menu and another for<a id="_idIndexMarker1206" class="pcalibre pcalibre1 calibre6"/> an Inspector UI. All the examples covered up to this point have all been in-game debug menu UI.</p>
<h2 id="_idParaDest-312" class="calibre7"><a id="_idTextAnchor509" class="pcalibre pcalibre1 calibre6"/>Using IMGUI to show framerate in-game</h2>
<p class="calibre3">Let’s create a very simple script that will show the frame rate of our game in the scene. It will change color if the framerate drops below a certain value.</p>
<p class="calibre3">To display the framerate in your<a id="_idIndexMarker1207" class="pcalibre pcalibre1 calibre6"/> game, complete the following steps:</p>
<ol class="calibre13">
<li class="calibre14">Create a new scene called <code>Chapter19-Examples.unity</code>.</li>
<li class="calibre14">Within the new scene, create a new GameObject called <code>DebugMenu</code>.</li>
<li class="calibre14">Create a new script called <code>DebugFrameRate.cs</code>.</li>
<li class="calibre14">Attach the <code>DebugFrameRate.cs</code> script to your <code>DebugMenu</code> GameObject as a component.</li>
<li class="calibre14">Open the new script and add the following variable declarations:<pre class="source-code">
int fps;
[SerializeField] int fpsThreshold;</pre><p class="calibre3">The <code>fps</code> variable is used to get an estimate of our game’s frame rate, while the <code>fpsThreshold</code> variable is assigned in the Inspector and used to determine the threshold for when our fps will display as red in the scene.</p></li> <li class="calibre14">Create an IMGUI <code>Label</code> that will display the fps with the following code:<pre class="source-code">
private void OnGUI() {
        GUI.Label(new Rect(10, 10, 50, 50), "fps = " + fps.ToString());
}</pre></li> <li class="calibre14">Now, let’s calculate the fps. We can get an estimate of the fps with the following:<pre class="source-code">
private void Update() {
    fps = (int)(1f / Time.unscaledDeltaTime);
}</pre></li> <li class="calibre14">Play your game, and you should see the fps displayed in the scene. If you open the <strong class="bold">Stats</strong> window, you <a id="_idIndexMarker1208" class="pcalibre pcalibre1 calibre6"/>should see that the values are relatively close.
<div><div><img alt="Figure 19.5: The frame rate displaying in-game" src="img/B18327_19_05.jpg" class="calibre658"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 19.5: The frame rate displaying in-game</p>
<p class="calibre3">It’s slightly difficult to see what the value is without pausing the game. So, let’s make it change color when it drops below a certain value. This will make it easier to see when there is a framerate we find worrisome. We’ll use the <code>fpsThreshold</code> value for this. Your game running in your Editor may run at a different framerate than mine, so please use a value that makes sense for your system to be able to see the code execute. I’m going to use <code>1000</code>. Enter the value for your <code>fpsThreshould</code> in the Inspector.</p></li>
</ol>
<ol class="calibre13">
<li value="9" class="calibre14">Now, let’s make it change color when it goes below that threshold. Add the following <code>if</code>/<code>else</code> statement to the top of your <code>OnGUI()</code> method, before the label is created:<pre class="source-code">
if (fps &lt; fpsThreshold) {
    GUI.contentColor = Color.red;
}
else {
    GUI.contentColor = Color.white;
}</pre></li> </ol>
<p class="calibre3">And that’s all you need to have a framerate estimate display in your game.</p>
<p class="calibre3">Displaying a framerate for your game is a great example of something you might want to make with an in-game debug<a id="_idIndexMarker1209" class="pcalibre pcalibre1 calibre6"/> UI. This will let you easily see the general performance of your game, even when you run it outside of the Editor. You could extend this to only appear when you perform specific tasks or only update every second. The possibilities are endless.</p>
<p class="calibre3">There are lots of other reasons you may want to use an in-game debug menu. For example, you might want buttons that call functions that help you skip to sections of your game. Or maybe you want a button that clears your saved data. The important thing to remember about making in-game UI with IMGUI is this should all be to help you, the developer, but should not be used to display information to your player.</p>
<p class="calibre3">Now, let’s look at an example of something you can do in your Editor to assist your development.</p>
<h2 id="_idParaDest-313" class="calibre7"><a id="_idTextAnchor510" class="pcalibre pcalibre1 calibre6"/>Using IMGUI to make an Inspector button that imports data</h2>
<p class="calibre3">Often in game development, you will have data stored in some external source and need to import it into a usable format within <a id="_idIndexMarker1210" class="pcalibre pcalibre1 calibre6"/>your game’s code. For example, you may have a writer on your team who creates all dialogue in an Excel sheet, which you then need to figure out how to import into your game. This example will show a basic example that uses an Inspector button to read text from a file and distribute it to the appropriate place within your game, specifically a ScriptableObject.</p>
<div><div><img alt="Figure 19.6: A custom Inspector with an import button" src="img/B18327_19_06.jpg" class="calibre659"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 19.6: A custom Inspector with an import button</p>
<p class="callout-heading">Note</p>
<p class="callout">We haven’t really discussed ScriptableObjects in this text. A ScriptableObject is essentially a data container within Unity.</p>
<p class="calibre3">To create a button that imports <a id="_idIndexMarker1211" class="pcalibre pcalibre1 calibre6"/>data into your ScriptableObject, complete the following steps:</p>
<ol class="calibre13">
<li class="calibre14">Create a new C# script called <code>DialogueData.cs</code>.</li>
<li class="calibre14">Create a new folder in your <code>Assets</code> folder called <code>Data</code>.</li>
<li class="calibre14">From the code files, find the text file called <code>SampleDialogue.txt</code>. Import it into your <code>Data</code> folder. Alternatively, you can create a text file with at least three lines of text and place it into this folder.</li>
<li class="calibre14">Open your <code>DialogueData.cs</code> script and change it so that it inherits from <code>Monobehavior</code> to <code>ScriptableObject</code>, like so:<pre class="source-code">
public class DialogueData : ScriptableObject {</pre></li> <li class="calibre14">Add the following two lines of code to the class:<pre class="source-code">
public string textPath;
public List&lt;string&gt; importedDialogue;</pre><p class="calibre3">We’ll use the <code>textPath</code> variable to define where the text file being imported is within our project and the <code>importedDialogue</code> variable to hold all the imported dialogue.</p></li> <li class="calibre14">Add the following line<a id="_idIndexMarker1212" class="pcalibre pcalibre1 calibre6"/> above the class definition, to create a menu that makes <code>DialogueData</code> ScriptableObjects:<pre class="source-code">
[CreateAssetMenu(fileName = "New SO", menuName = "DialogueData", order = 1)]</pre></li> <li class="calibre14">Now, return to your Editor and create a new ScriptableObject by right-clicking within your <code>Data</code> folder and selecting <strong class="bold">Create</strong> | <strong class="bold">DialogueData</strong>.
<div><div><img alt="Figure 19.7: Creating the DialogueData ScriptableObject" src="img/B18327_19_07.jpg" class="calibre660"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 19.7: Creating the DialogueData ScriptableObject</p>
<p class="calibre3">This will create a new ScriptableObject called <code>New SO</code> with the following Inspector:</p>
<div><div><img alt="Figure 19.8: The ScriptableObject’s Inspector" src="img/B18327_19_08.jpg" class="calibre661"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 19.8: The ScriptableObject’s Inspector</p></li>
</ol>
<ol class="calibre13">
<li value="8" class="calibre14">Now, let’s customize the Inspector with an import button. Create a new script called <code>DialogueDataCustomEditor.cs</code> and save it in your <code>Editor</code> folder.</li>
<li class="calibre14">Open the script and make it inherit<a id="_idIndexMarker1213" class="pcalibre pcalibre1 calibre6"/> from <code>Editor</code> instead of <code>Monobehavior</code>, like so:<pre class="source-code">
public class DialogueDataCustomEditor : Editor {</pre></li> <li class="calibre14">Make sure to add the following:<pre class="source-code">
using UnityEditor;</pre></li> <li class="calibre14">Now, to let the script know that it is a custom Inspector for the <code>DialogueData</code> class, add the following above the class definition:<pre class="source-code">
[CustomEditor(typeof(DialogueData))]</pre></li> <li class="calibre14">Add the following code to your script to display a button in the Inspector:<pre class="source-code">
public override void OnInspectorGUI()
{
    if (GUI.Button(new Rect(10, 10, 100, 50), "Import Button"))
    {
        // Handle button click logic here
    }
}</pre><p class="calibre3">If you return to your <code>New SO</code>, you’ll see that the Inspector only contains<a id="_idTextAnchor511" class="pcalibre pcalibre1 calibre6"/> a button now.</p></li> </ol>
<div><div><img alt="Figure 19.9: The button in the Inspector" src="img/B18327_19_09.jpg" class="calibre662"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 19.9: The button in the Inspector</p>
<ol class="calibre13">
<li value="13" class="calibre14">It no longer displays all of the data that we want to show in the Inspector. So, add the following, above your button code:<pre class="source-code">
DrawDefaultInspector();</pre></li> <li class="calibre14">It should now draw the <a id="_idIndexMarker1214" class="pcalibre pcalibre1 calibre6"/>button on top of the default Inspector information, which is not what we want.
<div><div><img alt="Figure 19.10: The button in the Inspector over the default information" src="img/B18327_19_10.jpg" class="calibre663"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 19.10: The button in the Inspector over the default information</p>
<p class="calibre3">Edit the button code to the following:</p>
<pre class="source-code">
if (GUILayout.Button("Import Dialogue")) {
}</pre> <p class="calibre3">This will cause the <a id="_idIndexMarker1215" class="pcalibre pcalibre1 calibre6"/>button to display at the bottom of the component, utilizing the layout of the Unity GUI instead of being explicitly positioned.</p>
<div><div><img alt="Figure 19.11: The button using the GUILayout base class" src="img/B18327_19_11.jpg" class="calibre664"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 19.11: The button using the GUILayout base class</p></li>
</ol>
<ol class="calibre13">
<li value="15" class="calibre14">Now, we just need<a id="_idIndexMarker1216" class="pcalibre pcalibre1 calibre6"/> to import the dialogue. Add the following variable declaration to your code:<pre class="source-code">
private string[] splitTags = { "\r\n", "\r", "\n"};</pre><p class="calibre3">We will use this variable to correctly parse the data in the text file, making sure each new line is a new line of dialogue.</p></li> <li class="calibre14">Now, we need to add code that will first get the data from the file and then send it to the ScriptableObject:<pre class="source-code">
private void ReadString() {
    DialogueData dialogueDataScript = (DialogueData)target;
    StreamReader reader = new StreamReader(dialogueDataScript.textPath);
    ParseFile(reader.ReadToEnd());
    reader.Close();
}
private void ParseFile(string theFileText) {
    Debug.Log(theFileText);
    DialogueData dialogueDataScript = (DialogueData)target;
    dialogueDataScript.importedDialogue.Clear();
    string[] lines = theFileText.Split(splitTags, StringSplitOptions.None);
    foreach (var line in lines) {
        dialogueDataScript.importedDialogue.Add(line);
        EditorUtility.SetDirty(target);
    }
}</pre></li> <li class="calibre14">Now, update <a id="_idIndexMarker1217" class="pcalibre pcalibre1 calibre6"/>your <code>OnInspectorGUI()</code> method to call the <code>ReadString()</code> method:<pre class="source-code">
public override void OnInspectorGUI() {
        DrawDefaultInspector();
        if (GUILayout.Button("Import Dialogue")) {
            ReadString();
        }
  }</pre></li> <li class="calibre14">We need to add the location of the <code>SampleDialogue.txt</code> file to our ScriptableObject. Right-click on <code>SampleDialogue.txt</code> and select <strong class="bold">Copy Path</strong>. Paste it into the <strong class="bold">Text </strong><strong class="bold">Path</strong> slot.</li>
</ol>
<div><div><img alt="Figure 19.12: The textPath variable assigned in the Inspector" src="img/B18327_19_12.jpg" class="calibre665"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 19.12: The textPath variable assigned in the Inspector</p>
<ol class="calibre13">
<li value="19" class="calibre14">We should be good to go. Click <a id="_idIndexMarker1218" class="pcalibre pcalibre1 calibre6"/>on the <strong class="bold">Import Dialogue</strong> button and the dialogue will now import. Your Inspector should appear like <em class="italic">Figure 19</em><em class="italic">.6</em>.</li>
</ol>
<p class="calibre3">And that’s it for using IMGUI to create a button within the Editor.</p>
<h1 id="_idParaDest-314" class="calibre5"><a id="_idTextAnchor512" class="pcalibre pcalibre1 calibre6"/>Summary</h1>
<p class="calibre3">In this chapter, we discussed how to use the IMGUI system to build UI for both developers, in-game debug displays as well as Editor extensions. While IMGUI is not necessarily a recommended UI system, it is extremely helpful for creating super-quick tools to assist developers during the development process.</p>
<p class="calibre3">In the next chapter, we will look at the other input system provided by Unity: the New Input System.</p>
</div>
</div></body></html>