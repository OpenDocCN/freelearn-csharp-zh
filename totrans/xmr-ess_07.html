<html><head></head><body><div class="chapter" title="Chapter&#xA0;7.&#xA0;Sharing with MvvmCross"><div class="titlepage"><div><div><h1 class="title"><a id="ch07"/>Chapter 7. Sharing with MvvmCross</h1></div></div></div><p>In the previous chapter, we covered the basic approaches to reusing code across projects and platforms. In this chapter, we will take the next step and look at how the use of design patterns and frameworks can increase the amount of code that can be reused. We will cover the following topics:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">An introduction to MvvmCross</li><li class="listitem" style="list-style-type: disc">The MVVM design pattern</li><li class="listitem" style="list-style-type: disc">Core concepts</li><li class="listitem" style="list-style-type: disc">Views, ViewModels, and commands</li><li class="listitem" style="list-style-type: disc">Data binding</li><li class="listitem" style="list-style-type: disc">Navigation (ViewModel to ViewModel)</li><li class="listitem" style="list-style-type: disc">The project organization</li><li class="listitem" style="list-style-type: disc">The startup process</li><li class="listitem" style="list-style-type: disc">Creating <code class="literal">NationalParks.MvvmCross</code></li></ul></div><p>It's more than a little ambitious to try to cover MvvmCross along with a working example in a single chapter. Our approach will be to introduce the core concepts at a high level and then dive in and create the national parks sample app using MvvmCross. This will give you a basic understanding of how to use the framework and the value associated with its use. With that in mind, let's get started.</p><div class="section" title="Introducing MvvmCross"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec54"/>Introducing MvvmCross</h1></div></div></div><p>MvvmCross is an <a class="indexterm" id="id486"/>open source framework that was created by Stuart Lodge. It is <a class="indexterm" id="id487"/>based on the <span class="strong"><strong>Model-View-ViewModel</strong></span> (<span class="strong"><strong>MVVM</strong></span>) design pattern and is designed to enhance code reuse across numerous platforms, including Xamarin.Android, Xamarin.iOS, Windows Phone, Windows Store, WPF, and Mac OS X. The MvvmCross project is hosted on GitHub and <a class="indexterm" id="id488"/>can be accessed at <a class="ulink" href="https://github.com/MvvmCross/MvvmCross">https://github.com/MvvmCross/MvvmCross</a>.</p><div class="section" title="The MVVM pattern"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec68"/>The MVVM pattern</h2></div></div></div><p>MVVM is a variation of the Model-View-Controller pattern. It separates logic traditionally placed <a class="indexterm" id="id489"/>in a <span class="strong"><strong>View</strong></span> object into two distinct objects, one called <span class="strong"><strong>View</strong></span> and the other <a class="indexterm" id="id490"/>called <span class="strong"><strong>ViewModel</strong></span>. The View is responsible for <a class="indexterm" id="id491"/>providing the user interface and the ViewModel is responsible for the presentation logic. The presentation logic includes transforming data from the Model into a form that is suitable for the user interface to work with and mapping user interaction with the View into requests sent back to the Model. The following diagram depicts how the various objects in MVVM communicate:</p><div class="mediaobject"><img alt="The MVVM pattern" src="graphics/0838OT_07_03.jpg"/></div><p>While MVVM presents a more complex implementation model, there are significant benefits of it, which are as follows:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">ViewModels and their interactions with Models can generally be tested using frameworks (such as NUnit) that are much easier than applications that combine the user interface and presentation layers</li><li class="listitem" style="list-style-type: disc">ViewModels can generally be reused across different user interface technologies and platforms</li></ul></div><p>These factors make <a class="indexterm" id="id492"/>the MVVM approach both flexible and powerful.</p></div><div class="section" title="Views"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec69"/>Views</h2></div></div></div><p>Views in an <a class="indexterm" id="id493"/>MvvmCross app are implemented using platform-specific constructs. For iOS apps, Views are generally implemented as ViewControllers and XIB files. MvvmCross provides a set of base classes, such as <code class="literal">MvxViewContoller</code>, that iOS ViewControllers inherit from. Storyboards can also be used in conjunction with a custom presenter to create Views; we will briefly discuss this option in the section titled <span class="emphasis"><em>Implementing the iOS user interface</em></span> later in this chapter.</p><p>For Android apps, Views are generally implemented as <code class="literal">MvxActivity</code> or <code class="literal">MvxFragment</code> along with their associated layout files.</p></div><div class="section" title="ViewModels"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec70"/>ViewModels</h2></div></div></div><p>ViewModels are classes <a class="indexterm" id="id494"/>that provide data and presentation logic to views in an app. Data is exposed to a View as properties on a ViewModel, and logic that can be invoked from a View is exposed as commands. ViewModels inherit from the <code class="literal">MvxViewModel</code> base class.</p></div><div class="section" title="Commands"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec71"/>Commands</h2></div></div></div><p>Commands are used <a class="indexterm" id="id495"/>in ViewModels to expose logic that can be invoked from the View in response to user interactions. The command architecture is based on the <code class="literal">ICommand</code> interface used in a number of Microsoft frameworks such as <span class="strong"><strong>Windows </strong></span><a class="indexterm" id="id496"/><span class="strong"><strong>Presentation Foundation</strong></span> (<span class="strong"><strong>WPF</strong></span>) and Silverlight. MvvmCross provides <code class="literal">IMvxCommand</code>, which is an extension of <code class="literal">ICommand</code>, along with an implementation named <code class="literal">MvxCommand</code>.</p><p>The commands are generally defined as properties on a ViewModel. For example:</p><div class="informalexample"><pre class="programlisting">public  IMvxCommand ParkSelected { get; protected set; }</pre></div><p>Each command has an action method defined, which implements the logic to be invoked:</p><div class="informalexample"><pre class="programlisting">protected void ParkSelectedExec(NationalPark park)
{
   . . .// logic goes here
}</pre></div><p>The commands must be <a class="indexterm" id="id497"/>initialized and the corresponding action method should be assigned:</p><div class="informalexample"><pre class="programlisting">ParkSelected =
    new MvxCommand&lt;NationalPark&gt; (ParkSelectedExec);</pre></div></div><div class="section" title="Data binding"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec72"/>Data binding</h2></div></div></div><p>Data binding <a class="indexterm" id="id498"/>facilitates communication between the View and the ViewModel by establishing a two-way link that allows data to be exchanged. The data binding capabilities provided by MvvmCross are based on capabilities found in a number of Microsoft XAML-based UI frameworks such as WPF and Silverlight. The basic idea is that you would like to bind a property in a UI control, such as the <span class="strong"><strong>Text</strong></span> property of an <span class="strong"><strong>EditText</strong></span> control in an Android app to a property of a data object such as the <span class="strong"><strong>Description</strong></span> property of <span class="strong"><strong>NationalPark</strong></span>. The following diagram depicts this scenario:</p><div class="mediaobject"><img alt="Data binding" src="graphics/0838OT_07_06.jpg"/></div><div class="section" title="The binding modes"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl3sec43"/>The binding modes</h3></div></div></div><p>There are four <a class="indexterm" id="id499"/>different binding modes that can be used for data binding:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>OneWay binding</strong></span>: This mode tells the data binding framework to transfer values from <a class="indexterm" id="id500"/>the ViewModel to the View and <a class="indexterm" id="id501"/>transfer any updates to properties on the ViewModel to their bound View property.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>OneWayToSource binding</strong></span>: This mode tells the data binding framework to transfer <a class="indexterm" id="id502"/>values from the View to the <a class="indexterm" id="id503"/>ViewModel and transfer updates to View properties to their bound ViewModel property.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>TwoWay binding</strong></span>: This mode tells the data binding framework to transfer values in <a class="indexterm" id="id504"/>both directions between the <a class="indexterm" id="id505"/>ViewModel and View, and updates on either object will cause the other to be updated. This binding mode is useful when values are being edited.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>OneTime binding</strong></span>: This mode tells the data binding framework to transfer values <a class="indexterm" id="id506"/>from ViewModel to View when the binding <a class="indexterm" id="id507"/>is established; in this mode, updates to <a class="indexterm" id="id508"/>ViewModel properties are not monitored by the View.</li></ul></div></div><div class="section" title="The INotifyPropertyChanged interface"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl3sec44"/>The INotifyPropertyChanged interface</h3></div></div></div><p>The <code class="literal">INotifyPropertyChanged</code> interface is an integral part of making data binding work <a class="indexterm" id="id509"/>effectively; it acts as a contract between the source object and the target object. As the name implies, it defines a contract <a class="indexterm" id="id510"/>that allows the source object to notify the target object when data has changed, thus allowing the target to take any necessary actions such as refreshing its display.</p><p>The interface consists of a single event—the <code class="literal">PropertyChanged</code> event—that the target object can subscribe to and that is triggered by the source if a property changes. The following sample demonstrates how to implement <code class="literal">INotifyPropertyChanged</code>:</p><div class="informalexample"><pre class="programlisting">public class NationalPark : INotifyPropertyChanged
{
  public event PropertyChangedEventHandler
     PropertyChanged;
  // rather than use "… code" it is safer to use
  // the comment form 
  string _name;
  public string Name
  {
    get { return _name; }
    set
    {
        if (value.Equals (_name,
            StringComparison.Ordinal))
        {
      // Nothing to do - the value hasn't changed;
      return;
        }
        _name = value;
        OnPropertyChanged();
    }
  }
  . . . 
  void OnPropertyChanged(
    [CallerMemberName] string propertyName = null)
  {
      var handler = PropertyChanged;
  if (handler != null)
  {
      handler(this,
            new PropertyChangedEventArgs(propertyName));
  }
  }
}</pre></div></div><div class="section" title="Binding specifications"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl3sec45"/>Binding specifications</h3></div></div></div><p>Bindings can <a class="indexterm" id="id511"/>be specified in a couple of ways. For Android apps, bindings can be specified in layout files. The following example demonstrates how to bind the <code class="literal">Text</code> property of a <code class="literal">TextView</code> instance to the <code class="literal">Description</code> property in a <code class="literal">NationalPark</code> instance:</p><div class="informalexample"><pre class="programlisting">&lt;TextView
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:id="@+id/descrTextView"
    local:MvxBind="Text Park.Description" /&gt;</pre></div><p>For iOS, binding must be accomplished using the binding API. <code class="literal">CreateBinding()</code> is a method than can be found on <code class="literal">MvxViewController</code>. The following example demonstrates how to bind the <code class="literal">Description</code> property to a <code class="literal">UILabel</code> instance:</p><div class="informalexample"><pre class="programlisting">this.CreateBinding (this.descriptionLabel).
    To ((DetailViewModel vm) =&gt; vm.Park.Description).
    Apply ();</pre></div></div></div><div class="section" title="Navigating between ViewModels"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec73"/>Navigating between ViewModels</h2></div></div></div><p>Navigating <a class="indexterm" id="id512"/>between various screens within an app is an important capability. Within a MvvmCross app, this is implemented at the ViewModel level so that navigation logic can be reused. MvvmCross supports navigation between ViewModels through use of the <code class="literal">ShowViewModel&lt;T&gt;()</code> method inherited from <code class="literal">MvxNavigatingObject</code>, which is the base class for <code class="literal">MvxViewModel</code>. The following example demonstrates how to navigate to <code class="literal">DetailViewModel</code>:</p><div class="informalexample"><pre class="programlisting">ShowViewModel&lt;DetailViewModel&gt;();</pre></div><div class="section" title="Passing parameters"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl3sec46"/>Passing parameters</h3></div></div></div><p>In many <a class="indexterm" id="id513"/>situations, there is a need to pass information to the destination ViewModel. MvvmCross provides a number of ways to accomplish this. The primary method is to create a class that contains simple public properties and passes an instance of the class into <code class="literal">ShowViewModel&lt;T&gt;()</code>. The following example demonstrates how to define and use a <code class="literal">parameters</code> class during navigation:</p><div class="informalexample"><pre class="programlisting">public class DetailParams
{
    public int ParkId { get; set; }
}

// using the parameters class
ShowViewModel&lt;DetailViewModel&gt;(
new DetailViewParam() { ParkId = 0 });</pre></div><p>To receive and use parameters, the destination ViewModel implements an <code class="literal">Init()</code> method that accepts an instance of the <code class="literal">parameters</code> class:</p><div class="informalexample"><pre class="programlisting">public class DetailViewModel : MvxViewModel
{
    . . .
    public void Init(DetailViewParams parameters)
    {
        // use the parameters here . . .
    }
}</pre></div></div><div class="section" title="Solution/project organization"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl3sec47"/>Solution/project organization</h3></div></div></div><p>MvvmCross <a class="indexterm" id="id514"/>solutions are organized in a way that is similar to how we organized the PCL solution in <a class="link" href="ch06.html" title="Chapter 6. The Sharing Game">Chapter 6</a>, <span class="emphasis"><em>The Sharing Game.</em></span> Each MvvmCross solution will have a single core PCL project that houses the reusable code and a series of platform-specific projects that contain the various apps. The following <a class="indexterm" id="id515"/>diagram depicts the general structure:</p><div class="mediaobject"><img alt="Solution/project organization" src="graphics/0838OT_07_05.jpg"/></div></div><div class="section" title="The startup process"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl3sec48"/>The startup process</h3></div></div></div><p>MvvmCross <a class="indexterm" id="id516"/>apps generally follow a standard startup sequence that is initiated by platform-specific code within each app. There are several <a class="indexterm" id="id517"/>classes that collaborate to accomplish the startup; some of these classes reside in the core project and some of them reside in the platform-specific projects. The following sections describe the responsibilities of each of the classes involved.</p><div class="section" title="App.cs"><div class="titlepage"><div><div><h4 class="title"><a id="ch07lvl4sec07"/>App.cs</h4></div></div></div><p>The core <a class="indexterm" id="id518"/>project has an <code class="literal">App</code> class that inherits from <code class="literal">MvxApplication</code>. The <code class="literal">App</code> class contains an override to the <code class="literal">Initialize()</code> method so that at a minimum, it can register the first ViewModel that should be presented when the app starts:</p><div class="informalexample"><pre class="programlisting">RegisterAppStart&lt;ViewModels.MasterViewModel&gt;();</pre></div></div><div class="section" title="Setup.cs"><div class="titlepage"><div><div><h4 class="title"><a id="ch07lvl4sec08"/>Setup.cs</h4></div></div></div><p>Android and iOS projects have a <code class="literal">Setup</code> class that is responsible for creating the <code class="literal">App</code> object from the core project during the startup. This is accomplished by overriding the <code class="literal">CreateApp()</code> method:</p><div class="informalexample"><pre class="programlisting">protected override IMvxApplication CreateApp()
{
    return new Core.App();
}</pre></div><p>For Android apps, <code class="literal">Setup</code> inherits <a class="indexterm" id="id519"/>from <code class="literal">MvxAndroidSetup</code>. For iOS apps, <code class="literal">Setup</code> inherits from <code class="literal">MvxTouchSetup</code>.</p></div><div class="section" title="The Android startup"><div class="titlepage"><div><div><h4 class="title"><a id="ch07lvl4sec09"/>The Android startup</h4></div></div></div><p>Android apps are <a class="indexterm" id="id520"/>kicked off using a special <code class="literal">Activity</code> splash screen that calls the <code class="literal">Setup</code> class and initiates the MvvmCross startup process. This is all done automatically for you; all you need to do is include the splash screen definition and make sure it is marked as the launch activity. The definition is as follows:</p><div class="informalexample"><pre class="programlisting">[Activity(
  Label="NationalParks.Droid", MainLauncher = true,
  Icon="@drawable/icon", Theme="@style/Theme.Splash",
  NoHistory=true,
  ScreenOrientation = ScreenOrientation.Portrait)]
public class SplashScreen : MvxSplashScreenActivity
{
    public SplashScreen():base(Resource.Layout.SplashScreen)
    {
    }
}</pre></div></div><div class="section" title="The iOS startup"><div class="titlepage"><div><div><h4 class="title"><a id="ch07lvl4sec10"/>The iOS startup</h4></div></div></div><p>The iOS app startup is <a class="indexterm" id="id521"/>slightly less automated and is initiated from within the <code class="literal">FinishedLaunching()</code> method of <code class="literal">AppDelegate</code>:</p><div class="informalexample"><pre class="programlisting">public override bool FinishedLaunching (
    UIApplication app, NSDictionary options)
{
    _window = new UIWindow (UIScreen.MainScreen.Bounds);

    var setup = new Setup(this, _window);
    setup.Initialize();
    var startup = Mvx.Resolve&lt;IMvxAppStart&gt;();
    startup.Start();

    _window.MakeKeyAndVisible ();

    return true;
}</pre></div></div></div></div></div></div>
<div class="section" title="Creating NationalParks.MvvmCross"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec55"/>Creating NationalParks.MvvmCross</h1></div></div></div><p>Now that we have basic knowledge of the MvvmCross framework, let's put that knowledge to work and convert the <code class="literal">NationalParks</code> app to leverage the capabilities we just learned.</p><div class="section" title="Creating the MvvmCross core project"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec74"/>Creating the MvvmCross core project</h2></div></div></div><p>We <a class="indexterm" id="id522"/>will start by creating the <a class="indexterm" id="id523"/>core project. This project will contain all the code that will be shared between the iOS and Android app primarily in the form of ViewModels. The core project will be built as a Portable Class Library.</p><p>To create <code class="literal">NationalParks.Core</code>, perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">From the main menu, navigate to <span class="strong"><strong>File</strong></span> | <span class="strong"><strong>New Solution</strong></span>.</li><li class="listitem">From the <span class="strong"><strong>New Solution</strong></span> dialog box, navigate to <span class="strong"><strong>C#</strong></span> | <span class="strong"><strong>Portable Library</strong></span>, enter <code class="literal">NationalParks.Core</code> for the project <span class="strong"><strong>Name</strong></span> field, enter <code class="literal">NationalParks.MvvmCross</code> for the <span class="strong"><strong>Solution</strong></span> field, and click on <span class="strong"><strong>OK</strong></span>.</li><li class="listitem">Add the MvvmCross starter package to the project from NuGet. Select the <code class="literal">NationalParks.Core</code> project and navigate to <span class="strong"><strong>Project</strong></span> | <span class="strong"><strong>Add Packages</strong></span> from the main menu. Enter <code class="literal">MvvmCross starter</code> in the search field.</li><li class="listitem">Select the <span class="strong"><strong>MvvmCross – Hot Tuna Starter Pack</strong></span> entry and click on <span class="strong"><strong>Add Package</strong></span>.<div class="mediaobject"><img alt="Creating the MvvmCross core project" src="graphics/0838OT_07_01.jpg"/></div></li><li class="listitem">A number of things were added to <code class="literal">NationalParks.Core</code> as a result of adding the package, and they are as follows:<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">A <code class="literal">packages.config</code> file, which contains a list of libraries (<code class="literal">dlls</code>) associated with the MvvmCross starter kit package. These entries are links to actual libraries in the <code class="literal">Packages</code> folder of the overall solution.</li><li class="listitem" style="list-style-type: disc">A <code class="literal">ViewModels</code> folder with a sample ViewModel named <code class="literal">FirstViewModel</code>.</li><li class="listitem" style="list-style-type: disc">An <code class="literal">App</code> class in <code class="literal">App.cs</code>, which contains an <code class="literal">Initialize()</code> method <a class="indexterm" id="id524"/>that starts the MvvmCross app by calling <code class="literal">RegisterAppStart()</code> to start <code class="literal">FirstViewModel</code>. We will eventually be changing this to start the <code class="literal">MasterViewModel</code> class, which <a class="indexterm" id="id525"/>will be associated with a View that lists national parks.</li></ul></div></li></ol></div></div><div class="section" title="Creating the MvvmCross Android app"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec75"/>Creating the MvvmCross Android app</h2></div></div></div><p>The <a class="indexterm" id="id526"/>next step is to create an <a class="indexterm" id="id527"/>Android app project in the same solution.</p><p>To create <a class="indexterm" id="id528"/><code class="literal">NationalParks.Droid</code>, complete the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Select the <code class="literal">NationalParks.MvvmCross</code> solution, right-click on it, and navigate to <span class="strong"><strong>Add</strong></span> | <span class="strong"><strong>New Project</strong></span>.</li><li class="listitem">From the <span class="strong"><strong>New Project</strong></span> dialog box, navigate to <span class="strong"><strong>C#</strong></span> | <span class="strong"><strong>Android</strong></span> | <span class="strong"><strong>Android Application</strong></span>, enter <code class="literal">NationalParks.Droid</code> for the <span class="strong"><strong>Name</strong></span> field, and click on <span class="strong"><strong>OK</strong></span>.</li><li class="listitem">Add the MvvmCross starter kit package to the new project by selecting <code class="literal">NationalParks.Droid</code> and navigating to <span class="strong"><strong>Project</strong></span> | <span class="strong"><strong>Add Packages</strong></span> from the main menu.</li><li class="listitem">A number of things were added to <code class="literal">NationalParks.Droid</code> as a result of adding the package, which are as follows:<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">packages.config</code>: This file contains a list of libraries (<code class="literal">dlls</code>) associated with the MvvmCross starter kit package. These entries are links to an actual library in the <code class="literal">Packages</code> folder of the overall solution, which contains the actual downloaded libraries.</li><li class="listitem" style="list-style-type: disc"><code class="literal">FirstView</code> : This class is present in the <code class="literal">Views</code> folder, which corresponds to <code class="literal">FirstViewModel</code>, which was created in <code class="literal">NationalParks.Core</code>.</li><li class="listitem" style="list-style-type: disc"><code class="literal">FirstView</code>: This layout is present in <code class="literal">Resources\layout</code>, which is used by the <code class="literal">FirstView</code> activity. This is a traditional Android layout file with the exception that it contains binding declarations in the <code class="literal">EditView</code> and <code class="literal">TextView</code> elements.</li><li class="listitem" style="list-style-type: disc"><code class="literal">Setup</code>: This <a class="indexterm" id="id529"/>file inherits from <code class="literal">MvxAndroidSetup</code>. This class is responsible for creating an instance of the <code class="literal">App</code> class from the core project, which in turn displays the first ViewModel via a call to <code class="literal">RegisterAppStart()</code>.</li><li class="listitem" style="list-style-type: disc"><code class="literal">SplashScreen</code>: This class inherits from <code class="literal">MvxSplashScreenActivity</code>. The <code class="literal">SplashScreen</code> class is marked as the main launcher activity and thus initializes the <code class="literal">MvvmCross</code> app with a call to <code class="literal">Setup.Initialize()</code>.</li></ul></div></li><li class="listitem">Add a reference to <code class="literal">NationalParks.Core</code> by selecting the <code class="literal">References</code> folder, right-click on it, select <span class="strong"><strong>Edit References</strong></span>, select the <span class="strong"><strong>Projects</strong></span> tab, check <code class="literal">NationalParks.Core</code>, and click on <span class="strong"><strong>OK</strong></span>.</li><li class="listitem">Remove <code class="literal">MainActivity.cs</code> as it is no longer needed and will create a build error. This <a class="indexterm" id="id530"/>is because it is marked as the main launch and so is the new <code class="literal">SplashScreen</code> class. Also, remove the corresponding <code class="literal">Resources\layout\main.axml</code> layout file.</li><li class="listitem">Run <a class="indexterm" id="id531"/>the app. The app will present <code class="literal">FirstViewModel</code>, which is linked to the corresponding <code class="literal">FirstView</code> instance with an <code class="literal">EditView</code> class, and <code class="literal">TextView</code> presents the same <span class="strong"><strong>Hello MvvmCross</strong></span> text. As you edit the text in the <code class="literal">EditView</code> class, the <code class="literal">TextView</code> class is automatically updated by means of data binding. The following screenshot depicts what you should see:<div class="mediaobject"><img alt="Creating the MvvmCross Android app" src="graphics/0838OT_07_08.jpg"/></div></li></ol></div><div class="section" title="Reusing NationalParks.PortableData and NationalParks.IO"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl3sec49"/>Reusing NationalParks.PortableData and NationalParks.IO</h3></div></div></div><p>Before <a class="indexterm" id="id532"/>we start creating the Views and ViewModels for our app, we first need to bring in some code from <a class="indexterm" id="id533"/>our previous efforts that can be <a class="indexterm" id="id534"/>used to maintain parks. For this, we will simply reuse the <code class="literal">NationalParksData</code> singleton and the <code class="literal">FileHandler</code> classes that were created previously.</p><p>To reuse the <a class="indexterm" id="id535"/><code class="literal">NationalParksData</code> singleton and <code class="literal">FileHandler</code> classes, complete the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Copy <code class="literal">NationalParks.PortableData</code> and <code class="literal">NationalParks.IO</code> from the solution created in <a class="link" href="ch06.html" title="Chapter 6. The Sharing Game">Chapter 6</a>, <span class="emphasis"><em>The Sharing Game</em></span>, to the <code class="literal">NationalParks.MvvmCross</code> solution folder.</li><li class="listitem">Add a reference to <code class="literal">NationalParks.PortableData</code> in the <code class="literal">NationalParks.Droid</code> project.</li><li class="listitem">Create a folder named <code class="literal">NationalParks.IO</code> in the <code class="literal">NationalParks.Droid</code> project and add a link to <code class="literal">FileHandler.cs</code> from the <code class="literal">NationalParks.IO</code> project. Recall <a class="indexterm" id="id536"/>that the <code class="literal">FileHandler</code> class <a class="indexterm" id="id537"/>cannot be contained in the Portable Class Library because it uses file IO APIs that cannot be references from a Portable Class Library.</li><li class="listitem">Compile the project. The project should compile cleanly now.</li></ol></div><div class="section" title="Implementing the INotifyPropertyChanged interface"><div class="titlepage"><div><div><h4 class="title"><a id="ch07lvl4sec11"/>Implementing the INotifyPropertyChanged interface</h4></div></div></div><p>We will be using data binding to bind UI controls to the <code class="literal">NationalPark</code> object and thus, we need to implement the <code class="literal">INotifyPropertyChanged</code> interface. This ensures that changes made to properties of a park are reported to the appropriate UI controls.</p><p>To <a class="indexterm" id="id538"/>implement <code class="literal">INotifyPropertyChanged</code>, complete the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open <a class="indexterm" id="id539"/><code class="literal">NationalPark.cs</code> in the <code class="literal">NationalParks.PortableData</code> project.</li><li class="listitem">Specify that the <code class="literal">NationalPark</code> class implements <code class="literal">INotifyPropertyChanged</code> interface.</li><li class="listitem">Select the <code class="literal">INotifyPropertyChanged</code> interface, right-click on it, navigate to <span class="strong"><strong>Refactor</strong></span> | <span class="strong"><strong>Implement interface</strong></span>, and press <span class="emphasis"><em>Enter</em></span>. Enter the following code snippet:<div class="informalexample"><pre class="programlisting">public class NationalPark : INotifyPropertyChanged
{
    public event PropertyChangedEventHandler
        PropertyChanged;
    . . .
}</pre></div></li><li class="listitem">Add an <code class="literal">OnPropertyChanged()</code> method that can be called from each property setter method:<div class="informalexample"><pre class="programlisting">void OnPropertyChanged(
    [CallerMemberName] string propertyName = null)
{
    var handler = PropertyChanged;
    if (handler != null)
    {
        handler(this,
            new PropertyChangedEventArgs(propertyName));
    }
}</pre></div></li><li class="listitem">Update each property definition to call the setter in the same way as it is depicted for the <code class="literal">Name</code> property:<div class="informalexample"><pre class="programlisting">string _name;
public string Name
{
  get { return _name; }
  set
  {
    if (value.Equals (_name, StringComparison.Ordinal))
    {
      // Nothing to do - the value hasn't changed;
  return;
    }
    _name = value;
    OnPropertyChanged();
  }
}</pre></div></li><li class="listitem">Compile <a class="indexterm" id="id540"/>the project. The <a class="indexterm" id="id541"/>project should compile cleanly. We are now ready to use the <code class="literal">NationalParksData</code> singleton in our new project, and it supports data binding.</li></ol></div></div></div><div class="section" title="Implementing the Android user interface"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl3sec50"/>Implementing the Android user interface</h3></div></div></div><p>Now, we are ready to create the Views and ViewModels required for our app. The app we are <a class="indexterm" id="id542"/>creating will <a class="indexterm" id="id543"/>follow the same flow that was used in previous chapters:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">A master list view to view national parks</li><li class="listitem" style="list-style-type: disc">A detail view to view details of a specific park</li><li class="listitem" style="list-style-type: disc">An edit view to edit a new or previously existing park</li></ul></div><p>The process for creating views and ViewModels in an Android app generally consists of three different steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Create a ViewModel in the core project with the data and event handlers (commands) required to support the View.</li><li class="listitem">Create an Android layout with visual elements and data binding specifications.</li><li class="listitem">Create an Android activity, which corresponds to the ViewModel and displays the layout.</li></ol></div><p>In our case, this process will be slightly different because we will reuse some of our previous work, specifically, the layout files and the menu definitions.</p><p>To reuse <a class="indexterm" id="id544"/>layout files and menu definitions, perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Copy <code class="literal">Master.axml</code>, <code class="literal">Detail.axml</code>, and <code class="literal">Edit.axml</code> from the <code class="literal">Resources\layout</code> folder of the solution created in <a class="link" href="ch05.html" title="Chapter 5. Developing Your First Android App with Xamarin.Android">Chapter 5</a>, <span class="emphasis"><em>Developing Your First Android App with Xamarin.Android</em></span>, to the <code class="literal">Resources\layout</code> folder in the <code class="literal">NationalParks.Droid</code> project, and add them to the project by selecting the layout folder and navigating to <span class="strong"><strong>Add</strong></span> | <span class="strong"><strong>Add Files</strong></span>.</li><li class="listitem">Copy <code class="literal">MasterMenu.xml</code>, <code class="literal">DetailMenu.xml</code>, and <code class="literal">EditMenu.xml</code> from the <code class="literal">Resources\menu</code> folder of the solution created in <a class="link" href="ch05.html" title="Chapter 5. Developing Your First Android App with Xamarin.Android">Chapter 5</a>, <span class="emphasis"><em>Developing Your First Android App with Xamarin.Android</em></span>, to the <code class="literal">Resources\menu</code> folder in the <code class="literal">NationalParks.Droid</code> project, and add them to the project by selecting <a class="indexterm" id="id545"/>the <code class="literal">menu</code> folder and navigating to <span class="strong"><strong>Add</strong></span> | <span class="strong"><strong>Add Files</strong></span>.</li></ol></div></div><div class="section" title="Implementing the master list view"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl3sec51"/>Implementing the master list view</h3></div></div></div><p>We <a class="indexterm" id="id546"/>are now ready to implement <a class="indexterm" id="id547"/>the first of our View/ViewModel combinations, which is the master list view.</p><div class="section" title="Creating MasterViewModel"><div class="titlepage"><div><div><h4 class="title"><a id="ch07lvl4sec12"/>Creating MasterViewModel</h4></div></div></div><p>The first step is to create a ViewModel and add a property that <a class="indexterm" id="id548"/>will provide data to the list view that displays <a class="indexterm" id="id549"/>national parks along with some initialization code.</p><p>To create <code class="literal">MasterViewModel</code>, complete the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Select the <code class="literal">ViewModels</code> folder in <code class="literal">NationalParks.Core</code>, right-click on it, and navigate to <span class="strong"><strong>Add</strong></span> | <span class="strong"><strong>New File</strong></span>.</li><li class="listitem">In the <span class="strong"><strong>New File</strong></span> dialog box, navigate to <span class="strong"><strong>General</strong></span> | <span class="strong"><strong>Empty Class</strong></span>, enter <code class="literal">MasterViewModel</code> for the <span class="strong"><strong>Name</strong></span> field, and click on <span class="strong"><strong>New</strong></span>.</li><li class="listitem">Modify the class definition so that <code class="literal">MasterViewModel</code> inherits from <code class="literal">MvxViewModel</code>; you will also need to add a few <code class="literal">using</code> directives:<div class="informalexample"><pre class="programlisting">. . .
using Cirrious.CrossCore.Platform;
using Cirrious.MvvmCross.ViewModels;
. . .
namespace NationalParks.Core.ViewModels
{
  public class MasterViewModel : MvxViewModel
  {
         . . .
   }
}</pre></div></li><li class="listitem">Add a <a class="indexterm" id="id550"/>property that is a list of <code class="literal">NationalPark</code> elements to <code class="literal">MasterViewModel</code>. This property will later be data-bound to a list view:<div class="informalexample"><pre class="programlisting">private List&lt;NationalPark&gt; _parks;
public List&lt;NationalPark&gt; Parks
{
    get { return _parks; }
    set { _parks = value;
          RaisePropertyChanged(() =&gt; Parks);
    }
 }</pre></div></li><li class="listitem">Override the <code class="literal">Start()</code> method on <code class="literal">MasterViewModel</code> to load the <code class="literal">_parks</code> collection with data from the <code class="literal">NationalParksData</code> singleton. You will need to <a class="indexterm" id="id551"/>add a <code class="literal">using</code> directive for the <a class="indexterm" id="id552"/><code class="literal">NationalParks.PortableData</code> namespace again:<div class="informalexample"><pre class="programlisting">. . .
using NationalParks.PortableData;
. . .
public async override void Start ()
{
    base.Start ();
    await NationalParksData.Instance.Load ();
    Parks = new List&lt;NationalPark&gt; (
        NationalParksData.Instance.Parks);
}</pre></div></li><li class="listitem">We <a class="indexterm" id="id553"/>now need to modify the app startup sequence so that <code class="literal">MasterViewModel</code> is the first ViewModel <a class="indexterm" id="id554"/>that's started. Open <code class="literal">App.cs</code> in <code class="literal">NationalParks.Core</code> and change the call to <code class="literal">RegisterAppStart()</code> to reference <a class="indexterm" id="id555"/><code class="literal">MasterViewModel</code>:<div class="informalexample"><pre class="programlisting">RegisterAppStart&lt;ViewModels.MasterViewModel&gt;();</pre></div></li></ol></div></div><div class="section" title="Updating the Master.axml layout"><div class="titlepage"><div><div><h4 class="title"><a id="ch07lvl4sec13"/>Updating the Master.axml layout</h4></div></div></div><p>Update <a class="indexterm" id="id556"/><code class="literal">Master.axml</code> so that it can leverage the data binding capabilities provided by MvvmCross.</p><p>To update <code class="literal">Master.axml</code>, complete the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open <a class="indexterm" id="id557"/><code class="literal">Master.axml</code> and add a namespace definition to the top of the XML to include the <code class="literal">NationalParks.Droid</code> namespace:<div class="informalexample"><pre class="programlisting"/></div><p>This namespace definition is required in order to allow Android to resolve the MvvmCross-specific elements that will be specified.</p></li><li class="listitem">Change the <code class="literal">ListView</code> element to a <code class="literal">Mvx.MvxListView</code> element:<div class="informalexample"><pre class="programlisting">&lt;Mvx.MvxListView
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:id="@+id/parksListView" /&gt;</pre></div></li><li class="listitem">Add a data binding specification to the <code class="literal">MvxListView</code> element, binding the <code class="literal">ItemsSource</code> property of the list view to the <code class="literal">Parks</code> property of <code class="literal">MasterViewModel</code>, as follows:<div class="informalexample"><pre class="programlisting">    . . .
    android:id="@+id/parksListView"
    local:MvxBind="ItemsSource Parks" /&gt;</pre></div></li><li class="listitem">Add a list item template attribute to the element definition. This layout controls the content of each item that will be displayed in the list view:<div class="informalexample"><pre class="programlisting">local:MvxItemTemplate="@layout/nationalparkitem"</pre></div></li><li class="listitem">Create the <code class="literal">NationalParkItem</code> layout and provide <code class="literal">TextView</code> elements to display both the name and description of a park, as follows:<div class="informalexample"><pre class="programlisting">&lt;LinearLayout 
  
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"&gt;
    &lt;TextView
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:textSize="40sp"/&gt;
    &lt;TextView
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:textSize="20sp"/&gt;
&lt;/LinearLayout&gt;</pre></div></li><li class="listitem">Add <a class="indexterm" id="id558"/>data binding <a class="indexterm" id="id559"/>specifications to each of the TextView elements:<div class="informalexample"><pre class="programlisting">. . .
        local:MvxBind="Text Name" /&gt;
. . .
        local:MvxBind="Text Description" /&gt;
. . .</pre></div><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note14"/>Note</h3><p>Note that in this case, the context for data binding is an instance of an item in the collection that was bound to <code class="literal">MvxListView</code>, for this example, an instance of <code class="literal">NationalPark</code>.</p></div></div></li></ol></div></div><div class="section" title="Creating the MasterView activity"><div class="titlepage"><div><div><h4 class="title"><a id="ch07lvl4sec14"/>Creating the MasterView activity</h4></div></div></div><p>Next, create <a class="indexterm" id="id560"/><code class="literal">MasterView</code>, which is an <code class="literal">MvxActivity</code> instance that corresponds with <code class="literal">MasterViewModel</code>.</p><p>To <a class="indexterm" id="id561"/>create <code class="literal">MasterView</code>, complete the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Select the <code class="literal">ViewModels</code> folder in <code class="literal">NationalParks.Core</code>, right-click on it, navigate to <span class="strong"><strong>Add</strong></span> | <span class="strong"><strong>New File</strong></span>.</li><li class="listitem">In the <span class="strong"><strong>New File</strong></span> dialog, navigate to <span class="strong"><strong>Android</strong></span> | <span class="strong"><strong>Activity</strong></span>, enter <code class="literal">MasterView</code> in the <span class="strong"><strong>Name</strong></span> field, and select <span class="strong"><strong>New</strong></span>.</li><li class="listitem">Modify the class specification so that it inherits from <code class="literal">MvxActivity</code>; you will also need to add a few <code class="literal">using</code> directives as follows:<div class="informalexample"><pre class="programlisting">using Cirrious.MvvmCross.Droid.Views;
using NationalParks.Core.ViewModels;
. . .
namespace NationalParks.Droid.Views
{
    [Activity(Label = "Parks")]
    public class MasterView : MvxActivity
    {
        . . .
    }
}</pre></div></li><li class="listitem">Open <code class="literal">Setup.cs</code> and add code to initialize the file handler and path for the <a class="indexterm" id="id562"/><code class="literal">NationalParksData</code> singleton to the <code class="literal">CreateApp()</code> method, as follows:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>protected override IMvxApplication CreateApp()</strong></span>
<span class="strong"><strong>{</strong></span>
<span class="strong"><strong>    NationalParksData.Instance.FileHandler =</strong></span>
<span class="strong"><strong>       new FileHandler ();</strong></span>
<span class="strong"><strong>    NationalParksData.Instance.DataDir =</strong></span>
<span class="strong"><strong>       System.Environment.GetFolderPath(</strong></span>
<span class="strong"><strong>          System.Environment.SpecialFolder.MyDocuments);</strong></span>
<span class="strong"><strong>    return new Core.App();</strong></span>
<span class="strong"><strong>}</strong></span>
</pre></div></li><li class="listitem">Compile and run the app; you will need to copy the <code class="literal">NationalParks.json</code> file to the device or emulator using the Android Device <a class="indexterm" id="id563"/>Monitor. All the parks in <code class="literal">NationalParks.json</code> should be displayed.</li></ol></div></div></div><div class="section" title="Implementing the detail view"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl3sec52"/>Implementing the detail view</h3></div></div></div><p>Now <a class="indexterm" id="id564"/>that we have the master list <a class="indexterm" id="id565"/>view displaying national parks, we can focus on creating the detail view. We will follow the same steps for the detail view as the ones we just completed for the master view.</p><div class="section" title="Creating DetailViewModel"><div class="titlepage"><div><div><h4 class="title"><a id="ch07lvl4sec15"/>Creating DetailViewModel</h4></div></div></div><p>We start <a class="indexterm" id="id566"/>creating <code class="literal">DetailViewModel</code> by using the <a class="indexterm" id="id567"/>following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Following the same procedure as the one that was used to create <code class="literal">MasterViewModel</code>, create a new ViewModel named <code class="literal">DetailViewModel</code> in the <code class="literal">ViewModel</code> folder of <code class="literal">NationalParks.Core</code>.</li><li class="listitem">Add a <code class="literal">NationalPark</code> property to support data binding for the view controls, as follows:<div class="informalexample"><pre class="programlisting">protected NationalPark _park;
public NationalPark Park
{ 
    get { return _park; }
    set { _park = value;
          RaisePropertyChanged(() =&gt; Park);
     }
}</pre></div></li><li class="listitem">Create a <code class="literal">Parameters</code> class that can be used to pass a park ID for the park that should be displayed. It's convenient to create this class within the class definition of the ViewModel that the parameters are for:<div class="informalexample"><pre class="programlisting">public class DetailViewModel : MvxViewModel
{
    public class Parameters
    {
        public string ParkId { get; set; }
    }
    . . .</pre></div></li><li class="listitem">Implement an <code class="literal">Init()</code> method that will accept an instance of the <code class="literal">Parameters</code> class and get the corresponding national park from <code class="literal">NationalParkData</code>:<div class="informalexample"><pre class="programlisting">public void Init(Parameters parameters)
{
    Park = NationalParksData.Instance.Parks.
        FirstOrDefault(x =&gt; x.Id == parameters.ParkId);
}</pre></div></li></ol></div></div><div class="section" title="Updating the Detail.axml layout"><div class="titlepage"><div><div><h4 class="title"><a id="ch07lvl4sec16"/>Updating the Detail.axml layout</h4></div></div></div><p>Next, we will update the layout file. The main changes that need to be made are to add data binding specifications to the layout file.</p><p>To update <a class="indexterm" id="id568"/>the <code class="literal">Detail.axml</code> layout, perform <a class="indexterm" id="id569"/>the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open <code class="literal">Detail.axml</code> and add the project namespace to the XML file:<div class="informalexample"><pre class="programlisting"/></div></li><li class="listitem">Add data binding specifications to each of the <code class="literal">TextView</code> elements that correspond to a national park property, as demonstrated for the park name:<div class="informalexample"><pre class="programlisting">&lt;TextView
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:id="@+id/nameTextView"
    local:MvxBind="Text Park.Name" /&gt;</pre></div></li></ol></div></div><div class="section" title="Creating the DetailView activity"><div class="titlepage"><div><div><h4 class="title"><a id="ch07lvl4sec17"/>Creating the DetailView activity</h4></div></div></div><p>Now, create the <code class="literal">MvxActivity</code> instance that will work with <code class="literal">DetailViewModel</code>.</p><p>To <a class="indexterm" id="id570"/>create <code class="literal">DetailView</code>, perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Following <a class="indexterm" id="id571"/>the same procedure as the one that was used to create <code class="literal">MasterView</code>, create a new view named <code class="literal">DetailView</code> in the <code class="literal">Views</code> folder of <code class="literal">NationalParks.Droid</code>.</li><li class="listitem">Implement the <code class="literal">OnCreateOptionsMenu()</code> and <code class="literal">OnOptionsItemSelected()</code> methods so that our menus will be accessible. Copy the implementation of these methods from the solution created in <a class="link" href="ch06.html" title="Chapter 6. The Sharing Game">Chapter 6</a>, <span class="emphasis"><em>The Sharing Game</em></span>. Comment out the section in <code class="literal">OnOptionsItemSelect()</code> related to the <code class="literal">Edit</code> action for now; we will fill that in once the edit view is completed.</li></ol></div></div><div class="section" title="Adding navigation"><div class="titlepage"><div><div><h4 class="title"><a id="ch07lvl4sec18"/>Adding navigation</h4></div></div></div><p>The last <a class="indexterm" id="id572"/>step is to add navigation so that when an item is clicked on in <code class="literal">MvxListView</code> on <code class="literal">MasterView</code>, the park is displayed in the detail view. We will accomplish this using a <code class="literal">command</code> property and data binding.</p><p>To add navigation, perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open <code class="literal">MasterViewModel</code> and add an <code class="literal">IMvxCommand</code> property; this will be used to handle a park that is being selected:<div class="informalexample"><pre class="programlisting">protected IMvxCommand ParkSelected { get; protected set; }</pre></div></li><li class="listitem">Create an <code class="literal">Action</code> delegate that will be called when the <code class="literal">ParkSelected</code> command is executed, as follows:<div class="informalexample"><pre class="programlisting">protected void ParkSelectedExec(NationalPark park)
{
    ShowViewModel&lt;DetailViewModel&gt; (
        new DetailViewModel.Parameters ()
            { ParkId = park.Id });
}</pre></div></li><li class="listitem">Initialize the <code class="literal">command</code> property in the constructor of <code class="literal">MasterViewModel</code>:<div class="informalexample"><pre class="programlisting">ParkClicked =
    new MvxCommand&lt;NationalPark&gt; (ParkSelectedExec);</pre></div></li><li class="listitem">Now, for the last step, add a data binding specification to <code class="literal">MvvListView</code> in <code class="literal">Master.axml</code> to bind the <code class="literal">ItemClick</code> event to the <code class="literal">ParkClicked</code> command on <code class="literal">MasterViewModel</code>, which we just created:<div class="informalexample"><pre class="programlisting">local:MvxBind="ItemsSource Parks; ItemClick ParkClicked"</pre></div></li><li class="listitem">Compile and run the app. Clicking on a park in the list view should now navigate <a class="indexterm" id="id573"/>to the detail view, displaying the selected park.</li></ol></div></div></div><div class="section" title="Implementing the edit view"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl3sec53"/>Implementing the edit view</h3></div></div></div><p>We are <a class="indexterm" id="id574"/>now almost experts at implementing <a class="indexterm" id="id575"/>new Views and ViewModels. One last View to go is the edit view.</p><div class="section" title="Creating EditViewModel"><div class="titlepage"><div><div><h4 class="title"><a id="ch07lvl4sec19"/>Creating EditViewModel</h4></div></div></div><p>Like we <a class="indexterm" id="id576"/>did previously, we start with the ViewModel.</p><p>To <a class="indexterm" id="id577"/>create <code class="literal">EditViewModel</code>, complete the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Following the same process that was previously used in this chapter to create <code class="literal">EditViewModel</code>, add a data binding property and create a <code class="literal">Parameters</code> class for navigation.</li><li class="listitem">Implement an <code class="literal">Init()</code> method that will accept an instance of the <code class="literal">Parameters</code> class and get the corresponding national park from <code class="literal">NationalParkData</code> in the case of editing an existing park or create a new instance <a class="indexterm" id="id578"/>if the user has chosen the <code class="literal">New</code> action. Inspect <a class="indexterm" id="id579"/>the parameters passed in to determine what the intent is:<div class="informalexample"><pre class="programlisting">public void Init(Parameters parameters)
{
    if (string.IsNullOrEmpty (parameters.ParkId))
        Park = new NationalPark ();
    else
        Park =
            NationalParksData.Instance.
            Parks.FirstOrDefault(
            x =&gt; x.Id == parameters.ParkId);
}</pre></div></li></ol></div></div><div class="section" title="Updating the Edit.axml layout"><div class="titlepage"><div><div><h4 class="title"><a id="ch07lvl4sec20"/>Updating the Edit.axml layout</h4></div></div></div><p>Update <code class="literal">Edit.axml</code> to provide data binding specifications.</p><p>To <a class="indexterm" id="id580"/>update the <code class="literal">Edit.axml</code> layout, you first need to open <code class="literal">Edit.axml</code> and add the project namespace to the XML file. Then, add the data binding specifications to each of the <code class="literal">EditView</code> elements that correspond to a national park <a class="indexterm" id="id581"/>property.</p></div><div class="section" title="Creating the EditView activity"><div class="titlepage"><div><div><h4 class="title"><a id="ch07lvl4sec21"/>Creating the EditView activity</h4></div></div></div><p>Create <a class="indexterm" id="id582"/>a new <code class="literal">MvxActivity</code> instance named <code class="literal">EditView</code> to will work with <code class="literal">EditViewModel</code>.</p><p>To create <a class="indexterm" id="id583"/><code class="literal">EditView</code>, perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Following the same procedure as the one that was used to create <code class="literal">DetailView</code>, create a new View named <code class="literal">EditView</code> in the <code class="literal">Views</code> folder of <code class="literal">NationalParks.Droid</code>.</li><li class="listitem">Implement the <code class="literal">OnCreateOptionsMenu()</code> and <code class="literal">OnOptionsItemSelected()</code> methods so that the <code class="literal">Done</code> action will accessible from the ActionBar. You can copy the implementation of these methods from the solution created in <a class="link" href="ch06.html" title="Chapter 6. The Sharing Game">Chapter 6</a>, <span class="emphasis"><em>The Sharing Game</em></span>. Change the implementation of <code class="literal">Done</code> to call the <code class="literal">Done</code> command on <code class="literal">EditViewModel</code>.</li></ol></div></div><div class="section" title="Adding navigation"><div class="titlepage"><div><div><h4 class="title"><a id="ch07lvl4sec22"/>Adding navigation</h4></div></div></div><p>Add <a class="indexterm" id="id584"/>navigation to two places: when New (<span class="strong"><strong>+</strong></span>) is clicked from <code class="literal">MasterView</code> and when <span class="strong"><strong>Edit</strong></span> is clicked in <code class="literal">DetailView</code>. Let's start with MasterView.</p><p>To add <a class="indexterm" id="id585"/>navigation from <code class="literal">MasterViewModel</code>, complete the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open <code class="literal">MasterViewModel.cs</code> and add a <code class="literal">NewParkClicked</code> command property along with the handler for the command. Be sure to initialize the command in the constructor, as follows:<div class="informalexample"><pre class="programlisting">protected IMvxCommand NewParkClicked { get; set; }
protected void NewParkClickedExec()
{
  ShowViewModel&lt;EditViewModel&gt; ();
}</pre></div><p>Note that we do not pass in a parameter class into <code class="literal">ShowViewModel()</code>. This will cause a default instance to be created and passed in, which means that <code class="literal">ParkId</code> will be null. We will use this as a way to determine whether a new park should be created.</p></li><li class="listitem">Now, it's time to hook the <code class="literal">NewParkClicked</code> command up to the <code class="literal">actionNew</code> menu item. We do not have a way to accomplish this using data binding, so we will resort to a more traditional approach—we will use the <code class="literal">OnOptionsItemSelected()</code> method. Add logic to invoke the <code class="literal">Execute()</code> method on <code class="literal">NewParkClicked</code>, as follows:<div class="informalexample"><pre class="programlisting">case Resource.Id.actionNew:
    ((MasterViewModel)ViewModel).
        NewParkClicked.Execute ();
    return true; </pre></div></li></ol></div><p>To add navigation from <code class="literal">DetailViewModel</code>, complete the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open <code class="literal">DetailViewModel.cs</code> and add a <code class="literal">EditParkClicked</code> command property along with the handler for the command. Be sure to initialize the command in the constructor, as shown in the following code snippet:<div class="informalexample"><pre class="programlisting">protected IMvxCommand EditPark { get; protected set;}
protected void EditParkHandler()
{
    ShowViewModel&lt;EditViewModel&gt; (
        new EditViewModel.Parameters ()
            { ParkId = _park.Id });
}</pre></div><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note15"/>Note</h3><p>Note that an instance of the <code class="literal">Parameters</code> class is created, initialized, and passed into the <code class="literal">ShowViewModel()</code> method. This instance will in turn be passed into the <code class="literal">Init()</code> method on <code class="literal">EditViewModel</code>.</p></div></div></li><li class="listitem">Initialize the <code class="literal">command</code> property in the constructor for <code class="literal">MasterViewModel</code>, as follows:<div class="informalexample"><pre class="programlisting">EditPark =
    new MvxCommand&lt;NationalPark&gt; (EditParkHandler);</pre></div></li><li class="listitem">Now, update the <code class="literal">OnOptionsItemSelect()</code> method in <code class="literal">DetailView</code> to invoke the <code class="literal">DetailView.EditPark</code> command when the <code class="literal">Edit</code> action is selected:<div class="informalexample"><pre class="programlisting">case Resource.Id.actionEdit:
    ((DetailViewModel)ViewModel).EditPark.Execute ();
    return true;</pre></div></li><li class="listitem">Compile and run <code class="literal">NationalParks.Droid</code>. You should now have a fully <a class="indexterm" id="id586"/>functional app that has the ability to create new parks and edit the existing parks. Changes <a class="indexterm" id="id587"/>made to <code class="literal">EditView</code> should automatically be reflected in <code class="literal">MasterView</code> and <code class="literal">DetailView</code>.</li></ol></div></div></div></div><div class="section" title="Creating the MvvmCross iOS app"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec76"/>Creating the MvvmCross iOS app</h2></div></div></div><p>The <a class="indexterm" id="id588"/>process of creating the <a class="indexterm" id="id589"/>Android app with MvvmCross provides a solid understanding of how the overall architecture works. Creating the iOS solution should be much easier for two reasons: first, we understand how to interact with MvvmCross and second, all the logic we have placed in <code class="literal">NationalParks.Core</code> is reusable, so that we just need to create the View portion of the app and the startup code.</p><p>To create <code class="literal">NationalParks.iOS</code>, complete the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Select the <code class="literal">NationalParks.MvvmCross</code> solution, right-click on it, and navigate to <span class="strong"><strong>Add</strong></span> | <span class="strong"><strong>New Project</strong></span>.</li><li class="listitem">From the <span class="strong"><strong>New Project</strong></span> dialog, navigate to <span class="strong"><strong>C#</strong></span> | <span class="strong"><strong>iOS</strong></span> | <span class="strong"><strong>iPhone</strong></span> | <span class="strong"><strong>Single View Application</strong></span>, enter <code class="literal">NationalParks.iOS</code> in the Name field, and click on <span class="strong"><strong>OK</strong></span>.</li><li class="listitem">Add the MvvmCross starter kit package to the new project by selecting <code class="literal">NationalParks.iOS</code> and navigating to <span class="strong"><strong>Project</strong></span> | <span class="strong"><strong>Add Packages</strong></span> from the main menu.</li><li class="listitem">A number of things were added to <code class="literal">NationalParks.iOS</code> as a result of adding the package. They are as follows:<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">packages.config</code>: This file contains a list of libraries associated with the MvvmCross starter kit package. These entries are <a class="indexterm" id="id590"/>links to an actual library in the <code class="literal">Packages</code> folder of the overall solution, which contains the actual downloaded libraries.</li><li class="listitem" style="list-style-type: disc"><code class="literal">FirstView</code>: This class is placed in the <code class="literal">Views</code> folder, which corresponds <a class="indexterm" id="id591"/>to the <code class="literal">FirstViewModel</code> instance created in <code class="literal">NationalParks.Core</code>.</li><li class="listitem" style="list-style-type: disc"><code class="literal">Setup</code>: This <a class="indexterm" id="id592"/>class inherits from <code class="literal">MvxTouchSetup</code>. This class is responsible for creating an instance <a class="indexterm" id="id593"/>of the <code class="literal">App</code> class from the core project, which in turn displays the first ViewModel via a call to <code class="literal">RegisterAppStart()</code>.</li><li class="listitem" style="list-style-type: disc"><code class="literal">AppDelegate.cs.txt</code>: This <a class="indexterm" id="id594"/>class <a class="indexterm" id="id595"/>contains the sample startup code, which should be placed in the actual <code class="literal">AppDelete.cs</code> file.</li></ul></div></li></ol></div><div class="section" title="Implementing the iOS user interface"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl3sec54"/>Implementing the iOS user interface</h3></div></div></div><p>We are <a class="indexterm" id="id596"/>now ready to create the user interface for the iOS app. The good news is that we already have all the ViewModels implemented, so we can simply reuse them. The bad news is that we cannot easily reuse the storyboards from our previous work; MvvmCross apps generally use XIB files. One of the reasons for this is that storyboards are intended to provide navigation capabilities <a class="indexterm" id="id597"/>and an MvvmCross app delegates that responsibility to ViewModel and presenter. It is possible to use storyboards in combination with a custom presenter, but the remainder of this chapter will focus on using XIB files, as this is the more common use. The screen layouts as used in <a class="link" href="ch04.html" title="Chapter 4. Developing Your First iOS App with Xamarin.iOS">Chapter 4</a>, <span class="emphasis"><em>Developing Your First iOS App with Xamarin.iOS</em></span>, can be used as depicted in the following screenshot:</p><div class="mediaobject"><img alt="Implementing the iOS user interface" src="graphics/0838OT_07_07.jpg"/></div><p>We <a class="indexterm" id="id598"/>are <a class="indexterm" id="id599"/>now ready to get started.</p></div><div class="section" title="Implementing the master view"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl3sec55"/>Implementing the master view</h3></div></div></div><p>The first <a class="indexterm" id="id600"/>view we will work on is the master view.</p><p>To implement <a class="indexterm" id="id601"/>the master view, complete the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Create a new <code class="literal">ViewController</code> class named <code class="literal">MasterView</code> by right-clicking on the <code class="literal">Views</code> folder of <code class="literal">NationalParks.iOS</code> and navigating to <span class="strong"><strong>Add</strong></span> | <span class="strong"><strong>New File</strong></span> | <span class="strong"><strong>iOS</strong></span> | <span class="strong"><strong>iPhone View Controller</strong></span>.</li><li class="listitem">Open <code class="literal">MasterView.xib</code> and arrange controls as seen in the screen layouts. Add outlets for each of the edit controls.</li><li class="listitem">Open <code class="literal">MasterView.cs</code> and add the following boilerplate logic to deal with constraints on iOS 7, as follows:<div class="informalexample"><pre class="programlisting">// ios7 layout
if (RespondsToSelector(new
    Selector("edgesForExtendedLayout")))
    EdgesForExtendedLayout = UIRectEdge.None;</pre></div></li><li class="listitem">Within the <code class="literal">ViewDidLoad()</code> method, add logic to create <code class="literal">MvxStandardTableViewSource</code> for <code class="literal">parksTableView</code>:<div class="informalexample"><pre class="programlisting">MvxStandardTableViewSource _source;
. . .
_source = new MvxStandardTableViewSource(
    parksTableView,
    UITableViewCellStyle.Subtitle,
    new NSString("cell"),
    "TitleText Name; DetailText Description",
     0);
parksTableView.Source = _source;</pre></div><p>Note that the example uses the <code class="literal">Subtitle</code> cell style and binds the national park name and description to the title and subtitle.</p></li><li class="listitem">Add the binding logic to the <code class="literal">ViewDidShow()</code> method. In the previous step, we provided specifications for properties of <code class="literal">UITableViewCell</code> to properties in the binding context. In this step, we need to set the binding context for the <code class="literal">Parks</code> property on <code class="literal">MasterModelView</code>:<div class="informalexample"><pre class="programlisting">var set = this.CreateBindingSet&lt;MasterView,
    MasterViewModel&gt;();
set.Bind (_source).To (vm =&gt; vm.Parks);
set.Apply();</pre></div></li><li class="listitem">Compile <a class="indexterm" id="id602"/>and run the <a class="indexterm" id="id603"/>app. All the parks in <code class="literal">NationalParks.json</code> should be displayed.</li></ol></div></div><div class="section" title="Implementing the detail view"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl3sec56"/>Implementing the detail view</h3></div></div></div><p>Now, implement <a class="indexterm" id="id604"/>the detail view using <a class="indexterm" id="id605"/>the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Create a new <code class="literal">ViewController</code> instance named <code class="literal">DetailView</code>.</li><li class="listitem">Open <code class="literal">DetailView.xib</code> and arrange controls as shown in the following code. Add outlets for each of the edit controls.</li><li class="listitem">Open <code class="literal">DetailView.cs</code> and add the binding logic to the <code class="literal">ViewDidShow()</code> method:<div class="informalexample"><pre class="programlisting">this.CreateBinding (this.nameLabel).
    To ((DetailViewModel vm) =&gt; vm.Park.Name).Apply ();
this.CreateBinding (this.descriptionLabel).
    To ((DetailViewModel vm) =&gt; vm.Park.Description).
        Apply ();
this.CreateBinding (this.stateLabel).
    To ((DetailViewModel vm) =&gt; vm.Park.State).Apply ();
this.CreateBinding (this.countryLabel).
    To ((DetailViewModel vm) =&gt; vm.Park.Country).
        Apply ();
this.CreateBinding (this.latLabel).
    To ((DetailViewModel vm) =&gt; vm.Park.Latitude).
        Apply ();
this.CreateBinding (this.lonLabel).
    To ((DetailViewModel vm) =&gt; vm.Park.Longitude).
        Apply ();</pre></div></li></ol></div><div class="section" title="Adding navigation"><div class="titlepage"><div><div><h4 class="title"><a id="ch07lvl4sec23"/>Adding navigation</h4></div></div></div><p>Add <a class="indexterm" id="id606"/>navigation from the master view so that when a park is selected, the detail view is displayed, showing the park.</p><p>To add navigation, complete the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open <code class="literal">MasterView.cs</code>, create an event handler named <code class="literal">ParkSelected</code>, and assign it to the <code class="literal">SelectedItemChanged</code> event on <code class="literal">MvxStandardTableViewSource</code>, which was created in the <code class="literal">ViewDidLoad()</code> method:<div class="informalexample"><pre class="programlisting">. . .
    _source.SelectedItemChanged += ParkSelected;
. . .
protected void ParkSelected(object sender, EventArgs e)
{
    . . .
}</pre></div></li><li class="listitem">Within the event handler, invoke the <code class="literal">ParkSelected</code> command on <code class="literal">MasterViewModel</code>, passing in the selected park:<div class="informalexample"><pre class="programlisting">((MasterViewModel)ViewModel).ParkSelected.Execute (
        (NationalPark)_source.SelectedItem);</pre></div></li><li class="listitem">Compile and run <code class="literal">NationalParks.iOS</code>. Selecting a park in the list view should now navigate you to the detail view, displaying the selected park.</li></ol></div></div></div><div class="section" title="Implementing the edit view"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl3sec57"/>Implementing the edit view</h3></div></div></div><p>We now <a class="indexterm" id="id607"/>need to implement the last of the <a class="indexterm" id="id608"/>Views for the iOS app, which is the edit view.</p><p>To implement the edit view, complete the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Create a new <code class="literal">ViewController</code> instance named <code class="literal">EditView</code>.</li><li class="listitem">Open <code class="literal">EditView.xib</code> and arrange controls as in the layout screenshots. Add outlets for each of the edit controls.</li><li class="listitem">Open <code class="literal">EditView.cs</code> and add the data binding logic to the <code class="literal">ViewDidShow()</code> method. You should use the same approach to data binding as the approach used for the details view.</li><li class="listitem">Add an event handler named <code class="literal">DoneClicked</code>, and within the event handler, invoke the <code class="literal">Done</code> command on <code class="literal">EditViewModel</code>:<div class="informalexample"><pre class="programlisting">protected void DoneClicked (object sender, EventArgs e)
{
    ((EditViewModel)ViewModel).Done.Execute();
}</pre></div></li><li class="listitem">In <code class="literal">ViewDidLoad()</code>, add <code class="literal">UIBarButtonItem</code> to <code class="literal">NavigationItem</code> for <code class="literal">EditView</code>, and <a class="indexterm" id="id609"/>assign the <a class="indexterm" id="id610"/><code class="literal">DoneClicked</code> event handler to it, as follows:<div class="informalexample"><pre class="programlisting">NavigationItem.SetRightBarButtonItem(
    new UIBarButtonItem(UIBarButtonSystemItem.Done,
        DoneClicked), true);  </pre></div></li></ol></div><div class="section" title="Adding navigation"><div class="titlepage"><div><div><h4 class="title"><a id="ch07lvl4sec24"/>Adding navigation</h4></div></div></div><p>Add <a class="indexterm" id="id611"/>navigation to two places: when New (<span class="strong"><strong>+</strong></span>) is clicked from the master view and when <span class="strong"><strong>Edit</strong></span> is clicked on in the detail view. Let's start with the master view.</p><p>To add navigation to the master view, perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open <code class="literal">MasterView.cs</code> and add an event handler named <code class="literal">NewParkClicked</code>. In the event handler, invoke the <code class="literal">NewParkClicked</code> command on <code class="literal">MasterViewModel</code>:<div class="informalexample"><pre class="programlisting">protected void NewParkClicked(object sender,
        EventArgs e)
{
    ((MasterViewModel)ViewModel).
            NewParkClicked.Execute ();
}</pre></div></li><li class="listitem">In <code class="literal">ViewDidLoad()</code>, add <code class="literal">UIBarButtonItem</code> to <code class="literal">NavigationItem</code> for <code class="literal">MasterView</code> and assign the <code class="literal">NewParkClicked</code> event handler to it:<div class="informalexample"><pre class="programlisting">NavigationItem.SetRightBarButtonItem(
    new UIBarButtonItem(UIBarButtonSystemItem.Add,
        NewParkClicked), true);</pre></div></li></ol></div><p>To add <a class="indexterm" id="id612"/>navigation to the details view, perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open <code class="literal">DetailView.cs</code> and add an event handler named <code class="literal">EditParkClicked</code>. In the event handler, invoke the <code class="literal">EditParkClicked</code> command on <code class="literal">DetailViewModel</code>:<div class="informalexample"><pre class="programlisting">protected void EditParkClicked (object sender,
    EventArgs e)
{
    ((DetailViewModel)ViewModel).EditPark.Execute ();
}</pre></div></li><li class="listitem">In <code class="literal">ViewDidLoad()</code>, add <code class="literal">UIBarButtonItem</code> to <code class="literal">NavigationItem</code> for <code class="literal">MasterView</code>, and assign the <code class="literal">EditParkClicked</code> event handler to it:<div class="informalexample"><pre class="programlisting">NavigationItem.SetRightBarButtonItem(
    new UIBarButtonItem(UIBarButtonSystemItem.Edit,
        EditParkClicked), true);</pre></div></li></ol></div></div><div class="section" title="Refreshing the master view list"><div class="titlepage"><div><div><h4 class="title"><a id="ch07lvl4sec25"/>Refreshing the master view list</h4></div></div></div><p>One last <a class="indexterm" id="id613"/>detail that needs to be taken care of is to refresh the <code class="literal">UITableView</code> control on <code class="literal">MasterView</code> when items have been changed on <code class="literal">EditView</code>.</p><p>To refresh the master view list, perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open <code class="literal">MasterView.cs</code> and call <code class="literal">ReloadData()</code> on <code class="literal">parksTableView</code> within the <code class="literal">ViewDidAppear()</code> method of <code class="literal">MasterView</code>:<div class="informalexample"><pre class="programlisting">public override void ViewDidAppear (bool animated)
{
    base.ViewDidAppear (animated);
    parksTableView.ReloadData();
}</pre></div></li><li class="listitem">Compile and run <code class="literal">NationalParks.iOS</code>. You should now have a fully functional app that has the ability to create new parks and edit existing parks. Changes made to <code class="literal">EditView</code> should automatically be reflected in <code class="literal">MasterView</code> and <code class="literal">DetailVIew</code>.</li></ol></div></div></div></div></div>
<div class="section" title="Considering the pros and cons"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec56"/>Considering the pros and cons</h1></div></div></div><p>After <a class="indexterm" id="id614"/>completing our work, we now have the basis to make some fundamental observations. Let's start with the pros:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">MvvmCross definitely increases the amount of code that can be reused across platforms. The ViewModels house the data required by the View, the logic required to obtain and transform the data in preparation for viewing, and the logic triggered by user interactions in the form of commands. In our sample app, the ViewModels were somewhat simple; however, the more complex the app, the more reuse will likely be gained.</li><li class="listitem" style="list-style-type: disc">As MvvmCross <a class="indexterm" id="id615"/>relies on the use of each platform's native UI frameworks, each app has a native look and feel and we have a natural layer that implements platform-specific logic when required.</li><li class="listitem" style="list-style-type: disc">The data binding capabilities of MvvmCross also eliminate a great deal of tedious code that would otherwise have to be written.</li></ul></div><p>All of these positives are not necessarily free; let's look at some cons:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The first con is complexity; you have to learn another framework on top of Xamarin, Android, and iOS.</li><li class="listitem" style="list-style-type: disc">In some ways, MvvmCross forces you to align the way your apps work across platforms to achieve the most reuse. As the presentation logic is contained in the ViewModels, the views are coerced into aligning with them. The more your UI deviates across platforms; the less likely it will be that you can actually reuse ViewModels.</li></ul></div><p>With these things in mind, I would definitely consider using MvvmCross for a cross-platform mobile project. Yes, you need to learn an addition framework and yes, you will likely have to align the way some of the apps are laid out, but I think MvvmCross provides enough value and flexibility to make these issues workable. I'm a big fan of reuse and MvvmCross definitely pushes reuse to the next level.</p></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec57"/>Summary</h1></div></div></div><p>In this chapter, we reviewed the high-level concepts of MvvmCross and worked through a practical exercise in order to convert the national parks apps to use the MvvmCross framework and the increase code reuse. In the next chapter, we will follow a similar approach to exploring the Xamarin.Forms framework in order to evaluate how its use can affect code reuse.</p></div></body></html>