<html><head></head><body>
  <div id="_idContainer065">
   <h1 class="chapter-number" id="_idParaDest-350">
    <a id="_idTextAnchor350">
    </a>
    <span class="koboSpan" id="kobo.1.1">
     10
    </span>
   </h1>
   <h1 id="_idParaDest-351">
    <a id="_idTextAnchor351">
    </a>
    <span class="koboSpan" id="kobo.2.1">
     Integrating with OpenAI
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.3.1">
     In this chapter, we will explore how to integrate advanced AI capabilities into your applications using OpenAI’s powerful language models.
    </span>
    <span class="koboSpan" id="kobo.3.2">
     You will learn to set up the Azure OpenAI service and deploy models, laying the foundation for integrating AI into your applications.
    </span>
    <span class="koboSpan" id="kobo.3.3">
     By implementing AI-enhanced features in web applications, such as smart-pasting and smart text areas, you will enhance the user experience with intelligent data processing and content generation.
    </span>
    <span class="koboSpan" id="kobo.3.4">
     Additionally, you’ll build and integrate a ChatGPT-like chatbot for interactive AI-driven conversations.
    </span>
    <span class="koboSpan" id="kobo.3.5">
     Finally, you will enable seamless data analysis by connecting your Azure OpenAI service to an existing Azure Search service
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.4.1">
      data index.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.5.1">
     Before we dive into recipes, it’s crucial to highlight the ethical implications of using AI models, particularly concerning user data.
    </span>
    <span class="koboSpan" id="kobo.5.2">
     In some cases, by using and deploying AI models, you consent to training those models on your application content.
    </span>
    <span class="koboSpan" id="kobo.5.3">
     You must be vigilant about the privacy and security of your users’ data and implement clear warnings and acceptance forms within your applications, allowing users to consent to or opt out of data sharing.
    </span>
    <span class="koboSpan" id="kobo.5.4">
     By prioritizing transparency and user autonomy, you safeguard user trust and adhere to responsible
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.6.1">
      AI practices.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.7.1">
     Here are the recipes we will cover in
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.8.1">
      this chapter:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.9.1">
      Setting up an Azure
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.10.1">
       OpenAI service
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.11.1">
      Implementing
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.12.1">
       smart pasting
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.13.1">
      Implementing a smart
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.14.1">
       text area
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.15.1">
      Adding
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.16.1">
       a ChatBot
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.17.1">
      Connecting an Azure OpenAI service to an existing
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.18.1">
       data index
      </span>
     </span>
    </li>
   </ul>
   <h1 id="_idParaDest-352">
    <a id="_idTextAnchor352">
    </a>
    <span class="koboSpan" id="kobo.19.1">
     Technical requirements
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.20.1">
     In this chapter, we will rely heavily on the Azure services and a few NuGet packages that may still be in preview when you install them.
    </span>
    <span class="koboSpan" id="kobo.20.2">
     You will find all the details and warnings described in detail in each of the impacted recipes, so you have nothing to worry about.
    </span>
    <span class="koboSpan" id="kobo.20.3">
     Before you dive in, make sure you have
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.21.1">
      the following:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.22.1">
      An active Azure account with access to the Azure Portal (if you don’t have one yet, you can start with a time-limited, free account
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.23.1">
       at
      </span>
     </span>
     <a href="https://azure.microsoft.com/en-us/free">
      <span class="No-Break">
       <span class="koboSpan" id="kobo.24.1">
        https://azure.microsoft.com/en-us/free
       </span>
      </span>
     </a>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.25.1">
       )
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.26.1">
      A pre-created resource group
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.27.1">
       in Azure
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.28.1">
      A pre-installed Npm package manager, with globally available
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.29.1">
        npm
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.30.1">
       command
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.31.1">
      A Blazor Web App project with per component/page
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.32.1">
       render modes
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.33.1">
     You can find all the code examples (and data samples) from the following recipes in a dedicated GitHub repository at
    </span>
    <a href="https://github.com/PacktPublishing/Blazor-Web-Development-Cookbook/tree/main">
     <span class="koboSpan" id="kobo.34.1">
      https://github.com/PacktPublishing/Blazor-Web-Development-Cookbook/tree/main
     </span>
    </a>
    <span class="koboSpan" id="kobo.35.1">
     .
    </span>
    <span class="koboSpan" id="kobo.35.2">
     Just be aware that we will implement some recipes only on the server side – you’ll understand why as you read through
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.36.1">
      the chapter.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-353">
    <a id="_idTextAnchor353">
    </a>
    <span class="koboSpan" id="kobo.37.1">
     Setting up an Azure OpenAI service
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.38.1">
     Azure OpenAI Service is
    </span>
    <a id="_idIndexMarker479">
    </a>
    <span class="koboSpan" id="kobo.39.1">
     a cloud-based offering from Microsoft Azure that provides access to OpenAI’s powerful language models.
    </span>
    <span class="koboSpan" id="kobo.39.2">
     A
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.40.1">
      large language model
     </span>
    </strong>
    <span class="koboSpan" id="kobo.41.1">
     (
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.42.1">
      LLM
     </span>
    </strong>
    <span class="koboSpan" id="kobo.43.1">
     ) is an optimized
    </span>
    <a id="_idIndexMarker480">
    </a>
    <span class="koboSpan" id="kobo.44.1">
     cost-function, trained on human texts, that can generate human-like text, allowing you to take chatbots, content generation, or language translation to the next level.
    </span>
    <span class="koboSpan" id="kobo.44.2">
     By leveraging the Azure OpenAI service, you can integrate advanced AI capabilities into your Blazor application without managing the underlying infrastructure.
    </span>
    <span class="koboSpan" id="kobo.44.3">
     You’re also getting access to existing
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.45.1">
      GPT models.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.46.1">
     Let’s set up an Azure OpenAI service in the Azure cloud using the Azure portal, deploy a dedicated GPT-4 model, and locate access details required for integration on the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.47.1">
      application side.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-354">
    <a id="_idTextAnchor354">
    </a>
    <span class="koboSpan" id="kobo.48.1">
     Getting ready
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.49.1">
     In this recipe, we won’t write any code just yet; instead, we will focus on setting up the Azure OpenAI service.
    </span>
    <span class="koboSpan" id="kobo.49.2">
     To get started, here are
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.50.1">
      some prerequisites:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.51.1">
      You will need an Azure account and access to the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.52.1">
       Azure Portal
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.53.1">
      You should create a resource group beforehand; we will use one named
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.54.1">
       blazor-cookbook
      </span>
     </strong>
     <span class="koboSpan" id="kobo.55.1">
      dedicated to
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.56.1">
       this chapter
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.57.1">
     At the time of writing, the process of setting up the Azure OpenAI service consists of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.58.1">
      two phases.
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.59.1">
      In the first phase, do
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.60.1">
       the following:
      </span>
     </span>
     <ol>
      <li class="upper-roman">
       <span class="koboSpan" id="kobo.61.1">
        You must complete a request form to gain access to the Azure OpenAI service.
       </span>
       <span class="koboSpan" id="kobo.61.2">
        To find the request form, follow the first two steps outlined in the
       </span>
       <em class="italic">
        <span class="koboSpan" id="kobo.62.1">
         How to do it
        </span>
       </em>
       <span class="koboSpan" id="kobo.63.1">
        section
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.64.1">
         that follows.
        </span>
       </span>
      </li>
      <li class="upper-roman">
       <span class="koboSpan" id="kobo.65.1">
        After submitting the form, you will need to wait for approval from the
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.66.1">
         Azure Cognitive Services team
        </span>
       </strong>
       <span class="koboSpan" id="kobo.67.1">
        .
       </span>
       <span class="koboSpan" id="kobo.67.2">
        You will receive a confirmation email once your
       </span>
       <a id="_idIndexMarker481">
       </a>
       <span class="koboSpan" id="kobo.68.1">
        request has been approved, marking the end of the
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.69.1">
         first phase.
        </span>
       </span>
      </li>
     </ol>
    </li>
    <li>
     <span class="koboSpan" id="kobo.70.1">
      We will walk through the second phase in the
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.71.1">
       How to do
      </span>
     </em>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.72.1">
        it
       </span>
      </em>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.73.1">
       section.
      </span>
     </span>
    </li>
   </ol>
   <h2 id="_idParaDest-355">
    <a id="_idTextAnchor355">
    </a>
    <span class="koboSpan" id="kobo.74.1">
     How to do it…
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.75.1">
     Follow these steps to
    </span>
    <a id="_idIndexMarker482">
    </a>
    <span class="koboSpan" id="kobo.76.1">
     add the Azure OpenAI service to your
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.77.1">
      Azure resources:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.78.1">
      Open your resource group in Azure Portal and navigate to the Azure Marketplace by clicking the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.79.1">
       Create
      </span>
     </strong>
     <span class="koboSpan" id="kobo.80.1">
      button in the top
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.81.1">
       navigation bar.
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer048">
     <span class="koboSpan" id="kobo.82.1">
      <img alt="Figure 10.1: Navigating to Azure Marketplace from the resource group overview" src="image/B22020_10_1.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.83.1">
     Figure 10.1: Navigating to Azure Marketplace from the resource group overview
    </span>
   </p>
   <ol>
    <li value="2">
     <span class="koboSpan" id="kobo.84.1">
      In the Azure Marketplace, use the search bar in the top panel to find the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.85.1">
       Azure OpenAI
      </span>
     </strong>
     <span class="koboSpan" id="kobo.86.1">
      service and start the creation process by clicking the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.87.1">
       Create
      </span>
     </strong>
     <span class="koboSpan" id="kobo.88.1">
      button on the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.89.1">
       resulting tab.
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer049">
     <span class="koboSpan" id="kobo.90.1">
      <img alt="Figure 10.2: Navigating to the Azure OpenAI service creation panel" src="image/B22020_10_2.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.91.1">
     Figure 10.2: Navigating to the Azure OpenAI service creation panel
    </span>
   </p>
   <ol>
    <li value="3">
     <span class="koboSpan" id="kobo.92.1">
      In the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.93.1">
       Create Azure OpenAI
      </span>
     </strong>
     <span class="koboSpan" id="kobo.94.1">
      panel, provide the necessary details to create an Azure
     </span>
     <a id="_idIndexMarker483">
     </a>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.95.1">
       OpenAI instance:
      </span>
     </span>
     <ol>
      <li class="Alphabets">
       <span class="koboSpan" id="kobo.96.1">
        Select the subscription for the service in the
       </span>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.97.1">
          Subscription
         </span>
        </strong>
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.98.1">
         field.
        </span>
       </span>
      </li>
      <li class="Alphabets">
       <span class="koboSpan" id="kobo.99.1">
        Select the resource group where you want to create the service in the
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.100.1">
         Resource
        </span>
       </strong>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.101.1">
          Group
         </span>
        </strong>
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.102.1">
         field.
        </span>
       </span>
      </li>
      <li class="Alphabets">
       <span class="koboSpan" id="kobo.103.1">
        Select the hosting region in the
       </span>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.104.1">
          Region
         </span>
        </strong>
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.105.1">
         field.
        </span>
       </span>
      </li>
      <li class="Alphabets">
       <span class="koboSpan" id="kobo.106.1">
        Provide a unique name for the service in the
       </span>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.107.1">
          Name
         </span>
        </strong>
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.108.1">
         field.
        </span>
       </span>
      </li>
      <li class="Alphabets">
       <span class="koboSpan" id="kobo.109.1">
        Select the pricing plan in the
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.110.1">
         Pricing
        </span>
       </strong>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.111.1">
          tier
         </span>
        </strong>
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.112.1">
         field.
        </span>
       </span>
      </li>
     </ol>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer050">
     <span class="koboSpan" id="kobo.113.1">
      <img alt="Figure 10.3: First step of the Azure OpenAI service creation process – defining instance details" src="image/B22020_10_3.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.114.1">
     Figure 10.3: First step of the Azure OpenAI service creation process – defining instance details
    </span>
   </p>
   <p class="list-inset">
    <span class="koboSpan" id="kobo.115.1">
     After reviewing
    </span>
    <a id="_idIndexMarker484">
    </a>
    <span class="koboSpan" id="kobo.116.1">
     the terms and conditions, click
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.117.1">
      Next
     </span>
    </strong>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.118.1">
      to proceed.
     </span>
    </span>
   </p>
   <ol>
    <li value="4">
     <span class="koboSpan" id="kobo.119.1">
      In the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.120.1">
       Network
      </span>
     </strong>
     <span class="koboSpan" id="kobo.121.1">
      step, select the network availability for the service that best suits your needs and confirm by
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.122.1">
       clicking
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.123.1">
        Next
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.124.1">
       .
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer051">
     <span class="koboSpan" id="kobo.125.1">
      <img alt="Figure 10.4: Second step of the Azure OpenAI service creation process – configuring network" src="image/B22020_10_4.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.126.1">
     Figure 10.4: Second step of the Azure OpenAI service creation process – configuring network
    </span>
   </p>
   <ol>
    <li value="5">
     <span class="koboSpan" id="kobo.127.1">
      Leave the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.128.1">
       Tags
      </span>
     </strong>
     <span class="koboSpan" id="kobo.129.1">
      step
     </span>
     <a id="_idIndexMarker485">
     </a>
     <span class="koboSpan" id="kobo.130.1">
      unchanged unless you have tag policies to follow in your organization and proceed by
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.131.1">
       clicking
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.132.1">
        Next
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.133.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.134.1">
      In the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.135.1">
       Review + submit
      </span>
     </strong>
     <span class="koboSpan" id="kobo.136.1">
      step, review the service summary and confirm the creation request by clicking the
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.137.1">
        Create
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.138.1">
       button.
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer052">
     <span class="koboSpan" id="kobo.139.1">
      <img alt="Figure 10.5: Last step of the Azure OpenAI creation process – reviewing instance details" src="image/B22020_10_5.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.140.1">
     Figure 10.5: Last step of the Azure OpenAI creation process – reviewing instance details
    </span>
   </p>
   <ol>
    <li value="7">
     <span class="koboSpan" id="kobo.141.1">
      Once the deployment
     </span>
     <a id="_idIndexMarker486">
     </a>
     <span class="koboSpan" id="kobo.142.1">
      completes, open your resource group overview and select the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.143.1">
       Azure
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.144.1">
        OpenAI
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.145.1">
       service.
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer053">
     <span class="koboSpan" id="kobo.146.1">
      <img alt="Figure 10.6: Selecting the Azure OpenAI instance from the resource group overview" src="image/B22020_10_6.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.147.1">
     Figure 10.6: Selecting the Azure OpenAI instance from the resource group overview
    </span>
   </p>
   <ol>
    <li value="8">
     <span class="koboSpan" id="kobo.148.1">
      Find the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.149.1">
       Model deployments
      </span>
     </strong>
     <span class="koboSpan" id="kobo.150.1">
      feature in the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.151.1">
       Resource Management
      </span>
     </strong>
     <span class="koboSpan" id="kobo.152.1">
      section in the left
     </span>
     <a id="_idIndexMarker487">
     </a>
     <span class="koboSpan" id="kobo.153.1">
      menu.
     </span>
     <span class="koboSpan" id="kobo.153.2">
      Open the Azure OpenAI Studio by clicking the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.154.1">
       Manage
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.155.1">
        deployments
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.156.1">
       button.
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer054">
     <span class="koboSpan" id="kobo.157.1">
      <img alt="Figure 10.7: Navigating to Azure OpenAI Studio to manage model deployments" src="image/B22020_10_7.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.158.1">
     Figure 10.7: Navigating to Azure OpenAI Studio to manage model deployments
    </span>
   </p>
   <ol>
    <li value="9">
     <span class="koboSpan" id="kobo.159.1">
      In the Azure OpenAI Studio, find the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.160.1">
       Deployments
      </span>
     </strong>
     <span class="koboSpan" id="kobo.161.1">
      feature in the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.162.1">
       Management
      </span>
     </strong>
     <span class="koboSpan" id="kobo.163.1">
      section on the left menu and start the deployment process by clicking the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.164.1">
       Create new
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.165.1">
        deployment
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.166.1">
       button.
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer055">
     <span class="koboSpan" id="kobo.167.1">
      <img alt="Figure 10.8: Initiating model deployment through the Azure OpenAI Studio" src="image/B22020_10_8.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.168.1">
     Figure 10.8: Initiating model deployment through the Azure OpenAI Studio
    </span>
   </p>
   <ol>
    <li value="10">
     <span class="koboSpan" id="kobo.169.1">
      Fill out
     </span>
     <a id="_idIndexMarker488">
     </a>
     <span class="koboSpan" id="kobo.170.1">
      the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.171.1">
       Deploy model
      </span>
     </strong>
     <span class="koboSpan" id="kobo.172.1">
      form with the details of the model you intend
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.173.1">
       to use:
      </span>
     </span>
     <ol>
      <li class="Alphabets">
       <span class="koboSpan" id="kobo.174.1">
        Name the deployment in the
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.175.1">
         Deployment
        </span>
       </strong>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.176.1">
          name
         </span>
        </strong>
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.177.1">
         field.
        </span>
       </span>
      </li>
      <li class="Alphabets">
       <span class="koboSpan" id="kobo.178.1">
        Choose the model you want to deploy from the
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.179.1">
         Select a
        </span>
       </strong>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.180.1">
          model
         </span>
        </strong>
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.181.1">
         dropdown.
        </span>
       </span>
      </li>
      <li class="Alphabets">
       <span class="koboSpan" id="kobo.182.1">
        Select a specific model version or the
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.183.1">
         Auto-update to default
        </span>
       </strong>
       <span class="koboSpan" id="kobo.184.1">
        option in the
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.185.1">
         Model
        </span>
       </strong>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.186.1">
          version
         </span>
        </strong>
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.187.1">
         dropdown.
        </span>
       </span>
      </li>
      <li class="Alphabets">
       <span class="koboSpan" id="kobo.188.1">
        Choose the type of deployment in the
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.189.1">
         Deployment
        </span>
       </strong>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.190.1">
          type
         </span>
        </strong>
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.191.1">
         dropdown.
        </span>
       </span>
      </li>
     </ol>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer056">
     <span class="koboSpan" id="kobo.192.1">
      <img alt="Figure 10.9: Filling the model deployment details and deploying the model" src="image/B22020_10_9.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.193.1">
     Figure 10.9: Filling the model deployment details and deploying the model
    </span>
   </p>
   <p class="list-inset">
    <span class="koboSpan" id="kobo.194.1">
     After filling out
    </span>
    <a id="_idIndexMarker489">
    </a>
    <span class="koboSpan" id="kobo.195.1">
     all required fields, confirm the deployment by
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.196.1">
      clicking
     </span>
    </span>
    <span class="No-Break">
     <strong class="bold">
      <span class="koboSpan" id="kobo.197.1">
       Create
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.198.1">
      .
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-356">
    <a id="_idTextAnchor356">
    </a>
    <span class="koboSpan" id="kobo.199.1">
     How it works…
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.200.1">
     In
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.201.1">
      step 1
     </span>
    </em>
    <span class="koboSpan" id="kobo.202.1">
     , we open the Azure Portal and find the resource group where we want to deploy the Azure OpenAI service.
    </span>
    <span class="koboSpan" id="kobo.202.2">
     From the top bar of the overview panel, we select the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.203.1">
      Create
     </span>
    </strong>
    <span class="koboSpan" id="kobo.204.1">
     option.
    </span>
    <span class="koboSpan" id="kobo.204.2">
     Azure will redirect us to the Azure Marketplace, where we can choose the services
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.205.1">
      to install.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.206.1">
     In
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.207.1">
      step 2
     </span>
    </em>
    <span class="koboSpan" id="kobo.208.1">
     , we utilize the search bar at the top of the Azure Marketplace to look for Azure OpenAI.
    </span>
    <span class="koboSpan" id="kobo.208.2">
     The result tab has a
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.209.1">
      Create
     </span>
    </strong>
    <span class="koboSpan" id="kobo.210.1">
     button, which we use to start the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.211.1">
      creation process.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.212.1">
     In
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.213.1">
      step 3
     </span>
    </em>
    <span class="koboSpan" id="kobo.214.1">
     , we arrive at the first step of the Azure OpenAI creation –
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.215.1">
      Basics
     </span>
    </strong>
    <span class="koboSpan" id="kobo.216.1">
     .
    </span>
    <span class="koboSpan" id="kobo.216.2">
     In this step, we fill out all the basic details of the instance we’re about to create.
    </span>
    <span class="koboSpan" id="kobo.216.3">
     We choose the Azure subscription to define the owner of the service.
    </span>
    <span class="koboSpan" id="kobo.216.4">
     Then, we select the appropriate resource group from the list assigned to the subscription.
    </span>
    <span class="koboSpan" id="kobo.216.5">
     Next, we define the instance details, such as the hosting region and pricing tier.
    </span>
    <span class="koboSpan" id="kobo.216.6">
     Be careful, as different areas have different AI models available.
    </span>
    <span class="koboSpan" id="kobo.216.7">
     Also, depending on the pricing tier you select, you may incur service usage costs.
    </span>
    <span class="koboSpan" id="kobo.216.8">
     To avoid that, opt for a free pricing tier (it has restricted scalability and request limits but will be enough for the recipes in this chapter).
    </span>
    <span class="koboSpan" id="kobo.216.9">
     You can review the availability and pricing details by clicking the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.217.1">
      View full pricing details
     </span>
    </strong>
    <span class="koboSpan" id="kobo.218.1">
     link.
    </span>
    <span class="koboSpan" id="kobo.218.2">
     Then, we provide the instance name and a pricing tier.
    </span>
    <span class="koboSpan" id="kobo.218.3">
     Once we have filled in all required fields, we move to the next step by
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.219.1">
      clicking
     </span>
    </span>
    <span class="No-Break">
     <strong class="bold">
      <span class="koboSpan" id="kobo.220.1">
       Next
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.221.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.222.1">
     In
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.223.1">
      step 4
     </span>
    </em>
    <span class="koboSpan" id="kobo.224.1">
     , we arrive at the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.225.1">
      Network
     </span>
    </strong>
    <span class="koboSpan" id="kobo.226.1">
     step of the Azure OpenAI creation.
    </span>
    <span class="koboSpan" id="kobo.226.2">
     In the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.227.1">
      Network
     </span>
    </strong>
    <span class="koboSpan" id="kobo.228.1">
     tab, we define the discoverability of the service.
    </span>
    <span class="koboSpan" id="kobo.228.2">
     We can disable network access entirely, configure private endpoints, set up network security within Azure, or make the instance publicly accessible.
    </span>
    <span class="koboSpan" id="kobo.228.3">
     To keep it simple, we allow the instance access from any network, including the internet, and confirm by clicking
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.229.1">
      Next
     </span>
    </strong>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.230.1">
      to proceed.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.231.1">
     In
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.232.1">
      step 5
     </span>
    </em>
    <span class="koboSpan" id="kobo.233.1">
     , we arrive
    </span>
    <a id="_idIndexMarker490">
    </a>
    <span class="koboSpan" id="kobo.234.1">
     at the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.235.1">
      Tags
     </span>
    </strong>
    <span class="koboSpan" id="kobo.236.1">
     step of the Azure OpenAI creation.
    </span>
    <span class="koboSpan" id="kobo.236.2">
     The
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.237.1">
      Tags
     </span>
    </strong>
    <span class="koboSpan" id="kobo.238.1">
     tab allows defining custom tags describing services.
    </span>
    <span class="koboSpan" id="kobo.238.2">
     Unless you have tag-based policies defined in your organization, tags won’t have any functional impact.
    </span>
    <span class="koboSpan" id="kobo.238.3">
     Hence, we leave the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.239.1">
      Tags
     </span>
    </strong>
    <span class="koboSpan" id="kobo.240.1">
     panel unchanged and proceed to the last step by
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.241.1">
      clicking
     </span>
    </span>
    <span class="No-Break">
     <strong class="bold">
      <span class="koboSpan" id="kobo.242.1">
       Next
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.243.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.244.1">
     In
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.245.1">
      step 6
     </span>
    </em>
    <span class="koboSpan" id="kobo.246.1">
     , we arrive at the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.247.1">
      Review + submit
     </span>
    </strong>
    <span class="koboSpan" id="kobo.248.1">
     panel, where we get the last chance to review the details of the instance we’re about to create.
    </span>
    <span class="koboSpan" id="kobo.248.2">
     When everything checks out, we confirm the creation by
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.249.1">
      clicking
     </span>
    </span>
    <span class="No-Break">
     <strong class="bold">
      <span class="koboSpan" id="kobo.250.1">
       Create
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.251.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.252.1">
     It will take some time for the service deployment to complete.
    </span>
    <span class="koboSpan" id="kobo.252.2">
     When completed, we proceed to
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.253.1">
      step 7
     </span>
    </em>
    <span class="koboSpan" id="kobo.254.1">
     .
    </span>
    <span class="koboSpan" id="kobo.254.2">
     We navigate to the overview panel of the resource group and select the Azure
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.255.1">
      OpenAI instance.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.256.1">
     In
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.257.1">
      step 8
     </span>
    </em>
    <span class="koboSpan" id="kobo.258.1">
     , we find the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.259.1">
      Resource Management
     </span>
    </strong>
    <span class="koboSpan" id="kobo.260.1">
     submenu and navigate to the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.261.1">
      Model deployments
     </span>
    </strong>
    <span class="koboSpan" id="kobo.262.1">
     feature.
    </span>
    <span class="koboSpan" id="kobo.262.2">
     In that panel, we click the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.263.1">
      Manage Deployments
     </span>
    </strong>
    <span class="koboSpan" id="kobo.264.1">
     button and get redirected to the Azure OpenAI Studio for
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.265.1">
      further steps.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.266.1">
     In
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.267.1">
      step 9
     </span>
    </em>
    <span class="koboSpan" id="kobo.268.1">
     , in the Azure OpenAI Studio, we find the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.269.1">
      Management
     </span>
    </strong>
    <span class="koboSpan" id="kobo.270.1">
     submenu and navigate to the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.271.1">
      Deployments
     </span>
    </strong>
    <span class="koboSpan" id="kobo.272.1">
     panel.
    </span>
    <span class="koboSpan" id="kobo.272.2">
     In the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.273.1">
      Deployments
     </span>
    </strong>
    <span class="koboSpan" id="kobo.274.1">
     navigation bar, we click the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.275.1">
      Create new deployment
     </span>
    </strong>
    <span class="koboSpan" id="kobo.276.1">
     button to initialize a model deployment for the Azure
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.277.1">
      OpenAI service.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.278.1">
     In
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.279.1">
      step 10
     </span>
    </em>
    <span class="koboSpan" id="kobo.280.1">
     , we arrive at the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.281.1">
      Deploy model
     </span>
    </strong>
    <span class="koboSpan" id="kobo.282.1">
     submission form, where we must configure the deployment details.
    </span>
    <span class="koboSpan" id="kobo.282.2">
     First, we define the deployment name – we will later use that name to specify which model to use for executing requests from the Blazor app.
    </span>
    <span class="koboSpan" id="kobo.282.3">
     Next, we choose the model to deploy.
    </span>
    <span class="koboSpan" id="kobo.282.4">
     Depending on the region where the Azure OpenAI instance is hosted, we can choose from a different set of AI models provided by Azure.
    </span>
    <span class="koboSpan" id="kobo.282.5">
     To keep it simple, we opt to deploy GPT-4o.
    </span>
    <span class="koboSpan" id="kobo.282.6">
     After choosing the model, we specify the version to use.
    </span>
    <span class="koboSpan" id="kobo.282.7">
     From the dropdown, we can select a specific GPT model version or choose
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.283.1">
      Auto-update to default
     </span>
    </strong>
    <span class="koboSpan" id="kobo.284.1">
     to use the latest stable model.
    </span>
    <span class="koboSpan" id="kobo.284.2">
     In the deployment form, we can fine-tune a rate limit for requests and a content filter, which we leave at default values.
    </span>
    <span class="koboSpan" id="kobo.284.3">
     We can also enable
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.285.1">
      Dynamic quota
     </span>
    </strong>
    <span class="koboSpan" id="kobo.286.1">
     , allowing Azure to automatically scale up the
    </span>
    <a id="_idIndexMarker491">
    </a>
    <span class="koboSpan" id="kobo.287.1">
     tokens per minute limit when there’s higher traffic.
    </span>
    <span class="koboSpan" id="kobo.287.2">
     When we have filled in all deployment details, we can start the process by
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.288.1">
      clicking
     </span>
    </span>
    <span class="No-Break">
     <strong class="bold">
      <span class="koboSpan" id="kobo.289.1">
       Create
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.290.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.291.1">
     When the deployment completes, you’ll see the model in the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.292.1">
      Deployments
     </span>
    </strong>
    <span class="koboSpan" id="kobo.293.1">
     panel of Azure
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.294.1">
      OpenAI Studio:
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer057">
     <span class="koboSpan" id="kobo.295.1">
      <img alt="Figure 10.10: Azure OpenAI model deployments overview, showing the deployed model" src="image/B22020_10_10.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.296.1">
     Figure 10.10: Azure OpenAI model deployments overview, showing the deployed model
    </span>
   </p>
   <h2 id="_idParaDest-357">
    <a id="_idTextAnchor357">
    </a>
    <span class="koboSpan" id="kobo.297.1">
     There’s more…
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.298.1">
     To communicate with the Azure OpenAI instance and the deployed AI model, you will need the model deployment name (which we set in
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.299.1">
      step 10
     </span>
    </em>
    <span class="koboSpan" id="kobo.300.1">
     ) and the Azure OpenAI API
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.301.1">
      access details.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.302.1">
     To find those details, navigate to the resource group and the created Azure OpenAI instance.
    </span>
    <span class="koboSpan" id="kobo.302.2">
     In the menu on the left, select the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.303.1">
      Keys and Endpoint
     </span>
    </strong>
    <span class="koboSpan" id="kobo.304.1">
     item in the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.305.1">
      Resource
     </span>
    </strong>
    <span class="No-Break">
     <strong class="bold">
      <span class="koboSpan" id="kobo.306.1">
       Management
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.307.1">
      section.
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer058">
     <span class="koboSpan" id="kobo.308.1">
      <img alt="Figure 10.11: Navigating to the panel with the Azure OpenAI instance API access details" src="image/B22020_10_11.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.309.1">
     Figure 10.11: Navigating to the panel with the Azure OpenAI instance API access details
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.310.1">
     You’ll arrive at the
    </span>
    <a id="_idIndexMarker492">
    </a>
    <span class="koboSpan" id="kobo.311.1">
     API details panel, which includes the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.312.1">
      Endpoint
     </span>
    </strong>
    <span class="koboSpan" id="kobo.313.1">
     pointing to the Azure OpenAI instance, the location where it’s hosted, and two API keys.
    </span>
    <span class="koboSpan" id="kobo.313.2">
     Having two API keys ensures continuous service availability when you need to regenerate one
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.314.1">
      of them.
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer059">
     <span class="koboSpan" id="kobo.315.1">
      <img alt="Figure 10.12: API access details panel, with API keys and URI" src="image/B22020_10_12.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.316.1">
     Figure 10.12: API access details panel, with API keys and URI
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.317.1">
     You will need the endpoint, API key, and deployed model name for all the upcoming recipes, so store them securely in your secrets storage or keep them handy in a notepad for quick access as
    </span>
    <a id="_idIndexMarker493">
    </a>
    <span class="koboSpan" id="kobo.318.1">
     we proceed through
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.319.1">
      the implementations.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-358">
    <a id="_idTextAnchor358">
    </a>
    <span class="koboSpan" id="kobo.320.1">
     See also
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.321.1">
     We’ve only touched on the Azure OpenAI service, covering the scope required to integrate OpenAI into a Blazor application.
    </span>
    <span class="koboSpan" id="kobo.321.2">
     If you’d like to learn more, access the Microsoft Learn
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.322.1">
      resource here:
     </span>
    </span>
   </p>
   <p>
    <a href="https://learn.microsoft.com/en-us/azure/ai-services/openai/overview ">
     <span class="No-Break">
      <span class="koboSpan" id="kobo.323.1">
       https://learn.microsoft.com/en-us/azure/ai-services/openai/overview
      </span>
     </span>
    </a>
   </p>
   <h1 id="_idParaDest-359">
    <a id="_idTextAnchor359">
    </a>
    <span class="koboSpan" id="kobo.324.1">
     Implementing smart pasting
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.325.1">
     One common
    </span>
    <a id="_idIndexMarker494">
    </a>
    <span class="koboSpan" id="kobo.326.1">
     challenge in web development is dealing with unstandardized data, such as when you receive an email or other data that needs to be accurately input into a claim form.
    </span>
    <span class="koboSpan" id="kobo.326.2">
     This task can quickly become tedious and frustrating, as manually copying and pasting data into the correct fields is time-consuming and prone
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.327.1">
      to errors.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.328.1">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.329.1">
      SmartComponents
     </span>
    </strong>
    <span class="koboSpan" id="kobo.330.1">
     repository is an open-source repository with components enabling you to add AI-driven features to your .NET applications quickly and without an in-depth knowledge of prompt engineering.
    </span>
    <span class="koboSpan" id="kobo.330.2">
     Among other features,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.331.1">
      SmartComponents
     </span>
    </strong>
    <span class="koboSpan" id="kobo.332.1">
     can enhance the pasting of the unstructured data to fit the expected form.
    </span>
    <span class="koboSpan" id="kobo.332.2">
     Even though
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.333.1">
      SmartComponents
     </span>
    </strong>
    <span class="koboSpan" id="kobo.334.1">
     is not in the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.335.1">
      Microsoft
     </span>
    </strong>
    <span class="koboSpan" id="kobo.336.1">
     namespace, it is under the official .NET Platform GitHub account and is fully endorsed, developed, and maintained by the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.337.1">
      Microsoft Team.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.338.1">
     Let’s implement a smart-pasting feature allowing users to paste copied text directly into designated fields without
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.339.1">
      any preprocessing.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-360">
    <a id="_idTextAnchor360">
    </a>
    <span class="koboSpan" id="kobo.340.1">
     Getting ready
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.341.1">
     Before we dive into making the pasting smarter, do
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.342.1">
      the following:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.343.1">
      Create a
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.344.1">
       Chapter10
      </span>
     </strong>
     <span class="koboSpan" id="kobo.345.1">
      /
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.346.1">
       Recipe02
      </span>
     </strong>
     <span class="koboSpan" id="kobo.347.1">
      directory – this will be your
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.348.1">
       working directory
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.349.1">
      Copy the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.350.1">
       Models
      </span>
     </strong>
     <span class="koboSpan" id="kobo.351.1">
      file from the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.352.1">
       Chapter10
      </span>
     </strong>
     <span class="koboSpan" id="kobo.353.1">
      /
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.354.1">
       Data
      </span>
     </strong>
     <span class="koboSpan" id="kobo.355.1">
      directory in the GitHub repository to the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.356.1">
       working directory
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.357.1">
      Copy the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.358.1">
       SmartComponents
      </span>
     </strong>
     <span class="koboSpan" id="kobo.359.1">
      folder from the GitHub repository to your solution folder, and add all projects inside to your solution.
     </span>
     <span class="koboSpan" id="kobo.359.2">
      The
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.360.1">
       SmartComponents
      </span>
     </strong>
     <span class="koboSpan" id="kobo.361.1">
      folder contains a clone of the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.362.1">
       SmartComponents
      </span>
     </strong>
     <span class="koboSpan" id="kobo.363.1">
      repository, updated to support the latest Azure
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.364.1">
       OpenAI updates
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.365.1">
      Have the Azure OpenAI details ready (you can see how to get them in the
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.366.1">
       There’s more…
      </span>
     </em>
     <span class="koboSpan" id="kobo.367.1">
      section of the
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.368.1">
       Setting up Azure OpenAI
      </span>
     </em>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.369.1">
        service
       </span>
      </em>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.370.1">
       recipe)
      </span>
     </span>
    </li>
   </ul>
   <h2 id="_idParaDest-361">
    <a id="_idTextAnchor361">
    </a>
    <span class="koboSpan" id="kobo.371.1">
     How to do it…
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.372.1">
     Follow these instructions to enhance pasting in your application
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.373.1">
      with AI:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.374.1">
      Navigate to
     </span>
     <a id="_idIndexMarker495">
     </a>
     <span class="koboSpan" id="kobo.375.1">
      the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.376.1">
       csproj
      </span>
     </strong>
     <span class="koboSpan" id="kobo.377.1">
      file of the server-side project and include two required
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.378.1">
        SmartComponents
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.379.1">
       projects:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.380.1">
&lt;ItemGroup&gt;
  &lt;ProjectReference
    Include= "..\SmartComponents\
    SmartComponents.AspNetCore\
    SmartComponents.AspNetCore.csproj" /&gt;
  &lt;ProjectReference
    Include= "..\SmartComponents\
    SmartComponents.Inference.OpenAI\
    SmartComponents.Inference.OpenAI.csproj" /&gt;
&lt;/ItemGroup&gt;</span></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.381.1">
      Still on the server side, open the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.382.1">
       Program.cs
      </span>
     </strong>
     <span class="koboSpan" id="kobo.383.1">
      file and register
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.384.1">
       SmartComponents
      </span>
     </strong>
     <span class="koboSpan" id="kobo.385.1">
      with the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.386.1">
       OpenAI backend:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.387.1">
using SmartComponents.Inference.OpenAI;
//...other service registrations
builder.Services
    .AddSmartComponents()
    .WithInferenceBackend&lt;OpenAIInferenceBackend&gt;();</span></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.388.1">
      Locate the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.389.1">
       appSettings
      </span>
     </strong>
     <span class="koboSpan" id="kobo.390.1">
      file of the server-side project and extend the application settings with an area for
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.391.1">
        SmartComponents
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.392.1">
       configuration:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.393.1">
{
  "SmartComponents": {
    "ApiKey": "YOUR_API_KEY",
    "Endpoint": "YOUR_ENDPOINT",
    "DeploymentName": "YOUR_MODEL_DEPLOYMENT"
  }
}</span></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.394.1">
      Navigate to the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.395.1">
       csproj
      </span>
     </strong>
     <span class="koboSpan" id="kobo.396.1">
      file of the client-side project and include the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.397.1">
       SmartComponents
      </span>
     </strong>
     <span class="koboSpan" id="kobo.398.1">
      project
     </span>
     <a id="_idIndexMarker496">
     </a>
     <span class="koboSpan" id="kobo.399.1">
      required by the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.400.1">
       WebAssembly renderer:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.401.1">
&lt;ItemGroup&gt;
  &lt;ProjectReference
    Include="..\SmartComponents\
    SmartComponents.AspNetCore.Components\
    SmartComponents.AspNetCore.Components.csproj" /&gt;
&lt;/ItemGroup&gt;</span></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.402.1">
      Create a new routable
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.403.1">
       FillClaim
      </span>
     </strong>
     <span class="koboSpan" id="kobo.404.1">
      component, referencing the
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.405.1">
        SmartComponents
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.406.1">
       assembly:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.407.1">
@page "/ch10r02"
@using SmartComponents</span></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.408.1">
      In the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.409.1">
       @code
      </span>
     </strong>
     <span class="koboSpan" id="kobo.410.1">
      block of the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.411.1">
       FillClaim
      </span>
     </strong>
     <span class="koboSpan" id="kobo.412.1">
      component, declare a
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.413.1">
       Claim
      </span>
     </strong>
     <span class="koboSpan" id="kobo.414.1">
      form parameter of the
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.415.1">
        ClaimViewModel
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.416.1">
       type:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.417.1">
@code {
    [SupplyParameterFromForm]
    public ClaimViewModel Claim { get; set; } = new();
}</span></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.418.1">
      In the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.419.1">
       FillClaim
      </span>
     </strong>
     <span class="koboSpan" id="kobo.420.1">
      markup, construct an
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.421.1">
       EditForm
      </span>
     </strong>
     <span class="koboSpan" id="kobo.422.1">
      frame, binding it to the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.423.1">
       Claim
      </span>
     </strong>
     <span class="koboSpan" id="kobo.424.1">
      parameter.
     </span>
     <span class="koboSpan" id="kobo.424.2">
      If
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.425.1">
       EditForm
      </span>
     </strong>
     <span class="koboSpan" id="kobo.426.1">
      is not recognized as a component, include a
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.427.1">
       @using Microsoft.AspNetCore.Components.Forms
      </span>
     </strong>
     <span class="koboSpan" id="kobo.428.1">
      reference at the top of the
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.429.1">
        FillClaim
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.430.1">
       component:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.431.1">
&lt;EditForm Model="@Claim" FormName="claim-form"&gt;
    @* we will continue here *@
&lt;/EditForm&gt;</span></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.432.1">
      Inside the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.433.1">
       FillClaim
      </span>
     </strong>
     <span class="koboSpan" id="kobo.434.1">
      form, add
     </span>
     <a id="_idIndexMarker497">
     </a>
     <span class="koboSpan" id="kobo.435.1">
      fields for entering event and
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.436.1">
       customer details:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.437.1">
&lt;p&gt;
    Event name:
    &lt;InputText @bind-Value="@Claim.Event" /&gt;
&lt;/p&gt;
&lt;p&gt;Date: &lt;InputText @bind-Value="@Claim.Date" /&gt;&lt;/p&gt;
&lt;p&gt;
    Customer name:
    &lt;InputText @bind-Value="@Claim.Customer.Name" /&gt;
&lt;/p&gt;
&lt;p&gt;
    Customer email:
    &lt;InputText @bind-Value="@Claim.Customer.Email" /&gt;
&lt;/p&gt;</span></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.438.1">
      Add a submit button within the form to confirm
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.439.1">
       the input:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.440.1">
&lt;button type="submit"&gt;Submit&lt;/button&gt;</span></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.441.1">
      Lastly, below the submit button, embed a
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.442.1">
       SmartPasteButton
      </span>
     </strong>
     <span class="koboSpan" id="kobo.443.1">
      component with a
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.444.1">
       default icon:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.445.1">
&lt;SmartPasteButton DefaultIcon /&gt;</span></pre>
    </li>
   </ol>
   <h2 id="_idParaDest-362">
    <a id="_idTextAnchor362">
    </a>
    <span class="koboSpan" id="kobo.446.1">
     How it works…
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.447.1">
     In
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.448.1">
      step 1
     </span>
    </em>
    <span class="koboSpan" id="kobo.449.1">
     , we start by configuring the server side of the application.
    </span>
    <span class="koboSpan" id="kobo.449.2">
     We navigate to the project configuration file and add references to two projects required to make
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.450.1">
      SmartComponents
     </span>
    </strong>
    <span class="koboSpan" id="kobo.451.1">
     work on the server.
    </span>
    <span class="koboSpan" id="kobo.451.2">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.452.1">
      SmartComponents.AspNetCore
     </span>
    </strong>
    <span class="koboSpan" id="kobo.453.1">
     project contains server components powered by AI, while the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.454.1">
      SmartComponents.Inference.OpenAI
     </span>
    </strong>
    <span class="koboSpan" id="kobo.455.1">
     project contains an implementation of services to communicate with
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.456.1">
      OpenAI backend.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.457.1">
     In
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.458.1">
      step 2
     </span>
    </em>
    <span class="koboSpan" id="kobo.459.1">
     , we navigate to the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.460.1">
      Program.cs
     </span>
    </strong>
    <span class="koboSpan" id="kobo.461.1">
     file in the server-side project and register
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.462.1">
      SmartComponents
     </span>
    </strong>
    <span class="koboSpan" id="kobo.463.1">
     in the dependency-injection container.
    </span>
    <span class="koboSpan" id="kobo.463.2">
     We also register an
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.464.1">
      OpenAIInferenceBackend
     </span>
    </strong>
    <span class="koboSpan" id="kobo.465.1">
     implementation as the default prompts configuration for
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.466.1">
      SmartComponents
     </span>
    </strong>
    <span class="koboSpan" id="kobo.467.1">
     to use.
    </span>
    <span class="koboSpan" id="kobo.467.2">
     Custom inference implementations come in handy when you leverage the AI to generate texts.
    </span>
    <span class="koboSpan" id="kobo.467.3">
     We will explore that later, in the
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.468.1">
      Implementing a smart text
     </span>
    </em>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.469.1">
       area
      </span>
     </em>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.470.1">
      recipe.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.471.1">
     In
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.472.1">
      step 3
     </span>
    </em>
    <span class="koboSpan" id="kobo.473.1">
     , we complete the setup of
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.474.1">
      SmartComponents
     </span>
    </strong>
    <span class="koboSpan" id="kobo.475.1">
     by navigating to the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.476.1">
      appSettings.json
     </span>
    </strong>
    <span class="koboSpan" id="kobo.477.1">
     file on the server side.
    </span>
    <span class="koboSpan" id="kobo.477.2">
     As
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.478.1">
      appSettings.json
     </span>
    </strong>
    <span class="koboSpan" id="kobo.479.1">
     is a configuration source of the application, we extend the JSON with a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.480.1">
      SmartComponents
     </span>
    </strong>
    <span class="koboSpan" id="kobo.481.1">
     section
    </span>
    <a id="_idIndexMarker498">
    </a>
    <span class="koboSpan" id="kobo.482.1">
     and key nodes, representing the API key and endpoint and the model deployment name that the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.483.1">
      SmartComponents
     </span>
    </strong>
    <span class="koboSpan" id="kobo.484.1">
     components
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.485.1">
      must use.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.486.1">
     In
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.487.1">
      step 4
     </span>
    </em>
    <span class="koboSpan" id="kobo.488.1">
     , we jump to the client side of the application.
    </span>
    <span class="koboSpan" id="kobo.488.2">
     In-line with default Blazor component packages,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.489.1">
      SmartComponents
     </span>
    </strong>
    <span class="koboSpan" id="kobo.490.1">
     also has component counterparts for rendering in WebAssembly mode.
    </span>
    <span class="koboSpan" id="kobo.490.2">
     We navigate to the configuration file of the client-side project and add a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.491.1">
      SmartComponents.AspNetCore.Components
     </span>
    </strong>
    <span class="koboSpan" id="kobo.492.1">
     project
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.493.1">
      reference there.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.494.1">
     In
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.495.1">
      step 5
     </span>
    </em>
    <span class="koboSpan" id="kobo.496.1">
     , we create a routable
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.497.1">
      FillClaim
     </span>
    </strong>
    <span class="koboSpan" id="kobo.498.1">
     component and reference the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.499.1">
      SmartComponents
     </span>
    </strong>
    <span class="koboSpan" id="kobo.500.1">
     assembly.
    </span>
    <span class="koboSpan" id="kobo.500.2">
     Next, we build a form where the support team can fill in claim details with the help
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.501.1">
      of AI.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.502.1">
     In
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.503.1">
      step 6
     </span>
    </em>
    <span class="koboSpan" id="kobo.504.1">
     , we initialize an
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.505.1">
      @code
     </span>
    </strong>
    <span class="koboSpan" id="kobo.506.1">
     block and declare a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.507.1">
      Claim
     </span>
    </strong>
    <span class="koboSpan" id="kobo.508.1">
     parameter that will also act as the backing model of the claim form.
    </span>
    <span class="koboSpan" id="kobo.508.2">
     If you’re new to form creation in Blazor, we covered that in detail in
    </span>
    <a href="B22020_06.xhtml#_idTextAnchor203">
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.509.1">
        Chapter 6
       </span>
      </em>
     </span>
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.510.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.511.1">
     In
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.512.1">
      step 7
     </span>
    </em>
    <span class="koboSpan" id="kobo.513.1">
     , we construct a form frame using
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.514.1">
      EditForm
     </span>
    </strong>
    <span class="koboSpan" id="kobo.515.1">
     and bind it to the
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.516.1">
       Claim
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.517.1">
      model.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.518.1">
     In
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.519.1">
      step 8
     </span>
    </em>
    <span class="koboSpan" id="kobo.520.1">
     , we build a simple form body, allowing the user to fill in an event name, date, customer name, and email – enough to identify and process
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.521.1">
      the claim.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.522.1">
     In
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.523.1">
      step 9
     </span>
    </em>
    <span class="koboSpan" id="kobo.524.1">
     , we complete the form by adding a
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.525.1">
      submit button.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.526.1">
     Lastly, in
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.527.1">
      step 10
     </span>
    </em>
    <span class="koboSpan" id="kobo.528.1">
     , we enhance the form with AI by embedding the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.529.1">
      SmartPasteButton
     </span>
    </strong>
    <span class="koboSpan" id="kobo.530.1">
     component within the form’s body.
    </span>
    <span class="koboSpan" id="kobo.530.2">
     We also declare the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.531.1">
      SmartPasteButton
     </span>
    </strong>
    <span class="koboSpan" id="kobo.532.1">
     component to render with a default icon.
    </span>
    <span class="koboSpan" id="kobo.532.2">
     With that simple setup, you can now transform unstructured data into a ready-to-send form with the help of a (
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.533.1">
      smart) button.
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer060">
     <span class="koboSpan" id="kobo.534.1">
      <img alt="Figure 10.13: A result of smart pasting an e-mail with a claim into a form" src="image/B22020_10_13.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.535.1">
     Figure 10.13: A result of smart pasting an e-mail with a claim into a form
    </span>
   </p>
   <h2 id="_idParaDest-363">
    <a id="_idTextAnchor363">
    </a>
    <span class="koboSpan" id="kobo.536.1">
     There’s more…
    </span>
   </h2>
   <p>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.537.1">
      SmartComponents
     </span>
    </strong>
    <span class="koboSpan" id="kobo.538.1">
     can also work with the OpenAI API key.
    </span>
    <span class="koboSpan" id="kobo.538.2">
     If you already have an OpenAI account, navigate to the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.539.1">
      following URL:
     </span>
    </span>
   </p>
   <p>
    <a href="https://platform.openai.com/api-keys">
     <span class="No-Break">
      <span class="koboSpan" id="kobo.540.1">
       https://platform.openai.com/api-keys
      </span>
     </span>
    </a>
   </p>
   <p>
    <span class="koboSpan" id="kobo.541.1">
     Here, you’ll be able to create an API key that allows you to access the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.542.1">
      ChatGPT API:
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer061">
     <span class="koboSpan" id="kobo.543.1">
      <img alt="Figure 10.14: Creating an API key to access the OpenAI API" src="image/B22020_10_14.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.544.1">
     Figure 10.14: Creating an API key to access the OpenAI API
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.545.1">
     Once you have the API key, open the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.546.1">
      appSettings.json
     </span>
    </strong>
    <span class="koboSpan" id="kobo.547.1">
     file of the server-side application and update the
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.548.1">
       SmartComponents
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.549.1">
      section:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.550.1">
{
  "SmartComponents": {
    "ApiKey": "YOUR_API_KEY",
    "DeploymentName": "gpt-4o"
  }
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.551.1">
     In the preceding
    </span>
    <a id="_idIndexMarker499">
    </a>
    <span class="koboSpan" id="kobo.552.1">
     configuration, the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.553.1">
      ApiKey
     </span>
    </strong>
    <span class="koboSpan" id="kobo.554.1">
     node still represents your API key, while the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.555.1">
      DeploymentName
     </span>
    </strong>
    <span class="koboSpan" id="kobo.556.1">
     node now defines the GPT model you want to use.
    </span>
    <span class="koboSpan" id="kobo.556.2">
     Notice that the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.557.1">
      Endpoint
     </span>
    </strong>
    <span class="koboSpan" id="kobo.558.1">
     node is no longer needed.
    </span>
    <span class="koboSpan" id="kobo.558.2">
     When you don’t provide an
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.559.1">
      Endpoint
     </span>
    </strong>
    <span class="koboSpan" id="kobo.560.1">
     value explicitly,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.561.1">
      SmartComponents
     </span>
    </strong>
    <span class="koboSpan" id="kobo.562.1">
     will fall back to the default OpenAI
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.563.1">
      API URI.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-364">
    <a id="_idTextAnchor364">
    </a>
    <span class="koboSpan" id="kobo.564.1">
     Implementing a smart text area
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.565.1">
     You’ve probably
    </span>
    <a id="_idIndexMarker500">
    </a>
    <span class="koboSpan" id="kobo.566.1">
     seen the generative power of AI in action – you provide a context, and a wall of sensible text appears.
    </span>
    <span class="koboSpan" id="kobo.566.2">
     No more writer’s block, right?
    </span>
    <span class="koboSpan" id="kobo.566.3">
     Generative AI is a game-changer for all text-driven features in your application.
    </span>
    <span class="koboSpan" id="kobo.566.4">
     You can take store item descriptions or event descriptions from a list of bullet points into well-written copy in seconds.
    </span>
    <span class="koboSpan" id="kobo.566.5">
     With
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.567.1">
      SmartComponents
     </span>
    </strong>
    <span class="koboSpan" id="kobo.568.1">
     , we can easily connect to an AI model and leverage the generative power, making content creation faster and
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.569.1">
      more intuitive.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.570.1">
     Let’s implement a text area where the support team can fill in a message attached to a response to a
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.571.1">
      client’s claim.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-365">
    <a id="_idTextAnchor365">
    </a>
    <span class="koboSpan" id="kobo.572.1">
     Getting ready
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.573.1">
     Before we explore the AI-powered text area implementation, we must do
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.574.1">
      the following:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.575.1">
      Create a
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.576.1">
       Chapter10
      </span>
     </strong>
     <span class="koboSpan" id="kobo.577.1">
      /
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.578.1">
       Recipe03
      </span>
     </strong>
     <span class="koboSpan" id="kobo.579.1">
      directory – this will be our
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.580.1">
       working directory
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.581.1">
      Copy the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.582.1">
       FillClaim
      </span>
     </strong>
     <span class="koboSpan" id="kobo.583.1">
      component from the
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.584.1">
       Implementing smart pasting
      </span>
     </em>
     <span class="koboSpan" id="kobo.585.1">
      recipe or from the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.586.1">
       Chapter10
      </span>
     </strong>
     <span class="koboSpan" id="kobo.587.1">
      /
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.588.1">
       Recipe02
      </span>
     </strong>
     <span class="koboSpan" id="kobo.589.1">
      directory in the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.590.1">
       GitHub repository
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.591.1">
      Copy the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.592.1">
       Models
      </span>
     </strong>
     <span class="koboSpan" id="kobo.593.1">
      from the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.594.1">
       Chapter10
      </span>
     </strong>
     <span class="koboSpan" id="kobo.595.1">
      /
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.596.1">
       Data
      </span>
     </strong>
     <span class="koboSpan" id="kobo.597.1">
      directory in the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.598.1">
       GitHub repository
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.599.1">
      If you’re starting
     </span>
     <a id="_idIndexMarker501">
     </a>
     <span class="koboSpan" id="kobo.600.1">
      here, review instructions from
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.601.1">
       step 1
      </span>
     </em>
     <span class="koboSpan" id="kobo.602.1">
      to
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.603.1">
       step 4
      </span>
     </em>
     <span class="koboSpan" id="kobo.604.1">
      of the
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.605.1">
       Implementing smart pasting
      </span>
     </em>
     <span class="koboSpan" id="kobo.606.1">
      recipe for an initial
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.607.1">
        SmartComponents
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.608.1">
       configuration
      </span>
     </span>
    </li>
   </ul>
   <h2 id="_idParaDest-366">
    <a id="_idTextAnchor366">
    </a>
    <span class="koboSpan" id="kobo.609.1">
     How to do it…
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.610.1">
     Follow these instructions to add a smart text area to
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.611.1">
      your application:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.612.1">
      Navigate to the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.613.1">
       @code
      </span>
     </strong>
     <span class="koboSpan" id="kobo.614.1">
      block of the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.615.1">
       FillClaim
      </span>
     </strong>
     <span class="koboSpan" id="kobo.616.1">
      component and add a
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.617.1">
       replier
      </span>
     </strong>
     <span class="koboSpan" id="kobo.618.1">
      variable that defines the person filling out the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.619.1">
       claim form:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.620.1">
const string replier =
    "An event organizer support team member replying
    to a claim request.";</span></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.621.1">
      Jump to the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.622.1">
       EditForm
      </span>
     </strong>
     <span class="koboSpan" id="kobo.623.1">
      body in the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.624.1">
       FillClaim
      </span>
     </strong>
     <span class="koboSpan" id="kobo.625.1">
      markup and extend the form by embedding a
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.626.1">
       SmartTextArea
      </span>
     </strong>
     <span class="koboSpan" id="kobo.627.1">
      component above the submission button.
     </span>
     <span class="koboSpan" id="kobo.627.2">
      Attach the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.628.1">
       replier
      </span>
     </strong>
     <span class="koboSpan" id="kobo.629.1">
      variable to the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.630.1">
       UserRole
      </span>
     </strong>
     <span class="koboSpan" id="kobo.631.1">
      parameter of the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.632.1">
       SmartTextArea
      </span>
     </strong>
     <span class="koboSpan" id="kobo.633.1">
      component and bind the text area value to the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.634.1">
       Message
      </span>
     </strong>
     <span class="koboSpan" id="kobo.635.1">
      property of the
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.636.1">
        Claim
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.637.1">
       instance:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.638.1">
&lt;p&gt;
    &lt;SmartTextArea
        @bind-Value="@Claim.Message"
        rows="5" cols="50"
        UserRole="@replier" /&gt;
&lt;/p&gt;</span></pre>
    </li>
   </ol>
   <h2 id="_idParaDest-367">
    <a id="_idTextAnchor367">
    </a>
    <span class="koboSpan" id="kobo.639.1">
     How it works…
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.640.1">
     In
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.641.1">
      step 1
     </span>
    </em>
    <span class="koboSpan" id="kobo.642.1">
     , we jump straight to the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.643.1">
      FillClaim
     </span>
    </strong>
    <span class="koboSpan" id="kobo.644.1">
     component.
    </span>
    <span class="koboSpan" id="kobo.644.2">
     First, we move to the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.645.1">
      @code
     </span>
    </strong>
    <span class="koboSpan" id="kobo.646.1">
     block and declare a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.647.1">
      replier
     </span>
    </strong>
    <span class="koboSpan" id="kobo.648.1">
     variable, where we put a brief but detailed description of the persona that we want the AI to represent.
    </span>
    <span class="koboSpan" id="kobo.648.2">
     Considering that AI models learn from content written by humans, you should strive to make the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.649.1">
      replier
     </span>
    </strong>
    <span class="koboSpan" id="kobo.650.1">
     description as natural as you would sound when speaking to
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.651.1">
      a friend.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.652.1">
     In
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.653.1">
      step 2
     </span>
    </em>
    <span class="koboSpan" id="kobo.654.1">
     , we locate the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.655.1">
      EditForm
     </span>
    </strong>
    <span class="koboSpan" id="kobo.656.1">
     markup in the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.657.1">
      FillClaim
     </span>
    </strong>
    <span class="koboSpan" id="kobo.658.1">
     markup.
    </span>
    <span class="koboSpan" id="kobo.658.2">
     Above the submission button, we embed a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.659.1">
      SmartTextArea
     </span>
    </strong>
    <span class="koboSpan" id="kobo.660.1">
     component.
    </span>
    <span class="koboSpan" id="kobo.660.2">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.661.1">
      SmartTextArea
     </span>
    </strong>
    <span class="koboSpan" id="kobo.662.1">
     component supports the bind-value binding pattern (you can learn more about binding in
    </span>
    <a href="B22020_03.xhtml#_idTextAnchor095">
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.663.1">
        Chapter 3
       </span>
      </em>
     </span>
    </a>
    <span class="koboSpan" id="kobo.664.1">
     ) and allows
    </span>
    <a id="_idIndexMarker502">
    </a>
    <span class="koboSpan" id="kobo.665.1">
     defining standard
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.666.1">
      textarea
     </span>
    </strong>
    <span class="koboSpan" id="kobo.667.1">
     attributes, such as
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.668.1">
      rows
     </span>
    </strong>
    <span class="koboSpan" id="kobo.669.1">
     or
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.670.1">
      cols
     </span>
    </strong>
    <span class="koboSpan" id="kobo.671.1">
     , representing the default size of the text box.
    </span>
    <span class="koboSpan" id="kobo.671.2">
     It also allows setting a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.672.1">
      UserRole
     </span>
    </strong>
    <span class="koboSpan" id="kobo.673.1">
     parameter – that’s where we attach our persona definition stored
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.674.1">
      in
     </span>
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.675.1">
       replier
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.676.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.677.1">
     That’s all it takes to add a generative field to
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.678.1">
      your application:
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer062">
     <span class="koboSpan" id="kobo.679.1">
      <img alt="Figure 10.15: AI helping to write a claim response as user types the message" src="image/B22020_10_15.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.680.1">
     Figure 10.15: AI helping to write a claim response as user types the message
    </span>
   </p>
   <h2 id="_idParaDest-368">
    <a id="_idTextAnchor368">
    </a>
    <span class="koboSpan" id="kobo.681.1">
     There’s more…
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.682.1">
     So far, we used the default inference configuration provided by the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.683.1">
      SmartComponents
     </span>
    </strong>
    <span class="koboSpan" id="kobo.684.1">
     package.
    </span>
    <span class="koboSpan" id="kobo.684.2">
     However, you can customize the prompt and AI behavior by implementing a custom
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.685.1">
      SmartTextAreaInference
     </span>
    </strong>
    <span class="koboSpan" id="kobo.686.1">
     logic.
    </span>
    <span class="koboSpan" id="kobo.686.2">
     Since AI communication and processing only happen on the server, you must keep prompt customization in the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.687.1">
      server-side project.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.688.1">
     Let’s create a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.689.1">
      ClaimReplyInference
     </span>
    </strong>
    <span class="koboSpan" id="kobo.690.1">
     class, inheriting from
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.691.1">
      SmartTextAreaInference
     </span>
    </strong>
    <span class="koboSpan" id="kobo.692.1">
     , and
    </span>
    <a id="_idIndexMarker503">
    </a>
    <span class="koboSpan" id="kobo.693.1">
     customize suggestions coming in the
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.694.1">
       FillClaim
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.695.1">
      form:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.696.1">
public class ClaimReplyInference : SmartTextAreaInference
{
    public override ChatParameters BuildPrompt(
        SmartTextAreaConfig config,
        string textBefore, string textAfter
    )
    {
        var prompt = base.BuildPrompt(
            config, textBefore, textAfter
        );
        var systemMessage = new ChatMessage(
            ChatMessageRole.System,
            "Make suggestions in a professional tone."
</span><span class="koboSpan" id="kobo.696.2">        );
        prompt.Messages.Add(systemMessage);
        prompt.Temperature = 0.7f;
        return prompt;
    }
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.697.1">
     In
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.698.1">
      ClaimReplyInference
     </span>
    </strong>
    <span class="koboSpan" id="kobo.699.1">
     , we override the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.700.1">
      BuildPrompt()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.701.1">
     method.
    </span>
    <span class="koboSpan" id="kobo.701.2">
     We leverage the base implementation to build the prompt but customize it afterward.
    </span>
    <span class="koboSpan" id="kobo.701.3">
     First, we append an additional
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.702.1">
      ChatMessage
     </span>
    </strong>
    <span class="koboSpan" id="kobo.703.1">
     instance to the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.704.1">
      Messages
     </span>
    </strong>
    <span class="koboSpan" id="kobo.705.1">
     collection the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.706.1">
      prompt
     </span>
    </strong>
    <span class="koboSpan" id="kobo.707.1">
     already has.
    </span>
    <span class="koboSpan" id="kobo.707.2">
     We define that new
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.708.1">
      ChatMessage
     </span>
    </strong>
    <span class="koboSpan" id="kobo.709.1">
     role as
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.710.1">
      System
     </span>
    </strong>
    <span class="koboSpan" id="kobo.711.1">
     .
    </span>
    <span class="koboSpan" id="kobo.711.2">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.712.1">
      System
     </span>
    </strong>
    <span class="koboSpan" id="kobo.713.1">
     message sets the overall behavior of the AI model, indicating that we expect a professional tone of suggestions.
    </span>
    <span class="koboSpan" id="kobo.713.2">
     Lastly, we customize the value of the prompt’s
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.714.1">
      Temperature
     </span>
    </strong>
    <span class="koboSpan" id="kobo.715.1">
     property.
    </span>
    <span class="koboSpan" id="kobo.715.2">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.716.1">
      Temperature
     </span>
    </strong>
    <span class="koboSpan" id="kobo.717.1">
     setting controls the randomness of the AI responses, with lower values making the output more focused and deterministic and higher values making it more creative
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.718.1">
      and varied.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.719.1">
     Having
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.720.1">
      ClaimReplyInference
     </span>
    </strong>
    <span class="koboSpan" id="kobo.721.1">
     in place, we must add it to the dependency
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.722.1">
      injection container:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.723.1">
builder.Services.AddSingleton&lt;SmartTextAreaInference,
    ClaimReplyInference&gt;()</span></pre>
   <p>
    <span class="koboSpan" id="kobo.724.1">
     In the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.725.1">
      Program
     </span>
    </strong>
    <span class="koboSpan" id="kobo.726.1">
     entry
    </span>
    <a id="_idIndexMarker504">
    </a>
    <span class="koboSpan" id="kobo.727.1">
     class, we register the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.728.1">
      SmartTextAreaInference
     </span>
    </strong>
    <span class="koboSpan" id="kobo.729.1">
     class as a singleton.
    </span>
    <span class="koboSpan" id="kobo.729.2">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.730.1">
      SmartTextArea
     </span>
    </strong>
    <span class="koboSpan" id="kobo.731.1">
     component will automatically discover the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.732.1">
      new implementation.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.733.1">
     Now, users will get more
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.734.1">
      official-sounding suggestions:
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer063">
     <span class="koboSpan" id="kobo.735.1">
      <img alt="Figure 10.16: AI generating suggestions in a professional tone, to help a user replay to a claim" src="image/B22020_10_16.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.736.1">
     Figure 10.16: AI generating suggestions in a professional tone, to help a user replay to a claim
    </span>
   </p>
   <h2 id="_idParaDest-369">
    <a id="_idTextAnchor369">
    </a>
    <span class="koboSpan" id="kobo.737.1">
     See also
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.738.1">
     You can customize all available
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.739.1">
      SmartComponents
     </span>
    </strong>
    <span class="koboSpan" id="kobo.740.1">
     components and fine-tune the AI behavior to your application needs.
    </span>
    <span class="koboSpan" id="kobo.740.2">
     If you want to learn more, check out the official
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.741.1">
      SmartComponents
     </span>
    </strong>
    <span class="koboSpan" id="kobo.742.1">
     docs on GitHub
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.743.1">
      at
     </span>
    </span>
    <a href="https://github.com/dotnet-smartcomponents/smartcomponents/tree/main">
     <span class="No-Break">
      <span class="koboSpan" id="kobo.744.1">
       https://github.com/dotnet-smartcomponents/smartcomponents/tree/main
      </span>
     </span>
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.745.1">
      .
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-370">
    <a id="_idTextAnchor370">
    </a>
    <span class="koboSpan" id="kobo.746.1">
     Adding a ChatBot
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.747.1">
     ChatGPT, developed
    </span>
    <a id="_idIndexMarker505">
    </a>
    <span class="koboSpan" id="kobo.748.1">
     by OpenAI, is an advanced conversational AI model that has gained significant attention since its release.
    </span>
    <span class="koboSpan" id="kobo.748.2">
     It’s designed to understand and generate human-like text based on the input it receives, making interactions with it feel natural and intuitive.
    </span>
    <span class="koboSpan" id="kobo.748.3">
     The versatility of the GPT models enables their application in numerous contexts, from customer support and personal assistants to educational tools
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.749.1">
      and entertainment.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.750.1">
     Let’s construct a primitive chat UI and connect it to the Azure OpenAI service to embed a ChatGPT-like chat functionality in the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.751.1">
      Blazor application.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-371">
    <a id="_idTextAnchor371">
    </a>
    <span class="koboSpan" id="kobo.752.1">
     Getting ready
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.753.1">
     Similar to
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.754.1">
      SmartComponents
     </span>
    </strong>
    <span class="koboSpan" id="kobo.755.1">
     , which we explored in previous chapters, the chat will require Azure OpenAI API access.
    </span>
    <span class="koboSpan" id="kobo.755.2">
     To avoid leaking API access details, we move to the server side of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.756.1">
      the application.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.757.1">
     Before we dive into building AI-powered chat, we must do
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.758.1">
      the following:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.759.1">
      Create a
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.760.1">
       Chapter10
      </span>
     </strong>
     <span class="koboSpan" id="kobo.761.1">
      /
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.762.1">
       Recipe04
      </span>
     </strong>
     <span class="koboSpan" id="kobo.763.1">
      directory – this will be your
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.764.1">
       working directory
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.765.1">
      Copy the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.766.1">
       InputModel
      </span>
     </strong>
     <span class="koboSpan" id="kobo.767.1">
      from the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.768.1">
       Chapter10
      </span>
     </strong>
     <span class="koboSpan" id="kobo.769.1">
      /
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.770.1">
       Data
      </span>
     </strong>
     <span class="koboSpan" id="kobo.771.1">
      directory in the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.772.1">
       GitHub repository
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.773.1">
      Prepare the Azure OpenAI Service connection details (you can see how to get them in the
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.774.1">
       There’s more…
      </span>
     </em>
     <span class="koboSpan" id="kobo.775.1">
      section of the
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.776.1">
       Setting up an Azure OpenAI
      </span>
     </em>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.777.1">
        service
       </span>
      </em>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.778.1">
       recipe)
      </span>
     </span>
    </li>
   </ul>
   <h2 id="_idParaDest-372">
    <a id="_idTextAnchor372">
    </a>
    <span class="koboSpan" id="kobo.779.1">
     How to do it…
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.780.1">
     Follow these steps to add an AI-powered chat to
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.781.1">
      an application:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.782.1">
      Navigate to the configuration file of the server-side project and include the latest version of the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.783.1">
       Azure.AI.OpenAI
      </span>
     </strong>
     <span class="koboSpan" id="kobo.784.1">
      package (at the time of writing, it’s still
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.785.1">
       in preview):
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.786.1">
&lt;ItemGroup&gt;
  &lt;PackageReference
    Include="Azure.AI.OpenAI"
    Version="2.0.0-beta.2" /&gt;
&lt;/ItemGroup&gt;</span></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.787.1">
      Open the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.788.1">
       appsettings.json
      </span>
     </strong>
     <span class="koboSpan" id="kobo.789.1">
      file with the server project configuration and add a
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.790.1">
       ChatBot
      </span>
     </strong>
     <span class="koboSpan" id="kobo.791.1">
      section with the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.792.1">
       required nodes:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.793.1">
{
  "ChatBot": {
    "ApiKey": "YOUR_API_KEY",
    "Endpoint": "YOUR_ENDPOINT",
    "DeploymentName": "YOUR_MODEL_DEPLOYMENT"
  }
}</span></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.794.1">
      Move to the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.795.1">
       Program.cs
      </span>
     </strong>
     <span class="koboSpan" id="kobo.796.1">
      entry
     </span>
     <a id="_idIndexMarker506">
     </a>
     <span class="koboSpan" id="kobo.797.1">
      file of the server-side project, and right after the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.798.1">
       builder
      </span>
     </strong>
     <span class="koboSpan" id="kobo.799.1">
      instance is initialized, intercept the chat configuration
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.800.1">
       into variables:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.801.1">
var endpoint = builder
    .Configuration["ChatBot:Endpoint"];
var apiKey = builder
    .Configuration["ChatBot:ApiKey"];
var deploymentName = builder
    .Configuration["ChatBot:DeploymentName"];</span></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.802.1">
      Below the configuration variables, register an
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.803.1">
       AzureOpenAIClient
      </span>
     </strong>
     <span class="koboSpan" id="kobo.804.1">
      service as a singleton by passing the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.805.1">
       endpoint
      </span>
     </strong>
     <span class="koboSpan" id="kobo.806.1">
      and
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.807.1">
       apiKey
      </span>
     </strong>
     <span class="koboSpan" id="kobo.808.1">
      variables into the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.809.1">
       service constructor:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.810.1">
builder.Services.AddSingleton(
    new AzureOpenAIClient(
        new Uri(endpoint),
        new AzureKeyCredential(apiKey)
));</span></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.811.1">
      After registering
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.812.1">
       AzureOpenAIClient
      </span>
     </strong>
     <span class="koboSpan" id="kobo.813.1">
      , add a
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.814.1">
       ChatClient
      </span>
     </strong>
     <span class="koboSpan" id="kobo.815.1">
      service to the dependency injection container as scoped.
     </span>
     <span class="koboSpan" id="kobo.815.2">
      Leverage the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.816.1">
       AzureOpenAIClient
      </span>
     </strong>
     <span class="koboSpan" id="kobo.817.1">
      API
     </span>
     <a id="_idIndexMarker507">
     </a>
     <span class="koboSpan" id="kobo.818.1">
      and
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.819.1">
       deploymentName
      </span>
     </strong>
     <span class="koboSpan" id="kobo.820.1">
      to construct the
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.821.1">
        ChatClient
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.822.1">
       instance:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.823.1">
builder.Services
    .AddScoped(services =&gt;
    {
        var openAI = services
            .GetRequiredService&lt;AzureOpenAIClient&gt;();
        return openAI.GetChatClient(deploymentName);
    });</span></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.824.1">
      Create a routable
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.825.1">
       ChatBot
      </span>
     </strong>
     <span class="koboSpan" id="kobo.826.1">
      component, rendering in the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.827.1">
       InteractiveServer
      </span>
     </strong>
     <span class="koboSpan" id="kobo.828.1">
      mode and referencing the
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.829.1">
        OpenAI.Chat
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.830.1">
       assembly:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.831.1">
@page "/ch10r04"
@rendermode InteractiveServer
@using OpenAI.Chat</span></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.832.1">
      Initialize the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.833.1">
       @code
      </span>
     </strong>
     <span class="koboSpan" id="kobo.834.1">
      block in the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.835.1">
       ChatBot
      </span>
     </strong>
     <span class="koboSpan" id="kobo.836.1">
      component and inject the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.837.1">
       ChatClient
      </span>
     </strong>
     <span class="koboSpan" id="kobo.838.1">
      service
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.839.1">
       as
      </span>
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.840.1">
        Chat
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.841.1">
       :
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.842.1">
@code {
    [Inject] private ChatClient Chat { get; init; }
}</span></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.843.1">
      Below the service injection, initialize a
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.844.1">
       Model
      </span>
     </strong>
     <span class="koboSpan" id="kobo.845.1">
      instance to bind to the input form and
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.846.1">
       Messages
      </span>
     </strong>
     <span class="koboSpan" id="kobo.847.1">
      collection to persist chat messages to display on
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.848.1">
       the UI:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.849.1">
protected InputModel Model = new();
protected List&lt;string&gt; Messages = [];</span></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.850.1">
      Below the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.851.1">
       Messages
      </span>
     </strong>
     <span class="koboSpan" id="kobo.852.1">
      collection, initialize a
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.853.1">
       _messages
      </span>
     </strong>
     <span class="koboSpan" id="kobo.854.1">
      collection to hold messages in a form transferable to the Azure OpenAI Service.
     </span>
     <span class="koboSpan" id="kobo.854.2">
      Start the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.855.1">
       _messages
      </span>
     </strong>
     <span class="koboSpan" id="kobo.856.1">
      collection
     </span>
     <a id="_idIndexMarker508">
     </a>
     <span class="koboSpan" id="kobo.857.1">
      with a system prompt, defining the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.858.1">
       chatbot’s persona:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.859.1">
private List&lt;ChatMessage&gt; _messages =
[
    new SystemChatMessage(
        "Act as a friendly salesman for the Blazor Web
        Development Cookbook written by Pawel
        Bazyluk."
</span><span class="koboSpan" id="kobo.859.2">    )
];</span></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.860.1">
      Next to the backing variables, implement a
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.861.1">
       SendMessage()
      </span>
     </strong>
     <span class="koboSpan" id="kobo.862.1">
      method.
     </span>
     <span class="koboSpan" id="kobo.862.2">
      Start by checking the validity of the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.863.1">
       Model
      </span>
     </strong>
     <span class="koboSpan" id="kobo.864.1">
      state.
     </span>
     <span class="koboSpan" id="kobo.864.2">
      If the input is valid, convert it to the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.865.1">
       UserChatMessage
      </span>
     </strong>
     <span class="koboSpan" id="kobo.866.1">
      object and add the message to the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.867.1">
       backing collections:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.868.1">
private async Task SendMessage()
{
    if (!Model.IsValid) return;
    var message = new UserChatMessage(Model.Value);
    Messages.Add($"You: {Model.Value}");
    _messages.Add(message);
    //continue here...
</span><span class="koboSpan" id="kobo.868.2">}</span></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.869.1">
      Still within the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.870.1">
       SendMessage()
      </span>
     </strong>
     <span class="koboSpan" id="kobo.871.1">
      method, request chat completion by passing the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.872.1">
       _messages
      </span>
     </strong>
     <span class="koboSpan" id="kobo.873.1">
      collection to the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.874.1">
       CompleteChatAsync()
      </span>
     </strong>
     <span class="koboSpan" id="kobo.875.1">
      method of the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.876.1">
       Chat
      </span>
     </strong>
     <span class="koboSpan" id="kobo.877.1">
      service and resolve the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.878.1">
       response payload:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.879.1">
var chatResponse = await Chat
    .CompleteChatAsync(_messages);
var response = chatResponse.Value.Content[0].Text;
// continue here...</span></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.880.1">
      Complete the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.881.1">
       SendMessage()
      </span>
     </strong>
     <span class="koboSpan" id="kobo.882.1">
      method by persisting the received response in the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.883.1">
       Messages
      </span>
     </strong>
     <span class="koboSpan" id="kobo.884.1">
      collection
     </span>
     <a id="_idIndexMarker509">
     </a>
     <span class="koboSpan" id="kobo.885.1">
      and in the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.886.1">
       _messages
      </span>
     </strong>
     <span class="koboSpan" id="kobo.887.1">
      collection as an
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.888.1">
       AssistantChatMessage
      </span>
     </strong>
     <span class="koboSpan" id="kobo.889.1">
      object.
     </span>
     <span class="koboSpan" id="kobo.889.2">
      Lastly, reset
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.890.1">
       Value
      </span>
     </strong>
     <span class="koboSpan" id="kobo.891.1">
      of the
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.892.1">
        Model
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.893.1">
       object:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.894.1">
_messages.Add(new AssistantChatMessage(response));
Messages.Add($"OpenAI: {response}");
Model.Value = string.Empty;</span></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.895.1">
      Move to the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.896.1">
       ChatBot
      </span>
     </strong>
     <span class="koboSpan" id="kobo.897.1">
      markup and construct a simple
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.898.1">
       EditForm
      </span>
     </strong>
     <span class="koboSpan" id="kobo.899.1">
      form with a single input field bound to the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.900.1">
       Model
      </span>
     </strong>
     <span class="koboSpan" id="kobo.901.1">
      variable, triggering
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.902.1">
       SendMessage()
      </span>
     </strong>
     <span class="koboSpan" id="kobo.903.1">
      when submitted.
     </span>
     <span class="koboSpan" id="kobo.903.2">
      If
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.904.1">
       EditForm
      </span>
     </strong>
     <span class="koboSpan" id="kobo.905.1">
      is not recognized as a component, include a
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.906.1">
       @using Microsoft.AspNetCore.Components.Forms
      </span>
     </strong>
     <span class="koboSpan" id="kobo.907.1">
      reference at the top of the
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.908.1">
        FillClaim
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.909.1">
       component:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.910.1">
&lt;h3&gt;What can I help you with?&lt;/h3&gt;
&lt;EditForm Model="@Model" FormName="chat-input"
          OnSubmit="@SendMessage"&gt;
    &lt;InputText @bind-Value="@Model.Value" /&gt;
    &lt;button type="submit"&gt;Send&lt;/button&gt;
&lt;/EditForm&gt;</span></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.911.1">
      Below the input form, iterate over the elements in the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.912.1">
       Messages
      </span>
     </strong>
     <span class="koboSpan" id="kobo.913.1">
      collection and render them in
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.914.1">
       separate paragraphs:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.915.1">
&lt;hr /&gt;
@foreach (var message in Messages)
{
    &lt;p&gt;@message&lt;/p&gt;
}</span></pre>
    </li>
   </ol>
   <h2 id="_idParaDest-373">
    <a id="_idTextAnchor373">
    </a>
    <span class="koboSpan" id="kobo.916.1">
     How it works…
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.917.1">
     In
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.918.1">
      step 1
     </span>
    </em>
    <span class="koboSpan" id="kobo.919.1">
     , we start by adding the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.920.1">
      Azure.AI.OpenAI
     </span>
    </strong>
    <span class="koboSpan" id="kobo.921.1">
     package to the server side of the application.
    </span>
    <span class="koboSpan" id="kobo.921.2">
     If you’ve
    </span>
    <a id="_idIndexMarker510">
    </a>
    <span class="koboSpan" id="kobo.922.1">
     been using the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.923.1">
      NuGet Package Manager
     </span>
    </strong>
    <span class="koboSpan" id="kobo.924.1">
     , you’ll have to include prerelease versions of the packages, as
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.925.1">
      Azure.AI.OpenAI
     </span>
    </strong>
    <span class="koboSpan" id="kobo.926.1">
     is still in preview at the time
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.927.1">
      of writing.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.928.1">
     In
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.929.1">
      step 2
     </span>
    </em>
    <span class="koboSpan" id="kobo.930.1">
     , we add a chatbot configuration section to the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.931.1">
      appsettings.json
     </span>
    </strong>
    <span class="koboSpan" id="kobo.932.1">
     file.
    </span>
    <span class="koboSpan" id="kobo.932.2">
     We will need an
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.933.1">
      ApiKey
     </span>
    </strong>
    <span class="koboSpan" id="kobo.934.1">
     node, an API
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.935.1">
      Endpoint
     </span>
    </strong>
    <span class="koboSpan" id="kobo.936.1">
     node, and a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.937.1">
      DeploymentName
     </span>
    </strong>
    <span class="koboSpan" id="kobo.938.1">
     node, to specify the name of the model we want
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.939.1">
      to use.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.940.1">
     In
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.941.1">
      step 3
     </span>
    </em>
    <span class="koboSpan" id="kobo.942.1">
     , we navigate to the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.943.1">
      Program.cs
     </span>
    </strong>
    <span class="koboSpan" id="kobo.944.1">
     file of the server-side project, where we register the necessary services in the dependency injection container.
    </span>
    <span class="koboSpan" id="kobo.944.2">
     First, we intercept the chatbot configuration values into
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.945.1">
      endpoint
     </span>
    </strong>
    <span class="koboSpan" id="kobo.946.1">
     ,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.947.1">
      apiKey
     </span>
    </strong>
    <span class="koboSpan" id="kobo.948.1">
     , and
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.949.1">
      deploymentName
     </span>
    </strong>
    <span class="koboSpan" id="kobo.950.1">
     by accessing the configuration reader from the
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.951.1">
       builder
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.952.1">
      instance.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.953.1">
     In
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.954.1">
      step 4
     </span>
    </em>
    <span class="koboSpan" id="kobo.955.1">
     , we register the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.956.1">
      AzureOpenAIClient
     </span>
    </strong>
    <span class="koboSpan" id="kobo.957.1">
     service as a singleton, passing the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.958.1">
      endpoint
     </span>
    </strong>
    <span class="koboSpan" id="kobo.959.1">
     value as the Azure OpenAI URI and initializing
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.960.1">
      AzureKeyCredentials
     </span>
    </strong>
    <span class="koboSpan" id="kobo.961.1">
     with an
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.962.1">
      apiKey
     </span>
    </strong>
    <span class="koboSpan" id="kobo.963.1">
     value.
    </span>
    <span class="koboSpan" id="kobo.963.2">
     We can have a shared instance of the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.964.1">
      AzureOpenAIClient
     </span>
    </strong>
    <span class="koboSpan" id="kobo.965.1">
     service as it’s thread- and scope-safe by design but consider the memory impact in
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.966.1">
      your implementations.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.967.1">
     In
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.968.1">
      step 5
     </span>
    </em>
    <span class="koboSpan" id="kobo.969.1">
     , we add one more service to the dependency injection container – we register a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.970.1">
      ChatClient
     </span>
    </strong>
    <span class="koboSpan" id="kobo.971.1">
     service as scoped.
    </span>
    <span class="koboSpan" id="kobo.971.2">
     We construct the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.972.1">
      ChatClient
     </span>
    </strong>
    <span class="koboSpan" id="kobo.973.1">
     object by resolving the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.974.1">
      AzureOpenAIClient
     </span>
    </strong>
    <span class="koboSpan" id="kobo.975.1">
     instance from the services collection and invoking its
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.976.1">
      GetChatClient()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.977.1">
     method with the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.978.1">
      deploymentName
     </span>
    </strong>
    <span class="koboSpan" id="kobo.979.1">
     value.
    </span>
    <span class="koboSpan" id="kobo.979.2">
     Having services in place, we construct the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.980.1">
      UI part.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.981.1">
     In
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.982.1">
      step 6
     </span>
    </em>
    <span class="koboSpan" id="kobo.983.1">
     , we create a routable
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.984.1">
      ChatBot
     </span>
    </strong>
    <span class="koboSpan" id="kobo.985.1">
     component that references the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.986.1">
      OpenAI.Chat
     </span>
    </strong>
    <span class="koboSpan" id="kobo.987.1">
     assembly, as we will need access to the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.988.1">
      ChatClient
     </span>
    </strong>
    <span class="koboSpan" id="kobo.989.1">
     class definition.
    </span>
    <span class="koboSpan" id="kobo.989.2">
     We also need the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.990.1">
      ChatBot
     </span>
    </strong>
    <span class="koboSpan" id="kobo.991.1">
     component to render in
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.992.1">
      InteractiveServer
     </span>
    </strong>
    <span class="koboSpan" id="kobo.993.1">
     mode, since our users will interact with
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.994.1">
      the chat.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.995.1">
     In
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.996.1">
      step 7
     </span>
    </em>
    <span class="koboSpan" id="kobo.997.1">
     , we initialize the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.998.1">
      @code
     </span>
    </strong>
    <span class="koboSpan" id="kobo.999.1">
     block and inject the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1000.1">
      ChatClient
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1001.1">
     service from the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1002.1">
      dependency injection.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1003.1">
     In
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.1004.1">
      step 8
     </span>
    </em>
    <span class="koboSpan" id="kobo.1005.1">
     , we initialize a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1006.1">
      Model
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1007.1">
     instance to bind the input form where users fill in their messages, as well as a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1008.1">
      Messages
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1009.1">
     collection, where we persist the text representation of the chat and user messages to render them in
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1010.1">
      the markup.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1011.1">
     In
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.1012.1">
      step 9
     </span>
    </em>
    <span class="koboSpan" id="kobo.1013.1">
     , we initialize one more collection –
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1014.1">
      _messages
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1015.1">
     .
    </span>
    <span class="koboSpan" id="kobo.1015.2">
     In
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1016.1">
      _messages
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1017.1">
     , we persist messages in the form of
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1018.1">
      ChatMessage
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1019.1">
     objects.
    </span>
    <span class="koboSpan" id="kobo.1019.2">
     With that, we can easily provide the full context of the conversation when requesting a new response from the Azure OpenAI service; without the history of the messages, we would limit the chat context to the last message the user
    </span>
    <a id="_idIndexMarker511">
    </a>
    <span class="koboSpan" id="kobo.1020.1">
     sends.
    </span>
    <span class="koboSpan" id="kobo.1020.2">
     We also start off
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1021.1">
      _messages
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1022.1">
     with a predefined
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1023.1">
      SystemChatMessage
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1024.1">
     object.
    </span>
    <span class="koboSpan" id="kobo.1024.2">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1025.1">
      SystemChatMessage
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1026.1">
     object allows us to inject a prompt, where we define how the chatbot should behave, but the prompt itself is not a part of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1027.1">
      the conversation.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1028.1">
     In
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.1029.1">
      step 9
     </span>
    </em>
    <span class="koboSpan" id="kobo.1030.1">
     , we implement a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1031.1">
      SendMessage()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1032.1">
     method where all the chatting logic goes.
    </span>
    <span class="koboSpan" id="kobo.1032.2">
     At the beginning, we check whether the submitted
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1033.1">
      Model
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1034.1">
     value is valid and fast-return when there’s nothing to process.
    </span>
    <span class="koboSpan" id="kobo.1034.2">
     Then, we wrap the user input into a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1035.1">
      UserChatMessage
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1036.1">
     object.
    </span>
    <span class="koboSpan" id="kobo.1036.2">
     We must use the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1037.1">
      UserChatMessage
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1038.1">
     objects when sending user inputs so the AI can interpret them accordingly.
    </span>
    <span class="koboSpan" id="kobo.1038.2">
     Next, we add the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1039.1">
      UserChatMessage
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1040.1">
     instance to the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1041.1">
      _messages
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1042.1">
     context collection and format the user input into a chat-like version to add it to the renderable
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1043.1">
       Messages
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1044.1">
      collection.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1045.1">
     In
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.1046.1">
      step 10
     </span>
    </em>
    <span class="koboSpan" id="kobo.1047.1">
     , we leverage the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1048.1">
      Chat
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1049.1">
     instance and its
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1050.1">
      CompleteChatAsync()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1051.1">
     method to request a new chat response from the Azure OpenAI.
    </span>
    <span class="koboSpan" id="kobo.1051.2">
     Notice that we send the entire
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1052.1">
      _messages
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1053.1">
     collection as part of the request so that GPT in the cloud has the full context of the conversation.
    </span>
    <span class="koboSpan" id="kobo.1053.2">
     Then, we unpack the message from the received response
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1054.1">
       Content
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1055.1">
      property.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1056.1">
     In
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.1057.1">
      step 11
     </span>
    </em>
    <span class="koboSpan" id="kobo.1058.1">
     , we push the unpacked payload to the backing variables.
    </span>
    <span class="koboSpan" id="kobo.1058.2">
     This time, we wrap the received message in an
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1059.1">
      AssistantChatMessage
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1060.1">
     object before adding it to the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1061.1">
      _messages
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1062.1">
     collection.
    </span>
    <span class="koboSpan" id="kobo.1062.2">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1063.1">
      AssistantChatMessage
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1064.1">
     type represents responses from the AI itself.
    </span>
    <span class="koboSpan" id="kobo.1064.2">
     Next, we construct a chat-like message to add to the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1065.1">
      Messages
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1066.1">
     collection to render it for the user to see.
    </span>
    <span class="koboSpan" id="kobo.1066.2">
     Finally, we clear the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1067.1">
      Model
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1068.1">
     value to accept another message from
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1069.1">
      the user.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1070.1">
     In
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.1071.1">
      step 12
     </span>
    </em>
    <span class="koboSpan" id="kobo.1072.1">
     , we implement a primitive markup so the user can interact with the chat.
    </span>
    <span class="koboSpan" id="kobo.1072.2">
     We add a call to action at the top and construct an
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1073.1">
      EditForm
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1074.1">
     form.
    </span>
    <span class="koboSpan" id="kobo.1074.2">
     We bind the form to the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1075.1">
      Model
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1076.1">
     instance and attach the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1077.1">
      SendMessage()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1078.1">
     method to its submission callback.
    </span>
    <span class="koboSpan" id="kobo.1078.2">
     Within the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1079.1">
      EditForm
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1080.1">
     markup, we add a single
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1081.1">
      InputText
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1082.1">
     field where the user provides their chat requests and a button allowing them to submit the form and trigger the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1083.1">
      chat generation.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1084.1">
     In
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.1085.1">
      step 13
     </span>
    </em>
    <span class="koboSpan" id="kobo.1086.1">
     , below the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1087.1">
      EditForm
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1088.1">
     component, we construct a simple loop where we iterate over the chat-like messages in the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1089.1">
      Messages
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1090.1">
     collection and render them in
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1091.1">
      separate paragraphs.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1092.1">
     With that simple
    </span>
    <a id="_idIndexMarker512">
    </a>
    <span class="koboSpan" id="kobo.1093.1">
     implementation, you already get a ready-to-talk
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1094.1">
      chat prototype:
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer064">
     <span class="koboSpan" id="kobo.1095.1">
      <img alt="Figure 10.17: Primitive chat UI with a powerful AI-powered backend in action" src="image/B22020_10_17.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.1096.1">
     Figure 10.17: Primitive chat UI with a powerful AI-powered backend in action
    </span>
   </p>
   <h2 id="_idParaDest-374">
    <a id="_idTextAnchor374">
    </a>
    <span class="koboSpan" id="kobo.1097.1">
     There’s more…
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.1098.1">
     Depending on the session or message length that you expect to handle with the chat, you should consider cleaning the context of the conversation periodically.
    </span>
    <span class="koboSpan" id="kobo.1098.2">
     This will help maintain the efficiency and effectiveness of the chat functionality.
    </span>
    <span class="koboSpan" id="kobo.1098.3">
     Managing the length of the chat context impacts both the cost and responsiveness of the chat.
    </span>
    <span class="koboSpan" id="kobo.1098.4">
     Longer contexts can lead to higher costs due to increased API usage and potentially slower response times as more data
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1099.1">
      is processed.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1100.1">
     One effective strategy is to
    </span>
    <a id="_idIndexMarker513">
    </a>
    <span class="koboSpan" id="kobo.1101.1">
     implement a
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1102.1">
      circular buffer
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1103.1">
     of a fixed size.
    </span>
    <span class="koboSpan" id="kobo.1103.2">
     In a circular buffer, new elements
    </span>
    <a id="_idIndexMarker514">
    </a>
    <span class="koboSpan" id="kobo.1104.1">
     are added to the end of the buffer while the oldest elements are overwritten when the buffer reaches its capacity.
    </span>
    <span class="koboSpan" id="kobo.1104.2">
     This approach ensures that the chat context remains within a manageable size, keeping the conversation relevant
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1105.1">
      and efficient.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-375">
    <a id="_idTextAnchor375">
    </a>
    <span class="koboSpan" id="kobo.1106.1">
     See also
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.1107.1">
     If you’d want to explore the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1108.1">
      Azure.AI.OpenAI
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1109.1">
     possibilities further, visit the package docs
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1110.1">
      at
     </span>
    </span>
    <a href="https://github.com/Azure/azure-sdk-for-net/blob/main/sdk/openai/Azure.AI.OpenAI/README.md">
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1111.1">
       https://github.com/Azure/azure-sdk-for-net/blob/main/sdk/openai/Azure.AI.OpenAI/README.md
      </span>
     </span>
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1112.1">
      .
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-376">
    <a id="_idTextAnchor376">
    </a>
    <span class="koboSpan" id="kobo.1113.1">
     Connecting an Azure OpenAI service to an existing 
data index
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.1114.1">
     In Azure, you can
    </span>
    <a id="_idIndexMarker515">
    </a>
    <span class="koboSpan" id="kobo.1115.1">
     have multiple existing
    </span>
    <a id="_idIndexMarker516">
    </a>
    <span class="koboSpan" id="kobo.1116.1">
     data sources, ranging from Azure Cosmos DB to various Azure Cognitive services with tokenized and indexed data.
    </span>
    <span class="koboSpan" id="kobo.1116.2">
     While the Azure OpenAI service works with commonly available GPT models, it also allows you to connect a chosen model to your specific data source.
    </span>
    <span class="koboSpan" id="kobo.1116.3">
     With this integration, you can analyze and extract data more intuitively by interacting with your application through
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1117.1">
      natural language.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1118.1">
     Let’s connect the Azure OpenAI service to an existing Azure Search service data index.
    </span>
    <span class="koboSpan" id="kobo.1118.2">
     By doing so, we will leverage the power of AI to analyze our internal
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1119.1">
      data seamlessly.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-377">
    <a id="_idTextAnchor377">
    </a>
    <span class="koboSpan" id="kobo.1120.1">
     Getting ready
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.1121.1">
     Before we explore connecting Azure Search data to Azure OpenAI, we must do
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1122.1">
      the following:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.1123.1">
      On the server-side on your application, create a
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1124.1">
       Chapter10
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1125.1">
      /
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1126.1">
       Recipe05
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1127.1">
      directory – this will be your
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1128.1">
       working directory
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1129.1">
      Copy the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1130.1">
       ChatBot
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1131.1">
      component from the
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.1132.1">
       Adding a ChatBot
      </span>
     </em>
     <span class="koboSpan" id="kobo.1133.1">
      recipe or from the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1134.1">
       Chapter10
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1135.1">
      /
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1136.1">
       Recipe04
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1137.1">
      directory in the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1138.1">
       GitHub repository
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1139.1">
      If you’re starting here, register all the Azure services as shown in the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1140.1">
       Configure
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1141.1">
      file, in the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1142.1">
       Chapter10
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1143.1">
      /
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1144.1">
       Recipe04
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1145.1">
      directory in the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1146.1">
       GitHub repository
      </span>
     </span>
    </li>
   </ul>
   <h2 id="_idParaDest-378">
    <a id="_idTextAnchor378">
    </a>
    <span class="koboSpan" id="kobo.1147.1">
     How to do it…
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.1148.1">
     Follow these
    </span>
    <a id="_idIndexMarker517">
    </a>
    <span class="koboSpan" id="kobo.1149.1">
     instructions
    </span>
    <a id="_idIndexMarker518">
    </a>
    <span class="koboSpan" id="kobo.1150.1">
     to connect Azure OpenAI to the Azure Search data and enable analyzing
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1151.1">
      the data:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.1152.1">
      Open the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1153.1">
       appsettings.json
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1154.1">
      file on the server side and add a new
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1155.1">
       Search
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1156.1">
      section with
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1157.1">
       ApiKey
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1158.1">
      ,
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1159.1">
       Endpoint
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1160.1">
      ,
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1161.1">
       and
      </span>
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.1162.1">
        Index
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1163.1">
       :
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.1164.1">
"Search": {
  "ApiKey": "YOUR_API_KEY",
  "Endpoint": "YOUR_ENDPOINT",
  "Index": "YOUR_INDEX_NAME"
}</span></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1165.1">
      Move to the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1166.1">
       Program.cs
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1167.1">
      file of the server-side project.
     </span>
     <span class="koboSpan" id="kobo.1167.2">
      Below the builder and Azure OpenAI services initializations, intercept the search data access details into
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1168.1">
       searchEndpoint
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1169.1">
      ,
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1170.1">
       searchApiKey
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1171.1">
      , and
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.1172.1">
        searchIndex
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1173.1">
       variables:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.1174.1">
var searchEndpoint = builder
    .Configuration["Search:Endpoint"];
var searchApiKey = builder
    .Configuration["Search:ApiKey"];
var searchIndex = builder
    .Configuration["Search:Index"];</span></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1175.1">
      Below the intercepted search configuration, register
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1176.1">
       ChatCompletionOptions
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1177.1">
      as a singleton.
     </span>
     <span class="koboSpan" id="kobo.1177.2">
      As part of the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1178.1">
       ChatCompletionOptions
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1179.1">
      initialization, build an
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1180.1">
       AzureSearchChatDataSource
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1181.1">
      instance and attach it to the constructed
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1182.1">
       completion options:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.1183.1">
builder.Services.AddSingleton(services =&gt;
{
    var dataSource = new AzureSearchChatDataSource
    {
        Endpoint = new Uri(searchEndpoint),
        IndexName = searchIndex,
        Authentication = DataSourceAuthentication
            .FromApiKey(searchApiKey)
    };
    ChatCompletionOptions completionOptions = new();
    completionOptions.AddDataSource(dataSource);
    return completionOptions;
});</span></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1184.1">
      At the time
     </span>
     <a id="_idIndexMarker519">
     </a>
     <span class="koboSpan" id="kobo.1185.1">
      of
     </span>
     <a id="_idIndexMarker520">
     </a>
     <span class="koboSpan" id="kobo.1186.1">
      writing, the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1187.1">
       Azure.AI.OpenAI
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1188.1">
      package is in preview and your IDE may interpret using the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1189.1">
       AddDataSource()
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1190.1">
      method of the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1191.1">
       ChatCompletionOptions
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1192.1">
      class as a compilation error.
     </span>
     <span class="koboSpan" id="kobo.1192.2">
      To suppress the error, add the required
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1193.1">
       #pragma
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1194.1">
      directive at the top of the
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.1195.1">
        Program.cs
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1196.1">
       file:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.1197.1">
#pragma warning disable AOAI001</span></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1198.1">
      Navigate to the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1199.1">
       @code
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1200.1">
      block of the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1201.1">
       ChatBot
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1202.1">
      component and inject the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1203.1">
       ChatCompletionOptions
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1204.1">
      instance next to the
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.1205.1">
        Chat
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1206.1">
       client:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.1207.1">
[Inject]
private ChatCompletionOptions ChatOptions
{
    get; init;
}</span></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1208.1">
      Still within the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1209.1">
       @code
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1210.1">
      block, inside the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1211.1">
       SendMessage()
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1212.1">
      method, locate where we invoke the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1213.1">
       CompleteChatAsync()
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1214.1">
      method of the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1215.1">
       Chat
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1216.1">
      service and pass
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1217.1">
       ChatOptions
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1218.1">
      as a
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1219.1">
       second parameter:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.1220.1">
var chatResponse = await Chat
    .CompleteChatAsync(_messages, ChatOptions);</span></pre>
    </li>
   </ol>
   <h2 id="_idParaDest-379">
    <a id="_idTextAnchor379">
    </a>
    <span class="koboSpan" id="kobo.1221.1">
     How it works…
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.1222.1">
     In
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.1223.1">
      step 1
     </span>
    </em>
    <span class="koboSpan" id="kobo.1224.1">
     , we navigate to the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1225.1">
      appsettings.json
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1226.1">
     configuration file of the server-side project.
    </span>
    <span class="koboSpan" id="kobo.1226.2">
     We extend the configuration file with a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1227.1">
      Search
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1228.1">
     section where we require the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1229.1">
      ApiKey
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1230.1">
     ,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1231.1">
      Endpoint
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1232.1">
     , and
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1233.1">
       Index
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1234.1">
      values.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1235.1">
     In
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.1236.1">
      step 2
     </span>
    </em>
    <span class="koboSpan" id="kobo.1237.1">
     , we stay on
    </span>
    <a id="_idIndexMarker521">
    </a>
    <span class="koboSpan" id="kobo.1238.1">
     the
    </span>
    <a id="_idIndexMarker522">
    </a>
    <span class="koboSpan" id="kobo.1239.1">
     server side but move to the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1240.1">
      Program.cs
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1241.1">
     project entry file.
    </span>
    <span class="koboSpan" id="kobo.1241.2">
     We intercept the search configuration into
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1242.1">
      searchEndpoint
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1243.1">
     ,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1244.1">
      searchApiKey
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1245.1">
     , and
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1246.1">
      searchIndex
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1247.1">
     variables, so we can use them to connect data to the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1248.1">
      Azure OpenAI.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1249.1">
     In
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.1250.1">
      step 3
     </span>
    </em>
    <span class="koboSpan" id="kobo.1251.1">
     , we register a singleton
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1252.1">
      ChatCompletionOptions
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1253.1">
     object in the application’s dependency injection container.
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1254.1">
      ChatCompletionOptions
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1255.1">
     is used to configure the behavior of chat completions, allowing us to customize and extend the functionality of our chat service.
    </span>
    <span class="koboSpan" id="kobo.1255.2">
     As part of the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1256.1">
      ChatCompletionOptions
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1257.1">
     initialization logic, we construct an instance of
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1258.1">
      AzureSearchChatDataSource
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1259.1">
     , which represents the search data connection details and requires providing an endpoint, API key, and index name.
    </span>
    <span class="koboSpan" id="kobo.1259.2">
     We’ve intercepted this from the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1260.1">
      appsettings.json
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1261.1">
     file.
    </span>
    <span class="koboSpan" id="kobo.1261.2">
     We use the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1262.1">
      AddDataSource()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1263.1">
     method of the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1264.1">
      ChatCompletionOptions
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1265.1">
     instance to attach the search
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1266.1">
      data access.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1267.1">
     As
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1268.1">
      Azure.AI.OpenAI
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1269.1">
     is still in preview at the time of writing, your IDE may flag the use of the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1270.1">
      AddDataSource()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1271.1">
     method as a compilation error – that’s nothing to worry about.
    </span>
    <span class="koboSpan" id="kobo.1271.2">
     The Azure team will adjust this before releasing the stable package.
    </span>
    <span class="koboSpan" id="kobo.1271.3">
     For now, we can suppress the warning by adding a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1272.1">
      #pragma
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1273.1">
     directive at the top of the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1274.1">
      Program.cs
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1275.1">
     file with the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1276.1">
      AOAI001
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1277.1">
     validation code we need to suppress, as we do in
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.1278.1">
      step 4
     </span>
    </em>
    <span class="koboSpan" id="kobo.1279.1">
     .
    </span>
    <span class="koboSpan" id="kobo.1279.2">
     Next, we move to the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1280.1">
      ChatBot
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1281.1">
     component and attach the enhanced completion options to
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1282.1">
      our chatbot.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1283.1">
     In
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.1284.1">
      step 5
     </span>
    </em>
    <span class="koboSpan" id="kobo.1285.1">
     , we go straight to the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1286.1">
      @code
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1287.1">
     block of the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1288.1">
      ChatBot
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1289.1">
     component and inject the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1290.1">
      ChatCompletionOptions
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1291.1">
     instance from the dependency injection container
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1292.1">
      as
     </span>
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1293.1">
       ChatOptions
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1294.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1295.1">
     In
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.1296.1">
      step 6
     </span>
    </em>
    <span class="koboSpan" id="kobo.1297.1">
     , we locate the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1298.1">
      SendMessage()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1299.1">
     method and find where we invoke the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1300.1">
      CompleteChatAsync()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1301.1">
     method of the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1302.1">
      Chat
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1303.1">
     service to get a response from the Azure OpenAI.
    </span>
    <span class="koboSpan" id="kobo.1303.2">
     We’re already passing a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1304.1">
      _messages
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1305.1">
     collection to the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1306.1">
      CompleteChatAsync()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1307.1">
     method, but it also accepts a second parameter of the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1308.1">
      ChatCompletionOptions
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1309.1">
     type – that’s where we pass the injected
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1310.1">
      ChatOptions
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1311.1">
     instance
    </span>
    <a id="_idIndexMarker523">
    </a>
    <span class="koboSpan" id="kobo.1312.1">
     with
    </span>
    <a id="_idIndexMarker524">
    </a>
    <span class="koboSpan" id="kobo.1313.1">
     access to the Azure
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1314.1">
      Search data.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-380">
    <a id="_idTextAnchor380">
    </a>
    <span class="koboSpan" id="kobo.1315.1">
     There’s more…
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.1316.1">
     You don’t have to have the data source and Azure OpenAI in the same resource group.
    </span>
    <span class="koboSpan" id="kobo.1316.2">
     In fact, you don’t even have to own the data source.
    </span>
    <span class="koboSpan" id="kobo.1316.3">
     Azure OpenAI will work correctly and generate contextualized results as long as you provide a valid set of configuration details.
    </span>
    <span class="koboSpan" id="kobo.1316.4">
     This flexibility allows you to leverage existing data sources and integrate them with Azure OpenAI seamlessly, enhancing the functionality of your applications without needing to consolidate or
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1317.1">
      migrate resources.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-381">
    <a id="_idTextAnchor381">
    </a>
    <span class="koboSpan" id="kobo.1318.1">
     See also
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.1319.1">
     In the recipe implementation, we’ve used a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1320.1">
      #pragma
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1321.1">
     preprocessor directive.
    </span>
    <span class="koboSpan" id="kobo.1321.2">
     Preprocessor directives have different purposes and allow adjusting your code behavior on a lower level.
    </span>
    <span class="koboSpan" id="kobo.1321.3">
     If
    </span>
    <a id="_idIndexMarker525">
    </a>
    <span class="koboSpan" id="kobo.1322.1">
     you’re
    </span>
    <a id="_idIndexMarker526">
    </a>
    <span class="koboSpan" id="kobo.1323.1">
     curious to learn more, check out this Microsoft
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1324.1">
      Learn resource:
     </span>
    </span>
   </p>
   <p>
    <a href="https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/preprocessor-directives">
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1325.1">
       https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/preprocessor-directives
      </span>
     </span>
    </a>
   </p>
  </div>
 </body></html>