<html><head></head><body>
  <div><h1 class="chapter-number" id="_idParaDest-126">
    <a id="_idTextAnchor126">
    </a>
    
     9
    
   </h1>
   <h1 id="_idParaDest-127">
    <a id="_idTextAnchor127">
    </a>
    
     Authentication  and Authorization
    
   </h1>
   <p>
    
     In the previous chapter, we reviewed a number of advanced API topics.
    
    
     In this chapter, you will learn how to add authentication (which answers questions such as “is this user who they say they are?”) and authorization (“is this user allowed to take this action?”).
    
    
     We will use the Azure function from
    
    <a href="B21998_06.xhtml#_idTextAnchor077">
     
      <em class="italic">
       
        Chapter 6
       
      </em>
     
    </a>
    
     
      .
     
    
   </p>
   <p>
    
     In this chapter, we will cover the
    
    
     
      following topics:
     
    
   </p>
   <ul>
    <li>
     
      Differences between authentication
     
     
      
       and authorization
      
     
    </li>
    <li>
     
      Definitions of authentication
     
     
      
       and authorization
      
     
    </li>
    <li>
     
      A walkthrough of authentication – proving who
     
     
      
       you are
      
     
    </li>
    <li>
     
      A walkthrough of authorization – testing if you can take a
     
     
      
       specific action
      
     
    </li>
   </ul>
   <h1 id="_idParaDest-128">
    <a id="_idTextAnchor128">
    </a>
    
     Technical requirements
    
   </h1>
   <p>
    
     For this chapter, you will need
    
    
     
      the following:
     
    
   </p>
   <ol>
    <li>
     
      
       Visual Studio
      
     
    </li>
    <li>
     
      An Azure Account (you can get a free starter account
     
     
      
       at
      
     
     <a href="https://azure.mcrosoft.com">
      
       
        https://azure.mcrosoft.com
       
      
     </a>
     
      
       )
      
     
    </li>
   </ol>
   <p>
    
     Note that much of this chapter relies on the code and action from
    
    <a href="B21998_06.xhtml#_idTextAnchor077">
     
      <em class="italic">
       
        Chapter 6
       
      </em>
     
    </a>
    
     .
    
    
     If you don’t have the code, you can download it from the
    
    
     
      repository:
     
    
    <a href="https://github.com/PacktPublishing/Programming-APIs-with-C-Sharp-and-.NET/tree/main/Chapter06">
     
      
       https://github.com/PacktPublishing/Programming-APIs-with-C-Sharp-and-.NET/tree/main/Chapter06
      
     
    </a>
   </p>
   <p>
    
     The code for this chapter is available
    
    
     
      at
     
    
    <a href="https://github.com/PacktPublishing/Programming-APIs-with-C-Sharp-and-.NET/tree/main/Chapter09">
     
      
       https://github.com/PacktPublishing/Programming-APIs-with-C-Sharp-and-.NET/tree/main/Chapter09
      
     
    </a>
   </p>
   <h1 id="_idParaDest-129">
    <a id="_idTextAnchor129">
    </a>
    
     Introduction to authentication and authorization
    
   </h1>
   <p>
    
     The vast majority of applications
    
    <a id="_idIndexMarker265">
    </a>
    
     will need some form of
    
    <strong class="bold">
     
      authentication and authorization
     
    </strong>
    
     (
    
    <strong class="bold">
     
      A&amp;A
     
    </strong>
    
     ).
    
    
     Authentication is the process of proving who you are, while authorization is the process of determining whether you have permission to do what you are trying to do.
    
    
     Typically, you authenticate first, perhaps once per session, and then authorization is checked for each action
    
    
     
      you attempt.
     
    
   </p>
   <p>
    
     There are many different types of A&amp;A, but since we’re focusing mostly on Azure, we’ll use their built-in feature set
    
    <a id="_idIndexMarker266">
    </a>
    
     colloquially known as
    
    
     <strong class="bold">
      
       Easy Auth
      
     </strong>
    
    
     
      .
     
    
   </p>
   <h1 id="_idParaDest-130">
    <a id="_idTextAnchor130">
    </a>
    
     Overview of A&amp;A
    
   </h1>
   <p>
    
     Though there are
    
    <a id="_idIndexMarker267">
    </a>
    
     many kinds of A&amp;A, including many nuances such as the authentication of services, users, and so on, we’ll focus on A&amp;A for a single user in an Azure Tenant.
    
    
     That will usually be an employee during debugging (you!).
    
    
     This will then allow you to extend these concepts so that other services you create can be authorized in the
    
    
     
      same way.
     
    
   </p>
   <p class="callout-heading">
    
     Tenant
    
   </p>
   <p class="callout">
    
     A tenant in Azure is a Guid that specifies all the content of a
    
    
     
      single organization.
     
    
   </p>
   <h2 id="_idParaDest-131">
    <a id="_idTextAnchor131">
    </a>
    
     Enabling authentication on existing functions
    
   </h2>
   <p>
    
     Let’s begin by
    
    <a id="_idIndexMarker268">
    </a>
    
     adding authentication to an existing Azure function.
    
    
     To do so, follow
    
    
     
      these steps:
     
    
   </p>
   <ol>
    <li>
     
      Open your Azure Function resource from
     
     <a href="B21998_06.xhtml#_idTextAnchor077">
      
       <em class="italic">
        
         Chapter 6
        
       </em>
      
     </a>
     
      and navigate to the
     
     <strong class="bold">
      
       Authentication
      
     </strong>
     
      section, as shown in
     
     
      <em class="italic">
       
        Figure 9
       
      </em>
     
     
      <em class="italic">
       
        .1
       
      </em>
     
     
      
       .
      
     
    </li>
   </ol>
   <div><div><img alt="Figure 9.1 – Selecting Authentication" src="img/B21998_09_1.jpg"/>
     
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    
     Figure 9.1 – Selecting Authentication
    
   </p>
   <ol>
    <li value="2">
     
      Click
     
     <strong class="bold">
      
       Add Identity Provider
      
     </strong>
     
      , and then select
     
     <strong class="bold">
      
       Microsoft
      
     </strong>
     
      .
     
     
      Use the following configuration
     
     <a id="_idIndexMarker269">
     </a>
     
      options (they are almost
     
     
      
       all default):
      
     
     <ul>
      <li>
       <strong class="bold">
        
         Choose
        
       </strong>
       
        <strong class="bold">
         
          a tenant
         
        </strong>
       
       <ul>
        <li>
         <strong class="bold">
          
           Workforce
          
         </strong>
         
          <strong class="bold">
           
            configuration
           
          </strong>
         
         
          
           (default)
          
         
        </li>
       </ul>
      </li>
      <li>
       
        <strong class="bold">
         
          App registration
         
        </strong>
       
       <ul>
        <li>
         <strong class="bold">
          
           App registration type
          
         </strong>
         
          :
         
         <strong class="bold">
          
           Create new app
          
         </strong>
         
          <strong class="bold">
           
            registration
           
          </strong>
         
         
          
           (default)
          
         
        </li>
        <li>
         <strong class="bold">
          
           Name
          
         </strong>
         
          : The default is likely the name of your existing Function App resource; in this
         
         <a id="_idIndexMarker270">
         </a>
         
          case, it
         
         
          
           is
          
         
         
          <strong class="bold">
           
            Functions
           
          </strong>
         
         
          
           .
          
         
        </li>
        <li>
         <strong class="bold">
          
           Client secret expiration
          
         </strong>
         
          :
         
         <strong class="bold">
          
           Recommended: 180
          
         </strong>
         
          <strong class="bold">
           
            days
           
          </strong>
         
         
          
           (default)
          
         
        </li>
        <li>
         <strong class="bold">
          
           Supported account types
          
         </strong>
         
          :
         
         <strong class="bold">
          
           Current tenant – Single
          
         </strong>
         
          <strong class="bold">
           
            tenant
           
          </strong>
         
         
          
           (default)
          
         
        </li>
       </ul>
      </li>
      <li>
       <strong class="bold">
        
         Additional
        
       </strong>
       
        <strong class="bold">
         
          checks
         
        </strong>
       
       
        
         (default)
        
       
       <ul>
        <li>
         <strong class="bold">
          
           Client application requirement
          
         </strong>
         
          :
         
         <strong class="bold">
          
           Allow requests only from this application
          
         </strong>
         
          <strong class="bold">
           
            itself
           
          </strong>
         
         
          
           (default)
          
         
        </li>
        <li>
         <strong class="bold">
          
           Identity requirement
          
         </strong>
         
          :
         
         <strong class="bold">
          
           Allow requests from any
          
         </strong>
         
          <strong class="bold">
           
            identity
           
          </strong>
         
         
          
           (default)
          
         
        </li>
        <li>
         <strong class="bold">
          
           Tenant requirement
          
         </strong>
         
          :
         
         <strong class="bold">
          
           Allow requests only from the issuer tenant
          
         </strong>
         
          (your tenant GUID
         
         
          
           goes here)
          
         
        </li>
       </ul>
      </li>
      <li>
       <strong class="bold">
        
         App Service authentication
        
       </strong>
       
        <strong class="bold">
         
          settings
         
        </strong>
       
       
        
         (default)
        
       
       <ul>
        <li>
         <strong class="bold">
          
           Restrict access
          
         </strong>
         
          :
         
         <strong class="bold">
          
           Require
          
         </strong>
         
          <strong class="bold">
           
            authentication
           
          </strong>
         
         
          
           (default)
          
         
        </li>
        <li>
         <strong class="bold">
          
           Unauthenticated requests
          
         </strong>
         
          :
         
         <strong class="bold">
          
           HTTP 401 Unauthorized: recommended for
          
         </strong>
         
          <strong class="bold">
           
            APIs
           
          </strong>
         
         
          
           (default)
          
         
        </li>
       </ul>
      </li>
      <li>
       <strong class="bold">
        
         Token
        
       </strong>
       
        <strong class="bold">
         
          Store
         
        </strong>
       
       
        
         :
        
       
       
        <strong class="bold">
         
          Checked
         
        </strong>
       
       <p class="list-inset">
        
         To put this all together, see
        
        
         <em class="italic">
          
           Figure 9
          
         </em>
        
        
         <em class="italic">
          
           .2
          
         </em>
        
        
         
          .
         
        
       </p>
      </li>
     </ul>
    </li>
   </ol>
   <div><div><img alt="Figure 9.2 – Adding an identity provider" src="img/B21998_09_2.jpg"/>
     
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    
     Figure 9.2 – Adding an identity provider
    
   </p>
   <ol>
    <li value="3">
     
      We can skip
     
     <strong class="bold">
      
       Permissions
      
     </strong>
     
      for now, so
     
     
      
       click
      
     
     
      <strong class="bold">
       
        Add
       
      </strong>
     
     
      
       .
      
     
     <p class="list-inset">
      
       You will be returned to your
      
      <strong class="bold">
       
        Authentication
       
      </strong>
      
       blade, showing your new Microsoft
      
      
       
        Identity
       
      
      
       <a id="_idIndexMarker271">
       </a>
      
      
       
        provider.
       
      
     </p>
    </li>
    <li>
     
      Click on the name of your Identity provider or navigate back to the main Azure portal.
     
     
      Click on
     
     <strong class="bold">
      
       Microsoft Entra ID
      
     </strong>
     
      , select
     
     <strong class="bold">
      
       App registrations
      
     </strong>
     
      , then
     
     
      
       your app.
      
     
    </li>
   </ol>
   <p>
    
     This is your configuration area to manage various things about the app’s authentication.
    
    
     We’ll be editing this in a bit but try to run or navigate to your existing Function app’s HTTP trigger like you did in
    
    <a href="B21998_06.xhtml#_idTextAnchor077">
     
      <em class="italic">
       
        Chapter 6
       
      </em>
     
    </a>
    
     .
    
    
     You should see that it now shows
    
    <strong class="bold">
     
      401
     
    </strong>
    
     <strong class="bold">
      
       error (Unauthorized)
      
     </strong>
    
    
     
      .
     
    
   </p>
   <p>
    
     Next, we’ll authenticate to the new Identity Provider in two ways to give you an idea of different
    
    
     
      use cases.
     
    
   </p>
   <h2 id="_idParaDest-132">
    <a id="_idTextAnchor132">
    </a>
    
     Programmatically accessing your API
    
   </h2>
   <p>
    
     Open your Function in Visual Studio from
    
    <a href="B21998_06.xhtml#_idTextAnchor077">
     
      <em class="italic">
       
        Chapter 6
       
      </em>
     
    </a>
    
     .
    
    
     Right-click on the solution in
    
    <strong class="bold">
     
      Solution Explorer
     
    </strong>
    
     and click on
    
    <strong class="bold">
     
      Add New Project...
     
     
      Add a .NET Console app
     
    </strong>
    
     .
    
    
     Add the
    
    <strong class="source-inline">
     
      Azure.Identity
     
    </strong>
    
     NuGet package, and then create a
    
    
     <strong class="source-inline">
      
       DefaultAzureCredential
      
     </strong>
    
    
     
      instance.
     
    
   </p>
   <p>
    
     There are many different
    
    <a id="_idIndexMarker272">
    </a>
    
     credential classes that inherit from a
    
    <strong class="source-inline">
     
      TokenCredential
     
    </strong>
    
     base class implementing different use cases, but the
    
    <strong class="source-inline">
     
      DefaultAzureCredential
     
    </strong>
    
     tries a number of different credentials in order so that it can easily be used in several different scenarios.
    
    
     Use the following boilerplate code to securely call
    
    
     
      your Function:
     
    
   </p>
   <pre class="source-code">
DefaultAzureCredential cred = new DefaultAzureCredential(new DefaultAzureCredentialOptions
            {
                TenantId = &lt;your tenant ID&gt;
            });
Azure.Core.AccessToken token = await cred.GetTokenAsync(new Azure.Core.TokenRequestContext(new string[]
           {
               &lt;clientId&gt;
           }), CancellationToken.None);
var message = new HttpRequestMessage(HttpMethod.Get,<code> </code>"https://&lt;your function<code> </code>resource&gt;.azurewebsites.net/api/Function1");
            message.Headers.Authorization = new 
            AuthenticationHeaderValue("Bearer", token.Token);
            HttpResponseMessage resp = await new HttpClient().
            SendAsync(message);//inject the HttpClient in a production 
                              //app
            resp.EnsureSuccessStatusCode();
            string content = await resp.Content.ReadAsStringAsync();
            Console.WriteLine(content);</pre>
   <p>
    
     Try to run it now, and it should throw an error on
    
    <strong class="source-inline">
     
      resp.EnsureSuccessStatusCode();
     
    </strong>
    
     .
    
    
     This is because we have not told our API that you as a user (via Visual
    
    <a id="_idIndexMarker273">
    </a>
    
     Studio’s helper authentication client) are allowed to make calls to
    
    
     
      your API.
     
    
   </p>
   <p>
    
     In a development environment, we can authorize the well-known client ID to the API.
    
    
     To do so, in the Azure Portal, navigate to your Function
    
    
     
      resource again:
     
    
   </p>
   <ol>
    <li>
     
      In the
     
     <strong class="bold">
      
       Authentication
      
     </strong>
     
      blade, click the pencil icon under the
     
     
      <strong class="bold">
       
        Edit
       
      </strong>
     
     
      
       heading.
      
     
    </li>
    <li>
     
      Select
     
     <strong class="bold">
      
       Allow Requests From Specific Client Applications
      
     </strong>
     
      if it isn’t already selected, and then add
     
     <strong class="bold">
      
       04f0c124-f2bc-4f59-8241-bf6df9866bbd
      
     </strong>
     
      .
     
     
      Click
     
     <strong class="bold">
      
       OK
      
     </strong>
     
      and
     
     
      
       then
      
     
     
      <strong class="bold">
       
        Save
       
      </strong>
     
     
      
       .
      
     
     <p class="list-inset">
      
       We’ll be doing this again later in
      
      
       
        this chapter.
       
      
     </p>
    </li>
    <li>
     
      Go back to Visual Studio and run the console
     
     
      
       application again.
      
     
    </li>
   </ol>
   <p>
    
     The call to your API should now succeed and will print out the data you configured in your API’s Environment variables blade in
    
    <a href="B21998_06.xhtml#_idTextAnchor077">
     
      <em class="italic">
       
        Chapter 6
       
      </em>
     
    </a>
    
     
      .
     
    
   </p>
   <p>
    
     Next, we’ll try to use
    
    <strong class="source-inline">
     
      ClientSecretCredential
     
    </strong>
    
     .
    
    
     To do so, follow
    
    
     
      these instructions:
     
    
   </p>
   <ol>
    <li>
     
      Navigate to the
     
     <strong class="bold">
      
       Certificates &amp; Secrets
      
     </strong>
     
      blade in the app registration and click
     
     <strong class="bold">
      
       New
      
     </strong>
     
      <strong class="bold">
       
        Client Secret
       
      </strong>
     
     
      
       .
      
     
    </li>
    <li>
     
      Enter a description
     
     <a id="_idIndexMarker274">
     </a>
     
      and expiration time, and
     
     
      
       click
      
     
     
      <strong class="bold">
       
        Add
       
      </strong>
     
     
      
       .
      
     
    </li>
    <li>
     
      Copy the value somewhere (e.g., Notepad), as you will not be able to access it again.
     
     
      Modify the code by adding a new
     
     <strong class="source-inline">
      
       ClientSecretCredential
      
     </strong>
     
      instance instead of the existing credentials you might already have.
     
     
      You’ll need the Tenant ID and Client ID available in the
     
     
      <strong class="bold">
       
        Overview
       
      </strong>
     
     
      
       blade:
      
     
     <pre class="source-code">
ClientSecretCredential cred = new ClientSecretCredential(&lt;tenantId&gt;, &lt;clientId&gt;, &lt;clientSecret&gt;);</pre>
    </li>
   </ol>
   <p>
    
     The existing call to
    
    <strong class="source-inline">
     
      GetTokenAsync
     
    </strong>
    
     should work without changes.
    
    
     The rest of the code including the HTTP call itself should run successfully as is, and you should again see your configured
    
    
     
      API string.
     
    
   </p>
   <p class="callout-heading">
    
     Note
    
   </p>
   <p class="callout">
    
     All of the preceding strings are available in the code from
    
    <a href="B21998_06.xhtml#_idTextAnchor077">
     
      <em class="italic">
       
        Chapter 6
       
      </em>
     
    </a>
    
     
      .
     
    
   </p>
   <h2 id="_idParaDest-133">
    <a id="_idTextAnchor133">
    </a>
    
     Authorizing additional Azure Resources
    
   </h2>
   <p>
    
     You’ll almost certainly
    
    <a id="_idIndexMarker275">
    </a>
    
     need additional Azure services to complement your cloud solution, so let’s try to authorize one to call your API.
    
    
     To do so, follow
    
    
     
      these instructions:
     
    
   </p>
   <ol>
    <li>
     
      Go to the Azure portal, and then your existing Resource group.
     
     
      Create a new Logic app, and select
     
     <strong class="bold">
      
       Consumption
      
     </strong>
     
      
       for hosting.
      
     
    </li>
    <li>
     
      Give it a name and select the same
     
     <strong class="bold">
      
       Region
      
     </strong>
     
      that your other Resources
     
     
      
       are in.
      
     
    </li>
    <li>
     
      When it completes deployment, select the
     
     <strong class="bold">
      
       Identity blade
      
     </strong>
     
      , change the
     
     <strong class="bold">
      
       Status
      
     </strong>
     
      to
     
     <strong class="bold">
      
       On
      
     </strong>
     
      , and click
     
     <strong class="bold">
      
       Save
      
     </strong>
     
      and
     
     
      
       then
      
     
     
      <strong class="bold">
       
        Yes
       
      </strong>
     
     
      
       .
      
     
    </li>
    <li>
     
      Select the Logic
     
     <a id="_idIndexMarker276">
     </a>
     
      app designer blade.
     
     
      Add a new HTTP trigger, enter your deployed Function URI (likely https://&lt;my
     
     <strong class="source-inline">
      
       resource name&gt;.azurewebsites.net/api/Function1
      
     </strong>
     
      ), and the
     
     
      <strong class="source-inline">
       
        GET
       
      </strong>
     
     
      
       method.
      
     
    </li>
    <li>
     
      Click
     
     <strong class="bold">
      
       Show All
      
     </strong>
     
      for
     
     <strong class="bold">
      
       Advanced parameters
      
     </strong>
     
      and select
     
     <strong class="bold">
      
       Managed Identity
      
     </strong>
     
      under
     
     <strong class="bold">
      
       Authentication Type
      
     </strong>
     
      .
     
     
      It should resemble
     
     
      <em class="italic">
       
        Figure 9
       
      </em>
     
     
      <em class="italic">
       
        .3
       
      </em>
     
     
      
       .
      
     
    </li>
   </ol>
   <div><div><img alt="Figure 9.3 – Advanced Parameters" src="img/B21998_09_3.jpg"/>
     
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    
     Figure 9.3 – Advanced Parameters
    
   </p>
   <ol>
    <li value="6">
     
      Click
     
     <strong class="bold">
      
       Save
      
     </strong>
     
      .
     
     
      Go
     
     <a id="_idIndexMarker277">
     </a>
     
      back to the
     
     <strong class="bold">
      
       Overview
      
     </strong>
     
      blade and
     
     
      
       click
      
     
     
      <strong class="bold">
       
        Run
       
      </strong>
     
     
      
       .
      
     
    </li>
    <li>
     
      Click on the
     
     <strong class="bold">
      
       Trigger history
      
     </strong>
     
      tab and notice that it is red, indicating
     
     
      
       a failure.
      
     
    </li>
    <li>
     
      Click on the failed trigger, and then click the
     
     <strong class="bold">
      
       Outputs
      
     </strong>
     
      link.
     
     
      It should show
     
     <strong class="bold">
      
       403 error (Forbidden)
      
     </strong>
     
      , indicating that the service authenticated you correctly, but you were
     
     
      
       not authorized.
      
     
     <p class="list-inset">
      
       To authorize this Logic app to call your Function API, we need to add its client ID to the list of authorized clients that can call
      
      
       
        your API.
       
      
     </p>
    </li>
    <li>
     
      Go back to
     
     <strong class="bold">
      
       Azure Portal Home
      
     </strong>
     
      and click on
     
     <strong class="bold">
      
       Microsoft Entra ID
      
     </strong>
     
      .
     
     
      Search for your Logic app’s name in the
     
     <strong class="bold">
      
       Search Your Tenant
      
     </strong>
     
      text box.
     
     
      It should have an entry under the
     
     <strong class="bold">
      
       Enterprise
      
     </strong>
     
      <strong class="bold">
       
        Applications
       
      </strong>
     
     
      
       section.
      
     
    </li>
    <li>
     
      Next, click on that
     
     <a id="_idIndexMarker278">
     </a>
     
      and then copy the GUID under
     
     
      <strong class="bold">
       
        Application ID
       
      </strong>
     
     
      
       .
      
     
    </li>
   </ol>
   <div><div><img alt="Figure 9.4 – Authorization" src="img/B21998_09_4.jpg"/>
     
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    
     Figure 9.4 – Authorization
    
   </p>
   <p class="callout-heading">
    
     Note
    
   </p>
   <p class="callout">
    
     Some of the fields in
    
    
     <em class="italic">
      
       Figure 9
      
     </em>
    
    <em class="italic">
     
      .4
     
    </em>
    
     have been obscured as a
    
    
     
      security measure.
     
    
   </p>
   <ol>
    <li value="11">
     
      Navigate back to your Function app.
     
     
      Find the
     
     <strong class="bold">
      
       Authentication
      
     </strong>
     
      blade, and then click on the pencil as we did before.
     
     
      Next, click the other pencil icon next to
     
     <strong class="bold">
      
       Allowed client applications
      
     </strong>
     
      , and add a new entry with the GUID you just copied, as
     
     <a id="_idIndexMarker279">
     </a>
     
      shown in
     
     
      <em class="italic">
       
        Figure 9
       
      </em>
     
     
      <em class="italic">
       
        .5
       
      </em>
     
     
      
       .
      
     
    </li>
   </ol>
   <div><div><img alt="Figure 9.5 – Adding allowed client applications" src="img/B21998_09_5.jpg"/>
     
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    
     Figure 9.5 – Adding allowed client applications
    
   </p>
   <ol>
    <li value="12">
     
      Click
     
     <strong class="bold">
      
       OK
      
     </strong>
     
      and
     
     
      
       then
      
     
     
      <strong class="bold">
       
        Save
       
      </strong>
     
     
      
       .
      
     
    </li>
    <li>
     
      Navigate back to the Logic app, and then click on
     
     <strong class="bold">
      
       Run
      
     </strong>
     
      |
     
     <strong class="bold">
      
       Run
      
     </strong>
     
      .
     
     
      This should immediately start another run of your Logic app calling
     
     
      
       your API.
      
     
    </li>
    <li>
     
      Click on the
     
     <strong class="bold">
      
       Trigger history
      
     </strong>
     
      tab on the
     
     <strong class="bold">
      
       Overview
      
     </strong>
     
      blade.
     
     
      You should see that the latest one has a green status, indicating success, as shown in
     
     
      <em class="italic">
       
        Figure 9
       
      </em>
     
     
      <em class="italic">
       
        .6
       
      </em>
     
     
      
       .
      
     
    </li>
   </ol>
   <div><div><img alt="Figure 9.6 – Success!" src="img/B21998_09_6.jpg"/>
     
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    
     Figure 9.6 – Success!
    
   </p>
   <p>
    
     If the start time does not match up to what you are expecting, you may have to click
    
    <strong class="bold">
     
      Refresh
     
    </strong>
    
     at the top of the blade.
    
    
     Click the green success indicator and click on
    
    <strong class="bold">
     
      Outputs
     
    </strong>
    
     again.
    
    
     The
    
    <strong class="source-inline">
     
      statusCode
     
    </strong>
    
     should
    
    <a id="_idIndexMarker280">
    </a>
    
     now be
    
    <strong class="bold">
     
      200 (OK)
     
    </strong>
    
     , and you should once again see the text you configured in the
    
    <strong class="bold">
     
      Function Environment
     
    </strong>
    
     
      variables blade.
     
    
   </p>
   <h1 id="_idParaDest-134">
    <a id="_idTextAnchor134">
    </a>
    
     Summary
    
   </h1>
   <p>
    
     In this chapter, you learned the difference between A&amp;A.
    
    
     You then saw how to use the Azure controls to establish authentication and authorization for a specific Azure resource.
    
    
     In the next chapter, we will learn about
    
    <strong class="bold">
     
      Continuous Integration and Continuous Deployment
     
    </strong>
    
     (
    
    <strong class="bold">
     
      CI/CD
     
    </strong>
    
     )
    
    
     
      on Azure.
     
    
   </p>
   <h1 id="_idParaDest-135">
    <a id="_idTextAnchor135">
    </a>
    
     You try it
    
   </h1>
   <p>
    
     Using the deployed function from
    
    <a href="B21998_06.xhtml#_idTextAnchor077">
     
      <em class="italic">
       
        Chapter 6
       
      </em>
     
    </a>
    
     , authenticate yourself and give yourself authorization.
    
    
     Ensure this succeeds by creating a console app.
    
    
     Then create a Logic app and then authorize it to call
    
    
     
      your API.
     
    
   </p>
  </div>
 </body></html>