<html><head></head><body>
		<div id="_idContainer193">
			<h1 id="_idParaDest-105"><em class="italic"><a id="_idTextAnchor107"/>Chapter 5</em>: Creating a Shop Scene for Our Game</h1>
			<p>In this chapter, we will incorporate and extend the scriptable objects that heavily helped make our player and the enemy ships in the previous chapter. We will customize a new shop scene, where we will add new upgrades for the player's ship with the use of scriptable objects.</p>
			<p>We will also look at the common uses of raycasts; if you aren't familiar with them, they're best described as an invisible laser that shoots from one point to another:</p>
			<div>
				<div id="_idContainer162" class="IMG---Figure">
					<img src="image/Figure_5.01_B18381.jpg" alt="Figure 5.1 – Identifying game objects with a raycast&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 5.1 – Identifying game objects with a raycast</p>
			<p>When the ray hits a game object with a collider, it can retrieve information about the object, and then we can go a little further and manipulate the object we've hit. For example, we can cast a ray to a game object cube, and the ray will confirm to us that it's a cube. Because we have the cube's reference, we can change its color or scale, or position or destroy it – we can pretty much do whatever we want with it. Here, we will use this raycast system to shoot a point from the camera's position to the button in three-dimensional space when we click or touch the screen.</p>
			<p>In this chapter, we will cover the following topics:</p>
			<ul>
				<li>Introducing our shop scripts</li>
				<li>Customizing our shop selection</li>
				<li>Selecting game objects with raycasts</li>
				<li>Adding information to our description panel</li>
			</ul>
			<p>By the end of this chapter, we will be comfortable with taking a piece of artwork and adding functionality to make it more useful. Scriptable objects are our friends, and we will make more use of them in this chapter – adding properties and values so that each option in our shop can hold sprites, prices, and a description. The shop buttons will be in 3D and selected with our invisible laser (the raycast system).</p>
			<h1 id="_idParaDest-106"><a id="_idTextAnchor108"/>The core exam skills covered in this chapter</h1>
			<p><em class="italic">We will cover programming core interactions</em>:</p>
			<ul>
				<li>Implementing and configuring game object behavior and physics</li>
				<li>Implementing and configuring input and controls</li>
			</ul>
			<p><em class="italic">We will also cover working in the art pipeline</em>:</p>
			<ul>
				<li>Understanding materials, textures, and shaders, and writing scripts that interact with Unity's rendering API</li>
			</ul>
			<p><em class="italic">This chapter also covers developing application systems</em>:</p>
			<ul>
				<li>Interpreting scripts for application interface flow, such as menu systems, UI navigation, and application settings</li>
				<li>Interpreting scripts for user-controlled customization, such as character creators, inventories, storefronts, and in-app purchases</li>
				<li>Analyzing scripts for user progression features, such as scoring, leveling, and in-game economies, utilizing technologies such as Unity Analytics and PlayerPrefs</li>
				<li>Analyzing scripts <a id="_idIndexMarker502"/>for two-dimensional overlays, such as <strong class="bold">Heads-Up Displays</strong> (<strong class="bold">HUDs</strong>), minimaps, and advertisements</li>
			</ul>
			<p><em class="italic">We will also cover programming scene and environment design</em>:</p>
			<ul>
				<li>Identifying methods for implementing game object instantiation, destruction, and management</li>
			</ul>
			<p><em class="italic">Finally, we will cover working in a professional software development team</em>:</p>
			<ul>
				<li>Recognizing techniques for structuring scripts for modularity, readability, and reusability</li>
			</ul>
			<h1 id="_idParaDest-107"><a id="_idTextAnchor109"/>Technical requirements</h1>
			<p>The project content for this chapter can be found at <a href="https://github.com/PacktPublishing/Unity-Certified-Programmer-Exam-Guide-Second-Edition/tree/main/Chapter_05">https://github.com/PacktPublishing/Unity-Certified-Programmer-Exam-Guide-Second-Edition/tree/main/Chapter_05</a>.</p>
			<p>You can download the entirety of each chapter's project files at <a href="https://github.com/PacktPublishing/Unity-Certified-Programmer-Exam-Guide-Second-Edition">https://github.com/PacktPublishing/Unity-Certified-Programmer-Exam-Guide-Second-Edition</a>.</p>
			<p>All the content for this chapter is held in the chapter's <strong class="source-inline">unitypackage</strong> file, including a <strong class="source-inline">Complete</strong> folder, which holds all of the work we'll carry out in this chapter.</p>
			<p>Check out the following video to see the <em class="italic">Code in Action</em>: <a href="https://bit.ly/3klZZ9q">https://bit.ly/3klZZ9q</a>.</p>
			<h1 id="_idParaDest-108"><a id="_idTextAnchor110"/>Introducing our shop scripts</h1>
			<p>In this section, we<a id="_idIndexMarker503"/> will make some new scriptable objects, as we did when we created our player's ship settings (health, speed, firepower, and so on). You can refer to the <em class="italic">Introducing our scriptable object </em>(<strong class="source-inline">SOActorModel</strong>) section of <a href="B18381_02_Epub.xhtml#_idTextAnchor048"><em class="italic">Chapter 2</em></a><em class="italic">, Adding and Manipulating Objects</em>, for a reminder of how this is done. Instead of changing our enemy's or player's ships, we will be manipulating the shop's selection of powerups (with a selection grid) to add our own ship upgrades that the player will be able to choose from. These upgrades will then be transferred to the player's ship, which will be visually recognized, and two of the three upgrades will carry out alterations to the gameplay.</p>
			<p>Before we go into further detail, let's refresh our memory on where the shop scripts are within the game framework that we introduced in <em class="italic">Chapter 1, Setting Up and Structuring Our Project</em>.</p>
			<p>The following diagram shows the location of the shop scripts:</p>
			<div>
				<div id="_idContainer163" class="IMG---Figure">
					<img src="image/Figure_5.02_B18381.jpg" alt="Figure 5.2 – Killer Wave's UML &#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 5.2 – Killer Wave's UML </p>
			<p>Our three <a id="_idIndexMarker504"/>shop scripts (<strong class="source-inline">PlayerShipBuild</strong>, <strong class="source-inline">ShopPiece</strong>, and <strong class="source-inline">SOShopSelection</strong>) connect to each other from where the <strong class="source-inline">PlayerShipBuild</strong> connects to the main, center <strong class="source-inline">GameManager</strong> script. In short, each script's responsibility in the shop scene is as follows:</p>
			<ul>
				<li><strong class="source-inline">PlayerShipBuild</strong> is the overall function of the shop, including adverts and in-game credit control. This script can be broken down into more scripts, but for the sake of trying to keep our framework to a minimum, it is OK for a demo.</li>
				<li><strong class="source-inline">ShopPiece</strong> handles the content of the player's ship upgrade selections.</li>
				<li><strong class="source-inline">SOShopSelection</strong> is a scriptable object that holds the data types that will be used in each selection grid in our shop scene.</li>
			</ul>
			<p>Let's take a look at the scene that we will be creating and start applying shop scripts to it, as follows:</p>
			<ol>
				<li>From the <strong class="bold">Project</strong> window, navigate to the <strong class="source-inline">Scene</strong> folder.</li>
				<li>Double-click on the <strong class="source-inline">shop</strong> scene.</li>
				<li>Drag and drop the <strong class="source-inline">ShopManager</strong> prefab from the <strong class="bold">Project</strong> window location (<strong class="source-inline">Assets/Prefab</strong>).</li>
				<li>Select <strong class="bold">Camera</strong> from the <strong class="bold">Hierarchy</strong> window and set its <strong class="bold">Transform Position</strong> settings as <strong class="bold">X</strong>: <strong class="source-inline">0</strong>, <strong class="bold">Y</strong>: <strong class="source-inline">0</strong>, and <strong class="bold">Z</strong>: <strong class="source-inline">0</strong>.</li>
				<li>If you want<a id="_idIndexMarker505"/> a different-colored background, with <strong class="bold">Camera</strong> still selected in the <strong class="bold">Hierarchy</strong> window, change the <strong class="bold">Clear Flags</strong> property from <strong class="bold">Skybox</strong> to <strong class="bold">Solid Color</strong>.<p class="callout-heading">Information</p><p class="callout">Make sure the camera remains in the same screen ratio we set in <a href="B18381_02_Epub.xhtml#_idTextAnchor048"><em class="italic">Chapter 2</em></a>, <em class="italic">Adding and Manipulating Objects</em> (that is, 1920 x 1080). Use the following screenshot for reference.</p></li>
			</ol>
			<p>The following scene is broken into four sections:</p>
			<div>
				<div id="_idContainer164" class="IMG---Figure">
					<img src="image/Figure_5.03_B18381.jpg" alt="Figure 5.3 – Our shop layout&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 5.3 – Our shop layout</p>
			<p>Looking at the<a id="_idIndexMarker506"/> previous screenshot, let's go through each of the numbered points:</p>
			<ul>
				<li>Starting with <strong class="bold">1</strong>, the bottom 10 boxes will hold 3 ship upgrades, an option to watch an advert to gain credits, and a start button to move on to the next scene, which will be our <strong class="source-inline">testLevel</strong> scene (the scene we have been working on in the previous four chapters).</li>
				<li>At the top left (<strong class="bold">2</strong>), we have a visual representation of the player's ship. We can see what it looks like on our player's ship if they buy an upgrade.</li>
				<li>Below the player's ship (<strong class="bold">3</strong>) is a small rectangle that will display the in-game credit balance.</li>
				<li>At the top right (<strong class="bold">4</strong>), a larger rectangle will hold information about our selected upgrade. It will also contain a button that, if the player has enough credits and/or hasn't purchased the item already, will give them the option to buy an upgrade. </li>
			</ul>
			<p>We can make a start with the selection grid (the shop's row of buttons). To save time, I have provided some template art for this scene because we will be replacing it in the next chapter when we create our own UI. </p>
			<p>To make a start with the first button in our shop's selection grid, we need to go to the <strong class="bold">Hierarchy</strong> window in the Unity Editor and do the following:</p>
			<ol>
				<li value="1">At the top-right corner of the <strong class="bold">Hierarchy</strong> window, we have a search bar with a magnifying glass, and <strong class="bold">All</strong> written in its field. Click on the field and type in <strong class="source-inline">upgrade</strong>, as<a id="_idIndexMarker507"/> shown in the following screenshot:</li>
			</ol>
			<div>
				<div id="_idContainer165" class="IMG---Figure">
					<img src="image/Figure_5.04_B18381.jpg" alt="Figure 5.4 – Looking for game objects containing the word &quot;upgrade&quot; in the Hierarchy window&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 5.4 – Looking for game objects containing the word "upgrade" in the Hierarchy window</p>
			<ol>
				<li value="2">Now, select the top game object titled <strong class="source-inline">UPGRADE_00</strong>.<p class="callout-heading">Information</p><p class="callout">Note that the content of the <strong class="bold">Scene</strong> window is grayed out, apart from the selected game object in the <strong class="bold">Hierarchy</strong> window in the Unity Editor. This is to help us locate the game object we are searching for.</p></li>
				<li>Click on the round <strong class="bold">x</strong> symbol to the right of the search bar. This will bring our <strong class="bold">Hierarchy</strong> content back and expand the parent game objects for us, as shown in the following screenshot:</li>
			</ol>
			<div>
				<div id="_idContainer166" class="IMG---Figure">
					<img src="image/Figure_5.05_B18381.jpg" alt="Figure 5.5 – The children of UPGRADE_00&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 5.5 – The children of UPGRADE_00</p>
			<ol>
				<li value="4">Hold <a id="_idIndexMarker508"/>down <em class="italic">Ctrl</em> (or <em class="italic">command</em> on macOS) on your keyboard and select the three game objects:<ul><li><strong class="source-inline">sprite</strong></li><li><strong class="source-inline">itemText</strong></li><li><strong class="source-inline">SelectionQuad</strong></li></ul></li>
				<li>With these three objects selected, select the top-left tick box in the <strong class="bold">Inspector</strong> window to make these objects active. The location of the box is shown in the following screenshot:<div id="_idContainer167" class="IMG---Figure"><img src="image/Figure_5.06_B18381.jpg" alt="Figure 5.6 – Show and hide the game objects with the tick box&#13;&#10;"/></div></li>
			</ol>
			<p class="figure-caption"> </p>
			<p class="figure-caption">Figure 5.6 – Show and hide the game objects with the tick box</p>
			<p>Our grid should now show its first selection, as shown in the following screenshot:</p>
			<div>
				<div id="_idContainer168" class="IMG---Figure">
					<img src="image/Figure_5.07_B18381.jpg" alt="Figure 5.7 – Our first shop button&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 5.7 – Our first shop button</p>
			<p>Our shop has<a id="_idIndexMarker509"/> started to take form. With the first selection set up, we can now go further by customizing these selections with code in the next section. </p>
			<h2 id="_idParaDest-109"><a id="_idTextAnchor111"/>Importing and calibrating our sprite game object</h2>
			<p>The game<a id="_idIndexMarker510"/> object <a id="_idIndexMarker511"/>that I have labeled <strong class="source-inline">sprite</strong> will receive and display a ship upgrade image that will be displayed in the selection grid. To understand how this sprite can be displayed correctly, we can view its properties when its game object is selected in the <strong class="bold">Hierarchy</strong> window.</p>
			<p>The <strong class="bold">Inspector</strong> window in the following screenshot shows that our <strong class="source-inline">sprite</strong> game object has a <strong class="bold">Sprite Renderer</strong> component attached to it:</p>
			<div>
				<div id="_idContainer169" class="IMG---Figure">
					<img src="image/Figure_5.08_B18381.jpg" alt="Figure 5.8 – The Sprite Renderer component&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 5.8 – The Sprite Renderer component</p>
			<p>I have<a id="_idIndexMarker512"/> grayed<a id="_idIndexMarker513"/> out the <strong class="bold">Transform</strong> and <strong class="bold">Material</strong> options in the <strong class="bold">Inspector</strong> window but left the <strong class="bold">Sprite Renderer</strong> component clear in the previous screenshot. The main focus of this <strong class="source-inline">sprite</strong> game object property is what object type we are going to be supplying the <strong class="bold">Sprite Renderer</strong> component with. The previous screenshot shows the sprite <strong class="source-inline">powerup</strong> property, which gives us a fire-like icon in the <strong class="bold">Scene</strong> window. </p>
			<p>Let's check the <strong class="source-inline">powerup</strong> property so that we are certain of its data type and how it's recognized in the Unity Editor.</p>
			<p>To view the sprite's data type, follow these steps:</p>
			<ol>
				<li value="1">With the <strong class="source-inline">sprite</strong> game object still selected in our <strong class="bold">Hierarchy</strong> window, click once on the <strong class="source-inline">powerup</strong> property in the <strong class="bold">Inspector</strong> window of the <strong class="bold">Sprite Renderer</strong> section.</li>
				<li>The <strong class="source-inline">powerup</strong> sprite location will appear in the <strong class="bold">Project</strong> window with a yellow border around it. The following screenshot shows the <strong class="source-inline">powerup</strong> sprite location pinging when selected from the <strong class="bold">Sprite Renderer</strong> component: </li>
			</ol>
			<div>
				<div id="_idContainer170" class="IMG---Figure">
					<img src="image/Figure_5.09_B18381.jpg" alt="Figure 5.9 – The location of our 'powerup' sprite in the Project window&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 5.9 – The location of our 'powerup' sprite in the Project window</p>
			<ol>
				<li value="3">Next, click <a id="_idIndexMarker514"/>on <a id="_idIndexMarker515"/>the parent of the <strong class="source-inline">powerup</strong> property in the <strong class="bold">Project</strong> window. The <strong class="bold">Inspector</strong> window will change to the <strong class="source-inline">powerup</strong> sprite's import settings.</li>
			</ol>
			<p>The majority of the information doesn't require altering, but the main point of focus is making sure that the <strong class="bold">Texture Type</strong> setting is recognized as <strong class="bold">Sprite</strong> to make the file compatible with the <strong class="bold">Sprite Renderer</strong> component.</p>
			<p>The following screenshot shows our <strong class="source-inline">powerup</strong> file recognized as a sprite, with an image preview at the bottom of the window:</p>
			<div>
				<div id="_idContainer171" class="IMG---Figure">
					<img src="image/Figure_5.10_B18381.jpg" alt="Figure 5.10 – Our 'powerup' file will be set as a Sprite in the Texture Type field&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 5.10 – Our 'powerup' file will be set as a Sprite in the Texture Type field</p>
			<p>It is possible <a id="_idIndexMarker516"/>that<a id="_idIndexMarker517"/> when a sprite, such as a <strong class="source-inline">powerup</strong> texture in the previous screenshot, is imported into Unity, it may not be recognized as a sprite and will be given the <strong class="source-inline">Default</strong> type. This is because <strong class="source-inline">Default</strong> is the most common selection for textures, especially with three-dimensional models. <strong class="source-inline">Default</strong> also offers more options with regard to texture properties.</p>
			<p class="callout-heading">Further Information</p>
			<p class="callout">If you want to know more about texture types, check out <a href="https://docs.unity3d.com/Manual/TextureTypes.html">https://docs.unity3d.com/Manual/TextureTypes.html</a>.</p>
			<p>With regard to our <strong class="source-inline">powerup</strong> texture, we do not need to change it to <strong class="source-inline">Default</strong>. When we add another selection, the same principles of checking the image type should be carried out. Let's<a id="_idIndexMarker518"/> now move on to the second game object <a id="_idIndexMarker519"/>of the <strong class="source-inline">UPGRADE_00</strong> game object – <strong class="source-inline">itemText</strong>.</p>
			<h2 id="_idParaDest-110"><a id="_idTextAnchor112"/>Displaying credit on our itemText game object</h2>
			<p>The second<a id="_idIndexMarker520"/> child game object from <strong class="source-inline">UPGRADE_00</strong> is <strong class="source-inline">itemText</strong>. This game object has a <strong class="bold">Text Mesh</strong> component that holds the responsibility of displaying text. We will use this component to receive and display the selection upgrade's credit value and also to notify the player when the item has been purchased by displaying <strong class="source-inline">SOLD</strong> in the text.</p>
			<p>The following screenshot shows the connection between the <strong class="bold">Text Mesh</strong> component and the text in the <strong class="bold">Scene</strong> window:  </p>
			<div>
				<div id="_idContainer172" class="IMG---Figure">
					<img src="image/Figure_5.11_B18381.jpg" alt="Figure 5.11 – Text Mesh text set to '0000'&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 5.11 – Text Mesh text set to '0000'</p>
			<p>Let's now move on to the final child game object of the <strong class="source-inline">UPGRADE_00</strong> hierarchy, which is <strong class="source-inline">SelectionQuad</strong>.</p>
			<h2 id="_idParaDest-111"><a id="_idTextAnchor113"/>Project file diagnosis when making SelectionQuad</h2>
			<p>In this section, I am going to briefly explain how the shop's selection grid is prepared.</p>
			<p><strong class="source-inline">SelectionQuad</strong> is the third child game object of the <strong class="source-inline">UPGRADE_00</strong> game object, as shown in the following screenshot:</p>
			<div>
				<div id="_idContainer173" class="IMG---Figure">
					<img src="image/Figure_5.12_B18381.jpg" alt="Figure 5.12 – The SelectionQuad game object in the Hierarchy window&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 5.12 – The SelectionQuad game object in the Hierarchy window</p>
			<p>This game object <a id="_idIndexMarker521"/>simply serves to show the player that they have made a selection. It consists of a quad mesh, which is a standard primitive that can be made in Unity (by right-clicking in the <strong class="bold">Hierarchy</strong> window and selecting <strong class="bold">3D Object | Quad</strong>). We are now going to change its appearance to make it look more interesting by manipulating its material values; follow these steps:</p>
			<ol>
				<li value="1">Once the <strong class="source-inline">Quad</strong> object is moved into position, change its <strong class="bold">Material</strong> properties from an <strong class="bold">Opaque</strong> rendering mode to <strong class="bold">Transparent</strong> (<strong class="bold">1</strong>).</li>
				<li>Then, click on the <strong class="bold">Albedo</strong> thumbnail color (<strong class="bold">2</strong>) and change its color settings (<strong class="bold">3</strong>) to <strong class="bold">R</strong>: <strong class="source-inline">64</strong>, <strong class="bold">G</strong>: <strong class="source-inline">152</strong>, <strong class="bold">B</strong>: <strong class="source-inline">255</strong>, and <strong class="bold">A</strong>: <strong class="source-inline">140</strong>. The following screenshot shows the color property changes made to the <strong class="source-inline">SelectionQuad</strong> material:</li>
			</ol>
			<div>
				<div id="_idContainer174" class="IMG---Figure">
					<img src="image/Figure_5.13_B18381.jpg" alt="Figure 5.13 – Rendering Mode set to Transparent and the RGBA values modified to a light blue color&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 5.13 – Rendering Mode set to Transparent and the RGBA values modified to a light blue color</p>
			<ol>
				<li value="3">That is the<a id="_idIndexMarker522"/> entirety of our <strong class="source-inline">UPGRADE_00</strong> selection. Then, copy and paste each game object onto two more black rectangles and rename them <strong class="source-inline">UPGRADE_01</strong> and <strong class="source-inline">UPGRADE_02</strong>.</li>
			</ol>
			<p>The following screenshot shows the three game objects:</p>
			<div>
				<div id="_idContainer175" class="IMG---Figure">
					<img src="image/Figure_5.14_B18381.jpg" alt="Figure 5.14 – Duplicating the game objects&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 5.14 – Duplicating the game objects</p>
			<p>For the purpose of this chapter, we are going to be using these three game objects to manipulate and carry information from one scene to another. Before we start making scripts for these selections, I want to show you some text that will be added to the two slightly larger buttons at the far right of the grid:</p>
			<ol>
				<li value="1">Scroll down in the <strong class="bold">Hierarchy</strong> window until you get to two game objects titled <strong class="source-inline">WATCH AD</strong> and <strong class="source-inline">START</strong>. These two game objects will hold the following responsibilities:<ul><li><strong class="source-inline">WATCH AD</strong> is used when the player selects this button; an advert will play. Once the advert is finished, the player is rewarded with credits. These credits can be used to buy more upgrades.</li><li><strong class="source-inline">START</strong> is used when the player is finished with the shop. They can move on by pressing the <strong class="bold">START</strong> button.</li></ul></li>
				<li>Expand <strong class="source-inline">WATCH AD</strong> and <strong class="source-inline">START</strong> by clicking on each arrow to the left of them.</li>
				<li>Click on<a id="_idIndexMarker523"/> each game object and make them active in the <strong class="bold">Inspector</strong> window, as we did earlier in the <em class="italic">Introducing our shop scripts</em> section.</li>
			</ol>
			<p>In each expanded game object, we have a label game object; this holds a <strong class="bold">Text Mesh</strong> component, which we have been introduced to already in this section, that displays our button text.</p>
			<p>The following screenshot shows the expanded <strong class="source-inline">WATCH AD</strong> and <strong class="source-inline">START</strong> objects in the <strong class="bold">Hierarchy</strong> window:</p>
			<div>
				<div id="_idContainer176" class="IMG---Figure">
					<img src="image/Figure_5.15_B18381.jpg" alt="Figure 5.15 – The WATCH AD and START button locations&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 5.15 – The WATCH AD and START button locations</p>
			<p>So far, we understand that we have a shop scene that will contain scriptable objects for our ship's upgrades; we are also aware of how the option to watch adverts to gain credits is a popular mechanism with free-to-play games.</p>
			<p>That is all that<a id="_idIndexMarker524"/> we need for the selection grid. We can now start considering how to turn the buttons on and off, change each upgrade art, and more in the next section.</p>
			<h1 id="_idParaDest-112"><a id="_idTextAnchor114"/>Customizing our shop selection</h1>
			<p>In this section, we <a id="_idIndexMarker525"/>are going to use scriptable objects to customize each selection. We have already used scriptable objects in <a href="B18381_02_Epub.xhtml#_idTextAnchor048"><em class="italic">Chapter 2</em></a>, <em class="italic">Adding and Manipulating Objects</em>. This time, we will use a similar method but for our selection grid; hopefully, this will make you appreciate how scriptable objects can be expanded and used across the game.</p>
			<p>As mentioned in <a href="B18381_02_Epub.xhtml#_idTextAnchor048"><em class="italic">Chapter 2</em></a>, <em class="italic">Adding and Manipulating Objects</em>, I make a habit of initialing scriptable objects with an <strong class="source-inline">SO</strong> prefix so that they're easy to identify. Let's create an <strong class="source-inline">SOShopSelection</strong> script:</p>
			<ol>
				<li value="1">In the Unity Editor, go to the <strong class="bold">Project</strong> window and navigate to <strong class="source-inline">Assets/Script</strong>.</li>
				<li>Create a script (using the same method from <a href="B18381_02_Epub.xhtml#_idTextAnchor048"><em class="italic">Chapter 2</em></a><em class="italic">,</em> <em class="italic">Adding and Manipulating Objects</em>) and name it <strong class="source-inline">SOShopSelection</strong>.</li>
			</ol>
			<p>This <strong class="source-inline">SOShopSelection</strong> script will create a template of data types for our asset files (the same as with our player and enemy ships). These asset files will be attached to each of the player ship upgrades.</p>
			<p>An individual selection from the grid will take four property types, as follows:</p>
			<ul>
				<li><strong class="source-inline">icon</strong>: A picture of the selection.</li>
				<li><strong class="source-inline">iconName</strong>: Identifies what the selection is.</li>
				<li><strong class="source-inline">description</strong>: Used to describe what the upgrade is in the large selection box at the top right of the scene.</li>
				<li><strong class="source-inline">cost</strong>: Calculates how many credits it is worth so that it can be displayed in the credit values of the selection.</li>
			</ul>
			<p>Let's open the <strong class="source-inline">SOShopSelection</strong> script and begin to code:</p>
			<ol>
				<li value="3">At the top of the script, make sure that we have imported the following library:<p class="source-code"><strong class="bold">using UnityEngine;</strong></p></li>
			</ol>
			<p>As with most scripts in Unity, we need the <strong class="source-inline">UnityEngine</strong> library so that we can use the <strong class="source-inline">ScriptableObject</strong> functionality.</p>
			<ol>
				<li value="4">To make it <a id="_idIndexMarker526"/>so that we can create assets from the scriptable object, we enter the following attribute above our class name:<p class="source-code"><strong class="bold">[CreateAssetMenu(fileName = "Create Shop Piece", menuName = </strong></p><p class="source-code"><strong class="bold">   "Create Shop Piece")]</strong></p></li>
				<li>Enter the following code to inherit <strong class="source-inline">ScriptableObject</strong> to the <strong class="source-inline">SOShopSelection</strong> script. This will give us the functionality for creating template asset files:<p class="source-code"><strong class="bold">public class SOShopSelection : ScriptableObject</strong></p><p class="source-code"><strong class="bold">{</strong></p></li>
				<li>Enter the following code to hold the specific variables:<p class="source-code">  public Sprite icon;</p><p class="source-code">  public string iconName;</p><p class="source-code">  public string description;</p><p class="source-code">  public string cost;</p><p class="source-code">}</p></li>
				<li>Save the script.</li>
			</ol>
			<p>We have made the script to hold our data for each potential selection in the grid. As mentioned, we have already made these types of scripts before – we are just using them here to customize buttons, rather than spaceships.</p>
			<p>We can now<a id="_idIndexMarker527"/> customize our three <strong class="source-inline">UPGRADE</strong> game objects in the Unity Editor – let's do that next.</p>
			<h2 id="_idParaDest-113"><a id="_idTextAnchor115"/>Creating selection templates</h2>
			<p>In the last <a id="_idIndexMarker528"/>section, we made a scriptable object<a id="_idIndexMarker529"/> that allowed us to create an asset file that holds custom parameters and values. These assets and their properties can be created by users who don't hold programming knowledge, which is ideal for designers and programmers.</p>
			<p>We have three selections to add to our selection grid:</p>
			<ul>
				<li><strong class="bold">Weapon upgrade</strong>: Gives the player's ship a stronger weapon</li>
				<li><strong class="bold">Health upgrade</strong>: Allows the player's ship to get hit twice by an enemy object</li>
				<li><strong class="bold">Atom bomb</strong>: Wipes all the visible enemies out</li>
			</ul>
			<p>So, let's go back to the Unity Editor and make some asset templates for our selection grid:</p>
			<ol>
				<li value="1">From the <strong class="bold">Project</strong> window, navigate to <strong class="source-inline">Assets/ScriptableObject</strong>.</li>
				<li>Right-click in an open space of the <strong class="bold">Project</strong> window, and from the dropdown that appears, select <strong class="bold">Create</strong> and then <strong class="bold">Create Shop Piece</strong>, as shown in the following screenshot:</li>
			</ol>
			<div>
				<div id="_idContainer177" class="IMG---Figure">
					<img src="image/Figure_5.16_B18381.jpg" alt="Figure 5.16 – Creating a 'Shop Piece'&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 5.16 – Creating a 'Shop Piece'</p>
			<ol>
				<li value="3">Rename the new <strong class="source-inline">Create Shop Piece</strong> file <strong class="source-inline">Shot_PowerUp</strong>.</li>
				<li>With <strong class="source-inline">Shot_PowerUp</strong> still selected, navigate to the <strong class="bold">Inspector</strong> window, where we have the data types that we can enter.</li>
			</ol>
			<p>The following screenshot shows the <strong class="source-inline">Shot_PowerUp</strong> properties that we are going<a id="_idIndexMarker530"/> to<a id="_idIndexMarker531"/> change next:</p>
			<div>
				<div id="_idContainer178" class="IMG---Figure">
					<img src="image/Figure_5.17_B18381.jpg" alt="Figure 5.17 – The Shot_PowerUp properties&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 5.17 – The Shot_PowerUp properties</p>
			<ol>
				<li value="5">We will apply our <strong class="source-inline">powerup</strong> sprite icon to the <strong class="bold">Icon</strong> data type by clicking on the small circle to the right of its field.</li>
				<li>Scroll down in the <strong class="bold">Select Sprite</strong> window until you see the <strong class="source-inline">powerup</strong> sprite, and then double-click it, as shown in the following screenshot:</li>
			</ol>
			<div>
				<div id="_idContainer179" class="IMG---Figure">
					<img src="image/Figure_5.18_B18381.jpg" alt="Figure 5.18 – Updating the shop buttons icon&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 5.18 – Updating the shop buttons icon</p>
			<ol>
				<li value="7">Now, enter<a id="_idIndexMarker532"/> the following property <a id="_idIndexMarker533"/>names and the values we are going to give them:<ul><li><strong class="bold">Icon Name</strong>: <strong class="source-inline">b. Shot</strong></li><li><strong class="bold">Description</strong>: <strong class="source-inline">Blast Shot</strong></li><li><strong class="bold">Cost</strong>: <strong class="source-inline">400</strong></li></ul></li>
				<li>Create another <strong class="source-inline">ShopPiece</strong> asset as we did before.</li>
				<li>This time, change the asset name from <strong class="source-inline">Create Shop Piece</strong> to <strong class="source-inline">Health_Level1</strong> and give it the details shown in the following screenshot:</li>
			</ol>
			<div>
				<div id="_idContainer180" class="IMG---Figure">
					<img src="image/Figure_5.19_B18381.jpg" alt="Figure 5.19 – Health button properties&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 5.19 – Health button properties</p>
			<ol>
				<li value="10">Let's now make the third asset file, using the exact same process as the last two assets, but this time name it <strong class="source-inline">Bomb_Cluster</strong> and give it the following details:</li>
			</ol>
			<div>
				<div id="_idContainer181" class="IMG---Figure">
					<img src="image/Figure_5.20_B18381.jpg" alt="Figure 5.20 – Bomb Cluster button properties&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 5.20 – Bomb Cluster button properties</p>
			<p>We have made the scriptable objects and configured them for our ship's upgrades. Let's now make the second main script for the shop, <strong class="source-inline">ShopPiece</strong>. This script will hold each of the asset files <a id="_idIndexMarker534"/>we have just made and display <a id="_idIndexMarker535"/>their content around the shop's grid scene.</p>
			<h2 id="_idParaDest-114"><a id="_idTextAnchor116"/>Customizing our player ship's upgrade selection</h2>
			<p>The purpose<a id="_idIndexMarker536"/> of this script is to<a id="_idIndexMarker537"/> send information to each of the selection buttons in our shop scene. For each of the three <strong class="source-inline">UPGRADE</strong> game objects, we will create and attach a script that takes reference from the <strong class="source-inline">SOShopSelection</strong> scriptable object (the three asset files we made in the previous section) and assign them to each player ship's upgrade button. </p>
			<p>To create the <strong class="source-inline">ShopPiece</strong> script, do the following:</p>
			<ol>
				<li value="1">Let's start by navigating to <strong class="source-inline">Assets/Script</strong> from the <strong class="bold">Project</strong> window.</li>
				<li>Create the script the same way as we did at the start of the <em class="italic">Customizing our shop selection</em> section and name the script <strong class="source-inline">ShopPiece</strong>.</li>
				<li>Open the script and begin to code, starting with the script that contains the <strong class="source-inline">UnityEngine</strong> library at the top of the script:<p class="source-code"><strong class="bold">using UnityEngine;</strong></p></li>
			</ol>
			<p>Because we are using elements of Unity and attaching the <strong class="source-inline">ShopPiece</strong> script with the Unity Editor, this script will require the <strong class="source-inline">UnityEngine</strong> library.</p>
			<ol>
				<li value="4">Check and enter the following code to declare the class name and inheritance:<p class="source-code"><strong class="bold">public class ShopPiece : MonoBehaviour </strong></p><p class="source-code"><strong class="bold">{</strong></p></li>
			</ol>
			<p>By default, our script should be automatically named, with <strong class="source-inline">Monobehaviour</strong> inherited.</p>
			<ol>
				<li value="5">Enter the<a id="_idIndexMarker538"/> following <a id="_idIndexMarker539"/>code to allow the <strong class="source-inline">shopSelection</strong> instance to be updated:<p class="source-code">[SerializeField]</p><p class="source-code">  SOShopSelection shopSelection;</p><p class="source-code">  public SOShopSelection ShopSelection</p><p class="source-code">  {</p><p class="source-code">    get {return shopSelection; }</p><p class="source-code">    set {shopSelection = value; }</p><p class="source-code">  }</p></li>
			</ol>
			<p>We add a reference to the <strong class="source-inline">SOShopSelection</strong> script that we made in the last section. This reference is private (because it isn't labeled as <strong class="source-inline">public</strong>), but we expose it to the Unity Editor with a <strong class="source-inline">[SerializeField]</strong> function above it. This means that we can drag and drop each scriptable asset file to its field in the Unity Editor. If another script requires access to the private <strong class="source-inline">shopSelection</strong> variable, we can refer to the <strong class="source-inline">ShopSelection</strong> property that will receive and send its data (<strong class="source-inline">get</strong> and <strong class="source-inline">set</strong>).</p>
			<ol>
				<li value="6">Enter the following code to update the <strong class="source-inline">shopSelection</strong> sprite:<p class="source-code">void Awake()</p><p class="source-code">  {</p><p class="source-code">   //icon slot</p><p class="source-code">   if (GetComponentInChildren&lt;SpriteRenderer&gt;() != null)</p><p class="source-code">  {</p><p class="source-code">   GetComponentInChildren&lt;SpriteRenderer&gt;().sprite = </p><p class="source-code">     shopSelection.icon;</p><p class="source-code">  }</p></li>
			</ol>
			<p>When this script is active and runs for the first time, it runs its <strong class="source-inline">Awake</strong> function. Inside the <a id="_idIndexMarker540"/>function <a id="_idIndexMarker541"/>are two <strong class="source-inline">if</strong> statements; the first checks whether there is a <strong class="source-inline">SpriteRenderer</strong> component in any of its child game objects. If there is, then it grabs a reference from its <strong class="source-inline">shopSelection</strong> asset file and applies its icon sprite to display on the button. </p>
			<ol>
				<li value="7">Enter the following code to update the cost value:<p class="source-code">   //selection value</p><p class="source-code">    if(transform.Find("itemText"))</p><p class="source-code">    {</p><p class="source-code">      GetComponentInChildren&lt;TextMesh&gt;().text =     shopSelection.cost;</p><p class="source-code">    }</p><p class="source-code">  }</p></li>
			</ol>
			<p>The alternative <strong class="source-inline">if</strong> statement checks whether any of the child game objects of this class have a game object titled <strong class="source-inline">itemText</strong>. </p>
			<p>If there is a game object titled <strong class="source-inline">itemText</strong>, we update its <strong class="source-inline">TextMesh</strong> component's <strong class="source-inline">text</strong> value with the <strong class="source-inline">shopSelection</strong> cost value.</p>
			<ol>
				<li value="8">Save the script.</li>
			</ol>
			<p>Back in the Unity Editor, we can attach the <strong class="source-inline">ShopPiece</strong> script, along with each asset script we made in the last section.</p>
			<p>To attach <a id="_idIndexMarker542"/>each <strong class="source-inline">ShopPiece</strong> script <a id="_idIndexMarker543"/>to each <strong class="source-inline">UPGRADE</strong> game object file, follow these steps:</p>
			<ol>
				<li value="1">From the <strong class="bold">Hierarchy</strong> window, locate and select the <strong class="source-inline">UPGRADE_00</strong> game object.</li>
				<li>Either drag and drop the <strong class="source-inline">ShopPiece</strong> script from the <strong class="bold">Project</strong> window (<strong class="source-inline">Assets /Script</strong>) or click on <strong class="bold">Add Component</strong> in the <strong class="bold">Inspector</strong> window and type the script's name in the drop-down search.</li>
				<li><strong class="source-inline">UPGRADE_00</strong> will be our weapon powerup button, so for the <strong class="bold">Shop</strong><strong class="bold"> </strong><strong class="bold">Selection</strong> parameter, either locate the file we made earlier in the <strong class="bold">Project</strong> window (<strong class="source-inline">Assets /ScriptableObject</strong>) or click on the small circle to the right of the <strong class="bold">Shop Selection</strong> field and type in the asset file that we named <strong class="source-inline">Shot_PowerUp</strong>. Use the following screenshot as a reference to see how your <strong class="bold">Inspector</strong> window should look:</li>
			</ol>
			<div>
				<div id="_idContainer182" class="IMG---Figure">
					<img src="image/Figure_5.21_B18381.jpg" alt="Figure 5.21 – Our 'Shop Piece' script containing the 'Shop_PowerUp' Scriptable Object&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 5.21 – Our 'Shop Piece' script containing the 'Shop_PowerUp' Scriptable Object</p>
			<ol>
				<li value="4">Now, repeat <a id="_idIndexMarker544"/>this process<a id="_idIndexMarker545"/> for <strong class="source-inline">UPGRADE_01</strong> by giving the game object the <strong class="source-inline">ShopPiece</strong> script with the <strong class="source-inline">Health_Level1</strong> asset in its <strong class="bold">Shop Selection</strong> field. The following screenshot shows the <strong class="source-inline">ShopPiece</strong> component for <strong class="source-inline">UPGRADE_01</strong>:</li>
			</ol>
			<div>
				<div id="_idContainer183" class="IMG---Figure">
					<img src="image/Figure_5.22_B18381.jpg" alt="Figure 5.22 – Our 'Shop Piece' script containing the 'Health_Level1' Scriptable Object&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 5.22 – Our 'Shop Piece' script containing the 'Health_Level1' Scriptable Object</p>
			<ol>
				<li value="5">Finally, complete the same procedure for <strong class="source-inline">UPGRADE_02</strong>, adding the <strong class="source-inline">ShopPiece</strong> script and applying <strong class="source-inline">Bomb_Cluster</strong> to the <strong class="bold">Shop Selection</strong> field. The following screenshot shows the <strong class="source-inline">ShopPiece</strong> script with the <strong class="source-inline">Bomb_Cluster</strong> asset applied:</li>
			</ol>
			<div>
				<div id="_idContainer184" class="IMG---Figure">
					<img src="image/Figure_5.23_B18381.jpg" alt="Figure 5.23 – Our 'Shop Piece' script containing the 'Bomb_Cluster' Scriptable Object&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 5.23 – Our 'Shop Piece' script containing the 'Bomb_Cluster' Scriptable Object</p>
			<ol>
				<li value="6">To test whether the three selection pieces work in the selection grid, save the scene so far and click the <strong class="bold">Play</strong> button in the Unity Editor.</li>
			</ol>
			<p>Our selection grid should go from the top three buttons with the same image and same value (not in play mode) to each image and value being different (in play mode):</p>
			<div>
				<div id="_idContainer185" class="IMG---Figure">
					<img src="image/Figure_5.24_B18381.jpg" alt="Figure 5.24 – Our shop buttons updating their prices in Play Mode&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 5.24 – Our shop buttons updating their prices in Play Mode</p>
			<p>If you recall, our asset files have names and description data; we can use this for the large rectangle in the shop scene when it comes to supplying information about the item. Also, we<a id="_idIndexMarker546"/> need to update the<a id="_idIndexMarker547"/> player ship's visuals to show what a purchase looks like on the ship, as well as a few other things. In the next section, we are going to create a script that allows the player to press a button from the selection grid.</p>
			<h1 id="_idParaDest-115"><a id="_idTextAnchor117"/>Selecting game objects with raycasts</h1>
			<p>In this <a id="_idIndexMarker548"/>section, we<a id="_idIndexMarker549"/> are going to create the final shop script, <strong class="source-inline">PlayerShipBuild</strong>. This script holds properties such as selecting any button from the selection grid, running adverts, communicating with our existing game framework scripts, launching our game to play, and a few other things that we will cover.</p>
			<p>One of the subjects you will likely come across in your Unity programmer exam and when developing games/applications in Unity is shooting invisible lasers, which are used for things such as shooting a gun, making a selection in three-dimensional space, and more. In this section, we are going to make a button on the selection grid light up blue when the player presses on it to let them know that it has been selected. We already have each of our buttons set up with blue rectangles that are permanently on. So, all that we need to do now is turn them all off when the scene becomes active and make any of the buttons turn on when a ray (invisible laser) comes into contact with them.</p>
			<p>The following screenshot shows an example of how the player sees the selection screen (<strong class="bold">SELECTION 2D</strong>) and the same scene at an angle so that we can see the main camera's clipping planes (<strong class="bold">SELECTION 3D</strong>). When the player presses a button on the selection grid, an invisible line (ray) will travel across it. If the line comes into contact with a game <a id="_idIndexMarker550"/>object that has a collider attached to it, we<a id="_idIndexMarker551"/> can get information from that game object:</p>
			<div>
				<div id="_idContainer186" class="IMG---Figure">
					<img src="image/Figure_5.25_B18381.jpg" alt="Figure 5.25 – Shooting a ray from our camera position to select a button in the shop&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 5.25 – Shooting a ray from our camera position to select a button in the shop</p>
			<p>So, what we are going to do for this selection is start creating a <strong class="source-inline">PlayerShipBuild</strong> script and give it the functionality to shoot rays, which will then change the color of the button.</p>
			<p>Let's start by creating a script in the usual <strong class="bold">Project</strong> window location (<strong class="source-inline">Assets/Script</strong>) and naming it <strong class="source-inline">PlayerShipBuild</strong>. You should know how to make a script now, as we did so in the previous <em class="italic">Customizing our player ship's upgrade selection</em> section.</p>
			<p>To create a raycast selection, open the <strong class="source-inline">PlayerShipBuild</strong> script and follow these steps:</p>
			<ol>
				<li value="1">By default, we require the UnityEngine library, as previously mentioned:<p class="source-code"><strong class="bold">using UnityEngine;</strong></p></li>
				<li>Enter the following code to declare our class:<p class="source-code"><strong class="bold">public class PlayerShipBuild : MonoBehaviour </strong></p><p class="source-code"><strong class="bold">{</strong></p></li>
			</ol>
			<p>Our script has a <strong class="source-inline">public</strong> access modifier and is named the same as the <strong class="source-inline">PlayerShipBuild</strong> file.</p>
			<p>This <a id="_idIndexMarker552"/>script <a id="_idIndexMarker553"/>inherits <strong class="source-inline">MonoBehaviour</strong>, so it is recognized when attached to a game object in the Editor. </p>
			<ol>
				<li value="3">Enter the following code to hold each of the <strong class="source-inline">shopButtons</strong>:<p class="source-code"><strong class="bold">  [SerializeField]</strong></p><p class="source-code"><strong class="bold">  GameObject[] shopButtons;</strong></p></li>
			</ol>
			<p>We have a <strong class="source-inline">private</strong> variable that is exposed in the Editor with <strong class="source-inline">[SerializeField]</strong> (so we can see and edit it), which will hold an array of all 10 game object buttons on the selection grid.</p>
			<ol>
				<li value="4">Enter the following code to hold two game objects for raycasting:<p class="source-code"><strong class="bold">  GameObject target;</strong></p><p class="source-code"><strong class="bold">  GameObject tmpSelection;</strong></p></li>
			</ol>
			<p>The <strong class="source-inline">tmpSelection</strong> variable is used to store the raycast selection so that we can check to see what we have made contact with. The target variable will be used later on in the script.</p>
			<p><strong class="source-inline">tmpSelection</strong> will be used at the end of the selection process when it comes to turning the game object on. </p>
			<ol>
				<li value="5">Enter the following code within the <strong class="source-inline">Start</strong> function to run our method:<p class="source-code"><strong class="bold">  void Start()</strong></p><p class="source-code"><strong class="bold">  {</strong></p><p class="source-code"><strong class="bold">    TurnOffSelectionHighlights();</strong></p><p class="source-code"><strong class="bold">  }</strong></p></li>
			</ol>
			<p>Unity's <strong class="source-inline">Start</strong> function will be the first thing called when this script becomes active.</p>
			<ol>
				<li value="6">Next, we <a id="_idIndexMarker554"/>will <a id="_idIndexMarker555"/>enter the following code to create the <strong class="source-inline">TurnOffSelectionHighlights</strong> method:<p class="source-code">  void TurnOffSelectionHighlights()</p><p class="source-code">  {</p><p class="source-code">    for (int i = 0; i &lt; shopButtons.Length; i++)</p><p class="source-code">    {</p><p class="source-code">      shopButtons[i].SetActive(false);</p><p class="source-code">    }</p><p class="source-code">  }</p></li>
			</ol>
			<p>Within the <strong class="source-inline">TurnOffSelectionHighlights</strong> method, we run a <strong class="source-inline">for</strong> loop that makes sure all of the buttons have their blue rectangles turned off.</p>
			<ol>
				<li value="7">Enter the following code into the <strong class="source-inline">Update</strong> function that is called at every frame:<p class="source-code">  void Update()</p><p class="source-code">  {</p><p class="source-code">    AttemptSelection();</p><p class="source-code">  }</p></li>
			</ol>
			<p>The <strong class="source-inline">AttemptSelection</strong> method is responsible for receiving the player's input for a button selection. The content of this method will be covered in detail when we come to it.</p>
			<ol>
				<li value="8">Enter the following<a id="_idIndexMarker556"/> code<a id="_idIndexMarker557"/> to create our <strong class="source-inline">ReturnClickedObject</strong> method:<p class="source-code">  GameObject ReturnClickedObject (out RaycastHit hit)</p><p class="source-code">  {</p><p class="source-code">    GameObject target = null;</p><p class="source-code">    Ray ray = Camera.main.ScreenPointToRay (Input.mousePosition);</p><p class="source-code">    if (Physics.Raycast (ray.origin, ray.direction * 100, out hit)) </p><p class="source-code">    {</p><p class="source-code">      target = hit.collider.gameObject;</p><p class="source-code">    }</p><p class="source-code">    return target;</p><p class="source-code">  }</p></li>
			</ol>
			<p>The <strong class="source-inline">ReturnClickedObject</strong> method also takes an argument of an <strong class="source-inline">out</strong> raycast hit, which will contain information of what collider the ray has made contact with.</p>
			<p>Within this method, we reset the <strong class="source-inline">target</strong> game object to remove any previous data. We then take reference from the camera to find where the player tapped or clicked their mouse on the screen and store the result in the form of a ray.</p>
			<p class="callout-heading">Further Information</p>
			<p class="callout">More information about <strong class="source-inline">ScreenPointToRay</strong> can be found in Unity's scripting reference at <a href="https://docs.unity3d.com/ScriptReference/Camera.ScreenPointToRay.html">https://docs.unity3d.com/ScriptReference/Camera.ScreenPointToRay.html</a>.</p>
			<p>We then check whether the origin and the direction of the camera from where we have shot the ray have made contact with a collider (within 100 world space meters).</p>
			<p>If we have made contact with a collider, the <strong class="source-inline">if</strong> statement is acknowledged as <strong class="source-inline">true</strong>; we then take the reference of the game object it has hit and store it in the <strong class="source-inline">target</strong> game object.</p>
			<p>Finally, we send out (<strong class="source-inline">return</strong>) the <strong class="source-inline">target</strong> game object that the ray has come into contact with.</p>
			<p>If you<a id="_idIndexMarker558"/> recall, we <a id="_idIndexMarker559"/>referred to an <strong class="source-inline">AttemptSelection</strong> method earlier in the <strong class="source-inline">Update</strong> function. The <strong class="source-inline">AttemptSelection</strong> method will check whether a condition is made when the player has made contact by tapping the screen or clicking a mouse button in our shop scene.</p>
			<ol>
				<li value="9">Enter the following code to write out the <strong class="source-inline">AttemptSelection</strong> method:<p class="source-code">void AttemptSelection()</p><p class="source-code">{</p><p class="source-code">    if (Input.GetMouseButtonDown (0)) </p><p class="source-code">    {</p><p class="source-code">      RaycastHit hitInfo;</p><p class="source-code">      target = ReturnClickedObject (out hitInfo);</p><p class="source-code">      if (target != null)</p><p class="source-code">      {</p><p class="source-code">        if (target.transform.Find("itemText"))</p><p class="source-code">        { </p><p class="source-code">          TurnOffSelectionHighlights();</p><p class="source-code">          Select();</p><p class="source-code">        }</p><p class="source-code">      }</p><p class="source-code">    }</p><p class="source-code"> }</p></li>
			</ol>
			<p>If the player has pressed the mouse button or tapped the touchscreen, we will fire the ray and send all <strong class="source-inline">RaycastHit</strong> objects into the <strong class="source-inline">ReturnClickedObject</strong> method that we mentioned in the previous section of code. The results from the <strong class="source-inline">ReturnClickedObject</strong> method are returned to the <strong class="source-inline">target</strong> game object that we made at the start of the script.</p>
			<p>We then <a id="_idIndexMarker560"/>check <a id="_idIndexMarker561"/>whether this <strong class="source-inline">target</strong> game object exists. If it does exist, we then run another check to see whether this <strong class="source-inline">target</strong> game object is holding a game object named <strong class="source-inline">itemText</strong>. If it does have a game object with this name, we refresh the selection grid by turning all the blue quads off, followed by a method called <strong class="source-inline">Select</strong>, which is what we are going to talk about next.</p>
			<p>We have finally dug down into the last bit of our script where we find the name of the <strong class="source-inline">SelectionQuad</strong> game object and turn it on to give the player visual feedback of what selection they have made.</p>
			<ol>
				<li value="10">Enter the following method into our code; this will make the player's button selection active:<p class="source-code">  void Select()</p><p class="source-code">  {</p><p class="source-code">    tmpSelection =  target.transform.Find</p><p class="source-code">       ("SelectionQuad").gameObject;</p><p class="source-code">    tmpSelection.SetActive(true);</p><p class="source-code">  }</p></li>
			</ol>
			<p>The <strong class="source-inline">Select</strong> method doesn't need to check any conditions with <strong class="source-inline">if</strong> statements, as this has mostly been done for us with the previous code. We will carry out a search for <strong class="source-inline">SelectionQuad</strong> and store its reference as <strong class="source-inline">tmpSelection</strong>.</p>
			<p>Finally, we set the <strong class="source-inline">tmpSelection</strong> game object's activity to <strong class="source-inline">true</strong> so that it is seen in our <strong class="source-inline">shop</strong> <strong class="bold">Scene</strong> window.</p>
			<ol>
				<li value="11">Save<a id="_idIndexMarker562"/> the <a id="_idIndexMarker563"/>script and return to the Unity Editor.</li>
			</ol>
			<p>We can now attach our <strong class="source-inline">PlayerShipBuild</strong> script to our shop game object (using the same attaching method we used earlier in this chapter for <strong class="source-inline">ShopPiece</strong>), which is the parent to all of the buttons in the selection grid, as shown in the following screenshot:</p>
			<div>
				<div id="_idContainer187" class="IMG---Figure">
					<img src="image/Figure_5.26_B18381.jpg" alt="Figure 5.26 – Our 'shop' containing the 'Player Ship Build' script and the amount of 'Shop Buttons' highlighted (0)&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 5.26 – Our 'shop' containing the 'Player Ship Build' script and the amount of 'Shop Buttons' highlighted (0)</p>
			<p>Also, if you recall at the start of the <strong class="source-inline">PlayerShipBuild</strong> script, we added a game object variable that would take an array of <strong class="source-inline">shopButtons</strong>. We could have a <strong class="source-inline">for</strong> loop to add each <strong class="source-inline">UPGRADE</strong> game object automatically at the start of the script, but if, in the future, we wanted to consider using a joypad or keyboard to guide us through the selection grid, we would have more control over knowing which button is assigned to each array number. Also, this is just another way of programming without relying on code, as Unity is a component-based engine. Other controller inputs and interactions are something we are going to cover in <a href="B18381_13_Epub.xhtml#_idTextAnchor219"><em class="italic">Chapter 13</em></a>, <em class="italic">Effects, Testing, Performance, and Alt Controls</em>, where we will start thinking about other platforms to port our game to.</p>
			<p>With<a id="_idIndexMarker564"/> the<a id="_idIndexMarker565"/> potential of updating our controls in a later lesson, here is how you should attach the game objects to the <strong class="source-inline">shopButtons</strong> array in the Unity Editor:</p>
			<ol>
				<li value="12">With the shop game object still selected in the <strong class="bold">Hierarchy</strong> window, it's probably best to lock the <strong class="bold">Inspector</strong> window at this point (as we did in <a href="B18381_04_Epub.xhtml#_idTextAnchor087"><em class="italic">Chapter 4</em></a>, <em class="italic">Applying Art, Animation, and Particles</em>), as we are going to be selecting and dragging different game objects.</li>
				<li>Change the shop button's size from <strong class="source-inline">0</strong> to <strong class="source-inline">10</strong> in the <strong class="bold">Inspector</strong> window.</li>
			</ol>
			<p>We will now get a burst of empty game object fields in the <strong class="bold">Inspector</strong> window, which will allow us to drag and drop each <strong class="source-inline">SelectionQuad</strong> game object to each field.</p>
			<ol>
				<li value="14">Next, to make things even easier, click on the arrow to the left of each game object under the shop game object to expand each of the child game objects. This will uncover the <strong class="source-inline">SelectionQuad</strong> game objects that we need to drag across.</li>
			</ol>
			<p>The following screenshot shows the <strong class="bold">Inspector</strong> window with a list of empty game objects and the <strong class="bold">Hierarchy</strong> window game objects expanded out:</p>
			<div>
				<div id="_idContainer188" class="IMG---Figure">
					<img src="image/Figure_5.27_B18381.jpg" alt="Figure 5.27 – Drag and drop each SelectionQuad game object from the Hierarchy window into the correct fields in the Inspector window&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 5.27 – Drag and drop each SelectionQuad game object from the Hierarchy window into the correct fields in the Inspector window</p>
			<p>We have <a id="_idIndexMarker566"/>also<a id="_idIndexMarker567"/> added arrow stripes to the previous screenshot to show which <strong class="source-inline">SelectionQuad</strong> objects need to go into which game object field in the <strong class="bold">Inspector</strong> window.</p>
			<ol>
				<li value="15">Save the scene. If you locked your <strong class="bold">Inspector</strong> window, don't forget to unlock it.</li>
				<li>Press the <strong class="bold">Play</strong> button in the Editor.</li>
			</ol>
			<p>Now, when the scene starts, all the blue selection quads disappear, but if you click on any one, it will light up, depending on which button is pressed.</p>
			<p>The following screenshot shows the atom bomb button selected when the mouse clicks on it in the game window. This will also work with touchscreen devices:</p>
			<div>
				<div id="_idContainer189" class="IMG---Figure">
					<img src="image/Figure_5.28_B18381.jpg" alt="Figure 5.28 – The Atom Bomb button selected&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 5.28 – The Atom Bomb button selected</p>
			<p>That covers using raycasts, which is a transferable skill and can be used for anything that involves shooting to grab information from another game object, providing it has a collider attached to it.</p>
			<p>Let's now move on to updating the description panel so that when a selection is made from the grid, we <a id="_idIndexMarker568"/>get the text on the large, dark rectangle<a id="_idIndexMarker569"/> with information we stored from the same scriptable objects that give information to each player upgrade button.</p>
			<h1 id="_idParaDest-116"><a id="_idTextAnchor118"/>Adding information to our description panel</h1>
			<p>When a selection<a id="_idIndexMarker570"/> is made in the shop scene, we can take the information from the selection's scriptable object asset file and display its details within its <strong class="source-inline">textBoxPanel</strong> game object.</p>
			<p>Let's take a look at the <strong class="source-inline">textBoxPanel</strong> object in the <strong class="bold">Hierarchy</strong> window:</p>
			<div>
				<div id="_idContainer190" class="IMG---Figure">
					<img src="image/Figure_5.29_B18381.jpg" alt="Figure 5.29 – Our 'textBoxPanel' content in the Hierarchy window&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 5.29 – Our 'textBoxPanel' content in the Hierarchy window</p>
			<p>The <strong class="source-inline">textBoxPanel</strong> game object holds a black quad that is used for its background. It also holds four other <a id="_idIndexMarker571"/>game objects, as follows:</p>
			<ul>
				<li><strong class="source-inline">name</strong>: This game object <a id="_idIndexMarker572"/>contains a <strong class="bold">TextMesh</strong> component that receives data from the selection that was made that contains the <strong class="source-inline">iconName</strong> scriptable object variable.</li>
				<li><strong class="source-inline">desc</strong>: This game object also holds a <strong class="bold">TextMesh</strong> component that receives data from the selection's <strong class="source-inline">description</strong> scriptable object variable.</li>
				<li><strong class="source-inline">backPanel</strong>: This game object serves as a background for the selection grid.</li>
				<li><strong class="source-inline">BUY?</strong>: This game object will be covered later on when we want to confirm that we want to purchase the item we have selected.</li>
			</ul>
			<p>The following screenshot identifies the two scriptable object data types from the <strong class="source-inline">Health_Level1</strong> asset file that we made earlier in this chapter. The information on this large rectangle will change, depending on which button is selected:</p>
			<div>
				<div id="_idContainer191" class="IMG---Figure">
					<img src="image/Figure_5.30_B18381.jpg" alt="Figure 5.30 – A description of the button selected in the rectangle box&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 5.30 – A description of the button selected in the rectangle box</p>
			<p>Let's now go back to the <strong class="source-inline">PlayerShipBuild</strong> script and add some more code to update the<a id="_idIndexMarker573"/> description panel (the <strong class="source-inline">textBoxPanel</strong> game object):</p>
			<ol>
				<li value="1">Reopen the <strong class="source-inline">PlayerShipBuild</strong> script and add the following variable to the top of the script with the other variables:<p class="source-code"><strong class="bold">GameObject textBoxPanel;</strong></p></li>
			</ol>
			<p>This game object variable will hold a reference to the <strong class="source-inline">textBoxPanel</strong> game object in our scene. Next, we need to grab and refer to this game object from our <strong class="bold">Hierarchy</strong> window.</p>
			<ol>
				<li value="2">Scroll down to the <strong class="source-inline">Start</strong> function and enter the following line of code to store the <strong class="source-inline">textBoxPanel</strong> game object as a reference:<p class="source-code">textBoxPanel = GameObject.Find("textBoxPanel");</p></li>
			</ol>
			<p>Now, scroll down to the content of <strong class="source-inline">AttemptSelection</strong>.  </p>
			<ol>
				<li value="3">Scroll down until we get to the following <strong class="source-inline">if</strong> statement and add <strong class="source-inline">UpdateDescriptionBox();</strong> to the content of that statement:<p class="source-code">        if (target.transform.Find("itemText"))</p><p class="source-code">        { </p><p class="source-code">          TurnOffSelectionHighlights();</p><p class="source-code">          Select();</p><p class="source-code">          UpdateDescriptionBox();</p><p class="source-code">        }        </p></li>
			</ol>
			<p>The <strong class="source-inline">UpdateDescriptionBox</strong> method will grab the selected button's two assets. These <a id="_idIndexMarker574"/>asserts (<strong class="source-inline">iconName</strong> and <strong class="source-inline">description)</strong> are then applied to each <strong class="source-inline">TextMesh</strong> <strong class="source-inline">text</strong> component of <strong class="source-inline">textboxPanel</strong>.</p>
			<ol>
				<li value="4">Let's now enter the content of this method with the following code:<p class="source-code">void UpdateDescriptionBox()</p><p class="source-code">{</p><p class="source-code">               textBoxPanel.transform.Find("name").gameObject.GetComponent</p><p class="source-code">   &lt;TextMesh&gt;().text = tmpSelection.GetComponentInParent</p><p class="source-code">      &lt;ShopPiece&gt;().ShopSelection.iconName;</p><p class="source-code">    textBoxPanel.transform.Find("desc").gameObject.GetComponent</p><p class="source-code">   &lt;TextMesh&gt;().text = tmpSelection.GetComponentInParent</p><p class="source-code">      &lt;ShopPiece&gt;().ShopSelection.description;</p><p class="source-code"> }</p></li>
			</ol>
			<p>The <strong class="source-inline">UpdateDescriptionBox</strong> method will get the reference name and description from the shop button that's selected and will apply the string values to the shop's black noticeboard ( <strong class="source-inline">textBoxPanel</strong>).</p>
			<ol>
				<li value="5">Save the script.</li>
				<li>Test the results by pressing <strong class="bold">Play</strong> in the Unity Editor.</li>
			</ol>
			<p>The following<a id="_idIndexMarker575"/> screenshot shows the first selection grid being selected with the description panel details displayed:</p>
			<div>
				<div id="_idContainer192" class="IMG---Figure">
					<img src="image/Figure_5.31_B18381.jpg" alt="Figure 5.31 – The description displayed for selecting the 'Blast Shot' weapon&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 5.31 – The description displayed for selecting the 'Blast Shot' weapon</p>
			<p>With a small amount of code, the description panel lights up and displays information from any of the items that are selected. This is useful, as if we ever wanted to extend the selection grid with more items, we wouldn't need to bloat our code to compensate for each selection.</p>
			<p>We now have a shop scene that shows what is available to buy and descriptions of what each item is. Let's<a id="_idIndexMarker576"/> summarize what we have learned in this chapter.</p>
			<h1 id="_idParaDest-117"><a id="_idTextAnchor119"/>Summary</h1>
			<p>In this chapter, we started creating a shop scene that holds various buttons and panels created from three-dimensional polygons. We then created our own script to fill the scene with images, values, names, and descriptions of assets that can potentially be purchased with virtual credits.</p>
			<p>We also made use of scriptable objects to create a template for our code so that it can be topped up with various in-game powerups without inflating our game's framework. We also made it interchangeable, so if a weapon needs changing, replacing, or removing, we can simply remove the template without affecting the rest of the code in our game framework.</p>
			<p>The other lesson we learned in this chapter is being aware that we can create games that are free to download but also knowing how to create a form of income with a monetization game design to create revenue.</p>
			<p>In the next chapter, we will continue with our shop scene and focus more on the content of each button and the overall functionality of our shop by adding content to our player's ship. We will also look at game advertisements as a form of currency for the player to upgrade their spaceship.</p>
		</div>
	</body></html>