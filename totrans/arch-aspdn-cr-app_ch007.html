<html xml:lang="en-US" xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops">
<head>
<meta charset="utf-8"/>
<meta content="packt" name="generator"/>
<title>6 Model-View-Controller</title>
<link href="../styles/stylesheet1.css" rel="stylesheet" type="text/css"/>
<link href="../styles/stylesheet2.css" rel="stylesheet" type="text/css"/>
<!-- kobo-style -->
<style id="koboSpanStyle" type="text/css" xmlns="http://www.w3.org/1999/xhtml">.koboSpan { -webkit-text-combine: inherit; }</style>
</head>
<body>
<section class="level1 pkt" data-number="7" id="model-view-controller">
<h1 data-number="7"><span class="koboSpan" id="kobo.1.1" xmlns="http://www.w3.org/1999/xhtml">6 Model-View-Controller</span></h1>
<section class="level2" data-number="7.1" id="before-you-begin-join-our-book-community-on-discord-5">
<h2 data-number="7.1"><span class="koboSpan" id="kobo.2.1" xmlns="http://www.w3.org/1999/xhtml">Before you begin: Join our book community on Discord</span></h2>
<p><span class="koboSpan" id="kobo.3.1" xmlns="http://www.w3.org/1999/xhtml">Give your feedback straight to the author himself and chat to other early readers on our Discord server (find the "architecting-aspnet-core-apps-3e" channel under EARLY ACCESS SUBSCRIPTION).</span></p>
<p><a href="https://packt.link/EarlyAccess"><span class="koboSpan" id="kobo.4.1" xmlns="http://www.w3.org/1999/xhtml">https://packt.link/EarlyAccess</span></a></p>
<p><span class="koboSpan" id="kobo.5.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Qr code Description automatically generated" src="../media/file29.png" style="width:10em"/></span></p>
<p><span class="koboSpan" id="kobo.6.1" xmlns="http://www.w3.org/1999/xhtml">This chapter delves into the Model-View-Controller (MVC) design pattern, a cornerstone of modern software architecture that intuitively structures your code around entities. </span><span class="koboSpan" id="kobo.6.2" xmlns="http://www.w3.org/1999/xhtml">MVC is perfect for CRUD operations or to tap into the advanced features unavailable in Minimal APIs. </span><span class="koboSpan" id="kobo.6.3" xmlns="http://www.w3.org/1999/xhtml">The MVC pattern partitions your application into three interrelated parts: Models, Views, and Controllers.</span></p>
<ul>
<li><strong><span class="koboSpan" id="kobo.7.1" xmlns="http://www.w3.org/1999/xhtml">Models</span></strong><span class="koboSpan" id="kobo.8.1" xmlns="http://www.w3.org/1999/xhtml">, which represent our data and business logic.</span></li>
<li><strong><span class="koboSpan" id="kobo.9.1" xmlns="http://www.w3.org/1999/xhtml">Views</span></strong><span class="koboSpan" id="kobo.10.1" xmlns="http://www.w3.org/1999/xhtml">, which are the user-facing components.</span></li>
<li><strong><span class="koboSpan" id="kobo.11.1" xmlns="http://www.w3.org/1999/xhtml">Controllers</span></strong><span class="koboSpan" id="kobo.12.1" xmlns="http://www.w3.org/1999/xhtml">, that act as intermediaries, mediating the interaction between Models and Views.</span></li>
</ul>
<p><span class="koboSpan" id="kobo.13.1" xmlns="http://www.w3.org/1999/xhtml">With its emphasis on the separation of concerns, the MVC pattern is a proven pattern for creating scalable and robust web applications. </span><span class="koboSpan" id="kobo.13.2" xmlns="http://www.w3.org/1999/xhtml">In the context of ASP.NET Core, MVC has provided a practical approach to building applications efficiently for years. </span><span class="koboSpan" id="kobo.13.3" xmlns="http://www.w3.org/1999/xhtml">While we discussed REST APIs in </span><em><span class="koboSpan" id="kobo.14.1" xmlns="http://www.w3.org/1999/xhtml">Chapter 4</span></em><span class="koboSpan" id="kobo.15.1" xmlns="http://www.w3.org/1999/xhtml">, this chapter provides insight into how to use MVC to create REST APIs. </span><span class="koboSpan" id="kobo.15.2" xmlns="http://www.w3.org/1999/xhtml">We also address using Data Transfer Objects (DTOs) within this framework.In this chapter, we cover the following topics:</span></p>
<ul>
<li><span class="koboSpan" id="kobo.16.1" xmlns="http://www.w3.org/1999/xhtml">The Model-View-Controller design pattern</span></li>
<li><span class="koboSpan" id="kobo.17.1" xmlns="http://www.w3.org/1999/xhtml">Using MVC with DTOs</span></li>
</ul>
<p><span class="koboSpan" id="kobo.18.1" xmlns="http://www.w3.org/1999/xhtml">Our ultimate goal is clean, maintainable, and scalable code; the ASP.NET Core MVC framework is a favored tool for achieving this. </span><span class="koboSpan" id="kobo.18.2" xmlns="http://www.w3.org/1999/xhtml">Let's dive in!</span></p>
</section>
<section class="level2" data-number="7.2" id="the-model-view-controller-design-pattern">
<h2 data-number="7.2"><span class="koboSpan" id="kobo.19.1" xmlns="http://www.w3.org/1999/xhtml">The Model View Controller design pattern</span></h2>
<p><span class="koboSpan" id="kobo.20.1" xmlns="http://www.w3.org/1999/xhtml">Now that we have explored the basics of REST and Minimal APIs, it is time to explore the MVC pattern to build ASP.NET Core REST APIs.Model-View-Controller (MVC) is a design pattern commonly used in web development. </span><span class="koboSpan" id="kobo.20.2" xmlns="http://www.w3.org/1999/xhtml">It has a long history of building REST APIs in ASP.NET and is widely used and praised by many.This pattern divides an application into three interconnected components: the Model, the View, and the Controller. </span><span class="koboSpan" id="kobo.20.3" xmlns="http://www.w3.org/1999/xhtml">A View in MVC formerly represented a user interface. </span><span class="koboSpan" id="kobo.20.4" xmlns="http://www.w3.org/1999/xhtml">However, in our case, the View is a data contract that reflects the REST API’s data-oriented nature.</span></p>
<blockquote>
<p><span class="koboSpan" id="kobo.21.1" xmlns="http://www.w3.org/1999/xhtml">Dividing responsibilities this way aligns with the </span><strong><span class="koboSpan" id="kobo.22.1" xmlns="http://www.w3.org/1999/xhtml">Single Responsibility Principle</span></strong><span class="koboSpan" id="kobo.23.1" xmlns="http://www.w3.org/1999/xhtml"> (</span><strong><span class="koboSpan" id="kobo.24.1" xmlns="http://www.w3.org/1999/xhtml">SRP</span></strong><span class="koboSpan" id="kobo.25.1" xmlns="http://www.w3.org/1999/xhtml">) explored in </span><em><span class="koboSpan" id="kobo.26.1" xmlns="http://www.w3.org/1999/xhtml">Chapter 3</span></em><span class="koboSpan" id="kobo.27.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.28.1" xmlns="http://www.w3.org/1999/xhtml">Architectural Principles</span></em><span class="koboSpan" id="kobo.29.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.29.2" xmlns="http://www.w3.org/1999/xhtml">However, this is not the only way to build REST APIs with ASP.NET Core, as we saw in </span><em><span class="koboSpan" id="kobo.30.1" xmlns="http://www.w3.org/1999/xhtml">Chapter 5</span></em><span class="koboSpan" id="kobo.31.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.32.1" xmlns="http://www.w3.org/1999/xhtml">Minimal APIs</span></em><span class="koboSpan" id="kobo.33.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<blockquote>
<p><span class="koboSpan" id="kobo.34.1" xmlns="http://www.w3.org/1999/xhtml">The new minimal API model mixed with the Request-EndPoint-Response (REPR) pattern can make building REST APIs leaner. </span><span class="koboSpan" id="kobo.34.2" xmlns="http://www.w3.org/1999/xhtml">We cover that pattern in </span><em><span class="koboSpan" id="kobo.35.1" xmlns="http://www.w3.org/1999/xhtml">Chapter 18</span></em><span class="koboSpan" id="kobo.36.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.37.1" xmlns="http://www.w3.org/1999/xhtml">Request-EndPoint-Response (REPR)</span></em><span class="koboSpan" id="kobo.38.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.38.2" xmlns="http://www.w3.org/1999/xhtml">We could see REPR as what ASP.NET Core Razor Pages are to page-oriented web applications, but for REST APIs.</span></p>
</blockquote>
</blockquote>
<p><span class="koboSpan" id="kobo.39.1" xmlns="http://www.w3.org/1999/xhtml">We often design MVC applications around entities, and each entity has a controller that orchestrates its endpoints. </span><span class="koboSpan" id="kobo.39.2" xmlns="http://www.w3.org/1999/xhtml">We called those CRUD controllers. </span><span class="koboSpan" id="kobo.39.3" xmlns="http://www.w3.org/1999/xhtml">However, you can design your controller to fit your needs.In the past few decades, the number of REST APIs just exploded to a gazillion; everybody builds APIs nowadays, not because people follow the trend but based on good reasons. </span><span class="koboSpan" id="kobo.39.4" xmlns="http://www.w3.org/1999/xhtml">REST APIs have fundamentally transformed how systems communicate, offering various benefits that make them indispensable in modern software architecture. </span><span class="koboSpan" id="kobo.39.5" xmlns="http://www.w3.org/1999/xhtml">Here are a few key factors that contribute to their widespread appeal:</span></p>
<ul>
<li><strong><span class="koboSpan" id="kobo.40.1" xmlns="http://www.w3.org/1999/xhtml">Data Efficiency</span></strong><span class="koboSpan" id="kobo.41.1" xmlns="http://www.w3.org/1999/xhtml">: REST APIs promote efficient data sharing across different systems, fostering seamless interconnectivity.</span></li>
<li><strong><span class="koboSpan" id="kobo.42.1" xmlns="http://www.w3.org/1999/xhtml">Universal Communication</span></strong><span class="koboSpan" id="kobo.43.1" xmlns="http://www.w3.org/1999/xhtml">: REST APIs leverage universally recognized data formats like JSON or XML, ensuring broad compatibility and interoperability.</span></li>
<li><strong><span class="koboSpan" id="kobo.44.1" xmlns="http://www.w3.org/1999/xhtml">Backend Centralization</span></strong><span class="koboSpan" id="kobo.45.1" xmlns="http://www.w3.org/1999/xhtml">: REST APIs enable the backend to serve as a centralized hub, supporting multiple frontend platforms, including mobile, desktop, and web applications.</span></li>
<li><strong><span class="koboSpan" id="kobo.46.1" xmlns="http://www.w3.org/1999/xhtml">Layered Backends</span></strong><span class="koboSpan" id="kobo.47.1" xmlns="http://www.w3.org/1999/xhtml">: REST APIs facilitate the stratification of backends, allowing for the creation of foundational, low-level APIs that provide basic functionalities. </span><span class="koboSpan" id="kobo.47.2" xmlns="http://www.w3.org/1999/xhtml">These, in turn, can be consumed by higher-level, product-centric APIs that offer specialized capabilities, thus promoting a flexible and modular backend architecture.</span></li>
<li><strong><span class="koboSpan" id="kobo.48.1" xmlns="http://www.w3.org/1999/xhtml">Security Measures</span></strong><span class="koboSpan" id="kobo.49.1" xmlns="http://www.w3.org/1999/xhtml">: REST APIs can function as gateways, providing security measures to protect downstream systems and ensuring data access is appropriately regulated—a good example of layering APIs.</span></li>
<li><strong><span class="koboSpan" id="kobo.50.1" xmlns="http://www.w3.org/1999/xhtml">Encapsulation</span></strong><span class="koboSpan" id="kobo.51.1" xmlns="http://www.w3.org/1999/xhtml">: REST APIs allow for the encapsulation of specific units of logic into reusable, independent modules, often leading to cleaner, more maintainable code.</span></li>
<li><strong><span class="koboSpan" id="kobo.52.1" xmlns="http://www.w3.org/1999/xhtml">Scalability</span></strong><span class="koboSpan" id="kobo.53.1" xmlns="http://www.w3.org/1999/xhtml">: due to their stateless nature, REST APIs are easier to scale up to accommodate increasing loads.</span></li>
</ul>
<p><span class="koboSpan" id="kobo.54.1" xmlns="http://www.w3.org/1999/xhtml">These advantages greatly facilitate the reuse of backend systems across various user interfaces or even other backend services. </span><span class="koboSpan" id="kobo.54.2" xmlns="http://www.w3.org/1999/xhtml">Consider, for instance, a typical mobile application that needs to support iOS, Android, and web platforms. </span><span class="koboSpan" id="kobo.54.3" xmlns="http://www.w3.org/1999/xhtml">By utilizing a shared backend through REST APIs, development teams can streamline their efforts, saving significant time and cost. </span><span class="koboSpan" id="kobo.54.4" xmlns="http://www.w3.org/1999/xhtml">This shared backend approach ensures consistency across platforms while reducing the complexity of maintaining multiple codebases.</span></p>
<blockquote>
<p><span class="koboSpan" id="kobo.55.1" xmlns="http://www.w3.org/1999/xhtml">We explore different such patterns in </span><em><span class="koboSpan" id="kobo.56.1" xmlns="http://www.w3.org/1999/xhtml">Chapter 19</span></em><span class="koboSpan" id="kobo.57.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.58.1" xmlns="http://www.w3.org/1999/xhtml">Introduction to Microservices Architecture</span></em><span class="koboSpan" id="kobo.59.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</blockquote>
<section class="level3" data-number="7.2.1" id="goal-2">
<h3 data-number="7.2.1"><span class="koboSpan" id="kobo.60.1" xmlns="http://www.w3.org/1999/xhtml">Goal</span></h3>
<p><span class="koboSpan" id="kobo.61.1" xmlns="http://www.w3.org/1999/xhtml">In the context of REST APIs, the MVC pattern aims to streamline the process of managing an entity by breaking it down into three separate, interacting components. </span><span class="koboSpan" id="kobo.61.2" xmlns="http://www.w3.org/1999/xhtml">Rather than struggling with large, bloated blocks of code that are hard to test, developers work with smaller units that enhance maintainability and promote efficient testing. </span><span class="koboSpan" id="kobo.61.3" xmlns="http://www.w3.org/1999/xhtml">This compartmentalization results in small, manageable pieces of functionality that are simpler to maintain and test.</span></p>
</section>
<section class="level3" data-number="7.2.2" id="design-2">
<h3 data-number="7.2.2"><span class="koboSpan" id="kobo.62.1" xmlns="http://www.w3.org/1999/xhtml">Design</span></h3>
<p><span class="koboSpan" id="kobo.63.1" xmlns="http://www.w3.org/1999/xhtml">MVC divides the application into three distinct parts, where each has a single responsibility:</span></p>
<ul>
<li><strong><span class="koboSpan" id="kobo.64.1" xmlns="http://www.w3.org/1999/xhtml">Model</span></strong><span class="koboSpan" id="kobo.65.1" xmlns="http://www.w3.org/1999/xhtml">: The model represents the data and business logic we are modeling.</span></li>
<li><strong><span class="koboSpan" id="kobo.66.1" xmlns="http://www.w3.org/1999/xhtml">View</span></strong><span class="koboSpan" id="kobo.67.1" xmlns="http://www.w3.org/1999/xhtml">: The view represents what the user sees. </span><span class="koboSpan" id="kobo.67.2" xmlns="http://www.w3.org/1999/xhtml">In the context of REST APIs, that usually is a serialized data structure.</span></li>
<li><strong><span class="koboSpan" id="kobo.68.1" xmlns="http://www.w3.org/1999/xhtml">Controller</span></strong><span class="koboSpan" id="kobo.69.1" xmlns="http://www.w3.org/1999/xhtml">: The controller represents a key component of MVC. </span><span class="koboSpan" id="kobo.69.2" xmlns="http://www.w3.org/1999/xhtml">It orchestrates the flow between the client request and the server response. </span><span class="koboSpan" id="kobo.69.3" xmlns="http://www.w3.org/1999/xhtml">The primary role of the controller is to act as an HTTP bridge. </span><span class="koboSpan" id="kobo.69.4" xmlns="http://www.w3.org/1999/xhtml">Essentially, the controller facilitates the communication in and out of the system.</span></li>
</ul>
<blockquote>
<p><span class="koboSpan" id="kobo.70.1" xmlns="http://www.w3.org/1999/xhtml">The code of a controller should remain minimalistic and not contain complex logic, serving as a thin layer between the clients and the domain.</span></p>
<blockquote>
<p><span class="koboSpan" id="kobo.71.1" xmlns="http://www.w3.org/1999/xhtml">We explore alternative points of view in </span><em><span class="koboSpan" id="kobo.72.1" xmlns="http://www.w3.org/1999/xhtml">Chapter 14</span></em><span class="koboSpan" id="kobo.73.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.74.1" xmlns="http://www.w3.org/1999/xhtml">Layering and Clean Architecture</span></em><span class="koboSpan" id="kobo.75.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</blockquote>
</blockquote>
<p><span class="koboSpan" id="kobo.76.1" xmlns="http://www.w3.org/1999/xhtml">Here is a diagram that represents the MVC flow of a REST API:</span></p>
<figure>
<span class="koboSpan" id="kobo.77.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Figure 6.1: Workflow of a REST API using MVC" src="../media/file30.png"/></span><figcaption aria-hidden="true"><span class="koboSpan" id="kobo.78.1" xmlns="http://www.w3.org/1999/xhtml">Figure 6.1: Workflow of a REST API using MVC</span></figcaption>
</figure>
<p><span class="koboSpan" id="kobo.79.1" xmlns="http://www.w3.org/1999/xhtml">In the preceding diagram, we send the model directly to the client. </span><span class="koboSpan" id="kobo.79.2" xmlns="http://www.w3.org/1999/xhtml">In most scenarios, this is not ideal. </span><span class="koboSpan" id="kobo.79.3" xmlns="http://www.w3.org/1999/xhtml">We generally prefer sending only the necessary data portion, formatted according to our requirements. </span><span class="koboSpan" id="kobo.79.4" xmlns="http://www.w3.org/1999/xhtml">We can design robust API contracts by leveraging the Data Transfer Object (DTO) pattern to achieve that. </span><span class="koboSpan" id="kobo.79.5" xmlns="http://www.w3.org/1999/xhtml">But before we delve into that, let's first explore the basics of ASP.NET Core MVC.</span></p>
</section>
<section class="level3" data-number="7.2.3" id="anatomy-of-asp.net-core-web-apis">
<h3 data-number="7.2.3"><span class="koboSpan" id="kobo.80.1" xmlns="http://www.w3.org/1999/xhtml">Anatomy of ASP.NET Core web APIs</span></h3>
<p><span class="koboSpan" id="kobo.81.1" xmlns="http://www.w3.org/1999/xhtml">There are many ways to create a REST API project in .NET, including the </span><code><span class="koboSpan" id="kobo.82.1" xmlns="http://www.w3.org/1999/xhtml">dotnet new webapi</span></code><span class="koboSpan" id="kobo.83.1" xmlns="http://www.w3.org/1999/xhtml"> CLI command, also available from Visual Studio’s UI. </span><span class="koboSpan" id="kobo.83.2" xmlns="http://www.w3.org/1999/xhtml">Next, we explore a few pieces of the MVC framework, starting with the entry point.</span></p>
<section class="level4" data-number="7.2.3.1" id="the-entry-point">
<h4 data-number="7.2.3.1"><span class="koboSpan" id="kobo.84.1" xmlns="http://www.w3.org/1999/xhtml">The entry point</span></h4>
<p><span class="koboSpan" id="kobo.85.1" xmlns="http://www.w3.org/1999/xhtml">The first piece is the entry point: the </span><code><span class="koboSpan" id="kobo.86.1" xmlns="http://www.w3.org/1999/xhtml">Program.cs</span></code><span class="koboSpan" id="kobo.87.1" xmlns="http://www.w3.org/1999/xhtml"> file. </span><span class="koboSpan" id="kobo.87.2" xmlns="http://www.w3.org/1999/xhtml">Since .NET 6, there is no more </span><code><span class="koboSpan" id="kobo.88.1" xmlns="http://www.w3.org/1999/xhtml">Startup</span></code><span class="koboSpan" id="kobo.89.1" xmlns="http://www.w3.org/1999/xhtml"> class by default, and the compiler autogenerates the </span><code><span class="koboSpan" id="kobo.90.1" xmlns="http://www.w3.org/1999/xhtml">Program</span></code><span class="koboSpan" id="kobo.91.1" xmlns="http://www.w3.org/1999/xhtml"> class. </span><span class="koboSpan" id="kobo.91.2" xmlns="http://www.w3.org/1999/xhtml">As explored in the previous chapter, using the minimal hosting model leads to a simplified </span><code><span class="koboSpan" id="kobo.92.1" xmlns="http://www.w3.org/1999/xhtml">Program.cs</span></code><span class="koboSpan" id="kobo.93.1" xmlns="http://www.w3.org/1999/xhtml"> file with less boilerplate code.Here is an example:</span></p>
<div class="C0-CodePACKT">
<pre><code><span class="koboSpan" id="kobo.94.1" xmlns="http://www.w3.org/1999/xhtml">using Shared;
using System.Text.Json.Serialization;
var builder = WebApplication.CreateBuilder(args);
builder.Services.AddCustomerRepository();
builder.Services
    .AddControllers()
    .AddJsonOptions(options =&gt; options
        .JsonSerializerOptions
        .Converters
        .Add(new JsonStringEnumConverter())
    )
;
builder.Services.AddEndpointsApiExplorer();
builder.Services.AddSwaggerGen();
var app = builder.Build();
if (app.Environment.IsDevelopment())
{
    app.UseSwagger();
    app.UseDarkSwaggerUI();
}
app.MapControllers();
app.InitializeSharedDataStore();
app.Run();</span></code></pre>
</div>
<p><span class="koboSpan" id="kobo.95.1" xmlns="http://www.w3.org/1999/xhtml">In the preceding </span><code><span class="koboSpan" id="kobo.96.1" xmlns="http://www.w3.org/1999/xhtml">Program.cs</span></code><span class="koboSpan" id="kobo.97.1" xmlns="http://www.w3.org/1999/xhtml"> file, the highlighted lines identify the minimum code required to enable ASP.NET Core MVC. </span><span class="koboSpan" id="kobo.97.2" xmlns="http://www.w3.org/1999/xhtml">The rest is very similar to the Minimal APIs code.</span></p>
</section>
<section class="level4" data-number="7.2.3.2" id="directory-structure">
<h4 data-number="7.2.3.2"><span class="koboSpan" id="kobo.98.1" xmlns="http://www.w3.org/1999/xhtml">Directory structure</span></h4>
<p><span class="koboSpan" id="kobo.99.1" xmlns="http://www.w3.org/1999/xhtml">The default directory structure contains a </span><code><span class="koboSpan" id="kobo.100.1" xmlns="http://www.w3.org/1999/xhtml">Controllers</span></code><span class="koboSpan" id="kobo.101.1" xmlns="http://www.w3.org/1999/xhtml"> folder to host the controllers. </span><span class="koboSpan" id="kobo.101.2" xmlns="http://www.w3.org/1999/xhtml">On top of that, we can create a </span><code><span class="koboSpan" id="kobo.102.1" xmlns="http://www.w3.org/1999/xhtml">Models</span></code><span class="koboSpan" id="kobo.103.1" xmlns="http://www.w3.org/1999/xhtml"> folder to store your model classes or use any other structure.</span></p>
<blockquote>
<p><span class="koboSpan" id="kobo.104.1" xmlns="http://www.w3.org/1999/xhtml">While controllers are typically housed in the </span><code><span class="koboSpan" id="kobo.105.1" xmlns="http://www.w3.org/1999/xhtml">Controllers</span></code><span class="koboSpan" id="kobo.106.1" xmlns="http://www.w3.org/1999/xhtml"> directory for organizational purposes, this convention is more for the benefit of developers than a strict requirement. </span><span class="koboSpan" id="kobo.106.2" xmlns="http://www.w3.org/1999/xhtml">ASP.NET Core is indifferent to the file's location, offering us the flexibility to structure our project as we see fit.</span></p>
<blockquote>
<p><em><span class="koboSpan" id="kobo.107.1" xmlns="http://www.w3.org/1999/xhtml">Section 4, Applications Patterns</span></em><span class="koboSpan" id="kobo.108.1" xmlns="http://www.w3.org/1999/xhtml">, explores many ways of designing applications.</span></p>
</blockquote>
</blockquote>
<p><span class="koboSpan" id="kobo.109.1" xmlns="http://www.w3.org/1999/xhtml">Next, we look at the central part of this pattern—the controllers.</span></p>
</section>
<section class="level4" data-number="7.2.3.3" id="controller">
<h4 data-number="7.2.3.3"><span class="koboSpan" id="kobo.110.1" xmlns="http://www.w3.org/1999/xhtml">Controller</span></h4>
<p><span class="koboSpan" id="kobo.111.1" xmlns="http://www.w3.org/1999/xhtml">The easiest way to create a controller is to create a class inheriting from </span><code><span class="koboSpan" id="kobo.112.1" xmlns="http://www.w3.org/1999/xhtml">ControllerBase</span></code><span class="koboSpan" id="kobo.113.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.113.2" xmlns="http://www.w3.org/1999/xhtml">However, while </span><code><span class="koboSpan" id="kobo.114.1" xmlns="http://www.w3.org/1999/xhtml">ControllerBase</span></code><span class="koboSpan" id="kobo.115.1" xmlns="http://www.w3.org/1999/xhtml"> adds many utility methods, the only requirement is to decorate the controller class with the </span><code><span class="koboSpan" id="kobo.116.1" xmlns="http://www.w3.org/1999/xhtml">[ApiController]</span></code><span class="koboSpan" id="kobo.117.1" xmlns="http://www.w3.org/1999/xhtml"> attribute.</span></p>
<blockquote>
<p><span class="koboSpan" id="kobo.118.1" xmlns="http://www.w3.org/1999/xhtml">By convention, we write the controller’s name in its plural form and suffix it with </span><code><span class="koboSpan" id="kobo.119.1" xmlns="http://www.w3.org/1999/xhtml">Controller</span></code><span class="koboSpan" id="kobo.120.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.120.2" xmlns="http://www.w3.org/1999/xhtml">For example, if the controller relates to the </span><code><span class="koboSpan" id="kobo.121.1" xmlns="http://www.w3.org/1999/xhtml">Employee</span></code><span class="koboSpan" id="kobo.122.1" xmlns="http://www.w3.org/1999/xhtml"> entity, we’d name it </span><code><span class="koboSpan" id="kobo.123.1" xmlns="http://www.w3.org/1999/xhtml">EmployeesController</span></code><span class="koboSpan" id="kobo.124.1" xmlns="http://www.w3.org/1999/xhtml">, which, by default, leads to an excellent URL pattern that is easy to understand:</span></p>
</blockquote>
<ul>
<li><span class="koboSpan" id="kobo.125.1" xmlns="http://www.w3.org/1999/xhtml">Get all employees: </span><code><span class="koboSpan" id="kobo.126.1" xmlns="http://www.w3.org/1999/xhtml">/employees</span></code></li>
<li><span class="koboSpan" id="kobo.127.1" xmlns="http://www.w3.org/1999/xhtml">Get a specific employee: </span><code><span class="koboSpan" id="kobo.128.1" xmlns="http://www.w3.org/1999/xhtml">/employees/{id}</span></code></li>
<li><span class="koboSpan" id="kobo.129.1" xmlns="http://www.w3.org/1999/xhtml">And so on.</span></li>
</ul>
<p><span class="koboSpan" id="kobo.130.1" xmlns="http://www.w3.org/1999/xhtml">Once we have a controller class, we must add actions. </span><span class="koboSpan" id="kobo.130.2" xmlns="http://www.w3.org/1999/xhtml">Actions are public methods that represent the operations that a client can perform. </span><span class="koboSpan" id="kobo.130.3" xmlns="http://www.w3.org/1999/xhtml">Each action represents an HTTP endpoint.More precisely, the following defines a controller:</span></p>
<ul>
<li><span class="koboSpan" id="kobo.131.1" xmlns="http://www.w3.org/1999/xhtml">A controller exposes one or more actions.</span></li>
<li><span class="koboSpan" id="kobo.132.1" xmlns="http://www.w3.org/1999/xhtml">An action can take zero or more input parameters.</span></li>
<li><span class="koboSpan" id="kobo.133.1" xmlns="http://www.w3.org/1999/xhtml">An action can return zero or one output value.</span></li>
<li><span class="koboSpan" id="kobo.134.1" xmlns="http://www.w3.org/1999/xhtml">The action is what handles the HTTP request.</span></li>
</ul>
<blockquote>
<p><span class="koboSpan" id="kobo.135.1" xmlns="http://www.w3.org/1999/xhtml">We should group cohesive actions under the same controller, thus creating a loosely coupled unit.</span></p>
</blockquote>
<p><span class="koboSpan" id="kobo.136.1" xmlns="http://www.w3.org/1999/xhtml">For example, the following represents the </span><code><span class="koboSpan" id="kobo.137.1" xmlns="http://www.w3.org/1999/xhtml">SomeController</span></code><span class="koboSpan" id="kobo.138.1" xmlns="http://www.w3.org/1999/xhtml"> class containing a single </span><code><span class="koboSpan" id="kobo.139.1" xmlns="http://www.w3.org/1999/xhtml">Get</span></code><span class="koboSpan" id="kobo.140.1" xmlns="http://www.w3.org/1999/xhtml"> action:</span></p>
<div class="C0-CodePACKT">
<pre><code><span class="koboSpan" id="kobo.141.1" xmlns="http://www.w3.org/1999/xhtml">[Route("api/[controller]")]
[ApiController]
public class SomeController : ControllerBase
{
    [HttpGet]
    public IActionResult Get() =&gt; Ok();
}</span></code></pre>
</div>
<p><span class="koboSpan" id="kobo.142.1" xmlns="http://www.w3.org/1999/xhtml">The preceding </span><code><span class="koboSpan" id="kobo.143.1" xmlns="http://www.w3.org/1999/xhtml">Get</span></code><span class="koboSpan" id="kobo.144.1" xmlns="http://www.w3.org/1999/xhtml"> method (action) returns an empty </span><code><span class="koboSpan" id="kobo.145.1" xmlns="http://www.w3.org/1999/xhtml">200 OK</span></code><span class="koboSpan" id="kobo.146.1" xmlns="http://www.w3.org/1999/xhtml"> response to the client. </span><span class="koboSpan" id="kobo.146.2" xmlns="http://www.w3.org/1999/xhtml">We can reach the endpoint at the </span><code><span class="koboSpan" id="kobo.147.1" xmlns="http://www.w3.org/1999/xhtml">/api/some</span></code><span class="koboSpan" id="kobo.148.1" xmlns="http://www.w3.org/1999/xhtml"> URI. </span><span class="koboSpan" id="kobo.148.2" xmlns="http://www.w3.org/1999/xhtml">From there, we can add more actions.</span></p>
<blockquote>
<p><span class="koboSpan" id="kobo.149.1" xmlns="http://www.w3.org/1999/xhtml">The </span><code><span class="koboSpan" id="kobo.150.1" xmlns="http://www.w3.org/1999/xhtml">ControllerBase</span></code><span class="koboSpan" id="kobo.151.1" xmlns="http://www.w3.org/1999/xhtml"> class gives us access to most of the same utility methods as we had with the Minimal APIs </span><code><span class="koboSpan" id="kobo.152.1" xmlns="http://www.w3.org/1999/xhtml">TypedResults</span></code><span class="koboSpan" id="kobo.153.1" xmlns="http://www.w3.org/1999/xhtml"> class.</span></p>
</blockquote>
<p><span class="koboSpan" id="kobo.154.1" xmlns="http://www.w3.org/1999/xhtml">Next, we look at returning value.</span></p>
</section>
<section class="level4" data-number="7.2.3.4" id="returning-values">
<h4 data-number="7.2.3.4"><span class="koboSpan" id="kobo.155.1" xmlns="http://www.w3.org/1999/xhtml">Returning values</span></h4>
<p><span class="koboSpan" id="kobo.156.1" xmlns="http://www.w3.org/1999/xhtml">Building a REST API aims to return data to clients and execute remote operations. </span><span class="koboSpan" id="kobo.156.2" xmlns="http://www.w3.org/1999/xhtml">Most of the plumbing is done for us by the ASP.NET Core code, including serialization.</span></p>
<blockquote>
<p><span class="koboSpan" id="kobo.157.1" xmlns="http://www.w3.org/1999/xhtml">Most of the ASP.NET Core pipeline is customizable, which is out of the scope of this chapter.</span></p>
</blockquote>
<p><span class="koboSpan" id="kobo.158.1" xmlns="http://www.w3.org/1999/xhtml">Before returning values, let’s look at a few valuable helper methods provided by the </span><code><span class="koboSpan" id="kobo.159.1" xmlns="http://www.w3.org/1999/xhtml">ControllerBase</span></code><span class="koboSpan" id="kobo.160.1" xmlns="http://www.w3.org/1999/xhtml"> class:</span></p>
<table>
<colgroup>
<col style="width: 50%"/>
<col style="width: 50%"/>
</colgroup>
<tbody>
<tr class="odd">
<td><span class="koboSpan" id="kobo.161.1" xmlns="http://www.w3.org/1999/xhtml">Method</span></td>
<td><span class="koboSpan" id="kobo.162.1" xmlns="http://www.w3.org/1999/xhtml">Description</span></td>
</tr>
<tr class="even">
<td><code><span class="koboSpan" id="kobo.163.1" xmlns="http://www.w3.org/1999/xhtml">StatusCode</span></code></td>
<td><p><span class="koboSpan" id="kobo.164.1" xmlns="http://www.w3.org/1999/xhtml">Produces an empty response with the specified status code.</span></p>
<p><span class="koboSpan" id="kobo.165.1" xmlns="http://www.w3.org/1999/xhtml">We can optionally include a second argument to serialize in the response body.</span></p></td>
</tr>
<tr class="odd">
<td><code><span class="koboSpan" id="kobo.166.1" xmlns="http://www.w3.org/1999/xhtml">Ok</span></code></td>
<td><p><span class="koboSpan" id="kobo.167.1" xmlns="http://www.w3.org/1999/xhtml">Produces a </span><code><span class="koboSpan" id="kobo.168.1" xmlns="http://www.w3.org/1999/xhtml">200 OK</span></code><span class="koboSpan" id="kobo.169.1" xmlns="http://www.w3.org/1999/xhtml"> response, indicating the operation was successful.</span></p>
<p><span class="koboSpan" id="kobo.170.1" xmlns="http://www.w3.org/1999/xhtml">We can optionally include a second argument to serialize in the response body.</span></p></td>
</tr>
<tr class="even">
<td><code><span class="koboSpan" id="kobo.171.1" xmlns="http://www.w3.org/1999/xhtml">Created</span></code></td>
<td><p><span class="koboSpan" id="kobo.172.1" xmlns="http://www.w3.org/1999/xhtml">Produces a </span><code><span class="koboSpan" id="kobo.173.1" xmlns="http://www.w3.org/1999/xhtml">201 Created</span></code><span class="koboSpan" id="kobo.174.1" xmlns="http://www.w3.org/1999/xhtml"> response, indicating the system created the entity.</span></p>
<p><span class="koboSpan" id="kobo.175.1" xmlns="http://www.w3.org/1999/xhtml">We can optionally specify the location where to read the entity and the entity itself as arguments.</span></p>
<p><span class="koboSpan" id="kobo.176.1" xmlns="http://www.w3.org/1999/xhtml">The </span><code><span class="koboSpan" id="kobo.177.1" xmlns="http://www.w3.org/1999/xhtml">CreatedAtAction</span></code><span class="koboSpan" id="kobo.178.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><code><span class="koboSpan" id="kobo.179.1" xmlns="http://www.w3.org/1999/xhtml">CreatedAtRoute</span></code><span class="koboSpan" id="kobo.180.1" xmlns="http://www.w3.org/1999/xhtml"> methods give us options to compose the location value.</span></p></td>
</tr>
<tr class="odd">
<td><code><span class="koboSpan" id="kobo.181.1" xmlns="http://www.w3.org/1999/xhtml">NoContent</span></code></td>
<td><span class="koboSpan" id="kobo.182.1" xmlns="http://www.w3.org/1999/xhtml">Produces an empty </span><code><span class="koboSpan" id="kobo.183.1" xmlns="http://www.w3.org/1999/xhtml">204 No Content</span></code><span class="koboSpan" id="kobo.184.1" xmlns="http://www.w3.org/1999/xhtml"> response.</span></td>
</tr>
<tr class="even">
<td><code><span class="koboSpan" id="kobo.185.1" xmlns="http://www.w3.org/1999/xhtml">NotFound</span></code></td>
<td><span class="koboSpan" id="kobo.186.1" xmlns="http://www.w3.org/1999/xhtml">Produces a </span><code><span class="koboSpan" id="kobo.187.1" xmlns="http://www.w3.org/1999/xhtml">404 Not Found</span></code><span class="koboSpan" id="kobo.188.1" xmlns="http://www.w3.org/1999/xhtml"> response, indicating the resource was not found.</span></td>
</tr>
<tr class="odd">
<td><code><span class="koboSpan" id="kobo.189.1" xmlns="http://www.w3.org/1999/xhtml">BadRequest</span></code></td>
<td><span class="koboSpan" id="kobo.190.1" xmlns="http://www.w3.org/1999/xhtml">Produces a </span><code><span class="koboSpan" id="kobo.191.1" xmlns="http://www.w3.org/1999/xhtml">400 Bad Request</span></code><span class="koboSpan" id="kobo.192.1" xmlns="http://www.w3.org/1999/xhtml"> response, indicating an issue with the client request, often a validation error.</span></td>
</tr>
<tr class="even">
<td><code><span class="koboSpan" id="kobo.193.1" xmlns="http://www.w3.org/1999/xhtml">Redirect</span></code></td>
<td><p><span class="koboSpan" id="kobo.194.1" xmlns="http://www.w3.org/1999/xhtml">Produces a </span><code><span class="koboSpan" id="kobo.195.1" xmlns="http://www.w3.org/1999/xhtml">302 Found</span></code><span class="koboSpan" id="kobo.196.1" xmlns="http://www.w3.org/1999/xhtml"> response, accepting the </span><code><span class="koboSpan" id="kobo.197.1" xmlns="http://www.w3.org/1999/xhtml">Location</span></code><span class="koboSpan" id="kobo.198.1" xmlns="http://www.w3.org/1999/xhtml"> URL as an argument.</span></p>
<p><span class="koboSpan" id="kobo.199.1" xmlns="http://www.w3.org/1999/xhtml">Different </span><code><span class="koboSpan" id="kobo.200.1" xmlns="http://www.w3.org/1999/xhtml">Redirect*</span></code><span class="koboSpan" id="kobo.201.1" xmlns="http://www.w3.org/1999/xhtml"> methods produce </span><code><span class="koboSpan" id="kobo.202.1" xmlns="http://www.w3.org/1999/xhtml">301 Moved Permanently</span></code><span class="koboSpan" id="kobo.203.1" xmlns="http://www.w3.org/1999/xhtml">, </span><code><span class="koboSpan" id="kobo.204.1" xmlns="http://www.w3.org/1999/xhtml">307 Temporary Redirect</span></code><span class="koboSpan" id="kobo.205.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><code><span class="koboSpan" id="kobo.206.1" xmlns="http://www.w3.org/1999/xhtml">308 Permanent Redirect</span></code><span class="koboSpan" id="kobo.207.1" xmlns="http://www.w3.org/1999/xhtml"> responses instead.</span></p></td>
</tr>
<tr class="odd">
<td><code><span class="koboSpan" id="kobo.208.1" xmlns="http://www.w3.org/1999/xhtml">Accepted</span></code></td>
<td><p><span class="koboSpan" id="kobo.209.1" xmlns="http://www.w3.org/1999/xhtml">Produces a </span><code><span class="koboSpan" id="kobo.210.1" xmlns="http://www.w3.org/1999/xhtml">202 Accepted</span></code><span class="koboSpan" id="kobo.211.1" xmlns="http://www.w3.org/1999/xhtml"> response, indicating the beginning of an asynchronous process.</span></p>
<p><span class="koboSpan" id="kobo.212.1" xmlns="http://www.w3.org/1999/xhtml">We can optionally specify the location the client can query to learn about the status of the asynchronous operation. </span><span class="koboSpan" id="kobo.212.2" xmlns="http://www.w3.org/1999/xhtml">We can also optionally specify an object to serialize in the response body.</span></p>
<p><span class="koboSpan" id="kobo.213.1" xmlns="http://www.w3.org/1999/xhtml">The </span><code><span class="koboSpan" id="kobo.214.1" xmlns="http://www.w3.org/1999/xhtml">AcceptedAtAction</span></code><span class="koboSpan" id="kobo.215.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><code><span class="koboSpan" id="kobo.216.1" xmlns="http://www.w3.org/1999/xhtml">AcceptedAtRoute</span></code><span class="koboSpan" id="kobo.217.1" xmlns="http://www.w3.org/1999/xhtml"> methods give us options to compose the location value.</span></p></td>
</tr>
<tr class="even">
<td><code><span class="koboSpan" id="kobo.218.1" xmlns="http://www.w3.org/1999/xhtml">Conflict</span></code></td>
<td><span class="koboSpan" id="kobo.219.1" xmlns="http://www.w3.org/1999/xhtml">Produces a </span><code><span class="koboSpan" id="kobo.220.1" xmlns="http://www.w3.org/1999/xhtml">409 Conflict</span></code><span class="koboSpan" id="kobo.221.1" xmlns="http://www.w3.org/1999/xhtml"> response, indicating a conflict occurred when processing the request, often a concurrency error.</span></td>
</tr>
</tbody>
</table><span class="koboSpan" id="kobo.222.1" xmlns="http://www.w3.org/1999/xhtml">
Table 6.1: a subset of the ControllerBase methods producing an IActionResult.
</span><blockquote>
<p><span class="koboSpan" id="kobo.223.1" xmlns="http://www.w3.org/1999/xhtml">Other methods in the </span><code><span class="koboSpan" id="kobo.224.1" xmlns="http://www.w3.org/1999/xhtml">ControllerBase</span></code><span class="koboSpan" id="kobo.225.1" xmlns="http://www.w3.org/1999/xhtml"> class are self-discoverable using IntelliSense (code completion) or in the official documentation. </span><span class="koboSpan" id="kobo.225.2" xmlns="http://www.w3.org/1999/xhtml">Most, if not all, of what we covered in </span><em><span class="koboSpan" id="kobo.226.1" xmlns="http://www.w3.org/1999/xhtml">Chapter 5</span></em><span class="koboSpan" id="kobo.227.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.228.1" xmlns="http://www.w3.org/1999/xhtml">Minimal APIs</span></em><span class="koboSpan" id="kobo.229.1" xmlns="http://www.w3.org/1999/xhtml">, is also available to controllers.</span></p>
</blockquote>
<p><span class="koboSpan" id="kobo.230.1" xmlns="http://www.w3.org/1999/xhtml">The advantage of using a helper method is leveraging the ASP.NET Core MVC mechanism, making our life easier. </span><span class="koboSpan" id="kobo.230.2" xmlns="http://www.w3.org/1999/xhtml">However, you could manually manage the HTTP response using lower-level APIs like </span><code><span class="koboSpan" id="kobo.231.1" xmlns="http://www.w3.org/1999/xhtml">HttpContext</span></code><span class="koboSpan" id="kobo.232.1" xmlns="http://www.w3.org/1999/xhtml"> or create custom classes that implement the </span><code><span class="koboSpan" id="kobo.233.1" xmlns="http://www.w3.org/1999/xhtml">IActionResult</span></code><span class="koboSpan" id="kobo.234.1" xmlns="http://www.w3.org/1999/xhtml"> interface to hook your custom response classes into the MVC pipeline.Now let’s look at the multiple ways we can use to return data to the client:</span></p>
<table>
<colgroup>
<col style="width: 50%"/>
<col style="width: 50%"/>
</colgroup>
<tbody>
<tr class="odd">
<td><span class="koboSpan" id="kobo.235.1" xmlns="http://www.w3.org/1999/xhtml">Return type</span></td>
<td><span class="koboSpan" id="kobo.236.1" xmlns="http://www.w3.org/1999/xhtml">Description</span></td>
</tr>
<tr class="even">
<td><code><span class="koboSpan" id="kobo.237.1" xmlns="http://www.w3.org/1999/xhtml">void</span></code></td>
<td><p><span class="koboSpan" id="kobo.238.1" xmlns="http://www.w3.org/1999/xhtml">We can return </span><code><span class="koboSpan" id="kobo.239.1" xmlns="http://www.w3.org/1999/xhtml">void</span></code><span class="koboSpan" id="kobo.240.1" xmlns="http://www.w3.org/1999/xhtml"> and manually manage the HTTP response using the </span><code><span class="koboSpan" id="kobo.241.1" xmlns="http://www.w3.org/1999/xhtml">HttpContext</span></code><span class="koboSpan" id="kobo.242.1" xmlns="http://www.w3.org/1999/xhtml"> class.</span></p>
<p><span class="koboSpan" id="kobo.243.1" xmlns="http://www.w3.org/1999/xhtml">This is the most low-level and complex way.</span></p></td>
</tr>
<tr class="odd">
<td><code><span class="koboSpan" id="kobo.244.1" xmlns="http://www.w3.org/1999/xhtml">TModel</span></code></td>
<td><span class="koboSpan" id="kobo.245.1" xmlns="http://www.w3.org/1999/xhtml">We can directly return the model, which ASP.NET Core will serialize. </span><span class="koboSpan" id="kobo.245.2" xmlns="http://www.w3.org/1999/xhtml">The problem with this approach is that we don’t control the status code, nor can we return multiple different results from the action.</span></td>
</tr>
<tr class="even">
<td><p><code><span class="koboSpan" id="kobo.246.1" xmlns="http://www.w3.org/1999/xhtml">ActionResult</span></code></p>
<p><code><span class="koboSpan" id="kobo.247.1" xmlns="http://www.w3.org/1999/xhtml">IActionResult</span></code></p></td>
<td><p><span class="koboSpan" id="kobo.248.1" xmlns="http://www.w3.org/1999/xhtml">We can return one of those two abstractions. </span><span class="koboSpan" id="kobo.248.2" xmlns="http://www.w3.org/1999/xhtml">The concrete result can take many forms depending on the implementation that the action method returns.</span></p>
<p><span class="koboSpan" id="kobo.249.1" xmlns="http://www.w3.org/1999/xhtml">However, doing this makes our API less auto-discoverable by tools like SwaggerGen.</span></p></td>
</tr>
<tr class="odd">
<td><code><span class="koboSpan" id="kobo.250.1" xmlns="http://www.w3.org/1999/xhtml">ActionResult&lt;TModel&gt;</span></code></td>
<td><p><span class="koboSpan" id="kobo.251.1" xmlns="http://www.w3.org/1999/xhtml">We can return the </span><code><span class="koboSpan" id="kobo.252.1" xmlns="http://www.w3.org/1999/xhtml">TModel</span></code><span class="koboSpan" id="kobo.253.1" xmlns="http://www.w3.org/1999/xhtml"> directly and other results like a </span><code><span class="koboSpan" id="kobo.254.1" xmlns="http://www.w3.org/1999/xhtml">NotFoundResult</span></code><span class="koboSpan" id="kobo.255.1" xmlns="http://www.w3.org/1999/xhtml"> or a </span><code><span class="koboSpan" id="kobo.256.1" xmlns="http://www.w3.org/1999/xhtml">BadRequestResult</span></code><span class="koboSpan" id="kobo.257.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.258.1" xmlns="http://www.w3.org/1999/xhtml">This is the most flexible way that makes the API the most discoverable by the ApiExplorer.</span></p></td>
</tr>
</tbody>
</table><span class="koboSpan" id="kobo.259.1" xmlns="http://www.w3.org/1999/xhtml">
Table 6.2: multiple ways to return data
</span><p><span class="koboSpan" id="kobo.260.1" xmlns="http://www.w3.org/1999/xhtml">We start with an example where the actions return an instance of the </span><code><span class="koboSpan" id="kobo.261.1" xmlns="http://www.w3.org/1999/xhtml">Model</span></code><span class="koboSpan" id="kobo.262.1" xmlns="http://www.w3.org/1999/xhtml"> class by leveraging the </span><code><span class="koboSpan" id="kobo.263.1" xmlns="http://www.w3.org/1999/xhtml">Ok</span></code><span class="koboSpan" id="kobo.264.1" xmlns="http://www.w3.org/1999/xhtml"> method (highlighted code):</span></p>
<div class="C0-CodePACKT">
<pre><code><span class="koboSpan" id="kobo.265.1" xmlns="http://www.w3.org/1999/xhtml">using Microsoft.AspNetCore.Mvc;
namespace MVC.API.Controllers;
[Route("api/[controller]")]
[ApiController]
public class ValuesController : ControllerBase
{
    [HttpGet("IActionResult")]
    public IActionResult InterfaceAction()
        =&gt; Ok(new Model(nameof(InterfaceAction)));
    [HttpGet("ActionResult")]
    public ActionResult ClassAction()
        =&gt; Ok(new Model(nameof(ClassAction)));
    // ...
    </span><span class="koboSpan" id="kobo.265.2" xmlns="http://www.w3.org/1999/xhtml">public record class Model(string Name);
}</span></code></pre>
</div>
<p><span class="koboSpan" id="kobo.266.1" xmlns="http://www.w3.org/1999/xhtml">The problem with the preceding code is API discoverability. </span><span class="koboSpan" id="kobo.266.2" xmlns="http://www.w3.org/1999/xhtml">The </span><code><span class="koboSpan" id="kobo.267.1" xmlns="http://www.w3.org/1999/xhtml">ApiExplorer</span></code><span class="koboSpan" id="kobo.268.1" xmlns="http://www.w3.org/1999/xhtml"> can’t know what the endpoints return. </span><span class="koboSpan" id="kobo.268.2" xmlns="http://www.w3.org/1999/xhtml">The </span><code><span class="koboSpan" id="kobo.269.1" xmlns="http://www.w3.org/1999/xhtml">ApiExplorer</span></code><span class="koboSpan" id="kobo.270.1" xmlns="http://www.w3.org/1999/xhtml"> describes the actions as returning </span><code><span class="koboSpan" id="kobo.271.1" xmlns="http://www.w3.org/1999/xhtml">200 OK</span></code><span class="koboSpan" id="kobo.272.1" xmlns="http://www.w3.org/1999/xhtml"> but doesn’t know about the </span><code><span class="koboSpan" id="kobo.273.1" xmlns="http://www.w3.org/1999/xhtml">Model</span></code><span class="koboSpan" id="kobo.274.1" xmlns="http://www.w3.org/1999/xhtml"> class.To overcome this limitation, we can decorate our actions with the </span><code><span class="koboSpan" id="kobo.275.1" xmlns="http://www.w3.org/1999/xhtml">ProducesResponseType</span></code><span class="koboSpan" id="kobo.276.1" xmlns="http://www.w3.org/1999/xhtml"> attribute, effectively circumventing the limitation as shown below:</span></p>
<div class="C0-CodePACKT">
<pre><code><span class="koboSpan" id="kobo.277.1" xmlns="http://www.w3.org/1999/xhtml">[ProducesResponseType(typeof(Model), StatusCodes.Status200OK)]
public IActionResult InterfaceAction() { ... </span><span class="koboSpan" id="kobo.277.2" xmlns="http://www.w3.org/1999/xhtml">}</span></code></pre>
</div>
<p><span class="koboSpan" id="kobo.278.1" xmlns="http://www.w3.org/1999/xhtml">In the preceding code, we specify the return type as the first argument and the status code as the second. </span><span class="koboSpan" id="kobo.278.2" xmlns="http://www.w3.org/1999/xhtml">Using the constants of the </span><code><span class="koboSpan" id="kobo.279.1" xmlns="http://www.w3.org/1999/xhtml">StatusCodes</span></code><span class="koboSpan" id="kobo.280.1" xmlns="http://www.w3.org/1999/xhtml"> class is a convenient way to reference standard status codes. </span><span class="koboSpan" id="kobo.280.2" xmlns="http://www.w3.org/1999/xhtml">We can decorate each action with multiple </span><code><span class="koboSpan" id="kobo.281.1" xmlns="http://www.w3.org/1999/xhtml">ProducesResponseType</span></code><span class="koboSpan" id="kobo.282.1" xmlns="http://www.w3.org/1999/xhtml"> attributes to define alternate states, such as </span><code><span class="koboSpan" id="kobo.283.1" xmlns="http://www.w3.org/1999/xhtml">404</span></code><span class="koboSpan" id="kobo.284.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><code><span class="koboSpan" id="kobo.285.1" xmlns="http://www.w3.org/1999/xhtml">400</span></code><span class="koboSpan" id="kobo.286.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<blockquote>
<p><span class="koboSpan" id="kobo.287.1" xmlns="http://www.w3.org/1999/xhtml">With ASP.NET Core MVC, we can also define conventions that apply broad rules to our controllers, allowing us to define those conventions once and reuse them throughout our application. </span><span class="koboSpan" id="kobo.287.2" xmlns="http://www.w3.org/1999/xhtml">I left a link in the </span><em><span class="koboSpan" id="kobo.288.1" xmlns="http://www.w3.org/1999/xhtml">Further reading</span></em><span class="koboSpan" id="kobo.289.1" xmlns="http://www.w3.org/1999/xhtml"> section.</span></p>
</blockquote>
<p><span class="koboSpan" id="kobo.290.1" xmlns="http://www.w3.org/1999/xhtml">Next, We explore how we can return a </span><code><span class="koboSpan" id="kobo.291.1" xmlns="http://www.w3.org/1999/xhtml">Model</span></code><span class="koboSpan" id="kobo.292.1" xmlns="http://www.w3.org/1999/xhtml"> instance directly. </span><span class="koboSpan" id="kobo.292.2" xmlns="http://www.w3.org/1999/xhtml">The </span><code><span class="koboSpan" id="kobo.293.1" xmlns="http://www.w3.org/1999/xhtml">ApiExplorer</span></code><span class="koboSpan" id="kobo.294.1" xmlns="http://www.w3.org/1999/xhtml"> can discover the return value of the method this way, so we do not need to use the </span><code><span class="koboSpan" id="kobo.295.1" xmlns="http://www.w3.org/1999/xhtml">ProducesResponseType</span></code><span class="koboSpan" id="kobo.296.1" xmlns="http://www.w3.org/1999/xhtml"> attribute:</span></p>
<div class="C0-CodePACKT">
<pre><code><span class="koboSpan" id="kobo.297.1" xmlns="http://www.w3.org/1999/xhtml">[HttpGet("DirectModel")]
public Model DirectModel()
    =&gt; new Model(nameof(DirectModel)); </span></code></pre>
</div>
<p><span class="koboSpan" id="kobo.298.1" xmlns="http://www.w3.org/1999/xhtml">Next, thanks to </span><strong><span class="koboSpan" id="kobo.299.1" xmlns="http://www.w3.org/1999/xhtml">class conversion operators</span></strong><span class="koboSpan" id="kobo.300.1" xmlns="http://www.w3.org/1999/xhtml"> (see </span><em><span class="koboSpan" id="kobo.301.1" xmlns="http://www.w3.org/1999/xhtml">Appendix A</span></em><span class="koboSpan" id="kobo.302.1" xmlns="http://www.w3.org/1999/xhtml"> for more info), we can do the same with </span><code><span class="koboSpan" id="kobo.303.1" xmlns="http://www.w3.org/1999/xhtml">ActionResult&lt;T&gt;</span></code><span class="koboSpan" id="kobo.304.1" xmlns="http://www.w3.org/1999/xhtml">, like this:</span></p>
<div class="C0-CodePACKT">
<pre><code><span class="koboSpan" id="kobo.305.1" xmlns="http://www.w3.org/1999/xhtml">[HttpGet("ActionResultT")]
public ActionResult&lt;Model&gt; ActionResultT()
    =&gt; new Model(nameof(ActionResultT));</span></code></pre>
</div>
<p><span class="koboSpan" id="kobo.306.1" xmlns="http://www.w3.org/1999/xhtml">The main benefit of using </span><code><span class="koboSpan" id="kobo.307.1" xmlns="http://www.w3.org/1999/xhtml">ActionResult&lt;T&gt;</span></code><span class="koboSpan" id="kobo.308.1" xmlns="http://www.w3.org/1999/xhtml"> is to return other types of results. </span><span class="koboSpan" id="kobo.308.2" xmlns="http://www.w3.org/1999/xhtml">Here is an example showing this where the method returns either </span><code><span class="koboSpan" id="kobo.309.1" xmlns="http://www.w3.org/1999/xhtml">Ok</span></code><span class="koboSpan" id="kobo.310.1" xmlns="http://www.w3.org/1999/xhtml"> or </span><code><span class="koboSpan" id="kobo.311.1" xmlns="http://www.w3.org/1999/xhtml">NotFound</span></code><span class="koboSpan" id="kobo.312.1" xmlns="http://www.w3.org/1999/xhtml">:</span></p>
<div class="C0-CodePACKT">
<pre><code><span class="koboSpan" id="kobo.313.1" xmlns="http://www.w3.org/1999/xhtml">[HttpGet("MultipleResults")]
public ActionResult&lt;Model&gt; MultipleResults()
{
    var condition = Random.Shared
        .GetItems(new[] { true, false }, 1)
        .First();
    return condition
        ? </span><span class="koboSpan" id="kobo.313.2" xmlns="http://www.w3.org/1999/xhtml">Ok(new Model(nameof(MultipleResults)))
        : NotFound();
}</span></code></pre>
</div>
<p><span class="koboSpan" id="kobo.314.1" xmlns="http://www.w3.org/1999/xhtml">However, the </span><code><span class="koboSpan" id="kobo.315.1" xmlns="http://www.w3.org/1999/xhtml">ApiExplorer</span></code><span class="koboSpan" id="kobo.316.1" xmlns="http://www.w3.org/1999/xhtml"> does not know about the </span><code><span class="koboSpan" id="kobo.317.1" xmlns="http://www.w3.org/1999/xhtml">404 Not Found</span></code><span class="koboSpan" id="kobo.318.1" xmlns="http://www.w3.org/1999/xhtml">, so we must document it using the </span><code><span class="koboSpan" id="kobo.319.1" xmlns="http://www.w3.org/1999/xhtml">ProducesResponseType</span></code><span class="koboSpan" id="kobo.320.1" xmlns="http://www.w3.org/1999/xhtml"> attribute.</span></p>
<blockquote>
<p><span class="koboSpan" id="kobo.321.1" xmlns="http://www.w3.org/1999/xhtml">We can return a </span><code><span class="koboSpan" id="kobo.322.1" xmlns="http://www.w3.org/1999/xhtml">Task&lt;T&gt;</span></code><span class="koboSpan" id="kobo.323.1" xmlns="http://www.w3.org/1999/xhtml"> or a </span><code><span class="koboSpan" id="kobo.324.1" xmlns="http://www.w3.org/1999/xhtml">ValueTask&lt;T&gt;</span></code><span class="koboSpan" id="kobo.325.1" xmlns="http://www.w3.org/1999/xhtml"> from the action method when the method body is asynchronous. </span><span class="koboSpan" id="kobo.325.2" xmlns="http://www.w3.org/1999/xhtml">Doing so lets you write the async/await code from the controller.</span></p>
<blockquote>
<p><span class="koboSpan" id="kobo.326.1" xmlns="http://www.w3.org/1999/xhtml">I highly recommend returning a </span><code><span class="koboSpan" id="kobo.327.1" xmlns="http://www.w3.org/1999/xhtml">Task&lt;T&gt;</span></code><span class="koboSpan" id="kobo.328.1" xmlns="http://www.w3.org/1999/xhtml"> or a </span><code><span class="koboSpan" id="kobo.329.1" xmlns="http://www.w3.org/1999/xhtml">ValueTask&lt;T&gt;</span></code><span class="koboSpan" id="kobo.330.1" xmlns="http://www.w3.org/1999/xhtml"> whenever possible because it allows your REST API to handle more requests using the same resources without effort. </span><span class="koboSpan" id="kobo.330.2" xmlns="http://www.w3.org/1999/xhtml">Nowadays, non-Task-based methods in libraries are infrequent, so you will most likely have little choice.</span></p>
</blockquote>
</blockquote>
<p><span class="koboSpan" id="kobo.331.1" xmlns="http://www.w3.org/1999/xhtml">We learned multiple ways to return values from an action. </span><span class="koboSpan" id="kobo.331.2" xmlns="http://www.w3.org/1999/xhtml">The </span><code><span class="koboSpan" id="kobo.332.1" xmlns="http://www.w3.org/1999/xhtml">ActionResult&lt;T&gt;</span></code><span class="koboSpan" id="kobo.333.1" xmlns="http://www.w3.org/1999/xhtml"> class is the most flexible regarding feature support. </span><span class="koboSpan" id="kobo.333.2" xmlns="http://www.w3.org/1999/xhtml">On the other hand, </span><code><span class="koboSpan" id="kobo.334.1" xmlns="http://www.w3.org/1999/xhtml">IActionResult</span></code><span class="koboSpan" id="kobo.335.1" xmlns="http://www.w3.org/1999/xhtml"> is the most abstract one.Next, we look at routing requests to those action methods.</span></p>
</section>
<section class="level4" data-number="7.2.3.5" id="attribute-routing">
<h4 data-number="7.2.3.5"><span class="koboSpan" id="kobo.336.1" xmlns="http://www.w3.org/1999/xhtml">Attribute routing</span></h4>
<p><span class="koboSpan" id="kobo.337.1" xmlns="http://www.w3.org/1999/xhtml">Attribute routing maps an HTTP request to a controller action. </span><span class="koboSpan" id="kobo.337.2" xmlns="http://www.w3.org/1999/xhtml">Those attributes decorate the controllers and the actions to create the complete routes. </span><span class="koboSpan" id="kobo.337.3" xmlns="http://www.w3.org/1999/xhtml">We already used some of those attributes. </span><span class="koboSpan" id="kobo.337.4" xmlns="http://www.w3.org/1999/xhtml">Nonetheless, let’s visit those attributes:</span></p>
<div class="C0-CodePACKT">
<pre><code><span class="koboSpan" id="kobo.338.1" xmlns="http://www.w3.org/1999/xhtml">namespace MVC.API.Controllers.Empty;
[Route("empty/[controller]")]
[ApiController]
public class CustomersController : ControllerBase
{
    [HttpGet]
    public Task&lt;IEnumerable&lt;Customer&gt;&gt; GetAllAsync(
        ICustomerRepository customerRepository)
        =&gt; throw new NotImplementedException();
    [HttpGet("{id}")]
    public Task&lt;ActionResult&lt;Customer&gt;&gt; GetOneAsync(
        int id, ICustomerRepository customerRepository)
        =&gt; throw new NotImplementedException();
    [HttpPost]
    public Task&lt;ActionResult&gt; PostAsync(
        [FromBody] Customer value, ICustomerRepository customerRepository)
        =&gt; throw new NotImplementedException();
    [HttpPut("{id}")]
    public Task&lt;ActionResult&lt;Customer&gt;&gt; PutAsync(
        int id, [FromBody] Customer value, 
        ICustomerRepository customerRepository)
        =&gt; throw new NotImplementedException();
    [HttpDelete("{id}")]
    public Task&lt;ActionResult&lt;Customer&gt;&gt; DeleteAsync(
        int id, ICustomerRepository customerRepository)
        =&gt; throw new NotImplementedException();
}</span></code></pre>
</div>
<p><span class="koboSpan" id="kobo.339.1" xmlns="http://www.w3.org/1999/xhtml">The </span><code><span class="koboSpan" id="kobo.340.1" xmlns="http://www.w3.org/1999/xhtml">Route</span></code><span class="koboSpan" id="kobo.341.1" xmlns="http://www.w3.org/1999/xhtml"> attributes and </span><code><span class="koboSpan" id="kobo.342.1" xmlns="http://www.w3.org/1999/xhtml">Http[Method]</span></code><span class="koboSpan" id="kobo.343.1" xmlns="http://www.w3.org/1999/xhtml"> attributes define what a user should query to reach a specific resource. </span><span class="koboSpan" id="kobo.343.2" xmlns="http://www.w3.org/1999/xhtml">The </span><code><span class="koboSpan" id="kobo.344.1" xmlns="http://www.w3.org/1999/xhtml">Route</span></code><span class="koboSpan" id="kobo.345.1" xmlns="http://www.w3.org/1999/xhtml"> attribute allows us to define a routing pattern that applies to all HTTP methods under the decorated controller. </span><span class="koboSpan" id="kobo.345.2" xmlns="http://www.w3.org/1999/xhtml">The </span><code><span class="koboSpan" id="kobo.346.1" xmlns="http://www.w3.org/1999/xhtml">Http[Method]</span></code><span class="koboSpan" id="kobo.347.1" xmlns="http://www.w3.org/1999/xhtml"> attributes determine the HTTP method used to reach that action method. </span><span class="koboSpan" id="kobo.347.2" xmlns="http://www.w3.org/1999/xhtml">They also offer the possibility to set an optional and additive route pattern to handle more complex routes, including specifying route parameters. </span><span class="koboSpan" id="kobo.347.3" xmlns="http://www.w3.org/1999/xhtml">Those attributes are beneficial in crafting concise and clear URLs while keeping the routing system close to the controller. </span><span class="koboSpan" id="kobo.347.4" xmlns="http://www.w3.org/1999/xhtml">All routes must be unique.Based on the code, </span><code><span class="koboSpan" id="kobo.348.1" xmlns="http://www.w3.org/1999/xhtml">[Route("empty/[controller]")]</span></code><span class="koboSpan" id="kobo.349.1" xmlns="http://www.w3.org/1999/xhtml"> means that the actions of this controller are reachable through </span><code><span class="koboSpan" id="kobo.350.1" xmlns="http://www.w3.org/1999/xhtml">empty/customers</span></code><span class="koboSpan" id="kobo.351.1" xmlns="http://www.w3.org/1999/xhtml"> (MVC ignores the </span><code><span class="koboSpan" id="kobo.352.1" xmlns="http://www.w3.org/1999/xhtml">Controller</span></code><span class="koboSpan" id="kobo.353.1" xmlns="http://www.w3.org/1999/xhtml"> suffix). </span><span class="koboSpan" id="kobo.353.2" xmlns="http://www.w3.org/1999/xhtml">Then, the other attributes tell ASP.NET to map specific requests to specific methods:</span></p>
<table>
<tbody>
<tr class="odd">
<td><span class="koboSpan" id="kobo.354.1" xmlns="http://www.w3.org/1999/xhtml">Routing Attribute</span></td>
<td><span class="koboSpan" id="kobo.355.1" xmlns="http://www.w3.org/1999/xhtml">HTTP Method</span></td>
<td><span class="koboSpan" id="kobo.356.1" xmlns="http://www.w3.org/1999/xhtml">URL</span></td>
</tr>
<tr class="even">
<td><code><span class="koboSpan" id="kobo.357.1" xmlns="http://www.w3.org/1999/xhtml">HttpGet</span></code></td>
<td><code><span class="koboSpan" id="kobo.358.1" xmlns="http://www.w3.org/1999/xhtml">GET</span></code></td>
<td><code><span class="koboSpan" id="kobo.359.1" xmlns="http://www.w3.org/1999/xhtml">empty/customers</span></code></td>
</tr>
<tr class="odd">
<td><code><span class="koboSpan" id="kobo.360.1" xmlns="http://www.w3.org/1999/xhtml">HttpGet("{id}")</span></code></td>
<td><code><span class="koboSpan" id="kobo.361.1" xmlns="http://www.w3.org/1999/xhtml">GET</span></code></td>
<td><code><span class="koboSpan" id="kobo.362.1" xmlns="http://www.w3.org/1999/xhtml">empty/customers/{id}</span></code></td>
</tr>
<tr class="even">
<td><code><span class="koboSpan" id="kobo.363.1" xmlns="http://www.w3.org/1999/xhtml">HttpPost</span></code></td>
<td><code><span class="koboSpan" id="kobo.364.1" xmlns="http://www.w3.org/1999/xhtml">POST</span></code></td>
<td><code><span class="koboSpan" id="kobo.365.1" xmlns="http://www.w3.org/1999/xhtml">empty/customers</span></code></td>
</tr>
<tr class="odd">
<td><code><span class="koboSpan" id="kobo.366.1" xmlns="http://www.w3.org/1999/xhtml">HttpPut("{id}")</span></code></td>
<td><code><span class="koboSpan" id="kobo.367.1" xmlns="http://www.w3.org/1999/xhtml">PUT</span></code></td>
<td><code><span class="koboSpan" id="kobo.368.1" xmlns="http://www.w3.org/1999/xhtml">empty/customers/{id}</span></code></td>
</tr>
<tr class="even">
<td><code><span class="koboSpan" id="kobo.369.1" xmlns="http://www.w3.org/1999/xhtml">HttpDelete("{id}")</span></code></td>
<td><code><span class="koboSpan" id="kobo.370.1" xmlns="http://www.w3.org/1999/xhtml">DELETE</span></code></td>
<td><code><span class="koboSpan" id="kobo.371.1" xmlns="http://www.w3.org/1999/xhtml">empty/customers/{id}</span></code></td>
</tr>
</tbody>
</table><span class="koboSpan" id="kobo.372.1" xmlns="http://www.w3.org/1999/xhtml">
Table 6.3: routing attributes of the example controller and their final URL
</span><p><span class="koboSpan" id="kobo.373.1" xmlns="http://www.w3.org/1999/xhtml">As we can see from the preceding table, we can even use the same attribute for multiple actions as long as the URL is unique. </span><span class="koboSpan" id="kobo.373.2" xmlns="http://www.w3.org/1999/xhtml">In this case, the </span><code><span class="koboSpan" id="kobo.374.1" xmlns="http://www.w3.org/1999/xhtml">id</span></code><span class="koboSpan" id="kobo.375.1" xmlns="http://www.w3.org/1999/xhtml"> parameter is the </span><code><span class="koboSpan" id="kobo.376.1" xmlns="http://www.w3.org/1999/xhtml">GET</span></code><span class="koboSpan" id="kobo.377.1" xmlns="http://www.w3.org/1999/xhtml"> discriminator.Next, we can use the </span><code><span class="koboSpan" id="kobo.378.1" xmlns="http://www.w3.org/1999/xhtml">FromBody</span></code><span class="koboSpan" id="kobo.379.1" xmlns="http://www.w3.org/1999/xhtml"> attribute to tell the model binder to use the HTTP request body to get the value of that parameter. </span><span class="koboSpan" id="kobo.379.2" xmlns="http://www.w3.org/1999/xhtml">There are many of those attributes; here’s a list:</span></p>
<table>
<tbody>
<tr class="odd">
<td><span class="koboSpan" id="kobo.380.1" xmlns="http://www.w3.org/1999/xhtml">Attribute</span></td>
<td><span class="koboSpan" id="kobo.381.1" xmlns="http://www.w3.org/1999/xhtml">Description</span></td>
</tr>
<tr class="even">
<td><code><span class="koboSpan" id="kobo.382.1" xmlns="http://www.w3.org/1999/xhtml">FromBody</span></code></td>
<td><span class="koboSpan" id="kobo.383.1" xmlns="http://www.w3.org/1999/xhtml">Binds the JSON body of the request to the parameter’s type.</span></td>
</tr>
<tr class="odd">
<td><code><span class="koboSpan" id="kobo.384.1" xmlns="http://www.w3.org/1999/xhtml">FromForm</span></code></td>
<td><span class="koboSpan" id="kobo.385.1" xmlns="http://www.w3.org/1999/xhtml">Binds the form value that matches the name of the parameter.</span></td>
</tr>
<tr class="even">
<td><code><span class="koboSpan" id="kobo.386.1" xmlns="http://www.w3.org/1999/xhtml">FromHeader</span></code></td>
<td><span class="koboSpan" id="kobo.387.1" xmlns="http://www.w3.org/1999/xhtml">Binds the HTTP header value that matches the name of the parameter.</span></td>
</tr>
<tr class="odd">
<td><code><span class="koboSpan" id="kobo.388.1" xmlns="http://www.w3.org/1999/xhtml">FromQuery</span></code></td>
<td><span class="koboSpan" id="kobo.389.1" xmlns="http://www.w3.org/1999/xhtml">Binds the query string value that matches the name of the parameter.</span></td>
</tr>
<tr class="even">
<td><code><span class="koboSpan" id="kobo.390.1" xmlns="http://www.w3.org/1999/xhtml">FromRoute</span></code></td>
<td><span class="koboSpan" id="kobo.391.1" xmlns="http://www.w3.org/1999/xhtml">Binds the route value that matches the name of the parameter.</span></td>
</tr>
<tr class="odd">
<td><code><span class="koboSpan" id="kobo.392.1" xmlns="http://www.w3.org/1999/xhtml">FromServices</span></code></td>
<td><span class="koboSpan" id="kobo.393.1" xmlns="http://www.w3.org/1999/xhtml">Inject the service from the ASP.NET Core dependency container.</span></td>
</tr>
</tbody>
</table><span class="koboSpan" id="kobo.394.1" xmlns="http://www.w3.org/1999/xhtml">
Table 6.4: MVC binding sources
</span><blockquote>
<p><span class="koboSpan" id="kobo.395.1" xmlns="http://www.w3.org/1999/xhtml">ASP.NET Core MVC does many implicit binding, so you don’t always need to decorate all parameters with an attribute. </span><span class="koboSpan" id="kobo.395.2" xmlns="http://www.w3.org/1999/xhtml">For example, .NET injects the services we needed in the code samples, and we never used the </span><code><span class="koboSpan" id="kobo.396.1" xmlns="http://www.w3.org/1999/xhtml">FromServices</span></code><span class="koboSpan" id="kobo.397.1" xmlns="http://www.w3.org/1999/xhtml"> attribute. </span><span class="koboSpan" id="kobo.397.2" xmlns="http://www.w3.org/1999/xhtml">Same with the </span><code><span class="koboSpan" id="kobo.398.1" xmlns="http://www.w3.org/1999/xhtml">FromRoute</span></code><span class="koboSpan" id="kobo.399.1" xmlns="http://www.w3.org/1999/xhtml"> attribute.</span></p>
</blockquote>
<p><span class="koboSpan" id="kobo.400.1" xmlns="http://www.w3.org/1999/xhtml">Now, if we look back at </span><code><span class="koboSpan" id="kobo.401.1" xmlns="http://www.w3.org/1999/xhtml">CustomersController</span></code><span class="koboSpan" id="kobo.402.1" xmlns="http://www.w3.org/1999/xhtml">, the route map looks like the following (I excluded non-route-related code to improve readability):</span></p>
<table>
<tbody>
<tr class="odd">
<td><strong><span class="koboSpan" id="kobo.403.1" xmlns="http://www.w3.org/1999/xhtml">URL</span></strong></td>
<td><strong><span class="koboSpan" id="kobo.404.1" xmlns="http://www.w3.org/1999/xhtml">Action/Method</span></strong></td>
</tr>
<tr class="even">
<td><code><span class="koboSpan" id="kobo.405.1" xmlns="http://www.w3.org/1999/xhtml">GET empty/customers</span></code></td>
<td><code><span class="koboSpan" id="kobo.406.1" xmlns="http://www.w3.org/1999/xhtml">GetAllAsync()</span></code></td>
</tr>
<tr class="odd">
<td><code><span class="koboSpan" id="kobo.407.1" xmlns="http://www.w3.org/1999/xhtml">GET empty/customers/{id}</span></code></td>
<td><code><span class="koboSpan" id="kobo.408.1" xmlns="http://www.w3.org/1999/xhtml">GetOneAsync(int id)</span></code></td>
</tr>
<tr class="even">
<td><code><span class="koboSpan" id="kobo.409.1" xmlns="http://www.w3.org/1999/xhtml">POST empty/customers</span></code></td>
<td><code><span class="koboSpan" id="kobo.410.1" xmlns="http://www.w3.org/1999/xhtml">PostAsync([FromBody] Customer value)</span></code></td>
</tr>
<tr class="odd">
<td><code><span class="koboSpan" id="kobo.411.1" xmlns="http://www.w3.org/1999/xhtml">PUT empty/customers/{id}</span></code></td>
<td><code><span class="koboSpan" id="kobo.412.1" xmlns="http://www.w3.org/1999/xhtml">PutAsync(int id, [FromBody] Customer value)</span></code></td>
</tr>
<tr class="even">
<td><code><span class="koboSpan" id="kobo.413.1" xmlns="http://www.w3.org/1999/xhtml">DELETE empty/customers/{id}</span></code></td>
<td><code><span class="koboSpan" id="kobo.414.1" xmlns="http://www.w3.org/1999/xhtml">DeleteAsync(int id)</span></code></td>
</tr>
</tbody>
</table><span class="koboSpan" id="kobo.415.1" xmlns="http://www.w3.org/1999/xhtml">
Table 6.5: the map between the URLs and their respective action methods
</span><p><span class="koboSpan" id="kobo.416.1" xmlns="http://www.w3.org/1999/xhtml">When designing a REST API, the URL leading to our endpoints should be clear and concise, making it easy for consumers to discover and learn. </span><span class="koboSpan" id="kobo.416.2" xmlns="http://www.w3.org/1999/xhtml">Hierarchically grouping our resources by responsibility (concern) and creating a cohesive URL space help achieve that goal. </span><span class="koboSpan" id="kobo.416.3" xmlns="http://www.w3.org/1999/xhtml">Consumers (a.k.a. </span><span class="koboSpan" id="kobo.416.4" xmlns="http://www.w3.org/1999/xhtml">other developers) should understand the logic behind the endpoints easily. </span><span class="koboSpan" id="kobo.416.5" xmlns="http://www.w3.org/1999/xhtml">Think about your endpoints as if you were the consumer of the REST API. </span><span class="koboSpan" id="kobo.416.6" xmlns="http://www.w3.org/1999/xhtml">I would even extend that suggestion to any API; always consider the consumers of your code to create the best possible APIs.</span></p>
</section>
</section>
<section class="level3" data-number="7.2.4" id="conclusion-6">
<h3 data-number="7.2.4"><span class="koboSpan" id="kobo.417.1" xmlns="http://www.w3.org/1999/xhtml">Conclusion</span></h3>
<p><span class="koboSpan" id="kobo.418.1" xmlns="http://www.w3.org/1999/xhtml">This section explored the MVC pattern, how to create controllers and action methods, and how to route requests to those actions.We could talk about MVC for the remainder of the book, but we would be missing the point. </span><span class="koboSpan" id="kobo.418.2" xmlns="http://www.w3.org/1999/xhtml">The subset of features we covered here should be enough theory to fill the gap you might have had and allow you to understand the code samples that leverage ASP.NET Core MVC.Using the MVC pattern helps us follow the SOLID principles in the following ways:</span></p>
<ul>
<li><strong><span class="koboSpan" id="kobo.419.1" xmlns="http://www.w3.org/1999/xhtml">S</span></strong><span class="koboSpan" id="kobo.420.1" xmlns="http://www.w3.org/1999/xhtml">: The MVC pattern divides the rendering of a data structure into three different roles. </span><span class="koboSpan" id="kobo.420.2" xmlns="http://www.w3.org/1999/xhtml">The framework handles most of the serialization portion (the View), leaving us only two pieces to manage: the Model and the Controller.</span></li>
<li><strong><span class="koboSpan" id="kobo.421.1" xmlns="http://www.w3.org/1999/xhtml">O</span></strong><span class="koboSpan" id="kobo.422.1" xmlns="http://www.w3.org/1999/xhtml">: N/A</span></li>
<li><strong><span class="koboSpan" id="kobo.423.1" xmlns="http://www.w3.org/1999/xhtml">L</span></strong><span class="koboSpan" id="kobo.424.1" xmlns="http://www.w3.org/1999/xhtml">: N/A</span></li>
<li><strong><span class="koboSpan" id="kobo.425.1" xmlns="http://www.w3.org/1999/xhtml">I</span></strong><span class="koboSpan" id="kobo.426.1" xmlns="http://www.w3.org/1999/xhtml">: Each controller handles a subset of features and represents a smaller interface into the system. </span><span class="koboSpan" id="kobo.426.2" xmlns="http://www.w3.org/1999/xhtml">MVC makes the system easier to manage than having a single entry point for all routes, like a single controller.</span></li>
<li><strong><span class="koboSpan" id="kobo.427.1" xmlns="http://www.w3.org/1999/xhtml">D</span></strong><span class="koboSpan" id="kobo.428.1" xmlns="http://www.w3.org/1999/xhtml">: N/A</span></li>
</ul>
<p><span class="koboSpan" id="kobo.429.1" xmlns="http://www.w3.org/1999/xhtml">Next, we explore the </span><strong><span class="koboSpan" id="kobo.430.1" xmlns="http://www.w3.org/1999/xhtml">Data Transfer Object</span></strong><span class="koboSpan" id="kobo.431.1" xmlns="http://www.w3.org/1999/xhtml"> pattern to isolate the API’s model from the domain.</span></p>
</section>
</section>
<section class="level2" data-number="7.3" id="using-mvc-with-dtos">
<h2 data-number="7.3"><span class="koboSpan" id="kobo.432.1" xmlns="http://www.w3.org/1999/xhtml">Using MVC with DTOs</span></h2>
<p><span class="koboSpan" id="kobo.433.1" xmlns="http://www.w3.org/1999/xhtml">This section explores leveraging the </span><strong><span class="koboSpan" id="kobo.434.1" xmlns="http://www.w3.org/1999/xhtml">Data Transfer Object</span></strong><span class="koboSpan" id="kobo.435.1" xmlns="http://www.w3.org/1999/xhtml"> (</span><strong><span class="koboSpan" id="kobo.436.1" xmlns="http://www.w3.org/1999/xhtml">DTO</span></strong><span class="koboSpan" id="kobo.437.1" xmlns="http://www.w3.org/1999/xhtml">) pattern with the MVC framework.</span></p>
<blockquote>
<p><span class="koboSpan" id="kobo.438.1" xmlns="http://www.w3.org/1999/xhtml">This section is the same as we explore in </span><em><span class="koboSpan" id="kobo.439.1" xmlns="http://www.w3.org/1999/xhtml">Chapter 5</span></em><span class="koboSpan" id="kobo.440.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.441.1" xmlns="http://www.w3.org/1999/xhtml">Minimal APIs</span></em><span class="koboSpan" id="kobo.442.1" xmlns="http://www.w3.org/1999/xhtml">, but in the context of MVC. </span><span class="koboSpan" id="kobo.442.2" xmlns="http://www.w3.org/1999/xhtml">Moreover, the two code projects are part of the same Visual Studio solution for convenience, allowing you to compare the two implementations.</span></p>
</blockquote>
<section class="level3" data-number="7.3.1" id="goal-3">
<h3 data-number="7.3.1"><span class="koboSpan" id="kobo.443.1" xmlns="http://www.w3.org/1999/xhtml">Goal</span></h3>
<p><span class="koboSpan" id="kobo.444.1" xmlns="http://www.w3.org/1999/xhtml">As a reminder, DTOs aim to </span><em><span class="koboSpan" id="kobo.445.1" xmlns="http://www.w3.org/1999/xhtml">control the inputs and outputs of an endpoint</span></em><span class="koboSpan" id="kobo.446.1" xmlns="http://www.w3.org/1999/xhtml"> by decoupling the API contract from the application’s inner workings. </span><span class="koboSpan" id="kobo.446.2" xmlns="http://www.w3.org/1999/xhtml">DTOs empower us to define our APIs without thinking about the underlying data structures, leaving us to craft our REST APIs how we want.</span></p>
<blockquote>
<p><span class="koboSpan" id="kobo.447.1" xmlns="http://www.w3.org/1999/xhtml">We discuss REST APIs and DTOs more in-depth in </span><em><span class="koboSpan" id="kobo.448.1" xmlns="http://www.w3.org/1999/xhtml">Chapter 4</span></em><span class="koboSpan" id="kobo.449.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.450.1" xmlns="http://www.w3.org/1999/xhtml">REST APIs</span></em><span class="koboSpan" id="kobo.451.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</blockquote>
<p><span class="koboSpan" id="kobo.452.1" xmlns="http://www.w3.org/1999/xhtml">Other possible objectives are to save bandwidth by limiting the amount of information the API transmits, flattening the data structure, or adding API features that cross multiple entities.</span></p>
</section>
<section class="level3" data-number="7.3.2" id="design-3">
<h3 data-number="7.3.2"><span class="koboSpan" id="kobo.453.1" xmlns="http://www.w3.org/1999/xhtml">Design</span></h3>
<p><span class="koboSpan" id="kobo.454.1" xmlns="http://www.w3.org/1999/xhtml">Let’s start by analyzing a diagram that expands MVC to work with DTOs:</span></p>
<figure>
<span class="koboSpan" id="kobo.455.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Figure 6.2: MVC workflow with a DTO" src="../media/file31.png"/></span><figcaption aria-hidden="true"><span class="koboSpan" id="kobo.456.1" xmlns="http://www.w3.org/1999/xhtml">Figure 6.2: MVC workflow with a DTO</span></figcaption>
</figure>
<p><span class="koboSpan" id="kobo.457.1" xmlns="http://www.w3.org/1999/xhtml">DTOs allow the decoupling of the domain from the view (data) and empower us to manage the inputs and outputs of our REST APIs independently from the domain. </span><span class="koboSpan" id="kobo.457.2" xmlns="http://www.w3.org/1999/xhtml">The controller still manipulates the domain model but returns a serialized DTO instead.</span></p>
</section>
<section class="level3" data-number="7.3.3" id="project-mvc-api">
<h3 data-number="7.3.3"><span class="koboSpan" id="kobo.458.1" xmlns="http://www.w3.org/1999/xhtml">Project – MVC API</span></h3>
<p><em><span class="koboSpan" id="kobo.459.1" xmlns="http://www.w3.org/1999/xhtml">This code sample is the same as in the previous chapter but uses the MVC framework instead of Minimal APIs</span></em><span class="koboSpan" id="kobo.460.1" xmlns="http://www.w3.org/1999/xhtml">.</span><strong><span class="koboSpan" id="kobo.461.1" xmlns="http://www.w3.org/1999/xhtml">Context</span></strong><span class="koboSpan" id="kobo.462.1" xmlns="http://www.w3.org/1999/xhtml">: we must build an application to manage customers and contracts. </span><span class="koboSpan" id="kobo.462.2" xmlns="http://www.w3.org/1999/xhtml">We must track the state of each contract and have a primary contact in case the business needs to contact the customer. </span><span class="koboSpan" id="kobo.462.3" xmlns="http://www.w3.org/1999/xhtml">Finally, we must display the number of contracts and the number of opened contracts for each customer on a dashboard.As a reminder, the model is the following:</span></p>
<div class="C0-CodePACKT">
<pre><code><span class="koboSpan" id="kobo.463.1" xmlns="http://www.w3.org/1999/xhtml">namespace Shared.Models;
public record class Customer(
    int Id,
    string Name,
    List&lt;Contract&gt; Contracts
);
public record class Contract(
    int Id,
    string Name,
    string Description,
    WorkStatus Status,
    ContactInformation PrimaryContact
);
public record class WorkStatus(int TotalWork, int WorkDone)
{
    public WorkState State =&gt;
        WorkDone == 0 ? </span><span class="koboSpan" id="kobo.463.2" xmlns="http://www.w3.org/1999/xhtml">WorkState.New :
        WorkDone == TotalWork ? </span><span class="koboSpan" id="kobo.463.3" xmlns="http://www.w3.org/1999/xhtml">WorkState.Completed :
        WorkState.InProgress;
}
public record class ContactInformation(
    string FirstName,
    string LastName,
    string Email
);
public enum WorkState
{
    New,
    InProgress,
    Completed
}</span></code></pre>
</div>
<p><span class="koboSpan" id="kobo.464.1" xmlns="http://www.w3.org/1999/xhtml">The preceding code is straightforward. </span><span class="koboSpan" id="kobo.464.2" xmlns="http://www.w3.org/1999/xhtml">The only piece of logic is the </span><code><span class="koboSpan" id="kobo.465.1" xmlns="http://www.w3.org/1999/xhtml">WorkStatus.State</span></code><span class="koboSpan" id="kobo.466.1" xmlns="http://www.w3.org/1999/xhtml"> property that returns </span><code><span class="koboSpan" id="kobo.467.1" xmlns="http://www.w3.org/1999/xhtml">WorkState.New</span></code><span class="koboSpan" id="kobo.468.1" xmlns="http://www.w3.org/1999/xhtml"> when the work has not yet started on that contract, </span><code><span class="koboSpan" id="kobo.469.1" xmlns="http://www.w3.org/1999/xhtml">WorkState.Completed</span></code><span class="koboSpan" id="kobo.470.1" xmlns="http://www.w3.org/1999/xhtml"> when all the work is completed, or </span><code><span class="koboSpan" id="kobo.471.1" xmlns="http://www.w3.org/1999/xhtml">WorkState.InProgress</span></code><span class="koboSpan" id="kobo.472.1" xmlns="http://www.w3.org/1999/xhtml"> otherwise.The controllers leverage the </span><code><span class="koboSpan" id="kobo.473.1" xmlns="http://www.w3.org/1999/xhtml">ICustomerRepository</span></code><span class="koboSpan" id="kobo.474.1" xmlns="http://www.w3.org/1999/xhtml"> interface to simulate database operations. </span><span class="koboSpan" id="kobo.474.2" xmlns="http://www.w3.org/1999/xhtml">The implementation is unimportant. </span><span class="koboSpan" id="kobo.474.3" xmlns="http://www.w3.org/1999/xhtml">It uses a </span><code><span class="koboSpan" id="kobo.475.1" xmlns="http://www.w3.org/1999/xhtml">List&lt;Customer&gt;</span></code><span class="koboSpan" id="kobo.476.1" xmlns="http://www.w3.org/1999/xhtml"> as the database. </span><span class="koboSpan" id="kobo.476.2" xmlns="http://www.w3.org/1999/xhtml">Here’s the interface that allows querying and updating the data:</span></p>
<div class="C0-CodePACKT">
<pre><code><span class="koboSpan" id="kobo.477.1" xmlns="http://www.w3.org/1999/xhtml">using Shared.Models;
namespace Shared.Data;
public interface ICustomerRepository
{
    Task&lt;IEnumerable&lt;Customer&gt;&gt; AllAsync(
        CancellationToken cancellationToken);
    Task&lt;Customer&gt; CreateAsync(
        Customer customer, 
        CancellationToken cancellationToken);
    Task&lt;Customer?&gt; DeleteAsync(
        int customerId, 
        CancellationToken cancellationToken);
    Task&lt;Customer?&gt; FindAsync(
        int customerId, 
        CancellationToken cancellationToken);
    Task&lt;Customer?&gt; UpdateAsync(
        Customer customer, 
        CancellationToken cancellationToken);
}</span></code></pre>
</div>
<p><span class="koboSpan" id="kobo.478.1" xmlns="http://www.w3.org/1999/xhtml">Now that we know about the underlying foundation, we explore a CRUD controller that does not leverage DTOs.</span></p>
<section class="level4" data-number="7.3.3.1" id="raw-crud-controller">
<h4 data-number="7.3.3.1"><span class="koboSpan" id="kobo.479.1" xmlns="http://www.w3.org/1999/xhtml">Raw CRUD Controller</span></h4>
<p><span class="koboSpan" id="kobo.480.1" xmlns="http://www.w3.org/1999/xhtml">Many issues can arise if we create a CRUD controller to manage the customers directly (see </span><code><span class="koboSpan" id="kobo.481.1" xmlns="http://www.w3.org/1999/xhtml">RawCustomersController.cs</span></code><span class="koboSpan" id="kobo.482.1" xmlns="http://www.w3.org/1999/xhtml">). </span><span class="koboSpan" id="kobo.482.2" xmlns="http://www.w3.org/1999/xhtml">First, a little mistake from the client could erase several data points. </span><span class="koboSpan" id="kobo.482.3" xmlns="http://www.w3.org/1999/xhtml">For example, if the client forgets to send the contracts during a </span><code><span class="koboSpan" id="kobo.483.1" xmlns="http://www.w3.org/1999/xhtml">PUT</span></code><span class="koboSpan" id="kobo.484.1" xmlns="http://www.w3.org/1999/xhtml"> operation, that would delete all the contracts associated with that customer. </span><span class="koboSpan" id="kobo.484.2" xmlns="http://www.w3.org/1999/xhtml">Here’s the controller code:</span></p>
<div class="C0-CodePACKT">
<pre><code><span class="koboSpan" id="kobo.485.1" xmlns="http://www.w3.org/1999/xhtml">// PUT raw/customers/1
[HttpPut("{id}")]
public async Task&lt;ActionResult&lt;Customer&gt;&gt; PutAsync(
    int id,
    [FromBody] Customer value,
    ICustomerRepository customerRepository)
{
    var customer = await customerRepository.UpdateAsync(
        value, 
        HttpContext.RequestAborted);
    if (customer == null)
    {
        return NotFound();
    }
    return customer;
}</span></code></pre>
</div>
<p><span class="koboSpan" id="kobo.486.1" xmlns="http://www.w3.org/1999/xhtml">The highlighted code represents the customer update. </span><span class="koboSpan" id="kobo.486.2" xmlns="http://www.w3.org/1999/xhtml">So to mistakenly remove all contracts, a client could send the following HTTP request (from the </span><code><span class="koboSpan" id="kobo.487.1" xmlns="http://www.w3.org/1999/xhtml">MVC.API.http</span></code><span class="koboSpan" id="kobo.488.1" xmlns="http://www.w3.org/1999/xhtml"> file):</span></p>
<div class="C0-CodePACKT">
<pre><code><span class="koboSpan" id="kobo.489.1" xmlns="http://www.w3.org/1999/xhtml">PUT {{MVC.API.BaseAddress}}/customers/1
Content-Type: application/json
{
  "id": 1,
  "name": "Some new name",
  "contracts": []
}</span></code></pre>
</div>
<p><span class="koboSpan" id="kobo.490.1" xmlns="http://www.w3.org/1999/xhtml">That request would result in the following response entity:</span></p>
<div class="C0-CodePACKT">
<pre><code><span class="koboSpan" id="kobo.491.1" xmlns="http://www.w3.org/1999/xhtml">{
  "id": 1,
  "name": "Some new name",
  "contracts": []
}</span></code></pre>
</div>
<p><span class="koboSpan" id="kobo.492.1" xmlns="http://www.w3.org/1999/xhtml">Previously, however, that customer had contracts (seeded when we started the application). </span><span class="koboSpan" id="kobo.492.2" xmlns="http://www.w3.org/1999/xhtml">Here’s the original data:</span></p>
<div class="C0-CodePACKT">
<pre><code><span class="koboSpan" id="kobo.493.1" xmlns="http://www.w3.org/1999/xhtml">{
  "id": 1,
  "name": "Jonny Boy Inc.",
  "contracts": [
    {
      "id": 1,
      "name": "First contract",
      "description": "This is the first contract.",
      "status": {
        "totalWork": 100,
        "workDone": 100,
        "state": "Completed"
      },
      "primaryContact": {
        "firstName": "John",
        "lastName": "Doe",
        "email": "john.doe@jonnyboy.com"
      }
    },
    {
      "id": 2,
      "name": "Some other contract",
      "description": "This is another contract.",
      "status": {
        "totalWork": 100,
        "workDone": 25,
        "state": "InProgress"
      },
      "primaryContact": {
        "firstName": "Jane",
        "lastName": "Doe",
        "email": "jane.doe@jonnyboy.com"
      }
    }
  ]
}</span></code></pre>
</div>
<p><span class="koboSpan" id="kobo.494.1" xmlns="http://www.w3.org/1999/xhtml">As we can see, by exposing our entities directly, we are giving a lot of power to the consumers of our API. </span><span class="koboSpan" id="kobo.494.2" xmlns="http://www.w3.org/1999/xhtml">Another issue with this design is the dashboard. </span><span class="koboSpan" id="kobo.494.3" xmlns="http://www.w3.org/1999/xhtml">The user interface would have to calculate the statistics about the contracts. </span><span class="koboSpan" id="kobo.494.4" xmlns="http://www.w3.org/1999/xhtml">Moreover, if we implement paging the contracts over time, the user interface could become increasingly complex and even overquery the database, hindering our performance.</span></p>
<blockquote>
<p><span class="koboSpan" id="kobo.495.1" xmlns="http://www.w3.org/1999/xhtml">I implemented the entire API, which is available on GitHub but without UI.</span></p>
</blockquote>
<p><span class="koboSpan" id="kobo.496.1" xmlns="http://www.w3.org/1999/xhtml">Next, we explore how we can fix those two use cases using DTOs.</span></p>
</section>
<section class="level4" data-number="7.3.3.2" id="dto-controller">
<h4 data-number="7.3.3.2"><span class="koboSpan" id="kobo.497.1" xmlns="http://www.w3.org/1999/xhtml">DTO controller</span></h4>
<p><span class="koboSpan" id="kobo.498.1" xmlns="http://www.w3.org/1999/xhtml">To solve our problems, we reimplement the controller using DTOs. </span><span class="koboSpan" id="kobo.498.2" xmlns="http://www.w3.org/1999/xhtml">To make it easier to follow along, here are all the DTOs as a reference:</span></p>
<div class="C0-CodePACKT">
<pre><code><span class="koboSpan" id="kobo.499.1" xmlns="http://www.w3.org/1999/xhtml">namespace Shared.DTO;
public record class ContractDetails(
    int Id,
    string Name,
    string Description,
    int StatusTotalWork,
    int StatusWorkDone,
    string StatusWorkState,
    string PrimaryContactFirstName,
    string PrimaryContactLastName,
    string PrimaryContactEmail
);
public record class CustomerDetails(
    int Id,
    string Name,
    IEnumerable&lt;ContractDetails&gt; Contracts
);
public record class CustomerSummary(
    int Id,
    string Name,
    int TotalNumberOfContracts,
    int NumberOfOpenContracts
);
public record class CreateCustomer(string Name);
public record class UpdateCustomer(string Name);</span></code></pre>
</div>
<p><span class="koboSpan" id="kobo.500.1" xmlns="http://www.w3.org/1999/xhtml">First, let’s fix our update problem, starting with the reimplementation of the update endpoint leveraging DTOs (see the </span><code><span class="koboSpan" id="kobo.501.1" xmlns="http://www.w3.org/1999/xhtml">DTOCustomersController.cs</span></code><span class="koboSpan" id="kobo.502.1" xmlns="http://www.w3.org/1999/xhtml"> file):</span></p>
<div class="C0-CodePACKT">
<pre><code><span class="koboSpan" id="kobo.503.1" xmlns="http://www.w3.org/1999/xhtml">// PUT dto/customers/1
[HttpPut("{customerId}")]
public async Task&lt;ActionResult&lt;CustomerDetails&gt;&gt; PutAsync(
        int customerId,
        [FromBody] UpdateCustomer input,
        ICustomerRepository customerRepository)
{
    // Get the customer
    var customer = await customerRepository.FindAsync(
        customerId,
        HttpContext.RequestAborted
    );
    if (customer == null)
    {
        return NotFound();
    }
    // Update the customer's name using the UpdateCustomer DTO
    var updatedCustomer = await customerRepository.UpdateAsync(
        customer with { Name = input.Name },
        HttpContext.RequestAborted
    );
    if (updatedCustomer == null)
    {
        return Conflict();
    }
    // Map the updated customer to a CustomerDetails DTO
    var dto = MapCustomerToCustomerDetails(updatedCustomer);
    // Return the DTO
    return dto;
}</span></code></pre>
</div>
<p><span class="koboSpan" id="kobo.504.1" xmlns="http://www.w3.org/1999/xhtml">In the preceding code, the main differences are (highlighted):</span></p>
<ul>
<li><span class="koboSpan" id="kobo.505.1" xmlns="http://www.w3.org/1999/xhtml">The request body is now bound to the </span><code><span class="koboSpan" id="kobo.506.1" xmlns="http://www.w3.org/1999/xhtml">UpdateCustomer</span></code><span class="koboSpan" id="kobo.507.1" xmlns="http://www.w3.org/1999/xhtml"> class instead of the </span><code><span class="koboSpan" id="kobo.508.1" xmlns="http://www.w3.org/1999/xhtml">Customer</span></code><span class="koboSpan" id="kobo.509.1" xmlns="http://www.w3.org/1999/xhtml"> itself.</span></li>
<li><span class="koboSpan" id="kobo.510.1" xmlns="http://www.w3.org/1999/xhtml">The action method returns an instance of the </span><code><span class="koboSpan" id="kobo.511.1" xmlns="http://www.w3.org/1999/xhtml">CustomerDetails</span></code><span class="koboSpan" id="kobo.512.1" xmlns="http://www.w3.org/1999/xhtml"> class instead of the </span><code><span class="koboSpan" id="kobo.513.1" xmlns="http://www.w3.org/1999/xhtml">Customer</span></code><span class="koboSpan" id="kobo.514.1" xmlns="http://www.w3.org/1999/xhtml"> itself.</span></li>
</ul>
<p><span class="koboSpan" id="kobo.515.1" xmlns="http://www.w3.org/1999/xhtml">However, we can see more code in our controller action than before. </span><span class="koboSpan" id="kobo.515.2" xmlns="http://www.w3.org/1999/xhtml">That’s because the controller now handles the data changes instead of the clients. </span><span class="koboSpan" id="kobo.515.3" xmlns="http://www.w3.org/1999/xhtml">The action now does:</span></p>
<ol>
<li><span class="koboSpan" id="kobo.516.1" xmlns="http://www.w3.org/1999/xhtml">Load the data from the database.</span></li>
<li><span class="koboSpan" id="kobo.517.1" xmlns="http://www.w3.org/1999/xhtml">Ensure the entity exists.</span></li>
<li><span class="koboSpan" id="kobo.518.1" xmlns="http://www.w3.org/1999/xhtml">Use the input DTO to update the data, limiting the clients to a subset of properties.</span></li>
<li><span class="koboSpan" id="kobo.519.1" xmlns="http://www.w3.org/1999/xhtml">Proceed with the update.</span></li>
<li><span class="koboSpan" id="kobo.520.1" xmlns="http://www.w3.org/1999/xhtml">Ensure the entity still exists (handles conflicts).</span></li>
<li><span class="koboSpan" id="kobo.521.1" xmlns="http://www.w3.org/1999/xhtml">Copy the Customer into the output DTO and return it.</span></li>
</ol>
<p><span class="koboSpan" id="kobo.522.1" xmlns="http://www.w3.org/1999/xhtml">By doing this, we now control what the clients can do when they send a </span><code><span class="koboSpan" id="kobo.523.1" xmlns="http://www.w3.org/1999/xhtml">PUT</span></code><span class="koboSpan" id="kobo.524.1" xmlns="http://www.w3.org/1999/xhtml"> request through the input DTO (</span><code><span class="koboSpan" id="kobo.525.1" xmlns="http://www.w3.org/1999/xhtml">UpdateCustomer</span></code><span class="koboSpan" id="kobo.526.1" xmlns="http://www.w3.org/1999/xhtml">). </span><span class="koboSpan" id="kobo.526.2" xmlns="http://www.w3.org/1999/xhtml">Moreover, we encapsulated the logic to calculate the statistics on the server. </span><span class="koboSpan" id="kobo.526.3" xmlns="http://www.w3.org/1999/xhtml">We hid the computation behind the output DTO (</span><code><span class="koboSpan" id="kobo.527.1" xmlns="http://www.w3.org/1999/xhtml">CustomerDetails</span></code><span class="koboSpan" id="kobo.528.1" xmlns="http://www.w3.org/1999/xhtml">), which lowers the complexity of our user interface and allows us to improve the performance without impacting any of our clients (loose coupling).Furthermore, we now use the </span><code><span class="koboSpan" id="kobo.529.1" xmlns="http://www.w3.org/1999/xhtml">customerId</span></code><span class="koboSpan" id="kobo.530.1" xmlns="http://www.w3.org/1999/xhtml"> parameter.If we send the same HTTP request as before, which sends more data than we accept, only the customer's name will change. </span><span class="koboSpan" id="kobo.530.2" xmlns="http://www.w3.org/1999/xhtml">On top of that, we get all the data we need to display the customer’s statistics. </span><span class="koboSpan" id="kobo.530.3" xmlns="http://www.w3.org/1999/xhtml">Here’s a response example:</span></p>
<div class="C0-CodePACKT">
<pre><code><span class="koboSpan" id="kobo.531.1" xmlns="http://www.w3.org/1999/xhtml">{
  "id": 1,
  "name": "Some new name",
  "contracts": [
    {
      "id": 1,
      "name": "First contract",
      "description": "This is the first contract.",
      "statusTotalWork": 100,
      "statusWorkDone": 100,
      "statusWorkState": "Completed",
      "primaryContactFirstName": "John",
      "primaryContactLastName": "Doe",
      "primaryContactEmail": "john.doe@jonnyboy.com"
    },
    {
      "id": 2,
      "name": "Some other contract",
      "description": "This is another contract.",
      "statusTotalWork": 100,
      "statusWorkDone": 25,
      "statusWorkState": "InProgress",
      "primaryContactFirstName": "Jane",
      "primaryContactLastName": "Doe",
      "primaryContactEmail": "jane.doe@jonnyboy.com"
    }
  ]
}</span></code></pre>
</div>
<p><span class="koboSpan" id="kobo.532.1" xmlns="http://www.w3.org/1999/xhtml">As we can see from the preceding response, only the customer’s name changed, but we now received the </span><code><span class="koboSpan" id="kobo.533.1" xmlns="http://www.w3.org/1999/xhtml">statusWorkDone</span></code><span class="koboSpan" id="kobo.534.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><code><span class="koboSpan" id="kobo.535.1" xmlns="http://www.w3.org/1999/xhtml">statusTotalWork</span></code><span class="koboSpan" id="kobo.536.1" xmlns="http://www.w3.org/1999/xhtml"> fields. </span><span class="koboSpan" id="kobo.536.2" xmlns="http://www.w3.org/1999/xhtml">Lastly, we flattened the data structure.</span></p>
<blockquote>
<p><span class="koboSpan" id="kobo.537.1" xmlns="http://www.w3.org/1999/xhtml">DTOs are a great resource to flatten data structures, but you don’t have to. </span><span class="koboSpan" id="kobo.537.2" xmlns="http://www.w3.org/1999/xhtml">You must always design your systems, including DTOs and data contracts, for specific use cases.</span></p>
</blockquote>
<p><span class="koboSpan" id="kobo.538.1" xmlns="http://www.w3.org/1999/xhtml">As for the dashboard, the “get all customers” endpoint achieves this by doing something similar. </span><span class="koboSpan" id="kobo.538.2" xmlns="http://www.w3.org/1999/xhtml">It outputs a collection of </span><code><span class="koboSpan" id="kobo.539.1" xmlns="http://www.w3.org/1999/xhtml">CustomerSummary</span></code><span class="koboSpan" id="kobo.540.1" xmlns="http://www.w3.org/1999/xhtml"> objects instead of the customers themselves. </span><span class="koboSpan" id="kobo.540.2" xmlns="http://www.w3.org/1999/xhtml">In this case, the controller executes the calculations and copies the entity's relevant properties to the DTO. </span><span class="koboSpan" id="kobo.540.3" xmlns="http://www.w3.org/1999/xhtml">Here’s the code:</span></p>
<div class="C0-CodePACKT">
<pre><code><span class="koboSpan" id="kobo.541.1" xmlns="http://www.w3.org/1999/xhtml">// GET: dto/customers
[HttpGet]
public async Task&lt;IEnumerable&lt;CustomerSummary&gt;&gt; GetAllAsync(
    ICustomerRepository customerRepository)
{
    // Get all customers
    var customers = await customerRepository.AllAsync(
        HttpContext.RequestAborted
    );
    // Map customers to CustomerSummary DTOs
    var customersSummary = customers
        .Select(customer =&gt; new CustomerSummary(
            Id: customer.Id,
            Name: customer.Name,
            TotalNumberOfContracts: customer.Contracts.Count,
            NumberOfOpenContracts: customer.Contracts.Count(x =&gt; x.Status.State != WorkState.Completed)
        ))
    ;
    // Return the DTOs
    return customersSummary;
}</span></code></pre>
</div>
<p><span class="koboSpan" id="kobo.542.1" xmlns="http://www.w3.org/1999/xhtml">In the preceding code, the action method:</span></p>
<ol>
<li><span class="koboSpan" id="kobo.543.1" xmlns="http://www.w3.org/1999/xhtml">Read the entities</span></li>
<li><span class="koboSpan" id="kobo.544.1" xmlns="http://www.w3.org/1999/xhtml">Create the DTOs and calculate the number of open contracts.</span></li>
<li><span class="koboSpan" id="kobo.545.1" xmlns="http://www.w3.org/1999/xhtml">Return the DTOs.</span></li>
</ol>
<p><span class="koboSpan" id="kobo.546.1" xmlns="http://www.w3.org/1999/xhtml">As simple as that, we now encapsulated the computation on the server.</span></p>
<blockquote>
<p><span class="koboSpan" id="kobo.547.1" xmlns="http://www.w3.org/1999/xhtml">You should optimize such code based on your real-life data source. </span><span class="koboSpan" id="kobo.547.2" xmlns="http://www.w3.org/1999/xhtml">In this case, a </span><code><span class="koboSpan" id="kobo.548.1" xmlns="http://www.w3.org/1999/xhtml">static</span></code> <code><span class="koboSpan" id="kobo.549.1" xmlns="http://www.w3.org/1999/xhtml">List&lt;T&gt;</span></code><span class="koboSpan" id="kobo.550.1" xmlns="http://www.w3.org/1999/xhtml"> is low latency. </span><span class="koboSpan" id="kobo.550.2" xmlns="http://www.w3.org/1999/xhtml">However, querying the whole database to get a count can become a bottleneck.</span></p>
</blockquote>
<p><span class="koboSpan" id="kobo.551.1" xmlns="http://www.w3.org/1999/xhtml">Calling the endpoint results in the following:</span></p>
<div class="C0-CodePACKT">
<pre><code><span class="koboSpan" id="kobo.552.1" xmlns="http://www.w3.org/1999/xhtml">[
  {
    "id": 1,
    "name": "Some new name",
    "totalNumberOfContracts": 2,
    "numberOfOpenContracts": 1
  },
  {
    "id": 2,
    "name": "Some mega-corporation",
    "totalNumberOfContracts": 1,
    "numberOfOpenContracts": 1
  }
]</span></code></pre>
</div>
<p><span class="koboSpan" id="kobo.553.1" xmlns="http://www.w3.org/1999/xhtml">It is now super easy to build our dashboard. </span><span class="koboSpan" id="kobo.553.2" xmlns="http://www.w3.org/1999/xhtml">We can query that endpoint once and display the data in the UI. </span><span class="koboSpan" id="kobo.553.3" xmlns="http://www.w3.org/1999/xhtml">The UI offloaded the calculation to the backend.</span></p>
<blockquote>
<p><span class="koboSpan" id="kobo.554.1" xmlns="http://www.w3.org/1999/xhtml">User interfaces tend to be more complex than APIs because they are stateful. </span><span class="koboSpan" id="kobo.554.2" xmlns="http://www.w3.org/1999/xhtml">As such, offloading as much complexity to the backend helps. </span><span class="koboSpan" id="kobo.554.3" xmlns="http://www.w3.org/1999/xhtml">You can use a Backend-for-frontend (BFF) to help with this task. </span><span class="koboSpan" id="kobo.554.4" xmlns="http://www.w3.org/1999/xhtml">We explore ways to layer APIs, including the BFF pattern in </span><em><span class="koboSpan" id="kobo.555.1" xmlns="http://www.w3.org/1999/xhtml">Chapter 19</span></em><span class="koboSpan" id="kobo.556.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em><span class="koboSpan" id="kobo.557.1" xmlns="http://www.w3.org/1999/xhtml">Introduction to Microservices Architecture</span></em><span class="koboSpan" id="kobo.558.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</blockquote>
<p><span class="koboSpan" id="kobo.559.1" xmlns="http://www.w3.org/1999/xhtml">Lastly, you can play with the API using the HTTP requests in the </span><code><span class="koboSpan" id="kobo.560.1" xmlns="http://www.w3.org/1999/xhtml">MVC.API.DTO.http</span></code><span class="koboSpan" id="kobo.561.1" xmlns="http://www.w3.org/1999/xhtml"> file. </span><span class="koboSpan" id="kobo.561.2" xmlns="http://www.w3.org/1999/xhtml">I implemented all the endpoints using a similar technique. </span><span class="koboSpan" id="kobo.561.3" xmlns="http://www.w3.org/1999/xhtml">If your controller logic becomes too complex, it is good practice to encapsulate it into other classes. </span><span class="koboSpan" id="kobo.561.4" xmlns="http://www.w3.org/1999/xhtml">We explore many techniques to organize application code in </span><em><span class="koboSpan" id="kobo.562.1" xmlns="http://www.w3.org/1999/xhtml">Section 4</span></em><span class="koboSpan" id="kobo.563.1" xmlns="http://www.w3.org/1999/xhtml">: </span><em><span class="koboSpan" id="kobo.564.1" xmlns="http://www.w3.org/1999/xhtml">Applications patterns</span></em><span class="koboSpan" id="kobo.565.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</section>
</section>
<section class="level3" data-number="7.3.4" id="conclusion-7">
<h3 data-number="7.3.4"><span class="koboSpan" id="kobo.566.1" xmlns="http://www.w3.org/1999/xhtml">Conclusion</span></h3>
<p><span class="koboSpan" id="kobo.567.1" xmlns="http://www.w3.org/1999/xhtml">A data transfer object allows us to design an API endpoint with a specific data contract (input and output) instead of exposing the domain or data model. </span><span class="koboSpan" id="kobo.567.2" xmlns="http://www.w3.org/1999/xhtml">This separation between the presentation and the domain is a crucial element that leads to having multiple independent components instead of a bigger, more fragile one. </span><span class="koboSpan" id="kobo.567.3" xmlns="http://www.w3.org/1999/xhtml">Using DTOs to control the inputs and outputs gives us more control over what the clients can do or receive.Using the data transfer object pattern helps us follow the SOLID principles in the following ways:</span></p>
<ul>
<li><strong><span class="koboSpan" id="kobo.568.1" xmlns="http://www.w3.org/1999/xhtml">S</span></strong><span class="koboSpan" id="kobo.569.1" xmlns="http://www.w3.org/1999/xhtml">: A DTO adds clear boundaries between the domain model and the API contract. </span><span class="koboSpan" id="kobo.569.2" xmlns="http://www.w3.org/1999/xhtml">Moreover, having an input and an output DTO help further separate the responsibilities.</span></li>
<li><strong><span class="koboSpan" id="kobo.570.1" xmlns="http://www.w3.org/1999/xhtml">O</span></strong><span class="koboSpan" id="kobo.571.1" xmlns="http://www.w3.org/1999/xhtml">: N/A</span></li>
<li><strong><span class="koboSpan" id="kobo.572.1" xmlns="http://www.w3.org/1999/xhtml">L</span></strong><span class="koboSpan" id="kobo.573.1" xmlns="http://www.w3.org/1999/xhtml">: N/A</span></li>
<li><strong><span class="koboSpan" id="kobo.574.1" xmlns="http://www.w3.org/1999/xhtml">I</span></strong><span class="koboSpan" id="kobo.575.1" xmlns="http://www.w3.org/1999/xhtml">: A DTO is a small, specifically crafted data contract (abstraction) with a clear purpose in the API contract.</span></li>
<li><strong><span class="koboSpan" id="kobo.576.1" xmlns="http://www.w3.org/1999/xhtml">D</span></strong><span class="koboSpan" id="kobo.577.1" xmlns="http://www.w3.org/1999/xhtml">: Due to those smaller interfaces (ISP), DTOs allow changing the implementation details of the endpoint without affecting the clients because they depend only on the API contract (an abstraction).</span></li>
</ul>
<p><span class="koboSpan" id="kobo.578.1" xmlns="http://www.w3.org/1999/xhtml">You have learned DTOs' added value, their role in an API contract, and the ASP.NET Core MVC framework.</span></p>
</section>
</section>
<section class="level2" data-number="7.4" id="summary-5">
<h2 data-number="7.4"><span class="koboSpan" id="kobo.579.1" xmlns="http://www.w3.org/1999/xhtml">Summary</span></h2>
<p><span class="koboSpan" id="kobo.580.1" xmlns="http://www.w3.org/1999/xhtml">This chapter explored the Model-View-Controller (MVC) design pattern, a well-established framework in the ASP.NET ecosystem that offers more advanced features than its newer Minimal APIs counterpart. </span><span class="koboSpan" id="kobo.580.2" xmlns="http://www.w3.org/1999/xhtml">Minimal APIs are not competing against MVC; we can use them together. </span><span class="koboSpan" id="kobo.580.3" xmlns="http://www.w3.org/1999/xhtml">The MVC pattern emphasizes the separation of concerns, making it a proven pattern for creating maintainable, scalable, and robust web applications. </span><span class="koboSpan" id="kobo.580.4" xmlns="http://www.w3.org/1999/xhtml">We broke down the MVC pattern into its three core components: Models, Views, and Controllers. </span><span class="koboSpan" id="kobo.580.5" xmlns="http://www.w3.org/1999/xhtml">Models represent data and business logic, Views are user-facing components (serialized data structures), and Controllers act as intermediaries, mediating the interaction between Models and Views. </span><span class="koboSpan" id="kobo.580.6" xmlns="http://www.w3.org/1999/xhtml">We also discussed using Data Transfer Objects (DTOs) to package data in the format we need, providing many benefits, including flexibility, efficiency, encapsulation, and improved performance. </span><span class="koboSpan" id="kobo.580.7" xmlns="http://www.w3.org/1999/xhtml">DTOs are a crucial part of the API contract.Now that we have explored principles and methodologies, it is time to continue our learning and tackle more design patterns and features. </span><span class="koboSpan" id="kobo.580.8" xmlns="http://www.w3.org/1999/xhtml">The following two chapters explore our first Gang of Four (GoF) design patterns and deep dive into ASP.NET Core dependency injection (DI). </span><span class="koboSpan" id="kobo.580.9" xmlns="http://www.w3.org/1999/xhtml">All of this will help us to continue on the path we started: to learn the tools to design better software.</span></p>
</section>
<section class="level2" data-number="7.5" id="questions-5">
<h2 data-number="7.5"><span class="koboSpan" id="kobo.581.1" xmlns="http://www.w3.org/1999/xhtml">Questions</span></h2>
<p><span class="koboSpan" id="kobo.582.1" xmlns="http://www.w3.org/1999/xhtml">Let’s look at a few practice questions:</span></p>
<ol>
<li><span class="koboSpan" id="kobo.583.1" xmlns="http://www.w3.org/1999/xhtml">What are the three components of the MVC design pattern?</span></li>
<li><span class="koboSpan" id="kobo.584.1" xmlns="http://www.w3.org/1999/xhtml">What is the role of a Controller in the MVC pattern?</span></li>
<li><span class="koboSpan" id="kobo.585.1" xmlns="http://www.w3.org/1999/xhtml">What are Data Transfer Objects (DTOs), and why are they important?</span></li>
<li><span class="koboSpan" id="kobo.586.1" xmlns="http://www.w3.org/1999/xhtml">How does the MVC pattern contribute to the maintainability of an application?</span></li>
<li><span class="koboSpan" id="kobo.587.1" xmlns="http://www.w3.org/1999/xhtml">How does attribute routing work in MVC?</span></li>
</ol>
</section>
<section class="level2" data-number="7.6" id="further-reading-5">
<h2 data-number="7.6"><span class="koboSpan" id="kobo.588.1" xmlns="http://www.w3.org/1999/xhtml">Further reading</span></h2>
<p><span class="koboSpan" id="kobo.589.1" xmlns="http://www.w3.org/1999/xhtml">Here are some links to build on what we have learned in the chapter:</span></p>
<ul>
<li><span class="koboSpan" id="kobo.590.1" xmlns="http://www.w3.org/1999/xhtml">Using web API conventions: </span><a href="https://adpg.link/ioKV"><span class="koboSpan" id="kobo.591.1" xmlns="http://www.w3.org/1999/xhtml">https://adpg.link/ioKV</span></a></li>
<li><span class="koboSpan" id="kobo.592.1" xmlns="http://www.w3.org/1999/xhtml">Getting started with Swashbuckle and ASP.NET Core: </span><a href="https://adpg.link/ETja"><span class="koboSpan" id="kobo.593.1" xmlns="http://www.w3.org/1999/xhtml">https://adpg.link/ETja</span></a></li>
</ul>
</section>
<section class="level2" data-number="7.7" id="answers-2">
<h2 data-number="7.7"><span class="koboSpan" id="kobo.594.1" xmlns="http://www.w3.org/1999/xhtml">Answers</span></h2>
<ol>
<li><span class="koboSpan" id="kobo.595.1" xmlns="http://www.w3.org/1999/xhtml">The three components of the MVC design pattern are Models, Views, and Controllers.</span></li>
<li><span class="koboSpan" id="kobo.596.1" xmlns="http://www.w3.org/1999/xhtml">In the MVC pattern, a Controller acts as an intermediary, mediating the interaction between Models and Views.</span></li>
<li><span class="koboSpan" id="kobo.597.1" xmlns="http://www.w3.org/1999/xhtml">We use Data Transfer Objects (DTOs) to package data into a format that provides many benefits, including efficient data sharing, encapsulation, and improved maintainability.</span></li>
<li><span class="koboSpan" id="kobo.598.1" xmlns="http://www.w3.org/1999/xhtml">The MVC pattern contributes to the maintainability of an application by separating concerns. </span><span class="koboSpan" id="kobo.598.2" xmlns="http://www.w3.org/1999/xhtml">Each component (Model, View, Controller) has a specific role and responsibility, making the code easier to manage, test, and extend. </span><span class="koboSpan" id="kobo.598.3" xmlns="http://www.w3.org/1999/xhtml">This separation allows changes to one component to have minimal impact on the others.</span></li>
<li><span class="koboSpan" id="kobo.599.1" xmlns="http://www.w3.org/1999/xhtml">Attribute routing in MVC maps an HTTP request to a controller action. </span><span class="koboSpan" id="kobo.599.2" xmlns="http://www.w3.org/1999/xhtml">These attributes decorate the controllers and the actions to create the complete routes.</span></li>
</ol>
</section>
</section>
</body>
</html>
