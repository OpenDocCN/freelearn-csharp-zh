# 第1章. Unity中的平面世界

这是我们进入Unity 2D游戏开发世界的旅程的开始。本书的结构旨在引导你从头开始创建一个完整的2D游戏，特别是塔防游戏。

尽管我们将专注于2D游戏开发，但我们的最终目标是学习如何使用Unity，因此这也意味着我们将简要了解Unity如何处理3D。所以，如果你以后想花时间做3D游戏，到这本书结束时，你将具备这样做所需的背景知识。事实上，本书的结构旨在包含每个主题尽可能多的细节，这包括历史概述和进一步阅读的参考。

在每一章中，我们都会面临不同的挑战，这将提高我们的技能。此外，本书不仅仅告诉你需要做什么（像许多其他书籍一样），它还解释了我们将遇到的不同工具以及如何使用它们。这样，我们将学会如何在不同的环境中使用和应用它们。因此，你可以将这本书作为参考手册，以加快你的工作流程。为了帮助你，我建议你使用索引，以便快速定位我们将面临的具体主题。

每章结束时，都有一个*作业*部分，其中包含一些与本章所讨论的主题相关的练习。当然，你可以自由地跳过这一部分，但我建议如果你觉得需要进一步提高技能，就做这些练习。

现在，本章是Unity中2D世界的介绍，以及为了创建我们的游戏需要做什么。特别是，我们将探讨以下主题：

+   2D游戏是什么？

+   设计和开发2D游戏意味着什么？

+   哪里可以获取Unity及其不同版本

+   从外部来源下载图形包

+   如何在Unity中组织项目

+   在2D中理解Unity

+   Sprite是什么？

+   Sprite渲染器组件

+   Sprite的导入设置

+   如何使用具有所有不同模式的Sprite编辑器

+   为我们的游戏准备资源

+   设置场景和比例

最后一点。有时我会提到玩家和角色，以便举例或解释概念。因此，有时我会将他们称为男性，有时会称为女性（有时两者都是）。这种做法源于我的个人观点，以便不歧视两种性别。

说了这么多，让我们开始吧！

# 学习游戏开发

游戏开发和设计是围绕的一些最广泛的艺术作品。这是由于将游戏带入生命所需的巨大专业知识。你可以通过查看任何游戏的信用列表来了解这一点。它们非常广泛，包含了许多人名字，他们在各种角色上为游戏投入了大量时间。

就像生活中的大多数事情一样，游戏开发不仅可以通过实践学习，还可以通过迭代学习。即使你掌握了游戏开发中的许多分支之一，仍然有新东西可以学习。

无论你对 Unity 的了解程度如何，我强烈建议你遵循这本书中的每个步骤，即使你认为你已经掌握了这个主题。你永远不知道，总有新东西可以学习！

# 塔防游戏

塔防游戏有多种不同的风格。例如，在以下 *Defense Grid: The Awakening* 和 *Unstoppable Gorg* 的截图上，两者都是俯视等距风格的游戏。然而，它们设定在不同的世界中，有不同的目标。所以，鉴于这一点，什么是塔防游戏呢？首先，它们围绕着保护某个东西的想法，无论是建筑、资源、武器等等。这是定义该流派并推动游戏玩法的主要机制。其次，大多数塔防游戏需要经济和资源管理。例如，在每一波敌人之后，你可能会获得一定数量的虚拟货币，然后你必须将其分配给购买新的防御（武器、塔楼等）或升级。每种都有其优点，这取决于一系列因素，如你防御的弱点以及预计下一波将出现的敌人数量和强度。每一波敌人的数量和难度都会增加，因此挑战玩家战略性地管理和构建防御。目标是积累足够的资源来升级你的防御，并比下一波敌人存活更久。有时，玩家必须阻止敌人（或对手）摧毁他们的基地。

在其他情况下，玩家必须阻止敌人到达终点，因为每个成功通过的敌人都会对玩家的生命条造成伤害。

![塔防游戏](img/image00316.jpeg)

（顶部）*Defense Grid: The Awakening* 和 （底部）*Unstoppable Gorg*

在互联网上有许多地方可以找到塔防游戏。例如，Kongregate ([http://www.kongregate.com/](http://www.kongregate.com/)) 和 Newgrounds ([http://www.newgrounds.com/](http://www.newgrounds.com/)) 是提供各种免费塔防游戏的网站（例如 *Kingdom Rush* 或 *Bloons Tower Defense 5*）。然而，许多游戏适用于 iOS (App Store) 和 Android (Play Store)，操作系统如 Linux、OSX 和 PC（例如 Steam），以及游戏机（Playstation、Xbox）等等。

# 设计我们的游戏

在您甚至考虑打开电脑之前，您需要设计您的游戏。仅仅有一个大致的想法是不够的。您需要事先写下所有想法才能开始工作。游戏设计的第一个阶段是**头脑风暴**。不幸的是，我们在这个小节中没有时间描述不同的头脑风暴技术和方法。然而，最终的结果应该是堆满纸张，上面写满了成千上万的想法。这并不是要成为一件艺术品，而是您游戏将建立的基础。

### 注意

关于头脑风暴的一些信息也可以在《Unity游戏化》这本书中找到，作者是Packt publishing。您可以在以下链接找到它：[https://www.packtpub.com/game-development/gamification-unity-5x](https://www.packtpub.com/game-development/gamification-unity-5x)。

下一步是细化您的想法，丢弃（或保留用于其他项目）您不需要的，并以一种连贯的形式组织它们。

最终结果应该类似于以下内容。

> *《熊猫入侵》是一款2D塔防游戏。实际上，饥饿的熊猫正在入侵以偷走玩家所有的糖。玩家必须使用纸杯塔来击退熊猫。玩家可以在地图上放置不同类型的纸杯塔。在每一级中，熊猫将遵循一条路径。此外，它们将在这条路径的开始处生成。最后，有一个玩家必须防守的野心勃勃的糖城堡。如果熊猫偷走太多糖，将糖量计降到零，玩家将失败他的重要任务。相反，如果玩家能够击退所有熊猫，玩家将获得胜利。然而，纸杯塔不是免费的。实际上，玩家必须使用糖果来购买它们。每次击退熊猫，玩家都将获得一定数量的糖果。此外，玩家可以使用糖果升级纸杯塔，使它们变得更强大！*

从这段摘录中，你现在应该能够理解我们将在本书中做什么。你也有了一个如何写下你想法的基本概念。我强烈建议你始终进行这一步，即使你只是唯一的开发者，尤其是在你有团队的时候。

# 准备中

现在我们有了我们的想法，下一步就是获取Unity。它有不同的版本：个人版（免费）、专业版、企业版。后三个版本比个人版包含更多功能。然而，这本书中涵盖的所有主题都可以使用免费版本完成。无论如何，您可以在官方网站上获取或购买Unity：[www.unity3d.com](http://www.unity3d.com)。

这是Unity Technologies网站上不同版本Unity的比较屏幕（如果您向下滚动，您将找到哪个版本包含哪些功能）：

![准备中](img/image00317.jpeg)

### 注意

这是对Unity近年来模型定价变化的非常简短的总结。实际上，成为一名开发者也意味着要了解你周围的世界，并且拥有基本的营销知识也可能有所帮助。最初，Unity的模型价格不允许开发者使用免费版本发布商业游戏。此外，游戏引擎没有所有功能，例如Profiler或Movie Textures。拥有Unreal Engine的Epic Games公司在2015年3月通过使其游戏引擎免费（尽管它将收取游戏总收入的5%）来改变其模型价格，也适用于商业用途（尽管它将收取游戏总收入的5%）。一段时间后，Unity Technologies也允许开发者使用免费版本发布商业游戏，但仍然带有水印。从Unity 5.x版本开始，之前仅在Pro版本中存在的功能也出现在免费版本中。在2016年初，Unity通常有两种不同的版本：免费（或个人）和专业。后者比个人版包含更多功能，以下是两个版本的比较屏幕：

![准备就绪](img/image00318.jpeg)

2016年6月，Unity对其之前描述的价格模式进行了更改。

一旦我们安装了Unity，我们就可以开始创建新的项目。如果我们点击窗口右上角的**新建项目**按钮，Unity会要求我们输入项目的详细信息。我们可以将其命名为`Panda Invasion`并选择目标路径，即项目文件将存储的位置。还有另一个需要注意的重要事项。Unity给我们提供了选择3D和2D项目之间的可能性。这并不是一个重要的决定，因为任何时候都可以更改。然而，提前考虑游戏是2D还是3D是有用的。通过选择2D模式，Unity会根据我们心中的游戏调整默认设置。我们将在下一节中看到这些设置。现在，你应该有一个看起来像以下的屏幕：

![准备就绪](img/image00319.jpeg)

现在，我们可以按下**创建项目**按钮，我们就成功创建了项目，并准备好构建它。

本书假设您对Unity界面和C#代码相当熟悉。如果您不熟悉，不要担心。在继续阅读本书之前，您有多种学习方式。例如，我编写了一个小型的免费电子指南，简要介绍了Unity的主要界面和概念。不要期望在那里学到所有需要的东西，但这是一个良好的开始。您可以在[https://www.packtpub.com/packt/free-ebook/what-you-need-know-about-unity-5](https://www.packtpub.com/packt/free-ebook/what-you-need-know-about-unity-5)找到它。如果您是Unity的完全新手，请阅读这个小电子指南。完成阅读后，我还会在这里，我们可以继续我们的精彩旅程。此外，Unity的官方手册及其文档在Unity游戏开发世界中是极好的伴侣。您可以在官方网站上找到它们，在[https://docs.unity3d.com/Manual/index.html](https://docs.unity3d.com/Manual/index.html)。

由于我们没有时间为我们即将开发的游戏创建自己的图形，我们需要下载一个自定义包。当然，您可以选择您最喜欢的。对于本书，我们将使用`Tower Defence Pack 2`包，可以从[http://player26.com/](http://player26.com/)下载。

### 注意

`Tower Defence Pack 2`提供了一系列美味的蛋糕，从臭名昭著的蓬松白色糖霜和彩色糖珠，到奢华的巧克力豆，更不用说一直以来的最爱，柠檬蛋白霜配银色果仁。它还提供了Sugar Castle，这是糖果爱好者的家外之家！除了所有这些甜蜜的东西，还有树木、山脉、彩虹以及各种其他资产来填充您的甜蜜环境。只是要注意，其中有一些隐藏的危险，包括熊猫，所以请小心保护您的宝藏，防止被偷吃的甜食动物盗走！

该包包含我们创建塔防游戏所需的所有基本资产。它是免费的，即使是商业用途，即使需要署名。还有一个包含更多资产和一些不同精灵中的装饰以提高可定制性的高级版本。特别是，在免费版本中我们可以找到：

+   为塔防游戏设计的地图

+   恶搞熊猫（带有动画）

+   三个不同的升级等级用于蛋糕塔

+   包含每个对象的多个图标

+   以及更多资产来填充关卡！

以下图片可以给您一个关于本包包含的图形类型的概念：

![准备就绪](img/image00320.jpeg)

因此，在进入下一节之前，请先下载此包。

# 记住过去，构建未来

如果您是Unity的新手，或者您只使用过Unity 5.x，您可以跳过这一节，或者只是出于好奇阅读它。

在Unity 4.x版本（在4.6版本之前）和其他早期版本中，构建2D游戏有点困难。实际上，您需要使用一系列不同的方法和技巧来实现2D的错觉。实际上，所有的2D对象都是特定视角或特定摄像机下查看的3D对象，这产生了2D对象的错觉。

从Unity 4.6版本开始，尤其是自Unity 5.x版本以来，这不再需要。现在，Unity内置了对2D游戏的支持。因此，现在有专门处理2D对象的组件，接下来的几节将探讨其中的一些。

# 组织项目

在Unity中组织项目有多种方式，因此提供了一定的自由度。在本节中，我们提出了一种方法，我们将在本书的项目开发中使用这种方法。

关键思想是按类型组织不同的资产（而不是像其他方法那样，按它们在关卡中的位置组织）。

首先，让我们了解Unity如何组织资产。所有资产都放置在一个名为`Assets`的文件夹中，该文件夹也位于`Project`文件夹内。因此，我们所有的资产都应该包含在这个文件夹或子文件夹中。为了创建一个新的文件夹，右键单击**项目**面板，然后选择**创建** | **文件夹**。结果，在您点击的文件夹内创建了一个新的文件夹。由于我们没有任何文件夹，它将是**Assets**文件夹的子文件夹。我们可以将其重命名为我们想要的任何名称。如果您错过了这个步骤，只需选择它并再次单击它（但不要太快，否则Unity会将其视为双击并打开文件夹），如下面的截图所示：

![组织项目](img/image00321.jpeg)

### 备注

需要注意的是，Unity将忽略以下类别，以避免导入系统文件：

+   隐藏的文件夹和文件

+   以`~`开头并以`.`结尾的文件夹和文件

+   命名为`cvs`的文件夹和文件

+   扩展名为`.tmp`的文件

我们需要创建以下文件夹（您只需创建加粗的文件夹，因为我们不会使用其他文件夹）：

+   字体

+   **图形**

+   材质

+   **动画**（我们将在[第4章](part0056.xhtml#aid-1LCVG1 "第4章。不再孤单——甜牙熊猫出击")中更详细地了解它们），*不再孤单——甜牙熊猫出击*

+   音乐和声音

+   其他资产（例如，用于存储的`.txt`资产）

+   物理材质

+   **预制体**（我们将在下一章中了解它们是什么）

+   **场景**

+   **脚本**

### 备注

如果您计划创建3D游戏，文件夹将不同，并将包含其他类型的资产，例如3D模型和纹理。

最后，我们应该在我们的**项目**面板中看到以下内容（我将在[第4章](part0056.xhtml#aid-1LCVG1 "第4章。不再孤单——甜牙熊猫出击")中添加`Animation`文件夹，*不再孤单——甜牙熊猫出击*，当我们看到动画时，但如果您喜欢，可以立即添加）：

![组织项目](img/image00322.jpeg)

关于您项目中的文件夹，还有其他一些事情需要了解。如果您创建具有某些特定名称的文件夹，Unity将以特殊方式处理它们。我们不会使用它们；然而，快速查看它们是值得的：

+   `编辑器`（或其子文件夹）：这包含编辑器脚本而不是运行时脚本。这些脚本旨在在您的游戏开发期间在Unity中实现新功能，并且不会包含在发布的游戏中。因此，您不能在您的`场景`中使用此文件夹中的任何脚本。此外，您的项目中可以包含多个`编辑器`文件夹（即使这会影响执行顺序）。

+   `编辑器默认资源`：这包含可以通过使用`EditorGUIUtility.Load()`函数按需由编辑器脚本加载的资源。

+   `资源`（或其子文件夹）：这包含所有可以通过使用`Resources.Load()`函数按需从脚本中加载的资产。实际上，您可能需要加载场景中尚未存在的资产。与`编辑器`文件夹一样，您可以在项目中拥有尽可能多的这些文件夹。

+   `插件`：这包含用C/C++编写的本地DLL，可以访问第三方库、系统调用和其他Unity不直接提供的功能。正如其名所示，它用于实现或导入插件。

+   `StreamingAssets`：这包含不会包含在您的游戏主文件中，但可以从脚本中流式传输的资产。

+   `WebPlayerTemplates`：这包含用于目标平台为`WebPlayer`时的自定义宿主页面。此文件夹中的脚本将不会编译。

回到我们的文件夹，我们需要导入我们下载的包。这可以通过多种不同的方式完成，但最简单的方式是将包的文件夹拖放到我们的`Graphics`文件夹中。

如果您需要选择要使用的资产，在**项目**面板的左下角有一个滑块，允许您增加**项目**面板中图标的大小。当有大量资产且我们需要在不了解名称的情况下找到正确的资产，或者探索我们还不了解的新包时，此功能非常有用。以下截图中的滑块已突出显示，以方便您查看：

![组织项目](img/image00323.jpeg)

# 二维世界

当我们的项目设置为二维模式时，有几个需要注意的事项，我们将在本节中探讨。

首先，如果您需要在不同二维和三维模式之间切换，您可以通过导航到**编辑** | **项目设置** | **编辑器**来完成。如果您进入**默认行为模式**设置，您可以更改**模式**，如下面的截图所示：

![二维世界](img/image00324.jpeg)

回到我们的主界面，让我们看看2D模式和3D模式之间的主要区别。默认情况下，**场景**视图设置为**2D**，如以下截图所示：

![2D世界](img/image00325.jpeg)

这允许我们将**场景**视图锁定在*xy*平面上。

### 注意

*z*轴用于确定哪个对象应该首先渲染。这决定了哪些对象在前景，哪些在背景。

然后，每次我们创建一个新的场景时，随场景提供的默认摄像机总是设置为**正交**模式。此外，其位置设置为(`0`, `0`, `-10`)，而在3D模式中，它设置为(`0`, `1`, `-10`)。你也可以通过在**层次**面板中选择**主摄像机**并查看**检查器**中的属性来检查这一点，如下面的截图所示：

![2D世界](img/image00326.jpeg)

其他区别包括使用**精灵打包器**的选项或默认没有实时方向光的对象。还有**光照**设置的变化（你可以从**窗口/光照**访问它们）。特别是，**天空盒**在新场景中是禁用的，**预计算实时全局光照**、**烘焙全局光照**和**自动构建**都设置为关闭。此外，**环境光源**带有深灰色。

在以下截图中，你可以看到默认的**光照**设置：

![2D世界](img/image00327.jpeg)

### 注意

在2D模式下默认设置的**环境光源**颜色的RGB代码是(`54`, `58`, `66`)。

然而，最重要的区别是Unity导入新2D资产的方式，但我们将详细讨论这一点在接下来的章节中。

# 精灵

在Unity中，2D游戏的基石是精灵。你可以把它们想象成图片，但实际上，正如我们即将看到的，它们是更多的事物。实际上，一张图片可以包含多个精灵。通常，这类图片被称为精灵表。以下是我们包内一个精灵表的示例：

![精灵](img/image00328.jpeg)

我们希望所有精灵都在单个图像上，而不是单独显示，原因有很多。其中最重要的原因是效率。每次你想在屏幕上渲染某些内容时，这都必须由你的电脑中的显卡来渲染。如果所有精灵都在单独的图像中，显卡将不得不处理大量的图像。结果，你的游戏会运行得较慢。

另一个使用精灵表的原因是动画。虽然3D动画是由描述3D模型如何移动的数据组成的，但2D动画是由帧组成的。就像电影或卡通一样，动画是由不同的图像组成的，或者在这种情况下，是精灵。每个都描述了一个瞬间，如果你足够快地改变它们，比如每秒25帧，你就可以产生运动的错觉。将所有帧放在一个独特的图像中既高效又井然有序。

自然地，精灵表单还有其他原因，但前两个原因应该足以让你相信精灵表单是最好的实践。另一方面，需要付出的代价是：游戏引擎需要能够在图像中区分它们。我们将在接下来的章节中看到Unity是如何处理这个问题的。但在我们继续之前，还有其他关于Unity中精灵的重要概念需要了解。

就像三维对象一样，精灵也有一个中心点。通常，这个中心点位于中间，但可以在精灵编辑器中更改。中心点是Unity开始所有计算的地方。例如，当你为精灵指定一个在场景中的位置时，Unity将中心点放置在那个特定位置，然后围绕它绘制精灵。中心点对于旋转也很重要。每次我们旋转精灵时，旋转都会围绕中心点进行。换句话说，在旋转过程中，中心点是唯一不改变位置的点。

这可以通过截图更好地解释，其中箭头指示中心点的位置：

![精灵](img/image00329.jpeg)

正如你所见，有一个以顺时针方向旋转90度的相同精灵。左边的一个中心点位于中间，而右边的一个中心点位于左侧（中心点可以通过蓝色圆圈识别）。当然，你可以通过平移使它们重合，但记住它在哪里很重要，尤其是在我们编码时，这样我们才能轻松实现我们想要的效果。

现在，关于精灵还有另一个需要考虑的方面。在二维游戏中，背景和在世界中移动的角色都被认为是精灵。然而，我们希望渲染在角色后面的背景，而不是相反。因此，精灵以一定的顺序渲染，这决定了哪个精灵应该渲染在其他精灵之上。

在Unity中，有两种主要方式来决定这个顺序：

+   **排序层**: 每个**精灵渲染器**，这是一个附加到游戏对象上的组件，用于渲染所选的精灵，都有一个名为**排序层**的变量。在那里，我们可以选择精灵将在哪个层上渲染。不同排序层的顺序可以在标签和层设置中确定（我们将在本章后面看到如何访问此菜单）。此外，排序层可以通过使用**层内顺序**变量为同一层内的精灵提供内部顺序，该变量始终位于**精灵渲染器**组件中。

+   **Z缓冲区**: 由于二维对象只需要两个坐标来描述其位置（*x*轴和*y*轴），我们有一个*z*轴来描述深度。Unity使用深度来确定哪个精灵应该首先渲染。由于你需要想象这是一个深度，因此只使用负值是一个好习惯。负值越大，角色或对象就越接近相机。

在计算效率方面，这些方法之间没有太大的差异。因此，两者都可以使用。实际上，它们也可以一起使用。一种通用方法是使用*z*轴来在视觉上组织角色。想象一个携带武器的角色。根据武器握在哪个手上以及角色面向哪个方向，武器应该渲染在角色后面还是前面。相反，排序层用于在更高层次上组织精灵，例如背景、前景、玩家、敌人等等。

然而，为了学习的目的，在这本书中，我们将不会使用排序层，而只使用Z缓冲区，因为它可以在代码中轻松更改。

## Sprite 渲染器

在我们提到这个组件之前，可能值得多讨论一下。

每次我们向场景添加精灵时，这个组件都会自动附加。它应该看起来像以下截图：

![Sprite 渲染器](img/image00330.jpeg)

让我们分解一下不同的参数：

+   **精灵**：这包含需要渲染的精灵。

+   **颜色**：这是一个乘以精灵图像的颜色。如果您对着色器和渲染器有些了解，这实际上是渲染网格的顶点颜色。

+   **翻转**：这定义了精灵需要在哪个轴上翻转。这是Unity 5.3中的一个新功能。

+   **材质**：这是Unity应该用来渲染精灵的材质。默认的材质对我们的需求来说已经足够了。如果您是着色器专家，有两种内置的着色器。两者都是简单的alpha混合着色器，但漫反射着色器与光线交互，生成一个(`0`, `0`, `-1`)的前向法线向量。

+   **排序层**：精灵应该渲染在哪个排序层（如前所述）。

+   **层中顺序**：这是特定排序层内的顺序（如前所述）。

## 导入新朋友

如果您已经从“准备就绪”部分下载并导入了这个包，我们现在应该在我们的“项目”文件夹中拥有所有文件。如果您转到“图形/塔”文件夹并选择`cupcake_tower_sheet-01`，我们应该在**检查器**中看到以下内容：

![导入新朋友](img/image00331.jpeg)

这些是**导入设置**，可以设置不同的选项。在我们更改了某些内容之后，我们需要按下底部的**应用**按钮来确认更改。同样，如果我们不满意，我们可以按下**还原**按钮来放弃我们的更改。

重要的是要注意**纹理类型**是**精灵（2D和UI）**。在2D模式下，Unity始终将图像文件导入为精灵而不是纹理。

我们需要考虑的另一个重要参数是**精灵模式**。默认情况下，它设置为**单个**，但它可以被更改为**多个**或**多边形**（仅从Unity 5.3开始）。正如名称所暗示的，第一个用于图像包含单个精灵时，第二个模式用于我们有一个包含多个精灵的精灵图集时。最后一个用于识别具有自定义边数的多边形精灵。

此外，**每单位像素**参数决定了精灵在场景中的大小。它表示在**场景视图**中需要多少像素来表示一个单位长度。默认情况下，它设置为**100**，但当你需要调整你的资产并更改它们到正确的尺寸时，你应该修改这个值。然而，如果你已经有了缩放的想法，相应地创建图形可以在开发的后期阶段节省一些时间。

关于其他设置（**打包标签**、**生成Mip贴图**、**过滤模式**、**最大尺寸**和**格式**），我们将在本书的最后一章中详细讨论，届时我们将讨论优化。

由于我们选择的文件包含多个精灵，在我们进入下一节之前，让我们将**精灵模式**设置为**多个**。

## 精灵编辑器

在**导入设置**中，还有一个名为**精灵编辑器**的按钮。如果我们按下这个按钮，会出现一个新的窗口。这就是**精灵编辑器**，正如我们可以在以下屏幕截图中看到的：

![精灵编辑器](img/image00332.jpeg)

如果我们搞砸了，我们总是可以通过点击**精灵编辑器**右上角的**还原**按钮来恢复它们。旁边，你还可以找到一个**应用**按钮，你使用它来确认你的选择，所以请小心你按的是哪一个！

为了你的参考，它们在下一张屏幕截图中被突出显示：

![精灵编辑器](img/image00333.jpeg)

在这两个按钮附近，你可以找到一些可能在你在**精灵编辑器**中工作时有所帮助的功能。第一个按钮很容易错过，但它允许你从彩色资产（RGB通道）切换到B/W（alpha通道）。这在需要定义轮廓且图像具有透明度时特别有用，正如我们稍后将会看到的。为了避免错过它，你可以在以下屏幕截图中找到它被突出显示：

![精灵编辑器](img/image00334.jpeg)

在它的右边，有两个滑块，允许你放大/缩小或增加/减少分辨率（像素数）。这些功能在以下屏幕截图中显示：

![精灵编辑器](img/image00335.jpeg)

**精灵编辑器**允许你进行不同的操作。对于单个精灵，它提供了改变支点的可能性。对于精灵图集，例如在这个案例中，这是Unity理解有多少精灵以及它们在图像中位置的方式。

现在，有几种不同的方法来做这件事，所以让我们更详细地看看它们。

### 手动模式

在手动模式下，是你选择图像中的每个精灵，并告诉Unity它的位置和大小。

要创建一个新的选择，你需要点击精灵的一个角，并拖动鼠标直到你选择了整个精灵。一个绿色矩形出现，显示你选择的部分，并且你可以看到在拖动鼠标时精灵如何实时变化。如果你释放鼠标按钮，绿色矩形变成蓝色，Unity将解释它内部的所有内容作为精灵。

你可以创建尽可能多的选择（矩形）。此外，通过点击它们，你可以将它们移动到图像的周围并改变它们的尺寸。以下是我们带有一些手动选择的精灵图集的示例：

![手动模式](img/image00336.jpeg)

如果你画了一个比精灵大的矩形，Unity可以尝试裁剪它。在精灵编辑器的左上角，有裁剪按钮，如图所示：

![手动模式](img/image00337.jpeg)

它仅在突出显示选择时才处于活动状态。如果你不喜欢最终结果，你总是可以修改选择。

此外，在每个选择的中间有一个小蓝色圆圈。这是该选择的中心点。我们可以自由地将其拖动到另一个位置。然而，除了非常特定的情况外，将中心点放在中间是常见且有用的。所以目前，不必太担心它，只需将其留在中间即可。

你可能还会注意到，在矩形的每一边中间都有四个小绿色方块。在几个部分中，我们需要它们来进行9切片缩放。

一旦我们突出显示了选择，就可以通过使用出现在精灵编辑器右下角菜单中的选项来更详细地修改它。这里看起来是这样的：

![手动模式](img/image00338.jpeg)

从这个菜单中，你可以修改选择的名称，这将反映在我们使用精灵时的名称上。通过输入数值，你可以精确设置选择的尺寸、位置和中心点。

总结来说，手动模式在精灵图集中的精灵形状和尺寸不同时特别有用。即使图片的设计者很小心，避免将单个精灵放置得很近，物体仍然可以有非常不同的尺寸。

### 自动模式

在自动模式下，Unity会尝试切割精灵，这意味着它会为你创建不同的选择。然而，为了获得更好的结果，你需要提供一些关于图像的信息。无论如何，一旦Unity为图像提供了选择，你仍然可以像在手动模式下一样修改它们。

在**精灵编辑器**的左上角，紧挨着**裁剪**按钮，我们可以看到**切片**按钮，如图所示：

![自动模式](img/image00339.jpeg)

点击它，会出现一个看起来像这样的菜单：

![自动模式](img/image00340.jpeg)

如你所见，我们可以选择不同的类型。让我们逐一了解它们。

**自动**类型是Unity对选择的最佳猜测。除了我们稍后将看到的放置选择中心点的方法外，没有其他设置。Unity将自动完成所有操作，如果我们不需要我们的精灵具有相同的大小，这种方法效果相当不错。以下是应用于我们图像的最终结果：

![自动模式](img/image00341.jpeg)

**自动**类型包含三种不同的方法：

+   **删除现有**方法在切片图像之前删除所有之前的选区

+   **智能**方法试图为尚未选择的精灵创建选择

+   **安全**方法在创建新选区时不会删除之前的选区

相反，**按单元格大小划分网格**类型将图像划分为选区的网格。从菜单中，你可以选择每个单元格的尺寸。因此，单元格的数量将取决于它们的大小。

**按单元格数量划分网格**类型再次将图像划分为选区的网格。然而，这次，你可以从菜单中设置图像中的单元格数量，它们的尺寸将取决于此。以下是使用4 x 4网格切片的我们的图像：

![自动模式](img/image00342.jpeg)

### 多边形模式

从Unity 5.3开始，你可以访问精灵编辑器的新功能。为了使用它，你需要将资产的导入设置中的精灵模式设置为多边形。

在此模式下，Unity自动将精灵作为多边形切片。一旦我们打开精灵编辑器，我们就可以立即设置多边形的边数或边。如果我们错过了这个设置，我们总是可以按下精灵编辑器左上角所示的**更改形状**按钮：

![多边形模式](img/image00343.jpeg)

如果我们选择一个八边形（八边形多边形），这是我们图像中的最终结果：

![多边形模式](img/image00344.jpeg)

### UI精灵编辑器-9切片缩放

另一个重要的精灵编辑器功能是9切片。当用户界面元素需要在不同部分进行不同缩放时使用。这个功能在精灵编辑器中，因为Unity将用户界面元素视为精灵。

我们将在另一章中看到用户界面，但让我们先了解为什么某些用户界面元素需要以不同的方式缩放。正如你所知，游戏可以在不同屏幕上运行，这些屏幕通常具有不同的分辨率和宽高比。因此，用户界面需要根据屏幕进行适当的缩放。然而，如果你创建了一个具有美丽圆角的按钮，一旦缩放，它们的外观将与我们最初设计的完全不同，而且并不更好。

9切片技术通过在精灵上定义九个不同缩放的区域来避免这个问题。特别是，角落将完全不缩放：只有沿着其轴的边缘和中央区域将向所有方向缩放。以下图像将帮助理解这九个区域以及它们的缩放方式：

![精灵编辑器用于UI-9切片缩放](img/image00345.jpeg)

让我们用一个UI图像来学习如何使用Unity的精灵编辑器进行9切片。在`Graphics/UI`文件夹中选择`ui_blank_square_icon_pink`，并在精灵编辑器中打开它。由于我们没有将其**精灵模式**设置为**多个**，所以我们只有一个围绕整个图像的选择。

正如我们已经注意到的，在我们的选择边缘有一些绿色方块。如果我们拖动它们，我们可以将图像分成九个部分，我们正在对这个精灵执行9切片。以下是如何使用按钮进行9切片的示例：

![精灵编辑器用于UI-9切片缩放](img/image00346.jpeg)

你需要将中央区域留得尽可能大，并保持其他区域适当的大小，以包括角落和边缘。

现在，我们应该对精灵编辑器有了很多了解。我建议你在进入本书的下一部分之前，先使用精灵编辑器练习一下。实际上，你需要练习我们迄今为止所介绍的方法，为我们将要构建的游戏准备所有资源。

## 准备资源

在本节中，你将有机会练习我们迄今为止所学到的。实际上，我们需要为我们的游戏准备资源。

让我们先选择`Graphics/towers/cupcake_tower_sheet-01`（我们之前使用的同一个文件）并使用3 x 3网格进行切片。然后，我们应该为每个精灵重命名。

在第一行，我们可以给他们这些名称（从左到右）：

+   `Sprinkles_Cupcake_Tower_0`

+   `Sprinkles_Cupcake_Tower_1`

+   `Sprinkles_Cupcake_Tower_2`

在第二行，我们可以给他们这些名称：

+   `ChocolateChip_Cupcake_Tower_0`

+   `ChocolateChip_Cupcake_Tower_1`

+   `ChocolateChip_Cupcake_Tower_2`

最后，第三行：

+   `Lemon_Cupcake_Tower_0`

+   `Lemon_Cupcake_Tower_1`

+   `Lemon_Cupcake_Tower_2`

最后，在**项目**面板中，我们应该有以下内容：

![准备资源](img/image00347.jpeg)

使用相同的过程处理`Graphics/enemies`和`Graphics/UI`文件夹，通过分割不同的精灵图集。别忘了分配有意义的名称。在本书的其余部分，当我们提到一个资源时，其名称将不言自明。为了您的方便，我们将指定精灵被取出的原始文件。

# 作为关卡的场景

一个Unity游戏由不同的场景组成，你可以把它们想象成关卡。在**项目**面板中创建一个文件夹来存储所有场景是个好习惯。所以，如果我们还没有这样做，请右键点击**项目**面板，然后导航到**创建 | 文件夹**，并将其重命名为`Scenes`。

在工具栏菜单中，在**文件**下，有创建、保存和加载场景的选项。让我们保存当前的场景，即使它是空的，也可以通过导航到**文件** | **保存场景**，如图所示：

![场景作为关卡](img/image00348.jpeg)

### 小贴士

您也可以使用键盘快捷键*Ctrl* + *s* (*Cmd* + *S*在Mac OS上)来保存场景。

Unity会询问保存场景的位置。选择我们刚刚创建的`Scenes`文件夹，并将文件命名为`Level_01`。因此，每次我们保存场景时，Unity都会将其保存在这个文件中。

## 设置比例

在构建我们的游戏时，我们需要考虑我们打算为哪个目标平台进行开发。当然，我们希望将游戏适配到尽可能多的设备和平台。因此，在游戏开发过程中，进行这种适配是一个重要的步骤。

由于这超出了本书的范围，我们不会过多地详细介绍，但重要的是要了解目标平台的屏幕比例，并据此开发游戏。对于本书，我们将坚持使用16:9，因为它是一个常见的比例，也容易适应其他比例，而且我们下载的包是为16:9比例创建的。

要在Unity中更改比例，您需要选择**游戏**选项卡。在左上角，有两个下拉菜单。第一个是用于显示（从Unity 5.3可用）的，另一个是比例。它们在以下屏幕截图中突出显示：

![设置比例](img/image00349.jpeg)

### 注意

从Unity 5.5开始，在这些设置旁边还有一个滑块，允许您通过更改其比例在场景中放大或缩小。

如果您需要一个自定义比例，您可以在列表末尾选择加号按钮，然后会出现如下屏幕：

![设置比例](img/image00350.jpeg)

从这里，您可以为此分辨率及其维度分配一个标签。一旦添加了分辨率，它将在所有项目中共享。

在我们进入下一部分之前，请记住将项目的分辨率设置为**16:9**。

# 关于Unity界面的更多信息

从我在本章开头向您推荐的e-guide中，您应该已经对Unity界面有了更多的了解。但是，我想与您分享一个小技巧。

从顶部菜单栏导航并选择**编辑 | 预设...**，如图所示：

![关于Unity界面的更多信息](img/image00351.jpeg)

然后，从出现的菜单中选择第三个选项卡，**颜色**，在这个屏幕上您将有机会更改场景视图中主要图形元素（或Gizmos；见下一章）的颜色，例如轴或网格，如图所示：

![关于Unity界面的更多信息](img/image00352.jpeg)

然而，技巧在于 **Playmode 淡色** 设置。它允许你在游戏运行时更改界面的整体色调。你可能现在看不到它的实用性，但当你想要修改参数时，它会非常有帮助。而且，你可能会忘记自己是在游戏模式中。我个人认为，这个小技巧在很多情况下都帮了我大忙。以下是一个示例，展示了 Unity 界面在以蓝色色调的游戏模式下的外观：

![关于 Unity 界面还有更多内容](img/image00353.jpeg)

# 作业

在本章中，你已经花了一些时间与 Sprite 编辑器一起工作，因此没有必要再进行更多关于它的练习。然而，如果你出于某种原因想要继续练习，你可以从 Unity 资产商店（**窗口 | 资产商店**）下载标准资产，因为它是免费的。然后，导入 `Standard Assets/2D/Sprites` 文件夹，并尝试使用不同的模式从头开始切片，以实现相同的结果。

# 摘要

在本章中，我们已经看到了导入 Sprites 并为在游戏中使用它们做准备的全过程。在这个过程中，我们了解了 Sprites 是什么，如何导入它们，以及如何以不同的方式使用 Sprite 编辑器。此外，我们还探讨了在设置为 2D 模式下的 Unity，并了解了 2D 游戏开发的简介。最后，我们学习了如何设置场景，以适应目标平台的正确屏幕分辨率。

我认为本章我们已经涵盖了大量的内容，现在是时候休息一下了。在继续到下一章学习 2D 游戏脚本之前，去拿一杯咖啡或者甚至一块纸杯蛋糕吧。
