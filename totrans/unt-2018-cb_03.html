<html><head></head><body>
        

                            
                    <h1 class="header-title">Inventory UIs</h1>
                
            
            
                
<p>In this chapter, we will cover the following topics:</p>
<ul>
<li>Creating a simple 2-D mini-game - SpaceGirl</li>
<li>Displaying single object pickups with carrying and not-carrying text</li>
<li>Displaying single object pickups with carrying and not-carrying icons</li>
<li>Displaying multiple pickups of the same object with multiple status icons</li>
<li>Using panels to visually outline the inventory UI area and individual items</li>
<li>Creating a C# inventory slot display UI scripted component</li>
<li>Generalizing multiple icon displays using UI Grid Layout Groups (with scrollbars!)</li>
<li>Displaying multiple pickups of different objects as a list of text via a dynamic <kbd>List&lt;&gt;</kbd> of scripted PickUp objects</li>
<li>Displaying multiple pickups of different objects as text totals via a dynamic <kbd>Dictionary&lt;&gt;</kbd> of PickUp objects and enum pickup types</li>
</ul>


            

            
        
    

        

                            
                    <h1 class="header-title">Introduction</h1>
                
            
            
                
<p>Many games involve the player collecting items or choosing from a selection of items. Examples are collecting keys to open doors, collecting ammo for weapons, and choosing from a collection of spells to cast.</p>
<p>The recipes in this chapter provide a range of solutions for displaying to the player whether they are carrying an item or not, whether they are allowed more than one of an item, and how many they have.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">The big picture</h1>
                
            
            
                
<p>The two parts of software design for implementing inventories relate to, first, how we choose to represent the data about inventory items (that is, the data types and structures to store the data) and, second, how we choose to display information about inventory items to the player (the UI).</p>
<p>Also, whilst not strictly inventory items, player properties such as lives left, health, and time remaining can also be designed around the same concepts that we present in this chapter.</p>
<p>We need to first think about the nature of different inventory items for any particular game:</p>
<ul>
<li>Single items:
<ul>
<li>Examples: the only key for a level, our suit of magic armor</li>
<li>Data type: <kbd>bool</kbd> (Boolean – <kbd>true</kbd>/<kbd>false</kbd>)</li>
<li>UI: nothing (if not carried) or text/image to show being carried
<ul>
<li>Or perhaps, if we wish to highlight to the player that there is an <strong>option</strong> to carry this item, then we could display a text <kbd>string</kbd> saying <kbd>no key</kbd>/<kbd>key</kbd>, or two images, one showing an empty key outline and the second showing a full-color key.</li>
</ul>
</li>
</ul>
</li>
<li>Continuous item:
<ul>
<li>Examples: time left, health, shield strength</li>
<li>Data type: <kbd>float</kbd> (for example, 0.00-1.00) or <kbd>int</kbd> (Integer) scale<br/>
(for example, 0% to 100%)</li>
<li>UI: text number or image progress bar/pie chart</li>
</ul>
</li>
<li>Two or more of same item
<ul>
<li>Examples: lives left, or number of arrows or bullets left</li>
<li>Data type: <kbd>int</kbd> (Integer – whole numbers)</li>
<li>UI: text count or images</li>
</ul>
</li>
</ul>
<ul>
<li style="font-size: 1em">Collection of related items
<ul>
<li>Examples: keys of different colors to open correspondingly colored doors, potions of different strength with different titles</li>
<li>Data structure: a <kbd>struct</kbd> or <kbd>class</kbd> for the general item type (for example, class <kbd>Key</kbd> (color/cost/doorOpenTagString), stored as an array or <kbd>List&lt;&gt;</kbd></li>
<li>UI: text list or list/grid arrangement of icons</li>
</ul>
</li>
<li>Collection of different items
<ul>
<li>Examples: keys, potions, weapons, tools, all in the same inventory system</li>
<li>Data structure: <kbd>List&lt;&gt;</kbd> or <kbd>Dictionary&lt;&gt;</kbd> or array of objects, which can be instances of different class for each item type</li>
</ul>
</li>
</ul>
<p>Each of the preceding representations and UI display methods are illustrated by the recipes in this chapter. In addition, in the chapter we'll learn how to create and use custom Sorting Layers in order to have complete control over which objects appear on top of or below other objects – something that is pretty important when scene content can contain background images, pickups, player characters, and so on.</p>
<p>These recipes demonstrate a range of C# data representations for inventory items and a range of Unity UI interface components for displaying the status and contents of player inventories at runtime. Inventory UI needs good quality graphical assets for a high-quality result. Some sources of assets that you might wish to explore include the following sites:</p>
<ul>
<li>The graphics for our SpaceGirl mini-game are from Space Cute art by Daniel Cook; he generously publishes lots of 2D art for game developers to use:
<ul>
<li><a href="http://www.lostgarden.com/">http://www.lostgarden.com/</a></li>
<li><a href="http://www.lostgarden.com/search?q=planet+cute">http://www.lostgarden.com/search?q=planet+cute</a></li>
</ul>
</li>
<li>Sethbyrd-lots of fun 2D graphics:
<ul>
<li><a href="http://www.sethbyrd.com/">http://www.sethbyrd.com/</a></li>
</ul>
</li>
<li>Royalty-free art for 2D games:
<ul>
<li><a href="http://www.gameart2d.com/freebies.html">http://www.gameart2d.com/freebies.html</a></li>
</ul>
</li>
</ul>


            

            
        
    

        

                            
                    <h1 class="header-title">Creating a simple 2D mini-game – SpaceGirl</h1>
                
            
            
                
<p class="mce-root">This recipe shows how to create the 2D Space Girl mini-game, on which all the recipes of this chapter are based.</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/0fb94072-acb7-423d-871d-da25d88ec6f4.png" style="width:24.17em;height:6.67em;"/></p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p style="color: black">For this recipe, we have prepared the images you need in a folder named Sprites in the <kbd>03_01</kbd> folder. We have also provided the completed game as a Unity package in this folder, named <kbd>Simple2DGame_SpaceGirl</kbd>.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<p>To create the simple 2D Space Girl mini-game, follow these steps:</p>
<ol>
<li>Create a new, empty 2D project.</li>
<li>Import the supplied folder <kbd>Sprites</kbd> into your project.</li>
<li>Since it's a 2D project, each sprite image should be of type <strong>Sprite (2D and UI)</strong>. Check this by selecting the sprite in the Project panel, then, in the <strong>Inspector</strong>, check property <strong>Texture</strong> Type. If you need to change the type, change it from this drop-down menu, then click the <strong>Apply</strong> button.</li>
<li>Set the Unity Player screen size to <kbd>800 x 600</kbd>: choose this resolution from the drop-down menu on the Game panel. If <kbd>800 x 600</kbd> isn't an offered resolution, the click the plus sign <strong>+</strong> button and create this as a new resolution for the panel.</li>
<li>Display the <strong>Tags</strong> and <strong>Layers</strong> properties for the current Unity project. Choose menu Edit | Project Settings | Tags and Layers. Alternatively, if you are already editing a GameObject, then you can select the <strong>Add Layer...</strong> menu from the Layer drop-down menu at the top of the Inspector panel, next to the Static <kbd>true</kbd>/<kbd>false</kbd> toggle.</li>
</ol>
<ol start="6">
<li>Use the expand/contract triangle tools to contract <strong>Tags and Layers</strong>, and to expand <strong>Sorting Layers</strong>. Use the plus sign + button to add two new sorting layers, as shown in the screenshot: first, add one named <kbd>Background</kbd>, and next, add one named <kbd>Foreground</kbd>. The sequence is important since Unity will draw items in layers<br/>
further down this list on top of items earlier in the list. You can rearrange the layer sequence by clicking and dragging the position control: the wide equals sign (=) icon to the left of the word Layer in each row:</li>
</ol>
<div><img src="img/163362cf-7579-4d18-aaeb-1ee90007781f.png"/></div>
<ol start="7">
<li>Drag the <kbd>background_blue</kbd> sprite from the Project panel (in the <kbd>Sprites</kbd> folder) into either the <strong>Game</strong> or <strong>Hierarchy</strong> panel to create a GameObject for the current scene. Set the <kbd>Position</kbd> of this GameObject to (<kbd>0</kbd>,<kbd>0</kbd>,<kbd>0</kbd>). It should completely cover the Game panel (at resolution <kbd>800 x 600</kbd>).</li>
<li>Set the <strong>Sorting Layer</strong> of GameObject background-blue to <strong>Background</strong> (in the <strong>Sprite Renderer</strong> component):</li>
</ol>
<div><img src="img/b621c9a4-4585-4ce1-91e8-606e55b7fcb5.png"/></div>
<ol start="9">
<li>Drag sprite star from the <strong>Project</strong> panel (in the <kbd>Sprites</kbd> folder) into either the <strong>Game</strong> or <strong>Hierarchy</strong> panel to create a GameObject for the current scene:
<ul>
<li>Create a new tag, Star, and assign this tag to GameObject star (tags are created in the same way we created sorting layers).</li>
<li>Set the Sorting Layer of GameObject star to Foreground (in the Sprite Renderer component).</li>
<li>Add to GameObject star a Box Collider 2D (Add Component | Physics 2D | Box Collider 2D) and check Is Trigger, as shown in the screenshot:</li>
</ul>
</li>
</ol>
<div><img src="img/ee263562-8258-4402-b467-879532053a6a.png"/></div>
<ol start="10">
<li>Drag the girl1 sprite from the <strong>Project</strong> panel (in the <kbd>Sprites</kbd> folder) into either the <strong>Game</strong> or <strong>Hierarchy</strong> panel to create a GameObject for the player's character in the current scene. Rename this GameObject <kbd>player-girl1</kbd>.</li>
<li>Set the Sorting Layer of GameObject <kbd>player-girl1</kbd> to Foreground.</li>
<li>Add a Physics | Box Collider 2D component to GameObject <kbd>player-girl1</kbd> .</li>
<li>Add a Physics 2D | Rigid Body 2D component to GameObject <kbd>player-girl1</kbd> . Set its Gravity Scale to zero (so it isn't falling down the screen due to simulated gravity), as shown in the screenshot:</li>
</ol>
<div><img src="img/464d268b-9a25-45cf-9ba0-4742586b04d3.png" style="width:19.83em;height:16.67em;"/></div>
<ol start="14">
<li>Create a new folder for your scripts named <kbd>_Scripts</kbd>.</li>
<li>Create the following C# Script PlayerMove (in the <kbd>_Scripts</kbd> folder) and add an instance as a component to GameObject player-girl1 in the <strong>Hierarchy</strong>:</li>
</ol>
<pre style="color: black;padding-left: 60px">using UnityEngine; 
using System.Collections; 

public class PlayerMove : MonoBehaviour { 
  public float speed = 10; 
  private Rigidbody2D rigidBody2D;<br/>  private Vector2 newVelocity;<br/><br/>void Awake(){ <br/>rigidBody2D = GetComponent&lt;Rigidbody2D&gt;(); <br/>} <br/><br/>void Update() {<br/>  float xMove = Input.GetAxis("Horizontal");<br/>  float yMove = Input.GetAxis("Vertical");<br/><br/>  float xSpeed = xMove * speed;<br/>  float ySpeed = yMove * speed;<br/><br/>  newVelocity = new Vector2(xSpeed, ySpeed);<br/>}<br/><br/>void FixedUpdate() {<br/>  rigidBody2D.velocity = newVelocity;<br/>}<br/><br/>}</pre>
<ol start="16">
<li>Save the scene (name it Main Scene and save it into a new folder named _Scenes).</li>
</ol>


            

            
        
    

        

                            
                    <h1 class="header-title">How it works...</h1>
                
            
            
                
<p style="color: black">You have created a player character in the scene using the girl1 sprite, and added a scripted component instance of class <kbd>PlayerMove</kbd>. You have also created a star GameObject (a pickup), tagged Star and with a 2D box collider that will trigger a collision when the player's character hits it. When you run the game, the <kbd>player-girl1</kbd> character should move around using <kbd>W A S D</kbd>, the arrow keys, or joystick. There is a <kbd>newVelocity</kbd> variable, which is updated each frame in the <kbd>Update()</kbd> method based on the inputs. This <kbd>Vector2</kbd> value is then applied in the <kbd>FixedUpdate()</kbd> method to become the new velocity for the GameObject. </p>
<p style="color: black">Unity maps user inputs such as key presses, arrow keys, and game controller controls to its <kbd>Input</kbd> class. Two special properties of the Input class are the Horizontal and Vertical axes – accessed via the <kbd>Input.GetAxis</kbd>("<kbd>Horizontal</kbd>") and <kbd>Input.GetAxis</kbd>("<kbd>Vertical</kbd>") methods.</p>
<div><strong>Managing your input mapping:</strong> You can manage the mapping from different user input methods (keys, mouse, controllers, and so on) to the axes through menu: <strong>Edit</strong> | <strong>Project Settings</strong> | <strong>Input</strong></div>
<p style="color: black">Currently, nothing will happen if the <kbd>player-SpaceGirl</kbd> character hits a star because that has yet to be scripted.</p>
<p style="color: black">You have added a background (GameObject background-blue) to the scene, which will be behind everything since it is in the rearmost sorting layer, <strong>Background</strong>. Items you want to appear in front of the background (the player character and the star, so far) are placed on the <strong>Foreground</strong> sorting layer.</p>
<p>We can learn more about Unity tags and layers at <a href="http://docs.unity3d.com/Manual/class-TagManager.html">http://docs.unity3d.com/Manual/class-TagManager.html</a>.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Displaying single object pickups with carrying and not-carrying text</h1>
                
            
            
                
<p style="color: black">Often the simplest inventory situation is to display text to tell players whether they are carrying a single item (or not). We'll add the ability to detect collisions with GameObject tagged <strong>Star</strong> to the SpaceGirl mini-game, and display an on-screen message stating whether a star has been collected or not:</p>
<div><img src="img/47cd6ba6-5511-4d54-bcc3-8b980049f26c.png" style="width:28.42em;height:5.08em;"/></div>
<p style="color: black">At the end of the recipe, in the <em>There's more...</em> section, we'll learn to adapt this recipe to maintain an <strong>Integer</strong> total of how many stars have been collected, for a version of the game with lots of stars to collect.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p style="color: black">For this recipe, we have prepared a folder named Fonts in the <kbd>03_02</kbd> folder.</p>
<p style="color: black">This recipe assumes that you are starting with the <kbd>Simple2Dgame_SpaceGirl</kbd> project that was set up from the first recipe in this chapter. So, make a copy of that project, and work on this copy.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<p style="color: black">To display text to inform the user about the status of carrying a single object pickup, follow these steps:</p>
<ol>
<li>Start with a new copy of the <kbd>Simple2Dgame_SpaceGirl</kbd> mini-game.</li>
<li>Add a UI Text object (<strong>Create</strong> | <strong>UI</strong> | <strong>Text</strong>). Rename it Text-carrying-star. Change its text to Carrying star: false.</li>
<li>Import the provided Fonts folder into your project.</li>
</ol>
<ol start="4">
<li>In the <strong>Inspector</strong> panel, set the font of Text-carrying-star to <strong>Xolonium-Bold</strong>, and set its color to yellow. Center the text horizontally and vertically, set its <strong>Height</strong> to <kbd>50</kbd>, and set the <strong>Font Size</strong> to <kbd>32</kbd>.</li>
</ol>
<ol start="5">
<li>Edit its Rect Transform, and while holding down <em>Shift</em> + <em>Alt</em> (to set pivot and position), choose the top-stretch box:</li>
</ol>
<div><img src="img/93d7b082-58ea-4ac2-b06c-417d0d24aec4.png"/></div>
<ol start="6">
<li>Your text should now be positioned at the middle top of the <strong>Game</strong> panel, and its width should stretch to match that of the whole panel, as shown in the screenshot in the introduction to this recipe.</li>
<li>Create the following C# script class <kbd>PlayerInventory</kbd> in the <kbd>_Scripts</kbd> folder:<br/></li>
</ol>
<pre style="color: black;padding-left: 60px">using UnityEngine; 

public class PlayerInventory : MonoBehaviour { 
   private PlayerInventoryDisplay playerInventoryDisplay; 
   private bool carryingStar = false;  

   void Awake() { 
         playerInventoryDisplay = GetComponent&lt;PlayerInventoryDisplay&gt;(); 
   } 

   void Start() { 
         playerInventoryDisplay.OnChangeCarryingStar( carryingStar); 
   }  

   void OnTriggerEnter2D(Collider2D hit) { 
         if (hit.CompareTag("Star")) { 
               carryingStar = true; 
               playerInventoryDisplay.OnChangeCarryingStar( carryingStar); 
               Destroy(hit.gameObject); 
         } 
   } 
} </pre>
<ol start="8">
<li>Create the following C# script class <kbd>PlayerInventoryDisplay</kbd> in the <kbd>_Scripts</kbd> folder:</li>
</ol>
<pre style="color: black;padding-left: 60px">using UnityEngine; 
using UnityEngine.UI;

[RequireComponent(typeof(PlayerInventory))] 
public class PlayerInventoryDisplay : MonoBehaviour  { 
   public Text starText; 
   public void OnChangeCarryingStar(bool carryingStar) { 
         string starMessage = "no star :-("; 
         if(carryingStar) 
               starMessage = "Carrying star :-)"; 
         starText.text = starMessage; 
   } 
} </pre>
<ol start="9">
<li>Add an instance of script-class <kbd>PlayerInventoryDisplay</kbd> to the player-SpaceGirl GameObject in the <strong>Hierarchy</strong>.</li>
</ol>
<p>Note, since the <kbd>PlayerInventoryDisplay</kbd> class contains <kbd>RequireComponent(),</kbd> then an instance of script class <kbd>PlayerInventory</kbd> will be automatically added to GameObject <kbd>player-SpaceGirl.</kbd></p>
<ol start="10">
<li>From the <strong>Hierarchy</strong> view, select the <kbd>player-SpaceGirl</kbd> GameObject. Then, from the <strong>Inspector</strong>, access the Player Inventory Display (Script) component and populate the <strong>Star Text</strong> public field with GameObject Text-carrying-star, as shown in the screenshot.</li>
</ol>
<div><img src="img/4cc4e685-d15a-4492-a65b-abf72bd68271.png" style="width:37.83em;height:18.75em;"/></div>
<ol start="11">
<li>When you play the scene, after moving the character into the star, the star should disappear, and the onscreen <strong>UI Text</strong> message should change to Carrying star :-):</li>
</ol>
<div><img src="img/8914a461-ea47-40b9-a487-b01e209ea333.png" style="width:31.92em;height:6.92em;"/></div>


            

            
        
    

        

                            
                    <h1 class="header-title">How it works...</h1>
                
            
            
                
<p style="color: black">You created a <strong>UI Text</strong> GameObject Text-carrying-star to display to the player a text message stating whether or not a star is being carried. You created two script classes, and an instance of each was added as a component to the player's <kbd>player-SpaceGirl</kbd> character GameObject:</p>
<ul>
<li>Script-class <kbd>PlayerInventory</kbd> detects player-star collisions, updates internal variables saying whether a star is carried, and asks for the UI display to be updated each time a collision is detected.</li>
</ul>
<ul>
<li>Script-class <kbd>PlayerInventoryDisplay</kbd> handles the communication to the user by updating the text message displayed by the Text-carrying-star UI Text GameObject.</li>
</ul>
<p style="color: black">A game design pattern (best practice approach) called the <strong>Model-View-Controller pattern</strong> (<strong>MVC</strong>) separates the code that updates the UI from the code that changes player and game variables such as score and inventory item lists. Although this recipe has only one variable and one method for updating the UI, well-structured game architectures scale up to cope with more complex games, so it is often worth the effort of a little more code and an extra script class, even at this game-beginning stage, if we want our final game architecture to be well structured and maintainable.</p>
<p style="color: black">One additional advantage of this design pattern is that the method in which the information is communicated to the user via the UI can be changed (for example, from text to an icon – see the next recipe!), without any change to the code in script class <kbd>PlayerInventory</kbd>.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">The PlayerInventory script class</h1>
                
            
            
                
<p style="color: black">The <kbd>playerInventoryDisplay</kbd> variable is a reference to an instance object of class <kbd>PlayerInventoryDisplay</kbd>.</p>
<p style="color: black">The bool variable carryingStar represents whether or not the player is carrying the star at any point in time; it is initialized to false.</p>
<p style="color: black"><kbd>Method Awake()</kbd> caches a reference to the sibling component <kbd>playerInventoryDisplay</kbd>.</p>
<p style="color: black">When the scene begins, via the <kbd>Start()</kbd> method, we call the <kbd>OnChangeCarryingStar(...)</kbd> method of script component <kbd>playerInventoryDisplay</kbd>, passing in the initial value of <kbd>carryingStar</kbd> (which is false). This ensures that we are not relying on text typed into the <strong>UI Text</strong> object Text-carrying-star at <strong>Design-Time</strong>, so that the UI seen by the user is always set by our <strong>Run-Time</strong> methods. This avoids problems where the words to be displayed to the user are changed in code and not in the <strong>Inspector</strong> panel – which leads to a mismatch between the onscreen text when the scene first runs and after it has been updated from a script.</p>
<p>A golden rule in Unity game design is to avoid duplicating content in more than one place, and, therefore, we avoid having to maintain two or more copies of the same content. Each duplicate is an opportunity for maintenance issues when some, but not all, copies of a value are changed.<br/>
Maximizing use of prefabs is another example of this principle in action. This is also know as the DRY principal – don't repeat yourself.</p>
<p style="color: black">Each time the player's character collides with any object that has its Is <strong>Trigger</strong> set to true, an <kbd>OnTriggerEnter2D()</kbd> event message is sent to both objects involved in the collision. The <kbd>OnTriggerEnter2D()</kbd> message is passed as a parameter that is a reference to the <kbd>Collider2D</kbd> component inside the object just collided with.</p>
<p style="color: black">Our player's <kbd>OnTriggerEnter2D()</kbd> method tests the tag string of the object collided with to see whether it has the <strong>Star</strong> value. Since the GameObject star we created has its trigger set, and has the tag <strong>Star</strong>, the if statement inside this method will detect a collision with the star and complete the following three actions:</p>
<ul>
<li>The Boolean (flag) variable <kbd>carryingStar</kbd> is set to true</li>
<li>The method <strong>OnChangeCarryingStar(...)</strong> of script component <strong>playerInventoryDisplay</strong> is called, passing in the updated value of <strong>carryingStar</strong></li>
<li>The GameObject just collided with is destroyed – that is, the star</li>
</ul>
<div><br/>
Boolean variables are often referred to as flags.<br/>
The use of a bool (true/false) variable to represent whether some feature of the game state is true or false is very common. Programmers often refer to these variables as flags. So, programmers might refer to the carryingStar variable as the star-carrying flag.</div>


            

            
        
    

        

                            
                    <h1 class="header-title">The PlayerInventoryDisplay script class</h1>
                
            
            
                
<p style="color: black">The public <kbd>Text</kbd> variable <kbd>starText</kbd> is a reference to the <strong>UI Text</strong> object Text-carrying-star. Its value has been set via drag-and-drop at design time.</p>
<p style="color: black">The <kbd>OnChangeCarryingStar</kbd>(carryingStar) method updates the text property of starText with the value of string variable <kbd>starMessage</kbd>. This method takes an input bool argument <kbd>carryingStar</kbd>. The default value of string <kbd>starMessage</kbd> tells the user that the player is not carrying the star, but an if statement tests the value of <kbd>carryingStar</kbd>, and, if that is true, then the message is changed to inform the player that they are carrying the star.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">There's more...</h1>
                
            
            
                
<p style="color: black">Here are some details you won't want to miss.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Collecting multiple items and display total number carried</h1>
                
            
            
                
<p style="color: black">Often there are pickups that the player can collect more than one of. In such situations, we can use an Integer to represent the total number collected, and use a UI Text object to display this total to the user. Let's modify the recipe to allow SpaceGirl to collect lots of stars!</p>
<div><img src="img/8897c7a4-4a47-4947-ba46-a95155071af0.png"/></div>
<p style="color: black">To convert this recipe to one that shows the total number of stars collected, do the following:</p>
<ol>
<li>Make three or four more copies of the <strong>star</strong> GameObject and spread them around the scene. This gives the player several stars to collect rather than just one.</li>
</ol>
<p>Use keyboard shortcut <em>Ctrl</em> + <em>D</em> (Windows) or <em>CMD</em> + <em>D</em> (Mac) to quickly duplicate GameObjects.</p>
<ol start="2">
<li>Change the contents of the C# script class <kbd>PlayerInventory</kbd> to contain the following:</li>
</ol>
<pre style="color: black;padding-left: 60px">using UnityEngine; 
public class PlayerInventory : MonoBehaviour { 
   private PlayerInventoryDisplay playerInventoryDisplay; 
   private int totalStars = 0; 

   void Awake() { 
         playerInventoryDisplay = GetComponent&lt;PlayerInventoryDisplay&gt;(); 
   }  

   void Start() { 
        playerInventoryDisplay.OnChangeStarTotal(totalStars); 
   } 

   void OnTriggerEnter2D(Collider2D hit) { 
         if (hit.CompareTag("Star")) { 
            totalStars++; 
            playerInventoryDisplay.OnChangeCarryingStar(totalStars); 
            Destroy(hit.gameObject); 
         } 
   } 
} </pre>
<ol start="3">
<li>Change the contents of C# script class <kbd>PlayerInventoryDisplay</kbd> to contain the following:</li>
</ol>
<pre style="color: black;padding-left: 60px">using UnityEngine; 
using UnityEngine.UI; 

[RequireComponent(typeof(PlayerInventoryTotal))] 
public class PlayerInventoryDisplay : MonoBehaviour { 
   public Text starText; 
   public void OnChangeStarTotal(int numStars) { 
         string starMessage = "total stars = " + numStars; 
         starText.text = starMessage; 
   } 
}</pre>
<p style="color: black">As you can see, in <kbd>PlayerInventory</kbd> we now increment totalStars by 1 each time a star GameObject is collided with. In <kbd>PlayerInventoryDisplay</kbd> we display on screen a simple text message of "total stars = " followed by the integer total received by the method <kbd>OnChangeStarTotal(...)./</kbd></p>
<p style="color: black">Now when you run the game you should see the total stars start at zero, and increase by 1 each time the player's character hits a star.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Alternative – combining all the responsibilities into a single script</h1>
                
            
            
                
<p style="color: black">The separation of the player inventory (what they are carrying) and how to display the inventory to the user is an example of a game design pattern (best practice approach) called the <strong>Model-View-Controller</strong> (<strong>MVC</strong>) whereby we separate the code that updates the UI from the code that changes player and game variables such as score and inventory item lists. Although this recipe has only one variable and one method to update the UI, well-structured game architectures scale up to cope with more complex games, so it is often worth the effort of a little more code and an extra script class, even at this game's development, if we want our final game architecture to be well structured and maintainable.</p>
<p style="color: black">However, for <em>very simple games</em> we may choose to combine both status and display of that status in a single script class. For an example of this approach for this recipe, remove script components <kbd>PlayerInventory</kbd> and <kbd>PlayerInventoryDisplay</kbd> and create the following C# script class <kbd>PlayerInventoryCombined</kbd> and add an instance to GameObject <kbd>player-SpaceGirl</kbd> in the <strong>Hierarchy</strong>:</p>
<pre style="color: black">using UnityEngine.UI; 
public class PlayerInventoryCombined : MonoBehaviour { 
   public Text starText; 
   private bool carryingStar = false; 

   void Start() { 
         UpdateStarText(); 
   } 

   void OnTriggerEnter2D(Collider2D hit) { 
         if (hit.CompareTag("Star")){ 
               carryingStar = true; 
               UpdateStarText(); 
               Destroy(hit.gameObject); 
         } 
   } 

   private void UpdateStarText() { 
         string starMessage = "no star :-("; 
         if (carryingStar) 
            starMessage = "Carrying star :-)"; 
         starText.text = starMessage; 
   } 
} </pre>
<p>There is no difference in the experience of the player, and the change is simply in the architectural structure of our game code.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Displaying single object pickups with carrying and not-carrying icons</h1>
                
            
            
                
<p style="color: black">Graphic icons are an effective way to inform the player that they are carrying an item. In this recipe, if no star is being carried, a gray-filled icon in a blocked-off circle is displayed in the top-left of the screen:</p>
<div><img src="img/8325bea3-24c1-47ee-bf4c-acff231a4674.png"/></div>
<p style="color: black">Then, after a star has been picked up, a yellow-filled star icon is displayed. In many cases, icons are clearer (they don't require reading and thinking about) and can also be smaller onscreen than text messages that indicate player status and inventory items.</p>
<p style="color: black">This recipe also illustrates the benefits of the MVC design pattern described in the previous recipe – we are changing how to communicate to the user (using the <strong>View</strong> via icons rather than text), but we can use, with no changes required, script class PlayerInventory (the <strong>Model-Controller</strong>), which detects player-star collisions and maintains the Boolean flag that tells us whether a star is being carried or not.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p style="color: black">This recipe assumes that you are starting with the Simple2Dgame_SpaceGirl project set up in the first recipe in this chapter.</p>
<p style="color: black">For this recipe, we have prepared a folder named <kbd>_Scripts</kbd> in the <kbd>03_03</kbd> folder.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<p style="color: black">To toggle carrying and not-carrying icons for a single object pickup, follow these steps:</p>
<ol>
<li>Start with a new copy of the <kbd>Simple2Dgame_SpaceGirl</kbd> mini-game.</li>
<li>Import the <kbd>_Scripts</kbd> folder from the provided files (this contains a copy of the script class <kbd>PlayerInventory</kbd> from the previous recipe, which we can use unchanged for this recipe).</li>
<li>Add to the scene a <strong>UI Image</strong> object (<strong>Create</strong> | <strong>UI</strong> | <strong>Image</strong>). Rename it <kbd>Image-star-icon</kbd>.
<ul>
<li>With Image-star-icon selected in the <strong>Hierarchy</strong>, drag the <kbd>icon_nostar_100</kbd> sprite (in the <kbd>Sprites</kbd> folder) from the <strong>Project</strong> panel into the <strong>Source Image</strong> field in the <strong>Inspector</strong> (in the Image (Script) component).</li>
</ul>
</li>
<li>Click on the <strong>Set Native Size</strong> button for the <strong>Image</strong> component. This will resize the <strong>UI Image</strong> to fit the physical pixel width and height of the <kbd>icon_nostar_100</kbd> sprite file:</li>
</ol>
<div><img src="img/eb577c82-34fe-48a1-8ca4-bb647df529bb.png" style="width:38.25em;height:18.25em;"/></div>
<ol start="5">
<li>Position the image icon at the top and left of the Game panel, in Rect Transform. Choose the top-left box component while holding down <em>SHIFT</em> and <em>ALT</em> (to set pivot and position).</li>
<li>Create the following C# Script class PlayerInventoryDisplay and add an instance to GameObject player-SpaceGirl in the Hierarchy:</li>
</ol>
<pre style="color: black;padding-left: 60px">using UnityEngine; 
using UnityEngine.UI;

[RequireComponent(typeof(PlayerInventory))] 
public class PlayerInventoryDisplay : MonoBehaviour  { 
   public Image imageStarGO; 
   public Sprite iconNoStar; 
   public Sprite iconStar;

   public void OnChangeCarryingStar(bool carryingStar) { 
        if (carryingStar) 
            imageStarGO.sprite = iconStar; 
        else 
            imageStarGO.sprite = iconNoStar; 
    } 
} </pre>
<ol start="7">
<li>From the Hierarchy view, select the GameObject player-SpaceGirl. Then, from the Inspector, access the PlayerInventoryDisplay (Script) component and populate the Star Image public field with UI Image object Image-star-icon.</li>
<li>Populate the Icon No Star public field from the Project panel with the <kbd>icon_nostar_100</kbd> sprite, and then populate the Icon Star public field from the Project panel with the <kbd>icon_star_100</kbd> sprite, as shown in the screenshot:</li>
</ol>
<div><img src="img/60355ab6-8a60-44ee-be1f-69d1b0ed20d8.png"/></div>
<ol start="9">
<li>Play the scene. You should see the no star icon (a gray-filled icon in a blocked-off circle) in the top left until you pick up the star, at which point it will change to show the carrying star icon (yellow-filled star).</li>
</ol>


            

            
        
    

        

                            
                    <h1 class="header-title">How it works...</h1>
                
            
            
                
<p style="color: black">In the script class <kbd>PlayerInventoryDisplay</kbd> the Image variable <kbd>imageStarGO</kbd> is a reference to the UI Image object <kbd>Image-star-icon</kbd>. The sprite variables <kbd>iconStar</kbd> and <kbd>iconNoStar</kbd> are references to the Sprite files in the Project panel - the sprites to tell the player whether or not a star is being carried.</p>
<p style="color: black">Each time method <kbd>OnChangeCarryingStar(carryingStar)</kbd> is invoked by the <kbd>PlayerInventory</kbd> object, this method uses an <kbd>if</kbd> statement to set the <strong>UI Image</strong> to the sprite that corresponds to the value of the bool argument received.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Displaying multiple pickups of the same object with multiple status icons</h1>
                
            
            
                
<p style="color: black">If there is a small, fixed total number of an item to be collected rather than text totals, an effective UI approach is to display placeholder icons (empty or grayed out pictures) to show the user how many of the item remain to be collected, and each time an item is picked up, a placeholder icon is replaced by a full color collected icon.</p>
<p style="color: black">In this recipe, we use gray-filled star icons as the placeholders and yellow-filled star icons to indicate each collected star, as shown in the screenshot:</p>
<div><img src="img/458361ac-c050-4586-969e-e298a1fd8d5c.png" style="width:25.58em;height:7.50em;"/></div>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p style="color: black">This recipe assumes that you are starting with the <kbd>Simple2Dgame_SpaceGirl</kbd> project set up in the first recipe in this chapter.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<p style="color: black">To display multiple inventory icons for multiple pickups of same type of object, follow these steps:</p>
<ol>
<li>Start with a new copy of the <kbd>Simple2Dgame_SpaceGirl</kbd> mini-game.</li>
<li>Create C# Script class <kbd>PlayerInventory</kbd> in the <kbd>_Scripts</kbd> folder:</li>
</ol>
<pre style="color: black;padding-left: 60px">using UnityEngine; 

public class PlayerInventory : MonoBehaviour { 
   private PlayerInventoryDisplay playerInventoryDisplay; 
   private int totalStars = 0; 

   void Awake() { 
         playerInventoryDisplay = GetComponent&lt;PlayerInventoryDisplay&gt;(); 
   }  

   void Start() { 
        playerInventoryDisplay.OnChangeStarTotal(totalStars); 
   }  

   void OnTriggerEnter2D(Collider2D hit) { 
         if (hit.CompareTag("Star")) { 
            totalStars++; 
            playerInventoryDisplay.OnChangeCarryingStar(totalStars); 
            Destroy(hit.gameObject); 
         } 
   } 
} </pre>
<ol start="3">
<li>Select the GameObject star in the <strong>Hierarchy</strong> panel and make three more copies of this GameObject. There are now four star GameObjects in the scene. Move these new star GameObjects to different parts of the screen.</li>
<li>Add the following C# Script <kbd>PlayerInventoryDisplay</kbd> to the GameObject <kbd>player-SpaceGirl</kbd> in the <strong>Hierarchy</strong>:</li>
</ol>
<pre style="color: black;padding-left: 60px">using UnityEngine; 
using System.Collections; 
using UnityEngine.UI; 

public class PlayerInventoryDisplay : MonoBehaviour { 
    public Image[] starPlaceholders; 
    public Sprite iconStarYellow; 
    public Sprite iconStarGrey;

    public void OnChangeStarTotal(int starTotal){ 
       for (int i = 0;i &lt; starPlaceholders.Length; ++i){ 
          if (i &lt; starTotal) 
              starPlaceholders[i].sprite = iconStarYellow; 
          else 
             starPlaceholders[i].sprite = iconStarGrey; 
        } 
    } 
}</pre>
<ol start="5">
<li>Select the Canvas in the Hierarchy panel and add a new UI Image object (Create | UI | Image). Rename it Image-star0.</li>
<li>Select Image-star0 in the Hierarchy panel.</li>
<li>From the Project panel, drag the sprite <kbd>icon_star_grey_100</kbd> (in the Sprites folder) into the Source Image field in the Inspector for the Image (Script) component.</li>
<li>Click on the Set Native Size button for this for the Image (Script) component. This will resize the UI Image to fit the physical pixel width and height of sprite file <kbd>icon_star_grey_100</kbd>.</li>
<li>Now we will position our icon at the top-left of the Game panel. Edit the UI Image's Rect Transform component, and while holding down <em>Shift</em> + <em>Alt</em> (to set pivot and position), choose the top-left box. The UI Image should now be positioned at the top left of the Game panel.</li>
<li>Make three more copies of Image-star0 in the Hierarchy panel, naming them Image-star1, Image-star2, and Image-star3.</li>
<li>In the Inspector panel, change the Pos X position (in the Rect Transform component) of Image-star1 to <kbd>100</kbd>, of Image-star2 to <kbd>200</kbd>, and of Image-star3 to <kbd>300</kbd>:</li>
</ol>
<div><img src="img/1aae7d83-99c9-4d6b-81b8-8072835d454e.png"/></div>
<ol start="12">
<li>In the <strong>Hierarchy</strong>, select the GameObject player-SpaceGirl. Then, from the <strong>Inspector</strong>, access the <strong>Player Inventory Display</strong> (Script) component and set the Size property of the public field Star Placeholders to <kbd>4</kbd>.</li>
<li>Next, populate the Element 0/1/2/3 array values of public field <strong>Star Placeholders</strong> with <strong>UI Image</strong> objects Image-star0/1/2/3.</li>
</ol>
<ol start="14">
<li>Now, populate the Icon <strong>Star Yellow</strong> and <strong>Icon Star Grey</strong> public fields from the Project panel with sprite <kbd>icon_star_100</kbd> and <kbd>icon_star_grey_100</kbd>, as shown in the screenshot:</li>
</ol>
<div><img src="img/3265c7b4-d3d7-423f-b3c8-7db0511c8d5c.png" style="width:36.75em;height:26.58em;"/></div>
<ol start="15">
<li>Now, when you play the scene, you should see the sequence of four gray placeholder star icons initially, and each time you collide with a star, the next icon at the top should turn yellow.</li>
</ol>


            

            
        
    

        

                            
                    <h1 class="header-title">How it works...</h1>
                
            
            
                
<p style="color: black">Four <strong>UI Image</strong> objects Image-star0/1/2/3 have been created at the top of the screen — initialized with the gray placeholder icon. The gray and yellow icon sprite files have been resized to be 100 x 100 pixels, making their horizontal arrangement positioning at design time easier, since their positions are (0,0), (100,0), (200,0), and (300,0). In a more complicated game screen, or one where real estate is precious, the actual size of the icons would probably be smaller – a decision to be made by the game graphic designer.</p>
<p style="color: black">In script class <kbd>PlayerInventory</kbd>, the int variable <kbd>totalStars</kbd> represents how many stars have been collected so far; it is initialized to zero. The variable <kbd>playerInventoryDisplay</kbd> is a reference to the scripted component that manages our inventory display – this variable is cached before the scene begins in the <kbd>Awake()</kbd> method.</p>
<p style="color: black">The <kbd>Start()</kbd> method that runs at the beginning of the scene, calls the <kbd>OnChangeStarTotal(...)</kbd> method of the <kbd>PlayerInventoryDisplay</kbd> component to ensure that the icons on screen are displayed to match the starting value of totalStars.</p>
<p style="color: black">In the <kbd>OnTriggerEnter2D()</kbd> method, the totalStars counter is incremented by 1 each time the player's character hits an object tagged Star. As well as destroying the hit GameObject, the <kbd>OnChangeStarTotal(...)</kbd> method of the <kbd>PlayerInventoryDisplay</kbd> component is called, passing the new star total integer.</p>
<p style="color: black">The <kbd>OnChangeStarTotal(...)</kbd> method of script class <kbd>PlayerInventoryDisplay</kbd> has references to the four <strong>UI Images</strong>, and loops through each item in the array of Image references, setting the given number of images to yellow, and the remaining to gray. This method is public, allowing it to be called from an instance of script class <kbd>PlayerInventory</kbd>.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">There's more...</h1>
                
            
            
                
<p style="color: black">Here are some details you don't want to miss:</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Revealing icons for multiple object pickups by changing the size of a tiled image</h1>
                
            
            
                
<p style="color: black">Another approach that could be taken to show increasing numbers of images is to make use of tiled images. The same visual effect as in the previous recipe can also be achieved by making use of a tiled gray star image of width 400 (showing four copies of the gray star icon), behind a tiled yellow star image, whose width is 100 times the number of stars collected.</p>
<p style="color: black">If the yellow-starred image is less wide that the gray starred imaged beneath then we'll see gray stars for any remaining locations. For example, if we are carrying 3 stars, we'll make the width of the yellow-starred image 3 x 100 = 300 pixels wide. This will show 3 yellow stars and reveal 100 pixels, that is, 1 gray star, from the gray starred image beneath it.</p>
<p style="color: black">To display grey and yellow star icons for multiple object pickups using tiled images, let's adapt our recipe to illustrate this technique by following these steps:</p>
<ol>
<li>In the <strong>Hierarchy</strong> panel, delete the entire <strong>Canvas</strong> GameObject (and therefore delete all four <strong>UI Images</strong>).</li>
<li>Add to your scene a new <strong>UI Image</strong> object (<strong>Create</strong> | <strong>UI</strong> | <strong>Image</strong>). Rename the GameObject Image-stars-gray.</li>
<li>Ensure Image-stars-gray is selected in the <strong>Hierarchy</strong>. From the <strong>Project</strong> panel, drag sprite <kbd>icon_star_grey_100</kbd> (in the Sprites folder) into the <strong>Source Image</strong> field in the <strong>Inspector</strong> (in the <strong>Image (Script)</strong> component).</li>
<li>Click on the <strong>Set Native Size</strong> button for this for the Image (Script) component. This will resize the <strong>UI Image</strong> to fit the physical pixel width and height of sprite file <kbd>icon_star_grey_100</kbd>.</li>
<li>Now position the icon at the <strong>top</strong> and <strong>left</strong> of the screen. Edit the <strong>UI Image's</strong> <strong>Rect</strong> <strong>Transform</strong> component, and while holding down <em>Shift</em> + <em>Alt</em> (to set pivot and position), choose the top-left box. The UI Image should now be positioned at the top left of the <strong>Game</strong> panel.</li>
<li>In the Inspector panel, change the <strong>Width</strong> (in the Rect Transform component) of Image-stars-grey to <kbd>400</kbd>. Also, set the <strong>Image Type</strong> (in the <strong>Image (Script)</strong> component) to <strong>Tiled</strong>, as shown in the following screenshot:</li>
</ol>
<div><img src="img/6007c4cf-2c62-4bbc-824a-dcd34e83b481.png"/></div>
<p>For a simple game like this, we are choosing simplicity over memory efficiency. You'll see a notice suggesting using an advanced texture with Wrap mode repeat and a cleared packing tag. While more memory efficient, it's more complicated to do for small, simple tiling such as in this recipe.</p>
<ol start="7">
<li>Make a copy of Image-stars-grey in the <strong>Hierarchy</strong> panel, naming the copy <strong>Image-stars-yellow</strong>.</li>
<li>With Image-stars-yellow selected in Hierarchy panel, from the <strong>Project</strong> panel, drag the sprite <kbd>icon_star_100</kbd> (in the <kbd>Sprites</kbd> folder) into the <strong>Source Image</strong> field in the Inspector (in the <strong>Image (Script)</strong> component).</li>
<li>Set the width of Image-stars-yellow to 0 (in the <strong>Rect Transform</strong> component). So, now we have the yellow stars tiled image above the grey tiled image, but since its width is zero, we don't see any of the yellow stars yet.</li>
<li>Replace the existing C# script <kbd>PlayerInventoryDisplay</kbd> with the following code:</li>
</ol>
<pre style="color: black;padding-left: 60px">using UnityEngine; 
using UnityEngine.UI; 

[RequireComponent(typeof(PlayerInventory))] 
public class PlayerInventoryDisplay : MonoBehaviour { 
   public Image iconStarsYellow; 
<br/>   public void OnChangeStarTotal(int starTotal) { 
         float newWidth = 100 * starTotal; 
        iconStarsYellow.rectTransform.SetSizeWithCurrentAnchors( RectTransform.Axis.Horizontal, newWidth ); 
   } 
} </pre>
<ol start="11">
<li>From the <strong>Hierarchy</strong> view, select the GameObject player-SpaceGirl. Then, from the <strong>Inspector</strong>, access the <strong>Player Inventory Display</strong> <strong>(Script)</strong> component and populate the Icons Stars Yellow public field with UI Image object Image-stars-yellow.</li>
</ol>
<p style="color: black">UI Image Image-stars-gray is a tiled image, wide enough (<kbd>400px</kbd>) for the gray sprite <kbd>icon_star_grey_100</kbd> to be shown four times. UI Image Image-stars-yellow is a tiled image, above the grey one, initially with width set to zero, so no yellow stars can be seen.</p>
<p style="color: black">Each time a star is picked up, a call is made from the <kbd>PlayerInventory</kbd> scripted object to the <kbd>OnChangeStarTotal()</kbd> method of the script component <kbd>PlayerInventoryDisplay</kbd>, passing the new integer number of stars collected. By multiplying this by the width of the yellow sprite image (100 px), we get the correct width to set for <strong>UI Image</strong> Image-stars-yellow so that the corresponding number of yellow stars will now be seen by the user. Any stars that remain to be collected will still be seen as the grey stars that are not yet covered up.</p>
<p style="color: black">The actual task of changing the width of UI Image Image-stars-yellow is completed by calling the <kbd>SetSizeWithCurrentAnchors(...)</kbd> method. The first parameter is the axis, so we pass the constant <kbd>RectTransform.Axis.Horizontal</kbd> so that it will be the width that is changed. The second parameter is the new size for that axis, so we pass a value that is 100 times the number of stars collected so far (the variable <kbd>newWidth</kbd>).</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Using panels to visually outline the inventory UI area and individual items</h1>
                
            
            
                
<p style="color: black">We see four kinds of objects when playing a game:</p>
<ul>
<li>GameObjects that have some visual elements, such as 2D and 3D objects.</li>
<li>UI elements located in <strong>World Space</strong>, so they appear next to GameObjects in the scene.</li>
<li>UI elements located in <strong>Screen Space</strong> - <strong>Camera</strong>, so they appear at a fixed distance from the camera (but can be obscured by GameObjects closer to the camera than these UI elements).</li>
<li>UI elements located in <strong>Screen Space</strong> - <strong>Overlay</strong>. These always appear above the other three kinds of visual element, and are perfect for <strong>Head Up Display</strong> (<strong>HUD</strong>) elements, such as inventories.</li>
</ul>
<p style="color: black">Sometimes we want to visually make it clear which elements are part of the UI HUD and which are visual objects in the scene. Unity <strong>UI Panels</strong> with an opaque or translucent background image are a simple and effective way to achieve this.</p>
<div><img src="img/63f5bed4-4c57-4ebc-b0a7-e53313067b05.png" style="width:32.17em;height:11.25em;"/></div>
<p style="color: black">Panels can also be used to display locations (slots) with shaped or colored backgrounds indicating where items may be placed, or how many may be collected. As shown in the screenshot, in this recipe we'll create a panel with some title text, and three inventory slots, two of which will be filled with star icons, communicating to the player that there is one more star that could be collected/carried.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p style="color: black">This recipe assumes that you are starting with the <kbd>Simple2Dgame_SpaceGirl</kbd> project set up in the first recipe in this chapter. The font you need can be found in the <kbd>03_02</kbd> folder.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<p style="color: black">To use panels to visually outline the inventory area and individual items, follow these steps:</p>
<ol>
<li>Start with a new copy of the <kbd>Simple2Dgame_SpaceGirl</kbd> mini-game.</li>
<li>In the <strong>Hierarchy</strong> panel, create a <strong>UI Panel</strong> (<strong>Create</strong> | <strong>UI</strong> | <strong>Panel</strong>) and rename it Panel-background.</li>
<li>Let's now position Panel-background at the top of the Game panel, stretching the horizontal width of the canvas. Edit the UI <strong>Image's Rect Transform</strong> component, and while holding down <em>Shift</em> + <em>Alt</em> (to set pivot and position), choose the top-stretch box.</li>
</ol>
<ol start="4">
<li>The panel will still be taking up the whole game window. Now, in the <strong>Inspector</strong>, change the <strong>Height</strong> (in the <strong>Rect Transform</strong> component) of Panel-background to 100.</li>
<li>Add a UI Text object (<strong>Create</strong> | <strong>UI</strong> | <strong>Text</strong>), rename it <strong>Text-inventory</strong>. For its Text (Script) component, change the text to Inventory.</li>
<li>In the Hierarchy panel, child <strong>UI Text</strong> object <strong>Text-inventory</strong> to panel Panel-background.</li>
<li>In the <strong>Inspector panel</strong>, also set the font of Text-inventory to Xolonium-Bold (the Fonts folder). Center the text horizontally, for Alignment choose vertical center, set its <strong>Height</strong> to 50, and set the <strong>Font Size</strong> to 23.</li>
<li>Edit the <strong>Rect Transform</strong> of Text-inventory, and while holding down <em>Shift</em> + <em>Alt</em> (to set pivot and position), choose the top-stretch box. The text should now be positioned at the top-center of the UI Panel object Panel-background, and its width should stretch to match that of the whole panel.</li>
<li>The text should now be positioned at the top-center of the UI Panel object Panel-background and its width should stretch to match that of the whole panel.</li>
<li>Create a new UI Panel (<strong>Create</strong> | <strong>UI</strong> | <strong>Panel</strong>) and rename it Panel-inventory-slot.</li>
<li>Edit the Rect Transform of Panel-inventory-slot, and while holding down <em>Shift</em> + <em>Alt</em> (to set pivot and position), choose the top-center box. Set both the Width and Height to <kbd>70</kbd>, and the Pos Y to <kbd>-30</kbd>. See the following screenshot:</li>
</ol>
<div><img src="img/b23be950-c43f-4e56-bbab-fe05e6f2afaa.png"/></div>
<ol start="12">
<li>Ensure GameObject Panel-inventory-slot is selected in the Hierarchy. In the Image (Script) component change the Source Image from the <strong>UI Panel</strong> default of Background to the circular <strong>Knob</strong> image (this is one of the built-in images that come as part of the Unity UI system). As shown in the following screenshot, you should now see a circle centered below the title text in our inventory HUD rectangle. This circle visually tells the user that there is space in the inventory for an item to be collected:</li>
</ol>
<div><img src="img/5f4728fd-bf47-449b-8682-12ab388f57e3.png" style="width:34.33em;height:7.58em;"/></div>
<ol start="13">
<li>Imagine the player has collected a star. Let's now add (inside our inventory slot circle panel) a yellow star icon image. Add to the scene a UI Image object (<strong>Create</strong> | <strong>UI</strong> | <strong>Image</strong>). Rename it Image-icon. Child GameObject <strong>Image-icon</strong> to the panel Panel-inventory-slot.</li>
</ol>
<p>Child GameObjects can be hidden making the GameObject <strong>inactive</strong>. By creating a new <strong>UI Image</strong> GameObject for our star icon, and adding it as a child of our Panel-inventory-slot GameObject, we can now display the star icon when the <strong>Image</strong> is enabled and hide it by making it inactive. This is a general approach, which means as long as we have a reference to the <strong>Image</strong> GameObject, we don't have to do extra work swapping images as we had to do in some of the previous recipes. This means we can begin to write more general-purpose code that will work with different inventory panels for keys, stars, money, and so on.</p>
<ol start="14">
<li>With Image-icon selected in the <strong>Hierarchy</strong>, drag the sprite <kbd>icon_star_100</kbd> (in the <kbd>Sprites</kbd> folder) from the <strong>Project</strong> panel into the <strong>Source Image</strong> field in the Inspector (in the <strong>Image (Script</strong>) component).</li>
</ol>
<ol start="15">
<li>Edit the <strong>Rect Transform</strong> of Image-icon, and while holding down <em>Shift</em> + <em>Alt</em> (to set pivot and position), choose the stretch-stretch box. The star icon should now be stretched the perfect size to fit inside the <kbd>70x70</kbd> parent panel, so we see a star inside the circle.</li>
</ol>
<div><img src="img/f48f5552-6b5b-4003-9eee-087f33cab456.png" style="width:36.33em;height:13.50em;"/></div>
<ol start="16">
<li>Save and run the scene and play the game. You should see a clearly defined rectangle at the top of the screen, with the title text Inventory. Inside the inventory rectangular area you can see a circular slot, currently showing a star.</li>
<li>Let's display 3 slots to the player. First, change the Pos X horizontal position of panel Panel-inventory-slot to -70. This moves it left of center, making space for the next one, and allowing us to center the three slots when we've finished.</li>
<li>Duplicate panel Panel-inventory-slot, renaming (if necessary) the copy to panel Panel-inventory-slot (1). Set the Pos X of this copy to 0.</li>
<li>Duplicate panel Panel-inventory-slot again, renaming (if necessary) the copy to panel Panel-inventory-slot (2). Set the Pos X of this copy to 70. Now select the child Image-star-icon of this third panel and make it inactive (at the top of the <strong>Inspector</strong> uncheck its active checkbox, to the left of the GameObject name) . The star for this panel should now be hidden, and only the circle background of the slot's panel is visible.</li>
</ol>


            

            
        
    

        

                            
                    <h1 class="header-title">How it works...</h1>
                
            
            
                
<p style="color: black">We have created one simple panel (Panel-background) with title UI Text as a child GameObject at the top of the game canvas, which shows a grayish background rectangle and the title text Inventory. This indicates to the player that this part of the screen is where the inventory HUD will be displayed.</p>
<p style="color: black">To illustrate how this might be used to indicate a player carrying stars, we added a smaller panel for one slot in the inventory with a circular background image, and in that added a star icon a child GameObject. We then duplicated the slot panel two more times, positioning them 70 pixels apart. We then disabled (make inactive) the star icon of the third slot, so that the an empty slot circle is shown.</p>
<p style="color: black">Our scene presents to the user a display indicating two out of a possible three stars are being carried. This recipe is a good start for a more general-purpose approach to creating inventory UIs in Unity, and we'll build from it in some of the following recipes in this chapter.</p>
<p>We'll learn how to limit the player's movement to prevent their character moving into the rectangle of HUD items like this in <a href="eb0ea442-6350-4a86-9e16-708b80d8762f.xhtml" target="_blank"/><a href="eb0ea442-6350-4a86-9e16-708b80d8762f.xhtml">Chapter 12</a>, Controlling and Choosing Positions.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Creating a C# inventory slot UI display scripted component</h1>
                
            
            
                
<p style="color: black">In the previous recipe, we started to work with UI panels and images to create a more general-purpose GameObject for displaying inventory slots, and images to indicate what is stored in them. In this recipe, we look at taking things a little further with the graphics, and also create a C# script class to work with each inventory slot object.</p>
<div><img src="img/459b3abb-fd0c-4247-8bc3-772238db3426.png" style="width:39.83em;height:14.83em;"/></div>
<p style="color: black">As we can see in the screenshot, in this recipe we'll create the UI (and scripts) for an inventory that has three locations for stars, and three more for keys, using colored and gray icons to indicate how many have been collected.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p style="color: black">This recipe adapts the previous one. So, make a copy of the project for the previous recipe and work on this copy.</p>
<p style="color: black">For this recipe, we have prepared a folder named <kbd>_Scripts</kbd> in the <kbd>03_06</kbd> folder.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<p style="color: black">To create a C# inventory slot display script component, follow these steps:</p>
<ol>
<li>Import the <kbd>_Scripts</kbd> folder from the provided files (this contains a copy of the script class <kbd>PlayerInventory</kbd> from one of the previous recipes, which we can use unchanged for this recipe).</li>
<li>Delete two of the three inventory slot GameObjects: Panel-inventory-slot (1) and (2). So, only Panel-inventory-slot remains.</li>
<li>First we'll create a panel for three star slots. In the <strong>Hierarchy</strong> panel, create a UI Panel (<strong>Create</strong> | <strong>UI</strong> | <strong>Panel</strong>) and rename it Panel-stars.</li>
<li>We'll now position Panel-stars at the top-left of the <strong>Game</strong> panel, and make it fit within the left side of our general inventory rectangle. Edit the UI <strong>Image's Rect Transform</strong> component, and while holding down <em>SHIFT</em> and <em>ALT</em> (to set pivot and position), choose the top-left box. Now set the Height to 60 and the Width to 300. We'll now nudge this away from the top-left corner by setting Pos X to 10 and Pos Y to -30.</li>
<li>Add a <strong>UI Text</strong> object (<strong>Create</strong> | <strong>UI</strong> | <strong>Text</strong>) and rename it Text-title. For its <strong>Text</strong> <strong>(Script)</strong> component, change the text to Stars. Child this UI Text object to the panel Panel-stars.</li>
<li>Edit the <strong>Rect Transform</strong> of Text-title, and while holding down <em>Shift</em> + <em>Alt</em> (to set pivot and position), choose the left-middle box. The text should now be positioned at the left-middle of the <strong>UI Panel</strong> object Panel-stars.</li>
<li>In the <strong>Inspector</strong> panel, also set the font of Text-title to <strong>Xolonium-Bold</strong> (the <kbd>Fonts</kbd> folder). Center the text horizontally, center-align the text vertically, set its <strong>Height</strong> to <kbd>50</kbd>, and set the <strong>Font Size</strong> to <kbd>32</kbd>. Choose a yellow text color. Set <strong>Vertical-overflow</strong> to Overflow, and set <strong>Alignment</strong> vertical to center. We'll now nudge this away from the very left edge by setting Pos X to 10.</li>
<li>Child the existing GameObject Panel-inventory-slot to Panel-stars. Edit its <strong>Rect Transform</strong>, and while holding down <em>Shift</em> + <em>Alt</em> (to set pivot and position), choose the left-middle box.</li>
</ol>
<ol start="9">
<li>Resize Panel-inventory-slot to Width and Height <kbd>50 x 50</kbd> pixels. Set its Pos X to 140. It should now appear to the right of the yellow Stars text:</li>
</ol>
<div><img src="img/771c225c-f450-410d-9ca0-69e8e0bbb1d6.png"/></div>
<ol start="10">
<li>Rename GameObject Image-icon as Image-icon-grey. Then duplicate this GameObject, naming the copy Image-icon-color. Both should be child GameObjects of Panel-inventory-slot. In the Hierarchy the sequence should be that the first child is Image-icon-grey and the second child is Image-icon-color. If this isn't the order, then swap them.</li>
<li>Select Image-icon-grey, and drag the sprite <kbd>icon_star_grey_100</kbd> (in the <kbd>Sprites</kbd> folder) from the <strong>Project</strong> panel into the <strong>Source Image</strong> field in the <strong>Inspector</strong> (in the <strong>Image (Script)</strong> component). Now, if you disable GameObject <strong>Image-icon-color</strong> you should see the grey star icon inside the slot panel circle.</li>
<li>Create the following C# Script <kbd>PickupUI</kbd> (in the <kbd>_Scripts</kbd> folder) and add an instance as a component to GameObject of Panel-inventory-slot in the <strong>Hierarchy</strong>:</li>
</ol>
<pre style="color: black;padding-left: 60px">using UnityEngine; 
using System.Collections; 

public class PickupUI : MonoBehaviour { 
   public GameObject iconColor; 
   public GameObject iconGrey; 
<br/>   void Awake() { 
         DisplayEmpty(); 
   }  
<br/>   public void DisplayColorIcon() { 
         iconColor.SetActive(true); 
         iconGrey.SetActive(false); 
   }  

   public void DisplayGreyIcon() { 
         iconColor.SetActive(false); 
         iconGrey.SetActive(true); 
   } 

   public void DisplayEmpty() { 
         iconColor.SetActive(false); 
         iconGrey.SetActive(false); 
   } 
} </pre>
<ol start="13">
<li>Select Panel-inventory-slot in the <strong>Hierarchy</strong>. In the Inspector, for the Pickup UI (Script) component, populate the <strong>Icon Color</strong> public field by dragging Image-icon-color from the Hierarchy. Likewise, populate the Icon Grey public field by dragging Image-icon-grey from the Hierarchy. Now the scripted component <strong>PickupUI</strong> in Panel-inventory-slot has references to the colored and grey icons for this inventory slot GameObject.</li>
<li>Duplicate GameObject Panel-inventory-slot and for the new duplicate GameObject set its Pos X to 190.</li>
<li>Duplicate GameObject Panel-inventory-slot second time and for the new duplicate GameObject, set its Pos X to 240. You should now see all three star inventory icons lined up nicely spaced to the right of the yellow Stars title text:</li>
</ol>
<div><img src="img/09799173-3394-4936-9deb-7fa15d9db835.png"/></div>
<ol start="16">
<li>Add the following C# Script PlayerInventoryDisplay to the GameObject player-SpaceGirl in the <strong>Hierarchy</strong>:</li>
</ol>
<pre style="color: black;padding-left: 60px">using UnityEngine; 
using System.Collections; 
using UnityEngine.UI; 

[RequireComponent(typeof(PlayerInventory))] 
public class PlayerInventoryDisplay : MonoBehaviour  { 
   public PickupUI[] slots = new PickupUI[1]; <br/>   public void OnChangeStarTotal(int starTotal) { 
       int numInventorySlots = slots.Length; 
       for(int i = 0; i &lt; numInventorySlots; i++){ 
             PickupUI slot = slots[i]; 
             if(i &lt; starTotal) 
                   slot.DisplayColorIcon(); 
             else 
                   slot.DisplayGreyIcon(); 
       } 
   } 
} </pre>
<ol start="17">
<li>From the <strong>Hierarchy</strong>, select the GameObject player-SpaceGirl. Then do the following in the <strong>Inspector</strong> for the <strong>Player Inventory Display (Script)</strong> component:
<ul>
<li>Set the Size of public array slots to 3.</li>
<li>Populate the <strong>Element</strong> <strong>0</strong> public field with the GameObject Panel-inventory-slot.</li>
<li>Populate the <strong>Element 1</strong> public field with the GameObject Panel-inventory-slot (1).</li>
<li>Populate the <strong>Element 2</strong> public field with the GameObject Panel-inventory-slot (2):</li>
</ul>
</li>
</ol>
<div><img src="img/a27617fe-ad95-4be5-a3cb-da340e4b4b39.png"/></div>
<ol start="18">
<li>Finally, make two more copies of GameObject star in the scene and move them around. So, there are now three GameObjects tagged Star for the player to collect.</li>
<li>When you run the game and the player's character hits each star GameObject, it should be removed from the scene, and the next free inventory star icon should change from grey to yellow.</li>
</ol>


            

            
        
    

        

                            
                    <h1 class="header-title">How it works...</h1>
                
            
            
                
<p>We have created a panel (Panel-stars) in which to display the large title text Stars and three inventory slot panels to show how many stars can be collected, and how many have been collected at any point in the game. Each star panel-slot is a <strong>UI Panel</strong> with a circular Knob background image, and then two children, one showing a grey icon image and a second showing a colored icon image. When the colored icon image GameObject is disabled it will be hidden, and so reveal the grey icon. When both colored and grey images are disabled, then an empty circle will be shown, which could, perhaps, be used to indicate to the user that a general-purpose location is empty and available in the inventory.</p>
<p>The script class <kbd>PickupUI</kbd> has two public variables that are references to the grey and colored icon for the GameObject it relates to. Before the scene starts (method <kbd>Awake()</kbd>), the script hides the grey and colored icons and displays an empty circle. This script class declares three public methods (public so that they can be invoked from another scripted object when the game is running). These methods hide/reveal the appropriate icons to display the related inventory panel UI object as either empty, grey, or colored. The methods are clearly named <kbd>DisplayEmpty()</kbd>, <kbd>DisplayGreyIcon(</kbd>), and <kbd>DisplayColorIcon()</kbd>.</p>
<p>The script class <kbd>PlayerInventory</kbd> maintains an integer total <kbd>starTotal</kbd> of how many stars have been collected (initialized to zero). Each time the player character collides with an object, then if that object is tagged Star, the method <kbd>AddStar()</kbd> is invoked. This method increments the total and sends a message passing the new total to method <kbd>OnChangeStarTotal(...)</kbd> of its sibling scripted component <kbd>PlayerInventoryDisplay</kbd> .</p>
<p>The script-class <kbd>PlayerInventoryDisplay</kbd> has a public array of references to PickupUI objects, and the single public method <kbd>OnChangeStarTotal(...)</kbd>. This method loops through its array of PickupUI scripted objects, setting them to display color icons while the loop counter is less than the number of stars carried, and thereafter setting them to display grey icons. This results in the color icons being displayed to match the number of stars being carried.</p>
<p>Note: It might seem that we could make our code simpler by assuming that slots are always displaying grey (no star) and just changing one slot to yellow each time a yellow star is picked up. But this would lead to problems if something happens in the game (for example, hitting a black hole or being shot by an alien) that makes us drop one or more stars. The C# script class PlayerInventoryDisplay makes no assumptions about which slots may or may not have been displayed grey or yellow or empty previously. Each time it is called, it ensures that an appropriate number of yellow stars are displayed, and all other slots are displayed with grey stars.</p>
<p>The UI Panel GameObjects slots for the three stars have a PickupUI scripted component added, and each is linked to its grey and colored icons.</p>
<p>Several star GameObjects are added to the scene (all tagged Star). The array of PickupUI object references in the <kbd>PlayerInventoryDisplay</kbd> scripted component in GameObject player-SpaceGirl is populated with references to the PickupUI scripted components in the three the UI Panels for each star.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">There's more...</h1>
                
            
            
                
<p>Here are some details you won't want to miss.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Modifying the game for a second inventory panel for keys</h1>
                
            
            
                
<p>We have created a great display panel for the collection of star objects. Now we can reuse that work, to create a second panel to display the collection of key objects in the game.</p>
<p>To modify the game to make a second inventory panel for key collection, do the following:</p>
<ol>
<li>Duplicate GameObject Panel-stars, naming the copy Panel-keys.</li>
<li>With Panel-keys selected in the Hierarchy, do the following:
<ul>
<li>Change the <strong>Text (Script)</strong> of child <strong>Text-title</strong> from Stars to Keys.</li>
<li>In the <strong>Rect Transform</strong>, choose top-right, set Pos X to -10 (to move away from the right edge) and Pos Y to -30 (to vertically align with Panel-keys).</li>
<li>For each Image-icon-grey GameObject that is a child of all three panel-inventory-slots, change the <strong>Image (Script)</strong> Source Image to: icon_key_grey_100.</li>
<li>For each Image-icon-color GameObject that is a child of all three panel-inventory-slots, change the <strong>Image (Script)</strong> Source Image to: icon_key_green_100.</li>
<li>For all of the <strong>Image-icon-grey</strong> GameObjects and the Image-icon-color GameObjects that are children of all three panel-inventory-slots, in the <strong>Rect Transform</strong> set the Scale to (0.75, 0.75, 1). This is to make the key images fit fully inside the background panel circle images.</li>
</ul>
</li>
<li>Remove from GameObject player-SpaceGirl script components: PlayerInventory and PlayerInventoryDisplay.</li>
<li>Create the following C# Script PlayerInventoryKeys in the <kbd>_Scripts</kbd> folder:</li>
</ol>
<pre style="padding-left: 60px">using UnityEngine; 

public class PlayerInventoryKeys : MonoBehaviour { 
   private int starTotal = 0; 
   private int keyTotal = 0; 
   private PlayerInventoryDisplayKeys playerInventoryDisplay; 

   void Awake() { 
         playerInventoryDisplay = GetComponent&lt;PlayerInventoryDisplayKeys&gt;(); 
   } 

   void Start() { 
         playerInventoryDisplay.OnChangeStarTotal(starTotal); 
         playerInventoryDisplay.OnChangeKeyTotal(keyTotal); 
   } 

   void OnTriggerEnter2D(Collider2D hit) { 
         if(hit.CompareTag("Star")){ 
               AddStar(); 
               Destroy(hit.gameObject); 
         } 
 
         if(hit.CompareTag("Key")){ 
               AddKey(); 
               Destroy(hit.gameObject); 
         } 
   } 

   private void AddStar() { 
         starTotal++; 
         playerInventoryDisplay.OnChangeStarTotal(starTotal); 
   } 

   private void AddKey() { 
         keyTotal++; 
         playerInventoryDisplay.OnChangeKeyTotal(keyTotal); 
   } 
} </pre>
<ol start="5">
<li>Add the following C# script <kbd>PlayerInventoryDisplayKeys</kbd> to GameObject player-SpaceGirl in the <strong>Hierarchy</strong>:</li>
</ol>
<pre style="padding-left: 60px">using UnityEngine; 

[RequireComponent(typeof(PlayerInventoryKeys))] 
public class PlayerInventoryDisplayKeys : MonoBehaviour  { 
   public PickupUI[] slotsStars = new PickupUI[1]; 
   public PickupUI[] slotsKeys = new PickupUI[1]; 

   public void OnChangeStarTotal(int starTotal) { 
         int numInventorySlots = slotsStars.Length; 
         for(int i = 0; i &lt; numInventorySlots; i++){ 
               PickupUI slot = slotsStars[i]; 
               if(i &lt; starTotal) 
                     slot.DisplayColorIcon(); 
               else 
                     slot.DisplayGreyIcon(); 
         } 
   } 

   public void OnChangeKeyTotal(int keyTotal) { 
         int numInventorySlots = slotsKeys.Length; 
         for(int i = 0; i &lt; numInventorySlots; i++){ 
               PickupUI slot = slotsKeys[i]; 
               if(i &lt; keyTotal) 
                     slot.DisplayColorIcon(); 
               else 
                     slot.DisplayGreyIcon(); 
         } 
   } 
}</pre>
<ol start="6">
<li>With the GameObject player-SpaceGirl selected in the <strong>Hierarchy</strong>, for its PlayerInventoryDisplayKeys scripted component, set both slotsKeys and slotsStars to 3 (making the size of each of these arrays 3). Then drag the corresponding inventory-slot GameObjects from the Hierarchy to populate these arrays.</li>
<li>Create a new GameObject key by dragging a copy of the sprite image icon-key-green-100 from the <strong>Project</strong> panel into the scene. Then add a <strong>Box Collider</strong> component (<strong>Physics 2D</strong>) and tick its Is Trigger setting. In its <strong>Sprite Renderer</strong> component, set the Sorting Layer to Foreground. Create a new <strong>Tag</strong>: Key, and add this tag to this GameObject.</li>
<li>Make two duplicates of GameObject key, moving them to different locations in the scene (so the player can see all three stars and all three keys).</li>
</ol>
<p>As you can see, we have duplicated and adjusted the visual UI Panel and components of for star carrying inventory to give us a second one for key carrying inventory. Likewise, we have added code to detect collisions with objects tagged Key, and added to the inventory display script to update the UI Panel for keys when notified that a change has occurred in the number of keys being carried.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Using UI Grid Layout Groups to automatically populate a panel</h1>
                
            
            
                
<p>The recipes in this chapter up to this point have been hand-crafted for each situation. While this is fine, more general and automated approaches to inventory UIs can sometimes save time and effort but still achieve visual and usability results of equal quality.</p>
<p>There can be a lot of dragging slots from the <strong>Hierarchy</strong> panel into arrays, such as in the previous recipe for the scripted component <kbd>PlayerInventoryDisplay</kbd>. This takes a bit of work (and mistakes might be made when dragging items in the wrong order or the same item twice). Also, if we change the number of slots, then we may have to do this all over again or try to remember to drag more slots if we increase the number. A better way of doing things is to make the first task of the script class <kbd>PlayerInventoryDisplay</kbd> when the scene begins to create at <strong>Run-Time</strong> as many as required of the panels for grey-color star (or key or whatever) icon GameObjects as children of Panel-slot-grid, and then populate the array of the display scripted component at the same time.</p>
<div><img src="img/a6686d9a-4236-4253-9ef5-006f2b585f64.png" style="width:18.92em;height:4.25em;"/></div>
<div><p>In this recipe, we will begin to explore a more engineered approach to inventory UIs by exploiting the automated sizing and layouts offered by Unity's Grid Layout Group component. Some enhancements at the end of this recipe include adding an interactive scrollbar, as show in the screenshot.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>This recipe adapts the previous one. So, make a copy of the project for the previous recipe, and work on this copy.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<p>To automatically populate a panel using UI Grid Layout Groups to follow these steps:</p>
<ol>
<li>Create a new folder named Prefabs. In this folder, create a new empty prefab named panel-inventory-slot.</li>
<li>From the <strong>Hierarchy</strong> panel, drag the GameObject Panel-inventory-slot into your new empty prefab named panel-inventory-slot. This prefab should now turn blue, showing it is populated.</li>
<li>In the <strong>Hierarchy</strong> panel, delete the three GameObjects Panel-inventory-slot / (1) / (2).</li>
<li>Un-child Text-title from Panel-stars. Set the Pos-X position of <strong>Panel-stars</strong>. To 130 - so that the panel is now to the right of the text Stars.</li>
</ol>
<ol start="5">
<li>With the panel Panel-stars selected in the Hierarchy panel, add a grid layout group component (<strong>Add Component</strong> | <strong>Layout</strong> | <strong>Grid Layout Group</strong>). Set <strong>Cell Size</strong> to <kbd>50 x 50</kbd> and Spacing to <kbd>5 x 5</kbd>. Also, set the <strong>Child Alignment</strong> to Middle Center (so our icons will have even spacing at the far left and right), as shown in the following screenshot:</li>
</ol>
<div><img src="img/2e21a36d-acf0-42c1-b3e4-ddd7eddde586.png"/></div>
<ol start="6">
<li>Replace the C# script <kbd>PlayerInventoryDisplay</kbd> in GameObject player-SpaceGirl with the following code:</li>
</ol>
<pre style="padding-left: 60px">using UnityEngine; 
using System.Collections; 
using UnityEngine.UI; 

[RequireComponent(typeof(PlayerInventory))] 
public class PlayerInventoryDisplay : MonoBehaviour  { 
   const int NUM_INVENTORY_SLOTS = 5; 
   public GameObject panelSlotGrid; 
   public GameObject starSlotPrefab; 
   private PickupUI[] slots = new PickupUI[NUM_INVENTORY_SLOTS]; 

   void Awake() {
         float width = 50 + (NUM_INVENTORY_SLOTS * 50); 
         panelSlotGrid.GetComponent&lt;RectTransform&gt;().SetSizeWithCurrentAnchors( RectTransform.Axis.Horizontal, width ); 
 
         for(int i=0; i &lt; NUM_INVENTORY_SLOTS; i++){ 
               GameObject starSlotGO = (GameObject) 
               Instantiate(starSlotPrefab); 
               starSlotGO.transform.SetParent(panelSlotGrid.transform); 
               starSlotGO.transform.localScale = new Vector3(1,1,1); 
               slots[i] = starSlotGO.GetComponent&lt;PickupUI&gt;(); 
         } 
   } 

   public void OnChangeStarTotal(int starTotal) { 
         for(int i = 0; i &lt; NUM_INVENTORY_SLOTS; i++){ 
               PickupUI slot = slots[i]; 
               if(i &lt; starTotal) 
                     slot.DisplayColorIcon(); 
               else 
                     slot.DisplayGreyIcon(); 
         } 
   } 
} </pre>
<ol start="7">
<li>Ensure GameObject <strong>player-girl1 </strong>is selected in the <strong>Hierarchy.</strong> Then drag from the <strong>Project</strong> panel GameObject <strong>Panel-stars</strong> into the <strong>Player Inventory Display (Script)</strong> variable <strong>Panel-slot-grid</strong>, in the <strong>Inspector</strong>.</li>
<li>With GameObject player-girl1 selected in the <strong>Hierarchy</strong>, drag from the <strong>Project</strong> panel prefab panel-inventory-slot into <strong>Player Inventory Display (Script)</strong> the variable Star Slot Prefab, in the Inspector. Steps 7 and 8 are illustrated in this screenshot:</li>
</ol>
<div><img src="img/b8eacab9-2256-4253-86be-776158d1e19b.png" style="width:38.92em;height:22.33em;"/></div>
<ol start="9">
<li>Edit the script class <kbd>PlayerInventoryDisplay</kbd> to set the constant <kbd>NUM_INVENTORY_SLOTS</kbd> to have 10 or 15 slots. So some can only be seen when using the horizontal scroll bar.</li>
<li>Save the scene and play the game. As you pick up stars, you should see more of the grey stars change to yellow in the inventory display.</li>
</ol>


            

            
        
    

        

                            
                    <h1 class="header-title">How it works...</h1>
                
            
            
                
<p>We took one of the panels that contained the Knob circle background, and children GameObjects of grey and colored star images, and used it to create a <strong>Prefab</strong> panel-inventory-slot. We then removed the star panel GameObjects from the scene since our script class PlayerInventoryDisplay will create as many of these as needed when the scene begins. This approach saves a lot of drag and dropping, saving <strong>Design-Time</strong> effort, and eliminating one possible source of sequence/object reference errors when the design of a scene is changed.</p>
<p>The C# script class <kbd>PlayerInventoryDisplay</kbd> has two properties:</p>
<ul>
<li>A constant integer (<kbd>NUM_INVENTORY_SLOTS</kbd>) defining the number of slots in our inventory, which for this game we set to 5.</li>
<li>A <kbd>(slots)</kbd> array of references to <kbd>PickupUI</kbd> scripted components. Each of these will become a reference to the scripted component in each of the five <kbd>Panel-inventory-slot</kbd> GameObjects in our <kbd>Panel-stars</kbd>.</li>
</ul>
<p>The <kbd>Awake()</kbd> method is used to create instances of the prefab in <kbd>PlayerInventoryDispay</kbd> so that we know this will be executed before the <kbd>Start()</kbd> method in <kbd>PlayerInventory</kbd> since no <kbd>Start()</kbd> method is executed in a scene until all <kbd>Awake()</kbd> methods for all GameObjects in the scene have been completed. The <kbd>Awake()</kbd> method first calculates the width of the Panel-stars (50 + (50 * number of inventory slots)). Next, the panel is resized to have that width, using the <kbd>SetSizeWithCurrentAnchors()</kbd> method. Then a loop runs for the number of slots in the inventory, each time creating a new star slot GameObject from the prefab, childing the new GameObject to Panel-stars, and adding a reference to the icon slot GameObject in array slots. When the <kbd>OnChangeStarTotal(...)</kbd> method is passed the number of stars we are carrying, it loops through each of the five slots. While the current slot is less than our star total, a yellow star is displayed by the calling of the <kbd>DisplayYellow()</kbd> method of the current slot (PickupUI scripted component). Once the loop counter is equal to or larger than our star total, then all remaining slots are made to display a grey star via the method <kbd>DisplayGrey()</kbd>.</p>
<p>Our player character GameObject, player-girl1, has a very simple basic <kbd>PlayerInventory</kbd> script. This just detects collisions with objects tagged Star, and when this happens, it removes the star GameObject collided with and calls its <kbd>AddStar()</kbd> method of its <kbd>playerInventoryMode</kbd>l scripted component. Each time the <kbd>AddStar()</kbd> method is called, it increments (adds 1) to the total umber of stars being carried, and then calls the <kbd>OnChangeStarTotal(...)</kbd> method of the scripted component <kbd>playerInventoryDisplay</kbd>. Also, when the scene starts, an initial call is made to the <kbd>OnChangeStarTotal(...)</kbd> method so that the UI display for the inventory is set up to show that we are initially carrying no stars.</p>
<p>The public array has been made private and no longer needs to be populated through manual drag-and-drop. When you run the game, it will play just the same as before, with the population of the array of images in our inventory grid panel now automated. The <kbd>Awake()</kbd> method creates new instances of the prefab (as many as defined by constant <kbd>NUM_INVENTORY_SLOTS</kbd>) and immediately childed them to Panel-slot-grid. Since we have a grid layout group component, their placement is automatically neat and tidy in our panel.</p>
<p>The scale property of the transform component of GameObjects is reset when a GameObject changes its parent (to keep the child size to relative to the parent size). So, it is a good idea to always reset the local scale of GameObjects to (1,1,1) immediately after they have been childed to another GameObject. We do this in the for loop of starSlotGO immediately following the <kbd>SetParent(...)</kbd> statement.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">There's more...</h1>
                
            
            
                
<p>Here are some details you won't want to miss.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Automatically infer number of inventory slots based on number of GameObjects tagged Star</h1>
                
            
            
                
<p>Rather than having to manually change Integer constant <kbd>NUM_INVENTORY_SLOTS</kbd> in the script class PlayerInventoryDisplay to match the number of GameObjects created in the scene for the player to collect, let's have our script count how many GameObjects are tagged Star, and use this to size and populate our array of references to inventory UI panel slots.</p>
<p>We just need to change from a constant to a variable for our array size, and set that variable before anything else in our <kbd>Awake()</kbd> method. The statement <kbd>GameObject.FindGameObjectsWithTag("Star")</kbd> gets an array of references to all GameObjects with tag Star, and its length is the array size we want:</p>
<p> </p>
<ol>
<li>Replace the C# Script <kbd>PlayerInventoryDisplay</kbd> in the GameObject player-SpaceGirl with the following code:</li>
</ol>
<pre style="padding-left: 60px">using UnityEngine; 
using System.Collections; 
using UnityEngine.UI; 

[RequireComponent(typeof(PlayerInventory))] 
public class PlayerInventoryDisplay : MonoBehaviour  { 
   private int numInventorySlots; 
   private PickupUI[] slots; 
   public GameObject panelSlotGrid; 
   public GameObject starSlotPrefab; 

   void Awake() { 
         GameObject[] gameObjectsTaggedStar = GameObject.FindGameObjectsWithTag("Star"); 
         numInventorySlots = gameObjectsTaggedStar.Length; 
         slots = new PickupUI[numInventorySlots]; 
         float width = 50 + (numInventorySlots * 50); 
         panelSlotGrid.GetComponent&lt;RectTransform&gt;().SetSizeWithCurrentAnchors( RectTransform.Axis.Horizontal, width);  

         for(int i=0; i &lt; numInventorySlots; i++){ 
               GameObject starSlotGO = (GameObject) 
               Instantiate(starSlotPrefab); 
               starSlotGO.transform.SetParent(panelSlotGrid.transform); 
               starSlotGO.transform.localScale = new Vector3(1,1,1); 
               slots[i] = starSlotGO.GetComponent&lt;PickupUI&gt;(); 
         } 
   } 

   public void OnChangeStarTotal(int starTotal) { 
         for(int i = 0; i &lt; numInventorySlots; i++){ 
               PickupUI slot = slots[i]; 
               if(i &lt; starTotal) 
                     slot.DisplayColorIcon(); 
               else 
                     slot.DisplayGreyIcon(); 
         } 
   } 
} </pre>
<ol start="2">
<li>Add or remove some of the duplicates of GameObject star so the total is no longer 5.</li>
<li>Run the scene. You should see the size and contents of Panel-star change to match the number of GameObjects tagged Star when the scene begins.</li>
</ol>


            

            
        
    

        

                            
                    <h1 class="header-title">Add a horizontal scrollbar to the inventory slot display</h1>
                
            
            
                
<p>How could we cope with many inventory slots, more than fit in the space provided? One solution is to add a scroll bar so that the user can scroll left and right, viewing five at a time, say, as shown in the following screenshot.</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/bd08f7cb-d510-4704-a666-ae4c35851bf4.png"/></p>
<p>Let's add a horizontal scroll bar to our game. This can be achieved without any C# code changes, all through the Unity 5 UI system.</p>
<p>To implement a horizontal scrollbar for our inventory display, we need to do the following:</p>
<ol>
<li>Increase the height of Panel-background to 110 pixels.</li>
<li>In the <strong>Inspector p</strong>anel, set the <strong>Child Alignment</strong> property of component <strong>Grid Layout</strong> <strong>Group (Script)</strong> of <kbd>Panel-slot-grid</kbd> to Upper Left. Then, move this panel to the right a little so that the inventory icons are centered on screen.</li>
<li>Add a <strong>UI Panel</strong> to the <strong>Canvas</strong> and name it <kbd>Panel-scroll-container</kbd>, and tint it red by setting the Color property of its <strong>Image (Script)</strong> component to red.</li>
<li>In the <strong>Hierarchy</strong> panel, drag <kbd>Panel-slot-grid</kbd> so that it is now childed to <kbd>Panel-scroll-container</kbd>.</li>
</ol>
<ol start="5">
<li>Size and position Panel-scroll-container so that it is just behind our Panel-slot-grid. Set its <strong>Rect Transform</strong> to top-left, <strong>Pos X</strong> to 130, <strong>Pos Y</strong> to -30, <strong>Width</strong> to 300 and <strong>Height</strong> to 60. So, you should now see a red rectangle behind the <kbd>Panel-slot-grid</kbd> inventory panel.</li>
<li>Add a <strong>UI Mask</strong> to <kbd>Panel-scroll-container</kbd> so now you should only be able to see the parts of <kbd>Panel-slot-grid</kbd> that fit within the rectangle of this red-tinted panel.</li>
</ol>
<p>One workflow is to to temporarily set this mask component as inactive so that you can see and work on the unseen parts of Panel-slot-grid if required.</p>
<ol start="7">
<li>Add a <strong>UI Scrollbar</strong> to the <strong>Canvas</strong> and name it Scrollbar-horizontal. Move it to be just below the red-tinted <kbd>Panel-scroll-container</kbd>, and resize it to be the same width as shown in the following screenshot:</li>
</ol>
<div><img src="img/182db6c2-84fe-4f49-8d34-059a66ab1206.png"/></div>
<ol start="8">
<li>Add a UI <strong>Scroll Rect</strong> component to Panel-scroll-container. Uncheck the <strong>Vertical</strong> property of this <strong>Scroll Rect</strong> component.</li>
<li>In the <strong>Inspector</strong> panel, drag Scrolbar-horizontal to the Horizontal Scrollbar property of the Scroll Rect component of Panel-scroll-container.</li>
</ol>
<ol start="10">
<li>In the <strong>Inspector</strong> panel, drag Panel-slot-grid to the <strong>Content</strong> property of the <strong>Scroll Rect</strong> component of Panel-scroll-container, as shown in the following screenshot:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="img/0933e74d-c4e7-4adc-8fc0-3c74e413459d.png"/></p>
<ol start="11">
<li>Now, ensure the mask component of Panel-scroll-container is set as active so that we don't see the overflow of Panel-slot-grid and uncheck this mask components option to <strong>Show Mask Graphic</strong> (so that we don't see the red rectangle any more).</li>
</ol>
<p>You should now have a working scrollable inventory system.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Automatically changing the grid cell size based on the number of slots in the inventory</h1>
                
            
            
                
<p>Consider a situation where we wish to change the number of slots. An alternative to using something like scrollbars is to change the cell size in the <strong>Grid Layout Group</strong> component. We can automate this through code so that the cell size is changed to ensure that <kbd>NUM_INVENTORY_SLOTS</kbd> will fit along the width of our panel at the top of the canvas.</p>
<p>To implement the automated resizing of the <strong>Grid Layout Group</strong> cell size for this recipe, we need to do the following:</p>
<ul>
<li>Comment-out the third statement in method <kbd>Awake()</kbd>:</li>
</ul>
<pre style="padding-left: 60px">// panelSlotGrid.GetComponent&lt;RectTransform&gt;().SetSizeWithCurrentAnchors( <br/>// RectTransform.Axis.Horizontal, width);</pre>
<ul>
<li>Add the following method Start() to the C# Script PlayerInventoryDisplay in GameObject player-SpaceGirl with the following code:</li>
</ul>
<pre style="padding-left: 60px">void Start() { 
  float panelWidth = panelSlotGrid.GetComponent&lt;RectTransform&gt;().rect.width; 
  print ("slotGrid.GetComponent&lt;RectTransform&gt;().rect = " + panelSlotGrid.GetComponent&lt;RectTransform&gt;().rect); 
   
  GridLayoutGroup gridLayoutGroup = panelSlotGrid.GetComponent&lt;GridLayoutGroup&gt;(); 
  float xCellSize = panelWidth / NUM_INVENTORY_SLOTS; 
  xCellSize -= gridLayoutGroup.spacing.x; 
  gridLayoutGroup.cellSize = new Vector2(xCellSize, xCellSize); 
} </pre>
<p>We write our code in the <kbd>Start()</kbd> method, rather than adding to code in the Awake() method, to ensure that the <kbd>RectTransform</kbd> of GameObject Panel-slot-grid has finished sizing (in this recipe, it stretches based on the width of the Game panel). While we can't know the sequence in which <strong>Hierarchy</strong> GameObjects are created when a scene begins, we can rely on the Unity behavior that every GameObject sends the <kbd>Awake()</kbd> message, and only after all corresponding <kbd>Awake()</kbd> methods have finished executing all objects, and then sends the Start() message. So, any code in the <kbd>Start()</kbd> method can safely assume that every GameObject has been initialized.</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/6e42b39d-5b56-4795-ba2b-11d31af8a0a9.png" style="width:39.58em;height:9.17em;"/></p>
<p>The screenshot above shows the value of <kbd>NUM_INVENTORY_SLOTS</kbd> having been changed to 15, and the cell size, having been corresponding, changed, so that all 15 now fit horizontally in our panel. Note that the spacing between cells is subtracted from the calculated available with divided by the number of slots <kbd>(xCellSize -= gridLayoutGroup.spacing.x</kbd>) since that spacing is needed between each item displayed as well.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Displaying multiple pickups of different objects as a list of text via a dynamic List&lt;&gt; of scripted PickUp objects</h1>
                
            
            
                
<p>When working with different kinds of pickups, one approach is to use a C# List to maintain a flexible-length data structure of the items currently in the inventory. In this recipe, we will show you how, each time an item is picked up, a new object is added to such a List collection. An iteration through the List is how the text display of items is generated each time the inventory changes. We introduce a very simple PickUp script class, demonstrating how information about a pickup can be stored in a scripted component, extracted upon collision, and stored in our List.</p>
<div><img src="img/5509c6f0-ae2d-43c5-843f-983801722e55.png"/></div>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>This recipe assumes that you are starting with the <kbd>Simple2Dgame_SpaceGirl</kbd> project we set up in the first recipe in this chapter. The font you need can be found in the <kbd>03_02</kbd> folder.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<p>To display inventory total text for multiple pickups of different object types, follow these steps:</p>
<ol>
<li>Start with a new copy of the <kbd>Simple2Dgame_SpaceGirl mini-game</kbd>.</li>
<li>Edit the tags, changing Star to Pickup. Ensure that the star GameObject now has the Pickup tag.</li>
</ol>
<div><img src="img/04aa78bc-5251-4ad1-b83d-4f02763715c0.png"/></div>
<ol start="3">
<li>Add the following C# Script <strong>PickUp</strong> to the GameObject star in the Hierarchy:</li>
</ol>
<pre style="padding-left: 60px">using UnityEngine; 
using System.Collections; 

public class PickUp : MonoBehaviour { 
  public string description; 
}</pre>
<ol start="4">
<li>In the Inspector, change the description property of component Pick Up (Script) of GameObject star to the text <kbd>star</kbd>:</li>
</ol>
<div><img src="img/550c9efa-2e77-4c2f-b811-f2f922175e86.png" style="width:47.75em;height:17.75em;"/></div>
<ol start="5">
<li>Select the GameObject star in the Hierarchy panel and make a copy of this GameObject, renaming the copy heart.</li>
</ol>
<ol start="6">
<li>In the Inspector, change the description property of component <kbd>Pick Up</kbd> (Script) of GameObject heart to the text heart. Also, drag the health heart image from the Project panel (in the Sprites folder) into the Sprite property of GameObject heart. The player should now see the heart image on screen for this pickup item.</li>
<li>Select the GameObject star in the <strong>Hierarchy</strong> panel and make a copy of this GameObject, renaming the copy key.</li>
<li>In the Inspector, change the description property of component Pick Up (Script) of GameObject key to the text key. Also, drag the <kbd>icon_key_green_100</kbd> image from the Project panel (in the Sprites folder) into the Sprite property of GameObject key. The player should now see the key image on screen for this pickup item.</li>
<li>Make another one or two copies of each pickup GameObject and arrange them around the screen, so there are two or three each of star, heart, and key pickup GameObjects.</li>
<li>Create the following C# Script <kbd>PlayerInventory</kbd> in the <kbd>_Scripts</kbd> folder.</li>
</ol>
<pre style="padding-left: 60px">using UnityEngine; 
using System.Collections; 
using UnityEngine.UI; 
using System.Collections.Generic; 

public class PlayerInventory : MonoBehaviour { 
   private PlayerInventoryDisplay playerInventoryDisplay; 
   private List&lt;PickUp&gt; inventory = new List&lt;PickUp&gt;(); 

   void Awake() { 
         playerInventoryDisplay = GetComponent&lt;PlayerInventoryDisplay&gt;(); 
   } 

   void Start() { 
         playerInventoryDisplay.OnChangeInventory(inventory); 
   } 

   void OnTriggerEnter2D(Collider2D hit) { 
         if(hit.CompareTag("Pickup")){ 
               PickUp item = hit.GetComponent&lt;PickUp&gt;(); 
               inventory.Add( item ); 
               playerInventoryDisplay.OnChangeInventory(inventory); 
               Destroy(hit.gameObject); 
         } 
   } 
} <q><br/></q></pre>
<ol start="11">
<li>Add a UI Text object (<strong>Create</strong> | <strong>UI</strong> | <strong>Text</strong>). Rename it Text-inventory-list. Change its text to the quick brown fox jumped over the lazy dog the quick brown fox jumped over the lazy dog, or another long list of nonsense words, to test the overflow settings you'll change in the next step.</li>
<li>In the Text (Script) component, ensure that <strong>Horizontal Overflow</strong> is set to Wrap, and set <strong>Vertical Overflow</strong> to <strong>Overflow</strong>. This will ensure that the text will wrap onto a second or third line (if needed) and not be hidden if there are lots of pickups.</li>
<li>In the <strong>Inspector</strong> panel, set its font to <strong>Xolonium-Bold</strong> (folder Fonts) and set its color to yellow. For the <strong>Alignment</strong> property, center the text horizontally and ensure that the text is top aligned vertically, set the <strong>Font Size</strong> to <kbd>28</kbd>, and choose a yellow text Color.</li>
<li>Edit its <strong>Rect Transform</strong> and set its <strong>Height</strong> to 50. Then, while holding down <em>Shift</em> + <em>Alt</em> (to set pivot and position), choose the top-stretch box. The text should now be positioned at the middle top of the <strong>Game</strong> panel, and its width should stretch to match that of the whole panel.</li>
<li>Your text should now appear at the top of the game panel.</li>
<li>Add the following C# Script <kbd>PlayerInventoryDisplay</kbd> to GameObject player-girl1 in the <strong>Hierarchy</strong>:</li>
</ol>
<pre style="padding-left: 60px">using UnityEngine; 
using System.Collections; 
using UnityEngine.UI; 
using System.Collections.Generic; 

[RequireComponent(typeof(PlayerInventory))] 
public class PlayerInventoryDisplay : MonoBehaviour { 
   public Text inventoryText; 

   public void OnChangeInventory(List&lt;PickUp&gt; inventory) { 
         // (1) clear existing display 
         inventoryText.text = ""; 

         // (2) build up new set of items  
         string newInventoryText = "carrying: "; 
         int numItems = inventory.Count; 
         for(int i = 0; i &lt; numItems; i++){ 
               string description = inventory[i].description; 
               newInventoryText += " [" + description+ "]"; 
         } 

         // if no items in List then set string to message saying inventory is empty 
         if(numItems &lt; 1) 
               newInventoryText = "(empty inventory)"; 

         // (3) update screen display 
         inventoryText.text = newInventoryText; 
   } 
} </pre>
<ol start="17">
<li>From the <strong>Hierarchy</strong>, select the GameObject player-girl1. Then, from the <strong>Inspector</strong>, access the <strong>Player Inventory Display (Script)</strong> component and populate the <strong>Inventory Text</strong> public field with the <strong>UI Text</strong> object Text-inventory-list.</li>
<li>Play the game. Each time you pick up a star or key or heart, the updated list of what you are carrying should be displayed in the form carrying [key] [heart].</li>
</ol>


            

            
        
    

        

                            
                    <h1 class="header-title">How it works...k</h1>
                
            
            
                
<p>In the script class <kbd>PlayerInventory</kbd>, the variable inventory is a C# List&lt;&gt;. This is a flexible data structure that can be sorted, searched, and dynamically (at runtime, when the game is being played) have items added to and removed from it. The <kbd>&lt;PickUp&gt;</kbd> in pointy brackets means that variable inventory will contain a list of <kbd>PickUp</kbd> objects. For this recipe, our <kbd>PickUp</kbd> class just has a single field, a string description, but we'll add more sophisticated data items in <kbd>PickUp</kbd> classes in later recipes. This variable inventory is initialized to be a new, empty C# List of <kbd>PickUp</kbd> objects.</p>
<p>Before the scene starts, the <kbd>Awake()</kbd> method of script class Player caches a reference to the <kbd>PlayerInventoryDisplay</kbd> scripted component.</p>
<p>When the scene starts the <kbd>Start()</kbd> method invokes the <kbd>OnChangeInventory(...)</kbd> method of the <kbd>PlayerInventoryDisplay</kbd> scripted component. This is so the text displayed to the user at the beginning of the scene corresponds to the initial value of the variable inventory (which might, for some games, not be empty. For example, a player might start a game with some money, or a basic weapon, or a map).</p>
<p>When the <kbd>OnTriggerEnter2D(...)</kbd> method detects collisions with items tagged Pickup, the <kbd>PickUp</kbd> object component of the item hit is added to our inventory list. A call is also made to the <kbd>OnChangeInventory(...)</kbd> method of <kbd>playerInventoryDisplay</kbd> to update out inventory display to the player, passing the updated inventory List as a parameter.</p>
<p>The script class <kbd>playerInventoryDisplay</kbd> has a public variable, linked to the UI Text object Text-inventory-list. The <kbd>OnChangeInventory(...)</kbd> method first sets the UI text to empty, and then loops through the inventory list, building up a string of each items description in square brackets ([key], [heart], and so on). If there were no items in the list, then the string is set to the text (empty inventory). Finally, the text property of the <strong>UI Text</strong> object Text-inventory-list is set to the value of this string representation of what is inside the variable inventory.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">There's more...</h1>
                
            
            
                
<p>Here are some details you won't want to miss.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Order items in the inventory list alphabetically</h1>
                
            
            
                
<p>It would be nice to alphabetically sort the words in the inventory list, both for neatness and consistency (so, in a game, if we pick up a key and a heart, it will look the same regardless of the order they are picked up in), but also so that items of the same type will be listed together so that we can easily see how many of each item we are carrying.</p>
<p>To implement alphabetical sorting of the items in the inventory list, we need to do the following:</p>
<ol>
<li>Add the following C# code to the beginning of method <kbd>OnChangeInventory(...)</kbd> in the script class <kbd>PlayerInventoryDisplay</kbd>:</li>
</ol>
<pre style="padding-left: 60px">public void OnChangeInventory(List&lt;PickUp&gt; inventory){ 
    inventory.Sort( 
        delegate(PickUp p1, PickUp p2){ 
           return p1.description.CompareTo(p2.description); 
        } 
    ); 

   // rest of the method as before ... 
} </pre>
<ol start="2">
<li>You should now see all the items listed in alphabetic sequence.</li>
</ol>
<p>This C# code takes advantage of the C# List.Sort(...) method, a feature of collections whereby each item can be compared to the next, and they are swapped if in the wrong order (if the CompareTo(...) methods returns false). Learn more at<a href="https://msdn.microsoft.com/en-us/library/3da4abas(v=vs.110).aspx"> https://msdn.microsoft.com/en-us/library/3da4abas(v=vs.110).aspx</a>.<a href="https://msdn.microsoft.com/en-us/library/3da4abas(v=vs.110).aspx"/></p>


            

            
        
    

        

                            
                    <h1 class="header-title">Displaying multiple pickups of different objects as text totals via a dynamic Dictionary&lt;&gt; of PickUp objects and enum pickup types</h1>
                
            
            
                
<p>While the previous recipe worked fine, any old text might have been typed into the description for a pickup or perhaps mistyped (star, Sstar, starr, and so on). A much better way of restricting game properties to one of a predefined (enumerated) list of possible values is to use C# enums. As well as removing the chance of mistyping a string, it also means that we can write code to appropriately deal with the predefined set of possible values. In this recipe, we will improve our general purpose <kbd>PickUp</kbd> class by introducing three possible pickup types (Star, Heart, and Key), and write inventory display code that counts the number of each type of pickup being carried and displays these totals via a <strong>UI Text</strong> object on screen. We also switch from using a <strong>List</strong> to using a <strong>Dictionary</strong>, since the Dictionary data structure is designed specifically for key-value pairs, perfect for associating a numeric total with an enumerated pickup type.</p>
<div><img src="img/19a086e7-1556-47f7-b1f6-2bf25d6e5daf.png" style="width:15.83em;height:4.58em;"/></div>
<p>In this recipe, we will also manage the additional complexity by separating the controller (user collection event) logic from the stored inventory data, by introducing an inventory manager scripted class. Our player controller is then simplified to just two methods (Awake, getting a reference to the inventory manager, and <kbd>OnTriggerEnter2D</kbd>, responding to collisions by communicating with the inventory manager).</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>This recipe adapts the previous one. So, make a copy of the project for the previous recipe, and work on this copy.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<p>To display multiple pickups of different objects as text totals via a dynamic Dictionary, follow these steps:</p>
<ol>
<li>Replace the content of the script class <kbd>PickUp</kbd> with the following code:</li>
</ol>
<pre style="padding-left: 60px">using UnityEngine; 

public class PickUp : MonoBehaviour { 
   public enum PickUpType { 
         Star, Key, Heart 
   } 

   public PickUpType type; 
} </pre>
<ol start="2">
<li>Remove the instance of the script class <kbd>PlayerInventory</kbd> from the GameObject <kbd>player-SpaceGirl</kbd>.</li>
<li>Create a new C# script class <kbd>PlayerController</kbd> containing the following code, and add an instance as a component to GameObject <kbd>player-girl1</kbd>:</li>
</ol>
<pre style="padding-left: 60px">using UnityEngine; 

public class PlayerController : MonoBehaviour { 
   private InventoryManager inventoryManager; 

   void Awake() { 
         inventoryManager = GetComponent&lt;InventoryManager&gt;(); 
   } 

   void OnTriggerEnter2D(Collider2D hit) { 
         if(hit.CompareTag("Pickup")){ </pre>
<p class="mce-root" style="padding-left: 60px"><kbd>PickUp item = hit.GetComponent&lt;PickUp&gt; ();</kbd></p>
<pre style="padding-left: 60px">               inventoryManager.Add(item); 
               Destroy(hit.gameObject); 
         } 
   } 
} </pre>
<ol start="4">
<li>Replace the content of script class <kbd>PlayerInventoryDisplay</kbd> with the following code:</li>
</ol>
<pre style="padding-left: 60px">using UnityEngine; 
using UnityEngine.UI; 
using System.Collections.Generic; 

[RequireComponent(typeof(PlayerController))] 
[RequireComponent(typeof(InventoryManager))] 
public class PlayerInventoryDisplay : MonoBehaviour { 
   public Text inventoryText; 

   public void OnChangeInventory(Dictionary&lt;PickUp.PickUpType, int&gt; inventory) { 
         inventoryText.text = ""; 
         string newInventoryText = "carrying: "; 

         foreach (var item in inventory) { 
               int itemTotal = item.Value; 
               string description = item.Key.ToString(); 
               newInventoryText += " [ " + description + " " + itemTotal + " ]"; 
         } 

         int numItems = inventory.Count; 
         if (numItems &lt; 1) 
               newInventoryText = "(empty inventory)"; 

         inventoryText.text = newInventoryText; 
   } 
} </pre>
<ol start="5">
<li>Add an instance of the following C# Script <kbd>InventoryManager</kbd> to the GameObject <kbd>player-SpaceGirl</kbd> in the Hierarchy:</li>
</ol>
<pre style="padding-left: 60px">using UnityEngine; 
using System.Collections.Generic; 

public class InventoryManager : MonoBehaviour { 
   private PlayerInventoryDisplay playerInventoryDisplay; 
   private Dictionary&lt;PickUp.PickUpType, int&gt; items = new Dictionary&lt;PickUp.PickUpType, int&gt;(); 

   void Awake() { 
         playerInventoryDisplay = GetComponent&lt;PlayerInventoryDisplay&gt;(); 
   } 

   void Start() { 
         playerInventoryDisplay.OnChangeInventory(items); 
   } 

   public void Add(PickUp pickup) { 
         PickUp.PickUpType type = pickup.type; 
         int oldTotal = 0; 

         if(items.TryGetValue(type, out oldTotal)) 
               items[type] = oldTotal + 1; 
         else 
               items.Add (type, 1); 

         playerInventoryDisplay.OnChangeInventory(items); 
   } 
} </pre>
<ol start="6">
<li>In the <strong>Hierarchy</strong> (or <strong>Scene</strong>) panel, select <em>each pickup</em> GameObject in turn, and choose from the drop-down menu its corresponding <strong>Type</strong> in the <strong>Inspector</strong> panel. As you can see, public variables that are of an enum type are automatically restricted to the set of possible values as a combo-box drop-down menu in the <strong>Inspector</strong> panel.</li>
</ol>
<div><img src="img/5bc6bcee-c71a-4fcf-b13e-46beb373366f.png"/></div>
<ol start="7">
<li>Play the game. First, you should see a message on screen stating the inventory is empty, and then as you pick up one or more items of each pickup type, you'll see text totals of each type you have collected.</li>
</ol>


            

            
        
    

        

                            
                    <h1 class="header-title">How it works...</h1>
                
            
            
                
<p>Each pickup GameObject in the scene has a scripted component of the class <kbd>PickUp</kbd>. The <kbd>PickUp</kbd> object for each <kbd>Pickup</kbd> GameObject has a single property, a pickup type, which has to be one of the enumerated set of <kbd>Star</kbd>, <kbd>Key</kbd>, or <kbd>Heart</kbd>. The use of an enumerated type means that the value has to be one of these three listed values, so there can be no misspelling/mistyping errors that could have happened with a general text string type, as in the previous recipe.</p>
<p>Previously, the script class <kbd>PlayerInventory</kbd> script had two sets of responsibilities:</p>
<ul>
<li>Maintain the internal record of items being carried</li>
<li>Detect collisions, update the state, and ask the display class to inform the player visually of the changed items being carried</li>
</ul>
<p>In this recipe, we separate these two set of responsibilities into separate script classes:</p>
<ul>
<li>The script class InventoryManager will maintain the internal record of items being carried (and ask the display class to inform the player visually each time there is a change to the items being carried).</li>
<li>The script class <kbd>Player</kbd> will detect collisions, and ask the <kbd>InventoryManager</kbd> to update what is being carried.</li>
</ul>
<p>The addition of this extra software layer both separates the player collision detection behavior from how the inventory is internally stored, and also prevents any single script class from becoming too complex by attempting to handle too many different responsibilities. This recipe is an example of the low coupling of the <strong>Model-View-Controller</strong> (<strong>MVC</strong>) design pattern. We have designed our code to not rely on or make too many assumptions about other parts of the game so that the likelihood of a change in some other part of our game breaking our inventory display code is reduced. The display (view) is separated from the logical representation of what we are carrying (inventory manager model), and changes to the model are made by public methods called from the player (controller).</p>
<p>The Player script class gets a reference to the <kbd>InventoryManager</kbd> component via its Awake() method, and each time the player's character collides with a pickup GameObject, it calls the <kbd>Add(...)</kbd> method of the inventory manager, passing the PickUp object of the object collided with.</p>
<p>In the script class <kbd>InventoryManager</kbd>, the inventory being carried by the player is being represented by a C# <strong>Dictionary</strong>. A Dictionary is made up of a sequence of <em>key-value pairs</em>, where the key is one of the possible <kbd>PickUp.PickUpType</kbd> enumerated <strong>values</strong>, and the value is an integer total of how many of that type of pickup is being carried. The Dictionary is declared stating what type will be used for a key, and then what type (or script class) will be stored as the value for that key. Here is the statement declaring our Dictionary variable items:</p>
<pre>items = new Dictionary&lt;PickUp.PickUpType, int&gt;() </pre>
<p>C# dictionaries provide a <kbd>TryGetValue(...)</kbd> method, which receives parameters of a key and is passed a reference to a variable the same data type as the value for the Dictionary. When the <kbd>Add(...)</kbd> method of the inventory manager is called, the type of the PickUp object is tested to see if a total for this type is already in Dictionary items. If an item total is found inside the Dictionary for the given type, then the value for this item in the Dictionary is incremented. If no entry is found for the given type, then a new element is added to the Dictionary with a total of 1.</p>
<div><strong>TryGetValue call-by-reference parameter<br/>
<br/></strong> Note the use of the C# <kbd>out</kbd> keyword before the parameter <kbd>oldTotal</kbd> in this statement:<br/>
<kbd>items.TryGetValue(type, out oldTotal)</kbd><br/>
indicates that a reference to the actual variable oldTotal is being passed to method <kbd>TryGetValue(...)</kbd>, not just a copy of its value. This means that the method can change the value of the variable.</div>
<p>The method returns true if an entry is found in the Dictionary for the given type, and if so, sets the value of oldTotal to the value against this key.</p>
<p>The last action of the <kbd>Add(...)</kbd> method is to call the <kbd>OnChangeInventory(...)</kbd> method of the <kbd>PlayerInventoryDisplay</kbd> scripted component of the player GameObject to update the text totals displayed on screen.</p>
<p>The method <kbd>OnChangeInventory(...)</kbd> of the script class <kbd>PlayerInventoryDisplay</kbd> first initializes the string variable <kbd>newInventoryText</kbd>, and then iterates through each item in the Dictionary, appending to <kbd>newInventoryText</kbd> a string of the type name and total for the current item. Finally, the text property of the UI Text object is updated with the completed text inside <kbd>newInventoryText</kbd>, showing the pickup totals to the player.</p>
<p>Learn more about using C# lists and dictionaries in Unity in the Unity Technologies tutorial at <a href="https://unity3d.com/learn/tutorials/modules/intermediate/scripting/lists-and-dictionaries">https://unity3d.com/learn/tutorials/modules/intermediate/scripting/lists-and-dictionaries</a>.</p>


            

            
        
    </body></html>