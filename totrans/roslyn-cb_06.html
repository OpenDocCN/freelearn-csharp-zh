<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">Live Unit Testing in Visual Studio Enterprise</h1>
                </header>
            
            <article>
                
<p>In this chapter, we will cover the following recipes:</p>
<ul>
<li>Running <strong>live unit tests</strong> (<strong>LUT</strong>) in Visual Studio for unit test projects based on NUnit, XUnit, and MSTest frameworks</li>
<li>Viewing and navigating live unit test results</li>
<li>Understanding incremental live unit test execution with code changes</li>
<li>Understanding start/stop/pause/continue/restart functionalities for fine grained control of LUT</li>
<li>Including and excluding subsets of tests for live execution</li>
<li>Configuring different options for live unit testing using the <span class="packt_screen">Tools</span> | <span class="packt_screen">Options</span> dialog</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Introduction</h1>
                </header>
            
            <article>
                
<p><span>This chapter enables developers to use the new Roslyn-based feature in the Visual Studio 2017 Enterprise edition that enables smart live unit test execution in the background. The following snippet and screenshot from this (<a href="https://blogs.msdn.microsoft.com/visualstudio/2016/11/18/live-unit-testing-visual-studio-2017-rc/">https://blogs.msdn.microsoft.com/visualstudio/2016/11/18/live-unit-testing-visual-studio-2017-rc/</a>) Visual Studio blog post on LUT gives a nice gist about this feature.</span></p>
<p>Live unit testing automatically runs the impacted unit tests in the background as you edit code and visualizes the results and code coverage live, in the editor, in real time. In addition to giving feedback on the impact that your changes had on the existing tests, you also get immediate feedback on whether the new code you added is already covered by one or more existing tests. This will gently remind you to write unit tests as you are making bug fixes or adding features. You will be on your way to the promised land, where there is no test debt in your code base!</p>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" src="assets/204ce7ba-0850-4cf9-8e63-5d83bd3b7468.png"/></div>
<p>As mentioned in the post, there are three potential states for any given line:</p>
<ul>
<li>A line of executable code that is covered by at least one failing test is decorated with a red cross (<img height="12" src="assets/f9a44d62-69b8-4e18-b971-bf0d093d04bd.png" width="12"/>)</li>
<li>A line of executable code that is covered by only passing tests is decorated with a green tick (<img height="12" src="assets/2a269d1c-166f-460e-8c21-5837e358122f.png" width="12"/>)</li>
<li>A line of executable code that is not covered by any test is decorated it with a blue dash (<img height="12" src="assets/c7fb20c1-dafb-42dc-a6c5-0c8f61b2ba32.png" width="12"/>)</li>
</ul>
<p>LUT uses the Roslyn APIs to analyze snapshots to your product and test code and determines the set of unit tests that need to be run for your projects. Additionally, it also uses the Roslyn APIs to analyze incremental updates to your code to smartly determine subset of unit tests that need to be re-run from your prior test runs. These are the same set of analysis APIs that are used by the Visual Studio IDE diagnostic engine to incrementally update the intellisense/live diagnostics in the error list and squiggles in the editor.</p>
<p>Once the set of unit tests to execute have been determined, it schedules them for execution in the <span>background, and as and when the tests complete, it automatically shows their pass/fail/exclusion status with the glyphs on test methods. Users can start/stop/pause/resume live test execution at any given time. Additionally, they can exclude/include a subset of tests/files projects for LUT execution. They can also pause/restart/stop LUT anytime and configure different options for LUT, such as automatic pause on low battery, test execution timeout, and so on.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Running live unit tests in Visual Studio for unit test projects based on NUnit, XUnit, and MSTest frameworks</h1>
                </header>
            
            <article>
                
<p><span>In this section, we will walk you through the steps to enable LUT for your unit test projects, viewing and understanding the live results from the test execution.</span> <span>In VS2017, live unit testing is supported for unit test projects, based on the following unit test frameworks:</span></p>
<ul>
<li><span><strong>NUnit</strong>: Documentation at <a href="https://www.nunit.org/">https://www.nunit.org/</a></span></li>
<li><span><strong>XUnit</strong>: Documentation at <a href="https://xunit.github.io/">https://xunit.github.io/</a><br/></span></li>
<li><span><strong>MSTest</strong>: Documentation at (<a href="https://en.wikipedia.org/wiki/MSTest">https://en.wikipedia.org/wiki/MSTest</a>) and (<a href="https://msdn.microsoft.com/en-us/library/ms182489.aspx">https://msdn.microsoft.com/en-us/library/ms182489.aspx</a></span>)<span><a href="https://msdn.microsoft.com/en-us/library/ms182489.aspx"/></span></li>
</ul>
<p><span>We will cover LUT for unit test projects, based on each of the preceding test frameworks.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting started</h1>
                </header>
            
            <article>
                
<p><span>You will need to have the Visual Studio 2017 Enterprise edition installed on your machine to execute this recipe. You can install a licensed enterprise edition from</span> <a href="https://www.visualstudio.com/thank-you-downloading-visual-studio/?sku=Enterprise&amp;rel=15">https://www.visualstudio.com/thank-you-downloading-visual-studio/?sku=Enterprise&amp;rel=15</a>.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it</h1>
                </header>
            
            <article>
                
<ol>
<li>Open Visual Studio and create a new C# class library project, say <kbd>ClassLibrary</kbd>, with the following source code:</li>
</ol>
<pre style="padding-left: 90px">
namespace ClassLibrary<br/>{<br/>  public class Class1<br/>  {<br/>    public bool Method1()<br/>    {<br/>      return true;<br/>    }<br/><br/>    public bool Method2()<br/>    {<br/>      return false;<br/>    }<br/><br/>    public bool Method3(Class1 c)<br/>    {<br/>      return c.Method1();<br/>    }<br/><br/>    public bool Method4(Class1 c)<br/>    {<br/>      return c.Method2();<br/>    }<br/>  }<br/>}
</pre>
<ol start="2">
<li>[NUnit] Add a C# unit test project, say <kbd>NUnitBasedTestProject</kbd>, to the solution and add a reference to <kbd>ClassLibrary</kbd> to this project.</li>
<li>Open <span class="packt_screen">NuGet Package Manager</span> for the project and uninstall the existing NuGet package references in <kbd>MSTest.TestAdapter</kbd> and <kbd>MSTest.TestFramework</kbd>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" height="232" src="assets/46ea5831-af6a-401f-97db-0aae0e8ecb38.png" width="864"/></div>
<ol start="4">
<li>Add NuGet package references to the latest stable versions of NUnit and <span class="packt_screen">NUnit3TestAdapter</span> to the project.</li>
<li>Replace the source code in file <kbd>UnitTest1.cs</kbd> with the following code:</li>
</ol>
<pre style="padding-left: 90px">
using <strong>NUnit.Framework</strong>;<br/><br/>namespace NUnitBasedTestProject<br/>{<br/>  [<strong>TestFixture</strong>]<br/>  public class UnitTest1<br/>  {<br/>    [<strong>Test</strong>]<br/>    public void TestMethod1()<br/>    {<br/>      var c = new ClassLibrary.Class1();<br/>      Assert.True(c.Method1());<br/>    }<br/><br/>    [<strong>Test</strong>]<br/>    public void TestMethod2()<br/>    {<br/>      var c = new ClassLibrary.Class1();<br/>      Assert.True(c.Method2());<br/>    }<br/>  }<br/>}
</pre>
<ol start="6">
<li>Start live unit testing for the project by executing the <span class="packt_screen">Test <span><span>|</span></span></span> <span class="packt_screen">Live Unit Testing <span><span>|</span></span></span> <span class="packt_screen">Start</span> command.</li>
</ol>
<ol start="7">
<li>Wait for a few seconds and note that the added unit tests execute in the background, and that <kbd>TestMethod1</kbd> passes and <kbd>TestMethod2</kbd> fails as expected and the corresponding green and red glyphs show up in the editor. Also, verify that the <span class="packt_screen">Output</span> window switches to <span class="packt_screen">Live Unit Testing</span> view and shows the test execution log with execution time stamps:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" src="assets/4b699501-9926-4efe-9907-57b1f6803eb0.png"/></div>
<ol start="8">
<li>[XUnit] Add a C# unit test project, say <kbd>XUnitBasedTestProject</kbd>, to the solution and add a reference to <kbd>ClassLibrary</kbd> to this project.</li>
<li><span>Open</span> <span class="packt_screen">NuGet Package Manager</span> <span>for the project and uninstall the existing NuGet package references to</span> <kbd>MSTest.TestAdapter</kbd> <span>and</span> <kbd>MSTest.TestFramework</kbd>.</li>
<li>Add the NuGet package references to the latest stable versions of XUnit and <kbd>xunit.runner.visualstudio</kbd> (later than <em>2.2.0</em>).</li>
</ol>
<ol start="11">
<li>Replace the source code in the <kbd>UnitTest1.cs</kbd> file with the following source code:</li>
</ol>
<pre style="padding-left: 90px">
using <strong>Xunit</strong>;<br/><br/>namespace XUnitBasedTestProject<br/>{<br/>  public class UnitTest1<br/>  {<br/>    [<strong>Fact</strong>]<br/>    public void TestMethod1()<br/>    {<br/>      var c = new ClassLibrary.Class1();<br/>      Assert.True(c.Method1());<br/>    }<br/><br/>    [<strong>Fact</strong>]<br/>    public void TestMethod2()<br/>    {<br/>      var c = new ClassLibrary.Class1();<br/>      Assert.True(c.Method2());<br/>    }<br/>  }<br/>}
</pre>
<ol start="12">
<li>Wait for a few seconds and note that unit tests execute in the background and <kbd>TestMethod1</kbd> passes and <kbd>TestMethod2</kbd> fails. Verify that the green and red glyphs shows up in the editor for these tests, respectively.</li>
<li>[MSTest] Add a C# unit test project, say <kbd>MSTestBasedTestProject</kbd>, to the solution and add a reference to <kbd>ClassLibrary</kbd> to this project.</li>
<li><span>Open the</span> <span class="packt_screen">NuGet Package Manager</span> <span>for the project</span> and update the <span>existing NuGet package references for</span> <kbd>MSTest.TestAdapter</kbd> <span>and</span> <kbd>MSTest.TestFramework</kbd> to latest stable version (later than <q>1.1.17</q>)</li>
<li>Replace the source code in file <kbd>UnitTest1.cs</kbd> with the following source code:</li>
</ol>
<pre style="padding-left: 90px">
using <strong>Microsoft.VisualStudio.TestTools.UnitTesting</strong>;<br/><br/>namespace MSTestBasedTestProject<br/>{<br/>  [<strong>TestClass</strong>]<br/>  public class UnitTest1<br/>  {<br/>    [<strong>TestMethod</strong>]<br/>    public void TestMethod1()<br/>    {<br/>      var c = new ClassLibrary.Class1();<br/>      Assert.IsTrue(c.Method1());<br/>    }<br/><br/>    [<strong>TestMethod</strong>]<br/>    public void TestMethod2()<br/>    {<br/>      var c = new ClassLibrary.Class1();<br/>      Assert.IsTrue(c.Method2());<br/>    }<br/>  }<br/>}
</pre>
<ol start="16">
<li>Wait for a few seconds and note that unit tests execute in the background and <kbd>TestMethod1</kbd> passes and <kbd>TestMethod2</kbd> fails. Verify that the green and red glyphs shows up in the editor for these tests, respectively.</li>
<li>Open <kbd>Class1.cs</kbd> in the project <kbd>ClassLibrary</kbd> and verify that the test coverage and pass/fail details are shown for each method in the editor:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" height="457" src="assets/54b46b51-f51b-4b05-8aee-c2861854f034.png" width="800"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Viewing and navigating live unit test results</h1>
                </header>
            
            <article>
                
<p><span>In this section, we will show you how to view and navigate the results from live test execution using the</span> <span class="packt_screen">Test Explorer</span> <span>and the tool tip in the Visual Studio editor.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting started</h1>
                </header>
            
            <article>
                
<p><span>You will need to have the Visual Studio 2017 Enterprise edition installed on your machine to execute this recipe. You can install a licensed enterprise edition from</span> <a href="https://www.visualstudio.com/thank-you-downloading-visual-studio/?sku=Enterprise&amp;rel=15">https://www.visualstudio.com/thank-you-downloading-visual-studio/?sku=Enterprise&amp;rel=15</a>.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<ol>
<li>Open Visual Studio and create a new C# class library project, say <kbd>ClassLibrary</kbd><em>.</em></li>
<li>Replace the existing code in the source file <kbd>Class1.cs</kbd> with the code in attached sample <kbd>ClassLibrary\Class1.cs</kbd>.</li>
<li>Add a C# unit test project, say <kbd>UnitTestProject</kbd><em>,</em> to the solution and add a reference to <kbd>ClassLibrary</kbd> to this project.</li>
<li><span>Open the <span class="packt_screen">NuGet Package Manager</span> for the project an</span>d update <span>the existing NuGet package references for</span> <kbd>MSTest.TestAdapter</kbd> <span>and</span> <kbd>MSTest.TestFramework</kbd> to latest stable version (later than <q>1.1.17</q>)</li>
<li>Replace the source code in the <kbd>UnitTest1.cs</kbd> file with the code in the attached sample <kbd>UnitTestProject\UnitTest1.cs</kbd>.</li>
<li>Open the <span class="packt_screen">Test Explorer</span> window by clicking on <span class="packt_screen">Test <span><span>|</span></span></span> <span class="packt_screen">Window <span><span>|</span></span></span> <span class="packt_screen">Test Explorer</span>.</li>
<li>Start live unit testing for the project by executing <span class="packt_screen">Test | Live Unit Testing | Start</span> command.</li>
<li>Wait for a few seconds and note that the added unit tests execute on the background and <kbd>TestMethod1</kbd> passes and <kbd>TestMethod2</kbd> fails as expected.</li>
</ol>
<ol start="9">
<li>Verify that the results are shown in the <span class="packt_screen">Test Explorer</span> and there are corresponding green and red glyphs in the editor:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" height="561" src="assets/4340f991-6fee-4d57-80d8-ce29d7c99c4a.png" width="800"/></div>
<ol start="10">
<li>Open source file <kbd>Class1.cs</kbd> in <kbd>ClassLibrary</kbd> and click on the test indicator on top of <kbd>Method1</kbd>, which reads <kbd>1/1 passing</kbd>. Verify that a tool bar pops up with the name and status of the test, <kbd>TestMethod1</kbd>.</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" height="237" src="assets/2c312c28-0c56-45c0-8c6a-187f2e9ddc24.png" width="801"/></div>
<ol start="11">
<li>Double-click on the method name <kbd>TestMethod1</kbd> in the tool bar and make sure to navigate to the definition of this method in <kbd>UnitTest1.cs</kbd>.</li>
<li>Switch back to <kbd>Class1.cs</kbd> and hover near the green tick (<img height="12" src="assets/8381cf4a-2013-44c9-94b4-97b4dd85b194.png" width="12"/>) near <kbd>Method1</kbd> <span>to view that the method is <span class="packt_screen">Covered by 1 test.</span>:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" height="83" src="assets/9a3298a1-a2ce-47c2-a12e-5f67372acb78.png" width="313"/></div>
<ol start="13">
<li>Click on the tick (<img height="12" src="assets/8381cf4a-2013-44c9-94b4-97b4dd85b194.png" width="12"/>) to bring up another toolbar with the method name and verify that double-clicking on it takes you to the test method definition.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Understanding incremental live unit test execution with code changes</h1>
                </header>
            
            <article>
                
<p><span>In this section, we will show you how live unit tests run incrementally on making changes to test and product code on a solution configured to run live unit tests.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting started</h1>
                </header>
            
            <article>
                
<p><span>You will need to have the Visual Studio 2017 Enterprise edition installed on your machine to execute this recipe. You can install a licensed enterprise edition from</span> <a href="https://www.visualstudio.com/thank-you-downloading-visual-studio/?sku=Enterprise&amp;rel=15">https://www.visualstudio.com/thank-you-downloading-visual-studio/?sku=Enterprise&amp;rel=15.</a></p>
<p>Additionally, clone the solution <kbd>ClassLibrary.sln</kbd> attached from the previous recipe in this chapter, <em>Viewing and navigating live unit test results</em>. Alternatively, you can manually execute the steps in that recipe before executing this recipe.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<ol>
<li>Open the <kbd>ClassLibrary.sln</kbd> solution with two projects: <kbd>ClassLibrary</kbd> and <kbd>UnitTestProject</kbd> and start live unit testing by navigating to <span class="packt_screen">Test <span><span>|</span></span></span> <span class="packt_screen">Live Unit Testing <span><span>|</span></span></span> <span class="packt_screen">Start</span>.</li>
<li>Add a new source file <kbd>Class2.cs</kbd> with the following code to the <kbd>ClassLibrary</kbd> project:</li>
</ol>
<pre style="padding-left: 60px">
namespace ClassLibrary<br/>{<br/>  public class Class2<br/>  {<br/>    public bool Method5()<br/>    {<br/>      return false;<br/>    }<br/><br/>    public bool Method6()<br/>    {<br/>      return true;<br/>    }<br/>  }<br/>}
</pre>
<ol start="3">
<li>Open the <span class="packt_screen">Output</span> window, switch the <span class="packt_screen">Show output from:</span> combo box to <span class="packt_screen">Live Unit Testing</span>, and clear all the contents in the window by pressing the highlighed button:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" height="215" src="assets/64291a34-9828-441b-9c2f-4baa3fa99a26.png" width="801"/></div>
<ol start="4">
<li>Add a new source file <kbd>UnitTest2.cs</kbd> with the following code to the <kbd>UnitTestProject</kbd> project:</li>
</ol>
<pre style="padding-left: 90px">
using Microsoft.VisualStudio.TestTools.UnitTesting;<br/><br/>namespace MSTestBasedTestProject<br/>{<br/>  [TestClass]<br/>  public class UnitTest2<br/>  {<br/>    [TestMethod]<br/>    public void TestMethod5()<br/>    {<br/>      var c = new ClassLibrary.Class2();<br/>      Assert.IsTrue(c.Method5());<br/>    }<br/><br/>    [TestMethod]<br/>    public void TestMethod6()<br/>    {<br/>      var c = new ClassLibrary.Class2();<br/>      Assert.IsTrue(c.Method6());<br/>    }<br/>  }<br/>}
</pre>
<ol start="5">
<li>Wait for a few seconds and note that the added unit tests execute on the background and <kbd>TestMethod5</kbd> passes and <kbd>TestMethod6</kbd> fails as expected.</li>
</ol>
<ol start="6">
<li>Also, note that the text in the <span class="packt_screen">Output</span> window states that only two unit tests were executed (newly added ones <kbd>TestMethod5</kbd> and <kbd>TestMethod6</kbd>). Additionally, the <span class="packt_screen">Test Explorer</span> shows the old tests <kbd>TestMethod1</kbd> and <kbd>TestMethod2</kbd> as grayed out, because these tests did not execute when we added new test code:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" height="562" src="assets/e49b1dcf-419d-4cf8-b177-2f42fb97c21e.png" width="800"/></div>
<ol start="7">
<li>Switch back to the <kbd>Class1.cs</kbd> file in <kbd>ClassLibrary</kbd> project and edit <kbd>Method1</kbd> to return <kbd>true</kbd>.</li>
<li>Wait a few seconds for the tests to execute in the background and see that <kbd>TestMethod1</kbd> now shows as passed.</li>
<li>Note that <kbd>TestMethod5</kbd> and <kbd>TestMxethod6</kbd> are now grayed out in the <span class="packt_screen">Test Explorer</span>, indicating that they did not execute with the last code change:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" height="331" src="assets/53b7902e-d6bf-4427-b519-dc8216714c87.png" width="800"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works</h1>
                </header>
            
            <article>
                
<p>In this recipe, we showed you how the live unit test execution is designed to analyze incremental product and test changes and execute only the subset of tests in the unit test projects, which could be semantically affected by those changes. As mentioned in the introduction section of this chapter, <span>LUT uses the Roslyn APIs to analyze these incremental code updates from your prior test runs. These are the same set of analysis APIs that are used by the Visual Studio IDE diagnostic engine to incrementally update the intellisense/live diagnostics in the error list and squiggles in the editor.</span></p>
<p>In this recipe, we started with a single class, <kbd>Class1</kbd><em>,</em> in the <kbd>ClassLibrary</kbd> project and a single unit test class, <kbd>UnitTest1</kbd><em>,</em> in <kbd>UnitTestProject</kbd>. <kbd>UnitTest1</kbd> contains two methods <kbd>TestMethod1</kbd> and <kbd>TestMethod2</kbd>, that tested methods <kbd>Method1</kbd> and <kbd>Method2</kbd> in <kbd>Class1</kbd>, respectively. We added a new class, <kbd>Class2</kbd>, in <kbd>ClassLibrary</kbd> project with methods <kbd>Method5</kbd> and <kbd>Method6</kbd>. Then, we added a new unit test class, <kbd>UnitTest2</kbd> containing methods <kbd>TestMethod5</kbd> and <kbd>TestMethod6</kbd>, that test methods <kbd>Method5</kbd> and <kbd>Method6</kbd>, respectively. On adding these methods, LUT determined that the existing tests in type <kbd>UnitTest1</kbd> are unaffected by newly added <kbd>Class2</kbd> and <kbd>UnitTest2</kbd> and hence did not re-execute them. Subsequently, when we edited <kbd>Class1.Method1</kbd>, LUT only re-executed <kbd>UnitTest1.TestMethod1</kbd> and <kbd>UnitTest1.TestMethod2</kbd> but not the test methods in <kbd>UnitTest2</kbd>.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Understanding Start/Stop/Pause/Continue/Restart functionality for fine grain control of LUT</h1>
                </header>
            
            <article>
                
<p><span>In this section, we will show you how to control the live unit test execution in Visual Studio using the start, stop, pause, continue, and restart commands.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting started</h1>
                </header>
            
            <article>
                
<p><span>You will need to have Visual Studio 2017 Enterprise edition installed on your machine to execute this recipe. You can install a licensed enterprise edition from</span> <a href="https://www.visualstudio.com/thank-you-downloading-visual-studio/?sku=Enterprise&amp;rel=15">https://www.visualstudio.com/thank-you-downloading-visual-studio/?sku=Enterprise&amp;rel=15</a>.</p>
<p>Additionally, clone the solution <kbd>ClassLibrary.sln</kbd> attached from the recipe, <em>Viewing and navigating live unit test results</em>, in this chapter. Alternatively, you can manually execute the steps in that recipe before executing this recipe.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<ol>
<li>Open the solution <kbd>ClassLibrary.sln</kbd>, with two projects: <kbd>ClassLibrary</kbd> and <kbd>UnitTestProject</kbd> and start live unit testing by clicking on <span class="packt_screen">Test</span> | <span class="packt_screen">Live Unit Testing</span> | <span class="packt_screen">Start</span>. Also, bring up the <span class="packt_screen">Test Explorer</span> window by clicking on <span class="packt_screen">Test <span><span>|</span></span></span> <span class="packt_screen">Windows <span><span>|</span></span></span> <span class="packt_screen">Test Explorer</span>.</li>
<li>Change <kbd>Class1.Method1</kbd> to return true instead of false.</li>
</ol>
<ol start="3">
<li>Wait for a few seconds and note that the unit tests execute on the background, and <kbd>TestMethod1</kbd> and <kbd>TestMethod2</kbd> are both passed:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" height="327" src="assets/212c5c58-8eb1-4608-9a37-91c5488a26c7.png" width="800"/></div>
<ol start="4">
<li>Click on <span class="packt_screen">Test</span>| <span class="packt_screen">Live Unit Testing <span><span>|</span></span></span> <span class="packt_screen">Pause</span> to temporarily pause LUT execution. Note that green tick (<img height="12" src="assets/fda17483-050b-463d-9bc9-0846f151a3a8.png" width="12"/>) marks in the editor disappear as soon as LUT is paused:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" height="329" src="assets/b224db4b-1d55-4aeb-ae17-f1b3e4c68b77.png" width="799"/></div>
<ol start="5">
<li>Change <kbd>Class1.Method1</kbd> to again return false. This should cause <kbd>TestMethod1</kbd> to fail when re-executed, but note that the test still shows as passing in <span class="packt_screen">Test Explorer</span> window because tests are not running live:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" height="328" src="assets/9547dcb9-9758-4926-9f11-d3e09da0031d.png" width="799"/></div>
<ol start="6">
<li>Navigate to <span class="packt_screen">Test <span><span>|</span></span></span> <span class="packt_screen">Live Unit Testing <span><span>|</span></span></span> <span class="packt_screen">Continue</span> to resume LUT and note that <kbd>TestMethod1</kbd> immediately executes and is now shown as failing in the <span class="packt_screen">Test Explorer</span> and gylph in the editor:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" height="331" src="assets/bf30fb79-f10b-482d-90d9-caefa738c42e.png" width="800"/></div>
<ol start="7">
<li><span>Click on</span> <span class="packt_screen">Test <span><span>|</span></span></span> <span class="packt_screen">Live Unit Testing <span><span>|</span></span></span> <span class="packt_screen">Restart</span> and note that all the test results are wiped out momentarily in the editor and <span class="packt_screen">Test Explorer</span> window.</li>
<li>Note that <span class="packt_screen">Output</span> window's <span class="packt_screen">Live Unit Testing</span> pane shows the message: <span class="packt_screen">Build completed (succeeded)</span>, indicating the projects were built again and all tests re-executed.</li>
<li>Navigate to <span class="packt_screen">Test <span><span>|</span></span></span> <span class="packt_screen">Live Unit Testing <span><span>|</span></span></span> <span class="packt_screen">Stop</span> <span>and note that all the test results are wiped out permanently in the editor and</span> <span class="packt_screen">Test Explorer</span> <span>window:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" height="327" src="assets/590f2111-0fe1-4ba7-a418-e71dfe2b4d44.png" width="800"/></div>
<ol start="10">
<li><span>Note that</span> the <span class="packt_screen">Output</span> <span>window's</span> <span class="packt_screen">Live Unit Testing</span> <span>pane shows the message:</span> <span class="packt_screen">Live Unit Testing stopped</span><q>.</q><span>, confirming that LUT execution was stopped.</span></li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Including and excluding subset of tests for live execution</h1>
                </header>
            
            <article>
                
<p><span>In this section, we will show you how to selectively include and/or exclude subset of tests from live unit test execution. This features is extremely helpful in improving responsiveness for very large solutions where building the entire solution and then executing all the unit tests could be time consuming and resource intensive.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting started</h1>
                </header>
            
            <article>
                
<p><span>You will need to have the Visual Studio 2017 Enterprise edition installed on your machine to execute this recipe. You can install a licensed enterprise edition from</span> <a href="https://www.visualstudio.com/thank-you-downloading-visual-studio/?sku=Enterprise&amp;rel=15">https://www.visualstudio.com/thank-you-downloading-visual-studio/?sku=Enterprise&amp;rel=15</a>.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<ol>
<li>Open Visual Studio 2017 and create a C# solution with 10 <kbd>ClassLibrary</kbd> projects, say <kbd>ClassLibrary</kbd>, <kbd>ClassLibrary1</kbd>, ..., <kbd>ClassLibrary9</kbd> and one unit test project <kbd>UnitTestProject</kbd>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" height="381" src="assets/8ca650dd-cfc7-41f3-ad5d-7c3b050ee8af.png" width="464"/></div>
<ol start="2">
<li>Add a project reference to all the class library projects in <kbd>UnitTestProject</kbd>.</li>
<li>Add a new test class <kbd>UnitTest2</kbd> in <kbd>UnitTestProject</kbd> and rename the test method to <kbd>TestMethod2.</kbd></li>
</ol>
<ol start="4">
<li>Navigate to <span class="packt_screen">Test <span><span>|</span></span></span> <span class="packt_screen">Live Unit Testing <span><span>|</span></span></span> <span class="packt_screen">Start</span> and notice the following dialog prompting that the solution is large and responsiveness will improve if subset of the tests are included:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" height="202" src="assets/2322b4be-14f8-470d-9859-ad3cd7bc9068.png" width="385"/></div>
<ol start="5">
<li>Click on <span class="packt_screen">No</span> so that none of the tests are included for live execution.</li>
<li>Verify the <span>blue dash (<img height="12" src="assets/91c7043d-5a4f-4c78-8ce4-09b3cb1ad729.png" width="12"/>) in front of the test methods in</span> <kbd>UnitTestProject</kbd><span>, confirming the exclusion of unit tests from live execution:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" height="274" src="assets/0740f180-58e2-4fbe-a3bb-b0e76faac5c2.png" width="460"/></div>
<ol start="7">
<li>Right-click on class <kbd>UnitTest1</kbd> in the editor and execute <span class="packt_screen">Live Tests <span><span>|</span></span></span> <span class="packt_screen">Include</span> to include unit tests in this class for LUT.</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" height="477" src="assets/332dadc6-29b1-4082-8641-03bbe55072a1.png" width="606"/></div>
<ol start="8">
<li>Verify that <kbd>UnitTest1.TestMethod1</kbd> executes immediately with LUT and is shown as passed, but <kbd>UnitTest2.TestMethod2</kbd> is not executed.</li>
<li>Right-click on class <kbd>UnitTest1</kbd> in the editor again and execute <span class="packt_screen">Live Tests <span><span>|</span></span></span> <span class="packt_screen">Exclude</span> to exclude unit tests in this class for LUT.</li>
<li>Edit the method <kbd>UnitTest1.TestMethod1</kbd> by hitting the <em>Enter</em> key and verify the test is now excluded from LUT and test result is also cleared from the editor and <span class="packt_screen">Test Explorer</span> window:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" height="333" src="assets/7d6526c3-578f-41de-93f1-3cc0d50b0e9c.png" width="799"/></div>
<div class="packt_infobox">You can include/exclude all tests from a unit test project for LUT by right-clicking on the project node in the solution explorer and clicking on <span class="packt_screen">Live Tests <span><span>|</span></span></span> <span class="packt_screen">Include/Exclude</span>.</div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Configuring different options for live unit testing using the Tools Options dialog</h1>
                </header>
            
            <article>
                
<p><span>In this section, we will show you how to configure LUT execution options, such as starting LUT on solution load, configuring the minimum battery percentage required to keep LUT enabled in order to save battery power, and so on. This enables users to control when to automatically start/pause LUT and to control the level of logging to meet their requirements.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting started</h1>
                </header>
            
            <article>
                
<p><span>You will need to have the Visual Studio 2017 Enterprise edition installed on your machine to execute this recipe. You can install a licensed enterprise edition from</span> <a href="https://www.visualstudio.com/thank-you-downloading-visual-studio/?sku=Enterprise&amp;rel=15">https://www.visualstudio.com/thank-you-downloading-visual-studio/?sku=Enterprise&amp;rel=15</a>.</p>
<p>Additionally, clone the <kbd>ClassLibrary.sln</kbd> solution attached from the recipe, <em>Viewing and navigating live unit test results</em>, in this chapter. Alternatively, you can manually execute the steps in that recipe before proceeding with this recipe.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<ol>
<li>Open the solution <kbd>ClassLibrary.sln</kbd> with two projects, <kbd>ClassLibrary</kbd> and <kbd>UnitTestProject</kbd><strong>,</strong> and start live unit testing by navigating to <span class="packt_screen">Test <span><span>|</span></span></span> <span class="packt_screen">Live Unit Testing <span><span>|</span></span></span> <span class="packt_screen">Start</span>. Also, bring up the <span class="packt_screen">Test Explorer</span> window by clicking on <span class="packt_screen">Test <span><span>|</span></span></span> <span class="packt_screen">Windows | Test Explorer</span>.</li>
<li>Click on <span class="packt_screen">Tools <span><span>|</span></span></span> <span class="packt_screen">Options</span>, and search <kbd>Live Unit Testing</kbd> in the search bar, and click on the <span class="packt_screen">General</span> tab to view the LUT configuration options:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" height="426" src="assets/75fdd645-88d0-44be-8dad-4e73202e51bf.png" width="652"/></div>
<ol start="3">
<li>Check <span class="packt_screen">Start Live Unit Testing on solution load</span> and click on <span class="packt_screen">OK</span> on the dialog.</li>
<li>Stop live unit testing for the solution by navigating to <span class="packt_screen">Test <span><span>|</span></span></span> <span class="packt_screen">Live Unit Testing <span><span>|</span></span></span> <span class="packt_screen">Stop</span>.</li>
<li>Close and re-open the solution and verify that all unit tests are automatically executed with LUT on completion of the solution load.</li>
<li>Open the LUT configuration options using <span class="packt_screen">Tools <span><span>|</span></span></span> <span class="packt_screen">Options</span> again and change the minimum battery percentage to pause LUT from 30% to 100%</li>
<li>Disconnect the power cord from your laptop and verify the LUT is immediately paused, and that editing any test method doesn't cause tests to be re-executed with LUT.</li>
<li>Connect the laptop power cord and verify the unit tests again; start executing in the background with LUT.</li>
</ol>


            </article>

            
        </section>
    </body></html>