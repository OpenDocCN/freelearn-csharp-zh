<html><head></head><body><div class="chapter" title="Chapter&#xA0;2.&#xA0;Designing a Sample Application"><div class="titlepage"><div><div><h1 class="title"><a id="ch02"/>Chapter 2. Designing a Sample Application</h1></div></div></div><p>In this chapter, we will learn how to use Microsoft Visual Studio 2012. We will create our application, and by studying the working of this application, we will learn the features of Visual Studio. We will also design our interface and validate our data. By the end of this chapter, we will have the final design of our application.</p><p>In this chapter, we will cover the following topics:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Creating a new application</li><li class="listitem" style="list-style-type: disc">Adding controls to the form</li><li class="listitem" style="list-style-type: disc">Validating form data</li><li class="listitem" style="list-style-type: disc">Sketching our reports on paper</li></ul></div><div class="section" title="Creating a new application"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec13"/>Creating a new application</h1></div></div></div><p>We will now start using<a id="id47" class="indexterm"/> Microsoft Visual Studio, which we installed in the previous chapter:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">From the <span class="strong"><strong>Start</strong></span> menu, select <span class="strong"><strong>All Programs</strong></span>, then select the <span class="strong"><strong>Microsoft Visual Studio 2012</strong></span> folder, and then select <span class="strong"><strong>Visual Studio 2012</strong></span>.</li><li class="listitem">Since we are running Visual Studio for the first time, we will see the following screenshot. We can select the default environment setting. Also, we can change this setting in our application. We will use C# as the programming language, so we will select <span class="strong"><strong>Visual C# Development Settings</strong></span> and click on the <span class="strong"><strong>Start Visual Studio</strong></span> button.<div class="mediaobject"><img src="graphics/8026_02_01.jpg" alt="Creating a new application"/></div></li><li class="listitem">Now we will <a id="id48" class="indexterm"/>see the <span class="strong"><strong>Start Page</strong></span> of Microsoft Visual Studio 2012. Select <span class="strong"><strong>New Project</strong></span> or open it by navigating to <span class="strong"><strong>File</strong></span> | <span class="strong"><strong>New</strong></span> | <span class="strong"><strong>Project</strong></span>. This is shown in the following screenshot:<div class="mediaobject"><img src="graphics/8026_02_02.jpg" alt="Creating a new application"/></div></li><li class="listitem">As shown in the <a id="id49" class="indexterm"/>following screenshot, we will select <span class="strong"><strong>Windows</strong></span> as the application template. We will then select <span class="strong"><strong>Windows Forms Application</strong></span> as the application type. Let us name our application <code class="literal">Monitor</code>. Choose where you want to save the application and click on <span class="strong"><strong>OK</strong></span>.<div class="mediaobject"><img src="graphics/8026_02_03.jpg" alt="Creating a new application"/></div><p>Now we will see the <a id="id50" class="indexterm"/>following screenshot. Let's start to design our application interface.</p><div class="mediaobject"><img src="graphics/8026_02_04.jpg" alt="Creating a new application"/></div></li><li class="listitem">Start by right-<a id="id51" class="indexterm"/>clicking on the form and navigating to <span class="strong"><strong>Properties</strong></span>, as shown in the following screenshot:<div class="mediaobject"><img src="graphics/8026_02_05.jpg" alt="Creating a new application"/></div></li><li class="listitem">The <span class="strong"><strong>Properties</strong></span> explorer will open as shown in the following screenshot. Change <span class="strong"><strong>Text</strong></span> property from <span class="strong"><strong>Form1</strong></span> to <code class="literal">monitor</code>, change the <span class="strong"><strong>Name</strong></span> property to <code class="literal">MainForm</code>, and then change <span class="strong"><strong>Size</strong></span> to <code class="literal">322, 563</code> because we will add many controls to our form. After I finished the design process, I found that this was the suitable form size; you can change form size and all controls sizes as you <a id="id52" class="indexterm"/>wish in order to better suit your application interface.<div class="mediaobject"><img src="graphics/8026_02_06.jpg" alt="Creating a new application"/></div></li></ol></div></div></div>
<div class="section" title="Adding controls to the form"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec14"/>Adding controls to the form</h1></div></div></div><p>In this step, we will<a id="id53" class="indexterm"/> start <a id="id54" class="indexterm"/>designing the interface of our application by adding controls to the Main Form.</p><p>We will divide the Main Form into three main parts as follows:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Employees</li><li class="listitem" style="list-style-type: disc">Products and orders</li><li class="listitem" style="list-style-type: disc">Employees and products</li></ul></div><div class="section" title="Employees"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec13"/>Employees</h2></div></div></div><p>In this section, we will see the different ways in which we can search for our employees and display the result in a report.</p><div class="section" title="Beginning your design process"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl3sec02"/>Beginning your design process</h3></div></div></div><p>Let's begin to design the Employees section of our application using the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">From the <span class="strong"><strong>Toolbox</strong></span> explorer, drag-and-drop <span class="strong"><strong>GroupBox</strong></span> into the Main Form. Change the GroupBox <span class="strong"><strong>Size</strong></span> property to <code class="literal">286, 181</code>, the <span class="strong"><strong>Location</strong></span> property to <code class="literal">12,12</code>, and <span class="strong"><strong>Text</strong></span> property to Employees.</li><li class="listitem">Add <span class="strong"><strong>Label</strong></span> to the Main Form. Change the <span class="strong"><strong>Text</strong></span> property to <code class="literal">ID</code> and the <span class="strong"><strong>Location</strong></span> property to <code class="literal">12,25</code>.</li><li class="listitem">Add <span class="strong"><strong>Textbox</strong></span> to the Main Form and change the <span class="strong"><strong>Name</strong></span> property to <code class="literal">txtEmpId</code>. Change the <span class="strong"><strong>Location</strong></span> property to <code class="literal">70, 20</code>.</li><li class="listitem">Add <span class="strong"><strong>GroupBox</strong></span> to the Main Form. Change the Groupbox <span class="strong"><strong>Size</strong></span> property to <code class="literal">250,103</code>, the <span class="strong"><strong>Location</strong></span> property to <code class="literal">6, 40</code>, and the <span class="strong"><strong>Text</strong></span> property to <code class="literal">filters</code>.</li><li class="listitem">Add <span class="strong"><strong>Label</strong></span> to the Main Form. Change the <span class="strong"><strong>Text</strong></span> property to <code class="literal">Title</code> and the <span class="strong"><strong>Location</strong></span> property to <code class="literal">6,21</code>.</li><li class="listitem">Add <span class="strong"><strong>ComboBox</strong></span> to Main Form. Change the <span class="strong"><strong>Name</strong></span> property to <code class="literal">cbEmpTitle</code> and the <span class="strong"><strong>Location</strong></span> property to <code class="literal">56,17</code>.</li><li class="listitem">Add <span class="strong"><strong>Label</strong></span> to Main Form. Change the <span class="strong"><strong>Text</strong></span> property to <code class="literal">City</code> and the <span class="strong"><strong>Location</strong></span> property to <code class="literal">6,50</code>.</li><li class="listitem">Add <span class="strong"><strong>ComboBox</strong></span> to Main Form. Change the <span class="strong"><strong>Name</strong></span> property to <code class="literal">cbEmpCity</code> and the <span class="strong"><strong>Location</strong></span> property to <code class="literal">56,46</code>.</li><li class="listitem">Add <span class="strong"><strong>Label</strong></span> to Main <a id="id55" class="indexterm"/>Form. Change the <span class="strong"><strong>Text</strong></span> property to <code class="literal">Country</code> and the <a id="id56" class="indexterm"/><span class="strong"><strong>Location</strong></span> property to <code class="literal">6,76</code>.</li><li class="listitem">Add <span class="strong"><strong>ComboBox</strong></span> to Main Form. Change the Name property to <code class="literal">cbEmpCountry</code> and the <span class="strong"><strong>Location</strong></span> property to <code class="literal">56,72</code>.</li><li class="listitem">Add <span class="strong"><strong>Button</strong></span> to Main Form. Change the <span class="strong"><strong>Name</strong></span> property to <code class="literal">btnEmpAll</code>, the <span class="strong"><strong>Location</strong></span> property to <code class="literal">6,152</code>, and the <span class="strong"><strong>Text</strong></span> property to <code class="literal">All</code>.</li><li class="listitem">Add <span class="strong"><strong>Button</strong></span> to Main Form. Change the <span class="strong"><strong>Name</strong></span> property to <code class="literal">btnEmpById</code>, the <span class="strong"><strong>Location</strong></span> property to <code class="literal">99,152</code>, and the <span class="strong"><strong>Text</strong></span> property to <code class="literal">By Id</code>.</li><li class="listitem">Add <span class="strong"><strong>Button</strong></span> to Main Form. Change the <span class="strong"><strong>Name</strong></span> property to <code class="literal">btnEmpByFilters</code>, the <span class="strong"><strong>Location</strong></span> property to <code class="literal">196,152</code> and the <span class="strong"><strong>Text</strong></span> property to <code class="literal">By filters</code>.</li></ol></div><p>The final design will look like the following screenshot:</p><div class="mediaobject"><img src="graphics/8026_02_07.jpg" alt="Beginning your design process"/></div></div></div><div class="section" title="Products and orders"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec14"/>Products and orders</h2></div></div></div><p>In this part, we will <a id="id57" class="indexterm"/>see the relationship between products and orders in order to<a id="id58" class="indexterm"/> demonstrate, which products have higher orders. Because we have a lot of product categories and orders from different countries, we filter our report by products category and countries.</p><div class="section" title="Beginning your design process"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl3sec03"/>Beginning your design process</h3></div></div></div><p>After we finished the design of employees section, let's start designing the products and orders section.</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">From <span class="strong"><strong>Toolbox</strong></span> explorer, drag-and-drop <span class="strong"><strong>GroupBox</strong></span> to the Main Form. Change the GroupBox <span class="strong"><strong>Size</strong></span> property to <code class="literal">284,136</code>, the <span class="strong"><strong>Location</strong></span> property to <code class="literal">12,204</code> and the <span class="strong"><strong>Text</strong></span> property to <code class="literal">Products – Orders</code>.</li><li class="listitem">Add <span class="strong"><strong>GroupBox</strong></span> to the Main Form. Change the GroupBox <span class="strong"><strong>Size</strong></span> property to <code class="literal">264,77</code>, the <span class="strong"><strong>Location</strong></span> property to <code class="literal">6,20</code>, and the <span class="strong"><strong>Text</strong></span> property to <code class="literal">filters</code>.</li><li class="listitem">Add <span class="strong"><strong>Label</strong></span> to the Main Form, change the <span class="strong"><strong>Text</strong></span> property to <code class="literal">Category</code>, and the <span class="strong"><strong>Location</strong></span> property to <code class="literal">6,25</code>.</li><li class="listitem">Add <span class="strong"><strong>ComboBox</strong></span> to the Main Form. Change the <span class="strong"><strong>Name</strong></span> Property to <code class="literal">cbProductsCategory</code>, and the <span class="strong"><strong>Location</strong></span> property to <code class="literal">61,20</code>.</li><li class="listitem">Add <span class="strong"><strong>Label</strong></span> to the Main Form. Change the <span class="strong"><strong>Text</strong></span> property to <code class="literal">Country</code> and the <span class="strong"><strong>Location</strong></span> property to <code class="literal">6,51</code>.</li><li class="listitem">Add <span class="strong"><strong>ComboBox</strong></span> to the Main Form. Change the <span class="strong"><strong>Name</strong></span> property to <code class="literal">cbOrdersCountry</code> and the <span class="strong"><strong>Location</strong></span> property to <code class="literal">61,47</code>.</li><li class="listitem">Add <span class="strong"><strong>Button</strong></span> to the Main Form. Change the <span class="strong"><strong>Name</strong></span> property to <code class="literal">btnProductsOrdersByFilters</code>, the <span class="strong"><strong>Location</strong></span> property to <code class="literal">108,103</code>, and the <span class="strong"><strong>Text</strong></span> property to <code class="literal">By filters</code>.</li></ol></div><p>The final design looks like the following screenshot:</p><div class="mediaobject"><img src="graphics/8026_02_08.jpg" alt="Beginning your design process"/></div></div></div><div class="section" title="Employees and orders"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec15"/>Employees and orders</h2></div></div></div><p>In this part we will<a id="id59" class="indexterm"/> see the relationship between employees and orders in order to evaluate the<a id="id60" class="indexterm"/> performance of each employee. In this section we will filter data by a period of time.</p><div class="section" title="Beginning your design process"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl3sec04"/>Beginning your design process</h3></div></div></div><p>In this section we will start to design the last section in our application employees and orders.</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">From <span class="strong"><strong>Toolbox</strong></span> explorer, drag -and-drop <span class="strong"><strong>GroupBox</strong></span> to the Main Form. Change the <span class="strong"><strong>Size</strong></span> property of GroupBox to <code class="literal">284,175</code>, the <span class="strong"><strong>Location</strong></span> property to <code class="literal">14,346</code>, and the <span class="strong"><strong>Text</strong></span> property to <code class="literal">Employees - Orders</code>.</li><li class="listitem">Add <span class="strong"><strong>GroupBox</strong></span> to the Main Form. Change the GroupBox <span class="strong"><strong>Size</strong></span> property to <span class="strong"><strong>264,77</strong></span>, the <span class="strong"><strong>Location</strong></span> property to <code class="literal">6,25</code>, and the <span class="strong"><strong>Text</strong></span> property to <code class="literal">filters</code>.</li><li class="listitem">Add <span class="strong"><strong>Label</strong></span> to the Main Form. Change the <span class="strong"><strong>Text</strong></span> property to <code class="literal">From</code> and the <span class="strong"><strong>Location</strong></span> property to <code class="literal">7,29</code>.</li><li class="listitem">Add <span class="strong"><strong>DateTimePicke</strong></span>r to the Main Form and change the <span class="strong"><strong>Name</strong></span> property to <code class="literal">dtpFrom</code>. Change the <span class="strong"><strong>Location</strong></span> property to <code class="literal">41,25</code>, the <span class="strong"><strong>Format</strong></span> property to <code class="literal">Short</code>, and the <span class="strong"><strong>Value</strong></span> property to <code class="literal">1/1/1996</code>.</li><li class="listitem">Add <span class="strong"><strong>Label</strong></span> to the Main Form. Change the <span class="strong"><strong>Text</strong></span> property to <code class="literal">To</code> and the <span class="strong"><strong>Location</strong></span> property to <code class="literal">7,55</code>.</li><li class="listitem">Add <span class="strong"><strong>DateTimePicker</strong></span> to the Main Form. Change the <span class="strong"><strong>Name</strong></span> property to <code class="literal">dtpTo</code>, the <span class="strong"><strong>Location</strong></span> property to <code class="literal">41,51</code>, the <span class="strong"><strong>Format</strong></span> property to <code class="literal">Short</code>, and the <span class="strong"><strong>Value</strong></span> property to <code class="literal">12/30/1996</code>.</li><li class="listitem">Add <span class="strong"><strong>Button</strong></span> to the Main Form. Change the <span class="strong"><strong>Name</strong></span> property to <code class="literal">btnBarChart</code>, the <span class="strong"><strong>Location</strong></span> property to <code class="literal">15,117</code>, and the <span class="strong"><strong>Text</strong></span> property to <code class="literal">Bar chart</code>.</li><li class="listitem">Add <span class="strong"><strong>Button</strong></span> to the Main Form and change the <span class="strong"><strong>Name</strong></span> property to <code class="literal">btnPieChart</code>. Change the <span class="strong"><strong>Location</strong></span> property to <code class="literal">99,117</code> and the <span class="strong"><strong>Text</strong></span> property to <code class="literal">Pie chart</code>.</li><li class="listitem">Add <span class="strong"><strong>Button</strong></span> to the Main Form. Change the <span class="strong"><strong>Name</strong></span> Property to <code class="literal">btnGaugeChart</code>, the <span class="strong"><strong>Location</strong></span> property to <code class="literal">186, 117</code>, and the <span class="strong"><strong>Text</strong></span> property to <code class="literal">Gauge chart</code>.</li><li class="listitem">Add <span class="strong"><strong>Button</strong></span> to the Main Form. Change the <span class="strong"><strong>Name</strong></span> property to <code class="literal">btnAllInOne</code>, the <span class="strong"><strong>Location</strong></span> property to <code class="literal">63,144</code>, and the <span class="strong"><strong>Text</strong></span> property to <code class="literal">All In One</code>.</li></ol></div><p>The final design looks like the following screenshot:</p><div class="mediaobject"><img src="graphics/8026_02_09.jpg" alt="Beginning your design process"/></div><p>You can change <a id="id61" class="indexterm"/>
<span class="strong"><strong>Location</strong></span>, <span class="strong"><strong>Size</strong></span>, and <span class="strong"><strong>Text</strong></span> properties as you wish; but don't change the <span class="strong"><strong>Name</strong></span>
<a id="id62" class="indexterm"/> property because we will use it in code in the next chapters.</p></div></div></div>
<div class="section" title="Validating form data"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec15"/>Validating form data</h1></div></div></div><p>When you start designing your <a id="id63" class="indexterm"/>application, you need to think of some facts, such as performance and graphical user interface (GUI). One of the most important rules you need to take into account to build a good application is the ease of use. You need to make sure that the user is comfortable with your application. Reduce the amount of data that the user has to enter into your application. In our application therefore, you will see that we use <span class="strong"><strong>GroupBox</strong></span> more than <span class="strong"><strong>Textbox</strong></span> because selecting data is easy and safe when we use <span class="strong"><strong>GroupBox</strong></span>. We will see how to fill all GroupBox controls with the corresponding data in the next chapter.</p></div>
<div class="section" title="Sketching your reports on paper"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec16"/>Sketching your reports on paper</h1></div></div></div><p>Our application will be <a id="id64" class="indexterm"/>kept simple and complete and will be designed as a single form with common reporting types. All reports will be displayed in another form containing a <span class="strong"><strong>Crystal Report Viewer</strong></span> as we will see in the next chapters. Every button in the Main Form is designed to display a report.</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The <code class="literal">btnEmpAll</code> button<a id="id65" class="indexterm"/> will display a report containing all employees' data and it will look like the following screenshot:<div class="mediaobject"><img src="graphics/8026_02_10.jpg" alt="Sketching your reports on paper"/></div></li><li class="listitem" style="list-style-type: disc">The <code class="literal">btnEmpById</code> button<a id="id66" class="indexterm"/> will display a report containing the data for a specific employee and it will look like the following screenshot:<div class="mediaobject"><img src="graphics/8026_02_11.jpg" alt="Sketching your reports on paper"/></div></li><li class="listitem" style="list-style-type: disc">The <code class="literal">btnEmpByFilters</code> button<a id="id67" class="indexterm"/> will display a report containing employee data and filter these employees using data in <code class="literal">cbEmpTitle</code>, <code class="literal">cbEmpCity</code>, and the <code class="literal">cbEmpCountry</code> GroupBoxes as we see in the following screenshot:<div class="mediaobject"><img src="graphics/8026_02_12.jpg" alt="Sketching your reports on paper"/></div></li><li class="listitem" style="list-style-type: disc">The <code class="literal">btnProductsOrdersByFilters</code> button<a id="id68" class="indexterm"/> will display a cross-tab report to see the <a id="id69" class="indexterm"/>relationship between products and orders. We will filter the data using data in <code class="literal">cbProductsCategory</code> and the <code class="literal">cbOrdersCountry</code> GroupBoxes, as shown in the following screenshot:<div class="mediaobject"><img src="graphics/8026_02_13.jpg" alt="Sketching your reports on paper"/></div></li><li class="listitem" style="list-style-type: disc">The <code class="literal">btnBarChart</code> button<a id="id70" class="indexterm"/> will display a bar chart report to see relations between employees and orders. We will filter data using the data in <code class="literal">dtpFrom</code> and the <code class="literal">dtpTo</code> DateTimePicker, as shown in the following screenshot:<div class="mediaobject"><img src="graphics/8026_02_14.jpg" alt="Sketching your reports on paper"/></div></li><li class="listitem" style="list-style-type: disc">The <code class="literal">btnPieChart</code> button<a id="id71" class="indexterm"/> will display a pie chart report to display the relationship between <a id="id72" class="indexterm"/>employees and orders. We will filter data using data in <code class="literal">dtpFrom</code> and the <code class="literal">dtpTo</code> DateTimePicker as shown in the following screenshot.<div class="mediaobject"><img src="graphics/8026_02_15.jpg" alt="Sketching your reports on paper"/></div></li><li class="listitem" style="list-style-type: disc">The <code class="literal">btnGaugeChart</code> button<a id="id73" class="indexterm"/> will display a gauge chart report showing the relationship between employees and orders. We will filter data using data in the <code class="literal">dtpFrom</code> and the <code class="literal">dtpTo</code> DateTimePicker as shown in the following screenshot:<div class="mediaobject"><img src="graphics/8026_02_16.jpg" alt="Sketching your reports on paper"/></div></li><li class="listitem" style="list-style-type: disc">The<a id="id74" class="indexterm"/> <code class="literal">btnAllInOne</code> button <a id="id75" class="indexterm"/>will display a report similar to the following screenshot:<div class="mediaobject"><img src="graphics/8026_02_17.jpg" alt="Sketching your reports on paper"/></div></li></ul></div></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec17"/>Summary</h1></div></div></div><p>In this chapter we discussed the design of our application. The application contains most Crystal Reports types. In the next chapter, we will start the development of our application. We will also learn how to select the data we need to display before creating our report.</p></div></body></html>