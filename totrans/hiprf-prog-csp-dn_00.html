<html><head></head><body>
		<div><h1 id="_idParaDest-5"><a id="_idTextAnchor004"/>Preface</h1>
			<p>Writing high-performance code while building an application is crucial, and over the years, Microsoft has focused on delivering various performance-related improvements within the .NET ecosystem. This book will help you understand the aspects involved in designing responsive, resilient, and high-performance applications with the new versions of C# and .NET.</p>
			<p>You will start by understanding the foundation of high-performance code and the latest performance-related improvements in C# 10.0 and .NET 6. Next, you’ll learn how to use tracing and diagnostics to track down performance issues and the cause of memory leaks. The chapters that follow then show you how to enhance the performance of your networked applications and various ways to improve directory tasks, file tasks, and more. You’ll go on to improve data querying performance and write responsive user interfaces. You’ll also discover how you can use cloud providers such as Microsoft Azure to build scalable distributed solutions. Finally, you’ll explore various ways to process code synchronously, asynchronously, and in parallel to reduce the time it takes to process a series of tasks.</p>
			<p>By the end of this C# programming book, you’ll have the confidence you need to build highly resilient, high-performance applications that meet your customer’s demands.</p>
			<h1 id="_idParaDest-6"><a id="_idTextAnchor005"/>Who this book is for</h1>
			<p>This book is for software engineers, professional software developers, performance engineers, and application profilers looking to improve the speed of their code or take their skills to the next level to gain a competitive advantage. You should be a proficient C# programmer who can already put the language to good use and is also comfortable using Microsoft Visual Studio 2022.</p>
			<h1 id="_idParaDest-7"><a id="_idTextAnchor006"/>What this book covers</h1>
			<p><a href="B16617_01_Final_SB_Epub.xhtml#_idTextAnchor014"><em class="italic">Chapter 1</em></a>, <em class="italic">Introducing C# 10.0 and .NET 6</em>, talks about the <strong class="bold">Common Language Runtime</strong> (<strong class="bold">CLR</strong>). You will start by learning about what’s new in C# 10.0 and .NET 6. Then you will learn about the .NET native runtime and CoreCLR. Next, you will learn about the unified BCL followed by Windows Store performance. Finally, you will learn about ASP.NET 5 performance.</p>
			<p><a href="B16617_02_Final_SB_Epub.xhtml#_idTextAnchor040"><em class="italic">Chapter 2</em></a>, <em class="italic">Implementing C# Interoperability</em>, introduces Microsoft .NET interoperability. You will learn how to call and dispose of unsafe code. You will also learn how to migrate legacy COM programs to .NET using COM interoperability. In this chapter, you will learn how to create .NET libraries and components and use them in legacy COM applications. By the end of the chapter, you will have learned how to consume COM components in .NET and how to consume .NET applications in COM components. This will help you to migrate COM applications over to the .NET platform.</p>
			<p><a href="B16617_03_Final_SB_Epub.xhtml#_idTextAnchor053"><em class="italic">Chapter 3</em></a>, <em class="italic">Predefined Data Types and Memory Allocations</em>, explores C# primitive types and C# object types. You will learn about the stack and the heap and about passing data by reference and by value. Then you will learn about boxing and unboxing and their implications on application performance. You will also be refreshed on the C# primitive type, and how to build objects that perform well.</p>
			<p><a href="B16617_04_Final_SB_Epub.xhtml#_idTextAnchor072"><em class="italic">Chapter 4</em></a>, <em class="italic">Memory Management</em>, talks about the garbage collector. You will learn how to use tracing and diagnostics to track down performance issues and the cause of memory leaks. Then you will learn about object generations and how the garbage collector decides what to dispose of. You will also learn about weak references and how to correctly dispose of objects in order to prevent memory leaks.</p>
			<p><a href="B16617_05_Final_SB_Epub.xhtml#_idTextAnchor085"><em class="italic">Chapter 5</em></a>, <em class="italic">Application Profiling and Tracing</em>, teaches you how to profile your applications to identify poor areas of performance. You will learn about code metrics and how to perform static code analysis. In your drive to write code that is more performant, you will learn to make use of memory dumps, the loaded modules viewer, debugging, tracing, and dotnet-counters. By the time you have completed this chapter, you will have the skills and experience you need to profile your own applications.</p>
			<p><a href="B16617_06_Final_SB_Epub.xhtml#_idTextAnchor117"><em class="italic">Chapter 6</em></a>, <em class="italic">The .NET Collections</em>, explores the collections framework. You will learn about the different collections and how to best use them to get maximum performance from them. You will access the various collections in the <code>System.Collection</code>, <code>System.Collection.Concurrent</code>, and <code>System.Collections.Generic</code> namespaces. You will also create your own custom exceptions and learn how to query collections using LINQ.</p>
			<p><a href="B16617_07_Final_SB_Epub.xhtml#_idTextAnchor139"><em class="italic">Chapter 7</em></a>, <em class="italic">LINQ Performance</em>, explains how to perform LINQ queries with performance in mind. Depending on how you use LINQ, different methods that return the same result can behave and perform differently. And so, in this chapter, you will learn how best to perform queries on LINQ to improve the performance of your applications.</p>
			<p><a href="B16617_08_Final_SB_Epub.xhtml#_idTextAnchor152"><em class="italic">Chapter 8</em></a>, <em class="italic">File and Stream I/O</em>, explains how to improve file and directory performance. You will learn ways to improve directory tasks, file tasks, memory tasks, and isolated storage tasks. In this book, you will learn how to write to files asynchronously and read from files asynchronously.</p>
			<p><a href="B16617_09_Final_SB_Epub.xhtml#_idTextAnchor168"><em class="italic">Chapter 9</em></a>, <em class="italic">Enhancing the Performance of Networked Applications</em>, breaks down how to speed up the performance of network applications. You will learn how to communicate over a network using the TCP and UDP network protocols. Then you will learn how to perform network tracing processes with the OSI Network Layer Reference Model and a selection of TCP and UDP networking protocols. Cache management will also be covered so that you can improve the efficiency of resource retrieval.</p>
			<p><a href="B16617_10_Final_SB_Epub.xhtml#_idTextAnchor189"><em class="italic">Chapter 10</em></a><em class="italic">, Setting Up Our Database Project</em>, sets up the Northwind database project on SQL Server as we will be using this database in the next section to benchmark data access methods.</p>
			<p><a href="B16617_11_Final_SB_Epub.xhtml#_idTextAnchor205"><em class="italic">Chapter 11</em></a>, <em class="italic">Benchmarking Relational Data Access Frameworks</em>, benchmarks three different ways to manipulate SQL Server database data. We will be performing a side-by-side comparison of Entity Framework, ADO.NET, and Dapper.NET. After running the benchmarks for each of these data access and object mappers, you will be able to make an educated judgment call on the best form of data access and object mapping for your projects.</p>
			<p><a href="B16617_12_Final_SB_Epub.xhtml#_idTextAnchor215"><em class="italic">Chapter 12</em></a>, <em class="italic">Responsive User Interfaces</em>, explains how to write responsive user interfaces. You will write responsive <strong class="bold">Windows Forms</strong> (<strong class="bold">WinForms</strong>), <strong class="bold">Windows Presentation Foundation</strong> (<strong class="bold">WPF</strong>), ASP.NET, .NET MAUI, and WinUI applications. Using background worker threads, you will see how you can update and work with the user interface in real time by running long-running tasks in the background.</p>
			<p><a href="B16617_13_Final_SB_Epub.xhtml#_idTextAnchor239"><em class="italic">Chapter 13</em></a>, <em class="italic">Distributed Systems</em>, describes distributed applications and explains how to improve their performance. You will learn how to build performant distributed applications using the <strong class="bold">Command Query Responsibility Separation</strong> (<strong class="bold">CQRS</strong>) software design pattern, event sourcing, and microservices. You will see how to use cloud providers such as Microsoft Azure to build scalable distributed solutions using Cosmos DB, Azure Functions, and the open source Pulumi infrastructure tool.</p>
			<p><a href="B16617_14_Final_SB_Epub.xhtml#_idTextAnchor254"><em class="italic">Chapter 14</em></a>, <em class="italic">Multi-Threaded Programming</em>, explores what threads and threading are and discusses background and foreground threads. Then you will learn how to pass data into threads before you run them. You will also learn how to pause, interrupt, destroy, schedule, and cancel threads.</p>
			<p><a href="B16617_15_Final_SB_Epub.xhtml#_idTextAnchor266"><em class="italic">Chapter 15</em></a>, <em class="italic">Parallel Programming</em>, explains how to take advantage of the multiple CPU cores that are available in today’s modern computers. You will learn how to process your code by distributing the work between processes concurrently.</p>
			<p><a href="B16617_16_Final_SB_Epub.xhtml#_idTextAnchor280"><em class="italic">Chapter 16</em></a>, <em class="italic">Asynchronous Programming</em>, demystifies the <code>async</code>, <code>await</code>, and <code>WhenAll</code>. You will also look at different return types, how to extract the required results, and how to correctly cancel asynchronous operations and perform asynchronous file reading and writing.</p>
			<h1 id="_idParaDest-8"><a id="_idTextAnchor007"/>To get the most out of this book</h1>
			<p>You will need to be proficient in C# and know how to use Visual Studio 2022 to create, run, and debug C# programs and install NuGet packages. You will get the most from this book if you follow along, write the code, and use the tools specified. But if you are too busy, follow Microsoft’s guidance for obtaining and installing the following software.</p>
			<div><div><img src="img/Preface_Table.jpg" alt=""/>
				</div>
			</div>
			<p><strong class="bold">If you are using the digital version of this book, we advise you to type the code yourself or access the code from the book’s GitHub repository (a link is available in the next section). Doing so will help you avoid any potential errors related to the copying and pasting of code.</strong></p>
			<p>Please try and answer the questions, read the external resources provided at the end of each chapter, and put what you have learned into action in your own programming and performance training exercises. This will help to reinforce what you have learned throughout this book.</p>
			<h1 id="_idParaDest-9"><a id="_idTextAnchor008"/>Download the example code files</h1>
			<p>You can download the example code files for this book from GitHub at <a href="https://github.com/PacktPublishing/High-Performance-Programming-in-CSharp-and-.NET">https://github.com/PacktPublishing/High-Performance-Programming-in-CSharp-and-.NET</a>. If there’s an update to the code, it will be updated in the GitHub repository.</p>
			<p>We also have other code bundles from our rich catalog of books and videos available at <a href="https://github.com/PacktPublishing/">https://github.com/PacktPublishing/</a>. Check them out!</p>
			<h1 id="_idParaDest-10"><a id="_idTextAnchor009"/>Download the color images</h1>
			<p>We also provide a PDF file that has color images of the screenshots and diagrams used in this book. You can download it here: <a href="https://packt.link/hQmsb">https://packt.link/hQmsb</a>.</p>
			<h1 id="_idParaDest-11"><a id="_idTextAnchor010"/>Conventions used</h1>
			<p>There are a number of text conventions used throughout this book.</p>
			<p><code>Code in text</code>: Indicates code words in text, database table names, folder names, filenames, file extensions, pathnames, dummy URLs, user input, and Twitter handles. Here is an example: “The <code>enum</code> data type is 4 bytes (32 bits) in size, nullable, and has a minimum value of 0. You can measure the size of a value type using <code>sizeof(Type type)</code>.”</p>
			<p>A block of code is set as follows:</p>
			<pre class="source-code">static void Main(string[] _) </pre>
			<pre class="source-code">{ </pre>
			<pre class="source-code">Console.WriteLine(“Chapter 3: Strings are immutable”); </pre>
			<pre class="source-code">var greeting1 = “Hello, world!”; </pre>
			<pre class="source-code">var greeting2 = greeting1; </pre>
			<pre class="source-code">Console.WriteLine($”greeting1={greeting1}”); </pre>
			<pre class="source-code">Console.WriteLine($”greeting2={greeting2}”); </pre>
			<pre class="source-code">greeting1 += “ Isn’t life grand!”; </pre>
			<pre class="source-code">Console.WriteLine($”greeting1={greeting1}”); </pre>
			<pre class="source-code">Console.WriteLine($”greeting1={greeting2}”); </pre>
			<pre class="source-code">} </pre>
			<p>When we wish to draw your attention to a particular part of a code block, the relevant lines or items are set in bold:</p>
			<pre class="source-code"><strong class="bold">git clone https://github.com/dotnet/roslyn.git</strong></pre>
			<p>Any command-line input or output is written as follows:</p>
			<pre>csc /help
csc -langversion:10.0 /out:HelloWorld.exe Program.cs
csc HelloWorld
cd css</pre>
			<p><strong class="bold">Bold</strong>: Indicates a new term, an important word, or words that you see onscreen. For instance, words in menus or dialog boxes appear in <strong class="bold">bold</strong>. Here is an example: “Make sure the project is set to <strong class="bold">Debug</strong> mode, and then step through the code.”</p>
			<p class="callout-heading">Tips or important notes	</p>
			<p class="callout">Appear like this.</p>
			<h1 id="_idParaDest-12"><a id="_idTextAnchor011"/>Get in touch</h1>
			<p>Feedback from our readers is always welcome.</p>
			<p><strong class="bold">General feedback</strong>: If you have questions about any aspect of this book, email us at <a href="mailto:customercare@packtpub.com">customercare@packtpub.com</a> and mention the book title in the subject of your message.</p>
			<p><strong class="bold">Errata</strong>: Although we have taken every care to ensure the accuracy of our content, mistakes do happen. If you have found a mistake in this book, we would be grateful if you would report this to us. Please visit <a href="http://www.packtpub.com/support/errata">www.packtpub.com/support/errata</a> and fill in the form.</p>
			<p><strong class="bold">Piracy</strong>: If you come across any illegal copies of our works in any form on the internet, we would be grateful if you would provide us with the location address or website name. Please contact us at <a href="mailto:copyright@packt.com">copyright@packt.com</a> with a link to the material.</p>
			<p><strong class="bold">If you are interested in becoming an author</strong>: If there is a topic that you have expertise in and you are interested in either writing or contributing to a book, please visit <a href="http://authors.packtpub.com">authors.packtpub.com</a>.</p>
			<h1 id="_idParaDest-13"><a id="_idTextAnchor012"/>Share Your Thoughts</h1>
			<p>Now you’ve finished <em class="italic">High-Performance Programming in C# and .NET</em>, we’d love to hear your thoughts! If you purchased the book from Amazon, please <a href="https://packt.link/r/1-800-56471-6">click here to go straight to the Amazon review page</a> for this book and share your feedback or leave a review on the site that you purchased it from.</p>
			<p>Your review is important to us and the tech community and will help us make sure we’re delivering excellent quality content.</p>
		</div>
	</body></html>