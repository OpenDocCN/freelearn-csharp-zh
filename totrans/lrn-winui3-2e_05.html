<html><head></head><body>
		<div><h1 id="_idParaDest-114" class="chapter-number"><a id="_idTextAnchor114"/>5</h1>
			<h1 id="_idParaDest-115"><a id="_idTextAnchor115"/>Exploring WinUI Controls</h1>
			<p>WinUI 3 and the Windows App SDK offer many controls and APIs for developers building desktop applications for Windows. The WinUI controls include some controls not previously available to Windows developers, as well as updated controls that were already available in WinUI 2.x<a id="_idIndexMarker373"/> and <strong class="bold">UWP</strong>. Using these new and updated controls with WinUI 3 enables their use in older versions of Windows that did not previously support this full suite of components. Developers can also leverage Windows App SDK APIs to get direct access to Windows features.</p>
			<p>In this chapter, we will cover the following topics:</p>
			<ul>
				<li>Learning more about the controls that are available in WinUI 3</li>
				<li>Exploring the <strong class="bold">WinUI 3 Gallery</strong> app for Windows to learn about the WinUI controls and design guidance</li>
				<li>How other Windows App SDK APIs provide Windows developers access to features such as power management and notifications</li>
				<li>How to implement <code>SplitButton</code> and <code>TeachingTip</code> controls in your own apps</li>
			</ul>
			<p>By the end of this chapter, you will have a greater understanding of the controls and libraries in WinUI 3. You will also feel comfortable using the WinUI 3 Gallery app for Windows to explore the controls and find samples that demonstrate how to use them.</p>
			<h1 id="_idParaDest-116"><a id="_idTextAnchor116"/>Technical requirements</h1>
			<p>To follow along with the examples in this chapter, please reference the <em class="italic">Technical requirements</em> section of <a href="B20908_02.xhtml#_idTextAnchor044"><em class="italic">Chapter 2</em></a>, <em class="italic">Configuring the Development Environment and Creating </em><em class="italic">the Project</em>.</p>
			<p>The source code for this chapter is available on GitHub here: <a href="https://github.com/PacktPublishing/Learn-WinUI-3-Second-Edition/tree/master/Chapter05">https://github.com/PacktPublishing/Learn-WinUI-3-Second-Edition/tree/master/Chapter05</a>.</p>
			<h1 id="_idParaDest-117"><a id="_idTextAnchor117"/>Understanding what WinUI offers developers</h1>
			<p>In <a href="B20908_01.xhtml#_idTextAnchor015"><em class="italic">Chapter 1</em></a>, <em class="italic">Introduction to WinUI</em>, you learned<a id="_idIndexMarker374"/> some background information about the origins of WinUI and UWP. That chapter also covered some of the controls available in the various releases of WinUI. Now, it’s time to explore a few of these in more detail. Let’s start by looking at a list of controls available to developers in WinUI 3:</p>
			<div><div><img src="img/B20908_05_01.jpg" alt="Figure 5.1 – List of WinUI 3 controls"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.1 – List of WinUI 3 controls</p>
			<p>This is quite an extensive list of<a id="_idIndexMarker375"/> controls available to developers in the Windows App SDK.</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">For an up-to-date list of the available controls, you can check this page on <em class="italic">Microsoft </em><em class="italic">Learn</em>: <a href="https://learn.microsoft.com/windows/apps/design/controls/#alphabetical-index">https://learn.microsoft.com/windows/apps/design/controls/#alphabetical-index</a>.</p>
			<p>If you have developed Windows applications before, most of these control names probably look familiar to you. In the sections ahead, we’ll get an overview of some controls that you may not have seen before.</p>
			<h2 id="_idParaDest-118"><a id="_idTextAnchor118"/>Animated visual player (Lottie)</h2>
			<p>The <code>AnimatedVisualPlayer</code> control, shown <a id="_idIndexMarker376"/>in <em class="italic">Figure 5</em><em class="italic">.2</em>, is a WinUI control that can<a id="_idIndexMarker377"/> display <strong class="bold">Lottie animations</strong>. Lottie is an open source library that can parse and display animations on Windows, the web, iOS, and Android. These animations are created by designers in tools such <a id="_idIndexMarker378"/>as <strong class="bold">Adobe After Effects</strong> and exported in JSON format. You can learn more about Lottie animations<a id="_idIndexMarker379"/> at the official website, <a href="http://airbnb.io/lottie/#/">http://airbnb.io/lottie/#/</a>:</p>
			<div><div><img src="img/B20908_05_02.jpg" alt="Figure 5.2 – The AnimatedVisualPlayer control"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.2 – The AnimatedVisualPlayer control</p>
			<h2 id="_idParaDest-119"><a id="_idTextAnchor119"/>Navigation View</h2>
			<p><code>NavigationView</code> provides a<a id="_idIndexMarker380"/> user-friendly page navigation system. Use it to give users quick access to all your application’s top-level pages. <code>NavigationView</code> can be configured to appear as a menu at the top of the application, with each page’s link appearing like a tab across the top of the page:</p>
			<div><div><img src="img/B20908_05_03.jpg" alt="Figure 5.3 – NavigationView configured at the top of a page"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.3 – NavigationView configured at the top of a page</p>
			<p><code>NavigationView</code> can also <a id="_idIndexMarker381"/>be configured to appear on the left-hand side of the page. This is a view that should be familiar to Windows and Android users. This menu format is commonly known as<a id="_idIndexMarker382"/> a <strong class="bold">hamburger menu</strong>. This is how the view appears when the menu is in a collapsed state:</p>
			<div><div><img src="img/B20908_05_04.jpg" alt="Figure 5.4 – A collapsed left NavigationView control"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.4 – A collapsed left NavigationView control</p>
			<p>In either configuration, <code>NavigationView</code> can hide or show a back arrow to navigate to the previous page and has a <strong class="bold">Settings</strong> menu item to show the application’s settings page. If your application does not have a settings page, this item should be hidden. When the left menu is<a id="_idIndexMarker383"/> expanded by clicking the <em class="italic">hamburger</em> icon below the back arrow, the menu text is displayed, along with the respective icons:</p>
			<div><div><img src="img/B20908_05_05.jpg" alt="Figure 5.5 – The expanded left NavigationView control"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.5 – The expanded left NavigationView control</p>
			<p>Everything on the menu is configurable. You can group pages with the <code>NavigationView</code>.</p>
			<h2 id="_idParaDest-120"><a id="_idTextAnchor120"/>Parallax view</h2>
			<p><code>ParallaxView</code> control brings this concept to your WinUI applications. You link <code>ParallaxView</code> to <code>ListView</code> and a background image, and it will provide a parallax effect when <code>ListView</code> is scrolled. There are settings to control the relationship between scrolling the list and<a id="_idIndexMarker385"/> the amount the image scrolls. This effect has a great impact on users when it is not overused:</p>
			<div><div><img src="img/B20908_05_06.jpg" alt="Figure 5.6 – The ParallaxView control scrolled to the top of a list"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.6 – The ParallaxView control scrolled to the top of a list</p>
			<div><div><img src="img/B20908_05_07.jpg" alt="Figure 5.7 – The ParallaxView control scrolled partially through a list"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.7 – The ParallaxView control scrolled partially through a list</p>
			<h2 id="_idParaDest-121"><a id="_idTextAnchor121"/>Rating control</h2>
			<p>Everyone is familiar with rating controls. You see them on shopping websites, streaming apps, and online surveys. The WinUI <code>RatingControl</code> control<a id="_idIndexMarker386"/> allows users to rate items in your application from 1 to 5 stars:</p>
			<div><div><img src="img/B20908_05_08.jpg" alt="Figure 5.8 – RatingControl displaying the user’s rating"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.8 – RatingControl displaying the user’s rating</p>
			<p>The control can also <a id="_idIndexMarker387"/>allow you to clear a rating by swiping left on the control and can show a placeholder value before the user has provided their own rating. Applications frequently use the placeholder value as a means of showing users the average rating given by other users.</p>
			<p>Now that we have discussed a few of the controls that were added with WinUI, let’s explore a Windows application that makes it easy to explore them on your own.</p>
			<h1 id="_idParaDest-122"><a id="_idTextAnchor122"/>Exploring the WinUI 3 Gallery app for Windows</h1>
			<p>Because there are so many powerful and configurable WinUI controls available, the WinUI team at Microsoft decided to create an application that allows Windows developers to explore and even try <a id="_idIndexMarker388"/>the controls. <strong class="bold">WinUI 3 Gallery</strong> is a great tool to get familiar with the controls, decide which ones are a good fit for your application, and get some sample code and design guidance.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">There is also a <strong class="bold">WinUI 2 Gallery</strong> app<a id="_idIndexMarker389"/> for UWP developers. The two apps used to be a single app <a id="_idIndexMarker390"/>called <strong class="bold">XAML </strong><strong class="bold">Controls Gallery</strong>.</p>
			<p>To install the WinUI 3 Gallery app, you can visit its Microsoft Store page on the web (<a href="https://apps.microsoft.com/store/detail/winui-3-gallery/9P3JFPWWDZRC">https://apps.microsoft.com/store/detail/winui-3-gallery/9P3JFPWWDZRC</a>) or launch the Microsoft Store app for Windows and search for <code>WinUI 3 Gallery</code>. The Gallery app itself is open source. You can browse the code to learn more about it on GitHub: <a href="https://github.com/microsoft/WinUI-Gallery">https://github.com/microsoft/WinUI-Gallery</a>.</p>
			<p>Once it’s been installed, launch the application:</p>
			<div><div><img src="img/B20908_05_09.jpg" alt="Figure 5.9 – The WinUI 3 Gallery application"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.9 – The WinUI 3 Gallery application</p>
			<p>In the <code>NavigationView</code> control, and the left-hand menu allows for quickly browsing or searching the various controls in the gallery.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">If you search for the controls shown in the previous section, you may notice that the screenshots provided for the controls in this chapter were taken from the WinUI 3 Gallery application.</p>
			<h2 id="_idParaDest-123"><a id="_idTextAnchor123"/>Learning about the ScrollViewer control</h2>
			<p>Suppose you were considering adding <a id="_idIndexMarker392"/>scrolling capability to a region of a page in your application. In the gallery application, you can click <code>ScrollViewer</code> control:</p>
			<div><div><img src="img/B20908_05_10.jpg" alt="Figure 5.10 – The ScrollViewer control detail page in XAML Controls Gallery"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.10 – The ScrollViewer control detail page in XAML Controls Gallery</p>
			<p>The control details page includes <a id="_idIndexMarker393"/>several sections. The header area provides a brief description of the control and its purpose. The right pane provides useful links to online documentation, other related controls in the gallery, and a link to provide feedback on the current gallery page.</p>
			<p>The middle area of the page itself contains three sections: a rendered control, a functional control, and a properties panel. Using the properties panel, you can update some of the properties of <code>ScrollViewer</code> and see the rendered control immediately update. In the bottom center, you will find a panel containing the source code for the rendered control. The source control pane is very handy for copying the code to use as a starting point in your own project.</p>
			<p>The gallery application’s design also responds well to being resized. If you drag the right-hand side of the window to make it as narrow as possible, you will see the left and right panels collapse, and the center area will realign to a single vertical column:</p>
			<div><div><img src="img/B20908_05_011.jpg" alt="Figure 5.11 – The gallery application resized horizontally"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.11 – The gallery application resized horizontally</p>
			<p>You can<a id="_idIndexMarker394"/> imagine this view would fit well on a <strong class="bold">Microsoft Surface Go laptop</strong> or other small PC.</p>
			<p>Take some time to explore the controls in the gallery. Some of the code samples can be quite lengthy. Try changing some control properties and notice how the XAML code updates to reflect the new property values. This is a great way to learn XAML and familiarize yourself with the WinUI controls.</p>
			<p>Now, let’s take a tour of the new features of WinUI 3.</p>
			<h1 id="_idParaDest-124"><a id="_idTextAnchor124"/>Reviewing what’s new in WinUI 3 and the Windows App SDK</h1>
			<p>Although WinUI 3 is a major release, the number of new features, as compared to WinUI 2.x, is not extensive. That may be surprising to many people, but simply creating WinUI 3 and the Windows App SDK as a standalone release was quite an undertaking. We’ll look at the most significant features in the following subsections.</p>
			<h2 id="_idParaDest-125"><a id="_idTextAnchor125"/>Backward compatibility</h2>
			<p>To make WinUI applications <a id="_idIndexMarker395"/>compatible with more versions of Windows (it works with Windows 10, version 1809 and later), the WinUI team had to extract the UWP controls from the Windows SDK and move them to the new <code>Microsoft.UI.*</code> libraries in the Windows App SDK. The result of this work not only creates compatibility with more versions of Windows but also enables developers to consume WinUI, regardless of whether they are using .NET or Win32 as the underlying platform. C# developers can build .NET apps with WinUI for Desktop projects, and C++ developers can consume WinUI on the Win32 platform.</p>
			<h2 id="_idParaDest-126"><a id="_idTextAnchor126"/>Fluent UI and modern look and feel</h2>
			<p>Developers <a id="_idIndexMarker396"/>who <a id="_idIndexMarker397"/>maintain <strong class="bold">Windows Presentation Form</strong> (<strong class="bold">WPF</strong>), WinForms, and <strong class="bold">Microsoft Foundation Class</strong> (<strong class="bold">MFC</strong>) applications<a id="_idIndexMarker398"/> aren’t easily able to achieve the modern look and feel of Windows with <strong class="bold">Fluent UI</strong> the<a id="_idIndexMarker399"/> way you can in WinUI. We will be covering Fluent UI in depth in <a href="B20908_07.xhtml#_idTextAnchor152"><em class="italic">Chapter 7</em></a>, <em class="italic">Fluent Design System for </em><em class="italic">Windows Applications</em>.</p>
			<h2 id="_idParaDest-127"><a id="_idTextAnchor127"/>Visual Studio tooling</h2>
			<p>Visual Studio can<a id="_idIndexMarker400"/> now add <a id="_idIndexMarker401"/>WinUI project templates without installing a separate extension from the Visual Studio Marketplace. As discussed in the opening chapter, WinUI support can be added along with the <strong class="bold">.NET Desktop Development</strong> workload for Visual Studio. Starting a new project with WinUI in Visual Studio is literally as easy as going to <strong class="bold">File</strong> | <strong class="bold">New Project</strong>.</p>
			<h2 id="_idParaDest-128"><a id="_idTextAnchor128"/>The WebView2 control</h2>
			<p>One new control available to <a id="_idIndexMarker402"/>developers in <a id="_idIndexMarker403"/>WinUI 3 is <code>WebView2</code>. This new version of <code>WebView</code> is built on the Chromium-based Microsoft Edge web browser. If you need to embed some web content into your app, <code>WebView2</code> is the control you should use to ensure maximum compatibility with modern web standards.</p>
			<p>Here is a screenshot of <strong class="bold">WebView2</strong> running in the <strong class="bold">WinUI 3 </strong><strong class="bold">Gallery</strong> app:</p>
			<div><div><img src="img/B20908_05_12.jpg" alt="Figure 5.12 – WebView2 running in the WinUI 3 Gallery application"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.12 – WebView2 running in the WinUI 3 Gallery application</p>
			<p>Web content can be loaded into the control from the web or local network, from files in local storage, or from files embedded into the application’s binaries. Here are some examples of loading into <code>WebView2</code> from each type of source:</p>
			<pre class="source-code">
&lt;!-- Load a website. --&gt;
&lt;WebView2 x:Name="WebView_Web"
  Source="https://www.packtpub.com"/&gt;
&lt;!— Load web files from local storage. --&gt;
&lt;WebView2 x:Name="WebView_Local" Source="ms-appdata:
  ///local/site/index.html"/&gt;
&lt;!— Load web files embedded from the app package. --&gt;
&lt;WebView2 x:Name="WebView_Embedded" Source="ms-appx-
  web:///web/index.html"/&gt;</pre>			<p>If you have an existing <a id="_idIndexMarker404"/>application written for the web, then <a id="_idIndexMarker405"/>the <code>WebView2</code> control is a great way to integrate it into your new WinUI client application.</p>
			<p>Let’s shift gears for a moment and talk about some features of the Windows App SDK outside of the WinUI 3 controls.</p>
			<h2 id="_idParaDest-129"><a id="_idTextAnchor129"/>What’s new in the Windows App SDK</h2>
			<p>You know by now that WinUI 3 <a id="_idIndexMarker406"/>is a part of the Windows App SDK. The Windows App SDK has its own versions, while WinUI 3 will always be known as WinUI 3. The latest stable release of the Windows App SDK at the time of this writing is version 1.4. In this section, we will review some of the Windows App SDK features that are outside the controls in WinUI. For a complete list of the current Windows App SDK features, you can review this page on <em class="italic">Microsoft </em><em class="italic">Learn</em>: <a href="https://learn.microsoft.com/windows/apps/windows-app-sdk/#windows-app-sdk-features">https://learn.microsoft.com/windows/apps/windows-app-sdk/#windows-app-sdk-features</a>.</p>
			<h3>Power management</h3>
			<p>Your app can subscribe and respond to power management<a id="_idIndexMarker407"/> events as part of the Windows App SDK’s app lifecycle API. Some of the events exposed by the <code>PowerManager</code> class in the SDK include the following:</p>
			<ul>
				<li><code>BatteryStatusChanged</code>: Raised when the status of the battery in the system has changed. Use the <code>BatteryStatus</code> property to get the current status.</li>
				<li><code>DisplayStatusChanged</code>: Raised when the status of the display where the app is running changes. Use the <code>DisplayStatus</code> property to get the current status.</li>
				<li><code>EffectivePowerModeChanged</code>: Raised when the effective power mode of the system has changed. These can also be referred to as power plans, such as battery saver and high performance. Use the <code>EffectivePowerMode</code> property to get the current mode.</li>
				<li><code>SystemSuspendStatusChanged</code>: Raised when the system is suspended or resumes. In UWP, these types of events were part of the built-in lifecycle in the <code>App</code> class. Use the <code>SystemSuspendStatus</code> property to get the current status.</li>
				<li><code>UserPresenceStatusChanged</code>: Raised when the system detects a change in the user’s presence. Use the <code>UserPresenceStatus</code> property to get the current status.</li>
			</ul>
			<p>A full list of <code>PowerManager</code> events and properties can be viewed on <em class="italic">Microsoft </em><em class="italic">Learn</em>: <a href="https://learn.microsoft.com/windows/windows-app-sdk/api/winrt/microsoft.windows.system.power.powermanager">https://learn.microsoft.com/windows/windows-app-sdk/api/winrt/microsoft.windows.system.power.powermanager</a>.</p>
			<p>Responding to<a id="_idIndexMarker408"/> changes in these events can help your app be intelligent in how and when it performs resource-intensive actions. You may have some background processing that should only be performed when a system is plugged in or its battery capacity is above a certain percentage. You could also choose to suspend screen animations or dashboard updates when a user’s screen is dimmed or turned off in order to conserve power.</p>
			<p>Next, let’s discuss the windowing capabilities in the Windows App SDK.</p>
			<h3>Window management</h3>
			<p>The Windows App SDK has some<a id="_idIndexMarker409"/> limited window management capabilities that can be leveraged by using the <code>AppWindow</code> class. By using some of the interop APIs, your app can get the <code>HWND</code> and <code>WindowId</code> values for the current window. In Win32 development, a <code>WindowId</code> can then be used to get a reference to the current <code>AppWindow</code> object:</p>
			<pre class="source-code">
var appWindow = Microsoft.UI.Windowing.AppWindow
  .GetFromWindowId(windowId)</pre>			<p>Most of the<a id="_idIndexMarker411"/> properties on <code>AppWindow</code> are read-only. You can get information such as its size, position, visibility, and the <code>WindowId</code> value of its owner. One writable property of <code>AppWindow</code> is <code>Title</code>. Setting <code>Title</code> allows you to change the text in the title bar of the current window.</p>
			<h3>Push notifications and app notifications</h3>
			<p><strong class="bold">Push notifications</strong> can be <a id="_idIndexMarker412"/>used to either interact with the app without notifying the user or display a toast notification in Windows. The latter is considered an <strong class="bold">app notification</strong> and is most familiar to<a id="_idIndexMarker413"/> users. The other raw notifications that trigger within the app are used for things such as waking the app from an inactive state or for data syncing purposes.</p>
			<p>The Windows App SDK supports both types of notifications. The APIs for these are in the <code>Microsoft.Windows.PushNotifications</code> and <code>Microsoft.Windows.AppNotifications</code> namespaces. Exploring notifications is beyond the scope of this chapter, but you can explore some quick starts on <em class="italic">Microsoft Learn</em> from the <em class="italic">Push notifications overview</em> page: <a href="https://learn.microsoft.com/windows/apps/windows-app-sdk/notifications/push-notifications/">https://learn.microsoft.com/windows/apps/windows-app-sdk/notifications/push-notifications/</a>. We will add notifications to our project in <a href="B20908_08.xhtml#_idTextAnchor197"><em class="italic">Chapter 8</em></a>, <em class="italic">Adding Windows Notifications to </em><em class="italic">WinUI Applications</em>.</p>
			<p>Now that we’ve learned about some of the new features in WinUI and the Windows App SDK, let’s get back to our project and add a couple of new controls to it.</p>
			<h1 id="_idParaDest-130"><a id="_idTextAnchor130"/>Adding some new controls to the project</h1>
			<p>In this section, we are going to use two controls that are only available to Windows applications with WinUI. We are going to change the <code>SplitButton</code> to allow users to save and return to a list of items, or save and continue adding another item to the item details page. Then, we will add a <code>TeachingTip</code> control to inform users of the new saving capabilities. To follow along with these steps, you can use the starter project on GitHub (<a href="https://github.com/PacktPublishing/Learn-WinUI-3-Second-Edition/tree/master/Chapter05/Start">https://github.com/PacktPublishing/Learn-WinUI-3-Second-Edition/tree/master/Chapter05/Start</a>). Let’s start by updating the <strong class="bold">Save</strong> button.</p>
			<h2 id="_idParaDest-131"><a id="_idTextAnchor131"/>Using the SplitButton control</h2>
			<p>Follow these<a id="_idIndexMarker414"/> steps:</p>
			<ol>
				<li>First, in <code>ItemDetailsViewModel</code>, add a new <code>SaveItemAndContinue</code> method to be bound to the <code>Click</code> event of our new <code>SplitButton</code> control:<pre class="source-code">
public void SaveItemAndContinue()
{
    Save();
    _itemId = 0;
    ItemName = string.Empty;
    SelectedMedium = null;
    SelectedLocation = null;
    SelectedItemType = null;
    IsDirty = false;
}</pre><p class="list-inset">In the <code>SaveItemAndContinue</code> method, we are calling <code>Save</code> and then resetting all<a id="_idIndexMarker415"/> the item state data so that it’s ready for a new item to be entered. The one problem here is that <code>Save</code> currently navigates back to the previous page. Let’s fix that.</p></li>				<li>To remove the call from <code>Save</code> to return to the previous page, we need a new method for the <code>SaveItemAndReturn</code>:<pre class="source-code">
public void SaveItemAndReturn()
{
    Save();
    _navigationService.GoBack();
}</pre><p class="list-inset">Here, we are calling <code>Save</code> and then navigating back to the previous page. The call to <code>_navigationService.GoBack</code> can now be removed from <code>Save</code>.</p></li>				<li>We’re currently using <code>x:Bind</code> to bind directly to the save methods instead of using <code>ICommand</code>. So, you can remove the <code>RelayCommand</code> attribute from <code>Save</code> and the <code>CanSaveItem</code> method from <code>ItemDetailsViewModel</code>. You will also need to remove the <code>NotifyCanExecuteChangedFor</code> attribute from the <code>isDirty</code> private member.</li>
				<li>Finally, open <code>ItemDetailsPage</code> and update<a id="_idIndexMarker416"/> the <code>SplitButton</code> control:<pre class="source-code">
&lt;SplitButton x:Name="SaveButton"
             Content="Save and Return"
             Margin="8,8,0,8"
             Click="{x:Bind ViewModel
               .SaveItemAndReturn}"
             IsEnabled="{x:Bind ViewModel.IsDirty,
               Mode=OneWay}"&gt;
    &lt;SplitButton.Flyout&gt;
        &lt;Flyout&gt;
          &lt;StackPanel&gt;
            &lt;Button Content="Save and Create New"
                    Click="{x:Bind ViewModel
                      .SaveItemAndContinue}"
                    IsEnabled="{x:Bind
                      ViewModel.IsDirty,
                         Model=OneWay}"
                    Background="Transparent"/&gt;
            &lt;Button Content="Save and Return"
                    Click="{x:Bind ViewModel
                      .SaveItemAndReturn}"
                    IsEnabled="{x:Bind
                      ViewModel.IsDirty, Mode=OneWay}"
                    Background="Transparent"/&gt;
          &lt;/StackPanel&gt;
        &lt;/Flyout&gt;
    &lt;/SplitButton.Flyout&gt;
&lt;/SplitButton&gt;</pre><p class="list-inset">The <a id="_idIndexMarker417"/>content of <code>SplitButton</code> has been updated to <code>Save and Return</code>. We’ve also updated the binding to use the <code>Click</code> event to invoke the action and the <code>IsEnabled</code> property with <code>IsDirty</code>. A new child <code>Flyout</code> item is also added. <code>Flyout</code> contains a <code>StackPanel</code> control with <code>Button</code> controls for both the <code>Click</code> event invoking <code>SaveItemAndContinue</code>.</p></li>				<li>That’s it! Now, run the application and try out this new feature. Here’s how the new button looks <a id="_idIndexMarker418"/>when you click the drop-down arrow:</li>
			</ol>
			<div><div><img src="img/B20908_05_013.jpg" alt="Figure 5.13 – Using the new SplitButton control to save items"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.13 – Using the new SplitButton control to save items</p>
			<h2 id="_idParaDest-132"><a id="_idTextAnchor132"/>Adding a TeachingTip control to the Save button</h2>
			<p>A <code>TeachingTip</code> control is a <a id="_idIndexMarker419"/>great way to educate users about<a id="_idIndexMarker420"/> features in your application. It is a small popup with header text and content text. You may have seen them in some of the Windows applications you use.</p>
			<p><code>TeachingTip</code> can either be linked to a control on the page or it can be placed directly on the page with an optional <code>PreferredPlacement</code> property, controlling where it appears on the page. It can be configured to be dismissed by the user with a <strong class="bold">Close </strong>button or automatically when the user starts interacting with the page.</p>
			<p>To add a <code>TeachingTip</code> control for our <code>SplitButton</code> control, add it to the <code>Resources</code> control in <code>ItemDetailsPage</code>, like so:</p>
			<pre class="source-code">
&lt;SplitButton x:Name="SaveButton" Content="Save and Return"
 Margin="8,8,0,8" Command="{x:Bind ViewModel.SaveCommand}"&gt;
    &lt;SplitButton.Flyout&gt;
        &lt;Flyout&gt;
            &lt;Button Content="Save and Create New"
            Command="{x:Bind ViewModel
               .SaveAndContinueCommand}"
                   Background="Transparent"/&gt;
        &lt;/Flyout&gt;
    &lt;/SplitButton.Flyout&gt;
<strong class="bold">    &lt;SplitButton.Resources&gt;</strong>
<strong class="bold">        &lt;TeachingTip x:Name="SavingTip"</strong>
<strong class="bold">                        Target="{x:Bind SaveButton}"</strong>
<strong class="bold">                        Title="Save and create new"</strong>
<strong class="bold">                        </strong><strong class="bold">Subtitle="Use the dropdown button</strong>
<strong class="bold">                        option to save your item and create</strong>
<strong class="bold">                        another."&gt;</strong>
<strong class="bold">        &lt;/TeachingTip&gt;</strong>
<strong class="bold">    &lt;/SplitButton.Resources&gt;</strong>
&lt;/SplitButton&gt;</pre>			<p>Inside the <code>TeachingTip</code> control, we’re<a id="_idIndexMarker421"/> binding <code>Target</code> to <code>SaveButton</code> and setting <code>Title</code> and <code>Subtitle</code> to educate users about the new <strong class="bold">Save and create </strong><strong class="bold">new</strong> feature.</p>
			<p>There’s an additional call <a id="_idIndexMarker422"/>needed in the <code>ItemDetailsPage</code> constructor to make the tip appear:</p>
			<pre class="source-code">
SavingTip.IsOpen = true;</pre>			<p>If you run the application now, <code>TeachingTip</code> is going to appear every time the user opens <code>ItemDetailsPage</code>. This is going to quickly annoy our users. We can add a little bit of code to <code>ItemDetailsPage.xaml.cs</code> to save a user-level setting indicating that the current user has already seen this <code>TeachingTip</code> control.  Then, the next time we load the page, we’ll check this setting so that the app can skip the code that displays the tip.</p>
			<p>We’re going to leverage<a id="_idIndexMarker423"/> Windows local storage to save and load<a id="_idIndexMarker424"/> the user setting:</p>
			<pre class="source-code">
Windows.Storage.ApplicationDataContainer localSettings =
  Windows.Storage.ApplicationData.Current.LocalSettings;
// Load the user setting
string haveExplainedSaveSetting = localSettings.Values
  [nameof(SavingTip)] as string;
// If the user has not seen the save tip, display it
if (!bool.TryParse(haveExplainedSaveSetting, out bool
  result) || !result)
{
    SavingTip.IsOpen = true;
    // Save the teaching tip setting
    localSettings.Values[nameof(SavingTip)] = "true";
}</pre>			<p>Now, the user will only see this tip the first time they load <code>ItemDetailsPage</code>.</p>
			<p>Let’s see our <code>TeachingTip</code> control in action. Run the application, select an item, and click <code>ItemDetailsPage</code>:</p>
			<div><div><img src="img/B20908_05_014.jpg" alt="Figure 5.14 – Using the new TeachingTip control"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.14 – Using the new TeachingTip control</p>
			<p>Now, the application has a new feature and a great way to inform users of how to use it. Let’s wrap up and discuss what we have learned in this chapter.</p>
			<h1 id="_idParaDest-133"><a id="_idTextAnchor133"/>Summary</h1>
			<p>In this chapter, we explored many of the controls available in WinUI 3. We learned that the <strong class="bold">WinUI 3 Gallery</strong> application is a great tool for exploring the controls available to WinUI developers. We also explored some of the features in the Windows App SDK that are not part of WinUI. At the end, we learned about, and added, a couple of new WinUI controls to our application.</p>
			<p>In the next chapter, we will learn more about services and will start persisting the data for our media items between sessions.</p>
			<h1 id="_idParaDest-134"><a id="_idTextAnchor134"/>Questions</h1>
			<ol>
				<li>Which WinUI control can display Lottie animations?</li>
				<li>Which WinUI control can display HTML content with the Chromium-based Microsoft Edge browser?</li>
				<li>Can you create a WinUI 3 app with C++?</li>
				<li>Which control would you use to educate users about a new feature?</li>
				<li>Which application can you download from the Microsoft Store to learn about all the WinUI controls?</li>
				<li>What type of control can be used to save and load user settings between sessions?</li>
				<li>Which Windows App SDK feature would you use to notify users when your app has a new message to be viewed?</li>
			</ol>
		</div>
	</body></html>