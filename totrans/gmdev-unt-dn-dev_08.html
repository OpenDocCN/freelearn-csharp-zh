<html><head></head><body>
		<div id="_idContainer326">
			<p><a id="_idTextAnchor094"/></p>
			<h1 id="_idParaDest-98"><em class="italic"><a id="_idTextAnchor095"/>Chapter 6</em>: Integrating Audio and Video in a Unity Project</h1>
			<p>In the previous chapters, we have discussed how to use C# scripts to develop game logic in Unity, how to efficiently implement UI, how to implement animation, and how to integrate physics simulation into your game. However, one feature that is often overlooked in game development is sound. The proper use of sound effects can enhance the immersion of a game, and the background music that matches the background of the game can trigger the emotional resonance of the players. Sometimes, playing video in a game is also a way to increase the fun of a game. There is no doubt that adding video and audio to your game can make your game more lively and interesting.</p>
			<p>In this chapter, we will introduce the following key topics:</p>
			<ul>
				<li>Concepts in Unity's audio system and video system</li>
				<li>Scripting with audio and video</li>
				<li><a id="_idTextAnchor096"/>Things to note when using Unity to develop web applications</li>
				<li>Increasing the performance of the audio system</li>
			</ul>
			<p>By the end of this chapter, you will be able to implement audio and video correctly and efficiently in Unity to add more realism and fun to your game.</p>
			<p>Now, let's get started!</p>
			<h1 id="_idParaDest-99"><a id="_idTextAnchor097"/>Technical requirements</h1>
			<p>You can find complete code examples on GitHub in the following repository: <a href="https://github.com/PacktPublishing/Game-Development-with-Unity-for-.NET-Developers">https://github.com/PacktPublishing/Game-Development-with-Unity-for-.NET-Developers</a>.</p>
			<h1 id="_idParaDest-100"><a id="_idTextAnchor098"/>Concepts in Unity's audio system and video system</h1>
			<p>Unity provides <a id="_idIndexMarker550"/>video and audio features, allowing your game to play videos on different platforms, and supports real-time mixing and full 3D spatial sound effects. In this section, we will introduce important concepts of the Unity audio system and video system.</p>
			<h2 id="_idParaDest-101"><a id="_idTextAnchor099"/>Audio clips</h2>
			<p>In order <a id="_idIndexMarker551"/>to be able to play audio in Unity, we need to import an audio file into the Unity editor first. The audio data will be saved in an <strong class="bold">audio clip</strong> object in Unity. We can download and import the <strong class="bold">Ultra Sci-Fi Game Audio Weapons Pack Vol. 1</strong> from <strong class="bold">Unity Asset Store</strong> at the following link: <a href="https://assetstore.unity.com/packages/audio/sound-fx/weapons/ultra-sci-fi-game-audio-weapons-pack-vol-1-113047">https://assetstore.unity.com/packages/audio/sound-fx/weapons/ultra-sci-fi-game-audio-weapons-pack-vol-1-113047</a>. You can see this in the following screenshot:</p>
			<div>
				<div id="_idContainer275" class="IMG---Figure">
					<img src="image/Figure_6.01_B17146.jpg" alt="Figure 6.1 – Ultra Sci-Fi Game Audio Weapons Pack Vol. 1&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.1 – Ultra Sci-Fi Game Audio Weapons Pack Vol. 1</p>
			<p>The format of the audio files<a id="_idIndexMarker552"/> contained in this pack is <strong class="source-inline">.wav</strong>. In addition to <strong class="source-inline">.wav</strong> files that can be imported into Unity, Unity also supports importing files in the following formats:</p>
			<ul>
				<li><strong class="source-inline">.aif</strong></li>
				<li><strong class="source-inline">.mp3</strong></li>
				<li><strong class="source-inline">.ogg</strong></li>
				<li><strong class="source-inline">.xm</strong></li>
				<li><strong class="source-inline">.mod</strong></li>
				<li><strong class="source-inline">.it</strong></li>
				<li><strong class="source-inline">.s3m</strong></li>
			</ul>
			<p>After importing<a id="_idIndexMarker553"/> these audio files, we can choose one of them to open the <strong class="bold">Import </strong>settings as shown in <em class="italic">Figure 6.2</em>: </p>
			<div>
				<div id="_idContainer276" class="IMG---Figure">
					<img src="image/Figure_6.02_B17146.jpg" alt="Figure 6.2 – Import settings of audio&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.2 – Import settings of audio</p>
			<p>As you can see in the <strong class="bold">Import</strong> settings, Unity supports mono and multichannel audio assets, up to eight channels. Unity also provides a lot of import options. Let's introduce some important options.</p>
			<h3>Load Type</h3>
			<p>Unity provides<a id="_idIndexMarker554"/> game developers with three different ways to load audio assets at runtime. We can determine how Unity loads this audio file by modifying the <strong class="bold">Load Type</strong> property in the <strong class="bold">Import</strong> settings window. </p>
			<div>
				<div id="_idContainer277" class="IMG---Figure">
					<img src="image/Figure_6.03_B17146.jpg" alt="Figure 6.3 – Load Type&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.3 – Load Type</p>
			<p>The three <a id="_idIndexMarker555"/>methods are as follows:</p>
			<ul>
				<li><strong class="bold">Decompress On Load</strong>: This is the<a id="_idIndexMarker556"/> default value for <strong class="bold">Load Type</strong>. If the audio file is small, such as UI sounds or footstep sounds, we should choose this option. This is because, in this way, the audio file will be decompressed and decoded into the memory at its original size. The advantage is that it will be ready for on-demand playing with minimal CPU usage.</li>
				<li><strong class="bold">Compressed In Memory</strong>: As a <a id="_idIndexMarker557"/>contrast with <strong class="bold">Decompress On Load</strong>, by choosing this method, Unity will store the compressed audio data in memory and require the CPU to decompress and decode it when playing the audio. </li>
				<li><strong class="bold">Streaming</strong>: This is<a id="_idIndexMarker558"/> completely different from the previous two. If we choose this method, Unity will not load the audio data into the memory, but instead will stream it from disk. This method uses the least memory, but at the cost of the highest CPU usage and disk usage.</li>
			</ul>
			<h3>Compression Format</h3>
			<p>In<a id="_idIndexMarker559"/> addition to the <strong class="bold">Load Type</strong> property just introduced, the <strong class="bold">Compression Format</strong> property is also very important for audio assets. Unity supports a variety of audio compression formats, and there are different formats available according to the different target platforms. For example, if the target platform is <strong class="bold">Windows</strong>, the following formats are available:</p>
			<div>
				<div id="_idContainer278" class="IMG---Figure">
					<img src="image/Figure_6.04_B17146.jpg" alt="Figure 6.4 – Compression Format on Windows&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.4 – Compression Format on Windows</p>
			<p>On the other <a id="_idIndexMarker560"/>hand, if the target platform is <strong class="bold">Android</strong>, in addition to the previous formats, it also supports the MP3 format.</p>
			<div>
				<div id="_idContainer279" class="IMG---Figure">
					<img src="image/Figure_6.05_B17146.jpg" alt="Figure 6.5 – Compression Format on Android&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.5 – Compression Format on Android</p>
			<p>We will explore the different compression formats here:</p>
			<ul>
				<li><strong class="bold">PCM</strong>: <strong class="bold">Pulse-code modulation</strong> (<strong class="bold">PCM</strong>) is a <a id="_idIndexMarker561"/>lossless, uncompressed <a id="_idIndexMarker562"/>format and is the standard form of digital audio in computers. It offers high quality and has a very large file size. As you can see in <em class="italic">Figure 6.6</em>, when the <strong class="bold">PCM</strong> format is selected, the imported size of this audio file is equal to its original size. </li>
			</ul>
			<div>
				<div id="_idContainer280" class="IMG---Figure">
					<img src="image/Figure_6.06_B17146.jpg" alt="Figure 6.6 – The PCM format&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.6 – The PCM format</p>
			<ul>
				<li><strong class="bold">Vorbis</strong>: This is the <a id="_idIndexMarker563"/>default value for <strong class="bold">Compression Format</strong>. <strong class="bold">Vorbis</strong> is <a id="_idIndexMarker564"/>a very effective audio compression format. Compared<a id="_idIndexMarker565"/> with <strong class="bold">PCM</strong> audio, this compression produces smaller files, but the quality is lower. If we choose the <strong class="bold">Vorbis</strong> option, the imported size of this audio file will be much smaller than its original size. There is a <strong class="bold">Quality</strong> slider that allows us to adjust the compression quality. </li>
			</ul>
			<div>
				<div id="_idContainer281" class="IMG---Figure">
					<img src="image/Figure_6.07_B17146.jpg" alt="Figure 6.7 – The Vorbis format&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.7 – The Vorbis format</p>
			<ul>
				<li><strong class="bold">ADPCM</strong>: <strong class="bold">ADPCM</strong> is short for <strong class="bold">adaptive differential pulse-code modulation</strong>. Although <a id="_idIndexMarker566"/>the name is<a id="_idIndexMarker567"/> similar to PCM, it is a lossy compression format. But unlike Vorbis, its compression ratio cannot be adjusted in Unity. The compressed file size will always be 3.5 times smaller than PCM. </li>
			</ul>
			<div>
				<div id="_idContainer282" class="IMG---Figure">
					<img src="image/Figure_6.08_B17146.jpg" alt="Figure 6.8 – The ADPCM format&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.8 – The ADPCM format</p>
			<ul>
				<li><strong class="bold">MP3</strong>: This<a id="_idIndexMarker568"/> is available on mobile platforms, such as Android. The MP3<a id="_idIndexMarker569"/> format<a id="_idIndexMarker570"/> is similar to Vorbis, which is a very effective audio compression format. There is also a <strong class="bold">Quality</strong> slider that allows us to adjust the compression quality. </li>
			</ul>
			<div>
				<div id="_idContainer283" class="IMG---Figure">
					<img src="image/Figure_6.09_B17146.jpg" alt="Figure 6.9 – The MP3 format&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.9 – The MP3 format</p>
			<p>After we set the import settings for these audio files, they can be imported into the Unity editor as audio clips.</p>
			<div>
				<div id="_idContainer284" class="IMG---Figure">
					<img src="image/Figure_6.10_B17146.jpg" alt="Figure 6.10 – Audio clips&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.10 – Audio clips</p>
			<p>As shown in <em class="italic">Figure 6.10</em>, we can find these audio clips in the <strong class="bold">Project</strong> window, and the icon of the audio clip will show its waveform.</p>
			<h2 id="_idParaDest-102"><a id="_idTextAnchor100"/>Audio Sources</h2>
			<p>In order to play the audio clip we just created in the game scene, we also need to set an <strong class="bold">Audio Source</strong>. Then this audio clip can be dragged to the Audio Source or used from a C# script.</p>
			<p>Let's follow these steps to create an Audio Source<a id="_idIndexMarker571"/> first:</p>
			<ol>
				<li>Right-click in the <strong class="bold">Hierarchy</strong> window to open the menu.</li>
				<li>Choose <strong class="bold">Create Empty</strong> to create a new GameObject in the scene. As a reminder, the GameObject that is the Audio Source is not necessarily a static object. In many cases, the Audio Source needs to be moved, such as simulating the effect of firing a cannonball in a game. But for the sake of simplicity, we will not add movement logic to this GameObject here.</li>
			</ol>
			<div>
				<div id="_idContainer285" class="IMG---Figure">
					<img src="image/Figure_6.11_B17146.jpg" alt="Figure 6.11 – Create an Audio Source object&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.11 – Create an Audio Source object</p>
			<ol>
				<li value="3">Select this newly created GameObject and click the <strong class="bold">Add Component</strong> button to open the components list. </li>
				<li>Choose <strong class="bold">Audio</strong> | <strong class="bold">Audio Source</strong> to add an <strong class="bold">Audio Source</strong> component <a id="_idIndexMarker572"/>to this GameObject.  </li>
			</ol>
			<p class="figure-caption"> </p>
			<div>
				<div id="_idContainer286" class="IMG---Figure">
					<img src="image/Figure_6.12_B17146.jpg" alt="Figure 6.12 – Add an Audio Source component&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.12 – Add an Audio Source component</p>
			<p>Now we have created a new <strong class="bold">Audio Source</strong> component in our game scene. The properties of this <strong class="bold">Audio Source</strong> component are shown in <em class="italic">Figure 6.13</em>.</p>
			<div>
				<div id="_idContainer287" class="IMG---Figure">
					<img src="image/Figure_6.13_B17146.jpg" alt="Figure 6.13 – Properties of Audio Source&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.13 – Properties of Audio Source</p>
			<p>We will explore some of them here:</p>
			<ul>
				<li><strong class="bold">AudioClip</strong>: Here, we<a id="_idIndexMarker573"/> find the first property of <strong class="bold">Audio Source</strong> is a reference to <strong class="bold">Audio Clip</strong>. We can drag an <strong class="bold">Audio Clip</strong> asset to this field directly in the editor. </li>
				<li><strong class="bold">Output</strong>: We don't have to set this property, because the output of this Audio Source will then be picked up by an Audio Listener in the scene by default. Set this property only when you want to output the sound to an Audio Mixer Group.</li>
				<li><strong class="bold">Play On Awake</strong>: This option is enabled by default, which means the sound will start playing when the scene is loaded. If you don't want this Audio Source to emit sounds when the scene is loaded and want to control when the audio is played through code, then you can disable this option and call the <strong class="source-inline">Play</strong> method in a C# script.</li>
			</ul>
			<p>In addition to the Audio Source, to emit the sound in the scene, an Audio Listener is also needed to receive the sound from the source. Next, we will discuss <strong class="bold">Audio Listener</strong>.</p>
			<h2 id="_idParaDest-103"><a id="_idTextAnchor101"/>Audio Listener</h2>
			<p>Generally speaking, you don't<a id="_idIndexMarker574"/> need to worry about the absence of <strong class="bold">Audio Listener</strong> in the scene, because an Audio Listener will be attached to the main camera in the scene by default when a scene is created, as shown here.</p>
			<div>
				<div id="_idContainer288" class="IMG---Figure">
					<img src="image/Figure_6.14_B17146.jpg" alt="Figure 6.14 – An Audio Listener&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.14 – An Audio Listener</p>
			<p>In real life, sounds are heard by listeners, and <strong class="bold">Audio Listener</strong> is the representation of a listener in Unity. If you set <strong class="bold">Audio Source</strong> correctly in the game scene and the audio clip is available but you can't hear the sound when you run the game, then you can first check whether there is an Audio Listener in the scene. Usually, the listener is attached to the camera.</p>
			<p>To hear the sound, we need to make sure that an Audio Listener is available, but at the same time, it should be noted that there cannot be more than one Audio Listener in the scene, otherwise you will see the following warning message in the <strong class="bold">Console</strong> window. So, please ensure <a id="_idIndexMarker575"/>there is always exactly one Audio Listener in the scene.</p>
			<div>
				<div id="_idContainer289" class="IMG---Figure">
					<img src="image/Figure_6.15_B17146.jpg" alt="Figure 6.15 – Please ensure there is always exactly one audio listener in the scene&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.15 – Please ensure there is always exactly one audio listener in the scene</p>
			<p>After introducing a few important concepts about audio in Unity, let's discuss the concepts related to video in Unity next.</p>
			<h2 id="_idParaDest-104"><a id="_idTextAnchor102"/>Video clips</h2>
			<p>Similar to audio clips, we also need to import external <a id="_idIndexMarker576"/>video files into the Unity editor to generate video clips. Unity supports typical file extensions for video files, such as the following:</p>
			<ul>
				<li><strong class="source-inline">.mp4</strong></li>
				<li><strong class="source-inline">.mov</strong></li>
				<li><strong class="source-inline">.webm</strong></li>
				<li><strong class="source-inline">.wmv</strong></li>
			</ul>
			<p>After importing a video file, we can choose to open <strong class="bold">Import settings</strong>, as shown in <em class="italic">Figure 6.16</em>:</p>
			<div>
				<div id="_idContainer290" class="IMG---Figure">
					<img src="image/Figure_6.16_B17146.jpg" alt="Figure 6.16 – Import settings of a video clip&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.16 – Import settings of a video clip</p>
			<p>By default, the <strong class="bold">Transcode</strong> option is <a id="_idIndexMarker577"/>disabled, which means that Unity will use the default settings to import this video file. If we enable this option, Unity will allow us to modify these settings, as shown in <em class="italic">Figure 6.17</em>, and we will introduce a few of them. At the bottom of the <strong class="bold">Import settings</strong> window, we can also directly preview the video by clicking the play button.</p>
			<p>Now, let's check and enable the <strong class="bold">Transcode</strong> option<a id="_idIndexMarker578"/> and explore some of these import settings.</p>
			<div>
				<div id="_idContainer291" class="IMG---Figure">
					<img src="image/Figure_6.17_B17146.jpg" alt="Figure 6.17 – Video import settings&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.17 – Video import settings</p>
			<ul>
				<li><strong class="bold">Dimensions</strong>: By <a id="_idIndexMarker579"/>default, Unity will not resize the original video, but if you want to resize the video file in Unity, you can change the <strong class="bold">Dimensions</strong> option. You will find a list of presets, such as <strong class="bold">Half Res</strong>, and you can also customize new sizes. </li>
			</ul>
			<div>
				<div id="_idContainer292" class="IMG---Figure">
					<img src="image/Figure_6.18_B17146.jpg" alt="Figure 6.18 – Dimensions option&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.18 – Dimensions option</p>
			<ul>
				<li><strong class="bold">Codec</strong>: Unity provides the option to transcode video clip assets into one of the following video codecs: <strong class="bold">H264</strong>, <strong class="bold">H265</strong>, and <strong class="bold">VP8</strong>, as shown in the following figure. <strong class="bold">Auto</strong> is the default value for <strong class="bold">Codec</strong>. Of course, you can also choose the video codec by yourself. <strong class="bold">H264</strong> is the best natively supported hardware-accelerated video codec.</li>
			</ul>
			<div>
				<div id="_idContainer293" class="IMG---Figure">
					<img src="image/Figure_6.19_B17146.jpg" alt="Figure 6.19 – Codec option&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.19 – Codec option</p>
			<ul>
				<li><strong class="bold">Keep Alpha</strong>: As you can see in <em class="italic">Figure 6.19</em>, <strong class="bold">Keep Alpha</strong> is not an option in this case. This is because this option can only be checked when the video file contains an alpha channel. If your video file contains an alpha channel and you want to keep the alpha channel when the video is played in the game, then check this option.</li>
				<li><strong class="bold">Flip Horizontally</strong>: As the name suggests, if this option is enabled, Unity will flip the video horizontally, switching the left side to the right side. </li>
				<li><strong class="bold">Flip Vertically</strong>: Similar to <strong class="bold">Flip Horizontally</strong>, if this option is enabled, Unity will flip the video vertically to make it upside down.</li>
				<li><strong class="bold">Import Audio</strong>: If <a id="_idIndexMarker580"/>your original video file contains audio tracks, then you can decide whether to import the audio tracks of the video by checking this option.</li>
			</ul>
			<p>After setting the import settings, we can click <strong class="bold">Apply </strong>to transcode the video. It may take some time to complete the transcoding process.</p>
			<div>
				<div id="_idContainer294" class="IMG---Figure">
					<img src="image/Figure_6.20_B17146.jpg" alt="Figure 6.20 – Transcoding the video&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.20 – Transcoding the video</p>
			<p>Now we have imported the video file into the Unity editor, next we need to set up a video player to play the video clip.</p>
			<h2 id="_idParaDest-105"><a id="_idTextAnchor103"/>Video Player</h2>
			<p>Let's create a Video Player<a id="_idIndexMarker581"/> by following these steps:</p>
			<ol>
				<li value="1">Right-click in the <strong class="bold">Hierarchy</strong> window to open the menu.</li>
				<li>Choose <strong class="bold">Create Empty</strong> to create a new GameObject and rename this GameObject to <strong class="source-inline">VideoPlayer</strong>.</li>
				<li>Select this newly created GameObject and click the <strong class="bold">Add Component</strong> button to open the components list. </li>
				<li>Choose <strong class="bold">Video</strong> | <strong class="bold">Video Player</strong> to add a <strong class="bold">VideoPlayer</strong> component to this GameObject.          </li>
			</ol>
			<p class="figure-caption">              </p>
			<div>
				<div id="_idContainer295" class="IMG---Figure">
					<img src="image/Figure_6.21_B17146.jpg" alt="Figure 6.21 – Add a Video Player component&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.21 – Add a Video Player component</p>
			<p>Now we have created a <a id="_idIndexMarker582"/>new <strong class="bold">Video Player</strong> in our game scene. The properties of this <strong class="bold">Video Player</strong> are shown in <em class="italic">Figure 6.22</em>:</p>
			<div>
				<div id="_idContainer296" class="IMG---Figure">
					<img src="image/Figure_6.22_B17146.jpg" alt="Figure 6.22 – Properties of Video Player component&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.22 – Properties of Video Player component</p>
			<p>Next, we will explore <a id="_idIndexMarker583"/>some of these properties:</p>
			<ul>
				<li><strong class="bold">Source</strong>: In Unity, a <strong class="bold">Video Player</strong> can play videos from video clip assets or from a URL. By default, the <strong class="bold">Video Player</strong> needs a video clip asset as the video source, but we can also choose a URL as the source for video here. </li>
			</ul>
			<div>
				<div id="_idContainer297" class="IMG---Figure">
					<img src="image/Figure_6.23_B17146.jpg" alt="Figure 6.23 – Choose the type of video source&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.23 – Choose the type of video source</p>
			<ul>
				<li><strong class="bold">Play On Awake</strong>: This option is enabled by default, which means the video will start playing when the scene is loaded. We can disable this option and call the <strong class="source-inline">Play</strong> method in a C# script to trigger the video playback at another point during the runtime.</li>
				<li><strong class="bold">Playback Speed</strong>: We<a id="_idIndexMarker584"/> can increase or decrease the playback speed by adjusting this slider. The default value is 1.</li>
			</ul>
			<h3>Render Mode</h3>
			<p>This is a very<a id="_idIndexMarker585"/> important setting, so we will explain it in detail. If you just set up the Video Player, drag a video clip asset to the <strong class="bold">Source</strong> property, and play the game, you will find that nothing will happen. This is because the default value for <strong class="bold">Render Mode</strong> in a Video Player is <strong class="bold">Render Texture</strong>, which means you should create and assign a render texture to the <strong class="bold">Target Texture</strong> property of the Video Player first. Then the Video Player will output the video to this render texture, as you can see in <em class="italic">Figure 6.24</em>:</p>
			<div>
				<div id="_idContainer298" class="IMG---Figure">
					<img src="image/Figure_6.24_B17146.jpg" alt="Figure 6.24 – Set the Target Texture property&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.24 – Set the Target Texture property</p>
			<p>However, at this stage, we only render the video to the render texture, and the video is not played in the game scene. In order to play this video in the game scene, we can create a new <strong class="bold">Raw Image</strong> UI element in the scene and assign this render texture to the <strong class="bold">Raw Image</strong> UI element.</p>
			<div>
				<div id="_idContainer299" class="IMG---Figure">
					<img src="image/Figure_6.25_B17146.jpg" alt="Figure 6.25 – The Raw Image UI element&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.25 – The Raw Image UI element</p>
			<p>Now, let's play the<a id="_idIndexMarker586"/> game again and the video plays as expected.</p>
			<div>
				<div id="_idContainer300" class="IMG---Figure">
					<img src="image/Figure_6.26_B17146.jpg" alt="Figure 6.26 – Play the video&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.26 – Play the video</p>
			<p>We can also change <strong class="bold">Render Mode</strong>. As you can see in <em class="italic">Figure 6.27</em>, the other options include the following: </p>
			<ul>
				<li><strong class="bold">Camera Far Plane</strong>, which <a id="_idIndexMarker587"/>renders video content behind the camera's scene, allows developers to change the value of the alpha channel to make video content transparent, and can be used as a background video player.</li>
				<li><strong class="bold">Camera Near Plane</strong>, which renders video content in front of the camera's scene, allows developers to change the value of the alpha channel to make video content transparent, and can be used as a foreground video player.</li>
				<li><strong class="bold">Material Override</strong>: In Unity, a material is used to describe the appearance of the surface of a model. If this mode is selected, the video content will be passed into a user-specified property of the target material instead of being drawn on the screen or in a render texture. This mode is often used when making 360-degree panoramic videos in Unity.</li>
				<li><strong class="bold">API Only</strong>, which does not render the video content, but allows developers to access the video content via an API. </li>
			</ul>
			<div>
				<div id="_idContainer301" class="IMG---Figure">
					<img src="image/Figure_6.27_B17146.jpg" alt="Figure 6.27 – Render Mode List&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.27 – Render Mode List</p>
			<p>As an example, we <a id="_idIndexMarker588"/>will choose <strong class="bold">Camera Far Plane</strong> for <strong class="bold">Render Mode</strong>. Instead of a render texture, we need to provide a camera here and, as you can see in the following figure, it allows us to modify the <strong class="bold">Alpha</strong> value as well.</p>
			<div>
				<div id="_idContainer302" class="IMG---Figure">
					<img src="image/Figure_6.28_B17146.jpg" alt="Figure 6.28 – Camera Far Plane&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.28 – Camera Far Plane</p>
			<p>If we play the game, the video plays again this time.</p>
			<div>
				<div id="_idContainer303" class="IMG---Figure">
					<img src="image/Figure_6.29_B17146.jpg" alt="Figure 6.29 – Play the video&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.29 – Play the video</p>
			<p>In this section, we learned about some concepts of Unity's audio and video systems. Now, let's explore how to write C# code in Unity to control audio and video.</p>
			<h1 id="_idParaDest-106"><a id="_idTextAnchor104"/>Scripting with audio and video</h1>
			<p>In this section, we will explore how to interact with the audio and video systems via C# scripts. Similar to the previous section, we will also introduce the C# methods for <strong class="bold">Audio Source</strong> and <strong class="bold">Video Player</strong> respectively. We first start with the C# methods for <strong class="bold">Audio Source</strong>.</p>
			<h2 id="_idParaDest-107"><a id="_idTextAnchor105"/>AudioSource.Play</h2>
			<p>The first function we will<a id="_idIndexMarker589"/> introduce is the <strong class="source-inline">Play</strong> function of <strong class="source-inline">AudioSource</strong>. The function signature of <strong class="source-inline">Play</strong> is as follows:</p>
			<p class="source-code">public void Play();</p>
			<p>It is very simple and straightforward to call this function to play an audio clip. However, if you need to deal with more complex scenarios, such as delaying the playback of an audio clip, you can call the <strong class="source-inline">PlayDelayed</strong> function, which will play the clip with a delay specified in seconds.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">There was an overloaded version of the <strong class="source-inline">Play</strong> function, which requires a <strong class="source-inline">delay</strong> parameter. However, it's deprecated now. Developers are advised to use the <strong class="source-inline">PlayDelayed</strong> function instead of the old <strong class="source-inline">Play</strong> (<strong class="source-inline">delay</strong>) function.</p>
			<p>The following is the function signature of <strong class="source-inline">PlayDelayed</strong>:</p>
			<p class="source-code">public void PlayDelayed(float delay);</p>
			<p>It requires a parameter, <strong class="source-inline">delay</strong>, which is specified in samples relative to the 44.1 kHz reference rate.</p>
			<p>Now let's create a new <a id="_idIndexMarker590"/>C# script to first obtain a reference to the Audio Source in the scene and play the audio clip assigned to it by calling the <strong class="source-inline">Play</strong> function:</p>
			<p class="source-code">using UnityEngine;</p>
			<p class="source-code">public class AudioPlayer : MonoBehaviour</p>
			<p class="source-code">{</p>
			<p class="source-code">[SerializeField] </p>
			<p class="source-code">private AudioSource _audioSource;</p>
			<p class="source-code">    private void Start()</p>
			<p class="source-code">    {</p>
			<p class="source-code">        if(_audioSource == null)</p>
			<p class="source-code">        {</p>
			<p class="source-code">            _audioSource = GetComponent&lt;AudioSource&gt;();</p>
			<p class="source-code">        }</p>
			<p class="source-code">    }</p>
			<p class="source-code">    public void OnClickPlayAudioButton()</p>
			<p class="source-code">    {</p>
			<p class="source-code">        _audioSource.Play();</p>
			<p class="source-code">    }</p>
			<p class="source-code">}</p>
			<p>Then we drag this newly <a id="_idIndexMarker591"/>created script onto the Audio Source GameObject in the scene to attach this script to the GameObject as a new component.</p>
			<div>
				<div id="_idContainer304" class="IMG---Figure">
					<img src="image/Figure_6.30_B17146.jpg" alt="Figure 6.30 – Attaching the script to the GameObject&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.30 – Attaching the script to the GameObject</p>
			<p>Here, we can manually drag<a id="_idIndexMarker592"/> the <strong class="bold">AudioSource</strong> component to the <strong class="bold">Audio Source</strong> field of the audio player component to obtain a reference to the <strong class="bold">AudioSource</strong> component, as shown in <em class="italic">Figure 6.30</em>. If you forget to assign a value to it, then you can use the <strong class="source-inline">GetComponent&lt;AudioSource&gt;()</strong> function to get the <strong class="bold">AudioSource</strong> component in the code as well.</p>
			<p>Next, we will create a UI button in the scene and bind the button with the <strong class="source-inline">OnClickPlayAudioButton</strong> function so that when the button is clicked, the <strong class="bold">Audio Source</strong> will play the audio clip.</p>
			<div>
				<div id="_idContainer305" class="IMG---Figure">
					<img src="image/Figure_6.31_B17146.jpg" alt="Figure 6.31 – Create a button&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.31 – Create a button</p>
			<p>Now we can run the game and click the button to play the sound effect in the scene. This function is very useful when implementing audio effects; for example, when the player fires a gun, the sound of the bullet can be played, and so on.</p>
			<h2 id="_idParaDest-108"><a id="_idTextAnchor106"/>AudioSource.Pause</h2>
			<p>An Audio Source can be used to play <a id="_idIndexMarker593"/>background music. In some cases, we would like the background music to be paused, such as when the player enters a different scene or triggers a new plot. At this point, we can consider using the <strong class="source-inline">Pause</strong> function to pause playing the background music clip.</p>
			<p>The function signature of <strong class="source-inline">Pause</strong> is very simple, as follows:</p>
			<p class="source-code">public void Pause();</p>
			<p>We can create another function for the <strong class="source-inline">AudioPlayer</strong> class we created earlier:</p>
			<p class="source-code">    public void OnClickPauseAudioButton()</p>
			<p class="source-code">    {</p>
			<p class="source-code">        _audioSource.Pause();</p>
			<p class="source-code">    }</p>
			<p>Since the assets pack we <a id="_idIndexMarker594"/>downloaded earlier only contains sound effects with a short duration, in order to demonstrate the function of pausing background music, we can download and import <strong class="bold">Free Music Tracks For Games</strong> from the Unity Asset Store at the following link:  <a href="https://assetstore.unity.com/packages/audio/music/free-music-tracks-for-games-156413">https://assetstore.unity.com/packages/audio/music/free-music-tracks-for-games-156413</a>.</p>
			<div>
				<div id="_idContainer306" class="IMG---Figure">
					<img src="image/Figure_6.32_B17146.jpg" alt="Figure 6.32 – Free Music Tracks For Games&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.32 – Free Music Tracks For Games</p>
			<p>Then replace the<a id="_idIndexMarker595"/> sound effect clip referenced by <strong class="source-inline">AudioSource</strong> with a new background music clip. Next, we will create another UI button and bind the button with the newly created <strong class="source-inline">OnClickPauseAudioButton</strong> function. </p>
			<p>Now, we can run the game. If you click the first button, the background music will play; if you click the second button, we can pause the music.</p>
			<p><strong class="source-inline">AudioSource</strong> also provides an <strong class="source-inline">UnPause</strong> function to unpause the paused playback and an <strong class="source-inline">isPlaying</strong> property to check whether the current audio clip is playing. </p>
			<p>The following is the function signature of <strong class="source-inline">UnPause</strong>:</p>
			<p class="source-code">public void UnPause();</p>
			<p>We can use them to implement a more flexible function of pausing and continuing music playback as in the following code snippet:</p>
			<p class="source-code">    public void OnClickPauseAudioButton()</p>
			<p class="source-code">    {</p>
			<p class="source-code">        if(_audioSource.isPlaying)</p>
			<p class="source-code">        {</p>
			<p class="source-code">            _audioSource.Pause();</p>
			<p class="source-code">        }</p>
			<p class="source-code">        else</p>
			<p class="source-code">        {</p>
			<p class="source-code">            _audioSource.UnPause();</p>
			<p class="source-code">        }</p>
			<p class="source-code">    }</p>
			<p>In this way, we can <a id="_idIndexMarker596"/>click the second button to pause the music playback, and click again to continue playing the music.</p>
			<h2 id="_idParaDest-109"><a id="_idTextAnchor107"/>AudioSource.Stop</h2>
			<p>In some cases, you may want the <a id="_idIndexMarker597"/>background music of the game to stop and then start from the beginning, instead of pausing and continuing to play. The <strong class="source-inline">Stop</strong> function of <strong class="source-inline">AudioSource</strong> is a suitable solution here.</p>
			<p>The function signature of <strong class="source-inline">Stop</strong> is also very simple, as shown in the following code snippet:</p>
			<p class="source-code">public void Pause();</p>
			<p>Let's create another function in the C# script to stop the background music and start playing from the beginning:</p>
			<p class="source-code">   public void OnClickStopAndPlayAudioButton()</p>
			<p class="source-code">    {</p>
			<p class="source-code">        if(_audioSource.isPlaying)</p>
			<p class="source-code">        {</p>
			<p class="source-code">            _audioSource.Stop();</p>
			<p class="source-code">        }</p>
			<p class="source-code">        else</p>
			<p class="source-code">        {</p>
			<p class="source-code">            _audioSource.Play();</p>
			<p class="source-code">        }</p>
			<p class="source-code">    }</p>
			<p>And we will also create a third UI button and bind the button with the <strong class="source-inline">OnClickStopAndPlayAudioButton</strong> function.</p>
			<p>Run the game and click this<a id="_idIndexMarker598"/> button and the background music starts to play. Click again to stop the background music, and if you click for a third time, the background music will start to play from the beginning.</p>
			<h2 id="_idParaDest-110"><a id="_idTextAnchor108"/>VideoPlayer.clip</h2>
			<p>By default, a <strong class="source-inline">VideoPlayer</strong> component <a id="_idIndexMarker599"/>will play the video clip it refers to. However, it's a common requirement that we should be able to change the video when the game is running instead of creating many different Video Player instances. So, we can just modify the clip property of <strong class="source-inline">VideoPlayer</strong> via C# code:</p>
			<p class="source-code">using UnityEngine;</p>
			<p class="source-code">using UnityEngine.Video;</p>
			<p class="source-code">public class VideoManager : MonoBehaviour</p>
			<p class="source-code">{</p>
			<p class="source-code">[SerializeField] </p>
			<p class="source-code">private VideoPlayer _videoPlayer;</p>
			<p class="source-code">[SerializeField] </p>
			<p class="source-code">private VideoClip _videoClip;</p>
			<p class="source-code">    void Start()</p>
			<p class="source-code">    {</p>
			<p class="source-code">        if (_videoPlayer == null)</p>
			<p class="source-code">        {</p>
			<p class="source-code">            _videoPlayer = GetComponent&lt;VideoPlayer&gt;();</p>
			<p class="source-code">        }</p>
			<p class="source-code">    }</p>
			<p class="source-code">    public void OnClickChangeVideoClip()</p>
			<p class="source-code">    {</p>
			<p class="source-code">        _videoPlayer.clip = _videoClip;</p>
			<p class="source-code">    }</p>
			<p class="source-code">}</p>
			<p>In this case, we create a new C# script called <strong class="source-inline">VideoManager</strong>, which will get a reference to the target <strong class="source-inline">VideoPlayer</strong> component and a reference to the video clip asset. There is also a function called <strong class="source-inline">OnClickChangeVideoClip</strong>, which will later be bound to a UI button to change the video clip being played. </p>
			<p>Compared to setting<a id="_idIndexMarker600"/> an Audio Source, setting a Video Player is slightly more complicated, because we also need to select a <strong class="bold">Render Mode</strong> option for <strong class="bold">Video Player</strong>. For simplicity, here we select the <strong class="bold">Camera Near Plane</strong> option and use <strong class="bold">Main Camera</strong> in the scene to render each frame of the video clip, as shown in <em class="italic">Figure 6.33</em>. </p>
			<div>
				<div id="_idContainer307" class="IMG---Figure">
					<img src="image/Figure_6.33_B17146.jpg" alt="Figure 6.33 – Video Player&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.33 – Video Player</p>
			<p>Then, we also need to assign the newly created script <strong class="bold">VideoManager</strong> to the same GameObject.</p>
			<div>
				<div id="_idContainer308" class="IMG---Figure">
					<img src="image/Figure_6.34_B17146.jpg" alt="Figure 6.34 – Video Manager&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.34 – Video Manager</p>
			<p>As you can see in <em class="italic">Figure 6.34</em>, we not only assigned a reference to <strong class="bold">Video Player</strong> to the <strong class="bold">VideoManager</strong> script but also assigned a reference to a video clip asset to it.</p>
			<p>The third thing is to <a id="_idIndexMarker601"/>create a new UI button and bind the button with the <strong class="source-inline">OnClickChangeVideoClip</strong> function we mentioned earlier.</p>
			<div>
				<div id="_idContainer309" class="IMG---Figure">
					<img src="image/Figure_6.35_B17146.jpg" alt="Figure 6.35 – UI button&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.35 – UI button</p>
			<p>Let's play the game in the editor and click the button to change the video clip.</p>
			<div>
				<div id="_idContainer310" class="IMG---Figure">
					<img src="image/Figure_6.36_B17146.jpg" alt="Figure 6.36 – Change the video clip&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.36 – Change the video clip</p>
			<p>As shown<a id="_idIndexMarker602"/> in <em class="italic">Figure 6.36</em>, the video clip of the <strong class="bold">Video Player</strong> component is changed to the video clip asset we want it to play.</p>
			<h2 id="_idParaDest-111"><a id="_idTextAnchor109"/>VideoPlayer.url</h2>
			<p>Sometimes, playing videos from <a id="_idIndexMarker603"/>video clip assets is not a good idea. For example, we do not want to increase the size of the game due to the inclusion of video files, or we want to develop WebGL-based games, and WebGL does not support video clip assets. Then, the use of a URL to provide video resources becomes an obvious solution. So, let's add another function called <strong class="source-inline">OnClickSetVideoURL</strong> to let the Video Player in the game scene play the video pointed to by the URL:</p>
			<p class="source-code">[SerializeField] private string _videoURL;</p>
			<p class="source-code">…</p>
			<p class="source-code">    public void OnClickSetVideoURL()</p>
			<p class="source-code">    {</p>
			<p class="source-code">        _videoPlayer.url = _videoURL;</p>
			<p class="source-code">    }</p>
			<p>And we also need to create a new UI button and bind the button with the <strong class="source-inline">OnClickSetVideoURL</strong> function. </p>
			<div>
				<div id="_idContainer311" class="IMG---Figure">
					<img src="image/Figure_6.37_B17146.jpg" alt="Figure 6.37 – Set Video URL&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.37 – Set Video URL</p>
			<p>Run the game and<a id="_idIndexMarker604"/> click the <strong class="bold">Set Video URL</strong> button to play the video from the URL, as shown in the preceding figure.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">Unity does not support playing videos from YouTube, so you can host your video resources on other platforms, such as the Azure cloud.</p>
			<h2 id="_idParaDest-112"><a id="_idTextAnchor110"/>VideoPlayer.Play</h2>
			<p>In the previous two <a id="_idIndexMarker605"/>examples, whether we set the video clip asset or the video URL, the Video Player will automatically play the video. This is because we have enabled the <strong class="bold">Play On Awake</strong> option by default, as shown in <em class="italic">Figure 6.38</em>.</p>
			<div>
				<div id="_idContainer312" class="IMG---Figure">
					<img src="image/Figure_6.38_B17146.jpg" alt="Figure 6.38 – Play On Awake&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.38 – Play On Awake</p>
			<p>Usually, we prefer to be able to control when to play the video ourselves. Therefore, it is a good idea to disable this option and use C# code in a script to control playback, as shown in the following code block:</p>
			<p class="source-code">    public void OnClickPlay()</p>
			<p class="source-code">    {</p>
			<p class="source-code">        _videoPlayer.Play();</p>
			<p class="source-code">    }</p>
			<p>Here, we will create the<a id="_idIndexMarker606"/> third UI button and bind the button with the <strong class="source-inline">OnClickPlay</strong><strong class="bold"> </strong>function. </p>
			<div>
				<div id="_idContainer313" class="IMG---Figure">
					<img src="image/Figure_6.39_B17146.jpg" alt="Figure 6.39 – Play Video&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.39 – Play Video</p>
			<p>This time, if we run the <a id="_idIndexMarker607"/>game and click the <strong class="bold">Change Video Clip</strong> button or the <strong class="bold">Set Video URL</strong> button, there will be no video playing automatically. We also need to click the <strong class="bold">Play Video</strong> button to call the <strong class="source-inline">Play</strong> function of <strong class="bold">Video Player</strong> to play the video, as shown in <em class="italic">Figure 6.39</em>.</p>
			<h2 id="_idParaDest-113"><a id="_idTextAnchor111"/>VideoPlayer.frame and VideoPlayer.frameCount</h2>
			<p>Speaking of controlling video playback, the video progress bar is a useful feature. We can also implement a video progress<a id="_idIndexMarker608"/> bar in Unity. Next, let's discuss how to use the <strong class="source-inline">frame</strong> and <strong class="source-inline">frameCount</strong> properties of <strong class="bold">Video Player</strong> to implement a video progress bar. </p>
			<p>The <strong class="source-inline">frameCount</strong> property is <a id="_idIndexMarker609"/>read-only and provides the number of frames in the current video content. On the other hand, the <strong class="source-inline">frame</strong> property can be modified and provides the frame index of the current frame. Therefore, we should first create a UI slider and then modify the value of the slider according to the value of <strong class="source-inline">frame</strong> and <strong class="source-inline">frameCount</strong> for a <strong class="bold">VideoPlayer</strong> component, as shown in <em class="italic">Figure 6.40</em>.</p>
			<div>
				<div id="_idContainer314" class="IMG---Figure">
					<img src="image/Figure_6.40_B17146.jpg" alt="Figure 6.40 – Create a slider&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.40 – Create a slider</p>
			<p>We also need to modify the C# script to obtain a reference to the slider and update the value of the <a id="_idIndexMarker610"/>slider based<a id="_idIndexMarker611"/> on the value of <strong class="source-inline">frame</strong> and the value of <strong class="source-inline">frameCount</strong>:</p>
			<p class="source-code">using UnityEngine;</p>
			<p class="source-code">using UnityEngine.Video;</p>
			<p class="source-code"><strong class="bold">using UnityEngine.UI;</strong></p>
			<p class="source-code">public class VideoManager : MonoBehaviour</p>
			<p class="source-code">{</p>
			<p class="source-code">    [SerializeField] private VideoPlayer _videoPlayer;</p>
			<p class="source-code">    [SerializeField] private VideoClip _videoClip;</p>
			<p class="source-code">    [SerializeField] private string _videoURL;</p>
			<p class="source-code">    <strong class="bold">[SerializeField] private Slider _progressBar;</strong></p>
			<p class="source-code">    void Start()</p>
			<p class="source-code">    {</p>
			<p class="source-code">        if (_videoPlayer == null)</p>
			<p class="source-code">        {</p>
			<p class="source-code">            _videoPlayer = GetComponent&lt;VideoPlayer&gt;();</p>
			<p class="source-code">        }</p>
			<p class="source-code">    }</p>
			<p class="source-code"><strong class="bold">    private void Update()</strong></p>
			<p class="source-code"><strong class="bold">    {</strong></p>
			<p class="source-code"><strong class="bold">        _progressBar.value = (float)_videoPlayer.frame /</strong></p>
			<p class="source-code"><strong class="bold">          (float)_videoPlayer.frameCount;</strong></p>
			<p class="source-code"><strong class="bold">    }</strong></p>
			<p class="source-code">    public void OnClickChangeVideoClip()</p>
			<p class="source-code">    {</p>
			<p class="source-code">        _videoPlayer.clip = _videoClip;</p>
			<p class="source-code">    }</p>
			<p class="source-code">    public void OnClickSetVideoURL()</p>
			<p class="source-code">    {</p>
			<p class="source-code">        _videoPlayer.url = _videoURL;</p>
			<p class="source-code">    }</p>
			<p class="source-code">    public void OnClickPlay()</p>
			<p class="source-code">    {</p>
			<p class="source-code">        _videoPlayer.Play();</p>
			<p class="source-code">    }</p>
			<p class="source-code">}</p>
			<p>In this case, we are using the <strong class="source-inline">UnityEngine.UI</strong> namespace because we need to access the UI slider from our code. And we implemented the <strong class="source-inline">Update</strong> function to update the value of the slider. </p>
			<p>Let's run the game and play the video as before. </p>
			<div>
				<div id="_idContainer315" class="IMG---Figure">
					<img src="image/Figure_6.41_B17146.jpg" alt="Figure 6.41 – The progress bar&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.41 – The progress bar</p>
			<p>We can see that as the video plays, the progress bar is also updated.</p>
			<p>In this section, we explored and demonstrated the use of C# code to control audio and video, such as how to play audio and video, pause audio and video, and implement a progress bar via C# code.</p>
			<p>However, if you are using Unity to develop a web application, then you may encounter other problems. Let's continue to explore.</p>
			<h1 id="_idParaDest-114"><a id="_idTextAnchor112"/>Things to note when using Unity to develop web applications</h1>
			<p>Unity is a cross-platform game engine, which means that we can deploy games that use the same code base and resources on different platforms, including WebGL. However, if you are using Unity to develop games for the web platform, here are some notes about implementing a video player.</p>
			<h2 id="_idParaDest-115"><a id="_idTextAnchor113"/>URL</h2>
			<p>First of all, the <strong class="source-inline">VideoPlayer.clip</strong> property is not supported on WebGL, which means that you<a id="_idIndexMarker612"/> can implement your video player solution by playing the video content in the video clip assets in the editor. However, once you build and deploy your web application to the server and run it, the video will not be played, even if the required video assets are packaged and deployed together.</p>
			<div>
				<div id="_idContainer316" class="IMG---Figure">
					<img src="image/Figure_6.42_B17146.jpg" alt="Figure 6.42 – WebGL&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.42 – WebGL</p>
			<p>As shown in <em class="italic">Figure 6.42</em>, when we run the web app and click the <strong class="bold">Play Video</strong> button, nothing will happen.</p>
			<p>In this case, we have to provide a video source via the <strong class="source-inline">VideoPlayer.url</strong> property instead. If the video file has been hosted on another cloud platform, then we can directly use the method introduced in the previous section to play the video pointed to by the URL. In <a id="_idIndexMarker613"/>addition, <strong class="source-inline">VideoPlayer.url</strong> also supports local absolute or relative paths. Therefore, we can also build and deploy video files and other content of the game together. It should be noted that in this case, we no longer use Unity's video clip assets, but directly use the original video files, and put these video files in a folder called <strong class="source-inline">StreamingAssets</strong>.</p>
			<p class="callout-heading">Note</p>
			<p class="callout"><strong class="bold">StreamingAssets</strong> is a special folder name of a Unity project. Files in this folder are available in their original format.</p>
			<p>Here, we can create a new folder in the root of the project, rename it <strong class="bold">StreamingAssets</strong>, then put the <a id="_idIndexMarker614"/>original video file in this folder.</p>
			<div>
				<div id="_idContainer317" class="IMG---Figure">
					<img src="image/Figure_6.43_B17146.jpg" alt="Figure 6.43 – StreamingAssets folder&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.43 – StreamingAssets folder</p>
			<p>As you can see in <em class="italic">Figure 6.43</em>, the video file is in its original format and has not been converted into a <a id="_idIndexMarker615"/>Unity video clip asset. </p>
			<p>Next, let's create another C# script to demonstrate how to make <strong class="bold">Video Player</strong> load this video file and play it in the browser:</p>
			<p class="source-code">using System.IO;</p>
			<p class="source-code">using UnityEngine;</p>
			<p class="source-code">using UnityEngine.Video;</p>
			<p class="source-code">public class VideoManagerForWeb : MonoBehaviour</p>
			<p class="source-code">{</p>
			<p class="source-code">    [SerializeField] private VideoPlayer _videoPlayer;</p>
			<p class="source-code">    [SerializeField] private string _videoFileName;</p>
			<p class="source-code">    void Start()</p>
			<p class="source-code">    {</p>
			<p class="source-code">        if (_videoPlayer == null)</p>
			<p class="source-code">        {</p>
			<p class="source-code">            _videoPlayer = GetComponent&lt;VideoPlayer&gt;();</p>
			<p class="source-code">        }</p>
			<p class="source-code">    }</p>
			<p class="source-code">    public void OnClickSetVideoURL()</p>
			<p class="source-code">    {</p>
			<p class="source-code">        _videoPlayer.<strong class="bold">url</strong> =</p>
			<p class="source-code">          Path.Combine(<strong class="bold">Application.streamingAssetsPath</strong>,</p>
			<p class="source-code">          _videoFileName);</p>
			<p class="source-code">    }</p>
			<p class="source-code">}</p>
			<p>In this script, we access the <strong class="source-inline">Application.streamingAssetsPath</strong> property to get the path to the folder at runtime and assign the path to the <strong class="source-inline">url</strong> property of <strong class="source-inline">VideoPlayer</strong>.</p>
			<p>Now, instead of <a id="_idIndexMarker616"/>running the game in the editor, we build and deploy it as a web application, and then run it in the browser.</p>
			<div>
				<div id="_idContainer318" class="IMG---Figure">
					<img src="image/Figure_6.44_B17146.jpg" alt="Figure 6.44 – Play the video in the broswer&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.44 – Play the video in the broswer</p>
			<p>This time the video played as expected in the browser.</p>
			<h2 id="_idParaDest-116"><a id="_idTextAnchor114"/>Frame rate</h2>
			<p>When <a id="_idIndexMarker617"/>developing WebGL applications with Unity, another thing you should pay attention to is the <strong class="bold">frame rate</strong> of the video. In Unity, the frame rate is expressed as frames per second. </p>
			<p>Let's print the video length, video frame count, and video frame rate information of the sample video we are using in the editor.</p>
			<div>
				<div id="_idContainer319" class="IMG---Figure">
					<img src="image/Figure_6.45_B17146.jpg" alt="Figure 6.45 – Frame rate&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.45 – Frame rate</p>
			<p>As you can see here, the frame count of this video is 213, the video length is 7.1 seconds, and the frame rate is 30 FPS.</p>
			<p>However, since the underlying implementation on the WebGL platform, that is, the JavaScript API for <strong class="source-inline">HTML5 &lt;video&gt;</strong>, does not disclose frame rate information, the frame rate is always assumed to be 24 FPS, even if the real frame rate of the video is 30 FPS. Therefore, frames/second of a video is always 24, which should be paid attention to when implementing the video progress bar for WebGL.</p>
			<p>In this section, we discussed the things that need to be paid attention to when using Unity to develop video functions due to some limitations of the web platform. Next, we will explore how to use the profiler tool provided by Unity to locate the performance problems caused by audio and how to solve them.</p>
			<h1 id="_idParaDest-117"><a id="_idTextAnchor115"/>Increasing the performance of the audio system</h1>
			<p>In game development, the importance of audio is often overlooked. Sometimes this is also reflected in performance optimization. Game developers usually invest more effort in other performance areas, such as performance optimization for graphics rendering. But as games become more and more complex, audio can also cause performance problems, such as greater memory usage and so on. In this section, we will explore how to optimize audio performance in Unity.</p>
			<h2 id="_idParaDest-118"><a id="_idTextAnchor116"/>The Unity Profiler</h2>
			<p>First, we should learn how to use the <a id="_idIndexMarker618"/>Unity Profiler tool to view and locate performance bottlenecks caused by the audio system in Unity: </p>
			<ol>
				<li value="1">Click <strong class="bold">Window</strong> | <strong class="bold">Analysis</strong> | <strong class="bold">Profiler</strong> or use the keyboard shortcut <em class="italic">Ctrl</em> + <em class="italic">7</em> (<em class="italic">command + 7</em> on macOS) to open the <strong class="bold">Profiler</strong> window.</li>
				<li>Click the <strong class="bold">Audio</strong> module area in the <strong class="bold">Profiler</strong> window to view the performance data of the audio system. You can find out how many Audio Sources are playing, the number of audio clips being used, and the amount of memory being used for audio, and so on, as shown in <em class="italic">Figure 6.46</em>:</li>
			</ol>
			<div>
				<div id="_idContainer320" class="IMG---Figure">
					<img src="image/Figure_6.46_B17146.jpg" alt="Figure 6.46 – Audio Profiler&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.46 – Audio Profiler</p>
			<p>As shown in <em class="italic">Figure 6.46</em>, the value of <strong class="bold">Total Audio Memory</strong> is 38.9 MB, which is very bad because, currently, only<a id="_idIndexMarker619"/> one Audio Source is playing sound. Therefore, we can click on the drop-down menu labeled <strong class="bold">Simple</strong> and switch to the <strong class="bold">Detailed</strong> view.       </p>
			<p class="figure-caption">                      </p>
			<div>
				<div id="_idContainer321" class="IMG---Figure">
					<img src="image/Figure_6.47_B17146.jpg" alt="Figure 6.47 – Switch to the Detailed view&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.47 – Switch to the Detailed view</p>
			<ol>
				<li value="3">We can get more information about the audio system and identify the specific audio asset that occupies 38.9 MB of memory. </li>
			</ol>
			<div>
				<div id="_idContainer322" class="IMG---Figure">
					<img src="image/Figure_6.48_B17146.jpg" alt="Figure 6.48 – Detailed view&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.48 – Detailed view</p>
			<p>Next, we will introduce how to reduce the memory occupied by this audio resource.</p>
			<h2 id="_idParaDest-119"><a id="_idTextAnchor117"/>Using Force To Mono to save memory</h2>
			<p>If we inspect this<a id="_idIndexMarker620"/> audio asset, we will find the audio asset is stereo, as shown in <em class="italic">Figure 6.49</em>.</p>
			<div>
				<div id="_idContainer323" class="IMG---Figure">
					<img src="image/Figure_6.49_B17146.jpg" alt="Figure 6.49 – The audio clip&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.49 – The audio clip</p>
			<p>However, since there is only one Audio Source in the game scene, which means that the sound is emitted from one point, the effect of using stereo is lost here, but the memory consumption is twice that of mono. Therefore, if the game does not require stereo and needs to reduce memory overhead, we can just enable the <strong class="bold">Force To Mono</strong> option in the audio clip's import settings to convert the stereo audio clip to a mono audio clip.</p>
			<div>
				<div id="_idContainer324" class="IMG---Figure">
					<img src="image/Figure_6.50_B17146.jpg" alt="Figure 6.50 – Enable Force To Mono&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.50 – Enable Force To Mono</p>
			<p>Then let's play the <a id="_idIndexMarker621"/>audio again. This time we find that the memory consumption of this audio clip has dropped from 38.9 MB to 20.2 MB, which is almost halved.</p>
			<div>
				<div id="_idContainer325" class="IMG---Figure">
					<img src="image/Figure_6.51_B17146.jpg" alt="Figure 6.51 – Memory consumption has dropped&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.51 – Memory consumption has dropped</p>
			<p>In this section, we introduced how to use Unity's Profiler tool to view the performance data of the audio system and explored how to optimize the performance of the audio system.</p>
			<h1 id="_idParaDest-120"><a id="_idTextAnchor118"/>Summary</h1>
			<p>In this chapter, we started by introducing the audio and video features provided by Unity, then we explored some of the most important concepts in the Unity audio system and video system, such as <strong class="bold">audio clip</strong> assets, <strong class="bold">Audio Source</strong> components, <strong class="bold">Audio Listener</strong> components, <strong class="bold">Video Player</strong> components, and so on. We also discussed how to create a new script in Unity to interact with Unity's audio system and video system.</p>
			<p>Then we demonstrated how to implement a video for the web platform because WebGL does not support Unity's <strong class="bold">video clip</strong> assets and due to underlying implementation reasons, the video frame rate is always assumed to be 24 FPS. These need to be paid attention to.</p>
			<p>Finally, we explored how to view and locate performance bottlenecks caused by the audio system in Unity.</p>
			<p>In the next chapter, we will introduce the mathematics of computer graphics in Unity.</p>
		</div>
	</body></html>