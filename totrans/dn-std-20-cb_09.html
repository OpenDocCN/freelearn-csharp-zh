<html><head></head><body>
        

                            
                    <h1 class="header-title">To Android with Xamarin</h1>
                
            
            
                
<p class="mce-root">In this chapter, we will be looking at these recipes:</p>
<ul>
<li>Hello Android – creating a Xamarin Android app</li>
<li>Adding a .NET Standard 2.0 library to the Xamarin project</li>
<li>Putting things together and testing the application</li>
</ul>


            

            
        
    

        

                            
                    <h1 class="header-title">Technical requirements</h1>
                
            
            
                
<p>Readers should have a basic knowledge of C#. They should also have a basic knowledge of using Visual Studio, installing packages using NuGet, and referencing libraries within projects from other projects.</p>
<p class="mce-root">The code files for this chapter can be found on GitHub:<br/>
<a href="https://github.com/PacktPublishing/DotNET-Standard-2-Cookbook/tree/master/Chapter09/Chapter9.Xamarin">https://github.com/PacktPublishing/DotNET-Standard-2-Cookbook/tree/master/Chapter09/Chapter9.Xamarin</a></p>
<p class="mce-root">Check out the following video to see the code in action:<br/>
<a href="https://goo.gl/dMi9PZ">https://goo.gl/dMi9PZ</a></p>


            

            
        
    

        

                            
                    <h1 class="header-title">Introduction</h1>
                
            
            
                
<p>In this chapter, we will be looking at building an Android application using Visual Studio for Mac. We will also be building a .NET Standard 2.0 class library that the Android application will use. Visual Studio for Mac allows you to build Xamarin-based applications for iOS, Android, and Windows using your favorite C# programming language. It also has F# support by default. In the previous chapter, <a href="03c5bbfe-3780-4928-9256-c9f13a856479.xhtml">Chapter 8</a>, <em>To iOS with Xamarin</em>, we talked about how to install Visual Studio for Mac.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Hello Android – Creating a Xamarin Android app</h1>
                
            
            
                
<p>In this recipe, we will be looking at support for Android-based applications in Visual Studio for Mac. We will be looking at an Android project, setting up a solution for it, and checking for all the bits and pieces required.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>Make sure you have installed Visual Studio for Mac for your macOS system. If not, follow the <em>Installing Visual Studio for Mac</em> <em>and preparation</em> recipe, which shows you how to install it.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<ol>
<li>Open Finder.</li>
<li>Click Applications in the left-hand pane.</li>
</ol>
<ol start="3">
<li>Now, double-click on the Visual Studio icon:</li>
</ol>
<div><img class="alignnone size-full wp-image-843 image-border" src="img/cb7fc017-56bb-4707-987a-0051a40a7a8f.png" style="width:131.67em;height:78.17em;"/></div>
<p>Visual Studio</p>
<ol start="4">
<li>Click on the New Project button.</li>
<li>In the <strong>Choose a template for your project</strong> dialog box, scroll down till you reach the other section.</li>
</ol>
<ol start="6">
<li>Select Miscellaneous and, under Generic, select Blank Solution:</li>
</ol>
<div><strong><img class="alignnone size-full wp-image-844 image-border" src="img/d8e26056-1cb2-459b-b291-b2c21fe3be6c.png" style="width:52.58em;height:38.17em;"/><br/></strong></div>
<ol start="7">
<li>Now, click the Next button.</li>
</ol>
<ol start="8">
<li>In the Solution Name: textbox, type <kbd>Chapter9.Xamarin</kbd>. Also make sure you have selected a proper location:</li>
</ol>
<div><img class="alignnone size-full wp-image-845 image-border" src="img/8558734e-9654-4c68-8f1a-80676d65d8f4.png" style="width:53.83em;height:32.08em;"/></div>
<ol start="9">
<li>Now, click Create.</li>
<li>Now, the Solution Explorer should look like this:</li>
</ol>
<div><img class="alignnone size-full wp-image-846 image-border" src="img/fbbc0780-56c8-4cb7-b095-403901d42121.png" style="width:23.00em;height:7.33em;"/></div>
<ol start="11">
<li>Now, <em>control (^)</em> + click on the <kbd>Chapter9.Xamarin</kbd> label and select Add  | New Project.</li>
<li>Select App under the Android section in the left-hand pane. Select Android App in the right-hand pane.</li>
<li>Make sure C# is selected as the programming language:</li>
</ol>
<div><img class="alignnone size-full wp-image-847 image-border" src="img/9d9b22e5-da20-44a3-9139-0ade2dc577e2.png" style="width:54.75em;height:39.75em;"/></div>
<ol start="14">
<li>Click Next.</li>
<li>Now, in the App Name: textbox, type <kbd>Chapter9.Xamarin.AndroidApp</kbd> and, in the Organization Identifier: textbox, type <kbd>com.chapter9</kbd>. Leave the rest as it is:</li>
</ol>
<div><img class="alignnone size-full wp-image-848 image-border" src="img/e6e6e42e-a50a-4dbf-a4f1-91d10faf0d85.png" style="width:52.42em;height:38.08em;"/></div>
<ol start="16">
<li>Click Next.</li>
<li>Leave everything as it is and click Create:</li>
</ol>
<div><img class="alignnone size-full wp-image-849 image-border" src="img/f69931e1-9595-47c9-ab54-60e087df3f76.png" style="width:52.42em;height:38.08em;"/></div>
<ol start="18">
<li>Now, the Solution Explorer should look like this:</li>
</ol>
<div><img class="alignnone size-full wp-image-850 image-border" src="img/77aa9e2a-8760-4252-8115-09f1894dbeb4.png" style="width:17.42em;height:16.83em;"/></div>
<ol start="19">
<li>Now, you should see that the default template already has a working application.</li>
<li>Press the <em>command</em> + <em>return</em> keys to debug the application.</li>
<li>Now, you should see the default <kbd>HelloWorld</kbd> application running in the emulator: </li>
</ol>
<div><img class="alignnone size-full wp-image-851 image-border" src="img/e9ae392d-a6dc-496b-897e-505a8cc41361.png" style="width:15.00em;height:25.75em;"/></div>
<ol start="22">
<li>Click on the button to see it in action. Press <em>shift</em> + <em>command</em> + <em>return</em> to stop debugging.</li>
</ol>
<div><img class="alignnone size-full wp-image-852 image-border" src="img/6c451a43-fee9-4a35-ac9a-684cfa2b3fee.png" style="width:18.58em;height:31.92em;"/></div>


            

            
        
    

        

                            
                    <h1 class="header-title">How it works...</h1>
                
            
            
                
<p>In steps 1 to 10, we created a blank solution and gave it a proper name. In step 10, we added an Android App project to that solution. The Android App project is a default template created by Visual Studio for Mac. It's a working prototype application for testing that everything is intact.</p>
<p>If you look at the Solution Explorer and click on the <kbd>MainActivity.cs</kbd> file, you will see all the action. Inside the <kbd>OnCreate()</kbd> method, the code looks like this:</p>
<pre>base.OnCreate(savedInstanceState);<br/><br/>// Set our view from the "main" layout resource<br/>SetContentView(Resource.Layout.Main);<br/><br/>// Get our button from the layout resource,<br/>// and attach an event to it<br/>Button button = FindViewById&lt;Button&gt;(Resource.Id.myButton);<br/><br/>button.Click += delegate { button.Text = $"{count++} clicks!"; };</pre>
<p>You can see a simple button. When you click on the button, its increments are counted and it updates the button label. <kbd>FindViewById</kbd> will locate the button and create a <kbd>Button</kbd> class. Finally, the <kbd>button.Click</kbd> event triggers the process of counting and storing it in the button caption.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Adding a .NET Standard 2.0 library to the Xamarin project</h1>
                
            
            
                
<p>In this recipe, we will be looking at creating a .NET Standard 2.0 library and moving the default count code into the library. The counting code was created by Visual Studio for Mac as a default template for the Android app.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>Make sure you have completed the previous recipe that creates a default Android Application. If you have already completed it, let's open up that solution and get started.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<ol>
<li>Open Finder.</li>
<li>Click Applications in the left-hand pane.</li>
<li>Now, double-click on the Visual Studio icon.</li>
<li>Click on Open, locate the <kbd>Chapter9.Xamarin</kbd> solution, and open it.</li>
<li>The Solution Explorer should look like this:</li>
</ol>
<div><img class="alignnone size-full wp-image-853 image-border" src="img/b827d7b7-a14b-43dd-ab9b-7d448b888351.png" style="width:21.67em;height:22.50em;"/></div>
<ol start="6">
<li>Now, <em>control (^)</em> + click on the <kbd>Chapter9.Xamarin</kbd> label and select Add | New Project.</li>
<li>In the New Project dialog box, scroll down the left-hand pane until you see the Multi Platform section.</li>
</ol>
<ol start="8">
<li>Click on Library and select .NET Standard Library under General in the right-hand pane. Also make sure C# is selected:</li>
</ol>
<div><img class="alignnone size-full wp-image-854 image-border" src="img/e6d85d77-8e2f-41d5-b5e9-408eae258321.png" style="width:51.42em;height:37.33em;"/></div>
<ol start="9">
<li>Click Next.</li>
</ol>
<ol start="10">
<li>Select Target Framework: as .NET Standard 2.0 and click Next:</li>
</ol>
<div><img class="alignnone size-full wp-image-855 image-border" src="img/88ec6e88-0f48-4b86-bb6d-3f74fc5913a4.png" style="width:41.50em;height:17.08em;"/></div>
<ol start="11">
<li>In the Project Name: textbox, type <kbd>Chapter9.Xamarin.AndroidLib</kbd> as the name and leave the rest:</li>
</ol>
<div><img class="alignnone size-full wp-image-856 image-border" src="img/aa651d87-9342-4f19-922c-38d43b850822.png" style="width:41.42em;height:30.17em;"/></div>
<ol start="12">
<li>Click Create.</li>
<li>Now, the Solution Explorer should look like this:</li>
</ol>
<div><img class="alignnone size-full wp-image-857 image-border" src="img/76eed9d2-5c0f-47a4-8d95-4f1a29e93241.png" style="width:20.00em;height:23.00em;"/></div>
<ol start="14">
<li>Now, select the <kbd>Class1.cs</kbd> label and press <em>command</em> + <em>R</em> to rename.</li>
<li>Rename it <kbd>CounterLib.cs</kbd>.</li>
<li>Make sure you change the class name as well from <kbd>Class1</kbd> to <kbd>CounterLib</kbd>.</li>
<li>Now, inside the <kbd>CounterLib</kbd> class, add the following code:</li>
</ol>
<pre>      public int IncrementByOne(int value)<br/>      {<br/>          return value++;<br/>      }</pre>
<ol start="18">
<li>Click Build | Build All to check that all syntax is correct.</li>
</ol>


            

            
        
    

        

                            
                    <h1 class="header-title">How it works...</h1>
                
            
            
                
<p class="mce-root">In steps 1 to 4, we opened the solution created in the previous recipe. In steps 6 to 12, we added a .NET Standard 2.0 library to the solution. Now, the solution has two projects: an Android project and a .NET Standard 2.0 library project. In steps 14 to 16, we renamed the class created in Visual Studio. We also renamed the actual class name to match the filename.</p>
<p>In step 17, we added a public method that took an <kbd>integer</kbd> parameter and returned an integer value with one added to the value supplied. Finally, we performed a quick build to check for the correct syntax.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Putting things together and testing the application</h1>
                
            
            
                
<p>In this recipe, we will be putting everything together and testing the final application. We will be referencing the .NET Standard 2.0 library from the Android application and using the library from the Android application.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>Make sure you have completed the previous recipe that builds the .NET Standard 2.0 library. If you have, open up the solution and get started on this application.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<ol>
<li>Open Finder.</li>
<li>Click Applications in the left-hand pane.</li>
<li>Now, double-click on the Visual Studio icon.</li>
</ol>
<ol start="4">
<li>Click on Open, locate the <kbd>Chapter9.Xamarin</kbd> solution, and open it.</li>
<li>The Solution Explorer should look like this:</li>
</ol>
<div><img class="alignnone size-full wp-image-858 image-border" src="img/fae6e9e0-535b-4e74-8aae-285f623e5026.png" style="width:21.50em;height:24.67em;"/></div>
<ol start="6">
<li>Now, expand the <kbd>Chapter9.Xamarin.AndroidApp</kbd> project node.</li>
<li>In the Solution Explorer, <em>control (^)</em> + click on the References label and select Edit References.</li>
<li>In the Edit References dialog box, click on the Projects tab.</li>
</ol>
<ol start="9">
<li>Check <kbd>Chapter9.Xamarin.AndroidLib</kbd> in the list and click OK:</li>
</ol>
<div><img class="alignnone size-full wp-image-859 image-border" src="img/61d4c365-7274-44c5-b64d-907ec553a677.png" style="width:148.17em;height:95.50em;"/></div>
<ol start="10">
<li>Scroll up until you reach the <kbd>using</kbd> directives and add the following <kbd>using</kbd> directive to access the library:</li>
</ol>
<pre>      using Chapter9.Xamarin.AndroidLib;</pre>
<ol start="11">
<li>Now, double-click on the MainActivity.cs file to open its code.</li>
<li>Under the <kbd>MainActivity</kbd> class, find this code:</li>
</ol>
<pre>      int count = 1; </pre>
<p style="padding-left: 60px">  Replace the previous code with the following:</p>
<pre>      int count = 0;</pre>
<ol start="13">
<li>Now, scroll down until you reach the <kbd>OnCreate()</kbd> method.</li>
<li>Add the following code next to the <kbd>base.OnCreate()</kbd> line:</li>
</ol>
<pre>      CounterLib counter = new CounterLib();</pre>
<ol start="15">
<li>Now, replace the default button click code with the following:</li>
</ol>
<pre>      button.Click += delegate { <br/>          count = counter.IncrementByOne(count);<br/>          button.Text = $"{count} clicks!";<br/>      };</pre>
<ol start="16">
<li>Press <em>command</em> + <em>return</em> to debug the application.</li>
<li>Click the button a few times and you should see the following output: </li>
</ol>
<div><img class="alignnone size-full wp-image-860 image-border" src="img/72e458ec-2708-4eb2-9246-cf21a3b9ac5c.png" style="width:18.08em;height:31.25em;"/></div>
<ol start="18">
<li>Press <em>shift</em> + c<em>ommand</em> + <em>return</em> to stop debugging.</li>
</ol>


            

            
        
    

        

                            
                    <h1 class="header-title">How it works...</h1>
                
            
            
                
<p>In steps 1 to 6, we opened the existing solution we created in previous recipes. In step 9, we added a reference to the library from the Android application. In step 10, we added the code-level reference to the library. This will allow us to grab all the available methods from the library. In step 12, we changed the existing code. In step 14, we created an instance of <kbd>CounterLib()</kbd> and stored it in a variable.</p>
<p>In step 15, again, we made a small change to the button's existing click code to use the <kbd>IncrementByOne()</kbd> method from the class library. Finally, in steps 16, 17, and 18, we tested our new code.</p>


            

            
        
    </body></html>