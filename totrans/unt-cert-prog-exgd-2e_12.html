<html><head></head><body>
		<div><h1 id="_idParaDest-197"><em class="italic"><a id="_idTextAnchor200"/>Chapter 12</em>: NavMesh, Timeline, and a Mock Test</h1>
			<p>In this chapter, we are going to cover two main functionalities that Unity offers developers for issuing <strong class="bold">AI</strong> to our game objects and for animation that supports logic.</p>
			<p>Unity has a ready-made system for our game objects to issue a path-finding algorithm where a game object can be given an area to patrol. This can be very handy in a series of games that use enemy soldiers to walk up and down a corridor looking for the player. A soldier can react depending on the behavior given to them.</p>
			<p>The other functionality we will be covering is the <strong class="bold">Timeline</strong> component, which is used for animation in scenarios such as cutscenes in games/films. You may be thinking that we already covered an animation system back in <a href="B18381_04_Epub.xhtml#_idTextAnchor087"><em class="italic">Chapter 4</em></a>, <em class="italic">Applying Art, Animation, and Particles</em>. Yes, you are right, but for a more complex animation that holds multiple game objects and animations, transitions and states can get complex pretty easily. Also, Timeline supports a series of tracks that work specifically with our code, and we can add our own custom animation tracks to our timeline.</p>
			<p>These two main features will be assigned to our Killer Wave game project. The <strong class="bold">Navigation Mesh</strong> (<strong class="bold">NavMesh</strong>) controls a flock of small <strong class="bold">Non-Player-Character </strong>(<strong class="bold">NPC</strong>) robots that will move away from our player's ship as if they're panicking to stay alive.</p>
			<p>Timeline will be used to apply a mid-level cutscene where our player will see the end-of-level boss rush past them and lights in the scene will flash red.</p>
			<p>Finally, we will end this chapter with the last mini-mock test, which will include questions covering the content from this chapter and previous ones.</p>
			<p>The following topics will be covered in this chapter:</p>
			<ul>
				<li>Preparing the final scene</li>
				<li>Developing AI with NavMesh</li>
				<li>Exploring the timeline</li>
				<li>Extending the timeline</li>
			</ul>
			<p>Let's start by reviewing what skills are covered in this chapter.</p>
			<h1 id="_idParaDest-198"><a id="_idTextAnchor201"/>The core exam skills covered in this chapter</h1>
			<p><em class="italic">Programming core interaction</em>:</p>
			<ul>
				<li>Implementing behaviors and interactions of game objects and environments</li>
				<li>Identifying methods to implement camera views and movement</li>
			</ul>
			<p><em class="italic">Working in an art pipeline</em>:</p>
			<ul>
				<li>Knowledge of materials, textures, and shaders: The Unity rendering API</li>
				<li>Knowledge of lighting: The Unity lighting API</li>
				<li>Knowledge of two-dimensional and three-dimensional animation: The Unity animation API</li>
			</ul>
			<p><em class="italic">Programming for the scene and environment design</em>:</p>
			<ul>
				<li>Determining scripts for pathfinding with the Unity navigation system</li>
			</ul>
			<h1 id="_idParaDest-199"><a id="_idTextAnchor202"/>Technical requirements</h1>
			<p>The project content for this chapter can be found at <a href="https://github.com/PacktPublishing/Unity-Certified-Programmer-Exam-Guide-Second-Edition">https://github.com/PacktPublishing/Unity-Certified-Programmer-Exam-Guide-Second-Edition</a>.</p>
			<p>You can download the entirety of each chapter's project files at <a href="https://github.com/PacktPublishing/Unity-Certified-Programmer-Exam-Guide-Second-Edition">https://github.com/PacktPublishing/Unity-Certified-Programmer-Exam-Guide-Second-Edition</a>.</p>
			<p>All the content for this chapter is held in the chapter's <code>unitypackage</code> file, including a <code>Complete</code> folder that holds all of the work we'll carry out in the chapter.</p>
			<p>Check out the following video to see the <em class="italic">Code in Action</em>: <a href="https://bit.ly/3LsC0B4">https://bit.ly/3LsC0B4</a>.</p>
			<h1 id="_idParaDest-200"><a id="_idTextAnchor203"/>Preparing the final scene</h1>
			<p>In this section, we are going to prepare our new <code>level3</code> scene in two parts – the first part of our game <a id="_idIndexMarker1276"/>will have some three-dimensional art assets for the player to potentially collide with. Also, the environment will be used for our new fleeing enemies. The second part of this section is used to upgrade our camera's behavior so that instead of it being static, we now require it to move across the level. The player will also be given the same fixed speed as the camera.</p>
			<p>By the end of this section, we will have an environment set up, as shown in the following screenshot:</p>
			<div><div><img src="img/Figure_12.01_B18381.jpg" alt="Figure 12.1 – Our third level assets&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.1 – Our third level assets</p>
			<p>The arrow going from left to right in the previous screenshot shows the path of the camera. Once it reaches a particular point, it will stop, and the level will end shortly after.</p>
			<p>It is worth mentioning that within the <code>level3Env</code> prefab is a game object that holds a script called <code>BossTrigger</code>. This game object contains a box collider, a rigid body, and a <code>BossTriggerBox</code> script.</p>
			<p>The purpose of the <code>BossTrigger</code> game object is to activate the <code>BossTrigger</code> collider. We will discuss this further in the <em class="italic">Exploring the timeline</em> section of this chapter.</p>
			<p>Let's continue by moving our <code>level3</code> file's environment into the scene:</p>
			<ol>
				<li>From the <code>Assets/Scene</code> and double-click on the <code>level3</code> scene file.</li>
				<li>From the <code>Assets/Prefab</code>.</li>
				<li>Click and drag the <code>level3Env</code> prefab into the <code>_SceneAssets</code> game object in the <strong class="bold">Hierarchy</strong> window.</li>
				<li>Select <code>level3Env</code> from the <code>2500</code>, <code>17</code>, and <code>-24</code></li><li><code>0.55</code>, <code>0.55</code>, and <code>0.55</code></li></ul></li>
			</ol>
			<p>The following screenshot shows our scene setup, which is ready for our player to fly into:</p>
			<div><div><img src="img/Figure_12.02_B18381.jpg" alt="Figure 12.2 – The level 3 assets in place&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.2 – The level 3 assets in place</p>
			<p>So, we need to make some changes to our <code>level3</code> scene so that it acts in a way that ensures the <a id="_idIndexMarker1278"/>camera supports the new environment and the environment itself doesn't have extra assets that we don't need, such as the animating texture quad for the background and the prefab particle system for the stars flying past. Be aware, if any of these game objects are in a prefab state, be sure to unpack (right click game object in <strong class="bold">Hierarchy</strong> <strong class="bold">Prefab | Unpack</strong>) them otherwise we will be changing the content in levels 1 and 2.</p>
			<p>Alter the <code>level3</code> scene in the <strong class="bold">Hierarchy</strong> window by doing the following:</p>
			<ol>
				<li value="1">Thankfully, the aforementioned two assets sit within the <code>GameSpeed</code> game object in the <code>GameSpeed</code> game object.</li>
				<li>We won't be using any directional lighting in our scene, so also remove <code>Directional Light</code> from the <strong class="bold">Hierarchy</strong> window.</li>
				<li>Also, for the sake of running our <code>level3</code> scene without going through the entire game loop, we can drop our <code>GameManager</code> prefab from the <code>Assets/Prefab</code> folder location into the <strong class="bold">Hierarchy</strong> window.</li>
			</ol>
			<p>Our <code>level3</code> will now look like the one in the following screenshot:</p>
			<div><div><img src="img/Figure_12.03_B18381.jpg" alt="Figure 12.3 – Our Hierarchy layout so far&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.3 – Our Hierarchy layout so far</p>
			<p>We now need to make it so that the <strong class="bold">Camera</strong> component supports a far clipping-plane value. To do this, we need to do the following:</p>
			<ol>
				<li value="1">Select the main camera in the <strong class="bold">Hierarchy</strong> window.</li>
				<li>In the <code>1300</code>.</li>
			</ol>
			<p>So, we have <a id="_idIndexMarker1279"/>adjusted the clipping plane of the camera to show all of the <code>level3</code> file's environment, removed the <code>GameSpeed</code> game object that helps art assets for our previous levels, and added <code>GameManager</code> to <code>level3</code> to make development easier. We now need to turn our focus toward making the camera actually move instead of creating the illusion it is moving, as with <code>level1</code> and <code>level2</code>.</p>
			<p>I have created a small script that will make the camera move from one point to another; everything inside the script demonstrates elements of code that we have already covered throughout this book. So, there's no need for you to create the script, but understanding it is obviously the main purpose.</p>
			<p>We are going to attach the script to the main camera in our scene to control its movement. Follow these instructions:</p>
			<ol>
				<li value="1">Select the main camera from the <strong class="bold">Hierarchy</strong> window.</li>
				<li>Click the <code>CameraMovement</code> until you see the script appear in the dropdown.</li>
				<li>Select the <strong class="bold">CameraMovement</strong> script.</li>
				<li>Click on <code>box collider</code> into the drop-down list. When it appears, select it and check its <strong class="bold">Is Trigger</strong> box.</li>
				<li>In brief, this script will translate along its <em class="italic">x</em> axis after 6 seconds when active. When the script reaches a particular point, it will stop; it will also make sure that the player stops traveling with it.</li>
			</ol>
			<p>Let's modify <a id="_idIndexMarker1280"/>our <code>Player</code> script to act on the movement of the camera for <code>level3</code>:</p>
			<ol>
				<li value="1">In the <code>Assets/Script</code> and double-click on the <code>Player</code> script to open it.</li>
				<li>Inside the <code>Player</code> script, at the top where we have our global variables, enter the private variable and its property:<pre>float camTravelSpeed;
public float CamTravelSpeed
{
  get {return camTravelSpeed;}
  set {camTravelSpeed = value;}
}
float movingScreen;</pre></li>
			</ol>
			<p>The <code>camTravelSpeed</code> variable that we just entered will be used as an extra multiplier to set the pace of the player's ship when the camera moves along the <em class="italic">x</em> axis.</p>
			<p>The second variable, <code>movingScreen</code>, will hold the result of <code>Time.deltaTime</code> multiplied by <code>camTravelspeed</code>. Later, <code>movingScreen</code> will be used when it comes to comparing the player's ship's <em class="italic">x</em> axis.</p>
			<ol>
				<li value="3">In the <code>Start</code> function, add the following line at the bottom of its function:<pre>movingScreen = width;</pre></li>
			</ol>
			<p>Inside the <code>Start</code> function, we will add our <code>width float</code> measurement to <code>movingScreen</code> (this happens after <code>width</code> has been updated in the <code>Start</code> function), as this will be the starting position before it receives its increments from <code>Time.deltaTime</code> and <code>camTravelspeed</code>.</p>
			<p>Still inside the <code>Player</code> script, scroll down to the <code>Movement</code> method.</p>
			<ol>
				<li value="4">At the <a id="_idIndexMarker1281"/>top of the <code>Movement</code> method, enter the following code, which will multiply our player's ship's speed:<pre>if(camTravelSpeed &gt; 1)
  {
   transform.position += Vector3.right * 
       Time.deltaTime * camTravelSpeed;
   movingScreen += Time.deltaTime * camTravelSpeed;
  }</pre></li>
			</ol>
			<p>In the code that we've just entered, we will run a check to see whether <code>camTravelSpeed</code> has increased from our new <code>CameraMovement</code> script. If <code>camTravelSpeed</code> has been updated, we fall into the scope of the <code>if</code> statement.</p>
			<p>Within the <code>if</code> statement, we will increment the player's ship's <em class="italic">x</em> axis to the right, multiplied by <code>Time.deltaTime</code> and <code>camTravelSpeed</code>.</p>
			<p>The second thing we do is add the <code>movingScreen</code> value that originally holds the current <code>width</code> of our playing area. However, because the screen is moving, we need to increment the playing area so that the player doesn't get left behind or go too far out of the camera view.</p>
			<p>The last amendment we add to our <code>Player</code> script is our horizontal movements, still in the <code>Movement</code> method.</p>
			<ol>
				<li value="5">Scroll down until you get to where the player can press the <em class="italic">right arrow</em> to move (<code>Input.GetAxisRaw("Horizontal") &gt; 0</code>). Within the scope of the <code>if</code> statement, we can amend the second <code>if</code> statement to the following: <pre>if (transform.localPosition.x &lt; movingScreen+(width/0.9f))</pre></li>
			</ol>
			<p>If the player presses the <em class="italic">right arrow</em> on their keyboard/joypad, we can run a check to see whether the player's <em class="italic">x</em> axis is less than the <code>movingScreen</code> float value; plus, we will include a buffer to push the player further to the edge of the screen.</p>
			<ol>
				<li value="6">We can <a id="_idIndexMarker1282"/>then do the same for when the player presses the <em class="italic">left arrow</em> on the keyboard/joystick within the second <code>if</code> statement:<pre>if (transform.localPosition.x &gt; movingScreen+width/6)</pre></li>
			</ol>
			<p>Similar rules apply where we make use of the <code>movingScreen</code> variable, which is constantly incremented along with a slight buffer to keep our player's ship within the game screen.</p>
			<ol>
				<li value="7">Save the <code>Player</code> script.</li>
			</ol>
			<p>Before we move on to the next script, we need to uncomment two lines of code in our new <code>CameraMovement</code> script so that it can interact with the <code>Player</code> script.</p>
			<p>Back in the <code>CameraMovement</code> script and uncomment the two following lines by removing <code>//</code>. The first line to uncomment is the following:</p>
			<pre> // GameObject.Find("Player").GetComponent&lt;Player&gt;().CamTravelSpeed = camSpeed;</pre>
			<p>The second line to uncomment is the following:</p>
			<pre>//   GameObject.Find("PlayerSpawner").GetComponentInChildren&lt;Player&gt;().CamTravelSpeed = 0;</pre>
			<p>Now, these two lines of code can alter the speed of the player ship.</p>
			<p>Next, we need to update our <code>GameManager</code> script so that it recognizes the difference between <code>level1</code>, <code>level2</code>, and <code>level3</code>, which has a moving camera.</p>
			<p>So, let's <a id="_idIndexMarker1283"/>move to the <code>GameManager</code> script and add two main elements – the camera speed and noticing the difference between scenes. Let's start by opening the <code>GameManager</code> script:</p>
			<ol>
				<li value="1">From the <code>Assets/Script</code>.</li>
				<li>Double-click on the <code>GameManager</code> script to open it in your IDE.</li>
			</ol>
			<p>You may or may not have looked into the <code>CameraMovement</code> script that we attached to the main camera, but inside that script is a variable called <code>camSpeed</code>. This variable manipulates the camera's speed; in our <code>GameManager</code> script, we set the speed of the main camera.</p>
			<p>The main takeaway from this is that the <code>CameraMovement</code> script will manipulate the camera's speed from what is set in the <code>GameManager</code> script.</p>
			<ol>
				<li value="3">In the <code>GameManger</code> script, scroll down to the method titled <code>CameraSetup</code>.</li>
				<li>We are going to make this method take a variable to alter the camera's speed. Change the <code>CameraSetup</code> method to take a <code>float</code> value in its parameter. The <code>CameraSetup</code> method will first look as follows:<pre>public void CameraSetup()</pre></li>
			</ol>
			<p>It will then change to this:</p>
			<pre>public void CameraSetup(float camSpeed)</pre>
			<ol>
				<li value="5">Within the <code>CameraSetup</code> method, we need to transfer <code>camSpeed</code> to the new <code>CameraMovement</code> script: <pre>gameCamera.GetComponent&lt;CameraMovement&gt;().CamSpeed = camSpeed;</pre></li>
			</ol>
			<p>Note that the line of code we add to our <code>CameraSetup</code> method needs to be added after the main camera has been stored in a <code>gameCamera</code> variable. Before continuing we also need to remove the reference to the <code>CameraSetup</code> from the <code>PlayerSpawner</code> script as we also don't need this anymore.</p>
			<ol>
				<li value="6">Open the <code>PlayerSpawner</code> script.</li>
				<li>Scroll to the bottom and remove: <code>GameManager.Instance.CameraSetup()</code>.</li>
				<li>Save the script and return to the <code>GameManager</code> script.</li>
			</ol>
			<p>The last thing to do in the <code>GameManager</code> script is to update the <code>LightandCameraSetup</code> method so that when the <code>CameraSetup</code> method within it is called, it takes a value that sets the main camera's speed. So, in <code>level1</code> and <code>level2</code>, we want the camera to continue <a id="_idIndexMarker1284"/>to not move; in <code>level3</code>, we will need to apply speed to the camera.</p>
			<ol>
				<li value="9">Within <code>LightandCameraSetup</code>, replace its original <code>switch</code> statement with the following:<pre>    switch (sceneNumber)
    {
      case 3 : case 4 :
      {
        LightSetup();
        CameraSetup(0);
        break;
      }
      case 5:
      {
        CameraSetup(150);
        break;
      }
    }</pre></li>
			</ol>
			<p>So, before, our <code>switch</code> statement had all the cases run <code>LightSetup</code> and <code>CameraSetup</code> within cases <code>3</code>, <code>4</code>, and <code>5</code>. But now, in the previous code, we have split the roles up. In cases <code>3</code> and <code>4</code>, we run <code>LightSetup</code> as usual, and now, because <code>CameraSetup</code> now takes a <code>float</code> value, we set the camera speed to <code>0</code>.</p>
			<p>In case <code>5</code>, which is the build number for our <code>level3</code> scene, we ignore <code>LightSetup</code>, as we won't be using a directional light in this scene. We run <code>CameraSetup</code> but give it a value of <code>150</code>, which will also be the speed we set the <code>camSpeed</code> variable within the method.Save the <code>GameManager</code> script.</p>
			<ol>
				<li value="10">Press <code>level3</code> scene plays out. The following screenshot shows what we have so far:</li>
			</ol>
			<div><div><img src="img/Figure_12.04_B18381.jpg" alt="Figure 12.4 – Level 3 in Play mode&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.4 – Level 3 in Play mode</p>
			<p>The previous screenshot shows a series of events of what happens after we press <strong class="bold">Play</strong> in the Unity Editor Let's go through each event sequentially:</p>
			<ul>
				<li>The <code>level3</code> scene before pressing <strong class="bold">Play</strong> (denoted by <strong class="bold">1.</strong>).</li>
				<li>The scene is in play mode and sets up the camera position and background (denoted by <strong class="bold">2.</strong>).</li>
				<li>The UI for the level is animated, and the enemies start floating into the game window (denoted by <strong class="bold">3.</strong>).</li>
				<li>The player enters the level, and the scene pauses for a few seconds before the player gets control of their ship (denoted by <strong class="bold">4.</strong>).</li>
				<li>The camera begins to move along with the radar camera, following the progress of the player and the oncoming enemies (denoted by <strong class="bold">5.</strong>).</li>
			</ul>
			<p>In the next section, we will add our second enemy type (flee enemy), which will flee across the span of our new art.</p>
			<h1 id="_idParaDest-201"><a id="_idTextAnchor204"/>Developing AI with NavMesh</h1>
			<p>In this section, we are going to introduce a new enemy that will attempt to flee with frenzy-type <a id="_idIndexMarker1286"/>behavior from our player's ship. This enemy's behavior will be implemented with the use of Unity's built-in <code>NavMesh</code> functionality.</p>
			<p>As you <a id="_idIndexMarker1287"/>can imagine, this built-in feature from Unity can answer a lot of problems with regard to games with NPCs, similar to ones in the Metal Gear Solid game, where the player has to sneak around and not get detected by the enemy soldiers. </p>
			<p><code>NavMesh</code> gives the enemy soldiers a path to walk around, and then if they see the player, their behavior changes from <code>Patrolling</code> to <code>Attack</code>.</p>
			<p>So, with our game, we are going to implement <code>NavMesh</code> but make it so that our enemies react differently to how they would in <em class="italic">Metal Gear Solid</em>. We will add multiple flee enemies in clusters to our third-level scene. This chaotic, distracting behavior will make the final level more challenging for our players. </p>
			<p>The following screenshot shows our fleeing enemy with a cylindrical radius around it. This radius is called the agent radius and can be altered to stop other obstacles and enemies from intersecting with each other:</p>
			<div><div><img src="img/Figure_12.05_B18381.jpg" alt="Figure 12.5 – Fleeing enemies&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.5 – Fleeing enemies</p>
			<p>Before we add these fleeing enemies to our scene, we need to tell the fleeing enemies where they can move around by baking a NavMesh first. </p>
			<p>First, we need <a id="_idIndexMarker1288"/>to select the game object that we will use <a id="_idIndexMarker1289"/>to bake, which also means we need to deselect game objects that don't need to be <strong class="bold">Navigation Static</strong>. To bake a NavMesh, follow these instructions:</p>
			<ol>
				<li value="1">From the <code>_SceneAssets</code> game object.</li>
				<li>From the <code>_SceneAssets</code>.</li>
				<li>The following screenshot shows <code>_SceneAssets</code> selected and the static dropdown (denoted by <strong class="bold">1.</strong>), followed by <strong class="bold">Navigation Static</strong> being unticked (denoted by <strong class="bold">2.</strong>):</li>
			</ol>
			<div><div><img src="img/Figure_12.06_B18381.jpg" alt="Figure 12.6 – Unticking Navigation Static&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.6 – Unticking Navigation Static</p>
			<ol>
				<li value="4">A window pops up asking whether we want to apply the changes to all the child objects. Select <strong class="bold">Yes, change children</strong>.</li>
			</ol>
			<p>So, we have <a id="_idIndexMarker1290"/>just deactivated all of our environment art assets in the <code>level3</code> scene so that they are not recognized for navigation <a id="_idIndexMarker1291"/>baking. We now need to turn on one of the child game objects within the <code>_SceneAssets</code> hierarchy: </p>
			<ol>
				<li value="1">From the <code>corridorFloorNav</code>:<ul><li><code>_SceneAssets</code></li><li><code>level</code></li><li><code>corridorFloor</code></li></ul></li>
			</ol>
			<p>The following screenshot shows that from the <code>corridorFloorNav</code> (denoted by <strong class="bold">1.</strong>):</p>
			<ol>
				<li value="2">With <code>corridorFloorNav</code> selected, make sure its <strong class="bold">Mesh Renderer</strong> component is ticked in the <strong class="bold">Inspector</strong> window (denoted by <strong class="bold">2.</strong>).</li>
				<li>Finally, select <strong class="bold">Navigation Static</strong> for this game object (denoted by <strong class="bold">3.</strong>):</li>
			</ol>
			<div><div><img src="img/Figure_12.07_B18381.jpg" alt="Figure 12.7 – Turning on the 'corridorFloorNav' game object, Mesh Renderer, and the 'Navigation Static' layer&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.7 – Turning on the 'corridorFloorNav' game object, Mesh Renderer, and the 'Navigation Static' layer</p>
			<p>We now <a id="_idIndexMarker1292"/>need to check the <code>CorridorFloorNav</code> mesh.</p>
			<ol>
				<li value="4">Select <strong class="bold">Window</strong> at the top of the Unity Editor and then click on <strong class="bold">AI | Navigation</strong>.</li>
			</ol>
			<p>It's likely <a id="_idIndexMarker1293"/>that the <strong class="bold">Navigation</strong> window will appear at the top-right corner of the Editor If it doesn't and has appeared as a floating window somewhere in the Unity Editor simply click and hold on the <strong class="bold">Navigation</strong> tab and dock it next to the <strong class="bold">Inspector</strong> tab, as in the following screenshot:</p>
			<div><div><img src="img/Figure_12.08_B18381.jpg" alt="Figure 12.8 – The Navigation window&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.8 – The Navigation window</p>
			<ol>
				<li value="5">In the <strong class="bold">Navigation</strong> window, click on the <strong class="bold">Bake</strong> button at the top to give us our <strong class="bold">Navigation</strong> bake options.<p class="callout-heading">Further Information</p><p class="callout">It's also worth noting that a game object that is manipulated in the NavMesh is referred to as an agent.</p></li>
			</ol>
			<p>In this <a id="_idIndexMarker1294"/>window, we are presented with a series of <a id="_idIndexMarker1295"/>options for our navigation bake. This may look a little intimidating at first, but the blue cylinder is basically our agent (the fleeing enemy) and the following parameters are based on how flexible our agent is with the navigation path it'll be walking around. Let's briefly go through each of the options so that we are aware of its features before we bake:</p>
			<ul>
				<li><strong class="bold">Agent Radius</strong>: This will create an invisible shield around our agent so that they can't clip into other agents, walls, doors, and so on.</li>
				<li><strong class="bold">Agent Height</strong>: Similar to <strong class="bold">Agent Radius</strong>, this gives our agent an invisible height; this can be useful for the game object that the NavMesh is manipulating to pass through doors.</li>
				<li><strong class="bold">Max Slope</strong>: We can alter, in degrees, how much of a slope our agent can walk up.</li>
				<li><strong class="bold">Step Height</strong>: This is similar to the <strong class="bold">Max Slope</strong> property, but in this case, this controls how much our agent is allowed to move up a step/stair.</li>
				<li><strong class="bold">Drop Height</strong>: Enter a value for the maximum height the character can drop down from (associated with the <strong class="bold">Off Mesh Link</strong> component).</li>
				<li><strong class="bold">Jump Distance</strong>: This specifies the value for the jump distance between the character and the object (associated with the <strong class="bold">Off Mesh Link</strong> component).<p class="callout-heading">Further Information</p><p class="callout">Information <a id="_idIndexMarker1296"/>about the <strong class="bold">Off Mesh Link</strong> component can be found at <a href="https://docs.unity3d.com/Manual/class-OffMeshLink.html">https://docs.unity3d.com/Manual/class-OffMeshLink.html</a>.</p></li>
				<li><strong class="bold">Manual Voxel</strong>: A voxel is <a id="_idIndexMarker1297"/>a three-dimensional measurement that <a id="_idIndexMarker1298"/>is used to scale the accuracy of our navigation bake.</li>
				<li><strong class="bold">Voxel Size</strong>: If the <strong class="bold">Manual Voxel</strong> option is ticked, this means we can give each agent tighter precision. The lower the number, the more accurate our agent will be; note that this will make the NavMesh take longer to bake. </li>
				<li><strong class="bold">Min Region Area</strong>: This specifies a minimum area that a surface must have for it to be included in the NavMesh.</li>
				<li><strong class="bold">Height Mesh</strong>: This checkbox will create a height mesh, which will improve the movement accuracy. This will also make navigation baking slower.</li>
			</ul>
			<p>The following screenshot shows the navigation bake settings we just went through:</p>
			<div><div><img src="img/Figure_12.09_B18381.jpg" alt="Figure 12.9 – The Navigation window with the 'Bake' tab selected&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.9 – The Navigation window with the 'Bake' tab selected</p>
			<p>Thankfully, the <strong class="bold">Bake</strong> properties of our default setup window will work just fine as it is.</p>
			<ol>
				<li value="6">Click on the <strong class="bold">Bake</strong> button at the bottom right of the <strong class="bold">Navigation</strong> window and wait <a id="_idIndexMarker1299"/>until the meter at the bottom-right corner <a id="_idIndexMarker1300"/>of the Editor completes, as shown in the following screenshot:</li>
			</ol>
			<div><div><img src="img/Figure_12.10_B18381.jpg" alt="Figure 12.10 – Exporting Tiles for your NavMesh&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.10 – Exporting Tiles for your NavMesh</p>
			<p>Once the navigation bake has completed, <code>corridorFloorNav</code> in our <strong class="bold">Scene</strong> window will have a NavMesh sitting on top of its mesh.</p>
			<p>If you can't see the navigation-baked mesh, make sure that the <strong class="bold">Show NavMesh</strong> checkbox is ticked at the bottom-right corner of the mesh. The following screenshot shows our NavMesh and the <strong class="bold">Navmesh Display</strong> box:</p>
			<div><div><img src="img/Figure_12.11_B18381.jpg" alt="Figure 12.11 – Our navigation mesh and its display at the bottom-right corner of the 'Scene' window&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.11 – Our navigation mesh and its display at the bottom-right corner of the 'Scene' window</p>
			<p>The last <a id="_idIndexMarker1301"/>thing to do in this section is turn off the <code>corridorFloorNav</code> game object's <strong class="bold">Mesh Renderer</strong> component. We only needed <a id="_idIndexMarker1302"/>this component to be active for the NavMesh to be baked.</p>
			<p>To turn off the <code>corridorFloorNav</code> game object's <strong class="bold">Mesh Renderer</strong> component, do the following:</p>
			<ol>
				<li value="1">Select the <code>corridorFloorNav</code> game object in the <strong class="bold">Hierarchy</strong> window.</li>
				<li>In the <strong class="bold">Inspector</strong> window, uncheck the <strong class="bold">Mesh Renderer</strong> component.</li>
			</ol>
			<p>The following screenshot shows the highlighted box that needs unchecking:</p>
			<div><div><img src="img/Figure_12.12_B18381.jpg" alt="Figure 12.12 – Unticking the 'corridorFloorNav' mesh&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.12 – Unticking the 'corridorFloorNav' mesh</p>
			<p>This is <a id="_idIndexMarker1303"/>all that is needed to allow our fleeing enemies <a id="_idIndexMarker1304"/>to move around.</p>
			<p class="callout-heading">Further Information</p>
			<p class="callout">If you would <a id="_idIndexMarker1305"/>like to find out more about the <strong class="bold">Navigation</strong> window, check out <a href="https://docs.unity3d.com/Manual/Navigation.html">https://docs.unity3d.com/Manual/Navigation.html</a>.</p>
			<p>So far in this section, we have discussed the requirements of AI and how it is used in games and how we are going to apply such methods to our fleeing enemies, with the use of the <code>NavMesh</code> system that Unity offers as standard.</p>
			<p>Now that we have our NavMesh baked for our agents to move around on, we can look into setting up our <code>NavMeshAgent</code> component to give our agents a set speed, acceleration, stopping distance, and more in the next section.</p>
			<h2 id="_idParaDest-202"><a id="_idTextAnchor205"/>Customizing our agents – NavMeshAgent</h2>
			<p>In this section, we will be continuing from setting up our NavMesh but shifting the focus toward the <a id="_idIndexMarker1306"/>agent (the fleeing enemy game object). The agent will be moving around the baked NavMesh.</p>
			<p>It is necessary for the fleeing enemy game object to be able to react and move within the NavMesh but also be able to move in a way that suits the behavior of what we're trying to achieve. For example, the enemy is to flee with an element of panic; so, we need to consider characteristics such as when the enemy decides to move, how quickly the enemy will react, and how fast the enemy can move. These properties, and more, come from a component called <code>NavMeshAgent</code>.   </p>
			<p><code>NavMeshAgent</code> is a required component that will be attached to each of the fleeing enemy game objects. The purpose of this component is to make it so that the game object is recognized as an agent and will stick to the NavMesh.</p>
			<p>Before we add <code>NavMeshAgent</code> to the fleeing enemy, we need to create a prefab of the enemy <a id="_idIndexMarker1307"/>so that we have a place where we can grab and clone copies of multiple enemies:</p>
			<ol>
				<li value="1">From the <code>Assets/Model</code> folder and drag <code>enemy_flee.fbx</code> to the bottom of the <strong class="bold">Hierarchy</strong> window.</li>
				<li>Drag <code>enemy_flee</code> from the <code>Assets/Prefab/Enemies</code>. When the window pops up asking if you want a variant or original. Pick original.  As there is only one type of this enemy.</li>
			</ol>
			<p>That's our fleeing enemy created; now, we can apply a material to it by doing the following:</p>
			<ol>
				<li value="1">Navigate to the <code>Assets/Prefab/Enemies</code> folder and select the <code>enemy_flee</code> prefab.</li>
				<li>From the <strong class="bold">Inspector</strong> window, select the remote button of the <strong class="bold">Mesh Renderer</strong> component (denoted by <strong class="bold">1</strong>. in the following screenshot).</li>
				<li>A dropdown will appear. Type <code>darkRed</code> in the search bar at the top if you can't see the material on the list.</li>
				<li>Double-click on <code>darkRed</code> from the dropdown (denoted by <strong class="bold">2.</strong> in the following).</li>
				<li>At this point, make sure that the <code>0</code> value and that the <code>1</code>.</li>
			</ol>
			<p>The following screenshot shows the <code>enemy_flee</code> prefab with its update material and the correct <strong class="bold">Transform</strong> values:</p>
			<div><div><img src="img/Figure_12.13_B18381.jpg" alt="Figure 12.13 – Adding the 'darkRed' material to the 'enemy_flee' Mesh Renderer Materials slot&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.13 – Adding the 'darkRed' material to the 'enemy_flee' Mesh Renderer Materials slot</p>
			<p>You may <a id="_idIndexMarker1308"/>have noticed in the previous screenshot that <code>enemy_flee</code> has hard, shiny edges. We can make these appear smoother in our three-dimensional model import settings by doing the following:</p>
			<ol>
				<li value="1">From the <code>Assets/Model</code> folder and select <code>enemy_flee</code>.</li>
				<li>In the <strong class="bold">Inspector</strong> window, change the property value for <strong class="bold">Normals</strong> from <strong class="bold">Import </strong> to <strong class="bold">Calculate</strong>.</li>
			</ol>
			<p>We can now adjust the <strong class="bold">Smoothing Angle</strong> value with the slider to change the smoothness between angles, as shown in the following screenshot:</p>
			<div><div><img src="img/Figure_12.14_B18381.jpg" alt="Figure 12.14 – Smoothing the edges of our enemy&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.14 – Smoothing the edges of our enemy</p>
			<p>In the previous screenshot, you can see three distinct stages in making the model look smoother. This can be done with any three-dimensional model imported into Unity.</p>
			<ol>
				<li value="3">Once you're <a id="_idIndexMarker1309"/>happy with the <strong class="bold">Smoothing Angle</strong> value, click on <strong class="bold">Apply</strong> at the bottom-right corner of the <strong class="bold">Inspector</strong> window.</li>
			</ol>
			<p>Coming back to <code>enemy_flee</code> in the <strong class="bold">Hierarchy</strong> window, as this is an enemy, we also need to give it an <strong class="bold">Enemy</strong> tag so that the player recognizes it as such if and when they collide with each other:</p>
			<ol>
				<li value="1">Click on the <strong class="bold">Tag</strong> parameter at the top of the <strong class="bold">Inspector</strong> window.</li>
				<li>Select <strong class="bold">Enemy</strong>.</li>
			</ol>
			<p>The following screenshot shows the <code>enemy_flee</code>:</p>
			<div><div><img src="img/Figure_12.15_B18381.jpg" alt="Figure 12.15 – Our enemy being given an 'Enemy' tag&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.15 – Our enemy being given an 'Enemy' tag</p>
			<p>We are <a id="_idIndexMarker1310"/>now ready to apply <code>NavMeshAgent</code> to the <code>enemy_flee</code> game object. With <code>enemy_flee</code> still selected, do the following:</p>
			<ol>
				<li value="1">Click on the <strong class="bold">Add Component</strong> button in the <strong class="bold">Inspector</strong> window.</li>
				<li>A drop-down list will appear. Type in <code>nav</code> and select <code>NavMeshAgent</code> from the list.</li>
			</ol>
			<p><code>enemy_flee</code> now has <code>NavMeshAgent</code> attached to it. As previously mentioned, let's go through each of the properties. The following screenshot also shows the <code>NavMeshAgent</code> default values (these may differ from your default values, but don't be concerned, as we will be changing the majority of the values):</p>
			<div><div><img src="img/Figure_12.16_B18381.jpg" alt="Figure 12.16 – The 'Nav Mesh Agent' component (its own default values – ignore them)&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.16 – The 'Nav Mesh Agent' component (its own default values – ignore them)</p>
			<ul>
				<li><strong class="bold">Agent Type</strong>: By default, there is only one agent type. This holds a preset of the name <a id="_idIndexMarker1311"/>of the agent, the radius, height, step height, and max slope. To find out more about these values, check the previous section.</li>
				<li><strong class="bold">Base Offset</strong>: This will change the placement of the agent mesh, which wraps around the fleeing enemy in the form of a cylinder that can only be seen in the <strong class="bold">Scene</strong> window.</li>
				<li><strong class="bold">Speed</strong>: The maximum speed value, based on world units per second.</li>
				<li><strong class="bold">Angular Speed</strong>: Sets how quickly the agent can rotate in degrees per second.</li>
				<li><strong class="bold">Acceleration</strong>: Maximum acceleration based on world units per second squared.</li>
				<li><strong class="bold">Stopping Distance</strong>: Agents will stop when they are at a particular measurement.</li>
				<li><strong class="bold">Auto Braking</strong>: The agent will slow down gradually before reaching a complete stop.</li>
				<li><strong class="bold">Radius</strong>: The agent's spatial area will increase the scale of the agent cylinder.</li>
				<li><strong class="bold">Height</strong>: This will increase the height of the agent's cylinder.</li>
				<li><strong class="bold">Quality</strong>: The ranges of the accuracy of obstacle avoidance.</li>
				<li><strong class="bold">Priority</strong>: Agents <a id="_idIndexMarker1312"/>of a lower priority will be ignored by this agent when performing avoidance.</li>
				<li><strong class="bold">Auto Traverse Off Mesh Link</strong>: If you want the agent to move between gaps, keep this checked; otherwise, custom animation will move the agent across the gap.</li>
				<li><strong class="bold">Auto Repath</strong>: If the agent is no longer on the path they are walking, with this option checked, they will try and make their way back to the nearest point.</li>
				<li><strong class="bold">Area Mask</strong>: With navigation baking, we can set which area this agent belongs to.</li>
			</ul>
			<p>For <code>NavMeshAgent</code>, we will set its agents to a high speed, rotation, and acceleration value to make these enemies react fast to match their fleeing behavior.  </p>
			<ol>
				<li value="3">Change the <code>NavMeshAgent</code> values for the <code>enemy_flee</code> prefab to the ones shown in the following screenshot. However, it's recommended to change and alter the values to make the enemies behave differently. Theres no wrong approach. But as a guide, match the ones in the following screenshot:</li>
			</ol>
			<div><div><img src="img/Figure_12.17_B18381.jpg" alt=""/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.17 – 'Nav Mesh Agent' with set values</p>
			<ol>
				<li value="4">Click <strong class="bold">Overrides | Apply All</strong> at the top-right corner of the <strong class="bold">Inspector</strong> window to confirm your prefab changes.</li>
			</ol>
			<p>In this section, we created <a id="_idIndexMarker1313"/>the fleeing enemy prefab and gave it a material. We also applied a <code>NavMeshAgent</code> component to our enemy so that it's calibrated and ready to react.</p>
			<p>The following screenshot shows what the fleeing enemy looks like with its <code>NavMeshAgent</code> component wrapped around it, which can only be seen in the <strong class="bold">Scene</strong> window:</p>
			<div><div><img src="img/Figure_12.18_B18381.jpg" alt="Figure 12.18 – Our enemy with its NavMeshAgent collider wrapped around it&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.18 – Our enemy with its NavMeshAgent collider wrapped around it</p>
			<p>In the next <a id="_idIndexMarker1314"/>section, we will give the fleeing enemy prefab a collider so that when the player makes contact with it, the player and the enemy are destroyed with the soon-to-come scripting.</p>
			<h2 id="_idParaDest-203"><a id="_idTextAnchor206"/>Adding a capsule collider to our fleeing enemy</h2>
			<p>In this <a id="_idIndexMarker1315"/>section, we are going to add a capsule collider to the fleeing enemy so that a collision can be detected from the player's ship when they collide with each other:</p>
			<ol>
				<li value="1">With the <code>enemy_flee</code> prefab still selected, scroll down to the bottom of the <strong class="bold">Inspector</strong> window and click on <strong class="bold">Add Component</strong>.</li>
				<li>Start typing <code>Capsule</code> into the drop-down window until you see <strong class="bold">Capsule Collider</strong>.</li>
				<li>Select <strong class="bold">Capsule Collider</strong> from the drop-down list. The fleeing enemy will now have a capsule collider wrapped around them.</li>
				<li>Finally, tick the <strong class="bold">Is Trigger</strong> checkbox in the <strong class="bold">Capsule Collider</strong> component.</li>
				<li>Click on the <code>enemy_flee</code> prefab's settings.</li>
				<li>Select the <code>enemy_flee</code> game object in <strong class="bold">Hierarchy</strong> and delete it.</li>
			</ol>
			<p>The following screenshot <a id="_idIndexMarker1316"/>shows <code>enemy_flee</code> with its capsule collider; these values may differ to yours:</p>
			<div><div><img src="img/Figure_12.19_B18381.jpg" alt="Figure 12.19 – 'enemy_flee' with its capsule collider&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.19 – 'enemy_flee' with its capsule collider</p>
			<p>The fleeing enemy is nearly ready to be tried out in the game. We just need to add a script to tell the game object what to do when it gets within a certain distance of the player. We will cover this in the next section.</p>
			<h2 id="_idParaDest-204"><a id="_idTextAnchor207"/>Creating our fleeing enemy script</h2>
			<p>In this section, we will be making it so that the fleeing enemy detects when the player is getting <a id="_idIndexMarker1317"/>close to them. If the player is too close, we will make it so that the enemy begins to flee.</p>
			<p>We will be taking a script that is partially made and import it into this chapter, as the majority of the <code>EnemyFlee</code> script will contain a similar setup to the previous enemy that we made in <a href="B18381_02_Epub.xhtml#_idTextAnchor048"><em class="italic">Chapter 2</em></a><em class="italic">, Adding and Manipulating Objects</em>. Follow these steps:</p>
			<ol>
				<li value="1">From the <code>Assets/Script</code>.</li>
				<li>Double-click on the <code>EnemyFlee</code> script to begin adding its navigation code.</li>
			</ol>
			<p>The <code>EnemyFlee</code> script will contain similar-looking code to the <code>EnemyWave</code> script. The enemies in our game will carry the same properties, such as giving and taking damage when hit or dying, detecting a collision, and inheriting their own scriptable object asset. There's no real need to go through this process again. What we are interested in is how the <code>enemy_flee</code> game object acts.</p>
			<p>To add the fleeing behavior to the <code>EnemyFlee</code> script, we need to do the following:</p>
			<ol>
				<li value="1">At the top of the script, add the AI library to give our script access to the <strong class="bold">Navigation Agent</strong> files:<pre><strong class="bold">using UnityEngine.AI;</strong></pre></li>
			</ol>
			<p>In our script, we will need access to the <code>NavMeshAgent</code> component (which is attached to our <code>enemy_flee</code> game object). The AI library gives us this functionality.</p>
			<ol>
				<li value="2">Scroll down in the script to where our global variables are (<code>health</code>, <code>travelSpeed</code>, <code>fireRate</code>, and so on) and add the following variables that we will be using with our navigation setup:<pre>GameObject player;
bool gameStarts = false;
 
[SerializeField]
float enemyDistanceRun = 200;
NavMeshAgent enemyAgent;</pre></li>
			</ol>
			<p>The first variable will be used to store the reference to the player's ship, as we will be comparing its distance later on. The <code>bool</code> value will be used as part of a delayed start for our script. We will talk more about this later on as well.</p>
			<p><code>enemyDistanceRun</code> will be used as a rule to "act" within the measured distance between the player and our fleeing enemy. We have also added the <code>SerializeField</code> attribute to this, as it will be handy to change these values in the <strong class="bold">Inspector</strong> window while keeping this variable private. Do try a different value if you think 200 is too low. Experiment!</p>
			<p>Finally, we have <code>NavMeshAgent</code>, which will be required to receive data from the player and fleeing enemy results. </p>
			<ol>
				<li value="3">Create a <code>Start</code> function that will require a short delay to get a reference from the player <a id="_idIndexMarker1318"/>ship. Enter the following code. We will go through each step to see why there is a delay and the standard <code>ActorStats</code> method:<pre>    void Start() 
    {
        ActorStats(actorModel);
        Invoke("DelayedStart",0.5f);
    }
    void DelayedStart()
    {
        gameStarts = true;
        player = GameObject.FindGameObjectWithTag
         ("Player");
        enemyAgent = GetComponent&lt;NavMeshAgent&gt;(); 
    }</pre></li>
			</ol>
			<p>The <code>Start</code> function contains the <code>ActorStats</code> method, which will update our enemy's abilities (the health value, points added to the score, and so on), similar to our <code>enemy_wave</code> game object. We will also run an <code>Invoke</code> function, which takes the name of the method we wish to run along with a parameter that determines when the method will be run.</p>
			<p>We are <a id="_idIndexMarker1319"/>running a short <code>0.5f</code> second delay, giving the player's ship time to be instantiated into the scene before we take a reference from it. We set a Boolean value to <code>true</code> to say that the <code>update</code> function can run the content within it, which we will cover shortly. The final thing we do is take reference from the <code>NavMeshAgent</code> component attached to the game object. </p>
			<p>We need to add a slight amendment to our speed value in our <code>ActorStats</code> method. Because we are affecting <code>NavMeshAgent_speed</code>, we need to manipulate this directly.</p>
			<p>To make the enemies' speed adjustable, add the following line of code within <code>ActorStats</code> of the <code>EnemyFlee</code> script:</p>
			<pre>GetComponent&lt;NavMeshAgent&gt;().speed = actorModel.speed;</pre>
			<p>The enemy flee speed value is now hooked up.</p>
			<ol>
				<li value="4">Moving on to the last piece of our code, the <code>Update</code> function will be measuring and reacting to and from the distance of our fleeing enemy and the player. Enter the following <code>Update</code> function and its content, and we will go through each step:<pre>    void Update () 
    {
      if(gameStarts)
      {
          if (player != null)
          {
              float distance = Vector3.Distance(transform.position,player.transform.position);
                  player.transform.position);
              if (distance &lt; enemyDistanceRun)
              {
                Vector3 disToPlayer = transform.position -
                player.transform.position;
                Vector3 newPos = transform.position +     disToPlayer;
                enemyAgent.SetDestination(newPos);
               }
           }
       }
     }</pre></li>
			</ol>
			<p>In the <code>Update</code> function, we will run an <code>if</code> statement to check whether the <code>gameStarts</code> Boolean value is <code>true</code>; if it is <code>true</code>, we then check to see whether <code>player_ship</code> is still in the scene. And if that is <code>true</code>, we move on to the <a id="_idIndexMarker1320"/>content in that <code>if</code> statement. Within this <code>if</code> statement, we use <code>Vector3.Distance</code> to measure the distance between the player's ship and the fleeing enemy. We then store the measurement as a <code>float</code> value called <code>distance</code>.</p>
			<p>Next, we run a check to see whether the distance measured is less than the <code>enemyDistanceRun</code> value, which is currently set to <code>200</code>.</p>
			<p>If the <code>distance</code> variable's value is lower, then that means the player's ship is too close to the fleeing enemy, so we run the following steps for it to react.</p>
			<ul>
				<li>Store the <code>Vector3</code> variable, which minuses the player's position from our own.</li>
				<li>We then add this <code>Vector3</code> variable to the fleeing enemy's <code>newPos</code> position of <code>Vector3</code>, which will be the direction for the enemy flee to run in.</li>
				<li>Finally, we send this <code>newPos</code> position to <code>NavMeshAgent</code>.</li>
				<li>Save the <code>EnemyFlee</code> script.</li>
			</ul>
			<p>We are <a id="_idIndexMarker1321"/>now ready to attach the <code>EnemyFlee</code> script to our <code>enemy_flee</code> prefab. Let's do this now; then, we will be able to test the results:</p>
			<ol>
				<li value="1">Back in the Unity Editor navigate to the <code>Assets/Prefab/Enemies</code> folder in the <strong class="bold">Project</strong> window.</li>
				<li>Select the <code>enemy_flee</code> prefab.</li>
				<li>Click on the <code>EnemyFlee</code>.</li>
				<li>Select the <code>Enemy Flee</code> script from the drop-down list.</li>
				<li>Create a new <code>BasicFlee_Enemy</code>, and then store it in <code>Assets/ScriptableObject</code>. Drag the Actor into the Actor Model area of the <code>EnemyFlee</code> script in the <strong class="bold">Inspector</strong> window, as shown in the following screenshot.</li>
			</ol>
			<p>The following screenshot shows the scriptable object asset for the <code>EnemyFlee</code> script's <strong class="bold">Actor Model</strong> parameter on the right:</p>
			<div><div><img src="img/Figure_12.20_B18381.jpg" alt="Figure 12.20 – The 'enemy_flee' game object holding its 'EnemyFlee' script and updated fields&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.20 – The 'enemy_flee' game object holding its 'EnemyFlee' script and updated fields</p>
			<p>We now <a id="_idIndexMarker1322"/>need to make our <code>enemy_flee</code> script recognizable on the radar map in the game HUD, as with the <code>enemy_wave</code> game object. As a reminder, we made a <code>radarPoint</code> object before in <a href="B18381_09_Epub.xhtml#_idTextAnchor161"><em class="italic">Chapter 9</em></a>, <em class="italic">Creating a 2D Shop Interface and In-Game HUD</em>. So, in this chapter, we're going to speed things up and use a ready-made <code>radarPoint</code> object to attach to the <code>enemy_flee</code> game object. The only difference with the ready-made <code>radarPoint</code> game object is that I have attached a small script called <code>RadarRotation</code> that will make the <code>radarPoint</code> sprite always face the camera, regardless of which rotation the <code>enemy_flee</code> game object makes.</p>
			<p>The <code>RadarRotation</code> script takes the current rotation in the <code>Awake</code> function, followed by reapplying the rotation on <code>LateUpdate</code>.</p>
			<p class="callout-heading">What Is LateUpdate?</p>
			<p class="callout"><code>LateUpdate</code> is the last function called in Unity's execution order game logic. The benefit to this is that there is no fighting between the rotation of the <code>radarPoint</code> object and the <code>enemy_flee</code> rotation being called at the same time. If you would like to learn more about <a id="_idIndexMarker1323"/>the execution order, check out <a href="https://docs.unity3d.com/Manual/ExecutionOrder.html">https://docs.unity3d.com/Manual/ExecutionOrder.html</a>. </p>
			<p>To attach the pre-made <code>radarPoint</code> object to the <code>enemy_flee</code> prefab, we need to do the following:</p>
			<ol>
				<li value="1">Back in the <code>enemy_flee</code> prefab from <code>Assets/Prefab/Enemies</code> into the <strong class="bold">Hierarchy</strong> window.</li>
				<li>Drag and drop the <code>radarPoint</code> object from <code>Assets/Prefab/Enemies</code> onto the <code>enemy_flee</code> prefab in the <strong class="bold">Hierarchy</strong> window.</li>
				<li>Then, drag and drop the <code>RadarRotation</code> script from <code>Assets/Script</code> into the <code>enemy_flee</code> <code>radarPoint</code> object point toward the camera.</li>
				<li>Once <a id="_idIndexMarker1324"/>applied, select the <code>enemy_flee</code> prefab from the <strong class="bold">Hierarchy</strong> window, and then click on <strong class="bold">Overrides | Apply All</strong> at the top-right corner of the <strong class="bold">Inspector</strong> window.</li>
				<li>The following screenshot shows the <code>enemy_flee</code> prefab holding the <code>radarPoint</code> object, along with the <code>radarPoint</code> object in the <strong class="bold">Inspector</strong> window, as a reference to help avoid any errors:</li>
			</ol>
			<div><div><img src="img/Figure_12.21_B18381.jpg" alt="Figure 12.21 – The 'radarPoint' game object and its Transform property values&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.21 – The 'radarPoint' game object and its Transform property values</p>
			<ol>
				<li value="6">Our <code>enemy_flee</code> prefab is now ready to be trialed out in <code>enemy_flee</code> from its current location to the <code>_Enemies</code> game object in the <code>enemy_flee</code> now is in the <strong class="bold">Hierarchy</strong> window:</li>
			</ol>
			<div><div><img src="img/Figure_12.22_B18381.jpg" alt="Figure 12.22 – The 'Enemies' game object children in the Hierarchy window&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.22 – The 'Enemies' game object children in the Hierarchy window</p>
			<ol>
				<li value="7">Set the <code>enemy_flee</code> prefab to somewhere near the start of the level. I have placed <a id="_idIndexMarker1325"/>mine at the following <strong class="bold">Transform</strong> values:</li>
			</ol>
			<div><div><img src="img/Figure_12.23_B18381.jpg" alt="Figure 12.23 – The 'enemy_flee' game object placement in level 3&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.23 – The 'enemy_flee' game object placement in level 3</p>
			<p>If you also have the <code>EnemySpawner</code> object in the scene close to the start of the level, push it back along the <em class="italic">x</em> axis as far as <code>1000</code> to get it out of the way.</p>
			<ol>
				<li value="8">Click the <code>enemy_flee</code> object should now start panicking and moving around to try and escape from you!</li>
			</ol>
			<p>Feel free to select the <code>enemy_flee</code> object in the <strong class="bold">Hierarchy</strong> window and press <em class="italic">Left</em> + <em class="italic">Ctrl</em> (<em class="italic">Command</em> on macOS) + <em class="italic">D</em> on your keyboard to spread a few fleeing enemies around to make the level more interesting, as shown in the following screenshot:</p>
			<div><div><img src="img/Figure_12.24_B18381.jpg" alt="Figure 12.24 – Duplicated 'enemy_flee' game objects&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.24 – Duplicated 'enemy_flee' game objects</p>
			<p>The <a id="_idIndexMarker1326"/>following screenshot shows our new fleeing enemies trying to escape from the player in pure panic!</p>
			<div><div><img src="img/Figure_12.25_B18381.jpg" alt="Figure 12.25 – Enemies fleeing from the player!&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.25 – Enemies fleeing from the player!</p>
			<ol>
				<li value="9">Save the scene.</li>
			</ol>
			<p>That's the end of this section, and hopefully, you now feel comfortable with this introduction to using the NavMesh and agents. As you can imagine, our fleeing enemy could have other events attached to it, such as shooting bullets at the player when at a safe distance, taking cover around a corner, and calling for help. Adding a series of events to an NPC would require a finite state machine to go through each appropriate event. </p>
			<p>In this <a id="_idIndexMarker1327"/>section, we introduced a new enemy that acted differently from our current wave enemy. We also became familiar with the ready-made path-finding algorithms offered by Unity, such as <code>NavMesh</code>.</p>
			<p>We are going to move on to the next section, where we will introduce the timeline, which works as an animator but can also be used with regard to blending the logical behavior with our components – for example, to make a light blend into a different color by using scripting.</p>
			<h1 id="_idParaDest-205"><a id="_idTextAnchor208"/>Exploring the timeline</h1>
			<p><strong class="bold">Timeline</strong> is a component in the Unity Editor that is intended to put a sequence of animations <a id="_idIndexMarker1328"/>together, which is attractive to industries such as film and TV. <strong class="bold">Timeline</strong> is also welcomed in games that may have cutscenes to help tell a story or introduce a player to a level. Unity also has two other useful components – <strong class="bold">Animator Controller</strong> and <strong class="bold">Animation</strong> <strong class="bold">Clips</strong> – as you will know if you have been following this book, as we covered these other components in <a href="B18381_04_Epub.xhtml#_idTextAnchor087"><em class="italic">Chapter 4</em></a><em class="italic">, Applying Art, Animation, and Particles</em>. They carry out the same tasks, but as a scene becomes busier with a series of individual animation clips, things can get messy quickly in the animator controller, with the multiple states transitioning between each other.</p>
			<p>The following screenshot shows the animator controller with multiple states and transitions:</p>
			<div><div><img src="img/Figure_12.26_B18381.jpg" alt="Figure 12.26 – An example of how chaotic Animator Controllers can get&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.26 – An example of how chaotic Animator Controllers can get</p>
			<p><strong class="bold">Timeline</strong> supports <a id="_idIndexMarker1329"/>three tasks:</p>
			<ul>
				<li>Playing animations and clips</li>
				<li>Playing audio</li>
				<li>Turning game objects on or off</li>
			</ul>
			<p>These three <a id="_idIndexMarker1330"/>capabilities on their own limit <strong class="bold">Timeline</strong> – for example, if we want to change the color of light, <strong class="bold">Timeline</strong> wouldn't be able to change the individual property alone. To change the color of light, we will need to change the light's property values in the <strong class="bold">Animation</strong> window itself. However, with some extra scripting to our timeline, we can introduce dragging and dropping game objects that hold components, such as a light component, where changes can be made on the fly.</p>
			<p>In this section, we are going to start by animating a large robotic craft in the timeline. Then, we will discuss playables and how they can extend a timeline's functionality. Finally, we will implement additional tracks to the timeline to control the color of the lights and fade the level into darkness once the player reaches the end of the level.</p>
			<p>Let's start by creating our <code>Timeline</code> game object and adding a <strong class="bold">Timeline</strong> component to it in the next section.</p>
			<h2 id="_idParaDest-206"><a id="_idTextAnchor209"/>Creating a timeline</h2>
			<p>In this section, we are going to get more familiar with the <strong class="bold">Timeline</strong> component and create <a id="_idIndexMarker1331"/>some of our own animations with a large flying robot. When setting up the timeline, we will also discuss the components and properties that are involved.</p>
			<p>To add a timeline to our scene, do the following:</p>
			<ol>
				<li value="1">In the Unity Editor's <code>Assets/Scene</code>.</li>
				<li>Double-click on <code>level3</code> to load the scene if it isn't loaded already.</li>
				<li>Right-click in the <strong class="bold">Hierarchy</strong> window and select <strong class="bold">Create Empty</strong> from the dropdown to create an empty game object.</li>
				<li>Click on <code>GameObject</code> twice slowly to rename it.</li>
				<li>Rename <code>GameObject</code> <code>Timeline</code>.</li>
			</ol>
			<p>With our <code>Timeline</code> game object still selected in the <strong class="bold">Hierarchy</strong> window, we can now open our <strong class="bold">Timeline</strong> window.</p>
			<p>At the top of the Unity Editor, click on <strong class="bold">Window | Sequencing</strong> and then <strong class="bold">Timeline</strong>; the following screenshot shows this:</p>
			<div><div><img src="img/Figure_12.27_B18381.jpg" alt="Figure 12.27 – Selecting the 'Timeline' game object and opening a Timeline window&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.27 – Selecting the 'Timeline' game object and opening a Timeline window</p>
			<p>It's likely <a id="_idIndexMarker1332"/>that the <strong class="bold">Timeline</strong> window will appear in the same window layout as your scene, which isn't ideal, as we want to see our <strong class="bold">Scene</strong> while animating. To move the <strong class="bold">Timeline</strong> window to a better place, click on the name of the <strong class="bold">Timeline</strong> tag and drag it down to the bottom of the screen, where the <strong class="bold">Console</strong> and <strong class="bold">Project</strong> windows are. The following screenshot shows my current Unity Editor layout proportions:</p>
			<div><div><img src="img/Figure_12.28_B18381.jpg" alt="Figure 12.28 – Window placements in the Unity Editor&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.28 – Window placements in the Unity Editor</p>
			<p>We can <a id="_idIndexMarker1333"/>now continue to create our <code>Timeline</code> asset, where we will be creating our new animations for all of our game objects and their components.</p>
			<p>To make a playable <code>Timeline</code> asset, do the following:</p>
			<ol>
				<li value="1">With the <code>Timeline</code> game object still selected in the <strong class="bold">Hierarchy</strong> window, click on the <strong class="bold">Create</strong> button in the <strong class="bold">Timeline</strong> window.</li>
				<li>A window browser will appear to let us select where we want to save our playable file.</li>
				<li>Choose the <code>Assets</code> folder.</li>
				<li>Give the playable file a name (something relevant to what it's going to be used for; I'm naming mine <code>level3</code>) and click on the <strong class="bold">Save</strong> button.</li>
			</ol>
			<p>Our <code>Timeline</code> asset has been created.</p>
			<p>If you have been following along with this book, at first glance, the <strong class="bold">Timeline</strong> window will likely look like the <strong class="bold">Animation</strong> window we saw in <a href="B18381_04_Epub.xhtml#_idTextAnchor087"><em class="italic">Chapter 4</em></a><em class="italic">, Applying Art, Animation, and Particles</em>. If so, that's good! A good section of the controls and methodology will be familiar to you. One of the main differences of <strong class="bold">Timeline</strong> is that any of the game objects can be dragged into the <strong class="bold">Timeline</strong> window without needing to have any kind of hierarchical relationship between them.</p>
			<p>The following <a id="_idIndexMarker1334"/>screenshot shows our <strong class="bold">Timeline</strong> window holding the <strong class="bold">Timeline</strong> game object in its first <strong class="bold">Timeline</strong> track:</p>
			<div><div><img src="img/Figure_12.29_B18381.jpg" alt="Figure 12.29 – The Timeline window&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.29 – The Timeline window</p>
			<p>Also, in the <strong class="bold">Inspector</strong> window, our <strong class="bold">Timeline</strong> game object has gained some extra components. The following screenshot shows two of the added components – <strong class="bold">Playable Director</strong> and <strong class="bold">Animator</strong>:</p>
			<div><div><img src="img/Figure_12.30_B18381.jpg" alt="Figure 12.30 – The 'Timeline' game object holding the Playable Director and Animator components in the Inspector window&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.30 – The 'Timeline' game object holding the Playable Director and Animator components in the Inspector window</p>
			<p>We worked with the <strong class="bold">Animator</strong> component in <a href="B18381_04_Epub.xhtml#_idTextAnchor087"><em class="italic">Chapter 4</em></a><em class="italic">, Applying Art, Animation, and Particles</em>, so for more details about this particular component, refer back to that chapter. Also, we don't actually do anything with the <strong class="bold">Animator</strong> component; it's just a required component for our <strong class="bold">Timeline</strong> setup.</p>
			<p>The other <a id="_idIndexMarker1335"/>component we gain when creating a <code>Timeline</code> asset file is <strong class="bold">Playable Director</strong>. It's the responsibility of this component to keep a relationship between the timeline and the game objects/components that are being manipulated. So, let's go through each of the properties under the <strong class="bold">Playable Director</strong> component to briefly get a general understanding of them.</p>
			<p>First, we have <strong class="bold">Playable</strong>. When we click on the <strong class="bold">Create</strong> button in the <strong class="bold">Timeline</strong> window, we create a <strong class="bold">Playable</strong> file. This file holds all of the animations and game object/component instances relating to the timeline.</p>
			<p>Then, we have <strong class="bold">Update Method</strong>. This parameter offers four properties that control how time affects the timeline. These properties are as follows:</p>
			<ul>
				<li><strong class="bold">Digital Signal Processing</strong> (<strong class="bold">DSP</strong>) helps to improve accuracy between our timeline <a id="_idIndexMarker1336"/>and its audio to prevent it from going out of sync.</li>
				<li><strong class="bold">Game Time</strong>: The time <a id="_idIndexMarker1337"/>for the timeline will be sourced from the game's time. This also means the time can be scaled (that is, slowed down or paused).</li>
				<li><strong class="bold">Unscaled Game Time</strong>: This <a id="_idIndexMarker1338"/>option works the same as the <strong class="bold">Game Time</strong> property, but it is not affected by scaling.</li>
				<li><strong class="bold">Manual</strong>: This <a id="_idIndexMarker1339"/>property uses the clock time we give it through scripting.</li>
			</ul>
			<p>Next, we have <strong class="bold">Play On Awake</strong>. If this checkbox is ticked, our timeline will play as soon as the scene is active.</p>
			<p>The next <a id="_idIndexMarker1340"/>parameter is <strong class="bold">Wrap Mode</strong>. This property determines what happens when the timeline has finished playing:</p>
			<ul>
				<li><strong class="bold">Hold</strong>: When the timeline reaches the end, it holds on to the last frame.</li>
				<li><strong class="bold">Loop</strong>: The timeline repeats.</li>
				<li><strong class="bold">None</strong>: The timeline plays and then resets.</li>
			</ul>
			<p><strong class="bold">Initial Time</strong> adds a delay in seconds before the timeline begins.</p>
			<p>Finally, we have <strong class="bold">Bindings</strong>. When a game object or component is dragged into the <strong class="bold">Timeline</strong> window, the <strong class="bold">Bindings</strong> list will update and show what object is connected to the timeline.</p>
			<p>So far, we have discussed the timeline and introduced it to our scene. We have also gone through the components that are required to make the timeline work.</p>
			<p>Now that we are more familiar with the timeline and the components that work in conjunction with it, in the next subsections, we are going to incorporate our large boss ship into our <code>level3</code> scene and animate it through the timeline.</p>
			<h2 id="_idParaDest-207"><a id="_idTextAnchor210"/>Setting up the boss game object in our scene</h2>
			<p>In this section, we are going to take a static UFO-looking game object from our imported  project files, drop it into the scene, and attach it to the timeline. From there, we will animate our UFO so that it spins and moves across the scene on two occasions.</p>
			<p>To bring the <a id="_idIndexMarker1341"/>large boss <code>UFO</code> game object into our scene before animating it, we need to do the following:</p>
			<ol>
				<li value="1">Drag and drop the <code>boss.prefab</code> object from <code>Assets/Prefab/Enemies</code> into the <code>_Enemies</code> game object in the <strong class="bold">Hierarchy</strong> window.</li>
			</ol>
			<p>Next, we need to position the boss so that it's in our scene but out of view of the camera. That way, when it comes to animating the boss in the timeline, we can change its position and rotation when required.</p>
			<ol>
				<li value="2">Select the <code>boss</code> game object in the <code>0</code>, <code>0</code>, and <code>-2000</code></li><li><code>0</code>, <code>0</code>, and <code>0</code></li><li><code>1</code>, <code>1</code>, and <code>1</code></li></ul></li>
				<li>With the <code>boss</code> object still selected in the <strong class="bold">Hierarchy</strong> window, press <em class="italic">F</em> on your keyboard to see what it looks like in the <strong class="bold">Scene</strong> window.</li>
			</ol>
			<p>The following screenshot shows the imported <code>boss</code> prefab, which contains a list of components and property values:</p>
			<div><div><img src="img/Figure_12.31_B18381.jpg" alt="Figure 12.31 – The 'boss' game object tagged as 'Enemy', positioned with the Transform component, and finally, set as a trigger with a scaled radius in Sphere Collider&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.31 – The 'boss' game object tagged as 'Enemy', positioned with the Transform component, and finally, set as a trigger with a scaled radius in Sphere Collider</p>
			<p>The <code>boss</code> object holds <a id="_idIndexMarker1342"/>the following component and property values, as shown in the previous screenshot:</p>
			<ul>
				<li>Tagged as <strong class="bold">Enemy</strong> (denoted by <strong class="bold">1.</strong>).</li>
				<li>The <strong class="bold">Transform</strong> property values are set to the ones detailed under <em class="italic">step 2</em> (denoted by <strong class="bold">2.</strong>).</li>
				<li><code>80</code> (denoted by <strong class="bold">3.</strong>).</li>
				<li><code>BossScript</code> makes the <code>boss</code> game object invincible to the player, and if the player makes contact with the boss, the player will die (denoted by <strong class="bold">4.</strong>).</li>
				<li>Because the <code>boss</code> object is an enemy, it has a <code>radarPoint</code> object that is picked up on the radar (denoted by <strong class="bold">5.</strong>).</li>
			</ul>
			<p>Before we move on to the next section, we need to add a <code>RadarRotation</code> script to the <code>radarPoint</code> game object, which is a child of the <code>boss</code> game object. This script will make <code>radarPoint</code> always face the camera:</p>
			<ol>
				<li value="1">Expand the <code>boss</code> content in the <strong class="bold">Hierarchy</strong> window.</li>
				<li>Select <code>radarPoint</code>, and then drag and drop the <code>RadarRotation</code> script from <code>Assets/Script</code>, moving it from the <strong class="bold">Project</strong> window to the <strong class="bold">Inspector</strong> window.</li>
				<li>Finally, select the <code>boss</code> game object in the <code>BossScript</code> from <code>Assets/Script</code> into the <strong class="bold">Inspector</strong> window.</li>
			</ol>
			<p>Now that the <code>boss</code> object is in the scene, we can add it to the timeline in the next section.</p>
			<h2 id="_idParaDest-208"><a id="_idTextAnchor211"/>Preparing the boss for the timeline</h2>
			<p>In this section, we <a id="_idIndexMarker1343"/>are going to take the <code>boss</code> game object from our <code>boss</code> object greet the player at the end of the level before jetting off after the player.</p>
			<p>Further sections will continue to make use of the timeline, including using specialized <code>boss</code> object animated.</p>
			<p>To animate the <code>boss</code> object in the timeline, do the following:</p>
			<ol>
				<li value="1">Select the <code>Timeline</code> game object, and in the <strong class="bold">Inspector</strong> window, untick <strong class="bold">Play On Awake</strong>, as we will be triggering the <strong class="bold">Timeline</strong> animation ourselves.</li>
			</ol>
			<p>To trigger the <code>BossTrigger</code> game object, which we mentioned at the beginning of this chapter.</p>
			<p>To have the main camera recognized as a trigger, we need to do the following:</p>
			<ol>
				<li>Select the main camera in the <strong class="bold">Hierarchy</strong> window.</li>
				<li>Click on the <strong class="bold">Add Component</strong> button in the <strong class="bold">Inspector</strong> window.</li>
				<li>Type in <code>Box Collider</code>, and when you see it in the drop-down list, select it.</li>
				<li>Tick the <strong class="bold">Is Trigger</strong> box under the <strong class="bold">Box Collider</strong> component.</li>
			</ol>
			<p>Let's now continue setting up our <code>boss</code> game object into it:</p>
			<ol>
				<li value="2">Select the <strong class="bold">Timeline</strong> tab, which, as you will know if you have been following along with the previous sections, is found at the bottom of the Unity Editor</li>
			</ol>
			<p>The <code>Timeline</code> game object and the <code>Timeline</code> game object from the <strong class="bold">Timeline</strong> window because we aren't going to animate it.</p>
			<ol>
				<li value="3">Right-click <a id="_idIndexMarker1345"/>on the <code>Timeline</code> object <a id="_idIndexMarker1346"/>in the <strong class="bold">Timeline</strong> window and select <strong class="bold">Delete</strong> from the dropdown.</li>
			</ol>
			<p>The following screenshot shows the <code>Timeline</code> game object being deleted:</p>
			<p class="figure-caption"><img src="img/Figure_12.32_B18381.png" alt="Figure 12.32 – Deleting the 'Timeline' game object from the Timeline window&#13;&#10;"/></p>
			<p class="figure-caption">Figure 12.32 – Deleting the 'Timeline' game object from the Timeline window</p>
			<ol>
				<li value="4">With the <code>Timeline</code> game object still selected in the <code>boss</code> game object from the <strong class="bold">Hierarchy</strong> window down into the <strong class="bold">Timeline</strong> window.</li>
			</ol>
			<p>A dropdown will appear with a choice of three selections:</p>
			<ul>
				<li><strong class="bold">Activation Track</strong>: Turns a game object on or off</li>
				<li><strong class="bold">Animation Track</strong>: Animates the game object</li>
				<li><strong class="bold">Audio Track</strong>: Sets particular audio on or off</li>
			</ul>
			<ol>
				<li value="5">Because we want to animate our <code>boss</code> game object, we will choose <strong class="bold">Animation Track</strong>.</li>
			</ol>
			<p>We will now have the <code>boss</code> game object in our <code>boss</code> game object will gain an <strong class="bold">Animator</strong> component in the <strong class="bold">Inspector</strong> window.</p>
			<p>The following screenshot shows what our timeline currently looks like:</p>
			<div><div><img src="img/Figure_12.33_B18381.jpg" alt="Figure 12.33 – Timeline holding the 'boss' game object&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.33 – Timeline holding the 'boss' game object</p>
			<p>Next, we will <a id="_idIndexMarker1347"/>start adding keyframes to our <strong class="bold">Timeline</strong> window, which <a id="_idIndexMarker1348"/>will affect our boss's position and rotation. Let's start by locking our <strong class="bold">Timeline</strong> window so that when we click on another game object, it will remain active:</p>
			<ol>
				<li value="1">Select the <code>Timeline</code> game object in the <strong class="bold">Hierarchy</strong> window.</li>
				<li>Select the <strong class="bold">Timeline</strong> window tab.</li>
				<li>Click on the padlock button at the top-right corner of the <strong class="bold">Timeline</strong> window.</li>
			</ol>
			<p>The padlock button is highlighted in the following screenshot:</p>
			<div><div><img src="img/Figure_12.34_B18381.jpg" alt="Figure 12.34 – Locking the Timeline window&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.34 – Locking the Timeline window</p>
			<p>Let's now move on to the next section, where we will start adding keyframes to the timeline and make our <code>boss</code> game object move and rotate in two phases of the third level. Let's start with phase one.</p>
			<h2 id="_idParaDest-209"><a id="_idTextAnchor212"/>Animating the boss in the timeline – phase one</h2>
			<p>In this section, we <a id="_idIndexMarker1349"/>will be adding keyframes to <a id="_idIndexMarker1350"/>the <code>boss</code> game object. This will make the <code>boss</code> game object travel from one point to another while rotating on its center pivot.</p>
			<p>To start adding keyframes for the <code>boss</code> game object, do the following:</p>
			<ol>
				<li value="1">With the <code>boss</code> game object.</li>
			</ol>
			<p>We will now start recording our boss's position and rotation.</p>
			<ol>
				<li value="2">In the <code>boss</code> game object name; the button should begin to flash.</li>
				<li>Make sure that the <code>0</code>, as shown in the following screenshot:</li>
			</ol>
			<div><div><img src="img/Figure_12.35_B18381.jpg" alt="Figure 12.35 – The Timeline frame set to zero&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.35 – The Timeline frame set to zero</p>
			<ol>
				<li value="4">In the <code>1675</code>, <code>0</code>, and <code>600</code></li><li><code>60</code>, <code>-90</code>, and <code>0</code></li></ul></li>
			</ol>
			<div><div><img src="img/Figure_12.36_B18381.jpg" alt="Figure 12.36 – The 'boss' game object's current location in our level 3 scene&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.36 – The 'boss' game object's current location in our level 3 scene</p>
			<p>Now, to animate <a id="_idIndexMarker1351"/>the <code>boss</code> object from one end <a id="_idIndexMarker1352"/>of the corridor to the other, we need to add another keyframe for the boss. Follow these steps:</p>
			<ol>
				<li value="1">With the record button still flashing in the <code>112</code> or change the value of the <code>112</code>.</li>
				<li>Select the <code>boss</code> game object in the <code>3160</code>, <code>0</code>, and <code>600</code></li><li><code>60</code>, <code>-90</code>, and <code>20</code><p class="callout-heading">Further Information</p><p class="callout">The <strong class="bold">Timeline</strong> and <strong class="bold">Animation</strong> windows have the same navigation rules with regard to zooming and panning in either window. Holding down the middle mouse button and moving the mouse will pan. Rolling the middle mouse wheel up or down zooms in and out. Hovering the mouse cursor over the animation bar and pressing <em class="italic">F</em> on the keyboard shows all the keyframes on the window.</p></li></ul></li>
				<li>Click on the record button next to the <code>boss</code> game object in the <strong class="bold">Timeline</strong> window to stop recording.</li>
				<li>Click and scrub (<code>boss</code> game object move from left to right while rotating.</li>
			</ol>
			<p>The following <a id="_idIndexMarker1353"/>screenshot shows a bird's-eye view <a id="_idIndexMarker1354"/>of the <code>boss</code> game object moving from left to right:</p>
			<div><div><img src="img/Figure_12.37_B18381.jpg" alt="Figure 12.37 – The 'boss' game object will move from left to right&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.37 – The 'boss' game object will move from left to right</p>
			<p>Later on, when we play the third level, we will see a moment where the <code>boss</code> game object rushes past the player in the distance. For now, we will continue by adding more keyframes to our <strong class="bold">Timeline</strong> window before moving on to looking at playables.</p>
			<p>Let's move on to phase two of animating our <code>boss</code> game object.</p>
			<h2 id="_idParaDest-210"><a id="_idTextAnchor213"/>Animating the boss in the timeline – phase two</h2>
			<p>In this section, we are going to animate our boss for a second time before the level ends  as some form of resolution for the ending of this third and final level.</p>
			<p>We are going to continue from the same <strong class="bold">Timeline</strong> track that we started in the previous section.</p>
			<p>So, let's <a id="_idIndexMarker1355"/>continue animating our boss from <a id="_idIndexMarker1356"/>where we left off:</p>
			<ol>
				<li value="1">Keep the <strong class="bold">Timeline</strong> window padlocked to stop the window from losing its display.</li>
				<li>Select the <code>boss</code> object from the <strong class="bold">Hierarchy</strong> window.</li>
				<li>Press the record button next to the <code>boss</code> object's name in the <strong class="bold">Timeline</strong> window so that the button flashes.</li>
				<li>Enter <code>1012</code> into the <strong class="bold">Frame</strong> parameter.</li>
			</ol>
			<p>With the <code>boss</code> object still selected in the <code>boss</code> object's position and rotation values to the following:</p>
			<ul>
				<li><code>4545</code>, <code>0</code>, and <code>600</code></li>
				<li><code>60</code>, <code>-90</code>, and <code>0</code></li>
			</ul>
			<p>The following screenshot shows where our boss sits in phase two:</p>
			<div><div><img src="img/Figure_12.38_B18381.jpg" alt="Figure 12.38 – The 'boss' game object positions&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.38 – The 'boss' game object positions</p>
			<ol>
				<li value="5">With the record button still flashing, move to frame <code>1180</code> in the <code>boss</code> game object to the following <code>6390</code>, <code>0</code>, and <code>600</code></li><li><code>60</code>, <code>-90</code>, and <code>20</code></li></ul></li>
				<li>Now, move to frame <code>1193</code> in the <code>boss</code> game object to the following <code>6390</code>, <code>0</code>, and <code>207</code></li><li><code>60</code>, <code>450</code>, and <code>0</code></li></ul></li>
				<li>Now, move <a id="_idIndexMarker1357"/>to frame <code>1215</code> in the <code>boss</code> game object to the following <code>5520</code>, <code>0</code>, and <code>50</code></li><li><code>60</code>, <code>90</code>, and <code>-40</code></li></ul></li>
				<li>Now, move to frame <code>1380</code> in the <code>boss</code> game object to the following <code>5510</code>, <code>0</code>, and <code>50</code></li><li><code>60</code>, <code>90</code>, and <code>0</code></li></ul></li>
				<li>Now, move to frame <code>1400</code> in the <code>boss</code> game object to the following <code>5510</code>, <code>0</code>, and <code>50</code></li><li><code>60</code>, <code>-70</code>, and <code>-40</code></li></ul></li>
				<li>Now, move to frame <code>1420</code> in the <code>boss</code> game object to the following <code>7540</code>, <code>0</code>, and <code>50</code></li><li><code>60</code>, <code>-70</code>, and <code>0</code></li></ul></li>
				<li>Press the <code>boss</code> game object in the <strong class="bold">Timeline</strong> window to stop recording.</li>
			</ol>
			<p>The following <a id="_idIndexMarker1359"/>screenshot shows a bird's-eye view <a id="_idIndexMarker1360"/>of each of these positions with their <strong class="bold">Timeline</strong> frame numbers:</p>
			<div><div><img src="img/Figure_12.39_B18381.jpg" alt="Figure 12.39 – The Timeline frame numbers of where the 'boss' game object will be&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.39 – The Timeline frame numbers of where the 'boss' game object will be</p>
			<p>If you want to adjust the <code>boss</code> game object rotation more, it is recommended to have <strong class="bold">boss</strong> selected in the <strong class="bold">Hierarchy</strong> window. Make sure the local position is selected (denoted by <strong class="bold">1</strong> in the following screenshot) and, with the Timeline still in record mode, rotate the <em class="italic">z</em> axes several times (denoted by <strong class="bold">2</strong>).</p>
			<div><div><img src="img/Figure_12.40_B18381.jpg" alt="Figure 12.40 – Rotating the 'boss' game object&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.40 – Rotating the 'boss' game object</p>
			<p>Finally, scrub backward and forward (move the <strong class="bold">Timeline</strong> indicator) in <strong class="bold">Timeline</strong> to see the result you are given.</p>
			<p>When you are happy, stop recording.</p>
			<p>As you <a id="_idIndexMarker1361"/>can see in the previous screenshot, the <code>boss</code> game object flies in from the left to the right toward where the player <a id="_idIndexMarker1362"/>will be. The boss will stop rotating, pause, turn around, and zip off to the far right.</p>
			<p>Let's press <code>level3</code> scene so far, with the boss versus our player's ship throughout the <code>level3</code> scene.</p>
			<p>The player moves through the level, and the boss animation is seen on two occasions. What we do see that we likely shouldn't is the large yellow dot of the boss even when the boss has moved on. It would be good if we could make the boss disappear off the radar when we can't see the game object itself.</p>
			<p>The following screenshot shows the <code>boss</code> object on the left screen, which is not visible on the right screen but still detected on the radar:</p>
			<div><div><img src="img/Figure_12.41_B18381.jpg" alt="Figure 12.41 – The 'boss' game object's radar is still detecting the boss&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.41 – The 'boss' game object's radar is still detecting the boss</p>
			<p>Let's make <a id="_idIndexMarker1363"/>use of the timeline before ending <a id="_idIndexMarker1364"/>this section to simply turn the <code>radarPoint</code> game object off and then on when we see the <code>boss</code> game object. Follow these steps:</p>
			<ol>
				<li value="1">Select the <code>Timeline</code> game object from the <strong class="bold">Hierarchy</strong> window.</li>
				<li>Select the <code>Timeline</code> tab to see the <code>boss</code> animation.</li>
				<li>Click and drag the boss's <code>radarPoint</code> object from the <strong class="bold">Hierarchy</strong> window into the <strong class="bold">Timeline</strong> window.</li>
				<li>The <strong class="bold">Timeline</strong> dropdown appears. This time, select <strong class="bold">Activation Track</strong>.</li>
				<li>Our <code>radarPoint</code> track.</li>
			</ol>
			<p>Let's now add an activation clip to decide when the player should and shouldn't see the <code>radarPoint</code> object. Follow these steps:</p>
			<ol>
				<li value="1">Right-click on the track of the <code>radarPoint</code> object and select <strong class="bold">Add Activation Clip</strong>, as shown in the following screenshot:</li>
			</ol>
			<p class="figure-caption"> </p>
			<div><div><img src="img/Figure_12.42_B18381.jpg" alt="Figure 12.42 – In the Timeline window, add an activation clip for our 'radarPoint' game object&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.42 – In the Timeline window, add an activation clip for our 'radarPoint' game object</p>
			<ol>
				<li value="2">An <code>boss</code> game object to be active on two occasions – once when the boss moves past the player in the open-space area of the environment, and once at the end when the boss approaches the player head-on.</li>
				<li>For the <a id="_idIndexMarker1365"/>first occasion, we need to set <a id="_idIndexMarker1366"/>the <code>35</code> and <code>95</code> on the timeline. We can do this by clicking and dragging its bar down to the <code>95</code> mark, as shown in the following screenshot:</li>
			</ol>
			<div><div><img src="img/Figure_12.43_B18381.jpg" alt="Figure 12.43 – Setting the activity of the 'radarPoint' game object between set frames&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.43 – Setting the activity of the 'radarPoint' game object between set frames</p>
			<p>For the second occasion, we can set the <code>boss</code> object from around <code>1020</code> to <code>1420</code>.</p>
			<p>Repeat this process by doing the following:</p>
			<ol>
				<li value="1">Right-click and create an activation clip on the <code>radarPoint</code> track.</li>
				<li>Scale the <strong class="bold">Active</strong> bar between the two <strong class="bold">Timeline</strong> points.</li>
				<li>Save the scene.</li>
			</ol>
			<p>We have <a id="_idIndexMarker1367"/>now set the settings so that the <code>boss</code> game object and its <code>radarPoint</code> object are active at the same time.</p>
			<p>We have <a id="_idIndexMarker1368"/>successfully introduced a timeline to our scene and customized it so that it accommodates a new game object that needs to be animated throughout the third and final level of our game. In the next section, we are going to look further into extending the features of the timeline by introducing animating lights.</p>
			<h1 id="_idParaDest-211"><a id="_idTextAnchor214"/>Extending the timeline</h1>
			<p>In this section, we <a id="_idIndexMarker1369"/>are going to add more functionality to the timeline by increasing its standard track selection, as shown in the following screenshot:</p>
			<div><div><img src="img/Figure_12.44_B18381.jpg" alt="Figure 12.44 – Expanding the functionality of our Timeline will be done next&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.44 – Expanding the functionality of our Timeline will be done next</p>
			<p>From this new extended track selection list, as shown in the previous screenshot, we will make use of <strong class="bold">Light Control Track</strong>.  </p>
			<p>It is possible to see a bigger selection from the drop-down list; this, however, is beyond the scope of this book. However, if you are interested, I will direct you to what to read to find out <a id="_idIndexMarker1370"/>how to extend the list later on in this section.</p>
			<p>In the next few sections, we will increase our tracklist with the aid of the Asset Store and download a free asset from Unity to increase our <strong class="bold">Timeline</strong> functionality. Then, we will animate the lights in our scene, which wouldn't have been possible before.</p>
			<h2 id="_idParaDest-212"><a id="_idTextAnchor215"/>Adding Default Playables to the project</h2>
			<p>In this section, we will take a shortcut in scripting to extend the timeline's functionality by going <a id="_idIndexMarker1371"/>to the Unity Asset Store and downloading a free <a id="_idIndexMarker1372"/>package called <strong class="bold">Default Playables</strong>. We will discuss the main features of playables and what they entail, but it is too lengthy to discuss it as a scripting approach.</p>
			<p>Playables organize, mix, and blend data through a playable graph to create a single output. To download and import <strong class="bold">Default Playables</strong> to our list, do the following:</p>
			<ol>
				<li value="1">Open your web browser and go to the Unity Asset Store: <a href="https://assetstore.unity.com/">https://assetstore.unity.com/</a>.</li>
				<li>At the top of the <code>default playables</code> and press <em class="italic">Enter</em> on your keyboard.</li>
				<li>Select the only selection from the thumbnail list – <strong class="bold">Default Playables</strong>.</li>
				<li>On the <strong class="bold">Default Playables</strong> shop screen, click on the <strong class="bold">Download</strong> button.</li>
				<li>Once downloaded, we can now import the asset into our project by clicking on the <strong class="bold">Add to My Assets</strong> button, as shown in the following screenshot:</li>
			</ol>
			<div><div><img src="img/Figure_12.45_B18381.jpg" alt="Figure 12.45 – Downloading and importing the free Default Playables package into our project from the Asset Store&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.45 – Downloading and importing the free Default Playables package into our project from the Asset Store</p>
			<p><strong class="bold">Default Playables</strong> can now <a id="_idIndexMarker1373"/>be downloaded from your Unity project via <strong class="bold">Package Manager</strong>.</p>
			<p><strong class="bold">Package Manager</strong> gives us access to assets we've downloaded from the <strong class="bold">Asset Store</strong> and also other "packages" we can add to our project. We will talk about <strong class="bold">Package Manager</strong> more in the next chapter.</p>
			<p>To download <strong class="bold">Default Playables</strong> into our project, we need to do the following:</p>
			<ol>
				<li value="1">In the Unity Editor, click <strong class="bold">Window</strong>, followed by <strong class="bold">Package Manager</strong>.</li>
				<li><strong class="bold">Package Manager</strong> will load in a new window. At the top-left corner of the window, select <strong class="bold">Packages:</strong>, followed by <strong class="bold">My Assets</strong> from the dropdown, as shown in the following screenshot:</li>
			</ol>
			<div><div><img src="img/Figure_12.46_B18381.jpg" alt="Figure 12.46 – Selecting &quot;My Assets&quot; from the dropdown in the Package Manager window&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.46 – Selecting "My Assets" from the dropdown in the Package Manager window</p>
			<p>We will now be presented with the assets we own from the Asset Store.</p>
			<ol>
				<li value="3">At the <a id="_idIndexMarker1374"/>top-right corner of <code>default playable</code> to shorten the list on the left side, as shown in the following screenshot:</li>
			</ol>
			<div><div><img src="img/Figure_12.47_B18381.jpg" alt="Figure 12.47 – The Package Manager search bar highlighted at the top-right corner&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.47 – The Package Manager search bar highlighted at the top-right corner</p>
			<ol>
				<li value="4">Select <strong class="bold">Default Playables</strong> at the left side of the window, followed by clicking <strong class="bold">Download</strong>, and then the <strong class="bold">Import</strong> button (at the bottom-right corner of the window).</li>
			</ol>
			<p>We will then be presented with a list of folders and files that will be imported into the project.</p>
			<ol>
				<li value="5">Click <a id="_idIndexMarker1375"/>the <strong class="bold">Import</strong> button, as shown in the following screenshot:</li>
			</ol>
			<div><div><img src="img/Figure_12.48_B18381.jpg" alt="Figure 12.48 – The Default Playables files to be imported into the project&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.48 – The Default Playables files to be imported into the project</p>
			<p>We now have extra functionality added to our timeline, with an added folder in our <code>Assets</code> folder called <code>DefaultPlayables</code>. Also, as mentioned, to add even more functionality (such as timeline tracks) to the timeline, check out the file inside the <code>DefaultPlayables</code> folder named <code>DefaultPlayablesDocumentation</code>.</p>
			<p>Let's now move on to the next section, where we will make use of manipulating the lights in the scene.</p>
			<h2 id="_idParaDest-213"><a id="_idTextAnchor216"/>Manipulating light components in the timeline</h2>
			<p>In this <a id="_idIndexMarker1376"/>section, we will continue working <a id="_idIndexMarker1377"/>on the same timeline and expand it to hold more tracks. In the last section, we introduced a free-to-download asset from the Asset Store called <strong class="bold">Default Playables</strong> to save us from writing code from scratch and to offer new playables. This asset gave us the ability to add new tracks to our timeline. To continue adding new tracks, we will manipulate the lights in our third-level scene.</p>
			<p>To add a light component to the timeline, we need to do the following:</p>
			<ol>
				<li value="1">Make sure the <strong class="bold">Timeline</strong> window is still locked, which we set in the <em class="italic">Preparing the boss for the timeline</em> section.</li>
				<li>Right-click at the bottom-left open-space corner of the <strong class="bold">Timeline</strong> window and select <strong class="bold">Light Control Track</strong>, as shown in the following screenshot:</li>
			</ol>
			<div><div><img src="img/Figure_12.49_B18381.jpg" alt="Figure 12.49 – Adding 'Light Control Track' to the Timeline&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.49 – Adding 'Light Control Track' to the Timeline</p>
			<p>We now have an empty light component track added to our timeline.</p>
			<ol>
				<li value="3">Next, we can add an <strong class="bold">Animation</strong> clip by right-clicking on the timeline's track line and selecting <strong class="bold">Add Light Control Clip</strong>, as shown in the following screenshot:</li>
			</ol>
			<div><div><img src="img/Figure_12.50_B18381.jpg" alt="Figure 12.50 – Adding control to our lights with the control clip&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.50 – Adding control to our lights with the control clip</p>
			<ol>
				<li value="4">We now <a id="_idIndexMarker1378"/>have a <code>LightControlClip</code> object in our timeline. Click on this clip and look at the <strong class="bold">Inspector</strong> window. There are a few options here, but we are going to focus mainly on <strong class="bold">Color</strong>, <strong class="bold">Intensity</strong>, and <strong class="bold">Range</strong>.</li>
			</ol>
			<p>These <a id="_idIndexMarker1379"/>properties will directly change the values of the light that sits in the <strong class="bold">None (Light)</strong> parameter.</p>
			<ol>
				<li value="5">Set your <strong class="bold">Light Control Clip</strong> values to the ones shown in the following screenshot in your <strong class="bold">Inspector</strong> window:</li>
			</ol>
			<div><div><img src="img/Figure_12.51_B18381.jpg" alt="Figure 12.51 – Copying the values from your 'Light Control Clip' to the ones in this screenshot&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.51 – Copying the values from your 'Light Control Clip' to the ones in this screenshot</p>
			<ol>
				<li value="6">Next, we will set the duration of this clip to <code>100</code>. We can do this by either changing the value of the <code>LightControlClip</code> to the <code>100</code> mark, as shown in the following screenshot:</li>
			</ol>
			<div><div><img src="img/Figure_12.52_B18381.jpg" alt="Figure 12.52 – Setting the duration of the light control clip to 100&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.52 – Setting the duration of the light control clip to 100</p>
			<p>Because this light is going to flash white and then red, ideally, it would make sense to have a loop between the two transitions. However, for the sake of blending and filling up the timeline, we are going to do it this way.</p>
			<ol>
				<li value="7">Select <code>LightControlClip</code> and press <em class="italic">Ctrl</em> (<em class="italic">command</em> on the macOS) + <em class="italic">D</em> 25 times to spam the track line with light control clips.</li>
				<li>Select <a id="_idIndexMarker1380"/>the second <code>LightControlClip</code> object from the left and change its <strong class="bold">Color</strong> property from white to red.</li>
				<li>Repeat <a id="_idIndexMarker1381"/>this process for clips <code>4</code>, <code>6</code>, <code>8</code>, <code>10</code>, <code>12</code>, <code>14</code>, <code>16</code>, <code>18</code>, <code>20</code>, <code>22</code>, <code>24</code>, and <code>26</code>.</li>
				<li>Now, zoom into the second <code>LightControlClip</code> object and move it 50% of the way across to its previous clip to create a blend between the color of the light, as in the following screenshot:</li>
			</ol>
			<div><div><img src="img/Figure_12.53_B18381.jpg" alt="Figure 12.53 – 1st light clip splicing into the 2nd light clip&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.53 – 1st light clip splicing into the 2nd light clip</p>
			<ol>
				<li value="11">Continue moving each clip 50% of the way across to the previous clip's location to make the lights flash white to red until the level finishes. The following screenshot shows the position of the third clip:</li>
			</ol>
			<div><div><img src="img/Figure_12.54_B18381.jpg" alt="Figure 12.54 – The 2nd light clip splicing into the 3rd &#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.54 – The 2nd light clip splicing into the 3rd </p>
			<p>Once we've merged the clips, we can now duplicate our light track asset so that more than one light can flash.</p>
			<ol>
				<li value="12">Click on <a id="_idIndexMarker1382"/>the track asset and press <em class="italic">Ctrl</em> (<em class="italic">Command</em> on macOS) + <em class="italic">D</em> four times. The following screenshot uses the <strong class="bold">*</strong> symbol <a id="_idIndexMarker1383"/>to highlight where to click, along with the duplicates made:</li>
			</ol>
			<div><div><img src="img/Figure_12.55_B18381.jpg" alt="Figure 12.55 – Duplicating the track asset&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.55 – Duplicating the track asset</p>
			<p>As these are all the same types of tracks, we can put them into a track group to keep our timeline tidy.</p>
			<ol>
				<li value="13">Right-click in the open-space area at the bottom left of the timeline and select <strong class="bold">Track Group</strong> from the dropdown.</li>
				<li>Our track group is made. Now, click and hold the top light track asset while holding down <em class="italic">Shift</em>, and click on the bottom light track asset to select all of the light track assets. Still holding down the left mouse button, drag these track assets into the track group.</li>
				<li>Click on <a id="_idIndexMarker1384"/>the <code>Lights</code>.</li>
			</ol>
			<p>You can <a id="_idIndexMarker1385"/>use the <strong class="bold">+</strong> button to expand and collapse the group.</p>
			<p>The following screenshot shows the final result of the timeline lights:</p>
			<div><div><img src="img/Figure_12.56_B18381.jpg" alt="Figure 12.56 – The track group called 'Lights' holding all our light track assets&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.56 – The track group called 'Lights' holding all our light track assets</p>
			<ol>
				<li value="16">Now that you know how to make a track group, follow the same process for the <code>boss</code> object and its <code>radarPoint</code> object, and call the track group <code>Boss</code>.</li>
			</ol>
			<p>The final step is to drag and drop the five lights that will flash red and white into the <strong class="bold">Game</strong> window.</p>
			<ol>
				<li value="17">Either click on the small, round remote button next to <code>light00</code>, <code>light01</code>, <code>light02</code>, <code>light03</code>, and <code>light04</code> into each parameter.</li>
				<li>Scrub or drag the <strong class="bold">Timeline</strong> indicator backward and forward on the timeline to see the selected lights flashing red.</li>
				<li>Save the scene.</li>
			</ol>
			<p>The following screenshot shows our player on the third level with a new set of AI enemies, a large boss flying in the background, and flashing lights:</p>
			<div><div><img src="img/Figure_12.57_B18381.jpg" alt="Figure 12.57 – The midway of level 3&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.57 – The midway of level 3</p>
			<p>Now would <a id="_idIndexMarker1386"/>be a good time to apply the pause screen, if you <a id="_idIndexMarker1387"/>haven't already done so, to all three scenes. Follow these instructions if you don't feel comfortable doing this on your own:</p>
			<ol>
				<li value="1">With the <code>level3</code> scene saved, load up <code>level1</code> from the <code>Assets/Scene</code> folder from the <strong class="bold">Project</strong> window.</li>
				<li>In the <code>Canvas</code> and <code>EventSystem</code> game objects, and then press <em class="italic">C</em> to copy them.</li>
				<li>Load the <code>level3</code> scene back up.</li>
				<li>Select the <code>Canvas</code> game object from the <strong class="bold">Hierarchy</strong> window and press <em class="italic">Delete</em> on your keyboard.</li>
				<li>Press <em class="italic">Ctrl</em> (<em class="italic">Command</em> on macOS) + <em class="italic">V</em> to paste <code>EventSystem</code> and <code>Canvas</code> from the level that contains the pause screen.</li>
				<li>Expand <code>Canvas</code> and then the <code>LevelTitle</code> game object in the <strong class="bold">Hierarchy</strong> window.</li>
				<li>Select the <code>Level</code> game object, and change the <code>level 1</code> to <code>level</code> <code>3</code> in the <strong class="bold">Inspector</strong> window.</li>
				<li>Save the scene.</li>
				<li>Repeat <a id="_idIndexMarker1388"/>this process for <code>level2</code>.</li>
			</ol>
			<p>The following <a id="_idIndexMarker1389"/>screenshot shows <code>level3</code> paused:</p>
			<div><div><img src="img/Figure_12.58_B18381.jpg" alt="Figure 12.58 – The pause screen working for level 3&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.58 – The pause screen working for level 3</p>
			<p>Let's move on to summarizing what we have covered in this chapter.</p>
			<h1 id="_idParaDest-214"><a id="_idTextAnchor217"/>Summary</h1>
			<p>In this chapter, we introduced a new concept to our game to make it more interesting than just taking place in space. Our camera and player needed to be slightly tweaked for the final level to support side-scrolling, instead of them being static in one screen, as is the case on the previous two levels. We also introduced a second enemy that can move around the floor, dodging other enemies in a panic-like state. The fleeing enemy used the navigation system that comes with Unity as standard, and we gave the enemy a floor to run around on. Lastly, we introduced the <strong class="bold">Timeline</strong> feature, which is related to the original animation system we used in <a href="B18381_04_Epub.xhtml#_idTextAnchor087"><em class="italic">Chapter 4</em></a><em class="italic">, Applying Art, Animation, and Particles</em>. We also discovered how <strong class="bold">Timeline</strong> lets any game object or component be animated in it without needing some form of hierarchical link between the game objects. Also, we extended the timeline to cover other components, such as lights, which we can't animate alone with the <strong class="bold">Timeline</strong> feature.</p>
			<p>The main takeaways from this chapter are the introduction of AI with a navigation system that can also be used for other behaviors in other games and the introduction of the timeline and its use to encourage creativity in projects, such as cutscenes, films, and  animated TV sequences. </p>
			<p>In the next chapter, we will look at polishing the visuals of our game, and we will see what tools can help us in optimizing performance and testing for bugs.</p>
			<p>Before you move on to the next chapter, try out the following mock test, as this is the last mini-mock test in this book before the big one.</p>
			<h1 id="_idParaDest-215"><a id="_idTextAnchor218"/>Mock test</h1>
			<ol>
				<li value="1">You are developing a game where your player is inside an office with other staff workers around them. When your player walks to a particular point, a trigger event is called to move the staff into another room with the use of <strong class="bold">Playable Director</strong>.</li>
			</ol>
			<p>You notice that when the game is paused and then un-paused, the audio and animation are out of sync with each other.</p>
			<p>Which property in the <strong class="bold">Playable Director</strong> component will likely fix this issue? </p>
			<ol>
				<li>Set the wrap mode to <strong class="bold">Hold</strong>.</li>
				<li>Set the update method to <strong class="bold">DSP</strong>.</li>
				<li>Set <strong class="bold">Initial Time</strong> to the current time (the time when the game is paused).</li>
				<li>Set the update method to <strong class="bold">Unscaled Game Time</strong>.</li>
			</ol>
			<ol>
				<li value="2">We have a set of playables linked within our playable graph. We need to remove one of these playables and its inputs.</li>
			</ol>
			<p>Which <strong class="bold">PlayerGraph</strong> function should we use?</p>
			<ol>
				<li><code>DestroyOutput</code></li>
				<li><code>DestroyPlayable</code></li>
				<li><code>DestroySubgraph</code></li>
				<li><code>Destroy</code></li>
			</ol>
			<ol>
				<li value="3">You have developed an eight-ball pool game. One of the testers has come back to you, saying that the frame rate of the game drops too low when one of the players breaks the balls up at the start of a game. All of the balls have rigid body sphere colliders.</li>
			</ol>
			<p>How can we improve the drop in the frame rate?</p>
			<ol>
				<li>Use a less expensive shader on the objects that are colliding with one another.</li>
				<li>Set the maximum allowed timestep to a range of 8–10 fps to account for this worst-case scenario.</li>
				<li>Change the rigid bodies so that they are kinematic.</li>
				<li>Use box and capsule colliders instead of sphere colliders.</li>
			</ol>
			<ol>
				<li value="4">What does the <code>NavMesh</code> modifier do?<ol><li>A <code>NavMesh</code> modifier determines what stage of the build process the NavMesh is baked at.</li><li>A <code>NavMesh</code> modifier describes the AI of each agent in the scene.</li><li>A <code>NavMesh</code> modifier allows NavMesh baking to occur outside the main thread so that it can be dynamically baked at runtime.</li><li>A <code>NavMesh</code> modifier adjusts how a game object behaves during NavMesh baking and can, for example, only affect certain agents.</li></ol></li>
				<li>Why does it help to only have the necessary boxes checked in the layer collision matrix?<ol><li>Unchecking boxes will hide layers so that they're not rendered.</li><li>Checking boxes will indicate which collisions can be ignored.</li><li>Checking boxes will show which layers are colliding in the frame debugger.</li><li>Unchecking boxes will reduce the number of layer collisions the physics system needs to check.</li></ol></li>
				<li>When we create a <code>Timeline</code> asset for a game object, what component is created and added to our game object?<ol><li><code>PlayableBinding</code></li><li><code>PlayableDirector</code></li><li><code>PlayableOutput</code></li><li><code>PlayableGraph</code></li></ol></li>
				<li>In your first-person shooter, which you are testing, you notice that when the alarm is sounded, the enemy guards come running toward the player. When you observe the enemy guards advancing, you close the door on them but notice that their arms and heads are coming through the door that you have closed.</li>
			</ol>
			<p>What setting do you need to increase to stop these arms and heads coming through objects that they shouldn't? </p>
			<ol>
				<li><strong class="bold">Step Height</strong></li>
				<li><strong class="bold">Max Slope</strong></li>
				<li><strong class="bold">Agent Height</strong></li>
				<li><strong class="bold">Agent Radius</strong></li>
			</ol>
			<ol>
				<li value="8">You have got yourself involved in a classic Save the Mayor rescue game. Your player is a trained vigilante trying to eliminate potential attackers to harm the city's mayor. One of the attackers gets too close, and you take a shot to warn them off. The attacker runs away but returns shortly after, crawling toward the mayor.</li>
			</ol>
			<p>Which <code>NavMesh</code> agent property can simulate this cautious behavior?</p>
			<ol>
				<li><strong class="bold">Area Mask</strong></li>
				<li><strong class="bold">Auto Braking</strong></li>
				<li><strong class="bold">Stopping Distance</strong></li>
				<li><strong class="bold">Priority</strong></li>
			</ol>
			<ol>
				<li value="9">Congratulations – Save the Mayor was a massive success, and you have been asked to start development straight away on Save the Mayor 2! Your vigilante is back, and this time, he can jump <em class="italic">and</em> run and jump across building rooftops.</li>
			</ol>
			<p>Yet again, you have applied the <code>NavMesh</code> agent so that your vigilante can run and jump across buildings in a linear path. You have correctly hooked all your animation controls up but have noticed that your vigilante isn't animating when it comes to jumping between building rooftops.</p>
			<p>What setting or property do we need to change to solve this issue?</p>
			<ol>
				<li>Uncheck <code>NavMesh</code> agent component.</li>
				<li>Increase the <code>NavMesh</code> agent component.</li>
				<li>Uncheck the <strong class="bold">Height Mesh</strong> property in the <strong class="bold">Bake</strong> settings under <strong class="bold">Navigation</strong>.</li>
				<li>Increase the jump distance in the <strong class="bold">Bake</strong> settings under <strong class="bold">Navigation</strong>.</li>
			</ol>
			<ol>
				<li value="10">We are working on a third-person game, and our character is using a finite state machine to react to their states. We currently have it set so that if we get too close to a particular character, they will attempt to run and hug us.</li>
			</ol>
			<p>What finite state machine component is the programmer working on?</p>
			<ol>
				<li><strong class="bold">Actions</strong></li>
				<li><strong class="bold">Transitions</strong></li>
				<li><strong class="bold">Events</strong></li>
				<li><strong class="bold">Rules</strong></li>
			</ol>
			<ol>
				<li value="11">Which of these tracks can the timeline not add without applying additional coding?<ol><li><strong class="bold">Activation Track</strong></li><li><strong class="bold">Animation Track</strong></li><li><strong class="bold">Light Control Track</strong></li><li><strong class="bold">Playable Track</strong></li></ol></li>
				<li>One of the 3D artists has supplied you with a series of three-dimensional models to be applied to one of the start up scenes for the project you are currently developing.</li>
			</ol>
			<p>When importing the models into the scene, you notice that all the models have sharp edges. You have asked the artist to make the models smoother.</p>
			<p>Is there anything else that can be done on the developer side to possibly fix these sharp three-dimensional model edges?</p>
			<ol>
				<li>Calculate the normals to a particular smoothing angle value.</li>
				<li>Import the files through Unity instead of dragging and dropping the files.</li>
				<li>Apply materials to each three-dimensional model.</li>
				<li>Make sure there is lighting in the scene.</li>
			</ol>
			<ol>
				<li value="13">What does <code>LateUpdate</code> do?<ol><li>Replaces the standard <code>Update</code> function when frames are overloaded.</li><li><code>LateUpdate</code> takes fewer resources to run, which makes it ideal for mobile platforms.</li><li>An update is only called once on every frame. <code>LateUpdate</code> is called every three frames.</li><li><code>LateUpdate</code> is the last item in the execution order before rendering.</li></ol></li>
				<li>What are the advantages of using <code>GameObject.Find</code> (if any)?<ol><li>There aren't any; it's slow and demanding.</li><li>If not called on every frame, it makes coding useful for referencing.</li><li><code>GameObject.Find</code> is deprecated.</li><li><code>GameObject.Find</code> searches through library asset data outside of the Unity project.</li></ol></li>
				<li>Do we have to import the <code>UnityEngine</code> library and <code>MonoBehaviour</code> with every script?<ol><li>No, as long as they are not applied to a game object.</li><li>Yes, or the Unity engine rejects the script.</li><li>Yes, as they act as a header to all scripts.</li><li>Only <code>MonoBehaviour</code> must be inherited in all cases.</li></ol></li>
				<li>When moving from one scene to another, you notice that the second scene is much darker, even though it uses the same art and lighting as the scene before it.</li>
			</ol>
			<p>How do we make the lighting act how it should in the scene?</p>
			<ol>
				<li>Make sure all the lights are turned off before being turned on in the second scene.</li>
				<li>Keep all the lights on from the first scene when moving into the second scene.</li>
				<li>Duplicate the lights from the previous scene over to the new one when loaded up.</li>
				<li>Turn off <strong class="bold">Auto Generate</strong> in the lighting settings and manually generate the lights.</li>
			</ol>
			<ol>
				<li value="17">What are the benefits of <code>Debug.Log()</code>?<ol><li>It is useful if developers want to know the value of a variable.</li><li>It sends string values to each variable.</li><li>There aren't any; it's deprecated, so we don't use it.</li><li>It logs information into Unity's database.</li></ol></li>
				<li>Is the Audio Mixer useful to developers?<ol><li>No, it's specifically built for audio users; developers use an AudioSource.</li><li>Yes, as it can be used to hold all the sounds in one central point.</li><li>Only if the developer is skilled in handling audio alone.</li><li>Yes, it helps the performance of the audio.</li></ol></li>
				<li>Why do some developers prefer JSON over PlayerPrefs?<ol><li>PlayerPrefs was released before JSON, which gives it a bigger following.</li><li>JSON can be used with more data types and is a more compatible API. </li><li>Both are good; it's just a matter of personal preference.</li><li>JSON is owned by Unity, so it incorporates a lot of features.</li></ol></li>
				<li>Why would we use a trigger box instead of a collider?<ol><li>Triggers and colliders carry out the same task.</li><li>Triggers have more functionality and cost less to run than colliders.</li><li>A trigger can call code when another collider/trigger enters it.</li><li>Triggers have different colored boxes.</li></ol></li>
			</ol>
		</div>
	</body></html>