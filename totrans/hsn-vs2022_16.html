<html><head></head><body>
		<div><h1 id="_idParaDest-149"><a id="_idTextAnchor149"/>Chapter 13: Working with Extensions in Visual Studio</h1>
			<p>We cannot deny that Visual Studio’s native functionality for performing tasks, as we have seen so far, is phenomenal. However, there may be times when you want to extend the capabilities of the IDE with simple features, such as applying a new theme with custom colors, or complex functionality, such as code-refactoring tools.</p>
			<p>It is in these cases where Visual Studio extensions are of great help, which is why we will dedicate an entire chapter to an analysis of their use.</p>
			<p>The main topics we will see are as follows: </p>
			<ul>
				<li>Working with the extensions tool</li>
				<li>Searching for and installing extensions</li>
				<li>Reviewing Visual Studio Marketplace</li>
				<li>Setting up extensions</li>
				<li>Creating a new theme as an extension</li>
			</ul>
			<p>Let’s start our tour through the extensibility of Visual Studio, thanks to extensions.</p>
			<h1 id="_idParaDest-150"><a id="_idTextAnchor150"/>Technical requirements</h1>
			<p>To follow this chapter, you must have installed Visual Studio with the web development workload, as shown in <a href="B17873_01_ePub.xhtml#_idTextAnchor013"><em class="italic">Chapter 1</em></a>, <em class="italic">Getting Started with Visual Studio 2022</em>.</p>
			<p>Additionally, to create a theme as an extension, as shown in the <em class="italic">Creating a new theme as an extension</em> section, you must install the <strong class="bold">Visual Studio extension development</strong> workload, as shown in <em class="italic">Figure 13.1</em>:</p>
			<div><div><img src="img/Figure_13.1_B17873.jpg" alt="Figure 13.1 – Installing the Visual Studio extension development workload&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 13.1 – Installing the Visual Studio extension development workload</p>
			<p>You can install it before you start reading the <em class="italic">Creating a new theme as an extension</em> section or while creating the extension, as shown in the same section.</p>
			<p>As the chapter focuses on showing the use of extensions in Visual Studio, a code repository is not required.</p>
			<p>Let’s see how to work with the extensions tool from Visual Studio.</p>
			<h1 id="_idParaDest-151"><a id="_idTextAnchor151"/>Working with the extensions tool</h1>
			<p>The <a id="_idIndexMarker519"/>main purpose of extensions in Visual Studio is that you can improve your day-to-day productivity with features that may be somewhat specific to particular tasks, such as providing suggestions for best practices in code, performing code cleanup, highlighting messages in the output window, adding visual features in code files, or interacting with SQLite databases. Allowing developers to create new features for Visual Studio and share them with the rest of the world is an excellent move on the part of the Microsoft team.</p>
			<p class="callout-heading">Important Note</p>
			<p class="callout">In this section, I will show you simple extensions to familiarize you with the concept of extensions. In <a href="B17873_14_ePub.xhtml#_idTextAnchor157"><em class="italic">Chapter 14</em></a>, <em class="italic">Using Popular Extensions</em>, you will learn about the most widely used and preferred extensions by developers and how to work with them.</p>
			<p>But how <a id="_idIndexMarker520"/>can we access these extensions? The most direct answer is through the extensions tool, which you can find through the <strong class="bold">Extensions</strong> | <strong class="bold">Manage Extensions</strong> menu, as shown in <em class="italic">Figure 13.2</em>:</p>
			<div><div><img src="img/Figure_13.02_B17873.jpg" alt="Figure 13.2 – The extensions tool&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 13.2 – The extensions tool</p>
			<p>On the left side, we find the<a id="_idIndexMarker521"/> following categories, which allow us to filter the extensions:</p>
			<ul>
				<li><strong class="bold">Installed</strong>: These are the extensions that we have previously installed in the Visual Studio instance.</li>
				<li><strong class="bold">Online</strong>: In this category, you will find the extensions available to be added to Visual Studio. In the upper part, we have a filter with the <strong class="bold">Sort by</strong> legend, which allows us to filter the extensions in different ways.</li>
				<li><strong class="bold">Updates</strong>: This category shows the extensions that have pending updates, either with bug fixes or extension improvements.</li>
				<li><strong class="bold">Roaming Extensions Manager</strong>: This category allows you to view extensions previously installed in an instance of Visual Studio that are associated with a Microsoft <a id="_idIndexMarker522"/>account, so they can be installed in the current instance of Visual Studio. This means that if you are logged in on a different computer and you install an extension, you will be able to see it in<a id="_idIndexMarker523"/> this list, so you do not have to remember the name of the extension and can install it easily.</li>
			</ul>
			<p>Now, let’s see how we can search and install extensions, thanks to this tool.</p>
			<h1 id="_idParaDest-152"><a id="_idTextAnchor152"/>Searching for and installing extensions</h1>
			<p>The extensions tool, which is shown in <em class="italic">Figure 13.3</em>, has a search box located at the top right, where<a id="_idIndexMarker524"/> we can enter a search term to find extensions referring to some technology or tool. It is important to note that the search will be performed in the selected category, which we discussed in the <em class="italic">Working with the extensions tools</em> section. </p>
			<p>If you want to <a id="_idIndexMarker525"/>perform a search among all the extensions, the best thing to do is to go to the <code>javascript</code>:</p>
			<div><div><img src="img/Figure_13.03_B17873.jpg" alt="Figure 13.3 – A list of results in the extensions tool&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 13.3 – A list of results in the extensions tool</p>
			<p>The order of the<a id="_idIndexMarker526"/> list of extensions will appear according to the drop-down item at the top, which by default appears as sorting by <strong class="bold">Relevance</strong>, but we can also select other options, such as displaying by <strong class="bold">Most Downloads</strong>, <strong class="bold">Most Recent</strong>, <strong class="bold">Trending</strong>, or <strong class="bold">Highest Rating</strong>.</p>
			<p>Let’s do another test, this <a id="_idIndexMarker527"/>time to install an extension. Let’s look for extensions related to <code>css</code>, and in the list, you will see an extension called <strong class="bold">Color Preview</strong>. To install an extension, just click on the <strong class="bold">Download</strong> button, which will start the download process:</p>
			<div><div><img src="img/Figure_13.04_B17873.jpg" alt="Figure 13.4 – Searching for and installing an extension&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 13.4 – Searching for and installing an extension</p>
			<p>Once the<a id="_idIndexMarker528"/> extension download is complete, a message will appear at the bottom of the window, stating <strong class="bold">Your changes will be scheduled. The modifications will begin when all Microsoft Visual Studio windows are closed</strong>. The message is very descriptive, so we will proceed to restart Visual Studio to perform the installation. </p>
			<p>Once we close Visual Studio, the installation process will start, which will show you (as shown in <em class="italic">Figure 13.5</em>) the extension that will be installed on the Visual Studio instance, as well as additional information, such as the <strong class="bold">Digital Signature</strong> and <strong class="bold">License</strong> types:</p>
			<div><div><img src="img/Figure_13.05_B17873.jpg" alt="Figure 13.5 – The extension installation window&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 13.5 – The extension installation window</p>
			<p>If we agree with the<a id="_idIndexMarker529"/> displayed information, as shown in <em class="italic">Figure 13.5</em>, we must click on the <strong class="bold">Modify</strong> button, which will start the installation process in the IDE.</p>
			<p>Once the installation process is complete, you must reopen an instance of Visual Studio. Although at first glance it seems that nothing has changed, this extension has added the ability to show us the selected color applied in the properties of a <code>css</code> file to the IDE, as demonstrated in <em class="italic">Figure 13.6</em>: </p>
			<div><div><img src="img/Figure_13.06_B17873.jpg" alt="Figure 13.6 – The feature added by the Color Preview extension&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 13.6 – The feature added by the Color Preview extension</p>
			<p>You can compare <a id="_idIndexMarker530"/>the preceding screenshot with those shown in the <em class="italic">Working with CSS styling tools</em> section of <a href="B17873_09_ePub.xhtml#_idTextAnchor108"><em class="italic">Chapter 9</em></a><em class="italic">,</em> <em class="italic">Styling and Cleanup Tools</em>.</p>
			<p>If you want to uninstall an extension, just open the extensions tool again and look for the extension in the <strong class="bold">Installed</strong> section. Then, click on the <strong class="bold">Uninstall</strong> button, as shown in <em class="italic">Figure 13.7</em>:</p>
			<div><div><img src="img/Figure_13.07_B17873.jpg" alt="Figure 13.7 – Uninstalling an extension&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 13.7 – Uninstalling an extension</p>
			<p>In the <a id="_idIndexMarker531"/>preceding screenshot, you can see a second button called <strong class="bold">Disable</strong>, which allows you to temporarily disable an extension until you decide to reactivate it.</p>
			<p>Now that we have seen how to install extensions from the extensions tool, let’s take a look at Visual Studio Marketplace.</p>
			<h1 id="_idParaDest-153"><a id="_idTextAnchor153"/>Reviewing Visual Studio Marketplace</h1>
			<p>Visual Studio Marketplace<a id="_idIndexMarker532"/> is the online place to find and install extensions for Visual Studio 2022. In this marketplace, you can also find extensions for other products of the Visual Studio family, such as Visual Studio Code and Azure DevOps. You can access the marketplace<a id="_idIndexMarker533"/> through the site: <a href="https://marketplace.visualstudio.com/vs">https://marketplace.visualstudio.com/vs</a>.</p>
			<p>Once you enter the portal, you will have a very different user interface to the extensions tool, but the core operation is the same. In the main portal, you will be able to see the different extensions sorted by <strong class="bold">Featured</strong>, <strong class="bold">Trending</strong>, <strong class="bold">Most Popular</strong>, and <strong class="bold">Highest Rated</strong>.</p>
			<p>To test the <a id="_idIndexMarker534"/>marketplace, let’s search for the term <code>icons</code> and see the list of results. Although the list currently yields 49 results, not all extensions are compatible with the most modern version of Visual Studio. Therefore, it is recommended to apply the filter for <strong class="bold">Visual Studio 2022</strong>, as shown in <em class="italic">Figure 13.8</em>:</p>
			<div><div><img src="img/Figure_13.8_B17873.jpg" alt="Figure 13.8 – Filtering Visual Studio versions in the marketplace&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 13.8 – Filtering Visual Studio versions in the marketplace</p>
			<p>Once the filter has been applied, find the <strong class="bold">Visual Studio Iconizer</strong> extension and click on it to go to the extension page:</p>
			<div><div><img src="img/Figure_13.09_B17873.jpg" alt="Figure 13.9 – Searching for extensions in the marketplace&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 13.9 – Searching for extensions in the marketplace</p>
			<p>On the <a id="_idIndexMarker535"/>extension page, you will be able to find information that will give you a general idea about the extension, such as the number of <a id="_idIndexMarker536"/>installations, the number of reviews, ratings, the change log, and the project page, among other data. If the description of the extension describes that it can help you solve a problem, you can click on the green <strong class="bold">Download</strong> button, as shown next:</p>
			<div><div><img src="img/Figure_13.10_B17873.jpg" alt="Figure 13.10 – The button to download an extension&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 13.10 – The button to download an extension</p>
			<p>This will <a id="_idIndexMarker537"/>start the process of downloading a file with a <code>vsix</code> extension – in this particular case, the name is <code>VSIconizer.vsix</code>. To install the extension in <a id="_idIndexMarker538"/>Visual Studio, you must first make sure you have closed all instances of the IDE and then run the downloaded file, which will start the same installation process that we saw in the <em class="italic">Searching for and installing extensions</em> section.</p>
			<p>Once the installation process is finished and an instance of Visual Studio 2022 is opened, we can see how the appearance of the IDE tabs has changed, illustrated in <em class="italic">Figure 13.11</em>, with the text being replaced by icons:</p>
			<div><div><img src="img/Figure_13.11_B17873.jpg" alt="Figure 13.11 – The appearance of the IDE tabs modified by the Iconizer extension&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 13.11 – The appearance of the IDE tabs modified by the Iconizer extension</p>
			<p>Whether you opt <a id="_idIndexMarker539"/>for an installation with the extensions tool or by downloading the extensions from the marketplace, the installation process is extremely simple. </p>
			<p>Now, let’s see how to configure the extensions we install.</p>
			<h1 id="_idParaDest-154"><a id="_idTextAnchor154"/>Setting up extensions</h1>
			<p>Unfortunately, there<a id="_idIndexMarker540"/> is no standardized way to configure a Visual Studio extension, as each extension is unique and serves specific purposes. What is true is that most extensions will add configuration options for the extension, either through a special window, or from the configuration options.</p>
			<p>The best way to know these configuration options is through the extension page itself. For example, in the case of the <strong class="bold">Visual Studio Iconizer</strong> extension, which we installed in the <em class="italic">Reviewing Visual Studio Marketplace</em> section, the initial behavior is to show only the icons on the tabs. The extension page tells us that this behavior can be changed to show the text of the tab next to the icon added by the extension. This can be done through the option that has been added through the <strong class="bold">Tools</strong> | <strong class="bold">Options</strong> | <strong class="bold">Environment</strong> | <strong class="bold">Iconizer</strong> menu, as shown in <em class="italic">Figure 13.12</em>:</p>
			<div><div><img src="img/Figure_13.12_B17873.jpg" alt="Figure 13.12 – The Iconizer extension options&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 13.12 – The Iconizer extension options</p>
			<p>Most extensions create a section, as shown in the preceding figure, and the more complex ones even <a id="_idIndexMarker541"/>provide a special new menu for the tool, which we will discuss in <a href="B17873_14_ePub.xhtml#_idTextAnchor157"><em class="italic">Chapter 14</em></a>, <em class="italic">Using Popular Extensions</em>.</p>
			<p>Now, let’s look at a way to create a new theme for Visual Studio and export it as an extension so that more users can apply it to their Visual Studio instances.</p>
			<h1 id="_idParaDest-155"><a id="_idTextAnchor155"/>Creating a new theme as an extension</h1>
			<p>If you want to <a id="_idIndexMarker542"/>carry out an even more customized color configuration for your IDE, it is possible to do so, thanks to the extension called <strong class="bold">Visual Studio Color Theme Designer</strong>. You can search and download this extension within Visual Studio Marketplace, as we saw in the <em class="italic">Reviewing Visual Studio Marketplace</em> section.</p>
			<p>Once you have installed the extension, you will need to start Visual Studio and select the <strong class="bold">Create a new project</strong> option, as shown here:</p>
			<div><div><img src="img/Figure_13.13_B17873.jpg" alt="Figure 13.13 – Creating a new project&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption"> </p>
			<p class="figure-caption">Figure 13.13 – Creating a new project</p>
			<p>In the window that is opened, you must select the project from the list called <strong class="bold">VSTheme Project</strong>, which has been installed, thanks to the previously added extension. If <a id="_idIndexMarker543"/>you do not find it at first glance, you can search for it in the search box at the top, as shown in <em class="italic">Figure 13.14</em>:</p>
			<div><div><img src="img/Figure_13.14_B17873.jpg" alt="Figure 13.14 – Searching for the VSTheme project&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 13.14 – Searching for the VSTheme project</p>
			<p>In the new project configuration window, as shown in <em class="italic">Figure 13.15</em>, you can enter a project name that refers to the theme you are creating. For this example, I will name it <code>CustomTheme</code>. You can leave the other parameters as the default values. Proceed to create the new project by clicking on <strong class="bold">Create</strong>:</p>
			<div><div><img src="img/Figure_13.15_B17873.jpg" alt="Figure 13.15 – Project configuration&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 13.15 – Project configuration</p>
			<p>If you are shown <a id="_idIndexMarker544"/>a window indicating that you must install the <strong class="bold">Visual Studio extension development</strong> workload, click on <strong class="bold">Install</strong>:</p>
			<div><div><img src="img/Figure_13.16_B17873.jpg" alt="Figure 13.16 – Installing the Visual Studio extension development workload&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 13.16 – Installing the Visual Studio extension development workload</p>
			<p>This will <a id="_idIndexMarker545"/>enable the environment to be able to develop extensions for the IDE.</p>
			<p class="callout-heading">Important Note</p>
			<p class="callout">If, after installing the workload shown in <em class="italic">Figure 13.16</em>, you get a solution without files, you must recreate the project, which will solve the problem.</p>
			<p>Once the IDE has installed the extension, the new project will be created with different elements. To configure your new theme, double-click on the file with the <code>vstheme</code> extension, inside the <strong class="bold">Solution Explorer</strong> window, as shown here:</p>
			<div><div><img src="img/Figure_13.17_B17873.jpg" alt="Figure 13.17 – Opening the theme configuration file&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 13.17 – Opening the theme configuration file</p>
			<p>This will<a id="_idIndexMarker546"/> start a wizard, which will allow you to create your new theme quickly. You will start in a tab called <strong class="bold">Quick start</strong>, where you will be able to select a base theme from the installed ones in order to make modifications to the new theme:</p>
			<div><div><img src="img/Figure_13.18_B17873.jpg" alt="Figure 13.18 – Setting up a new theme&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 13.18 – Setting up a new theme</p>
			<p>In <em class="italic">Figure 13.18</em>, the <strong class="bold">Dark</strong> theme<a id="_idIndexMarker547"/> has been selected for the demonstration. From here, you can click on any of the three main colors, tagged as <strong class="bold">Primary</strong>, <strong class="bold">Accent</strong>, and <strong class="bold">Secondary</strong>, to select a different color and apply it by clicking the <strong class="bold">OK</strong> button, highlighted in red in <em class="italic">Figure 13.19</em>:</p>
			<div><div><img src="img/Figure_13.19_B17873.jpg" alt="Figure 13.19 – Changing a color&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 13.19 – Changing a color</p>
			<p>If you want <a id="_idIndexMarker548"/>more detailed customization, you can do it by following the same procedure, both in the <strong class="bold">Common elements</strong> and <strong class="bold">All elements</strong> tabs, as shown in <em class="italic">Figure 13.18</em>.</p>
			<p>Finally, to use the theme, you have a <strong class="bold">Preview</strong> button at the bottom of the window to preview how the changes would look with your new configuration, and a button with the legend <strong class="bold">Apply</strong> to apply the changes to the IDE:</p>
			<div><div><img src="img/Figure_13.20_B17873.jpg" alt="Figure 13.20 – The buttons to preview and apply theme changes&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 13.20 – The buttons to preview and apply theme changes</p>
			<p>To obtain the<a id="_idIndexMarker549"/> installable extension file, you must compile the project. One of the ways to compile the project is shown in <em class="italic">Figure 13.21</em>:</p>
			<div><div><img src="img/Figure_13.21_B17873.jpg" alt="Figure 13.21 – Building the project&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 13.21 – Building the project</p>
			<p>Once the project<a id="_idIndexMarker550"/> has been successfully compiled, we must go to the compilation directory by right-clicking on the project and selecting the <strong class="bold">Open Folder in File Explorer</strong> option:</p>
			<div><div><img src="img/Figure_13.22_B17873.jpg" alt="Figure 13.22 – The option to open the project folder in Windows Explorer&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 13.22 – The option to open the project folder in Windows Explorer</p>
			<p>This will open<a id="_idIndexMarker551"/> the Windows file explorer at the project location. In this path, we will proceed to find the file located in the <code>bin</code> | <code>Debug</code> | <code>CustomTheme.vsix</code> path. The name of the file will be taken from the name of the project. In our example, the name of the project is <code>CustomTheme</code>, as shown in <em class="italic">Figure 13.15</em>, so if you have used another name for the creation of the project, you will find the file with that name. This is the file that you can distribute to share the theme, or you can upload it to Visual Studio Marketplace.</p>
			<p class="callout-heading">Important Note</p>
			<p class="callout">It is also possible to set the output mode to <strong class="bold">Release</strong>, as discussed in <a href="B17873_05_ePub.xhtml#_idTextAnchor060"><em class="italic">Chapter 5</em></a>,<em class="italic"> Debugging and Compiling Your Projects</em>. This will generate a smaller file that will run faster. </p>
			<p>As we have seen, creating a new theme, thanks to Visual Studio extensions, is extremely easy.</p>
			<h1 id="_idParaDest-156"><a id="_idTextAnchor156"/>Summary</h1>
			<p>In this chapter, we have seen that extensions are a way in which we can extend the functionality of Visual Studio, always with the aim of improving our user experience and optimizing development time. We have tested a few extensions that have completely changed some of the IDE’s functionality, such as previewing colors in <code>css</code> files, changing tabs to icons, and creating themes for distribution.</p>
			<p>Also, we have reviewed how to search for and install extensions, both from the extensions tool and Visual Studio Marketplace. We analyzed how extensions are regularly configured, and finally, we created a new custom theme that can be shared with others, thanks to the use of an extension.</p>
			<p>In <a href="B17873_14_ePub.xhtml#_idTextAnchor157"><em class="italic">Chapter 14</em></a>, <em class="italic">Using Popular Extensions</em>, we will delve even deeper into the topic of extensions, analyzing which ones are the most popular because of their usefulness in web development.</p>
		</div>
	</body></html>