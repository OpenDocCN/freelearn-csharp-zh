- en: Chapter 7. Working with Charts
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter we will see how to use charts in Crystal Reports. Crystal Reports
    supports many types of charts but we will create four reports that contain different
    samples of charts.
  prefs: []
  type: TYPE_NORMAL
- en: 'We will cover:'
  prefs: []
  type: TYPE_NORMAL
- en: Types of charts
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Creating charts
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Using the Chart Expert
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'We will use the same data table in our reports and see how to display this
    data in different charts. The first report will display data in a bar chart as
    we can see in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Working with Charts](img/8026EN_07_01.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'The second report will display data in a pie chart as we can see in the following
    screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Working with Charts](img/8026EN_07_02.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'The third report will display data in a gauge chart as we can see in the following
    screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Working with Charts](img/8026EN_07_03.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'In the final report, we will see how to display different charts in one report.
    Refer to the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Working with Charts](img/8026EN_07_04.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Creating the reports data source
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this section we will create the data source that we will use in all the reports
    in this chapter. All the reports in this chapter display the relation between
    employees and orders. These reports display the number of orders for each employee.
  prefs: []
  type: TYPE_NORMAL
- en: The SQL query that we will use in our report looks like the following screenshot:![Creating
    the reports data source](img/8026EN_07_05.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: We will create a new TableAdapter using the previous SQL query and we will name
    it `EmployeeOrdersTableAdapter`, as shown the following screenshot:![Creating
    the reports data source](img/8026EN_07_06.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Creating the first report – bar chart
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Let's start to create the first chart report. We will start with a bar chart.
  prefs: []
  type: TYPE_NORMAL
- en: Add a new Crystal Reports to our application and name it `crEmpPerBar`. We will
    choose the **As a Blank Report** option to see how we can add or modify our chart
    at any time after the report creation.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Right-click on **Database Fields** in **Field Explorer** and select the **Database
    Expert** option. As shown in the following screenshot, we will select our TableAdapter
    **EmployeeOrders** as a data source:![Creating the first report – bar chart](img/8026EN_07_07.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Right-click on the report and navigate to **Insert** | **Chart** and drag it
    in **Section1 (Report Header)**. As we can see in the following screenshot, in
    the **Type** tab we will select **Bar** as a chart type and **Side by side bar
    chart** as the type of bar chart, from the submenu that comes up in the right
    window:![Creating the first report – bar chart](img/8026EN_07_08.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Navigate to the **Data** tab as we can see in the following screenshot:![Creating
    the first report – bar chart](img/8026EN_07_09.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: In this step we will see how to display data in a bar chart. We need to display
    the name of the employee on the X-axis and the numbers of orders on the Y-axis.
    We will add the **EmployeeOrders.fullName** field to the upper-right list to display
    it on the X-axis and add the **EmployeeOrders.Quantity** field to the lower list
    to display it on the Y-axis. We can display only a specific number of employees
    using the **TopN** button as we have seen before in **Cross-Tab**. We will keep
    the other options in the other tabs and click on the **OK** button.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: We want to filter the orders by a period of date so we will add two filter parameters
    to our report with type **Date**. We will name the first parameter `pmFrom` and
    the second one `pmTo`. Have a look at the following screenshot to see the filter
    code:![Creating the first report – bar chart](img/8026EN_07_10.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Go to the main form and double-click on the **btnBarChart** button (**Bar chart**)
    to navigate to the code window behind it. Write the code as shown in the following
    screenshot for the `click` event:![Creating the first report – bar chart](img/8026EN_07_11.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Run the application to test the result. Enter the **from** and **to** dates
    as shown in the following screenshot:![Creating the first report – bar chart](img/8026EN_07_12.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on the **Bar chart** button to see the report result as shown in the following
    screenshot:![Creating the first report – bar chart](img/8026EN_07_13.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Now we will see how to update our report to get the required report, which we
    designed at the beginning of this chapter.
  prefs: []
  type: TYPE_NORMAL
- en: Removing the legend
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The legend is the box that appears on the right side as shown in the previous
    screenshot; by default it''s displayed beside the chart. In the following steps
    we will see how to remove it:'
  prefs: []
  type: TYPE_NORMAL
- en: Right-click on the chart and navigate to **Chart Options** | **General**. Navigate
    to the **Legend** tab as shown in the following screenshot:![Removing the legend](img/8026EN_07_14.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Uncheck the **Show Legend** checkbox. The dialog has many options that you can
    use. Try to change these options and test the result. Click on the **OK** button.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Removing the chart's title
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'In the next few steps we will see how to remove or change the default chart
    title:'
  prefs: []
  type: TYPE_NORMAL
- en: Right-click on our chart and navigate to **Chart Options** | **Titles**, as
    shown in the following screenshot:![Removing the chart's title](img/8026EN_07_15.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Clear the **Title** textbox and the **Group Title** textbox. Click on the **OK**
    button.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Changing the chart's appearance
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The Crystal Reports allows us to modify the appearance of our charts to meet
    the user requirements. In the following steps we will see how to achieve this:'
  prefs: []
  type: TYPE_NORMAL
- en: Right-click on our chart and navigate to **Chart Options** | **General**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Navigate to the **Appearance** tab; update the appearance properties as shown
    in the following screenshot:![Changing the chart's appearance](img/8026EN_07_16.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select the **Use Depth** checkbox. Change the **Depth** value as shown in the
    preceding screenshot.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Resize the chart size in the report to fit the report width.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Run the application to test the result; we will see that the report is the same
    as the one we had designed before.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Creating the second report – pie chart
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The second chart report that we will create is a pie chart. Let''s start the
    work:'
  prefs: []
  type: TYPE_NORMAL
- en: Add a new Crystal Reports to our application and name it `crEmpPerPie`. We will
    choose the **As a Blank Report** option.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Right-click on **Database Fields** in **Field Explorer** and select **Database
    Expert**. We will choose our TableAdapter **EmployeeOrders** as a data source.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Right-click on the report and navigate to **Insert** | **Chart** and drag it
    in **Section1 (Report Header)**. As shown in the following screenshot, in the
    **Type** tab we will select **Pie** as a chart type:![Creating the second report
    – pie chart](img/8026EN_07_17.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Move to the **Data** tab and select the data fields as we did in the previous
    report. Click on the **OK** button.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Add two **date** filters as we did in the previous report.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Go to the main form and double-click on the **btnPieChart** button (**Pie chart**)
    to navigate to the code window behind it. Write the code as shown in the following
    screenshot for the `click` event:![Creating the second report – pie chart](img/8026EN_07_18.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Run the application to test the result. We will see the report result as shown
    in the following screenshot:![Creating the second report – pie chart](img/8026EN_07_19.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Now we will see how to update our report to meet the required report that we
    designed at the beginning of this chapter.
  prefs: []
  type: TYPE_NORMAL
- en: Removing the legend
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'In the next few steps we will remove the legend as we did before with the bar
    chart:'
  prefs: []
  type: TYPE_NORMAL
- en: Right-click on our chart and navigate to **Chart Options** | **General**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Navigate to the **Legend** tab.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Unselect the **Show Legend** checkbox.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on the **OK** button.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Removing the chart's title
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: In the next few steps we will remove the chart's title again, as we did before
    with the bar chart.
  prefs: []
  type: TYPE_NORMAL
- en: Right-click on our chart and navigate to **Chart Options** | **Titles**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Clear the **Title** textbox.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on the **OK** button.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Changing the chart's appearance
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'We will change the chart''s appearance as we did before with the bar chart
    by performing the following steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Right-click on our chart and navigate to **Chart Options** | **General**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Navigate to the **Appearance** tab; update the appearance properties as shown
    in the following screenshot:![Changing the chart's appearance](img/8026EN_07_20.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Resize the chart size in the report to fit the report width.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Creating the third report – gauge chart
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The next chart report that we will create is a gauge chart report. Let''s start:'
  prefs: []
  type: TYPE_NORMAL
- en: Add a new Crystal Reports to our application and name it `crEmpPerGauge`. We
    will choose the **As a Blank Report** option.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Right-click on **Database Fields** in **Field Explorer** and navigate to **Database
    Expert**. We will choose our TableAdapter **EmployeeOrders** as a data source.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Right-click on the report and navigate to **Insert** | **Chart** and drag it
    in **Section1 (Report Header)**. As shown in the following screenshot, in the
    **Type** tab we will select **Gauge** as a chart type:![Creating the third report
    – gauge chart](img/8026EN_07_21.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Navigate to the **Data** tab and choose the data fields as we did in the first
    report. Click on the **OK** button.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Add the two **date** filters as we did in the first report.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Go to main form and double-click on **btnGaugeChart** button (**Gauge chart**)
    to navigate to the code window behind it. Write the code as shown in the following
    screenshot for the `click` event:![Creating the third report – gauge chart](img/8026EN_07_22.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Run the application to test the result. We will see the report result as shown
    in the following screenshot:![Creating the third report – gauge chart](img/8026EN_07_23.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Now we will see how to update our report to meet the report that we had designed
    at the beginning of this chapter.
  prefs: []
  type: TYPE_NORMAL
- en: Removing the legend
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'In the next few steps we will remove the legend as we did before with the bar
    chart:'
  prefs: []
  type: TYPE_NORMAL
- en: Right-click on our chart and navigate to **Chart Options** | **General**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Navigate to the **Legend** tab.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Deselect the **Show Legend** checkbox.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on the **OK** button.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Removing the chart's title
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'In the next few steps we will remove the chart''s title as we did before with
    the bar chart:'
  prefs: []
  type: TYPE_NORMAL
- en: Right-click on our chart and navigate to **Chart Options** | **Titles**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Clear the **Title** textbox.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on the **OK** button.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Changing the chart's appearance
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'We will change the chart''s appearance as we did before with the bar chart
    by performing the following steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Right-click on our chart and navigate to **Chart Options | General**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Navigate to the **Appearance** tab; update the appearance properties as shown
    in the following screenshot:![Changing the chart's appearance](img/8026EN_07_24.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Resize the chart size in the report to fit the report width.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Creating the fourth report – all in one
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this report we use different charts in one report and display the data with
    the charts.
  prefs: []
  type: TYPE_NORMAL
- en: Add new Crystal Reports to our application and name it `crEmpAllInOne`. We will
    choose the **As a Blank Report** option.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Right-click on **Database Fields** in **Field Explorer** and choose **Database
    Expert**. We will choose our TableAdapter **EmployeeOrders** as a data source.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Right-click on the report and navigate to **Insert** | **Chart** and drag it
    in **Section1 (Report Header)**. In the **Type** tab we will select **Bar** and
    resize the chart to fit the width of the report.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Right-click on the report and navigate to **Insert** | **Chart** and drag it
    in **Section1 (Report Header)**. In **Type** tab we will select **Pie** as a chart
    type and locate it under the **Bar** chart and resize the chart to fit the width
    of the report.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Right-click on the report and navigate to **Insert | Chart** and drag it in
    **Section1 (Report Header)**. In **Type** tab we will select **Gauge** as a chart
    type. Locate it under the **Pie** chart and resize the chart to fit the width
    of the report.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Update the appearance of all the three charts as we did before.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Add two **date** filters as we did in the previous report.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Drag-and-drop the report fields to the **Details** section and format them as
    shown in the following screenshot.![Creating the fourth report – all in one](img/8026EN_07_25.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Go to main form and double-click on the **btnAllInOne** button (**All In One**)
    to move to the code window behind it. Write the code as shown in the following
    screenshot for the `click` event:![Creating the fourth report – all in one](img/8026EN_07_26.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Run the application to test the result. It will be the same as the report we
    designed earlier.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter we learned how to use charts to build fantastic and powerful
    reports. We have seen that Crystal Reports support many types of charts and how
    easy it is to use these charts.
  prefs: []
  type: TYPE_NORMAL
- en: This chapter was the last one in our book. We learned how to create a reporting
    application from beginning to the end. I tried to give knowledge to the reader
    not only about tools such as Crystal Reports but also tried to teach them the
    skills and techniques that may help them to use these tools quickly and easily.
    We have seen how to design the application, and what tools we can use to create
    our application. We learned how to install our tools, how to use each tool, and
    how these tools communicate with each other. We learned Crystal Reports tools
    such as database expert, parameters, grouping, sorting, lines, and boxes. We learned
    to create different types of reports such as tabular, cross-tab and charts, and
    how to mix these types in one report. We learned how to display our reports in
    Visual Studio and passing parameter values dynamically using C# code.
  prefs: []
  type: TYPE_NORMAL
