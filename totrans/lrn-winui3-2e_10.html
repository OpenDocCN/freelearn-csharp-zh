<html><head></head><body>
		<div><h1 id="_idParaDest-206" class="chapter-number"><a id="_idTextAnchor315"/>10</h1>
			<h1 id="_idParaDest-207"><a id="_idTextAnchor316"/>Accelerating App Development with Template Studio</h1>
			<p>Starting a new project from scratch can be daunting. What are the best practices for application architecture and project layout? <strong class="bold">Template Studio for WinUI</strong> is an open source project <a id="_idIndexMarker719"/>that began as <strong class="bold">Windows Template Studio</strong> for<a id="_idIndexMarker720"/> UWP and WPF applications. Each version of Template Studio is an extension for Visual Studio. It now supports WinUI, and variations have <a id="_idIndexMarker721"/>been created that will also<a id="_idIndexMarker722"/> generate <strong class="bold">.NET MAUI</strong> and <strong class="bold">Uno </strong><strong class="bold">Platform</strong> projects.</p>
			<p>In this chapter, we will cover the following topics:</p>
			<ul>
				<li>Discover what Template Studio is and how it can help developers create new WinUI projects while following best patterns and practices</li>
				<li>Review the history of Windows Template Studio and UWP applications</li>
				<li>Create a new project with Template Studio for WinUI and the MVVM Toolkit</li>
				<li>Learn about other variations of Template Studio</li>
			</ul>
			<p>By the end of this chapter, you will understand the origins of the current Template Studio extensions for Visual Studio. You’ll also have enough familiarity with Template Studio for WinUI to choose it when starting your next WinUI 3 project. You will also know where you can go to suggest enhancements, submit issues, or improve the project by submitting your own changes to the open source project.</p>
			<h1 id="_idParaDest-208"><a id="_idTextAnchor317"/>Technical requirements</h1>
			<p>To follow along with the examples in this chapter, please refer to the <em class="italic">Technical requirements</em> section of <a href="B20908_02.xhtml#_idTextAnchor044"><em class="italic">Chapter 2</em></a>, <em class="italic">Configuring the Development Environment and Creating </em><em class="italic">the Project</em>.</p>
			<p>The source code for this chapter is available on GitHub here: <a href="https://github.com/PacktPublishing/Learn-WinUI-3-Second-Edition/tree/master/Chapter10">https://github.com/PacktPublishing/Learn-WinUI-3-Second-Edition/tree/master/Chapter10</a></p>
			<h1 id="_idParaDest-209"><a id="_idTextAnchor318"/>Overview of Template Studio for WinUI</h1>
			<p>Template Studio for WinUI <a id="_idIndexMarker723"/>is an open source extension for Visual Studio that enhances the experience of creating a new WinUI 3 project. Microsoft currently has three versions of the Template Studio extension available:</p>
			<ul>
				<li><strong class="bold">Template Studio for WinUI (C#)</strong> – This is<a id="_idIndexMarker724"/> the extension we will use in this chapter. There are also plans for a C++ version of Template Studio for WinUI.</li>
				<li><strong class="bold">Template Studio for WPF</strong> – The <a id="_idIndexMarker725"/>WPF version of Template Studio is similar to the WinUI extension. It creates a .NET WPF project.</li>
				<li><strong class="bold">Template Studio for UWP</strong> – This<a id="_idIndexMarker726"/> version is the updated extension that was originally named Windows Template Studio.</li>
			</ul>
			<p>The code and documentation for the Template Studio projects<a id="_idIndexMarker727"/> are available on GitHub: <a href="https://github.com/microsoft/TemplateStudio">https://github.com/microsoft/TemplateStudio</a>. The team also maintains a release roadmap on GitHub that you can monitor: <a href="https://github.com/microsoft/TemplateStudio/blob/main/docs/roadmap.md">https://github.com/microsoft/TemplateStudio/blob/main/docs/roadmap.md</a>.</p>
			<p>Creating a new project with one of the Template Studio extensions launches an enhanced wizard-style experience where you can select the type of project you want to create and the design pattern to follow (such as MVVM). You can also select some pre-defined pages and other features to include in your project, as well as a unit test project. We will step through the full experience and discuss the options in the next section.</p>
			<p>Template Studio for WinUI is installed like any other Visual Studio extension. If you aren’t familiar with the process, you can either download the <strong class="bold">VSIX</strong> package<a id="_idIndexMarker728"/> from the Visual Studio Marketplace (<a href="https://marketplace.visualstudio.com/items?itemName=TemplateStudio.TemplateStudioForWinUICs">https://marketplace.visualstudio.com/items?itemName=TemplateStudio.TemplateStudioForWinUICs</a>) or you can search for and add it in the <strong class="bold">Manage Extensions</strong> dialog box in Visual <a id="_idIndexMarker729"/>Studio.</p>
			<div><div><img src="img/B20908_10_01.jpg" alt="Figure 10.1 – Template Studio for WinUI in Visual Studio Marketplace"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.1 – Template Studio for WinUI in Visual Studio Marketplace</p>
			<p>We’ll be using the <strong class="bold">Manage Extensions</strong> dialog to install the extension in this chapter. For detailed information on managing extensions in Visual Studio, see this documentation on Microsoft Learn: <a href="https://learn.microsoft.com/visualstudio/ide/finding-and-using-visual-studio-extensions">https://learn.microsoft.com/visualstudio/ide/finding-and-using-visual-studio-extensions</a>.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">If you’re curious about the inner workings of a Visual Studio extension package, or VSIX, you can read more about them on Microsoft Learn: <a href="https://learn.microsoft.com/visualstudio/extensibility/anatomy-of-a-vsix-package">https://learn.microsoft.com/visualstudio/extensibility/anatomy-of-a-vsix-package</a></p>
			<p>The <a id="_idIndexMarker730"/>code that is generated by the extension continues to guide you as you proceed to build out the newly created project. There are <em class="italic">TODO</em> comments with guidance about where you add your own code and helpful links to documentation that explains the concepts and controls used in the code. The extension is updated frequently to reflect the latest WinUI features, practices, and recommendations for Windows developers.</p>
			<p>Contributions to the Template Studio projects on GitHub are all reviewed to ensure they follow good coding style, fluent design, and helpful comments throughout.</p>
			<p>Now that we have reviewed some basics of Template Studio for WinUI, let’s dive right in and create a new project with the extension.</p>
			<h1 id="_idParaDest-210"><a id="_idTextAnchor319"/>Starting a new WinUI project with Template Studio</h1>
			<p>In this section, we <a id="_idIndexMarker731"/>are going to create a new WinUI<a id="_idIndexMarker732"/> project with Template Studio for WinUI. We’ll install the extension, create the project with several pages and features selected, and then run the project to explore what is provided before we add any of our own code. In the next section, we’ll dive a little deeper into the generated code to see where we would start extending and enhancing the project if we were building a production application:</p>
			<ol>
				<li>To start, open Visual Studio and select <strong class="bold">Continue without code</strong> to open the IDE without loading a solution:</li>
			</ol>
			<div><div><img src="img/B20908_10_02.jpg" alt="Figure 10.2 – The Visual Studio 2022 launch dialog"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.2 – The Visual Studio 2022 launch dialog</p>
			<ol>
				<li value="2">In<a id="_idIndexMarker733"/> the <a id="_idIndexMarker734"/>menu, select <strong class="bold">Extensions</strong> | <strong class="bold">Manage Extensions</strong> to open the <strong class="bold">Manage </strong><strong class="bold">Extensions</strong> dialog:</li>
			</ol>
			<div><div><img src="img/B20908_10_03.jpg" alt="Figure 10.3 – The Manage Extensions dialog in Visual Studio"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.3 – The Manage Extensions dialog in Visual Studio</p>
			<ol>
				<li value="3">In<a id="_idIndexMarker735"/> the <code>template studio</code>. In <a id="_idIndexMarker736"/>the list of search results, select <strong class="bold">Download</strong> on <strong class="bold">Template Studio for </strong><strong class="bold">WinUI (C#)</strong>:</li>
			</ol>
			<div><div><img src="img/B20908_10_04.jpg" alt="Figure 10.4 – Installing Template Studio for WinUI from Manage Extensions"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.4 – Installing Template Studio for WinUI from Manage Extensions</p>
			<p class="list-inset">You will<a id="_idIndexMarker737"/> need to restart Visual Studio<a id="_idIndexMarker738"/> to complete the extension’s installation.</p>
			<ol>
				<li value="4">After the installation completes, launch Visual Studio and select <strong class="bold">Create a </strong><strong class="bold">new project</strong>.</li>
				<li>On the <code>template studio</code>. The new project template should appear first in the list of results:</li>
			</ol>
			<div><div><img src="img/B20908_10_05.jpg" alt="Figure 10.5 – Selecting Template Studio for WinUI to create a new project"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.5 – Selecting Template Studio for WinUI to create a new project</p>
			<ol>
				<li value="6">Select <code>TemplateStudioSampleApp</code>.</li>
				<li>Click <strong class="bold">Create</strong> to continue. Instead of the Visual Studio IDE immediately loading, you will be presented with the Template Studio wizard:</li>
			</ol>
			<div><div><img src="img/B20908_10_06.jpg" alt="Figure 10.6 – The first page of the Template Studio for WinUI wizard"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.6 – The first page of the Template Studio for WinUI wizard</p>
			<p class="list-inset">The first <a id="_idIndexMarker741"/>page of the wizard prompts you <a id="_idIndexMarker742"/>to select a project type. The choices are <code>NavigationView</code> control that we discussed in <a href="B20908_05.xhtml#_idTextAnchor114"><em class="italic">Chapter 5</em></a>, <em class="italic">Exploring WinUI Controls</em>. It’s also the navigation method used in the WinUI 3 Gallery app.</p>
			<ol>
				<li value="8">Select <strong class="bold">Next</strong> to continue. On the <strong class="bold">Design pattern</strong> screen, the only available option is <strong class="bold">MVVM Toolkit</strong>. Some versions of Template Studio offer other MVVM frameworks or a <strong class="bold">Code Behind</strong> option. For WinUI 3, we only have one choice:</li>
			</ol>
			<div><div><img src="img/B20908_10_07.jpg" alt="Figure 10.7 – The Design pattern screen"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.7 – The Design pattern screen</p>
			<p class="list-inset">You’ll also<a id="_idIndexMarker743"/> notice that the right pane <a id="_idIndexMarker744"/>contains the <strong class="bold">Your project details</strong> heading and the options that have been selected so far. When you’re more familiar with Template Studio, you will be able to review these options and click <strong class="bold">Create</strong> to finish the wizard without visiting each screen if you’re satisfied with the default selections.</p>
			<ol>
				<li value="9">Click <strong class="bold">Next</strong> and review the <strong class="bold">Pages</strong> screen:</li>
			</ol>
			<div><div><img src="img/B20908_10_08.jpg" alt="Figure 10.8 – The Pages screen in Template Studio for WinUI"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.8 – The Pages screen in Template Studio for WinUI</p>
			<p class="list-inset">By default, one <strong class="bold">Blank</strong> page has been selected. The default name of this page is <strong class="bold">Main</strong>. You can<a id="_idIndexMarker745"/> change the names of any pages<a id="_idIndexMarker746"/> in the <strong class="bold">Your project </strong><strong class="bold">details</strong> panel.</p>
			<ol>
				<li value="10">Let’s select several other page types to review in the next section. Select <strong class="bold">Data Grid</strong>, <strong class="bold">List Details</strong>, <strong class="bold">Web View</strong>, and <strong class="bold">Settings</strong>. You can select more if you like:</li>
			</ol>
			<div><div><img src="img/B20908_10_09.jpg" alt="Figure 10.9 – Selecting several additional pages for our project"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.9 – Selecting several additional pages for our project</p>
			<p class="list-inset">Any of the<a id="_idIndexMarker747"/> pages can be renamed<a id="_idIndexMarker748"/> except for <strong class="bold">Settings</strong>. We’ll leave the default names.</p>
			<ol>
				<li value="11">Click <strong class="bold">Next</strong> to move on to the <strong class="bold">Features</strong> screen:</li>
			</ol>
			<div><div><img src="img/B20908_10_010.jpg" alt="Figure 10.10 – Exploring the Features screen of Template Studio for WinUI"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.10 – Exploring the Features screen of Template Studio for WinUI</p>
			<p class="list-inset">The default <a id="_idIndexMarker749"/>selections on the <strong class="bold">Features</strong> screen <a id="_idIndexMarker750"/>are <strong class="bold">Settings Storage</strong>, <strong class="bold">MSIX Packaging</strong>, and <strong class="bold">Theme Selection</strong>. We’ll leave those defaults selected. If you want to include the Windows App SDK dependencies with your project, you can select <strong class="bold">Self-Contained</strong>. This is useful if you are going to distribute your app manually with <a id="_idIndexMarker751"/>an <strong class="bold">xcopy deployment</strong>. We’ll discuss deployment options in <a href="B20908_14.xhtml#_idTextAnchor582"><em class="italic">Chapter 14</em></a>, <em class="italic">Packaging and Deploying WinUI Applications</em>. The other unselected option is <strong class="bold">App Notifications</strong>. We have already explored notifications in <a href="B20908_08.xhtml#_idTextAnchor197"><em class="italic">Chapter 8</em></a>, <em class="italic">Add</em><em class="italic">ing</em><em class="italic"> Windows Notifications to WinUI Applications</em>. If you want to learn more about any of the features, select <strong class="bold">Details</strong>.</p>
			<ol>
				<li value="12">Click <strong class="bold">Next</strong> to move on to the final step of the wizard, <strong class="bold">Testing</strong>:</li>
			</ol>
			<div><div><img src="img/B20908_10_011.jpg" alt="Figure 10.11 – The Testing screen of the Template Studio for WinUI wizard"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.11 – The Testing screen of the Template Studio for WinUI wizard</p>
			<ol>
				<li value="13">The only<a id="_idIndexMarker752"/> option on the <strong class="bold">Testing</strong> screen is <strong class="bold">MSTest</strong>. Select it to add a unit test project to your solution.</li>
				<li>We’ve reached<a id="_idIndexMarker753"/> the end of the wizard. Select <strong class="bold">Create</strong> to create the solution and launch the Visual Studio IDE:</li>
			</ol>
			<div><div><img src="img/B20908_10_012.jpg" alt="Figure 10.12 – Visual Studio with our new solution loaded"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.12 – Visual Studio with our new solution loaded</p>
			<ol>
				<li value="15">The <a id="_idIndexMarker754"/>markdown file named <code>README.md</code> will <a id="_idIndexMarker755"/>be opened by default. If you want to view a formatted preview of the markdown, you can select the <strong class="bold">Preview</strong> button at the top of the editor window:</li>
			</ol>
			<div><div><img src="img/B20908_10_013.jpg" alt="Figure 10.13 – Viewing the formatted README file"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.13 – Viewing the formatted README file</p>
			<p class="list-inset">The <a id="_idIndexMarker756"/>solution contains three projects: <strong class="bold">TemplateStudioSampleApp</strong>, <strong class="bold">TemplateStudioSampleApp.Core</strong>, and <strong class="bold">TemplateStudioSampleApp.Tests.MSTest</strong>. We’ll discuss the purpose and contents of <a id="_idIndexMarker757"/>each of these projects in the next section:</p>
			<div><div><img src="img/B20908_10_14.jpg" alt="Figure 10.14 – Viewing the projects in Solution Explorer"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.14 – Viewing the projects in Solution Explorer</p>
			<ol>
				<li value="16">It’s<a id="_idIndexMarker758"/> finally time to run the application. Start <a id="_idIndexMarker759"/>debugging and ensure that there are no compile-time or runtime errors when launching it:</li>
			</ol>
			<div><div><img src="img/B20908_10_15.jpg" alt="Figure 10.15 – Running the TemplateStudioSampleApp solution"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.15 – Running the TemplateStudioSampleApp solution</p>
			<p class="list-inset">Everything should run as expected, and you can try navigating to each page with the <code>NavigationView</code> controls on the left. The <strong class="bold">Settings</strong> button will always appear at the bottom of the navigation bar.</p>
			<p>Now that we have a working application, let’s take some time to understand what’s been generated for us.</p>
			<h1 id="_idParaDest-211"><a id="_idTextAnchor320"/>Exploring the code generated by Template Studio</h1>
			<p>It’s time to review the contents of the newly generated <code>README.md</code> file with an overview of the project and its purpose.</p>
			<h2 id="_idParaDest-212"><a id="_idTextAnchor321"/>Exploring the Core project</h2>
			<p>The <strong class="bold">TemplateStudioSampleApp.Core</strong> project is a class library project targeting .NET 7. This <a id="_idIndexMarker760"/>is where you would place any code that is intended to be shared across projects. The project contains four folders:</p>
			<ul>
				<li><code>Contracts</code>: Interfaces for the services in the project are kept here in a <code>Services</code> subfolder. Any new interfaces needed in this project should be created here.</li>
				<li><code>Helpers</code>: This folder contains a <code>Json</code> helper class with methods to convert between <strong class="bold">JSON</strong> strings and .NET objects. Add your own common helper classes to this folder.</li>
				<li><code>Models</code>: There are some sample model classes in this folder that are used to populate company and order data on the <code>DataGridPage</code> and <code>ListDetailPage</code> views.</li>
				<li><code>Services</code>: This folder contains <code>FileService</code> and <code>SampleDataService</code> classes. The <code>FileService</code> class reads and writes files with classes in the .NET <code>System.IO</code> and <code>System.Text</code> namespaces. The <code>SampleDataService</code> creates static data to populate the model classes for the UI. Any other shared services can be added here.</li>
			</ul>
			<p class="callout-heading">Note</p>
			<p class="callout">It’s possible that the Template Studio extensions may be updated to create .NET 8 libraries by the time this book is published.</p>
			<p>Next, let’s explore the largest project in the solution, <strong class="bold">TemplateStudioSampleApp</strong>.</p>
			<h2 id="_idParaDest-213"><a id="_idTextAnchor322"/>Exploring the main project</h2>
			<p>The main <a id="_idIndexMarker761"/>project, <strong class="bold">TemplateStudioSampleApp</strong>, is the largest of the three projects in the solution. It contains all the user interface markup and logic. You will probably recognize the files in the root of the project, after working with other WinUI projects. <strong class="bold">App.xaml</strong>, <strong class="bold">MainWindow.xaml</strong>, and <strong class="bold">Package.appxmanifest</strong> are all there, along with C# code-behind files for each XAML file.</p>
			<p>The contents of the <code>Page</code> and <code>ViewModel</code> class for each page that we selected when configuring the project with the Template Studio wizard. There are also <code>ShellPage</code> and <code>ShellViewModel</code> classes for handling the navigation between child pages. <code>NavigationView</code> control and is the direct child of <code>MainWindow</code>.</p>
			<p>Next, let’s go through the contents of the remaining folders:</p>
			<ul>
				<li><code>Activation</code>: This folder contains the <code>ActivationHandler</code>, <code>DefaultActivation</code><code> Handler</code>, and <code>IActivationHandler</code> classes. They are helpers that use the <code>INavigationService</code> to navigate to the selected page inside the <code>Frame</code> hosted within <code>ShellPage</code>. If you needed to change the default activation behavior, you would create a new handler that inherits from <code>ActivationHandler</code>.</li>
				<li><code>Assets</code>: This contains the graphical assets for the project. The <code>Assets</code> folder is present in every WinUI project.</li>
				<li><code>Behaviors</code>: This folder contains an enum named <code>NavigationViewHeaderMode</code>, which specifies the appearance of the navigation bar, and <code>NavigationViewHeaderBehavior</code>, which contains the logic to implement these modes. The behavior class inherits from <code>Behavior&lt;NavigationView&gt;</code>. Any other custom WinUI behaviors would be added here.</li>
				<li><code>Contracts</code>: This is where you keep your interfaces for the project. The two subfolders, <code>Services</code> and <code>ViewModels</code>, contain interfaces for eight existing classes in those corresponding project folders.</li>
				<li><code>Helpers</code>: Any helper classes specific to this project are kept here. Some of the helpers provided by default include <code>NavigationHelper</code>, <code>SettingsStorageExtensions</code>, and <code>TitleBarHelper</code>. The <code>SettingsStorageExtensions</code> helper class leverages members of the <code>Windows.Storage</code> and <code>Windows.Storage.Streams</code> namespaces to read and write user settings.</li>
				<li><code>Models</code>: The sample data models are kept in the <code>LocalSettingsOptions</code> class stores the name and location of the settings file. Any other UI-specific model classes would be added here.</li>
				<li><code>Services</code>: There are seven service classes in the <code>Services</code> folder. You can probably determine the purpose of each by its name: <code>ActivationService</code>, <code>LocalSettings</code><code> Service</code>, <code>NavigationService</code>, <code>NavigationViewService</code>, <code>PageService</code>, <code>ThemeSelectorService</code>, and <code>WebViewService</code>. You should take some time to review the code in these services.</li>
				<li><code>Strings</code>: This <a id="_idIndexMarker762"/>folder holds language-specific <code>Resources.resw</code> files to localize any string values displayed in your application. The English language resource file can be found in the <code>en-us</code> folder. For more information about localization, you should read <em class="italic">Localize your WinUI 3 app</em> on Microsoft Learn: <a href="https://learn.microsoft.com/windows/apps/winui/winui3/localize-winui3-app">https://learn.microsoft.com/windows/apps/winui/winui3/localize-winui3-app</a>.</li>
				<li><code>Styles</code>: This folder contains three files with XAML <code>ResourceDictionary</code> elements: <code>FontSizes.xaml</code>, <code>TextBlock.xaml</code>, and <code>Thickness.xaml</code>. Let’s look at the contents of <code>FontSizes.xaml</code> as an example:<pre class="source-code">
&lt;ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/
      2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/
      2006/xaml"&gt;
    &lt;x:Double x:Key="LargeFontSize"&gt;24&lt;/x:Double&gt;
    &lt;x:Double x:Key="MediumFontSize"&gt;16&lt;/x:Double&gt;
&lt;/ResourceDictionary&gt;</pre><p class="list-inset">By centralizing how your app defines a <a id="_idIndexMarker763"/>large or medium font size, you can change this later without having to modify multiple XAML views. If you are using a <code>TextBlock</code> or <code>RichTextBlock</code>, the other option for <a id="_idIndexMarker764"/>font sizing is to use the <strong class="bold">XAML type ramp</strong> (discussed in <a href="B20908_07.xhtml#_idTextAnchor152"><em class="italic">Chapter 7</em></a>, <em class="italic">Fluent Design System for Windows Applications</em>) defined in the XAML theme resources: <a href="https://learn.microsoft.com/windows/apps/design/style/xaml-theme-resources#the-xaml-type-ramp">https://learn.microsoft.com/windows/apps/design/style/xaml-theme-resources#the-xaml-type-ramp</a>.</p></li>			</ul>
			<p>Before we move on to explore the <code>App.xaml.cs</code> file. Everything in here should look familiar to you. The project is using the <code>IHostBuilder.ConfigureServices</code> method to add the <code>ActivationHandler</code> and all services, views, and ViewModel classes to the DI container. The services and core services are added as singleton objects while all the other classes are added with <code>AddTransient</code>.</p>
			<p>The <code>App</code> class also has a handy helper method to fetch an instance from the DI container:</p>
			<pre class="source-code">
public static T GetService&lt;T&gt;() T : class
{
    if ((App.Current as App)!.Host.Services.GetService
      (typeof(T)) is not T service)
    {
        throw new ArgumentException($"{typeof(T)} needs to
          be registered in ConfigureServices within
            App.xaml.cs.");
    }
    return service;
}</pre>			<p>This <a id="_idIndexMarker765"/>encapsulates some exception-handling logic in case the requested type cannot be found, reducing the need to repeat this code throughout the application.</p>
			<p>Notice how each class has helpful comments with links to Microsoft Learn resources for any related APIs or other topics. The <code>App</code> class has links to .NET dependency injection, logging, and other learning resources.</p>
			<p>Let’s finish this section with a quick look at the <strong class="bold">MSTest</strong> project that was created by Template Studio.</p>
			<h2 id="_idParaDest-214"><a id="_idTextAnchor323"/>Exploring the MSTest project</h2>
			<p>The <code>TestClass</code>, a <code>README.md</code> file, and <code>Initialize</code> and <code>Usings</code> classes. You should<a id="_idIndexMarker766"/> read the <code>README.md</code> file carefully. It contains information about the project, testing UI elements, dependency injection, and mocking. There are examples of how to leverage DI and mocks to test the <code>SettingsViewModel</code> without actually reading or writing any settings to the filesystem.</p>
			<p>The <code>TestClass</code> contains examples of test initialization and cleanup at the class and test level, as well as two sample test methods: <code>TestMethod</code> and <code>UITestMethod</code>:</p>
			<pre class="source-code">
[TestMethod]
public void TestMethod()
{
    Assert.IsTrue(true);
}
[UITestMethod]
public void UITestMethod()
{
    Assert.AreEqual(0, new Grid().ActualWidth);
}</pre>			<p>Any test method decorated with the <code>UITestMethod</code> attribute will run on the UI thread. The generated code does not test any members of the <strong class="bold">TemplateStudioSampleApp</strong> or <strong class="bold">TemplateStudioSampleApp.Core</strong> projects yet. It’s up to you to <a id="_idIndexMarker767"/>add your own test methods to do that. You can get started by reading the Visual Studio unit testing documentation on Microsoft Learn: <a href="https://learn.microsoft.com/visualstudio/test/getting-started-with-unit-testing">https://learn.microsoft.com/visualstudio/test/getting-started-with-unit-testing</a>.</p>
			<p>In the next section, we will discuss some other Template Studio extensions created by Microsoft and one from a third party.</p>
			<h1 id="_idParaDest-215"><a id="_idTextAnchor324"/>Template Studio extensions for other UI frameworks</h1>
			<p>We’ve <a id="_idIndexMarker768"/>taken a deep dive into the Template Studio for WinUI extension, but what about the UI frameworks? As we mentioned earlier in the chapter, Microsoft also maintains extensions for Template Studio for <a id="_idIndexMarker769"/>WPF and <a id="_idIndexMarker770"/>Template Studio for UWP. In fact, they even have<a id="_idIndexMarker771"/> a <strong class="bold">Microsoft Web Template Studio</strong> available: <a href="https://github.com/microsoft/WebTemplateStudio">https://github.com/microsoft/WebTemplateStudio</a>. It supports <strong class="bold">React</strong>, <strong class="bold">Angular</strong>, or <strong class="bold">Vue.js</strong> for<a id="_idIndexMarker772"/> the frontend <a id="_idIndexMarker773"/>and <strong class="bold">Node.js</strong>, <strong class="bold">Flask</strong>, <strong class="bold">Molecular</strong>, and <strong class="bold">ASP.NET Core</strong> as <a id="_idIndexMarker774"/>backend frameworks. If you’re interested in<a id="_idIndexMarker775"/> web <a id="_idIndexMarker776"/>development, you should check<a id="_idIndexMarker777"/> it out.</p>
			<p>There is also an <a id="_idIndexMarker778"/>extension called <strong class="bold">MAUI App Accelerator</strong> (<a href="https://marketplace.visualstudio.com/items?itemName=MattLaceyLtd.MauiAppAccelerator">https://marketplace.visualstudio.com/items?itemName=MattLaceyLtd.MauiAppAccelerator</a>), which is a Template Studio version for .NET MAUI. We’ll remain focused on WinUI and WPF templates in this chapter. The final two we’ll review are Template Studio for WPF and the Template Studio-style wizard that comes with the Uno Platform extension for Visual Studio. Let’s start with WPF.</p>
			<h2 id="_idParaDest-216"><a id="_idTextAnchor325"/>Template Studio for WPF</h2>
			<p>The Template Studio for<a id="_idIndexMarker779"/> WPF extension (<a href="https://marketplace.visualstudio.com/items?itemName=TemplateStudio.TemplateStudioForWPF">https://marketplace.visualstudio.com/items?itemName=TemplateStudio.TemplateStudioForWPF</a>) is similar to its WinUI counterpart. It has one additional step in the wizard (<strong class="bold">Services</strong>), and there are a few different options on some of the pages. One of the project types available to WPF developers is the <strong class="bold">Ribbon</strong> type. This creates a shell with a Microsoft Office-style ribbon control at the top in place of the standard menu control you would get in a <strong class="bold">MenuBar</strong>-type project.</p>
			<p>The <strong class="bold">Design pattern</strong> screen allows you to select <strong class="bold">Code Behind</strong> or <strong class="bold">Prism</strong>, in addition to the <strong class="bold">MVVM Toolkit</strong> option. While the <strong class="bold">Page</strong> options are the same as WinUI, the <strong class="bold">Features</strong> screen has an option with the ability to show multiple views in separate windows. The <strong class="bold">Services</strong> screen has two identity-related options: <strong class="bold">Forced Login</strong> and <strong class="bold">Optional Login</strong>. Finally, the <strong class="bold">Testing</strong> screen has seven different options, rather than just <strong class="bold">MSTest</strong>. The additional<a id="_idIndexMarker780"/> testing <a id="_idIndexMarker781"/>frameworks provided <a id="_idIndexMarker782"/>are <strong class="bold">NUnit</strong>, <strong class="bold">xUnit</strong>, and <strong class="bold">Appium</strong> (for UI tests), and there are options to add test projects for the main project and the <strong class="bold">Core</strong> library project.</p>
			<p>The generated projects have the same folder structure as the WinUI projects. Here’s an example of a generated WPF project with an empty ribbon control:</p>
			<div><div><img src="img/B20908_10_16.jpg" alt="Figure 10.16 – A WPF project created by Template Studio"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.16 – A WPF project created by Template Studio</p>
			<p>Let’s finish up by taking a look at the Template Studio wizard provided by the Uno Platform extension.</p>
			<h2 id="_idParaDest-217"><a id="_idTextAnchor326"/>Template Studio for Uno Platform</h2>
			<p><strong class="bold">Uno Platform</strong> (<a href="https://platform.uno/">https://platform.uno/</a>) is a <a id="_idIndexMarker783"/>UI framework that uses WinUI XAML and .NET code, and it<a id="_idIndexMarker784"/> can create applications to target virtually every available <a id="_idIndexMarker785"/>device platform today: Windows, iOS, Android, macOS, Tizen, web (with <strong class="bold">WebAssembly</strong>), and even Linux. The<a id="_idIndexMarker786"/> Uno Platform extension for Visual Studio (<a href="https://marketplace.visualstudio.com/items?itemName=unoplatform.uno-platform-addin-2022">https://marketplace.visualstudio.com/items?itemName=unoplatform.uno-platform-addin-2022</a>) includes a new project wizard that is based on the Template Studio code.</p>
			<p>If you install the extension in Visual Studio and create a new project with the <strong class="bold">Uno Platform App</strong> template, clicking the <strong class="bold">Create</strong> button from the <strong class="bold">Configure your new project</strong> screen will launch the wizard:</p>
			<div><div><img src="img/B20908_10_17.jpg" alt="Figure 10.17 – The Uno Platform new project screen"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.17 – The Uno Platform new project screen</p>
			<p>From here, you can<a id="_idIndexMarker787"/> simply select <strong class="bold">Create</strong> to accept all the defaults and generate a new solution. However, if you select the <strong class="bold">Customize</strong> button on the <strong class="bold">Default</strong> startup type, you will get the full wizard experience:</p>
			<div><div><img src="img/B20908_10_18.jpg" alt="Figure 10.18 – The Uno Platform new project wizard"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.18 – The Uno Platform new project wizard</p>
			<p>From here, you can <a id="_idIndexMarker788"/>select from options in 10 different categories. Even though the wizard is styled a bit differently, you can see that it has the same origins as the Template Studio extensions. We will get into the details of each step of the wizard when we build an Uno Platform app in <a href="B20908_13.xhtml#_idTextAnchor570"><em class="italic">Chapter 13</em></a>, <em class="italic">Take Your App Cross-Platform with Uno Platform</em>. If you create a new Uno Platform project with the defaults and run the <strong class="bold">UnoApp1.Wasm</strong> project, you’ll see your app running in the browser by leveraging WebAssembly:</p>
			<div><div><img src="img/B20908_10_19.jpg" alt="Figure 10.19 – Running an Uno Platform app in the browser"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.19 – Running an Uno Platform app in the browser</p>
			<p>That’s very cool! Now let’s wrap up and review what we’ve learned in this chapter.</p>
			<h1 id="_idParaDest-218"><a id="_idTextAnchor327"/>Summary</h1>
			<p>In this chapter, we learned how the Template Studio for WinUI extension can save time and promote good patterns and practices when starting a new WinUI project. We stepped through the creation of a new WinUI project with the wizard and explored the generated code in the new solution. Understanding the structure and purpose of the solution’s components will make it easier to extend it for your own projects. We wrapped things up by discussing the Template Studio extensions that are available for other UI frameworks such as WPF and Uno Platform.</p>
			<p>In the next chapter, <a href="B20908_11.xhtml#_idTextAnchor330"><em class="italic">Chapter 11</em></a>, <em class="italic">Debugging WinUI Apps with Visual Studio</em>, we will explore the tools and options provided by Visual Studio to make .NET and XAML developers’ lives easier.</p>
			<h1 id="_idParaDest-219"><a id="_idTextAnchor328"/>Questions</h1>
			<ol>
				<li>Which unit test framework is used when creating a test project in Template Studio for WinUI?</li>
				<li>Which project type in Template Studio for WinUI implements a <code>NavigationView</code> control?</li>
				<li>What was the previous name of Template Studio for UWP?</li>
				<li>Which MVVM framework is used by Template Studio for WinUI when generating a project?</li>
				<li>What file format is used for Visual Studio extensions?</li>
				<li>Which Template Studio extension could you use to create a new project if you needed to include Linux as one of your target platforms?</li>
				<li>Which folder contains all the interfaces for the main project generated by Template Studio for WinUI?</li>
			</ol>
		</div>
	

		<div><h1 id="_idParaDest-220" lang="en-US" xml:lang="en-US"><a id="_idTextAnchor329"/>Part 3:Build and Deploy on Windows and Beyond</h1>
			<p>This part rounds out your WinUI knowledge by exploring techniques to debug, build, and deploy WinUI 3 applications. You will explore the extensive debugging tools Visual Studio has to offer WinUI developers. Then, you will see how you can host a web application inside a WinUI application, leveraging Blazor, Visual Studio Code, GitHub Actions, and the WebView2 control. We’ll also learn how to migrate a WinUI project to Uno Platform to run on multiple platforms, including Android and the web with WebAssembly. Finally, you’ll learn about the options to build and deploy WinUI applications with Visual Studio, the Microsoft Store, and Microsoft’s command-line installer, Windows Package Manager (WinGet).</p>
			<p>This part has the following chapters:</p>
			<ul>
				<li><a href="B20908_11.xhtml#_idTextAnchor330"><em class="italic">Chapter 11</em></a>, <em class="italic">Debugging WinUI Applications with Visual Studio</em></li>
				<li><a href="B20908_12.xhtml#_idTextAnchor454"><em class="italic">Chapter 12</em></a>, <em class="italic">Hosting a Blazor Application in WinUI</em></li>
				<li><a href="B20908_13.xhtml#_idTextAnchor570"><em class="italic">Chapter 13</em></a>, <em class="italic">Take Your App Cross-Platform with Uno Platform</em></li>
				<li><a href="B20908_14.xhtml#_idTextAnchor582"><em class="italic">Chapter 14</em></a>, <em class="italic">Packaging and Deploying WinUI Applications</em></li>
			</ul>
		</div>
		<div><div></div>
		</div>
		<div><div></div>
		</div>
	</body></html>