<html><head></head><body><div><div><div><div><h1 class="title"><a id="ch04"/>Chapter 4. Comparing Approaches for Programming</h1></div></div></div><p>Up until this point, we have centered upon the C# language and its evolution. However, this evolution is not the only one in .NET framework as far as languages are concerned. Other languages have kept evolving as well (and this is independent of the fact that many more compilers have increased the list of languages for which there is a .NET version nowadays). Especially, there are two members of the .NET language ecosystem, F# and TypeScript, which are becoming increasingly popular among the programmer community, and we're going to—briefly—introduce them in this chapter.</p><p>Consequently, we will review some of the most relevant aspects of both languages, with C# as a reference in both cases.</p><p>With this goal, our purpose is to roughly underline the most crucial programming structures in such a way that you can establish a comparison between the ways you code usual and everyday programming tasks but using different languages.</p><p>I'd like to add a note about VB.NET and why I'm not including it here. Even considering that VB.NET has evolved in parallel with the rest of the languages of the .NET ecosystem, (and VB.NET followers, please forgive me, but this is a tendency that most of you must have noticed<a id="id351" class="indexterm"/> for sure), the truth is that there's more hype around F# and JavaScript languages (and TypeScript, for that matter).</p><p>That tendency is especially clear when we talk about future expectations. VB.NET users can be confident that while Microsoft doesn't say the opposite, VB.NET will keep on running as expected, and will be a language of the previously mentioned language's ecosystem, with all the goodness and advantages that a developer is used to find inside Visual Studio.</p><p>Going back to F# and TypeScript, both have something in common: they belong to the category of functional languages (although TypeScript uses classes, which later on "compile" to functions). The first one will serve us as a comparison with C#, since it's a compiled language, unlike TypeScript, which is an interpreted language.</p><div><h3 class="title"><a id="note17"/>Note</h3><p>The list of functional languages<a id="id352" class="indexterm"/> of all types keeps on growing. Wikipedia maintains a pretty comprehensive list of most of them at <a class="ulink" href="https://en.wikipedia.org/wiki/Category:Functional_languages">https://en.wikipedia.org/wiki/Category:Functional_languages</a>.</p></div><p>So, we'll review the differences between both approaches to programming and identify those programming structures that are intended to obtain the same results, each one expressed in its own style. Also, note that there are a number of applications out there to solve problems (especially mathematical and engineering ones) with an implementation of an F# DLL, since possibilities increase with every version as the language grows.</p><p>On the other hand, the continuous growth of TypeScript adoption has been clearly stated with the announcement by Google that TypeScript has been the language used in the building of their new version of the Angular framework (Angular 2.0), available since September 2016. That's a quite unexpected collaboration!</p><p>In this chapter, we will cover the following topics:</p><div><ul class="itemizedlist"><li class="listitem">Foundations of functional languages</li><li class="listitem">F# as a fully functional language</li><li class="listitem">Equivalence of typical programming structures</li><li class="listitem">Support in Visual Studio</li><li class="listitem">TypeScript inception and main purposes</li><li class="listitem">Basic structures and programming characteristics</li><li class="listitem">TypeScript support in Visual Studio</li></ul></div><div><div><div><div><h1 class="title"><a id="ch04lvl1sec22"/>Functional languages</h1></div></div></div><p>A functional language is <a id="id353" class="indexterm"/>one that avoids changing the state and mutable data and mainly focuses its statements on the evaluation of code as mathematical functions. So, the entire programming experience is based on functions (or procedures) to construct its program flow.</p><p>Note how different this approach is from object-oriented languages for whom everything is an object (some OOP languages have primitive types, such as Java, but, in general, types can always be considered objects).</p><p>The next graphic shows some popular Imperative Languages as opposed to pure Functional Languages and the place F# (and Scala) occupy between the two models.</p><p>With that in mind, the flow of the program's goal keeps declaring functions that relate or base themselves in other functions until the goal is reached:</p><div><img src="img/image00483.jpeg" alt="Functional languages"/></div><p style="clear:both; height: 1em;"> </p><p>A functional language does not have the side-effects of other imperative programming languages since the state does not change and the same call will return the same results as long as the function calls are<a id="id354" class="indexterm"/> made with the same arguments. Eliminating these kinds of side-effects can make the behavior much more predictive, and that's precisely one of the most important motivations for their use.</p><p>However, this advantage also implies a consideration: not all programs can be developed without these effects, especially those that require changing the state and the creation of I/O procedures.</p><p>Functional programming, as a discipline, has its roots in <em>Lambda Calculus</em>, originally developed as a formal system to express computation in terms of function abstractions, and it was first developed by Alonzo Church in the late twenties in the context of research on the foundations of mathematics.</p><p>Two points should be noted here:</p><div><ol class="orderedlist arabic"><li class="listitem">Lambda Calculus is a universal <a id="id355" class="indexterm"/>model of computation equivalent to the <em>Turing Machine</em>, as stated by Wikipedia. Furthermore, Turing himself refers to this work in his seminal paper on State Machines. There are interesting works that relate to both and explain their differences, although they're not the goal of this chapter.</li><li class="listitem">Even considering they're not the same as the lambda expressions we've seen so far in the C# language, there's a direct connection given that the Lambda Terms or Lambda<a id="id356" class="indexterm"/> Expressions used in Lambda Calculus refer to binding a <a id="id357" class="indexterm"/>variable in a function pretty much in the way we've seen in previous examples. For more information on Lambda Calculus, refer to <a class="ulink" href="https://en.wikipedia.org/wiki/Lambda_calculus">https://en.wikipedia.org/wiki/Lambda_calculus</a>.</li></ol><div></div><div><div><div><div><h2 class="title"><a id="ch04lvl2sec53"/>F# 4 and .NET Framework</h2></div></div></div><p>The first version of the F# language showed up in 2005, although it was something that you had to download and<a id="id358" class="indexterm"/> install separately. The language evolution process was originally managed by Don Syme from Microsoft Research, although <a id="id359" class="indexterm"/>nowadays, it uses an open development and engineering process, basically monitored by the F# Software Foundation, founded in 2013, which became a 501C3 nonprofit organization in 2014.</p><p>Actually, the current version is 4.0, and it appeared in January 2016 along with several improvements in the tooling linked to <a id="id360" class="indexterm"/>Visual Studio. However, support for F# programming <a id="id361" class="indexterm"/>can be found also<a id="id362" class="indexterm"/> in <strong>Xamarin Studio</strong>, <strong>Mono</strong>, <strong>MonoDevelop</strong>, <strong>SharpDevelop</strong>, <strong>MBrace</strong>, and <strong>WebSharper</strong>.</p><p>According to<a id="id363" class="indexterm"/> <strong>Syme</strong>, F# originated from ML and<a id="id364" class="indexterm"/> has<a id="id365" class="indexterm"/> influences from other <a id="id366" class="indexterm"/>functional languages, mainly from <strong>OCaml</strong>, <strong>C#</strong>, <strong>Python</strong>, <strong>Haskell</strong>, <strong>Scala</strong>, and <strong>Erlang</strong>. To be<a id="id367" class="indexterm"/> more precise, Syme explains that from the syntactic point <a id="id368" class="indexterm"/>of view, the main influence comes from OCaml, while the object<a id="id369" class="indexterm"/> model aspect is inspired from C# and .NET.</p><p>F# is defined as a <a id="id370" class="indexterm"/>strongly typed, multi-paradigm, <a id="id371" class="indexterm"/>and functional-first programming language that <a id="id372" class="indexterm"/>encompasses functional, imperative, and object-oriented programming techniques.</p><p>It uses type inference from its inception in the way we've already seen from version 3.0 in C# when using the <code class="literal">var</code> keyword. However, F# admits explicit type annotations, and it requires it in certain situations. However, exceptions apart, every expression in F# is linked to a static type. If the function or expression doesn't return any value, the return type is named <code class="literal">unit</code>.</p><div><div><div><div><h3 class="title"><a id="ch04lvl3sec32"/>The inevitable Hello World demo</h3></div></div></div><p>So, let's start with the <a id="id373" class="indexterm"/>mandatory Hello World program, but first, keep in mind that you will have to activate F# tools in Visual Studio if you did not do that at installation time. (If you didn't, when accessing the F# language section, you'll be offered this activation.) Once activation is ready, you will be presented with a new type of project linked to this language in the way shown in the following screenshot:</p><div><img src="img/image00484.jpeg" alt="The inevitable Hello World demo"/></div><p style="clear:both; height: 1em;"> </p><p>To start with, you <a id="id374" class="indexterm"/>can pick up the tutorial, which is a comprehensive collection of the different aspects of the language— it's pretty well structured—or just use a console application for that matter.</p><p>If you opt for the tutorial, you can mark a section of the code you want to test, and if you right-click on that area, you'll be presented with two options for execution: <strong>Execute In Interactive</strong> and <strong>Debug In Interactive</strong>:</p><div><img src="img/image00485.jpeg" alt="The inevitable Hello World demo"/></div><p style="clear:both; height: 1em;"> </p><p>To visualize the<a id="id375" class="indexterm"/> results, we can—of course—create an executable and launch it in a console window, but for this scenario, F# Interactive Window is more suitable. For completeness, keep in mind that you can call the compiler (named <code class="literal">fsc.exe</code>) using the <strong>build</strong> option in Visual Studio just like you would with any other project.</p><p>So, we'll start with writing very simple code:</p><div><pre class="programlisting">let a = 1 + 2
let b = a * 3
printfn "Expression a equals to %i" a
printfn "Expression b equals to %i" b
printfn "So, expression b (%i) depends on a (%i)" b a</pre></div><p>This generates the following output in the <strong>F# Interactive</strong> window:</p><div><img src="img/image00486.jpeg" alt="The inevitable Hello World demo"/></div><p style="clear:both; height: 1em;"> </p><p>Here, we've done the following:</p><div><ol class="orderedlist arabic"><li class="listitem">First, we used the <code class="literal">let</code> keyword in order to assign an arithmetic expression to variable <code class="literal">a</code>.</li><li class="listitem">Then, we used the same keyword for another variable, variable <code class="literal">b</code>, which uses the previous <a id="id376" class="indexterm"/>definition.</li><li class="listitem">Finally, the <code class="literal">printfn</code> function of the F# library produced an output to the standard I/O, formatting the result in a manner similar to what we do in C#, just changing the <code class="literal">{0}..{1}</code> and so on, expressions into <code class="literal">%i</code> or the letter corresponding to the type of the value to be printed (<code class="literal">f</code> for float, <code class="literal">s</code> for strings, <code class="literal">d</code> for double, <code class="literal">A</code> for generic printing including arrays and tuples, and so on).</li></ol><div></div><p>Note how the interactive window presents an echo of the members implied in the process, indicating its type as well.</p><p>Keep in mind that since F# is considered another member of the Visual Studio family, it has its own area of configuration in the <strong>Tools/Properties</strong> dialog box, as shown in the next screenshot. In addition, another entry in this dialog allows you to configure behaviors of the <strong>F# Interactive</strong> window:</p><div><img src="img/image00487.jpeg" alt="The inevitable Hello World demo"/></div><p style="clear:both; height: 1em;"> </p></div><div><div><div><div><h3 class="title"><a id="ch04lvl3sec33"/>Identifiers and scope</h3></div></div></div><p>The scope of an identifier indicates the area of code where such an identifier is usable. All identifiers, either functions or values, are scoped (valid) starting at the end of their definition until the end<a id="id377" class="indexterm"/> of the section in which they act. Additionally, in F#, you don't have to explicitly return any value, since the result of the computation is automatically assigned the corresponding identifier.</p><p>So, in order to create intermediate<a id="id378" class="indexterm"/> values for a computation, you denote it with indentation (by convention, the size of the indentation is 4, but the user can opt for any other value). Every indentation defines a new scope, and the end of every scope is marked by the end of the indentation. For example, let's think of a function to calculate the hypotenuse of a right triangle:</p><div><pre class="programlisting">let hypo (x:float) (y:float) =
  let legsSquare = x*x + y*y
// System.Math.Sqrt(legsSquare)
sqrt(legsSquare) // an alias of the former
printfn "The hypotenuse for legs 3 and 4 is: %f" (hypo 3.0 4.0)</pre></div><p>First, we define the <code class="literal">hypo</code> function, which receives two arguments of type <code class="literal">float</code> (note that we can explicitly indicate types with the syntax <code class="literal">arg:type</code>). Then, we declare <code class="literal">legsSquare</code> to be the sum of the squares of both triangle's legs, and this is done with a new level of indentation. Finally, we just calculate the square root of this intermediate variable without any other indication, which means that <code class="literal">System.Math.Sqrt(legsSquare)</code> is the return value.</p><p>Also, note how we <a id="id379" class="indexterm"/>make a reference to <code class="literal">System.Math</code> directly since it's included in the references of the <a id="id380" class="indexterm"/>project. Alternatively, you can use the <code class="literal">open</code> keyword to indicate a reference to <code class="literal">System</code> (such as <code class="literal">open System</code>), and then, you can use the <code class="literal">Math</code> static class in an unqualified way.</p><p>Finally, we call <code class="literal">printfn</code> to format the output and make sure there's only one value to include in the formatted output string by enclosing the call to <code class="literal">hypo</code> in the parenthesis.</p><p>Of course, the <strong>F# Interactive</strong> window will show the formatted result, as is expected:</p><div><img src="img/image00488.jpeg" alt="Identifiers and scope"/></div><p style="clear:both; height: 1em;"> </p></div><div><div><div><div><h3 class="title"><a id="ch04lvl3sec34"/>Lists</h3></div></div></div><p>In F#, lists are ordered collections of immutable<a id="id381" class="indexterm"/> elements of the same type. Its generation admits many<a id="id382" class="indexterm"/> language-compatible options, but the initial style is very simple. If you go through the tutorial a bit, you'll discover the following declaration:</p><div><pre class="programlisting">/// A list of the numbers from 0 to 99
let sampleNumbers = [ 0 .. 99 ]</pre></div><p>Here, you are introduced to the range operator: (<code class="literal">..</code>), which denotes a sequence of elements deductible for the compiler. Due to the echo feature of the Interactive window, we just have to mark that line and select <strong>Interactive Window</strong> to view the results:</p><div><img src="img/image00489.jpeg" alt="Lists"/></div><p style="clear:both; height: 1em;"> </p><p>The range operator <a id="id383" class="indexterm"/>also admits the increment descriptor (..), allowing you to define a different, collective type, called sequence (<code class="literal">seq</code>) that supports many of the same functions as lists:</p><div><pre class="programlisting">seq {5..3..15}</pre></div><p>Here, we define a sequence of elements starting with <code class="literal">5</code>, going through <code class="literal">15</code>, and increasing in steps of three (the output being the following):</p><div><pre class="programlisting">val it : seq&lt;int&gt; = seq [5; 8; 11; 14]</pre></div><p>In the same manner as earlier, let's mark the following sentence and proceed:</p><div><pre class="programlisting">let sampleTableOfSquares = [ for i in 0 .. 99 -&gt; (i, i*i) ]</pre></div><p>An array of tuples is created, each containing a number from 0 to 99 and its corresponding squares. There are a few things to notice in this sentence.</p><p>Assigning something in squared brackets means that the expression inside it should be evaluated to an array (similar to JavaScript). We've seen this in the previous sentence as well, but this time, inside the brackets, we see a <code class="literal">for..in</code> loop and a <code class="literal">-&gt;</code> symbol, which indicate the generated value for each step in the loop.</p><p>This generated value turns out to be a tuple, since it's enclosed in parenthesis—a very powerful and expressive syntax.</p><p>List objects contain several useful methods to manipulate their inner collections. One of them is <code class="literal">List.map</code>, which permits you to apply a function to each element in the list and returns a new list with the calculated results.</p><p>It's important to note how close the philosophy of this approach reminds what we saw in C# when using generic's collections and passing a lambda expression to their methods.</p><p>For example, we can write the following:</p><div><pre class="programlisting">let initialList = [9.0; 4.0; 1.0]
let sqrootList = List.map (fun x -&gt; sqrt(x)) initialList

printfn "Square root list: %A" sqrootList</pre></div><p>Here, <code class="literal">initialList</code> contains three float numbers, for which we want to calculate the square root. So, we generate another list (<code class="literal">sqrootList</code>) by calling <code class="literal">List.map</code> and passing to it as an argument an<a id="id384" class="indexterm"/> anonymous function that gets a value and returns its square root. The last argument is <code class="literal">initialList</code>. Note that the argument of <code class="literal">map</code> is just like a lambda expression.</p><p>Once more, the output in the <strong>F# Interactive</strong> windows is as expected:</p><div><img src="img/image00490.jpeg" alt="Lists"/></div><p style="clear:both; height: 1em;"> </p><div><div><div><div><h4 class="title"><a id="ch04lvl4sec06"/>Function declarations</h4></div></div></div><p>We've seen how to use anonymous functions and how they can be passed as arguments to some methods. To <a id="id385" class="indexterm"/>declare a named function, you can use a similar syntax as what you used with variables but by specifying the arguments it can receive, following the function's name:</p><div><pre class="programlisting">let func1 x = x*x + 3</pre></div><p>This time, <code class="literal">func1</code> is the name of the function, and <code class="literal">x</code> the argument to be passed, which can, optionally, be enclosed in parenthesis. Later on, we can combine the previous declaration with an assignment to a variable, which you can see if you continue to analyze this code:</p><div><pre class="programlisting">let result1 = func1 4573
printfn "The result of squaring the integer 4573 and adding 3 is %d" result1</pre></div><p>Also, remember that arguments can be annotated (indicating its type explicitly):</p><div><pre class="programlisting">let func2 (x:int) = 2*x*x - x/5 + 3</pre></div><p>When we need to indicate code structures inside the function, we will use indentation the way we saw in a<a id="id386" class="indexterm"/> previous sample along with the required expression to be evaluated (and that's what <code class="literal">func3</code> does here):</p><div><pre class="programlisting">let func3 x =
  if x &lt; 100.0 then
    2.0*x*x - x/5.0 + 3.0
  else
    2.0*x*x + x/5.0 - 37.0</pre></div><p>Note the difference between lists in relation with tuples, which are defined enclosed in parenthesis. Furthermore, a list can be generated using expressions that include loops, as you can see in the following code, which uses such a construction:</p><div><pre class="programlisting">let daysList =
  [ for month in 1 .. 12 do
  for day in 1 .. System.DateTime.DaysInMonth(2012, month) do
    yield System.DateTime(2012, month, day) ]</pre></div><p>Here, we have two <code class="literal">for</code> loops nested using the <code class="literal">for..in..do</code> syntax. Also, note the presence of the <code class="literal">yield</code> keyword, just like in C#. The previous code generates the following output:</p><div><img src="img/image00491.jpeg" alt="Function declarations"/></div><p style="clear:both; height: 1em;"> </p><p>And the list goes on...</p></div><div><div><div><div><h4 class="title"><a id="ch04lvl4sec07"/>The pipeline operator</h4></div></div></div><p>Another important feature of F# is<a id="id387" class="indexterm"/> the pipeline operator (<code class="literal">|&gt;</code>). It serves to pass a value to a function but by <em>piping</em> the result. The definition is simple:</p><div><pre class="programlisting">let (|&gt;) x f = f x</pre></div><p>This means: take a parameter <code class="literal">x</code> and apply it to function <code class="literal">f</code>. In this way, the parameter is passed before the function and we can express chains of calculations in a very suitable manner. For instance, we can define a sum function and use it this way:</p><div><pre class="programlisting">let sum a b = a + b
let chainOfSums = sum 1 2 |&gt; sum 3 |&gt; sum 4</pre></div><p>After the execution, we'll obtain a value of 10 for <code class="literal">chainOfSums</code>. For example, consider that we have the following code:</p><div><pre class="programlisting">let numberList = [ 1 .. 1000 ]  /// list of integers from 1 to 1000
let squares = numberList
  |&gt; List.map (fun x -&gt; x*x)</pre></div><p>This means, take <code class="literal">numberList</code>, apply it to <code class="literal">List.map</code> of the function enclosed in parentheses (which calculates the square of every number in the list), and assign the result to the squares identifier.</p><p>If we need to link several <a id="id388" class="indexterm"/>operations in a sequence over the same collection, we can concatenate the operator, as the next sample in the tutorial shows:</p><div><pre class="programlisting">/// Computes the sum of the squares of the numbers divisible by 3.
let sumOfSquares = numberList
|&gt; List.filter (fun x -&gt; x % 3 = 0)
|&gt; List.sumBy (fun x -&gt; x * x)</pre></div></div><div><div><div><div><h4 class="title"><a id="ch04lvl4sec08"/>Pattern matching</h4></div></div></div><p>Another useful structure when managing collections is the <code class="literal">match..with</code> construct. It's used with the <code class="literal">|</code> operator to<a id="id389" class="indexterm"/> indicate different options, much like what we would do in a <code class="literal">switch</code> and <code class="literal">case</code> statement in C#.</p><p>To test this in simple way, let's try the typical recursive function to calculate the factorial of a number:</p><div><pre class="programlisting">let rec factorial n = match n with
  | 0 -&gt; 1
  | _ -&gt; n * factorial (n - 1)
let factorial5 = factorial 5</pre></div><p>Note the presence of the <code class="literal">rec</code> keyword as a modifier of the function's declaration in order to indicate that the function is recursive. The variable to test (<code class="literal">n</code>) goes in between the <code class="literal">match..with</code> structure and the <code class="literal">|</code> operator separates the distinct cases to be tested. Also, look at how the underscore operator (<code class="literal">_</code>) is used to indicate what to do with any other value.</p><p>The <strong>F# Interactive</strong> window, once more, will show the correct results:</p><div><img src="img/image00492.jpeg" alt="Pattern matching"/></div><p style="clear:both; height: 1em;"> </p></div><div><div><div><div><h4 class="title"><a id="ch04lvl4sec09"/>Classes and types</h4></div></div></div><p>F# can work well with classes <a id="id390" class="indexterm"/>and types, and by itself, it is considered a typed language. Actually, you can declare elements of any supported type using type abbreviations and type definitions.</p><p>In the first case, we just establish aliases of existing types. You can declare these aliases using the <code class="literal">type</code> keyword followed by an identifier (the alias) and assign it to the type it represents:</p><div><pre class="programlisting">type numberOfEntries = int
type response = string * int</pre></div><p>Note that the second definition declares a new type construct made of two parts (<code class="literal">string</code> and <code class="literal">int</code>) that can be used later on.</p><p>The most common usage of types is to declare type definitions, indicating members as pairs of values (<code class="literal">key : type</code>) enclosed in curly braces, as the <code class="literal">RecordTypes</code> module of the tutorial reminds us (we reproduce it here):</p><div><pre class="programlisting">// define a record type
type ContactCard =
  { Name     : string;
    Phone    : string;
    Verified : bool }
  let contact1 = { Name = "Alf" ; Phone = "(206) 555-0157" ; Verified = false }</pre></div><p>If we launch the previous code in the <strong>F# Interactive</strong> window, we will get the following:</p><div><img src="img/image00493.jpeg" alt="Classes and types"/></div><p style="clear:both; height: 1em;"> </p><p>As you can see, the <code class="literal">contact1</code> identifier is qualified as <code class="literal">val (value)</code>. This value can also be used to <a id="id391" class="indexterm"/>declare further types based on the previous one. This is the purpose of the following declaration in the tutorial:</p><div><pre class="programlisting">let contact2 = { contact1 with Phone = "(206) 555-0112"; Verified = true }</pre></div><p>In this case, <code class="literal">contact2</code> is based on <code class="literal">contact1</code>, but there are two changed values.</p><p>The next definition makes things quite clear as well:</p><div><pre class="programlisting">/// Converts a 'ContactCard' object to a string
let showCard c =
  c.Name + " Phone: " + c.Phone + (if not c.Verified then " (unverified)" else "")</pre></div><p>This is used to convert the <code class="literal">ContactCard</code> type into a string as we check the output in the <strong>F# Interactive</strong> window after adding another sentence to test the output:</p><div><pre class="programlisting">let stringifyedCard = showCard contact1</pre></div><p>The following screenshot shows the output generated:</p><div><img src="img/image00494.jpeg" alt="Classes and types"/></div><p style="clear:both; height: 1em;"> </p></div><div><div><div><div><h4 class="title"><a id="ch04lvl4sec10"/>Casting</h4></div></div></div><p>In F#, casting sentences<a id="id392" class="indexterm"/> have their own specific operators. The two possible operations depend on the type of casting required (downcasting if you go from general to particular in the hierarchy, or upcasting if you proceed in the opposite way). As it happens, with C#, the hierarchy starts with <code class="literal">System.Object</code>, although there is an alias, <code class="literal">obj</code>, which we can use in its place.</p><p>As for the behavior in relation to the compiler, let's remember that upcasting is a safe operation because the compiler always knows the ancestors of the type to be converted. It is represented by a colon, followed by a greater-than sign (<code class="literal">:&gt;</code>). For example, the following operation is legitimate:</p><div><img src="img/image00495.jpeg" alt="Casting"/></div><p style="clear:both; height: 1em;"> </p><p>As we can see, the <code class="literal">someObject</code> identifier is declared in parenthesis as the result of a conversion from a literal string to <code class="literal">obj</code>. As a result, in the next sentence, Intellisense in V. Studio reminds us that <code class="literal">System.Object</code> declares exactly those members that appear in the contextual menu.</p></div></div></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch04lvl1sec23"/>The TypeScript language</h1></div></div></div><p>For the last 5 or 6 years, there<a id="id393" class="indexterm"/> has been a growing hype around the languages used to build websites and web applications. As you surely know, the reason was mainly related to the proliferation of mobile devices of all types: tablets, phones, IoT devices, and so on.</p><p>Parallel to this, back in 2008, a new effort for <a id="id394" class="indexterm"/>standardization emerged at the W3C (<a class="ulink" href="http://www.w3.org">http://www.w3.org</a>, the entity that takes care of most of the Internet language's specs) in order to update these languages of the Web and make them more suitable for this decade's needs. Announcements like the elimination of Flash components (or Silverlight, for that matter) on platforms such as MacOS or iOS only fostered these attempts.</p><p>For the first time in many years, a bunch of companies invested in the creation of this new Open Web that would be capable of holding any kind of content in a flexible, adaptable, easy-to-use, and responsive way.</p><p>All these efforts came to an end in 2015, with <a id="id395" class="indexterm"/>the final recommendation of HTML5 (<a class="ulink" href="https://www.w3.org/TR/html5/">https://www.w3.org/TR/html5/</a>) along with a number of specifications related to the CSS3 presentation syntax (it's not a language, remember). They adopted a <em>most-needed</em> approach in the writing and testing process, starting with those whose implementation was a due requirement, such as Media Queries (very important in mobile devices, as you know).</p><p>Finally, the expected new version of the JavaScript <a id="id396" class="indexterm"/>language was published by ECMA (<a class="ulink" href="http://www.ecma-international.org/">http://www.ecma-international.org/</a>) and it received the name ECMAScript 2015 (previously named ES6 in the specification and testing processes).</p><p>Important decisions were taken in the creation of the HTML, CSS, and JavaScript standards: preserving backward compatibility, applying good practices and principles (such as the S.O.L.I.D. principles), and above all, making these specifications <em>a continuous process of development and integration, for which the consensus of companies is key</em>. So, after this first release of the specifications, the work continued in all these areas, except now, engineers of the main user agents' manufacturers collaborated directly with W3C and ECMA in order to make the HTML, CSS, and JavaScript engines faster, more reliable, and up to date. The most evident applications that came up as a result are generally called modern browsers.</p><div><div><div><div><h2 class="title"><a id="ch04lvl2sec54"/>The new JavaScript</h2></div></div></div><p>So, a new JavaScript <a id="id397" class="indexterm"/>was born, which included many of the features that were long awaited by developers, such as classes, interfaces, scope variables, packages (finally, the concept of namespace shows up in the language, eliminating the need for closures), and many more.</p><p>Along with the new requirements, a set of libraries (a big one, by the way) appeared to help the developer in their daily tasks (they're numbered by hundreds, of thousands today).</p><p>As a consequence, the JavaScript language appeared to be the number one preference according to quite a few<a id="id398" class="indexterm"/> developer surveys carried out last year. One was carried out by the most popular code reference website among developers<a id="id399" class="indexterm"/> today: StackOverflow, which researched and published it with quite insightful results; you can read it at <a class="ulink" href="http://stackoverflow.com/research/developer-survey-2015">http://stackoverflow.com/research/developer-survey-2015</a>.</p><p>The poll is very wide and covers a lot of different aspects, with thousands of developers having participated. The following figure showing the language's ranking is pretty important:</p><div><img src="img/image00496.jpeg" alt="The new JavaScript"/></div><p style="clear:both; height: 1em;"> </p><p>All this is great, but support for these features in browsers immediately became an important issue. Actually, support is insufficient and only a few browsers (the modern browsers, which we mentioned earlier), such as Chrome's latest versions, Microsoft Edge, and Firefox's recent updates, give enough coverage of the great amount of news and functionality proposed by the new standards.</p><p>To make matters even worse, versions of the same type of browser are not coincidental, since they might depend <a id="id400" class="indexterm"/>on the device we use to open a website. In order to finalize the list of problems linked to this situation, developers started to build big applications in which, not just dozens or hundreds but several thousands of lines of JavaScript were required.</p><p>So, the need for a new tool to build these sites and applications arose, and—once again—our admired Anders Hejlsberg decided to do something serious about it. The solution he proposed is called TypeScript.</p></div><div><div><div><div><h2 class="title"><a id="ch04lvl2sec55"/>TypeScript: a superset of JavaScript</h2></div></div></div><p>So, what's TypeScript and <a id="id401" class="indexterm"/>why is it a solution for these problems? The first question is <a id="id402" class="indexterm"/>answered on its own site at <a class="ulink" href="http://www.typescriptlang.org/">http://www.typescriptlang.org/</a>. TypeScript is, as the ineffable Wikipedia states:</p><div><blockquote class="blockquote"><p>Typescript is a free and open source programming language developed and maintained by Microsoft. It is a strict superset of JavaScript, and adds optional static typing and class-based object-oriented programming to the language. TypeScript may be used to develop JavaScript applications for client-side or server-side (Node.js) execution.</p></blockquote></div><p>And, how does TypeScript achieve these goals? Again, Wikipedia reminds us that:</p><div><blockquote class="blockquote"><p>TypeScript is designed for development of large applications and transcompiles to JavaScript. As TypeScript is a superset of JavaScript, any existing JavaScript programs are also valid TypeScript programs.</p></blockquote></div><div><img src="img/image00497.jpeg" alt="TypeScript: a superset of JavaScript"/></div><p style="clear:both; height: 1em;"> </p><p>So, we can start writing or use already existing JavaScript, knowing that it will be 100% compatible with older browsers. However, the term transcompiles requires a bit of explanation. Since JavaScript (any version of it) is an interpreted, functional language, the one in charge of its execution will always be the JavaScript runtime embedded in the browser or user agent.</p><p>So, transcompiling (or just<a id="id403" class="indexterm"/> transpiling, like most people call it) is the process of converting TypeScript code into pure JavaScript that can be interpreted correctly by browsers. The advantage is double: on the one hand, we can decide which version of JavaScript we want (JavaScript 3, 5, or 2015), and on the other hand, when used with a tool such as Visual Studio (or even Visual Studio Code, Emacs, Vim, Sublime Text, and Eclipse via a plug-in provided by Palantir Technologies, and so on), we'll get all the benefits of Intellisense, code completion, dynamic analysis, and so on.</p><p>Indeed, once those tools are configured, they can use Roselyn services to supply Intellisense, type inference, and all the goodness we all know and love from other languages. By convention (although it's not mandatory), TypeScript files have a <code class="literal">.ts</code> extension.</p></div><div><div><div><div><h2 class="title"><a id="ch04lvl2sec56"/>So, what exactly is TypeScript?</h2></div></div></div><p>The official answer to this question is that it is a superset of JavaScript that transpiles (generates after compilation) to valid JavaScript for whatever version you want to support: 3.0, 5.0 of ECMAScript 2015.</p><p>Furthermore, it allows you to work with features that won't be available until the next releases of the specification or—even if they are—features that are not yet supported in the majority of browsers.</p><p>Besides, the language starts with JavaScript, so any piece of JavaScript is also valid TypeScript. The big<a id="id404" class="indexterm"/> difference is that you work with a language that offers generally the same type of editing and compiling services that we've seen in this book related to Roslyn in particular: code completion, peek definitions, type checking, refactoring, code analysis, and so on.</p><div><div><div><div><h3 class="title"><a id="ch04lvl3sec35"/>Main features and coalitions</h3></div></div></div><p>Another main feature is that the<a id="id405" class="indexterm"/> project was built to comply with any browser, any host, and any operating system. Actually, the TypeScript transpiler is written in TypeScript.</p><p>To summarize, the two <a id="id406" class="indexterm"/>most important characteristics that this architecture provide are as follows:</p><div><ul class="itemizedlist"><li class="listitem">A whole set of tools enabled by static types</li><li class="listitem">The possibility of using features in the future, with the confidence that the resulting code will work in every browser (or server).</li></ul></div><p>With all these possibilities, a joint venture between Microsoft and Google appeared (to be precise, between the TypeScript team and Google's Angular Team) to work together in the new versions of Angular (2.0+).</p></div><div><div><div><div><h3 class="title"><a id="ch04lvl3sec36"/>Installing the tools</h3></div></div></div><p>As always, we recommend that <a id="id407" class="indexterm"/>you download and install the latest version of the library, which is accompanied by some project templates. These templates cover the use of TypeScript with Apache/Cordova, with Node.js, or plain HTML.</p><p>You will find the latest version of TypeScript by searching for its name in the <strong>Tools/Extensions and Updates</strong> menu. There's another way to install it, by visiting the official site for<a id="id408" class="indexterm"/> the language located at <a class="ulink" href="https://www.typescriptlang.org/">https://www.typescriptlang.org/</a>, which also contains extra documentation, demos, and a REPL to test code snippets online.</p><p>The current version that I'm using in this book is 1.8.4, but most likely, by the time the book is published, you'll have access to versions higher than 2.0. After accepting to download the installable file, you'll be presented with a confirmation dialog box like this:</p><div><img src="img/image00498.jpeg" alt="Installing the tools"/></div><p style="clear:both; height: 1em;"> </p><p>If you want to try a more<a id="id409" class="indexterm"/> complete and self-explanatory test of TypeScript, you can create a new project named <code class="literal">HTML Application</code> with TypeScript which you'll find in <code class="literal">Templates/TypeScript</code> after the previous installation.</p><p>The execution generates a web page, which shows a clock that changes the time every second. The review of the code structure is very informative:</p><div><pre class="programlisting">class Greeter {
  element: HTMLElement;
  span: HTMLElement;
  timerToken: number;

  constructor(element: HTMLElement) {
    this.element = element;
    this.element.innerHTML += "The time is: ";
    this.span = document.createElement('span');
    this.element.appendChild(this.span);
    this.span.innerText = new Date().toUTCString();
  }

  start() {
    this.timerToken = setInterval(
      () =&gt; this.span.innerHTML = new Date().toUTCString(), 500);
  }

  stop() {
    clearTimeout(this.timerToken);
  }
}

window.onload = () =&gt; {
  var el = document.getElementById('content');
  var greeter = new Greeter(el);
  greeter.start();
};</pre></div><p>As you can see, the <code class="literal">app.ts</code> file is defining a class (<code class="literal">Greeter</code>). The class has a state, defined using three fields, two of which relate to the user interface, so they are created as <code class="literal">HTMLElement</code>.</p><p>The <code class="literal">constructor</code> method is in charge of the initialization. It gets an <code class="literal">HTMLElement</code> argument and creates a new <code class="literal">&lt;span&gt;</code> element next to it in order to display the time every second after reading it from the system's time. The value is assigned to the <code class="literal">innerText</code> argument of <code class="literal">&lt;span&gt;</code>, so it shows the current time from the beginning.</p><p>Then, we have two methods: <code class="literal">start()</code> and <code class="literal">stop()</code>. The first uses a lambda and assigns the value of the <code class="literal">timerToken</code> field to a <code class="literal">setInterval</code> method, which receives a function to be called periodically. The return value is useful if you want to cancel the process at anytime, as we will do in slightly modifying the demo.</p><p>The result is shown in<a id="id410" class="indexterm"/> the <code class="literal">HTMLElement</code> interface linked to it; note that only one element in the user interface is involved: a <code class="literal">div</code> element with its ID <code class="literal">content</code>.</p><p>The mechanism that turns on the clock is expressed after the definition of the <code class="literal">Greeter</code> class. In the <code class="literal">onload</code> event, the content element is linked to a new instance of the <code class="literal">Greeter</code> class.</p><div><h3 class="title"><a id="note18"/>Note</h3><p>To summarize, the class' purpose is to define a behavior and associate that behavior with a part of the user interface.</p></div><p>We can stop the clock simply by including a button (or any other <code class="literal">HTMLElement</code> interface) and making a slight change in the TypeScript code:</p><div><pre class="programlisting">&lt;button id="btnStop"&gt;Stop Clock&lt;/button&gt;
window.onload = () =&gt; {
  // This links the UI to the JS code
  var el = document.getElementById('content');
  var btnStop = document.getElementById('btnStop');
  var greeter = new Greeter(el);
  // Now that Greeter is defined, we can use it
  // from the button to stop the clock
  btnStop.addEventListener("click", () =&gt; {
    greeter.stop();
    alert("Clock Stopped!");
  });
greeter.start();
};</pre></div><p>Since <code class="literal">stop()</code> is already defined, there's no need to change the <code class="literal">Greeter</code> class. We assign a call to the <code class="literal">stop()</code> method to the button's <code class="literal">click</code> event, and that's all that is required:</p><div><img src="img/image00499.jpeg" alt="Installing the tools"/></div><p style="clear:both; height: 1em;"> </p></div><div><div><div><div><h3 class="title"><a id="ch04lvl3sec37"/>Transpiling to different versions</h3></div></div></div><p>Visual Studio<a id="id411" class="indexterm"/> gives us the option to choose which version of JavaScript will be generated after the process of transpilation. You just have to go to <strong>Project</strong> | <strong>Properties</strong> and select the <strong>TypeScript Build</strong> tab. You'll learn how you're offered several options on how you would like the transpiler to behave. One of them shows a ComboBox with the available final JavaScript options.</p><p>Also, note that other options are available on JSX, managing comments, combining JavaScript, and so on in the way shown in the following screenshot:</p><div><img src="img/image00500.jpeg" alt="Transpiling to different versions"/></div><p style="clear:both; height: 1em;"> </p><p>A comparison of both files (<code class="literal">.ts</code> and <code class="literal">.js</code>) will make it clear how neat and concise (and object-oriented) the TypeScript code is in relation to the pure JavaScript.</p><p>However, the<a id="id412" class="indexterm"/> benefits don't end there. This is just the beginning, since most advantages are related to the creation process in the editor, Intellisense, type inference, and the like...</p></div><div><div><div><div><h3 class="title"><a id="ch04lvl3sec38"/>Advantages in the IDE</h3></div></div></div><p>When we pass the <a id="id413" class="indexterm"/>cursor over a definition of the previous code, observe how every element is recognized by its type: the class itself and its members:</p><div><img src="img/image00501.jpeg" alt="Advantages in the IDE"/></div><p style="clear:both; height: 1em;"> </p><p>It's not just about recognizing the initialization values. If we change a member's value in the code and assign it to a different (non-compatible) type, the IDE will complain about this circumstance again:</p><div><img src="img/image00502.jpeg" alt="Advantages in the IDE"/></div><p style="clear:both; height: 1em;"> </p><p>Even within <code class="literal">HTMLElements</code>, you can find this kind of Intellisense, since a walk over the <code class="literal">innerText</code> property of the<a id="id414" class="indexterm"/> <code class="literal">span</code> element will tell you that the property is a string value.</p><p>To end with this example and change the functionality so that we can stop the clock, we only need to add any suitable element in the UI and assign it a call to <code class="literal">Greeter.stop()</code>, for example, with the following code to the HTML file:</p><div><pre class="programlisting">&lt;!-- Button to stop the clock --&gt;
&lt;button id="btnStop"&gt;Press to stop the clock&lt;/button&gt;</pre></div><p>In the TypeScript code, the following is the <code class="literal">window.onload</code> assignment:</p><div><pre class="programlisting">var theButton = document.getElementById('btnStop');
theButton.onclick = () =&gt; {
  greeter.stop();
  theButton.innerText = "Clock stopped!";
}</pre></div><p>Just for the sake of completeness, I'm including the whole code of the TypeScript file after the proposed modification:</p><div><pre class="programlisting">class Greeter {
  element: HTMLElement;
  span: HTMLElement;
  timerToken: number;

  constructor(element: HTMLElement) {
    this.element = element;
    this.element.innerHTML += "The time is: ";
    this.span = document.createElement('span');
    this.element.appendChild(this.span);
    this.span.innerText = new Date().toUTCString();
  }

  start() {
    this.timerToken = setInterval(() =&gt; this.span.innerHTML =
    new Date().toUTCString(), 500);
  }

  stop() {
   clearTimeout(this.timerToken);
  }
}
window.onload = () =&gt; {
  var el = document.getElementById('content');
  var greeter = new Greeter(el);
  greeter.start();

  var theButton = document.getElementById('btnStop');
  theButton.onclick = () =&gt; {
    greeter.stop();
    theButton.innerText = "Clock stopped!";
  }
};</pre></div><p>This will work like a <a id="id415" class="indexterm"/>charm. So, we can follow the OOP paradigm, create classes, define interfaces, and so on and still be working with pure JavaScript.</p></div></div><div><div><div><div><h2 class="title"><a id="ch04lvl2sec57"/>A note on TypeScript's object-oriented syntax</h2></div></div></div><p>In this basic demo, the<a id="id416" class="indexterm"/> <code class="literal">Greeter</code> class is defined using the new <code class="literal">class</code> keyword available in ECMAScript 2015. You can declare a state for the class by defining its members, followed by the corresponding type—either it is another type (such as an <code class="literal">HTMLElement</code>) or a primitive type, such as <code class="literal">number</code>.</p><p>The constructor gets the element passed to it, assigns it a text, and creates a new <code class="literal">span</code> element that will be the receiver of every new string the <code class="literal">start()</code> method generates in order to update the current time. Once that span is initialized, the preliminary state of the class is ready to start working.</p><p>Later, two methods are<a id="id417" class="indexterm"/> defined: one to start the clock and another to stop it. Note that the clock is implemented using the <code class="literal">setInterval</code> function of JavaScript. The way to stop the interval process from keeping on running is by using a reference to the return value of that function. This is why <code class="literal">timerToken</code> is part of the class.</p><p>Also, observe the declaration of the callback function passed to <code class="literal">setInterval</code>, since it is another lambda expression, which creates a new string containing the current time every half second.</p><p>There's another important thing to note. How does the demo work if there's no <code class="literal">app.js</code> file yet? Well, if you press the <strong>Show all files</strong> button in the <strong>Solution Explorer</strong> menu, you'll see that an <code class="literal">app.js</code> file has indeed been created, and prototype inheritance has been used to define the functionality, only that it's been created using the JavaScript 3 syntax, thus allowing older browsers to work with it without incompatibilities.</p></div><div><div><div><div><h2 class="title"><a id="ch04lvl2sec58"/>More details and functionality</h2></div></div></div><p>Up to this point, we've seen another approach to programming, this time, linked to the browser's universal language. With TypeScript, Microsoft takes a major step forward in covering its ecosystem <a id="id418" class="indexterm"/>of languages, and many companies are adopting it as an advanced solution that allows programming today with tomorrow's languages, as proclaimed by its slogan.</p><p>In this introduction, our<a id="id419" class="indexterm"/> purpose was only to present the language and its main features and integration with Visual Studio. In <a class="link" title="Chapter 8. Open Source Programming" href="part0044.xhtml#aid-19UOO2">Chapter 8</a>, <em>Open Source Programming</em>, we'll cover more aspects of the language so you can have a better idea of its possibilities.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch04lvl1sec24"/>Summary</h1></div></div></div><p>We skimmed the surface of some of the most typical characteristics of the F# and TypeScript languages, which are now part of the .NET language ecosystem.</p><p>Both are functional languages, but—as you saw—the differences between them are evident. In the first case, we saw how declarations are made and understood the important role of operators in the language.</p><p>We also covered some of the most typical uses and looked for equivalent expressions in the C# language.</p><p>As for TypeScript, we saw how it has become a superset of JavaScript, allowing the programmer to work using an OOP coding style while still transpiling the resulting code in a way that provides backward browser compatibility, even reaching version 3 of the language.</p><p>We also explored the fundamental role that Visual Studio plays in editing this code, so we included some screenshots from the TypeScript Editor to prove this point. We'll see more about it in <a class="link" title="Chapter 8. Open Source Programming" href="part0044.xhtml#aid-19UOO2">Chapter 8</a>, <em>Open Source Programming</em>.</p><p>In the next chapter, we will go deeper into programmability using Reflection and Interop Applications, which allow us to use other well-known tools, such as the Microsoft Office Suite, directly in our applications.</p></div></body></html>