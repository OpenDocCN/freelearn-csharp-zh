# 前言

不久以前，典型的个人计算机 CPU 只有一个计算核心，其功耗足以在上面煎鸡蛋。2005 年，英特尔推出了其首款多核 CPU，从那时起，计算机开始向不同方向发展。低功耗和多个计算核心比单个计算核心的性能更重要。这导致了编程范式的变化。现在，我们需要学习如何有效地使用所有 CPU 核心以实现最佳性能，同时，我们还需要通过仅运行特定时间所需的程序来节省电池电量。除此之外，我们还需要以尽可能高效的方式编写服务器应用程序，使用多个 CPU 核心甚至多台计算机，以支持尽可能多的用户。

要能够创建这样的应用程序，你必须学会在程序中有效地使用多个 CPU 核心。如果你使用的是 Microsoft .NET 开发平台和 C#，这本书将是你编写快速响应应用程序的完美起点。

本书的目的是为你提供 C#中多线程和并行编程的逐步指南。我们将从基本概念开始，根据前几章的信息，逐步深入更高级的主题，并以实际世界的并行编程模式、通用 Windows 应用程序和跨平台应用程序示例结束。

# 本书涵盖的内容

第一章，*线程基础*，介绍了 C#中线程的基本操作。它解释了什么是线程，使用线程的优缺点，以及其他重要的线程方面。

第二章，*线程同步*，描述了线程交互的细节。你将了解为什么我们需要协调线程，以及组织线程协调的不同方式。

第三章，*使用线程池*，解释了线程池的概念。它展示了如何使用线程池，如何处理异步操作，以及使用线程池的优缺点。

第四章，*使用任务并行库*，深入探讨了任务并行库（TPL）框架。本章概述了 TPL 的每个重要方面，包括任务组合、异常管理和操作取消。

第五章，*使用 C# 6.0*，详细介绍了最近引入的 C#特性——异步方法。你将了解`async`和`await`关键字的意义，如何在不同的场景中使用它们，以及`await`是如何在底层工作的。

第六章, *使用并发集合*描述了.NET Framework 中包含的并行算法的标准数据结构。它为每个数据结构提供了示例编程场景。

第七章, *使用 PLINQ*深入探讨了 Parallel LINQ 基础设施。本章描述了任务并行和数据并行，并行化 LINQ 查询，调整并行选项，分区查询以及聚合并行查询的结果。

第八章, *响应式扩展*解释了何时以及如何使用响应式扩展框架。你将学习如何组合事件以及如何对事件序列执行 LINQ 查询。

第九章, *使用异步 I/O*详细介绍了异步 I/O 过程，包括文件、网络和数据库场景。

第十章, *并行编程模式*概述了常见并行编程问题的解决方案。

第十一章
{
  lock (lock1)
  {
    Sleep(1000);
    lock (lock2);
  }
}
```

任何命令行输入或输出都如下所示：

```cs
dotnet restore
dotnet run

```

**新术语**和**重要词汇**以粗体显示。你在屏幕上看到的单词，例如在菜单或对话框中，在文本中显示如下："在项目的**引用**文件夹上右键单击，并选择**管理 NuGet 包…**菜单选项"。

### 注意

警告或重要注意事项如下所示。

### 小贴士

小技巧和窍门如下所示。

# 读者反馈

我们始终欢迎读者的反馈。请告诉我们您对这本书的看法——您喜欢什么或可能不喜欢什么。读者的反馈对我们开发您真正能从中获得最大收益的标题非常重要。

要发送给我们一般反馈，只需发送电子邮件到`<feedback@packtpub.com>`，并在您的邮件主题中提及书名。

如果您在某个主题上具有专业知识，并且您对撰写或为书籍做出贡献感兴趣，请参阅我们的作者指南[www.packtpub.com/authors](http://www.packtpub.com/authors)。

# 客户支持

现在您是 Packt 书籍的骄傲拥有者，我们有多种方式可以帮助您从您的购买中获得最大收益。

## 下载示例代码

您可以从[`www.packtpub.com`](http://www.packtpub.com)的账户下载本书的示例代码文件。如果您在其他地方购买了这本书，您可以访问[`www.packtpub.com/support`](http://www.packtpub.com/support)并注册，以便将文件直接通过电子邮件发送给您。

您可以通过以下步骤下载代码文件：

1.  使用您的电子邮件地址和密码登录或注册我们的网站。

1.  将鼠标指针悬停在顶部的**支持**标签上。

1.  点击**代码下载 & 错误清单**。

1.  在**搜索**框中输入书籍的名称。

1.  选择您想要下载代码文件的书籍。

1.  从下拉菜单中选择您购买这本书的地方。

1.  点击**代码下载**。

下载文件后，请确保您使用最新版本解压缩或提取文件夹：

+   WinRAR / 7-Zip for Windows

+   Zipeg / iZip / UnRarX for Mac

+   7-Zip / PeaZip for Linux

## 错误清单

尽管我们已经尽一切努力确保我们内容的准确性，但错误仍然会发生。如果您在我们的书中发现错误——可能是文本或代码中的错误——如果您能向我们报告这一点，我们将不胜感激。通过这样做，您可以节省其他读者的挫败感，并帮助我们改进本书的后续版本。如果您发现任何错误清单，请通过访问[`www.packtpub.com/submit-errata`](http://www.packtpub.com/submit-errata)，选择您的书籍，点击**错误清单提交表单**链接，并输入您的错误清单详情来报告它们。一旦您的错误清单得到验证，您的提交将被接受，错误清单将被上传到我们的网站，或添加到该标题的错误清单部分。您可以通过从[`www.packtpub.com/support`](http://www.packtpub.com/support)选择您的标题来查看现有的错误清单。

## 侵权

在互联网上侵犯版权材料是一个跨所有媒体持续存在的问题。在 Packt，我们非常重视我们版权和许可证的保护。如果您在互联网上发现我们作品的任何非法副本，无论形式如何，请立即提供位置地址或网站名称，以便我们可以追究补救措施。

请通过 `<copyright@packtpub.com>` 联系我们，并提供涉嫌盗版材料的链接。

我们感谢您在保护我们作者以及为我们提供有价值内容方面的帮助。

## 问题

如果你在本书的任何方面遇到问题，可以通过 `<questions@packtpub.com>` 联系我们，我们将尽力解决。
