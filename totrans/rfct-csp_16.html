<html><head></head><body>
<div id="_idContainer198">
<h1 class="chapter-number" id="_idParaDest-342"><a id="_idTextAnchor341"/><span class="koboSpan" id="kobo.1.1">16</span></h1>
<h1 id="_idParaDest-343"><a id="_idTextAnchor342"/><span class="koboSpan" id="kobo.2.1">Adopting Code Standards</span></h1>
<p><span class="koboSpan" id="kobo.3.1">In this chapter, we’ll talk about the importance of establishing clear </span><strong class="bold"><span class="koboSpan" id="kobo.4.1">code standards</span></strong><span class="koboSpan" id="kobo.5.1"> with the right degree of flexibility. </span><span class="koboSpan" id="kobo.5.2">We’ll also cover some built-in tooling in Visual Studio that will help your team adopt a consistent set of coding standards. </span><span class="koboSpan" id="kobo.5.3">This in turn helps you focus on the right things during </span><span class="No-Break"><span class="koboSpan" id="kobo.6.1">code review.</span></span></p>
<p><span class="koboSpan" id="kobo.7.1">This chapter covers the </span><span class="No-Break"><span class="koboSpan" id="kobo.8.1">following topics:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.9.1">Understanding </span><span class="No-Break"><span class="koboSpan" id="kobo.10.1">code standards</span></span></li>
<li><span class="koboSpan" id="kobo.11.1">Establishing </span><span class="No-Break"><span class="koboSpan" id="kobo.12.1">code standards</span></span></li>
<li><span class="koboSpan" id="kobo.13.1">Formatting and code cleanup in </span><span class="No-Break"><span class="koboSpan" id="kobo.14.1">Visual Studio</span></span></li>
<li><span class="koboSpan" id="kobo.15.1">Applying code standards </span><span class="No-Break"><span class="koboSpan" id="kobo.16.1">with </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.17.1">EditorConfig</span></strong></span></li>
</ul>
<h1 id="_idParaDest-344"><a id="_idTextAnchor343"/><span class="koboSpan" id="kobo.18.1">Technical requirements</span></h1>
<p><span class="koboSpan" id="kobo.19.1">The starting code for this chapter is available from GitHub at </span><a href="https://github.com/PacktPublishing/Refactoring-with-CSharp"><span class="koboSpan" id="kobo.20.1">https://github.com/PacktPublishing/Refactoring-with-CSharp</span></a><span class="koboSpan" id="kobo.21.1"> in the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.22.1">Chapter16/Ch16BeginningCode</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.23.1"> folder.</span></span></p>
<h1 id="_idParaDest-345"><a id="_idTextAnchor344"/><span class="koboSpan" id="kobo.24.1">Understanding code standards</span></h1>
<p><span class="koboSpan" id="kobo.25.1">In this chapter, we’re going to explore the idea of </span><span class="No-Break"><span class="koboSpan" id="kobo.26.1">code standards.</span></span></p>
<p><span class="koboSpan" id="kobo.27.1">Code standards</span><a id="_idIndexMarker910"/><span class="koboSpan" id="kobo.28.1"> are an agreed-upon set of standards your team decides should be applied to any new code created by </span><span class="No-Break"><span class="koboSpan" id="kobo.29.1">the team.</span></span></p>
<p><span class="koboSpan" id="kobo.30.1">These standards have an important role in resolving disputes, focusing attention on the areas that truly matter, reducing the amount of technical debt teams naturally accumulate, and helping pay down existing </span><span class="No-Break"><span class="koboSpan" id="kobo.31.1">technical debt.</span></span></p>
<h3><span class="koboSpan" id="kobo.32.1">The importance of code standards</span></h3>
<p><span class="koboSpan" id="kobo.33.1">One of the most frustrating experiences I’ve ever had as a developer is when I’ve sent a carefully</span><a id="_idIndexMarker911"/><span class="koboSpan" id="kobo.34.1"> thought-out change to another developer for review and I’ve heard back remarks such as </span><span class="No-Break"><span class="koboSpan" id="kobo.35.1">the following:</span></span></p>
<ul>
<li><em class="italic"><span class="koboSpan" id="kobo.36.1">I don’t like your curly </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.37.1">brace formatting</span></em></span></li>
<li><em class="italic"><span class="koboSpan" id="kobo.38.1">Your indentation doesn’t match mine. </span><span class="koboSpan" id="kobo.38.2">I use spaces instead </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.39.1">of tabs</span></em></span></li>
<li><em class="italic"><span class="koboSpan" id="kobo.40.1">I’d like it if you’d use </span></em><strong class="source-inline"><span class="koboSpan" id="kobo.41.1">var</span></strong><em class="italic"><span class="koboSpan" id="kobo.42.1"> instead of </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.43.1">the Type</span></em></span></li>
</ul>
<p><span class="koboSpan" id="kobo.44.1">In these scenarios, the developer in question ignores the </span><em class="italic"><span class="koboSpan" id="kobo.45.1">substance</span></em><span class="koboSpan" id="kobo.46.1"> of the change and instead focuses on the </span><em class="italic"><span class="koboSpan" id="kobo.47.1">style</span></em><span class="koboSpan" id="kobo.48.1"> of the change – specifically where the style differs from </span><span class="No-Break"><span class="koboSpan" id="kobo.49.1">their preferences.</span></span></p>
<p><span class="koboSpan" id="kobo.50.1">The cure for this is to adopt a set of code standards that you and your team agree upon. </span><span class="koboSpan" id="kobo.50.2">These standards establish what your team cares about with regard to new code going forward. </span><span class="koboSpan" id="kobo.50.3">The standards might also contain the rationale behind the team’s style and </span><span class="No-Break"><span class="koboSpan" id="kobo.51.1">code preferences.</span></span></p>
<p><span class="koboSpan" id="kobo.52.1">Some examples of code </span><a id="_idIndexMarker912"/><span class="koboSpan" id="kobo.53.1">standard decisions might include </span><span class="No-Break"><span class="koboSpan" id="kobo.54.1">the following:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.55.1">We use file-scoped namespaces because they result in </span><span class="No-Break"><span class="koboSpan" id="kobo.56.1">less nesting</span></span></li>
<li><span class="koboSpan" id="kobo.57.1">Unit test classes should be named after the classes </span><span class="No-Break"><span class="koboSpan" id="kobo.58.1">they test</span></span></li>
<li><span class="koboSpan" id="kobo.59.1">We prefer using target-typed </span><strong class="source-inline"><span class="koboSpan" id="kobo.60.1">new</span></strong><span class="koboSpan" id="kobo.61.1"> when </span><span class="No-Break"><span class="koboSpan" id="kobo.62.1">instantiating objects</span></span></li>
<li><span class="koboSpan" id="kobo.63.1">Class definitions should be clearly organized and start with fields, then move on to constructors, properties, and </span><span class="No-Break"><span class="koboSpan" id="kobo.64.1">finally methods</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.65.1">These standards don’t have to be so rigid that developers don’t have any decisions to make or live in constant fear of </span><span class="No-Break"><span class="koboSpan" id="kobo.66.1">violating them.</span></span></p>
<p><span class="koboSpan" id="kobo.67.1">Your code standards should be prescriptive enough that they address the major points of contention and confusion. </span><span class="koboSpan" id="kobo.67.2">This helps you focus on creating and maintaining code in a way that maximizes your ability to provide value to </span><span class="No-Break"><span class="koboSpan" id="kobo.68.1">the organization.</span></span></p>
<h3><span class="koboSpan" id="kobo.69.1">How code standards influence refactoring</span></h3>
<p><span class="koboSpan" id="kobo.70.1">When</span><a id="_idIndexMarker913"/><span class="koboSpan" id="kobo.71.1"> you have a definitive set of standards that you and your team agree on, it opens the floodgates </span><span class="No-Break"><span class="koboSpan" id="kobo.72.1">for refactoring.</span></span></p>
<p><span class="koboSpan" id="kobo.73.1">Without a set of standards, when you talk about old code, you might say “I don’t like this very much,” or “This isn’t how I would have written this,” or “This seems poorly </span><span class="No-Break"><span class="koboSpan" id="kobo.74.1">put together.”</span></span></p>
<p><span class="koboSpan" id="kobo.75.1">These things may be true, but they aren’t compelling arguments </span><span class="No-Break"><span class="koboSpan" id="kobo.76.1">for refactoring.</span></span></p>
<p><span class="koboSpan" id="kobo.77.1">Instead, when </span><a id="_idIndexMarker914"/><span class="koboSpan" id="kobo.78.1">you can say “This class violates our code standards in these areas,” the conversation becomes much more productive. </span><span class="koboSpan" id="kobo.78.2">This is especially true when you can establish that some of your standards are critical while others are important but </span><span class="No-Break"><span class="koboSpan" id="kobo.79.1">less critical.</span></span></p>
<p><span class="koboSpan" id="kobo.80.1">There are certain aspects of code standards that I believe are critical and worth going in and making changes to just to get the code onto the new standards. </span><span class="koboSpan" id="kobo.80.2">For me, these areas often revolve around the handling of </span><strong class="source-inline"><span class="koboSpan" id="kobo.81.1">IDisposable</span></strong><span class="koboSpan" id="kobo.82.1"> resources and using proper exception </span><span class="No-Break"><span class="koboSpan" id="kobo.83.1">management practices.</span></span></p>
<p><span class="koboSpan" id="kobo.84.1">Whatever you and your team agree upon is critical. </span><span class="koboSpan" id="kobo.84.2">These standards will impact your priorities and the decisions you make while maintaining code. </span><span class="koboSpan" id="kobo.84.3">Standards violations can be issues that get dedicated work items assigned to people to go in and fix without any other reason for touching the code in question. </span><span class="koboSpan" id="kobo.84.4">We’ll talk more about this in the final chapter of </span><span class="No-Break"><span class="koboSpan" id="kobo.85.1">this book.</span></span></p>
<h3><span class="koboSpan" id="kobo.86.1">Applying code standards to existing code</span></h3>
<p><span class="koboSpan" id="kobo.87.1">The </span><a id="_idIndexMarker915"/><span class="koboSpan" id="kobo.88.1">non-critical standards are used to guide the work developers do every day. </span><span class="koboSpan" id="kobo.88.2">All code changes are expected to comply with these code standards. </span><span class="koboSpan" id="kobo.88.3">Often, the standards encourage developers to update nearby pre-existing code that is out </span><span class="No-Break"><span class="koboSpan" id="kobo.89.1">of compliance.</span></span></p>
<p><span class="koboSpan" id="kobo.90.1">For example, your team might have a code standard to not use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.91.1">var</span></strong><span class="koboSpan" id="kobo.92.1"> keyword when you can help it (or to always prefer </span><strong class="source-inline"><span class="koboSpan" id="kobo.93.1">var</span></strong><span class="koboSpan" id="kobo.94.1">, if that’s your jam). </span><span class="koboSpan" id="kobo.94.2">The team’s expectation would be that as developers write new code, the new code will comply with </span><span class="No-Break"><span class="koboSpan" id="kobo.95.1">this rule.</span></span></p>
<p><span class="koboSpan" id="kobo.96.1">When standards are defined, teams sometimes expect that code near the code you’re changing will also be updated to comply with the standards. </span><span class="koboSpan" id="kobo.96.2">This is particularly true for code in the same method. </span><span class="koboSpan" id="kobo.96.3">After all, you’ve spent effort testing your new code to validate the changes you made. </span><span class="koboSpan" id="kobo.96.4">This testing effort can help catch any issues introduced by refactoring the rest of </span><span class="No-Break"><span class="koboSpan" id="kobo.97.1">the method.</span></span></p>
<p><span class="koboSpan" id="kobo.98.1">Over time, these code standards will help reduce the rate at which your team accumulates technical debt. </span><span class="koboSpan" id="kobo.98.2">This ongoing improvement of the existing code will also help pay down existing technical debt in frequently </span><span class="No-Break"><span class="koboSpan" id="kobo.99.1">changed areas.</span></span></p>
<h1 id="_idParaDest-346"><a id="_idTextAnchor345"/><span class="koboSpan" id="kobo.100.1">Establishing code standards</span></h1>
<p><span class="koboSpan" id="kobo.101.1">So, now</span><a id="_idIndexMarker916"/><span class="koboSpan" id="kobo.102.1"> that I’ve convinced you how code standards can reduce conflict in your team, focus code reviews, and guide refactoring efforts, let’s talk about where these standards come from and how we adopt them in </span><span class="No-Break"><span class="koboSpan" id="kobo.103.1">our teams.</span></span></p>
<h3><span class="koboSpan" id="kobo.104.1">Collective code standards</span></h3>
<p><span class="koboSpan" id="kobo.105.1">Every software</span><a id="_idIndexMarker917"/><span class="koboSpan" id="kobo.106.1"> development team already has </span><span class="No-Break"><span class="koboSpan" id="kobo.107.1">code standards.</span></span></p>
<p><span class="koboSpan" id="kobo.108.1">I say this because each software development team already has, by definition, at least one developer. </span><span class="koboSpan" id="kobo.108.2">Every developer, whether they’re aware of it or not, has their own set of internalized </span><span class="No-Break"><span class="koboSpan" id="kobo.109.1">code standards.</span></span></p>
<p><span class="koboSpan" id="kobo.110.1">They may not have thought about their preferences or be able to list them out, but if you look at each developer on your team and the code they write in isolation, there will be a certain amount of consistency </span><span class="No-Break"><span class="koboSpan" id="kobo.111.1">to it.</span></span></p>
<p><span class="koboSpan" id="kobo.112.1">The problem teams encounter is not that they don’t have standards, but rather that they have too many standards. </span><span class="koboSpan" id="kobo.112.2">Each developer operates from their own internal set of standards and preferences and the team must now come together and interact with each other’s unique styles </span><span class="No-Break"><span class="koboSpan" id="kobo.113.1">and preferences.</span></span></p>
<p><span class="koboSpan" id="kobo.114.1">Usually, teams will gravitate toward certain styles as developers tend to mimic the existing style in code files. </span><span class="koboSpan" id="kobo.114.2">As time goes on and teams grow, there are usually conflicts over certain choices. </span><span class="koboSpan" id="kobo.114.3">When this happens, your team will need to decide whether the creative freedom of not having defined any collective standards is worth the friction and distractions caused by these </span><span class="No-Break"><span class="koboSpan" id="kobo.115.1">differing preferences.</span></span></p>
<p><span class="koboSpan" id="kobo.116.1">Eventually, most teams formalize a set of standards around the things that really matter to those teams. </span><span class="koboSpan" id="kobo.116.2">Let’s talk about what should go on </span><span class="No-Break"><span class="koboSpan" id="kobo.117.1">that list.</span></span></p>
<h3><span class="koboSpan" id="kobo.118.1">Selecting what is important</span></h3>
<p><span class="koboSpan" id="kobo.119.1">Programming is a creative endeavor and so we don’t want to place too many restrictions on how </span><a id="_idIndexMarker918"/><span class="koboSpan" id="kobo.120.1">developers write code. </span><span class="koboSpan" id="kobo.120.2">On the other hand, when there are too few rules, it can result in somewhat eclectic areas of code that are suited to one developer’s preferences but not the </span><span class="No-Break"><span class="koboSpan" id="kobo.121.1">larger team.</span></span></p>
<p><span class="koboSpan" id="kobo.122.1">So, how does a development team figure out what should go in </span><span class="No-Break"><span class="koboSpan" id="kobo.123.1">its standards?</span></span></p>
<p><span class="koboSpan" id="kobo.124.1">I like to start with the standards that keep teams safe. </span><span class="koboSpan" id="kobo.124.2">These involve following established best practices such as those defined in the .NET’s </span><strong class="bold"><span class="koboSpan" id="kobo.125.1">Framework Design Guidelines</span></strong><span class="koboSpan" id="kobo.126.1"> (see </span><em class="italic"><span class="koboSpan" id="kobo.127.1">Further reading</span></em><span class="koboSpan" id="kobo.128.1"> for more information). </span><span class="koboSpan" id="kobo.128.2">These practices are less oriented around individual opinions. </span><span class="koboSpan" id="kobo.128.3">This lets them have a high impact while being relatively free of drama as </span><span class="No-Break"><span class="koboSpan" id="kobo.129.1">a result.</span></span></p>
<p><span class="koboSpan" id="kobo.130.1">Next, look at the major sticking points your team bumps into in code review. </span><span class="koboSpan" id="kobo.130.2">If you’re sick of discussions around tabs versus spaces – whether or not the </span><strong class="source-inline"><span class="koboSpan" id="kobo.131.1">{</span></strong><span class="koboSpan" id="kobo.132.1"> belongs on its own line, or the use of </span><strong class="source-inline"><span class="koboSpan" id="kobo.133.1">var</span></strong><span class="koboSpan" id="kobo.134.1"> – these are things to consider adding to your </span><span class="No-Break"><span class="koboSpan" id="kobo.135.1">team’s standards.</span></span></p>
<p><span class="koboSpan" id="kobo.136.1">If these areas are major sources of disagreements, you have a couple </span><span class="No-Break"><span class="koboSpan" id="kobo.137.1">of choices:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.138.1">Pick a stance on the area of contention and adopt it as </span><span class="No-Break"><span class="koboSpan" id="kobo.139.1">a team</span></span></li>
<li><span class="koboSpan" id="kobo.140.1">Make having no official stance on the topic your team’s </span><span class="No-Break"><span class="koboSpan" id="kobo.141.1">official position</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.142.1">Picking a stance and adopting it as a team may cause temporary arguments and hurt feelings. </span><span class="koboSpan" id="kobo.142.2">In the long term, adopting a stance tends to be beneficial since your team can operate with a consistent style. </span><span class="koboSpan" id="kobo.142.3">While developers may feel less appreciated or valued by the position, most tend to naturally warm to the new style over time, though this can lead to turnover in some cases when developers feel very strongly about a topic or that their opinions </span><span class="No-Break"><span class="koboSpan" id="kobo.143.1">weren’t considered.</span></span></p>
<p><span class="koboSpan" id="kobo.144.1">You may not think that explicitly saying your team has no stance on an aspect of code would be very beneficial. </span><span class="koboSpan" id="kobo.144.2">However, I’ve seen this approach have a massive impact on the conversations teams have. </span><span class="koboSpan" id="kobo.144.3">By explicitly having no policy on the topic, the contentious topic now becomes something </span><span class="No-Break"><span class="koboSpan" id="kobo.145.1">quickly resolved.</span></span></p>
<p><span class="koboSpan" id="kobo.146.1">Instead of debating whether </span><strong class="source-inline"><span class="koboSpan" id="kobo.147.1">var</span></strong><span class="koboSpan" id="kobo.148.1"> belongs in your code, the team can point to its standards that say individual developers can make their own choices on this matter. </span><span class="koboSpan" id="kobo.148.2">This moves your team past contentious areas and on to more productive topics. </span><span class="koboSpan" id="kobo.148.3">The primary downside is that your overall code will be </span><span class="No-Break"><span class="koboSpan" id="kobo.149.1">less consistent.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.150.1">The value of consistency</span></p>
<p class="callout"><span class="koboSpan" id="kobo.151.1">Code that follows consistent styling and design decisions feels more professional, makes it easier for developers to work in areas they’ve not worked in before and keeps developers productive and focused on the function of code instead of </span><span class="No-Break"><span class="koboSpan" id="kobo.152.1">its form.</span></span></p>
<p><span class="koboSpan" id="kobo.153.1">Make sure </span><a id="_idIndexMarker919"/><span class="koboSpan" id="kobo.154.1">the engineering team is represented when creating code standards and determining what goes in those standards. </span><span class="koboSpan" id="kobo.154.2">This can be done by involving the entire team or by picking a subset that represents the various experience levels and preferences of the engineers in your organization. </span><span class="koboSpan" id="kobo.154.3">Additionally, if you have individuals who may react particularly strongly to a new style, make sure their concerns are fully heard and – where possible – involve them in </span><span class="No-Break"><span class="koboSpan" id="kobo.155.1">the process.</span></span></p>
<h3><span class="koboSpan" id="kobo.156.1">Sources of code standards</span></h3>
<p><span class="koboSpan" id="kobo.157.1">Sometimes, creating a</span><a id="_idIndexMarker920"/><span class="koboSpan" id="kobo.158.1"> standard of your own can be too difficult or polarizing, or you may find that you don’t know where to start when creating </span><span class="No-Break"><span class="koboSpan" id="kobo.159.1">code standards.</span></span></p>
<p><span class="koboSpan" id="kobo.160.1">When this happens, I recommend starting from an established set of code standards and customizing those </span><span class="No-Break"><span class="koboSpan" id="kobo.161.1">as needed.</span></span></p>
<p><span class="koboSpan" id="kobo.162.1">In </span><a href="B21324_12.xhtml#_idTextAnchor259"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.163.1">Chapter 12</span></em></span></a><span class="koboSpan" id="kobo.164.1">, we covered the built-in code analysis rulesets and how you can progressively move your ruleset from the latest ruleset to the latest minimum, then the latest recommended, and finally all the latest rulesets. </span><span class="koboSpan" id="kobo.164.2">These code analysis rules can help enforce </span><span class="No-Break"><span class="koboSpan" id="kobo.165.1">best practices.</span></span></p>
<p><span class="koboSpan" id="kobo.166.1">If you’d like a little more formality to things, Microsoft has documented C# coding conventions and framework design guidelines that give you a good starting point for your team. </span><span class="koboSpan" id="kobo.166.2">Both documents are referenced at the end of this chapter in the </span><em class="italic"><span class="koboSpan" id="kobo.167.1">Further reading</span></em><span class="koboSpan" id="kobo.168.1"> section and are fantastic, evergreen sources of wisdom around .NET </span><span class="No-Break"><span class="koboSpan" id="kobo.169.1">and C#.</span></span></p>
<h3><span class="koboSpan" id="kobo.170.1">Evolving code standards</span></h3>
<p><span class="koboSpan" id="kobo.171.1">I </span><a id="_idIndexMarker921"/><span class="koboSpan" id="kobo.172.1">mention “evergreen” because C# is not a dormant language. </span><span class="koboSpan" id="kobo.172.2">Every November, Microsoft ships new versions of C# with new language features building upon the previous year’s improvements. </span><span class="koboSpan" id="kobo.172.3">This makes the C# language feel more organic as it evolves </span><span class="No-Break"><span class="koboSpan" id="kobo.173.1">over time.</span></span></p>
<p><span class="koboSpan" id="kobo.174.1">Additionally, the context in which we program changes over time. </span><span class="koboSpan" id="kobo.174.2">When .NET was first introduced, it was essentially a productivity improvement for developers primarily performing Windows desktop development. </span><span class="koboSpan" id="kobo.174.3">Since then, we’ve seen .NET become open source and cross-platform. </span><span class="koboSpan" id="kobo.174.4">At the same time, many organizations have migrated from on-premises data centers as cloud computing on platforms such as Azure and AWS has become </span><span class="No-Break"><span class="koboSpan" id="kobo.175.1">the norm.</span></span></p>
<p><span class="koboSpan" id="kobo.176.1">Things </span><a id="_idIndexMarker922"/><span class="koboSpan" id="kobo.177.1">that were best practices back in the original days of C# have since faded in popularity as new language features have arrived to take their place and as the .NET platform grows </span><span class="No-Break"><span class="koboSpan" id="kobo.178.1">new features.</span></span></p>
<p><span class="koboSpan" id="kobo.179.1">I’ve been working with .NET since the beginning and have felt this in my own coding style. </span><span class="koboSpan" id="kobo.179.2">Throughout this book, I’ve discussed </span><strong class="source-inline"><span class="koboSpan" id="kobo.180.1">var</span></strong><span class="koboSpan" id="kobo.181.1"> because it’s an easy language feature to talk about, but it is a good example of how C# changes </span><span class="No-Break"><span class="koboSpan" id="kobo.182.1">over time.</span></span></p>
<p><span class="koboSpan" id="kobo.183.1">Prior to </span><strong class="source-inline"><span class="koboSpan" id="kobo.184.1">var</span></strong><span class="koboSpan" id="kobo.185.1">, you’d declare a dictionary of </span><strong class="source-inline"><span class="koboSpan" id="kobo.186.1">Guid</span></strong><span class="koboSpan" id="kobo.187.1"> keys and </span><strong class="source-inline"><span class="koboSpan" id="kobo.188.1">int</span></strong><span class="koboSpan" id="kobo.189.1"> values </span><span class="No-Break"><span class="koboSpan" id="kobo.190.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.191.1">
Dictionary&lt;Guid, int&gt; data = new Dictionary&lt;Guid, int&gt;();</span></pre>
<p><span class="koboSpan" id="kobo.192.1">When </span><strong class="source-inline"><span class="koboSpan" id="kobo.193.1">var</span></strong><span class="koboSpan" id="kobo.194.1"> was introduced, the standard shifted to using </span><strong class="source-inline"><span class="koboSpan" id="kobo.195.1">var</span></strong><span class="koboSpan" id="kobo.196.1"> to simplify your declaration since the Type </span><span class="No-Break"><span class="koboSpan" id="kobo.197.1">was obvious:</span></span></p>
<pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.198.1">var</span></strong><span class="koboSpan" id="kobo.199.1"> data = new Dictionary&lt;Guid, int&gt;();</span></pre>
<p><span class="koboSpan" id="kobo.200.1">This resulted in less duplicated syntax and improved developer productivity while still keeping the </span><span class="No-Break"><span class="koboSpan" id="kobo.201.1">Type obvious.</span></span></p>
<p><span class="koboSpan" id="kobo.202.1">With the recent addition of target-typed </span><strong class="source-inline"><span class="koboSpan" id="kobo.203.1">new</span></strong><span class="koboSpan" id="kobo.204.1">, my preference changed to use it </span><span class="No-Break"><span class="koboSpan" id="kobo.205.1">as follows:</span></span></p>
<pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.206.1">Dictionary&lt;Guid, int&gt; data = new();</span></strong></pre>
<p><span class="koboSpan" id="kobo.207.1">I’m sharing my own personal journey on standards here because it’s a microcosm of what engineering teams will </span><span class="No-Break"><span class="koboSpan" id="kobo.208.1">go through.</span></span></p>
<p><span class="koboSpan" id="kobo.209.1">You’ll adapt to standards and then C# will change over time, and you’ll adjust your standards to keep up. </span><span class="koboSpan" id="kobo.209.2">What you may consider a “best” practice right now may later turn out to not work well a few months into implementation. </span><span class="koboSpan" id="kobo.209.3">It’s also natural for the obstacles facing your team to change. </span><span class="koboSpan" id="kobo.209.4">When this happens, this forces you and your team to adopt new strategies to overcome </span><span class="No-Break"><span class="koboSpan" id="kobo.210.1">these obstacles.</span></span></p>
<p><span class="koboSpan" id="kobo.211.1">It’s okay to change your standards over time. </span><span class="koboSpan" id="kobo.211.2">That’s normal and is a sign of an evolving language and the evolving context of our daily </span><span class="No-Break"><span class="koboSpan" id="kobo.212.1">programming jobs.</span></span></p>
<h3><span class="koboSpan" id="kobo.213.1">Integrating standards into your processes</span></h3>
<p><span class="koboSpan" id="kobo.214.1">Code standards affect a few different places in software development, from how you approach </span><a id="_idIndexMarker923"/><span class="koboSpan" id="kobo.215.1">building new features to the way in which you </span><span class="No-Break"><span class="koboSpan" id="kobo.216.1">maintain code.</span></span></p>
<p><span class="koboSpan" id="kobo.217.1">Your code standards should be clearly documented and stored in a central location, such as a team wiki or shared document. </span><span class="koboSpan" id="kobo.217.2">These standards should be communicated to new developers who join the team to help them familiarize themselves with the team’s expectations on </span><span class="No-Break"><span class="koboSpan" id="kobo.218.1">code standards.</span></span></p>
<p><span class="koboSpan" id="kobo.219.1">Code standards should also be reinforced in the code review process after all other concerns on the substance of code changes are discussed. </span><span class="koboSpan" id="kobo.219.2">These issues should be resolved before the code is approved and the work item is completed, but this shouldn’t be done in a </span><span class="No-Break"><span class="koboSpan" id="kobo.220.1">punitive manner.</span></span></p>
<p><span class="koboSpan" id="kobo.221.1">It’s important to understand that internalizing code standards takes some time for new developers on the team. </span><span class="koboSpan" id="kobo.221.2">It’s normal for it to take a few months with the team before your new developers think in terms of the </span><span class="No-Break"><span class="koboSpan" id="kobo.222.1">team’s standards.</span></span></p>
<p><span class="koboSpan" id="kobo.223.1">One thing that can help is to incorporate tools into the process that make it easy for your team to validate whether its code meets standards before it sends the code on for peer review. </span><span class="koboSpan" id="kobo.223.2">Code analysis rules and Roslyn Analyzers can help with this, but Visual Studio places a few more tools at your disposal that can help standardize code before code reaches human review: code formatting and </span><strong class="source-inline"><span class="koboSpan" id="kobo.224.1">.</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.225.1">editorconfig</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.226.1"> files.</span></span></p>
<h1 id="_idParaDest-347"><a id="_idTextAnchor346"/><span class="koboSpan" id="kobo.227.1">Formatting and code cleanup in Visual Studio</span></h1>
<p><span class="koboSpan" id="kobo.228.1">It turns out that </span><a id="_idIndexMarker924"/><span class="koboSpan" id="kobo.229.1">Visual Studio can automatically arrange and even clean up </span><a id="_idIndexMarker925"/><span class="koboSpan" id="kobo.230.1">your code in a consistent manner through </span><span class="No-Break"><span class="koboSpan" id="kobo.231.1">built-in features.</span></span></p>
<h3><span class="koboSpan" id="kobo.232.1">Formatting documents</span></h3>
<p><span class="koboSpan" id="kobo.233.1">One </span><a id="_idIndexMarker926"/><span class="koboSpan" id="kobo.234.1">of the easiest ways to do this is with the </span><strong class="bold"><span class="koboSpan" id="kobo.235.1">Format Document</span></strong><span class="koboSpan" id="kobo.236.1"> feature, either by pressing </span><em class="italic"><span class="koboSpan" id="kobo.237.1">Ctrl</span></em><span class="koboSpan" id="kobo.238.1"> + </span><em class="italic"><span class="koboSpan" id="kobo.239.1">K</span></em><span class="koboSpan" id="kobo.240.1"> and then </span><em class="italic"><span class="koboSpan" id="kobo.241.1">Ctrl</span></em><span class="koboSpan" id="kobo.242.1"> + </span><em class="italic"><span class="koboSpan" id="kobo.243.1">D</span></em><span class="koboSpan" id="kobo.244.1"> or by opening</span><a id="_idIndexMarker927"/><span class="koboSpan" id="kobo.245.1"> the </span><strong class="bold"><span class="koboSpan" id="kobo.246.1">Edit</span></strong><span class="koboSpan" id="kobo.247.1"> menu, then going to </span><strong class="bold"><span class="koboSpan" id="kobo.248.1">Advanced</span></strong><span class="koboSpan" id="kobo.249.1"> and selecting </span><strong class="bold"><span class="koboSpan" id="kobo.250.1">Format Document</span></strong><span class="koboSpan" id="kobo.251.1">, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.252.1">Figure 16</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.253.1">.1</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.254.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer190">
<span class="koboSpan" id="kobo.255.1"><img alt="Figure 16.1 – Formatting the active editor document" src="image/B21324_16_01.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.256.1">Figure 16.1 – Formatting the active editor document</span></p>
<p><span class="koboSpan" id="kobo.257.1">This will </span><a id="_idIndexMarker928"/><span class="koboSpan" id="kobo.258.1">change the code in your current file to match the preferences you’ve configured in </span><span class="No-Break"><span class="koboSpan" id="kobo.259.1">Visual Studio.</span></span></p>
<p><span class="koboSpan" id="kobo.260.1">These settings </span><a id="_idIndexMarker929"/><span class="koboSpan" id="kobo.261.1">can be configured by opening the </span><strong class="bold"><span class="koboSpan" id="kobo.262.1">Tools</span></strong><span class="koboSpan" id="kobo.263.1"> menu and then selecting </span><strong class="bold"><span class="koboSpan" id="kobo.264.1">Options…</span></strong><span class="koboSpan" id="kobo.265.1">. </span><span class="koboSpan" id="kobo.265.2">From there, expand the </span><strong class="bold"><span class="koboSpan" id="kobo.266.1">Text Editor</span></strong><span class="koboSpan" id="kobo.267.1">, </span><strong class="bold"><span class="koboSpan" id="kobo.268.1">C#</span></strong><span class="koboSpan" id="kobo.269.1">, </span><strong class="bold"><span class="koboSpan" id="kobo.270.1">Code Style</span></strong><span class="koboSpan" id="kobo.271.1">, and </span><strong class="bold"><span class="koboSpan" id="kobo.272.1">Formatting</span></strong><span class="koboSpan" id="kobo.273.1"> nodes until you see the various preferences for indentation, new lines, spacing, </span><span class="No-Break"><span class="koboSpan" id="kobo.274.1">and wrapping.</span></span></p>
<p><span class="koboSpan" id="kobo.275.1">These settings blades allow you to configure the formatting preferences of Visual Studio and preview the formatting choices, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.276.1">Figure 16</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.277.1">.2</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.278.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer191">
<span class="koboSpan" id="kobo.279.1"><img alt="Figure 16.2 – Changing how Visual Studio formats catch statements" src="image/B21324_16_02.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.280.1">Figure 16.2 – Changing how Visual Studio formats catch statements</span></p>
<p><span class="koboSpan" id="kobo.281.1">Once you’ve customized </span><a id="_idIndexMarker930"/><span class="koboSpan" id="kobo.282.1">your settings, these settings will be used any time you use the </span><strong class="bold"><span class="koboSpan" id="kobo.283.1">Format </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.284.1">Document</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.285.1"> feature.</span></span></p>
<p><span class="koboSpan" id="kobo.286.1">Many </span><a id="_idIndexMarker931"/><span class="koboSpan" id="kobo.287.1">developers learn the </span><em class="italic"><span class="koboSpan" id="kobo.288.1">Ctrl</span></em><span class="koboSpan" id="kobo.289.1"> + </span><em class="italic"><span class="koboSpan" id="kobo.290.1">K</span></em><span class="koboSpan" id="kobo.291.1"> and </span><em class="italic"><span class="koboSpan" id="kobo.292.1">Ctrl</span></em><span class="koboSpan" id="kobo.293.1"> + </span><em class="italic"><span class="koboSpan" id="kobo.294.1">D</span></em><span class="koboSpan" id="kobo.295.1"> shortcuts to format documents early on and use them reflexively, but you can actually get Visual Studio to apply code </span><span class="No-Break"><span class="koboSpan" id="kobo.296.1">cleanup automatically.</span></span></p>
<h3><span class="koboSpan" id="kobo.297.1">Automatically formatting documents</span></h3>
<p><span class="koboSpan" id="kobo.298.1">Visual Studio</span><a id="_idIndexMarker932"/><span class="koboSpan" id="kobo.299.1"> has a </span><strong class="bold"><span class="koboSpan" id="kobo.300.1">Code Cleanup</span></strong><span class="koboSpan" id="kobo.301.1"> feature </span><a id="_idIndexMarker933"/><span class="koboSpan" id="kobo.302.1">that allows you to</span><a id="_idIndexMarker934"/><span class="koboSpan" id="kobo.303.1"> format your code either manually or automatically whenever the file </span><span class="No-Break"><span class="koboSpan" id="kobo.304.1">is saved.</span></span></p>
<p><span class="koboSpan" id="kobo.305.1">This is done through </span><strong class="bold"><span class="koboSpan" id="kobo.306.1">Code Cleanup </span></strong><span class="koboSpan" id="kobo.307.1">profiles. </span><span class="koboSpan" id="kobo.307.2">These profiles can do things such as remove unused </span><strong class="source-inline"><span class="koboSpan" id="kobo.308.1">using</span></strong><span class="koboSpan" id="kobo.309.1"> statements, sort the members in your classes into a more consistent order, and apply your code formatting preferences to </span><span class="No-Break"><span class="koboSpan" id="kobo.310.1">a file.</span></span></p>
<p><span class="koboSpan" id="kobo.311.1">To </span><a id="_idIndexMarker935"/><span class="koboSpan" id="kobo.312.1">configure a code cleanup profile, go to the </span><strong class="bold"><span class="koboSpan" id="kobo.313.1">Options</span></strong><span class="koboSpan" id="kobo.314.1"> dialog again and this time, find </span><strong class="bold"><span class="koboSpan" id="kobo.315.1">Code Cleanup</span></strong><span class="koboSpan" id="kobo.316.1"> in the </span><strong class="bold"><span class="koboSpan" id="kobo.317.1">Text Editor</span></strong><span class="koboSpan" id="kobo.318.1"> node, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.319.1">Figure 16</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.320.1">.3</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.321.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer192">
<span class="koboSpan" id="kobo.322.1"><img alt="Figure 16.3 – Enabling code cleanup when files are saved" src="image/B21324_16_03.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.323.1">Figure 16.3 – Enabling code cleanup when files are saved</span></p>
<p><span class="koboSpan" id="kobo.324.1">From here, you can check </span><strong class="bold"><span class="koboSpan" id="kobo.325.1">Run Code Cleanup profile on Save</span></strong><span class="koboSpan" id="kobo.326.1"> to have your cleanup profile </span><span class="No-Break"><span class="koboSpan" id="kobo.327.1">automatically applied.</span></span></p>
<p><span class="koboSpan" id="kobo.328.1">I also recommend you click </span><strong class="bold"><span class="koboSpan" id="kobo.329.1">Configure Code Cleanup</span></strong><span class="koboSpan" id="kobo.330.1"> to view your </span><span class="No-Break"><span class="koboSpan" id="kobo.331.1">cleanup profiles.</span></span></p>
<p><span class="koboSpan" id="kobo.332.1">This shows you the fixers that will be applied as part of each profile, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.333.1">Figure 16</span></em></span><em class="italic"><span class="koboSpan" id="kobo.334.1">.4</span></em><span class="koboSpan" id="kobo.335.1">, and allows you to configure what is and isn’t included in the code </span><span class="No-Break"><span class="koboSpan" id="kobo.336.1">cleanup action:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer193">
<span class="koboSpan" id="kobo.337.1"><img alt="Figure 16.4 – Configuring code cleanup profiles" src="image/B21324_16_04.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.338.1">Figure 16.4 – Configuring code cleanup profiles</span></p>
<p><span class="koboSpan" id="kobo.339.1">Automatically </span><a id="_idIndexMarker936"/><span class="koboSpan" id="kobo.340.1">cleaning up code on</span><a id="_idIndexMarker937"/><span class="koboSpan" id="kobo.341.1"> save</span><a id="_idIndexMarker938"/><span class="koboSpan" id="kobo.342.1"> can be helpful, but it does have </span><a id="_idIndexMarker939"/><span class="koboSpan" id="kobo.343.1">some downsides. </span><span class="koboSpan" id="kobo.343.2">If your code hasn’t been cleaned up in a while, your cleanup action could appear to create many changes in the file. </span><span class="koboSpan" id="kobo.343.3">This can be confusing in git when multiple authors are trying to modify the same file or even see what </span><span class="No-Break"><span class="koboSpan" id="kobo.344.1">has changed.</span></span></p>
<h3><span class="koboSpan" id="kobo.345.1">Configuring code style settings</span></h3>
<p><span class="koboSpan" id="kobo.346.1">Believe </span><a id="_idIndexMarker940"/><span class="koboSpan" id="kobo.347.1">it or not, when we covered the C# settings for new lines and indentation earlier, this wasn’t the limit of what Visual Studio </span><span class="No-Break"><span class="koboSpan" id="kobo.348.1">can do.</span></span></p>
<p><span class="koboSpan" id="kobo.349.1">Visual Studio provides a </span><strong class="bold"><span class="koboSpan" id="kobo.350.1">Code Style</span></strong><span class="koboSpan" id="kobo.351.1"> settings section that allows you to configure your individual preferences around most language features found </span><span class="No-Break"><span class="koboSpan" id="kobo.352.1">in C#.</span></span></p>
<p><span class="koboSpan" id="kobo.353.1">These settings are found in the </span><strong class="bold"><span class="koboSpan" id="kobo.354.1">Options</span></strong><span class="koboSpan" id="kobo.355.1"> dialog under </span><strong class="bold"><span class="koboSpan" id="kobo.356.1">Text Editor</span></strong><span class="koboSpan" id="kobo.357.1">, </span><strong class="bold"><span class="koboSpan" id="kobo.358.1">C#</span></strong><span class="koboSpan" id="kobo.359.1">, </span><strong class="bold"><span class="koboSpan" id="kobo.360.1">Code Style</span></strong><span class="koboSpan" id="kobo.361.1">, and then </span><strong class="bold"><span class="koboSpan" id="kobo.362.1">General</span></strong><span class="koboSpan" id="kobo.363.1">, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.364.1">Figure 16</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.365.1">.5</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.366.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer194">
<span class="koboSpan" id="kobo.367.1"><img alt="Figure 16.5 – Configuring Code Style rules in Visual Studio" src="image/B21324_16_05.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.368.1">Figure 16.5 – Configuring Code Style rules in Visual Studio</span></p>
<p><span class="koboSpan" id="kobo.369.1">In this user</span><a id="_idIndexMarker941"/><span class="koboSpan" id="kobo.370.1"> interface, you can configure which rules you care about, what your preferences are on each rule, and how much you care about each rule. </span><span class="koboSpan" id="kobo.370.2">Also notice the </span><strong class="bold"><span class="koboSpan" id="kobo.371.1">Generate .editorconfig file from settings</span></strong><span class="koboSpan" id="kobo.372.1"> button, as we’ll talk about that </span><span class="No-Break"><span class="koboSpan" id="kobo.373.1">more later.</span></span></p>
<p><span class="koboSpan" id="kobo.374.1">For each rule, you get to select whether the rule only appears as a refactoring option, whether Visual Studio subtly suggests the rule through green underlines on identifiers, or whether Visual Studio should be more aggressive, such as using compiler warnings or compiler errors for violations </span><span class="No-Break"><span class="koboSpan" id="kobo.375.1">from standards.</span></span></p>
<p><span class="koboSpan" id="kobo.376.1">There are a lot of these settings, but they allow you to fine-tune your individual preferences for which C# features you prefer and how you like </span><span class="No-Break"><span class="koboSpan" id="kobo.377.1">them formatted.</span></span></p>
<p><span class="koboSpan" id="kobo.378.1">However, these are your </span><em class="italic"><span class="koboSpan" id="kobo.379.1">individual</span></em><span class="koboSpan" id="kobo.380.1"> settings that get applied to the code you work with on your own machine. </span><span class="koboSpan" id="kobo.380.2">In the next section, we’ll talk about how to make these settings apply to your </span><span class="No-Break"><span class="koboSpan" id="kobo.381.1">entire team.</span></span></p>
<h1 id="_idParaDest-348"><a id="_idTextAnchor347"/><span class="koboSpan" id="kobo.382.1">Applying code standards with EditorConfig</span></h1>
<p><span class="koboSpan" id="kobo.383.1">Let’s take a</span><a id="_idIndexMarker942"/><span class="koboSpan" id="kobo.384.1"> look at how you can take the same</span><a id="_idIndexMarker943"/><span class="koboSpan" id="kobo.385.1"> code style settings found in the options dialog and attach them to a project through an </span><strong class="source-inline"><span class="koboSpan" id="kobo.386.1">.</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.387.1">editorconfig</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.388.1"> file.</span></span></p>
<p><span class="koboSpan" id="kobo.389.1">The </span><strong class="bold"><span class="koboSpan" id="kobo.390.1">EditorConfig</span></strong><span class="koboSpan" id="kobo.391.1"> feature uses </span><strong class="source-inline"><span class="koboSpan" id="kobo.392.1">.editorconfig</span></strong><span class="koboSpan" id="kobo.393.1"> files that contain style and language usage rules </span><a id="_idIndexMarker944"/><span class="koboSpan" id="kobo.394.1">that apply to your project. </span><span class="koboSpan" id="kobo.394.2">Any violation of your </span><strong class="source-inline"><span class="koboSpan" id="kobo.395.1">EditorConfig</span></strong><span class="koboSpan" id="kobo.396.1"> rules will result in compiler warnings and suggestions in the Visual </span><span class="No-Break"><span class="koboSpan" id="kobo.397.1">Studio editor.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.398.1">EditorConfig files outside of Visual Studio</span></p>
<p class="callout"><span class="koboSpan" id="kobo.399.1">At the time of this writing, </span><strong class="source-inline"><span class="koboSpan" id="kobo.400.1">.editorconfig</span></strong><span class="koboSpan" id="kobo.401.1"> files work in Visual Studio and JetBrains Rider natively. </span><span class="koboSpan" id="kobo.401.2">In VS Code, EditorConfig files are supported as long as you install the C# Dev Kit and the EditorConfig for VS Code extension. </span><span class="koboSpan" id="kobo.401.3">See the </span><em class="italic"><span class="koboSpan" id="kobo.402.1">Further reading</span></em><span class="koboSpan" id="kobo.403.1"> section for instructions on enabling these features in VS Code and </span><span class="No-Break"><span class="koboSpan" id="kobo.404.1">JetBrains Rider.</span></span></p>
<p><span class="koboSpan" id="kobo.405.1">The key benefit of </span><strong class="source-inline"><span class="koboSpan" id="kobo.406.1">EditorConfig</span></strong><span class="koboSpan" id="kobo.407.1"> files is that they allow all developers working on a project to work with a consistent set of formatting and </span><span class="No-Break"><span class="koboSpan" id="kobo.408.1">styling preferences.</span></span></p>
<h2 id="_idParaDest-349"><a id="_idTextAnchor348"/><span class="koboSpan" id="kobo.409.1">Reviewing our starter code</span></h2>
<p><span class="koboSpan" id="kobo.410.1">The code we’ll be formatting </span><a id="_idIndexMarker945"/><span class="koboSpan" id="kobo.411.1">lives in our </span><a href="B21324_16.xhtml#_idTextAnchor341"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.412.1">Chapter 16</span></em></span></a><span class="koboSpan" id="kobo.413.1"> solution, which has a </span><strong class="source-inline"><span class="koboSpan" id="kobo.414.1">FlightQueryDecoder</span></strong><span class="koboSpan" id="kobo.415.1"> console app and an associated </span><strong class="source-inline"><span class="koboSpan" id="kobo.416.1">xUnit</span></strong><span class="koboSpan" id="kobo.417.1"> test project. </span><span class="koboSpan" id="kobo.417.2">This code is minimal for this chapter and revolves around the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.418.1">FlightQueryParser</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.419.1"> class.</span></span></p>
<p><span class="koboSpan" id="kobo.420.1">Let’s start with the first half of </span><strong class="source-inline"><span class="koboSpan" id="kobo.421.1">FlightQueryParser</span></strong><span class="koboSpan" id="kobo.422.1">, which parses a flight search string such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.423.1">AD08FEBDENLHR</span></strong><span class="koboSpan" id="kobo.424.1"> into a </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.425.1">FlightQuery</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.426.1"> object:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.427.1">
namespace Packt.FlightQueryDecoder;
public class FlightQueryParser
{
  public FlightQuery ParseQuery(string query) {
    if (query.StartsWith("AD") &amp;&amp; query.Length == 13)
    {
      var flightQuery = new FlightQuery {
        Date = DateTime.Parse(query.Substring(2, 5)),
        Origin = query.Substring(7, 3),
        Destination = query.Substring(10, 3)
      };
      return flightQuery;
    }
    else {
      throw new ArgumentException("Invalid query format");
    }
  }</span></pre>
<p><span class="koboSpan" id="kobo.428.1">The actual</span><a id="_idIndexMarker946"/><span class="koboSpan" id="kobo.429.1"> logic here isn’t the focus. </span><span class="koboSpan" id="kobo.429.2">What I want to highlight to you is the inconsistency in how the code is formatted within </span><span class="No-Break"><span class="koboSpan" id="kobo.430.1">the block.</span></span></p>
<p><span class="koboSpan" id="kobo.431.1">Let’s see the other half of the file, which takes a flight search result string such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.432.1">DEN LHR 05:50P 09:40A E0/789 8:50</span></strong><span class="koboSpan" id="kobo.433.1"> and converts it to </span><span class="No-Break"><span class="koboSpan" id="kobo.434.1">a </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.435.1">FlightQueryResult</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.436.1">:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.437.1">
  public FlightQueryResult ParseResult(string result)
  {
    var fqr = new FlightQueryResult();
    var segments = result.Split(' ',
      StringSplitOptions.RemoveEmptyEntries
      | StringSplitOptions.TrimEntries);
    fqr.Origin = segments[0];
    fqr.Destination = segments[1];
    string today = DateTime.Today.ToShortDateString();
    fqr.DepartureTime = DateTime.Parse(
      today + " "+segments[2] + 'M');
    string seg3 = segments[3];
    fqr.ArrivalTime = DateTime.Parse($"{today} {seg3}M");
    fqr.AircraftTypeDesignator = segments[4];
    fqr.FlightDuration = TimeSpan.Parse(segments[5]);
    return fqr;
  }
}</span></pre>
<p><span class="koboSpan" id="kobo.438.1">While this code is </span><a id="_idIndexMarker947"/><span class="koboSpan" id="kobo.439.1">deliberately bad and inconsistently formatted to serve as an example, I’m sure you’ve seen many larger files in the real world with equally </span><span class="No-Break"><span class="koboSpan" id="kobo.440.1">inconsistent styling.</span></span></p>
<p><span class="koboSpan" id="kobo.441.1">Now that we’ve introduced this code with its different styling choices, let’s add an </span><strong class="source-inline"><span class="koboSpan" id="kobo.442.1">.editorconfig</span></strong><span class="koboSpan" id="kobo.443.1"> file to the project and see how that can help </span><span class="No-Break"><span class="koboSpan" id="kobo.444.1">enforce styles.</span></span></p>
<h2 id="_idParaDest-350"><a id="_idTextAnchor349"/><span class="koboSpan" id="kobo.445.1">Adding an EditorConfig</span></h2>
<p><span class="koboSpan" id="kobo.446.1">To </span><a id="_idIndexMarker948"/><span class="koboSpan" id="kobo.447.1">add the </span><strong class="source-inline"><span class="koboSpan" id="kobo.448.1">.editorconfig</span></strong><span class="koboSpan" id="kobo.449.1"> file, right-click on the </span><strong class="source-inline"><span class="koboSpan" id="kobo.450.1">Packt.FlightQueryDecoder</span></strong><span class="koboSpan" id="kobo.451.1"> project and choose </span><strong class="bold"><span class="koboSpan" id="kobo.452.1">Add</span></strong><span class="koboSpan" id="kobo.453.1"> and then </span><strong class="bold"><span class="koboSpan" id="kobo.454.1">New EditorConfig</span></strong><span class="koboSpan" id="kobo.455.1"> or </span><strong class="bold"><span class="koboSpan" id="kobo.456.1">New </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.457.1">EditorConfig (IntelliCode)</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.458.1">.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.459.1">What is EditorConfig (IntelliCode)?</span></p>
<p class="callout"><span class="koboSpan" id="kobo.460.1">There’s a difference between the </span><strong class="bold"><span class="koboSpan" id="kobo.461.1">New EditorConfig</span></strong><span class="koboSpan" id="kobo.462.1"> and </span><strong class="bold"><span class="koboSpan" id="kobo.463.1">New EditorConfig (IntelliCode)</span></strong><span class="koboSpan" id="kobo.464.1"> options. </span><span class="koboSpan" id="kobo.464.2">The standard option creates an </span><strong class="source-inline"><span class="koboSpan" id="kobo.465.1">.editorconfig</span></strong><span class="koboSpan" id="kobo.466.1"> file with the default options, whereas the IntelliCode choice analyzes your project and generates an </span><strong class="source-inline"><span class="koboSpan" id="kobo.467.1">.editorconfig</span></strong><span class="koboSpan" id="kobo.468.1"> file from the conventions it observes in your current code. </span><span class="koboSpan" id="kobo.468.2">Both are viable options for creating a starting point for </span><span class="No-Break"><span class="koboSpan" id="kobo.469.1">your projects.</span></span></p>
<p><span class="koboSpan" id="kobo.470.1">Depending on which option you selected, you may need to select which folder the </span><strong class="source-inline"><span class="koboSpan" id="kobo.471.1">.editorconfig</span></strong><span class="koboSpan" id="kobo.472.1"> file should live in. </span><span class="koboSpan" id="kobo.472.2">If you’re prompted, select the default choice of the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.473.1">Packt.FlightQueryDecoder</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.474.1"> folder.</span></span></p>
<p><span class="koboSpan" id="kobo.475.1">Once</span><a id="_idIndexMarker949"/><span class="koboSpan" id="kobo.476.1"> this completes, you should see a new </span><strong class="source-inline"><span class="koboSpan" id="kobo.477.1">.editorconfig</span></strong><span class="koboSpan" id="kobo.478.1"> file present in your project in </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.479.1">Solution Explorer</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.480.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.481.1">Before we go on to work with this </span><strong class="source-inline"><span class="koboSpan" id="kobo.482.1">.editorconfig</span></strong><span class="koboSpan" id="kobo.483.1"> file, it’s worth pointing out that the </span><strong class="bold"><span class="koboSpan" id="kobo.484.1">Code Style</span></strong><span class="koboSpan" id="kobo.485.1"> settings in the </span><strong class="bold"><span class="koboSpan" id="kobo.486.1">Options</span></strong><span class="koboSpan" id="kobo.487.1"> dialog we saw earlier can be used to generate an </span><strong class="source-inline"><span class="koboSpan" id="kobo.488.1">.editorconfig</span></strong><span class="koboSpan" id="kobo.489.1"> file based on your current code style choices. </span><span class="koboSpan" id="kobo.489.2">This allows you to customize your styles and then create an </span><strong class="source-inline"><span class="koboSpan" id="kobo.490.1">.editorconfig</span></strong><span class="koboSpan" id="kobo.491.1"> file out of </span><span class="No-Break"><span class="koboSpan" id="kobo.492.1">these choices.</span></span></p>
<p><span class="koboSpan" id="kobo.493.1">Now that we have an </span><strong class="source-inline"><span class="koboSpan" id="kobo.494.1">.editorconfig</span></strong><span class="koboSpan" id="kobo.495.1"> file, let’s </span><span class="No-Break"><span class="koboSpan" id="kobo.496.1">customize it.</span></span></p>
<h2 id="_idParaDest-351"><a id="_idTextAnchor350"/><span class="koboSpan" id="kobo.497.1">Customizing EditorConfigs</span></h2>
<p><span class="koboSpan" id="kobo.498.1">Double-click on the </span><strong class="source-inline"><span class="koboSpan" id="kobo.499.1">.editorconfig</span></strong><span class="koboSpan" id="kobo.500.1"> file to open its </span><span class="No-Break"><span class="koboSpan" id="kobo.501.1">properties view.</span></span></p>
<p><span class="koboSpan" id="kobo.502.1">You’ll see </span><a id="_idIndexMarker950"/><span class="koboSpan" id="kobo.503.1">an editor with tabs allowing you to customize various properties related to white space, code style, naming style, and </span><span class="No-Break"><span class="koboSpan" id="kobo.504.1">Roslyn Analyzers.</span></span></p>
<p><span class="koboSpan" id="kobo.505.1">There are a lot of options here, so we’ll focus on just a few very </span><span class="No-Break"><span class="koboSpan" id="kobo.506.1">specific ones.</span></span></p>
<p><span class="koboSpan" id="kobo.507.1">Go to the </span><strong class="bold"><span class="koboSpan" id="kobo.508.1">Code Style</span></strong><span class="koboSpan" id="kobo.509.1"> tab and then scroll down to the bottom for the </span><strong class="bold"><span class="koboSpan" id="kobo.510.1">var </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.511.1">preferences</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.512.1"> group.</span></span></p>
<p><span class="koboSpan" id="kobo.513.1">From here, you can state your team’s preferences and the severity of violations of those preferences. </span><span class="koboSpan" id="kobo.513.2">For example, if your team wants to avoid </span><strong class="source-inline"><span class="koboSpan" id="kobo.514.1">var</span></strong><span class="koboSpan" id="kobo.515.1">, you could set all three </span><strong class="source-inline"><span class="koboSpan" id="kobo.516.1">var</span></strong><span class="koboSpan" id="kobo.517.1"> rules to </span><strong class="bold"><span class="koboSpan" id="kobo.518.1">Prefer explicit type</span></strong><span class="koboSpan" id="kobo.519.1"> and increase the severity to </span><strong class="bold"><span class="koboSpan" id="kobo.520.1">Warning</span></strong><span class="koboSpan" id="kobo.521.1"> or </span><strong class="bold"><span class="koboSpan" id="kobo.522.1">Error</span></strong><span class="koboSpan" id="kobo.523.1">, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.524.1">Figure 16</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.525.1">.6</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.526.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer195">
<span class="koboSpan" id="kobo.527.1"><img alt="Figure 16.6 – Customizing the var preferences for your project" src="image/B21324_16_06.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.528.1">Figure 16.6 – Customizing the var preferences for your project</span></p>
<p><span class="koboSpan" id="kobo.529.1">Save this</span><a id="_idIndexMarker951"/><span class="koboSpan" id="kobo.530.1"> file and go back into </span><strong class="source-inline"><span class="koboSpan" id="kobo.531.1">FlightQueryParser.cs</span></strong><span class="koboSpan" id="kobo.532.1">, and you should now see warnings and errors in your editor for violations of these rules, as seen in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.533.1">Figure 16</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.534.1">.7</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.535.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer196">
<span class="koboSpan" id="kobo.536.1"><img alt="Figure 16.7 – Visual Studio warnings against using var based on code style rules" src="image/B21324_16_07.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.537.1">Figure 16.7 – Visual Studio warnings against using var based on code style rules</span></p>
<p><span class="koboSpan" id="kobo.538.1">These rule violations do not cause your code to not compile but they do appear in the </span><strong class="bold"><span class="koboSpan" id="kobo.539.1">Error List</span></strong><span class="koboSpan" id="kobo.540.1"> view, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.541.1">Figure 16</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.542.1">.8</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.543.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer197">
<span class="koboSpan" id="kobo.544.1"><img alt="Figure 16.8 – Code violations appearing in Error List" src="image/B21324_16_08.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.545.1">Figure 16.8 – Code violations appearing in Error List</span></p>
<p><span class="koboSpan" id="kobo.546.1">Because </span><strong class="source-inline"><span class="koboSpan" id="kobo.547.1">.editorconfig</span></strong><span class="koboSpan" id="kobo.548.1"> files are added to source control when you commit your code, other </span><a id="_idIndexMarker952"/><span class="koboSpan" id="kobo.549.1">developers on your team will pull down that file and see the exact same styling preferences and warnings you see on </span><span class="No-Break"><span class="koboSpan" id="kobo.550.1">your machine.</span></span></p>
<p><span class="koboSpan" id="kobo.551.1">This makes code standards apparent during the development process and reduces the odds of a peer review of important code changes breaking down into a discussion of the appropriate placement of opening curly braces or the use </span><span class="No-Break"><span class="koboSpan" id="kobo.552.1">of </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.553.1">var</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.554.1">.</span></span></p>
<h1 id="_idParaDest-352"><a id="_idTextAnchor351"/><span class="koboSpan" id="kobo.555.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.556.1">Code standards are important for helping your team focus on productive things and ensuring source code can be easily maintained by all developers on </span><span class="No-Break"><span class="koboSpan" id="kobo.557.1">your team.</span></span></p>
<p><span class="koboSpan" id="kobo.558.1">While code standards don’t need to include everything, it can be helpful to codify stances on commonly contested items or best practices your team wants to make sure absolutely every </span><span class="No-Break"><span class="koboSpan" id="kobo.559.1">change follows.</span></span></p>
<p><span class="koboSpan" id="kobo.560.1">Visual Studio provides a number of features that help ensure a consistent and high-quality codebase including code formatting, code cleanup profiles, formatting on save, code analysis warning profiles, code styles at the editor level, and EditorConfigs to configure code styles inside of </span><span class="No-Break"><span class="koboSpan" id="kobo.561.1">your editor.</span></span></p>
<p><span class="koboSpan" id="kobo.562.1">In the final chapter of this book, we’ll discuss refactoring code as part of a larger organization and as part of an agile software </span><span class="No-Break"><span class="koboSpan" id="kobo.563.1">development team.</span></span></p>
<h1 id="_idParaDest-353"><a id="_idTextAnchor352"/><span class="koboSpan" id="kobo.564.1">Questions</span></h1>
<ol>
<li><span class="koboSpan" id="kobo.565.1">How do you determine what code standards your team </span><span class="No-Break"><span class="koboSpan" id="kobo.566.1">should adopt?</span></span></li>
<li><span class="koboSpan" id="kobo.567.1">What are some ways you can handle disagreements on </span><span class="No-Break"><span class="koboSpan" id="kobo.568.1">style rules?</span></span></li>
<li><span class="koboSpan" id="kobo.569.1">What are some options for configuring how Visual Studio </span><span class="No-Break"><span class="koboSpan" id="kobo.570.1">formats code?</span></span></li>
<li><span class="koboSpan" id="kobo.571.1">What does the </span><strong class="bold"><span class="koboSpan" id="kobo.572.1">New EditorConfig (IntelliCode)</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.573.1">option do?</span></span></li>
</ol>
<h1 id="_idParaDest-354"><a id="_idTextAnchor353"/><span class="koboSpan" id="kobo.574.1">Further reading</span></h1>
<p><span class="koboSpan" id="kobo.575.1">You can find more information about materials from this chapter at </span><span class="No-Break"><span class="koboSpan" id="kobo.576.1">these URLs:</span></span></p>
<ul>
<li><em class="italic"><span class="koboSpan" id="kobo.577.1">Framework design </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.578.1">guidelines</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.579.1">: </span></span><a href="https://learn.microsoft.com/en-us/dotnet/standard/design-guidelines/"><span class="No-Break"><span class="koboSpan" id="kobo.580.1">https://learn.microsoft.com/en-us/dotnet/standard/design-guidelines/</span></span></a></li>
<li><em class="italic"><span class="koboSpan" id="kobo.581.1">.NET coding style </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.582.1">guidelines</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.583.1">: </span></span><a href="https://learn.microsoft.com/en-us/dotnet/csharp/fundamentals/coding-style/coding-conventions"><span class="No-Break"><span class="koboSpan" id="kobo.584.1">https://learn.microsoft.com/en-us/dotnet/csharp/fundamentals/coding-style/coding-conventions</span></span></a></li>
<li><em class="italic"><span class="koboSpan" id="kobo.585.1">Create portable, custom editor settings with </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.586.1">EditorConfig</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.587.1">: </span></span><a href="https://learn.microsoft.com/en-us/visualstudio/ide/create-portable-custom-editor-options"><span class="No-Break"><span class="koboSpan" id="kobo.588.1">https://learn.microsoft.com/en-us/visualstudio/ide/create-portable-custom-editor-options</span></span></a></li>
<li><em class="italic"><span class="koboSpan" id="kobo.589.1">Beginner friendly EditorConfig </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.590.1">settings</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.591.1">:</span></span><span class="No-Break"> </span><a href="https://newdevsguide.com/2022/11/22/beginner-friendly-csharp/"><span class="No-Break"><span class="koboSpan" id="kobo.592.1">https://newdevsguide.com/2022/11/22/beginner-friendly-csharp/</span></span></a></li>
<li><em class="italic"><span class="koboSpan" id="kobo.593.1">Using EditorConfig in VS Code with C# Dev </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.594.1">Kit</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.595.1">: </span></span><a href="https://code.visualstudio.com/docs/csharp/formatting-linting#_how-to-support-editorconfig-with-c-dev-kit"><span class="No-Break"><span class="koboSpan" id="kobo.596.1">https://code.visualstudio.com/docs/csharp/formatting-linting#_how-to-support-editorconfig-with-c-dev-kit</span></span></a></li>
<li><em class="italic"><span class="koboSpan" id="kobo.597.1">Using EditorConfig in JetBrains </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.598.1">Rider</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.599.1">:</span></span><span class="No-Break"><em class="italic"> </em></span><a href="https://www.jetbrains.com/help/rider/Using_EditorConfig.html"><span class="No-Break"><span class="koboSpan" id="kobo.600.1">https://www.jetbrains.com/help/rider/Using_EditorConfig.html</span></span></a></li>
</ul>
</div>
</body></html>