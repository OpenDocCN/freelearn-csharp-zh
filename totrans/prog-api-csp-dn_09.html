<html><head></head><body>
  <div id="_idContainer098">
   <h1 class="chapter-number" id="_idParaDest-126">
    <a id="_idTextAnchor126">
    </a>
    <span class="koboSpan" id="kobo.1.1">
     9
    </span>
   </h1>
   <h1 id="_idParaDest-127">
    <a id="_idTextAnchor127">
    </a>
    <span class="koboSpan" id="kobo.2.1">
     Authentication  and Authorization
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.3.1">
     In the previous chapter, we reviewed a number of advanced API topics.
    </span>
    <span class="koboSpan" id="kobo.3.2">
     In this chapter, you will learn how to add authentication (which answers questions such as “is this user who they say they are?”) and authorization (“is this user allowed to take this action?”).
    </span>
    <span class="koboSpan" id="kobo.3.3">
     We will use the Azure function from
    </span>
    <a href="B21998_06.xhtml#_idTextAnchor077">
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.4.1">
        Chapter 6
       </span>
      </em>
     </span>
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.5.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.6.1">
     In this chapter, we will cover the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.7.1">
      following topics:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.8.1">
      Differences between authentication
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.9.1">
       and authorization
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.10.1">
      Definitions of authentication
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.11.1">
       and authorization
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.12.1">
      A walkthrough of authentication – proving who
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.13.1">
       you are
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.14.1">
      A walkthrough of authorization – testing if you can take a
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.15.1">
       specific action
      </span>
     </span>
    </li>
   </ul>
   <h1 id="_idParaDest-128">
    <a id="_idTextAnchor128">
    </a>
    <span class="koboSpan" id="kobo.16.1">
     Technical requirements
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.17.1">
     For this chapter, you will need
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.18.1">
      the following:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.19.1">
       Visual Studio
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.20.1">
      An Azure Account (you can get a free starter account
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.21.1">
       at
      </span>
     </span>
     <a href="https://azure.mcrosoft.com">
      <span class="No-Break">
       <span class="koboSpan" id="kobo.22.1">
        https://azure.mcrosoft.com
       </span>
      </span>
     </a>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.23.1">
       )
      </span>
     </span>
    </li>
   </ol>
   <p>
    <span class="koboSpan" id="kobo.24.1">
     Note that much of this chapter relies on the code and action from
    </span>
    <a href="B21998_06.xhtml#_idTextAnchor077">
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.25.1">
        Chapter 6
       </span>
      </em>
     </span>
    </a>
    <span class="koboSpan" id="kobo.26.1">
     .
    </span>
    <span class="koboSpan" id="kobo.26.2">
     If you don’t have the code, you can download it from the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.27.1">
      repository:
     </span>
    </span>
    <a href="https://github.com/PacktPublishing/Programming-APIs-with-C-Sharp-and-.NET/tree/main/Chapter06">
     <span class="No-Break">
      <span class="koboSpan" id="kobo.28.1">
       https://github.com/PacktPublishing/Programming-APIs-with-C-Sharp-and-.NET/tree/main/Chapter06
      </span>
     </span>
    </a>
   </p>
   <p>
    <span class="koboSpan" id="kobo.29.1">
     The code for this chapter is available
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.30.1">
      at
     </span>
    </span>
    <a href="https://github.com/PacktPublishing/Programming-APIs-with-C-Sharp-and-.NET/tree/main/Chapter09">
     <span class="No-Break">
      <span class="koboSpan" id="kobo.31.1">
       https://github.com/PacktPublishing/Programming-APIs-with-C-Sharp-and-.NET/tree/main/Chapter09
      </span>
     </span>
    </a>
   </p>
   <h1 id="_idParaDest-129">
    <a id="_idTextAnchor129">
    </a>
    <span class="koboSpan" id="kobo.32.1">
     Introduction to authentication and authorization
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.33.1">
     The vast majority of applications
    </span>
    <a id="_idIndexMarker265">
    </a>
    <span class="koboSpan" id="kobo.34.1">
     will need some form of
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.35.1">
      authentication and authorization
     </span>
    </strong>
    <span class="koboSpan" id="kobo.36.1">
     (
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.37.1">
      A&amp;A
     </span>
    </strong>
    <span class="koboSpan" id="kobo.38.1">
     ).
    </span>
    <span class="koboSpan" id="kobo.38.2">
     Authentication is the process of proving who you are, while authorization is the process of determining whether you have permission to do what you are trying to do.
    </span>
    <span class="koboSpan" id="kobo.38.3">
     Typically, you authenticate first, perhaps once per session, and then authorization is checked for each action
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.39.1">
      you attempt.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.40.1">
     There are many different types of A&amp;A, but since we’re focusing mostly on Azure, we’ll use their built-in feature set
    </span>
    <a id="_idIndexMarker266">
    </a>
    <span class="koboSpan" id="kobo.41.1">
     colloquially known as
    </span>
    <span class="No-Break">
     <strong class="bold">
      <span class="koboSpan" id="kobo.42.1">
       Easy Auth
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.43.1">
      .
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-130">
    <a id="_idTextAnchor130">
    </a>
    <span class="koboSpan" id="kobo.44.1">
     Overview of A&amp;A
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.45.1">
     Though there are
    </span>
    <a id="_idIndexMarker267">
    </a>
    <span class="koboSpan" id="kobo.46.1">
     many kinds of A&amp;A, including many nuances such as the authentication of services, users, and so on, we’ll focus on A&amp;A for a single user in an Azure Tenant.
    </span>
    <span class="koboSpan" id="kobo.46.2">
     That will usually be an employee during debugging (you!).
    </span>
    <span class="koboSpan" id="kobo.46.3">
     This will then allow you to extend these concepts so that other services you create can be authorized in the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.47.1">
      same way.
     </span>
    </span>
   </p>
   <p class="callout-heading">
    <span class="koboSpan" id="kobo.48.1">
     Tenant
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.49.1">
     A tenant in Azure is a Guid that specifies all the content of a
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.50.1">
      single organization.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-131">
    <a id="_idTextAnchor131">
    </a>
    <span class="koboSpan" id="kobo.51.1">
     Enabling authentication on existing functions
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.52.1">
     Let’s begin by
    </span>
    <a id="_idIndexMarker268">
    </a>
    <span class="koboSpan" id="kobo.53.1">
     adding authentication to an existing Azure function.
    </span>
    <span class="koboSpan" id="kobo.53.2">
     To do so, follow
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.54.1">
      these steps:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.55.1">
      Open your Azure Function resource from
     </span>
     <a href="B21998_06.xhtml#_idTextAnchor077">
      <span class="No-Break">
       <em class="italic">
        <span class="koboSpan" id="kobo.56.1">
         Chapter 6
        </span>
       </em>
      </span>
     </a>
     <span class="koboSpan" id="kobo.57.1">
      and navigate to the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.58.1">
       Authentication
      </span>
     </strong>
     <span class="koboSpan" id="kobo.59.1">
      section, as shown in
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.60.1">
        Figure 9
       </span>
      </em>
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.61.1">
        .1
       </span>
      </em>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.62.1">
       .
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer092">
     <span class="koboSpan" id="kobo.63.1">
      <img alt="Figure 9.1 – Selecting Authentication" src="image/B21998_09_1.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.64.1">
     Figure 9.1 – Selecting Authentication
    </span>
   </p>
   <ol>
    <li value="2">
     <span class="koboSpan" id="kobo.65.1">
      Click
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.66.1">
       Add Identity Provider
      </span>
     </strong>
     <span class="koboSpan" id="kobo.67.1">
      , and then select
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.68.1">
       Microsoft
      </span>
     </strong>
     <span class="koboSpan" id="kobo.69.1">
      .
     </span>
     <span class="koboSpan" id="kobo.69.2">
      Use the following configuration
     </span>
     <a id="_idIndexMarker269">
     </a>
     <span class="koboSpan" id="kobo.70.1">
      options (they are almost
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.71.1">
       all default):
      </span>
     </span>
     <ul>
      <li>
       <strong class="bold">
        <span class="koboSpan" id="kobo.72.1">
         Choose
        </span>
       </strong>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.73.1">
          a tenant
         </span>
        </strong>
       </span>
       <ul>
        <li>
         <strong class="bold">
          <span class="koboSpan" id="kobo.74.1">
           Workforce
          </span>
         </strong>
         <span class="No-Break">
          <strong class="bold">
           <span class="koboSpan" id="kobo.75.1">
            configuration
           </span>
          </strong>
         </span>
         <span class="No-Break">
          <span class="koboSpan" id="kobo.76.1">
           (default)
          </span>
         </span>
        </li>
       </ul>
      </li>
      <li>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.77.1">
          App registration
         </span>
        </strong>
       </span>
       <ul>
        <li>
         <strong class="bold">
          <span class="koboSpan" id="kobo.78.1">
           App registration type
          </span>
         </strong>
         <span class="koboSpan" id="kobo.79.1">
          :
         </span>
         <strong class="bold">
          <span class="koboSpan" id="kobo.80.1">
           Create new app
          </span>
         </strong>
         <span class="No-Break">
          <strong class="bold">
           <span class="koboSpan" id="kobo.81.1">
            registration
           </span>
          </strong>
         </span>
         <span class="No-Break">
          <span class="koboSpan" id="kobo.82.1">
           (default)
          </span>
         </span>
        </li>
        <li>
         <strong class="bold">
          <span class="koboSpan" id="kobo.83.1">
           Name
          </span>
         </strong>
         <span class="koboSpan" id="kobo.84.1">
          : The default is likely the name of your existing Function App resource; in this
         </span>
         <a id="_idIndexMarker270">
         </a>
         <span class="koboSpan" id="kobo.85.1">
          case, it
         </span>
         <span class="No-Break">
          <span class="koboSpan" id="kobo.86.1">
           is
          </span>
         </span>
         <span class="No-Break">
          <strong class="bold">
           <span class="koboSpan" id="kobo.87.1">
            Functions
           </span>
          </strong>
         </span>
         <span class="No-Break">
          <span class="koboSpan" id="kobo.88.1">
           .
          </span>
         </span>
        </li>
        <li>
         <strong class="bold">
          <span class="koboSpan" id="kobo.89.1">
           Client secret expiration
          </span>
         </strong>
         <span class="koboSpan" id="kobo.90.1">
          :
         </span>
         <strong class="bold">
          <span class="koboSpan" id="kobo.91.1">
           Recommended: 180
          </span>
         </strong>
         <span class="No-Break">
          <strong class="bold">
           <span class="koboSpan" id="kobo.92.1">
            days
           </span>
          </strong>
         </span>
         <span class="No-Break">
          <span class="koboSpan" id="kobo.93.1">
           (default)
          </span>
         </span>
        </li>
        <li>
         <strong class="bold">
          <span class="koboSpan" id="kobo.94.1">
           Supported account types
          </span>
         </strong>
         <span class="koboSpan" id="kobo.95.1">
          :
         </span>
         <strong class="bold">
          <span class="koboSpan" id="kobo.96.1">
           Current tenant – Single
          </span>
         </strong>
         <span class="No-Break">
          <strong class="bold">
           <span class="koboSpan" id="kobo.97.1">
            tenant
           </span>
          </strong>
         </span>
         <span class="No-Break">
          <span class="koboSpan" id="kobo.98.1">
           (default)
          </span>
         </span>
        </li>
       </ul>
      </li>
      <li>
       <strong class="bold">
        <span class="koboSpan" id="kobo.99.1">
         Additional
        </span>
       </strong>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.100.1">
          checks
         </span>
        </strong>
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.101.1">
         (default)
        </span>
       </span>
       <ul>
        <li>
         <strong class="bold">
          <span class="koboSpan" id="kobo.102.1">
           Client application requirement
          </span>
         </strong>
         <span class="koboSpan" id="kobo.103.1">
          :
         </span>
         <strong class="bold">
          <span class="koboSpan" id="kobo.104.1">
           Allow requests only from this application
          </span>
         </strong>
         <span class="No-Break">
          <strong class="bold">
           <span class="koboSpan" id="kobo.105.1">
            itself
           </span>
          </strong>
         </span>
         <span class="No-Break">
          <span class="koboSpan" id="kobo.106.1">
           (default)
          </span>
         </span>
        </li>
        <li>
         <strong class="bold">
          <span class="koboSpan" id="kobo.107.1">
           Identity requirement
          </span>
         </strong>
         <span class="koboSpan" id="kobo.108.1">
          :
         </span>
         <strong class="bold">
          <span class="koboSpan" id="kobo.109.1">
           Allow requests from any
          </span>
         </strong>
         <span class="No-Break">
          <strong class="bold">
           <span class="koboSpan" id="kobo.110.1">
            identity
           </span>
          </strong>
         </span>
         <span class="No-Break">
          <span class="koboSpan" id="kobo.111.1">
           (default)
          </span>
         </span>
        </li>
        <li>
         <strong class="bold">
          <span class="koboSpan" id="kobo.112.1">
           Tenant requirement
          </span>
         </strong>
         <span class="koboSpan" id="kobo.113.1">
          :
         </span>
         <strong class="bold">
          <span class="koboSpan" id="kobo.114.1">
           Allow requests only from the issuer tenant
          </span>
         </strong>
         <span class="koboSpan" id="kobo.115.1">
          (your tenant GUID
         </span>
         <span class="No-Break">
          <span class="koboSpan" id="kobo.116.1">
           goes here)
          </span>
         </span>
        </li>
       </ul>
      </li>
      <li>
       <strong class="bold">
        <span class="koboSpan" id="kobo.117.1">
         App Service authentication
        </span>
       </strong>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.118.1">
          settings
         </span>
        </strong>
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.119.1">
         (default)
        </span>
       </span>
       <ul>
        <li>
         <strong class="bold">
          <span class="koboSpan" id="kobo.120.1">
           Restrict access
          </span>
         </strong>
         <span class="koboSpan" id="kobo.121.1">
          :
         </span>
         <strong class="bold">
          <span class="koboSpan" id="kobo.122.1">
           Require
          </span>
         </strong>
         <span class="No-Break">
          <strong class="bold">
           <span class="koboSpan" id="kobo.123.1">
            authentication
           </span>
          </strong>
         </span>
         <span class="No-Break">
          <span class="koboSpan" id="kobo.124.1">
           (default)
          </span>
         </span>
        </li>
        <li>
         <strong class="bold">
          <span class="koboSpan" id="kobo.125.1">
           Unauthenticated requests
          </span>
         </strong>
         <span class="koboSpan" id="kobo.126.1">
          :
         </span>
         <strong class="bold">
          <span class="koboSpan" id="kobo.127.1">
           HTTP 401 Unauthorized: recommended for
          </span>
         </strong>
         <span class="No-Break">
          <strong class="bold">
           <span class="koboSpan" id="kobo.128.1">
            APIs
           </span>
          </strong>
         </span>
         <span class="No-Break">
          <span class="koboSpan" id="kobo.129.1">
           (default)
          </span>
         </span>
        </li>
       </ul>
      </li>
      <li>
       <strong class="bold">
        <span class="koboSpan" id="kobo.130.1">
         Token
        </span>
       </strong>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.131.1">
          Store
         </span>
        </strong>
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.132.1">
         :
        </span>
       </span>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.133.1">
          Checked
         </span>
        </strong>
       </span>
       <p class="list-inset">
        <span class="koboSpan" id="kobo.134.1">
         To put this all together, see
        </span>
        <span class="No-Break">
         <em class="italic">
          <span class="koboSpan" id="kobo.135.1">
           Figure 9
          </span>
         </em>
        </span>
        <span class="No-Break">
         <em class="italic">
          <span class="koboSpan" id="kobo.136.1">
           .2
          </span>
         </em>
        </span>
        <span class="No-Break">
         <span class="koboSpan" id="kobo.137.1">
          .
         </span>
        </span>
       </p>
      </li>
     </ul>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer093">
     <span class="koboSpan" id="kobo.138.1">
      <img alt="Figure 9.2 – Adding an identity provider" src="image/B21998_09_2.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.139.1">
     Figure 9.2 – Adding an identity provider
    </span>
   </p>
   <ol>
    <li value="3">
     <span class="koboSpan" id="kobo.140.1">
      We can skip
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.141.1">
       Permissions
      </span>
     </strong>
     <span class="koboSpan" id="kobo.142.1">
      for now, so
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.143.1">
       click
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.144.1">
        Add
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.145.1">
       .
      </span>
     </span>
     <p class="list-inset">
      <span class="koboSpan" id="kobo.146.1">
       You will be returned to your
      </span>
      <strong class="bold">
       <span class="koboSpan" id="kobo.147.1">
        Authentication
       </span>
      </strong>
      <span class="koboSpan" id="kobo.148.1">
       blade, showing your new Microsoft
      </span>
      <span class="No-Break">
       <span class="koboSpan" id="kobo.149.1">
        Identity
       </span>
      </span>
      <span class="No-Break">
       <a id="_idIndexMarker271">
       </a>
      </span>
      <span class="No-Break">
       <span class="koboSpan" id="kobo.150.1">
        provider.
       </span>
      </span>
     </p>
    </li>
    <li>
     <span class="koboSpan" id="kobo.151.1">
      Click on the name of your Identity provider or navigate back to the main Azure portal.
     </span>
     <span class="koboSpan" id="kobo.151.2">
      Click on
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.152.1">
       Microsoft Entra ID
      </span>
     </strong>
     <span class="koboSpan" id="kobo.153.1">
      , select
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.154.1">
       App registrations
      </span>
     </strong>
     <span class="koboSpan" id="kobo.155.1">
      , then
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.156.1">
       your app.
      </span>
     </span>
    </li>
   </ol>
   <p>
    <span class="koboSpan" id="kobo.157.1">
     This is your configuration area to manage various things about the app’s authentication.
    </span>
    <span class="koboSpan" id="kobo.157.2">
     We’ll be editing this in a bit but try to run or navigate to your existing Function app’s HTTP trigger like you did in
    </span>
    <a href="B21998_06.xhtml#_idTextAnchor077">
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.158.1">
        Chapter 6
       </span>
      </em>
     </span>
    </a>
    <span class="koboSpan" id="kobo.159.1">
     .
    </span>
    <span class="koboSpan" id="kobo.159.2">
     You should see that it now shows
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.160.1">
      401
     </span>
    </strong>
    <span class="No-Break">
     <strong class="bold">
      <span class="koboSpan" id="kobo.161.1">
       error (Unauthorized)
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.162.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.163.1">
     Next, we’ll authenticate to the new Identity Provider in two ways to give you an idea of different
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.164.1">
      use cases.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-132">
    <a id="_idTextAnchor132">
    </a>
    <span class="koboSpan" id="kobo.165.1">
     Programmatically accessing your API
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.166.1">
     Open your Function in Visual Studio from
    </span>
    <a href="B21998_06.xhtml#_idTextAnchor077">
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.167.1">
        Chapter 6
       </span>
      </em>
     </span>
    </a>
    <span class="koboSpan" id="kobo.168.1">
     .
    </span>
    <span class="koboSpan" id="kobo.168.2">
     Right-click on the solution in
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.169.1">
      Solution Explorer
     </span>
    </strong>
    <span class="koboSpan" id="kobo.170.1">
     and click on
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.171.1">
      Add New Project...
     </span>
     <span class="koboSpan" id="kobo.171.2">
      Add a .NET Console app
     </span>
    </strong>
    <span class="koboSpan" id="kobo.172.1">
     .
    </span>
    <span class="koboSpan" id="kobo.172.2">
     Add the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.173.1">
      Azure.Identity
     </span>
    </strong>
    <span class="koboSpan" id="kobo.174.1">
     NuGet package, and then create a
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.175.1">
       DefaultAzureCredential
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.176.1">
      instance.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.177.1">
     There are many different
    </span>
    <a id="_idIndexMarker272">
    </a>
    <span class="koboSpan" id="kobo.178.1">
     credential classes that inherit from a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.179.1">
      TokenCredential
     </span>
    </strong>
    <span class="koboSpan" id="kobo.180.1">
     base class implementing different use cases, but the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.181.1">
      DefaultAzureCredential
     </span>
    </strong>
    <span class="koboSpan" id="kobo.182.1">
     tries a number of different credentials in order so that it can easily be used in several different scenarios.
    </span>
    <span class="koboSpan" id="kobo.182.2">
     Use the following boilerplate code to securely call
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.183.1">
      your Function:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.184.1">
DefaultAzureCredential cred = new DefaultAzureCredential(new DefaultAzureCredentialOptions
            {
                TenantId = &lt;your tenant ID&gt;
            });
Azure.Core.AccessToken token = await cred.GetTokenAsync(new Azure.Core.TokenRequestContext(new string[]
           {
               &lt;clientId&gt;
           }), CancellationToken.None);
var message = new HttpRequestMessage(HttpMethod.Get,</span><strong class="source-inline"> </strong><span class="koboSpan" id="kobo.185.1">"https://&lt;your function</span><strong class="source-inline"> </strong><span class="koboSpan" id="kobo.186.1">resource&gt;.azurewebsites.net/api/Function1");
            message.Headers.Authorization = new 
            AuthenticationHeaderValue("Bearer", token.Token);
            HttpResponseMessage resp = await new HttpClient().
</span><span class="koboSpan" id="kobo.186.2">            SendAsync(message);//inject the HttpClient in a production 
                              //app
            resp.EnsureSuccessStatusCode();
            string content = await resp.Content.ReadAsStringAsync();
            Console.WriteLine(content);</span></pre>
   <p>
    <span class="koboSpan" id="kobo.187.1">
     Try to run it now, and it should throw an error on
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.188.1">
      resp.EnsureSuccessStatusCode();
     </span>
    </strong>
    <span class="koboSpan" id="kobo.189.1">
     .
    </span>
    <span class="koboSpan" id="kobo.189.2">
     This is because we have not told our API that you as a user (via Visual
    </span>
    <a id="_idIndexMarker273">
    </a>
    <span class="koboSpan" id="kobo.190.1">
     Studio’s helper authentication client) are allowed to make calls to
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.191.1">
      your API.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.192.1">
     In a development environment, we can authorize the well-known client ID to the API.
    </span>
    <span class="koboSpan" id="kobo.192.2">
     To do so, in the Azure Portal, navigate to your Function
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.193.1">
      resource again:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.194.1">
      In the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.195.1">
       Authentication
      </span>
     </strong>
     <span class="koboSpan" id="kobo.196.1">
      blade, click the pencil icon under the
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.197.1">
        Edit
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.198.1">
       heading.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.199.1">
      Select
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.200.1">
       Allow Requests From Specific Client Applications
      </span>
     </strong>
     <span class="koboSpan" id="kobo.201.1">
      if it isn’t already selected, and then add
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.202.1">
       04f0c124-f2bc-4f59-8241-bf6df9866bbd
      </span>
     </strong>
     <span class="koboSpan" id="kobo.203.1">
      .
     </span>
     <span class="koboSpan" id="kobo.203.2">
      Click
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.204.1">
       OK
      </span>
     </strong>
     <span class="koboSpan" id="kobo.205.1">
      and
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.206.1">
       then
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.207.1">
        Save
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.208.1">
       .
      </span>
     </span>
     <p class="list-inset">
      <span class="koboSpan" id="kobo.209.1">
       We’ll be doing this again later in
      </span>
      <span class="No-Break">
       <span class="koboSpan" id="kobo.210.1">
        this chapter.
       </span>
      </span>
     </p>
    </li>
    <li>
     <span class="koboSpan" id="kobo.211.1">
      Go back to Visual Studio and run the console
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.212.1">
       application again.
      </span>
     </span>
    </li>
   </ol>
   <p>
    <span class="koboSpan" id="kobo.213.1">
     The call to your API should now succeed and will print out the data you configured in your API’s Environment variables blade in
    </span>
    <a href="B21998_06.xhtml#_idTextAnchor077">
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.214.1">
        Chapter 6
       </span>
      </em>
     </span>
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.215.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.216.1">
     Next, we’ll try to use
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.217.1">
      ClientSecretCredential
     </span>
    </strong>
    <span class="koboSpan" id="kobo.218.1">
     .
    </span>
    <span class="koboSpan" id="kobo.218.2">
     To do so, follow
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.219.1">
      these instructions:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.220.1">
      Navigate to the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.221.1">
       Certificates &amp; Secrets
      </span>
     </strong>
     <span class="koboSpan" id="kobo.222.1">
      blade in the app registration and click
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.223.1">
       New
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.224.1">
        Client Secret
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.225.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.226.1">
      Enter a description
     </span>
     <a id="_idIndexMarker274">
     </a>
     <span class="koboSpan" id="kobo.227.1">
      and expiration time, and
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.228.1">
       click
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.229.1">
        Add
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.230.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.231.1">
      Copy the value somewhere (e.g., Notepad), as you will not be able to access it again.
     </span>
     <span class="koboSpan" id="kobo.231.2">
      Modify the code by adding a new
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.232.1">
       ClientSecretCredential
      </span>
     </strong>
     <span class="koboSpan" id="kobo.233.1">
      instance instead of the existing credentials you might already have.
     </span>
     <span class="koboSpan" id="kobo.233.2">
      You’ll need the Tenant ID and Client ID available in the
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.234.1">
        Overview
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.235.1">
       blade:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.236.1">
ClientSecretCredential cred = new ClientSecretCredential(&lt;tenantId&gt;, &lt;clientId&gt;, &lt;clientSecret&gt;);</span></pre>
    </li>
   </ol>
   <p>
    <span class="koboSpan" id="kobo.237.1">
     The existing call to
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.238.1">
      GetTokenAsync
     </span>
    </strong>
    <span class="koboSpan" id="kobo.239.1">
     should work without changes.
    </span>
    <span class="koboSpan" id="kobo.239.2">
     The rest of the code including the HTTP call itself should run successfully as is, and you should again see your configured
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.240.1">
      API string.
     </span>
    </span>
   </p>
   <p class="callout-heading">
    <span class="koboSpan" id="kobo.241.1">
     Note
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.242.1">
     All of the preceding strings are available in the code from
    </span>
    <a href="B21998_06.xhtml#_idTextAnchor077">
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.243.1">
        Chapter 6
       </span>
      </em>
     </span>
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.244.1">
      .
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-133">
    <a id="_idTextAnchor133">
    </a>
    <span class="koboSpan" id="kobo.245.1">
     Authorizing additional Azure Resources
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.246.1">
     You’ll almost certainly
    </span>
    <a id="_idIndexMarker275">
    </a>
    <span class="koboSpan" id="kobo.247.1">
     need additional Azure services to complement your cloud solution, so let’s try to authorize one to call your API.
    </span>
    <span class="koboSpan" id="kobo.247.2">
     To do so, follow
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.248.1">
      these instructions:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.249.1">
      Go to the Azure portal, and then your existing Resource group.
     </span>
     <span class="koboSpan" id="kobo.249.2">
      Create a new Logic app, and select
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.250.1">
       Consumption
      </span>
     </strong>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.251.1">
       for hosting.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.252.1">
      Give it a name and select the same
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.253.1">
       Region
      </span>
     </strong>
     <span class="koboSpan" id="kobo.254.1">
      that your other Resources
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.255.1">
       are in.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.256.1">
      When it completes deployment, select the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.257.1">
       Identity blade
      </span>
     </strong>
     <span class="koboSpan" id="kobo.258.1">
      , change the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.259.1">
       Status
      </span>
     </strong>
     <span class="koboSpan" id="kobo.260.1">
      to
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.261.1">
       On
      </span>
     </strong>
     <span class="koboSpan" id="kobo.262.1">
      , and click
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.263.1">
       Save
      </span>
     </strong>
     <span class="koboSpan" id="kobo.264.1">
      and
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.265.1">
       then
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.266.1">
        Yes
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.267.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.268.1">
      Select the Logic
     </span>
     <a id="_idIndexMarker276">
     </a>
     <span class="koboSpan" id="kobo.269.1">
      app designer blade.
     </span>
     <span class="koboSpan" id="kobo.269.2">
      Add a new HTTP trigger, enter your deployed Function URI (likely https://&lt;my
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.270.1">
       resource name&gt;.azurewebsites.net/api/Function1
      </span>
     </strong>
     <span class="koboSpan" id="kobo.271.1">
      ), and the
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.272.1">
        GET
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.273.1">
       method.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.274.1">
      Click
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.275.1">
       Show All
      </span>
     </strong>
     <span class="koboSpan" id="kobo.276.1">
      for
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.277.1">
       Advanced parameters
      </span>
     </strong>
     <span class="koboSpan" id="kobo.278.1">
      and select
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.279.1">
       Managed Identity
      </span>
     </strong>
     <span class="koboSpan" id="kobo.280.1">
      under
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.281.1">
       Authentication Type
      </span>
     </strong>
     <span class="koboSpan" id="kobo.282.1">
      .
     </span>
     <span class="koboSpan" id="kobo.282.2">
      It should resemble
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.283.1">
        Figure 9
       </span>
      </em>
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.284.1">
        .3
       </span>
      </em>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.285.1">
       .
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer094">
     <span class="koboSpan" id="kobo.286.1">
      <img alt="Figure 9.3 – Advanced Parameters" src="image/B21998_09_3.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.287.1">
     Figure 9.3 – Advanced Parameters
    </span>
   </p>
   <ol>
    <li value="6">
     <span class="koboSpan" id="kobo.288.1">
      Click
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.289.1">
       Save
      </span>
     </strong>
     <span class="koboSpan" id="kobo.290.1">
      .
     </span>
     <span class="koboSpan" id="kobo.290.2">
      Go
     </span>
     <a id="_idIndexMarker277">
     </a>
     <span class="koboSpan" id="kobo.291.1">
      back to the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.292.1">
       Overview
      </span>
     </strong>
     <span class="koboSpan" id="kobo.293.1">
      blade and
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.294.1">
       click
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.295.1">
        Run
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.296.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.297.1">
      Click on the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.298.1">
       Trigger history
      </span>
     </strong>
     <span class="koboSpan" id="kobo.299.1">
      tab and notice that it is red, indicating
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.300.1">
       a failure.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.301.1">
      Click on the failed trigger, and then click the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.302.1">
       Outputs
      </span>
     </strong>
     <span class="koboSpan" id="kobo.303.1">
      link.
     </span>
     <span class="koboSpan" id="kobo.303.2">
      It should show
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.304.1">
       403 error (Forbidden)
      </span>
     </strong>
     <span class="koboSpan" id="kobo.305.1">
      , indicating that the service authenticated you correctly, but you were
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.306.1">
       not authorized.
      </span>
     </span>
     <p class="list-inset">
      <span class="koboSpan" id="kobo.307.1">
       To authorize this Logic app to call your Function API, we need to add its client ID to the list of authorized clients that can call
      </span>
      <span class="No-Break">
       <span class="koboSpan" id="kobo.308.1">
        your API.
       </span>
      </span>
     </p>
    </li>
    <li>
     <span class="koboSpan" id="kobo.309.1">
      Go back to
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.310.1">
       Azure Portal Home
      </span>
     </strong>
     <span class="koboSpan" id="kobo.311.1">
      and click on
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.312.1">
       Microsoft Entra ID
      </span>
     </strong>
     <span class="koboSpan" id="kobo.313.1">
      .
     </span>
     <span class="koboSpan" id="kobo.313.2">
      Search for your Logic app’s name in the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.314.1">
       Search Your Tenant
      </span>
     </strong>
     <span class="koboSpan" id="kobo.315.1">
      text box.
     </span>
     <span class="koboSpan" id="kobo.315.2">
      It should have an entry under the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.316.1">
       Enterprise
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.317.1">
        Applications
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.318.1">
       section.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.319.1">
      Next, click on that
     </span>
     <a id="_idIndexMarker278">
     </a>
     <span class="koboSpan" id="kobo.320.1">
      and then copy the GUID under
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.321.1">
        Application ID
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.322.1">
       .
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer095">
     <span class="koboSpan" id="kobo.323.1">
      <img alt="Figure 9.4 – Authorization" src="image/B21998_09_4.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.324.1">
     Figure 9.4 – Authorization
    </span>
   </p>
   <p class="callout-heading">
    <span class="koboSpan" id="kobo.325.1">
     Note
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.326.1">
     Some of the fields in
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.327.1">
       Figure 9
      </span>
     </em>
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.328.1">
      .4
     </span>
    </em>
    <span class="koboSpan" id="kobo.329.1">
     have been obscured as a
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.330.1">
      security measure.
     </span>
    </span>
   </p>
   <ol>
    <li value="11">
     <span class="koboSpan" id="kobo.331.1">
      Navigate back to your Function app.
     </span>
     <span class="koboSpan" id="kobo.331.2">
      Find the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.332.1">
       Authentication
      </span>
     </strong>
     <span class="koboSpan" id="kobo.333.1">
      blade, and then click on the pencil as we did before.
     </span>
     <span class="koboSpan" id="kobo.333.2">
      Next, click the other pencil icon next to
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.334.1">
       Allowed client applications
      </span>
     </strong>
     <span class="koboSpan" id="kobo.335.1">
      , and add a new entry with the GUID you just copied, as
     </span>
     <a id="_idIndexMarker279">
     </a>
     <span class="koboSpan" id="kobo.336.1">
      shown in
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.337.1">
        Figure 9
       </span>
      </em>
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.338.1">
        .5
       </span>
      </em>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.339.1">
       .
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer096">
     <span class="koboSpan" id="kobo.340.1">
      <img alt="Figure 9.5 – Adding allowed client applications" src="image/B21998_09_5.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.341.1">
     Figure 9.5 – Adding allowed client applications
    </span>
   </p>
   <ol>
    <li value="12">
     <span class="koboSpan" id="kobo.342.1">
      Click
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.343.1">
       OK
      </span>
     </strong>
     <span class="koboSpan" id="kobo.344.1">
      and
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.345.1">
       then
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.346.1">
        Save
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.347.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.348.1">
      Navigate back to the Logic app, and then click on
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.349.1">
       Run
      </span>
     </strong>
     <span class="koboSpan" id="kobo.350.1">
      |
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.351.1">
       Run
      </span>
     </strong>
     <span class="koboSpan" id="kobo.352.1">
      .
     </span>
     <span class="koboSpan" id="kobo.352.2">
      This should immediately start another run of your Logic app calling
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.353.1">
       your API.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.354.1">
      Click on the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.355.1">
       Trigger history
      </span>
     </strong>
     <span class="koboSpan" id="kobo.356.1">
      tab on the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.357.1">
       Overview
      </span>
     </strong>
     <span class="koboSpan" id="kobo.358.1">
      blade.
     </span>
     <span class="koboSpan" id="kobo.358.2">
      You should see that the latest one has a green status, indicating success, as shown in
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.359.1">
        Figure 9
       </span>
      </em>
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.360.1">
        .6
       </span>
      </em>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.361.1">
       .
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer097">
     <span class="koboSpan" id="kobo.362.1">
      <img alt="Figure 9.6 – Success!" src="image/B21998_09_6.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.363.1">
     Figure 9.6 – Success!
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.364.1">
     If the start time does not match up to what you are expecting, you may have to click
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.365.1">
      Refresh
     </span>
    </strong>
    <span class="koboSpan" id="kobo.366.1">
     at the top of the blade.
    </span>
    <span class="koboSpan" id="kobo.366.2">
     Click the green success indicator and click on
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.367.1">
      Outputs
     </span>
    </strong>
    <span class="koboSpan" id="kobo.368.1">
     again.
    </span>
    <span class="koboSpan" id="kobo.368.2">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.369.1">
      statusCode
     </span>
    </strong>
    <span class="koboSpan" id="kobo.370.1">
     should
    </span>
    <a id="_idIndexMarker280">
    </a>
    <span class="koboSpan" id="kobo.371.1">
     now be
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.372.1">
      200 (OK)
     </span>
    </strong>
    <span class="koboSpan" id="kobo.373.1">
     , and you should once again see the text you configured in the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.374.1">
      Function Environment
     </span>
    </strong>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.375.1">
      variables blade.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-134">
    <a id="_idTextAnchor134">
    </a>
    <span class="koboSpan" id="kobo.376.1">
     Summary
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.377.1">
     In this chapter, you learned the difference between A&amp;A.
    </span>
    <span class="koboSpan" id="kobo.377.2">
     You then saw how to use the Azure controls to establish authentication and authorization for a specific Azure resource.
    </span>
    <span class="koboSpan" id="kobo.377.3">
     In the next chapter, we will learn about
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.378.1">
      Continuous Integration and Continuous Deployment
     </span>
    </strong>
    <span class="koboSpan" id="kobo.379.1">
     (
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.380.1">
      CI/CD
     </span>
    </strong>
    <span class="koboSpan" id="kobo.381.1">
     )
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.382.1">
      on Azure.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-135">
    <a id="_idTextAnchor135">
    </a>
    <span class="koboSpan" id="kobo.383.1">
     You try it
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.384.1">
     Using the deployed function from
    </span>
    <a href="B21998_06.xhtml#_idTextAnchor077">
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.385.1">
        Chapter 6
       </span>
      </em>
     </span>
    </a>
    <span class="koboSpan" id="kobo.386.1">
     , authenticate yourself and give yourself authorization.
    </span>
    <span class="koboSpan" id="kobo.386.2">
     Ensure this succeeds by creating a console app.
    </span>
    <span class="koboSpan" id="kobo.386.3">
     Then create a Logic app and then authorize it to call
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.387.1">
      your API.
     </span>
    </span>
   </p>
  </div>
 </body></html>