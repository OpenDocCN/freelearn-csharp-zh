<html><head></head><body>
		<div><h1 id="_idParaDest-82"><a id="_idTextAnchor081"/>Chapter 6: Adding Code Snippets</h1>
			<p>Coding is a lovely activity, but at times, we have some repeated statements to solve a few known situations, which makes coding more of a monotonous process. <strong class="bold">Code snippets</strong> are a good resource to reuse pieces of code where it's desirable. Visual Studio has some code snippets by default that we can use while we are coding, but we also have some tools to create our own code snippets.</p>
			<p>In this chapter, we will learn about how Visual Studio helps us to write code faster using code snippets and how to create our own.</p>
			<p>We will review the following topics and functionalities for snippets: </p>
			<ul>
				<li>What are code snippets?</li>
				<li>Creating code snippets</li>
				<li>Deleting code snippets</li>
				<li>Importing code snippets</li>
			</ul>
			<p>Let's start recognizing the concept of code snippets and how they work in Visual Studio.</p>
			<h1 id="_idParaDest-83"><a id="_idTextAnchor082"/>Technical requirements</h1>
			<p>To complete the demos of this book chapter, you must have previously installed Visual Studio 2022 with the web development workload, as shown in <a href="B17873_01_ePub.xhtml#_idTextAnchor013"><em class="italic">Chapter 1</em></a>, <em class="italic">Getting Started with Visual Studio 2022</em>. It's important to have the SPA base project that we created in <a href="B17873_04_ePub.xhtml#_idTextAnchor052"><em class="italic">Chapter 4</em></a>, <em class="italic">Creating Projects and Templates</em>.</p>
			<p>You can check the changes made in <code>WeatherForecastController.cs</code> at the following link: <a href="https://github.com/PacktPublishing/Hands-On-Visual-Studio-2022/blob/main/Chapter06/WeatherForecast.cs">https://github.com/PacktPublishing/Hands-On-Visual-Studio-2022/blob/main/Chapter06/WeatherForecast.cs</a>.</p>
			<h1 id="_idParaDest-84"><a id="_idTextAnchor083"/>What are code snippets?</h1>
			<p>Code snippets are a simple and easy way to reuse code by creating templates that generate <a id="_idIndexMarker265"/>common statements, such as conditionals, loops, or comment structures. </p>
			<p>Visual Studio has many code snippets by default for almost all the supported technologies and programming languages. There are many ways to use code snippets in Visual Studio, so let's check them out. </p>
			<p class="callout-heading">Important Note</p>
			<p class="callout">Code snippets are a common concept in software development. Almost all IDEs and code editors provide code snippets or have extensions to include code snippets. </p>
			<p>Using the SPA project created in <a href="B17873_04_ePub.xhtml#_idTextAnchor052"><em class="italic">Chapter 4</em></a>, <em class="italic">Creating Projects and Templates</em>, you will create a new condition to return an empty collection in the <code>Get</code> method by navigating to the <code>WeatherForecastController.cs</code> file. Just write the word <code>if</code> to see the code snippet suggested by Visual Studio (see <em class="italic">Figure 6.1</em>):</p>
			<div><div><img src="img/Figure_6.01_B17873.jpg" alt="Figure 6.1 – The code snippet for the if statement suggested by Visual Studio&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.1 – The code snippet for the if statement suggested by Visual Studio</p>
			<p>Since a conditional statement is a very common piece of code, Visual Studio gives you the option to create this code quickly. You can click on <code>if</code> or continue writing if you don't want to perform any action. You can also press <em class="italic">tab</em> twice to create the <code>if</code> statement automatically. </p>
			<p>There is an option in the <a id="_idIndexMarker266"/>intelligent code completion (also called <strong class="bold">IntelliSense</strong>, about which we <a id="_idIndexMarker267"/>will talk more in <a href="B17873_07_ePub.xhtml#_idTextAnchor088"><em class="italic">Chapter 7</em></a>, <em class="italic">Coding Efficiently with AI and Code Views</em>) suggestions where you can see all the code snippets filtered by the characters that you wrote. See the code snippets filter marked in red in <em class="italic">Figure 6.2</em>:</p>
			<div><div><img src="img/Figure_6.02_B17873.jpg" alt="Figure 6.2 – The code snippets filter in Visual Studio&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.2 – The code snippets filter in Visual Studio</p>
			<p>When the code snippet for the <code>if</code> condition is highlighted, you can press the <em class="italic">tab</em> key twice to generate the code of the <code>if</code> statement, including the brackets (<em class="italic">see Figure 6.3</em>):</p>
			<div><div><img src="img/Figure_6.03_B17873.jpg" alt="Figure 6.3 – The if statement created by Visual Studio&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.3 – The if statement created by Visual Studio</p>
			<p>You will get the <code>if</code> statement, including the braces and <code>true</code> as a default value. You need to replace <code>true</code> with your condition. In this case, you can add a condition to return an <a id="_idIndexMarker268"/>empty collection when the operating system is Linux:</p>
			<pre class="source-code">[HttpGet]</pre>
			<pre class="source-code">public IEnumerable&lt;WeatherForecast&gt; Get()</pre>
			<pre class="source-code">{</pre>
			<pre class="source-code">            if (OperatingSystem.IsLinux())</pre>
			<pre class="source-code">            {</pre>
			<pre class="source-code">                return new List&lt;WeatherForecast&gt;();</pre>
			<pre class="source-code">            }</pre>
			<pre class="source-code">            return Enumerable.Range(1, 5).Select(index =&gt; </pre>
			<pre class="source-code">                new WeatherForecast</pre>
			<pre class="source-code">            {</pre>
			<pre class="source-code">                Date = DateTime.Now.AddDays(index),</pre>
			<pre class="source-code">                TemperatureC = Random.Shared.Next(-20, 55),</pre>
			<pre class="source-code">                Summary = Summaries[Random.Shared.Next</pre>
			<pre class="source-code">                    (Summaries.Length)]</pre>
			<pre class="source-code">            })</pre>
			<pre class="source-code">            .ToArray();</pre>
			<pre class="source-code">}</pre>
			<p>In the previous code block, we added a condition in the <code>Get</code> method before the default logic to check <a id="_idIndexMarker269"/>whether the operating system where the app is running is Linux or not. Within the condition, we are returning an empty list.  </p>
			<p>There are many useful code snippets included as default for C#, but the following are the most popular:</p>
			<ul>
				<li><code>try</code>: Creates a structure for a <code>try</code>/<code>catch</code> statement</li>
				<li><code>for</code>: Generates a <code>for</code> statement using the local <code>i</code> variable</li>
				<li><code>ctor</code>: Creates the constructor of the class automatically</li>
				<li><code>switch</code>: Generates a <code>switch</code> statement</li>
				<li><code>prop</code>: Creates a new property in the current class</li>
			</ul>
			<p>You can try some of these code snippets in C# code to see the code generated by Visual Studio and use them when the need arises. </p>
			<p>Let's see another example using a CSS file. Navigate to <code>custom.css</code> CSS file (<em class="italic">see Figure 6.4</em>):</p>
			<div><div><img src="img/Figure_6.04_B17873.jpg" alt="Figure 6.4 – The custom.css file loaded in Visual Studio&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.4 – The custom.css file loaded in Visual Studio</p>
			<p>In the <code>custom.css</code> file, you can <a id="_idIndexMarker270"/>write the <code>columns</code> property and see how Visual Studio suggests a code snippet for it. See the code snippets suggested for this demo in <em class="italic">Figure 6.5</em>:</p>
			<div><div><img src="img/Figure_6.05_B17873.jpg" alt="Figure 6.5 – The code snippets suggested by Visual Studio when you type the word &quot;columns&quot;&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.5 – The code snippets suggested by Visual Studio when you type the word "columns"</p>
			<p>Once again, using <a id="_idIndexMarker271"/>the key <em class="italic">tab</em> twice, you can generate the code for this property automatically. See the code generated in <em class="italic">Figure 6.6</em>:</p>
			<div><div><img src="img/Figure_6.06_B17873.jpg" alt="Figure 6.6 – The code generated by the code snippet &#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.6 – The code generated by the code snippet </p>
			<p>In this case, Visual Studio is going to generate four properties, one per browser, to ensure the <a id="_idIndexMarker272"/>code is compatible with all of them (Chrome, Mozilla, and others). We can keep the default <code>inherit</code> value because the proposal of this action is just to see how Visual Studio makes the code. </p>
			<p>You are now ready to use code snippets in Visual Studio. You can identify which suggestions by Visual Studio are code snippets and how to filter them. Now, it's time to learn how to create your own code snippets and use them in your code. </p>
			<h1 id="_idParaDest-85"><a id="_idTextAnchor084"/>Creating code snippets</h1>
			<p>To create a <a id="_idIndexMarker273"/>code snippet in Visual Studio, we need to create a file with the <code>snippet</code> extension. This file has an XML format, and there is a base template that we can update to include the information for our code snippet. The following code is a template example:</p>
			<pre class="source-code">&lt;?xml version="1.0" encoding="utf-8"?&gt;</pre>
			<pre class="source-code">&lt;CodeSnippets xmlns="http://schemas.microsoft.com/</pre>
			<pre class="source-code">    VisualStudio/2005/CodeSnippet"&gt;</pre>
			<pre class="source-code">    &lt;CodeSnippet Format="1.0.0"&gt;</pre>
			<pre class="source-code">        &lt;Header&gt;</pre>
			<pre class="source-code">            &lt;Title&gt;&lt;/Title&gt;</pre>
			<pre class="source-code">            &lt;Author&gt;&lt;/Author&gt;</pre>
			<pre class="source-code">            &lt;Description&gt;&lt;/Description&gt;</pre>
			<pre class="source-code">            &lt;Shortcut&gt;&lt;/Shortcut&gt;</pre>
			<pre class="source-code">        &lt;/Header&gt;</pre>
			<pre class="source-code">        &lt;Snippet&gt;</pre>
			<pre class="source-code">            &lt;Code Language=""&gt;</pre>
			<pre class="source-code">                &lt;![CDATA[]]&gt;</pre>
			<pre class="source-code">            &lt;/Code&gt;</pre>
			<pre class="source-code">        &lt;/Snippet&gt;</pre>
			<pre class="source-code">    &lt;/CodeSnippet&gt;</pre>
			<pre class="source-code">&lt;/CodeSnippets&gt;</pre>
			<p>Let's review <a id="_idIndexMarker274"/>all the properties in this XML and understand how to create our first code snippet. </p>
			<p>In the <code>Header</code> section, we have the following:</p>
			<ul>
				<li><code>Title</code>: Name or general information</li>
				<li><code>Author</code>: Creator or author</li>
				<li><code>Description</code>: What your code snippets do</li>
				<li><code>Shortcut</code>: The shortcut to call the code snippet when you are typing</li>
			</ul>
			<p>In <code>Snippet</code>, we have the following:</p>
			<ul>
				<li><code>Language</code>: The programming language for the code</li>
				<li><code>[CDATA[]</code>: Contains the code</li>
			</ul>
			<p>Now, we can <a id="_idIndexMarker275"/>create a code snippet to detect whether the operating system where the code is running is Linux or not:</p>
			<pre class="source-code">&lt;?xml version="1.0" encoding="utf-8"?&gt;</pre>
			<pre class="source-code">&lt;CodeSnippets xmlns="http://schemas.microsoft.com/VisualStudio/2005/CodeSnippet"&gt;</pre>
			<pre class="source-code">    &lt;CodeSnippet Format="1.0.0"&gt;</pre>
			<pre class="source-code">        &lt;Header&gt;</pre>
			<pre class="source-code">            &lt;Title&gt;If Linux condition&lt;/Title&gt;</pre>
			<pre class="source-code">            &lt;Author&gt;Myself&lt;/Author&gt;</pre>
			<pre class="source-code">            &lt;Description&gt;Conditional to now if the </pre>
			<pre class="source-code">                operating system is Linux&lt;/Description&gt;</pre>
			<pre class="source-code">            &lt;Shortcut&gt;ifln&lt;/Shortcut&gt;</pre>
			<pre class="source-code">        &lt;/Header&gt;</pre>
			<pre class="source-code">        &lt;Snippet&gt;</pre>
			<pre class="source-code">            &lt;Code Language="CSharp"&gt;</pre>
			<pre class="source-code">                &lt;![CDATA[if (OperatingSystem.IsLinux())</pre>
			<pre class="source-code">                {</pre>
			<pre class="source-code">                    return new List&lt;WeatherForecast&gt;();</pre>
			<pre class="source-code">                 }]]&gt;</pre>
			<pre class="source-code">            &lt;/Code&gt;</pre>
			<pre class="source-code">        &lt;/Snippet&gt;</pre>
			<pre class="source-code">    &lt;/CodeSnippet&gt;</pre>
			<pre class="source-code">&lt;/CodeSnippets&gt;</pre>
			<p>You can create a new folder in documents or any new folder for this activity and save the file <a id="_idIndexMarker276"/>with the <code>snippet</code> extension (see <em class="italic">Figure 6.7</em>):</p>
			<div><div><img src="img/Figure_6.07_B17873.jpg" alt="Figure 6.7 – The code snippet file in Windows explorer&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.7 – The code snippet file in Windows explorer</p>
			<p>Now, the last step is to add this folder to the code snippet section in Visual Studio. Navigate to <strong class="bold">Tools</strong> | <strong class="bold">Code Snippets Manager</strong>, and in the <strong class="bold">Language</strong> dropdown, select <strong class="bold">CSharp</strong> (see <em class="italic">Figure 6.8</em>):</p>
			<div><div><img src="img/Figure_6.08_B17873.jpg" alt="Figure 6.8 – Code Snippets Manager in Visual Studio&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.8 – Code Snippets Manager in Visual Studio</p>
			<p class="callout-heading">Important Note</p>
			<p class="callout">You can use the <em class="italic">Ctrl</em> + <em class="italic">K</em> shortcuts followed by <em class="italic">Ctrl</em> + <em class="italic">B</em> to open the <strong class="bold">Code Snippets Manager</strong>. </p>
			<p>The <strong class="bold">Language</strong> option includes <a id="_idIndexMarker277"/>all the programming languages and technologies supported by Visual Studio, depending on the workload installed. </p>
			<p>You can click on <strong class="bold">Add...</strong> and select the folder where your code snippet was created.</p>
			<p>After adding the folder, you will see a new folder in the list, including the new code snippet. If you <a id="_idIndexMarker278"/>select this code snippet, you will see the details on the right panel, as shown in <em class="italic">Figure 6.9</em>:</p>
			<div><div><img src="img/Figure_6.09_B17873.jpg" alt="Figure 6.9 – The code snippet details for the if linux condition&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.9 – The code snippet details for the if linux condition</p>
			<p>Now, you are ready to use your code snippet in any C# file. Open the <code>WeatherForecastController.cs</code> file and try your new code snippet in the <code>Get</code> method:</p>
			<div><div><img src="img/Figure_6.10_B17873.jpg" alt="Figure 6.10 – Using the if linux condition code snippet in Visual Studio&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.10 – Using the if linux condition code snippet in Visual Studio</p>
			<p>You can see in <em class="italic">Figure 6.10</em> how Visual Studio suggests your new code snippet, and in the tooltip, there is <a id="_idIndexMarker279"/>the description that you provided. As usual, you can press <em class="italic">tab</em> twice to generate the code for the code snippet. </p>
			<p class="callout-heading">Important Note</p>
			<p class="callout">For more <a id="_idIndexMarker280"/>information about how to create and design code snippets, look at the official documentation: <a href="https://docs.microsoft.com/visualstudio/ide/code-snippets">https://docs.microsoft.com/visualstudio/ide/code-snippets</a>.</p>
			<p>So far, you have created your first code snippet and know how to create others that meet your needs. But there are also other actions that you can perform with code snippets. So, let's see how to delete a code snippet in the next section. </p>
			<h1 id="_idParaDest-86"><a id="_idTextAnchor085"/>Deleting code snippets</h1>
			<p>Due to <a id="_idIndexMarker281"/>human error, we can add code snippets that we don't need, or maybe we selected the wrong code snippet. For these scenarios, Visual Studio has an option to delete code snippets. To see this option, navigate to <code>CodeSnippets</code> folder. This folder contains the code snippet that you included in the <em class="italic">Creating code snippets</em> section. If you used a different name, select the <a id="_idIndexMarker282"/>correct folder for you. You can see the <strong class="bold">Remove</strong> button location in <em class="italic">Figure 6.11</em>:</p>
			<div><div><img src="img/Figure_6.11_B17873.jpg" alt="Figure 6.11 – The Remove button in Code Snippets Manager&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.11 – The Remove button in Code Snippets Manager</p>
			<p>The <strong class="bold">Remove</strong> button will delete the whole folder, including all the code snippets inside. In Visual Studio 2022, it's not possible to remove code snippets one by one, and therefore, we need to create a folder with a proper name for our code snippets. After removing the folder, Visual Studio is not going to suggest the code snippets anymore.</p>
			<p class="callout-heading">Important Note</p>
			<p class="callout">When you remove code snippets in Visual Studio, the original files and folder are not removed from your local system. Only the reference to the file in Visual Studio will be removed.</p>
			<p>At this point, you know <a id="_idIndexMarker283"/>how to create and delete code snippets. We can also import code snippets in Visual Studio, so let's see how to do it. </p>
			<h1 id="_idParaDest-87"><a id="_idTextAnchor086"/>Importing code snippets</h1>
			<p>If we want <a id="_idIndexMarker284"/>to include code snippets in a folder already created in <strong class="bold">Code Snippets Manager</strong>, we can use the <strong class="bold">Import…</strong> option:</p>
			<div><div><img src="img/Figure_6.12_B17873.jpg" alt="Figure 6.12 – The Import… button in Code Snippets Manager&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.12 – The Import… button in Code Snippets Manager</p>
			<p>After clicking on <code>.snippet</code> extension in the modal (see <em class="italic">Figure 6.13</em>):</p>
			<div><div><img src="img/Figure_6.13_B17873.jpg" alt="Figure 6.13 – Selecting a code snippet file (.snippet) in the filesystem&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.13 – Selecting a code snippet file (.snippet) in the filesystem</p>
			<p>Select the code <a id="_idIndexMarker286"/>snippet created in the <em class="italic">Creating code snippets</em> section, and then click on <strong class="bold">Open</strong>. Finally, you must complete the import process by selecting the location folder for your code snippet and clicking on <strong class="bold">Finish</strong>:</p>
			<div><div><img src="img/Figure_6.14_B17873.jpg" alt="Figure 6.14 – The selection location for the imported code snippet&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.14 – The selection location for the imported code snippet</p>
			<p>After completing <a id="_idIndexMarker287"/>the importation, you will see that the code snippet is added to the selected folder. See the imported code snippet in <em class="italic">Figure 6.15</em>:</p>
			<div><div><img src="img/Figure_6.15_B17873.jpg" alt="Figure 6.15 – The code snippet imported into the My Code Snippets folder&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.15 – The code snippet imported into the My Code Snippets folder</p>
			<p>Importing code <a id="_idIndexMarker288"/>snippets is a great way to share our custom snippets with friends, colleagues, and coworkers. We can create amazing pieces of code for common scenarios and some special code closely related to our architecture or guidelines. </p>
			<h1 id="_idParaDest-88"><a id="_idTextAnchor087"/>Summary</h1>
			<p>Now, you can use code snippets in Visual Studio and increase your productivity. You can identify which pieces of code are common in your architecture and use patterns to create your own code snippets to meet your requirements. Also, you know how to manage code snippets using the functionalities to delete and import. After completing the demos in this chapter, you will recognize the importance of code snippets and why Visual Studio is a powerful IDE that helps developers to write code faster.</p>
			<p>In <a href="B17873_07_ePub.xhtml#_idTextAnchor088"><em class="italic">Chapter 7</em></a>, <em class="italic">Coding Efficiently with AI and Code Views</em>, we will review the <strong class="bold">artificial intelligence </strong>(<strong class="bold">AI</strong>) included in Visual Studio and how this tool can help us to write code faster and improve the syntax in some scenarios. You will also do some demos where the AI will help you, allowing you to predict what action or statement you want to perform.</p>
		</div>
	</body></html>