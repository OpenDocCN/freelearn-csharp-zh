<html><head></head><body>
  <div><h1 class="chapterNumber">14</h1>
    <h1 class="chapterTitle" id="_idParaDest-511">Building Web User Interfaces Using ASP.NET Core</h1>
    <p class="normal">This chapter is about building web user interfaces with ASP.NET Core. You will learn about ASP.NET Core MVC views, Razor syntax, HTML and Tag Helpers, internationalizing your website, and how to use Bootstrap for quick user interface prototyping.</p>
    <p class="normal">This chapter will cover the following topics:</p>
    <ul>
      <li class="bulletList">Setting up an ASP.NET Core MVC website</li>
      <li class="bulletList">Defining web user interfaces with Razor views</li>
      <li class="bulletList">Localizing and globalizing with ASP.NET Core</li>
      <li class="bulletList">Defining web user interfaces with Tag Helpers</li>
      <li class="bulletList">Output caching</li>
    </ul>
    <h1 class="heading-1" id="_idParaDest-512">Setting up an ASP.NET Core MVC website</h1>
    <p class="normal">The <strong class="keyWord">Model-View-Controller</strong> (<strong class="keyWord">MVC</strong>) design pattern allows<a id="_idIndexMarker1499"/> a clean separation between technical concerns, as shown in the following list:</p>
    <ul>
      <li class="bulletList"><strong class="keyWord">Models</strong>: Classes that represent the<a id="_idIndexMarker1500"/> data entities and view models used on the website.</li>
      <li class="bulletList"><strong class="keyWord">Views</strong>: Razor files, that is, <code class="inlineCode">.cshtml</code> files, that <a id="_idIndexMarker1501"/>render data in view models into HTML web pages. Blazor uses the <code class="inlineCode">.razor</code> file extension, but do not confuse them with Razor files!</li>
      <li class="bulletList"><strong class="keyWord">Controllers</strong>: Classes that execute code when an HTTP request arrives at the web server. The controller<a id="_idIndexMarker1502"/> methods usually create a view model that may contain entity models and pass it to a view to generate an HTTP response to send back to the web browser or other client.</li>
    </ul>
    <p class="normal">ASP.NET Core has many Razor file types, which can be confusing because they all use the term “Razor”, so I will <a id="_idIndexMarker1503"/>now remind you of them and highlight the important similarities and differences, as shown in <em class="italic">Table 14.1</em>:</p>
    <table class="table-container" id="table001-10">
      <tbody>
        <tr>
          <td class="table-cell">
            <p class="normal"><strong class="keyWord">Technology</strong></p>
          </td>
          <td class="table-cell">
            <p class="normal"><strong class="keyWord">Special filename</strong></p>
          </td>
          <td class="table-cell">
            <p class="normal"><strong class="keyWord">File extension</strong></p>
          </td>
          <td class="table-cell">
            <p class="normal"><strong class="keyWord">Directive</strong></p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal">Razor Component (for Blazor)</p>
          </td>
          <td class="table-cell"/>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">.razor</code></p>
          </td>
          <td class="table-cell"/>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal">Razor Component (for Blazor with page routing)</p>
          </td>
          <td class="table-cell"/>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">.razor</code></p>
          </td>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">@page</code></p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal">Razor Page</p>
          </td>
          <td class="table-cell"/>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">.cshtml</code></p>
          </td>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">@page</code></p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal">Razor View (for MVC)</p>
          </td>
          <td class="table-cell"/>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">.cshtml</code></p>
          </td>
          <td class="table-cell"/>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal">Razor Layout</p>
          </td>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">_{customname}</code></p>
          </td>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">.cshtml</code></p>
          </td>
          <td class="table-cell"/>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal">Razor View (partial)</p>
          </td>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">_{customname}</code></p>
          </td>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">.cshtml</code></p>
          </td>
          <td class="table-cell"/>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal">Razor View Start</p>
          </td>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">_ViewStart</code></p>
          </td>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">.cshtml</code></p>
          </td>
          <td class="table-cell"/>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal">Razor View Imports</p>
          </td>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">_ViewImports</code></p>
          </td>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">.cshtml</code></p>
          </td>
          <td class="table-cell"/>
        </tr>
      </tbody>
    </table>
    <p class="packt_figref">Table 14.1: Important similarities and differences between Razor files</p>
    <div><p class="normal"><strong class="keyWord">Warning!</strong> Be careful to use the correct file extension and directive at the top of the file or you will get unexpected behavior.</p>
    </div>
    <p class="normal">A Razor View file is technically identical to a Razor Layout or a Razor View (partial). That is why it is so important to follow the convention of prefixing a layout or partial view with an underscore. </p>
    <p class="normal">What turns a Razor View into a Razor Layout is the name of the Razor file being set as the <code class="inlineCode">Layout</code> property of another Razor file or the default layout in the <code class="inlineCode">_ViewStart.cshtml</code> file, as shown in the following code:</p>
    <pre class="programlisting code"><code class="hljs-code">@{
  Layout = "_LayoutWithAdverts";
}
</code></pre>
    <p class="normal">What turns a Razor View into a Razor View (partial) is the Razor View name being used in a <code class="inlineCode">&lt;partial&gt;</code> component on a page, as <a id="_idIndexMarker1504"/>shown in the following code:</p>
    <pre class="programlisting code"><code class="hljs-code">&lt;partial name="_Product" model="product" /&gt;
</code></pre>
    <div><p class="normal"><strong class="keyWord">Good Practice</strong>: The naming convention for special and shared Razor files like layouts and partial views is to prefix them with an underscore <code class="inlineCode">_</code>, for example, <code class="inlineCode">_ViewStart.cshtml</code>, <code class="inlineCode">_Layout.cshtml</code>, or <code class="inlineCode">_Product.cshtml</code> (this might be a partial view for rendering a product).</p>
    </div>
    <h2 class="heading-2" id="_idParaDest-513">Creating an ASP.NET Core MVC website</h2>
    <p class="normal">You will use a project template<a id="_idIndexMarker1505"/> to create an ASP.NET Core MVC website project that has a local database for authenticating and authorizing users. </p>
    <p class="normal">Visual Studio 2022 defaults to using SQL Server LocalDB for the accounts database. </p>
    <p class="normal">Visual Studio Code (or more accurately the <code class="inlineCode">dotnet</code> CLI tool) uses SQLite by default and you can specify a switch to use SQL Server LocalDB instead.</p>
    <p class="normal">Let’s see it in action:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">Use your preferred code editor to create an ASP.NET Core MVC website project with authentication accounts stored in a database, as defined in the following list:<ul>
          <li class="bulletList">Project template: <strong class="screenText">ASP.NET Core Web App (Model-View-Controller) [C#]</strong> / <code class="inlineCode">mvc</code></li>
          <li class="bulletList">Project file and folder: <code class="inlineCode">Northwind.Mvc</code></li>
          <li class="bulletList">Solution file and folder: <code class="inlineCode">Chapter14</code></li>
          <li class="bulletList">Authentication type: <strong class="screenText">Individual Accounts</strong> / <code class="inlineCode">--auth Individual</code></li>
          <li class="bulletList">Configure for HTTPS: Selected.</li>
          <li class="bulletList">Enable Docker: Cleared.</li>
          <li class="bulletList">Do not use top-level statements: Cleared.</li>
        </ul>
      </li>
      <li class="numberedList">Build the <code class="inlineCode">Northwind.Mvc</code> project.<ul>
          <li class="bulletList">If you created the MVC project using Visual Studio 2022, then the database for authentication and authorization will be stored in SQL Server LocalDB. But the database does not yet exist. At a command prompt or terminal, in the <code class="inlineCode">Northwind.Mvc</code> folder, enter the command to run database migrations so that the database used to store credentials for authentication is created, as shown in the following command:
            <pre class="programlisting con"><code class="hljs-con">dotnet ef database update
</code></pre>
          </li>
          <li class="bulletList">If you created the MVC project using <code class="inlineCode">dotnet new</code>, then the database for authentication and authorization will be stored in SQLite and the file has already been created, named <code class="inlineCode">app.db</code>.</li>
        </ul>
      </li>
      <li class="numberedList">In the root folder for<a id="_idIndexMarker1506"/> the MVC website project, in the <code class="inlineCode">appsettings.json</code> file, note the connection string for the authentication database named <code class="inlineCode">DefaultConnection</code>, as shown in the following configuration:<ul>
          <li class="bulletList">Using SQL Server LocalDB:
            <pre class="programlisting code"><code class="hljs-code">{
  "ConnectionStrings": {
    "DefaultConnection": "Server=(localdb)\\mssqllocaldb;Database=aspnet-Northwind.Mvc-...;Trusted_Connection=True;MultipleActiveResultSets=true"
  },
</code></pre>
          </li>
          <li class="bulletList">Using SQLite:
            <pre class="programlisting code"><code class="hljs-code">{
  "ConnectionStrings": {
    "DefaultConnection": "DataSource=app.db;Cache=Shared"
  },
</code></pre>
          </li>
        </ul>
      </li>
    </ol>
    <h2 class="heading-2" id="_idParaDest-514">Exploring the default ASP.NET Core MVC website</h2>
    <p class="normal">Let’s review the behavior of the <a id="_idIndexMarker1507"/>default ASP.NET Core MVC website project template:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">In the <code class="inlineCode">Northwind.Mvc</code> project, expand the <code class="inlineCode">Properties</code> folder, open the <code class="inlineCode">launchSettings.json</code> file, and for the <code class="inlineCode">https</code> profile, for its <code class="inlineCode">applicationUrl</code> setting, change the port numbers to <code class="inlineCode">5141</code> for <code class="inlineCode">https</code> and <code class="inlineCode">5142</code> for <code class="inlineCode">http</code>, as shown in the following setting:
        <pre class="programlisting code"><code class="hljs-code">"applicationUrl": "https://localhost:5141;http://localhost:5142",
</code></pre>
      </li>
      <li class="numberedList">Save the changes to the <code class="inlineCode">launchSettings.json</code> file.</li>
      <li class="numberedList">In your preferred code editor or at the command line, start the <code class="inlineCode">Northwind.Mvc</code> project with the <code class="inlineCode">https</code> profile and using Chrome as the browser:<ul>
          <li class="bulletList">If you are using Visual Studio 2022, then select the <code class="inlineCode">https</code> profile as the <strong class="screenText">Startup Project</strong>, and <strong class="screenText">Google Chrome</strong> as the <strong class="screenText">Web Browser</strong>, then start the <code class="inlineCode">Northind.Mvc</code> website project without debugging.</li>
          <li class="bulletList">If you are using Visual Studio Code, then at the command prompt or terminal, enter the following command: <code class="inlineCode">dotnet run --launch-profile https</code>. Start Chrome and navigate to: <code class="inlineCode">https://localhost:5141/</code>.</li>
          <li class="bulletList">On Windows, if the <strong class="screenText">Windows Defender Firewall</strong> displays a <strong class="screenText">Windows Security Alert</strong> because it “has blocked some features of this app,” then click <strong class="screenText">Allow access</strong>.</li>
        </ul>
      </li>
      <li class="numberedList">In Chrome, open <strong class="screenText">Developer Tools</strong>.</li>
      <li class="numberedList">Refresh the home page and note the following, as shown in <em class="italic">Figure 14.1</em>:<ul>
          <li class="bulletList">The top navigation menu with links to <strong class="screenText">Home</strong>, <strong class="screenText">Privacy</strong>, <strong class="screenText">Register</strong>, and <strong class="screenText">Login</strong>. If the viewport width is 575 pixels or less, then the navigation collapses into a hamburger menu.</li>
          <li class="bulletList">The title of the website, <strong class="screenText">Northwind.Mvc</strong>, shown in the header and footer.</li>
        </ul>
      </li>
    </ol>
    <figure class="mediaobject"><img alt="" src="img/B19587_14_01.png"/></figure>
    <p class="packt_figref">Figure 14.1: The ASP.NET Core MVC project template website home page</p>
    <h2 class="heading-2" id="_idParaDest-515">Understanding visitor registration</h2>
    <p class="normal">By default, passwords must have at least one non-alphanumeric character, at least one digit (0-9), and at least one<a id="_idIndexMarker1508"/> uppercase letter (A-Z). I use <code class="inlineCode">Pa$$w0rd</code> in scenarios like this when I am just exploring.</p>
    <p class="normal">The MVC project template follows best<a id="_idIndexMarker1509"/> practices for <strong class="keyWord">double-opt-in</strong> (<strong class="keyWord">DOI</strong>), meaning that after filling in an email address and password to register, an email is sent to the email address, and the visitor must click a link in that email to confirm that they want to register.</p>
    <p class="normal">We have not yet configured an email provider to send that email, so we must simulate that step:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">Close the <strong class="screenText">Developer Tools</strong> pane.</li>
      <li class="numberedList">In the top navigation menu, click <strong class="screenText">Register</strong>.</li>
      <li class="numberedList">Enter an email and password, and then click the <strong class="screenText">Register</strong> button. (I used <code class="inlineCode">test@example.com</code> and <code class="inlineCode">Pa$$w0rd</code>.)</li>
      <li class="numberedList">Click the link with the text <strong class="screenText">Click here to confirm your account</strong> and note that you are redirected to a <strong class="screenText">Confirm email</strong> web page that you could customize.</li>
      <li class="numberedList">In the top navigation menu, click <strong class="screenText">Login</strong>, enter your email address and password (note that there is an optional checkbox to remember you, and there are links if the visitor has forgotten their password or they want to register as a new visitor), and then click the <strong class="screenText">Log in</strong> button.</li>
      <li class="numberedList">Click your email address in the top navigation menu. This will navigate to an account management page. Note that you can set a phone number, change your email address, change your password, enable two-factor authentication (if you add an authenticator app), and download and delete your personal data. This last feature is good for compliance with legal regulations like the European GDPR.</li>
      <li class="numberedList">Close Chrome, and <a id="_idIndexMarker1510"/>then at the command prompt or terminal for the MVC website, press <em class="keystroke">Ctrl</em> + <em class="keystroke">C</em> to cleanly shut down the web server.</li>
    </ol>
    <h2 class="heading-2" id="_idParaDest-516">Reviewing an MVC website project structure</h2>
    <p class="normal">In your code editor, in Visual <a id="_idIndexMarker1511"/>Studio 2022 <strong class="screenText">Solution Explorer</strong> (toggle on <strong class="screenText">Show All Files</strong>) or Visual Studio Code <strong class="screenText">EXPLORER – SOLUTION EXPLORER</strong>, review the structure of an MVC website project, as shown in <em class="italic">Figure 14.2</em>:</p>
    <figure class="mediaobject"><img alt="" src="img/B19587_14_02.png"/></figure>
    <p class="packt_figref">Figure 14.2: VS Code and VS 2022 Solution Explorers for an ASP.NET Core MVC project</p>
    <p class="normal">We will look in more<a id="_idIndexMarker1512"/> detail at some of these parts later, but for now, note the following:</p>
    <ul>
      <li class="bulletList"><code class="inlineCode">Areas</code>: This folder contains nested folders and a file needed to integrate your website project with ASP.NET Core Identity, which is used for authentication.</li>
      <li class="bulletList"><code class="inlineCode">bin</code>, <code class="inlineCode">obj</code>: These folders contain temporary files needed during the build process and the compiled assemblies for the project. Solution Explorer for Visual Studio Code + C# Dev Kit does not show hidden folders like these, but you can see them in the folder view (labeled <strong class="screenText">CHAPTER14</strong> in <em class="italic">Figure 14.2</em>).</li>
      <li class="bulletList"><code class="inlineCode">Controllers</code>: This folder contains C# classes that have methods (known as actions) that fetch a model and pass it to a view, for example, <code class="inlineCode">HomeController.cs</code>.</li>
      <li class="bulletList"><code class="inlineCode">Data</code>: This folder contains Entity Framework Core migration classes used by the ASP.NET Core Identity system to provide data storage for authentication and authorization, for example, <code class="inlineCode">ApplicationDbContext.cs</code>.</li>
      <li class="bulletList"><code class="inlineCode">Models</code>: This folder contains C# classes that represent all the data gathered together by a controller and passed to a view, for example, <code class="inlineCode">ErrorViewModel.cs</code>.</li>
      <li class="bulletList"><code class="inlineCode">Properties</code>: This folder contains a configuration file for Kestrel (or IIS or IIS Express on Windows) named <code class="inlineCode">launchSettings.json</code>, for launching the website during development. This file is only used on the local development machine and is not deployed to your production website.</li>
      <li class="bulletList"><code class="inlineCode">Views</code>: This folder contains the <code class="inlineCode">.cshtml</code> Razor files that combine HTML and C# code to <a id="_idIndexMarker1513"/>dynamically generate HTML responses. The <code class="inlineCode">_ViewStart.cshtml</code> file sets the default layout and <code class="inlineCode">_ViewImports.cshtml</code> imports common namespaces used in all views like Tag Helpers:<ul>
          <li class="bulletList"><code class="inlineCode">Home</code>: This subfolder contains Razor files for the home and privacy pages.</li>
          <li class="bulletList"><code class="inlineCode">Shared</code>: This subfolder contains Razor files for the shared layout, an error page, and two partial views for logging- in and validation scripts.</li>
        </ul>
      </li>
      <li class="bulletList"><code class="inlineCode">wwwroot</code>: This folder contains static content used by the website, such as CSS for styling, libraries of JavaScript, JavaScript for this website project, and a <code class="inlineCode">favicon.ico</code> file. You also put images and other static file resources like PDF documents in here. The project template includes Bootstrap and jQuery libraries.</li>
      <li class="bulletList"><code class="inlineCode">appsettings.json</code> and <code class="inlineCode">appsettings.Development.json</code>: These files contain settings that your website can load at runtime, for example, the database connection string for the ASP.NET Core Identity system and logging levels.</li>
      <li class="bulletList"><code class="inlineCode">Northwind.Mvc.csproj</code>: This file contains project settings like the use of the Web .NET SDK, an entry for SQLite to ensure that the <code class="inlineCode">app.db</code> file is copied to the website’s output folder, and a list of NuGet packages that your project requires such as EF Core for your chosen database provider, including:<ul>
          <li class="bulletList"><code class="inlineCode">Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore</code></li>
          <li class="bulletList"><code class="inlineCode">Microsoft.AspNetCore.Identity.EntityFrameworkCore</code></li>
          <li class="bulletList"><code class="inlineCode">Microsoft.AspNetCore.Identity.UI</code></li>
          <li class="bulletList"><code class="inlineCode">Microsoft.EntityFrameworkCore.Sqlite</code> or <code class="inlineCode">Microsoft.EntityFrameworkCore.SqlServer</code></li>
          <li class="bulletList"><code class="inlineCode">Microsoft.EntityFrameworkCore.Tools</code></li>
        </ul>
      </li>
      <li class="bulletList"><code class="inlineCode">Program.cs</code>: This file defines an auto-generated <code class="inlineCode">Program</code> class that contains the <code class="inlineCode">&lt;Main&gt;$</code> entry point. It builds a pipeline for processing incoming HTTP requests and hosts the website using default options, like configuring the Kestrel web server and loading <code class="inlineCode">appsettings</code>. It adds and configures services that your website <a id="_idIndexMarker1514"/>needs, for example, ASP.NET Core Identity for authentication, SQLite or SQL Server for identity data storage, and so on, and routes for your application.<div><p class="normal">If you choose to use SQLite instead of SQL Server for the ASP.NET Core Identity database, then you will also see a file named <code class="inlineCode">app.db</code>. This is the SQLite database that stores registered visitors.</p>
        </div>
      </li>
    </ul>
    <h2 class="heading-2" id="_idParaDest-517">Referencing an EF Core class library and registering a data context</h2>
    <p class="normal">We will reference the EF Core <a id="_idIndexMarker1515"/>model that you <a id="_idIndexMarker1516"/>created in <em class="chapterRef">Chapter 3</em>, <em class="italic">Building Entity Models for SQL Server Using EF Core</em>:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">In the <code class="inlineCode">Northwind.Mvc.csproj</code> project file, treat warnings as errors and add a project reference to the Northwind database context project, as shown in the following markup:
        <pre class="programlisting code"><code class="hljs-code">&lt;ItemGroup&gt;
  &lt;ProjectReference Include="..\..\Chapter03\Northwind.Common.DataContext
.SqlServer\Northwind.Common.DataContext.SqlServer.csproj" /&gt;
&lt;/ItemGroup&gt;
</code></pre>
      
    <div><p class="normal">The <code class="inlineCode">Include</code> path must not have a line break.</p>
    </div></li>
    </ol>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="2">At the command prompt or terminal, build the <code class="inlineCode">Northwind.Mvc</code> project, as shown in the following command: <code class="inlineCode">dotnet build</code>.</li>
      <li class="numberedList">In <code class="inlineCode">Program.cs</code>, import the namespace to use the <code class="inlineCode">AddNorthwindContext</code> extension method, as shown in the following code:
        <pre class="programlisting code"><code class="hljs-code">using Northwind.EntityModels; // To use AddNorthwindContext method.
</code></pre>
      </li>
      <li class="numberedList">In the section that <a id="_idIndexMarker1517"/>adds services to the<a id="_idIndexMarker1518"/> container, add a statement that registers <code class="inlineCode">NorthwindContext</code> as a service, as shown in the following code:
        <pre class="programlisting code"><code class="hljs-code">builder.Services.AddNorthwindContext();
</code></pre>
      </li>
    </ol>
    <h1 class="heading-1" id="_idParaDest-518">Defining web user interfaces with Razor views </h1>
    <p class="normal">Let’s review how we can build the <a id="_idIndexMarker1519"/>user interface of a web page in a modern<a id="_idIndexMarker1520"/> ASP.NET Core MVC website.</p>
    <h2 class="heading-2" id="_idParaDest-519">Understanding Razor views</h2>
    <p class="normal">In MVC, the V stands for <em class="italic">view</em>. The responsibility of a view is to transform a model into HTML or other formats.</p>
    <p class="normal">There are multiple <strong class="keyWord">view engines</strong> that could<a id="_idIndexMarker1521"/> be used t<a id="_idIndexMarker1522"/>o do this. The default view <a id="_idIndexMarker1523"/>engine is called <strong class="keyWord">Razor</strong>, and it uses the <code class="inlineCode">@</code> symbol to indicate server-side code execution.</p>
    <p class="normal">Let’s review the home page view and how it uses a shared layout:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">In the <code class="inlineCode">Views/Home</code> folder, open the <code class="inlineCode">Index.cshtml</code> file and note the block of C# code wrapped in <code class="inlineCode">@{ }</code>. This will execute first and can be used to store data that needs to be passed into a shared layout file, like the title of the web page, as shown in the following code:
        <pre class="programlisting code"><code class="hljs-code">@{
  ViewData["Title"] = "Home Page";
}
</code></pre>
      </li>
      <li class="numberedList">Note the static HTML content in the <code class="inlineCode">&lt;div&gt;</code> element that uses Bootstrap classes like <code class="inlineCode">text-center</code> and <code class="inlineCode">display-4</code> for styling, as shown in the following markup:
        <pre class="programlisting code"><code class="hljs-code">&lt;div class="text-center"&gt;
  &lt;h1 class="display-4"&gt;Welcome&lt;/h1&gt;
  &lt;p&gt;Learn about &lt;a href="https://learn.microsoft.com/aspnet/core"&gt;building Web apps with ASP.NET Core&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
</code></pre>
      </li>
      <li class="numberedList">In the <code class="inlineCode">Views</code> folder, open the <code class="inlineCode">_ViewImports.cshtml</code> file and note that it imports the namespace for the project and the namespace for the <code class="inlineCode">Models</code> folder in the project, and then adds the ASP.NET Core Tag Helpers, which we will learn more about later in this chapter, as shown in the following code:
        <pre class="programlisting code"><code class="hljs-code">@using Northwind.Mvc 
@using Northwind.Mvc.Models
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
</code></pre>
      </li>
      <li class="numberedList">In the <code class="inlineCode">Views</code> folder, open the <code class="inlineCode">_ViewStart.cshtml</code> file. It gets executed when the <code class="inlineCode">View</code> method is <a id="_idIndexMarker1524"/>called in a controller class. It is used to set defaults that apply to all views. For example, note that it<a id="_idIndexMarker1525"/> sets the <code class="inlineCode">Layout</code> property of all views to a shared layout file (without its file extension), as shown in the following markup:
        <pre class="programlisting code"><code class="hljs-code">@{
  Layout = "_Layout";
}
</code></pre>
      
    <div><p class="normal">This file is not executed when a partial view is rendered, for example, when you call the <code class="inlineCode">PartialView</code> method instead of the <code class="inlineCode">View</code> method.</p>
    </div></li>
    </ol>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="5">In the <code class="inlineCode">Shared</code> folder, open the <code class="inlineCode">_Layout.cshtml</code> file.</li>
      <li class="numberedList">Note that <code class="inlineCode">&lt;title&gt;</code> is being set from the <code class="inlineCode">ViewData</code> dictionary that was set earlier in the <code class="inlineCode">Index.cshtml</code> view, as shown in the following markup:
        <pre class="programlisting code"><code class="hljs-code">&lt;title&gt;@ViewData["Title"] – Northwind.Mvc&lt;/title&gt;
</code></pre>
        <div><p class="normal">The title is shown in the browser tab for the current page or the browser window.</p>
        </div>
      </li>
    </ol>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="7">Note the rendering of links to support Bootstrap and a site stylesheet, where <code class="inlineCode">~</code> means the <code class="inlineCode">wwwroot</code> folder in the project, as shown in the following markup:
        <pre class="programlisting code"><code class="hljs-code">&lt;link rel="stylesheet" 
      href="~/lib/bootstrap/dist/css/bootstrap.min.css" /&gt;
&lt;link rel="stylesheet" href="~/css/site.css" asp-append-version="true" /&gt;
&lt;link rel="stylesheet" href="~/Northwind.Mvc.styles.css" 
      asp-append-version="true" /&gt;
</code></pre>
      </li>
      <li class="numberedList">Note the rendering<a id="_idIndexMarker1526"/> of a navigation bar in<a id="_idIndexMarker1527"/> the header, as shown in the following markup:
        <pre class="programlisting code"><code class="hljs-code">&lt;body&gt;
  &lt;header&gt;
    &lt;nav class="navbar ..."&gt;
</code></pre>
      </li>
      <li class="numberedList">Note the rendering of a collapsible <code class="inlineCode">&lt;div&gt;</code> containing a partial view named <code class="inlineCode">_LoginPartial</code> for logging in, and hyperlinks to allow users to navigate between pages using ASP.NET Core Tag Helpers with attributes like <code class="inlineCode">asp-controller</code> and <code class="inlineCode">asp-action</code>, as shown in the following markup:
        <pre class="programlisting code"><code class="hljs-code">&lt;div class="navbar-collapse collapse d-sm-inline-flex
            justify-content-between"&gt;
  &lt;ul class="navbar-nav flex-grow-1"&gt;
    &lt;li class="nav-item"&gt;
      &lt;a class="nav-link text-dark" asp-area=""
        asp-controller="Home" asp-action="Index"&gt;Home&lt;/a&gt;
    &lt;/li&gt;
    &lt;li class="nav-item"&gt;
      &lt;a class="nav-link text-dark" asp-area="" 
        asp-controller="Home" asp-action="Privacy"&gt;Privacy&lt;/a&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
  &lt;partial name="_LoginPartial" /&gt;
&lt;/div&gt;
</code></pre>
        <div><p class="normal">The <code class="inlineCode">&lt;a&gt;</code> elements use Tag Helper attributes named <code class="inlineCode">asp-controller</code> and <code class="inlineCode">asp-action</code> to specify the controller name and action name that will execute when the link is clicked on. The <code class="inlineCode">asp-area</code> attribute can be used to organize and group pages within large, complex MVC websites. If you want to navigate to a feature in a Razor Class Library, then you can also use <code class="inlineCode">asp-area</code> to specify the feature name.</p>
        </div>
      </li>
    </ol>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="10">Note the rendering <a id="_idIndexMarker1528"/>of the body inside the <code class="inlineCode">&lt;main&gt;</code> element, as shown in the following markup:
        <pre class="programlisting code"><code class="hljs-code">&lt;div class="container"&gt;
  &lt;main role="main" class="pb-3"&gt;
    @RenderBody()
  &lt;/main&gt;
&lt;/div&gt;
</code></pre>
      
    <div><p class="normal">The <code class="inlineCode">RenderBody</code> method injects the contents of a specific Razor view for a page like the <code class="inlineCode">Index.cshtml</code> file at that point in the shared layout.</p>
    </div></li>
    </ol>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="11">Note the rendering of <code class="inlineCode">&lt;script&gt;</code> elements at the bottom of the page so that it does not slow down the display<a id="_idIndexMarker1529"/> of the page, and that you can add your own script blocks into an optional defined section named <code class="inlineCode">Scripts</code>, as shown in the following markup:
        <pre class="programlisting code"><code class="hljs-code">&lt;script src="img/jquery.min.js"&gt;&lt;/script&gt;
&lt;script src="img/bootstrap.bundle.min.js"&gt;
&lt;/script&gt;
&lt;script src="img/site.js" asp-append-version="true"&gt;&lt;/script&gt; 
@await RenderSectionAsync("Scripts", required: false)
</code></pre>
      </li>
      <li class="numberedList">In the <code class="inlineCode">Shared</code> folder, open the <code class="inlineCode">_LoginPartial.cshtml</code> file, and note the <code class="inlineCode">if</code> statement, which if the visitor is logged in renders links to their account and to log out, or if they are not logged in, renders links to register or log in.</li>
      <li class="numberedList">In the <code class="inlineCode">Shared</code> folder, open the <code class="inlineCode">_ValidationScriptsPartial.cshtml</code> file, and note it contains two script blocks for adding validation to the client-side browser using JavaScript, as shown in the following markup:
        <pre class="programlisting code"><code class="hljs-code">&lt;script src="img/jquery.validate.min.js"&gt;&lt;/script&gt;
&lt;script src="img/jquery.validate.unobtrusive.min.js"&gt;&lt;/script&gt;
</code></pre>
      
    <div><p class="normal"><strong class="keyWord">Good Practice</strong>: You need to add this partial view to the <code class="inlineCode">Scripts</code> section if you want to enable validation in a Razor View like <code class="inlineCode">Index.cshtml</code>, as shown in the following markup:</p>
      <pre class="programlisting code"><code class="hljs-code">@section Scripts {
  &lt;partial name="_ValidationScriptsPartial" /&gt;
}
</code></pre>
    </div></li>
    </ol>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="14">In the <code class="inlineCode">Shared</code> folder, open the <code class="inlineCode">Error.cshtml</code> file, and<a id="_idIndexMarker1530"/> note it contains markup to render <a id="_idIndexMarker1531"/>an exception.</li>
    </ol>
    <h2 class="heading-2" id="_idParaDest-520">Prototyping with Bootstrap</h2>
    <p class="normal">Bootstrap is the world’s most popular<a id="_idIndexMarker1532"/> framework for building responsive, mobile-first websites. It combines CSS stylesheets with JavaScript libraries to implement its functionality. </p>
    <p class="normal">It is a good choice for prototyping a website user interface, although before going public you might want to hire a web designer to build a custom Bootstrap theme or replace it with a completely custom set of CSS stylesheets to give your website a distinct brand.</p>
    <p class="normal">Bootstrap is like Marmite. Some developers love it; some hate it.</p>
    <p class="normal">Good reasons to use Bootstrap include:</p>
    <ul>
      <li class="bulletList">It saves time. </li>
      <li class="bulletList">It is customizable.</li>
      <li class="bulletList">It is open-source.</li>
      <li class="bulletList">It is well documented officially and has lots of answers about it on sites like Stack Overflow.</li>
    </ul>
    <p class="normal">But implementing Bootstrap without care has the following negatives:</p>
    <ul>
      <li class="bulletList">Your website will look generic.</li>
      <li class="bulletList">Bootstrap themes do not work well with the default views built-in with ASP.NET Core Identity.</li>
      <li class="bulletList">It is heavy compared to a hand-crafted solution.</li>
    </ul>
    <p class="normal">In the previous edition of this book, I included about five pages reviewing some of the features of Bootstrap that are most used. But Bootstrap is not .NET, and the second edition is already crammed with <a id="_idIndexMarker1533"/>content, so I have moved the Bootstrap content to an online-only resource section. You can read it at the following link: <a href="https://github.com/markjprice/apps-services-net8/blob/main/docs/ch14-bootstrap.md">https://github.com/markjprice/apps-services-net8/blob/main/docs/ch14-bootstrap.md</a>.</p>
    <div><p class="normal"><strong class="keyWord">Good Practice</strong>: As well as defining your own styles, base your styles on a common library, such as Bootstrap, that implements responsive design. However, if you are building a website that needs a distinct identity or brand, make sure you use Bootstrap’s theming support. Do not just accept the defaults.</p>
    </div>
    <h2 class="heading-2" id="_idParaDest-521">Understanding Razor syntax and expressions</h2>
    <p class="normal">Before we customize the home <a id="_idIndexMarker1534"/>page view, let’s review an example Razor file. The file has an initial Razor code block that instantiates an order with price and quantity and then outputs information about the order on the web page, as shown in the following markup:</p>
    <pre class="programlisting code"><code class="hljs-code">@{
  Order order = new()
  {
    OrderId = 123,
    Product = "Sushi",
    Price = 8.49M,
    Quantity = 3
  };
}
&lt;div&gt;Your order for @order.Quantity of @order.Product has a total cost of $@ order.Price * @order.Quantity&lt;/div&gt;
</code></pre>
    <p class="normal">The preceding Razor file would result in the following incorrect output:</p>
    <pre class="programlisting code"><code class="hljs-code">Your order for 3 of Sushi has a total cost of $8.49 * 3
</code></pre>
    <p class="normal">Although Razor markup can<a id="_idIndexMarker1535"/> include the value of any single property using the <code class="inlineCode">@object.property</code> syntax, you should wrap expressions in parentheses, as shown in the following markup:</p>
    <pre class="programlisting code"><code class="hljs-code">&lt;div&gt;Your order for @order.Quantity of @order.Product has a total cost of $@ (order.Price * order.Quantity)&lt;/div&gt;
</code></pre>
    <p class="normal">The preceding Razor expression results in the following correct output:</p>
    <pre class="programlisting code"><code class="hljs-code">Your order for 3 of Sushi has a total cost of $25.47
</code></pre>
    <h2 class="heading-2" id="_idParaDest-522">Understanding HTML Helper methods</h2>
    <p class="normal">When creating a view for ASP.NET<a id="_idIndexMarker1536"/> Core MVC, you can use the <code class="inlineCode">Html</code> object and its methods to generate markup. When Microsoft first introduced ASP.NET MVC in 2009, these HTML Helper methods were the way to programmatically render HTML.</p>
    <p class="normal">Modern ASP.NET Core retains these HTML Helper methods for backward compatibility and provides Tag Helpers, which are usually easier to read and write in most scenarios. But there are notable situations where Tag Helpers cannot be used, like in Razor components. </p>
    <p class="normal">You will learn about Tag Helpers later in this chapter.</p>
    <p class="normal">Some useful <code class="inlineCode">Html</code> object methods include the following:</p>
    <ul>
      <li class="bulletList"><code class="inlineCode">ActionLink</code>: Use this to generate an anchor <code class="inlineCode">&lt;a&gt;</code> element that contains a URL path to the specified controller and action. For example, <code class="inlineCode">Html.ActionLink(linkText: "Binding", actionName: "ModelBinding", controllerName: "Home")</code> would generate <code class="inlineCode">&lt;a href="/home/modelbinding"&gt;Binding&lt;/a&gt;</code>.</li>
      <li class="bulletList"><code class="inlineCode">AntiForgeryToken</code>: Use this inside a <code class="inlineCode">&lt;form&gt;</code> to insert a <code class="inlineCode">&lt;hidden&gt;</code> element containing an anti-forgery token that can be validated when the form is submitted.</li>
      <li class="bulletList"><code class="inlineCode">Display</code> and <code class="inlineCode">DisplayFor</code>: Use this to generate HTML markup for the expression relative to the current model using a display template. There are built-in display templates for .NET types and custom templates can be created in the <code class="inlineCode">DisplayTemplates</code> folder. The folder name is case-sensitive on case-sensitive filesystems.</li>
      <li class="bulletList"><code class="inlineCode">DisplayForModel</code>: Use this to generate HTML markup for an entire model instead of a single expression.</li>
      <li class="bulletList"><code class="inlineCode">Editor</code> and <code class="inlineCode">EditorFor</code>: Use this to generate HTML markup for the expression relative to the<a id="_idIndexMarker1537"/> current model using an editor template. There are built-in editor templates for .NET types that use <code class="inlineCode">&lt;label&gt;</code> and <code class="inlineCode">&lt;input&gt;</code> elements, and custom templates can be created in the <code class="inlineCode">EditorTemplates</code> folder. The folder name is case-sensitive on case-sensitive filesystems.</li>
      <li class="bulletList"><code class="inlineCode">EditorForModel</code>: Use this to generate HTML markup for an entire model instead of a single expression.</li>
      <li class="bulletList"><code class="inlineCode">Encode</code>: Use this to safely encode an object or string into HTML. For example, the string value <code class="inlineCode">"&lt;script&gt;"</code> would be encoded as <code class="inlineCode">"&amp;lt;script&amp;gt;"</code>. This is not normally necessary since the Razor <code class="inlineCode">@</code> symbol encodes string values by default.</li>
      <li class="bulletList"><code class="inlineCode">Raw</code>: Use this to render a string value <em class="italic">without</em> encoding as HTML.</li>
      <li class="bulletList"><code class="inlineCode">PartialAsync</code> and <code class="inlineCode">RenderPartialAsync</code>: Use these to generate HTML markup for a partial view. You can optionally pass a model and view data.</li>
    </ul>
    <h2 class="heading-2" id="_idParaDest-523">Defining a strongly-typed Razor view</h2>
    <p class="normal">To improve the IntelliSense when writing a view, you can define what type the view can expect using an <code class="inlineCode">@model</code> directive at<a id="_idIndexMarker1538"/> the top. Let’s modify the home page to display a table of orders from the Northwind database:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">In the <code class="inlineCode">Controllers</code> folder, in <code class="inlineCode">HomeController.cs</code>, import the namespace for the Northwind entity models and EF Core features, as shown in the following code:
        <pre class="programlisting code"><code class="hljs-code">using Northwind.EntityModels; // To use Northwind entity models.
using Microsoft.EntityFrameworkCore; // To use Include method.
</code></pre>
      </li>
      <li class="numberedList">In the controller class, define a field to store the Northwind data context and set it in the<a id="_idIndexMarker1539"/> constructor, as shown highlighted in the following code:
        <pre class="programlisting code"><code class="hljs-code"><strong class="hljs-keyword-slc">private</strong><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc">readonly</strong><strong class="hljs-slc"> NorthwindContext _db;</strong>
public HomeController(ILogger&lt;HomeController&gt; logger
  <strong class="hljs-params-slc">, NorthwindContext db</strong>)
{
  _logger = logger;
<strong class="hljs-slc">  _db = db;</strong>
}
</code></pre>
      </li>
      <li class="numberedList">In the <code class="inlineCode">Index</code> action method, add statements to create a view model containing all the orders and their related order details, as shown highlighted in the following code:
        <pre class="programlisting code"><code class="hljs-code">public IActionResult Index()
{
<strong class="hljs-slc">  IEnumerable&lt;Order&gt; model = _db.Orders</strong>
<strong class="hljs-slc">    .Include(order =&gt; order.Customer)</strong>
<strong class="hljs-slc">    .Include(order =&gt; order.OrderDetails)</strong>
<strong class="hljs-slc">    .OrderByDescending(order =&gt; order.OrderDetails</strong>
<strong class="hljs-slc">      .Sum(detail =&gt; detail.Quantity * detail.UnitPrice))</strong>
<strong class="hljs-slc">    .AsEnumerable();</strong>
  return View(<strong class="hljs-slc">model</strong>);
}
</code></pre>
      </li>
      <li class="numberedList">In the <code class="inlineCode">Views</code> folder, in <code class="inlineCode">_ViewImports.cshtml</code>, add a statement to import the EF Core entity models for all Razor views and pages, as shown in the following code:
        <pre class="programlisting code"><code class="hljs-code">@using Northwind.EntityModels
</code></pre>
      </li>
      <li class="numberedList">In the <code class="inlineCode">Views\Home</code> folder, in <code class="inlineCode">Index.cshtml</code>, at the top of the file, add a statement to set the model type to use a collection of orders, as shown in the following code:
        <pre class="programlisting code"><code class="hljs-code">@model IEnumerable&lt;Order&gt;
</code></pre>
      
    <p class="normal">Now, whenever we type <code class="inlineCode">Model</code> in this view, our code editor will know the correct type for the <a id="_idIndexMarker1540"/>model and will provide IntelliSense for it.</p>
    <div><p class="normal">While entering code in a view, remember the following:</p>
      <ul>
        <li class="bulletList">Declare the type for the model using <code class="inlineCode">@model</code> (with a lowercase <code class="inlineCode">m</code>).</li>
        <li class="bulletList">Interact with the instance of the model using <code class="inlineCode">@Model</code> (with an uppercase <code class="inlineCode">M</code>).</li>
      </ul>
    </div></li>
    </ol>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="6">In <code class="inlineCode">Index.cshtml</code>, in the initial Razor code block, replace the existing content with an HTML table of the orders, as shown in the following markup:
        <pre class="programlisting code"><code class="hljs-code">@model IEnumerable&lt;Order&gt;
@{
  ViewData["Title"] = "Orders";
}
&lt;div class="text-center"&gt;
  &lt;h1 class="display-4"&gt;@ViewData["Title"]&lt;/h1&gt;
  &lt;table class="table table-bordered table-striped"&gt;
    &lt;thead&gt;
      &lt;tr&gt;
        &lt;th&gt;Order ID&lt;/th&gt;
        &lt;th&gt;Order Date&lt;/th&gt;
        &lt;th&gt;Company Name&lt;/th&gt;
        &lt;th&gt;Country&lt;/th&gt;
        &lt;th&gt;Item Count&lt;/th&gt;
        &lt;th&gt;Order Total&lt;/th&gt;
      &lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tbody&gt;
      @foreach (Order order in Model)
      {
        &lt;tr&gt;
          &lt;td&gt;@order.OrderId&lt;/td&gt;
          &lt;td&gt;@order.OrderDate?.ToString("D")&lt;/td&gt;
          &lt;td&gt;@order.Customer?.CompanyName&lt;/td&gt;
          &lt;td&gt;@order.Customer?.Country&lt;/td&gt;
          &lt;td&gt;@order.OrderDetails.Count()&lt;/td&gt;
          &lt;td&gt;@order.OrderDetails.Sum(detail =&gt; detail.Quantity * detail.UnitPrice).ToString("C")&lt;/td&gt;
        &lt;/tr&gt;
      }
    &lt;/tbody&gt;
  &lt;/table&gt;
&lt;/div&gt;
</code></pre>
      
    <p class="normal">Let’s see the result of our customized home page:</p></li>
    </ol>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="7">If your database server is not running, for example, because you are hosting it in Docker, a virtual <a id="_idIndexMarker1541"/>machine, or in the cloud, then make sure to start it.</li>
      <li class="numberedList">Start the <code class="inlineCode">Northwind.Mvc</code> website project without debugging.</li>
      <li class="numberedList">Note that the home page now shows a table of orders with the highest-value order displayed first, as shown in <em class="italic">Figure 14.3</em>:
    <figure class="mediaobject"><img alt="" src="img/B19587_14_03.png"/></figure>
    <p class="packt_figref">Figure 14.3: The updated Northwind MVC website home page</p>
    <div><p class="normal">I am running my web server on my local laptop, and its operating system, Windows 11, is configured to use United Kingdom culture for date, time, and currency values. Next, we will see how to localize the web page for the preferred culture of the visitor.</p>
    </div></li>
    </ol>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="10">Close Chrome and shut down the web server.</li>
    </ol>
    <p class="normal">Now that you’ve been reminded of how to build a basic MVC website that displays data, let’s look at an important intermediate-level topic that is often overlooked when building websites for the World Wide Web: supporting all the world’s languages and cultures.</p>
    <h1 class="heading-1" id="_idParaDest-524">Localizing and globalizing with ASP.NET Core</h1>
    <p class="normal">In <em class="chapterRef">Chapter 7</em>, <em class="italic">Handling Dates, Times, and Internationalization</em>, you learned about working with dates, times, and time <a id="_idIndexMarker1542"/>zones, and how to globalize and localize a .NET<a id="_idIndexMarker1543"/> codebase.</p>
    <p class="normal">In this section, we will look specifically at how to localize a website that uses ASP.NET Core.</p>
    <p class="normal">As well as localizing <code class="inlineCode">string</code> values into languages like French and Spanish using <code class="inlineCode">IStringLocalizer</code>, you can localize HTML content using <code class="inlineCode">IHtmlLocalizer</code>, but this should be used with care. Usually, HTML markup should be the same for all locales. For views, you can use <code class="inlineCode">IViewLocalizer</code>.</p>
    <p class="normal"><strong class="keyWord">Request localization</strong> means that the<a id="_idIndexMarker1544"/> browser can request what culture it prefers in the following ways:</p>
    <ul>
      <li class="bulletList">Add a query string parameter, for example, <code class="inlineCode">?culture=en-US&amp;ui-culture=en-US</code>.</li>
      <li class="bulletList">Send a cookie with the request, for example, <code class="inlineCode">c=en-US|uic=en-US</code>.</li>
      <li class="bulletList">Set an HTTP header, for example, <code class="inlineCode">Accept-Language: en-US,en;q=0.9,fr-FR;q=0.8,fr;q=0.7,en-GB;q=0.6</code>.</li>
    </ul>
    <p class="normal">To enable request localization, call the <code class="inlineCode">UseRequestLocalization</code> method when you configure the HTTP request pipeline in <code class="inlineCode">Program.cs</code>. This tells ASP.NET Core to look for these requests and to automatically change the current thread that is processing that request (and only that request, no one else’s requests) to use the appropriate culture to format data and load resource values.</p>
    <p class="normal">Let’s create some resource files to localize the web user interface into American English, British English, and French, and then globalize the data like dates and currency values:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">In the <code class="inlineCode">Northwind.Mvc</code> project, add a new folder named <code class="inlineCode">Resources</code>. This is the default name for the folder that localizer services look in for <code class="inlineCode">*.resx</code> resource files.</li>
      <li class="numberedList">In <code class="inlineCode">Resources</code>, add a new folder named <code class="inlineCode">Views</code>.</li>
      <li class="numberedList">In <code class="inlineCode">Views</code>, add a new folder named <code class="inlineCode">Home</code>.</li>
    </ol>
    <h2 class="heading-2" id="_idParaDest-525">Creating resource files</h2>
    <p class="normal">How you create<a id="_idIndexMarker1545"/> resource files (<code class="inlineCode">*.resx</code>) depends on your code editor.</p>
    <div><p class="normal">To save time, you can just copy the <code class="inlineCode">.resx</code> files from the GitHub repository found in the folder at the following link: <a href="https://github.com/markjprice/apps-services-net8/tree/main/code/Chapter14/Northwind.Mvc/Resources/Views/Home">https://github.com/markjprice/apps-services-net8/tree/main/code/Chapter14/Northwind.Mvc/Resources/Views/Home</a>.</p>
    </div>
    <h3 class="heading-3" id="_idParaDest-526">If you are using Visual Studio 2022</h3>
    <p class="normal">You can use a special project item<a id="_idIndexMarker1546"/> type and editor:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">In <code class="inlineCode">Home</code>, add a file type of <strong class="screenText">Resources File</strong> named <code class="inlineCode">Index.en-US.resx</code>.</li>
      <li class="numberedList">Use the editor to <a id="_idIndexMarker1547"/>define names and values, as shown in <em class="italic">Figure 14.4</em>:
    <figure class="mediaobject"><img alt="" src="img/B19587_14_04.png"/></figure>
    <p class="packt_figref">Figure 14.4: Using the Resources File editor to define the localized labels</p>
    <div><p class="normal">JetBrains Rider has its own resource file editor that combines all <code class="inlineCode">.resx</code> files in one experience as a grid. Each language has its own column, side-by-side. It’s much more useful than having to edit each file individually as in Visual Studio 2022.</p>
    </div></li>
    </ol>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="3">Close the editor.</li>
      <li class="numberedList">Copy and paste the file and rename it <code class="inlineCode">Index.en-GB.resx</code>.
    <div><p class="normal"><strong class="keyWord">Warning!</strong> You must not change any of the entries in the <strong class="screenText">Name</strong> column because these are used to look up localized values for all languages! You can only change the entries in the <strong class="screenText">Value</strong> or <strong class="screenText">Comment</strong> columns.</p>
    </div></li>
    </ol>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="5">In <code class="inlineCode">Index.en-GB.resx</code>, modify <code class="inlineCode">Orders (USA)</code> to <code class="inlineCode">Orders (UK)</code>. This is so we can see a<a id="_idIndexMarker1548"/> difference.</li>
      <li class="numberedList">Close the editor.</li>
      <li class="numberedList">Copy and paste the file and rename it as <code class="inlineCode">Index.fr-FR.resx</code>.</li>
      <li class="numberedList">In <code class="inlineCode">Index.fr-FR.resx</code>, modify<a id="_idIndexMarker1549"/> the <code class="inlineCode">value</code> column to use French. (See the step-by-step instructions in the next section for Visual Studio Code for the translations.)</li>
      <li class="numberedList">Copy and paste the file and rename it <code class="inlineCode">Index.fr.resx</code>.</li>
      <li class="numberedList">In <code class="inlineCode">Index.fr.resx</code>, modify the last value to be <code class="inlineCode">Commandes (Neutral French)</code>.</li>
    </ol>
    <h3 class="heading-3" id="_idParaDest-527">If you are using Visual Studio Code</h3>
    <p class="normal">You will have to edit the file<a id="_idIndexMarker1550"/> without a special editor:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">In <code class="inlineCode">Home</code>, add a new file <a id="_idIndexMarker1551"/>named <code class="inlineCode">Index.en-US.resx</code>.</li>
      <li class="numberedList">Modify the contents to contain American English language resources, as shown in the following markup:
        <pre class="programlisting code"><code class="hljs-code">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;root&gt;
  &lt;data name="Company Name" xml:space="preserve"&gt;
    &lt;value&gt;Company Name&lt;/value&gt;
  &lt;/data&gt;
  &lt;data name="Country" xml:space="preserve"&gt;
    &lt;value&gt;Country&lt;/value&gt;
  &lt;/data&gt;
  &lt;data name="Item Count" xml:space="preserve"&gt;
    &lt;value&gt;Item Count&lt;/value&gt;
  &lt;/data&gt;
  &lt;data name="Order Date" xml:space="preserve"&gt;
    &lt;value&gt;Order Date&lt;/value&gt;
  &lt;/data&gt;
  &lt;data name="Order ID" xml:space="preserve"&gt;
    &lt;value&gt;Order ID&lt;/value&gt;
  &lt;/data&gt;
  &lt;data name="Order Total" xml:space="preserve"&gt;
    &lt;value&gt;Order Total&lt;/value&gt;
  &lt;/data&gt;
  &lt;data name="Orders" xml:space="preserve"&gt;
    &lt;value&gt;Orders (USA)&lt;/value&gt;
  &lt;/data&gt;
&lt;/root&gt;
</code></pre>
      </li>
      <li class="numberedList">Copy and paste<a id="_idIndexMarker1552"/> the file and rename it <code class="inlineCode">Index.en-GB.resx</code>.</li>
      <li class="numberedList">In <code class="inlineCode">Index.en-GB.resx</code>, modify <code class="inlineCode">Orders (USA)</code> to <code class="inlineCode">Orders (UK)</code>. This is so we can see a difference.</li>
      <li class="numberedList">Copy and paste the file and<a id="_idIndexMarker1553"/> rename it <code class="inlineCode">Index.fr-FR.resx</code>.</li>
      <li class="numberedList">In <code class="inlineCode">Index.fr-FR.resx</code>, modify the <code class="inlineCode">value</code> column to use French:
        <pre class="programlisting code"><code class="hljs-code">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;root&gt;
  &lt;data name="Company Name" xml:space="preserve"&gt;
    &lt;value&gt;Nom de l'entreprise&lt;/value&gt;
  &lt;/data&gt;
  &lt;data name="Country" xml:space="preserve"&gt;
    &lt;value&gt;Pays&lt;/value&gt;
  &lt;/data&gt;
  &lt;data name="Item Count" xml:space="preserve"&gt;
    &lt;value&gt;Nombre d'éléments&lt;/value&gt;
  &lt;/data&gt;
  &lt;data name="Order Date" xml:space="preserve"&gt;
    &lt;value&gt;Date de commande&lt;/value&gt;
  &lt;/data&gt;
  &lt;data name="Order ID" xml:space="preserve"&gt;
    &lt;value&gt;Numéro de commande&lt;/value&gt;
  &lt;/data&gt;
  &lt;data name="Order Total" xml:space="preserve"&gt;
    &lt;value&gt;Total de la commande&lt;/value&gt;
  &lt;/data&gt;
  &lt;data name="Orders" xml:space="preserve"&gt;
    &lt;value&gt;Commandes (France)&lt;/value&gt;
  &lt;/data&gt;
&lt;/root&gt;
</code></pre>
      </li>
      <li class="numberedList">Copy and paste the file and rename it <code class="inlineCode">Index.fr.resx</code>.</li>
      <li class="numberedList">In <code class="inlineCode">Index.fr.resx</code>, modify the last value to be <code class="inlineCode">Commandes (Neutral French)</code>.</li>
    </ol>
    <h2 class="heading-2" id="_idParaDest-528">Localizing Razor views with an injected view localizer</h2>
    <p class="normal">Now we can continue with these steps for both <a id="_idIndexMarker1554"/>code editors:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">In the <code class="inlineCode">Views/Home</code> folder, in <code class="inlineCode">Index.cshtml</code>, import<a id="_idIndexMarker1555"/> the namespace for working with localization, inject the <code class="inlineCode">IViewLocalizer</code> service, and make changes to use the labels in the view model, as shown highlighted in the following markup:
        <pre class="programlisting code"><code class="hljs-code"><strong class="hljs-slc">@using Microsoft.AspNetCore.Mvc.Localization</strong>
@model IEnumerable&lt;Order&gt;
<strong class="hljs-slc">@inject IViewLocalizer Localizer</strong>
@{
  ViewData["Title"] = <strong class="hljs-slc">Localizer[</strong><strong class="hljs-string-slc">"Orders"</strong><strong class="hljs-slc">]</strong>;
}
&lt;div class="text-center"&gt;
  &lt;h1 class="display-4"&gt;@ViewData["Title"]&lt;/h1&gt;
  &lt;table class="table table-bordered table-striped"&gt;
    &lt;thead&gt;
      &lt;tr&gt;
        &lt;th&gt;@<strong class="hljs-slc">Localizer[</strong><strong class="hljs-string-slc">"Order ID"</strong><strong class="hljs-slc">]</strong>&lt;/th&gt;
        &lt;th&gt;@<strong class="hljs-slc">Localizer[</strong><strong class="hljs-string-slc">"Order Date"</strong><strong class="hljs-slc">]</strong>&lt;/th&gt;
        &lt;th&gt;@<strong class="hljs-slc">Localizer[</strong><strong class="hljs-string-slc">"Company Name"</strong><strong class="hljs-slc">]</strong>&lt;/th&gt;
        &lt;th&gt;@<strong class="hljs-slc">Localizer[</strong><strong class="hljs-string-slc">"Country"</strong><strong class="hljs-slc">]</strong>&lt;/th&gt;
        &lt;th&gt;@<strong class="hljs-slc">Localizer[</strong><strong class="hljs-string-slc">"Item Count"</strong><strong class="hljs-slc">]</strong>&lt;/th&gt;
        &lt;th&gt;@<strong class="hljs-slc">Localizer[</strong><strong class="hljs-string-slc">"Order Total"</strong><strong class="hljs-slc">]</strong>&lt;/th&gt;
      &lt;/tr&gt;
    &lt;/thead&gt;
</code></pre>
      
    <div><p class="normal"><strong class="keyWord">Good Practice</strong>: The key values like <code class="inlineCode">"Order ID"</code> are used to look up the localized values. If a value is missing, then it returns the key as a default. It is good practice to therefore use keys that also work as a good fallback, which is why I used US English proper titles with spaces as the keys above and in the <code class="inlineCode">.resx</code> files.</p>
    </div></li>
    </ol>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="2">In <code class="inlineCode">Program.cs</code>, before the call to <code class="inlineCode">AddControllersWithViews</code>, add a statement to add localization <a id="_idIndexMarker1556"/>and set the path to find resource files to the <code class="inlineCode">Resources</code> folder, and <a id="_idIndexMarker1557"/>after the call to <code class="inlineCode">AddControllersWithViews</code>, append a call to add view localization, as shown highlighted in the following code:
        <pre class="programlisting code"><code class="hljs-code"><strong class="hljs-slc">builder.Services.AddLocalization(</strong>
<strong class="hljs-slc">  options =&gt; options.ResourcesPath = </strong><strong class="hljs-string-slc">"Resources"</strong><strong class="hljs-slc">);</strong>
builder.Services.AddControllersWithViews()
  <strong class="hljs-slc">.AddViewLocalization()</strong>;
</code></pre>
      </li>
      <li class="numberedList">In <code class="inlineCode">Program.cs</code>, after the call to <code class="inlineCode">Build</code> the <code class="inlineCode">app</code> object, add statements to declare four cultures that we will support: US English, British English, neutral French, and French in France. Then, create a new localization options object and add those cultures as supported for both localization of user interfaces (<code class="inlineCode">UICultures</code>) and globalization of data values like dates and currency (<code class="inlineCode">Cultures</code>), as shown in the following code:
        <pre class="programlisting code"><code class="hljs-code">string[] cultures = { "en-US", "en-GB", "fr", "fr-FR" };
RequestLocalizationOptions localizationOptions = new();
// cultures[0] will be "en-US"
localizationOptions.SetDefaultCulture(cultures[0])
  // Set globalization of data formats like dates and currencies.
  .AddSupportedCultures(cultures)
  // Set localization of user interface text.
  .AddSupportedUICultures(cultures);
app.UseRequestLocalization(localizationOptions);
</code></pre>
      </li>
      <li class="numberedList">Start the <code class="inlineCode">Northwind.Mvc</code> website project.</li>
      <li class="numberedList">In Chrome, navigate to <strong class="screenText">Settings</strong>.</li>
      <li class="numberedList">In the <strong class="screenText">Search settings</strong> box, type <code class="inlineCode">lang</code>, and note you will find the <strong class="screenText">Preferred languages</strong> section, as shown in <em class="italic">Figure 14.5</em>:
    <figure class="mediaobject"><img alt="" src="img/B19587_14_05.png"/></figure>
    <p class="packt_figref">Figure 14.5: Searching Chrome Settings for the Preferred languages section</p>
    <div><p class="normal"><strong class="keyWord">Warning!</strong> If you are using a localized version of Chrome, in other words, its user interface is in your local language, like French, then you will need to search for the word “language” in your own language. (Although “language” in French is “langue”, so entering “lang” will still work. But in Spanish you would need to search for “idioma”.)</p>
    </div></li>
    </ol>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="7">Click <strong class="screenText">Add languages</strong>, search for <code class="inlineCode">french</code>, select both <strong class="screenText">French - francais</strong> and <strong class="screenText">French (France) – francais (France)</strong>, and then click <strong class="screenText">Add</strong>.
    <div><p class="normal"><strong class="keyWord">Warning!</strong> If you are using a localized version of Chrome, then you will need to search for the word “French” in your own language. For example, in Spanish, it would be “Francés,” and in Welsh, it would be “Ffrangeg.”</p>
    </div></li>
    </ol>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="8">Add <strong class="screenText">English (United States)</strong> and <strong class="screenText">English (United Kingdom)</strong> if you do not have them in the list<a id="_idIndexMarker1558"/> already.</li>
      <li class="numberedList">In the dots <strong class="screenText">…</strong> menu to the right of <strong class="screenText">French (France)</strong>, click <strong class="screenText">Move to the top</strong>, and confirm that it is at the top<a id="_idIndexMarker1559"/> of your list of languages.</li>
      <li class="numberedList">Close the <strong class="screenText">Settings</strong> tab.</li>
      <li class="numberedList">In Chrome, perform a hard reload/refresh (for example, hold down <em class="keystroke">Ctrl</em> and click the <strong class="screenText">Refresh</strong> button), and note the home page now uses localized labels and French formats for dates and currency, as shown in <em class="italic">Figure 14.6</em>:</li>
    </ol>
    <figure class="mediaobject"><img alt="" src="img/B19587_14_06.png"/></figure>
    <p class="packt_figref">Figure 14.6: The Orders table localized and globalized into French in France</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="12">Repeat the above steps<a id="_idIndexMarker1560"/> for the other languages, for example, <strong class="screenText">English (United Kingdom)</strong>.</li>
      <li class="numberedList">View <strong class="screenText">Developer Tools</strong>, and note<a id="_idIndexMarker1561"/> the request headers have been set with British English (<code class="inlineCode">en-GB</code>) first, as shown in <em class="italic">Figure 14.7</em>:</li>
    </ol>
    <figure class="mediaobject"><img alt="" src="img/B19587_14_07.png"/></figure>
    <p class="packt_figref">Figure 14.7: Orders localized and globalized into British English due to the Accept-Language: en-GB header</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="14">Close the browser and shut down the web server.</li>
    </ol>
    <h2 class="heading-2" id="_idParaDest-529">Understanding the Accept-Language header</h2>
    <p class="normal">You might wonder how the <code class="inlineCode">Accept-Language</code> header <a id="_idIndexMarker1562"/>works:</p>
    <pre class="programlisting code"><code class="hljs-code">Accept-Language: en-US,en;q=0.9,fr-FR;q=0.8,fr;q=0.7,en-GB;q=0.6
</code></pre>
    <p class="normal">The <code class="inlineCode">Accept-Language</code> header uses commas as separators between culture codes. Each culture code can be neutral (just a language) or specific (language and region), and each can have a <strong class="keyWord">quality value</strong> (<code class="inlineCode">q</code>) between 0.0 and 1.0 (default). The preceding <code class="inlineCode">Accept-Language</code> header example should <a id="_idIndexMarker1563"/>therefore be read as follows:</p>
    <ul>
      <li class="bulletList"><code class="inlineCode">en-US</code>: English language in the United States ranked highest at 1.0 (if <code class="inlineCode">q</code> not explicitly set).</li>
      <li class="bulletList"><code class="inlineCode">en;q=0.9</code>: English language anywhere in the world ranked at 0.9.</li>
      <li class="bulletList"><code class="inlineCode">fr-FR;q=0.8</code>: French language in France ranked at 0.8.</li>
      <li class="bulletList"><code class="inlineCode">fr;q=0.7</code>: French language anywhere in the world ranked at 0.7.</li>
      <li class="bulletList"><code class="inlineCode">en-GB;q=0.6</code>: English language in United Kingdom ranked lowest at 0.6.</li>
    </ul>
    <h1 class="heading-1" id="_idParaDest-530">Defining web user interfaces with Tag Helpers</h1>
    <p class="normal"><strong class="keyWord">Tag Helpers</strong> make it easier <a id="_idIndexMarker1564"/>to make HTML elements dynamic. The markup is cleaner and easier to read, edit, and maintain than if you use HTML Helpers.</p>
    <p class="normal">However, Tag Helpers do not <a id="_idIndexMarker1565"/>completely replace HTML Helpers because there are some things that can only be achieved with HTML Helpers, like rendering output that contains multiple nested tags. Tag Helpers also cannot be used in Razor components. So, you must learn HTML Helpers and treat Tag Helpers as an optional choice that is better in some scenarios.</p>
    <p class="normal">Tag Helpers are especially<a id="_idIndexMarker1566"/> useful for <strong class="keyWord">Front End </strong>(<strong class="keyWord">FE</strong>) developers who primarily work with HTML, CSS, and JavaScript because the FE developer does not have to learn C# syntax. Tag Helpers just use what look like normal HTML attributes on elements. The attribute names and values can also be selected from IntelliSense if your code editor supports that; both Visual Studio 2022 and Visual Studio Code do.</p>
    <h2 class="heading-2" id="_idParaDest-531">Comparing HTML Helpers and Tag Helpers</h2>
    <p class="normal">For example, to render a<a id="_idIndexMarker1567"/> linkable hyperlink to a controller action, you could use an HTML Helper method, as shown<a id="_idIndexMarker1568"/> in the following markup:</p>
    <pre class="programlisting code"><code class="hljs-code">@Html.ActionLink("View our privacy policy.", "Privacy", "Index")
</code></pre>
    <p class="normal">To make it clearer how it works, you could use named parameters, as shown in the following code:</p>
    <pre class="programlisting code"><code class="hljs-code">@Html.ActionLink(linkText: "View our privacy policy.", 
  action: "Privacy", controller: "Index")
</code></pre>
    <p class="normal">But using a Tag Helper would be even clearer and cleaner for someone who works more with HTML than C#, as shown in the following markup:</p>
    <pre class="programlisting code"><code class="hljs-code">&lt;a asp-action="Privacy" asp-controller="Home"&gt;View our privacy policy.&lt;/a&gt;
</code></pre>
    <p class="normal">All three examples above generate the same rendered HTML element, as shown in the following markup:</p>
    <pre class="programlisting code"><code class="hljs-code">&lt;a href="/home/privacy"&gt;View our privacy policy.&lt;/a&gt;
</code></pre>
    <p class="normal">In the next few sections, we will review some of the more common Tag Helpers:</p>
    <ul>
      <li class="bulletList">Anchor Tag Helper</li>
      <li class="bulletList">Cache Tag Helper</li>
      <li class="bulletList">Environment Tag Helper</li>
      <li class="bulletList">Image Tag Helper</li>
      <li class="bulletList">Forms-related Tag Helpers</li>
    </ul>
    <h2 class="heading-2" id="_idParaDest-532">Exploring the Anchor Tag Helper</h2>
    <p class="normal">First, we will create three clickable hyperlinks<a id="_idIndexMarker1569"/> styled as buttons to view the home page with all orders, the orders for a single customer, and the orders in a single country. This will allow us to see the basics of creating links to controllers and <a id="_idIndexMarker1570"/>actions, as well as passing parameters using a route parameter and arbitrary query string parameters.</p>
    <p class="normal">Let’s explore these examples of the Anchor Tag Helper:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">In the <code class="inlineCode">Views</code> folder, in <code class="inlineCode">_ViewImports.cshtml</code>, note the <code class="inlineCode">@addTagHelper</code> directive, which adds the ASP.NET Core Tag Helpers, as shown highlighted in the following code:
        <pre class="programlisting code"><code class="hljs-code">@using Northwind.Mvc 
@using Northwind.Mvc.Models
<strong class="hljs-slc">@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers</strong>
@using Northwind.EntityModels
</code></pre>
      
    <div><p class="normal">You could create your own Tag Helpers and you would have to register them in the same way. But that is beyond the <a id="_idIndexMarker1571"/>scope of this book. If you want to learn how, you can read the following documentation: <a href="https://learn.microsoft.com/en-us/aspnet/core/mvc/views/tag-helpers/authoring">https://learn.microsoft.com/en-us/aspnet/core/mvc/views/tag-helpers/authoring</a>.</p>
    </div></li>
    </ol>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="2">In the <code class="inlineCode">Views/Home</code> folder, in <code class="inlineCode">Privacy.cshtml</code>, add markup to define a paragraph with <a id="_idIndexMarker1572"/>clickable hyperlinks styled as buttons using the <code class="inlineCode">&lt;a&gt;</code> tag, as shown in the following <a id="_idIndexMarker1573"/>markup:
        <pre class="programlisting code"><code class="hljs-code">&lt;p&gt;
  &lt;a asp-controller="Home" asp-action="Index" 
     class="btn btn-primary" role="button"&gt;Orders&lt;/a&gt;
  &lt;a asp-controller="Home" 
     class="btn btn-outline-primary" role="button"&gt;This Page&lt;/a&gt;
  &lt;a asp-controller="Home" asp-action="Index" asp-route-id="ALFKI" 
     class="btn btn-outline-primary" role="button"&gt;
     Orders for Alfreds Futterkiste&lt;/a&gt;
  &lt;a asp-controller="Home" asp-action="Index" asp-route-country="Brazil" 
     class="btn btn-outline-primary" role="button"&gt;Orders in Brazil&lt;/a&gt;
&lt;/p&gt;
</code></pre>
      
    <div><p class="normal">If you set a controller name without an action name, then it defaults to the current action, in this case, <code class="inlineCode">Privacy</code>. The <code class="inlineCode">asp-route-{parametername}</code> attribute can use any arbitrary parameter name. In the code example above, we used <code class="inlineCode">id</code> and <code class="inlineCode">country</code>. <code class="inlineCode">id</code> will map to the route parameter with the same name. <code class="inlineCode">country</code> is not a route parameter, so it will be passed as a query string.</p>
    </div></li>
    </ol>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="3">In the <code class="inlineCode">Controllers</code> folder, in <code class="inlineCode">HomeController.cs</code>, modify the <code class="inlineCode">Index</code> action method to define two optional parameters to pass a customer ID and the name of a country, and<a id="_idIndexMarker1574"/> then modify the LINQ query to use them to filter the orders if they are set, as shown highlighted in the<a id="_idIndexMarker1575"/> following code:
        <pre class="programlisting code"><code class="hljs-code">public IActionResult Index(
  <strong class="hljs-built_in-slc">string</strong><strong class="hljs-params-slc">? id = </strong><strong class="hljs-literal-slc">null</strong><strong class="hljs-params-slc">, </strong><strong class="hljs-built_in-slc">string</strong><strong class="hljs-params-slc">? country = </strong><strong class="hljs-literal-slc">null</strong>)
{
  // Start with a simplified initial model.
  IEnumerable&lt;Order&gt; model = db.Orders
    .Include(order =&gt; order.Customer)
    .Include(order =&gt; order.OrderDetails)<strong class="hljs-slc">;</strong>
  // Add filtering based on parameters.
<strong class="hljs-slc">  </strong><strong class="hljs-keyword-slc">if</strong><strong class="hljs-slc"> (id </strong><strong class="hljs-keyword-slc">is</strong><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc">not</strong><strong class="hljs-slc"> </strong><strong class="hljs-literal-slc">null</strong><strong class="hljs-slc">)</strong>
<strong class="hljs-slc">  {</strong>
<strong class="hljs-slc">    model = model.Where(order =&gt; order.Customer?.CustomerId == id);</strong>
<strong class="hljs-slc">  }</strong>
<strong class="hljs-slc">  </strong><strong class="hljs-keyword-slc">else</strong><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc">if</strong><strong class="hljs-slc"> (country </strong><strong class="hljs-keyword-slc">is</strong><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc">not</strong><strong class="hljs-slc"> </strong><strong class="hljs-literal-slc">null</strong><strong class="hljs-slc">)</strong>
<strong class="hljs-slc">  {</strong>
<strong class="hljs-slc">    model = model.Where(order =&gt; order.Customer?.Country == country);</strong>
<strong class="hljs-slc">  }</strong>
  // Add ordering and make enumerable.
<strong class="hljs-slc">  model = model</strong>
    .OrderByDescending(order =&gt; order.OrderDetails
      .Sum(detail =&gt; detail.Quantity * detail.UnitPrice))
    .AsEnumerable();
  return View(model);
}
</code></pre>
      </li>
      <li class="numberedList">Start the <code class="inlineCode">Northwind.Mvc</code> website project.</li>
      <li class="numberedList">View <strong class="screenText">Developer Tools</strong> and click the <strong class="screenText">Elements</strong> tab.</li>
      <li class="numberedList">On the home page, click <strong class="screenText">Privacy</strong> to navigate to that page, and note the buttons, including their raw HTML, which shows the <code class="inlineCode">href</code> attribute paths that were <a id="_idIndexMarker1576"/>generated by the Anchor Tag Helper, as shown in Figure <em class="italic">14.8</em>:</li>
    </ol>
    <figure class="mediaobject"><img alt="" src="img/B19587_14_08.png"/></figure>
    <p class="packt_figref">Figure 14.8: Three hyperlinks styled as buttons generated by Anchor Tag Helper</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="7">Click each button and<a id="_idIndexMarker1577"/> then come back to the <strong class="screenText">Privacy Policy</strong> page to make sure they work correctly.</li>
      <li class="numberedList">Close the browser and shut down the web server.</li>
      <li class="numberedList">In the <code class="inlineCode">Views/Home</code> folder, in <code class="inlineCode">Index.cshtml</code>, at the end of the table of orders, add an anchor tag to indicate the end of the orders table, as shown highlighted in the following markup:
        <pre class="programlisting code"><code class="hljs-code">  &lt;/table&gt;
<strong class="hljs-slc">  </strong><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">a</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">id</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">"endOfTable"</strong><strong class="hljs-tag-slc"> /&gt;</strong>
&lt;/div&gt;
</code></pre>
      </li>
      <li class="numberedList">In the <code class="inlineCode">Views/Home</code> folder, in <code class="inlineCode">Privacy.cshtml</code>, after the existing anchor tags, add another one to link to the anchor with an <code class="inlineCode">id</code> of <code class="inlineCode">endOfTable</code> by setting the <code class="inlineCode">asp-fragment</code> attribute, as shown in the following markup:
        <pre class="programlisting code"><code class="hljs-code">&lt;a asp-controller="Home" asp-action="Index" asp-fragment="endOfTable"
   class="btn btn-outline-primary"&gt;Orders (end of table)&lt;/a&gt;
</code></pre>
      </li>
      <li class="numberedList">Modify the second anchor tag to explicitly set the protocol to use <code class="inlineCode">https</code>, as shown highlighted in the following markup:
        <pre class="programlisting code"><code class="hljs-code">&lt;a asp-controller="Home" <strong class="hljs-attr-slc">asp-protocol</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">"https"</strong>
    class="btn btn-outline-primary"&gt;This Page&lt;/a&gt;
</code></pre>
      </li>
      <li class="numberedList">In the <code class="inlineCode">Controllers</code> folder, in <code class="inlineCode">HomeController.cs</code>, add an action method named <code class="inlineCode">Shipper</code>. Give it a<a id="_idIndexMarker1578"/> parameter to receive a shipper entity and then pass it to the view, as shown in the following code:
        <pre class="programlisting code"><code class="hljs-code">public IActionResult Shipper(Shipper shipper)
{
  return View(shipper);
}
</code></pre>
      
    <div><p class="normal">This action method can respond to any method of request, for example, <code class="inlineCode">GET</code> or <code class="inlineCode">POST</code>. With a <code class="inlineCode">GET</code> request, the shipper entity would be passed as query string key-value pairs. With a <code class="inlineCode">POST</code> request, the shipper entity would be passed in the body.</p>
    </div></li>
    </ol>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="13">In the <code class="inlineCode">Views/Home</code> folder, add an empty Razor view named <code class="inlineCode">Shipper.cshtml</code>.</li>
      <li class="numberedList">Modify the contents, as <a id="_idIndexMarker1579"/>shown in the following markup:
        <pre class="programlisting code"><code class="hljs-code">@model Shipper
@{
  ViewData["Title"] = "Shippers";
}
&lt;h1&gt;@ViewData["Title"]&lt;/h1&gt;
&lt;div&gt;
  &lt;div class="mb-3"&gt;
    &lt;label for="shipperIdInput" class="form-label"&gt;Shipper Id&lt;/label&gt;
    &lt;input type="number" class="form-control" id="shipperIdInput" 
           value="@Model.ShipperId"&gt;
  &lt;/div&gt;
  &lt;div class="mb-3"&gt;
    &lt;label for="companyNameInput" class="form-label"&gt;Company Name&lt;/label&gt;
    &lt;input class="form-control" id="companyNameInput" 
           value="@Model.CompanyName"&gt;
  &lt;/div&gt;
  &lt;div class="mb-3"&gt;
    &lt;label for="phoneInput" class="form-label"&gt;Phone&lt;/label&gt;
    &lt;input class="form-control" id="phoneInput" value="@Model.Phone"&gt;
  &lt;/div&gt;
&lt;/div&gt;
</code></pre>
      </li>
      <li class="numberedList">In the <code class="inlineCode">Views/Home</code> folder, in <code class="inlineCode">Privacy.cshtml</code>, at the top of the file, add code and markup to inject the<a id="_idIndexMarker1580"/> Northwind database context. Then, use it to define a Razor function to create a dictionary with string values for both the key and value populated<a id="_idIndexMarker1581"/> from the shippers table, as shown highlighted in the following code:
        <pre class="programlisting code"><code class="hljs-code"><strong class="hljs-slc">@inject NorthwindContext db</strong>
@{
  ViewData["Title"] = "Privacy Policy";
}
<strong class="hljs-slc">@functions {</strong>
<strong class="hljs-slc">  </strong><strong class="hljs-keyword-slc">public</strong><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc">async</strong><strong class="hljs-slc"> Task&lt;IDictionary&lt;</strong><strong class="hljs-built_in-slc">string</strong><strong class="hljs-slc">, </strong><strong class="hljs-built_in-slc">string</strong><strong class="hljs-slc">&gt;&gt; GetShipperData()</strong>
<strong class="hljs-slc">  {</strong>
<strong class="hljs-slc">    </strong><strong class="hljs-comment-slc">// Find the shipper with ID of 1.</strong>
<strong class="hljs-slc">    Shipper? shipper = </strong><strong class="hljs-keyword-slc">await</strong><strong class="hljs-slc"> db.Shippers.FindAsync(</strong><strong class="hljs-number-slc">1</strong><strong class="hljs-slc">);</strong>
<strong class="hljs-slc">    Dictionary&lt;</strong><strong class="hljs-built_in-slc">string</strong><strong class="hljs-slc">, </strong><strong class="hljs-built_in-slc">string</strong><strong class="hljs-slc">&gt; keyValuePairs = </strong><strong class="hljs-keyword-slc">new</strong><strong class="hljs-slc">();</strong>
<strong class="hljs-slc">    </strong><strong class="hljs-keyword-slc">if</strong><strong class="hljs-slc"> (shipper != </strong><strong class="hljs-literal-slc">null</strong><strong class="hljs-slc">)</strong>
<strong class="hljs-slc">    {</strong>
<strong class="hljs-slc">      keyValuePairs = </strong><strong class="hljs-keyword-slc">new</strong><strong class="hljs-slc">()</strong>
<strong class="hljs-slc">      {</strong>
<strong class="hljs-slc">        { </strong><strong class="hljs-string-slc">"ShipperId"</strong><strong class="hljs-slc">, shipper.ShipperId.ToString() },</strong>
<strong class="hljs-slc">        { </strong><strong class="hljs-string-slc">"CompanyName"</strong><strong class="hljs-slc">, shipper.CompanyName },</strong>
<strong class="hljs-slc">        { </strong><strong class="hljs-string-slc">"Phone"</strong><strong class="hljs-slc">, shipper.Phone ?? </strong><strong class="hljs-built_in-slc">string</strong><strong class="hljs-slc">.Empty }</strong>
<strong class="hljs-slc">      };</strong>
<strong class="hljs-slc">    }</strong>
<strong class="hljs-slc">    </strong><strong class="hljs-keyword-slc">return</strong><strong class="hljs-slc"> keyValuePairs;</strong>
<strong class="hljs-slc">  }</strong>
<strong class="hljs-slc">}</strong>
</code></pre>
      </li>
      <li class="numberedList">After the existing anchor tags, add another one to pass the dictionary to the current page, as shown in the following markup:
        <pre class="programlisting code"><code class="hljs-code">&lt;a asp-controller="Home" asp-action="Shipper" 
    asp-all-route-data="await GetShipperData()"
    class="btn btn-outline-primary"&gt;Shipper&lt;/a&gt;
</code></pre>
      
    <div><p class="normal">Passing a complex object as a query string like this quickly hits the limit of about 1,000 characters for a URL. To send larger objects, you should use <code class="inlineCode">POST</code> instead of <code class="inlineCode">GET</code> by using a <code class="inlineCode">&lt;form&gt;</code> element instead of an anchor tag <code class="inlineCode">&lt;a&gt;</code>.</p>
    </div></li>
    </ol>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="17">If your database<a id="_idIndexMarker1582"/> server is not running, for example, because <a id="_idIndexMarker1583"/>you are hosting it in Docker, a virtual machine, or the cloud, then make sure to start it.</li>
      <li class="numberedList">Start the <code class="inlineCode">Northwind.Mvc</code> website project.</li>
      <li class="numberedList">View <strong class="screenText">Developer Tools</strong> and click <strong class="screenText">Elements</strong>.</li>
      <li class="numberedList">On the home page, click <strong class="screenText">Privacy</strong> to navigate to that page and note the buttons, including their raw HTML, which shows the <code class="inlineCode">href</code> attribute paths that were generated by the Anchor Tag Helper, as shown in Figure <em class="italic">14.9</em>:
    <figure class="mediaobject"><img alt="" src="img/B19587_14_09.png"/></figure>
    <p class="packt_figref">Figure 14.9: Using a fragment and passing a complex object using query string parameters</p>
    <div><p class="normal">A side benefit of specifying the protocol is that the generated URL must include the protocol, domain, and any port number, as well as the relative path, so it is a convenient way to get an absolute URL instead of the default relative path URL, as shown in the second link above.</p>
    </div></li>
    </ol>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="21">Click the <strong class="screenText">Orders (end of table)</strong> button and note the browser navigates to the home page and then <a id="_idIndexMarker1584"/>jumps to the end of the orders table.</li>
      <li class="numberedList">Go back to the <strong class="screenText">Privacy</strong> page, click the <strong class="screenText">Shipper</strong> button, and note the shipper details are pre-entered into the shipper form.</li>
      <li class="numberedList">Close the browser and shut down the web server.</li>
    </ol>
    <h2 class="heading-2" id="_idParaDest-533">Exploring the Cache Tag Helpers</h2>
    <p class="normal">The Cache and Distributed Cache <a id="_idIndexMarker1585"/>Tag Helpers improve the performance of your web pages by<a id="_idIndexMarker1586"/> caching their content using the in-memory or registered distributed cache providers respectively. We covered reading and writing objects to these caches in <em class="chapterRef">Chapter 9</em>, <em class="italic">Caching, Queuing, and Resilient Background Services</em>. Now we will see how to store fragments of HTML for a view in them.</p>
    <p class="normal">As a reminder, an in-memory cache is best for a single web server or a web server farm with session affinity enabled. Session affinity means that subsequent requests from the same browser are served by the same web server. A distributed cache is best for a web server farm or in a cloud provider like Azure. You can register providers for SQL Server, Redis, or NCache, or create your own custom provider.</p>
    <p class="normal">Attributes that can be applied to the Cache Tag Helper include:</p>
    <ul>
      <li class="bulletList"><code class="inlineCode">enabled</code>: Default value is <code class="inlineCode">true</code>. This exists so that you can include the <code class="inlineCode">&lt;cache&gt;</code> element in the markup but decide at runtime if it should be enabled or not.</li>
      <li class="bulletList"><code class="inlineCode">expires-after</code>: A <code class="inlineCode">TimeSpan</code> value to expire after. The default is <code class="inlineCode">00:20:00</code>, meaning 20 minutes.</li>
      <li class="bulletList"><code class="inlineCode">expires-on</code>: A <code class="inlineCode">DateTimeOffset</code> value to expire at. No default.</li>
      <li class="bulletList"><code class="inlineCode">expires-sliding</code>: A <code class="inlineCode">TimeSpan</code> value to expire after if the value has not been accessed during that time. This is useful when storing database entities that cost a lot to create and have varied popularity. The popular entities will stay cached if they continue to be accessed. Less popular entities will drop out. No default.</li>
      <li class="bulletList"><code class="inlineCode">vary-by-{type}</code>: These attributes allow multiple different cached versions based on differences in an HTTP <code class="inlineCode">header</code> value, a <code class="inlineCode">user</code>, a <code class="inlineCode">route</code>, <code class="inlineCode">cookie</code>, or <code class="inlineCode">query</code> string value, or a custom value.</li>
    </ul>
    <p class="normal">Let’s see an example of the Cache Tag Helper:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">In the <code class="inlineCode">Views/Home</code> folder, in <code class="inlineCode">Index.cshtml</code>, between the heading and the table, add <code class="inlineCode">&lt;div&gt;</code> elements to <a id="_idIndexMarker1587"/>define a Bootstrap row with two columns that show the current UTC date <a id="_idIndexMarker1588"/>and time twice, once live and then once cached, as shown in the following markup:
        <pre class="programlisting code"><code class="hljs-code">&lt;div class="row"&gt;
  &lt;div class="col"&gt;
    &lt;h2&gt;Live&lt;/h2&gt;
    &lt;p class="alert alert-info"&gt;
    UTC: @DateTime.UtcNow.ToLongDateString() at 
         @DateTime.UtcNow.ToLongTimeString()
    &lt;/p&gt;
  &lt;/div&gt;
  &lt;div class="col"&gt;
    &lt;h2&gt;Cached&lt;/h2&gt;
    &lt;p class="alert alert-secondary"&gt;
      &lt;cache&gt;
        UTC: @DateTime.UtcNow.ToLongDateString() at 
             @DateTime.UtcNow.ToLongTimeString()
      &lt;/cache&gt;
    &lt;/p&gt;
  &lt;/div&gt;
&lt;/div&gt;
</code></pre>
      </li>
      <li class="numberedList">Start the <code class="inlineCode">Northwind.Mvc</code> website project.</li>
      <li class="numberedList">Refresh the home page several times over several seconds and note the left-hand time is always refreshed to show the live time, and the right-hand time is cached (for 20 minutes by default), as shown in <em class="italic">Figure 14.10</em>:</li>
    </ol>
    <figure class="mediaobject"><img alt="" src="img/B19587_14_10.png"/></figure>
    <p class="packt_figref">Figure 14.10: Live and cached UTC times</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="4">Close the browser and <a id="_idIndexMarker1589"/>shut down the web server.</li>
      <li class="numberedList">In the <code class="inlineCode">Views/Home</code> folder, in <code class="inlineCode">Index.cshtml</code>, modify the <code class="inlineCode">&lt;cache&gt;</code> element to expire after 10 seconds, as <a id="_idIndexMarker1590"/>shown highlighted in the following markup:
        <pre class="programlisting code"><code class="hljs-code">&lt;cache<strong class="hljs-slc"> expires-after=</strong><strong class="hljs-string-slc">"@TimeSpan.FromSeconds(10)"</strong>&gt;
</code></pre>
      </li>
      <li class="numberedList">Start the <code class="inlineCode">Northwind.Mvc</code> website project.</li>
      <li class="numberedList">Refresh the home page several times over several seconds and note the left-hand time is always refreshed to show the live time, and the right-hand time is cached for 10 seconds before it then refreshes.</li>
      <li class="numberedList">Close the browser and shut down the web server.</li>
    </ol>
    <h2 class="heading-2" id="_idParaDest-534">Exploring the Environment Tag Helper</h2>
    <p class="normal">The Environment Tag Helper renders its content only if the current environment matches one of the values in a <a id="_idIndexMarker1591"/>comma-separated list of names. This is useful if you want to render some content like instructions to a tester when hosted in <a id="_idIndexMarker1592"/>a staging environment, or content like customer-specific information that developers and testers do not need to see while hosted in the production environment.</p>
    <p class="normal">As well as a <code class="inlineCode">names</code> attribute to set the comma-separated list of environments, you can also use <code class="inlineCode">include</code> (works the same as <code class="inlineCode">names</code>) and <code class="inlineCode">exclude</code> (renders for all environments <em class="italic">except</em> the ones in the list).</p>
    <p class="normal">Let’s see an example:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">In the <code class="inlineCode">Views/Home</code> folder, in <code class="inlineCode">Privacy.cshtml</code>, inject the dependency service for the web host environment, as shown in the following code:
        <pre class="programlisting code"><code class="hljs-code">@inject IWebHostEnvironment webhost
</code></pre>
      </li>
      <li class="numberedList">After the heading, add two <code class="inlineCode">&lt;environment&gt;</code> elements, the first to show output only for developers <a id="_idIndexMarker1593"/>and testers, and the second to show output only for product visitors, as shown in the following markup:
        <pre class="programlisting code"><code class="hljs-code">&lt;environment names="Development,Staging"&gt;
  &lt;div class="alert alert-warning"&gt;
    &lt;h2&gt;Attention developers and testers&lt;/h2&gt;
    &lt;p&gt;
      This is a warning that only developers and testers will see.
      Current environment: 
      &lt;span class="badge bg-warning"&gt;@webhost.EnvironmentName&lt;/span&gt;
    &lt;/p&gt;
  &lt;/div&gt;
&lt;/environment&gt;
&lt;environment names="Production"&gt;
  &lt;div class="alert alert-info"&gt;
    &lt;h2&gt;Welcome, visitor!&lt;/h2&gt;
    &lt;p&gt;
      This is information that only a visitor to the production website 
      will see. Current environment: 
      &lt;span class="badge bg-info"&gt;@webhost.EnvironmentName&lt;/span&gt;
    &lt;/p&gt;
  &lt;/div&gt;
&lt;/environment&gt;
</code></pre>
      </li>
      <li class="numberedList">Start the <code class="inlineCode">Northwind.Mvc</code> website project.</li>
      <li class="numberedList">Navigate<a id="_idIndexMarker1594"/> to the <strong class="screenText">Privacy</strong> page, and note the message for developers and testers, as shown in <em class="italic">Figure 14.11</em>:</li>
    </ol>
    <figure class="mediaobject"><img alt="" src="img/B19587_14_11.png"/></figure>
    <p class="packt_figref">Figure 14.11: The Privacy page in the Development environment</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="5">Close the browser and <a id="_idIndexMarker1595"/>shut down the web server.</li>
      <li class="numberedList">In the <code class="inlineCode">Properties</code> folder, in <code class="inlineCode">launchSettings.json</code>, for the <code class="inlineCode">https</code> profile, change the<a id="_idIndexMarker1596"/> environment setting to <code class="inlineCode">Production</code>, as shown highlighted in the following JSON:
        <pre class="programlisting code"><code class="hljs-code">"https": {
  ...
  "environmentVariables": {
<strong class="hljs-slc">    </strong><strong class="hljs-attr-slc">"ASPNETCORE_ENVIRONMENT"</strong><strong class="hljs-punctuation-slc">:</strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc">"Production"</strong>
  }
},
</code></pre>
      </li>
      <li class="numberedList">Start the <code class="inlineCode">Northwind.Mvc</code> website project.</li>
      <li class="numberedList">Navigate to the <strong class="screenText">Privacy</strong> page, and note the message for public visitors, as shown in <em class="italic">Figure 14.12</em>:</li>
    </ol>
    <figure class="mediaobject"><img alt="" src="img/B19587_14_12.png"/></figure>
    <p class="packt_figref">Figure 14.12: The Privacy page in the Production environment</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="9">Close the browser and shut down the web server.</li>
      <li class="numberedList">In the <code class="inlineCode">Properties</code> folder, in <code class="inlineCode">launchSettings.json</code>, for the <code class="inlineCode">https</code> profile, change the environment setting back to <code class="inlineCode">Development</code>.</li>
    </ol>
    <h2 class="heading-2" id="_idParaDest-535">Understanding how cache busting with Tag Helpers works</h2>
    <p class="normal">When <code class="inlineCode">asp-append-version</code> is specified with a <code class="inlineCode">true</code> value in a <code class="inlineCode">&lt;link&gt;</code>, <code class="inlineCode">&lt;img&gt;</code>, or <code class="inlineCode">&lt;script&gt;</code> element, the <a id="_idIndexMarker1597"/>Tag Helper for that tag type is invoked.</p>
    <p class="normal">They work by automatically appending a query string value named <code class="inlineCode">v</code> that is generated from a SHA256 hash of the referenced source file, as shown in the following example generated output:</p>
    <pre class="programlisting code"><code class="hljs-code">&lt;script src="img/site.js? v=Kl_dqr9NVtnMdsM2MUg4qthUnWZm5T1fCEimBPWDNgM"&gt;&lt;/script&gt;
</code></pre>
    <div><p class="normal">You can see this for yourself in the current project because the <code class="inlineCode">_Layout.cshtml</code> file has the <code class="inlineCode">&lt;script src="img/site.js" asp-append-version="true"&gt;&lt;/script&gt;</code> element.</p>
    </div>
    <p class="normal">If even a single byte within the <code class="inlineCode">site.js</code> file changes, then its hash value will be different, and therefore if a browser or CDN is caching the script file, then it will bust the cached copy and replace it with the new version.</p>
    <p class="normal">The <code class="inlineCode">src</code> attribute must be set to a static file stored on the local web server, usually in the <code class="inlineCode">wwwroot</code> folder, but you can configure additional locations. Remote references are not supported.</p>
    <h2 class="heading-2" id="_idParaDest-536">Exploring Forms-related Tag Helpers</h2>
    <p class="normal">The Form Tag Helper <a id="_idIndexMarker1598"/>generates the <code class="inlineCode">&lt;form&gt;</code> elements <code class="inlineCode">action</code> attribute for an MVC controller action or named route. Like the Anchor Tag Helper, you can pass <a id="_idIndexMarker1599"/>parameters using the <code class="inlineCode">asp-route-&lt;parametername&gt;</code> attribute. It also generates a hidden verification token to prevent cross-site request forgery. You must apply the <code class="inlineCode">[ValidateAntiForgeryToken]</code> attribute to the HTTP <code class="inlineCode">POST</code> action method to properly use this feature.</p>
    <p class="normal">The Label and Input Tag Helpers bind labels and inputs to properties on a model. They can then generate the <code class="inlineCode">id</code>, <code class="inlineCode">name</code>, and <code class="inlineCode">for</code> attributes automatically, as well as add validation attributes and messages.</p>
    <p class="normal">Let’s see an example of a form for entering shipper information:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">In the <code class="inlineCode">Views/Home</code> folder, in <code class="inlineCode">Shipper.cshtml</code>, duplicate the existing markup that outputs shipper details, wrap it in a <code class="inlineCode">&lt;form&gt;</code> element that uses the Form Tag Helper, and modify the <code class="inlineCode">&lt;label&gt;</code> and <code class="inlineCode">&lt;input&gt;</code> elements to use the Label and Input Tag Helpers, as <a id="_idIndexMarker1600"/>shown highlighted in the<a id="_idIndexMarker1601"/> following markup:
        <pre class="programlisting code"><code class="hljs-code">@model Shipper
@{
  ViewData["Title"] = "Shippers";
}
&lt;h1&gt;@ViewData["Title"]&lt;/h1&gt;
<strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">h2</strong><strong class="hljs-tag-slc">&gt;</strong><strong class="hljs-slc">Without Form Tag Helper</strong><strong class="hljs-tag-slc">&lt;/</strong><strong class="hljs-name-slc">h2</strong><strong class="hljs-tag-slc">&gt;</strong>
&lt;div&gt;
  &lt;div class="mb-3"&gt;
    &lt;label for="shipperIdInput" class="form-label"&gt;Shipper ID&lt;/label&gt;
    &lt;input type="number" class="form-control" id="shipperIdInput"
           value="@Model.ShipperId"&gt;
  &lt;/div&gt;
  &lt;div class="mb-3"&gt;
    &lt;label for="companyNameInput" class="form-label"&gt;Company Name&lt;/label&gt;
    &lt;input class="form-control" id="companyNameInput"
           value="@Model.CompanyName"&gt;
  &lt;/div&gt;
  &lt;div class="mb-3"&gt;
    &lt;label for="phoneInput" class="form-label"&gt;Phone&lt;/label&gt;
    &lt;input class="form-control" id="phoneInput" value="@Model.Phone"&gt;
  &lt;/div&gt;
&lt;/div&gt;
<strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">h2</strong><strong class="hljs-tag-slc">&gt;</strong><strong class="hljs-slc">With Form Tag Helper</strong><strong class="hljs-tag-slc">&lt;/</strong><strong class="hljs-name-slc">h2</strong><strong class="hljs-tag-slc">&gt;</strong>
<strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">form</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">asp-controller</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">"Home"</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">asp-action</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">"ProcessShipper"</strong><strong class="hljs-tag-slc"> </strong>
<strong class="hljs-tag-slc">      </strong><strong class="hljs-attr-slc">class</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">"form-horizontal"</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">role</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">"form"</strong><strong class="hljs-tag-slc">&gt;</strong>
<strong class="hljs-slc">  </strong><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">div</strong><strong class="hljs-tag-slc">&gt;</strong>
<strong class="hljs-slc">    </strong><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">div</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">class</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">"mb-3"</strong><strong class="hljs-tag-slc">&gt;</strong>
<strong class="hljs-slc">      </strong><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">label</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">asp-for</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">"ShipperId"</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">class</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">"</strong><strong class="hljs-string-slc">form-label"</strong><strong class="hljs-tag-slc"> /&gt;</strong>
<strong class="hljs-slc">      </strong><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">input</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">asp-for</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">"ShipperId"</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">class</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">"form-control"</strong><strong class="hljs-tag-slc">&gt;</strong>
<strong class="hljs-slc">    </strong><strong class="hljs-tag-slc">&lt;/</strong><strong class="hljs-name-slc">div</strong><strong class="hljs-tag-slc">&gt;</strong>
<strong class="hljs-slc">    </strong><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">div</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">class</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">"mb-3"</strong><strong class="hljs-tag-slc">&gt;</strong>
<strong class="hljs-slc">      </strong><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">label</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">asp-for</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">"CompanyName"</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">class</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">"form-label"</strong><strong class="hljs-tag-slc"> /&gt;</strong>
<strong class="hljs-slc">      </strong><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">input</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">asp-for</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">"CompanyName"</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">class</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">"form-control"</strong><strong class="hljs-tag-slc">&gt;</strong>
<strong class="hljs-slc">    </strong><strong class="hljs-tag-slc">&lt;/</strong><strong class="hljs-name-slc">div</strong><strong class="hljs-tag-slc">&gt;</strong>
<strong class="hljs-slc">    </strong><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">div</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">class</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">"</strong><strong class="hljs-string-slc">mb-3"</strong><strong class="hljs-tag-slc">&gt;</strong>
<strong class="hljs-slc">      </strong><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">label</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">asp-for</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">"Phone"</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">class</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">"form-label"</strong><strong class="hljs-tag-slc"> /&gt;</strong>
<strong class="hljs-slc">      </strong><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">input</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">asp-for</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">"</strong><strong class="hljs-string-slc">Phone"</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">class</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">"form-control"</strong><strong class="hljs-tag-slc">&gt;</strong>
<strong class="hljs-slc">    </strong><strong class="hljs-tag-slc">&lt;/</strong><strong class="hljs-name-slc">div</strong><strong class="hljs-tag-slc">&gt;</strong>
<strong class="hljs-slc">    </strong><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">div</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">class</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">"mb-3"</strong><strong class="hljs-tag-slc">&gt;</strong>
<strong class="hljs-slc">      </strong><strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">input</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">type</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">"submit"</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">class</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">"form-control"</strong><strong class="hljs-tag-slc">&gt;</strong>
<strong class="hljs-slc">    </strong><strong class="hljs-tag-slc">&lt;/</strong><strong class="hljs-name-slc">div</strong><strong class="hljs-tag-slc">&gt;</strong>
<strong class="hljs-slc">  </strong><strong class="hljs-tag-slc">&lt;/</strong><strong class="hljs-name-slc">div</strong><strong class="hljs-tag-slc">&gt;</strong>
<strong class="hljs-tag-slc">&lt;/</strong><strong class="hljs-name-slc">form</strong><strong class="hljs-tag-slc">&gt;</strong>
</code></pre>
      </li>
      <li class="numberedList">In the <code class="inlineCode">Controllers</code> folder, in <code class="inlineCode">HomeController.cs</code>, add an action method named <code class="inlineCode">ProcessShipper</code>. Give it a<a id="_idIndexMarker1602"/> parameter to receive a shipper entity and then return it as <a id="_idIndexMarker1603"/>a JSON document using the <code class="inlineCode">Json</code> method, as shown in the following code:
        <pre class="programlisting code"><code class="hljs-code">[HttpPost]
[ValidateAntiForgeryToken]
public IActionResult ProcessShipper(Shipper shipper)
{
  return Json(shipper);
}
</code></pre>
      </li>
      <li class="numberedList">Start the <code class="inlineCode">Northwind.Mvc</code> website project.</li>
      <li class="numberedList">Navigate to the <strong class="screenText">Privacy</strong> page, and then click the <strong class="screenText">Shipper</strong> button. </li>
      <li class="numberedList">On the <strong class="screenText">Shipper</strong> page, right-click, select <strong class="screenText">View page source</strong>, and note the different HTML output for the form generated by the Form, Input, and Label Tag Helpers, including a hidden element named <code class="inlineCode">__RequestVerificationToken</code>, as shown in the following markup:
        <pre class="programlisting code"><code class="hljs-code">&lt;h2&gt;With Form Tag Helper&lt;/h2&gt;
&lt;form class="form-horizontal" role="form" action="/Home/ProcessShipper" method="post"&gt;
  &lt;div&gt;
    &lt;div class="mb-3"&gt;
      &lt;label class="form-label" for="ShipperId" /&gt;
      &lt;input class="form-control" type="number" data-val="true" data-val-required="The ShipperId field is required." id="ShipperId" name="ShipperId" value="1"&gt;
    &lt;/div&gt;
    &lt;div class="mb-3"&gt;
      &lt;label class="form-label" for="CompanyName" /&gt;
      &lt;input class="form-control" type="text" data-val="true" data-val-length="The field CompanyName must be a string with a maximum length of 40." data-val-length-max="40" data-val-required="The CompanyName field is required." id="CompanyName" maxlength="40" name="CompanyName" value="Speedy Express"&gt;
    &lt;/div&gt;
    &lt;div class="mb-3"&gt;
      &lt;label class="form-label" for="Phone" /&gt;
      &lt;input class="form-control" type="text" data-val="true" data-val-length="The field Phone must be a string with a maximum length of 24." data-val-length-max="24" id="Phone" maxlength="24" name="Phone" value="(503) 555-9831"&gt;
    &lt;/div&gt;
    &lt;div class="mb-3"&gt;
      &lt;input type="submit" class="form-control"&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;input name="__RequestVerificationToken" type="hidden" value="CfDJ8NTt08jabvBCqd1P4J-HCq3X9CDrTPjBphdDdVmG6UT0GFBJk1w7F1OLmNT-jEGjlGIjfV3kmNUaofOAxlGgiZJwbAR73g-QgFw8oFV_0vjlo45t9dL9E1l1hZzjLXtj8B7ysDkCYcm8W9zS0T7V3R0" /&gt;&lt;/form&gt;
</code></pre>
      </li>
      <li class="numberedList">In the form, change the shipper ID and company name, noting that attributes like <code class="inlineCode">maxlength="40"</code> prevent a company name longer than 40 characters, and <code class="inlineCode">type="number"</code> only <a id="_idIndexMarker1604"/>allows numbers for the<a id="_idIndexMarker1605"/> shipper ID.</li>
      <li class="numberedList">Click the <strong class="screenText">Submit</strong> button and note the JSON document returned, as shown in the following output:
        <pre class="programlisting con"><code class="hljs-con">{"shipperId":1,"companyName":"Speedy Express","phone":"(503) 555-9831","orders":[]}
</code></pre>
      </li>
      <li class="numberedList">Close the browser and shut down the web server.</li>
    </ol>
    <h1 class="heading-1" id="_idParaDest-537">Output caching</h1>
    <p class="normal">In some ways, output caching is like response caching, which we covered in <em class="chapterRef">Chapter 9</em>, <em class="italic">Caching, Queuing, and Resilient Background Services</em>. Output caching can store dynamically generated responses on the server so that they do not have to be regenerated again for another<a id="_idIndexMarker1606"/> request. This can improve performance. Unlike response caching, output caching does not rely on clients and intermediaries doing what they are told by the HTTP response headers.</p>
    <h2 class="heading-2" id="_idParaDest-538">Output caching endpoints</h2>
    <p class="normal">Let’s see it in action with a really<a id="_idIndexMarker1607"/> simple example of applying output caching to some endpoints to make sure it is working properly:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">In the <code class="inlineCode">Northwind.Mvc</code> project, in <code class="inlineCode">Program.cs</code>, after the call to <code class="inlineCode">AddNorthwindContext</code>, add a statement to add the output cache middleware and override the default expiration timespan to make it only 10 seconds, as shown in the following code:
        <pre class="programlisting code"><code class="hljs-code">builder.Services.AddOutputCache(options =&gt;
{
  options.DefaultExpirationTimeSpan = TimeSpan.FromSeconds(10);
});
</code></pre>
      
    <div><p class="normal"><strong class="keyWord">Good Practice</strong>: The default expiration time span is one minute. Think carefully about what the duration should be.</p>
    </div></li>
    </ol>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="2">In <code class="inlineCode">Program.cs</code>, before the call to map controller routes, add a statement to use output cache, as shown in the following code:
        <pre class="programlisting code"><code class="hljs-code">app.UseOutputCache();
</code></pre>
      </li>
      <li class="numberedList">In <code class="inlineCode">Program.cs</code>, after the call to map Razor Pages, add statements to create two simple endpoints that respond with plain text, one that is not cached and one that uses the output cache, as shown in the following code:
        <pre class="programlisting code"><code class="hljs-code">app.MapGet("/notcached", () =&gt; DateTime.Now.ToString());
app.MapGet("/cached", () =&gt; DateTime.Now.ToString()).CacheOutput();
</code></pre>
      </li>
      <li class="numberedList">In <code class="inlineCode">appsettings.Development.json</code>, add a log level of <code class="inlineCode">Information</code> for the output caching middleware, as shown highlighted in the following configuration:
        <pre class="programlisting code"><code class="hljs-code">{
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning"<strong class="hljs-punctuation-slc">,</strong>
<strong class="hljs-slc">      </strong><strong class="hljs-attr-slc">"</strong><strong class="hljs-attr-slc">Microsoft.AspNetCore.OutputCaching"</strong><strong class="hljs-punctuation-slc">:</strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc">"Information"</strong>
    }
  }
}
</code></pre>
      </li>
      <li class="numberedList">Start the <code class="inlineCode">Northwind.Mvc</code> website project and arrange the browser window and command prompt or <a id="_idIndexMarker1608"/>terminal window so that you can see both.</li>
      <li class="numberedList">In the browser, navigate to <code class="inlineCode">https://localhost:5141/notcached</code>, and note nothing is written to the command prompt or terminal.</li>
      <li class="numberedList">In the browser, click the <strong class="screenText">Refresh</strong> button several times and note that the time is always updated because it is not served from the output cache.</li>
      <li class="numberedList">In the browser, navigate to <code class="inlineCode">https://localhost:5141/cached</code>, and note that messages are written to the command prompt or terminal to tell you that you have made a request for a cached resource but it does not have anything in the output cache so it has now cached the output, as shown in the following output:
        <pre class="programlisting con"><code class="hljs-con">info: Microsoft.AspNetCore.OutputCaching.OutputCacheMiddleware[7]
      No cached response available for this request.
info: Microsoft.AspNetCore.OutputCaching.OutputCacheMiddleware[9]
      The response has been cached.
</code></pre>
      </li>
      <li class="numberedList">In the browser, click the <strong class="screenText">Refresh</strong> button several times and note that the time is not updated, and an output caching message tells you that the value was served from the cache, as shown in the following output:
        <pre class="programlisting con"><code class="hljs-con">info: Microsoft.AspNetCore.OutputCaching.OutputCacheMiddleware[5]
      Serving response from cache.
</code></pre>
      </li>
      <li class="numberedList">Continue refreshing until 10 seconds have passed and note that messages are written to the command line or terminal to tell you that the cached output has been<a id="_idIndexMarker1609"/> updated.</li>
      <li class="numberedList">Close the browser and shut down the web server.</li>
    </ol>
    <h2 class="heading-2" id="_idParaDest-539">Output caching MVC views</h2>
    <p class="normal">Now let’s see how we can output cache an MVC view:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">In <code class="inlineCode">Program.cs</code>, at the end of the<a id="_idIndexMarker1610"/> call to map controllers, add a call to the <code class="inlineCode">CacheOutput</code> method, as shown highlighted in the following code:
        <pre class="programlisting code"><code class="hljs-code">app.MapControllerRoute(
    name: "default",
    pattern: "{controller=Home}/{action=Index}/{id?}")
  <strong class="hljs-slc">.CacheOutput()</strong>;
</code></pre>
      </li>
      <li class="numberedList">Start the <code class="inlineCode">Northwind.Mvc</code> website project and arrange the browser window and command prompt or terminal window so that you can see both.</li>
      <li class="numberedList">At the command prompt or terminal, note that the home page with its table of orders is not in the output cache, so SQL commands are executed to get the data, and then once the Razor view generates the page, it is stored in the cache, as shown highlighted in the following output:
        <pre class="programlisting con"><code class="hljs-con">info: Microsoft.Hosting.Lifetime[14]
      Now listening on: https://localhost:5141
info: Microsoft.Hosting.Lifetime[14]
      Now listening on: http://localhost:5142
info: Microsoft.Hosting.Lifetime[0]
      Application started. Press Ctrl+C to shut down.
info: Microsoft.Hosting.Lifetime[0]
      Hosting environment: Development
info: Microsoft.Hosting.Lifetime[0]
      Content root path: C:\apps-services-net8\Chapter14\Northwind.Mvc
<strong class="hljs-con-slc">info: Microsoft.AspNetCore.OutputCaching.OutputCacheMiddleware[7]</strong>
<strong class="hljs-con-slc">      No cached response available for this request.</strong>
dbug: 6/16/2023 10:40:15.252 RelationalEventId.CommandExecuting[20100] (Microsoft.EntityFrameworkCore.Database.Command)
      Executing DbCommand [Parameters=[], CommandType='Text', CommandTimeout='30']
      SELECT [o].[OrderId], [o].[CustomerId], [o].[EmployeeId], [o].[Freight], [o].[OrderDate], [o].[RequiredDate], [o].[ShipAddress], [o].[ShipCity], [o].[ShipCountry], [o].[ShipName], [o].[ShipPostalCode], [o].[ShipRegion], [o].[ShipVia], [o].[ShippedDate], [c].[CustomerId], [c].[Address], [c].[City], [c].[CompanyName], [c].[ContactName], [c].[ContactTitle], [c].[Country], [c].[Fax], [c].[Phone], [c].[PostalCode], [c].[Region], [o0].[OrderId], [o0].[ProductId], [o0].[Discount], [o0].[Quantity], [o0].[UnitPrice]
      FROM [Orders] AS [o]
      LEFT JOIN [Customers] AS [c] ON [o].[CustomerId] = [c].[CustomerId]
      LEFT JOIN [Order Details] AS [o0] ON [o].[OrderId] = [o0].[OrderId]
      ORDER BY [o].[OrderId], [c].[CustomerId], [o0].[OrderId]
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (32ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
      SELECT [o].[OrderId], [o].[CustomerId], [o].[EmployeeId], [o].[Freight], [o].[OrderDate], [o].[RequiredDate], [o].[ShipAddress], [o].[ShipCity], [o].[ShipCountry], [o].[ShipName], [o].[ShipPostalCode], [o].[ShipRegion], [o].[ShipVia], [o].[ShippedDate], [c].[CustomerId], [c].[Address], [c].[City], [c].[CompanyName], [c].[ContactName], [c].[ContactTitle], [c].[Country], [c].[Fax], [c].[Phone], [c].[PostalCode], [c].[Region], [o0].[OrderId], [o0].[ProductId], [o0].[Discount], [o0].[Quantity], [o0].[UnitPrice]
      FROM [Orders] AS [o]
      LEFT JOIN [Customers] AS [c] ON [o].[CustomerId] = [c].[CustomerId]
      LEFT JOIN [Order Details] AS [o0] ON [o].[OrderId] = [o0].[OrderId]
      ORDER BY [o].[OrderId], [c].[CustomerId], [o0].[OrderId]
<strong class="hljs-con-slc">info: Microsoft.AspNetCore.OutputCaching.OutputCacheMiddleware[8]</strong>
<strong class="hljs-con-slc">      The response has been cached.</strong> 
</code></pre>
      </li>
      <li class="numberedList">On the home page, note the current time, and then refresh the page and note that the whole page, including the time and orders table, is served from the output cache, as shown in the following output:
        <pre class="programlisting con"><code class="hljs-con">info: Microsoft.AspNetCore.OutputCaching.OutputCacheMiddleware[5]
      Serving response from cache.
</code></pre>
      </li>
      <li class="numberedList">Keep refreshing until 10 <a id="_idIndexMarker1611"/>seconds have passed and note that the page is then regenerated from the database and the current time is shown.</li>
      <li class="numberedList">Close the browser and shut down the web server.</li>
    </ol>
    <p class="normal">There are many other ways to vary the cached results for output caching and the ASP.NET Core team intends to add more capabilities in the future.</p>
    <h1 class="heading-1" id="_idParaDest-540">Practicing and exploring</h1>
    <p class="normal">Test your knowledge and understanding by answering some questions, getting some hands-on practice, and exploring this chapter’s topics with deeper research.</p>
    <h2 class="heading-2" id="_idParaDest-541">Exercise 14.1 – Test your knowledge</h2>
    <p class="normal">Answer the following questions:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">What is the advantage of declaring a strongly typed Razor view and how do you do it?</li>
      <li class="numberedList">How do you enable Tag Helpers in a view?</li>
      <li class="numberedList">What are the pros and cons of HTML Helper methods compared to Tag Helpers?</li>
      <li class="numberedList">How can a browser request a preferred language for localization?</li>
      <li class="numberedList">How do you localize text in a view?</li>
      <li class="numberedList">What is the prefix for attributes recognized by Tag Helpers?</li>
      <li class="numberedList">How can you pass a complex object as a query string parameter?</li>
      <li class="numberedList">How can you control how long the contents of the <code class="inlineCode">&lt;cache&gt;</code> element are cached for?</li>
      <li class="numberedList">What is the <code class="inlineCode">&lt;environment&gt;</code> element used for?</li>
      <li class="numberedList">How does cache busting with Tag Helpers work?</li>
    </ol>
    <h2 class="heading-2" id="_idParaDest-542">Exercise 14.2 – Practice building user interfaces with Boostrap</h2>
    <p class="normal">Create a new ASP.NET Core MVC project named <code class="inlineCode">Ch14Ex02_ExploringBootstrap</code>. Add views that implement the following Bootstrap features:</p>
    <ul>
      <li class="bulletList">Accordion: <a href="https://getbootstrap.com/docs/5.3/components/accordion/">https://getbootstrap.com/docs/5.3/components/accordion/</a>.</li>
      <li class="bulletList">Cards: <a href="https://getbootstrap.com/docs/5.3/components/card/">https://getbootstrap.com/docs/5.3/components/card/</a>.</li>
      <li class="bulletList">Carousel: <a href="https://getbootstrap.com/docs/5.3/components/carousel/">https://getbootstrap.com/docs/5.3/components/carousel/</a>.</li>
      <li class="bulletList">NavBar: <a href="https://getbootstrap.com/docs/5.3/components/navbar/">https://getbootstrap.com/docs/5.3/components/navbar/</a>.</li>
      <li class="bulletList">Popovers: <a href="https://getbootstrap.com/docs/5.3/components/popovers/">https://getbootstrap.com/docs/5.3/components/popovers/</a>.</li>
      <li class="bulletList">Toast: <a href="https://getbootstrap.com/docs/5.3/components/toasts/">https://getbootstrap.com/docs/5.3/components/toasts/</a>.</li>
      <li class="bulletList">Tooltips: <a href="https://getbootstrap.com/docs/5.3/components/tooltips/">https://getbootstrap.com/docs/5.3/components/tooltips/</a>.</li>
    </ul>
    <h2 class="heading-2" id="_idParaDest-543">Exercise 14.3 – Explore topics</h2>
    <p class="normal">Use the links on the following page to learn more about the topics covered in this chapter:</p>
    <p class="normal"><a href="https://github.com/markjprice/apps-services-net8/blob/main/docs/book-links.md#chapter-14---building-web-user-interfaces-using-aspnet-core">https://github.com/markjprice/apps-services-net8/blob/main/docs/book-links.md#chapter-14---building-web-user-interfaces-using-aspnet-core</a></p>
    <h1 class="heading-1" id="_idParaDest-544">Summary</h1>
    <p class="normal">In this chapter, you learned how to build user interfaces using ASP.NET Core MVC. You learned about:</p>
    <ul>
      <li class="bulletList">ASP.NET Core Razor views and Razor syntax</li>
      <li class="bulletList">Some common Bootstrap styles</li>
      <li class="bulletList">Localizing and globalizing an ASP.NET Core website</li>
      <li class="bulletList">HTML Helpers and Tag Helpers</li>
      <li class="bulletList">Output caching endpoints and views</li>
    </ul>
    <p class="normal">In the next chapter, you will learn how to build web user interface components using Blazor.</p>
  </div>
</body></html>