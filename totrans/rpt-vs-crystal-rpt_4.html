<html><head></head><body><div class="chapter" title="Chapter&#xA0;4.&#xA0;Creating First Report"><div class="titlepage"><div><div><h1 class="title"><a id="ch04"/>Chapter 4. Creating First Report</h1></div></div></div><p>In this chapter, we will see how to create a simple report and display this report in our application. We will begin by preparing the report data and connecting that data to our report. Then we will formulate our report data and display the resulting report in our application.</p><p>We will cover the following topics:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Preparing a report data</li><li class="listitem" style="list-style-type: disc">Adding a report to the application</li><li class="listitem" style="list-style-type: disc">Using a database expert</li><li class="listitem" style="list-style-type: disc">Choosing a report template</li><li class="listitem" style="list-style-type: disc">Creating report sections</li><li class="listitem" style="list-style-type: disc">Working with lines and boxes</li><li class="listitem" style="list-style-type: disc">Using special fields</li><li class="listitem" style="list-style-type: disc">Adding the report to a form</li></ul></div><div class="section" title="Preparing a report data"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec22"/>Preparing a report data</h1></div></div></div><p>Before we begin to add <a id="id103" class="indexterm"/>Crystal Reports to our application, we need to understand the data that we will be displaying and know what data will be displayed in this report. Look at the design of the report in the following screenshot:</p><div class="mediaobject"><img src="graphics/4-1.jpg" alt="Preparing a report data"/></div><div class="section" title="Selecting the report data"><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec24"/>Selecting the report data</h2></div></div></div><p>As we can see in the <a id="id104" class="indexterm"/>preceding screenshot, all report data comes from the <code class="literal">Employees</code> table. The <span class="strong"><strong>SELECT</strong></span> query will appear as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/4-2.jpg" alt="Selecting the report data"/></div><p>When we compare the report data with the data retrieved through the query, we will find two differences changes:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>The </strong></span><span class="strong"><strong>Full Name</strong></span><span class="strong"><strong> column</strong></span>: The <span class="strong"><strong>Full Name</strong></span> column is displayed in the report as one part but in the database it consists of three parts (<span class="strong"><strong>TitleOfCourtesy</strong></span>, <span class="strong"><strong>FirstName</strong></span>, and <span class="strong"><strong>LastName</strong></span>). We can address this problem here in the <code class="literal">SELECT</code> query or in the report itself. We can concatenate the three fields into one field using the SQL query by the plus (<code class="literal">+</code>) operator, as shown in the following screenshot:<div class="mediaobject"><img src="graphics/4-3.jpg" alt="Selecting the report data"/></div></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>The </strong></span><span class="strong"><strong>Reports To</strong></span><span class="strong"><strong> column</strong></span>: The <span class="strong"><strong>Reports To</strong></span> column is displayed in the report as a name, but as we<a id="id105" class="indexterm"/> can see in the preceding screenshot it is displayed as number. If we look at the <span class="strong"><strong>Employee</strong></span> table we will see that this table has a self-join relationship, see the following screenshot:<div class="mediaobject"><img src="graphics/4-4.jpg" alt="Selecting the report data"/></div></li></ul></div><p>We can modify our query to display names rather than numbers in two ways:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Using subquery</strong></span>: We will <a id="id106" class="indexterm"/>update the query to look like the following screenshot:<div class="mediaobject"><img src="graphics/4-5.jpg" alt="Selecting the report data"/></div></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Using self join</strong></span>: We will <a id="id107" class="indexterm"/>update the query to look like the following screenshot:<div class="mediaobject"><img src="graphics/4-6.jpg" alt="Selecting the report data"/></div></li></ul></div></div><div class="section" title="Creating a TableAdapter"><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec25"/>Creating a TableAdapter</h2></div></div></div><p>Here are the steps for<a id="id108" class="indexterm"/> creating a TableAdapter:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open <span class="strong"><strong>DataSet1</strong></span> from <span class="strong"><strong>Solution Explorer</strong></span>.</li><li class="listitem">Right-click on it and navigate to <span class="strong"><strong>Add</strong></span> | <span class="strong"><strong>TableAdapter</strong></span>.</li><li class="listitem">Select your connection settings and click on the <span class="strong"><strong>Next</strong></span> button.</li><li class="listitem">Select the <span class="strong"><strong>Use SQL Statements</strong></span> option and click on the <span class="strong"><strong>Next</strong></span> button.</li><li class="listitem">Write our selection query as we see in the preceding screenshot and click on the <span class="strong"><strong>Next</strong></span> button.</li><li class="listitem">Click on the <span class="strong"><strong>Next</strong></span> button on the subsequent screens and click on the <span class="strong"><strong>Finish</strong></span> button for the last screen.</li><li class="listitem">Change your <a id="id109" class="indexterm"/>adapter name as shown in the following screenshot:<div class="mediaobject"><img src="graphics/4-7.jpg" alt="Creating a TableAdapter"/></div></li></ol></div></div></div></div>
<div class="section" title="Adding a report to the application"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec23"/>Adding a report to the application</h1></div></div></div><p>In this section, we will see how to add <a id="id110" class="indexterm"/>Crystal Reports to our application to display all <span class="strong"><strong>Employee</strong></span> data from the database.</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Right-click on our application (<span class="strong"><strong>Monitor</strong></span>) in <span class="strong"><strong>Solution Explorer</strong></span> and navigate to <span class="strong"><strong>Add</strong></span> | <span class="strong"><strong>New Item</strong></span>. We will get a result as shown in the following screenshot:<div class="mediaobject"><img src="graphics/4-8.jpg" alt="Adding a report to the application"/></div></li><li class="listitem">From the <a id="id111" class="indexterm"/>menu on the left-hand side, select <span class="strong"><strong>Reporting</strong></span> and select <span class="strong"><strong>Crystal Reports</strong></span> from the options on the right-hand side. Change the name to <code class="literal">crAllEmployees.rpt</code> and click on the <span class="strong"><strong>Add</strong></span> button. We will get a result as shown in the following screenshot:<div class="mediaobject"><img src="graphics/4-9.jpg" alt="Adding a report to the application"/></div></li><li class="listitem">We have <a id="id112" class="indexterm"/>three options to create our report. From the preceding screenshot, we select <span class="strong"><strong>Standard</strong></span> and use the report wizard to create the report. We will be using the other methods later and they will be explained in the following chapters. Click on the <span class="strong"><strong>OK</strong></span> button to see the following screenshot:<div class="mediaobject"><img src="graphics/4-10.jpg" alt="Adding a report to the application"/></div></li><li class="listitem">In this step, we will<a id="id113" class="indexterm"/> choose our TableAdapter that we created before to be used in this report. We will expand <span class="strong"><strong>Project Data</strong></span> | <span class="strong"><strong>ADO.NET DataSets</strong></span> | <span class="strong"><strong>Monitor.DataSet1</strong></span> and choose the <span class="strong"><strong>Employees</strong></span> TableAdapter and move it to the <span class="strong"><strong>Selected Tables</strong></span> list. Then click on the <span class="strong"><strong>Next</strong></span> button as shown in the following screenshot:<div class="mediaobject"><img src="graphics/4-11.jpg" alt="Adding a report to the application"/></div></li><li class="listitem">In this step, <a id="id114" class="indexterm"/>we will choose the fields that we need to display in our report, we can add/remove these fields any time we need to after the report creation. Select all the required fields, move them to <span class="strong"><strong>Fields To Display</strong></span> menu, and click on the <span class="strong"><strong>Next</strong></span> button to see the following screenshot:<div class="mediaobject"><img src="graphics/4-12.jpg" alt="Adding a report to the application"/></div></li><li class="listitem">In this step we <a id="id115" class="indexterm"/>can add a group to our report, but we don't need any grouping in this report. We will use grouping in other reports and we will see that we can add any group after report creation. Click on the <span class="strong"><strong>Next</strong></span> button to see the following screenshot:<div class="mediaobject"><img src="graphics/4-13.jpg" alt="Adding a report to the application"/></div></li><li class="listitem">In this step we <a id="id116" class="indexterm"/>can add a filter to our report, but we don't need any filter in this report. We will use filters in other reports and we can add any filter after the report is created. Click on the <span class="strong"><strong>Next</strong></span> button to see the following screenshot:<div class="mediaobject"><img src="graphics/4-14.jpg" alt="Adding a report to the application"/></div></li><li class="listitem">In this step we<a id="id117" class="indexterm"/> will choose the report style. You can browse the styles available and choose the one you like. We will choose the <span class="strong"><strong>Standard</strong></span> style and click on the <span class="strong"><strong>Finish</strong></span> button to see the following screenshot:<div class="mediaobject"><img src="graphics/4-15.jpg" alt="Adding a report to the application"/></div></li><li class="listitem">This report has five main sections:<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Section 1 (Report Header)</strong></span>: Any data (text, image, and so on) inserted in this section will be displayed in the report for one time in the top of the first paper only</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Section 2 (Page Header)</strong></span>: Any data (text, image, and so on) inserted in this section will be displayed in the header of each page in the report</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Section 3 (Details)</strong></span>: This section displays the data from the data source containing multiple rows of returned results like Microsoft SQL Server in our sample</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Section 4 (Report Footer)</strong></span>: Any data (text, image, and so on) inserted in this section will be displayed for one time in the end of the last page in the report only</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Section 5 (Page Footer)</strong></span>: Any data (text, image, and so on) inserted in this section will be displayed in the footer of each page in the report</li></ul></div></li><li class="listitem">We need to add <a id="id118" class="indexterm"/><span class="strong"><strong>All Employees</strong></span> text as a header to our report so we will add it in the <span class="strong"><strong>Report Header</strong></span> section:<div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Right-click on <span class="strong"><strong>Section2 (Report Header)</strong></span> and navigate to <span class="strong"><strong>Insert</strong></span> | <span class="strong"><strong>Text Object</strong></span>.</li><li class="listitem">Double-click on <span class="strong"><strong>Text Object</strong></span> and enter <code class="literal">All Employees</code>.</li><li class="listitem">Right-click on <span class="strong"><strong>Text Object</strong></span> and choose <span class="strong"><strong>Format Object</strong></span>, navigate to the <span class="strong"><strong>Font</strong></span> tab, and change <span class="strong"><strong>Style</strong></span> to <span class="strong"><strong>Bold</strong></span> and <span class="strong"><strong>Size</strong></span> to <span class="strong"><strong>12</strong></span>. Navigate to the <span class="strong"><strong>Paragraph</strong></span> tab, change <span class="strong"><strong>Alignment</strong></span> to <span class="strong"><strong>Centered</strong></span> and click on the <span class="strong"><strong>OK</strong></span> button.</li><li class="listitem">Move the <span class="strong"><strong>Text Object</strong></span> to the horizontal middle of the section.</li></ol></div></li><li class="listitem">We will format all report objects and fields as we did with <span class="strong"><strong>All Employees</strong></span> <span class="strong"><strong>Text Object</strong></span> so the report will look like the following screenshot:<div class="mediaobject"><img src="graphics/4-16.jpg" alt="Adding a report to the application"/></div></li></ol></div></div>
<div class="section" title="Working with lines and boxes"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec24"/>Working with lines and boxes</h1></div></div></div><p>In this section we will see how <a id="id119" class="indexterm"/>to use boxes<a id="id120" class="indexterm"/> and lines to enhance our report design.</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Right-click on <span class="strong"><strong>Section 2(Page Header)</strong></span> and navigate to <span class="strong"><strong>Insert</strong></span> | <span class="strong"><strong>Box</strong></span> and draw a box around our fields as shown in the following screenshot:<div class="mediaobject"><img src="graphics/4-17.jpg" alt="Working with lines and boxes"/></div></li><li class="listitem">Right-click on <span class="strong"><strong>Section 2(Page Header)</strong></span> and navigate to <span class="strong"><strong>Insert</strong></span> | <span class="strong"><strong>Line</strong></span> and draw a line as shown in the following screenshot:<div class="mediaobject"><img src="graphics/4-18.jpg" alt="Working with lines and boxes"/></div></li><li class="listitem">Add some lines between fields, as shown in the following screenshot:<div class="mediaobject"><img src="graphics/4-19.jpg" alt="Working with lines and boxes"/></div></li></ol></div></div>
<div class="section" title="Using special fields"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec25"/>Using special fields</h1></div></div></div><p>In Crystal Reports, <a id="id121" class="indexterm"/>there are a lot of special fields that we can use in our reports; in this section we will see how to use these special fields.</p><p>We need to add the page number and total page number in the page footer to display the page location in the total page count. The steps for this purpose are as follows:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Right-click in our report and navigate to <span class="strong"><strong>Field Explorer</strong></span>.</li><li class="listitem">From <span class="strong"><strong>Filed Explorer</strong></span>, open the <span class="strong"><strong>Special Fields</strong></span> node and drag <span class="strong"><strong>Page N of M</strong></span> to <span class="strong"><strong>Section5 (Page Footer)</strong></span>. The <span class="strong"><strong>Page N of M</strong></span> special field will replace <span class="strong"><strong>N</strong></span> with the page number and <span class="strong"><strong>M</strong></span> with the total pages count when we run the report. See the following screenshot:<div class="mediaobject"><img src="graphics/4-20.jpg" alt="Using special fields"/></div></li></ol></div></div>
<div class="section" title="Adding the report to a form"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec26"/>Adding the report to a form</h1></div></div></div><p>In the preceding steps, we <a id="id122" class="indexterm"/>have completed the report design; the next step is <a id="id123" class="indexterm"/>displaying this report when the user clicks on the <span class="strong"><strong>btnEmpAll</strong></span> button.</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">First, we will add a form that we will use to display all reports; we will name this form <code class="literal">ReportForm</code>.</li><li class="listitem">From <span class="strong"><strong>Toolbox</strong></span> <span class="strong"><strong>|</strong></span> <span class="strong"><strong>Reporting</strong></span>, drag-and-drop <span class="strong"><strong>crystalReportViewer</strong></span> to <span class="strong"><strong>ReportForm</strong></span> and name it <code class="literal">crystalReportViewer1</code>.</li><li class="listitem">Double-click on <span class="strong"><strong>btnEmpAll</strong></span> to navigate to the earlier code. We will see the <code class="literal">click</code> event of the <span class="strong"><strong>btnEmpAll</strong></span> button.</li><li class="listitem">In the <code class="literal">click</code> event of the button <span class="strong"><strong>btnEmpAll</strong></span>, enter the code as shown in the following screenshot:<div class="mediaobject"><img src="graphics/4-21.jpg" alt="Adding the report to a form"/></div></li><li class="listitem">This code has<a id="id124" class="indexterm"/> three parts:<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Prepare report data</strong></span>: In the first <a id="id125" class="indexterm"/>three lines of code, we fill the dataset by the TableAdapter (<span class="strong"><strong>EmployeesTableAdapter</strong></span>).</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Pass data to our report</strong></span>: In the next two lines of code, we will pass the dataset to our report after we fill it with the data.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Display report in form</strong></span>: In the last three lines of code we pass our report to <span class="strong"><strong>crystalReportViewer1</strong></span> in <span class="strong"><strong>ReportForm</strong></span> and open this form to display our report.</li></ul></div></li><li class="listitem">Run our application (Press <span class="emphasis"><em>F5</em></span>) and click on the <span class="strong"><strong>btnEmpAll</strong></span> button (<span class="strong"><strong>All</strong></span>) to see our report, as shown in the following screenshot:<div class="mediaobject"><img src="graphics/4-22.jpg" alt="Adding the report to a form"/></div></li></ol></div></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec27"/>Summary</h1></div></div></div><p>In this chapter, we learned how to create a simple report and display this report in our application. We have seen how to connect the report to the database and how to display and format the data in the report. In the next chapter, we will create new reports to learn grouping and sorting data. We will also learn how to use parameters to filter the table data.</p></div></body></html>