<html><head></head><body>
<div><h1 class="chapterNumber">19</h1>
<h1 class="chapterTitle" id="_idParaDest-297">Where to Go from Here</h1>
<p class="normal">The book is coming to an end, and I want to leave you with some of the things we have encountered while running Blazor in production ever since it was in preview. We will also talk about where to go from here.</p>
<p class="normal">In this chapter, we will cover the following topics:</p>
<ul>
<li class="bulletList">Take-aways from running Blazor in production</li>
<li class="bulletList">The next steps</li>
</ul>
<h1 class="heading-1" id="_idParaDest-298">Take-aways from running Blazor in production</h1>
<p class="normal">Since Blazor was in<a id="_idIndexMarker674"/> preview, we have been running Blazor Server in production. In most cases, everything has run without issues. Occasionally, we have encountered a few problems, and I will share our take-aways from this with you in this section.</p>
<p class="normal">We will look at the following:</p>
<ul>
<li class="bulletList">Solving memory problems</li>
<li class="bulletList">Solving concurrency problems</li>
<li class="bulletList">Solving errors</li>
<li class="bulletList">Old browsers</li>
</ul>
<p class="normal">These are some of the things we ran into, and we have solved them all in a way that works for us.</p>
<h2 class="heading-2" id="_idParaDest-299">Solving memory problems</h2>
<p class="normal">Our latest upgrade added many <a id="_idIndexMarker675"/>users and, with that, a bigger load on the server. The <a id="_idIndexMarker676"/>server manages memory quite well, but with this release, the backend system was a bit slow, so users would press <em class="keystroke">F5</em> to reload a page. Then, the circuit would disconnect and a new circuit would be created. The old circuit would wait for the user to connect to the server again for 3 minutes (by default).</p>
<p class="normal">The user would then have a new circuit and would never connect to the old circuit again, but for three minutes, the user’s state would still take up memory. This is probably not a problem for most applications, but we are loading a lot of data into memory—the data, the render tree, and everything surrounding that will be kept in memory.</p>
<p class="normal">So, what can we learn from that? Blazor is a single-page application. Reloading the page is like restarting an app, which means we should always make sure to add the ability to update the data from within the page (if that makes sense for the application). We could also update the data as it changes, as we did in <em class="chapterRef">Chapter 11</em>, <em class="italic">Managing State – Part 2</em>.</p>
<p class="normal">In our case, we added more memory to the server and then made sure there were reload buttons in the UI that refresh the data without reloading the whole page. The ultimate goal is to add real-time updates that continuously update the UI when the data changes.</p>
<p class="normal">If adding more memory to the server isn’t an option, we can try to change the garbage collection from the server to the desktop. The .NET garbage collection has two modes:</p>
<ul>
<li class="bulletList"><strong class="keyWord">Workstation</strong> mode<a id="_idIndexMarker677"/> is optimized for running on a workstation that typically doesn’t have a lot of memory. It runs the garbage collection multiple times per second.</li>
<li class="bulletList"><strong class="keyWord">Server</strong> mode<a id="_idIndexMarker678"/> is optimized for servers where there is usually lots of memory and prioritizes speed, meaning it will only run the garbage collector every 2 seconds.</li>
</ul>
<p class="normal">The mode of the garbage collector can be set in the project file or the <code class="inlineCode">runtimeconfig.json</code> file by changing the <code class="inlineCode">ServerGarbageCollection</code> node:</p>
<pre class="programlisting code"><code class="hljs-code">&lt;PropertyGroup&gt;
&lt;ServerGarbageCollection&gt;true&lt;/ServerGarbageCollection&gt;
&lt;/PropertyGroup&gt;
</code></pre>
<p class="normal">Adding more memory is probably a better idea, though.</p>
<p class="normal">We have also noticed the importance of disposing of our database contexts. Make sure to use <code class="inlineCode">IDbContextFactory</code> to create an instance of the data context and, when we are done, dispose of it by using the <code class="inlineCode">Using</code> keyword.</p>
<p class="normal">Then the data<a id="_idIndexMarker679"/> context will only be available for a short time and then disposed of, freeing up memory fast.</p>
<h2 class="heading-2" id="_idParaDest-300">Solving concurrency problems</h2>
<p class="normal">We have often run into <a id="_idIndexMarker680"/>problems where the data context was already in <a id="_idIndexMarker681"/>use and couldn’t access the database from two different threads.</p>
<p class="normal">This is solved by using <code class="inlineCode">IDbContextFactory</code> and disposing of the data context when we are finished using it.</p>
<p class="normal">In a non-Blazor site, having multiple components to load at the same time is never a problem (because the web does one thing at a time), so the fact that Blazor can do multiple things at the same time is something we need to think about when we design our architecture.</p>
<h2 class="heading-2" id="_idParaDest-301">Solving errors</h2>
<p class="normal">Blazor usually gives us an error<a id="_idIndexMarker682"/> that is<a id="_idIndexMarker683"/> easy to understand, but in some rare cases, we do run into problems that are hard to figure out. We can add detailed errors to our circuit (for Blazor Server) by adding the following option in <code class="inlineCode">Startup.cs</code>:</p>
<pre class="programlisting code"><code class="hljs-code">services.AddServerSideBlazor().AddCircuitOptions(options =&gt; { options.DetailedErrors = true; });
</code></pre>
<p class="normal">By doing so, we will get more detailed errors. I don’t recommend using detailed errors in a production scenario, however. With that said, we have the setting turned on for an internal app in production because the internal users are briefed on it and understand how to handle it. It makes it easier for us to help our users, and the error message is only visible in the developer tools of the web browser and not in the interface of the user.</p>
<h2 class="heading-2" id="_idParaDest-302">Old browsers</h2>
<p class="normal">Some of our customers were running old browsers<a id="_idIndexMarker684"/> on old systems, and even though Blazor supports all major browsers, that support doesn’t include really old browsers. We ended up helping those customers upgrade to Edge or Chrome simply because we didn’t think they should be browsing the web using browsers that no longer receive security patches.</p>
<p class="normal">Even our TV at home can run Blazor WebAssembly, so old browsers are probably not a big problem, but it can be worth thinking about when it comes to browser support. What browsers do we need/want to support?</p>
<h1 class="heading-1" id="_idParaDest-303">The next steps</h1>
<p class="normal">At this point, we know the difference between Blazor Server and Blazor WebAssembly, and we know when to choose what, and picking one of them is not really that important. We know how to create reusable components, make APIs, manage state, and much more. But where do we go from here? What are the next steps?</p>
<h2 class="heading-2" id="_idParaDest-304">The community</h2>
<p class="normal">The Blazor community is not as big as<a id="_idIndexMarker685"/> other frameworks but is growing fast. Many people share content with the community through blogs or videos. YouTube and PluralSight have a lot of tutorials and courses. Twitch has a growing amount of Blazor content, but it is not always easy to find in the vast content catalog.</p>
<p class="normal">There are a number of resources worth mentioning:</p>
<ul>
<li class="bulletList"><strong class="keyWord">Jimmy Engström</strong> – I wouldn’t be much of a Blazor enthusiast if I didn’t make it into my own list. I talk about Blazor and throw in a pun here and there. When we stream, we do that using CodingAfterWork (see below). My blog has a lot of Blazor content and more to come: <a href="https://engstromjimmy.com/">https://engstromjimmy.com/</a>. X: <code class="inlineCode">@EngstromJimmy</code>.</li>
<li class="bulletList">The <strong class="keyWord">Blazm</strong> component library that we have written can be found here: <a href="http://blazm.net/">http://blazm.net/</a>. There are many better grid components out there, but this shows how easy and yet complex a grid component can be.</li>
<li class="bulletList"><strong class="keyWord">Coding after Work</strong> has many<a id="_idIndexMarker686"/> episodes of our podcast and our stream covering Blazor; please follow us on social media: <a href="http://codingafterwork.com/FindUs">http://codingafterwork.com/FindUs</a>.</li>
<li class="bulletList"><strong class="keyWord">Daniel Roth</strong> is the PM for Blazor. Amazing to listen to, he has been a guest on our podcast. Search for him on YouTube. X: <code class="inlineCode">@danroth27</code>.</li>
<li class="bulletList"><strong class="keyWord">Steve Sanderson</strong> is the guy who invented Blazor; he is definitely worth a follow. He continues to do groundbreaking things in his talks; search for him on YouTube. Make sure to see his NDC Oslo talk where he shows Blazor for the first time. X: <code class="inlineCode">@stevensanderson</code>.</li>
<li class="bulletList"><strong class="keyWord">Awesome-Blazor</strong> has a huge list of Blazor-related links and resources that can be found here: <a href="https://github.com/AdrienTorris/awesome-blazor">https://github.com/AdrienTorris/awesome-blazor</a>.</li>
<li class="bulletList"><strong class="keyWord">Jeff Fritz</strong> shares Blazor knowledge (among other things) on Twitch: <a href="https://www.twitch.tv/csharpfritz">https://www.twitch.tv/csharpfritz</a>. X: <code class="inlineCode">@csharpfritz</code>.</li>
<li class="bulletList"><strong class="keyWord">Chris Sainty</strong> is a fellow author and has made many really amazing packages for Blazor. He has lots of content on his blog: <a href="https://chrissainty.com/">https://chrissainty.com/</a>. X: <code class="inlineCode">@chris_sainty</code>.</li>
<li class="bulletList"><strong class="keyWord">Carl Franklin</strong> has done a lot of Blazor videos on <a href="https://BlazorTrain.com/">https://BlazorTrain.com/</a>. X: <code class="inlineCode">@carlfranklin</code>.</li>
<li class="bulletList"><strong class="keyWord">John Hilton</strong> has a lot of Blazor content. You can find him here: <a href="https://jonhilton.net/">https://jonhilton.net/</a>. X: <code class="inlineCode">@jonhilt</code>.</li>
<li class="bulletList"><strong class="keyWord">Patrick God</strong> has a lot of great content on his YouTube channel: <a href="mailto:https://www.youtube.com/@PatrickGod">https://www.youtube.com/@PatrickGod</a>. X: <code class="inlineCode">@_PatrickGod</code>.</li>
<li class="bulletList"><strong class="keyWord">David Pine</strong> is a fellow author and the creator of Blazorators and can be found here: <a href="https://github.com/IEvangelist/blazorators">https://github.com/IEvangelist/blazorators</a>. X: <code class="inlineCode">@davidpine7</code>.</li>
<li class="bulletList"><strong class="keyWord">Peter Morris</strong> is the creator of Fluxor and is a great person to follow. X: <code class="inlineCode">@MrPeterLMorris</code></li>
<li class="bulletList"><strong class="keyWord">Michael Washington</strong> is a fellow author, and we can find him here: <a href="https://adefwebserver.com/">https://adefwebserver.com/</a>. X: <code class="inlineCode">@ADefWebserver</code>.</li>
<li class="bulletList"><strong class="keyWord">Ed Charbeneau</strong> always has great content. Make sure to follow him. <a href="https://edcharbeneau.com/">https://edcharbeneau.com/</a> <a href="https://www.twitch.tv/edcharbeneau">https://www.twitch.tv/edcharbeneau</a>, <a href="https://www.youtube.com/edwardcharbeneau">https://www.youtube.com/edwardcharbeneau</a>, <a href="https://www.twitch.tv/codeitlive">https://www.twitch.tv/codeitlive</a>, <a href="mailto:https://www.youtube.com/@telerik">https://www.youtube.com/@telerik</a>. X: <code class="inlineCode">@EdCharbeneau</code>.</li>
<li class="bulletList"><strong class="keyWord">Eric Johansson</strong> is a regular on Twitch, showing his projects and modernizing his .NET Framework apps to a more modern platform <a href="https://www.twitch.tv/thindal">https://www.twitch.tv/thindal</a> X: <code class="inlineCode">@EricJohansson</code>.</li>
<li class="bulletList"><strong class="keyWord">Egil Hansen</strong> is the <a id="_idIndexMarker687"/>creator of bUnit. We can find him here: <a href="https://egilhansen.com/about/">https://egilhansen.com/about/</a>. X: <code class="inlineCode">@egilhansen</code>.</li>
<li class="bulletList"><strong class="keyWord">Sam Basu</strong> is a great person to follow when it comes to .NET MAUI content. <a href="https://www.twitch.tv/codeitlive">https://www.twitch.tv/codeitlive</a> and <a href="mailto:https://www.youtube.com/@telerik">https://www.youtube.com/@telerik</a>. X: <code class="inlineCode">@samidip</code>.</li>
<li class="bulletList"><strong class="keyWord">Junichi Sakamoto</strong> has made loads of fantastic Blazor libraries, everything from connecting to gamepads to translation and pre-rendering. You can find his projects here: <a href="https://github.com/jsakamoto">https://github.com/jsakamoto</a>. X: <code class="inlineCode">@jsakamoto</code>.</li>
<li class="bulletList"><strong class="keyWord">Blazor University</strong> has a lot of training material and is a great resource to learn more: <a href="https://blazor-university.com/">https://blazor-university.com/</a>.</li>
<li class="bulletList"><strong class="keyWord">Gerald Versluis</strong> has plenty of content on his YouTube channel related to all kinds of .NET things: <a href="https://youtube.com/GeraldVersluis">https://youtube.com/GeraldVersluis</a>. X: <code class="inlineCode">@jfversluis</code>.</li>
<li class="bulletList"><strong class="keyWord">Maddy Montaquilla</strong> is amazing to watch; search for her on YouTube to watch her videos. X: <code class="inlineCode">@maddymontaquila</code>.</li>
<li class="bulletList"><strong class="keyWord">James Montemagno</strong> has a great YouTube channel with loads of .NET MAUI content: <a href="https://www.youtube.com/JamesMontemagno">https://www.youtube.com/JamesMontemagno</a>. X: <code class="inlineCode">@JamesMontemagno</code>.</li>
<li class="bulletList"><strong class="keyWord">Daniel Hindrikes</strong> has some great .NET MAUI content on this <a id="_idIndexMarker688"/>YouTube channel: <a href="mailto:https://www.youtube.com/@DanielHindrikes">https://www.youtube.com/@DanielHindrikes</a>. X: <code class="inlineCode">@hindrikes</code>.</li>
</ul>
<h2 class="heading-2" id="_idParaDest-305">The components</h2>
<p class="normal">Most third-party <a id="_idIndexMarker689"/>component vendors, such as Progress Telerik, DevExpress, Syncfusion, Radzen, ComponentOne, and many more, have invested in Blazor. Some cost money and some are free. There are also a lot of open-source component libraries that we can use.</p>
<p class="normal">This question comes up a lot: <em class="italic">I am new to Blazor. What third-party vendor should I use?</em> My recommendation is to try to figure out what you need before investing in a library (either in terms of money or time).</p>
<p class="normal">Many vendors can do all the things we need, but in some cases, it will take a bit more effort to make an app work. We started to work on a grid component ourselves, and after a while, we decided to make it open-source.</p>
<p class="normal">This is how Blazm was born. We had a few special requirements (nothing fancy), but they required us to write a lot of code over and over again to make it work in a third-party vendor component.</p>
<p class="normal">We learned so much from writing our component, which is really easy to do. My recommendation is not always to write your own components. It is much better to focus on the actual business problem you are trying to solve.</p>
<p class="normal">For us, building a pretty advanced grid component taught us so much about the inner workings of Blazor.</p>
<p class="normal">Think about what you need and try out the different vendors to see what works best for you. Perhaps it would be better to build the component yourself, at least in the beginning, to learn more about Blazor.</p>
<p class="normal">But always look at your code. If you repeat the same code, wrap it in a component. Always think: <em class="italic">Could this be a reusable component?</em></p>
<p class="normal">We currently use a <a id="_idIndexMarker690"/>component vendor, but we wrap all the components in one of our components. This way, it is easy to set defaults and add logic that is right for us, just as we have learned throughout the book.</p>
<h1 class="heading-1" id="_idParaDest-306">Summary</h1>
<p class="normal">In this chapter, we examined some of the challenges we have encountered while running Blazor in production and discussed where to go from here.</p>
<p class="normal">Throughout the book, we have learned how Blazor works and how to create basic and advanced components. We implemented security with both authentication and authorization. We created and consumed an API connected to a “database.”</p>
<p class="normal">We made JavaScript calls and real-time updates. We debugged our application and tested our code, and last but not least, we looked at deploying to production.</p>
<p class="normal">We are now ready to apply all this knowledge to the next adventure, another app. I hope you have had as much fun reading this book as I have had writing it. Being part of the Blazor community is so much fun, and we learn new things every day.</p>
<p class="normal">Thank you for reading this book. Please stay in touch. I would love to learn about the things you build!</p>
<p class="normal"><em class="italic">Welcome to the Blazor community!</em></p>
<h1 class="heading-1" id="_idParaDest-307">Join our community on Discord </h1>
<p class="normal">Join our community’s Discord space for discussions with the author and other readers: </p>
<p class="normal"><a href="https://packt.link/WebDevBlazor3e">https://packt.link/WebDevBlazor3e</a></p>
<p class="normal"><img alt="" role="presentation" src="img/QR_Code2668029180838459906.png"/></p>
</div>
</body></html>