<html><head></head><body>
<div><div><div><div><div><h1 class="title" id="calibre_pb_0"><a id="ch06" class="calibre1"/>Chapter 6. Animation and Unity3D Physics</h1></div></div></div><p class="calibre8">In this chapter, you will learn to use Physics in animation creation. We will see that there are several animations that can be easily handled by Unity3D's Physics. During development, you will come to know that working with animations and Physics is easy in Unity3D. You will find the combination of Physics and animation very interesting.</p><p class="calibre8">We are going to cover the following topics:</p><div><ul class="itemizedlist"><li class="listitem">Interpolate and Extrapolate</li><li class="listitem">The Cloth component and its uses in animation</li><li class="listitem">ConstantForce</li><li class="listitem">AddForce</li><li class="listitem">AddTorque</li><li class="listitem">An example of creating a rope animation using different joints</li></ul></div></div>

<div><div><div><div><div><h1 class="title" id="calibre_pb_1"><a id="ch06lvl1sec26" class="calibre1"/>Developing simple and complex animations</h1></div></div></div><p class="calibre8">As <a id="id249" class="calibre1"/>mentioned earlier, you will learn how to handle <a id="id250" class="calibre1"/>and create simple and complex animations using Physics, for example, creating a rope animation and hanging ball. Let's start with the Physics properties of a Rigidbody component, which help in syncing animation.</p></div></div>

<div><div><div><div><div><div><h2 class="title1" id="calibre_pb_2"><a id="ch06lvl2sec25" class="calibre1"/>Interpolate and Extrapolate</h2></div></div></div><p class="calibre8">Unity3D <a id="id251" class="calibre1"/>offers a way that its Rigidbody <a id="id252" class="calibre1"/>component can help in the syncing <a id="id253" class="calibre1"/>of animation. Using the interpolation <a id="id254" class="calibre1"/>and extrapolation properties, we sync animations.</p><div><h3 class="title2"><a id="note22" class="calibre1"/>Note</h3><p class="calibre8">Interpolation is not only for animation, it also works with Rigidbody.</p></div><p class="calibre8">Let's see in detail how interpolation and extrapolation work:</p><div><ol class="orderedlist"><li class="listitem" value="1">Create a new scene and save it.</li><li class="listitem" value="2">Create a <strong class="calibre9">Cube</strong> game object and apply <strong class="calibre9">Rigidbody</strong> on it.</li><li class="listitem" value="3">Look <a id="id255" class="calibre1"/>at the <strong class="calibre9">Inspector</strong> panel <a id="id256" class="calibre1"/>shown in the following<a id="id257" class="calibre1"/> screenshot. On <a id="id258" class="calibre1"/>clicking <strong class="calibre9">Interpolate</strong>, a drop-down list that contains three options will appear, which are <strong class="calibre9">None</strong>, <strong class="calibre9">Interpolate</strong>, and <strong class="calibre9">Extrapolate</strong>. For details, refer to the previous chapter. By selecting any one of them, we can apply the feature.<div><img src="img/00080.jpeg" alt="Interpolate and Extrapolate" class="calibre11"/></div><p class="calibre14"> </p></li></ol><div></div><p class="calibre8">In interpolation, the position of an object is calculated by the current update time, moving it backwards one Physics update delta time.</p><div><h3 class="title2"><a id="note23" class="calibre1"/>Note</h3><p class="calibre8">
<strong class="calibre9">Delta time</strong> or <strong class="calibre9">delta timing</strong> is a concept used among programmers in relation to <a id="id259" class="calibre1"/>frame<a id="id260" class="calibre1"/> rate and time. For more details, check out <a class="calibre1" href="http://docs.unity3d.com/ScriptReference/Time-deltaTime.html">http://docs.unity3d.com/ScriptReference/Time-deltaTime.html</a>.</p></div><p class="calibre8">If you look closely, you will observe that there are at least two Physics updates, which are as follows:</p><div><ul class="itemizedlist"><li class="listitem">Ahead of the chosen time</li><li class="listitem">Behind the chosen time</li></ul></div><p class="calibre8">Unity interpolates between these two updates to get a position for the update position. So, we can say that the interpolation is actually lagging behind one Physics update.</p><p class="calibre8">The <a id="id261" class="calibre1"/>second option is <strong class="calibre9">Extrapolate</strong>, which<a id="id262" class="calibre1"/> is to use for extrapolation. In this <a id="id263" class="calibre1"/>case, Unity predicts the future position for<a id="id264" class="calibre1"/> the object. Although this does not show any lag, incorrect prediction sometime causes a visual jitter.</p><p class="calibre8">One more<a id="id265" class="calibre1"/> important component that is widely used to animate cloth is the <strong class="calibre9">Cloth component</strong>. Here, you will learn about its properties and how to use it.</p></div></div></div>

<div><div><div><div><div><div><h2 class="title1" id="calibre_pb_3"><a id="ch06lvl2sec26" class="calibre1"/>The Cloth component</h2></div></div></div><p class="calibre8">To make <a id="id266" class="calibre1"/>animation easy, Unity provides an interactive <a id="id267" class="calibre1"/>component called <strong class="calibre9">Cloth</strong>. In the <strong class="calibre9">GameObject</strong> menu, you can directly create the <strong class="calibre9">Cloth</strong> game object. Have a look at the following screenshot:</p><div><img src="img/00081.jpeg" alt="The Cloth component" class="calibre11"/></div><p class="calibre12"> </p><p class="calibre8">Unity<a id="id268" class="calibre1"/> also provides Cloth components in its Physics sections. To <a id="id269" class="calibre1"/>apply this, let's look at an example:</p><div><ol class="orderedlist"><li class="listitem" value="1">Create a new scene and save it.</li><li class="listitem" value="2">Create a <strong class="calibre9">Plane</strong> game object. (We can also create a <strong class="calibre9">Cloth</strong> game object.)</li><li class="listitem" value="3">Navigate to <strong class="calibre9">Component</strong> | <strong class="calibre9">Physics</strong> and choose <strong class="calibre9">InteractiveCloth</strong>.<p class="calibre16">As shown in the following screenshot, you will see the following properties in the <strong class="calibre9">Inspector</strong> panel:</p><div><img src="img/00082.jpeg" alt="The Cloth component" class="calibre11"/></div><p class="calibre14"> </p></li></ol><div></div><p class="calibre8">Let's have<a id="id270" class="calibre1"/> a look at the properties one by one. <strong class="calibre9">Blending Stiffness</strong> and <strong class="calibre9">Stretching Stiffness</strong> define the blending and stretching stiffness of the Cloth<a id="id271" class="calibre1"/> while <strong class="calibre9">Damping</strong> defines the damp motion of the Cloth. Using the <strong class="calibre9">Thickness</strong> property, we decide the thickness of the Cloth, which ranges from 0.001 to 10,000. If we enable the <strong class="calibre9">Use Gravity</strong> property, it will affect the Cloth simulation. Similarly, if we enable <strong class="calibre9">Self Collision</strong>, it allows the Cloth to collide with itself. For a constant or random acceleration, we apply the <strong class="calibre9">External Acceleration</strong> and <strong class="calibre9">Random Acceleration</strong> properties, respectively.</p><p class="calibre8">
<strong class="calibre9">World Velocity Scale</strong> decides the movement of the character in the world, which will affect the Cloth vertices. The higher the value, the more movement of the character will affect. <strong class="calibre9">World Acceleration</strong> works similarly. The <strong class="calibre9">Interactive Cloth</strong> component depends on the <strong class="calibre9">Cloth Renderer</strong> components. Lots of Cloth components in a game reduces the performance of game. To simulate clothing in characters, we use the <strong class="calibre9">Skinned Cloth</strong> component.</p><div><div><div><div><h3 class="title2"><a id="ch06lvl3sec26" class="calibre1"/>Important points while using the Cloth component</h3></div></div></div><p class="calibre8">The following <a id="id272" class="calibre1"/>are the important points to remember while using the Cloth component:</p><div><ul class="itemizedlist"><li class="listitem">Cloth simulation will not generate tangents. So, if you are using a tangent dependent shader, the lighting will look wrong for a Cloth component that has been moved from its initial position.</li><li class="listitem">We cannot directly change the transform of moving the Cloth game object. This is not supported.</li><li class="listitem">Disabling the Cloth before changing the transform is supported.</li><li class="listitem">The <strong class="calibre9">SkinnedCloth</strong> component works together with <strong class="calibre9">SkinnedMeshRenderer</strong> to simulate clothing on a character. As shown in the following screenshot, we can apply <strong class="calibre9">Skinned Cloth</strong>:<div><img src="img/00083.jpeg" alt="Important points while using the Cloth component" class="calibre11"/></div><p class="calibre14"> </p></li></ul></div><p class="calibre8">As you can <a id="id273" class="calibre1"/>see in the following screenshot, there are different properties that we can use to get the desired effect:</p><div><img src="img/00084.jpeg" alt="Important points while using the Cloth component" class="calibre11"/></div><p class="calibre12"> </p><p class="calibre8">We can <a id="id274" class="calibre1"/>disable or enable the<strong class="calibre9"> Skinned Cloth</strong> component at any time to turn it on or off.</p></div></div></div></div>

<div><div><div><div><div><div><h2 class="title1" id="calibre_pb_4"><a id="ch06lvl2sec27" class="calibre1"/>ConstantForce</h2></div></div></div><p class="calibre8">When a <a id="id275" class="calibre1"/>force is applied constantly on a game object, it is known as<a id="id276" class="calibre1"/> constant force. We use the <code class="email">ConstantForce</code> Physics utility class to apply constant force on a game object. <code class="email">AddForce</code> applies a force to the Rigidbody only for one frame whereas <code class="email">ConstantForce</code> applies a force in every frame until we change the force or torque to a new value.</p><p class="calibre8">We use this for one-shot objects such as rockets.</p><div><div><div><div><h3 class="title2"><a id="ch06lvl3sec27" class="calibre1"/>An example of animation using ConstantForce</h3></div></div></div><p class="calibre8">We <a id="id277" class="calibre1"/>will look at the example of animation <a id="id278" class="calibre1"/>using ConstantForce with the help of the following steps:</p><div><ol class="orderedlist"><li class="listitem" value="1">Create a new scene and save it as <code class="email">Constant Force Example</code>.</li><li class="listitem" value="2">Create a <strong class="calibre9">Cube</strong> game object.</li><li class="listitem" value="3">As shown in the following screenshot, apply <strong class="calibre9">Constant Force</strong> on it:<div><img src="img/00085.jpeg" alt="An example of animation using ConstantForce" class="calibre11"/></div><p class="calibre14"> </p></li><li class="listitem" value="4">To make a cube that accelerates forward, we set <strong class="calibre9">Relative Force</strong> to be along the positive <em class="calibre10">z</em> axis.</li><li class="listitem" value="5">Then, use the Rigidbody's <strong class="calibre9">Drag</strong> property to set the maximum velocity and turn off gravity so that the game object will always stay on its path.<div><img src="img/00086.jpeg" alt="An example of animation using ConstantForce" class="calibre11"/></div><p class="calibre14"> </p></li><li class="listitem" value="6">Run the scene and you will see that the cube game object moves constantly.</li></ol><div></div><p class="calibre8">Till <a id="id279" class="calibre1"/>now, you have learned different Physics <a id="id280" class="calibre1"/>components. Now, you'll learn how we can use Physics in scripting. In this chapter, we will learn <code class="email">AddForce</code> and <code class="email">AddTorque</code>. By applying <code class="email">AddForce</code> on a Rigidbody, we make it move while <code class="email">AddTorque</code> adds a torque to the Rigidbody to make it spin around the torque axis.</p></div><div><div><div><div><h3 class="title2"><a id="ch06lvl3sec28" class="calibre1"/>An example of animation using AddForce</h3></div></div></div><p class="calibre8">
<code class="email">AddForce</code> adds <a id="id281" class="calibre1"/>force to the Rigidbody.</p><div><h3 class="title2"><a id="note24" class="calibre1"/>Note</h3><p class="calibre8">In <a id="id282" class="calibre1"/>Physics, a <strong class="calibre9">force</strong> is any interaction<a id="id283" class="calibre1"/> that tends to change the motion of an object. In other words, a force can cause an object with mass to change its velocity (which includes beginning moving from a state of rest), that is, to accelerate. Force can also be described by intuitive concepts such as a push or a pull.</p></div><p class="calibre8">In this example, we will create a projectile using <code class="email">AddForce</code> Physics:</p><div><ol class="orderedlist"><li class="listitem" value="1">Create a new scene and save it as <code class="email">addForce example</code>.</li><li class="listitem" value="2">Use a <strong class="calibre9">Plane</strong> game object to create ground.</li><li class="listitem" value="3">Apply a green material on it.</li><li class="listitem" value="4">Create a <strong class="calibre9">Capsule</strong> object and apply <strong class="calibre9">Rigidbody</strong> on it as shown in the following screenshot. Now, name it <code class="email">bullet</code>.<div><img src="img/00087.jpeg" alt="An example of animation using AddForce" class="calibre11"/></div><p class="calibre14"> </p></li><li class="listitem" value="5">Create <a id="id284" class="calibre1"/>a new JavaScript or UnityScript <a id="id285" class="calibre1"/>and name it <code class="email">projectile</code>. Write the following code inside it:<div><pre class="programlisting">var speed:int=10000;
var bulletObject: GameObject;
private var hitPoint:Vector3;
private var hit : RaycastHit;
function Update ()
{
  var ray = Camera.main.ScreenPointToRay (Input.mousePosition);
  if (Input.GetMouseButtonDown (0))
  {
    if (Physics.Raycast (ray, hit, 300.0f))
    {
      if (hit.collider.tag == "ground")
      {
// Add "ground " tag to the plane game object.
        var bullet = Instantiate(bulletObject, Vector3(0,1.5,-12), transform.rotation);
        bullet.rigidbody.AddForce( Vector3(0,0.5,0.5) * speed);
      }
    }
  }
}</pre></div></li><li class="listitem" value="6">As shown in the following screenshot, you will need to specify <strong class="calibre9">Bullet Object</strong>:<div><img src="img/00088.jpeg" alt="An example of animation using AddForce" class="calibre11"/></div><p class="calibre14"> </p></li><li class="listitem" value="7">Drag<a id="id286" class="calibre1"/> the <strong class="calibre9">bullet</strong> game object and <a id="id287" class="calibre1"/>put it on the <strong class="calibre9">Bullet Object</strong> section as shown in the following screenshot:<div><img src="img/00089.jpeg" alt="An example of animation using AddForce" class="calibre11"/></div><p class="calibre14"> </p></li><li class="listitem" value="8">Now, test the scene and you will see that on a click, the bullet is fired and it is moved in a projectile.</li></ol><div></div><p class="calibre8">In this example, we saw how to use <code class="email">AddForce</code> to create a projectile animation. Similarly, in the next example, we will see how to use <code class="email">AddTorque</code> to create an animation.</p></div><div><div><div><div><h3 class="title2"><a id="ch06lvl3sec29" class="calibre1"/>An example of animation using AddTorque</h3></div></div></div><p class="calibre8">
<code class="email">AddTorque</code> <a id="id288" class="calibre1"/>adds<a id="id289" class="calibre1"/> torque to the Rigidbody.</p><div><h3 class="title2"><a id="note25" class="calibre1"/>Note</h3><p class="calibre8">Torque is a measure of the turning force on an object such as a bolt or a flywheel. For example, pushing or pulling the handle of a wrench connected to a nut or bolt produces a torque (turning force) that loosens or tightens the nut or bolt.</p></div><p class="calibre8">In this <a id="id290" class="calibre1"/>example, we will use <code class="email">AddTorque</code> to create an <a id="id291" class="calibre1"/>animation:</p><div><ol class="orderedlist"><li class="listitem" value="1">Create a new scene and save it as <code class="email">AddTorque example</code>.</li><li class="listitem" value="2">Create a <strong class="calibre9">Cube</strong> game object and name it <code class="email">box</code>.</li><li class="listitem" value="3">Add <strong class="calibre9">Rigidbody</strong> on a <strong class="calibre9">Box</strong> game object.</li><li class="listitem" value="4">Create a new JavaScript and use the following code:<div><pre class="programlisting">// Spins the rigidbody around the global y-axis
  var box:GameObject;
  var speed:int=10;
  function FixedUpdate () {
    box.rigidbody.AddTorque (Vector3.up * speed);
  }</pre></div></li><li class="listitem" value="5">Add the script file to <strong class="calibre9">Main Camera</strong> and drag the game object box to the box variable.</li><li class="listitem" value="6">Run the scene and you will see the spin movement of the box.</li></ol><div></div><p class="calibre8">In another example, we will create an animation using different joints. In the previous chapter, you learned different joints, including the character joint, which is used for a Ragdoll effect. Now, we will create a rope animation using <strong class="calibre9">Fixed Joint</strong> and <strong class="calibre9">Hinge Joint</strong>.</p></div><div><div><div><div><h3 class="title2"><a id="ch06lvl3sec30" class="calibre1"/>An example of rope animation using different joints</h3></div></div></div><p class="calibre8">In the <a id="id292" class="calibre1"/>following example, we will create a<a id="id293" class="calibre1"/> rope using different joints. Joints help to create flexible animation, and this is why we are going to use joints for the rope animation.</p><div><ol class="orderedlist"><li class="listitem" value="1">Create a new scene and save it as <code class="email">Rope Animation example</code>.</li><li class="listitem" value="2">Create a <strong class="calibre9">Sphere</strong> game object and apply a material to make it colorful.</li><li class="listitem" value="3">Now, apply <strong class="calibre9">Rigidbody</strong> and <strong class="calibre9">Fixed Joint</strong> on it as shown in the following screenshot:<div><img src="img/00090.jpeg" alt="An example of rope animation using different joints" class="calibre11"/></div><p class="calibre14"> </p></li><li class="listitem" value="4">Create<a id="id294" class="calibre1"/> a <strong class="calibre9">Cylinder</strong> game object <a id="id295" class="calibre1"/>and name it <code class="email">Chain 1</code>.</li><li class="listitem" value="5">Now, apply <strong class="calibre9">Rigidbody</strong> and <strong class="calibre9">Hinge Joint</strong> on it. As shown in the following screenshot, you will see the <strong class="calibre9">Connected Body</strong> property:<div><img src="img/00091.jpeg" alt="An example of rope animation using different joints" class="calibre11"/></div><p class="calibre14"> </p></li><li class="listitem" value="6">In the <strong class="calibre9">Connected Body</strong> property of the <strong class="calibre9">Sphere</strong> game object, drag the <strong class="calibre9">Chain 1</strong> game object.<div><img src="img/00092.jpeg" alt="An example of rope animation using different joints" class="calibre11"/></div><p class="calibre14"> </p></li><li class="listitem" value="7">Now, run<a id="id296" class="calibre1"/> the scene; you will <a id="id297" class="calibre1"/>see that the sphere falls along with the <strong class="calibre9">Cylinder</strong> game object as shown in the following screenshot:<div><img src="img/00093.jpeg" alt="An example of rope animation using different joints" class="calibre11"/></div><p class="calibre14"> </p></li><li class="listitem" value="8">As shown in the following screenshot, now create the <code class="email">Chain 2</code> game object and apply <strong class="calibre9">Rigidbody</strong> and <strong class="calibre9">Hinge Joint</strong>. Specify its position above the <strong class="calibre9">Chain 1</strong> and drag <strong class="calibre9">Chain 2</strong> as connected body for <strong class="calibre9">Chain 1</strong>.<div><img src="img/00094.jpeg" alt="An example of rope animation using different joints" class="calibre11"/></div><p class="calibre14"> </p></li><li class="listitem" value="9">Similarly, create <a id="id298" class="calibre1"/><strong class="calibre9">Chain 3</strong> and<a id="id299" class="calibre1"/> <strong class="calibre9">Chain 4</strong>. Now, rotate all the game objects as shown in the following screenshot:<div><img src="img/00095.jpeg" alt="An example of rope animation using different joints" class="calibre11"/></div><p class="calibre14"> </p></li><li class="listitem" value="10">Test <a id="id300" class="calibre1"/>this application; you will <a id="id301" class="calibre1"/>see a sphere hanging from a rope:<div><img src="img/00096.jpeg" alt="An example of rope animation using different joints" class="calibre11"/></div><p class="calibre14"> </p></li></ol><div></div><p class="calibre8">In the preceding steps, you learned how to create an animation using different joints.</p></div></div></div></div>
<div><div><div><div><h1 class="title" id="calibre_pb_0"><a id="ch06lvl1sec27" class="calibre1"/>Summary</h1></div></div></div><p class="calibre8">In this chapter, you learned about the different Physics components of Unity, using which we can create different types of animation. You learned how to use the Cloth component and <code class="email">AddForce</code> to create the projectile animation of a bullet. You learned how to create the wrecking animation of ball using different joints. In the next chapter, you will learn how to create a smooth game play using different Physics components and how we can handle the game play performance.</p></div></body></html>