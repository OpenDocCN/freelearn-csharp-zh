<html><head></head><body>
		<div><h1 id="_idParaDest-267" class="chapter-number"><a id="_idTextAnchor582"/>14</h1>
			<h1 id="_idParaDest-268"><a id="_idTextAnchor583"/>Packaging and Deploying WinUI Applications</h1>
			<p>WinUI developers have several options to package and deploy their applications. Developers can create an account on <strong class="bold">Microsoft Store</strong> and upload a packaged app to be released for public consumption through <strong class="bold">Microsoft Partner Center</strong>. App packages can also be created to be distributed by organizations through <strong class="bold">Microsoft Endpoint Manager</strong> and <strong class="bold">Microsoft Intune</strong>, or sideloaded by individuals on Windows PCs.</p>
			<p>In this chapter, we will cover the following topics:</p>
			<ul>
				<li>Discovering application packaging and <strong class="bold">MSIX</strong> basics</li>
				<li>Getting started with application packaging in Visual Studio</li>
				<li>Deploying applications with <strong class="bold">Windows </strong><strong class="bold">Package Manager</strong></li>
				<li>Distributing applications with the Microsoft Store</li>
				<li>Sideloading WinUI applications with MSIX</li>
			</ul>
			<p>By the end of this chapter, you will understand the methods available to package and distribute your WinUI applications and how to use each of them.</p>
			<h1 id="_idParaDest-269"><a id="_idTextAnchor584"/>Technical requirements</h1>
			<p>To follow along with the examples in this chapter, the following software is required:</p>
			<ul>
				<li>Windows 10 version 1809 (build 17763) or newer, or Windows 11</li>
				<li>Visual Studio 2022 or later, with the <strong class="bold">.NET Desktop Development</strong> workload configured for Windows App SDK development</li>
			</ul>
			<p>The source code for this chapter is available on GitHub at this URL: <a href="https://github.com/PacktPublishing/Learn-WinUI-3-Second-Edition/tree/master/Chapter14">https://github.com/PacktPublishing/Learn-WinUI-3-Second-Edition/tree/master/Chapter14</a>.</p>
			<h1 id="_idParaDest-270"><a id="_idTextAnchor585"/>Discovering application packaging and MSIX basics</h1>
			<p>For most of <a id="_idTextAnchor586"/>this book, we have built and run our <a id="_idTextAnchor587"/>WinUI 3 applications locally. Now, it’s time to learn the concepts of packaging and deploying WinUI applications and put that knowledge to use.</p>
			<p>Why package<a id="_idIndexMarker998"/> your application? Well, an application package is the easiest way for WinUI applications and their dependencies to be installed in Windows. Today, when you run a WinUI project in Visual<a id="_idTextAnchor588"/> Studio, the <strong class="bold">integrated development environment</strong> (<strong class="bold">IDE</strong>) creates<a id="_idIndexMarker999"/> a package and deploys it locally. Packaging serves several other importan<a id="_idTextAnchor589"/>t purposes, outlined <a id="_idIndexMarker1000"/>as follows:</p>
			<ul>
				<li><strong class="bold">Providing a clean uninstall</strong>: A packaging system ensures that any files installed or updated with an application are removed or restored to their previous state when the application is uninstalled</li>
				<li><strong class="bold">Bundling dependencies</strong>: The application package will bundle and deliver all your application’s dependencies, optimizing disk space by sharing files across installed applications when possible</li>
				<li><strong class="bold">Facilitating updates</strong>: Differential updates are optimized to only deliver files that require updating, based on the manifest of the original package and the updated one</li>
				<li><strong class="bold">Declaring capabilities</strong>: By declaring your application’s capabilities in the manifest, users know what types of access your app requires before they choose to install it</li>
				<li><strong class="bold">Verifying integrity and authenticity</strong>: In order to install a Windows application on someone else’s device, the applicati<a id="_idTextAnchor590"/>on package must be digitally signed with a valid certificate<a id="_idIndexMarker1001"/> from a <strong class="bold">trusted </strong><strong class="bold">signing authority</strong></li>
			</ul>
			<p>If you are going to distribute your WinUI applications, the packaging format you will use is <strong class="bold">MSIX</strong>. What is MSIX? Let’s find o<a id="_idTextAnchor591"/><a id="_idTextAnchor592"/>ut.</p>
			<h2 id="_idParaDest-271"><a id="_idTextAnchor593"/>MSIX</h2>
			<p>MSIX<a id="_idTextAnchor594"/> is the <a id="_idIndexMarker1002"/>latest standard introduced by Microsoft to package applications. It is<a id="_idTextAnchor595"/> not only for Windows. The <strong class="bold">MSIX SDK</strong> (<a href="https://learn.microsoft.com/windows/msix/msix-sdk/sdk-overview">https://learn.microsoft.com/windows/msix/msix-sdk/sdk-overview</a>) is an <a id="_idIndexMarker1003"/>open source project that can be used to create application packages for any platform. You can use the SDK for Windows, Linux, macOS, iOS, Android, and even web browsers. We will focus on delivering WinUI applications to Windows users in this chapter, but you can learn more about the MSIX SDK on its GitHub repository at <a href="https://github.com/Microsoft/msix-packaging">https://github.com/Microsoft/msix-packaging</a>.</p>
			<p>On Windows, the following platforms currently support the MSIX format:</p>
			<ul>
				<li>Windows 10, version 1709 and later, and Windows 11</li>
				<li>Wi<a id="_idTextAnchor596"/>ndows <a id="_idIndexMarker1004"/>Server 2019 <strong class="bold">Long-Term Servicing Channel</strong> (<strong class="bold">LTSC</strong>) and later</li>
				<li>Windows Enterprise 2019 LTSC and later</li>
			</ul>
			<p>Earlier versions of <a id="_idIndexMarker1005"/>Windows 10 required <strong class="bold">APPX</strong> packages, which were the predecessor to MSIX packages. However, all Windows 10 versions supported by WinUI 3 also support MSIX packages. Microsoft introduced MSIX packages in 2018 as an evolution of APPX, intending to fill the needs <a id="_idTextAnchor597"/>of APPX as well as legacy <strong class="bold">Windows Installer</strong> (<strong class="bold">MSI</strong>) packages. MSIX <a id="_idIndexMarker1006"/>is an open standard, and as such, it can be used to distribute applications to any platform. MSI has been the standard to package and install Windows desktop applications since 1999. Installing Windows applications with MSI packages is supported in Windows 95 and later operating systems.</p>
			<p>With the <a id="_idTextAnchor598"/>new MSIX <a id="_idIndexMarker1007"/>packaging standard, <strong class="bold">Universal Windows Platform</strong> (<strong class="bold">UWP</strong>) applications delivered to Windows users run inside a lightweight app container. WinUI 3 applications can also be configured to run in an app container for additional security. The <strong class="bold">Windows App Container</strong> provides a sandbox for<a id="_idIndexMarker1008"/> the execution of an application, restricting access to the registry, filesystem, and other system capabilities, such as the camera. Any capabilities that an application needs to access must be sp<a id="_idTextAnchor599"/>ecified in the manifest file. Applications packaged to run in an app container and installed with MSIX have <em class="italic">read access</em> to the Windows registry by default. In this configuration, any data written to the virtualized registry will be completely removed if the application is uninstalled or reset. The same is true of data written to the virtual filesystem.</p>
			<p>As documented on <a id="_idIndexMarker1009"/>Microsoft Learn (<a href="https://learn.microsoft.com/windows/msix/overview#inside-an-msix-package">https://learn.microsoft.com/windows/msix/overview#inside-an-msix-package</a>), an MSIX package’s c<a id="_idTextAnchor600"/>ontents are grouped into <em class="italic">application files</em> and <em class="italic">footprint files</em>, as illustrated in the followin<a id="_idTextAnchor601"/>g diagram:</p>
			<div><div><img src="img/B20908_14_01.jpg" alt="Figure 14.1 – The contents of an MSIX package"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.1 – The contents of an MSIX package</p>
			<p>The application files are the payload of code files and other assets delivered to a user. The footprint files are the metadata and other resources that a package needs to ensure the application files are delivered as intended. This metadata includes the following:</p>
			<ul>
				<li><code>AppManifest</code>: The<a id="_idIndexMarker1010"/> manifest (<code>AppxManifest.xml</code>) includes information about the application’s identity, dependencies, capabilities, extensibility points, and visual elements. This is generated from the <code>Package.appxmanifest</code> file in your WinUI project.</li>
				<li><code>AppBlockmap</code>: The <code>AppxBlockMap.xml</code> file includes an indexed and cryptographically <a id="_idIndexMarker1011"/>hashed list of the files in the package, digitally signed to ensure its integrity when the package is signed.</li>
				<li><code>AppSignature</code>: The <code>AppxSignature.p7x</code> file in the package is generated when th<a id="_idTextAnchor602"/>e package is <a id="_idIndexMarker1012"/>signed. This allows the operating system to validate the signature during installation.</li>
				<li><code>CodeIntegrity</code>: Code integrity<a id="_idIndexMarker1013"/> is ensured by verifying information about the package in <code>AppxManifest.xml</code>, <code>AppxBlockMap.xml</code>, and <code>AppxSignature.p7x</code>.</li>
			</ul>
			<p>The application files in the package will be installed to <code>C:\Program Files\WindowsApps</code><code> \&lt;package_name&gt;</code>, with the application executable found at <code>C:\Program Files\WindowsApps\&lt;package_name&gt;\&lt;app_name&gt;.exe</code>. Note that you can’t directly execute this <code>EXE</code> file, and access to the <code>WindowsApps</code> folder is restricted by Windows. Data created by the application during and after installation will be stored under <code>C:\Users\&lt;user_name&gt;\AppData\Local\Packages\&lt;package_name&gt;</code>. All the application files, dependencies, and data will be removed when the application is uninstalle<a id="_idTextAnchor603"/>d.</p>
			<p>Now that we know the background and history of MSIX, let’s review a few of the tools available to developer<a id="_idTextAnchor604"/><a id="_idTextAnchor605"/>s and IT pros.</p>
			<h2 id="_idParaDest-272">Reviewing MSIX tools and resou<a id="_idTextAnchor606"/>rces</h2>
			<p>Before we start using MSIX to package our own applic<a id="_idTextAnchor607"/>ation, we will review a couple of other available tools and resources, as follows:</p>
			<ul>
				<li><strong class="bold">MSIX Toolkit</strong>: The M<a id="_idTextAnchor608"/>SIX Toolkit<a id="_idIndexMarker1014"/> is an open source collection of MSIX tools and script<a id="_idTextAnchor609"/>s maintained by Microsoft on GitHub:<a href=" https://github.com/microsoft/MSIX-Toolkit"> https://github.com/microsoft/MSIX-Toolkit</a>.</li>
				<li><strong class="bold">MSIX <a id="_idTextAnchor610"/>Labs</strong>: Microsoft <a id="_idIndexMarker1015"/>maintains a set of hands-on tutorials for developers and IT pros interest<a id="_idTextAnchor611"/>ed in leveraging MSIX, to package and distribute their applications: <a href="https://github.com/Microsoft/msix-labs">https://github.com/Microsoft/msix-labs</a>.</li>
				<li><strong class="bold">MSIX Packagin<a id="_idTextAnchor612"/>g Tool</strong>: The <a id="_idIndexMarker1016"/>MSIX Packaging Tool is an application to <a id="_idTextAnchor613"/>repackage classic applications in the MSIX format. Existing EXE, MSI, and <strong class="bold">Application Virtualization</strong> (<strong class="bold">App-V</strong>) inst<a id="_idTextAnchor614"/>allation packages can be converted <a id="_idIndexMarker1017"/>to MSIX packages<a id="_idTextAnchor615"/> with the tool via its interactive <a id="_idTextAnchor616"/>UI or command-line tooling. It is available on the Microsoft Store at <a href="https://apps.microsoft.com/store/detail/msix-packaging-tool/9N5LW3JBCXKF">https://apps.microsoft.com/store/detail/msix-packaging-tool/9N5LW3JBCXKF</a>.</li>
				<li><strong class="bold">MSIX video<a id="_idTextAnchor617"/>s</strong>: Microsoft <a id="_idIndexMarker1018"/>Learn has a series of introductory videos on MSIX packaging here: <a href="https://learn.microsoft.com/windows/msix/resources#msix-videos">https://learn.microsoft.com/windows/msix/resources#msix-videos</a>. This is a great way to get started on your MSIX journey.</li>
				<li><strong class="bold">MSIX community</strong>: <strong class="bold">Microsoft T<a id="_idTextAnchor618"/>ech Community</strong> has <a id="_idIndexMarker1019"/>a<a id="_idTextAnchor619"/> group of discussion spaces dedicated to<a id="_idIndexMarker1020"/> MSIX packaging and deployment. Join <a id="_idTextAnchor620"/>the community and get involved here: <a href="https://techcommunity.microsoft.com/t5/msix/bd-p/MSIX-Discussions">https://techcommunity.microsoft.com/t5/msix/bd-p/MSIX-Discussions</a>.</li>
			</ul>
			<p>These tools and resources will assist you in your journ<a id="_idTextAnchor622"/>ey while learning the ins and outs of WinUI application deployment. It is important to remember that MSIX is an area of continual investment by Microsoft. It is the go-forward strategy and recommendation to package all applications. WinUI developers don’t need to have a deep understanding of MSIX. You w<a id="_idTextAnchor623"/>ill only need a basic knowledge of MSIX an<a id="_idTextAnchor624"/>d the properties that are relevant to our applications. Before we get hands-on, we’ll briefly discuss the concepts of <strong class="bold">packaged applications</strong>, <strong class="bold">package identity</strong>, and <strong class="bold">app containers</strong> in Windows.</p>
			<h2 id="_idParaDest-273"><a id="_idTextAnchor625"/>Packaged applications and application identity</h2>
			<p>There <a id="_idIndexMarker1021"/>are a few deployment concepts that are specific to the Windows App SDK. Let’s cover the basics here before we start to package and deploy our own applications.</p>
			<p>One of the most important concepts to understand is packaged applications. The concepts we have discussed so far apply to packaged WinUI applications. These applications are packaged and installed with MSIX, they have package identity, and by default, they are <strong class="bold">framework-dependent</strong>. We<a id="_idIndexMarker1022"/> just touched on some important concepts in that sentence; let’s start by examining package identity.</p>
			<p>All packaged applications, whether they are WinUI, UWP, or some other desktop Windows application type, benefit from package identity. Package identity is the unique identifier used by Windows to distinguish and validate the identity of your application. There are <a id="_idIndexMarker1023"/>some Windows App SDK features that are only available to applications with package identity. The new Windows App SDK notifications APIs that we used in <a href="B20908_08.xhtml#_idTextAnchor197"><em class="italic">Chapter 8</em></a>, <em class="italic">Add</em><em class="italic">ing</em><em class="italic"> Windows Notifications to WinUI Applications</em>, are available to any packaged application because those apps have package identity. For a current list of other features that require package identity, see this Microsoft Learn topic: <a href="https://learn.microsoft.com/windows/apps/desktop/modernize/modernize-packaged-apps">https://learn.microsoft.com/windows/apps/desktop/modernize/modernize-packaged-apps</a>.</p>
			<p>Now, let’s discuss packaged applications<a id="_idIndexMarker1024"/> and <strong class="bold">unpackaged applications</strong>. We already reviewed some aspects of packaged apps. Most packaged apps are both packaged and installed with MSIX. However, there is a particular variation of a packaged application called a <strong class="bold">packaged app with an external location</strong>. These <a id="_idIndexMarker1025"/>applications are packaged with MSIX, thus having package identity, but they are installed with a different installer mechanism. We won’t deploy a packaged app with an external location, but you can read more about them on Microsoft Learn: <a href="https://learn.microsoft.com/windows/apps/desktop/modernize/grant-identity-to-nonpackaged-apps">https://learn.microsoft.com/windows/apps/desktop/modernize/grant-identity-to-nonpackaged-apps</a>.</p>
			<p>Unpackaged applications don’t have package identity, so there are limits on the APIs they can access, as previously discussed. In most cases, you will only choose this route for legacy applications that don’t require any of the features that require package identity and often require fewer restrictions on their capabilities, such as filesystem or registry access. UWP applications cannot be unpackaged, but WinUI applications can be.</p>
			<p>The final concept to review is that of<a id="_idIndexMarker1026"/> framework-dependent applications and <strong class="bold">self-contained</strong> applications. WinUI applications that are framework-dependent rely on the Windows App SDK runtime to be installed on the target machine. This reduces the size of your application’s installer and allows apps to receive security bug fix updates during runtime, without each application updating. The downsides are having to check for the presence of the runtime during installation and the potential risk of users uninstalling the runtime after your application has been installed.</p>
			<p>Self-contained deployments bundle the Windows App SDK runtime with the MSIX. This increases the size of the installer but provides complete control over the version of the runtime that the application uses. Self-contained applications also enable <strong class="bold">Xcopy deployment</strong>. You<a id="_idIndexMarker1027"/> can copy the application and its dependencies from the project’s output folder to any supported PC. Other than the package size, the primary downside to this option is performance. Self-contained applications are slower to load, and they use more system memory because their dependencies are not shared with other WinUI applications on the system. They are isolated to your application’s process.</p>
			<p>For more detailed information on these concepts, there are two excellent topics on Microsoft Learn:</p>
			<ul>
				<li>The <em class="italic">Windows App SDK deployment overview</em> (<a href="https://learn.microsoft.com/windows/apps/package-and-deploy/deploy-overview">https://learn.microsoft.com/windows/apps/package-and-deploy/deploy-overview</a>) discusses the pros and cons of self-contained deployment</li>
				<li>The <em class="italic">Deployment overview</em> topic (<a href="https://learn.microsoft.com/windows/apps/package-and-deploy/">https://learn.microsoft.com/windows/apps/package-and-deploy/</a>) dives deeper into packaged apps versus unpackaged apps</li>
			</ul>
			<p>Now, let’s get started and go hands-on, creating our MS<a id="_idTextAnchor626"/><a id="_idTextAnchor627"/>IX package in Visual Studio.</p>
			<h1 id="_idParaDest-274"><a id="_idTextAnchor628"/>Getting started with application packaging in Visual Studio</h1>
			<p>In this section, we’ll <a id="_idIndexMarker1028"/>see how we can package our applications with MSIX in Visual Studio. Visual Studio 2022 includes two WinUI project templates capable of creating MSIX deployment packages, outlined as follows:</p>
			<ul>
				<li><code>package.appxmanifest</code> file to generate an MSIX package</li>
				<li><code>package.appxmanifest</code> file</li>
			</ul>
			<p>We will<a id="_idIndexMarker1029"/> work with the completed <strong class="bold">MyMediaCollection</strong> solution from <a href="B20908_08.xhtml#_idTextAnchor197"><em class="italic">Chapter 8</em></a>. You can either use your own solution from that chapter or download a copy from this chapter’s GitHub repository at <a href="https://github.com/PacktPublishing/Learn-WinUI-3-Second-Edition/tree/master/Chapter14">https://github.com/PacktPublishing/Learn-WinUI-3-Second-Edition/tree/master/Chapter14</a>. Let’s see how to generate an MSIX package for the application, as follows:</p>
			<ol>
				<li>Start by opening the solution in Visual Studio.</li>
				<li>If you want to review the manifest data for the project, you can open the <code>Package.appxmanifest</code> file and review the settings on each tab, as illustrated<a id="_idTextAnchor629"/> in the following screenshot:</li>
			</ol>
			<div><div><img src="img/B20908_14_02.jpg" alt="Figure 14.2 – Reviewing the applicati﻿on manifest"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.2 – Reviewing the applicati<a id="_idTextAnchor630"/>on manifest</p>
			<ol>
				<li value="3">Then, right-click <a id="_idTextAnchor631"/>the <code>MyMediaCollection</code> project in <strong class="bold">Solution Explorer</strong> and select <strong class="bold">Package and Publish</strong> | <strong class="bold">Create App Packages</strong>. The <strong class="bold">Create App Packages</strong> window will appear, as illustrated <a id="_idTextAnchor632"/>in the following screenshot:</li>
			</ol>
			<div><div><img src="img/B20908_14_03.jpg" alt="Figure 14.3 – The Create App Packages window"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.3 – The Create App Packages window</p>
			<ol>
				<li value="4">Select <strong class="bold">Sideloading</strong>, leave <strong class="bold">Enable automatic updates</strong> se<a id="_idTextAnchor633"/>lected, and click <strong class="bold">Next</strong>. This is the <a id="_idTextAnchor634"/><a id="_idIndexMarker1030"/>MSIX equivalent <a id="_idIndexMarker1031"/>of <strong class="bold">ClickOnce </strong><strong class="bold">deployment</strong> (<a href="https://learn.microsoft.com/visualstudio/deployment/clickonce-security-and-deployment">https://learn.microsoft.com/visualstudio/deployment/clickonce-security-and-deployment</a>).</li>
				<li>On the <strong class="bold">Select signing method</strong> page, remove the current certificate if one appears. You will see options to add a certificate<a id="_idIndexMarker1032"/> from <strong class="bold">Azure Key Vault</strong>, the Store, or a local file, or create a new one, as illustrate<a id="_idTextAnchor635"/>d in the following screenshot:</li>
			</ol>
			<div><div><img src="img/B20908_14_04.jpg" alt="Figure 14.4 – Selecting a signing method for the package"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.4 – Selecting a signing method for the package</p>
			<ol>
				<li value="6">We will<a id="_idIndexMarker1033"/> c<a id="_idTextAnchor636"/>reate a self-signed certificate here. If you wanted to create a package with a certificate from a trusted authority, you would choose one of the <code>.pfx</code> file. For this exercise, select <strong class="bold">Create</strong>.</li>
				<li>Enter and confirm a secure password on the <strong class="bold">Create a Self-Signed Test Certificate</strong> dialog, and click <strong class="bold">OK</strong>. If you are prompted to overwrite an existing certificate, you can do that. Select <strong class="bold">Yes</strong> to continue. You will also receive a message about the certificate being imported to the certificate store for package signing. You can click <strong class="bold">OK</strong> on that message dialog.</li>
				<li>When you return to the <strong class="bold">Select signing method</strong> page, the new certificate details will appear. Make sure you click the <strong class="bold">Trust</strong> button on the page to trust the certificate on your machine before continuing. Click <strong class="bold">Next</strong>.</li>
				<li>On the <strong class="bold">Select and configure packages</strong> page, there are options to change the version number, generate an app bundle, or add, remove, and change solution configuration mappings. There is also a checkbox to include public symbol files with your package. Leave all the defaults and click <strong class="bold">Next</strong>.</li>
				<li>On the <strong class="bold">Configure update settings</strong> page, an <strong class="bold">Installer location</strong> path is required. For<a id="_idIndexMarker1034"/> applications where you will install a worksta<a id="_idTextAnchor637"/>tion on an internal network, you could enter<a id="_idTextAnchor638"/> the network path to the package here. For our test purposes, we will enter a local path, as illustrated in the following screenshot. For an application to update correctly on other machines, the same local path to the<a id="_idTextAnchor639"/> installer would need to exist:</li>
			</ol>
			<div><div><img src="img/B20908_14_05.jpg" alt="Figure 14.5 – Configuring update settings for the package"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.5 – Configuring update settings for the package</p>
			<ol>
				<li value="11">Click <strong class="bold">Create</strong>. The solution will be built, and the package will be created. When it completes, click the <strong class="bold">Copy and Close</strong> button to copy the installer to your selected installer location.</li>
				<li>Open the <code>MyMediaCollection_1.0.0.0_x64_Debug_T<a id="_idTextAnchor640"/>est</code> folder to see the generated M<a id="_idTextAnchor641"/>SIX file, as illustrate<a id="_idTextAnchor642"/>d in the following screenshot:</li>
			</ol>
			<div><div><img src="img/B20908_14_06.jpg" alt="Figure 14.6 – The MSIX package created for MyMediaCollection"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.6 – The MSIX package created for MyMediaCollection</p>
			<ol>
				<li value="13">Navigate to<a id="_idIndexMarker1035"/> the <code>MyMediaCollection</code> parent folder and double-click the <code>index.html</code> file to install the package. It will open the file in your default browser and present you with options to install any of the configurations selected during packaging. Note, in the following screenshot, I packaged the application a second time, so the version number has been automatically incremented to <code>1.0.1.0</code>:</li>
			</ol>
			<div><div><img src="img/B20908_14_07.jpg" alt="Figure 14.7 – The installation page for MyMediaCollection"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.7 – The installation page for MyMediaCollection</p>
			<ol>
				<li value="14">If you try to<a id="_idIndexMarker1036"/> install the package on the same machine where it has already been installed and run, you will be prompted to update the application. Continue to install or update the application on your system.</li>
			</ol>
			<p>Creating a package with Visual Studio is how most IDE users will choose to g<a id="_idTextAnchor643"/>enerate their installers. Ther<a id="_idTextAnchor644"/>e are also tools to create MSIX packages and bundles at the command line, which are described in the Microsoft Learn documentation: <a href="https://learn.microsoft.com/windows/msix/package/manual-packaging-root">https://learn.microsoft.com/windows/msix/package/manual-packaging-root</a>.</p>
			<p>Now, let’s look at an alternative distribution m<a id="_idTextAnchor645"/><a id="_idTextAnchor646"/>ethod, Windows Package Manager.</p>
			<h1 id="_idParaDest-275">Deploying applications with <a id="_idTextAnchor647"/>Windows Package Manager</h1>
			<p>Windows Package Manager, also <a id="_idIndexMarker1037"/>referred to by its<a id="_idTextAnchor648"/> command<a id="_idIndexMarker1038"/> name <code>WinGet</code> command to <a id="_idIndexMarker1040"/>install published packages and the steps to add your own MSIX packages to the <code>WinGet</code> finds available packages to install. The Microsoft Store is one of the package sources available to <code>WinGet</code>. So, if you plan to publish your application to the store, it is not necessary to also publish it to the WinGet repository.</p>
			<p>Let’s start by reviewing the steps to add a p<a id="_idTextAnchor650"/><a id="_idTextAnchor651"/>ackage to the community repository.</p>
			<h2 id="_idParaDest-276">Adding a package to th<a id="_idTextAnchor652"/>e community repository</h2>
			<p><a id="_idTextAnchor653"/>To make <a id="_idIndexMarker1041"/>your applications available to Windows users with the <code>WinGet</code> command, they must be published to Microsoft’s Package Manager community repository or the Microsoft Store. Any application published to the community repository can be discovered and installed through the <code>WinGet</code> command in Windows.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">This method of distribution is inherently less secure than distribution through the Microsoft Store. In theory, anyone with access to the public repository could extract the package and de-compile your application.</p>
			<p>To add your existing MSIX bundle to the repository, we will need to make it<a id="_idTextAnchor654"/> publicly available, create a WinGet manifest, and submit a<a id="_idIndexMarker1042"/> GitHub <strong class="bold">pull request</strong> (<strong class="bold">PR</strong>) to have the manifest added to the community repository, as follows:</p>
			<ol>
				<li>Start by pushing the contents of the installer folder we created (<code>C:\Installers\MyMediaCollection</code>) to a public URL. To do this, you could create a static website in Azure. This Microsoft Learn topic walks through the process: <a href="https://learn.microsoft.com/azure/static-web-apps/get-started-portal">https://learn.microsoft.com/azure/static-web-apps/get-started-portal</a>. This would require a GitHub or Azure DevOps repository to host the files to be deployed.<p class="list-inset">The files can be <a id="_idIndexMarker1043"/>made available on any public URL. Another option is to host the files in <strong class="bold">Azure Blob Storage</strong> (<a href="https://learn.microsoft.com/azure/storage/blobs/storage-blob-static-website-how-to?tabs=azure-portal">https://learn.microsoft.com/azure/storage/blobs/storage-blob-static-website-how-to?tabs=azure-portal</a>). We will choose this option.</p></li>
				<li>After <a id="_idIndexMarker1044"/>the <code>index.html</code> filename that we’ll upload as the index document name. After you save the file, the <strong class="bold">Primary en<a id="_idTextAnchor655"/>dpoint</strong> field will appea<a id="_idTextAnchor656"/>r, as seen in the following screenshot:</li>
			</ol>
			<div><div><img src="img/B20908_14_08.jpg" alt="Figure 14.8 – Setting up a static website in Azure Blob Storage"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.8 – Setting up a static website in Azure Blob Storage</p>
			<ol>
				<li value="3">Click the <strong class="bold">$web</strong> link on that page to navigate to the portal page, where you can upload files to the static web app folder.</li>
				<li>Click <code>C:\Installers\MyMediaCollection</code> folder.</li>
			</ol>
			<p>Once your package is in the cloud, you are ready to create your manifest<a id="_idTextAnchor657"/> file for the community repository. The file is created in the <strong class="bold">YAML</strong> format. YAML files are the current standard <a id="_idIndexMarker1046"/>for <strong class="bold">DevOps</strong> workflows.</p>
			<p>For detailed instructions on creating a manifest and links to learn more about YAML, check out this Microsoft Learn topic: <a href="https://learn.microsoft.com/windows/package-manager/package/manifest">https://learn.microsoft.com/windows/package-manager/package/manifest</a>:</p>
			<ol>
				<li>Name <a id="_idIndexMarker1047"/>your YAML file <code>YourCompany.MyMediaCollection.yaml</code>; the contents should look something like this:<pre class="source-code">
PackageIdentifier: YourCompany.MyMediaCollection
PackageVersion: 1.0.0.0
PackageLocale: en-US
Publisher: Your Company Name
PackageName: My Media Collection
License: MIT
ShortDescription: My Media Collection helps you get your media collection organized.
Installers:
  - Architecture: x64
    InstallerType: msix
    InstallerUrl: https://mymediacollectiondeploy.z20.web.core.windows.net/MyMediaCollection_1.0.0.0_x64_Debug_Test/MyMediaCollection_1.0.0.0_x64_Debug.msix
    InstallerSha256: 712f139d71e56bfb306e4a7b739b0e1109abb662dfa164192a5cfd6adb24a4e1
    SignatureSha256: e53f48473621390c8243ada6345826af7c713cf1f4bbdf0d0<a id="_idTextAnchor658"/>30599d1e4c175ea
ManifestVersion: 1.0.0</pre></li>				<li>To get the <code>Sha256</code> informat<a id="_idTextAnchor659"/>ion for your <code>.msix</code> file, you can use this command:<pre class="source-code">
<strong class="bold">certUtil –hashfile</strong>
<strong class="bold">  C:\Installers\MyMediaCollection\</strong>
<strong class="bold">    MyMediaCollection_1.0.0.0_x64_Debug_Test\</strong>
<strong class="bold">      MyMediaCollection_1.0.0.0_x64_Debug.msix SHA256</strong></pre></li>				<li>Then, test your manifest with WinGet. To install WinGet, you can install the <strong class="bold">App Installer</strong> app <a id="_idIndexMarker1048"/>from the Microsoft Store at <a href="https://apps.microsoft.com/store/detail/app-installer/9NBLGGH4NNS1">https://apps.microsoft.com/store/detail/app-installer/9NBLGGH4NNS1</a>.</li>
				<li>After the <a id="_idIndexMarker1049"/>application is installed from the store, test the syntax in your manifest with the following command:<pre class="source-code">
<strong class="bold">winget validate &lt;manifest-file-name&gt;</strong></pre></li>				<li>Then, test installing the app from your manifest with this command:<pre class="source-code">
<code>publisher</code> name must be unique. If you have an<a id="_idIndexMarker1050"/> account on <code>package</code> is the name of your application:<pre class="source-code">
<strong class="bold">manifests\&lt;letter of alphabet&gt;\&lt;publisher&gt;\&lt;package&gt;\&lt;version&gt;\&lt;filename&gt;.yaml</strong></pre></li>			</ol>
			<p class="callout-heading">Note</p>
			<p class="callout">If you’re unfamiliar with the GitHub forking and PR workflow, the Package Manager documentation has more detailed steps: <a href="https://learn.microsoft.com/windows/package-manager/package/repository#step-3-clone-the-repository">https://learn.microsoft.com/windows/package-manager/package/repository#step-3-clone-the-repository</a>.</p>
			<p>After the PR has been approved and merged, any users with WinGet will be able to install your application from the com<a id="_idTextAnchor662"/><a id="_idTextAnchor663"/>mand line. Let’s see how to use WinGet next.</p>
			<h2 id="_idParaDest-277">Using<a id="_idTextAnchor664"/> WinGet for package management</h2>
			<p>W<a id="_idTextAnchor665"/>inGet is the <a id="_idIndexMarker1051"/>command-line client for Windows Package Manager. If you are fami<a id="_idTextAnchor666"/>liar with other application package managers, such<a id="_idIndexMarker1052"/> as <strong class="bold">Chocolatey</strong> for Windows (<a href="https://chocolatey.org/">https://chocolatey.org/</a>) or<a id="_idTextAnchor667"/> <strong class="bold">Homebrew</strong> for macOS (<a href="https://brew.sh/">https://brew.sh/</a>), WinGet will feel familiar to you. A package manager allows <a id="_idIndexMarker1053"/>you to install, list, and update applications on your operating system and to script the installation of multiple applications, such as when you’re setting up a new computer. In this section, we will see how to use WinGet to <a id="_idIndexMarker1054"/>install <strong class="bold">Windows Terminal</strong>, Microsoft’s modern command-line app, built with WinUI!</p>
			<p class="callout-heading">Note</p>
			<p class="callout">To read about how <a id="_idIndexMarker1055"/>the Windows Terminal team created the application with WinUI, check out this blog post: <a href="https://devblogs.microsoft.com/commandline/building-windows-terminal-with-winui/">https://devblogs.microsoft.com/commandline/building-windows-terminal-with-winui/</a>.</p>
			<p>Let’s now look at the steps:</p>
			<ol>
				<li>You already have the App Installer preview installed, so open <strong class="bold">Command Prompt</strong>.</li>
				<li>Test WinGet with the following command:<pre class="source-code">
<code>search</code> command to find the application we want to insta<a id="_idTextAnchor668"/>ll, as follows:<pre class="source-code">
<strong class="bold">winget search windows<a id="_idTextAnchor669"/>termina<a id="_idTextAnchor670"/>l</strong></pre><p class="list-inset">You will see two results, as illustrated here:</p></li>			</ol>
			<div><div><img src="img/B20908_14_09.jpg" alt="Figure 14.9 – Performing a search with WinGet"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.9 – Performing a search with WinGet</p>
			<p class="callout-heading">Note</p>
			<p class="callout">You may have to agree to the Microsoft Store <em class="italic">terms of transaction</em> before continuing.</p>
			<ol>
				<li value="4">To get<a id="_idIndexMarker1056"/> more information about the package, use the <code>show</code> command, as follows:<pre class="source-code">
<strong class="bold">winget show Microsoft.WindowsTerminal</strong></pre><p class="list-inset">This will retur<a id="_idTextAnchor671"/>n the following from the application’s manifest:</p></li>			</ol>
			<div><div><img src="img/B20908_14_10.jpg" alt="Figure 14.10 – Viewing manifest information for a WinGet package"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.10 – Viewing manifest information for a WinGet package</p>
			<ol>
				<li value="5">Then, enter this command to install Windows Terminal:<pre class="source-code">
<code>Microsoft.PowerToys</code> (you can find out more about <strong class="bold">Microsoft PowerToys</strong> at <a href="https://learn.microsoft.com/windows/powertoys/">https://learn.microsoft.com/windows/powertoys/</a>).</p></li>			</ol>
			<p>Tha<a id="_idTextAnchor674"/>t’s all<a id="_idIndexMarker1058"/> there is to using WinGet. Because it is a command-line tool, you c<a id="_idTextAnchor675"/>an build scripts that install all the software you need to get a <a id="_idIndexMarker1059"/>new PC or <strong class="bold">virtual machine</strong> (<strong class="bold">VM</strong>) up and running. Get more information about scripting with WinGet on Microsoft Learn: <a href="https://learn.microsoft.com/windows/package-manager/winget/#scripting-winget">https://learn.microsoft.com/windows/package-manager/winget/#scripting-winget</a>.</p>
			<p>Let’s move along to our final section, where we will learn abou<a id="_idTextAnchor676"/><a id="_idTextAnchor677"/>t distributing applications in the Microsoft Store.</p>
			<h1 id="_idParaDest-278">Distrib<a id="_idTextAnchor678"/>uting applications with th<a id="_idTextAnchor679"/>e Microsoft Store</h1>
			<p>We have seen <a id="_idIndexMarker1060"/>how to deliver WinUI applications to users through packages that can be sideloaded and with WinGet. There are a couple<a id="_idTextAnchor680"/> of other distribution channels available to Windows developers – <strong class="bold">Microsoft Intune</strong> for <a id="_idIndexMarker1061"/>enterprise application distr<a id="_idTextAnchor681"/>ibution, and<a id="_idIndexMarker1062"/> the <strong class="bold">Microsoft Store</strong> for consumer apps.</p>
			<p>A deeper dive <a id="_idIndexMarker1063"/>into <strong class="bold">Microsoft Endpoint Configuration Manager</strong> and Intune is beyond the scope of this book, but if you are interested in learnin<a id="_idTextAnchor682"/>g how<a id="_idIndexMarker1064"/> to distribute <strong class="bold">line of business</strong> (<strong class="bold">LOB</strong>) applications through them, you can read this Microsoft Learn topic: <a href="https://learn.microsoft.com/windows/apps/publish/distribute-lob-apps-to-enterprises">https://learn.microsoft.com/windows/apps/publish/distribute-lob-apps-to-enterprises</a>.</p>
			<p>The Microsoft Store is the consumer app store for Windows users. The store accepts submissions for free and paid apps. Additional monetization options such as in-app purchases, sale pricing, and paid apps with a free trial period can also be configured.</p>
			<p>In this section, we will cover the basics of submitting a free application to the store. If you want to learn more about monetizing your app, you can start here: <a href="https://learn.microsoft.com/windows/apps/publish/publish-your-app/price-and-availability">https://learn.microsoft.com/windows/apps/publish/publish-your-app/price-and-availability</a>.</p>
			<p>Let’s see<a id="_idTextAnchor683"/><a id="_idTextAnchor684"/> how to submit <strong class="bold">MyMediaCollection</strong> to the Microsoft Store.</p>
			<h2 id="_idParaDest-279">Preparing a free<a id="_idTextAnchor685"/> application for<a id="_idTextAnchor686"/> the Microsoft Store</h2>
			<p>In this section, we will use <a id="_idIndexMarker1065"/>Visual Studio to prepare and submit the <strong class="bold">MyMediaCollection</strong> application to the Microsoft Store. The Microsoft Store is the primary delivery outlet for consumer applications. Before you start this process, you will need to have a developer account on the store. Let’s do this now, as follows:</p>
			<ol>
				<li>First, visit the sign-up page for the Microsoft Store (<a href="https://developer.microsoft.com/microsoft-store/register/">https://developer.microsoft.com/microsoft-store/register/</a>) and click <strong class="bold">SIGN UP</strong>.</li>
				<li>Sign in with a Microsoft account, and select the country or region where you or your company is located.</li>
			</ol>
			<p class="callout-heading">Note</p>
			<p class="callout">This account will be the owner of the Store account and cannot easily be changed. If you create a Store account for an organization, it is recommended to use a separate Microsoft account that is not tied to any individual at the organization or company.</p>
			<ol>
				<li value="3">Choose <strong class="bold">Individual</strong> or <strong class="bold">Company</strong> as your account type.</li>
				<li>Enter<a id="_idIndexMarker1066"/> your publisher display name. This is the name that will be seen by users on your public application store listings, so choose this carefully.</li>
				<li>Enter your contact details – this information will be used by Microsoft to contact you if there are any issues or updates with your store listings. Click <strong class="bold">Next</strong> to continue and enter payment information.</li>
				<li>Pay a one-time store registration fee. Microsoft charges a small fee the first time you register for an account on the store. This helps to prevent fraudulent and malicious accounts from being created. In most countries, the fee is approximately <em class="italic">$19 US Dollars (USD) for individuals</em> and <em class="italic">$99 USD for a </em><em class="italic">company account</em>.<p class="list-inset">The full listing of fees by country is available here: <a href="https://learn.microsoft.com/windows/apps/publish/partner-center/account-types-locations-and-fees#developer-account-and-app-submission-markets">https://learn.microsoft.com/windows/apps/publish/partner-center/account-types-locations-and-fees#developer-account-and-app-submission-markets</a>.</p></li>
				<li>When you are finished, click <strong class="bold">Review</strong>.</li>
				<li>Review the details for your account and the app developer agreement, and click <strong class="bold">Finish</strong> to confirm your registration. Payment will be processed at this time, and y<a id="_idTextAnchor687"/>ou will receive a confirmation emai<a id="_idTextAnchor688"/>l.</li>
			</ol>
			<p>Now that you have an account on the Microsoft Store, we can proceed to submit our first app, as follows:</p>
			<ol>
				<li>Return <a id="_idIndexMarker1067"/>to Visual Studio and right-click on the <code>MyMediaCollection</code> project in <strong class="bold">Solution Explorer</strong>.</li>
				<li>Select <strong class="bold">Package and Publish</strong> | <strong class="bold">Create App Packages</strong>. This process starts out the same as when creating a package for sideloading.</li>
				<li>On the <strong class="bold">Select distribution method</strong> screen, select <strong class="bold">Microsoft Store under a new app name</strong>, and click <strong class="bold">Next</strong>.</li>
				<li>On the <strong class="bold">Select an app name</strong> screen, ensure the Microsoft account linked to your store account is selected, and enter your desired application name in the <strong class="bold">Reserve a new app name</strong> field. Cli<a id="_idTextAnchor689"/>ck <strong class="bold">Reserve</strong> to check whether the name is available. Each app name must be unique a<a id="_idTextAnchor690"/>cross the Microsoft Store. The app name will appear in your<a id="_idTextAnchor691"/> list of apps, as illustrated in the following screenshot:</li>
			</ol>
			<div><div><img src="img/B20908_14_11_new.jpg" alt="Figure 14.11 – Selecting an app name for the Microsoft Store listing"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.11 – Selecting an app name for the Microsoft Store listing</p>
			<ol>
				<li value="5">Select the app name in your <strong class="bold">Existing app names</strong> list, and click <strong class="bold">Next</strong>.</li>
				<li>You can<a id="_idIndexMarker1068"/> leave the defaul<a id="_idTextAnchor692"/>t values on <a id="_idTextAnchor693"/>the <strong class="bold">Select and configure packages</strong> screen unless you want to update the version or the solution configuration mappings. Click <strong class="bold">Create</strong> at the bottom <a id="_idTextAnchor694"/>of the screen, as illustrated in the following screenshot:</li>
			</ol>
			<div><div><img src="img/B20908_14_12.jpg" alt="Figure 14.12 – T﻿he Select and confi﻿gure packages screen"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.12 – T<a id="_idTextAnchor695"/>he Select and confi<a id="_idTextAnchor696"/>gure packages screen</p>
			<ol>
				<li value="7">Visual Studio <a id="_idIndexMarker1069"/>will build your project and prepare the package for the store. It will also do some validation of your app manifest data. If you receive any errors during packaging, fix them and try again. If you feel your submission is ready to go after reviewing the submission checklist (<a href="https://learn.microsoft.com/windows/apps/publish/publish-your-app/create-app-submission#app-submission-checklist">https://learn.microsoft.com/windows/apps/publish/publish-your-app/create-app-submission#app-submission-checklist</a>), you can check the <strong class="bold">Automatically submit to the Microsoft Store after Windows App Certification Kit validation</strong> checkbox on the <strong class="bold">Finished creating package</strong> screen. This will submit your package to the store upon a successful validation run.</li>
				<li>Click the <strong class="bold">Launch Windows App Certification Kit</strong> button. When the certification<a id="_idIndexMarker1070"/> kit lau<a id="_idTextAnchor697"/>nches, keep all the test<a id="_idTextAnchor698"/>s selected, and then click <strong class="bold">Next</strong>. The tests will take several minutes to complete, and the application may launch several times during the validation process. The fo<a id="_idTextAnchor699"/>llowing screenshot illustrates the <strong class="bold">Validating </strong><strong class="bold">App</strong> progress:</li>
			</ol>
			<div><div><img src="img/B20908_14_13.jpg" alt="Figure 14.13 – The Microsoft Store application validation in process"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.13 – The Microsoft Store application validation in process</p>
			<ol>
				<li value="9">The process should provide a <strong class="bold">PASSED</strong> result on the <strong class="bold">View Final Report</strong> page. Upon completion, you can click the <strong class="bold">Click here to view the results</strong> option to see which tests passed or failed. All failures should be addressed before continuing with the store submission. These tests will be run during the Microsoft Store approval process, and any failures here are likely to cause the submission<a id="_idIndexMarker1071"/> to be rejected. For details on the tests and corrective actions that can be taken for failures, you can review this Microsoft Learn topic: <a href="https://learn.microsoft.com/windows/uwp/debug-test-perf/windows-app-certification-kit-tests">https://learn.microsoft.com/windows/uwp/debug-test-perf/windows-app-certification-kit-tests</a>.</li>
			</ol>
			<p>When you have a validated application ready to submit to the store, you can continue the process. Let’s walk through how to submit a Win<a id="_idTextAnchor702"/><a id="_idTextAnchor703"/>UI application through the Microsoft Partner Center w<a id="_idTextAnchor704"/>ebsite.</p>
			<h2 id="_idParaDest-280">Uploading a package to <a id="_idTextAnchor705"/>the Store</h2>
			<p>In this section, we<a id="_idIndexMarker1072"/> will walk through submitting a package created by Visual Studio to the Microsoft Store using the Partner Center dashboard. To do this, proceed as follows:</p>
			<ol>
				<li>Start by logging in to the Partner Center with your Microsoft account at the following URL: <a href="https://partner.microsoft.com/dashboard/home">https://partner.microsoft.com/dashboard/home</a>.</li>
				<li>Click <strong class="bold">Apps and Games</strong>, and you will be taken to the <strong class="bold">Overview</strong> page to submit apps and games to Windows and Xbox.</li>
				<li>You will see a list of reserved app names and submitted apps on your account here. If you do not yet have an app name reserved, you can click <strong class="bold">New product </strong> | <strong class="bold">MSIX or PWA app</strong>. I am going to select <strong class="bold">My Media Collection</strong> from my apps to submit an initial version of this application. The following scree<a id="_idTextAnchor706"/>nshot illustrates how you would start to reserve a new name:</li>
			</ol>
			<div><div><img src="img/B20908_14_14.jpg" alt="Figure 14.14 – Reserving a new name for your application"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.14 – Reserving a new name for your application</p>
			<ol>
				<li value="4">On the <strong class="bold">Application overview</strong> page for your selected app, click <strong class="bold">Start y<a id="_idTextAnchor707"/>our submission</strong>, as<a id="_idIndexMarker1073"/> illustrated in the following screenshot:</li>
			</ol>
			<div><div><img src="img/B20908_14_15.jpg" alt="Figure 14.15 – Starting your new application submission"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.15 – Starting your new application submission</p>
			<ol>
				<li value="5">Begin the submissio<a id="_idTextAnchor708"/>n by selecting the <strong class="bold">Pricing and </strong><strong class="bold">availab<a id="_idTextAnchor709"/>ility</strong> section.</li>
				<li>We will keep all the default settings in this section, except for the <strong class="bold">Base price</strong> option. A selection must be made here. Choose the <strong class="bold">Free</strong> option or select a base price from the list. When you are done, select <strong class="bold">Save draft</strong>.</li>
				<li>Then, select <a id="_idIndexMarker1074"/>the <strong class="bold">Properties</strong> section. Select a category and sub-category, if necessary, and enter your <strong class="bold">Support info</strong> data. Enter any relevant data for your app in the <strong class="bold">Display mode</strong>, <strong class="bold">Product declarations</strong>, and <strong class="bold">System requirements</strong> sections, and click <strong class="bold">Save</strong>.<p class="list-inset">The<a id="_idTextAnchor710"/> <strong class="bold">Properties</strong> section can be seen in the following screenshot:</p></li>
			</ol>
			<div><div><img src="img/B20908_14_16.jpg" alt="Figure 14.16 – The Properties section of the application submission"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.16 – The Properties section of the application submission</p>
			<ol>
				<li value="8">Complete the questionnaire <a id="_idTextAnchor711"/>on the <strong class="bold">Age ratings</strong> page and click <strong class="bold">P<a id="_idTextAnchor712"/>review ratings</strong>. This page determines whether your app should be restricted to certain age groups, based on the data it collects or exchanges with other users. If everything looks good after generation, click <strong class="bold">Save</strong>, followed by <strong class="bold">Continue</strong>.</li>
				<li>Select the <code>.msixupload</code> or <code>.msix</code> file and upload it to the site for submission. Choose the compatible device families and click <strong class="bold">Save</strong>.</li>
				<li>Then, select a language under the <strong class="bold">Store listings</strong> section. Supporting multiple languages and specifying them here makes it more likely that your application will be installed in different countries. Add an application description and at least one <a id="_idIndexMarker1075"/>screenshot of your application. The remaining fields are optional, but the more you complete, the easier it will be for customers to find your app, and the more likely they are to try it. When everything is completed, click <strong class="bold">Save</strong>.<p class="list-inset">Some exa<a id="_idTextAnchor713"/>mple language options are shown in the following screenshot:</p></li>
			</ol>
			<div><div><img src="img/B20908_14_17.jpg" alt="Figure 14.17 – Selecting languages for the application submission"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.17 – Selecting languages for the application submission</p>
			<ol>
				<li value="11">Completing the <strong class="bold">Submission options</strong> page is optional. By default, your app will be published immediately after passing certification. I will select <strong class="bold">Don’t publish this subm<a id="_idTextAnchor714"/>ission until I select publish now</strong> because<a id="_idTextAnchor715"/> I do not want this app to be available in the store until I make some additional changes.</li>
				<li>Finally, click <strong class="bold">Submit to the Store</strong>. Your app will be submitted for certification. If it passes, it will be available in the Microsoft Store when you have indicated this on the <strong class="bold">Submission options</strong> page. If your app fails validation, you will receive a list of issues to address before attempting another submission.</li>
			</ol>
			<p>Those are the <a id="_idIndexMarker1076"/>basic steps to submit a new application to the Microsoft Store. For more detailed scenarios, and information about updates and add-ons, you can review the Microsoft Learn <em class="italic">app submission</em> documentation: <a href="https://learn.microsoft.com/windows/apps/publish/publish-your-app/create-app-submission">https://learn.microsoft.com/windows/apps/publish/publish-your-app/create-app-submission</a>.</p>
			<p>Now, we <a id="_idTextAnchor716"/><a id="_idTextAnchor717"/>will cover how to sideload applications in Windows with MSIX.<a id="_idTextAnchor718"/></p>
			<h1 id="_idParaDest-281">Sideloading WinUI a<a id="_idTextAnchor719"/>pplications with MSIX</h1>
			<p>In this section, we <a id="_idIndexMarker1077"/>will create an MSIX package for a WinUI project and learn how to sideload it on Windows 10. When you sideload an application, you install it directly with the MSIX UI or PowerShell commands. This method of installation is important to understand, as it is frequently used by enterprises to distribute applications internally.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">You could also create a self-contained application package and use Xcopy deployment for distribution, but this method has some performance drawbacks, which we covered earlier in the chapter<a id="_idTextAnchor720"/><a id="_idTextAnchor721"/>.</p>
			<p>We are going to start by creating a package for sideloading<a id="_idTextAnchor722"/>.</p>
			<h2 id="_idParaDest-282">Creating an <a id="_idTextAnchor723"/>MSIX package for sideloading</h2>
			<p>In this section, we<a id="_idIndexMarker1078"/> will create a package for a WinUI project with Visual Studio. You can start by either opening an existing WinUI project or by creating a new, empty one. I have created a new project named <code>ProjectTracker</code>. Proceed as follows:</p>
			<ol>
				<li>First, right-click the project in <strong class="bold">Solution Explorer</strong>, and select <strong class="bold">Package and Publish</strong> | <strong class="bold">Create </strong><strong class="bold">App Packages</strong>.</li>
				<li>On the <strong class="bold">Select distribution method</strong> screen of the <strong class="bold">Create App Packages</strong> window, leave the <strong class="bold">Sideloading</strong> radio button and the <strong class="bold">Enable automatic updates</strong> checkbox selected. Click <strong class="bold">Next</strong>.</li>
				<li>On the <a id="_idIndexMarker1079"/>following page, select a signing method. Select <strong class="bold">Yes, select a certificate</strong>, and click the <strong class="bold">Create</strong> button. Here, you will create a self-signed certificate. By using a self-signed certificate, any users who install the app will need to trust your package and import the certificate from the MSIX package. We will explain this process in the following section, when we sideload the package. Enter a name and password f<a id="_idTextAnchor724"/>or the certificate, as illustrated in the following screenshot:</li>
			</ol>
			<div><div><img src="img/B20908_14_18.jpg" alt="Figure 14.18 – Creating a self-signed certificate for th﻿e package"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.18 – Creating a self-signed certificate for th<a id="_idTextAnchor725"/>e package</p>
			<ol>
				<li value="4">Select <strong class="bold">Tr<a id="_idTextAnchor726"/>ust</strong> to trust the certificate, and click <strong class="bold">Next</strong>.</li>
				<li>Leave the default settings on the <strong class="bold">Select and configure packages</strong> page. Click <strong class="bold">Next</strong>.</li>
				<li>Enter the<a id="_idIndexMarker1080"/> installer path. This can be a local file path or a network location. Click <strong class="bold">Create</strong>. Your project will compile, and the package will be created in the specified location.</li>
			</ol>
			<p>Now that we have an MSIX package for our proje<a id="_idTextAnchor727"/><a id="_idTextAnchor728"/>ct, we’re ready to sideload it. Let’s walk throu<a id="_idTextAnchor729"/>gh this process.</p>
			<h2 id="_idParaDest-283"><a id="_idTextAnchor730"/>Sideloading an MSIX package</h2>
			<p>In this section, we<a id="_idIndexMarker1081"/> will learn how to sideload a WinUI application with MSIX. We created a new MSIX package in the previous section. Navigate to the folder where the package was created inside your project’s folder, and review the files in the package folder – named <code>ProjectTracker_1.0.0.0_<a id="_idTextAnchor731"/>x64_Test</code>, in my case. The following screenshot illustrates this:</p>
			<div><div><img src="img/B20908_14_19.jpg" alt="Figure 14.19 – Reviewing the package files"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.19 – Reviewing the package files</p>
			<p>Now, let’s look at the steps to sideload the application:</p>
			<ol>
				<li>To install this package on another Windows device, start by copying the <code>Project</code><code> Tracker_1.0.0.0_x64.msix</code> file to the machine. This file contains all of the necessary information and files to install the application.</li>
				<li>Then, we need <a id="_idIndexMarker1082"/>to install the self-signed certificate used to sign the package. You can install it by running the <code>Install.ps1</code> <strong class="bold">PowerShell</strong> script, but <a id="_idIndexMarker1083"/>you can also install it at the time it was created if you are installing it on the same machine. We will install it by right-clicking the MSIX file and selecting <strong class="bold">Properties</strong>.</li>
				<li>Click the <strong class="bold">Digital Signatures</strong> tab, and select the certificate in th<a id="_idTextAnchor732"/>e <strong class="bold">Signature list</strong> box, as illustrated in the following screenshot:</li>
			</ol>
			<div><div><img src="img/B20908_14_20.jpg" alt="Figure 14.20 – Selecting the﻿ certificate in the MSIX package properties"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.20 – Selecting the<a id="_idTextAnchor733"/> certificate in the MSIX package properties</p>
			<ol>
				<li value="4">Click <strong class="bold">Details</strong> to open the <strong class="bold">Digital Signature </strong><strong class="bold">Details</strong> screen.</li>
				<li>Click <a id="_idIndexMarker1084"/>the <strong class="bold">View Certificate</strong> button. On the <strong class="bold">Certificate</strong> page that opens, click <strong class="bold">Install Certificate</strong>.</li>
				<li>When completing <strong class="bold">Certificate Import Wizard</strong>, import the certificate to the local machine, and on the <strong class="bold">Certificate Store</strong> page, select <strong class="bold">Place all certificates in<a id="_idTextAnchor734"/> the following store</strong>, as illustrated in the following screenshot:</li>
			</ol>
			<div><div><img src="img/B20908_14_21.jpg" alt="Figure 14.21 – Importing the package certificate"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.21 – Importing the package certificate</p>
			<ol>
				<li value="7">Click <strong class="bold">Browse</strong>, and <a id="_idIndexMarker1085"/>select <a id="_idTextAnchor735"/>the <strong class="bold">Trusted Root Certification Authorities</strong> folder. Click <strong class="bold">OK</strong> on the dialog and click <strong class="bold">Next</strong> on the wizard.</li>
				<li>After clicking <strong class="bold">Finish</strong>, the certificate will be imported. If all goes well, you will receive a message that the certificate was successfully imported. You can close the <strong class="bold">Properties</strong> page and continue with the package installation.</li>
				<li>Now, double-click <a id="_idIndexMarker1086"/>the <code>MSIX</code> package file. The installer will open a window with some of the application’s manifest information. Click <strong class="bold">Install</strong>, and leave the <strong class="bold">Launch when re<a id="_idTextAnchor736"/>ady</strong> checkbox selected, as illustrated in the following screenshot:</li>
			</ol>
			<div><div><img src="img/B20908_14_22.jpg" alt="Figure 14.22 – Installing a trusted application from its MSIX package"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.22 – Installing a trusted application from its MSIX package</p>
			<p>The application will install and launch, and you’re ready to go. Note that the package is trusted because we imported the certificate to the <strong class="bold">Trusted Root Certification </strong><strong class="bold">Authorities</strong> folder.</p>
			<p>This insta<a id="_idTextAnchor737"/>llation can be automated<a id="_idTextAnchor738"/> with PowerShell if the MSIX certificate is already trusted on the target machines. Use the <code>Add-AppPackage</code> command to install an MSIX package or MSIX bundle from a PowerShell prompt, as illustrated in the following command:</p>
			<pre class="console">
Add-AppPackage -path c:\Installers\ProjectTracker\ProjectTracker_1.0.0.0_x64.msix</pre>			<p>If you have several packages to distribute, you can create a custom PowerShell script to iterate over all of the <a id="_idIndexMarker1087"/>MSIX packages in a given folder. For more information about PowerShell scripting with MSIX, check out the following Microsoft Learn topic: <a href="https://learn.microsoft.com/windows/msix/desktop/powershell-msix-cmdlets">https://learn.microsoft.com/windows/msix/desktop/powershell-msix-cmdlets</a>.</p>
			<p>Let’s wrap up and review what we have learned in this chapter.</p>
			<h1 id="_idParaDest-284"><a id="_idTextAnchor741"/>Summary</h1>
			<p>In this chapter, we reviewed various methods of delivering WinUI applications to consumers. We learned the basics of MSIX packages and how to create packages to sideload our applications. We also covered the process of creating an account on Microsoft Partner Center to create application submissions on the Microsoft Store.</p>
			<p>Then, we validated and submitted an MSIX application package to the Store. Finally, we learned how to manually sideload MSIX packages and how PowerShell can be leveraged to automate the sideloading process. These concepts will help you when you are ready to create your own WinUI applications for enterprise or consumer use.</p>
			<p>This is the final chapter of our book. I hope that the concepts covered in each chapter will help<a id="_idTextAnchor742"/><a id="_idTextAnchor743"/> you succeed in your quest to become a WinUI application developer.</p>
			<h1 id="_idParaDest-285"><a id="_idTextAnchor744"/>Questions</h1>
			<ol>
				<li>What are some of the application installer formats that preceded MSIX?</li>
				<li>Is MSIX only for UWP and WinUI apps?</li>
				<li>In a WinUI project, which file contains the application manifest data?</li>
				<li>Which command is used to install packages with Windows Package Manager?</li>
				<li>How can you make your application available with WinGet?</li>
				<li>What is the name of the online portal to submit applications to the Microsoft Store?</li>
				<li>How many screenshots are required in a Microsoft Store listing?</li>
			</ol>
		</div>
	</body></html>