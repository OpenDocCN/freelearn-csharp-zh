<html><head></head><body>
<div id="_idContainer202">
<h1 class="chapter-number" id="_idParaDest-175"><a id="_idTextAnchor895"/><span class="koboSpan" id="kobo.1.1">11</span></h1>
<h1 id="_idParaDest-176"><a id="_idTextAnchor896"/><span class="koboSpan" id="kobo.2.1">Building a Calculator Using .NET MAUI Blazor</span></h1>
<p><span class="koboSpan" id="kobo.3.1">In this chapter, we will explore a .NET </span><strong class="bold"><span class="koboSpan" id="kobo.4.1">Blazor</span></strong><span class="koboSpan" id="kobo.5.1"> app embedded within a .NET MAUI app. </span><span class="koboSpan" id="kobo.5.2">We will write part of the calculator app using Blazor and host that in .NET MAUI using </span><strong class="source-inline"><span class="koboSpan" id="kobo.6.1">BlazorWebView</span></strong><span class="koboSpan" id="kobo.7.1">. </span><span class="koboSpan" id="kobo.7.2">We will also communicate between Blazor and .</span><span class="No-Break"><span class="koboSpan" id="kobo.8.1">NET MAUI.</span></span></p>
<p><span class="koboSpan" id="kobo.9.1">In this chapter, we are going to cover the </span><span class="No-Break"><span class="koboSpan" id="kobo.10.1">following topics:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.11.1">What </span><span class="No-Break"><span class="koboSpan" id="kobo.12.1">is Blazor?</span></span></li>
<li><span class="koboSpan" id="kobo.13.1">Exploring the differences between .NET MAUI projects and .NET MAUI </span><span class="No-Break"><span class="koboSpan" id="kobo.14.1">Blazor projects</span></span></li>
<li><span class="koboSpan" id="kobo.15.1">Using HTML and CSS to define </span><span class="No-Break"><span class="koboSpan" id="kobo.16.1">a UI</span></span></li>
<li><span class="koboSpan" id="kobo.17.1">Using XAML controls with HTML in </span><span class="No-Break"><span class="koboSpan" id="kobo.18.1">a WebView</span></span></li>
<li><span class="koboSpan" id="kobo.19.1">Writing C# code that will integrate with XAML controls and </span><span class="No-Break"><span class="koboSpan" id="kobo.20.1">HTML controls</span></span></li>
<li><span class="koboSpan" id="kobo.21.1">Working with the main .NET MAUI window to resize it to </span><span class="No-Break"><span class="koboSpan" id="kobo.22.1">its contents</span></span></li>
</ul>
<h1 id="_idParaDest-177"><a id="_idTextAnchor897"/><span class="koboSpan" id="kobo.23.1">Technical requirements</span></h1>
<p><span class="koboSpan" id="kobo.24.1">You will need to have Visual Studio for Mac or PC installed, as well as the .NET MAUI components. </span><span class="koboSpan" id="kobo.24.2">See </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.25.1">Chapter 1</span></em></span><span class="koboSpan" id="kobo.26.1">, </span><em class="italic"><span class="koboSpan" id="kobo.27.1">Introduction to .NET MAUI</span></em><span class="koboSpan" id="kobo.28.1">, for more details on how to set up your environment. </span><span class="koboSpan" id="kobo.28.2">The source code for this chapter is available in this bookâ€™s GitHub </span><span class="No-Break"><span class="koboSpan" id="kobo.29.1">repository: </span></span><a href="https://github.com/"><span class="No-Break"><span class="koboSpan" id="kobo.30.1">https://github.com/</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.31.1">PacktPublishing/MAUI-Projects-3rd-Edition</span></span><span class="No-Break"><span class="koboSpan" id="kobo.32.1">.</span></span></p>
<h1 id="_idParaDest-178"><a id="_idTextAnchor898"/><span class="koboSpan" id="kobo.33.1">Project overview</span></h1>
<p><span class="koboSpan" id="kobo.34.1">In this chapter, you</span><a id="_idIndexMarker1183"/><span class="koboSpan" id="kobo.35.1"> will discover .NET Blazor and how to use it with .NET MAUI to develop a UI for an app. </span><span class="koboSpan" id="kobo.35.2">We will explore the different options available for hosting a Blazor app within a .NET MAUI app. </span><span class="koboSpan" id="kobo.35.3">Communication between the two apps is a crucial part of the interoperability and this chapterâ€™s project will </span><a id="_idIndexMarker1184"/><span class="koboSpan" id="kobo.36.1">show you how to send data from .NET MAUI to Blazor and </span><span class="No-Break"><span class="koboSpan" id="kobo.37.1">vice versa.</span></span></p>
<h1 id="_idParaDest-179"><a id="_idTextAnchor899"/><span class="koboSpan" id="kobo.38.1">What is Blazor?</span></h1>
<p><span class="koboSpan" id="kobo.39.1">.NET Blazor is a </span><a id="_idIndexMarker1185"/><span class="koboSpan" id="kobo.40.1">web framework built on top of .NET. </span><span class="koboSpan" id="kobo.40.2">Blazor applications run in the browser by</span><a id="_idIndexMarker1186"/><span class="koboSpan" id="kobo.41.1"> using </span><strong class="bold"><span class="koboSpan" id="kobo.42.1">WebAssembly</span></strong><span class="koboSpan" id="kobo.43.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.44.1">WASM</span></strong><span class="koboSpan" id="kobo.45.1">), or on a server using SignalR. </span><span class="koboSpan" id="kobo.45.2">Blazor is one part of the whole ASP.NET ecosystem, and it leverages Razor pages for developing the UI. </span><span class="koboSpan" id="kobo.45.3">Blazor uses HTML and CSS to render a rich UI. </span><span class="koboSpan" id="kobo.45.4">Blazor uses a component-based UI, where each component is a Razor markup page. </span><span class="koboSpan" id="kobo.45.5">Within a Razor page, you can mix and match HTML, CSS, and C# code. </span><span class="koboSpan" id="kobo.45.6">There are three deployment models for a </span><span class="No-Break"><span class="koboSpan" id="kobo.46.1">Blazor app:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.47.1">Blazor Server</span></strong><span class="koboSpan" id="kobo.48.1">: In a Blazor</span><a id="_idIndexMarker1187"/><span class="koboSpan" id="kobo.49.1"> Server deployment, the </span><a id="_idIndexMarker1188"/><span class="koboSpan" id="kobo.50.1">application code runs on the server in an ASP.NET Core app, and it communicates with the UI running in a browser </span><span class="No-Break"><span class="koboSpan" id="kobo.51.1">via SignalR.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.52.1">Blazor WebAssembly</span></strong><span class="koboSpan" id="kobo.53.1">: For Blazor</span><a id="_idIndexMarker1189"/><span class="koboSpan" id="kobo.54.1"> WebAssembly, the entire app runs in the browser via WASM. </span><span class="koboSpan" id="kobo.54.2">It is an open web standard that makes it possible to run .NET code safely in the browser. </span><span class="koboSpan" id="kobo.54.3">WASM provides interoperability </span><span class="No-Break"><span class="koboSpan" id="kobo.55.1">with JavaScript.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.56.1">Blazor Hybrid</span></strong><span class="koboSpan" id="kobo.57.1">: Blazor Hybrid is a</span><a id="_idIndexMarker1190"/><span class="koboSpan" id="kobo.58.1"> blend of native .NET and</span><a id="_idIndexMarker1191"/><span class="koboSpan" id="kobo.59.1"> web technologies. </span><span class="koboSpan" id="kobo.59.2">Blazor Hybrid apps can be hosted in .NET MAUI, </span><strong class="bold"><span class="koboSpan" id="kobo.60.1">WPF</span></strong><span class="koboSpan" id="kobo.61.1">, and </span><strong class="bold"><span class="koboSpan" id="kobo.62.1">Windows Forms</span></strong><span class="koboSpan" id="kobo.63.1"> applications. </span><span class="koboSpan" id="kobo.63.2">Since the hosts are all .NET, the Blazor runtime runs natively within the same .NET process and renders the Razor page web UI into a </span><span class="No-Break"><span class="koboSpan" id="kobo.64.1">WebView control.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.65.1">Now that we have some general knowledge of Blazor, letâ€™s look at the app we will build in </span><span class="No-Break"><span class="koboSpan" id="kobo.66.1">this chapter!</span></span></p>
<h1 id="_idParaDest-180"><a id="_idTextAnchor900"/><span class="koboSpan" id="kobo.67.1">Creating the calculator app</span></h1>
<p><span class="koboSpan" id="kobo.68.1">In this chapter, we are</span><a id="_idIndexMarker1192"/><span class="koboSpan" id="kobo.69.1"> going to build a calculator app. </span><span class="koboSpan" id="kobo.69.2">The UI for the calculator is built using Razor pages in Blazor, but the actual mechanics of the calculator reside in the .NET </span><span class="No-Break"><span class="koboSpan" id="kobo.70.1">MAUI app.</span></span></p>
<h2 id="_idParaDest-181"><a id="_idTextAnchor901"/><span class="koboSpan" id="kobo.71.1">Setting up the project</span></h2>
<p><span class="koboSpan" id="kobo.72.1">This project, like all the</span><a id="_idIndexMarker1193"/><span class="koboSpan" id="kobo.73.1"> rest, is a </span><strong class="bold"><span class="koboSpan" id="kobo.74.1">File</span></strong><span class="koboSpan" id="kobo.75.1"> | </span><strong class="bold"><span class="koboSpan" id="kobo.76.1">New</span></strong><span class="koboSpan" id="kobo.77.1"> | </span><strong class="bold"><span class="koboSpan" id="kobo.78.1">Project...</span></strong><span class="koboSpan" id="kobo.79.1">-style project. </span><span class="koboSpan" id="kobo.79.2">This means that we will not be importing any code at all. </span><span class="koboSpan" id="kobo.79.3">So, this first section is all about creating the project and setting up the basic </span><span class="No-Break"><span class="koboSpan" id="kobo.80.1">project </span><a id="_idTextAnchor902"/><a id="_idTextAnchor903"/><span class="koboSpan" id="kobo.81.1">structure.</span></span></p>
<h3><span class="koboSpan" id="kobo.82.1">Creating the n</span><a id="_idTextAnchor904"/><span class="koboSpan" id="kobo.83.1">ew project</span></h3>
<p><span class="koboSpan" id="kobo.84.1">The first step is to</span><a id="_idIndexMarker1194"/><span class="koboSpan" id="kobo.85.1"> create a new .NET MAUI project. </span><span class="koboSpan" id="kobo.85.2">Follow </span><span class="No-Break"><span class="koboSpan" id="kobo.86.1">these steps:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.87.1">Open Visual Studio 2022 and select </span><strong class="bold"><span class="koboSpan" id="kobo.88.1">Create a </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.89.1">new project</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.90.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer187">
<span class="koboSpan" id="kobo.91.1"><img alt="Figure 11.1 â€“ Visual ï»¿Studio 2022" src="image/B19214_11_1.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.92.1">Figure 11.1 â€“ Visual </span><a id="_idTextAnchor905"/><span class="koboSpan" id="kobo.93.1">Studio 2022</span></p>
<p class="list-inset"><span class="koboSpan" id="kobo.94.1">This will</span><a id="_idIndexMarker1195"/><span class="koboSpan" id="kobo.95.1"> open the </span><strong class="bold"><span class="koboSpan" id="kobo.96.1">Create a new </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.97.1">project</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.98.1"> wizard.</span></span></p>
<ol>
<li value="2"><span class="koboSpan" id="kobo.99.1">In the search field, type in </span><strong class="source-inline"><span class="koboSpan" id="kobo.100.1">blazor</span></strong><span class="koboSpan" id="kobo.101.1"> and select the </span><strong class="bold"><span class="koboSpan" id="kobo.102.1">.NET MAUI Blazor App</span></strong><span class="koboSpan" id="kobo.103.1"> item from </span><span class="No-Break"><span class="koboSpan" id="kobo.104.1">the list:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer188">
<span class="koboSpan" id="kobo.105.1"><img alt="Figure 11.2 â€“ Create a nï»¿ew project" src="image/B19214_11_2.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.106.1">Figure 11.2 â€“ Create a n</span><a id="_idTextAnchor906"/><span class="koboSpan" id="kobo.107.1">ew project</span></p>
<ol>
<li value="3"><span class="No-Break"><span class="koboSpan" id="kobo.108.1">Click </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.109.1">Next</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.110.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.111.1">Enter </span><strong class="source-inline"><span class="koboSpan" id="kobo.112.1">Calculator</span></strong><span class="koboSpan" id="kobo.113.1"> as the</span><a id="_idIndexMarker1196"/><span class="koboSpan" id="kobo.114.1"> name of the app, as shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.115.1">following screenshot:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer189">
<span class="koboSpan" id="kobo.116.1"><img alt="Figure 11.3 â€“ Configure your new project" src="image/B19214_11_3.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.117.1">Figure 11.3 â€“ Configure your new project</span></p>
<ol>
<li value="5"><span class="No-Break"><span class="koboSpan" id="kobo.118.1">Click </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.119.1">Next</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.120.1">.</span></span><p class="list-inset"><span class="koboSpan" id="kobo.121.1">The last step will </span><a id="_idIndexMarker1197"/><span class="koboSpan" id="kobo.122.1">prompt you for the version of .NET Core to </span><a id="_idIndexMarker1198"/><span class="koboSpan" id="kobo.123.1">support. </span><span class="koboSpan" id="kobo.123.2">At the time of writing, .NET 6 is available as </span><strong class="bold"><span class="koboSpan" id="kobo.124.1">Long-Term Support</span></strong><span class="koboSpan" id="kobo.125.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.126.1">LTS</span></strong><span class="koboSpan" id="kobo.127.1">), and .NET 7 is available</span><a id="_idIndexMarker1199"/><span class="koboSpan" id="kobo.128.1"> as </span><strong class="bold"><span class="koboSpan" id="kobo.129.1">Standard Term Support</span></strong><span class="koboSpan" id="kobo.130.1">. </span><span class="koboSpan" id="kobo.130.2">For this book, we will assume that you will be using .</span><span class="No-Break"><span class="koboSpan" id="kobo.131.1">NET 7:</span></span></p></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer190">
<span class="koboSpan" id="kobo.132.1"><img alt="Figure 11.4 â€“ Additional information" src="image/B19214_11_4.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.133.1">Figure 11.4 â€“ Additional information</span></p>
<ol>
<li value="6"><span class="koboSpan" id="kobo.134.1">Finalize the setup by clicking </span><strong class="bold"><span class="koboSpan" id="kobo.135.1">Create</span></strong><span class="koboSpan" id="kobo.136.1"> and wait for Visual Studio to create </span><span class="No-Break"><span class="koboSpan" id="kobo.137.1">the project.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.138.1">Thatâ€™s it fo</span><a id="_idIndexMarker1200"/><span class="koboSpan" id="kobo.139.1">r </span><span class="No-Break"><span class="koboSpan" id="kobo.140.1">proj</span><a id="_idTextAnchor907"/><a id="_idTextAnchor908"/><a id="_idTextAnchor909"/><span class="koboSpan" id="kobo.141.1">ect creation.</span></span></p>
<p><span class="koboSpan" id="kobo.142.1">Letâ€™s continue by reviewing the structure of </span><span class="No-Break"><span class="koboSpan" id="kobo.143.1">the app.</span></span></p>
<h3><span class="koboSpan" id="kobo.144.1">Exploring a .NET MAUI Blazor Hybrid project</span></h3>
<p><span class="koboSpan" id="kobo.145.1">If you run the </span><a id="_idIndexMarker1201"/><span class="koboSpan" id="kobo.146.1">project, you will see an </span><a id="_idIndexMarker1202"/><span class="koboSpan" id="kobo.147.1">app, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.148.1">Figure 11</span></em></span><em class="italic"><span class="koboSpan" id="kobo.149.1">.5</span></em><span class="koboSpan" id="kobo.150.1">. </span><span class="koboSpan" id="kobo.150.2">It does not resemble the .NET MAUI app template and has a distinctive web feel to it. </span><span class="koboSpan" id="kobo.150.3">Poke around the app a little bit to see how all the visual elements work together. </span><span class="koboSpan" id="kobo.150.4">Then, close the application, return to Visual Studio, and continue exploring </span><span class="No-Break"><span class="koboSpan" id="kobo.151.1">the project:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer191">
<span class="koboSpan" id="kobo.152.1"><img alt="Figure 11.5 â€“ Running the .NET MAUI Blazor template project" src="image/B19214_11_5.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.153.1">Figure 11.5 â€“ Running the .NET MAUI Blazor template project</span></p>
<p><span class="koboSpan" id="kobo.154.1">The structure of </span><a id="_idIndexMarker1203"/><span class="koboSpan" id="kobo.155.1">the .NET MAUI Blazor app is a mashup of a .NET MAUI app and a Blazor app. </span><span class="koboSpan" id="kobo.155.2">If you look at the </span><strong class="bold"><span class="koboSpan" id="kobo.156.1">Solution Explorer</span></strong><span class="koboSpan" id="kobo.157.1"> window, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.158.1">Figure 11</span></em></span><em class="italic"><span class="koboSpan" id="kobo.159.1">.6</span></em><span class="koboSpan" id="kobo.160.1">, you will see the </span><strong class="source-inline"><span class="koboSpan" id="kobo.161.1">Platforms</span></strong><span class="koboSpan" id="kobo.162.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.163.1">Resources</span></strong><span class="koboSpan" id="kobo.164.1"> folders and the </span><strong class="source-inline"><span class="koboSpan" id="kobo.165.1">App.xaml</span></strong><span class="koboSpan" id="kobo.166.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.167.1">MainPage.xaml</span></strong><span class="koboSpan" id="kobo.168.1">, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.169.1">MauiProgram.cs</span></strong><span class="koboSpan" id="kobo.170.1"> files that are normally present in the .NET MAUI template. </span><span class="koboSpan" id="kobo.170.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.171.1">wwwroot</span></strong><span class="koboSpan" id="kobo.172.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.173.1">Data</span></strong><span class="koboSpan" id="kobo.174.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.175.1">Pages</span></strong><span class="koboSpan" id="kobo.176.1">, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.177.1">Shared</span></strong><span class="koboSpan" id="kobo.178.1"> folders all support the Blazor app. </span><span class="koboSpan" id="kobo.178.2">Additionally, youâ€™ll find </span><strong class="source-inline"><span class="koboSpan" id="kobo.179.1">_Imports.razor</span></strong><span class="koboSpan" id="kobo.180.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.181.1">Main.razor</span></strong><span class="koboSpan" id="kobo.182.1"> at the root of </span><span class="No-Break"><span class="koboSpan" id="kobo.183.1">the project:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer192">
<span class="koboSpan" id="kobo.184.1"><img alt="Figure 11.6 â€“ Solution Explorer view of a .NET MAUI Blazor project" src="image/B19214_11_6.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.185.1">Figure 11.6 â€“ Solution Explorer view of a .NET MAUI Blazor project</span></p>
<p><span class="koboSpan" id="kobo.186.1">If you need a refresher on how a .NET MAUI app is structured and works, refer to </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.187.1">Chapter 1</span></em></span><span class="koboSpan" id="kobo.188.1">. </span><span class="koboSpan" id="kobo.188.2">Ignoring how a Blazor app works for the moment, letâ€™s take a look at how a Blazor app is hosted by .</span><span class="No-Break"><span class="koboSpan" id="kobo.189.1">NET MAUI.</span></span></p>
<p><span class="koboSpan" id="kobo.190.1">Since all .NET MAUI </span><a id="_idIndexMarker1204"/><span class="koboSpan" id="kobo.191.1">programs start with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.192.1">MauiProgram.cs</span></strong><span class="koboSpan" id="kobo.193.1"> file, that seems like a good place to start. </span><span class="koboSpan" id="kobo.193.2">Open the </span><strong class="source-inline"><span class="koboSpan" id="kobo.194.1">MauiProgram.cs</span></strong><span class="koboSpan" id="kobo.195.1"> file and inspect its contents. </span><span class="koboSpan" id="kobo.195.2">The following snippet highlights the differences for a .NET MAUI </span><span class="No-Break"><span class="koboSpan" id="kobo.196.1">Blazor app:</span></span></p>
<pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.197.1">builder.Services.AddMauiBlazorWebView();</span></strong><span class="koboSpan" id="kobo.198.1">
#if DEBUG
Â Â Â Â </span><strong class="bold"><span class="koboSpan" id="kobo.199.1">builder.Services.AddBlazorWebViewDeveloperTools();</span></strong><span class="koboSpan" id="kobo.200.1">
Â Â Â Â builder.Logging.AddDebug();
#endif</span></pre> <p><span class="koboSpan" id="kobo.201.1">The first highlighted line enables the hosting services for the Blazor app, specifically the WebView controller. </span><span class="koboSpan" id="kobo.201.2">The second highlighted line enables the developer tools (</span><em class="italic"><span class="koboSpan" id="kobo.202.1">F12</span></em><span class="koboSpan" id="kobo.203.1">) within the WebView control, but only in a </span><span class="No-Break"><span class="koboSpan" id="kobo.204.1">debug configuration.</span></span></p>
<p><strong class="source-inline"><span class="koboSpan" id="kobo.205.1">App.xaml</span></strong><span class="koboSpan" id="kobo.206.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.207.1">App.xaml.cs</span></strong><span class="koboSpan" id="kobo.208.1"> are essentially the same as in a .NET MAUI template project, but </span><strong class="source-inline"><span class="koboSpan" id="kobo.209.1">MainPage.xaml</span></strong><span class="koboSpan" id="kobo.210.1"> is not. </span><span class="koboSpan" id="kobo.210.2">Open </span><a id="_idIndexMarker1205"/><span class="koboSpan" id="kobo.211.1">the </span><strong class="source-inline"><span class="koboSpan" id="kobo.212.1">MainPage.xaml</span></strong><span class="koboSpan" id="kobo.213.1"> file to inspect its contents, as</span><a id="_idIndexMarker1206"/> <span class="No-Break"><span class="koboSpan" id="kobo.214.1">shown here:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.215.1">
&lt;?xml version="1.0" encoding="utf-8" ?&gt;
&lt;ContentPage
Â Â Â Â 
Â Â Â Â 
Â Â Â Â 
Â Â Â Â x:Class="Calculator.MainPage"
Â Â Â Â BackgroundColor="{DynamicResource PageBackgroundColor}"&gt;
</span><strong class="bold"><span class="koboSpan" id="kobo.216.1">Â Â Â Â &lt;BlazorWebView x:Name="blazorWebView" HostPage="wwwroot/index.html"&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.217.1">Â Â Â Â Â Â &lt;BlazorWebView.RootComponents&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.218.1">Â Â Â Â Â Â Â Â &lt;RootComponent Selector="#app" ComponentType="{x:Type local:Main}" /&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.219.1">Â Â Â Â Â Â &lt;/BlazorWebView.RootComponents&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.220.1">Â Â Â Â &lt;/BlazorWebView&gt;</span></strong><span class="koboSpan" id="kobo.221.1">
&lt;/ContentPage&gt;</span></pre> <p><strong class="source-inline"><span class="koboSpan" id="kobo.222.1">MainPage</span></strong><span class="koboSpan" id="kobo.223.1"> has a single control, </span><strong class="source-inline"><span class="koboSpan" id="kobo.224.1">BlazorWebView</span></strong><span class="koboSpan" id="kobo.225.1">. </span><span class="koboSpan" id="kobo.225.2">This is a wrapper around the native controls to host web pages in apps. </span><span class="koboSpan" id="kobo.225.3">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.226.1">HostPage</span></strong><span class="koboSpan" id="kobo.227.1"> attribute points to the starting page â€“ in this case, </span><strong class="source-inline"><span class="koboSpan" id="kobo.228.1">wwwroot/index.html</span></strong><span class="koboSpan" id="kobo.229.1">. </span><span class="koboSpan" id="kobo.229.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.230.1">BlazorWebView.RootComponents</span></strong><span class="koboSpan" id="kobo.231.1"> element identifies the starting points for the Blazor application and the location where they are hosted on the page. </span><span class="koboSpan" id="kobo.231.2">In this case, </span><strong class="source-inline"><span class="koboSpan" id="kobo.232.1">RootComponent</span></strong> <strong class="source-inline"><span class="koboSpan" id="kobo.233.1">Main</span></strong><span class="koboSpan" id="kobo.234.1"> is rooted in the element with an ID </span><span class="No-Break"><span class="koboSpan" id="kobo.235.1">of </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.236.1">app</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.237.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.238.1">To see where the </span><strong class="source-inline"><span class="koboSpan" id="kobo.239.1">app</span></strong><span class="koboSpan" id="kobo.240.1"> element is located, open the </span><strong class="source-inline"><span class="koboSpan" id="kobo.241.1">index.html</span></strong><span class="koboSpan" id="kobo.242.1"> file in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.243.1">wwwroot</span></strong><span class="koboSpan" id="kobo.244.1"> folder and</span><a id="_idIndexMarker1207"/><span class="koboSpan" id="kobo.245.1"> inspect its contents, as </span><a id="_idIndexMarker1208"/><span class="No-Break"><span class="koboSpan" id="kobo.246.1">shown here:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.247.1">
&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
Â Â &lt;meta charset="utf-8" /&gt;
Â Â &lt;meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" /&gt;
Â Â &lt;title&gt;Calculator&lt;/title&gt;
Â Â &lt;base href="/" /&gt;
Â Â &lt;link rel="stylesheet" href="css/bootstrap/bootstrap.min.css" /&gt;
Â Â </span><strong class="bold"><span class="koboSpan" id="kobo.248.1">&lt;link href="css/app.css" rel="stylesheet" /&gt;</span></strong><span class="koboSpan" id="kobo.249.1">
Â Â </span><strong class="bold"><span class="koboSpan" id="kobo.250.1">&lt;link href="Calculator.styles.css" rel="stylesheet" /&gt;</span></strong><span class="koboSpan" id="kobo.251.1">
&lt;/head&gt;
&lt;body&gt;
Â Â &lt;div class="status-bar-safe-area"&gt;&lt;/div&gt;
Â Â </span><strong class="bold"><span class="koboSpan" id="kobo.252.1">&lt;div id="app"&gt;Loading...&lt;/div&gt;</span></strong><span class="koboSpan" id="kobo.253.1">
Â Â &lt;div id="blazor-error-ui"&gt;
Â Â Â Â An unhandled error has occurred.
</span><span class="koboSpan" id="kobo.253.2">Â Â Â Â &lt;a href="" class="reload"&gt;Reload&lt;/a&gt;
Â Â Â Â &lt;a class="dismiss"&gt;ðŸ—™&lt;/a&gt;
Â Â &lt;/div&gt;
Â Â </span><strong class="bold"><span class="koboSpan" id="kobo.254.1">&lt;script src="_framework/blazor.webview.js" autostart="false"&gt;&lt;/script&gt;</span></strong><span class="koboSpan" id="kobo.255.1">
&lt;/body&gt;
&lt;/html&gt;</span></pre> <p><span class="koboSpan" id="kobo.256.1">The key parts of the file are highlighted in the preceding code. </span><span class="koboSpan" id="kobo.256.2">First, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.257.1">div</span></strong><span class="koboSpan" id="kobo.258.1"> element with </span><strong class="source-inline"><span class="koboSpan" id="kobo.259.1">id</span></strong><span class="koboSpan" id="kobo.260.1"> set to </span><strong class="source-inline"><span class="koboSpan" id="kobo.261.1">app</span></strong><span class="koboSpan" id="kobo.262.1"> is where the </span><strong class="source-inline"><span class="koboSpan" id="kobo.263.1">Main</span></strong><span class="koboSpan" id="kobo.264.1"> component is rooted, or loaded. </span><span class="koboSpan" id="kobo.264.2">In the header of the page, the stylesheets are identified. </span><span class="koboSpan" id="kobo.264.3">The first stylesheet, </span><strong class="source-inline"><span class="koboSpan" id="kobo.265.1">app.css</span></strong><span class="koboSpan" id="kobo.266.1">, is located in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.267.1">wwwroot/css</span></strong><span class="koboSpan" id="kobo.268.1"> folder of the project. </span><span class="koboSpan" id="kobo.268.2">The second stylesheet, </span><strong class="source-inline"><span class="koboSpan" id="kobo.269.1">Calculator.Styles.css</span></strong><span class="koboSpan" id="kobo.270.1">, is created during the build process from isolated CSS files. </span><strong class="bold"><span class="koboSpan" id="kobo.271.1">Isolated CSS</span></strong><span class="koboSpan" id="kobo.272.1"> is a</span><a id="_idIndexMarker1209"/><span class="koboSpan" id="kobo.273.1"> feature of ASP.NET that allows you to create your styles close to the elements that use them. </span><span class="koboSpan" id="kobo.273.2">They are isolated from other components, so they wonâ€™t inadvertently bleed into other parts of your application. </span><span class="koboSpan" id="kobo.273.3">Finally, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.274.1">_framework/blazor.webview.js</span></strong><span class="koboSpan" id="kobo.275.1"> file is imported and is responsible for doing all the heavy lifting of getting your Blazor components rendered at the right location on </span><span class="No-Break"><span class="koboSpan" id="kobo.276.1">the page.</span></span></p>
<p><span class="koboSpan" id="kobo.277.1">The final piece for us to review before we move on to creating the rest of the application is the Blazor components. </span><strong class="source-inline"><span class="koboSpan" id="kobo.278.1">Main.razor</span></strong><span class="koboSpan" id="kobo.279.1"> is a routing file that directs the Blazor runtime to the </span><a id="_idIndexMarker1210"/><span class="koboSpan" id="kobo.280.1">starting</span><a id="_idIndexMarker1211"/><span class="koboSpan" id="kobo.281.1"> component, </span><strong class="source-inline"><span class="koboSpan" id="kobo.282.1">MainLayout.razor</span></strong><span class="koboSpan" id="kobo.283.1">, as shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.284.1">following code:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.285.1">
&lt;Router AppAssembly="@typeof(Main).Assembly"&gt;
Â Â &lt;Found Context="routeData"&gt;
Â Â Â Â </span><strong class="bold"><span class="koboSpan" id="kobo.286.1">&lt;RouteView RouteData="@routeData" DefaultLayout="@typeof(MainLayout)" /&gt;</span></strong><span class="koboSpan" id="kobo.287.1">
Â Â Â Â &lt;FocusOnNavigate RouteData="@routeData" Selector="h1" /&gt;
Â Â &lt;/Found&gt;
Â Â &lt;NotFound&gt;
Â Â Â Â &lt;LayoutView Layout="@typeof(MainLayout)"&gt;
Â Â Â Â Â Â &lt;p role="alert"&gt;Sorry, there's nothing at this address.&lt;/p&gt;
Â Â Â Â &lt;/LayoutView&gt;
Â Â &lt;/NotFound&gt;
&lt;/Router&gt;</span></pre> <p><span class="koboSpan" id="kobo.288.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.289.1">MainLayout.razor</span></strong><span class="koboSpan" id="kobo.290.1"> file defines the basic layout of the page, with a navigation bar on the left, and the main body consuming the remainder of the page, as shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.291.1">following code:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.292.1">
@inherits LayoutComponentBase
&lt;div class="page"&gt;
Â Â &lt;div class="sidebar"&gt;
Â Â Â Â </span><strong class="bold"><span class="koboSpan" id="kobo.293.1">&lt;NavMenu /&gt;</span></strong><span class="koboSpan" id="kobo.294.1">
Â Â &lt;/div&gt;
Â Â &lt;main&gt;
Â Â Â Â &lt;div class="top-row px-4"&gt;
Â Â Â Â Â Â &lt;a href="https://docs.microsoft.com/aspnet/" target="_blank"&gt;About&lt;/a&gt;
Â Â Â Â &lt;/div&gt;
Â Â Â Â &lt;article class="content px-4"&gt;
Â Â Â Â Â Â </span><strong class="bold"><span class="koboSpan" id="kobo.295.1">@Body</span></strong><span class="koboSpan" id="kobo.296.1">
Â Â Â Â &lt;/article&gt;
Â Â &lt;/main&gt;
&lt;/div&gt;</span></pre> <p><span class="koboSpan" id="kobo.297.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.298.1">@Body</span></strong><span class="koboSpan" id="kobo.299.1"> content is provided </span><a id="_idIndexMarker1212"/><span class="koboSpan" id="kobo.300.1">by the </span><a id="_idIndexMarker1213"/><span class="koboSpan" id="kobo.301.1">page that satisfies the route. </span><span class="koboSpan" id="kobo.301.2">For the first page, that would be </span><strong class="source-inline"><span class="koboSpan" id="kobo.302.1">/</span></strong><span class="koboSpan" id="kobo.303.1">. </span><span class="koboSpan" id="kobo.303.2">If you look at the files in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.304.1">Pages</span></strong><span class="koboSpan" id="kobo.305.1"> folder, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.306.1">Index.razor</span></strong><span class="koboSpan" id="kobo.307.1"> file has a </span><strong class="source-inline"><span class="koboSpan" id="kobo.308.1">@page</span></strong><span class="koboSpan" id="kobo.309.1"> directive with an argument of </span><strong class="source-inline"><span class="koboSpan" id="kobo.310.1">/</span></strong><span class="koboSpan" id="kobo.311.1">. </span><span class="koboSpan" id="kobo.311.2">So, by default, that is the page that would be displayed. </span><span class="koboSpan" id="kobo.311.3">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.312.1">@page</span></strong><span class="koboSpan" id="kobo.313.1"> directive is a Razor construct that allows the route to be satisfied without using a controller. </span><span class="koboSpan" id="kobo.313.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.314.1">NavLink</span></strong><span class="koboSpan" id="kobo.315.1"> entries in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.316.1">Shared/NavMenu.razor</span></strong><span class="koboSpan" id="kobo.317.1"> file reference the route using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.318.1">href</span></strong><span class="koboSpan" id="kobo.319.1"> attribute. </span><span class="koboSpan" id="kobo.319.2">That value is looked up in the list of </span><strong class="source-inline"><span class="koboSpan" id="kobo.320.1">@page</span></strong><span class="koboSpan" id="kobo.321.1"> directives to find a match. </span><span class="koboSpan" id="kobo.321.2">If no match is found, then the content in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.322.1">&lt;NotFound&gt;</span></strong><span class="koboSpan" id="kobo.323.1"> element in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.324.1">Main.razor</span></strong><span class="koboSpan" id="kobo.325.1"> file </span><span class="No-Break"><span class="koboSpan" id="kobo.326.1">is rendered.</span></span></p>
<p><span class="koboSpan" id="kobo.327.1">Open the </span><strong class="source-inline"><span class="koboSpan" id="kobo.328.1">Pages/Counter.razor</span></strong><span class="koboSpan" id="kobo.329.1"> page to see how a Razor </span><span class="No-Break"><span class="koboSpan" id="kobo.330.1">page works:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.331.1">
@page "/counter"
&lt;h1&gt;Counter&lt;/h1&gt;
&lt;p role="status"&gt;Current count: @currentCount&lt;/p&gt;
&lt;button class="btn btn-primary" @onclick="IncrementCount"&gt;Click me&lt;/button&gt;
@code {
Â Â Â Â private int currentCount = 0;
Â Â Â Â private void IncrementCount()
Â Â Â Â {
Â Â Â Â Â Â currentCount++;
Â Â Â Â }
}</span></pre> <p><span class="koboSpan" id="kobo.332.1">After the </span><strong class="source-inline"><span class="koboSpan" id="kobo.333.1">@page</span></strong><span class="koboSpan" id="kobo.334.1"> directive, the page is made up of HTML mixed with some Razor directives. </span><span class="koboSpan" id="kobo.334.2">Then, thereâ€™s the </span><strong class="source-inline"><span class="koboSpan" id="kobo.335.1">@code</span></strong><span class="koboSpan" id="kobo.336.1"> directive, which contains the C# code for the page. </span><span class="koboSpan" id="kobo.336.2">The HTML </span><strong class="source-inline"><span class="koboSpan" id="kobo.337.1">button</span></strong><span class="koboSpan" id="kobo.338.1"> element has its click event mapped to the C# </span><strong class="source-inline"><span class="koboSpan" id="kobo.339.1">IncrementCount</span></strong><span class="koboSpan" id="kobo.340.1"> method</span><a id="_idIndexMarker1214"/><span class="koboSpan" id="kobo.341.1"> using </span><a id="_idIndexMarker1215"/><span class="koboSpan" id="kobo.342.1">the </span><strong class="source-inline"><span class="koboSpan" id="kobo.343.1">@</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.344.1">onclick</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.345.1"> directive.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.346.1">Learn more</span></p>
<p class="callout"><span class="koboSpan" id="kobo.347.1">To learn more about Razor pages, take a look at the official documentation </span><span class="No-Break"><span class="koboSpan" id="kobo.348.1">at </span></span><a href="https://learn.microsoft.com/en-us/aspnet/core/blazor/?view=aspnetcore-7.0"><span class="No-Break"><span class="koboSpan" id="kobo.349.1">https://learn.microsoft.com/en-us/aspnet/core/blazor/?view=aspnetcore-7.0</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.350.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.351.1">Now, letâ€™s start creating </span><span class="No-Break"><span class="koboSpan" id="kobo.352.1">the project.</span></span></p>
<h3><span class="koboSpan" id="kobo.353.1">Preparing the project</span></h3>
<p><span class="koboSpan" id="kobo.354.1">.NET MAUI and Blazor </span><a id="_idIndexMarker1216"/><span class="koboSpan" id="kobo.355.1">integrate seamlessly â€“ so seamlessly that it is sometimes hard to differentiate what is executing where. </span><span class="koboSpan" id="kobo.355.2">That makes it very easy to render data in both XAML </span><span class="No-Break"><span class="koboSpan" id="kobo.356.1">and HTML.</span></span></p>
<p><span class="koboSpan" id="kobo.357.1">Letâ€™s get started by preparing the project for the calculator. </span><span class="koboSpan" id="kobo.357.2">We will start by removing much of the template code we wonâ€™t be using. </span><span class="koboSpan" id="kobo.357.3">Follow these steps to prepare </span><span class="No-Break"><span class="koboSpan" id="kobo.358.1">the template:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.359.1">In Visual Studio, using </span><strong class="bold"><span class="koboSpan" id="kobo.360.1">Solution Explorer</span></strong><span class="koboSpan" id="kobo.361.1">, delete the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.362.1">Data</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.363.1"> folder.</span></span></li>
<li><span class="koboSpan" id="kobo.364.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.365.1">Pages</span></strong><span class="koboSpan" id="kobo.366.1"> folder, delete </span><strong class="source-inline"><span class="koboSpan" id="kobo.367.1">Index.razor</span></strong><span class="koboSpan" id="kobo.368.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.369.1">Counter.Razor</span></strong><span class="koboSpan" id="kobo.370.1">, </span><span class="No-Break"><span class="koboSpan" id="kobo.371.1">and </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.372.1">FetchData.razor</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.373.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.374.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.375.1">Shared</span></strong><span class="koboSpan" id="kobo.376.1"> folder, delete </span><strong class="source-inline"><span class="koboSpan" id="kobo.377.1">NavMenu.razor</span></strong><span class="koboSpan" id="kobo.378.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.379.1">NavMenu.razor.css</span></strong><span class="koboSpan" id="kobo.380.1">, </span><span class="No-Break"><span class="koboSpan" id="kobo.381.1">and </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.382.1">SurveyPrompt.razor</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.383.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.384.1">Right-click on the </span><strong class="source-inline"><span class="koboSpan" id="kobo.385.1">Pages</span></strong><span class="koboSpan" id="kobo.386.1"> folder, then select </span><strong class="bold"><span class="koboSpan" id="kobo.387.1">Add</span></strong><span class="koboSpan" id="kobo.388.1"> |</span><strong class="bold"><span class="koboSpan" id="kobo.389.1"> Razor Componentâ€¦</span></strong><span class="koboSpan" id="kobo.390.1">, as shown in the </span><a id="_idIndexMarker1217"/><span class="No-Break"><span class="koboSpan" id="kobo.391.1">following screenshot:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer193">
<span class="koboSpan" id="kobo.392.1"><img alt="Figure 11.7 â€“ Adding a new Razor component" src="image/B19214_11_7.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.393.1">Figure 11.7 â€“ Adding a new Razor component</span></p>
<ol>
<li value="5"><span class="koboSpan" id="kobo.394.1">In the </span><strong class="bold"><span class="koboSpan" id="kobo.395.1">Add New Item</span></strong><span class="koboSpan" id="kobo.396.1"> dialog, name the component </span><strong class="source-inline"><span class="koboSpan" id="kobo.397.1">Keypad.razor</span></strong><span class="koboSpan" id="kobo.398.1"> and </span><span class="No-Break"><span class="koboSpan" id="kobo.399.1">click </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.400.1">Add</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.401.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer194">
<span class="koboSpan" id="kobo.402.1"><img alt="Figure 11.8 â€“ Razor ï»¿component" src="image/B19214_11_8.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.403.1">Figure 11.8 â€“ Razor component</span></p>
<ol>
<li value="6"><span class="koboSpan" id="kobo.404.1">In the</span><a id="_idIndexMarker1218"/><span class="koboSpan" id="kobo.405.1"> new </span><strong class="source-inline"><span class="koboSpan" id="kobo.406.1">Keypad.razor</span></strong><span class="koboSpan" id="kobo.407.1"> file, add the following </span><span class="No-Break"><span class="koboSpan" id="kobo.408.1">highlighted lines:</span></span><pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.409.1">@page "/"</span></strong><span class="koboSpan" id="kobo.410.1">
&lt;h3&gt;Keypad&lt;/h3&gt;
</span><strong class="bold"><span class="koboSpan" id="kobo.411.1">&lt;div&gt;Keypad goes here&lt;/div&gt;</span></strong><span class="koboSpan" id="kobo.412.1">
@code {
}</span></pre></li> <li><span class="koboSpan" id="kobo.413.1">Open the </span><strong class="source-inline"><span class="koboSpan" id="kobo.414.1">MainLayout.razor</span></strong><span class="koboSpan" id="kobo.415.1"> file in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.416.1">Shared</span></strong><span class="koboSpan" id="kobo.417.1"> folder and remove the following </span><span class="No-Break"><span class="koboSpan" id="kobo.418.1">highlighted sections:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.419.1">
@inherits LayoutComponentBase
&lt;div class="page"&gt;
</span><strong class="bold"><span class="koboSpan" id="kobo.420.1">Â Â Â Â &lt;div class="sidebar"&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.421.1">Â Â Â Â Â Â &lt;NavMenu /&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.422.1">Â Â Â Â &lt;/div&gt;</span></strong><span class="koboSpan" id="kobo.423.1">
Â Â Â Â &lt;main&gt;
</span><strong class="bold"><span class="koboSpan" id="kobo.424.1">Â Â Â Â Â Â &lt;div class="top-row px-4"&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.425.1">Â Â Â Â Â Â Â Â &lt;a href="https://docs.microsoft.com/aspnet/" target="_blank"&gt;About&lt;/a&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.426.1">Â Â Â Â Â Â &lt;/div&gt;</span></strong><span class="koboSpan" id="kobo.427.1">
Â Â Â Â Â Â &lt;article class="content px-4"&gt;
Â Â Â Â Â Â Â Â @Body
Â Â Â Â Â Â &lt;/article&gt;
Â Â Â Â &lt;/main&gt;
&lt;/div&gt;</span></pre></li> <li><span class="koboSpan" id="kobo.428.1">Open </span><strong class="source-inline"><span class="koboSpan" id="kobo.429.1">MauiProgram.cs</span></strong><span class="koboSpan" id="kobo.430.1"> and </span><a id="_idIndexMarker1219"/><span class="koboSpan" id="kobo.431.1">remove the highlighted lines </span><span class="No-Break"><span class="koboSpan" id="kobo.432.1">of code:</span></span><pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.433.1">using Calculator.Data;</span></strong><span class="koboSpan" id="kobo.434.1">
using Microsoft.Extensions.Logging;
namespace Calculator
{
Â Â Â Â public static class MauiProgram
Â Â Â Â {
Â Â Â Â Â Â public static MauiApp CreateMauiApp()
Â Â Â Â Â Â {
Â Â Â Â Â Â Â Â var builder = MauiApp.CreateBuilder();
Â Â Â Â Â Â Â Â builder
Â Â Â Â Â Â Â Â Â Â .UseMauiApp&lt;App&gt;()
Â Â Â Â Â Â Â Â Â Â .ConfigureFonts(fonts =&gt;
Â Â Â Â Â Â Â Â Â Â {
Â Â Â Â Â Â Â Â Â Â Â Â fonts.AddFont("OpenSans-Regular.ttf", "OpenSansRegular");
Â Â Â Â Â Â Â Â Â Â });
Â Â Â Â Â Â Â Â builder.Services.AddMauiBlazorWebView();
#if DEBUG
Â Â Â Â Â Â builder.Services.AddBlazorWebViewDeveloperTools();
Â Â Â Â Â Â builder.Logging.AddDebug();
#endif
</span><strong class="bold"><span class="koboSpan" id="kobo.435.1">Â Â Â Â Â Â builder.Services.AddSingleton&lt;WeatherForecastService&gt;();</span></strong><span class="koboSpan" id="kobo.436.1">
Â Â Â Â Â Â return builder.Build();
Â Â Â Â Â Â }
Â Â Â Â }
}</span></pre></li> <li><span class="koboSpan" id="kobo.437.1">Now, run the </span><a id="_idIndexMarker1220"/><span class="koboSpan" id="kobo.438.1">project to see the effects of the changes, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.439.1">Figure 11</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.440.1">.9</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.441.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer195">
<span class="koboSpan" id="kobo.442.1"><img alt="Figure 11.9 â€“ Running the blank calculator app on Windows" src="image/B19214_11_9.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.443.1">Figure 11.9 â€“ Running the blank calculator app on Windows</span></p>
<p><span class="koboSpan" id="kobo.444.1">Now that the </span><a id="_idIndexMarker1221"/><span class="koboSpan" id="kobo.445.1">project is ready to be an app, letâ€™s start with the </span><span class="No-Break"><span class="koboSpan" id="kobo.446.1">Keypad view.</span></span></p>
<h2 id="_idParaDest-182"><a id="_idTextAnchor910"/><span class="koboSpan" id="kobo.447.1">Creating the Keypad view</span></h2>
<p><span class="koboSpan" id="kobo.448.1">The Keypad view is the </span><a id="_idIndexMarker1222"/><span class="koboSpan" id="kobo.449.1">basic functionality of the calculator. </span><span class="koboSpan" id="kobo.449.2">It has buttons for each digit, 0 through 9, the decimal separator, </span><em class="italic"><span class="koboSpan" id="kobo.450.1">.</span></em><span class="koboSpan" id="kobo.451.1">, clear, </span><em class="italic"><span class="koboSpan" id="kobo.452.1">C</span></em><span class="koboSpan" id="kobo.453.1">, clear everything, </span><em class="italic"><span class="koboSpan" id="kobo.454.1">CE</span></em><span class="koboSpan" id="kobo.455.1">, and, finally, addition, </span><em class="italic"><span class="koboSpan" id="kobo.456.1">+</span></em><span class="koboSpan" id="kobo.457.1">, subtraction, </span><em class="italic"><span class="koboSpan" id="kobo.458.1">-</span></em><span class="koboSpan" id="kobo.459.1">, multiplication, </span><em class="italic"><span class="koboSpan" id="kobo.460.1">x</span></em><span class="koboSpan" id="kobo.461.1">, division, </span><em class="italic"><span class="koboSpan" id="kobo.462.1">/</span></em><span class="koboSpan" id="kobo.463.1">, </span><em class="italic"><span class="koboSpan" id="kobo.464.1">=</span></em><span class="koboSpan" id="kobo.465.1"> to get the result, and </span><em class="italic"><span class="koboSpan" id="kobo.466.1">&lt;</span></em><span class="koboSpan" id="kobo.467.1"> to erase the last character. </span><span class="koboSpan" id="kobo.467.2">The view has three basic components to it â€“ HTML and CSS for styling and the C# code. </span><span class="koboSpan" id="kobo.467.3">Each of the following sections will guide you through adding each of these components for the view, starting with </span><span class="No-Break"><span class="koboSpan" id="kobo.468.1">the HTML.</span></span></p>
<h3><span class="koboSpan" id="kobo.469.1">Adding the HTML</span></h3>
<p><span class="koboSpan" id="kobo.470.1">Razor files and .NET MAUI XAML</span><a id="_idIndexMarker1223"/><span class="koboSpan" id="kobo.471.1"> files do not have a </span><a id="_idIndexMarker1224"/><span class="koboSpan" id="kobo.472.1">designer for you to visualize your changes. </span><span class="koboSpan" id="kobo.472.2">You have to run your app to see the changes you have made, which usually involves building, deploying, and then navigating to the view in your app. </span><span class="koboSpan" id="kobo.472.3">.NET has a time-saving feature called Hot Reload. </span><span class="koboSpan" id="kobo.472.4">It works by applying the changes you make to your Razor, XAML, CSS, and C# files to the running application without you having to stop and restart the app. </span><span class="koboSpan" id="kobo.472.5">Try </span><a id="_idIndexMarker1225"/><span class="koboSpan" id="kobo.473.1">using </span><strong class="bold"><span class="koboSpan" id="kobo.474.1">Hot Reload</span></strong><span class="koboSpan" id="kobo.475.1"> while you go through the next set of steps. </span><span class="koboSpan" id="kobo.475.2">To apply the changes, use the </span><strong class="bold"><span class="koboSpan" id="kobo.476.1">Hot Reload</span></strong><span class="koboSpan" id="kobo.477.1"> button in the </span><strong class="bold"><span class="koboSpan" id="kobo.478.1">Debug</span></strong><span class="koboSpan" id="kobo.479.1"> toolbar. </span><span class="koboSpan" id="kobo.479.2">Itâ€™s easy to find â€“ itâ€™s the </span><span class="No-Break"><span class="koboSpan" id="kobo.480.1">flames icon:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer196">
<span class="koboSpan" id="kobo.481.1"><img alt="Figure 11.10 â€“ The Hot Reload toolbar button" src="image/B19214_11_10.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.482.1">Figure 11.10 â€“ The Hot Reload toolbar button</span></p>
<p><span class="koboSpan" id="kobo.483.1">If at any point you receive a â€œRude Editâ€ dialog like the following, it just means that the change cannot </span><a id="_idIndexMarker1226"/><span class="koboSpan" id="kobo.484.1">be </span><a id="_idIndexMarker1227"/><span class="koboSpan" id="kobo.485.1">applied by Hot Reload, so you need to stop, rebuild, and </span><span class="No-Break"><span class="koboSpan" id="kobo.486.1">restart debugging:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer197">
<span class="koboSpan" id="kobo.487.1"><img alt="Figure 11.11 â€“ Hot Reload ï»¿dialog" src="image/B19214_11_11.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.488.1">Figure 11.11 â€“ Hot Reload dialog</span></p>
<p><span class="koboSpan" id="kobo.489.1">Hot Reload is constantly getting better, so there will be fewer and fewer of these cases in </span><span class="No-Break"><span class="koboSpan" id="kobo.490.1">the future.</span></span></p>
<p><span class="koboSpan" id="kobo.491.1">To add the HTML that will provide you with the UI to interact with the keypad, follow </span><span class="No-Break"><span class="koboSpan" id="kobo.492.1">these steps:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.493.1">Start the app by using the debugger or </span><span class="No-Break"><span class="koboSpan" id="kobo.494.1">pressing </span></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.495.1">F5</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.496.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.497.1">If you want to see your app in Visual Studio, you can open the </span><strong class="bold"><span class="koboSpan" id="kobo.498.1">XAML Live Preview</span></strong><span class="koboSpan" id="kobo.499.1"> pane. </span><span class="koboSpan" id="kobo.499.2">To open the </span><strong class="bold"><span class="koboSpan" id="kobo.500.1">XAML Live Preview</span></strong><span class="koboSpan" id="kobo.501.1"> pane, use the Visual Studio menu and select </span><strong class="bold"><span class="koboSpan" id="kobo.502.1">Debug</span></strong><span class="koboSpan" id="kobo.503.1"> | </span><strong class="bold"><span class="koboSpan" id="kobo.504.1">Windows</span></strong><span class="koboSpan" id="kobo.505.1"> | </span><strong class="bold"><span class="koboSpan" id="kobo.506.1">XAML Live Preview</span></strong><span class="koboSpan" id="kobo.507.1">. </span><span class="koboSpan" id="kobo.507.2">I usually pin it open so that it is </span><span class="No-Break"><span class="koboSpan" id="kobo.508.1">always available.</span></span></li>
<li><span class="koboSpan" id="kobo.509.1">Open the </span><strong class="source-inline"><span class="koboSpan" id="kobo.510.1">Keypad.razor</span></strong><span class="koboSpan" id="kobo.511.1"> file in the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.512.1">Pages</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.513.1"> folder.</span></span></li>
<li><span class="koboSpan" id="kobo.514.1">Remove the </span><a id="_idIndexMarker1228"/><span class="koboSpan" id="kobo.515.1">highlighted content</span><a id="_idIndexMarker1229"/><span class="koboSpan" id="kobo.516.1"> shown in the following </span><span class="No-Break"><span class="koboSpan" id="kobo.517.1">code block:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.518.1">
@page "/"
</span><strong class="bold"><span class="koboSpan" id="kobo.519.1">&lt;h3&gt;Keypad&lt;/h3&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.520.1">&lt;div&gt;Keypad goes here&lt;/div&gt;</span></strong><span class="koboSpan" id="kobo.521.1">
@code {
}</span></pre></li> <li><span class="koboSpan" id="kobo.522.1">Add the following HTML after </span><strong class="source-inline"><span class="koboSpan" id="kobo.523.1">@page</span></strong><span class="koboSpan" id="kobo.524.1"> but before the </span><strong class="source-inline"><span class="koboSpan" id="kobo.525.1">@</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.526.1">code</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.527.1"> directive:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.528.1">
&lt;div class="keypad"&gt;
Â Â &lt;div class="keypad-body"&gt;
Â Â Â Â &lt;div class="keypad-screen"&gt;
Â Â Â Â Â Â &lt;div class="keypad-typed"&gt;&lt;/div&gt;
Â Â Â Â &lt;/div&gt;
Â Â Â Â &lt;div class="keypad-row"&gt;
Â Â Â Â Â Â &lt;div class="keypad-button wide command"&gt;C&lt;/div&gt;
Â Â Â Â Â Â &lt;div class="keypad-button command"&gt;CE&lt;/div&gt;
Â Â Â Â Â Â &lt;div class="keypad-button operator"&gt;/&lt;/div&gt;
Â Â Â Â &lt;/div&gt;
Â Â Â Â &lt;div class="keypad-row"&gt;
Â Â Â Â Â Â &lt;div class="keypad-button"&gt;7&lt;/div&gt;
Â Â Â Â Â Â &lt;div class="keypad-button"&gt;8&lt;/div&gt;
Â Â Â Â Â Â &lt;div class="keypad-button"&gt;9&lt;/div&gt;
Â Â Â Â Â Â &lt;div class="keypad-button operator"&gt;X&lt;/div&gt;
Â Â Â Â &lt;/div&gt;
Â Â Â Â &lt;div class="keypad-row"&gt;
Â Â Â Â Â Â &lt;div class="keypad-button"&gt;4&lt;/div&gt;
Â Â Â Â Â Â &lt;div class="keypad-button"&gt;5&lt;/div&gt;
Â Â Â Â Â Â &lt;div class="keypad-button"&gt;6&lt;/div&gt;
Â Â Â Â Â Â &lt;div class="keypad-button operator"&gt;âˆ’&lt;/div&gt;
Â Â Â Â &lt;/div&gt;
Â Â Â Â &lt;div class="keypad-row"&gt;
Â Â Â Â Â Â &lt;div class="keypad-button"&gt;1&lt;/div&gt;
Â Â Â Â Â Â &lt;div class="keypad-button"&gt;2&lt;/div&gt;
Â Â Â Â Â Â &lt;div class="keypad-button"&gt;3&lt;/div&gt;
Â Â Â Â Â Â &lt;div class="keypad-button operator"&gt;+&lt;/div&gt;
Â Â Â Â &lt;/div&gt;
Â Â Â Â &lt;div class="keypad-row"&gt;
Â Â Â Â Â Â &lt;div class="keypad-button"&gt;.&lt;/div&gt;
Â Â Â Â Â Â &lt;div class="keypad-button"&gt;0&lt;/div&gt;
Â Â Â Â Â Â &lt;div class="keypad-button"&gt;&amp;lt;&lt;/div&gt;
Â Â Â Â Â Â &lt;div class="keypad-button operator"&gt;=&lt;/div&gt;
Â Â Â Â &lt;/div&gt;
Â Â &lt;/div&gt;
&lt;/div&gt;</span></pre><p class="list-inset"><span class="koboSpan" id="kobo.529.1">Donâ€™t forget to press the </span><strong class="bold"><span class="koboSpan" id="kobo.530.1">Hot Reload</span></strong><span class="koboSpan" id="kobo.531.1"> button to see your changes! </span><span class="koboSpan" id="kobo.531.2">The keypad is implemented using </span><strong class="source-inline"><span class="koboSpan" id="kobo.532.1">div</span></strong><span class="koboSpan" id="kobo.533.1"> and not </span><strong class="source-inline"><span class="koboSpan" id="kobo.534.1">table</span></strong><span class="koboSpan" id="kobo.535.1"> since it is easier to style </span><strong class="source-inline"><span class="koboSpan" id="kobo.536.1">div</span></strong><span class="koboSpan" id="kobo.537.1"> elements than </span><strong class="source-inline"><span class="koboSpan" id="kobo.538.1">table</span></strong><span class="koboSpan" id="kobo.539.1"> elements. </span><span class="koboSpan" id="kobo.539.2">The keypad is arranged in rows of four buttons, except for the top two rows. </span><span class="koboSpan" id="kobo.539.3">The top row is the display where the expression or result is shown. </span><span class="koboSpan" id="kobo.539.4">The second row only has three buttons. </span><span class="koboSpan" id="kobo.539.5">The class names have already been added to the HTML elements, but since they donâ€™t exist yet, they </span><a id="_idIndexMarker1230"/><span class="koboSpan" id="kobo.540.1">donâ€™t </span><a id="_idIndexMarker1231"/><span class="koboSpan" id="kobo.541.1">alter </span><span class="No-Break"><span class="koboSpan" id="kobo.542.1">the appearance.</span></span></p></li> </ol>
<p><span class="koboSpan" id="kobo.543.1">The keypad doesnâ€™t quite look like a keypad yet, but it will once we add some style </span><span class="No-Break"><span class="koboSpan" id="kobo.544.1">to it.</span></span></p>
<h3><span class="koboSpan" id="kobo.545.1">Adding style to the HTML</span></h3>
<p><span class="koboSpan" id="kobo.546.1">CSS has been</span><a id="_idIndexMarker1232"/><span class="koboSpan" id="kobo.547.1"> around for a very long time </span><a id="_idIndexMarker1233"/><span class="koboSpan" id="kobo.548.1">and is the best way to make your HTML look its best. </span><span class="koboSpan" id="kobo.548.2">Follow these steps to add the styles we used in the </span><span class="No-Break"><span class="koboSpan" id="kobo.549.1">previous section:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.550.1">Make sure your app is still running and use </span><strong class="bold"><span class="koboSpan" id="kobo.551.1">Solution Explorer</span></strong><span class="koboSpan" id="kobo.552.1"> to add a new CSS stylesheet file named </span><strong class="source-inline"><span class="koboSpan" id="kobo.553.1">Keypad.razor.css</span></strong><span class="koboSpan" id="kobo.554.1"> in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.555.1">Pages</span></strong><span class="koboSpan" id="kobo.556.1"> folder. </span><span class="koboSpan" id="kobo.556.2">Click the </span><strong class="bold"><span class="koboSpan" id="kobo.557.1">Show All Templates</span></strong><span class="koboSpan" id="kobo.558.1"> button if Visual Studio doesnâ€™t display them </span><span class="No-Break"><span class="koboSpan" id="kobo.559.1">by default:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer198">
<span class="koboSpan" id="kobo.560.1"><img alt="Figure 11.12 â€“ Adding a new CSS file" src="image/B19214_11_12.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.561.1">Figure 11.12 â€“ Adding a new CSS file</span></p>
<p class="list-inset"><span class="koboSpan" id="kobo.562.1">If you</span><a id="_idIndexMarker1234"/><span class="koboSpan" id="kobo.563.1"> look</span><a id="_idIndexMarker1235"/><span class="koboSpan" id="kobo.564.1"> in </span><strong class="bold"><span class="koboSpan" id="kobo.565.1">Solution Explorer</span></strong><span class="koboSpan" id="kobo.566.1"> under the </span><strong class="source-inline"><span class="koboSpan" id="kobo.567.1">Pages</span></strong><span class="koboSpan" id="kobo.568.1"> folder, you will notice that your new file </span><a id="_idTextAnchor911"/><span class="koboSpan" id="kobo.569.1">is now under the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.570.1">Keypad.razor</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.571.1"> file:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer199">
<span class="koboSpan" id="kobo.572.1"><img alt=" Figure 11.13 â€“ A Razor page with an isolated CSS file" src="image/B19214_11_13.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.573.1"> Figure 11.13 â€“ A Razor page with an isolated CSS file</span></p>
<p class="list-inset"><span class="koboSpan" id="kobo.574.1">Visual Studio automatically recognized that you wanted to add an </span><strong class="bold"><span class="koboSpan" id="kobo.575.1">isolated CSS</span></strong><span class="koboSpan" id="kobo.576.1"> file and made the association. </span><span class="koboSpan" id="kobo.576.2">Isolated CSS files are a feature of ASP.NET that allows you to write CSS that only affects the Razor file itâ€™s associated with. </span><span class="koboSpan" id="kobo.576.3">None of the styles you add to this file can be used outside of the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.577.1">Keypad.razor</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.578.1"> file.</span></span></p>
<ol>
<li value="2"><span class="koboSpan" id="kobo.579.1">Add the </span><strong class="source-inline"><span class="koboSpan" id="kobo.580.1">keypad</span></strong><span class="koboSpan" id="kobo.581.1"> style to the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.582.1">Keypad.razor.css</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.583.1"> file:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.584.1">
.keypad {
Â Â Â Â width: 300px;
Â Â Â Â margin: auto;
Â Â Â Â margin-top: -1.1em;
}</span></pre><p class="list-inset"><span class="koboSpan" id="kobo.585.1">This style will set the width of the element to </span><strong class="source-inline"><span class="koboSpan" id="kobo.586.1">300px</span></strong><span class="koboSpan" id="kobo.587.1">, with automatic margins, except for the top, which is at </span><strong class="source-inline"><span class="koboSpan" id="kobo.588.1">-1.1em</span></strong><span class="koboSpan" id="kobo.589.1">. </span><strong class="source-inline"><span class="koboSpan" id="kobo.590.1">-1.1em</span></strong><span class="koboSpan" id="kobo.591.1"> moves the top edge of the keypad right </span><a id="_idIndexMarker1236"/><span class="koboSpan" id="kobo.592.1">up against the top of </span><a id="_idIndexMarker1237"/><span class="koboSpan" id="kobo.593.1">the web </span><span class="No-Break"><span class="koboSpan" id="kobo.594.1">view control.</span></span></p></li> <li><span class="koboSpan" id="kobo.595.1">Now, add the </span><strong class="source-inline"><span class="koboSpan" id="kobo.596.1">keypad-body</span></strong><span class="koboSpan" id="kobo.597.1"> style using the </span><span class="No-Break"><span class="koboSpan" id="kobo.598.1">following code:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.599.1">
.keypad-body {
Â Â Â Â border: solid 1px #3A4655;
}</span></pre><p class="list-inset"><span class="koboSpan" id="kobo.600.1">This style just gives the entire element a border one pixel wide in a dark </span><span class="No-Break"><span class="koboSpan" id="kobo.601.1">gray color.</span></span></p></li> <li><span class="koboSpan" id="kobo.602.1">We will save the </span><strong class="source-inline"><span class="koboSpan" id="kobo.603.1">keypad-screen</span></strong><span class="koboSpan" id="kobo.604.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.605.1">keypad-typed</span></strong><span class="koboSpan" id="kobo.606.1"> styles for last, so add the </span><strong class="source-inline"><span class="koboSpan" id="kobo.607.1">keypad-row</span></strong><span class="koboSpan" id="kobo.608.1"> style shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.609.1">following code:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.610.1">
.keypad-row {
Â Â Â Â width: 100%;
Â Â Â Â background: #3C4857;
}</span></pre><p class="list-inset"><span class="koboSpan" id="kobo.611.1">This style sets the element width to 100% of its parent, which would be </span><strong class="source-inline"><span class="koboSpan" id="kobo.612.1">keypad-body</span></strong><span class="koboSpan" id="kobo.613.1">, and sets the background to a pleasing dark </span><span class="No-Break"><span class="koboSpan" id="kobo.614.1">gray color.</span></span></p></li> <li><span class="koboSpan" id="kobo.615.1">The next style to add is </span><strong class="source-inline"><span class="koboSpan" id="kobo.616.1">keypad-button</span></strong><span class="koboSpan" id="kobo.617.1">. </span><span class="koboSpan" id="kobo.617.2">Use the following code to add </span><span class="No-Break"><span class="koboSpan" id="kobo.618.1">the style:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.619.1">
.keypad-button {
Â Â Â Â width: 25%;
Â Â Â Â background: #425062;
Â Â Â Â color: #fff;
Â Â Â Â padding: 20px;
Â Â Â Â display: inline-block;
Â Â Â Â font-size: 25px;
Â Â Â Â text-align: center;
Â Â Â Â vertical-align: middle;
Â Â Â Â margin-right: -4px;
Â Â Â Â border-right: solid 2px #3C4857;
Â Â Â Â border-bottom: solid 2px #3C4857;
Â Â Â Â transition: all 0.2s ease-in-out;
}</span></pre><p class="list-inset"><span class="koboSpan" id="kobo.620.1">This style is the base</span><a id="_idIndexMarker1238"/><span class="koboSpan" id="kobo.621.1"> for all the buttons</span><a id="_idIndexMarker1239"/><span class="koboSpan" id="kobo.622.1"> on the keypad, hence it has the most attributes. </span><span class="koboSpan" id="kobo.622.2">Elements that have this style applied have a border on the right and bottom that is 2 pixels wide and uses the same color as the background of the row. </span><span class="koboSpan" id="kobo.622.3">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.623.1">background</span></strong><span class="koboSpan" id="kobo.624.1"> attribute of the button is a bit darker than the border color, which provides a bit of depth. </span><span class="koboSpan" id="kobo.624.2">The text is aligned in the center both vertically and horizontally and uses a 25-pixel font size. </span><span class="koboSpan" id="kobo.624.3">The width is set to 25% since there are four buttons in a row, mostly. </span><span class="koboSpan" id="kobo.624.4">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.625.1">transition</span></strong><span class="koboSpan" id="kobo.626.1"> attribute imposes a 200-millisecond transition using </span><strong class="source-inline"><span class="koboSpan" id="kobo.627.1">ease-in-out</span></strong><span class="koboSpan" id="kobo.628.1">, which accelerates from the start to the middle and then decelerates from the middle to the end. </span><strong class="source-inline"><span class="koboSpan" id="kobo.629.1">transition</span></strong><span class="koboSpan" id="kobo.630.1"> is applied to all attributes, so any time an attribute of this style changes, it will slowly change from the starting value to the </span><span class="No-Break"><span class="koboSpan" id="kobo.631.1">end value.</span></span></p></li> <li><span class="koboSpan" id="kobo.632.1">If the button is an action button, such as an operator, then an additional style is applied, called </span><strong class="source-inline"><span class="koboSpan" id="kobo.633.1">operator</span></strong><span class="koboSpan" id="kobo.634.1">. </span><span class="koboSpan" id="kobo.634.2">The definition of this style is slightly different from the rest of the styles that have been created so far. </span><span class="koboSpan" id="kobo.634.3">Instead of just being named </span><strong class="source-inline"><span class="koboSpan" id="kobo.635.1">operator</span></strong><span class="koboSpan" id="kobo.636.1">, this style is named </span><strong class="source-inline"><span class="koboSpan" id="kobo.637.1">keypad-button.operator</span></strong><span class="koboSpan" id="kobo.638.1">. </span><span class="koboSpan" id="kobo.638.2">In CSS, </span><strong class="source-inline"><span class="koboSpan" id="kobo.639.1">.</span></strong><span class="koboSpan" id="kobo.640.1"> is a selector; it is used to locate which attributes to apply. </span><span class="koboSpan" id="kobo.640.2">In this case, we want all elements that have both the </span><strong class="source-inline"><span class="koboSpan" id="kobo.641.1">keypad-button</span></strong><span class="koboSpan" id="kobo.642.1"> class and the </span><strong class="source-inline"><span class="koboSpan" id="kobo.643.1">operator</span></strong><span class="koboSpan" id="kobo.644.1"> class applied. </span><span class="koboSpan" id="kobo.644.2">To add the </span><strong class="source-inline"><span class="koboSpan" id="kobo.645.1">keypad-button.operator</span></strong><span class="koboSpan" id="kobo.646.1"> class, use the </span><span class="No-Break"><span class="koboSpan" id="kobo.647.1">following code:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.648.1">
.keypad-button.operator {
Â Â Â Â color: #AEB3BA;
Â Â Â Â background: #404D5E;
}</span></pre><p class="list-inset"><span class="koboSpan" id="kobo.649.1">These buttons will</span><a id="_idIndexMarker1240"/><span class="koboSpan" id="kobo.650.1"> appear with a slightly </span><a id="_idIndexMarker1241"/><span class="koboSpan" id="kobo.651.1">darker background with slightly less </span><span class="No-Break"><span class="koboSpan" id="kobo.652.1">white text.</span></span></p></li> <li><span class="koboSpan" id="kobo.653.1">The clear (</span><em class="italic"><span class="koboSpan" id="kobo.654.1">C</span></em><span class="koboSpan" id="kobo.655.1">) and clear everything (</span><em class="italic"><span class="koboSpan" id="kobo.656.1">CE</span></em><span class="koboSpan" id="kobo.657.1">) buttons also have their own class, </span><span class="No-Break"><span class="koboSpan" id="kobo.658.1">as follows:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.659.1">
.keypad-button.command {
Â Â Â Â color: #D95D4E;
Â Â Â Â background: #404D5E;
}</span></pre><p class="list-inset"><span class="koboSpan" id="kobo.660.1">These buttons will appear with slightly darker backgrounds with </span><span class="No-Break"><span class="koboSpan" id="kobo.661.1">red text.</span></span></p></li> <li><span class="koboSpan" id="kobo.662.1">Now, for the desktop, we can add hover highlighting by using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.663.1">:hover</span></strong><span class="koboSpan" id="kobo.664.1"> pseudo selector. </span><span class="koboSpan" id="kobo.664.2">Add the hover styles using the </span><span class="No-Break"><span class="koboSpan" id="kobo.665.1">following code:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.666.1">
.keypad-button:hover {
Â Â Â Â background: #E0B612;
}
.keypad-button.command:hover,
.keypad-button.operator:hover {
Â Â Â Â background: #E0B612;
Â Â Â Â color: #fff;
}</span></pre><p class="list-inset"><span class="koboSpan" id="kobo.667.1">The background is altered to an orange color. </span><span class="koboSpan" id="kobo.667.2">The change isnâ€™t immediate due to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.668.1">transition</span></strong><span class="koboSpan" id="kobo.669.1"> attribute on the </span><strong class="source-inline"><span class="koboSpan" id="kobo.670.1">keypad-button</span></strong><span class="koboSpan" id="kobo.671.1"> style, so it will transition from dark gray to orange in two-tenths of </span><span class="No-Break"><span class="koboSpan" id="kobo.672.1">a second.</span></span></p></li> <li><span class="koboSpan" id="kobo.673.1">The last button-related style is wide, or </span><strong class="source-inline"><span class="koboSpan" id="kobo.674.1">keypad-button.wide</span></strong><span class="koboSpan" id="kobo.675.1">. </span><span class="koboSpan" id="kobo.675.2">This style makes the button twice as wide as a normal button. </span><span class="koboSpan" id="kobo.675.3">To add this style, use the </span><span class="No-Break"><span class="koboSpan" id="kobo.676.1">following code:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.677.1">
.keypad-button.wide {
Â Â Â Â width: 50%;
}</span></pre></li> <li><span class="koboSpan" id="kobo.678.1">The final two</span><a id="_idIndexMarker1242"/><span class="koboSpan" id="kobo.679.1"> styles, </span><strong class="source-inline"><span class="koboSpan" id="kobo.680.1">keypad-screen</span></strong><span class="koboSpan" id="kobo.681.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.682.1">keypad-typed</span></strong><span class="koboSpan" id="kobo.683.1">, are </span><a id="_idIndexMarker1243"/><span class="koboSpan" id="kobo.684.1">for displaying the expression and the result. </span><span class="koboSpan" id="kobo.684.2">Use the following code to add the remaining </span><span class="No-Break"><span class="koboSpan" id="kobo.685.1">two styles:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.686.1">
.keypad-screen {
Â Â Â Â background: #3A4655;
Â Â Â Â width: 100%;
Â Â Â Â height: 75px;
Â Â Â Â padding: 20px;
}
.keypad-typed {
Â Â Â Â font-size: 45px;
Â Â Â Â text-align: right;
Â Â Â Â color: #fff;
}</span></pre></li> </ol>
<p><span class="koboSpan" id="kobo.687.1">Now, the keypad looks like a real calculator keypad; refer to </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.688.1">Figure 11</span></em></span><em class="italic"><span class="koboSpan" id="kobo.689.1">.14</span></em><span class="koboSpan" id="kobo.690.1"> for an example. </span><span class="koboSpan" id="kobo.690.2">Were you able to keep adding styles and seeing the changes in your app without having to restart? </span><span class="koboSpan" id="kobo.690.3">Remember to click the </span><strong class="bold"><span class="koboSpan" id="kobo.691.1">Hot Reload</span></strong><span class="koboSpan" id="kobo.692.1"> button or set the </span><strong class="bold"><span class="koboSpan" id="kobo.693.1">Hot Reload on File Save</span></strong><span class="koboSpan" id="kobo.694.1"> option under the </span><strong class="bold"><span class="koboSpan" id="kobo.695.1">Hot Reload</span></strong><span class="koboSpan" id="kobo.696.1"> button menu; Visual Studio will attempt to apply the changes as soon as you save the file. </span><span class="koboSpan" id="kobo.696.2">Next, we will add the code to enable </span><a id="_idIndexMarker1244"/><span class="koboSpan" id="kobo.697.1">the </span><a id="_idIndexMarker1245"/><span class="koboSpan" id="kobo.698.1">buttons </span><span class="No-Break"><span class="koboSpan" id="kobo.699.1">to work:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer200">
<span class="koboSpan" id="kobo.700.1"><img alt="Figure 11.14 â€“ HTML keypad with style" src="image/B19214_11_14.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.701.1">Figure 11.14 â€“ HTML keypad with style</span></p>
<h3><span class="koboSpan" id="kobo.702.1">Wiring up the controls</span></h3>
<p><span class="koboSpan" id="kobo.703.1">In most web pages, you</span><a id="_idIndexMarker1246"/><span class="koboSpan" id="kobo.704.1"> would use </span><strong class="bold"><span class="koboSpan" id="kobo.705.1">JavaScript</span></strong><span class="koboSpan" id="kobo.706.1"> to </span><a id="_idIndexMarker1247"/><span class="koboSpan" id="kobo.707.1">write the code to interact with the page. </span><span class="koboSpan" id="kobo.707.2">In Blazor, you use C#. </span><span class="koboSpan" id="kobo.707.3">To add the C# functions to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.708.1">Keypad.razor</span></strong><span class="koboSpan" id="kobo.709.1"> file, follow </span><span class="No-Break"><span class="koboSpan" id="kobo.710.1">these steps:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.711.1">Within the </span><strong class="source-inline"><span class="koboSpan" id="kobo.712.1">@code</span></strong><span class="koboSpan" id="kobo.713.1"> directive block, add </span><span class="No-Break"><span class="koboSpan" id="kobo.714.1">the following:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.715.1">
string inputDisplay = string.Empty;
bool clearInputBeforeAppend = false;</span></pre><p class="list-inset"><span class="koboSpan" id="kobo.716.1">This declares a field named </span><strong class="source-inline"><span class="koboSpan" id="kobo.717.1">inputDisplay</span></strong><span class="koboSpan" id="kobo.718.1"> as a </span><strong class="source-inline"><span class="koboSpan" id="kobo.719.1">string</span></strong><span class="koboSpan" id="kobo.720.1"> element and initializes it to the empty string. </span><span class="koboSpan" id="kobo.720.2">It also declares a </span><strong class="source-inline"><span class="koboSpan" id="kobo.721.1">bool</span></strong><span class="koboSpan" id="kobo.722.1"> element and initializes it to </span><strong class="source-inline"><span class="koboSpan" id="kobo.723.1">false</span></strong><span class="koboSpan" id="kobo.724.1">. </span><strong class="source-inline"><span class="koboSpan" id="kobo.725.1">clearInputBeforeAppend</span></strong><span class="koboSpan" id="kobo.726.1"> is a flag to keep </span><strong class="source-inline"><span class="koboSpan" id="kobo.727.1">inputDisplay</span></strong><span class="koboSpan" id="kobo.728.1"> clean. </span><span class="koboSpan" id="kobo.728.2">After a result is displayed, when the user taps a button, </span><strong class="source-inline"><span class="koboSpan" id="kobo.729.1">inputDisplay</span></strong><span class="koboSpan" id="kobo.730.1"> should be cleared before the character is added to </span><span class="No-Break"><span class="koboSpan" id="kobo.731.1">the screen.</span></span></p></li> <li><span class="koboSpan" id="kobo.732.1">Update the element with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.733.1">keypad-typed</span></strong><span class="koboSpan" id="kobo.734.1"> class, as in the </span><span class="No-Break"><span class="koboSpan" id="kobo.735.1">following code:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.736.1">
&lt;div class="keypad-typed"&gt;@inputDisplay&lt;/div&gt;</span></pre><p class="list-inset"><span class="koboSpan" id="kobo.737.1">This will render the contents of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.738.1">inputDisplay</span></strong><span class="koboSpan" id="kobo.739.1"> variable into the </span><strong class="source-inline"><span class="koboSpan" id="kobo.740.1">div</span></strong><span class="koboSpan" id="kobo.741.1"> element. </span><span class="koboSpan" id="kobo.741.2">Note the use of </span><strong class="source-inline"><span class="koboSpan" id="kobo.742.1">@</span></strong><span class="koboSpan" id="kobo.743.1"> to reference the </span><span class="No-Break"><span class="koboSpan" id="kobo.744.1">C# field.</span></span></p></li> <li><span class="koboSpan" id="kobo.745.1">To help with </span><a id="_idIndexMarker1248"/><span class="koboSpan" id="kobo.746.1">validating the input, add </span><span class="No-Break"><span class="koboSpan" id="kobo.747.1">the following:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.748.1">
readonly char[] symbols = { '/', 'X', '+', '-', '.' </span><span class="koboSpan" id="kobo.748.2">};</span></pre></li> <li><span class="koboSpan" id="kobo.749.1">When any of the numbers (0 through 9) or the operator buttons are tapped, </span><strong class="source-inline"><span class="koboSpan" id="kobo.750.1">inputDisplay</span></strong><span class="koboSpan" id="kobo.751.1"> will be updated by appending a character to the display. </span><span class="koboSpan" id="kobo.751.2">Add the </span><strong class="source-inline"><span class="koboSpan" id="kobo.752.1">AppendInput</span></strong><span class="koboSpan" id="kobo.753.1"> method using the </span><span class="No-Break"><span class="koboSpan" id="kobo.754.1">following code:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.755.1">
void AppendInput(string inputValue)
{
Â Â Â Â double numValue;
Â Â Â Â if (clearInputBeforeAppend)
Â Â Â Â {
Â Â Â Â Â Â Â Â inputDisplay = string.Empty;
Â Â Â Â }
Â Â Â Â if (string.IsNullOrEmpty(inputDisplay) &amp;&amp; inputValue.IndexOfAny(symbols) != -1)
Â Â Â Â {
Â Â Â Â Â Â Â Â return;
Â Â Â Â }
Â Â Â Â if (!double.TryParse(inputValue, out numValue) &amp;&amp; !string.IsNullOrEmpty(inputDisplay) &amp;&amp; $"{inputDisplay[^1]}".IndexOfAny(symbols) != -1)
Â Â Â Â {
Â Â Â Â Â Â Â Â return;
Â Â Â Â }
Â Â Â Â if (inputDisplay.Trim() == "0" &amp;&amp; inputValue == "0")
Â Â Â Â {
Â Â Â Â Â Â Â Â return;
Â Â Â Â }
Â Â Â Â clearInputBeforeAppend = false;
Â Â Â Â inputDisplay += inputValue;
}</span></pre><p class="list-inset"><span class="koboSpan" id="kobo.756.1">Letâ€™s review the</span><a id="_idIndexMarker1249"/><span class="koboSpan" id="kobo.757.1"> code. </span><span class="koboSpan" id="kobo.757.2">The first check is to see whether </span><strong class="source-inline"><span class="koboSpan" id="kobo.758.1">inputDisplay</span></strong><span class="koboSpan" id="kobo.759.1"> needs to be cleared; if so, itâ€™s cleared. </span><span class="koboSpan" id="kobo.759.2">Then, a check for operators is made. </span><span class="koboSpan" id="kobo.759.3">The next check is more complex as it doesnâ€™t allow multiple operators in a row. </span><span class="koboSpan" id="kobo.759.4">This check uses the </span><strong class="source-inline"><span class="koboSpan" id="kobo.760.1">Range</span></strong><span class="koboSpan" id="kobo.761.1"> syntax of </span><strong class="source-inline"><span class="koboSpan" id="kobo.762.1">^1</span></strong><span class="koboSpan" id="kobo.763.1"> to indicate the last character. </span><span class="koboSpan" id="kobo.763.2">String interpolation is used to convert the last character back into a string, so </span><strong class="source-inline"><span class="koboSpan" id="kobo.764.1">IndexOfAny</span></strong><span class="koboSpan" id="kobo.765.1"> can be used to find that character in the array of symbols. </span><span class="koboSpan" id="kobo.765.2">Multiple leading 0s are checked and rejected if found. </span><span class="koboSpan" id="kobo.765.3">If all the checks pass, the input is appended to </span><strong class="source-inline"><span class="koboSpan" id="kobo.766.1">inputDisplay</span></strong><span class="koboSpan" id="kobo.767.1">, and the </span><strong class="source-inline"><span class="koboSpan" id="kobo.768.1">clearInputBeforeAppend</span></strong><span class="koboSpan" id="kobo.769.1"> flag is reset </span><span class="No-Break"><span class="koboSpan" id="kobo.770.1">to </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.771.1">false</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.772.1">.</span></span></p></li> <li><span class="koboSpan" id="kobo.773.1">When the user presses the </span><strong class="bold"><span class="koboSpan" id="kobo.774.1">&lt;</span></strong><span class="koboSpan" id="kobo.775.1"> button, it will remove the last character from the input. </span><span class="koboSpan" id="kobo.775.2">Add the </span><strong class="source-inline"><span class="koboSpan" id="kobo.776.1">Undo</span></strong><span class="koboSpan" id="kobo.777.1"> method using the </span><span class="No-Break"><span class="koboSpan" id="kobo.778.1">following code:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.779.1">
void Undo()
{
Â Â Â Â if (!clearInputBeforeAppend &amp;&amp; inputDisplay.Length &gt; 0)
Â Â Â Â {
Â Â Â Â Â Â Â Â inputDisplay = inputDisplay[0..^1];
Â Â Â Â Â Â Â Â return;
Â Â Â Â }
}</span></pre><p class="list-inset"><span class="koboSpan" id="kobo.780.1">This method uses the </span><strong class="source-inline"><span class="koboSpan" id="kobo.781.1">Range</span></strong><span class="koboSpan" id="kobo.782.1"> syntax again, and the capability of strings being able to be indexed as arrays. </span><span class="koboSpan" id="kobo.782.2">It uses the array syntax to get the elements from index 0 to the next to last index and </span><span class="No-Break"><span class="koboSpan" id="kobo.783.1">returns it.</span></span></p></li> <li><span class="koboSpan" id="kobo.784.1">When the user presses the </span><strong class="bold"><span class="koboSpan" id="kobo.785.1">C</span></strong><span class="koboSpan" id="kobo.786.1"> button, it will clear the input display. </span><span class="koboSpan" id="kobo.786.2">Add the </span><strong class="source-inline"><span class="koboSpan" id="kobo.787.1">ClearInput</span></strong><span class="koboSpan" id="kobo.788.1"> method</span><a id="_idIndexMarker1250"/><span class="koboSpan" id="kobo.789.1"> using the </span><span class="No-Break"><span class="koboSpan" id="kobo.790.1">following code:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.791.1">
void ClearInput()
{
Â Â Â Â inputDisplay = string.Empty;
}</span></pre></li> <li><span class="koboSpan" id="kobo.792.1">When the user presses the </span><strong class="bold"><span class="koboSpan" id="kobo.793.1">CE</span></strong><span class="koboSpan" id="kobo.794.1"> button, it will clear everything. </span><span class="koboSpan" id="kobo.794.2">For now, that is just the input display. </span><span class="koboSpan" id="kobo.794.3">Use the following code to add the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.795.1">ClearAll</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.796.1"> method:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.797.1">
void ClearAll()
{
Â Â Â Â ClearInput();
}</span></pre></li> <li><span class="koboSpan" id="kobo.798.1">Finally, the </span><strong class="bold"><span class="koboSpan" id="kobo.799.1">=</span></strong><span class="koboSpan" id="kobo.800.1"> button will take the expression that was entered and evaluate the result. </span><span class="koboSpan" id="kobo.800.2">Use the following code to add the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.801.1">EvaluateExpression</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.802.1"> method:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.803.1">
void EvaluateExpression()
{
Â Â Â Â var expression = inputDisplay;
Â Â Â Â clearInputBeforeAppend = true;
}</span></pre><p class="list-inset"><span class="koboSpan" id="kobo.804.1">This method doesnâ€™t evaluate the expression thatâ€™s entered yet; that will happen in the </span><em class="italic"><span class="koboSpan" id="kobo.805.1">Creating the Compute </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.806.1">service</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.807.1"> section.</span></span></p></li> </ol>
<p><span class="koboSpan" id="kobo.808.1">The next step in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.809.1">Keypad.razor</span></strong><span class="koboSpan" id="kobo.810.1"> file is to hook the methods that were just defined so that they are called when the user taps or clicks on that element. </span><span class="koboSpan" id="kobo.810.2">Like in standard HTML, events are hooked up via attributes on the element that reference code, either inline or methods. </span><span class="koboSpan" id="kobo.810.3">The attributes in Razor pages use a page directive with the event name. </span><span class="koboSpan" id="kobo.810.4">For example, the DOM event for handling taps or clicks is </span><strong class="source-inline"><span class="koboSpan" id="kobo.811.1">click</span></strong><span class="koboSpan" id="kobo.812.1">, so the Razor event name would be </span><strong class="source-inline"><span class="koboSpan" id="kobo.813.1">@onclick</span></strong><span class="koboSpan" id="kobo.814.1">. </span><span class="koboSpan" id="kobo.814.2">That attribute is then assigned to a delegate, which could be any method. </span><span class="koboSpan" id="kobo.814.3">The full attribute might look like </span><strong class="source-inline"><span class="koboSpan" id="kobo.815.1">@onclick="DoSomething"</span></strong><span class="koboSpan" id="kobo.816.1">, where </span><strong class="source-inline"><span class="koboSpan" id="kobo.817.1">DoSomething</span></strong><span class="koboSpan" id="kobo.818.1"> is a C# method defined in the pageâ€™s </span><strong class="source-inline"><span class="koboSpan" id="kobo.819.1">@</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.820.1">code</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.821.1"> directive.</span></span></p>
<p><span class="koboSpan" id="kobo.822.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.823.1">AppendInput</span></strong><span class="koboSpan" id="kobo.824.1"> method accepts a single string argument, so the delegate cannot be just </span><strong class="source-inline"><span class="koboSpan" id="kobo.825.1">AppendInput</span></strong><span class="koboSpan" id="kobo.826.1"> â€“ it has to be wrapped in an expression so that the parameter can be passed along. </span><span class="koboSpan" id="kobo.826.2">Expressions </span><a id="_idIndexMarker1251"/><span class="koboSpan" id="kobo.827.1">in Razor pages are contained in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.828.1">@(â€¦)</span></strong><span class="koboSpan" id="kobo.829.1"> directive. </span><span class="koboSpan" id="kobo.829.2">All calls to </span><strong class="source-inline"><span class="koboSpan" id="kobo.830.1">AppendInput</span></strong><span class="koboSpan" id="kobo.831.1"> from an event directive would look </span><span class="No-Break"><span class="koboSpan" id="kobo.832.1">like </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.833.1">@onclick="@(AppendInput("0"))"</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.834.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.835.1">Use the highlighted lines in the following code to update the HTML in the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.836.1">Keypad.razor</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.837.1"> file:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.838.1">
&lt;div class="keypad"&gt;
Â Â Â Â &lt;div class="keypad-body"&gt;
Â Â Â Â Â Â Â Â &lt;div class="keypad-screen"&gt;
Â Â Â Â Â Â Â Â Â Â Â Â &lt;div class="keypad-typed"&gt;@inputDisplay&lt;/div&gt;
Â Â Â Â Â Â Â Â &lt;/div&gt;
Â Â Â Â Â Â Â Â &lt;div class="keypad-row"&gt;
Â Â Â Â Â Â Â Â Â Â Â Â &lt;div class="keypad-button wide command" </span><strong class="bold"><span class="koboSpan" id="kobo.839.1">@onclick="ClearInput"</span></strong><span class="koboSpan" id="kobo.840.1">&gt;C&lt;/div&gt;
Â Â Â Â Â Â Â Â Â Â Â Â &lt;div class="keypad-button command" </span><strong class="bold"><span class="koboSpan" id="kobo.841.1">@onclick="ClearAll"</span></strong><span class="koboSpan" id="kobo.842.1">&gt;CE&lt;/div&gt;
Â Â Â Â Â Â Â Â Â Â Â Â &lt;div class="keypad-button operator" </span><strong class="bold"><span class="koboSpan" id="kobo.843.1">@onclick="@(()=&gt;AppendInput("/"))"</span></strong><span class="koboSpan" id="kobo.844.1">&gt;/&lt;/div&gt;
Â Â Â Â Â Â Â Â &lt;/div&gt;
Â Â Â Â Â Â Â Â &lt;div class="keypad-row"&gt;
Â Â Â Â Â Â Â Â Â Â Â Â &lt;div class="keypad-button" </span><strong class="bold"><span class="koboSpan" id="kobo.845.1">@onclick="@(()=&gt;AppendInput("7"))"</span></strong><span class="koboSpan" id="kobo.846.1">&gt;7&lt;/div&gt;
Â Â Â Â Â Â Â Â Â Â Â Â &lt;div class="keypad-button" </span><strong class="bold"><span class="koboSpan" id="kobo.847.1">@onclick="@(()=&gt;AppendInput("8"))"</span></strong><span class="koboSpan" id="kobo.848.1">&gt;8&lt;/div&gt;
Â Â Â Â Â Â Â Â Â Â Â Â &lt;div class="keypad-button" </span><strong class="bold"><span class="koboSpan" id="kobo.849.1">@onclick="@(()=&gt;AppendInput("9"))"</span></strong><span class="koboSpan" id="kobo.850.1">&gt;9&lt;/div&gt;
Â Â Â Â Â Â Â Â Â Â Â Â &lt;div class="keypad-button operator" </span><strong class="bold"><span class="koboSpan" id="kobo.851.1">@onclick="@(()=&gt;AppendInput("X"))"</span></strong><span class="koboSpan" id="kobo.852.1">&gt;X&lt;/div&gt;
Â Â Â Â Â Â Â Â &lt;/div&gt;
Â Â Â Â Â Â Â Â &lt;div class="keypad-row"&gt;
Â Â Â Â Â Â Â Â Â Â Â Â &lt;div class="keypad-button" </span><strong class="bold"><span class="koboSpan" id="kobo.853.1">@onclick="@(()=&gt;AppendInput("4"))"</span></strong><span class="koboSpan" id="kobo.854.1">&gt;4&lt;/div&gt;
Â Â Â Â Â Â Â Â Â Â Â Â &lt;div class="keypad-button" </span><strong class="bold"><span class="koboSpan" id="kobo.855.1">@onclick="@(()=&gt;AppendInput("5"))"</span></strong><span class="koboSpan" id="kobo.856.1">&gt;5&lt;/div&gt;
Â Â Â Â Â Â Â Â Â Â Â Â &lt;div class="keypad-button" </span><strong class="bold"><span class="koboSpan" id="kobo.857.1">@onclick="@(()=&gt;AppendInput("6"))"</span></strong><span class="koboSpan" id="kobo.858.1">&gt;6&lt;/div&gt;
Â Â Â Â Â Â Â Â Â Â Â Â &lt;div class="keypad-button operator" </span><strong class="bold"><span class="koboSpan" id="kobo.859.1">@onclick="@(()=&gt;AppendInput("-"))"</span></strong><span class="koboSpan" id="kobo.860.1">&gt;âˆ’&lt;/div&gt;
Â Â Â Â Â Â Â Â &lt;/div&gt;
Â Â Â Â Â Â Â Â &lt;div class="keypad-row"&gt;
Â Â Â Â Â Â Â Â Â Â Â Â &lt;div class="keypad-button" </span><strong class="bold"><span class="koboSpan" id="kobo.861.1">@onclick="@(()=&gt;AppendInput("1"))"</span></strong><span class="koboSpan" id="kobo.862.1">&gt;1&lt;/div&gt;
Â Â Â Â Â Â Â Â Â Â Â Â &lt;div class="keypad-button" </span><strong class="bold"><span class="koboSpan" id="kobo.863.1">@onclick="@(()=&gt;AppendInput("2"))"</span></strong><span class="koboSpan" id="kobo.864.1">&gt;2&lt;/div&gt;
Â Â Â Â Â Â Â Â Â Â Â Â &lt;div class="keypad-button" </span><strong class="bold"><span class="koboSpan" id="kobo.865.1">@onclick="@(()=&gt;AppendInput("3"))"</span></strong><span class="koboSpan" id="kobo.866.1">&gt;3&lt;/div&gt;
Â Â Â Â Â Â Â Â Â Â Â Â &lt;div class="keypad-button operator" </span><strong class="bold"><span class="koboSpan" id="kobo.867.1">@onclick="@(()=&gt;AppendInput("+"))"</span></strong><span class="koboSpan" id="kobo.868.1">&gt;+&lt;/div&gt;
Â Â Â Â Â Â Â Â &lt;/div&gt;
Â Â Â Â Â Â Â Â &lt;div class="keypad-row"&gt;
Â Â Â Â Â Â Â Â Â Â Â Â &lt;div class="keypad-button" </span><strong class="bold"><span class="koboSpan" id="kobo.869.1">@onclick="@(()=&gt;AppendInput("."))"</span></strong><span class="koboSpan" id="kobo.870.1">&gt;.&lt;/div&gt;
Â Â Â Â Â Â Â Â Â Â Â Â &lt;div class="keypad-button" </span><strong class="bold"><span class="koboSpan" id="kobo.871.1">@onclick="@(()=&gt;AppendInput("0"))"</span></strong><span class="koboSpan" id="kobo.872.1">&gt;0&lt;/div&gt;
Â Â Â Â Â Â Â Â Â Â Â Â &lt;div class="keypad-button" </span><strong class="bold"><span class="koboSpan" id="kobo.873.1">@onclick="Undo"</span></strong><span class="koboSpan" id="kobo.874.1">&gt;&amp;lt;&lt;/div&gt;
Â Â Â Â Â Â Â Â Â Â Â Â &lt;div class="keypad-button operator" </span><strong class="bold"><span class="koboSpan" id="kobo.875.1">@onclick="EvaluateExpression"</span></strong><span class="koboSpan" id="kobo.876.1">&gt;=&lt;/div&gt;
Â Â Â Â Â Â Â Â &lt;/div&gt;
Â Â Â Â &lt;/div&gt;
&lt;/div&gt;</span></pre> <p class="callout-heading"><span class="koboSpan" id="kobo.877.1">More about Razor event handling</span></p>
<p class="callout"><span class="koboSpan" id="kobo.878.1">To learn more about Razor event handling, </span><span class="No-Break"><span class="koboSpan" id="kobo.879.1">visit </span></span><span class="No-Break"><span class="koboSpan" id="kobo.880.1">https://learn.microsoft.com/en-us/aspnet/core/blazor/components/event-handling?view=aspnetcore-7.0</span></span><span class="No-Break"><span class="koboSpan" id="kobo.881.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.882.1">The keypad is nearly complete. </span><span class="koboSpan" id="kobo.882.2">At this point, you should be able to enter a full expression to </span><a id="_idIndexMarker1252"/><span class="koboSpan" id="kobo.883.1">evaluate and then clear the display. </span><span class="koboSpan" id="kobo.883.2">In the next section, you will create a service to evaluate </span><span class="No-Break"><span class="koboSpan" id="kobo.884.1">the expression.</span></span></p>
<h2 id="_idParaDest-183"><a id="_idTextAnchor912"/><span class="koboSpan" id="kobo.885.1">Creating the Compute service</span></h2>
<p><span class="koboSpan" id="kobo.886.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.887.1">Compute</span></strong><span class="koboSpan" id="kobo.888.1"> service </span><a id="_idIndexMarker1253"/><span class="koboSpan" id="kobo.889.1">evaluates the expression and</span><a id="_idIndexMarker1254"/><span class="koboSpan" id="kobo.890.1"> returns the result. </span><span class="koboSpan" id="kobo.890.2">To illustrate how .NET MAUI and the Blazor application can interact with one another, this service will be injected from the .NET MAUI dependency injection container into the Blazor page. </span><span class="koboSpan" id="kobo.890.3">To implement the </span><strong class="source-inline"><span class="koboSpan" id="kobo.891.1">Compute</span></strong><span class="koboSpan" id="kobo.892.1"> service, follow </span><span class="No-Break"><span class="koboSpan" id="kobo.893.1">these steps:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.894.1">Create a new folder in the root of the project </span><span class="No-Break"><span class="koboSpan" id="kobo.895.1">named </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.896.1">Services</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.897.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.898.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.899.1">Services</span></strong><span class="koboSpan" id="kobo.900.1"> folder, add a new C# class file </span><span class="No-Break"><span class="koboSpan" id="kobo.901.1">named </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.902.1">Compute</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.903.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.904.1">Modify the </span><strong class="source-inline"><span class="koboSpan" id="kobo.905.1">Compute.cs</span></strong><span class="koboSpan" id="kobo.906.1"> file so that it matches the </span><span class="No-Break"><span class="koboSpan" id="kobo.907.1">following code:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.908.1">
namespace Calculator.Services;
internal class Compute
{
Â Â Â Â public string Evaluate(string expression)
Â Â Â Â {
Â Â Â Â Â Â Â Â System.Data.DataTable dataTable = new System.Data.DataTable();
Â Â Â Â Â Â Â Â var finalResult = dataTable.Compute(expression, string.Empty);
Â Â Â Â Â Â Â Â return finalResult.ToString();
Â Â Â Â }
}</span></pre><p class="list-inset"><span class="koboSpan" id="kobo.909.1">This code might be shorter than you expected. </span><span class="koboSpan" id="kobo.909.2">Instead of writing a lot of code to parse the</span><a id="_idIndexMarker1255"/><span class="koboSpan" id="kobo.910.1"> expression and build an expression tree to evaluate, there is already a built-in way of evaluating simple expressions: </span><strong class="source-inline"><span class="koboSpan" id="kobo.911.1">DataTable</span></strong><span class="koboSpan" id="kobo.912.1">. </span><span class="koboSpan" id="kobo.912.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.913.1">DataTable.Compute</span></strong><span class="koboSpan" id="kobo.914.1"> method can evaluate all the expressions that can be built from </span><span class="No-Break"><span class="koboSpan" id="kobo.915.1">the calculator.</span></span></p></li> <li><span class="koboSpan" id="kobo.916.1">Open the </span><strong class="source-inline"><span class="koboSpan" id="kobo.917.1">MauiProgram.cs</span></strong><span class="koboSpan" id="kobo.918.1"> file and add the following highlighted line of code to register the class with </span><span class="No-Break"><span class="koboSpan" id="kobo.919.1">dependency injection:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.920.1">
#if DEBUG
Â Â Â Â builder.Services.AddBlazorWebViewDeveloperTools();
Â Â Â Â builder.Logging.AddDebug();
#endif
Â Â Â Â </span><strong class="bold"><span class="koboSpan" id="kobo.921.1">builder.Services.AddSingleton&lt;Compute&gt;();</span></strong><span class="koboSpan" id="kobo.922.1">
Â Â Â Â return builder.Build();</span></pre></li> <li><span class="koboSpan" id="kobo.923.1">To allow the </span><strong class="source-inline"><span class="koboSpan" id="kobo.924.1">Keypad.razor</span></strong><span class="koboSpan" id="kobo.925.1"> page to use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.926.1">Compute</span></strong><span class="koboSpan" id="kobo.927.1"> type, it needs to be declared with Razor. </span><span class="koboSpan" id="kobo.927.2">Open the </span><strong class="source-inline"><span class="koboSpan" id="kobo.928.1">_Imports.razor</span></strong><span class="koboSpan" id="kobo.929.1"> file and add the following highlighted line of code to the end of </span><span class="No-Break"><span class="koboSpan" id="kobo.930.1">the file:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.931.1">
@using Calculator.Services</span></pre><p class="list-inset"><span class="koboSpan" id="kobo.932.1">Without this line, you could still use the type, but you would have to fully qualify it as </span><strong class="source-inline"><span class="koboSpan" id="kobo.933.1">Calculator.Services.Compute</span></strong><span class="koboSpan" id="kobo.934.1">. </span><span class="koboSpan" id="kobo.934.2">This is the Razor equivalent of </span><strong class="source-inline"><span class="koboSpan" id="kobo.935.1">global</span></strong> <strong class="source-inline"><span class="koboSpan" id="kobo.936.1">using</span></strong><span class="koboSpan" id="kobo.937.1"> directives in </span><span class="No-Break"><span class="koboSpan" id="kobo.938.1">C# files.</span></span></p></li> <li><span class="koboSpan" id="kobo.939.1">Now, open the </span><strong class="source-inline"><span class="koboSpan" id="kobo.940.1">Keypad.razor</span></strong><span class="koboSpan" id="kobo.941.1"> file and add the following line of code after the </span><strong class="source-inline"><span class="koboSpan" id="kobo.942.1">@</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.943.1">page</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.944.1"> directive:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.945.1">
@inject Compute compute</span></pre><p class="list-inset"><span class="koboSpan" id="kobo.946.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.947.1">@inject</span></strong><span class="koboSpan" id="kobo.948.1"> directive will use the .NET MAUI dependency injection container to resolve the</span><a id="_idIndexMarker1256"/><span class="koboSpan" id="kobo.949.1"> type provided as the first parameter</span><a id="_idIndexMarker1257"/><span class="koboSpan" id="kobo.950.1"> and assign it to the variable defined in the </span><span class="No-Break"><span class="koboSpan" id="kobo.951.1">second parameter.</span></span></p></li> <li><span class="koboSpan" id="kobo.952.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.953.1">EvaluateExpression</span></strong><span class="koboSpan" id="kobo.954.1"> method, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.955.1">compute</span></strong><span class="koboSpan" id="kobo.956.1"> variable can be used to evaluate the expression contained in </span><strong class="source-inline"><span class="koboSpan" id="kobo.957.1">inputDisplay</span></strong><span class="koboSpan" id="kobo.958.1">, as shown in the following </span><span class="No-Break"><span class="koboSpan" id="kobo.959.1">highlighted code:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.960.1">
void EvaluateExpression()
{
Â Â Â Â var expression = inputDisplay;
</span><strong class="bold"><span class="koboSpan" id="kobo.961.1">Â Â Â Â var result = compute.Evaluate(inputDisplay.Replace('X', '*'));</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.962.1">Â Â Â Â inputDisplay = result;</span></strong><span class="koboSpan" id="kobo.963.1">
Â Â Â Â clearInputBeforeAppend = true;
}</span></pre><p class="list-inset"><span class="koboSpan" id="kobo.964.1">Here, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.965.1">Evaluate</span></strong><span class="koboSpan" id="kobo.966.1"> method is called with </span><strong class="source-inline"><span class="koboSpan" id="kobo.967.1">inputDisplay</span></strong><span class="koboSpan" id="kobo.968.1"> as the parameter. </span><strong class="source-inline"><span class="koboSpan" id="kobo.969.1">inputDisplay</span></strong><span class="koboSpan" id="kobo.970.1"> is first modified to replace all the </span><strong class="source-inline"><span class="koboSpan" id="kobo.971.1">X</span></strong><span class="koboSpan" id="kobo.972.1"> values in the string with </span><strong class="source-inline"><span class="koboSpan" id="kobo.973.1">*</span></strong><span class="koboSpan" id="kobo.974.1"> as that is what the </span><strong class="source-inline"><span class="koboSpan" id="kobo.975.1">DataTable</span></strong><span class="koboSpan" id="kobo.976.1"> expects for multiplication. </span><span class="koboSpan" id="kobo.976.2">The result is then assigned </span><span class="No-Break"><span class="koboSpan" id="kobo.977.1">to </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.978.1">inputDisplay</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.979.1">.</span></span></p></li> </ol>
<p><span class="koboSpan" id="kobo.980.1">At this point, the calculator app can accept input of a combination of numbers and operators and evaluate the result, displaying it to the user. </span><span class="koboSpan" id="kobo.980.2">The user can also clear out the display. </span><span class="koboSpan" id="kobo.980.3">In the</span><a id="_idIndexMarker1258"/><span class="koboSpan" id="kobo.981.1"> next section, we will explore more </span><a id="_idIndexMarker1259"/><span class="koboSpan" id="kobo.982.1">interoperability by giving the </span><span class="No-Break"><span class="koboSpan" id="kobo.983.1">calculator memory.</span></span></p>
<h2 id="_idParaDest-184"><a id="_idTextAnchor913"/><span class="koboSpan" id="kobo.984.1">Adding memory functions</span></h2>
<p><span class="koboSpan" id="kobo.985.1">Most calculators </span><a id="_idIndexMarker1260"/><span class="koboSpan" id="kobo.986.1">can store previous calculations. </span><span class="koboSpan" id="kobo.986.2">In this </span><a id="_idIndexMarker1261"/><span class="koboSpan" id="kobo.987.1">section, you will add a list of previous calculations to the calculator app and recall previous calculations to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.988.1">inputDisplay</span></strong><span class="koboSpan" id="kobo.989.1"> parameter of </span><span class="No-Break"><span class="koboSpan" id="kobo.990.1">the keypad.</span></span></p>
<p><span class="koboSpan" id="kobo.991.1">The code will use .NET MAUI controls to render right next to </span><strong class="source-inline"><span class="koboSpan" id="kobo.992.1">WebViewControl</span></strong><span class="koboSpan" id="kobo.993.1">. </span><span class="koboSpan" id="kobo.993.2">A new class, </span><strong class="source-inline"><span class="koboSpan" id="kobo.994.1">Calculations</span></strong><span class="koboSpan" id="kobo.995.1">, will be used to manage </span><span class="No-Break"><span class="koboSpan" id="kobo.996.1">the listing.</span></span></p>
<p><span class="koboSpan" id="kobo.997.1">To add the memory functions to the calculator app, follow </span><span class="No-Break"><span class="koboSpan" id="kobo.998.1">these steps:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.999.1">Create a new folder </span><span class="No-Break"><span class="koboSpan" id="kobo.1000.1">named </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1001.1">ViewModels</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1002.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.1003.1">Add a new class named </span><strong class="source-inline"><span class="koboSpan" id="kobo.1004.1">Calculations</span></strong><span class="koboSpan" id="kobo.1005.1"> in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1006.1">ViewModels</span></strong><span class="koboSpan" id="kobo.1007.1"> folder and modify the file so that it matches the </span><span class="No-Break"><span class="koboSpan" id="kobo.1008.1">following code:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.1009.1">
using System.Collections.ObjectModel;
namespace Calculator.ViewModels;
public class Calculations : ObservableCollection&lt;Calculation&gt;
{
}
public class Calculation : Tuple&lt;string, string&gt;
{
Â Â Â Â public Calculation(string expression, string result) : base(expression, result) { }
Â Â Â Â public string Expression =&gt; this.Item1;
Â Â Â Â public string Result =&gt; this.Item2;
}</span></pre><p class="list-inset"><span class="koboSpan" id="kobo.1010.1">This code adds two classes â€“ </span><strong class="source-inline"><span class="koboSpan" id="kobo.1011.1">Calculations</span></strong><span class="koboSpan" id="kobo.1012.1">, which is just shorthand for </span><strong class="source-inline"><span class="koboSpan" id="kobo.1013.1">Observable Collection&lt;Calculation&gt;</span></strong><span class="koboSpan" id="kobo.1014.1">, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.1015.1">Calculation</span></strong><span class="koboSpan" id="kobo.1016.1">, which is </span><strong class="source-inline"><span class="koboSpan" id="kobo.1017.1">Tuple&lt;string, string&gt;</span></strong><span class="koboSpan" id="kobo.1018.1"> and defines two properties to reference </span><strong class="source-inline"><span class="koboSpan" id="kobo.1019.1">Item1</span></strong><span class="koboSpan" id="kobo.1020.1"> as </span><strong class="source-inline"><span class="koboSpan" id="kobo.1021.1">Expression</span></strong><span class="koboSpan" id="kobo.1022.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.1023.1">Item2</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.1024.1">as </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1025.1">Result</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1026.1">.</span></span></p></li> <li><span class="koboSpan" id="kobo.1027.1">Add a reference to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1028.1">CommunityToolkit.Mvvm</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.1029.1">NuGet package.</span></span></li>
<li><span class="koboSpan" id="kobo.1030.1">Add a new class named </span><strong class="source-inline"><span class="koboSpan" id="kobo.1031.1">MainPageViewModel</span></strong><span class="koboSpan" id="kobo.1032.1"> to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1033.1">ViewModels</span></strong><span class="koboSpan" id="kobo.1034.1"> folder and modify</span><a id="_idIndexMarker1262"/><span class="koboSpan" id="kobo.1035.1"> the file, as shown in the</span><a id="_idIndexMarker1263"/> <span class="No-Break"><span class="koboSpan" id="kobo.1036.1">following code:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.1037.1">
using CommunityToolkit.Mvvm.Input;
using CommunityToolkit.Mvvm.Messaging;
namespace Calculator.ViewModels;
public partial class MainPageViewModel
{
Â Â Â Â IMessenger messenger;
Â Â Â Â public MainPageViewModel(Calculations results, IMessenger messenger)
Â Â Â Â {
Â Â Â Â Â Â Â Â Results = results;
Â Â Â Â Â Â Â Â this.messenger = messenger;
Â Â Â Â }
Â Â Â Â public Calculations Results { get; init; }
Â Â Â Â [RelayCommand]
Â Â Â Â public void Recall(Calculation sender)
Â Â Â Â {
Â Â Â Â Â Â Â Â messenger.Send(sender);
Â Â Â Â }
}</span></pre><p class="list-inset"><span class="koboSpan" id="kobo.1038.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.1039.1">MainViewModel</span></strong><span class="koboSpan" id="kobo.1040.1"> class uses two features of </span><strong class="source-inline"><span class="koboSpan" id="kobo.1041.1">CommunityToolkit</span></strong><span class="koboSpan" id="kobo.1042.1">: </span><strong class="source-inline"><span class="koboSpan" id="kobo.1043.1">RelayCommand</span></strong><span class="koboSpan" id="kobo.1044.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.1045.1">IMessenger</span></strong><span class="koboSpan" id="kobo.1046.1">. </span><span class="koboSpan" id="kobo.1046.2">As in the other chapters, </span><strong class="source-inline"><span class="koboSpan" id="kobo.1047.1">RelayCommand</span></strong><span class="koboSpan" id="kobo.1048.1"> is used to bind methods to XAML actions. </span><strong class="source-inline"><span class="koboSpan" id="kobo.1049.1">IMessenger</span></strong><span class="koboSpan" id="kobo.1050.1"> is an interface for sending messages between parts of your application. </span><span class="koboSpan" id="kobo.1050.2">It is helpful when you donâ€™t want to take a hard dependency between two classes, especially if it creates a circular reference. </span><strong class="source-inline"><span class="koboSpan" id="kobo.1051.1">CommunityToolkit</span></strong><span class="koboSpan" id="kobo.1052.1"> provides a default implementation of </span><strong class="source-inline"><span class="koboSpan" id="kobo.1053.1">IMessenger</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.1054.1">called </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1055.1">WeakReferenceMessenger</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1056.1">.</span></span></p></li> <li><span class="koboSpan" id="kobo.1057.1">Open </span><strong class="source-inline"><span class="koboSpan" id="kobo.1058.1">MauiProgram.cs</span></strong><span class="koboSpan" id="kobo.1059.1"> and </span><a id="_idIndexMarker1264"/><span class="koboSpan" id="kobo.1060.1">add the</span><a id="_idIndexMarker1265"/><span class="koboSpan" id="kobo.1061.1"> following </span><strong class="source-inline"><span class="koboSpan" id="kobo.1062.1">using</span></strong><span class="koboSpan" id="kobo.1063.1"> declarations to the top of </span><span class="No-Break"><span class="koboSpan" id="kobo.1064.1">the file:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.1065.1">
using Calculator.ViewModels;
using CommunityToolkit.Mvvm.Messaging;</span></pre></li> <li><span class="koboSpan" id="kobo.1066.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1067.1">CreateMauiApp</span></strong><span class="koboSpan" id="kobo.1068.1"> method make the following </span><span class="No-Break"><span class="koboSpan" id="kobo.1069.1">highlighted changes:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.1070.1">
builder.Services.AddSingleton&lt;Compute&gt;();
</span><strong class="bold"><span class="koboSpan" id="kobo.1071.1">builder.Services.AddSingleton&lt;Calculations&gt;();</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1072.1">builder.Services.AddSingleton&lt;MainPage&gt;();</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1073.1">builder.Services.AddSingleton&lt;MainPageViewModel&gt;();</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1074.1">builder.Services.AddSingleton&lt;IMessenger&gt;(WeakReferenceMessenger.Default);</span></strong><span class="koboSpan" id="kobo.1075.1">
return builder.Build();</span></pre><p class="list-inset"><span class="koboSpan" id="kobo.1076.1">This adds </span><strong class="source-inline"><span class="koboSpan" id="kobo.1077.1">MainPage</span></strong><span class="koboSpan" id="kobo.1078.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.1079.1">MainPageViewModel</span></strong><span class="koboSpan" id="kobo.1080.1">, and the default instance of </span><strong class="source-inline"><span class="koboSpan" id="kobo.1081.1">WeakReferenceMessenger</span></strong><span class="koboSpan" id="kobo.1082.1"> to the dependency injection container. </span><span class="koboSpan" id="kobo.1082.2">The next few steps will enable </span><strong class="source-inline"><span class="koboSpan" id="kobo.1083.1">MainPage</span></strong><span class="koboSpan" id="kobo.1084.1"> to be initialized via </span><span class="No-Break"><span class="koboSpan" id="kobo.1085.1">dependency injection.</span></span></p></li> <li><span class="koboSpan" id="kobo.1086.1">Open </span><strong class="source-inline"><span class="koboSpan" id="kobo.1087.1">MainView.xaml.cs</span></strong><span class="koboSpan" id="kobo.1088.1"> and make</span><a id="_idIndexMarker1266"/><span class="koboSpan" id="kobo.1089.1"> the following </span><span class="No-Break"><span class="koboSpan" id="kobo.1090.1">highlighted changes:</span></span><pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.1091.1">using Calculator.ViewModels;</span></strong><span class="koboSpan" id="kobo.1092.1">
namespace Calculator;
public partial class MainPage : ContentPage
{
Â Â Â Â public MainPage(</span><strong class="bold"><span class="koboSpan" id="kobo.1093.1">MainPageViewModel vm</span></strong><span class="koboSpan" id="kobo.1094.1">)
Â Â Â Â {
Â Â Â Â Â Â Â Â InitializeComponent();
Â Â Â Â Â Â Â Â </span><strong class="bold"><span class="koboSpan" id="kobo.1095.1">BindingContext = vm;</span></strong><span class="koboSpan" id="kobo.1096.1">
Â Â Â Â }
}</span></pre><p class="list-inset"><span class="koboSpan" id="kobo.1097.1">As in other</span><a id="_idIndexMarker1267"/><span class="koboSpan" id="kobo.1098.1"> chapters, the constructor for the view is updated to accept the view model as a parameter, and it is assigned </span><span class="No-Break"><span class="koboSpan" id="kobo.1099.1">as </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1100.1">BindingContext</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1101.1">.</span></span></p></li> <li><span class="koboSpan" id="kobo.1102.1">Open </span><strong class="source-inline"><span class="koboSpan" id="kobo.1103.1">App.xaml.cs</span></strong><span class="koboSpan" id="kobo.1104.1">, modify the constructor, and add the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1105.1">OnHandlerChanging</span></strong><span class="koboSpan" id="kobo.1106.1"> event handler, as shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.1107.1">following code:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.1108.1">
public App()
{
Â Â Â Â InitializeComponent();
}
protected override void OnHandlerChanging(HandlerChangingEventArgs args)
{
Â Â Â Â base.OnHandlerChanging(args);
Â Â Â Â MainPage = args.NewHandler.MauiContext.Services.GetService&lt;MainPage&gt;();
}</span></pre><p class="list-inset"><span class="koboSpan" id="kobo.1109.1">Since a .NET MAUI Blazor app does not use </span><strong class="source-inline"><span class="koboSpan" id="kobo.1110.1">Shell</span></strong><span class="koboSpan" id="kobo.1111.1"> by default, the views cannot be initialized via dependency injection the same way as is done with </span><strong class="source-inline"><span class="koboSpan" id="kobo.1112.1">Shell</span></strong><span class="koboSpan" id="kobo.1113.1">. </span><span class="koboSpan" id="kobo.1113.2">Instead, the instance of </span><strong class="source-inline"><span class="koboSpan" id="kobo.1114.1">MainPage</span></strong><span class="koboSpan" id="kobo.1115.1"> is obtained after </span><strong class="source-inline"><span class="koboSpan" id="kobo.1116.1">Handler</span></strong><span class="koboSpan" id="kobo.1117.1"> has been set. </span><span class="koboSpan" id="kobo.1117.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.1118.1">OnHandlerChanging</span></strong><span class="koboSpan" id="kobo.1119.1"> event is used to get the reference to the new </span><strong class="source-inline"><span class="koboSpan" id="kobo.1120.1">Handler</span></strong><span class="koboSpan" id="kobo.1121.1">, which then provides </span><strong class="source-inline"><span class="koboSpan" id="kobo.1122.1">MauiContext</span></strong><span class="koboSpan" id="kobo.1123.1"> to the dependency </span><span class="No-Break"><span class="koboSpan" id="kobo.1124.1">injection container.</span></span></p></li> <li><span class="koboSpan" id="kobo.1125.1">Open </span><strong class="source-inline"><span class="koboSpan" id="kobo.1126.1">_Imports.razor</span></strong><span class="koboSpan" id="kobo.1127.1"> and</span><a id="_idIndexMarker1268"/><span class="koboSpan" id="kobo.1128.1"> add the following</span><a id="_idIndexMarker1269"/><span class="koboSpan" id="kobo.1129.1"> lines to the end of </span><span class="No-Break"><span class="koboSpan" id="kobo.1130.1">the file:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.1131.1">
@using Calculator.ViewModels
@using CommunityToolkit.Mvvm.Messaging</span></pre></li> <li><span class="koboSpan" id="kobo.1132.1">Open </span><strong class="source-inline"><span class="koboSpan" id="kobo.1133.1">Keypad.razor</span></strong><span class="koboSpan" id="kobo.1134.1"> and add the following </span><span class="No-Break"><span class="koboSpan" id="kobo.1135.1">highlighted lines:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.1136.1">
@inject Compute compute
</span><strong class="bold"><span class="koboSpan" id="kobo.1137.1">@inject Calculations calculations</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1138.1">@inject IMessenger messenger</span></strong><span class="koboSpan" id="kobo.1139.1">
&lt;div class="keypad"&gt;</span></pre><p class="list-inset"><span class="koboSpan" id="kobo.1140.1">This will inject the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1141.1">Calculations</span></strong><span class="koboSpan" id="kobo.1142.1"> instance as </span><strong class="source-inline"><span class="koboSpan" id="kobo.1143.1">calculations</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.1144.1">and </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1145.1">WeakReference</span></strong></span><strong class="source-inline"><span class="koboSpan" id="kobo.1146.1">
Messenger</span></strong><span class="koboSpan" id="kobo.1147.1"> as </span><strong class="source-inline"><span class="koboSpan" id="kobo.1148.1">messenger</span></strong><span class="koboSpan" id="kobo.1149.1"> from the .NET MAUI dependency </span><span class="No-Break"><span class="koboSpan" id="kobo.1150.1">injection container.</span></span></p></li> <li><span class="koboSpan" id="kobo.1151.1">Modify the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1152.1">ClearAll</span></strong><span class="koboSpan" id="kobo.1153.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.1154.1">EvaluateExpression</span></strong><span class="koboSpan" id="kobo.1155.1"> methods and add </span><span class="No-Break"><span class="koboSpan" id="kobo.1156.1">an </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1157.1">OnAfter</span></strong></span><strong class="source-inline"><span class="koboSpan" id="kobo.1158.1">
RenderAsync</span></strong><span class="koboSpan" id="kobo.1159.1"> method, as </span><a id="_idIndexMarker1270"/><span class="koboSpan" id="kobo.1160.1">shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.1161.1">following code:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.1162.1">
void ClearAll()
{
Â Â Â Â ClearInput();
Â Â Â Â </span><strong class="bold"><span class="koboSpan" id="kobo.1163.1">calculations.Clear();</span></strong><span class="koboSpan" id="kobo.1164.1">
}
void EvaluateExpression()
{
Â Â Â Â var expression = inputDisplay;
Â Â Â Â var result = compute.Evaluate(inputDisplay.Replace('X', '*'));
Â Â Â Â </span><strong class="bold"><span class="koboSpan" id="kobo.1165.1">calculations.Add(new(expression, result));</span></strong><span class="koboSpan" id="kobo.1166.1">
Â Â Â Â inputDisplay = result;
Â Â Â Â clearInputBeforeAppend = true;
}
</span><strong class="bold"><span class="koboSpan" id="kobo.1167.1">protected override Task OnAfterRenderAsync(bool firstRender)</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1168.1">{</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1169.1">Â Â Â Â if (firstRender)</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1170.1">Â Â Â Â {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1171.1">Â Â Â Â Â Â Â Â messenger.Register&lt;Calculation&gt;(this, (sender, er) =&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1172.1">Â Â Â Â Â Â Â Â {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1173.1">Â Â Â Â Â Â Â Â Â Â Â Â inputDisplay = er.Expression;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1174.1">Â Â Â Â Â Â Â Â Â Â Â Â clearInputBeforeAppend = true;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1175.1">Â Â Â Â Â Â Â Â Â Â Â Â StateHasChanged();</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1176.1">Â Â Â Â Â Â Â Â });</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1177.1">Â Â Â Â }</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1178.1">Â Â Â Â return base.OnAfterRenderAsync(firstRender);</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1179.1">}</span></strong></pre><p class="list-inset"><strong class="source-inline"><span class="koboSpan" id="kobo.1180.1">ClearAll</span></strong><span class="koboSpan" id="kobo.1181.1"> will just clear the collection, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.1182.1">EvaluateExpression</span></strong><span class="koboSpan" id="kobo.1183.1"> will add the new </span><strong class="source-inline"><span class="koboSpan" id="kobo.1184.1">Calulation</span></strong><span class="koboSpan" id="kobo.1185.1"> to the collection. </span><strong class="source-inline"><span class="koboSpan" id="kobo.1186.1">OnAfterRenderAsync</span></strong><span class="koboSpan" id="kobo.1187.1"> is used to </span><strong class="source-inline"><span class="koboSpan" id="kobo.1188.1">register</span></strong><span class="koboSpan" id="kobo.1189.1"> this class to receive messages for any </span><strong class="source-inline"><span class="koboSpan" id="kobo.1190.1">Calculation</span></strong><span class="koboSpan" id="kobo.1191.1"> objects. </span><span class="koboSpan" id="kobo.1191.2">When a message is received, </span><strong class="source-inline"><span class="koboSpan" id="kobo.1192.1">inputDisplay</span></strong><span class="koboSpan" id="kobo.1193.1"> is set to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1194.1">Expression</span></strong><span class="koboSpan" id="kobo.1195.1"> value of </span><strong class="source-inline"><span class="koboSpan" id="kobo.1196.1">Calculation</span></strong><span class="koboSpan" id="kobo.1197.1">, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.1198.1">StateHasChanged</span></strong><span class="koboSpan" id="kobo.1199.1"> is called to force the UI to refresh with the </span><span class="No-Break"><span class="koboSpan" id="kobo.1200.1">updated value.</span></span></p></li> <li><span class="koboSpan" id="kobo.1201.1">Open the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1202.1">Shared/MainLayout.razor.css</span></strong><span class="koboSpan" id="kobo.1203.1"> file and add the following line to the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1204.1">page</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1205.1"> class:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.1206.1">
background-color: black;</span></pre><p class="list-inset"><span class="koboSpan" id="kobo.1207.1">This is</span><a id="_idIndexMarker1271"/><span class="koboSpan" id="kobo.1208.1"> simply for </span><a id="_idIndexMarker1272"/><span class="koboSpan" id="kobo.1209.1">aesthetics and makes the areas surrounding the </span><span class="No-Break"><span class="koboSpan" id="kobo.1210.1">calculator black.</span></span></p></li> <li><span class="koboSpan" id="kobo.1211.1">Open the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1212.1">MainPage.xaml</span></strong><span class="koboSpan" id="kobo.1213.1"> file and modify it so that it matches the </span><span class="No-Break"><span class="koboSpan" id="kobo.1214.1">following code:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.1215.1">
&lt;ContentPage
Â Â Â Â 
Â Â Â Â 
Â Â Â Â 
Â Â Â Â 
Â Â Â Â x:Class="Calculator.MainPage"
Â Â Â Â x:DataType="viewModels:MainPageViewModel"&gt;
Â Â Â Â &lt;Grid BackgroundColor="Black"&gt;
Â Â Â Â Â Â &lt;Grid.RowDefinitions&gt;
Â Â Â Â Â Â Â Â &lt;RowDefinition Height="1*" /&gt;
Â Â Â Â Â Â Â Â &lt;RowDefinition Height="1*" /&gt;
Â Â Â Â Â Â &lt;/Grid.RowDefinitions&gt;
Â Â Â Â Â Â &lt;ScrollView Grid.Row="0" BackgroundColor="Bisque" WidthRequest="400" VerticalScrollBarVisibility="Always"&gt;
Â Â Â Â Â Â Â Â &lt;CollectionView ItemsSource="{Binding Results}" ItemsUpdatingScrollMode="KeepLastItemInView"&gt;
Â Â Â Â Â Â Â Â Â Â &lt;CollectionView.ItemTemplate&gt;
Â Â Â Â Â Â Â Â Â Â Â Â &lt;DataTemplate x:DataType="viewModels:ExpressionResult"&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;SwipeView&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;SwipeView.LeftItems&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;SwipeItems Mode="Execute"&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;SwipeItem
Text="Recall"Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â BackgroundColor="LightPink"Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Command="{Binding Source={RelativeSource AncestorType={x:Type viewModels:MainPageViewModel}}, Path=RecallCommand}"Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â CommandParameter="{Binding}"/&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;/SwipeItems&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;/SwipeView.LeftItems&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;VerticalStackLayout&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;HorizontalStackLayout Padding="10" HorizontalOptions="EndAndExpand"&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;Label Text="{Binding Expression}" FontSize="Large" TextColor="Black" HorizontalTextAlignment="End" HorizontalOptions="EndAndExpand"/&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;Label Text="=" TextColor="Blue" FontSize="Large" HorizontalTextAlignment="End" HorizontalOptions="EndAndExpand"/&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;Label Text="{Binding Result}" FontSize="Large" TextColor="Black" HorizontalTextAlignment="End" HorizontalOptions="EndAndExpand"/&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;/HorizontalStackLayout&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;Line Stroke="LightSlateGray" X2="400" /&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;Line Stroke="Black" X2="400" /&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;/VerticalStackLayout&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;/SwipeView&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;/DataTemplate&gt;
Â Â Â Â Â Â Â Â Â Â Â Â &lt;/CollectionView.ItemTemplate&gt;
Â Â Â Â Â Â Â Â Â Â &lt;/CollectionView&gt;
Â Â Â Â Â Â &lt;/ScrollView&gt;
Â Â Â Â Â Â &lt;BlazorWebView Grid.Row="1" x:Name="blazorWebView" HostPage="wwwroot/index.html" HeightRequest="540"&gt;
Â Â Â Â Â Â Â Â &lt;BlazorWebView.RootComponents&gt;
Â Â Â Â Â Â Â Â Â Â &lt;RootComponent Selector="#app" ComponentType="{x:Type local:Main}" /&gt;
Â Â Â Â Â Â Â Â &lt;/BlazorWebView.RootComponents&gt;
Â Â Â Â Â Â &lt;/BlazorWebView&gt;
Â Â Â Â &lt;/Grid&gt;
&lt;/ContentPage&gt;</span></pre><p class="list-inset"><span class="koboSpan" id="kobo.1216.1">A </span><strong class="source-inline"><span class="koboSpan" id="kobo.1217.1">Grid</span></strong><span class="koboSpan" id="kobo.1218.1"> element with</span><a id="_idIndexMarker1273"/><span class="koboSpan" id="kobo.1219.1"> two rows defined is used to </span><a id="_idIndexMarker1274"/><span class="koboSpan" id="kobo.1220.1">contain the new display for previous calculations and the original </span><strong class="source-inline"><span class="koboSpan" id="kobo.1221.1">BlazorWebView</span></strong><span class="koboSpan" id="kobo.1222.1"> control. </span><span class="koboSpan" id="kobo.1222.2">The calculations are rendered using </span><strong class="source-inline"><span class="koboSpan" id="kobo.1223.1">ScrollView</span></strong><span class="koboSpan" id="kobo.1224.1">, which contains </span><strong class="source-inline"><span class="koboSpan" id="kobo.1225.1">CollectionView</span></strong><span class="koboSpan" id="kobo.1226.1">. </span><span class="koboSpan" id="kobo.1226.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.1227.1">CollectionView.ItemTemplate</span></strong><span class="koboSpan" id="kobo.1228.1"> property contains </span><strong class="source-inline"><span class="koboSpan" id="kobo.1229.1">DataTemplate</span></strong><span class="koboSpan" id="kobo.1230.1"> for each </span><strong class="source-inline"><span class="koboSpan" id="kobo.1231.1">Calculation</span></strong><span class="koboSpan" id="kobo.1232.1">. </span><span class="koboSpan" id="kobo.1232.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.1233.1">SwipeView</span></strong><span class="koboSpan" id="kobo.1234.1"> control allows the user to swipe in either the up, down, left, or right direction to expose additional commands. </span><span class="koboSpan" id="kobo.1234.2">Each direction has an element to define those actions. </span><span class="koboSpan" id="kobo.1234.3">For </span><strong class="source-inline"><span class="koboSpan" id="kobo.1235.1">Calculation</span></strong><span class="koboSpan" id="kobo.1236.1"> items, when the user swipes right, it exposes a </span><strong class="source-inline"><span class="koboSpan" id="kobo.1237.1">Recall</span></strong><span class="koboSpan" id="kobo.1238.1"> item, which is bound to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1239.1">Recall</span></strong><span class="koboSpan" id="kobo.1240.1"> command of </span><strong class="source-inline"><span class="koboSpan" id="kobo.1241.1">MainPageViewModel</span></strong><span class="koboSpan" id="kobo.1242.1">. </span><span class="koboSpan" id="kobo.1242.2">The display for </span><strong class="source-inline"><span class="koboSpan" id="kobo.1243.1">Calculation</span></strong><span class="koboSpan" id="kobo.1244.1"> uses a combination of horizontal and vertical </span><strong class="source-inline"><span class="koboSpan" id="kobo.1245.1">StackLayout</span></strong><span class="koboSpan" id="kobo.1246.1"> controls to stack </span><strong class="source-inline"><span class="koboSpan" id="kobo.1247.1">Expression</span></strong><span class="koboSpan" id="kobo.1248.1"> on top of </span><strong class="source-inline"><span class="koboSpan" id="kobo.1249.1">Result</span></strong><span class="koboSpan" id="kobo.1250.1"> with </span><strong class="source-inline"><span class="koboSpan" id="kobo.1251.1">=</span></strong><span class="koboSpan" id="kobo.1252.1">, all aligned to </span><span class="No-Break"><span class="koboSpan" id="kobo.1253.1">the left.</span></span></p></li> </ol>
<p><span class="koboSpan" id="kobo.1254.1">That completes the</span><a id="_idIndexMarker1275"/><span class="koboSpan" id="kobo.1255.1"> main functionality of our calculator app. </span><span class="koboSpan" id="kobo.1255.2">The next section deals with some aesthetics of the main window when running on a desktop such as Windows </span><span class="No-Break"><span class="koboSpan" id="kobo.1256.1">or macOS.</span></span></p>
<h2 id="_idParaDest-185"><a id="_idTextAnchor914"/><span class="koboSpan" id="kobo.1257.1">Resizing the main window</span></h2>
<p><span class="koboSpan" id="kobo.1258.1">The calculator </span><a id="_idIndexMarker1276"/><span class="koboSpan" id="kobo.1259.1">app is defined to be a fixed size. </span><span class="koboSpan" id="kobo.1259.2">Most of the projects in this book have allowed the controls to grow or shrink with changes to the window size. </span><span class="koboSpan" id="kobo.1259.3">For our calculator app, the main window should be fixed so that it appears in the best way possible. </span><span class="koboSpan" id="kobo.1259.4">To fix the window size when the app launches, open the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1260.1">App.xaml.cs</span></strong><span class="koboSpan" id="kobo.1261.1"> file and add the following method to the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1262.1">App</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1263.1"> class:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1264.1">
protected override Window CreateWindow(IActivationState activationState)
{
Â Â Â Â var window = base.CreateWindow(activationState);
Â Â Â Â if (OperatingSystem.IsWindows() || OperatingSystem.IsMacCatalyst())
Â Â Â Â {
Â Â Â Â Â Â Â Â window.Created += Window_Created;
Â Â Â Â }
Â Â Â Â return window;
}
private async void Window_Created(object sender, EventArgs e)
{
Â Â Â Â const int defaultWidth = 450;
Â Â Â Â const int defaultHeight = 800;
Â Â Â Â var window = (Window)sender;
Â Â Â Â window.Width = defaultWidth;
Â Â Â Â window.Height = defaultHeight;
Â Â Â Â window.X = -defaultWidth;
Â Â Â Â window.Y = -defaultHeight;
Â Â Â Â await window.Dispatcher.DispatchAsync(() =&gt; { });
Â Â Â Â var displayInfo = DeviceDisplay.Current.MainDisplayInfo;
Â Â Â Â window.X = (displayInfo.Width / displayInfo.Density - window.Width) / 2;
Â Â Â Â window.Y = (displayInfo.Height / displayInfo.Density - window.Height) / 2;
Â Â Â Â window.Created -= Window_Created;
}</span></pre> <p><span class="koboSpan" id="kobo.1265.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.1266.1">CreateWindow</span></strong><span class="koboSpan" id="kobo.1267.1"> method is </span><a id="_idIndexMarker1277"/><span class="koboSpan" id="kobo.1268.1">overridden so that the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1269.1">Window.Created</span></strong><span class="koboSpan" id="kobo.1270.1"> event can have a custom handler attached to it if the app is running on Windows or macOS. </span><span class="koboSpan" id="kobo.1270.2">The work of resizing the window is done in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1271.1">Window_Created</span></strong><span class="koboSpan" id="kobo.1272.1"> method. </span><span class="koboSpan" id="kobo.1272.2">It uses the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1273.1">defaultHeight</span></strong><span class="koboSpan" id="kobo.1274.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.1275.1">defaultWidth</span></strong><span class="koboSpan" id="kobo.1276.1"> constants to set the new windowsâ€™ height, width, and location on the screen. </span><span class="koboSpan" id="kobo.1276.2">The method then waits for all threads to have finished before altering the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1277.1">X</span></strong><span class="koboSpan" id="kobo.1278.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.1279.1">Y</span></strong><span class="koboSpan" id="kobo.1280.1"> properties of the window again, but this time accounting for the screen pixel density. </span><span class="koboSpan" id="kobo.1280.2">Finally, it detaches</span><a id="_idIndexMarker1278"/><span class="koboSpan" id="kobo.1281.1"> the </span><span class="No-Break"><span class="koboSpan" id="kobo.1282.1">event handler</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer201">
<span class="koboSpan" id="kobo.1283.1"><img alt="Figure 11.1ï»¿5 â€“ The completed calculator project" src="image/B19214_11_15.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.1284.1">Figure 11.15 â€“ The completed calculator project</span></p>
<h1 id="_idParaDest-186"><a id="_idTextAnchor915"/><span class="koboSpan" id="kobo.1285.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.1286.1">Excellent work! </span><span class="koboSpan" id="kobo.1286.2">In this chapter, you completed a project that used the .NET MAUI Blazor template. </span><span class="koboSpan" id="kobo.1286.3">You created a UI using HTML, updated it with C# code, and then implemented a service that was managed by .NET MAUI and injected it into a Razor page. </span><span class="koboSpan" id="kobo.1286.4">Then, you used </span><strong class="source-inline"><span class="koboSpan" id="kobo.1287.1">CollectionView</span></strong><span class="koboSpan" id="kobo.1288.1"> to display a list of the previous calculations. </span><span class="koboSpan" id="kobo.1288.2">Within </span><strong class="source-inline"><span class="koboSpan" id="kobo.1289.1">CollectionView</span></strong> <strong class="source-inline"><span class="koboSpan" id="kobo.1290.1">ItemTemplate</span></strong><span class="koboSpan" id="kobo.1291.1">, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1292.1">SwipeView</span></strong><span class="koboSpan" id="kobo.1293.1"> control was used to recall a previous calculation to the keypad for additional editing </span><span class="No-Break"><span class="koboSpan" id="kobo.1294.1">and reevaluation.</span></span></p>
<p><span class="koboSpan" id="kobo.1295.1">To extend this project even further, consider </span><span class="No-Break"><span class="koboSpan" id="kobo.1296.1">the following:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.1297.1">Add an additional swipe action to delete a calculation from </span><span class="No-Break"><span class="koboSpan" id="kobo.1298.1">the collection</span></span></li>
<li><span class="koboSpan" id="kobo.1299.1">Add an additional keypad layout for </span><span class="No-Break"><span class="koboSpan" id="kobo.1300.1">scientific calculations</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.1301.1">In the next â€“ and final â€“ chapter, you will discover the world of AI as you build an object </span><span class="No-Break"><span class="koboSpan" id="kobo.1302.1">recognition app.</span></span></p>
</div>
</body></html>