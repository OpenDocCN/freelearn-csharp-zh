<html><head></head><body><div class="chapter" title="Chapter&#xA0;4.&#xA0;Creating Maps and Materials"><div class="titlepage"><div><div><h1 class="title"><a id="ch04"/>Chapter 4. Creating Maps and Materials</h1></div></div></div><p>In this chapter, we will cover the following topics:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Creating a basic material with Standard Shader (Specular setup)</li><li class="listitem" style="list-style-type: disc">Adapting a basic material from Specular setup to Metallic</li><li class="listitem" style="list-style-type: disc">Applying Normal maps to a material</li><li class="listitem" style="list-style-type: disc">Adding Transparency and Emission maps to a material</li><li class="listitem" style="list-style-type: disc">Highlighting materials at mouse-over</li><li class="listitem" style="list-style-type: disc">Adding Detail maps to a material</li><li class="listitem" style="list-style-type: disc">Fading the transparency of a material</li><li class="listitem" style="list-style-type: disc">Playing videos inside a scene</li></ul></div><div class="section" title="Introduction"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec44"/>Introduction</h1></div></div></div><p>Unity 5 introduces in<a class="indexterm" id="id307"/> new <span class="strong"><strong>Physically-Based Shaders</strong></span>. Physically-Based Rendering is<a class="indexterm" id="id308"/> a technique that simulates the appearance of materials based on how the light reacts with that material (more specifically, the <span class="emphasis"><em>matter</em></span> from which that material is made) in the real world. Such a technique allows for more realistic and consistent materials. So, your creations in Unity should look better than ever. Creating materials in Unity has also become more efficient now. Once you have chosen between the available <a class="indexterm" id="id309"/>workflows (<span class="strong"><strong>Metallic</strong></span> or <span class="strong"><strong>Specular setup</strong></span>; we'll get back to that later), there is no<a class="indexterm" id="id310"/> longer the need to browse the drop-down menus in search of specific features, as Unity optimizes the shader for the created material, removing unnecessary code for unused properties once the material has been set up and the texture maps have been assigned.</p><p>For a deep understanding of Physically-Based Rendering, we recommend you to take a look at <span class="emphasis"><em>The Comprehensive PBR Guide</em></span>, written by <a class="indexterm" id="id311"/>Wes McDermott from Allegorithmic, freely available in two volumes at <a class="ulink" href="http://www.allegorithmic.com/pbr-guide">http://www.allegorithmic.com/pbr-guide</a>. Allegorithmic's guide contains invaluable information on PBR theory and techniques, having been a fundamental reference for this chapter. A great resource that we'd recommend you take a look at is <span class="emphasis"><em>Mastering Physically Based Shading in Unity 5</em></span> by Renaldas Zioma (Unity), Erland Körner (Unity), and <a class="indexterm" id="id312"/>Wes McDermott (Allegorithmic), available at <a class="ulink" href="http://www.slideshare.net/RenaldasZioma/unite2014-mastering-physically-based-shading-in-unity-5">http://www.slideshare.net/RenaldasZioma/unite2014-mastering-physically-based-shading-in-unity-5</a>.</p><p>Another resource is<span class="emphasis"><em> Physically Based Shading in Unity</em></span> by Aras Pranckevičius (Unity), available at <a class="ulink" href="http://aras-p.info/texts/files/201403-GDC_UnityPhysicallyBasedShading_notes.pdf">http://aras-p.info/texts/files/201403-GDC_UnityPhysicallyBasedShading_notes.pdf</a>.</p><div class="section" title="Creating and saving texture maps"><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec111"/>Creating and saving texture maps</h2></div></div></div><p>The visual aspects of <a class="indexterm" id="id313"/>a material can be modified through the use of textures. In <a class="indexterm" id="id314"/>order to create and edit image files, you will need an image editor such as Adobe Photoshop (the industry standard, and has its native format supported by Unity), GIMP, and so on. In order to follow the recipes in this chapter, it's strongly recommended that you have access to a few pieces of software like these.</p><p>When saving texture maps, especially the ones that have an Alpha Channel, you might want to choose an adequate file format. <span class="strong"><strong>PSD</strong></span>, Photoshop's <a class="indexterm" id="id315"/>native format, is practical for preserving the original artwork in many layers. The PNG format is also a great option, but please note that Photoshop doesn't handle PNG's Alpha channel independently of the transparency, possibly compromising the material's appearance. Also, PNG files <a class="indexterm" id="id316"/>don't support layers. For this chapter, we will often use the TIF format for three main reasons: (a) it's open to those not using Photoshop; (b) it uses layers; (c) it preserves the Alpha Channel information. The file size is significantly greater than in PSDs and PNGs, so feel free to save your work as PSDs (if you have Photoshop) or PNGs (if you don't need layers and, if using Photoshop, Alpha Channels).</p><p>Finally, a word of advice - although it's possible to manually create texture maps for our materials by using the traditional image editing software, new tools such as Allegorthmic's Substance Painter and Bitmap2Material make this work much more efficient, complete, and intuitive, complementing the traditional texture-making process or replacing it altogether - in a similar way to what zBrush and Mudbox did for 3D modeling. For design professionals, we strongly recommend at least trying such tools. Note, however, that products from Allegorithmic won't make use of Unity's Standard Shader, relying on the <a class="indexterm" id="id317"/><span class="strong"><strong>substance</strong></span> files (which are natively supported by Unity).</p></div><div class="section" title="The big picture"><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec112"/>The big picture</h2></div></div></div><p>To understand the new Standard Shaders, it's a good idea to know the workflows, their properties, and how<a class="indexterm" id="id318"/> they affect the material's appearance. There are, however, many possible ways to work with materials - texture map requirements, for instance, might change from engine to engine, or from one tool to another. Presently, Unity supports two different workflows: one based on Specular, and another based on Metallic values. Although both workflows share similar properties (such as Normal, Height, Occlusion, and Emission), they differ in the way the diffuse color and reflectance properties are set up.</p><div class="section" title="Specular workflow"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl3sec24"/>Specular workflow</h3></div></div></div><p>Unity's Standard Shader (Specular setup) uses Albedo and Specular/Smoothness maps, combining them to<a class="indexterm" id="id319"/> create some of the material's aspect—mainly its color and reflectance qualities. The following shows the difference between Albedo and Smoothness maps:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Albedo</strong></span>: This is the<a class="indexterm" id="id320"/> material's diffused color. Plainly and simply, this is how you usually describe the appearance of the material (the British flag is red, white and blue; Ferrari's logo is a black horse in a yellow setting; some sunglasses' lenses are semi-transparent gradients, and more). This description, however, can be deceptive. Purely metallic objects (such as aluminum, chrome, gold, and others) should have black as their diffuse color. Their colors, as we perceive them, have originated from their specular channel. Non-metallic objects (plastic, wood, and even painted or rusted metal), on the other hand, do have very distinct diffuse colors. Texture maps for the Albedo property feature RGB channels for colors and (optionally) an Alpha Channel for transparency.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Specular/Smoothness</strong></span>: This refers to the shininess of the material. Texture maps make use of RGB <a class="indexterm" id="id321"/>channels for specular color (which informs hue and intensity), and Alpha Channel for smoothness/gloss (dark values for less shiny surfaces and blurred reflections; light/white values for shiny, mirror-like appearance). It is important to note that non-metallic objects feature neutral, very dark specular colors (with plastic, for instance, you should work with a grey value around 59). Metallic objects, on the other hand, feature very light values, and are also a bit yellowish in hue.</li></ul></div><p>To illustrate such concepts, we have created a battery object (shown below), featuring brushed metal caps and a plastic body. Observe how each map contributes to the final result:</p><div class="mediaobject"><img alt="Specular workflow" src="graphics/1362OT_04_39.jpg"/></div></div><div class="section" title="The metallic workflow"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl3sec25"/>The metallic workflow</h3></div></div></div><p>Unity's default Standard Shader combines Albedo and Metallic/Glossiness maps to create the color and reflectance qualities of the material. The following are the differences:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Albedo</strong></span>: As in the<a class="indexterm" id="id322"/> Specular workflow, this is the material's diffuse color; how you would describe the material. However, Albedo<a class="indexterm" id="id323"/> maps for the Metallic workflow should be configured in a slightly different way than ones for Specular workflow. This time around, the perceived diffuse color of metallic materials (grey for iron, yellow/orange for golden, and so on) have to be present in the Albedo map. Again, Albedo maps feature RGB channels for the colors and (optionally) an Alpha channel for transparency.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Metallic/Smoothness</strong></span>: This <a class="indexterm" id="id324"/>refers to how metallic the material looks. Metallic texture maps make use of the Red channel for the Metallic value (black for non-metallic and white for metallic materials that are not painted or rusted) and the Alpha Channel for smoothness (in a similar way to the Specular workflow). Please note that Metallic maps do not include any information on hue, and in these cases the yellow-ish nature of the metallic gloss should be applied to the Albedo map.</li></ul></div><p>To reproduce the <a class="indexterm" id="id325"/>battery that illustrated the Specular workflow by using the Metallic workflow, maps would have to be recreated as follows:</p><div class="mediaobject"><img alt="The metallic workflow" src="graphics/1362OT_04_40.jpg"/></div><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note31"/>Note</h3><p>You might have noticed that we've used white to convey a metallic object. Technically, since only the Red channel is relevant, we could have used red (R: 255, G: 0, B: 0), yellow (R: 255, G: 255, B: 0) or, for that matter, any color that has a red value of 255.</p></div></div></div><div class="section" title="Other material properties"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl3sec26"/>Other material properties</h3></div></div></div><p>It's also <a class="indexterm" id="id326"/>worth mentioning that Unity's Standard Shaders support other maps such as:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Normal maps</strong></span>: The normal map adds detailed bumpiness into the material, simulating a more complex geometry. For instance, the internal ring on the positive (top) node <a class="indexterm" id="id327"/>of the battery that illustrated shader workflows is not modeled in the 3D object's geometry, but rather created through a simple normal map.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Occlusion maps</strong></span>: A greyscale<a class="indexterm" id="id328"/> map is used to simulate the dark sections of an object under ambient light. Usually, it is used to <a class="indexterm" id="id329"/>emphasize joints, creases, and other details of geometry.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Height maps</strong></span>: These add <a class="indexterm" id="id330"/>a displacement effect, giving the impression of depth without the need for complex geometry.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Emission maps</strong></span>: These add color<a class="indexterm" id="id331"/> emitted by the material, as if self-illuminated, such as fluorescent surfaces or LCDs. Texture maps for Emission feature RGB channels for color.</li></ul></div></div><div class="section" title="Unity samples and documentation"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl3sec27"/>Unity samples and documentation</h3></div></div></div><p>Before you start, it might be<a class="indexterm" id="id332"/> a good idea to read Unity's documentation <a class="indexterm" id="id333"/>on textures. It can be found online at <a class="ulink" href="http://unity3d.com/support/documentation/Manual/Textures.html">http://unity3d.com/support/documentation/Manual/Textures.html</a>.</p><p>Finally, Unity has<a class="indexterm" id="id334"/> put together a great resource for those looking for some pointers regarding how to set up maps for a variety of materials: the<a class="indexterm" id="id335"/> <span class="strong"><strong>Shader Calibration Scene</strong></span>, which can be downloaded (for free) from the Unity Asset Store. It is a fantastic collection, featuring sample materials (both Metallic and Specular setup) for wood, metal, rubber, plastic, glass, skin, mud, and much more.</p></div></div></div></div>
<div class="section" title="Creating a basic material with Standard Shader (Specular setup)"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec45"/>Creating a basic material with Standard Shader (Specular setup)</h1></div></div></div><p>In this recipe, we <a class="indexterm" id="id336"/>will learn how to create a basic material using the new Standard Shader (Specular Setup), an Albedo map, and a Specular/Smoothness map. The material will feature both metallic and <a class="indexterm" id="id337"/>non-metallic parts, with various smoothness levels.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec113"/>Getting ready</h2></div></div></div><p>Two files have been prepared to support this recipe: a 3D model (in FBX format) of a battery, and an UVW template texture (in PNG format) to guide us when creating the diffuse texture map. 3D models and UVW templates can be made with 3D modeling software, such as 3DS MAX, Maya, or Blender. All necessary files are available in the <code class="literal">1362_04_01</code> folder.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec114"/>How to do it...</h2></div></div></div><p>To create a basic material, follow these steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Import the <code class="literal">battery.FBX</code> and <code class="literal">uvw_template.png</code> files to your project.</li><li class="listitem">Place<a class="indexterm" id="id338"/> the <span class="strong"><strong>battery</strong></span> model in the scene by dragging it from the <span class="strong"><strong>Assets</strong></span> folder, in the <span class="strong"><strong>Project</strong></span> view, to the <span class="strong"><strong>Hierarchy</strong></span> view. Select it on the <span class="strong"><strong>Hierarchy</strong></span> view and make sure, via the <span class="strong"><strong>Transform</strong></span> component on the <span class="strong"><strong>Inspector</strong></span> view, that it is positioned at <span class="strong"><strong>X: 0</strong></span>, <span class="strong"><strong>Y: 0</strong></span>, <span class="strong"><strong>Z: 0</strong></span>.</li><li class="listitem">Now, let's create a Specular/Smoothness map for our object. Open the image file called <code class="literal">uvw_template.png</code> in your image editor (we'll use Adobe Photoshop to<a class="indexterm" id="id339"/> illustrate the next steps). Note that the image file has only a single layer, mostly transparent, containing the UVW mapping templates that we will use as guidelines for our specular map.</li><li class="listitem">Create a new layer and place it beneath the one with the guidelines. Fill the new layer with dark gray (<span class="strong"><strong>R: 56</strong></span>, <span class="strong"><strong>G: 56</strong></span>, <span class="strong"><strong>B: 56</strong></span>). The guidelines will be visible at the top of the solid black fill:<div class="mediaobject"><img alt="How to do it..." src="graphics/1362OT_04_02.jpg"/></div></li><li class="listitem">Create a new layer and select the upper section of the image (the one with the circles). Then, fill that area with a slightly hued light gray (<span class="strong"><strong>R: 196</strong></span>, <span class="strong"><strong>G: 199</strong></span>, <span class="strong"><strong>B: 199</strong></span>):<div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note32"/>Note</h3><p>The RGB values for our specular map are not arbitrary: Physically-Based Shading takes out most of the guesswork from the mapping process, replacing it with the research for references. In our case, we have used colors based on the reflectance values of iron (the slightly hued light gray) and plastic (the dark gray). Check out the chapter's conclusion for a list of references.</p></div></div></li><li class="listitem">Use the text<a class="indexterm" id="id340"/> elements in white to add a brand, size, and positive/negative indicators to the<a class="indexterm" id="id341"/> battery body. Then, hide the guidelines layer.<div class="mediaobject"><img alt="How to do it..." src="graphics/1362OT_04_41.jpg"/></div></li><li class="listitem">Select all your layers and organize them into a group (in Photoshop, this can be done by clicking on the drop-down menu in the <span class="strong"><strong>Layers</strong></span> window and navigating to <span class="strong"><strong>Window</strong></span> | <span class="strong"><strong>New Group from Layers…</strong></span>). Name the new group <code class="literal">Specular</code>:<div class="mediaobject"><img alt="How to do it..." src="graphics/1362OT_04_42.jpg"/></div></li><li class="listitem">Duplicate the <code class="literal">Specular</code> group (in the <span class="strong"><strong>Layers</strong></span> window, right-click on the group's name<a class="indexterm" id="id342"/> and select <span class="strong"><strong>Duplicate Group…</strong></span>). Name the duplicated group <code class="literal">Smoothness</code>.</li><li class="listitem">Hide<a class="indexterm" id="id343"/> the <code class="literal">Smoothness</code> group. Then, expand the <code class="literal">Specular</code> group and hide all text layers:<div class="mediaobject"><img alt="How to do it..." src="graphics/1362OT_04_43.jpg"/></div></li><li class="listitem">Unhide the <code class="literal">Smoothness</code> group, and hide the <code class="literal">Specular</code> group. Select the dark gray layer. Then, make an area selection around the upper region of the battery body, and fill it with light gray (<span class="strong"><strong>R: 220</strong></span>, <span class="strong"><strong>G: 220</strong></span>, <span class="strong"><strong>B: 220</strong></span>). Rescale and rearrange the <span class="strong"><strong>Text</strong></span> layers if needed:<div class="mediaobject"><img alt="How to do it..." src="graphics/1362OT_04_44.jpg"/></div></li><li class="listitem">Duplicate the<a class="indexterm" id="id344"/> layer that contains the gray fill for the upper section of the image (the one that went over the circles).</li><li class="listitem">To add a<a class="indexterm" id="id345"/> brushed quality to this material, add a <span class="strong"><strong>Noise</strong></span> filter to the duplicated layer (in Photoshop, this can be done by navigating to <span class="strong"><strong>Filter</strong></span> | <span class="strong"><strong>Noise</strong></span> | <span class="strong"><strong>Add Noise...</strong></span>). Use <span class="strong"><strong>50%</strong></span> as the <span class="strong"><strong>Amount </strong></span>and set <span class="strong"><strong>Monochromatic</strong></span> to <code class="literal">true</code>. Then, apply a <span class="strong"><strong>Motion Blur</strong></span> filter (<span class="strong"><strong>Filter</strong></span> | <span class="strong"><strong>Blur</strong></span> | <span class="strong"><strong>Motion Blur...</strong></span>) using <span class="strong"><strong>30 Pixels</strong></span> as the <span class="strong"><strong>Distance</strong></span>.</li><li class="listitem">Duplicate the <code class="literal">Smoothness</code> group. Then, select the duplicated group and merge it into a single layer (on the <span class="strong"><strong>Layers</strong></span> window, right-click on the group's name and select <span class="strong"><strong>Merge Group</strong></span>).</li><li class="listitem">Select the merged layer, use the <span class="emphasis"><em>CTRL</em></span> + <span class="emphasis"><em>A</em></span> key combination to select the entire image, and copy it using the <span class="emphasis"><em>CTRL</em></span> + <span class="emphasis"><em>C</em></span> keys:<div class="mediaobject"><img alt="How to do it..." src="graphics/1362OT_04_45.jpg"/></div></li><li class="listitem">Hide the<a class="indexterm" id="id346"/> merged layer and the <code class="literal">Smoothness</code> group. Then, unhide the <code class="literal">Specular</code> group.</li><li class="listitem">In your image<a class="indexterm" id="id347"/> editor, access the image channels window (in Photoshop, this can be done by navigating to <span class="strong"><strong>Window</strong></span> | <span class="strong"><strong>Channels</strong></span>). Create a <span class="strong"><strong>New Channel</strong></span>. This will be our <span class="strong"><strong>Alpha</strong></span> Channel.</li><li class="listitem">Paste the image that you previously copied (from the merged layer) in to the <span class="strong"><strong>Alpha</strong></span> Channel. Then, set all channels as <code class="literal">visible</code>:<div class="mediaobject"><img alt="How to do it..." src="graphics/1362OT_04_46.jpg"/></div></li><li class="listitem">Save your image in the Project's <span class="strong"><strong>Assets</strong></span> folder as <code class="literal">Battery_specular</code>, either in Photoshop format (PSD) or TIF format.</li><li class="listitem">Now, let's work on the Albedo map. Save a copy of <code class="literal">Battery_specular</code> as <code class="literal">Battery_albedo</code>. Then, from the <span class="strong"><strong>Channels</strong></span> window, delete the <span class="strong"><strong>Alpha</strong></span> Channel.</li><li class="listitem">From the <span class="strong"><strong>Layers</strong></span><a class="indexterm" id="id348"/> window, hide the <code class="literal">Smoothness copy</code> merged layer, and unhide the <code class="literal">Smoothness</code> group. Finally, expand the <code class="literal">Smoothness</code> group, and hide the layer where the <a class="indexterm" id="id349"/><span class="strong"><strong>Noise</strong></span> filter was applied:<div class="mediaobject"><img alt="How to do it..." src="graphics/1362OT_04_47.jpg"/></div></li><li class="listitem">Change the color of the upper rectangle to black. Then, change the light gray area to dark red (<span class="strong"><strong>R: 204</strong></span>, <span class="strong"><strong>G: 0</strong></span>, <span class="strong"><strong>B: 0</strong></span>), and the dark gray to red (<span class="strong"><strong>R: 255</strong></span>, <span class="strong"><strong>G: 0</strong></span>, <span class="strong"><strong>B: 0</strong></span>). Rename the group <code class="literal">Albedo</code> and save the file:<div class="mediaobject"><img alt="How to do it..." src="graphics/1362OT_04_48.jpg"/></div></li><li class="listitem">Go back to Unity and make sure that both files were imported. Then, from the <a class="indexterm" id="id350"/><span class="strong"><strong>Project</strong></span> view, create a new <span class="strong"><strong>Material</strong></span>. Name it <code class="literal">Battery_MAT</code>.<div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="tip05"/>Tip</h3><p>An easy way to<a class="indexterm" id="id351"/> create new materials is to access the <span class="strong"><strong>Project</strong></span> view, click on the <span class="strong"><strong>Create</strong></span> drop-down menu, and choose <span class="strong"><strong>Material</strong></span>.</p></div></div></li><li class="listitem">Select <code class="literal">Battery_MAT</code>. From the <span class="strong"><strong>Inspector</strong></span> view, change the Shader to <span class="strong"><strong>Standard (Specular setup),</strong></span> and make sure that the rendering mode is set to <span class="strong"><strong>Opaque</strong></span>.</li><li class="listitem">Set <code class="literal">Battery_specular</code> as the <span class="strong"><strong>Specular</strong></span> map, and <code class="literal">Battery_albedo</code> as the <span class="strong"><strong>Albedo</strong></span> map for <code class="literal">Battery_MAT</code>.</li><li class="listitem">Drag the <code class="literal">Battery_MAT</code> material from the <span class="strong"><strong>Project</strong></span> view and drop it into the <span class="strong"><strong>battery</strong></span> object in the <span class="strong"><strong>Hierarchy</strong></span> view:<div class="mediaobject"><img alt="How to do it..." src="graphics/1362OT_04_49.jpg"/></div></li><li class="listitem">Drag the<a class="indexterm" id="id352"/> <code class="literal">Battery_MAT</code> material from the <span class="strong"><strong>Project</strong></span> view and, in the <span class="strong"><strong>Hierarchy</strong></span> view, drop it into the <span class="strong"><strong>battery</strong></span> object:<div class="mediaobject"><img alt="How to do it..." src="graphics/1362OT_04_50.jpg"/></div></li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec115"/>How it works...</h2></div></div></div><p>Ultimately, the <a class="indexterm" id="id353"/>visual aspect of the battery is a combination of three properties of its material: Specular, Smoothness, and Albedo.</p><p>To compose the dark red part of the plastic body, for instance, we have mixed the following:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>The Specular</strong></span> map (RGB): Very dark grey specularity (for non-metallic appearance)</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>The Smoothness</strong></span> (the Alpha channel of the Specular map): Light gray (for a glossy aspect)</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>The Albedo</strong></span> map: Dark red (for a dark red color)</li></ul></div><p>The light red portion, on the other hand, combines the following:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>The Specular</strong></span> map (RGB): That same dark grey specular</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>The Smoothness</strong></span> (the Alpha Channel of the Specular map): Dark gray (for a matte aspect)</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>The Albedo</strong></span> map: Red (for a red color)</li></ul></div><p>Finally, the <a class="indexterm" id="id354"/>brushed metal used for the<a class="indexterm" id="id355"/> top and bottom covers combines the following:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>The Specular</strong></span> map (RGB): Light grey (for a metallic aspect)</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>The Smoothness</strong></span> (the Alpha Channel of the Specular map): A blurred grey noise pattern (for a brushed aspect)</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>The Albedo</strong></span> map: Black (for a red color)</li></ul></div><p>Regarding how the image layers are structured, it's good practice to organize your layers into groups named after the property that they are related to. As texture maps get more diversified, it can be a good idea to keep a file that contains all the maps for quick reference and consistency.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec116"/>There's more...</h2></div></div></div><p>A few things you should have in mind when working with Albedo maps are as follows.</p><div class="section" title="Setting the texture type for an image file"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl3sec28"/>Setting the texture type for an image file</h3></div></div></div><p>Since image<a class="indexterm" id="id356"/> files can be used for several purposes within Unity (texture maps, GUI textures, cursors, and more), it's a good idea to check if the right <span class="strong"><strong>Texture Type</strong></span> is assigned to your file. This can be done by selecting the image file in the <span class="strong"><strong>Project</strong></span> view, and in the <span class="strong"><strong>Inspector</strong></span> view by using the drop-down menu to select the right <span class="strong"><strong>Texture Type</strong></span> (in this case, <code class="literal">Texture</code>). Please note that other settings can be adjusted, such as <span class="strong"><strong>Wrap Mode</strong></span>, <span class="strong"><strong>Filter Mode</strong></span>, and <span class="strong"><strong>Maximum Size</strong></span>. This last parameter is very useful if you want to keep your texture maps small in size for your game, while still being able to edit them in full size.</p></div><div class="section" title="Combining the map with color"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl3sec29"/>Combining the map with color</h3></div></div></div><p>When<a class="indexterm" id="id357"/> editing a material, the color picker to the right of the <span class="strong"><strong>Albedo</strong></span> map slot, on the <span class="strong"><strong>Inspector</strong></span> view, can be used to select the material's color, in case there is no texture map. If a texture map is being used, the selected color will be multiplied to the image, allowing variations on the material's color hue.</p></div></div></div>
<div class="section" title="Adapting a basic material from Specular setup to Metallic"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec46"/>Adapting a basic material from Specular setup to Metallic</h1></div></div></div><p>For a better <a class="indexterm" id="id358"/>understanding of the differences between Metallic and Specular workflows, we will modify the Albedo and Specular/Smoothness maps that are used on a Specular setup material, in order to adapt them to the Metallic workflow. The material to be generated will feature both metallic and non-metallic parts, with various smoothness levels.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec117"/>Getting ready</h2></div></div></div><p>For this recipe, we have prepared a Unity package containing a battery model and its original material (made with Standard Shader—Specular setup). The package includes two image files for the original Albedo and Specular/Smoothness maps which, throughout the recipe, should be adapted for use with the Metallic setup. The package is available in the <code class="literal">1362_04_02</code> folder.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec118"/>How to do it...</h2></div></div></div><p>To create a basic material, follow these steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Import the <code class="literal">battery_prefab</code> Unity package into a new project.</li><li class="listitem">From the <span class="strong"><strong>Project</strong></span> view, select the <span class="strong"><strong>battery_prefab</strong></span> element. Then, from <span class="strong"><strong>Inspector</strong></span>, access its material (named <span class="strong"><strong>Battery_MAT</strong></span>) and change its <span class="strong"><strong>Shader</strong></span> to <span class="strong"><strong>Standard</strong></span> (as opposed to its current shader—<span class="strong"><strong>Standard (Specular setup)</strong></span>.<div class="mediaobject"><img alt="How to do it..." src="graphics/1362OT_04_51.jpg"/></div></li><li class="listitem">From the <span class="strong"><strong>Project</strong></span> view, find the <code class="literal">Battery_specular</code> map and rename it <code class="literal">Battery_metallic</code>. Open it in your image editor (we'll use Adobe Photoshop to illustrate the following steps).</li><li class="listitem">Find the layer group named <span class="strong"><strong>Specular</strong></span> and rename it <span class="strong"><strong>Metallic</strong></span>. Then, fill the light gray<a class="indexterm" id="id359"/> layer (named <span class="strong"><strong>Layer 2</strong></span>, in the <span class="strong"><strong>Metallic</strong></span> group) with white (<span class="strong"><strong>R: 255</strong></span>, <span class="strong"><strong>G: 255</strong></span>, <span class="strong"><strong>B: 255</strong></span>), and the dark gray layer (named <span class="strong"><strong>Layer 1</strong></span>, in the <span class="strong"><strong>Metallic</strong></span> group) with black (<span class="strong"><strong>R: 0</strong></span>, <span class="strong"><strong>G: 0</strong></span>, <span class="strong"><strong>B: 0)</strong></span>. Save the file:<div class="mediaobject"><img alt="How to do it..." src="graphics/1362OT_04_52.jpg"/></div></li><li class="listitem">Go back to Unity. From the <span class="strong"><strong>Inspector</strong></span> view, set the modified <span class="strong"><strong>Battery_metallic</strong></span> map as the <span class="strong"><strong>Metallic</strong></span> map of the <span class="strong"><strong>Battery_MAT</strong></span> material. Also, set <span class="strong"><strong>None</strong></span> as the <span class="strong"><strong>Albedo</strong></span> map for that material. This will give you an idea of how the material is coming along:<div class="mediaobject"><img alt="How to do it..." src="graphics/1362OT_04_53.jpg"/></div></li><li class="listitem">Now, let's adjust the<a class="indexterm" id="id360"/> Albedo texture map. From the <span class="strong"><strong>Project</strong></span> view, locate the <code class="literal">Battery_albedo</code> map and open it in your image editor. Then, use the <span class="strong"><strong>Paint Bucket</strong></span> tool to fill the black area of <span class="strong"><strong>Layer 2</strong></span>, in the <span class="strong"><strong>Albedo</strong></span> group, with light gray (R: <code class="literal">196</code>, G: <code class="literal">199</code>, B: <code class="literal">199</code>). Save the file:<div class="mediaobject"><img alt="How to do it..." src="graphics/1362OT_04_54.jpg"/></div></li><li class="listitem">Go back to Unity. From the <span class="strong"><strong>Inspector</strong></span> view, set the modified <span class="strong"><strong>Battery_albedo</strong></span> map as the <span class="strong"><strong>Albedo</strong></span> map of the <span class="strong"><strong>Battery_MAT</strong></span> material. </li></ol></div><p>Your material is ready, combining visual properties based on the different maps that you have edited and assigned.</p><div class="mediaobject"><img alt="How to do it..." src="graphics/1362OT_04_55.jpg"/></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec119"/>How it works...</h2></div></div></div><p>The visual aspect of the battery is a combination of three properties of its material: Metallic, Smoothness, and Albedo.</p><p>To compose the <a class="indexterm" id="id361"/>dark red part of the plastic body, for instance, we have mixed the following:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>The Metallic</strong></span> map (RGB): Black (for a non-metallic appearance)</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>The Smoothness</strong></span> (the Alpha Channel of a Metallic map): Light gray (for a glossy appearance)</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>The Albedo</strong></span> map: Dark red (for a dark red color)</li></ul></div><p>The light red portion, on the other hand, combines the following:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>The Metallic</strong></span> map (RGB): Black</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>The Smoothness</strong></span> (the Alpha Channel of the Metallic map): dark gray (for a matte appearance)</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Albedo</strong></span> map: red (for a red color)</li></ul></div><p>Finally, the brushed metal used for the top and bottom covers combines the following:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>The Metallic</strong></span> map (RGB): white (for a metallic aspect)</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>The Smoothness</strong></span> (the Alpha Channel of the Metallic map): blurred grey noise pattern (for a brushed appearance);</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Albedo</strong></span> map: light grey (for an iron-like appearance)</li></ul></div><p>Remember to organize your layers in to groups named after the property that they are related to.</p></div></div>
<div class="section" title="Applying Normal maps to a material"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec47"/>Applying Normal maps to a material</h1></div></div></div><p>Normal maps<a class="indexterm" id="id362"/> are generally used to simulate complex geometry that would be too expensive, in terms of computer processing, to be actually represented by the 3D polygons during the game's runtime. Oversimplifying, Normal maps fake complex<a class="indexterm" id="id363"/> geometry on low-definition 3D meshes. These maps can be generated either by projecting high-definition 3D meshes onto low-poly ones (a technique usually referred to as <span class="emphasis"><em>baking</em></span>), or, as will be the case for this recipe, from another texture map.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec120"/>Getting ready</h2></div></div></div><p>For this recipe, we will prepare two texture maps: the<a class="indexterm" id="id364"/> <span class="strong"><strong>Heightmap</strong></span> and the <span class="strong"><strong>Normal map</strong></span>. The<a class="indexterm" id="id365"/> former will be made from simple shapes in an image editor. The latter will be automatically processed from the Heightmap. Although there are a number of tools that can be used to generate Normal maps (see the <span class="emphasis"><em>There is more</em></span> section of this chapter for a list of resources), we will use a free online tool, Windows and Mac compatible, to generate our texture. Developed by Christian Petry, the <span class="strong"><strong>NormalMap Online</strong></span> feature <a class="indexterm" id="id366"/>can be accessed at <a class="ulink" href="http://cpetry.github.io/NormalMap-Online/">http://cpetry.github.io/NormalMap-Online/</a>.</p><p>To help you with this recipe, it's been provided a Unity package, containing a prefab made of a 3D object and its material; and also an UVW template texture (in PNG format) to guide you when creating the diffuse texture map. All the files are in the <code class="literal">1362_04_03</code> folder.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec121"/>How to do it...</h2></div></div></div><p>To apply a Normal map to a material, follow these steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Import the <code class="literal">1362_04_03.unitypackage</code> file to your project. Select the <code class="literal">batteryPrefab</code> object from the <span class="strong"><strong>Assets</strong></span> | <code class="literal">1362_04_03</code> folder, in the <span class="strong"><strong>Project</strong></span> view. After comparing it with some reference photos, inform yourself about the features that should be reproduced by the Normal map: (<span class="strong"><strong>A</strong></span>) a bumpy ring at the top; and (<span class="strong"><strong>B</strong></span>) some circular creases at the bottom, shown in the following image:<div class="mediaobject"><img alt="How to do it..." src="graphics/1362OT_04_14.jpg"/></div></li><li class="listitem">In an image editor, open <code class="literal">uvw_template.png</code>. Create a new layer, fill it with grey (RGB: 128), and position it <a class="indexterm" id="id367"/>below the pre-existing<a class="indexterm" id="id368"/> layer as shown:<div class="mediaobject"><img alt="How to do it..." src="graphics/1362OT_04_15.jpg"/></div></li><li class="listitem">On a separate layer, draw a white circle centered on the battery's top. Then, on another layer, draw a black circle, centered on the battery's bottom, as shown below:<div class="mediaobject"><img alt="How to do it..." src="graphics/1362OT_04_16.jpg"/></div></li><li class="listitem">If you have used vector shapes to make the circles, rasterize their layers (in Adobe Photoshop, right-click on the layer's name and select the <span class="strong"><strong>Rasterize Layer</strong></span> option from the context menu).</li><li class="listitem">Blur the white circle (in Photoshop, this can be done by navigating to <span class="strong"><strong>Filter</strong></span> | <span class="strong"><strong>Blur</strong></span> | <span class="strong"><strong>Gaussian Blur...</strong></span>). Use <span class="strong"><strong>4,0</strong></span> pixels as the <span class="strong"><strong>Radius</strong></span>.</li><li class="listitem">Hide the UVW<a class="indexterm" id="id369"/> template layer and save the image as <code class="literal">Battery_height.png</code>.</li><li class="listitem">If you want to<a class="indexterm" id="id370"/> convert the Heightmap directly from Unity, import it to your project. Select it from the <span class="strong"><strong>Project</strong></span> view and, from the <span class="strong"><strong>Inspector</strong></span> view, change its <span class="strong"><strong>Texture Type</strong></span> to <span class="strong"><strong>Normal map</strong></span>. Check the <span class="strong"><strong>Create from Grayscale</strong></span> option, adjust <span class="strong"><strong>Bumpiness</strong></span> and <span class="strong"><strong>Filtering</strong></span> as you like, and click on <span class="strong"><strong>Apply</strong></span> to save the changes:<div class="mediaobject"><img alt="How to do it..." src="graphics/1362OT_04_17.jpg"/></div></li><li class="listitem">To convert your<a class="indexterm" id="id371"/> Heightmap externally, access the website at <a class="ulink" href="http://cpetry.github.io/NormalMap-Online/">http://cpetry.github.io/NormalMap-Online/</a>. Then, drag the <code class="literal">HEIGHT_battery.png</code> file to<a class="indexterm" id="id372"/> the appropriate image slot. Feel free to play with the <span class="strong"><strong>Strength</strong></span>, <span class="strong"><strong>Level</strong></span> and <span class="strong"><strong>Blur/Sharp</strong></span> parameters:<div class="mediaobject"><img alt="How to do it..." src="graphics/1362OT_04_18.jpg"/></div></li><li class="listitem">Save the resulting <a class="indexterm" id="id373"/>Normal map as <code class="literal">Battery_normal.jpg</code> and add it to your Unity project.</li><li class="listitem">In Unity, select <code class="literal">Battery_normal</code> from the <span class="strong"><strong>Project</strong></span> view. Then, from the <span class="strong"><strong>Inspector</strong></span> view, change its <span class="strong"><strong>Texture Type</strong></span> to <span class="strong"><strong>Normal</strong></span>, leaving the <span class="strong"><strong>Create from Grayscale</strong></span> box unchecked. Click on <span class="strong"><strong>Apply</strong></span> to save the changes:<div class="mediaobject"><img alt="How to do it..." src="graphics/1362OT_04_19.jpg"/></div></li><li class="listitem">In the <span class="strong"><strong>Project</strong></span><a class="indexterm" id="id374"/> view, select <code class="literal">batteryPrefab</code>. Then, in the <span class="strong"><strong>Inspector</strong></span> view, scroll down to the <span class="strong"><strong>Material</strong></span> component, and assign <code class="literal">Battery_normal</code> to the <span class="strong"><strong>Normal Map</strong></span><a class="indexterm" id="id375"/> slot. To adjust its intensity and direction, change its value to <code class="literal">-0.35</code>:<div class="mediaobject"><img alt="How to do it..." src="graphics/1362OT_04_20.jpg"/></div></li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec122"/>How it works...</h2></div></div></div><p>The <span class="strong"><strong>Normal</strong></span> map was calculated from the grey<a class="indexterm" id="id376"/> values on the <span class="strong"><strong>Heightmap</strong></span>, where the lighter tones were<a class="indexterm" id="id377"/> interpreted as recesses (applied to the top of the battery), and the darker tones as bulges (applied to the bottom). Since the desired output was actually the opposite, it was necessary to adjust the Normal map to a negative value (<code class="literal">-0.35</code>). Another possible solution to the issue would have been to redraw the Heightmap and <a class="indexterm" id="id378"/>switch the colors for the white and black circles.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec123"/>There's more...</h2></div></div></div><p>If you wish to explore Normal mapping beyond the limitations of NormalMap Online, there is an ever-growing list of full-featured software that can produce Normal maps (and much more). Here are some resources that you might want to check out:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="emphasis"><em>CrazyBump</em></span> is a <a class="indexterm" id="id379"/>standalone tool for Windows and Mac, which is available at <a class="ulink" href="http://www.crazybump.com">http://www.crazybump.com</a></li><li class="listitem" style="list-style-type: disc"><span class="emphasis"><em>nDo</em></span> is a Photoshop plugin by <a class="indexterm" id="id380"/>Quixel (Windows only), available at <a class="ulink" href="http://quixel.se/ndo">http://quixel.se/ndo</a></li><li class="listitem" style="list-style-type: disc"><span class="emphasis"><em>GIMP normalmap Plugin</em></span>, available for <a class="indexterm" id="id381"/>Windows only, is available at <a class="ulink" href="http://code.google.com/p/gimp-normalmap/">http://code.google.com/p/gimp-normalmap/</a></li><li class="listitem" style="list-style-type: disc"><span class="emphasis"><em>NVIDIA Texture Tools for Adobe Photoshop</em></span>, available for Windows only, is available at <a class="ulink" href="http://developer.nvidia.com/nvidia-texture-tools-adobe-photoshop">http://developer.nvidia.com/nvidia-texture-tools-adobe-photoshop</a></li><li class="listitem" style="list-style-type: disc"><span class="emphasis"><em>Bitmap2Material</em></span> is an <a class="indexterm" id="id382"/>amazing texture generating tool from <a class="indexterm" id="id383"/>Allegorithmic, which is available at <a class="ulink" href="http://www.allegorithmic.com/">http://www.allegorithmic.com/</a></li></ul></div></div></div>
<div class="section" title="Adding Transparency and Emission maps to a material"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec48"/>Adding Transparency and Emission maps to a material</h1></div></div></div><p>The <span class="strong"><strong>Emission</strong></span> property can be used to simulate a variety of self-illuminated objects, from the LEDs of mobile displays to futuristic Tron suits. <span class="strong"><strong>Transparency</strong></span>, on the other hand, can make the diffuse color of a material more or less visible. In this recipe, you will learn how to configure these<a class="indexterm" id="id384"/> properties to produce a toy's cardboard packaging that features a plastic case and glow-in-the-dark text.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec124"/>Getting ready</h2></div></div></div><p>For this recipe, we have<a class="indexterm" id="id385"/> prepared a Unity package containing a prefab made of a 3D object, its material, and its respective diffused texture map (in PNG format). All files are in the <code class="literal">1362_04_04</code> folder.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec125"/>How to do it...</h2></div></div></div><p>To add transparency and color emissions to a material, follow these steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Import <code class="literal">TransparencyEmission.unitypackage</code> to your project. Select the <code class="literal">DIFF_package</code> texture from the <code class="literal">Assets</code> folder, in the <span class="strong"><strong>Project</strong></span> view. Then, open it in your image editor.</li><li class="listitem">First, we will add transparency to the image by deleting the white areas around the package (and the hang hole). Make a selection of those areas (in Photoshop, this can be done <a class="indexterm" id="id386"/>with the <span class="strong"><strong>Magic Wand</strong></span> Tool).</li><li class="listitem">Make sure you unlock the <span class="strong"><strong>Background</strong></span> layer by clicking on the lock icon, to the left of the layer's name, as shown below:<div class="mediaobject"><img alt="How to do it..." src="graphics/1362OT_04_21.jpg"/></div></li><li class="listitem">Delete the previously-made selection (this can be done in Photoshop by pressing the <span class="emphasis"><em>Delete</em></span> key). The <a class="indexterm" id="id387"/>background of the image should be transparent, as shown below. Save the file:<div class="mediaobject"><img alt="How to do it..." src="graphics/1362OT_04_22.jpg"/></div></li><li class="listitem">Back in <a class="indexterm" id="id388"/>Unity, in the <span class="strong"><strong>Assets</strong></span> folder, expand the <span class="strong"><strong>packagePrefab</strong></span> list and select the <span class="strong"><strong>PackageCard</strong></span> object. Now, in the <span class="strong"><strong>Inspector</strong></span> view, scroll down to the <span class="strong"><strong>Material</strong></span> component and change its <span class="strong"><strong>Rendering Mode</strong></span> to <span class="strong"><strong>Cutout</strong></span>, and adjust its <span class="strong"><strong>Alpha Cutoff</strong></span> to <code class="literal">0.9</code>:<div class="mediaobject"><img alt="How to do it..." src="graphics/1362OT_04_23.jpg"/></div><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="tip06"/>Tip</h3><p>Choosing <span class="strong"><strong>Cutout</strong></span> <a class="indexterm" id="id389"/>means that your material can be either invisible or fully visible, not allowing for semi-transparency. The <a class="indexterm" id="id390"/><span class="strong"><strong>Alpha Cutoff</strong></span> is used to get rid of unwanted pixels around the transparent borders.</p></div></div></li><li class="listitem">From the <a class="indexterm" id="id391"/>expanded <span class="strong"><strong>packagePrefab</strong></span>, select the <span class="strong"><strong>PackagePlastic</strong></span> object. In the <span class="strong"><strong>Inspector</strong></span> view, scroll down to the <span class="strong"><strong>Material</strong></span> component and<a class="indexterm" id="id392"/> change its <span class="strong"><strong>Rendering Mode</strong></span> to <span class="strong"><strong>Transparent</strong></span>. Then, use the <span class="strong"><strong>Diffuse</strong></span> color picker to change the color's <span class="strong"><strong>RGB</strong></span> values to <code class="literal">56</code>, and <span class="strong"><strong>Alpha</strong></span> to <code class="literal">25</code>. Also, change the <span class="strong"><strong>Smoothness</strong></span> level to <code class="literal">0.9</code>:<div class="mediaobject"><img alt="How to do it..." src="graphics/1362OT_04_24.jpg"/></div></li><li class="listitem">Now that we have taken care of our transparency needs, we need to work on the <span class="strong"><strong>Emission</strong></span> map. From the <span class="strong"><strong>Assets</strong></span> folder, duplicate the <code class="literal">DIFF_package</code> texture, rename it <code class="literal">EMI_package</code>, and open it in your image editor.</li><li class="listitem">Select all the characters from the <span class="strong"><strong>Ms. Laser</strong></span> inscription and the green star (in Photoshop, this can be done with the Magic Wand tool, keeping the <span class="emphasis"><em>Shift</em></span> key pressed while selecting multiple areas).</li><li class="listitem">Copy and paste your selection into a new layer. Then, select it and apply a Noise filter to it (in Photoshop, this can be done by navigating to <span class="strong"><strong>Filter</strong></span> | <span class="strong"><strong>Noise</strong></span> | <span class="strong"><strong>Add Noise...</strong></span>). Use <span class="strong"><strong>50%</strong></span> as the value.</li><li class="listitem">Create a new<a class="indexterm" id="id393"/> layer and, using a tool such as the <span class="strong"><strong>Paint Bucket</strong></span>, fill it with black (R: <code class="literal">0</code>, G: <code class="literal">0</code>, B: <code class="literal">0</code>). Place this black layer beneath the <a class="indexterm" id="id394"/>one with the colored elements.</li><li class="listitem">Flatten your image (in Photoshop this can be done by navigating to <span class="strong"><strong>Layer</strong></span> | <span class="strong"><strong>Flatten Image</strong></span>) and save your file:<div class="mediaobject"><img alt="How to do it..." src="graphics/1362OT_04_25.jpg"/></div></li><li class="listitem">Back in Unity, in the <span class="strong"><strong>Assets</strong></span> folder, expand <span class="strong"><strong>packagePrefab</strong></span> and select the <span class="strong"><strong>PackageCard</strong></span> object. Now, in the <span class="strong"><strong>Inspector</strong></span> view, scroll down to the <span class="strong"><strong>Material</strong></span> component and assign the <code class="literal">EMI_package</code> texture to its <span class="strong"><strong>Emission</strong></span> slot. Then, change the <span class="strong"><strong>Emission</strong></span> color slot to white (<span class="strong"><strong>R</strong></span>: <code class="literal">255</code>; <span class="strong"><strong>G</strong></span>: <code class="literal">255</code>; <span class="strong"><strong>B</strong></span>: <code class="literal">255</code>), and turn down its intensity to <code class="literal">0.25</code>, as shown in the following screenshot. Also, change its <span class="strong"><strong>GI</strong></span> option to <span class="strong"><strong>None</strong></span>, so that its glow won't be added to the Lightmaps or influence the illumination in real time:<div class="mediaobject"><img alt="How to do it..." src="graphics/1362OT_04_26.jpg"/></div></li><li class="listitem">Place an<a class="indexterm" id="id395"/> instance of the <span class="strong"><strong>packagePrefab</strong></span> in <a class="indexterm" id="id396"/>your scene and check out the results. Your material is ready:<div class="mediaobject"><img alt="How to do it..." src="graphics/1362OT_04_27.jpg"/></div></li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec126"/>How it works...</h2></div></div></div><p>Unity is able to read four channels of a texture map: R (Red), G (Green), B (Blue) and A (Alpha). When set to <code class="literal">Transparent</code> or Cutout, the Alpha channel of the diffuse texture map sets the transparency of the material according to each pixel's brightness level (the <span class="strong"><strong>Cutout</strong></span> mode will not render semi-transparency—only fully visible or invisible pixels). You might have noticed that we didn't add an Alpha channel—this is because Photoshop exports the PNG's Alpha map, based on its transparency. To help you visualize the Alpha map, the <code class="literal">1362_04_04</code> folder contains a <code class="literal">DIFF_packageFinal.TIF</code> file featuring an Alpha map that works exactly in the same way as the PNG file that we have generated:</p><div class="mediaobject"><img alt="How it works..." src="graphics/1362OT_04_28.jpg"/></div><p>Regarding the<a class="indexterm" id="id397"/> Emission texture map, Unity assigns its RGB colors to the material, combining them with the appropriate color selection slot, and also allowing<a class="indexterm" id="id398"/> adjustments to the intensity of that Emission.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec127"/>There's more...</h2></div></div></div><p>Let look at a little more information on Transparency and Emission.</p><div class="section" title="Using texture maps with Transparent Mode"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl3sec30"/>Using texture maps with Transparent Mode</h3></div></div></div><p>Please note that you can use a bitmap texture for the <span class="strong"><strong>Diffuse</strong></span> map in the <span class="strong"><strong>Transparent</strong></span> render mode. In this case, RGB <a class="indexterm" id="id399"/>values will be interpreted as the Diffuse color, while the Alpha will be used to determine that pixel's transparency (in this case, semi-transparent materials are allowed).</p></div><div class="section" title="Avoiding issues with the semi-transparent objects"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl3sec31"/>Avoiding issues with the semi-transparent objects</h3></div></div></div><p>You might have<a class="indexterm" id="id400"/> noticed that the plastic case was made from two objects (<span class="strong"><strong>PackagePlastic</strong></span> and <span class="strong"><strong>innerPlastic</strong></span>). This was done to avoid z-sorting problems, where faces are rendered in front of other geometry when they should be behind it. Having multiple meshes instead of a single one allows these faces to be correctly sorted for rendering. Materials in the <code class="literal">Cutout</code> mode are not affected by this problem, though.</p></div><div class="section" title="Emitting light over other objects"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl3sec32"/>Emitting light over other objects</h3></div></div></div><p>The <span class="strong"><strong>Emission</strong></span><a class="indexterm" id="id401"/> value can be used to calculate the material's light projection over other objects when using Lightmaps.</p></div></div></div>
<div class="section" title="Highlighting materials at mouse over"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec49"/>Highlighting materials at mouse over</h1></div></div></div><p>Changing the color of an object at runtime can be a very effective way of letting players know that they <a class="indexterm" id="id402"/>can interact with it. This is very useful in a number of game <span class="emphasis"><em>genres</em></span>, such as puzzles and point-and-click adventures, and it can also be used to create 3D user interfaces.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec128"/>Getting ready</h2></div></div></div><p>For this recipe, we'll use objects created directly in Unity. Alternatively, you can use any 3D model you like.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec129"/>How to do it...</h2></div></div></div><p>To highlight a material at mouse-over, follow these steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Create a new 3D project, and add a <span class="strong"><strong>Cube</strong></span> to the scene (from the <span class="strong"><strong>Hierarchy</strong></span> view, navigate to <span class="strong"><strong>Create</strong></span> | <span class="strong"><strong>3D Object</strong></span> | <span class="strong"><strong>Cube</strong></span>).</li><li class="listitem">From the <span class="strong"><strong>Project</strong></span> view, click the <span class="strong"><strong>Create</strong></span> drop-down menu and choose <span class="strong"><strong>Material</strong></span>. Name it <code class="literal">HighlightMaterial</code>.</li><li class="listitem">Select <span class="strong"><strong>HighlightMaterial</strong></span>, and, from the <span class="strong"><strong>Inspector</strong></span> view, change its <span class="strong"><strong>Albedo</strong></span> color to gray (R: <code class="literal">135</code>, G: <code class="literal">135</code>, B: <code class="literal">135</code>), its <span class="strong"><strong>Emission</strong></span> intensity to <code class="literal">1</code>, as shown in the screenshot below, and it's <span class="strong"><strong>Emission</strong></span> color to R: <code class="literal">1</code>, G: <code class="literal">1</code>, <span class="strong"><strong>B: </strong></span><code class="literal">1</code>:<div class="mediaobject"><img alt="How to do it..." src="graphics/1362OT_04_56.jpg"/></div></li><li class="listitem">Assign <span class="strong"><strong>HighlightMaterial</strong></span> to the <span class="strong"><strong>Cube</strong></span> that you previously created.</li><li class="listitem">From the <span class="strong"><strong>Project</strong></span> view, click on the <span class="strong"><strong>Create</strong></span> drop-down menu and choose <span class="strong"><strong>C# Script</strong></span>. Rename it <code class="literal">HighlightObject</code> and open it in your editor.</li><li class="listitem">Replace everything with the following code:<div class="informalexample"><pre class="programlisting">using UnityEngine;
using System.Collections;
public class HighlightObject : MonoBehaviour{
  private Color initialColor;
  public bool noEmissionAtStart = true;
  public Color highlightColor = Color.red;
  public Color mousedownColor = Color.green;

  private bool mouseon = false;
  private Renderer myRenderer;

  void Start() {
    myRenderer = GetComponent&lt;Renderer&gt;();
    if (noEmissionAtStart)
    initialColor = Color.black;
    else
    initialColor = myRenderer.material.GetColor("_EmissionColor");
  }

  void OnMouseEnter(){
    mouseon = true;
    myRenderer.material.SetColor("_EmissionColor", highlightColor);
  }

  void OnMouseExit(){
    mouseon = false;
    myRenderer.material.SetColor("_EmissionColor",initialColor);
  }

  void OnMouseDown(){
    myRenderer.material.SetColor("_EmissionColor", mousedownColor);
  }

  void OnMouseUp(){
    if (mouseon)
    myRenderer.material.SetColor("_EmissionColor", highlightColor);
    else
    myRenderer.material.SetColor("_EmissionColor", initialColor);
  }
}</pre></div></li><li class="listitem">Save <a class="indexterm" id="id403"/>your script and attach it to the <span class="strong"><strong>Cube</strong></span>.</li><li class="listitem">Select the <span class="strong"><strong>Cube</strong></span>, and, in the <span class="strong"><strong>Inspector</strong></span> view, set the <span class="strong"><strong>Highlight Color</strong></span> and <span class="strong"><strong>Mousedown Color</strong></span> values to any colors that you would like:<div class="mediaobject"><img alt="How to do it..." src="graphics/1362OT_04_29.jpg"/></div></li><li class="listitem">If you are using the script with your own imported 3D mesh, please make sure you add a <span class="strong"><strong>Collider</strong></span> component to your object.</li><li class="listitem">Test the scene. The <span class="strong"><strong>Cube</strong></span> will be highlighted red when the mouse is over it (and green when clicked on).</li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec130"/>How it works...</h2></div></div></div><p>The cube is automatically sent the mouse enter/exit/down/up events as the user moves the mouse pointer over and away from the part of the screen where the cube is visible. Our script adds a behavior to the cube when these events are detected. The <code class="literal">Start()</code> method gets a reference to the <code class="literal">Renderer</code> component of the GameObject that the script has been added to, and stores it in the variable <code class="literal">myRenderer</code> (note that 'renderer' already has a meaning in Unity so it is not appropriate as a private variable name for this script). The Boolean variable called <code class="literal">mouseon</code> records whether or not the mouse pointer is currently over the object. When the mouse button is released, we use the <code class="literal">mouseon</code> variable to decide whether to change the cube back to its initial color (<code class="literal">mouseon</code> FALSE, so the mouse pointer is away from the cube), or back to its highlight color (<code class="literal">mouseon</code> TRUE, so the mouse pointer is over the cube).</p><p>The reason we needed to change the material's original <span class="strong"><strong>Emission</strong></span> color to ultra, dark gray is that leaving it black would have caused Unity to optimize the Shader by removing the <span class="strong"><strong>Emission</strong></span> property from the material. Our script wouldn't have worked if this had happened.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec131"/>There's more...</h2></div></div></div><p>You can achieve other interesting results by changing the other properties of your material (by changing the <code class="literal">_EmissionColor</code> script to <code class="literal">_Color</code> or <code class="literal">"_SpecularColor</code>, for instance). For a full list of properties, select your material, and, in the <span class="strong"><strong>Inspector</strong></span> view, click on the <span class="strong"><strong>Edit</strong></span> button, at the side of the <span class="strong"><strong>Shader</strong></span> drop-down menu.</p></div></div>
<div class="section" title="Adding Detail maps to a material"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec50"/>Adding Detail maps to a material</h1></div></div></div><p>When creating<a class="indexterm" id="id404"/> a large object, there is not only the desire to texture it as a whole, but also to add details that can<a class="indexterm" id="id405"/> make it look better at closer distances. To overcome the need for gigantic texture maps, the use of Detail maps can make a real difference. In this recipe, we will add Detail maps to a rocket toy by applying a Detail mask and a Detail Normal map. In our case, we want to add a textured quality (and a stripe pattern) to the green plastic, except in the region where there is a battery compartment and the toy's logo:</p><div class="mediaobject"><img alt="Adding Detail maps to a material" src="graphics/1362OT_04_30.jpg"/></div><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec132"/>Getting ready</h2></div></div></div><p>For this recipe, we have prepared a Unity package, containing the prefab for a rocket toy. The prefab includes the 3D model and a material, featuring a Diffuse map and a Normal map (made from a Heightmap). The file can be found in the <code class="literal">1362_04_06</code> folder.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec133"/>How to do it...</h2></div></div></div><p>To add the Detail maps to your object, follow these steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Import the <code class="literal">rocket.unitypackage</code> file into your project. Then, select the prefab named <code class="literal">rocketToy</code> from the <span class="strong"><strong>Assets</strong></span> folder, in the <span class="strong"><strong>Project</strong></span> view, and place it in your scene.</li><li class="listitem">From the <span class="strong"><strong>Hierarchy</strong></span> view, expand the <span class="strong"><strong>rocketToy</strong></span> GameObject and select its child called <span class="strong"><strong>rocketLevel1</strong></span>. Then, scroll down the <span class="strong"><strong>Inspector</strong></span> view to the <span class="strong"><strong>Material</strong></span> component. Observe that it uses the <code class="literal">DIFF_ship</code> texture as the <span class="strong"><strong>Diffuse</strong></span> map. Duplicate this file and rename the new copy <code class="literal">COPY_ship</code>.</li><li class="listitem">Open <code class="literal">COPY_ship</code> in your image editor. Select all the solid green pixels around the logo and battery compartment (in Photoshop, this can be done with the Magic Wand tool, keeping the <span class="emphasis"><em>Shift</em></span> key pressed while selecting multiple areas):<div class="mediaobject"><img alt="How to do it..." src="graphics/1362OT_04_31.jpg"/></div></li><li class="listitem">Keeping your selection active, access the image <span class="strong"><strong>Channels</strong></span> window (in Photoshop, this <a class="indexterm" id="id406"/>can be done by navigating to <span class="strong"><strong>Window</strong></span> | <span class="strong"><strong>Channels</strong></span>). Click on <span class="strong"><strong>New Channel</strong></span>. This will be our <span class="strong"><strong>Alpha</strong></span> channel:<div class="mediaobject"><img alt="How to do it..." src="graphics/1362OT_04_32.jpg"/></div></li><li class="listitem">Hide the <span class="strong"><strong>Red</strong></span>, <span class="strong"><strong>Green</strong></span> and <span class="strong"><strong>Blue</strong></span> channels. Select the <span class="strong"><strong>Alpha</strong></span> channel and paint the selection <a class="indexterm" id="id407"/>white. Then, select the area of the battery compartment and paint it grey (R, G and B: <code class="literal">100</code>):<div class="mediaobject"><img alt="How to do it..." src="graphics/1362OT_04_33.jpg"/></div></li><li class="listitem">Save it in the <a class="indexterm" id="id408"/>TIFF format as <code class="literal">MASK_ship.TIF</code>, in the <code class="literal">Assets</code> folder. Make sure that you include <span class="strong"><strong>Alpha Channels</strong></span>:<div class="mediaobject"><img alt="How to do it..." src="graphics/1362OT_04_34.jpg"/></div></li><li class="listitem">Now that we have the mask, let's create a diffuse map for our detail. In your image editor, create a new image with the following dimensions: <span class="strong"><strong>width</strong></span>: <code class="literal">64</code>, and <span class="strong"><strong>height</strong></span>: <code class="literal">64</code>.</li><li class="listitem">Fill the new image with grey (R, G and B: <code class="literal">128</code>). Then, use shapes or rectangular <a class="indexterm" id="id409"/>fills to create a dark grey (R, G, and B: <code class="literal">100</code>) horizontal line that is about 16 pixels tall:<div class="mediaobject"><img alt="How to do it..." src="graphics/1362OT_04_35.jpg"/></div></li><li class="listitem">Save the image as <code class="literal">DIFF_detail.PNG</code> in the <code class="literal">Assets</code> folder.</li><li class="listitem">Create a new<a class="indexterm" id="id410"/> 64 x 64 image. Use a <span class="strong"><strong>Gradient</strong></span> tool to create a black and white <span class="strong"><strong>Radial Gradient</strong></span> (in Photoshop, this can be done with the <span class="strong"><strong>Gradient </strong></span>Tool in <span class="strong"><strong>Radial</strong></span> mode):<div class="mediaobject"><img alt="How to do it..." src="graphics/1362OT_04_36.jpg"/></div></li><li class="listitem">Save the image as <code class="literal">HEIGHT_detail.PNG</code> in the <code class="literal">Assets</code> folder.</li><li class="listitem">Go back to Unity. From the <code class="literal">Assets</code> folder, select <code class="literal">HEIGHT_detail</code>. Then, from the <span class="strong"><strong>Inspector</strong></span> view, change its <span class="strong"><strong>Texture Type</strong></span> to <span class="strong"><strong>Normal map</strong></span>, check the <span class="strong"><strong>Create from Grayscale</strong></span> option, adjust <span class="strong"><strong>Bumpiness</strong></span> to <code class="literal">0.25</code>, and set <span class="strong"><strong>Filtering</strong></span> to <code class="literal">smooth</code>. Click on <span class="strong"><strong>Apply</strong></span> to save the changes:<div class="mediaobject"><img alt="How to do it..." src="graphics/1362OT_04_37.jpg"/></div></li><li class="listitem">From the <span class="strong"><strong>Hierarchy</strong></span> view, expand the <span class="strong"><strong>rocketToy</strong></span> GameObject and select its child called <span class="strong"><strong>rocketLevel1</strong></span>. Then, scroll down the <span class="strong"><strong>Inspector</strong></span> view to the <span class="strong"><strong>Material</strong></span> component. Assign <code class="literal">MASK_ship</code> to the <span class="strong"><strong>Detail Mask</strong></span> slot; <code class="literal">DIFF_detail</code> as <span class="strong"><strong>Secondary Maps</strong></span> | <span class="strong"><strong>Detail Diffuse x 2</strong></span>; and <code class="literal">HEIGHT_detail</code> as <span class="strong"><strong>Secondary Maps</strong></span> | <span class="strong"><strong>Normal Map</strong></span>. Also, turn the <span class="strong"><strong>Normal Map</strong></span> intensity down to <code class="literal">0.6</code>.</li><li class="listitem">In the <span class="strong"><strong>Secondary Maps</strong></span> section, change the <span class="strong"><strong>Tiling</strong></span> values to <span class="strong"><strong>X</strong></span>: <code class="literal">200</code>, and <span class="strong"><strong>Y</strong></span>: <code class="literal">50</code>. You might <a class="indexterm" id="id411"/>notice that the pattern is not seamless. This is<a class="indexterm" id="id412"/> because we are using the same <span class="strong"><strong>UV Set</strong></span> from our <span class="strong"><strong>Diffuse</strong></span> texture. However, the object has been assigned to two different<a class="indexterm" id="id413"/> <span class="strong"><strong>UV channels</strong></span> (back when it was being modeled). While UV channel 1 contains the mapping for our <span class="strong"><strong>Diffuse</strong></span> map, UV channel 2 uses a basic cylindrical mapping. We need to change the <span class="strong"><strong>Secondary Maps</strong></span> section's <span class="strong"><strong>UV Set</strong></span> from <span class="strong"><strong>UV0</strong></span> to <span class="strong"><strong>UV1</strong></span>. The Detail map for your material is ready:<div class="mediaobject"><img alt="How to do it..." src="graphics/1362OT_04_38.jpg"/></div></li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec134"/>How it works...</h2></div></div></div><p>When in use, <span class="strong"><strong>Secondary Maps</strong></span> are blended onto the material's primary <span class="strong"><strong>Diffuse</strong></span> and <span class="strong"><strong>Normal</strong></span> maps (that's why <a class="indexterm" id="id414"/>our object is green even after the <span class="strong"><strong>Detail Diffuse</strong></span> is applied: the grey tones are superimposed on the original <span class="strong"><strong>Diffuse</strong></span> texture). By using a <span class="strong"><strong>Detail Mask</strong></span>, the artist defines which areas of the object should be affected by Secondary Maps. This is great for customization, and also for creating nuances (like the semi-bumped battery compartment in our example).</p><p>Another helpful feature is the possibility of using a separate UV channel for Details maps and Tiling. Besides adding variation to texture mapping, this allows us to paint the details that can be<a class="indexterm" id="id415"/> perceived even at a very close distance by dramatically enhancing the visual quality of our objects.</p></div></div>
<div class="section" title="Fading the transparency of a material"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec51"/>Fading the transparency of a material</h1></div></div></div><p>In this recipe, we will create an object that, once clicked, fades out and disappears. However, the script will be flexible enough to allow us adjust the initial and final alpha values. Plus, we will have the option of making the object self-destructible when turned invisible.</p><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec135"/>How to do it...</h2></div></div></div><p>Follow these steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Add a <span class="strong"><strong>Sphere</strong></span> to your scene by accessing the <span class="strong"><strong>GameObject</strong></span> | <span class="strong"><strong>3D Object</strong></span> | <span class="strong"><strong>Sphere </strong></span>menu.</li><li class="listitem">Select the <span class="strong"><strong>Sphere</strong></span> and make sure it has a collider (if you are using a custom 3D object, you might have to add a collider through the <span class="strong"><strong>Components | Physics</strong></span> menu).</li><li class="listitem">Create a new material. The easiest way to do that is to access the <span class="strong"><strong>Project</strong></span> view, click the <span class="strong"><strong>Create</strong></span> drop-down menu, and choose <span class="strong"><strong>Material</strong></span>.</li><li class="listitem">Rename your new material. For this example, let's call it <code class="literal">Fade_MAT</code>.</li><li class="listitem">Select your material. From the <span class="strong"><strong>Inspector</strong></span> view, use the drop-down menu to change its <span class="strong"><strong>Rendering Mode</strong></span> to <span class="strong"><strong>Fade</strong></span>:<div class="mediaobject"><img alt="How to do it..." src="graphics/1362OT_04_57.jpg"/></div><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="tip07"/>Tip</h3><p>The <span class="strong"><strong>Fade</strong></span> rendering mode is specifically designed for situations like this. Other rendering modes, such as Transparent, will fade turn the Albedo color transparent, but not the specular highlights nor the reflections, in which case the object will still be visible.</p></div></div></li><li class="listitem">Apply the <span class="strong"><strong>FadeMaterial</strong></span> to <span class="strong"><strong>Sphere</strong></span> by dragging it from the <span class="strong"><strong>Project</strong></span> view into the <span class="strong"><strong>Sphere</strong></span> Game Object name in the <span class="strong"><strong>Hierarchy</strong></span> view.</li><li class="listitem">From the <span class="strong"><strong>Project</strong></span> view, click the <span class="strong"><strong>Create</strong></span> drop down menu and choose <span class="strong"><strong>C# Script</strong></span>. Rename it as <code class="literal">FadeMaterial</code> and open it in your editor.</li><li class="listitem">Replace your script with the code below:<div class="informalexample"><pre class="programlisting">using UnityEngine;
using System.Collections;
public class FadeMaterial : MonoBehaviour {
  public float fadeDuration = 1.0f;
  public bool useMaterialAlpha = false;
  public float alphaStart = 1.0f;
  public float alphaEnd = 0.0f;
  public bool destroyInvisibleObject = true;
  private bool isFading = false;
  private float alphaDiff;
  private float startTime;
  private Renderer rend;
  private Color fadeColor;

  void Start () {
    rend = GetComponent&lt;Renderer&gt;();
    fadeColor = rend.material.color;

    if (!useMaterialAlpha) {
      fadeColor.a = alphaStart;
    } else {
      alphaStart = fadeColor.a;
    }

    rend.material.color = fadeColor;
    alphaDiff = alphaStart - alphaEnd;
  }

  void Update () {
    if(isFading){
      var elapsedTime = Time.time - startTime;

      if(elapsedTime &lt;= fadeDuration){
        var fadeProgress = elapsedTime / fadeDuration;
        var alphaChange = fadeProgress * alphaDiff;
        fadeColor.a = alphaStart - alphaChange;
        rend.material.color = fadeColor;
        } else {
        fadeColor.a = alphaEnd;
        rend.material.color = fadeColor;

        if(destroyInvisibleObject)
          Destroy (gameObject);
        isFading = false;  
      }
    }
  }

  void OnMouseUp(){
    FadeAlpha();
  }

  public void FadeAlpha(){
    isFading = true;
    startTime = Time.time;
  }
}</pre></div></li><li class="listitem">Save your script and apply it to the <span class="strong"><strong>Sphere</strong></span> Game.</li><li class="listitem">Play your scene and click on the <span class="strong"><strong>Sphere</strong></span> to see it fade away and self-destruct.</li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec136"/>How it works...</h2></div></div></div><p>Since the opaqueness of the material using a transparent Shader is determined by the alpha value of its main color, all we need to do in order to fade it is changing that value over a given amount of time. This transformation is expressed, in our script, on the following lines of code:</p><div class="informalexample"><pre class="programlisting">var fadeProgress = elapsedTime / fadeDuration;
var alphaChange = fadeProgress * alphaDiff;
fadeColor.a = alphaStart - alphaChange;
rend.material.color = fadeColor;</pre></div></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec137"/>There's more...</h2></div></div></div><p>You could call the <code class="literal">FadeAlpha</code> function in other circumstances (such as a <code class="literal">Rigidbody</code> collision, for instance). In fact, you could even call it from another Game Object's script by using the <code class="literal">GetComponent</code> command. The script would be something like:</p><div class="informalexample"><pre class="programlisting">GameObject.Find("Sphere").GetComponent&lt;FadeMaterial&gt;().FadeAlpha();</pre></div></div></div>
<div class="section" title="Playing videos inside a scene"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec52"/>Playing videos inside a scene</h1></div></div></div><p>TV sets, projectors, monitors.... If you want complex animated materials in your level, you can play video files as texture maps. In this recipe, we will learn how to apply a video texture to a cube. We will also implement a simple control scheme that plays or pauses the video whenever that cube is clicked on.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec138"/>Getting ready</h2></div></div></div><p>Unity imports video files through Apple Quicktime. If you don't have it installed in your machine, please download it at <a class="ulink" href="http://www.apple.com/quicktime/download/">http://www.apple.com/quicktime/download/</a>.</p><p>Also, if you need a video file to follow this recipe, please use the <code class="literal">videoTexture.mov</code> included in the folder <code class="literal">1632_04_08</code>.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec139"/>How to do it...</h2></div></div></div><p>Follow these steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Add a cube to the scene through the <span class="strong"><strong>GameObject</strong></span> | <span class="strong"><strong>3D Object</strong></span> | <span class="strong"><strong>Cube</strong></span> menu.</li><li class="listitem">Import the provided <code class="literal">videoTexture.mov</code> file.</li><li class="listitem">From the <span class="strong"><strong>Project</strong></span> view, use the <span class="strong"><strong>Create</strong></span> drop-down menu to create a new <span class="strong"><strong>Material</strong></span>. Rename it <code class="literal">Video_MAT</code> and, from the <span class="strong"><strong>Inspector</strong></span> view, change its <span class="strong"><strong>Shader</strong></span> to <span class="strong"><strong>Unlit/Texture</strong></span>:<div class="mediaobject"><img alt="How to do it..." src="graphics/1362OT_04_58.jpg"/></div></li><li class="listitem">Apply <code class="literal">videoTexture</code> to the texture slot of <code class="literal">Video_MAT</code> by dragging it from the <span class="strong"><strong>Project</strong></span> view into the appropriate slot.</li><li class="listitem">Apply the <code class="literal">Video_MAT</code> to the <span class="strong"><strong>Cube</strong></span> you have previously created.</li><li class="listitem">Expand <code class="literal">videoTexture</code> on the <span class="strong"><strong>Project</strong></span> view to reveal its correspondent <span class="strong"><strong>Audio Clip</strong></span>. Then, apply that audio clip to the <span class="strong"><strong>Cube</strong></span> (you can do it by dragging it from the <span class="strong"><strong>Project</strong></span> view to the <span class="strong"><strong>Cube</strong></span> in the <span class="strong"><strong>Hierarchy</strong></span> view, or a <span class="strong"><strong>Scene</strong></span> view).<div class="mediaobject"><img alt="How to do it..." src="graphics/1362OT_04_59.jpg"/></div></li><li class="listitem">Select the <span class="strong"><strong>Cube</strong></span>. Make sure there is a <span class="strong"><strong>Collider</strong></span> component visible from the <span class="strong"><strong>Inspector</strong></span> view. In case there isn't one, add it via the <span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>Physics</strong></span> | <span class="strong"><strong>Box Collider</strong></span> menu. Colliders are needed for mouse collision detection.</li><li class="listitem">Now we need to create a script for controlling the movie texture and associated audio clip. From <span class="strong"><strong>Project</strong></span> view, use the <span class="strong"><strong>Create</strong></span> drop-down menu to add a <span class="strong"><strong>C# Script</strong></span>. Name it <code class="literal">PlayVideo</code>.</li><li class="listitem">Open the script and replace it with the following code:<div class="informalexample"><pre class="programlisting">using UnityEngine;
using System.Collections;

[RequireComponent(typeof(AudioSource))]

public class PlayVideo : MonoBehaviour {

  public bool loop = true;
  public bool playFromStart = true;
  public MovieTexture video;
    public AudioClip audioClip;
  private AudioSource audio;

  void Start () {
    audio = GetComponent&lt;AudioSource&gt; ();

    if (!video)
      video = GetComponent&lt;Renderer&gt;().material.mainTexture as MovieTexture;

    if (!audioClip)
        audioClip = audio.clip;

    video.Stop ();
    audio.Stop ();
    video.loop = loop;
    audio.loop = loop;

    if(playFromStart)
      ControlMovie();
  }
  
  void OnMouseUp(){
    ControlMovie();
  }

  public void ControlMovie(){
  
    if(video.isPlaying){
      video.Pause();
      audio.Pause();
    } else {
      video.Play();
      audio.Play();
    }
  }
}</pre></div></li><li class="listitem">Save your script and attach it to the <span class="strong"><strong>Cube</strong></span>.</li><li class="listitem">Test your scene. You should be able to see the movie being played in the cube face, and also pause/play it by clicking on it.</li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec140"/>How it works...</h2></div></div></div><p>By default, our script makes the movie texture play in loop mode. There is, however, a Boolean variable than can be changed through the <span class="strong"><strong>Inspector</strong></span> panel, where it is represented by a check box. Likewise, there is a check box that can be used to prevent the movie from playing when the level starts.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec141"/>There's more...</h2></div></div></div><p>There are some other movie texture commands and parameters that can be played with. Don't forget to check out Unity's scripting guide at <a class="ulink" href="http://docs.unity3d.com/Documentation/ScriptReference/MovieTexture.html">http://docs.unity3d.com/Documentation/ScriptReference/MovieTexture.html</a>.</p></div></div>
<div class="section" title="Conclusion"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec53"/>Conclusion</h1></div></div></div><p>This chapter has covered a number of techniques used to create, often manually and sometimes automatically, texture maps that are capable of giving distinctive features to materials. Hopefully, you are now more confident about working with Unity's new Physically-Based Shading, which is capable of understanding differences between available workflows, is aware of the role of each material property, and is ready to make better-looking materials for your games. We have also explored ways of changing the properties of materials during runtime by accessing an object's material via script.</p><div class="section" title="Resources"><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec142"/>Resources</h2></div></div></div><p>Physically-Based Rendering is a <a class="indexterm" id="id416"/>complex (and current) topic, so it's a good idea to study it a bit by familiarizing yourself with the tools and concepts behind it. To help you with this task, we have included a non-exhaustive list of resources below that you should take a look at.</p><div class="section" title="References"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl3sec33"/>References</h3></div></div></div><p>Here's a list of interesting, detailed material on Physically-Based Rendering (within and outside Unity):</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="emphasis"><em>The Comprehensive PBR Guide Volumes 1 and 2</em></span> by Wes McDermott (Allegorithmic), available at <a class="ulink" href="http://www.allegorithmic.com/pbr-guide">http://www.allegorithmic.com/pbr-guide</a>. This guide<a class="indexterm" id="id417"/> takes an in-depth look at the practical and theoretical aspects of PBR, including great analysis of possible workflows.</li><li class="listitem" style="list-style-type: disc"><span class="emphasis"><em>Mastering Physically Based Shading in Unity 5</em></span> by Renaldas Zioma (Unity), Erland Körner (Unity), and Wes McDermott (Allegorithmic), is available at <a class="ulink" href="http://www.slideshare.net/RenaldasZioma/unite2014-mastering-physically-based-shading-in-unity-5">http://www.slideshare.net/RenaldasZioma/unite2014-mastering-physically-based-shading-in-unity-5</a>. This is a detailed presentation about using PBS in Unity. Originally presented at the Unite 2014 conference, it contains some out-of-date information, but, nevertheless, it is still worth taking a look at.</li><li class="listitem" style="list-style-type: disc"><span class="emphasis"><em>Physically Based Shading in Unity 5</em></span> by Aras Pranckevičius, from Unity, is available at <a class="ulink" href="http://aras-p.info/texts/talks.html">http://aras-p.info/texts/talks.html</a>. Slides and notes from a presentation on the subject are given at the GDC.</li><li class="listitem" style="list-style-type: disc"><span class="emphasis"><em>Tutorial: Physically Based Rendering, And You Can Too!</em></span> by Joe "EarthQuake" Wilson is available at <a class="ulink" href="http://www.marmoset.co/toolbag/learn/pbr-practice">http://www.marmoset.co/toolbag/learn/pbr-practice</a>. It is a great overview from the makers of <span class="strong"><strong>Marmoset Toolbag</strong></span> and <span class="strong"><strong>Skyshop</strong></span>.</li><li class="listitem" style="list-style-type: disc"><span class="emphasis"><em>Polycount PBR Wiki</em></span>, which is available at <a class="ulink" href="http://wiki.polycount.com/wiki/PBR">http://wiki.polycount.com/wiki/PBR</a>, is a list of resources compiled by the Polycount <a class="indexterm" id="id418"/>community.</li></ul></div></div><div class="section" title="Tools"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl3sec34"/>Tools</h3></div></div></div><p>This is a new generation of texturing software for you to check out, in case you haven't yet:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="emphasis"><em>Substance Painter</em></span> is a 3D painting application from Allegorithmic. It is available at <a class="ulink" href="http://www.allegorithmic.com/products/substance-painter">http://www.allegorithmic.com/products/substance-painter</a>. Again, it's worth <a class="indexterm" id="id419"/>mentioning that Allegorithmic products won't make use of Unity's Standard Shader, relying instead on substance files that are<a class="indexterm" id="id420"/> natively supported by Unity.</li><li class="listitem" style="list-style-type: disc"><span class="emphasis"><em>Bitmap2Material</em></span> creates<a class="indexterm" id="id421"/> full-featured materials (including normal maps, specular maps, and more) from a single bitmap image. Also, it is<a class="indexterm" id="id422"/> from Allegorithmic, and it is available at <a class="ulink" href="http://www.allegorithmic.com/products/bitmap2material">http://www.allegorithmic.com/products/bitmap2material</a>.</li><li class="listitem" style="list-style-type: disc"><span class="emphasis"><em>Quixel DDO</em></span> is a plugin for<a class="indexterm" id="id423"/> creating PBR-ready textures in Adobe <a class="indexterm" id="id424"/>Photoshop. From Quixel, it is available at <a class="ulink" href="http://www.quixel.se/ddo">http://www.quixel.se/ddo</a>.</li><li class="listitem" style="list-style-type: disc"><span class="emphasis"><em>Quixel NDO</em></span> is a plugin for<a class="indexterm" id="id425"/> creating <a class="indexterm" id="id426"/>Normal maps in Adobe Photoshop. From Quixel, it is available at <a class="ulink" href="http://www.quixel.se/ndo">http://www.quixel.se/ndo</a>.</li><li class="listitem" style="list-style-type: disc"><span class="emphasis"><em>Mari</em></span> is a 3D<a class="indexterm" id="id427"/> painting tool from <a class="indexterm" id="id428"/>The Foundry. It is available at <a class="ulink" href="http://www.thefoundry.co.uk/products/mari/">http://www.thefoundry.co.uk/products/mari/</a>.</li></ul></div></div></div></div></body></html>