<html><head></head><body>
		<div><h1 id="_idParaDest-251"><em class="italic"><a id="_idTextAnchor356"/>Chapter 12</em>: Working with MVC/Razor Pages</h1>
			<p>ABP Framework was designed to be modular, layered, and UI framework-agnostic. It is perfect for server-client architecture, and in theory, it can work with any kind of UI technology. The server-side uses the standard authentication protocols and provides standard-compliant HTTP APIs. You can use your favorite SPA framework and consume server-side APIs easily. In this way, you can utilize the entire server-side infrastructure of ABP Framework.</p>
			<p>However, ABP Framework helps with your UI development too. It provides systems so that you can build modular user interfaces, UI themes, layouts, navigation menus, and toolbars. It makes your development process easier while working with data tables, modals, and forms or authenticating and communicating with the server.</p>
			<p>ABP Framework is well integrated with, and provides startup solution templates for, the following UI frameworks:</p>
			<ul>
				<li>ASP.NET Core MVC/Razor Pages</li>
				<li>Blazor</li>
				<li>Angular </li>
			</ul>
			<p>In the fourth section of this book, I will cover working with the MVC/Razor Pages and Blazor UI options. In this chapter, you will learn how ABP Framework's MVC/Razor Page infrastructure is designed and how it can help you with your regular UI development cycle.</p>
			<p>I call this UI type MVC/Razor Pages as it supports both the MVC and Razor Pages approaches. You can even use both in a single application. However, since Razor Pages (introduced with ASP.NET Core 2.0) is Microsoft's recommended approach for new applications, all pre-built ABP modules, samples, and documents use the Razor Pages approach.</p>
			<p>This chapter covers the following topics:</p>
			<ul>
				<li>Understanding the theming system</li>
				<li>Using bundling and minification</li>
				<li>Working with menus</li>
				<li>Working with Bootstrap tag helpers</li>
				<li>Creating forms and implementing validation</li>
				<li>Working with modals</li>
				<li>Using the JavaScript API</li>
				<li>Consuming HTTP APIs</li>
			</ul>
			<h1 id="_idParaDest-252"><a id="_idTextAnchor357"/>Technical requirements</h1>
			<p>If you want to follow along with the examples in this chapter, you will need to have an IDE/editor that supports ASP.NET Core development. We will use the ABP CLI at some points, so you will need to install the ABP CLI, as explained in <a href="B17287_02_Epub_AM.xhtml#_idTextAnchor026"><em class="italic">Chapter 2</em></a>, <em class="italic">Getting Started with ABP Framework</em>. Finally, you will need to install Node.js v14+ to be able to install NPM packages.</p>
			<p>You can download the example application from this book's GitHub repository: <a href="https://github.com/PacktPublishing/Mastering-ABP-Framework">https://github.com/PacktPublishing/Mastering-ABP-Framework</a>. It contains some of the examples provided in this chapter.</p>
			<h1 id="_idParaDest-253"><a id="_idTextAnchor358"/>Understanding the theming system</h1>
			<p>UI styling <a id="_idIndexMarker755"/>is the most customized part of an application, and you have plenty of options. You can start with one of the UI kits such as Bootstrap, Tailwind CSS, or Bulma as the base for your application UI. You can then build a design language or buy a pre-built, cheap UI theme from a theme market. If you are building an independent application, you can make your selections and create your UI pages and components based on <a id="_idIndexMarker756"/>these selections. Your pages and styling don't have to be compatible with another application.</p>
			<p>On the other hand, if you want to build a modular application where each module's UI is independently developed (probably by a separate team) where the modules come together at runtime as a single application, you need to determine a design standard that should be implemented by all the module developers so that you have a consistent user interface.</p>
			<p>Since ABP Framework provides a modular infrastructure, it provides a theming system that determines a set of base libraries and standards. This helps ensure that the application and module developers can build UI pages and components without depending on a particular theme or style set. Once the module/application code is theme-independent and the theme standards are explicit, you can build different themes and easily use that theme for an application with a simple configuration.</p>
			<p>ABP Framework provides two free pre-built UI themes:</p>
			<ul>
				<li>The <strong class="bold">Basic</strong> theme<a id="_idIndexMarker757"/> is a minimalist theme that is built on the plain Bootstrap styling. It is ideal if you want to build styling from scratch.</li>
				<li>The <strong class="bold">LeptonX</strong> theme<a id="_idIndexMarker758"/> is a modern and production-ready <a id="_idIndexMarker759"/>UI theme built by the ABP Framework team.</li>
			</ul>
			<p>This book uses the Basic theme in all examples. The following is a screenshot of the LeptonX theme:</p>
			<div><div><img src="img/Figure_12.01_B17287.jpg" alt="Figure 12.1 – The LeptonX theme and the application layout&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.1 – The LeptonX theme and the application layout</p>
			<p>Pre-built UI themes are deployed as NuGet and NPM packages, so you can easily install and switch between them.</p>
			<p>The next two sections will introduce the fundamental base libraries and layouts that are shared by these themes.</p>
			<h2 id="_idParaDest-254"><a id="_idTextAnchor359"/>The base libraries</h2>
			<p>To make modules/applications independent of a particular theme, ABP determines some base CSS and JavaScript libraries that our module/application can rely on.</p>
			<p>The first <a id="_idIndexMarker760"/>and the most fundamental dependency of the ABP Framework MVC/Razor Pages UI is the <em class="italic">Twitter Bootstrap</em> framework. Starting with ABP Framework version 5.0, Bootstrap 5.x is used.</p>
			<p>Besides Bootstrap, there are some other core library dependencies such as Datatables.Net, JQuery, JQuery Validation, FontAwesome, Sweetalert, Toastr, Lodash, and more. No additional setup is needed if you want to use these standard libraries in your module or application.</p>
			<p>The next section will explain the layout system that is needed to understand how a web page is built.</p>
			<h2 id="_idParaDest-255"><a id="_idTextAnchor360"/>The layouts</h2>
			<p>A typical web page<a id="_idIndexMarker761"/> consists of two parts – the layout and the page's content. The layout shapes the overall page and generally includes the main header, a company/product logo, the main navigation menu, a footer, and other standard components. The following screenshot shows these parts on an example layout:</p>
			<div><div><img src="img/Figure_12.02_B17287.jpg" alt="Figure 12.2 – Parts of a page layout&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.2 – Parts of a page layout</p>
			<p>In modern web applications, layouts <a id="_idIndexMarker762"/>are designed to be responsive, which means they change their shape and placing so that they are suitable for the device that's being used by the current user. </p>
			<p>The layout's content almost remains the same across different pages – only the page's content changes. The page's content is generally a large part of the layout and may scroll if the content is larger than the height of the screen.</p>
			<p>A web application may have different layout requirements in different parts/pages. In ABP Framework, a theme can define one or more layouts. Every layout has a unique <code>string</code> name, and ABP Framework defines four standard layout names:</p>
			<ul>
				<li><code>Application</code>: Designed for back-office-style web applications with a header, menu, toolbar, footer, and so on. An example is shown in <em class="italic">Figure 12.1</em>.</li>
				<li><code>Account</code>: Designed for login, register, and other account-related pages.</li>
				<li><code>Public</code>: Designed for public-facing websites, such as a landing page for your product.</li>
				<li><code>Empty</code>: A layout without an actual layout. The page's content covers the entire screen.</li>
			</ul>
			<p>These strings are defined in the <code>Volo.Abp.AspNetCore.Mvc.UI.Theming. StandardLayouts</code> class. Every theme must define the <code>Application</code>, <code>Account</code>, and <code>Empty</code> layouts because they are common for most applications. The <code>Public</code> layout is optional and falls back to the <code>Application</code> layout if it's not implemented by the theme. A theme may define more layouts with different names.</p>
			<p>The <code>Application</code> layout <a id="_idIndexMarker763"/>is the default unless you change it. You can change it per page/view or for a folder. If you change it for a folder, all the pages/views under that folder will use the selected layout.</p>
			<p>To change it for a page/view, inject the <code>IThemeManager</code> service and use the <code>CurrentTheme.GetLayout</code> method with a layout name:</p>
			<pre>@inject IThemeManager ThemeManager
@{
    Layout = ThemeManager.CurrentTheme
             .GetLayout(StandardLayouts.Empty);
}</pre>
			<p>Here, you can use the <code>StandardLayouts</code> class to get the standard layout names. For this example, we could use <code>GetLayout("Empty")</code> since the value of <code>StandardLayouts.Empty</code> is a constant <code>string</code> that's <code>Empty</code>. In this way, you can get your theme's non-standard layouts with their <code>string</code> names.</p>
			<p>If you want to change the layout for all the pages/views in a folder, you can create a <code>_ViewStart.cshtml</code> file in that folder and place the following code inside it:</p>
			<pre>@using Volo.Abp.AspNetCore.Mvc.UI.Theming
@inject IThemeManager ThemeManager
@{
    Layout = ThemeManager.CurrentTheme
             .GetLayout(StandardLayouts.Account);
}</pre>
			<p>If you place that <code>_ViewStart.cshtml</code> file in the <code>Pages</code> folder (or in <code>Views</code> for MVC views), all your pages will use the selected layout unless you select another layout for a subfolder or a particular page/view.</p>
			<p>We can easily select a layout for our page to place content in. The next section will explain how to import script/style files into our pages and utilize the bundling and minification system.</p>
			<h1 id="_idParaDest-256"><a id="_idTextAnchor361"/>Using the bundling and minification system</h1>
			<p>ABP offers an end-to-end <a id="_idIndexMarker764"/>solution for installing client-side packages, adding script/style files to the pages, and bundling and minifying these files in development and production environments.</p>
			<p>Let's start by installing a client-side package for the application.</p>
			<h2 id="_idParaDest-257"><a id="_idTextAnchor362"/>Installing NPM packages</h2>
			<p>NPM is the<a id="_idIndexMarker765"/> de facto package manager for JavaScript/CSS libraries. When you create a new solution with the MVC/Razor Pages UI, you will see a <code>package.json</code> file in the web project's root folder. The initial content of the <code>package.json</code> file will look something like this:</p>
			<pre>{
  ...
  "dependencies": {
    "@abp/aspnetcore.mvc.ui.theme.basic": "^5.0.0"
  }
}</pre>
			<p>Initially, we have a single NPM package dependency called <code>@abp/aspnetcore.mvc.ui.theme.basic</code>. This package has dependencies on all the base CSS/JavaScript libraries that are necessary for the Basic theme. If we want to install another NPM package, we can use the standard <code>npm install</code> (or <code>yarn add</code>) command.</p>
			<p>Let's assume that we want to use the <em class="italic">Vue.js</em> library in our application. We can run the following command in the root directory of the web <a id="_idTextAnchor363"/>project:</p>
			<pre>npm install vue</pre>
			<p>This command installs the <code>vue</code> NPM package in the <code>node_modules/vue</code> folder. However, we can't use the files under the <code>node_modules</code> folder. We should copy the necessary files<a id="_idIndexMarker766"/> into the <code>wwwroot</code> folder of the web project to import them into the pages.</p>
			<p>You can copy the necessary files manually, but this is not the best way. ABP provides an <code>install-libs</code> command to automate this process using a mapping file. Open the <code>abp.resourcemapping.js</code> file under the web project and add the following code to the <code>mappings</code> di<a id="_idTextAnchor364"/>ctionary:</p>
			<pre>"@node_modules/vue/dist/vue.min.js": "@libs/vue/"</pre>
			<p>The final content of the <code>abp.resourcemapping.js</code> file should look as follows:</p>
			<pre>module.exports = {
    aliases: { },
    mappings: {
        "@node_modules/vue/dist/vue.min.js": "@libs/vue/"
    }
};</pre>
			<p>Now, we can run the following command in a command-line terminal, in the root directory of the web project:</p>
			<pre>abp install-libs</pre>
			<p>The <code>vue.min.js</code> file should be copied under the <code>wwwroot/libs/vue</code> folder:</p>
			<div><div><img src="img/Figure_12.03_B17287.jpg" alt="Figure 12.3 – Adding the Vue.js library to the web project&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.3 – Adding the Vue.js library to the web project</p>
			<p>Mappings support glob/wildcard patterns. For example, you can copy all the files in the <code>vue</code> package with the following mapping:</p>
			<pre>"@node_modules/vue/dist/*": "@libs/vue/"</pre>
			<p>The <code>libs</code> folder is committed to the source control system (such as Git) by default. This means that if your teammate gets the code from your source control system, they don't need to <a id="_idIndexMarker767"/>run the <code>npm install</code> or <code>abp install-libs</code> commands. If you want, you can add the <code>libs</code> folder to the ignore file of your source control (such as <code>.gitignore</code> for Git). In this case, you need to run the <code>npm install</code> and <code>abp install-libs</code> commands before running the application.</p>
			<p>The next section explains the standard ABP NPM packages.</p>
			<h2 id="_idParaDest-258"><a id="_idTextAnchor365"/>Using the standard packages</h2>
			<p>Building a<a id="_idIndexMarker768"/> modular system has another challenge – all the modules should use the same (or compatible) version of the same NPM package. ABP Framework provides a set of standard NPM packages to allow the ABP ecosystem to use the same version of these NPM packages and automate the mapping to copy the resources to the <code>libs</code> folder.</p>
			<p><code>@abp/vue</code> is one of these standard packages that can be used to install the Vue.js library in your project. You can install this package instead of the <code>vue</code> package:</p>
			<pre>npm install @abp/vue</pre>
			<p>Now, you can run the <code>abp install-libs</code> command to copy the <code>vue.min.js</code> file into the <code>wwwroot/libs/vue</code> folder. Notice that you don't need to define the mapping in the <code>abp.resourcemapping.js</code> file since the <code>@abp/vue</code> package already includes the necessary mapping configuration.</p>
			<p>It is suggested that you use the standard <code>@abp/*</code> packages when they are available. In this way, you can depend on a standard version of the related library, and you don't need to configure the <code>abp.resourcemapping.js</code> file manually.</p>
			<p>However, when <a id="_idIndexMarker769"/>you install the library in your project, you will need to import it into the page to use it in your application.</p>
			<h2 id="_idParaDest-259"><a id="_idTextAnchor366"/>Importing script and style files</h2>
			<p>Once we have<a id="_idIndexMarker770"/> installed a JavaScript or CSS library, we can include it in any page or bundle. Let's start with the most simple case – you can import <code>vue.min.js</code> into a Razor Page or view it using the fol<a id="_idTextAnchor367"/>lowing code:</p>
			<pre>@section scripts {
    &lt;abp-script src=»/libs/vue/vue.min.js» /&gt;
}</pre>
			<p>Here, we are importing JavaScript files into the <code>scripts</code> section, so the theme is placing them at the end of the HTML document, after the global scripts. <code>abp-script</code> is a tag helper that's defined by ABP Framework to include scripts to the page/view. It is rendered as follows:</p>
			<pre>&lt;script src=»/libs/vue/vue.min.js?_v=637653840922970000»&gt;&lt;/script&gt;</pre>
			<p>We could use a standard <code>script</code> tag, but <code>abp-script</code> has the following advantages:</p>
			<ul>
				<li>It automatically <a id="_idIndexMarker771"/>minifies the file in the production (or staging) environment if the given file is not already minified. If it is not minified and ABP finds the minified file near the original file, it uses the pre-minified file instead of dynamically minifying at runtime.</li>
				<li>It adds a query string parameter to add versioning information so that the browsers don't cache it when the file changes. This means that when you re-deploy your application, browsers don't accidentally cache the old versions of your script files.</li>
				<li>ABP ensures that the file is added to the page only once, even if you include it multiple times. This is a good feature if you wish to build a modular system since different module components may include the same library independent of each other, and ABP Framework eliminates this duplication.</li>
			</ul>
			<p>Once we have<a id="_idIndexMarker772"/> included Vue.js in a page, we can utilize its power to create highly dynamic pages. Here is an example Razor Page, named <code>VueDemo.cshtml</code>:</p>
			<pre>@page
@model MvcDemo.Web.Page<a id="_idTextAnchor368"/>s.VueDemoModel
@sec<a id="_idTextAnchor369"/>tion scripts {
    &lt;abp-script src=»/libs/vue/vue.min.js» /&gt;
    &lt;script&gt;
        var app = new Vue({
            el: '#app',
            data: {
                message: 'Hello Vue!'
            }
        })
    &lt;/script&gt;
}
&lt;div id="app"&gt;
    &lt;h2&gt;{{ message }}&lt;/h2&gt;
&lt;/div&gt;</pre>
			<p>If you run this page, a <strong class="bold">Hello Vue!</strong> message will be shown on the UI. I can recommend using Vue.js in some pages of your MVC/Razor Pages applications when you need to build complex and dynamic user interfaces.</p>
			<p>Let's take this example one step further and move the custom JavaScript code into a separate file. Create a JavaScript file named <code>VueDemo.cshtml.js</code> in the same folder:</p>
			<div><div><img src="img/Figure_12.04_B17287.jpg" alt="Figure 12.4 – Adding a JavaScript file&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.4 – Adding a JavaScript file</p>
			<p>I prefer this naming convention, but you can set any name for the JavaScript file.</p>
			<p class="callout-heading">JavaScript/CSS Files Under the Pages Folder</p>
			<p class="callout">In a regular ASP.NET Core application, you should place all the JavaScript/CSS files under the <code>wwwroot</code> folder. ABP allows you to add JavaScript/CSS files to the <code>Pages</code> or <code>Views</code> folder, near the corresponding <code>.cshtml</code> file. I find this approach to be pretty useful since we keep the related files together.</p>
			<p>The content of the new JavaScript file is shown in the followin<a id="_idTextAnchor370"/>g code block:</p>
			<pre>var app = new Vue({
    el: '#app',
    data: {
        message: 'Hello Vue!'
    }
});</pre>
			<p>Now, we can <a id="_idIndexMarker773"/>update the <code>VueDemo.cshtml</code> file's content, as shown in the following code block:</p>
			<pre>@page
@model MvcDemo.Web.Pages.VueDemoModel
@section scripts {
    &lt;abp-script src=»/libs/vue/vue.<a id="_idTextAnchor371"/>min.js» /&gt;
    &lt;abp-script src=»/Pages/VueDemo.cshtml.js» /&gt;
}
&lt;div id="app"&gt;
    &lt;h2&gt;{{ message }}&lt;/h2&gt;
&lt;/div&gt;</pre>
			<p>It is good to keep JavaScript code in a separate file and include it on the page as an external file, as in the preceding example.</p>
			<p>Working with style (CSS) files is<a id="_idIndexMarker774"/> pretty similar to working with script files. The following example uses the <code>styles</code> section and the <code>abp-style</code> tag helper to import a style fi<a id="_idTextAnchor372"/>le on the page:</p>
			<pre>@section styles {
    &lt;abp-style src="img/VueDemo.cshtml.css" /&gt;
}</pre>
			<p>We can import multiple script or style files into a page. The next section will show you how to bundle these files as a single, minified file in production.</p>
			<h2 id="_idParaDest-260"><a id="_idTextAnchor373"/>Creating page bundles</h2>
			<p>When we use<a id="_idIndexMarker775"/> multiple <code>abp-script</code> (or <code>abp-style</code>) tags on a page, ABP individually includes the files on the page and includes the minified versions in production. However, we generally want to create a single bundled and minified file in production. We can use the <code>abp-script-bundle</code> and <code>abp-style-bundle</code> tag helpers to create bundles for a page, as shown in the following example:</p>
			<pre>@secti<a id="_idTextAnchor374"/>on scripts {
    &lt;abp-script-bundle&gt;
        &lt;abp-script src=»/libs/vue/vue.min.js» /&gt;
        &lt;abp-script src=»/Pages/VueDemo.cshtml.js» /&gt;
    &lt;/abp-script-bundle&gt;
}</pre>
			<p>Here, we are creating a bundle that includes two files. ABP automatically minifies these files and bundles them as a single file, and then versions this single file in the production environment. ABP makes the bundling operation in the first request to the page and then caches the bundled file in memory. It uses the cached bundle file for subsequent requests.</p>
			<p>You can use conditional logic or dynamic code inside the bundle tags, as shown in the following example:</p>
			<pre>&lt;abp-script-bundle&gt;
    &lt;abp-script src="img/vali<a id="_idTextAnchor375"/>dator.js" /&gt;
    @if (System.Globalization.CultureInfo
         .CurrentUICulture.Name == "tr")
    {
        &lt;abp-script src="img/validator.tr.js" /&gt;
    }
    &lt;abp-script src="img/some-other.js" /&gt;
&lt;/abp-script-bundle&gt;</pre>
			<p>This example <a id="_idIndexMarker776"/>adds a sample validation library to the bundle and conditionally adds the Turkish localization script. If the user's language is Turkish, then Turkish localization will be added to the bundle. Otherwise, it won't be added. ABP can understand the difference – it creates and caches two separate bundles, one for Turkish users and one for the rest.</p>
			<p>With that, we've learned how to create bundles for an individual page. In the next section, we will explain how to configure global bundles.</p>
			<h2 id="_idParaDest-261"><a id="_idTextAnchor376"/>Configuring global bundles</h2>
			<p>The bundling tag <a id="_idIndexMarker777"/>helpers are very useful for page bundles. You can also use them if you are creating custom layouts. However, when we use themes, the layouts are controlled by the theme.</p>
			<p>Let's assume that we've decided to use the Vue.js library on all the pages and want to add it to the global bundle instead of adding it to every page individually. For this, we can configure <code>AbpBundlingOptions</code> in <code>ConfigureServices</code> of our module (in the web project), as shown in the following code block:</p>
			<pre>Configure&lt;AbpBundlingOptions<a id="_idTextAnchor377"/>&gt;(options =&gt;
{
    options.ScriptBundles.Configure(
        StandardBundles.Scripts.Global,
        bundle =&gt;
        {
            bundle.AddFiles(«/libs/vue/vue.min.js»);
        }
    );
    options.StyleBundles.Configure(
        StandardBundles.Styles.Global,
        bundle =&gt;
        {
            bundle.AddFiles("/global-styles.css");
        }
    );
});</pre>
			<p>The <code>options.ScriptBundles.Configure</code> method is used to manipulate a bundle with the <a id="_idIndexMarker778"/>given name. The first parameter is the name of the bundle. <code>StandardBundles.Scripts.Global</code> is a <code>constant string</code> whose value is the name of the global script bundle, which is imported by all the layouts. The preceding example also adds a CSS file to the global style bundle.</p>
			<p>The global bundles are just named bundles. We will explain these in the next section.</p>
			<h2 id="_idParaDest-262"><a id="_idTextAnchor378"/>Creating named bundles</h2>
			<p>Page-based bundling is <a id="_idIndexMarker779"/>a simple way to create bundles for a single page. However, there are situations where you will need to define a bundle and reuse it on multiple pages. As explained in the previous section, the global style and script bundles were named bundles. We can also define custom-named bundles and import the bundle in any page or layout.</p>
			<p>The following example defines a named bundle and adds three JavaScript files inside it:</p>
			<pre>Configure&lt;AbpBundlingOptio<a id="_idTextAnchor379"/>ns&gt;(options =&gt;
{
    options
        .ScriptBundles
        .Add("MyGlobalScripts", bundle =&gt; {
            bundle.AddFiles(
                "/libs/jquery/jquery.js",
                "/libs/bootstrap/js/bootstrap.js",
                "/scripts/my-global-scripts.js"
            );
        });                
});</pre>
			<p>We can write this <a id="_idIndexMarker780"/>code in <code>ConfigureServices</code> of a module class (typically, the module class in the web layer). <code>options.ScriptBundles</code> and <code>options.StyleBundles</code> are two kinds of bundles. In this example, we've used the <code>ScriptBundles</code> property to create a bundle that includes some JavaScript files.</p>
			<p>Once we have created a named bundle, we can use it in a page/view using the <code>abp-script-bundle</code> and <code>abp-style-bundle</code> tag helpers, as shown in t<a id="_idTextAnchor380"/>he following example:</p>
			<pre>&lt;abp-script-bundle name="MyGlobalScripts" /&gt;</pre>
			<p>When we use this code in a page or view, all the script files are individually added to the page at development time. They are automatically bundled and minified in the production environment by default. The next section explains how to change this default behavior.</p>
			<h2 id="_idParaDest-263"><a id="_idTextAnchor381"/>Controlling the bundling and minification behavior</h2>
			<p>We can use the <code>AbpBundlingOptions</code> options class to change the default behavior of the bundling and <a id="_idIndexMarker781"/>minification system. See the following configuration:</p>
			<pre>Configure&lt;AbpBundlingOptions&gt;(options =&gt;
{
    options.Mode = BundlingMode.None;
});</pre>
			<p>This configuration code disables the bundling and minification logic. This means that even in production, all the script/style files are individually added to the page without bundling and minification. <code>options.Mode</code> can take one of the following values:</p>
			<ul>
				<li><code>Auto</code> (default): Bundles and minifies in production and staging environments but disables bundling and minification at development time.</li>
				<li><code>Bundle</code>: Bundles the files (creates a file per bundle) but does not minify the styles/scripts.</li>
				<li><code>BundleAndMinify</code>: Always bundles and minifies the files, even at development time.</li>
				<li><code>None</code>: Disables the bundling and minification process.</li>
			</ul>
			<p>In this book, I've explained the basic usage of the bundling and minification system. However, it has advanced features, such as creating bundle contributor classes, inheriting a bundle from another bundle, extending and manipulating bundles, and more. These features are especially helpful when you want to create reusable UI modules. Please refer to the ABP Framework documentation for all the features: <a href="https://docs.abp.io/en/abp/latest/UI/AspNetCore/Bundling-Minification">https://docs.abp.io/en/abp/latest/UI/AspNetCore/Bundling-Minification</a>. </p>
			<p>In the next section, you will learn how to work with navigation menus.</p>
			<h1 id="_idParaDest-264"><a id="_idTextAnchor382"/>Working with menus</h1>
			<p>Menus are rendered <a id="_idIndexMarker782"/>by the current theme, so the final application or modules can't directly change the menu items. You can see the main menu on the left-hand side of <em class="italic">Figure 12.1</em>. ABP provides a menu system, so the modules and the final application can dynamically add new menu items or remove/change the items that are added by those modules.</p>
			<p>We can use <code>AbpNavigationOptions</code> to add contributors to the menu system. ABP executes all the contributors to build the menu dynamically, as shown in the following example:</p>
			<pre>Configure&lt;AbpNavigationOptions&gt;(options =&gt;
{
    options.MenuContributors.Add(new MyMenuContributor());
});</pre>
			<p>Here, <code>MyMenuContributor</code> should be a class that implements the <code>IMenuContributor</code> interface. The ABP startup solution template already contains a menu contributor class that you can directly use. <code>IMenuContributor</code> defines the <code>ConfigureMenuAsync</code> method, which we should implement like so:</p>
			<pre>public class MvcDemoMenuContributor : IMenuContributor
{
    public async Task ConfigureMenuAsync(
        MenuConfigurationContext context)
    {
        if (context.Menu.Name == StandardMenus.Main)
        {
            //TODO: Configure the main menu
        }
    }
}</pre>
			<p>The first thing we should consider is the menu's name. Two standard menu names are defined as constants in the <code>StandardMenus</code> class (in the <code>Volo.Abp.UI.Navigation</code> namespace):</p>
			<ul>
				<li><code>Main</code>: The main menu of the application. It is shown on the left-hand side of <em class="italic">Figure 12.1</em>.</li>
				<li><code>User</code>: The user context menu. It is opened when you click your username on the header.</li>
			</ul>
			<p>So, the preceding <a id="_idIndexMarker783"/>example checks the menu's name and only adds items to the main menu. The following example code block adds a <strong class="bold">Customer Relation Management</strong> (<strong class="bold">CRM</strong>) menu item with two sub-menu items:</p>
			<pre>var l = context.GetLocalizer&lt;MvcDemoResource&gt;();
context.Menu.AddItem(
    new ApplicationMenuItem("MyProject.Crm", l["CRM"])
        .AddItem(new ApplicationMenuItem(
            name: "MyProject.Crm.Customers", 
            displayName: l["Customers"], 
            url: "/crm/customers")
        ).AddItem(new ApplicationMenuItem(
            name: "MyProject.Crm.Orders", 
            displayName: l["Orders"],
            url: "/crm/orders")
        )
);</pre>
			<p>In this example, we are getting an <code>IStringLocalizer</code> instance (<code>l</code>) to localize the display names of the menu items. <code>context.GetLocalizer</code> is a shortcut to getting localizer services. You can use <code>context.ServiceProvider</code> to resolve any service and apply your custom logic to build the menu.</p>
			<p>Every menu item should have a unique <code>name</code> (such as <code>MyProject.Crm.Customers</code> in this example) and a <code>displayName</code>. There are <code>url</code>, <code>icon</code>, <code>order</code>, and some other options available to control the appearance and behavior of the menu items.</p>
			<p>The basic theme renders the example menu, as shown in the following screenshot:</p>
			<div><div><img src="img/Figure_12.05_B17287.jpg" alt="Figure 12.5 – Menu items rendered by the Basic theme&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.5 – Menu items rendered by the Basic theme</p>
			<p>It is important to understand that the <code>ConfigureMenuAsync</code> method is called every time we render the menu. For a typical MVC/Razor Pages application, this method is called in every page <a id="_idIndexMarker784"/>request. In this way, you can dynamically shape the menu and conditionally add or remove items. You generally need to check permissions while adding the menu items, as shown in the following code block:</p>
			<pre>if (await context.IsGrantedAsync("MyPermissionName"))
{
    context.Menu.AddItem(...);
}</pre>
			<p><code>context.IsGrantedAsync</code> is a shortcut for checking the permissions for the current user with a permission name. If we want to resolve and use <code>IAuthorizationService</code> manually, we could rewrite the same code, as shown in the following code block:</p>
			<pre>var authorizationService = context
    .ServiceProvider.GetRequiredService&lt;IAuthorizationService&gt;();
if (await authorizationService.IsGrantedAsync(
    "MyPermissionName"))
{
    context.Menu.AddItem()
}</pre>
			<p>In this example, I used <code>context.ServiceProvider</code> to resolve <code>IauthorizationService</code>. Then, I used its <code>IsGrantedAsync</code> method, just like in the previous example. You can safely resolve services from <code>context.ServiceProvider</code> and let ABP Framework release these services at the end of the menu's build process.</p>
			<p>It is also possible to find<a id="_idIndexMarker785"/> existing menu items (added by the depending modules) in the <code>context.Menu.Items</code> collection to modify or remove them. </p>
			<p>In the next section, we will continue looking at Bootstrap tag helpers and learn how to render common Bootstrap components in a type-safe way.</p>
			<h1 id="_idParaDest-265"><a id="_idTextAnchor383"/>Working with Bootstrap tag helpers</h1>
			<p>Bootstrap is <a id="_idIndexMarker786"/>one of the most popular UI (HTML/CSS/JS) libraries in the world, and it is the fundamental UI framework that's used by all the ABP themes. As a benefit of using such a library as a standard library, we can build our UI pages and components based on Bootstrap and let the theme style them. In this way, our modules and even applications can be theme-independent and work with any ABP-compatible UI theme.</p>
			<p>Bootstrap is a well-documented and easy-to-use library. However, there are two problems while writing<a id="_idIndexMarker787"/> Bootstrap-based UI code:</p>
			<ul>
				<li>Some components require a lot of boilerplate code. Most parts of these codes are repetitive and tedious to write and maintain.</li>
				<li>Writing plain Bootstrap code in an MVC/Razor Pages web application is not very type-safe. We can make mistakes in class names and HTML structure that we can't catch at <a id="_idIndexMarker788"/>compile time.</li>
			</ul>
			<p>ASP.NET Core MVC/Razor Pages has a <em class="italic">tag </em><em class="italic">helper</em> system to define reusable components and use them as other HTML tags in our pages/views. ABP takes the power of tag helpers and provides a set of tag helper components for the Bootstrap library. In this way, we can build Bootstrap-based UI pages and components with less code and in a type-safe manner.</p>
			<p>It is still possible to write native Bootstrap HTML code with ABP Framework, and ABP's Bootstrap tag helpers don't cover Bootstrap 100%. However, we suggest using the Bootstrap tag helpers wherever possible. See the following example:</p>
			<pre>&lt;abp-button button-type="Primary" text="Click me!" /&gt;</pre>
			<p>Here, I used the <code>abp-button</code> tag helper<a id="_idIndexMarker789"/> to render a Bootstrap button. I used the <code>button-type</code> and <code>text</code> attributes with compile-time check support. This example code is rendered as follows at runtime:</p>
			<pre>&lt;button class="btn btn-primary" type="button"&gt;
    Click me!
&lt;/button&gt;</pre>
			<p>There are many Bootstrap tag helpers in ABP Framework, so I won't explain all of them here. Please refer to ABP's documentation to learn how to use them: <a href="https://docs.abp.io/en/abp/latest/UI/AspNetCore/Tag-Helpers/Index">https://docs.abp.io/en/abp/latest/UI/AspNetCore/Tag-Helpers/Index</a>.</p>
			<p>In the next two sections, we will use some of these Bootstrap tag helpers to build form items and open modals.</p>
			<h1 id="_idParaDest-266"><a id="_idTextAnchor384"/>Creating forms and implementing validation</h1>
			<p>ASP.NET Core<a id="_idIndexMarker790"/> provides a good infrastructure for preparing forms and submitting, validating, and processing them on the server side. However, it still requires writing some boilerplate and repeating code. ABP Framework simplifies working with forms by providing tag <a id="_idIndexMarker791"/>helpers and automating validation and localization wherever possible. Let's begin with how to render form elements using ABP's tag helpers.</p>
			<h2 id="_idParaDest-267"><a id="_idTextAnchor385"/>Rendering form elements</h2>
			<p>The <code>abp-input</code> tag helper <a id="_idIndexMarker792"/>is used to render an appropriate HTML input element for a given property. It is better to show its usage in a complete example.</p>
			<p>Let's assume that we need to build a form to create a new <em class="italic">movie</em> entity and have created a new Razor Page called <code>CreateMovie.cshtml</code>. First, let's look at the code-behind file:</p>
			<pre>public class CreateMovieModel : AbpPageModel
{
    [BindProperty]
    public MovieViewModel Movie { get; set; }
    
    public void OnGet()
    {
        Movie = new MovieViewModel();
    }
    public async Task OnPostAsync()
    {
        // TODO: process the form (using the Movie object)
    }
}</pre>
			<p>Page models are<a id="_idIndexMarker793"/> normally derived from the <code>PageModel</code> class. However, we are deriving from ABP's <code>AbpPageModel</code> base class since it provides some pre-injected services and helper methods. That's a simple page model class. Here, we are creating a new <code>MovieViewModel</code> instance in the <code>OnGet</code> method to bind it to the form elements. We also have an <code>OnPostAsync</code> method that we can use to process the posted form data. <code>[BindProperty]</code> tells ASP.NET Core to bind the post data to the <code>Movie</code> object.</p>
			<p>To explore this example, let's look at the <code>MovieViewModel</code> class:</p>
			<pre>public class MovieViewModel
{
    [Required]
    [StringLength(256)]
    public string Name { get; set; }
    [Required]
    [DataType(DataType.Date)]
    public DateTime ReleaseDate { get; set; }
    [Required]
    [TextArea]
    [StringLength(1000)]
    public string Description { get; set; }
    public Genre Genre { get; set; }
    public float? Price { get; set; }
    public bool PreOrder { get; set; }
}</pre>
			<p>This object is used to <a id="_idIndexMarker794"/>render the form elements and bind the post data when the user submits the form. Notice that some properties have data annotation validation attributes to validate the values of these properties automatically. Here, the <code>Genre</code> property is an <code>enum</code>, as shown here:</p>
			<pre>public enum Genre
{
    Classic, Action, Fiction, Fantasy, Animation
}</pre>
			<p>Now, we can switch to the view part and try to render a form to get the movie information from the user.</p>
			<p>First, I will you show how we can do this without ABP Framework to understand the benefits of using ABP Framework. First, we must open a <code>form</code> element, as shown in the following code block:</p>
			<pre>&lt;form method="post"&gt;
    &lt;-- TODO: FORM ELEMENTS --&gt;
    &lt;button class="btn btn-primary" type="submit"&gt;
        Submit
    &lt;/button&gt;
&lt;/form&gt;</pre>
			<p>In the <code>form</code> block, we <a id="_idIndexMarker795"/>write code for each <code>form</code> element, and then we add a <code>submit</code> button to post the form. Showing the full code of <code>form</code> would be too long for this book, so I will only show the code that is necessary for rendering the input element for the <code>Movie.Name</code> property:</p>
			<pre>&lt;div class="form-group"&gt;
    &lt;label asp-for="Movie.Name" class="control-label"&gt;
    &lt;/label&gt;
    &lt;input asp-for="Movie.Name" class="form-control"/&gt;
    &lt;span asp-validation-for="Movie.Name" 
        class="text-danger"&gt;&lt;/span&gt;
&lt;/div&gt;</pre>
			<p>The preceding code block should seem very familiar to you if you have ever created a form with ASP.NET Core Razor Pages/MVC and Bootstrap. It puts a <code>label</code>, the actual input element, and a validation message area by wrapping them with a <code>form-group</code>. The following screenshot shows the rendered form:</p>
			<div><div><img src="img/Figure_12.06_B17287.jpg" alt="Figure 12.6 – A simple form with a single text input&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.6 – A simple form with a single text input</p>
			<p>The form currently<a id="_idIndexMarker796"/> contains only a single piece of text input for the <code>Name</code> property. You could write similar code for each property of the <code>Movie</code> class, which would result in large and repetitive code. Let's see how we can render the same input using ABP Framework's <code>abp-input</code> tag helper:</p>
			<pre>&lt;abp-input asp-for="Movie.Name" /&gt;</pre>
			<p>That's pretty easy. Now, we can render all the form elements. The following is the finalized code:</p>
			<pre>&lt;form method="post"&gt;
    &lt;abp-input asp-for="Movie.Name" /&gt;
    &lt;abp-select asp-for="Movie.Genre" /&gt;
    &lt;abp-input asp-for="Movie.Description" /&gt;
    &lt;abp-input asp-for="Movie.Price" /&gt;
    &lt;abp-input asp-for="Movie.ReleaseDate" /&gt;
    &lt;abp-input asp-for="Movie.PreOrder" /&gt;
    &lt;abp-button type="submit" button-type="Primary"
        text="Submit"/&gt;
&lt;/form&gt;</pre>
			<p>The preceding code block is dramatically shorter compared to the standard Bootstrap form code. I used the <code>abp-select</code> tag helper for the <code>Genre</code> property. It understands that <code>Genre</code> is an <code>enum</code> and<a id="_idIndexMarker797"/> creates the dropdown element using the <code>enum</code> members. The following is the rendered form:</p>
			<div><div><img src="img/Figure_12.07_B17287.jpg" alt="Figure 12.7 – Full form for creating a new movie&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.7 – Full form for creating a new movie</p>
			<p>ABP automatically adds <strong class="bold">*</strong> near the label of required form fields. It reads the types and attributes of the class properties and determines the form fields.</p>
			<p>If all you want to do is render the input elements in order, you can replace the last code block with the following one:</p>
			<pre>&lt;abp-dynamic-form abp-model="Movie" submit-button="true" /&gt;</pre>
			<p>The <code>abp-dynamic-form</code> tag helper gets a model and creates the entire form automatically!</p>
			<p>The <code>abp-input</code>, <code>abp-select</code>, and <code>abp-radio</code> tag helpers are mapped to a class property and render the corresponding UI element. You can use them if you want to control the layout of the form and place custom HTML elements between the form controls. On the <a id="_idIndexMarker798"/>other hand, <code>abp-dynamic-form</code> makes creating the form super simple while you have less control over the form's layout. However you create the form, ABP automates the validation and localization process for you, as I will explain in the next few sections.</p>
			<h2 id="_idParaDest-268"><a id="_idTextAnchor386"/>Validating user inputs</h2>
			<p>If you try to submit the form<a id="_idIndexMarker799"/> without filling in the required fields, the form won't be submitted to the server, and an error message will be shown for each invalid form element. The following screenshot shows the error message when you leave the <code>Name</code> property empty and submit the form:</p>
			<div><div><img src="img/Figure_12.08_B17287.jpg" alt="Figure 12.8 – Invalid user input&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.8 – Invalid user input</p>
			<p>Client-side validation is automatically done based on the data annotation attributes in the <code>MovieViewModel.Name</code> property. So, you don't need to write any validation code for the standard checks. Users can't submit the form until all the fields are valid.</p>
			<p>Client-side validation is just for the user experience. It would be easy to bypass the client-side validation and submit an invalid form to the server (by manipulating or disabling the JavaScript code in the browser's developer tools). So, you should always validate the user input on the server side, which should be done in the <code>OnPostAsync</code> method of the page model class. The following code block shows the common pattern that's used while handling a form post:</p>
			<pre>public async Task OnPostAsync()
{
    if (ModelState.IsValid)
    {
        //TODO: Create a new movie
    }
    else
    {
        Alerts.Danger("Please correct the form fields!");
    }
}</pre>
			<p><code>ModelState.IsValid</code> returns <code>false</code> if any form field is invalid. This is a standard feature of ASP.NET Core. You should always process the input in such an <code>if</code> statement. Optionally, you can have <a id="_idIndexMarker800"/>logic in the <code>else</code> statement. In this example, I used ABP's <code>Alerts</code> feature to show a client-side alert message to the user. The following screenshot shows the result of submitting the invalid form:</p>
			<div><div><img src="img/Figure_12.09_B17287.jpg" alt="Figure 12.9 – Invalid form result from the server&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.9 – Invalid form result from the server</p>
			<p>If you look at the validation <a id="_idIndexMarker801"/>error message under the <code>IValidatableObject</code> interface for the <code>MovieViewModel</code> class, as shown in the following code block:</p>
			<pre>public class MovieViewModel : IValidatableObject
{
    // ... properties omitted
    public IEnumerable&lt;ValidationResult&gt; Validate(
        ValidationContext validationContext)
    {
        if (PreOrder &amp;&amp; Price &gt; 999)
        {
            yield return new ValidationResult(
                "Price should be lower than 999 for 
                 pre-order movies!",
                new[] { nameof(Price) }
            );
        }
    }
}</pre>
			<p>I'm performing complex custom validation logic in the <code>Validate</code> method. You can refer to the <em class="italic">Validating user inputs</em> section in <a href="B17287_07_Epub_AM.xhtml#_idTextAnchor213"><em class="italic">Chapter 7</em></a>, <em class="italic">Exploring Cross-Cutting Concerns</em>, to learn <a id="_idIndexMarker802"/>more about server-side validation. Here, we should understand that we can use custom logic on the server and show validation messages on the client side.</p>
			<p>In the next section, we will learn how to localize validation errors, as well as form labels.</p>
			<h2 id="_idParaDest-269"><a id="_idTextAnchor387"/>Localizing forms</h2>
			<p>ABP Framework <a id="_idIndexMarker803"/>automatically localizes the validation error messages based on the current language. Try to switch to another language and submit the form without providing a movie name. The following screenshot shows this for the Turkish language:</p>
			<div><div><img src="img/Figure_12.10_B17287.jpg" alt="Figure 12.10 – Auto-localized validation error messages&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.10 – Auto-localized validation error messages</p>
			<p>The error text has changed. However, you can still see <strong class="bold">Name</strong> as the field name because that's our custom field name, and we haven't localized it yet.</p>
			<p>ABP provides a<a id="_idIndexMarker804"/> convention-based localization system for the form fields. You just define a localization entry in your localization JSON file with the key formatted as <code>DisplayName:&lt;property-name&gt;</code>. I can add the following lines to the <code>en.json</code> file (in the <em class="italic">Domain.Shared</em> project) to localize all the fields of the movie creation form:</p>
			<pre>"DisplayName:Name": "Name",
"DisplayName:ReleaseDate": "Release date",
«DisplayName:Description»: «Description»,
«DisplayName:Genre»: «Genre»,
"DisplayName:Price": "Price",
"DisplayName:PreOrder": "Pre-order"</pre>
			<p>Then, I can localize these in the Turkish language with the following entries in the <code>tr.json</code> file:</p>
			<pre>"DisplayName:Name": "İsim",
"DisplayName:ReleaseDate": "Yayınlanma tarihi",
"DisplayName:Description": "Açıklama",
"DisplayName:Genre": "Tür",
"DisplayName:Price": "Ücret",
"DisplayName:PreOrder": "Ön sipariş"</pre>
			<p>Now, we have a localized label and a more localized validation error message:</p>
			<div><div><img src="img/Figure_12.11_B17287.jpg" alt="Figure 12.11 – Fully localized validation error message and the field label&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.11 – Fully localized validation error message and the field label</p>
			<p>Adding the <code>DisplayName:</code> prefix to the property name is a suggested convention for the <code>form</code> fields, but actually, it is not required. If ABP can't find the <code>DisplayName:Price</code> entry, it will search an entry with the <code>Price</code> key, without any prefix. If you want to specify the localization key for a property, you can add the <code>[DisplayName]</code> attribute on top of the property, as shown in the following example:</p>
			<pre>[DisplayName("MoviePrice")]
public float? Price { get; set; }</pre>
			<p>With this setup, ABP<a id="_idIndexMarker805"/> will try to localize the field name using the <code>"MoviePrice"</code> key.</p>
			<p>The <code>abp-select</code> tag localizes the items in the dropdown for <code>enum</code> types by conventions. You can add entries to your localization file, such as <code>&lt;enum-type&gt;.&lt;enum-member&gt;</code>. For the <code>Action</code> member of the <code>Genre</code> enum type, we can add a localization entry with the <code>Genre.Action</code> key. It falls back to the <code>Action</code> key if the <code>Genre.Action</code> key is not found.</p>
			<p>In the next section, we will discuss how to convert a standard form into a fully AJAX form.</p>
			<h2 id="_idParaDest-270"><a id="_idTextAnchor388"/>Implementing AJAX forms</h2>
			<p>When the user submits a <a id="_idIndexMarker806"/>standard form, a full-page post is performed and the server re-renders the entire page. An alternative approach could be posting the form as an AJAX request and handling the response in JavaScript code. This approach is much faster than the regular post request since the browser doesn't need to reload the whole page and all the resources of the page. It is also a better user experience in many cases since you can show some animations on the waiting time. Also, in this way, you don't lose the page's state and can perform smart actions in your JavaScript code.</p>
			<p>You can handle all the AJAX stuff manually, but ABP Framework provides built-in ways for such common patterns. You can add the <code>data-ajaxForm="true"</code> attribute to any <code>form</code> element (including the <code>abp-dynamic-form</code> element) to make it posted through an AJAX request.</p>
			<p>The following example adds the AJAX feature to <code>abp-dynamic-form</code>:</p>
			<pre>&lt;abp-dynamic-form abp-model="Movie"
                  submit-button="true" 
                  data-ajaxForm="true"
                  id="MovieForm" /&gt;</pre>
			<p>When we convert a form into an AJAX form, the post handler on the server side should be implemented properly. The following code block shows a common pattern to implement the post handler:</p>
			<pre>public async Task&lt;IActionResult&gt; OnPostAsync()
{
    ValidateModel();    
    //TODO: Create a new movie
    return NoContent();
}</pre>
			<p>The first line validates<a id="_idIndexMarker807"/> the user input and throws <code>AbpValidationException</code> if the input model is not valid. The <code>ValidateModel</code> method comes from the base <code>AbpPageModel</code> class. If you don't want to use it, you can check <code>if (ModelState.IsValid)</code> and take any action you need. If the form is valid, you normally save the new movie to a database. Finally, you can return the resulting data to the client. We don't need to return a response for this example, so a <code>NoContent</code> result is fine.</p>
			<p>When you convert a form into an AJAX form, you typically want to take action when the form is successfully submitted. The following example handle<a id="_idTextAnchor389"/>s the <code>abp-ajax-success</code> event of the form:</p>
			<pre>$(function (){
    $('#MovieForm').on('abp-ajax-success', function(){
        $('#MovieForm').slideUp();
        abp.message.success('Successfully saved, thanks
            :)');
    });
});</pre>
			<p>In this example, I registered a callback function for the <code>abp-ajax-success</code> event of the form. In this callback, you can do anything you need. For example, I used the <code>slideUp</code> JQuery function to hide the form, then used ABP's success UI message. We will return to the <code>abp.message</code> API in the <em class="italic">Using the JavaScript API</em> section of this chapter.</p>
			<p>Exception handling logic<a id="_idIndexMarker808"/> is different for AJAX requests. ABP handles all exceptions, returns a proper JSON response to the client, and then automatically handles the error on the client side. For example, suppose the form has a validation error that's been determined on the server side. In this case, the server returns a validation error message, and the client shows a message box, as shown in the following screenshot:</p>
			<div><div><img src="img/Figure_12.12_B17287.jpg" alt="Figure 12.12 – Server-side validation errors on the AJAX form submit&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.12 – Server-side validation errors on the AJAX form submit</p>
			<p>The message box is <a id="_idIndexMarker809"/>shown in any exception, including your custom exceptions and <code>UserFriendlyException</code>. Go to the <em class="italic">Exception handling</em> section of <a href="B17287_07_Epub_AM.xhtml#_idTextAnchor213"><em class="italic">Chapter 7</em></a>, <em class="italic">Exploring Cross-Cutting Concerns</em>, to learn more about the exception handling system.</p>
			<p>In addition to converting the form into an AJAX form and handling exceptions, ABP also prevents double-clicking on the <code>data-busy-text</code> attribute on the <strong class="bold">Submit</strong> button to use another piece of text.</p>
			<p>In the next section, we will learn how ABP Framework helps us while working with modal dialogs.</p>
			<h1 id="_idParaDest-271"><a id="_idTextAnchor390"/>Working with modals</h1>
			<p>A modal is<a id="_idIndexMarker810"/> one of the essential components when you want to create interactive user interfaces. It provides a convenient way to get a response from the user or show some information without changing the current page layout.</p>
			<p>Bootstrap has a modal component, but it requires some boilerplate code. ABP Framework provides the <code>abp-modal</code> tag helper to render a modal component, which simplifies the modal's usage in most use cases. Another problem with modals is placing the modal code inside the page that opens the modal, which makes the modal hard to reuse. ABP provides a modal API on the JavaScript side to dynamically load and control these modals. It also works well with forms inside modals. Let's begin with the simplest usage.</p>
			<h2 id="_idParaDest-272"><a id="_idTextAnchor391"/>Understanding the basics of modals</h2>
			<p>ABP suggests defining modals<a id="_idIndexMarker811"/> as separate Razor Pages (or views if you are using the MVC pattern). So, as the first step, we should create a new Razor Page. Let's assume that we've created a new Razor Page called <code>MySimpleModal.cshtml</code> under the <code>Pages</code> folder. The code-behind file is simple:</p>
			<pre>public class MySimpleModalModel : AbpPageModel
{
    public string Message { get; set; }
    
    public void OnGet()
    {
        Message = "Hello modals!";
    }
}</pre>
			<p>We just have a <code>Message</code> property being shown inside the modal dialog. Let's see the view side:</p>
			<pre>@page
@model MvcDemo.Web.Pages.MySimpleModalModel
@{
    Layout = null;
}
&lt;abp-modal&gt;
    &lt;abp-modal-header title="My header"&gt;&lt;/abp-modal-header&gt;
    &lt;abp-modal-body&gt;
        @Model.Message
    &lt;/abp-modal-body&gt;
    &lt;abp-modal-footer buttons="Close"&gt;&lt;/abp-modal-footer&gt;
&lt;/abp-modal&gt;</pre>
			<p>The <code>Layout = null</code> statement is critical here. Because this page is loaded with an AJAX request, the result should only contain the modal's content, not the standard layout. <code>abp-modal</code> is the main tag helper that renders the HTML of the modal dialog. <code>abp-modal-header</code>, <code>abp-modal-body</code>, and <code>abp-modal-footer</code> are the main parts of the modal and have different options. The modal body is very simple in this example; it just shows <code>Message</code> on the model.</p>
			<p>We've created the <a id="_idIndexMarker812"/>modal, but we should create a way to open it. ABP provides the <code>ModalManager</code> API on the JavaScript side to control a modal. Here, we need to create a <code>ModalManager</code> object on the page where we want to open the modal:</p>
			<pre>var simpleModal = new abp.ModalManager({
    viewUrl: '/MySimpleModal'
});</pre>
			<p><code>abp.ModalManager</code> has a few options, but the most basic is <code>viewUrl</code>, which indicates the URL where the modal content will be loaded. Once we have a <code>ModalManager</code> instance, we can call its <code>open</code> method to open the modal:</p>
			<pre>$(function (){
    $('#Button1').click(function (){
        simpleModal.open();
    });
});</pre>
			<p>This example assumes there is a button with an ID of <code>Button1</code> on the page. We are opening the modal when the user clicks the button. The following screenshot shows the opened modal:</p>
			<div><div><img src="img/Figure_12.13_B17287.jpg" alt="Figure 12.13 – A simple modal dialog box&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.13 – A simple modal dialog box</p>
			<p>Typically, we create <a id="_idIndexMarker813"/>dynamic content in a modal, so we need to pass some arguments while opening the modal dialog box. To do this, you can pass an object to the <code>open</code> method that contains the modal arguments, as shown in the following example:</p>
			<pre>simpleModal.open({
    productId: 42
});</pre>
			<p>Here, we passed a <code>productId</code> argument to the modal, so it may show details of the given product. You can add the same argument to the <code>OnGet</code> method of the <code>MySimpleModalModel</code> class to obtain the value and process inside the method:</p>
			<pre>public void OnGet(int productId)
{
    ...
}</pre>
			<p>You can get the<a id="_idIndexMarker814"/> product information from the database and render the product details in the modal body. </p>
			<p>In the next section, we will learn how to place a form inside a modal to get data from the user.</p>
			<h2 id="_idParaDest-273"><a id="_idTextAnchor392"/>Working with forms inside modals</h2>
			<p>Modals are <a id="_idIndexMarker815"/>widely used to show a form to users. ABP's ModalManager API gracefully handles some common tasks for you:</p>
			<ul>
				<li>It focuses on the first input of the form.</li>
				<li>It triggers a validation check when you press the <em class="italic">Enter</em> key or click the <strong class="bold">Save</strong> button. It doesn't allow you to submit the form unless the form is fully valid.</li>
				<li>It submits the form via an AJAX request, disables the modal buttons, and shows a progressing icon until the save operation is complete.</li>
				<li>If you've entered some data and click the <strong class="bold">Cancel</strong> button or close the modal, it warns you about unsaved changes.</li>
			</ul>
			<p>Let's assume that we want to show a modal dialog to create a new movie and we've created a new Razor Page called <code>ModalWithForm.cshtml</code>. The code-behind file is similar to what we had in the <em class="italic">Implementing AJAX forms</em> section:</p>
			<pre>public class ModalWithForm : AbpPageModel
{
    [BindProperty]
    public MovieViewModel Movie { get; set; }
    
    public void OnGet()
    {
        Movie = new MovieViewModel();
    }
    public async Task&lt;IActionResult&gt; OnPostAsync()
    {
        ValidateModel();
        //TODO: Create a new movie
        return NoContent();
    }
}</pre>
			<p>The <code>OnPostAsync</code> method validates the user input first. If the form is not valid, an exception is thrown and handled by ABP Framework on the server side and the client side. You can return a response to the client, but we are returning a <code>NoContent</code> response in this example.</p>
			<p>The view side of the<a id="_idIndexMarker816"/> modal is a bit different since we mix a form with a modal:</p>
			<pre>@page
@using Volo.Abp.AspNetCore.Mvc.UI.Bootstrap.TagHelpers.Modal
@model MvcDemo.Web.Pages.ModalWithForm
@{
    Layout = null;
}
&lt;form method="post" asp-page="/ModalWithForm"&gt;
    &lt;abp-modal&gt;
        &lt;abp-modal-header title="Create new movie"&gt;
        &lt;/abp-modal-header&gt;
        &lt;abp-modal-body&gt;
            &lt;abp-input asp-for="Movie.Name" /&gt;
            &lt;abp-select asp-for="Movie.Genre" /&gt;
            &lt;abp-input asp-for="Movie.Description" /&gt;
            &lt;abp-input asp-for="Movie.Price" /&gt;
            &lt;abp-input asp-for="Movie.ReleaseDate" /&gt;
            &lt;abp-input asp-for="Movie.PreOrder" /&gt;
        &lt;/abp-modal-body&gt;
        &lt;abp-modal-footer buttons="@(
            AbpModalButtons.Cancel|AbpModalButtons.Save)"&gt;
        &lt;/abp-modal-footer&gt;
    &lt;/abp-modal&gt;
&lt;/form&gt;</pre>
			<p>The <code>abp-modal</code> tag <a id="_idIndexMarker817"/>is wrapped by a <code>form</code> element. We don't put the <code>form</code> tag inside the <code>abp-modal-body</code> element because the <code>form</code>. So, as a solution, we are placing <code>form</code> as the topmost element in this view. The rest of the code block should be familiar; we use ABP input tag helpers to render the form elements.</p>
			<p>Now, we can open the modal in our JavaScript code:</p>
			<pre>var newMovieModal = new abp.ModalManager({
    viewUrl: '/ModalWithForm'
});
$(function (){
    $('#Button2').click(function (){
        newMovieModal.open();
    });
});</pre>
			<p>The opened dialog <a id="_idIndexMarker818"/>is shown in the following screenshot:</p>
			<div><div><img src="img/Figure_12.14_B17287.jpg" alt="Figure 12.14 – A form inside a modal&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.14 – A form inside a modal</p>
			<p>It is also possible to use the <code>abp-dynamic-form</code> tag helper within a modal. We could rewrite the modal's view like so:</p>
			<pre>&lt;abp-dynamic-form abp-model="Movie" 
    asp-page="ModalWithForm"&gt;
    &lt;abp-modal&gt;
        &lt;abp-modal-header title="Create new movie!"&gt;
        &lt;/abp-modal-header&gt;
        &lt;abp-modal-body&gt;
            &lt;abp-form-content/&gt;
        &lt;/abp-modal-body&gt;
        &lt;abp-modal-footer buttons="@(
            AbpModalButtons.Cancel|AbpModalButtons.Save)"&gt;
        &lt;/abp-modal-footer&gt;
    &lt;/abp-modal&gt;
&lt;/abp-dynamic-form&gt;</pre>
			<p>Here, I <a id="_idIndexMarker819"/>wrapped <code>abp-modal</code> with an <code>abp-dynamic-form</code> element, just like in the previous section. The main point of this example is that I used the <code>&lt;abp-form-content/&gt;</code> tag helper in the <code>abp-modal-body</code> element. <code>abp-form-content</code> is an optional tag helper that is used to place the form inputs of the <code>abp-dynamic-form</code> tag helper in the desired place.</p>
			<p>You typically want to take action once the modal form has been saved. For this, you can register a callback function to the <code>onResult</code> event of <code>ModalManager</code>, as shown in the following code block:</p>
			<pre>newMovieModal.onResult(function (e, data){
    console.log(data.responseText);
});</pre>
			<p><code>data.responseText</code> will be the data if the server sends any result. For example, you can return a <code>Content</code> response from the <code>OnPostAsync</code> method, as shown in the following example:</p>
			<pre>public async Task&lt;IActionResult&gt; OnPostAsync()
{
    ...
    return Content("42");
}</pre>
			<p>ABP simplifies <a id="_idIndexMarker820"/>all these common tasks. Otherwise, you would write a lot of boilerplate code. </p>
			<p>In the next section, we will learn how to add client-side logic to our modal dialogs.</p>
			<h2 id="_idParaDest-274"><a id="_idTextAnchor393"/>Adding JavaScript for modals</h2>
			<p>If your modal<a id="_idIndexMarker821"/> needs some advanced client-side logic, you may <a id="_idIndexMarker822"/>want to write some custom JavaScript code for your modal. You can write your JavaScript code on the page where you open the modal, but that is not very modular and reusable. It is good to write your modal's JavaScript code in a separate file, ideally near the <code>.cshtml</code> file of the modal (remember that ABP allows you to place JavaScript files under the <code>Pages</code> folder).</p>
			<p>For this, we can create a new JavaScript file and define a function in the <code>abp.modals</code> namespace, as shown in the following code:</p>
			<pre>abp.modals.MovieCreation = function () {
     this.initModal = function(modalManager, args) {
        var $modal = modalManager.getModal();
        var preOrderCheckbox =
            $modal.find('input[name="Movie.PreOrder"]');
        preOrderCheckbox.change(function(){
            if (this.checked){
               alert('checked pre-order!'); 
            }
        });
        console.log('initialized the modal...');
    }
};</pre>
			<p>Once we have created such a JavaScript class, we can associate it with the modal while creating the <code>ModalManager</code> instance:</p>
			<pre>var newMovieModal = new abp.ModalManager({
    viewUrl: '/ModalWithForm',
    modalClass: 'MovieCreation'
});</pre>
			<p><code>ModalManager</code> creates<a id="_idIndexMarker823"/> a new instance of the <code>abp.modals.MovieCreation</code> class for every time you open the modal and calls the <code>initModal</code> function if you define it. The <code>initModal</code> function takes two parameters. The first one<a id="_idIndexMarker824"/> is the <code>ModalManager</code> instance that's associated with the modal so that you can use its functions. The second parameter is the arguments that you passed to the <code>open</code> function while opening the modal.</p>
			<p>The <code>initModal</code> function is a perfect place to prepare the modal's content and register some callbacks to the events of the modal components. In the preceding example, I got the modal instance and a JQuery object, found the <code>Movie.PreOrder</code> checkbox, and registered its <code>change</code> callback so that I'm informed when the user checks it.</p>
			<p>This example still doesn't work yet since we haven't added the JavaScript file to the page. There are two ways to add it to the page:</p>
			<ul>
				<li>We can use the <code>abp-script</code> tag to include the modal's JavaScript file in the page where we open the modal.</li>
				<li>We can set up <code>ModalManager</code> so that it lazy loads the JavaScript file.</li>
			</ul>
			<p>The first option is straightforward – just include the following line in the page where you want to use the modal:</p>
			<pre>&lt;abp-script src="img/ModalWithForm.cshtml.js" /&gt;</pre>
			<p>If we want to lazy load the modal's script, we can configure <code>ModalManager</code> like so:</p>
			<pre>var newMovieModal = new abp.ModalManager({
    viewUrl: '/ModalWithForm',
    scriptUrl: '/Pages/ModalWithForm.cshtml.js',
    modalClass: 'MovieCreation'
});</pre>
			<p>Here, I added the <code>scriptUrl</code> option as the URL of the modal's JavaScript file. <code>ModalManager</code> lazy loads the JavaScript file the first time you open the modal. The script is not loaded<a id="_idIndexMarker825"/> again if you <a id="_idIndexMarker826"/>open the modal a second time (without refreshing the whole page).</p>
			<p>In this section, we learned how to work with forms, validation, and modals. They are essential parts of a typical web application. In the next section, we will learn about some useful JavaScript APIs that we need in every application.</p>
			<h1 id="_idParaDest-275"><a id="_idTextAnchor394"/>Using the JavaScript API</h1>
			<p>In this section, we will explore some useful client-side APIs of ABP Framework. Some of these APIs provide simple ways to use server-side defined features such as authentication and <a id="_idIndexMarker827"/>localization, while others provide solutions for common UI patterns, such as message boxes and notifications.</p>
			<p>All the client-side JavaScript APIs are global objects and functions that are declared under the <code>abp</code> namespace. Let's begin with accessing the current user's information in your JavaScript code.</p>
			<h2 id="_idParaDest-276"><a id="_idTextAnchor395"/>Accessing the current user</h2>
			<p>We are using the <code>ICurrentUser</code> service on the server side to get information about the currently<a id="_idIndexMarker828"/> logged-in user. In the JavaScript code, we can use the global <code>abp.currentUser</code> object, as shown here:</p>
			<pre>var userId = abp.currentUser.id;
var userName = abp.currentUser. userName;</pre>
			<p>By doing this, we can get the user's ID and username. The following JSON object is an example of the <code>abp.currentUser</code> object:</p>
			<pre>{
  isAuthenticated: true,
  id: "813108d7-7108-4ab2-b828-f3c28bbcd8e0",
  tenantId: null,
  userName: "john",
  name: "John",
  surName: "Nash",
  email: "john.nash@abp.io",
  emailVerified: true,
  phoneNumber: "+901112223342",
  phoneNumberVerified: true,
  roles: ["moderator","manager"]
}</pre>
			<p>If the <a id="_idIndexMarker829"/>current user has not logged in yet, all these values will be <code>null</code> or <code>false</code>, as you would expect. The <code>abp.currentUser</code> object provides an easy way to get information about the current user. In the next section, we will learn how to check the permissions of the current user.</p>
			<h2 id="_idParaDest-277"><a id="_idTextAnchor396"/>Checking user permissions</h2>
			<p>ABP's authorization <a id="_idIndexMarker830"/>and permission management system is a powerful way to define permissions and check them at runtime for the current user. Checking these permissions in your JavaScript code is effortless using the <code>abp.auth</code> API.</p>
			<p>The following example checks if the current user has the <code>DeleteProduct</code> permission:</p>
			<pre>if (abp.auth.isGranted('DeleteProduct')) {
  // TODO: Delete the product
} else {
  abp.message.warn("You don't have permission to delete
                    products!");
}</pre>
			<p><code>abp.auth.isGranted</code> returns <code>true</code> if the current user has given permission or a policy. If the user doesn't have permission, we show a warning message using the ABP message API, which will be explained in the <em class="italic">Showing message boxes</em> section later in this chapter.</p>
			<p>While these APIs are<a id="_idIndexMarker831"/> rarely needed, you can use the <code>abp.auth.policies</code> object when you need to get a list of all the available permissions/policies and the <code>abp.auth.grantedPolicies</code> object if you need to get a list of all the granted permissions/policies for the current user.</p>
			<p class="callout-heading">Hiding UI Parts Based on Permissions</p>
			<p class="callout">A typical use case for client-side permission checking is to hide some UI parts (such as action buttons) based on the user's permissions. While the <code>abp.auth</code> API provides a dynamic way to do that, I suggest using the standard <code>IAuthorizationService</code> on your Razor Pages/views to conditionally render the UI elements wherever possible.</p>
			<p>Note that checking permissions on the client side is just for the user experience and that it doesn't guarantee security. You should always check the same permission on the server side. </p>
			<p>In the next section, we will learn how to check the feature rights of the current tenant in a multi-tenant application.</p>
			<h2 id="_idParaDest-278"><a id="_idTextAnchor397"/>Checking the tenant features</h2>
			<p>The feature system is <a id="_idIndexMarker832"/>used to restrict application functionalities/features based on the current tenant. We will explore ABP's multi-tenancy infrastructure in <a href="B17287_16_Epub_AM.xhtml#_idTextAnchor457"><em class="italic">Chapter 16</em></a>, <em class="italic">Implementing Multi-Tenancy</em>. However, we will cover checking tenant features here for the ASP.NET Core MVC/Razor Pages UI.</p>
			<p>The <code>abp.features</code> API is used to check feature values for the current tenant. Let's assume that we have a feature for importing email lists from Mailchimp (a cloud email marketing platform) and that we've defined a feature named <code>MailchimpImport</code>. We can easily check if the current tenant has that feature enabled:</p>
			<pre>if (abp.features.isEnabled('MailchimpImport'))
{
  // TODO: Import from Mailchimp
}</pre>
			<p><code>abp.features.isEnabled</code> only returns <code>true</code> if the given feature's value is <code>true</code>. ABP's feature system allows you to define non-boolean features too. In this case, you can use the <code>abp.features.get(…)</code> function to obtain the given feature's value for the current tenant.</p>
			<p>Checking features <a id="_idIndexMarker833"/>on the client side makes it easy to perform dynamic client-side logic, but remember to check the features on the server side as well for a secure application. </p>
			<p>In the next section, we will continue using the localization system in your JavaScript code.</p>
			<h2 id="_idParaDest-279"><a id="_idTextAnchor398"/>Localizing strings</h2>
			<p>One powerful part of ABP's <a id="_idIndexMarker834"/>localization system is that you can reuse the same localization strings on the client side. In this way, you don't have to deal with another kind of localization library in your JavaScript code.</p>
			<p>The <code>abp.localization</code> API is available in your JavaScript code to help you utilize the localization system. Let's begin with the simplest case:</p>
			<pre>var str = abp.localization.localize('HelloWorld');</pre>
			<p>The <code>localize</code> function, with that usage, takes a localization key and returns the localized value based on the current language. It uses the default localization resource. If you need to, you can specify the localization resource as the second parameter:</p>
			<pre>var str = abp.localization.localize('HelloWorld', 'MyResource');</pre>
			<p>Here, we've specified <code>MyResource</code> as the localization resource. If you want to localize lots of strings from the same resource, there is a shorter way to do this:</p>
			<pre>var localizer = abp.localization.getResource('MyResource');
var str = localizer('HelloWorld');</pre>
			<p>Here, you can use the <code>localizer</code> object to get texts from the same resource.</p>
			<p>The JavaScript localization API applies the same fallback logic to the server-side API; it returns the given key if it can't find the localized value.</p>
			<p>If the localized string contains placeholders, you can pass the placeholder values as parameters. Let's assume that we have the following entry in the localization JSON file:</p>
			<pre>"GreetingMessage": "Hello {0}!"</pre>
			<p>We can pass a parameter to the <code>localizer</code> or <code>abp.localization.localize</code> function, as shown in the following example:</p>
			<pre>var str = abp.localization.localize('GreetingMessage', 'John');</pre>
			<p>The resulting <code>str</code> value will be <code>Hello John!</code> for this example. If you have more than one placeholder, you can pass the values to the <code>localizer</code> function in the same order.</p>
			<p>Besides the <a id="_idIndexMarker835"/>localizing texts, you may need to know the current culture and language so that you can take extra actions. The <code>abp.localization.currentCulture</code> object contains detailed information about the current language and culture. In addition to the current language, the <code>abp.localization.languages</code> value is an array of all the available languages in the current application. Most of the time, you don't directly use these APIs since the theme you're using is responsible for showing a list of languages to the user and allows you to switch between them. However, it is good to know that you can access the language data when you need it.</p>
			<p>So far, you've learned how to use some ABP server-side features on the client side. In the next section, you will learn how to show message and confirmation boxes to the user.</p>
			<h2 id="_idParaDest-280"><a id="_idTextAnchor399"/>Showing message boxes</h2>
			<p>It is very common to <a id="_idIndexMarker836"/>show blocking message boxes to users to inform them about something important happening in the application. In this section, you will learn how to show nice message boxes and confirmation dialogs in your applications.</p>
			<p>The <code>abp.message</code> API is used to show a message box to inform the user easily. There are four types of message boxes:</p>
			<ul>
				<li><code>abp.message.info</code>: Displays an informative message</li>
				<li><code>abp.message.success</code>: Displays a success message</li>
				<li><code>abp.message.warn</code>: Displays a warning message</li>
				<li><code>abp.message.error</code>: Displays an error message</li>
			</ul>
			<p>Let's take a look at the following example:</p>
			<pre>abp.message.success('Your changes have been successfully
                     saved!', 'Congratulations');</pre>
			<p>In this example, I've used the <code>success</code> function to display a success message. The first parameter is a message text, while the optional second parameter is a message header. The result of this example is shown in the following screenshot:</p>
			<div><div><img src="img/Figure_12.15_B17287.jpg" alt="Figure 12.15 – A success message box&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.15 – A success message box</p>
			<p>Message boxes are blocked, which means the page is blocked (non-clickable) until the user clicks the <strong class="bold">OK</strong> button.</p>
			<p>Another kind of message <a id="_idIndexMarker837"/>box is used for confirmation purposes. The <code>abp.message.confirm</code> function shows some dialog to get a response from the user:</p>
			<pre>abp.message.confirm('Are you sure to delete this product?')
.then(function(confirmed){
  if(confirmed){
    // TODO: Delete the product!
  }
});</pre>
			<p>The <code>confirm</code> function returns a promise, so we could chain it with the <code>then</code> callback to execute some code once the user closes the dialog by accepting or canceling it. The following screenshot shows the confirmation dialog that was created for this example:</p>
			<div><div><img src="img/Figure_12.16_B17287.jpg" alt="Figure 12.16 – A confirmation dialog&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.16 – A confirmation dialog</p>
			<p>Message boxes<a id="_idIndexMarker838"/> are a good way to grab a user's attention. However, there is an alternative way to do this, as we'll see in the next section.</p>
			<h2 id="_idParaDest-281"><a id="_idTextAnchor400"/>Showing notifications</h2>
			<p>Notifications <a id="_idIndexMarker839"/>are a non-blocking way to inform users of certain events. They are shown on the bottom right corner of the screen and automatically disappear after a few seconds. Just like the message boxes, there are four types of notifications:</p>
			<ul>
				<li><code>abp.notify.info</code>: Displays an informative notification</li>
				<li><code>abp.notify.success</code>: Displays a success notification</li>
				<li><code>abp.notify.warn</code>: Displays a warning notification</li>
				<li><code>abp.notify.error</code>: Displays an error notification</li>
			</ul>
			<p>The following example shows an information notification:</p>
			<pre>abp.notify.info(
    'The product has been successfully deleted.',
    'Deleted the Product'
);</pre>
			<p>The second parameter is the notification title and is optional. The result of this example code is shown in the following screenshot:</p>
			<div><div><img src="img/Figure_12.17_B17287.jpg" alt="Figure 12.17 – A notification message&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.17 – A notification message</p>
			<p>With the<a id="_idIndexMarker840"/> notification API, we are closing the JavaScript APIs. </p>
			<p>Here, I covered the most used APIs. However, there are more APIs you can use in your JavaScript code, all of which you can learn about by reading the ABP Framework documentation: <a href="https://docs.abp.io/en/abp/latest/UI/AspNetCore/JavaScript-API/Index">https://docs.abp.io/en/abp/latest/UI/AspNetCore/JavaScript-API/Index</a>. In the next section, we will learn how to consume server-side APIs from JavaScript code.</p>
			<h1 id="_idParaDest-282"><a id="_idTextAnchor401"/>Consuming HTTP APIs</h1>
			<p>You can use any tool or <a id="_idIndexMarker841"/>technique to consume HTTP APIs from your JavaScript code. However, ABP provides the following ways as fully integrated solutions:</p>
			<ul>
				<li>You can use the <code>abp.ajax</code> API as an extension of the <code>jQuery.ajax</code> API.</li>
				<li>You can use dynamic JavaScript client proxies to call server-side APIs, just like you can with JavaScript functions.</li>
				<li>You can generate static JavaScript client proxies at development time.</li>
			</ul>
			<p>Let's begin with the first one – the <code>abp.ajax</code> API.</p>
			<h2 id="_idParaDest-283"><a id="_idTextAnchor402"/>Using the abp.ajax API</h2>
			<p>The <code>abp.ajax</code> API is a<a id="_idIndexMarker842"/> wrapper around the standard <code>jQuery.ajax</code> API. It <a id="_idIndexMarker843"/>automatically handles all errors and shows a localized message to the user on an error case. It also adds the anti-forgery token to the HTTP header to satisfy <strong class="bold">Cross-Site Request Forgery</strong> (<strong class="bold">CSRF</strong>) protection on the server side.</p>
			<p>The following example uses the <code>abp.ajax</code> API to get a list of users from the server:</p>
			<pre>abp.ajax({
  type: 'GET',
  url: '/api/identity/users'
}).then(function(result){
  // TODO: process the result
});</pre>
			<p>In this example, we've specified <code>GET</code> as the request's <code>type</code>. You can specify all the standard options of <code>jQuery.ajax</code> (or <code>$.ajax</code>) to override the defaults. <code>abp.ajax</code> returns a promise object, so we could add the <code>then</code> callback to handle the result that's sent by the server. We can also use the <code>catch</code> callback to handle errors and the <code>always</code> callback to perform an action at the end of <a id="_idTextAnchor403"/>the request.</p>
			<p>The following example shows how to handle errors manually:</p>
			<pre>abp.ajax({
  type: 'GET',
  url: '/api/identity/users',
  abpHandleError: false
}).then(function(result){
  // TODO: process the result
}).catch(function(){
  abp.message.error("request failed :(");
});</pre>
			<p>Here, I added a <code>catch</code> callback function after the <code>then</code> function. You can perform your error logic here. I also specified the <code>abpHandleError: false</code> option to disable ABP's automatic error handling logic. Otherwise, ABP <a id="_idIndexMarker844"/>will handle the error and show an error message to<a id="_idIndexMarker845"/> the user.</p>
			<p><code>abp.ajax</code> is a low-level API. You typically use dynamic or static client proxies to consume your own HTTP APIs.</p>
			<h2 id="_idParaDest-284"><a id="_idTextAnchor404"/>Using dynamic client proxies</h2>
			<p>You should have<a id="_idIndexMarker846"/> already used the dynamic JavaScript client proxy <a id="_idIndexMarker847"/>system if you applied the example application from <a href="B17287_03_Epub_AM.xhtml#_idTextAnchor044"><em class="italic">Chapter 3</em></a>, <em class="italic">Step-By-Step Application Development</em>. ABP Framework generates JavaScript functions at runtime to easily consume all the HTTP APIs of your application.</p>
			<p>The following code block shows two sample methods of <code>IProductAppService</code> that were defined in <a href="B17287_03_Epub_AM.xhtml#_idTextAnchor044"><em class="italic">Chapter 3</em></a>, <em class="italic">Step-By-Step Application Development</em>:</p>
			<pre>namespace ProductManagement.Products
{
    public interface IProductAppService :
        IApplicationService
    {
        Task CreateAsync(CreateUpdateProductDto input);
        Task&lt;ProductDto&gt; GetAsync(Guid id);
    }
}</pre>
			<p>All of these methods are available in the same namespace on the client side. For example, we can get a product by its ID, as shown in the following code block:</p>
			<pre>productManagement.products.product
  .get('1b8517c8-2c08-5016-bca8-39fef5c4f817')
  .then(function (result) {
    console.log(result);
  });</pre>
			<p><code>productManagement.products</code> is the camel case equivalent of the <code>ProductManagement.Products</code> namespace of the C# code. <code>product</code> is the conventional name of <code>IProductAppService</code>. The <code>I</code> prefix and the <code>AppService</code> suffix have been removed, and the remaining name is converted into camel case. Then, we can use the method name that's been converted in camel case without the <code>Async</code> suffix. So, the <code>GetAsync</code> method is used as the <code>get</code> function in the JavaScript code. The <code>get</code> function takes the<a id="_idIndexMarker848"/> same parameters that the C# method takes. It returns a <code>Deferred</code> object so that we can chain it with the <code>then</code>, <code>catch</code>, or <code>always</code> callbacks, similar to what can do for the <code>abp.ajax</code> API. It internally uses the <code>abp.ajax</code> API. In this example, the <code>result</code> argument of the <code>then</code> function is the <code>ProductDto</code> object that's sent by the <a id="_idIndexMarker849"/>server.</p>
			<p>Other methods are used in a similar way. For example, we can create a new product with the following code:</p>
			<pre>productManagement.products.product.create({
  categoryId: '5f568193-91b2-17de-21f3-39fef5c4f808',
  name: 'My product',
  price: 42,
  isFreeCargo: true,
  releaseDate: '2023-05-24',
  stockState: 'PreOrder'
});</pre>
			<p>Here, we pass the <code>CreateUpdateProductDto</code> object with the JSON object format.</p>
			<p>In some cases, we may need to pass additional AJAX options for the HTTP API calls. You can pass an object as the last parameter to every proxy function:</p>
			<pre>productManagement.products.product.create({
  categoryId: '5f568193-91b2-17de-21f3-39fef5c4f808',
  name: 'My product',
  //...other values
}, {
  url: 'https://localhost:21322/api/my-custom-url'
  headers: {
    'MyHeader': 'MyValue'
  }
});</pre>
			<p>Here, I passed an object to change the URL and add a custom header to the request. You can refer to jQuery's documentation (<a href="https://api.jquery.com/jquery.ajax/">https://api.jquery.com/jquery.ajax/</a>) for all the available options.</p>
			<p>Dynamic <a id="_idIndexMarker850"/>JavaScript client proxy functions are generated at runtime <a id="_idIndexMarker851"/>by the <code>/Abp/ServiceProxyScript</code> endpoint of your application. This URL is added to the layout by the themes so that you can directly use any proxy function in your pages without importing any script.</p>
			<p>In the next section, you will learn about an alternative way to consume your HTTP APIs.</p>
			<h2 id="_idParaDest-285"><a id="_idTextAnchor405"/>Using static client proxies</h2>
			<p>Unlike dynamic client<a id="_idIndexMarker852"/> proxies, which are generated at runtime, static proxies <a id="_idIndexMarker853"/>are generated at development time. We can use the ABP CLI to generate the proxy script file.</p>
			<p>First, we need to run the application that serves the HTTP APIs because the API endpoint data is requested from the server. Then, we can use the <code>generate-proxy</code> command, as shown in the following example:</p>
			<pre>abp generate-proxy -t js -u https://localhost:44349</pre>
			<p>The <code>generate-proxy</code> command can take the following parameters:</p>
			<ul>
				<li><code>-t</code> (required): The type of the proxy. We use <code>js</code> for JavaScript here.</li>
				<li><code>-u</code> (required): The root URL of the API endpoint.</li>
				<li><code>-m</code> (optional): The module name to generate the proxy for. The default value is <code>app</code> and is used to generate proxies for your application. In a modular application, you can specify the module name here.</li>
			</ul>
			<p>Static JavaScript proxies are generated under the <code>wwwroot/client-proxies</code> folder, as shown in the following screenshot:</p>
			<div><div><img src="img/Figure_12.18_B17287.jpg" alt="Figure 12.18 – The static JavaScript proxy file&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.18 – The static JavaScript proxy file</p>
			<p>Then, you<a id="_idIndexMarker854"/> can import the proxy script file into any page and use the static<a id="_idIndexMarker855"/> proxy functions like you would the dynamic ones.</p>
			<p>When you use static proxies, you don't need dynamic proxies. By default, ABP creates dynamic proxies for your application. You can configure <code>DynamicJavaScriptProxyOptions</code> to disable it for the application, as shown in the following example:</p>
			<pre>Configure&lt;DynamicJavaScriptProxyOptions&gt;(options =&gt; {
    options.EnabledModules.Remove("app");
});</pre>
			<p>The <code>EnabledModules</code> list contains <code>app</code> by default. If you are building a modular application and want to enable dynamic JavaScript proxies for your module, you need to add it to the <code>EnabledModules</code> list explicitly.</p>
			<h1 id="_idParaDest-286"><a id="_idTextAnchor406"/>Summary</h1>
			<p>In this chapter, we covered the fundamental design points and the essential features of the MVC/Razor Pages UI of ABP Framework.</p>
			<p>The theming system allows you to build theme/style independent modules and applications and easily switch between UI themes. It makes this possible by defining a set of base libraries and standard layouts.</p>
			<p>You then learned about the bundling and minification system, which covers the entire development cycle of importing and using client-side dependencies in your applications and optimizing resource usage in a production environment.</p>
			<p>ABP makes it easy to create forms and implement validation and localization using tag helpers and predefined conventions. You also learned how to convert a standard form into an AJAX-submitted form.</p>
			<p>We've also covered some JavaScript APIs that can utilize ABP features on the client side, such as authorization and localization, and easily show nice-looking message boxes and notifications.</p>
			<p>Finally, you learned about alternative ways to consume HTTP APIs from your JavaScript code.</p>
			<p>In the next chapter, you will learn about the Blazor UI for ABP Framework to build interactive web UIs using C# instead of JavaScript.</p>
		</div>
	</body></html>