<html><head></head><body>
<div id="_idContainer171">
<h1 class="chapter-number" id="_idParaDest-276"><a id="_idTextAnchor275"/><span class="koboSpan" id="kobo.1.1">13</span></h1>
<h1 id="_idParaDest-277"><a id="_idTextAnchor276"/><span class="koboSpan" id="kobo.2.1">Creating a Roslyn Analyzer</span></h1>
<p><span class="koboSpan" id="kobo.3.1">In the previous chapter, we covered the use of code analyzers to detect issues in code. </span><span class="koboSpan" id="kobo.3.2">But what happens when your team has common issues that aren’t detected by any existing </span><span class="No-Break"><span class="koboSpan" id="kobo.4.1">analysis rules?</span></span></p>
<p><span class="koboSpan" id="kobo.5.1">It turns out that modern C# provides a means for building custom analyzers through something called </span><strong class="bold"><span class="koboSpan" id="kobo.6.1">Roslyn Analyzers</span></strong><span class="koboSpan" id="kobo.7.1">. </span><span class="koboSpan" id="kobo.7.2">In this chapter, we’ll see how Roslyn Analyzers work in action by building an analyzer of </span><span class="No-Break"><span class="koboSpan" id="kobo.8.1">our own.</span></span></p>
<p><span class="koboSpan" id="kobo.9.1">This chapter covers the </span><span class="No-Break"><span class="koboSpan" id="kobo.10.1">following topics:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.11.1">Understanding </span><span class="No-Break"><span class="koboSpan" id="kobo.12.1">Roslyn Analyzers</span></span></li>
<li><span class="koboSpan" id="kobo.13.1">Creating a </span><span class="No-Break"><span class="koboSpan" id="kobo.14.1">Roslyn Analyzer</span></span></li>
<li><span class="koboSpan" id="kobo.15.1">Testing Roslyn Analyzers </span><span class="No-Break"><span class="koboSpan" id="kobo.16.1">with </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.17.1">RoslynTestKit</span></strong></span></li>
<li><span class="koboSpan" id="kobo.18.1">Sharing analyzers as Visual </span><span class="No-Break"><span class="koboSpan" id="kobo.19.1">Studio extensions</span></span></li>
</ul>
<h1 id="_idParaDest-278"><a id="_idTextAnchor277"/><span class="koboSpan" id="kobo.20.1">Technical requirements</span></h1>
<p><span class="koboSpan" id="kobo.21.1">Unlike other chapters, we won’t be starting with sample code. </span><span class="koboSpan" id="kobo.21.2">Instead, we’ll be starting with a blank solution and gradually adding new projects to </span><span class="No-Break"><span class="koboSpan" id="kobo.22.1">that solution.</span></span></p>
<p><span class="koboSpan" id="kobo.23.1">The starting empty solution and final code for this chapter are available from GitHub at </span><a href="https://github.com/PacktPublishing/Refactoring-with-CSharp"><span class="koboSpan" id="kobo.24.1">https://github.com/PacktPublishing/Refactoring-with-CSharp</span></a><span class="koboSpan" id="kobo.25.1"> in the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.26.1">Chapter13</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.27.1"> folder.</span></span></p>
<h1 id="_idParaDest-279"><a id="_idTextAnchor278"/><span class="koboSpan" id="kobo.28.1">Understanding Roslyn Analyzers</span></h1>
<p><span class="koboSpan" id="kobo.29.1">Before we can go into</span><a id="_idIndexMarker781"/><span class="koboSpan" id="kobo.30.1"> what a Roslyn Analyzer is, let’s talk </span><span class="No-Break"><span class="koboSpan" id="kobo.31.1">about Roslyn.</span></span></p>
<p><strong class="bold"><span class="koboSpan" id="kobo.32.1">Roslyn</span></strong><span class="koboSpan" id="kobo.33.1"> is the codename for the reimagined </span><strong class="bold"><span class="koboSpan" id="kobo.34.1">.NET Compiler Platform</span></strong><span class="koboSpan" id="kobo.35.1"> that was released alongside Visual Studio 2015. </span><span class="koboSpan" id="kobo.35.2">Since “.NET Compiler Platform” is a lot to say, most people refer to this as the Roslyn compiler or simply Roslyn </span><span class="No-Break"><span class="koboSpan" id="kobo.36.1">for short.</span></span></p>
<p><span class="koboSpan" id="kobo.37.1">Before Roslyn, if a tool wanted to understand C#, VB, or F# source code, developers needed to write their own language parser for these code files. </span><span class="koboSpan" id="kobo.37.2">This involved a significant amount of time and complexity, and this effort needed to be repeated every time these programming languages changed. </span><span class="koboSpan" id="kobo.37.3">This led to tools being slower to support new language features, lost productivity, </span><span class="No-Break"><span class="koboSpan" id="kobo.38.1">and bugs.</span></span></p>
<p><span class="koboSpan" id="kobo.39.1">One of the explicit </span><a id="_idIndexMarker782"/><span class="koboSpan" id="kobo.40.1">goals of the Rosyln compiler was to provide visibility into the structure of code in a standardized way. </span><span class="koboSpan" id="kobo.40.2">This way, plugins could work with the Roslyn APIs to get live information about code without having to write their </span><span class="No-Break"><span class="koboSpan" id="kobo.41.1">own parser.</span></span></p>
<p><span class="koboSpan" id="kobo.42.1">To do this, projects can create </span><strong class="bold"><span class="koboSpan" id="kobo.43.1">Roslyn Analyzers</span></strong><span class="koboSpan" id="kobo.44.1">, which integrate into the code analysis and compilation process. </span><span class="koboSpan" id="kobo.44.2">This lets you do </span><span class="No-Break"><span class="koboSpan" id="kobo.45.1">the following:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.46.1">Provide warnings and errors when anti-patterns in code </span><span class="No-Break"><span class="koboSpan" id="kobo.47.1">are present</span></span></li>
<li><span class="koboSpan" id="kobo.48.1">Integrate into the </span><strong class="bold"><span class="koboSpan" id="kobo.49.1">Quick Actions</span></strong><span class="koboSpan" id="kobo.50.1"> menu, allowing developers to automatically fix known issues using </span><span class="No-Break"><span class="koboSpan" id="kobo.51.1">established solutions</span></span></li>
<li><span class="koboSpan" id="kobo.52.1">Provide refactoring capabilities, thereby improving </span><span class="No-Break"><span class="koboSpan" id="kobo.53.1">developer productivity</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.54.1">You’ve been working with Roslyn Analyzers this whole time with the various code warnings, suggestions, and </span><strong class="bold"><span class="koboSpan" id="kobo.55.1">Quick Action</span></strong><span class="koboSpan" id="kobo.56.1"> refactorings you’ve seen in </span><span class="No-Break"><span class="koboSpan" id="kobo.57.1">Visual Studio.</span></span></p>
<p><span class="koboSpan" id="kobo.58.1">You can explore the built-in analyzers in your projects by going to </span><strong class="bold"><span class="koboSpan" id="kobo.59.1">Solution Explorer</span></strong><span class="koboSpan" id="kobo.60.1"> and then expanding a project’s </span><strong class="bold"><span class="koboSpan" id="kobo.61.1">Dependencies</span></strong><span class="koboSpan" id="kobo.62.1"> node, followed by its </span><strong class="bold"><span class="koboSpan" id="kobo.63.1">Analyzers</span></strong><span class="koboSpan" id="kobo.64.1"> node and specific analyzer assemblies, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.65.1">Figure 13</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.66.1">.1</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.67.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer161">
<span class="koboSpan" id="kobo.68.1"><img alt="Figure 13.1 – Code analyzers in Solutions Explorer" src="image/B21324_13_1.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.69.1">Figure 13.1 – Code analyzers in Solutions Explorer</span></p>
<p><span class="koboSpan" id="kobo.70.1">Through the rest </span><a id="_idIndexMarker783"/><span class="koboSpan" id="kobo.71.1">of this chapter, we’ll create a Roslyn Analyzer of our own, but before we do, let’s talk about how Roslyn sees </span><span class="No-Break"><span class="koboSpan" id="kobo.72.1">C# code.</span></span></p>
<h2 id="_idParaDest-280"><a id="_idTextAnchor279"/><span class="koboSpan" id="kobo.73.1">Installing the extension development workload and DGML editor</span></h2>
<p><span class="koboSpan" id="kobo.74.1">When you’re developing with </span><a id="_idIndexMarker784"/><span class="koboSpan" id="kobo.75.1">Roslyn Analyzers, two additions to Visual Studio will help you create and debug your own analyzers. </span><span class="koboSpan" id="kobo.75.2">Let’s install</span><a id="_idIndexMarker785"/><span class="koboSpan" id="kobo.76.1"> these by launching </span><strong class="bold"><span class="koboSpan" id="kobo.77.1">Visual Studio Installer</span></strong><span class="koboSpan" id="kobo.78.1"> from the</span><a id="_idIndexMarker786"/><span class="koboSpan" id="kobo.79.1"> Windows start menu. </span><span class="koboSpan" id="kobo.79.2">Next, select your installation of Visual Studio and </span><span class="No-Break"><span class="koboSpan" id="kobo.80.1">click </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.81.1">Modify</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.82.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.83.1">This will bring up a list of workloads and features that are available. </span><span class="koboSpan" id="kobo.83.2">These change over time, but you’ll want to make sure that the </span><strong class="bold"><span class="koboSpan" id="kobo.84.1">Visual Studio extension development</span></strong><span class="koboSpan" id="kobo.85.1"> workload is checked in the </span><strong class="bold"><span class="koboSpan" id="kobo.86.1">Workloads</span></strong><span class="koboSpan" id="kobo.87.1"> tab, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.88.1">Figure 13</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.89.1">.2</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.90.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer162">
<span class="koboSpan" id="kobo.91.1"><img alt="Figure 13.2 – Installing Visual Studio extension development and DGML editor" src="image/B21324_13_2.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.92.1">Figure 13.2 – Installing Visual Studio extension development and DGML editor</span></p>
<p><span class="koboSpan" id="kobo.93.1">Next, find </span><strong class="bold"><span class="koboSpan" id="kobo.94.1">DGML editor</span></strong><span class="koboSpan" id="kobo.95.1"> in the </span><strong class="bold"><span class="koboSpan" id="kobo.96.1">Individual components</span></strong><span class="koboSpan" id="kobo.97.1"> tab and check it as well before clicking </span><strong class="bold"><span class="koboSpan" id="kobo.98.1">Modify</span></strong><span class="koboSpan" id="kobo.99.1"> to install the </span><span class="No-Break"><span class="koboSpan" id="kobo.100.1">additional components.</span></span></p>
<p><span class="koboSpan" id="kobo.101.1">The Visual Studio extension </span><a id="_idIndexMarker787"/><span class="koboSpan" id="kobo.102.1">development workload is useful when you are trying to create a VSIX extension </span><a id="_idIndexMarker788"/><span class="koboSpan" id="kobo.103.1">project for Visual Studio. </span><span class="koboSpan" id="kobo.103.2">This type of project allows you to add custom user interface elements, analyzers, and new features to Visual Studio. </span><span class="koboSpan" id="kobo.103.3">We’ll talk more about VSIX extensions periodically throughout the rest of this chapter and </span><span class="No-Break"><span class="koboSpan" id="kobo.104.1">the next.</span></span></p>
<p><span class="koboSpan" id="kobo.105.1">The DGML editor works</span><a id="_idIndexMarker789"/><span class="koboSpan" id="kobo.106.1"> with </span><strong class="bold"><span class="koboSpan" id="kobo.107.1">Directed Graph Markup Language</span></strong><span class="koboSpan" id="kobo.108.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.109.1">DGML</span></strong><span class="koboSpan" id="kobo.110.1">) to show interactive visualizations in Visual Studio. </span><span class="koboSpan" id="kobo.110.2">It also happens to install a very useful view that will help us understand Rosyln more: </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.111.1">Syntax Visualizer</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.112.1">.</span></span></p>
<h2 id="_idParaDest-281"><a id="_idTextAnchor280"/><span class="koboSpan" id="kobo.113.1">Introducing Syntax Visualizer</span></h2>
<p><strong class="bold"><span class="koboSpan" id="kobo.114.1">Syntax Visualizer</span></strong><span class="koboSpan" id="kobo.115.1"> is a view in Visual</span><a id="_idIndexMarker790"/><span class="koboSpan" id="kobo.116.1"> Studio that allows you to see the structure of source code from the Roslyn API’s point </span><span class="No-Break"><span class="koboSpan" id="kobo.117.1">of view.</span></span></p>
<p><span class="koboSpan" id="kobo.118.1">To see this in action, open a</span><a id="_idIndexMarker791"/><span class="koboSpan" id="kobo.119.1"> C# file in your editor and then open </span><strong class="bold"><span class="koboSpan" id="kobo.120.1">Syntax Visualizer</span></strong><span class="koboSpan" id="kobo.121.1"> by clicking the </span><strong class="bold"><span class="koboSpan" id="kobo.122.1">View</span></strong><span class="koboSpan" id="kobo.123.1"> menu, followed by </span><strong class="bold"><span class="koboSpan" id="kobo.124.1">Other Windows</span></strong><span class="koboSpan" id="kobo.125.1"> and then </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.126.1">Syntax Visualizer</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.127.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.128.1">This should show you a hierarchy of various nodes corresponding to the code in your editor, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.129.1">Figure 13</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.130.1">.3</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.131.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer163">
<span class="koboSpan" id="kobo.132.1"><img alt="Figure 13.3 – Syntax Visualizer synchronizing with the current code selection" src="image/B21324_13_3.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.133.1">Figure 13.3 – Syntax Visualizer synchronizing with the current code selection</span></p>
<p><span class="koboSpan" id="kobo.134.1">Click on various keywords, variables, methods, and</span><a id="_idIndexMarker792"/><span class="koboSpan" id="kobo.135.1"> values in your code and watch </span><strong class="bold"><span class="koboSpan" id="kobo.136.1">Syntax Visualizer</span></strong><span class="koboSpan" id="kobo.137.1"> change to reflect what </span><span class="No-Break"><span class="koboSpan" id="kobo.138.1">you’ve selected.</span></span></p>
<p><span class="koboSpan" id="kobo.139.1">This is a very good way of</span><a id="_idIndexMarker793"/><span class="koboSpan" id="kobo.140.1"> understanding how code is structured in Roslyn’s APIs, but the tool can also be helpful when you’re not sure what class inside of the Roslyn API refers to the type of code element you want to </span><span class="No-Break"><span class="koboSpan" id="kobo.141.1">work with.</span></span></p>
<p><span class="koboSpan" id="kobo.142.1">Now that we have a slightly greater understanding of what the Roslyn API is, let’s create our first </span><span class="No-Break"><span class="koboSpan" id="kobo.143.1">Roslyn Analyzer.</span></span></p>
<h1 id="_idParaDest-282"><a id="_idTextAnchor281"/><span class="koboSpan" id="kobo.144.1">Creating a Roslyn Analyzer</span></h1>
<p><span class="koboSpan" id="kobo.145.1">People create custom </span><a id="_idIndexMarker794"/><span class="koboSpan" id="kobo.146.1">Roslyn Analyzers when they experience common issues in their code that no existing analyzer addresses. </span><span class="koboSpan" id="kobo.146.2">These custom analyzers help enforce rules that specific organizations or teams find to be useful. </span><span class="koboSpan" id="kobo.146.3">However, these organization-specific rules tend to be less relevant to the larger .</span><span class="No-Break"><span class="koboSpan" id="kobo.147.1">NET community.</span></span></p>
<p><span class="koboSpan" id="kobo.148.1">Here are a few examples of when you might want to build a </span><span class="No-Break"><span class="koboSpan" id="kobo.149.1">custom analyzer:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.150.1">Your team has been having issues with too many </span><strong class="source-inline"><span class="koboSpan" id="kobo.151.1">FormatException</span></strong><span class="koboSpan" id="kobo.152.1"> errors from things such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.153.1">int.Parse</span></strong><span class="koboSpan" id="kobo.154.1"> and wants to make </span><strong class="source-inline"><span class="koboSpan" id="kobo.155.1">int.TryParse</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.156.1">their standard</span></span></li>
<li><span class="koboSpan" id="kobo.157.1">Due to large files and limited memory, your team wants to avoid the </span><strong class="source-inline"><span class="koboSpan" id="kobo.158.1">File.ReadAllText</span></strong><span class="koboSpan" id="kobo.159.1"> method and use stream-based </span><span class="No-Break"><span class="koboSpan" id="kobo.160.1">approaches instead</span></span></li>
<li><span class="koboSpan" id="kobo.161.1">Your team mandates that all classes must override the </span><strong class="source-inline"><span class="koboSpan" id="kobo.162.1">ToString</span></strong><span class="koboSpan" id="kobo.163.1"> method to improve the debugging and </span><span class="No-Break"><span class="koboSpan" id="kobo.164.1">logging experience</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.165.1">Note that none of these approaches relate to styling or syntax. </span><span class="koboSpan" id="kobo.165.2">Instead, these analyzers deal with team-specific </span><a id="_idIndexMarker795"/><span class="koboSpan" id="kobo.166.1">decisions about how to best use .NET. </span><span class="koboSpan" id="kobo.166.2">We’ll explore ways of enforcing styling and syntax choices in </span><a href="B21324_16.xhtml#_idTextAnchor341"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.167.1">Chapter 16</span></em></span></a><span class="koboSpan" id="kobo.168.1">, </span><em class="italic"><span class="koboSpan" id="kobo.169.1">Adopting </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.170.1">Code Standards</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.171.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.172.1">Let’s say that Cloudy Skies Airlines is spending a lot of time debugging and troubleshooting code and suspects that overriding </span><strong class="source-inline"><span class="koboSpan" id="kobo.173.1">ToString</span></strong><span class="koboSpan" id="kobo.174.1"> in more places would lead to a better developer experience for </span><span class="No-Break"><span class="koboSpan" id="kobo.175.1">their team.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.176.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.177.1">It’s not an established best practice to override </span><strong class="source-inline"><span class="koboSpan" id="kobo.178.1">ToString</span></strong><span class="koboSpan" id="kobo.179.1"> in all classes. </span><span class="koboSpan" id="kobo.179.2">There are likely some performance drawbacks to doing so, but for this chapter, we’ll assume this rule makes sense for the Cloudy </span><span class="No-Break"><span class="koboSpan" id="kobo.180.1">Skies team.</span></span></p>
<p><span class="koboSpan" id="kobo.181.1">Throughout the rest of this chapter, we’ll create this analyzer, starting from a </span><span class="No-Break"><span class="koboSpan" id="kobo.182.1">blank solution.</span></span></p>
<h2 id="_idParaDest-283"><a id="_idTextAnchor282"/><span class="koboSpan" id="kobo.183.1">Adding the analyzer project to our solution</span></h2>
<p><span class="koboSpan" id="kobo.184.1">While there are</span><a id="_idIndexMarker796"/><span class="koboSpan" id="kobo.185.1"> templates for creating Roslyn Analyzers built into Visual Studio, these are older templates and they hide some of the implementation details. </span><span class="koboSpan" id="kobo.185.2">Instead, we’re going to walk through the steps of creating and deploying a Roslyn Analyzer from an </span><span class="No-Break"><span class="koboSpan" id="kobo.186.1">empty solution.</span></span></p>
<p><span class="koboSpan" id="kobo.187.1">We’ll start by adding a class library that will contain our analyzer. </span><span class="koboSpan" id="kobo.187.2">Class libraries are a special type of project that provides code to other projects but cannot run on </span><span class="No-Break"><span class="koboSpan" id="kobo.188.1">their own.</span></span></p>
<p><span class="koboSpan" id="kobo.189.1">Starting with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.190.1">Chapter13BeginningCode</span></strong><span class="koboSpan" id="kobo.191.1"> solution, we’ll right-click on the solution in </span><strong class="bold"><span class="koboSpan" id="kobo.192.1">Solution Explorer</span></strong><span class="koboSpan" id="kobo.193.1"> and then choose </span><strong class="bold"><span class="koboSpan" id="kobo.194.1">Add</span></strong><span class="koboSpan" id="kobo.195.1"> and then </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.196.1">New Project…</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.197.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.198.1">From there, we’ll select</span><a id="_idIndexMarker797"/><span class="koboSpan" id="kobo.199.1"> the type of project we want to create, select a </span><strong class="bold"><span class="koboSpan" id="kobo.200.1">Class Library</span></strong><span class="koboSpan" id="kobo.201.1"> project using the C# language, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.202.1">Figure 13</span></em></span><em class="italic"><span class="koboSpan" id="kobo.203.1">.4</span></em><span class="koboSpan" id="kobo.204.1">, and </span><span class="No-Break"><span class="koboSpan" id="kobo.205.1">click </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.206.1">Next</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.207.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer164">
<span class="koboSpan" id="kobo.208.1"><img alt="Figure 13.4 – Adding a C# Class Library project to our solution" src="image/B21324_13_4.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.209.1">Figure 13.4 – Adding a C# Class Library project to our solution</span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.210.1">Warning</span></p>
<p class="callout"><span class="koboSpan" id="kobo.211.1">There are multiple projects with the name Class Library in different languages. </span><span class="koboSpan" id="kobo.211.2">Look for the green C# icon and the C# label in </span><span class="No-Break"><span class="koboSpan" id="kobo.212.1">the list.</span></span></p>
<p><span class="koboSpan" id="kobo.213.1">Next, we’ll need to provide a name for our class library. </span><span class="koboSpan" id="kobo.213.2">This is the library that will hold the code analyzer we’re creating this chapter, so let’s call it </span><strong class="source-inline"><span class="koboSpan" id="kobo.214.1">Packt.Analyzers</span></strong><span class="koboSpan" id="kobo.215.1"> since the name of the project will become the default namespace of </span><span class="No-Break"><span class="koboSpan" id="kobo.216.1">the project.</span></span></p>
<p><span class="koboSpan" id="kobo.217.1">After this, you’ll be asked to select the framework the project should use. </span><span class="koboSpan" id="kobo.217.2">Select </span><strong class="bold"><span class="koboSpan" id="kobo.218.1">.NET Standard 2.0</span></strong><span class="koboSpan" id="kobo.219.1"> and click </span><strong class="bold"><span class="koboSpan" id="kobo.220.1">Create</span></strong><span class="koboSpan" id="kobo.221.1">. </span><span class="koboSpan" id="kobo.221.2">The new project will be added to </span><span class="No-Break"><span class="koboSpan" id="kobo.222.1">your solution.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.223.1">Why .NET Standard?</span></p>
<p class="callout"><span class="koboSpan" id="kobo.224.1">Unlike other projects in this book, we’re using .NET Standard here. </span><span class="koboSpan" id="kobo.224.2">This is a special version of .NET that was designed to run on a variety of different .NET runtimes. </span><span class="koboSpan" id="kobo.224.3">This makes .NET Standard a great choice for when you don’t know which version of .NET your code will be running in. </span><span class="koboSpan" id="kobo.224.4">See the </span><em class="italic"><span class="koboSpan" id="kobo.225.1">Further reading</span></em><span class="koboSpan" id="kobo.226.1"> section for </span><span class="No-Break"><span class="koboSpan" id="kobo.227.1">more information.</span></span></p>
<p><span class="koboSpan" id="kobo.228.1">To create a Roslyn Analyzer, we’ll need to add a few NuGet packages to our class library. </span><span class="koboSpan" id="kobo.228.2">To do this, right-click on the class library in </span><strong class="bold"><span class="koboSpan" id="kobo.229.1">Solution Explorer</span></strong><span class="koboSpan" id="kobo.230.1"> and then choose </span><strong class="bold"><span class="koboSpan" id="kobo.231.1">Manage </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.232.1">NuGet Packages…</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.233.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.234.1">Once you’re in </span><strong class="bold"><span class="koboSpan" id="kobo.235.1">NuGet Package Manager</span></strong><span class="koboSpan" id="kobo.236.1">, go to the </span><strong class="bold"><span class="koboSpan" id="kobo.237.1">Browse</span></strong><span class="koboSpan" id="kobo.238.1"> tab and then search for and install version</span><a id="_idIndexMarker798"/><span class="koboSpan" id="kobo.239.1"> 4.0.1 of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.240.1">Microsoft.CodeAnalysis</span></strong><span class="koboSpan" id="kobo.241.1"> package, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.242.1">Figure 13</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.243.1">.5</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.244.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer165">
<span class="koboSpan" id="kobo.245.1"><img alt="Figure 13.5 – Installing version 4.0.1 of Microsoft.CodeAnalysis" src="image/B21324_13_5.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.246.1">Figure 13.5 – Installing version 4.0.1 of Microsoft.CodeAnalysis</span></p>
<p><span class="koboSpan" id="kobo.247.1">Note that version 4.0.1 is not the most recent version of this package. </span><span class="koboSpan" id="kobo.247.2">This specific version was chosen to avoid a conflict with the testing library we’ll </span><span class="No-Break"><span class="koboSpan" id="kobo.248.1">use later.</span></span></p>
<p><span class="koboSpan" id="kobo.249.1">Now that the package has been installed, we’re ready to start creating our </span><span class="No-Break"><span class="koboSpan" id="kobo.250.1">Roslyn Analyzer.</span></span></p>
<h2 id="_idParaDest-284"><a id="_idTextAnchor283"/><span class="koboSpan" id="kobo.251.1">Defining a code analysis rule</span></h2>
<p><span class="koboSpan" id="kobo.252.1">Let’s start by </span><a id="_idIndexMarker799"/><span class="koboSpan" id="kobo.253.1">renaming the </span><strong class="source-inline"><span class="koboSpan" id="kobo.254.1">Class1.cs</span></strong><span class="koboSpan" id="kobo.255.1"> file to </span><strong class="source-inline"><span class="koboSpan" id="kobo.256.1">ToStringAnalyzer.cs</span></strong><span class="koboSpan" id="kobo.257.1"> and replacing its contents with </span><span class="No-Break"><span class="koboSpan" id="kobo.258.1">the following:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.259.1">
using System;
using System.Linq;
using System.Collections.Immutable;
using Microsoft.CodeAnalysis;
using Microsoft.CodeAnalysis.Diagnostics;
namespace Packt.Analyzers {
  [DiagnosticAnalyzer(LanguageNames.CSharp)]
  public class ToStringAnalyzer : DiagnosticAnalyzer {
  }
}</span></pre>
<p><span class="koboSpan" id="kobo.260.1">This is the minimum</span><a id="_idIndexMarker800"/><span class="koboSpan" id="kobo.261.1"> we need to have a compiling analyzer. </span><span class="koboSpan" id="kobo.261.2">Let’s explore </span><span class="No-Break"><span class="koboSpan" id="kobo.262.1">what’s here.</span></span></p>
<p><span class="koboSpan" id="kobo.263.1">First of all, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.264.1">ToStringAnalyzer</span></strong><span class="koboSpan" id="kobo.265.1"> class inherits from </span><strong class="source-inline"><span class="koboSpan" id="kobo.266.1">DiagnosticAnalyzer</span></strong><span class="koboSpan" id="kobo.267.1">, which is a base class for all Roslyn Analyzers that provide warnings to </span><span class="No-Break"><span class="koboSpan" id="kobo.268.1">the user.</span></span></p>
<p><span class="koboSpan" id="kobo.269.1">The class has a </span><strong class="source-inline"><span class="koboSpan" id="kobo.270.1">DiagnosticAnalyzer</span></strong><span class="koboSpan" id="kobo.271.1"> attribute that says the analyzer applies to code written </span><span class="No-Break"><span class="koboSpan" id="kobo.272.1">in C#.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.273.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.274.1">It’s possible to write analyzers that apply to C#, F#, Visual Basic, or some combination of </span><span class="No-Break"><span class="koboSpan" id="kobo.275.1">these languages.</span></span></p>
<p><span class="koboSpan" id="kobo.276.1">Inheriting from the abstract </span><strong class="source-inline"><span class="koboSpan" id="kobo.277.1">DiagnosticAnalyzers</span></strong><span class="koboSpan" id="kobo.278.1"> class forces us to override the </span><strong class="source-inline"><span class="koboSpan" id="kobo.279.1">SupportedDiagnostics</span></strong><span class="koboSpan" id="kobo.280.1"> property and the </span><strong class="source-inline"><span class="koboSpan" id="kobo.281.1">Initialize</span></strong><span class="koboSpan" id="kobo.282.1"> method. </span><span class="koboSpan" id="kobo.282.2">Let’s do that now in the simplest </span><span class="No-Break"><span class="koboSpan" id="kobo.283.1">way possible:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.284.1">
public override ImmutableArray&lt;DiagnosticDescriptor&gt;
  SupportedDiagnostics =&gt; null;
public override void Initialize(AnalysisContext con) {
}</span></pre>
<p><span class="koboSpan" id="kobo.285.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.286.1">SupportedDiagnostics</span></strong><span class="koboSpan" id="kobo.287.1"> property returns </span><strong class="source-inline"><span class="koboSpan" id="kobo.288.1">ImmutableArray</span></strong><span class="koboSpan" id="kobo.289.1">, which contains all diagnostic rules the analyzer provides to the editor. </span><span class="koboSpan" id="kobo.289.2">In our case, we’ll want it to return the warning the user might see if the rule </span><span class="No-Break"><span class="koboSpan" id="kobo.290.1">is violated.</span></span></p>
<p><span class="koboSpan" id="kobo.291.1">Let’s add a new property and update our </span><strong class="source-inline"><span class="koboSpan" id="kobo.292.1">SupportedDiagnostics</span></strong><span class="koboSpan" id="kobo.293.1"> property, as </span><span class="No-Break"><span class="koboSpan" id="kobo.294.1">shown here:</span></span></p>
<pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.295.1">public static readonly DiagnosticDescriptor Rule =</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.296.1">  new DiagnosticDescriptor(</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.297.1">    id: "CSA1001",</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.298.1">    title: "Override ToString()",</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.299.1">    messageFormat: "Override ToString on {0}",</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.300.1">    category: "Maintainability",</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.301.1">    defaultSeverity: DiagnosticSeverity.Info,</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.302.1">    isEnabledByDefault: true,</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.303.1">    description: "Override ToString to help debugging.");</span></strong><span class="koboSpan" id="kobo.304.1">
public override ImmutableArray&lt;DiagnosticDescriptor&gt;
  SupportedDiagnostics =&gt; </span><strong class="bold"><span class="koboSpan" id="kobo.305.1">ImmutableArray.Create(Rule);</span></strong></pre>
<p><span class="koboSpan" id="kobo.306.1">Here, we’ve added a static </span><strong class="source-inline"><span class="koboSpan" id="kobo.307.1">Rule</span></strong><span class="koboSpan" id="kobo.308.1"> property that defines the </span><strong class="source-inline"><span class="koboSpan" id="kobo.309.1">DiagnosticDescriptor</span></strong><span class="koboSpan" id="kobo.310.1"> object that’s </span><a id="_idIndexMarker801"/><span class="koboSpan" id="kobo.311.1">defining our rule. </span><span class="koboSpan" id="kobo.311.2">This rule is then included in the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.312.1">SupportedDiagnostics</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.313.1"> property.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.314.1">Localization note</span></p>
<p class="callout"><strong class="source-inline"><span class="koboSpan" id="kobo.315.1">DiagnosticDescriptor</span></strong><span class="koboSpan" id="kobo.316.1"> objects can be created with either raw strings, as we’re using here, or by using </span><strong class="source-inline"><span class="koboSpan" id="kobo.317.1">LocalizableString</span></strong><span class="koboSpan" id="kobo.318.1"> parameters. </span><strong class="source-inline"><span class="koboSpan" id="kobo.319.1">LocalizableString</span></strong><span class="koboSpan" id="kobo.320.1"> works better in different languages, so you’ll want to use it if you are trying to create a Roslyn Analyzer intended to be used throughout </span><span class="No-Break"><span class="koboSpan" id="kobo.321.1">the globe.</span></span></p>
<p><span class="koboSpan" id="kobo.322.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.323.1">DiagnosticDescriptor</span></strong><span class="koboSpan" id="kobo.324.1"> object that this code defines will show up in the </span><strong class="bold"><span class="koboSpan" id="kobo.325.1">Error List</span></strong><span class="koboSpan" id="kobo.326.1"> pane and build output if the rule is ever violated. </span><span class="koboSpan" id="kobo.326.2">The rule needs the </span><span class="No-Break"><span class="koboSpan" id="kobo.327.1">following parts:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.328.1">ID</span></strong><span class="koboSpan" id="kobo.329.1">: A piece of code starting with letters identifying a provider and then a numeric code. </span><span class="koboSpan" id="kobo.329.2">We chose the code </span><strong class="source-inline"><span class="koboSpan" id="kobo.330.1">CSA</span></strong><span class="koboSpan" id="kobo.331.1"> for Cloudy </span><span class="No-Break"><span class="koboSpan" id="kobo.332.1">Skies Airlines.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.333.1">Title</span></strong><span class="koboSpan" id="kobo.334.1">: The short name of the code analysis warning. </span><span class="koboSpan" id="kobo.334.2">This is what will appear in tooltips when the rule </span><span class="No-Break"><span class="koboSpan" id="kobo.335.1">is violated.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.336.1">Message format</span></strong><span class="koboSpan" id="kobo.337.1">: A formattable string that will appear in the Visual </span><span class="No-Break"><span class="koboSpan" id="kobo.338.1">Studio tooltip.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.339.1">Category</span></strong><span class="koboSpan" id="kobo.340.1">: The broad rule category. </span><span class="koboSpan" id="kobo.340.2">Common categories include </span><strong class="source-inline"><span class="koboSpan" id="kobo.341.1">Naming</span></strong><span class="koboSpan" id="kobo.342.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.343.1">Performance</span></strong><span class="koboSpan" id="kobo.344.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.345.1">Maintainability</span></strong><span class="koboSpan" id="kobo.346.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.347.1">Security</span></strong><span class="koboSpan" id="kobo.348.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.349.1">Reliability</span></strong><span class="koboSpan" id="kobo.350.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.351.1">Design</span></strong><span class="koboSpan" id="kobo.352.1">, </span><span class="No-Break"><span class="koboSpan" id="kobo.353.1">and </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.354.1">Usage</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.355.1">.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.356.1">Default severity</span></strong><span class="koboSpan" id="kobo.357.1">: The severity of the code analysis rule without the user adjusting it. </span><span class="koboSpan" id="kobo.357.2">This will be </span><strong class="source-inline"><span class="koboSpan" id="kobo.358.1">Hidden</span></strong><span class="koboSpan" id="kobo.359.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.360.1">Info</span></strong><span class="koboSpan" id="kobo.361.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.362.1">Warning</span></strong><span class="koboSpan" id="kobo.363.1">, </span><span class="No-Break"><span class="koboSpan" id="kobo.364.1">or </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.365.1">Error</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.366.1">.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.367.1">Enabled by default</span></strong><span class="koboSpan" id="kobo.368.1">: Whether the rule starts </span><span class="No-Break"><span class="koboSpan" id="kobo.369.1">as enabled.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.370.1">Description</span></strong><span class="koboSpan" id="kobo.371.1">: A detailed description of the rule and why it’s important. </span><span class="koboSpan" id="kobo.371.2">This shows up in the </span><strong class="bold"><span class="koboSpan" id="kobo.372.1">Error List</span></strong><span class="koboSpan" id="kobo.373.1"> pane when a rule violation </span><span class="No-Break"><span class="koboSpan" id="kobo.374.1">is expanded.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.375.1">Defining your rule as a separate property is helpful when other code needs to refer to your exact </span><span class="No-Break"><span class="koboSpan" id="kobo.376.1">rule </span></span><span class="No-Break"><a id="_idIndexMarker802"/></span><span class="No-Break"><span class="koboSpan" id="kobo.377.1">definition.</span></span></p>
<p><span class="koboSpan" id="kobo.378.1">Now that our rule has been defined, let’s write the code that detects when the rule </span><span class="No-Break"><span class="koboSpan" id="kobo.379.1">is violated.</span></span></p>
<h2 id="_idParaDest-285"><a id="_idTextAnchor284"/><span class="koboSpan" id="kobo.380.1">Analyzing symbols with our Roslyn Analyzer</span></h2>
<p><span class="koboSpan" id="kobo.381.1">Let’s start by building </span><a id="_idIndexMarker803"/><span class="koboSpan" id="kobo.382.1">out our </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.383.1">Initialize</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.384.1"> method:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.385.1">
public override void Initialize(AnalysisContext con) {
</span><strong class="bold"><span class="koboSpan" id="kobo.386.1">  con.ConfigureGeneratedCodeAnalysis(</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.387.1">    GeneratedCodeAnalysisFlags.None);</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.388.1">  con.EnableConcurrentExecution();</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.389.1">  con.RegisterSymbolAction(Analyze, SymbolKind.NamedType);</span></strong><span class="koboSpan" id="kobo.390.1">
}</span></pre>
<p><span class="koboSpan" id="kobo.391.1">This method now does a few </span><span class="No-Break"><span class="koboSpan" id="kobo.392.1">additional things:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.393.1">First, we configure the analyzer to ignore any auto-generated code for analysis purposes. </span><span class="koboSpan" id="kobo.393.2">These are files that the user didn’t write but various tools generate and so it doesn’t make sense to </span><span class="No-Break"><span class="koboSpan" id="kobo.394.1">analyze them.</span></span></li>
<li><span class="koboSpan" id="kobo.395.1">Secondly, we tell Roslyn that it’s fine to evaluate multiple pieces of code with this rule at the same time. </span><span class="koboSpan" id="kobo.395.2">This is always the preferred option from a </span><span class="No-Break"><span class="koboSpan" id="kobo.396.1">performance standpoint.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.397.1">Finally, we tell the analyzer that whenever it encounters a named </span><strong class="source-inline"><span class="koboSpan" id="kobo.398.1">Type</span></strong><span class="koboSpan" id="kobo.399.1"> during code analysis, we want to</span><a id="_idIndexMarker804"/><span class="koboSpan" id="kobo.400.1"> know about it. </span><span class="koboSpan" id="kobo.400.2">Specifically, the code should call a new </span><strong class="source-inline"><span class="koboSpan" id="kobo.401.1">Analyze</span></strong><span class="koboSpan" id="kobo.402.1"> method for each </span><strong class="source-inline"><span class="koboSpan" id="kobo.403.1">Type</span></strong><span class="koboSpan" id="kobo.404.1"> that </span><span class="No-Break"><span class="koboSpan" id="kobo.405.1">is detected.</span></span></p>
<p><span class="koboSpan" id="kobo.406.1">We haven’t written that </span><strong class="source-inline"><span class="koboSpan" id="kobo.407.1">Analyze</span></strong><span class="koboSpan" id="kobo.408.1"> method yet, so let’s do </span><span class="No-Break"><span class="koboSpan" id="kobo.409.1">so now:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.410.1">
private static void Analyze(
  SymbolAnalysisContext con) {
  INamedTypeSymbol sym = (INamedTypeSymbol)con.Symbol;
  IMethodSymbol toString =
    sym.GetMembers()
       .OfType&lt;IMethodSymbol&gt;()
       .FirstOrDefault(m =&gt; m.Name == "ToString"
                         &amp;&amp; m.IsOverride
                         &amp;&amp; m.Parameters.Length == 0);
  if (toString == null) {
    Diagnostic diagnostic = Diagnostic.Create(
      Rule, sym.Locations[0], sym.Name);
    con.ReportDiagnostic(diagnostic);
  }
}</span></pre>
<p><span class="koboSpan" id="kobo.411.1">This code is not easy to write or read, so let’s go over it before discussing </span><em class="italic"><span class="koboSpan" id="kobo.412.1">how</span></em><span class="koboSpan" id="kobo.413.1"> to write </span><span class="No-Break"><span class="koboSpan" id="kobo.414.1">analyzer code.</span></span></p>
<p><span class="koboSpan" id="kobo.415.1">First, since we know this method is called on named types, we can cast the symbol Roslyn gives us to </span><strong class="source-inline"><span class="koboSpan" id="kobo.416.1">INamedTypeSymbol</span></strong><span class="koboSpan" id="kobo.417.1">, which lets us </span><span class="No-Break"><span class="koboSpan" id="kobo.418.1">query further.</span></span></p>
<p><span class="koboSpan" id="kobo.419.1">Using this symbol, we can ask for all members such as properties and methods using </span><strong class="source-inline"><span class="koboSpan" id="kobo.420.1">GetMembers</span></strong><span class="koboSpan" id="kobo.421.1">. </span><span class="koboSpan" id="kobo.421.2">Next, we</span><a id="_idIndexMarker805"/><span class="koboSpan" id="kobo.422.1"> can use LINQ to filter these down to just ones that are methods. </span><span class="koboSpan" id="kobo.422.2">Once we have these, we can use </span><strong class="source-inline"><span class="koboSpan" id="kobo.423.1">FirstOrDefault</span></strong><span class="koboSpan" id="kobo.424.1"> to see if we have a method named </span><strong class="source-inline"><span class="koboSpan" id="kobo.425.1">ToString</span></strong><span class="koboSpan" id="kobo.426.1"> that takes in zero parameters and is </span><span class="No-Break"><span class="koboSpan" id="kobo.427.1">an override.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.428.1">Why not check the return type?</span></p>
<p class="callout"><span class="koboSpan" id="kobo.429.1">We could check if the return type was a string, but the C# compiler doesn’t allow multiple methods with the same parameters and different return types. </span><span class="koboSpan" id="kobo.429.2">We also know all objects have </span><strong class="source-inline"><span class="koboSpan" id="kobo.430.1">string ToString()</span></strong><span class="koboSpan" id="kobo.431.1">, so the return type will </span><span class="No-Break"><span class="koboSpan" id="kobo.432.1">be </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.433.1">string</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.434.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.435.1">If we didn’t find a </span><strong class="source-inline"><span class="koboSpan" id="kobo.436.1">ToString</span></strong><span class="koboSpan" id="kobo.437.1"> override, our analyzer should flag this as a violation of the rule. </span><span class="koboSpan" id="kobo.437.2">It does so by creating a </span><strong class="source-inline"><span class="koboSpan" id="kobo.438.1">Diagnostic</span></strong><span class="koboSpan" id="kobo.439.1"> object referencing the </span><strong class="source-inline"><span class="koboSpan" id="kobo.440.1">Rule</span></strong><span class="koboSpan" id="kobo.441.1"> property we defined earlier, as well as the name and location of the symbol that violated the rule. </span><span class="koboSpan" id="kobo.441.2">Here, the symbol will be a </span><strong class="source-inline"><span class="koboSpan" id="kobo.442.1">Type</span></strong><span class="koboSpan" id="kobo.443.1"> definition that does not </span><span class="No-Break"><span class="koboSpan" id="kobo.444.1">override </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.445.1">ToString</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.446.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.447.1">Before we go into verifying our analyzer works, let’s talk about writing </span><span class="No-Break"><span class="koboSpan" id="kobo.448.1">analyzer code.</span></span></p>
<h2 id="_idParaDest-286"><a id="_idTextAnchor285"/><span class="koboSpan" id="kobo.449.1">Tips for writing Roslyn Analyzers</span></h2>
<p><span class="koboSpan" id="kobo.450.1">In my experience, Roslyn</span><a id="_idIndexMarker806"/><span class="koboSpan" id="kobo.451.1"> Analyzers are one of the tougher pieces of code to write. </span><span class="koboSpan" id="kobo.451.2">With Roslyn, you’re looking at your C# code in a completely </span><span class="No-Break"><span class="koboSpan" id="kobo.452.1">different light.</span></span></p>
<p><span class="koboSpan" id="kobo.453.1">Each analyzer you write will likely be analyzing something completely different than the last one, making discussing the breadth of options available in </span><span class="No-Break"><span class="koboSpan" id="kobo.454.1">Roslyn difficult.</span></span></p>
<p><span class="koboSpan" id="kobo.455.1">I’ve found two key things helpful for writing </span><span class="No-Break"><span class="koboSpan" id="kobo.456.1">Roslyn Analyzers:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.457.1">Looking at other Roslyn Analyzers</span></strong><span class="koboSpan" id="kobo.458.1">: There are a lot of other Roslyn Analyzers out there (including the ones built into .NET) and most are open source. </span><span class="koboSpan" id="kobo.458.2">This means you can find an existing analyzer similar to what you’re interested in and then look at its source code and do </span><span class="No-Break"><span class="koboSpan" id="kobo.459.1">something similar.</span></span><p class="list-inset"><span class="koboSpan" id="kobo.460.1">See the </span><em class="italic"><span class="koboSpan" id="kobo.461.1">Further reading</span></em><span class="koboSpan" id="kobo.462.1"> section of this chapter for a few popular collections of </span><span class="No-Break"><span class="koboSpan" id="kobo.463.1">Roslyn Analyzers.</span></span></p></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.464.1">GitHub Copilot Chat</span></strong><span class="koboSpan" id="kobo.465.1">: Starting with an empty </span><strong class="source-inline"><span class="koboSpan" id="kobo.466.1">Analyze</span></strong><span class="koboSpan" id="kobo.467.1"> method, you can give Copilot a prompt such as “I want to find all methods contained in this type” or “How would I check if this type is marked </span><span class="No-Break"><span class="koboSpan" id="kobo.468.1">as public?”</span></span><p class="list-inset"><span class="koboSpan" id="kobo.469.1">You still need to provide high-level guidance, but in my experience, Copilot can be extremely effective at helping you write complex and unfamiliar </span><span class="No-Break"><span class="koboSpan" id="kobo.470.1">analyzer code.</span></span></p></li>
</ul>
<p><span class="koboSpan" id="kobo.471.1">Now that we’ve built our</span><a id="_idIndexMarker807"/><span class="koboSpan" id="kobo.472.1"> Roslyn Analyzer, let’s look at how we can make sure </span><span class="No-Break"><span class="koboSpan" id="kobo.473.1">it works.</span></span></p>
<h1 id="_idParaDest-287"><a id="_idTextAnchor286"/><span class="koboSpan" id="kobo.474.1">Testing Roslyn Analyzers with RoslynTestKit</span></h1>
<p><span class="koboSpan" id="kobo.475.1">We’ll show how to use your </span><a id="_idIndexMarker808"/><span class="koboSpan" id="kobo.476.1">Roslyn Analyzers in projects of your own at the end of this chapter, but we’ll start by writing unit tests around our </span><a id="_idIndexMarker809"/><span class="No-Break"><span class="koboSpan" id="kobo.477.1">existing analyzer.</span></span></p>
<p><span class="koboSpan" id="kobo.478.1">At a high level, we want to test two things with </span><span class="No-Break"><span class="koboSpan" id="kobo.479.1">our analyzer:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.480.1">The analyzer doesn’t trigger for code that doesn’t violate </span><span class="No-Break"><span class="koboSpan" id="kobo.481.1">its rule.</span></span></li>
<li><span class="koboSpan" id="kobo.482.1">The analyzer correctly flags code that </span><span class="No-Break"><span class="koboSpan" id="kobo.483.1">it should.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.484.1">We’ll do this with two unit tests in a new unit </span><span class="No-Break"><span class="koboSpan" id="kobo.485.1">test project.</span></span></p>
<h2 id="_idParaDest-288"><a id="_idTextAnchor287"/><span class="koboSpan" id="kobo.486.1">Adding a Roslyn Analyzer test project</span></h2>
<p><span class="koboSpan" id="kobo.487.1">Our tests can be </span><a id="_idIndexMarker810"/><span class="koboSpan" id="kobo.488.1">written in </span><strong class="bold"><span class="koboSpan" id="kobo.489.1">MSTest</span></strong><span class="koboSpan" id="kobo.490.1">, </span><strong class="bold"><span class="koboSpan" id="kobo.491.1">xUnit</span></strong><span class="koboSpan" id="kobo.492.1">, or </span><strong class="bold"><span class="koboSpan" id="kobo.493.1">NUnit</span></strong><span class="koboSpan" id="kobo.494.1">. </span><span class="koboSpan" id="kobo.494.2">We’ll use xUnit </span><span class="No-Break"><span class="koboSpan" id="kobo.495.1">for consistency.</span></span></p>
<p><span class="koboSpan" id="kobo.496.1">We’ll start by adding a new xUnit project to the solution by right-clicking on the solution and then choosing </span><strong class="bold"><span class="koboSpan" id="kobo.497.1">Add</span></strong><span class="koboSpan" id="kobo.498.1"> and then </span><strong class="bold"><span class="koboSpan" id="kobo.499.1">New Project…</span></strong><span class="koboSpan" id="kobo.500.1">, as we’ve </span><span class="No-Break"><span class="koboSpan" id="kobo.501.1">done before.</span></span></p>
<p><span class="koboSpan" id="kobo.502.1">After this, select the C# version of </span><strong class="bold"><span class="koboSpan" id="kobo.503.1">xUnit Test Project</span></strong><span class="koboSpan" id="kobo.504.1"> and click </span><strong class="bold"><span class="koboSpan" id="kobo.505.1">Next</span></strong><span class="koboSpan" id="kobo.506.1">. </span><span class="koboSpan" id="kobo.506.2">Name your project </span><strong class="source-inline"><span class="koboSpan" id="kobo.507.1">Packt.Analyzers.Tests</span></strong><span class="koboSpan" id="kobo.508.1"> and click </span><strong class="bold"><span class="koboSpan" id="kobo.509.1">Next</span></strong><span class="koboSpan" id="kobo.510.1">. </span><span class="koboSpan" id="kobo.510.2">When prompted with the framework, select </span><strong class="bold"><span class="koboSpan" id="kobo.511.1">.NET 8.0</span></strong><span class="koboSpan" id="kobo.512.1"> and </span><span class="No-Break"><span class="koboSpan" id="kobo.513.1">click </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.514.1">Create</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.515.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.516.1">Once the project has been created, add a project reference to </span><strong class="source-inline"><span class="koboSpan" id="kobo.517.1">Packt.Analyzers</span></strong><span class="koboSpan" id="kobo.518.1"> by right-clicking on the </span><strong class="bold"><span class="koboSpan" id="kobo.519.1">Dependencies</span></strong><span class="koboSpan" id="kobo.520.1"> node in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.521.1">Packt.Analyzers.Tests</span></strong><span class="koboSpan" id="kobo.522.1"> project and then</span><a id="_idIndexMarker811"/><span class="koboSpan" id="kobo.523.1"> selecting </span><strong class="bold"><span class="koboSpan" id="kobo.524.1">Add Project Reference…</span></strong><span class="koboSpan" id="kobo.525.1">, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.526.1">Figure 13</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.527.1">.6</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.528.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer166">
<span class="koboSpan" id="kobo.529.1"><img alt="Figure 13.6 – Add Project Reference…" src="image/B21324_13_6.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.530.1">Figure 13.6 – Add Project Reference…</span></p>
<p><span class="koboSpan" id="kobo.531.1">Check the box next to </span><strong class="source-inline"><span class="koboSpan" id="kobo.532.1">Packt.Analyzers</span></strong><span class="koboSpan" id="kobo.533.1"> and click </span><strong class="bold"><span class="koboSpan" id="kobo.534.1">OK</span></strong><span class="koboSpan" id="kobo.535.1">. </span><span class="koboSpan" id="kobo.535.2">This will allow you to reference your analyzers from the </span><span class="No-Break"><span class="koboSpan" id="kobo.536.1">test project.</span></span></p>
<p><span class="koboSpan" id="kobo.537.1">Next, we’ll need to add a reference to the </span><strong class="bold"><span class="koboSpan" id="kobo.538.1">RoslynTestKit</span></strong><span class="koboSpan" id="kobo.539.1"> NuGet package. </span><span class="koboSpan" id="kobo.539.2">This is a testing framework-agnostic library that lets us unit-test Roslyn Analyzers by extending from certain test fixture classes, as we’ll see in </span><span class="No-Break"><span class="koboSpan" id="kobo.540.1">a moment.</span></span></p>
<p><span class="koboSpan" id="kobo.541.1">Right-click </span><strong class="source-inline"><span class="koboSpan" id="kobo.542.1">Packt.Analyzers.Tests</span></strong><span class="koboSpan" id="kobo.543.1"> and click </span><strong class="bold"><span class="koboSpan" id="kobo.544.1">Manage NuGet Packages…</span></strong><span class="koboSpan" id="kobo.545.1">. </span><span class="koboSpan" id="kobo.545.2">Next, go to the </span><strong class="bold"><span class="koboSpan" id="kobo.546.1">Browse</span></strong><span class="koboSpan" id="kobo.547.1"> tab and </span><span class="No-Break"><span class="koboSpan" id="kobo.548.1">install </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.549.1">SmartAnalyzers.RoslynTestKit</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.550.1">.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.551.1">Troubleshooting installation issues</span></p>
<p class="callout"><span class="koboSpan" id="kobo.552.1">You may encounter a conflict between the latest versions of </span><strong class="source-inline"><span class="koboSpan" id="kobo.553.1">Microsoft.CodeAnalysis</span></strong><span class="koboSpan" id="kobo.554.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.555.1">SmartAnalyzers.RoslynTestKit</span></strong><span class="koboSpan" id="kobo.556.1">. </span><span class="koboSpan" id="kobo.556.2">See this chapter’s final code on GitHub for recommended versions of NuGet packages to resolve </span><span class="No-Break"><span class="koboSpan" id="kobo.557.1">this issue.</span></span></p>
<p><span class="koboSpan" id="kobo.558.1">With the project setup out of the way, let’s create our </span><span class="No-Break"><span class="koboSpan" id="kobo.559.1">test fixture.</span></span></p>
<h2 id="_idParaDest-289"><a id="_idTextAnchor288"/><span class="koboSpan" id="kobo.560.1">Creating AnalyzerTestFixture</span></h2>
<p><span class="koboSpan" id="kobo.561.1">We’ll start by renaming </span><strong class="source-inline"><span class="koboSpan" id="kobo.562.1">UnitTest1.cs</span></strong><span class="koboSpan" id="kobo.563.1"> to </span><strong class="source-inline"><span class="koboSpan" id="kobo.564.1">ToStringAnalyzerTests.cs</span></strong><span class="koboSpan" id="kobo.565.1"> and replacing its</span><a id="_idIndexMarker812"/><span class="koboSpan" id="kobo.566.1"> contents with the </span><span class="No-Break"><span class="koboSpan" id="kobo.567.1">following code:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.568.1">
using Microsoft.CodeAnalysis;
using Microsoft.CodeAnalysis.Diagnostics;
using RoslynTestKit;
namespace Packt.Analyzers.Tests;
public class ToStringAnalyzerTests : AnalyzerTestFixture {
  protected override string LanguageName
    =&gt; LanguageNames.CSharp;
  protected override DiagnosticAnalyzer CreateAnalyzer()
    =&gt; new ToStringAnalyzer();
}</span></pre>
<p><span class="koboSpan" id="kobo.569.1">This class inherits from </span><strong class="source-inline"><span class="koboSpan" id="kobo.570.1">AnalyzerTestFixture</span></strong><span class="koboSpan" id="kobo.571.1"> in </span><strong class="source-inline"><span class="koboSpan" id="kobo.572.1">RoslynTestKit</span></strong><span class="koboSpan" id="kobo.573.1">. </span><span class="koboSpan" id="kobo.573.2">This forces the class to provide the language it works with and a method to create the analyzer we want to test. </span><span class="koboSpan" id="kobo.573.3">Since we’re working with C#, we return </span><strong class="source-inline"><span class="koboSpan" id="kobo.574.1">LanguageNames.CSharp</span></strong><span class="koboSpan" id="kobo.575.1"> for the language. </span><span class="koboSpan" id="kobo.575.2">In </span><strong class="source-inline"><span class="koboSpan" id="kobo.576.1">CreateAnalyzer</span></strong><span class="koboSpan" id="kobo.577.1">, we instantiate and return an instance of our </span><strong class="source-inline"><span class="koboSpan" id="kobo.578.1">ToStringAnalyzer</span></strong><span class="koboSpan" id="kobo.579.1"> from the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.580.1">Packt.Analyzers</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.581.1"> project.</span></span></p>
<p><span class="koboSpan" id="kobo.582.1">This lets </span><strong class="source-inline"><span class="koboSpan" id="kobo.583.1">RoslynTestKit</span></strong><span class="koboSpan" id="kobo.584.1"> know how to create our analyzer and what languages we’re working with, but we haven’t defined a test yet. </span><span class="koboSpan" id="kobo.584.2">Let’s write our first </span><span class="No-Break"><span class="koboSpan" id="kobo.585.1">test now.</span></span></p>
<h2 id="_idParaDest-290"><a id="_idTextAnchor289"/><span class="koboSpan" id="kobo.586.1">Verifying that our Roslyn Analyzer doesn’t flag good code</span></h2>
<p><span class="koboSpan" id="kobo.587.1">Our first test will be to</span><a id="_idIndexMarker813"/><span class="koboSpan" id="kobo.588.1"> ensure that code that doesn’t violate our analyzer won’t get flagged as a rule violation. </span><span class="koboSpan" id="kobo.588.2">We’ll test this by defining a string containing valid code and then verifying that the analyzer didn’t find any issues </span><span class="No-Break"><span class="koboSpan" id="kobo.589.1">with it.</span></span></p>
<p><span class="koboSpan" id="kobo.590.1">We declare the “good” code </span><span class="No-Break"><span class="koboSpan" id="kobo.591.1">as follows:</span></span></p>
<pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.592.1">public const string GoodCode = @"</span></strong><span class="koboSpan" id="kobo.593.1">
using System;
public class Flight
{
  public string Id {get; set;}
  public string DepartAirport {get; set;}
  public string ArriveAirport {get; set;}
  </span><strong class="bold"><span class="koboSpan" id="kobo.594.1">public override string ToString() =&gt; Id;</span></strong><span class="koboSpan" id="kobo.595.1">
}</span><strong class="bold"><span class="koboSpan" id="kobo.596.1">"</span></strong><span class="koboSpan" id="kobo.597.1">;</span></pre>
<p><span class="koboSpan" id="kobo.598.1">This multi-line string</span><a id="_idIndexMarker814"/><span class="koboSpan" id="kobo.599.1"> defines C# for a simple class declaration of a </span><strong class="source-inline"><span class="koboSpan" id="kobo.600.1">Flight</span></strong><span class="koboSpan" id="kobo.601.1"> class, which includes an override of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.602.1">ToString</span></strong><span class="koboSpan" id="kobo.603.1"> method. </span><span class="koboSpan" id="kobo.603.2">Because </span><strong class="source-inline"><span class="koboSpan" id="kobo.604.1">ToString</span></strong><span class="koboSpan" id="kobo.605.1"> is overridden, our rule should not find issues with this </span><span class="No-Break"><span class="koboSpan" id="kobo.606.1">class definition.</span></span></p>
<p><span class="koboSpan" id="kobo.607.1">We can verify this with the </span><span class="No-Break"><span class="koboSpan" id="kobo.608.1">following code:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.609.1">
[Fact]
public void AnalyzerShouldNotFlagGoodCode() {
  </span><strong class="bold"><span class="koboSpan" id="kobo.610.1">NoDiagnostic(GoodCode, ToStringAnalyzer.Rule.Id);</span></strong><span class="koboSpan" id="kobo.611.1">
}</span></pre>
<p><span class="koboSpan" id="kobo.612.1">Here, we use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.613.1">NoDiagnostic</span></strong><span class="koboSpan" id="kobo.614.1"> method from the </span><strong class="source-inline"><span class="koboSpan" id="kobo.615.1">RoslynTestKit's AnalyzerTestFixture</span></strong><span class="koboSpan" id="kobo.616.1"> class to check that the code doesn’t violate </span><span class="No-Break"><span class="koboSpan" id="kobo.617.1">our rule.</span></span></p>
<p><strong class="source-inline"><span class="koboSpan" id="kobo.618.1">RoslynTestKit</span></strong><span class="koboSpan" id="kobo.619.1"> needs to know the ID of the rule we’re checking for, so we use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.620.1">Rule</span></strong><span class="koboSpan" id="kobo.621.1"> property we defined on </span><strong class="source-inline"><span class="koboSpan" id="kobo.622.1">ToStringAnalyzer</span></strong><span class="koboSpan" id="kobo.623.1"> earlier to provide its </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.624.1">id</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.625.1"> value.</span></span></p>
<p><span class="koboSpan" id="kobo.626.1">Now that our test passes without issues, let’s move on to the </span><span class="No-Break"><span class="koboSpan" id="kobo.627.1">second test.</span></span></p>
<h2 id="_idParaDest-291"><a id="_idTextAnchor290"/><span class="koboSpan" id="kobo.628.1">Verifying that our Roslyn Analyzer flags bad code</span></h2>
<p><span class="koboSpan" id="kobo.629.1">To verify that bad code</span><a id="_idIndexMarker815"/><span class="koboSpan" id="kobo.630.1"> triggers the analyzer rule, we’ll use a similar approach: we’ll pass in known bad code and ensure that the rule </span><span class="No-Break"><span class="koboSpan" id="kobo.631.1">is triggered.</span></span></p>
<p><span class="koboSpan" id="kobo.632.1">This is slightly more complicated because we want to make sure the rule is triggered for the right symbol in the code. </span><span class="koboSpan" id="kobo.632.2">So, when we define our bad code, we need to add </span><strong class="source-inline"><span class="koboSpan" id="kobo.633.1">[|</span></strong><span class="koboSpan" id="kobo.634.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.635.1">|]</span></strong><span class="koboSpan" id="kobo.636.1"> markers to denote which</span><a id="_idIndexMarker816"/><span class="koboSpan" id="kobo.637.1"> symbol should be flagged, as </span><span class="No-Break"><span class="koboSpan" id="kobo.638.1">shown here:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.639.1">
public const string BadCode = @"
using System;
public class </span><strong class="bold"><span class="koboSpan" id="kobo.640.1">[|</span></strong><span class="koboSpan" id="kobo.641.1">Flight</span><strong class="bold"><span class="koboSpan" id="kobo.642.1">|]</span></strong><span class="koboSpan" id="kobo.643.1">
{
  public string Id {get; set;}
  public string DepartAirport {get; set;}
  public string ArriveAirport {get; set;}
}";</span></pre>
<p><span class="koboSpan" id="kobo.644.1">This code doesn’t have a </span><strong class="source-inline"><span class="koboSpan" id="kobo.645.1">ToString</span></strong><span class="koboSpan" id="kobo.646.1"> override, so the </span><strong class="source-inline"><span class="koboSpan" id="kobo.647.1">Flight</span></strong><span class="koboSpan" id="kobo.648.1"> class should be flagged as a rule violation. </span><span class="koboSpan" id="kobo.648.2">We can verify this with the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.649.1">HasDiagnostic</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.650.1"> method:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.651.1">
[Fact]
public void AnalyzerShouldFlagViolations() {
  </span><strong class="bold"><span class="koboSpan" id="kobo.652.1">HasDiagnostic(BadCode, ToStringAnalyzer.Rule.Id);</span></strong><span class="koboSpan" id="kobo.653.1">
}</span></pre>
<p><span class="koboSpan" id="kobo.654.1">This code is very similar to our approach to validating good code and will fail if the rule was not triggered or was not triggered explicitly for the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.655.1">Flight</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.656.1"> symbol.</span></span></p>
<p><span class="koboSpan" id="kobo.657.1">We could continue to expand our tests with additional examples and counter-examples, but let’s move on to talking briefly about debugging our </span><span class="No-Break"><span class="koboSpan" id="kobo.658.1">Roslyn Analyzers.</span></span></p>
<h2 id="_idParaDest-292"><a id="_idTextAnchor291"/><span class="koboSpan" id="kobo.659.1">Debugging Roslyn Analyzers</span></h2>
<p><span class="koboSpan" id="kobo.660.1">When you write a </span><a id="_idIndexMarker817"/><span class="koboSpan" id="kobo.661.1">Roslyn Analyzer, it’s unlikely that you’ll get it right the </span><span class="No-Break"><span class="koboSpan" id="kobo.662.1">first time.</span></span></p>
<p><span class="koboSpan" id="kobo.663.1">Unit tests help detect failures in your analyzer, but let’s talk about how you would debug a </span><span class="No-Break"><span class="koboSpan" id="kobo.664.1">Roslyn Analyzer.</span></span></p>
<p><span class="koboSpan" id="kobo.665.1">My recommended approach with Roslyn Analyzers is to follow the approach of this chapter: </span><em class="italic"><span class="koboSpan" id="kobo.666.1">create a class library containing your analyzer and a test project that </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.667.1">tests it</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.668.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.669.1">If your analyzer isn’t properly triggering for certain code, you can put breakpoints in your analyzer code and step through the code for a specific instance by right-clicking on a specific test and selecting </span><strong class="bold"><span class="koboSpan" id="kobo.670.1">Debug</span></strong><span class="koboSpan" id="kobo.671.1">, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.672.1">Figure 13</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.673.1">.7</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.674.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer167">
<span class="koboSpan" id="kobo.675.1"><img alt="Figure 13.7 – Debugging a specific test case" src="image/B21324_13_7.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.676.1">Figure 13.7 – Debugging a specific test case</span></p>
<p><span class="koboSpan" id="kobo.677.1">I’ve found this approach to be generally very helpful when analyzing specific test cases. </span><span class="koboSpan" id="kobo.677.2">In these scenarios, I can see the exact objects the analyzer encounters from the test scenario. </span><span class="koboSpan" id="kobo.677.3">From</span><a id="_idIndexMarker818"/><span class="koboSpan" id="kobo.678.1"> there, I wrote enough code to get the analyzer to handle that scenario. </span><span class="koboSpan" id="kobo.678.2">Once the analyzer has handled that test case, I’m usually at a point where I’m ready to try the analyzer on a wider range of code, which we’ll </span><span class="No-Break"><span class="koboSpan" id="kobo.679.1">discuss next.</span></span></p>
<h1 id="_idParaDest-293"><a id="_idTextAnchor292"/><span class="koboSpan" id="kobo.680.1">Sharing analyzers as Visual Studio extensions</span></h1>
<p><span class="koboSpan" id="kobo.681.1">Once you’re ready to try an analyzer</span><a id="_idIndexMarker819"/><span class="koboSpan" id="kobo.682.1"> on more code or share it with your peers, there are a few </span><span class="No-Break"><span class="koboSpan" id="kobo.683.1">options available:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.684.1">Deploy the analyzer as a NuGet package, as we’ll discuss in the </span><span class="No-Break"><span class="koboSpan" id="kobo.685.1">next chapter</span></span></li>
<li><span class="koboSpan" id="kobo.686.1">Create a </span><strong class="bold"><span class="koboSpan" id="kobo.687.1">Visual Studio Installer</span></strong><span class="koboSpan" id="kobo.688.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.689.1">VSIX</span></strong><span class="koboSpan" id="kobo.690.1">) to install the </span><span class="No-Break"><span class="koboSpan" id="kobo.691.1">analyzers locally</span></span></li>
<li><span class="koboSpan" id="kobo.692.1">Create a new project and add an explicit reference to the analyzers by editing the </span><strong class="source-inline"><span class="koboSpan" id="kobo.693.1">.csproj</span></strong><span class="koboSpan" id="kobo.694.1"> file and adding an </span><strong class="source-inline"><span class="koboSpan" id="kobo.695.1">Analyzer</span></strong><span class="koboSpan" id="kobo.696.1"> node, as </span><span class="No-Break"><span class="koboSpan" id="kobo.697.1">shown here:</span></span></li>
</ul>
<pre class="source-code"><span class="koboSpan" id="kobo.698.1">
&lt;ItemGroup&gt;
</span><strong class="bold"><span class="koboSpan" id="kobo.699.1">  &lt;Analyzer Include="..\some\path\Your.Analyzer.dll" /&gt;</span></strong><span class="koboSpan" id="kobo.700.1">
&lt;/ItemGroup&gt;</span></pre>
<p><span class="koboSpan" id="kobo.701.1">This last approach is one you might consider if you had a large solution and wanted your analyzer to only apply to other projects in that solution. </span><span class="koboSpan" id="kobo.701.2">However, I’ve found this approach to be buggy and</span><a id="_idIndexMarker820"/><span class="koboSpan" id="kobo.702.1"> require frequent reloads of Visual Studio for changes in the analyzers to take hold, so we’ll use the VSIX approach as we close out </span><span class="No-Break"><span class="koboSpan" id="kobo.703.1">this chapter.</span></span></p>
<h2 id="_idParaDest-294"><a id="_idTextAnchor293"/><span class="koboSpan" id="kobo.704.1">Creating a Visual Studio extension (VSIX) for your Roslyn Analyzer</span></h2>
<p><span class="koboSpan" id="kobo.705.1">Visual Studio extension</span><a id="_idIndexMarker821"/><span class="koboSpan" id="kobo.706.1"> projects (VSIX projects) allow you to bundle a diverse set of capabilities into an extension that can then</span><a id="_idIndexMarker822"/><span class="koboSpan" id="kobo.707.1"> be installed into </span><span class="No-Break"><span class="koboSpan" id="kobo.708.1">Visual Studio.</span></span></p>
<p><span class="koboSpan" id="kobo.709.1">Let’s create a new VSIX project, add our analyzer to it, and then use it in a new instance of </span><span class="No-Break"><span class="koboSpan" id="kobo.710.1">Visual Studio.</span></span></p>
<p><span class="koboSpan" id="kobo.711.1">We’ll start as we usually do: by right-clicking on the solution in </span><strong class="bold"><span class="koboSpan" id="kobo.712.1">Solution Explorer</span></strong><span class="koboSpan" id="kobo.713.1">, choosing </span><strong class="bold"><span class="koboSpan" id="kobo.714.1">Add</span></strong><span class="koboSpan" id="kobo.715.1">, and then </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.716.1">New Project…</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.717.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.718.1">Next, select the </span><strong class="bold"><span class="koboSpan" id="kobo.719.1">Empty VSIX Project</span></strong><span class="koboSpan" id="kobo.720.1"> template with C# as the language. </span><span class="koboSpan" id="kobo.720.2">Name this project </span><strong class="source-inline"><span class="koboSpan" id="kobo.721.1">Packt.Analyzers.Installer</span></strong><span class="koboSpan" id="kobo.722.1"> and </span><span class="No-Break"><span class="koboSpan" id="kobo.723.1">click </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.724.1">Create</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.725.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.726.1">This empty project consists of a single </span><strong class="source-inline"><span class="koboSpan" id="kobo.727.1">source.extension.vsixmanifest</span></strong><span class="koboSpan" id="kobo.728.1"> file, which we’ll refer to as the manifest. </span><span class="koboSpan" id="kobo.728.2">This manifest is the only file we’ll need. </span><span class="koboSpan" id="kobo.728.3">Double-click on it to open the designer, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.729.1">Figure 13</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.730.1">.8</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.731.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer168">
<span class="koboSpan" id="kobo.732.1"><img alt="Figure 13.8 – The manifest in the design view" src="image/B21324_13_8.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.733.1">Figure 13.8 – The manifest in the design view</span></p>
<p><span class="koboSpan" id="kobo.734.1">This opens the metadata view, which contains different settings you can configure. </span><span class="koboSpan" id="kobo.734.2">We’ll ignore those and click on the </span><strong class="bold"><span class="koboSpan" id="kobo.735.1">Assets</span></strong><span class="koboSpan" id="kobo.736.1"> blade on the </span><span class="No-Break"><span class="koboSpan" id="kobo.737.1">left sidebar.</span></span></p>
<p><span class="koboSpan" id="kobo.738.1">The </span><strong class="bold"><span class="koboSpan" id="kobo.739.1">Assets</span></strong><span class="koboSpan" id="kobo.740.1"> blade</span><a id="_idIndexMarker823"/><span class="koboSpan" id="kobo.741.1"> specifies the different </span><a id="_idIndexMarker824"/><span class="koboSpan" id="kobo.742.1">components that are included in the extension. </span><span class="koboSpan" id="kobo.742.2">We want to include our analyzer, so click </span><strong class="bold"><span class="koboSpan" id="kobo.743.1">New</span></strong><span class="koboSpan" id="kobo.744.1"> to open the </span><strong class="bold"><span class="koboSpan" id="kobo.745.1">Add New </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.746.1">Asset</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.747.1"> dialogue.</span></span></p>
<p><span class="koboSpan" id="kobo.748.1">Next, specify the </span><strong class="bold"><span class="koboSpan" id="kobo.749.1">Analyzer</span></strong><span class="koboSpan" id="kobo.750.1"> type, use </span><strong class="bold"><span class="koboSpan" id="kobo.751.1">A project in current solution</span></strong><span class="koboSpan" id="kobo.752.1"> as your source, and then select the </span><strong class="source-inline"><span class="koboSpan" id="kobo.753.1">Packt.Analyzers</span></strong><span class="koboSpan" id="kobo.754.1"> project, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.755.1">Figure 13</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.756.1">.9</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.757.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer169">
<span class="koboSpan" id="kobo.758.1"><img alt="Figure 13.9 – Adding the Roslyn Analyzer to your VSIX project as an asset" src="image/B21324_13_9.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.759.1">Figure 13.9 – Adding the Roslyn Analyzer to your VSIX project as an asset</span></p>
<p><span class="koboSpan" id="kobo.760.1">Click </span><strong class="bold"><span class="koboSpan" id="kobo.761.1">OK</span></strong><span class="koboSpan" id="kobo.762.1">; your analyzer should now appear in the list </span><span class="No-Break"><span class="koboSpan" id="kobo.763.1">of assets.</span></span></p>
<p><span class="koboSpan" id="kobo.764.1">With that change, our VSIX project is now ready for us to use. </span><span class="koboSpan" id="kobo.764.2">To test this project, right-click on the </span><strong class="source-inline"><span class="koboSpan" id="kobo.765.1">Packt.Analyzers.Installer</span></strong><span class="koboSpan" id="kobo.766.1"> project and choose </span><strong class="bold"><span class="koboSpan" id="kobo.767.1">Set as Startup Project</span></strong><span class="koboSpan" id="kobo.768.1">. </span><span class="koboSpan" id="kobo.768.2">Next, run your project – a new experimental instance of Visual Studio </span><span class="No-Break"><span class="koboSpan" id="kobo.769.1">will open.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.770.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.771.1">It can take a few minutes for Visual Studio to open after you run the project. </span><span class="koboSpan" id="kobo.771.2">The version of Visual Studio that opens is built specifically for developing extensions and needs additional time to launch. </span><span class="koboSpan" id="kobo.771.3">It is not recommended to use this version of Visual Studio for actual development. </span><span class="koboSpan" id="kobo.771.4">Instead, use it to test your extensions and then </span><span class="No-Break"><span class="koboSpan" id="kobo.772.1">close it.</span></span></p>
<p><span class="koboSpan" id="kobo.773.1">After a few minutes, a new instance of Visual Studio will open with your VSIX project installed. </span><span class="koboSpan" id="kobo.773.2">Using this instance of Visual Studio, you can open any other project and the Roslyn Analyzer you built in this chapter will </span><span class="No-Break"><span class="koboSpan" id="kobo.774.1">be active.</span></span></p>
<p><span class="koboSpan" id="kobo.775.1">Specifically, our </span><a id="_idIndexMarker825"/><span class="koboSpan" id="kobo.776.1">analyzer will show up as a suggestion on classes that don’t override </span><strong class="source-inline"><span class="koboSpan" id="kobo.777.1">ToString</span></strong><span class="koboSpan" id="kobo.778.1">, such as the </span><strong class="source-inline"><span class="koboSpan" id="kobo.779.1">SkillController</span></strong><span class="koboSpan" id="kobo.780.1"> class in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.781.1">Figure 13</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.782.1">.10</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.783.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer170">
<span class="koboSpan" id="kobo.784.1"><img alt="Figure 13.10 – Our Roslyn Analyzer suggests overriding ToString" src="image/B21324_13_10.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.785.1">Figure 13.10 – Our Roslyn Analyzer suggests overriding ToString</span></p>
<p><span class="koboSpan" id="kobo.786.1">Warnings for your analyzer </span><a id="_idIndexMarker826"/><span class="koboSpan" id="kobo.787.1">will also show up in the error list, though if you marked them as having a severity, as we did in the chapter, you’ll need to make sure that messages are displayed in those results. </span><span class="koboSpan" id="kobo.787.2">See the highlighted button in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.788.1">Figure 13</span></em></span><em class="italic"><span class="koboSpan" id="kobo.789.1">.10</span></em><span class="koboSpan" id="kobo.790.1"> for the </span><span class="No-Break"><span class="koboSpan" id="kobo.791.1">message filter.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.792.1">DebuggerDisplay attributes versus ToString overrides</span></p>
<p class="callout"><span class="koboSpan" id="kobo.793.1">This chapter uses </span><strong class="source-inline"><span class="koboSpan" id="kobo.794.1">ToString</span></strong><span class="koboSpan" id="kobo.795.1"> as an example, and overriding </span><strong class="source-inline"><span class="koboSpan" id="kobo.796.1">ToString</span></strong><span class="koboSpan" id="kobo.797.1"> can help with the debugger experience. </span><span class="koboSpan" id="kobo.797.2">An alternative to this would be to add a </span><strong class="source-inline"><span class="koboSpan" id="kobo.798.1">[DebuggerDisplay]</span></strong><span class="koboSpan" id="kobo.799.1"> attribute </span><a id="_idIndexMarker827"/><span class="koboSpan" id="kobo.800.1">above your class definition to describe how it appears in the debugger without needing to </span><span class="No-Break"><span class="koboSpan" id="kobo.801.1">override </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.802.1">ToString</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.803.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.804.1">Once you are satisfied with your test, close the new instance of </span><span class="No-Break"><span class="koboSpan" id="kobo.805.1">Visual Studio.</span></span></p>
<p><span class="koboSpan" id="kobo.806.1">Building and testing your installer will have created a </span><strong class="source-inline"><span class="koboSpan" id="kobo.807.1">Packt.Analyzers.Installer.vsix</span></strong><span class="koboSpan" id="kobo.808.1"> file in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.809.1">bin/Debug</span></strong><span class="koboSpan" id="kobo.810.1"> folder within your extension project. </span><span class="koboSpan" id="kobo.810.2">This </span><strong class="source-inline"><span class="koboSpan" id="kobo.811.1">.vsix</span></strong><span class="koboSpan" id="kobo.812.1"> file will let other people install your custom extension and use your analyzers in </span><span class="No-Break"><span class="koboSpan" id="kobo.813.1">their projects.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.814.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.815.1">You could also distribute your installer on the Visual Studio marketplace. </span><span class="koboSpan" id="kobo.815.2">This would make the extension publicly available and easier for others to locate </span><span class="No-Break"><span class="koboSpan" id="kobo.816.1">and download.</span></span></p>
<p><span class="koboSpan" id="kobo.817.1">Any time you update</span><a id="_idIndexMarker828"/><span class="koboSpan" id="kobo.818.1"> your analyzer, you’ll need to</span><a id="_idIndexMarker829"/><span class="koboSpan" id="kobo.819.1"> share a new version of the extension and your team will need to upgrade. </span><span class="koboSpan" id="kobo.819.2">This makes managing Roslyn Analyzers via </span><strong class="source-inline"><span class="koboSpan" id="kobo.820.1">.vsix</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.821.1">files challenging.</span></span></p>
<p><span class="koboSpan" id="kobo.822.1">Fortunately, NuGet packages offer a better way of sharing Roslyn Analyzers, as we’ll see in the </span><span class="No-Break"><span class="koboSpan" id="kobo.823.1">next chapter.</span></span></p>
<h1 id="_idParaDest-295"><a id="_idTextAnchor294"/><span class="koboSpan" id="kobo.824.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.825.1">In this chapter, we created our first Roslyn Analyzer, tested it with </span><strong class="source-inline"><span class="koboSpan" id="kobo.826.1">RoslynTestKit</span></strong><span class="koboSpan" id="kobo.827.1">, and built a VSIX extension to integrate it into </span><span class="No-Break"><span class="koboSpan" id="kobo.828.1">Visual Studio.</span></span></p>
<p><span class="koboSpan" id="kobo.829.1">We saw how Roslyn Analyzers power all the warnings we interact with in Visual Studio and how you and your team can create new Roslyn Analyzers to detect and flag issues that are unique to your team and </span><span class="No-Break"><span class="koboSpan" id="kobo.830.1">its codebase.</span></span></p>
<p><span class="koboSpan" id="kobo.831.1">In the next chapter, we’ll see how Roslyn Analyzers can be used to fix the issues they find and help safely refactor </span><span class="No-Break"><span class="koboSpan" id="kobo.832.1">your code.</span></span></p>
<h1 id="_idParaDest-296"><a id="_idTextAnchor295"/><span class="koboSpan" id="kobo.833.1">Questions</span></h1>
<ol>
<li><span class="koboSpan" id="kobo.834.1">How do Roslyn </span><span class="No-Break"><span class="koboSpan" id="kobo.835.1">Analyzers work?</span></span></li>
<li><span class="koboSpan" id="kobo.836.1">When would you want to create your own </span><span class="No-Break"><span class="koboSpan" id="kobo.837.1">Roslyn Analyzer?</span></span></li>
<li><span class="koboSpan" id="kobo.838.1">How can you verify that Roslyn Analyzers </span><span class="No-Break"><span class="koboSpan" id="kobo.839.1">work correctly?</span></span></li>
</ol>
<h1 id="_idParaDest-297"><a id="_idTextAnchor296"/><span class="koboSpan" id="kobo.840.1">Further reading</span></h1>
<p><span class="koboSpan" id="kobo.841.1">You can find more information about the topics that were covered in this chapter at </span><span class="No-Break"><span class="koboSpan" id="kobo.842.1">these URLs:</span></span></p>
<ul>
<li><em class="italic"><span class="koboSpan" id="kobo.843.1">Roslyn </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.844.1">Analyzers</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.845.1">: </span></span><a href="https://learn.microsoft.com/en-us/visualstudio/code-quality/roslyn-analyzers-overview"><span class="No-Break"><span class="koboSpan" id="kobo.846.1">https://learn.microsoft.com/en-us/visualstudio/code-quality/roslyn-analyzers-overview</span></span></a></li>
<li><em class="italic"><span class="koboSpan" id="kobo.847.1">Install third-party </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.848.1">analyzers</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.849.1">: </span></span><a href="https://learn.microsoft.com/en-us/visualstudio/code-quality/install-roslyn-analyzers"><span class="No-Break"><span class="koboSpan" id="kobo.850.1">https://learn.microsoft.com/en-us/visualstudio/code-quality/install-roslyn-analyzers</span></span></a></li>
<li><em class="italic"><span class="koboSpan" id="kobo.851.1">Awesome </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.852.1">Roslyn</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.853.1">: </span></span><a href="https://github.com/ironcev/awesome-roslyn"><span class="No-Break"><span class="koboSpan" id="kobo.854.1">https://github.com/ironcev/awesome-roslyn</span></span></a></li>
<li><span class="koboSpan" id="kobo.855.1">.</span><em class="italic"><span class="koboSpan" id="kobo.856.1">NET </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.857.1">Standard</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.858.1">: </span></span><a href="https://learn.microsoft.com/en-us/dotnet/standard/net-standard"><span class="No-Break"><span class="koboSpan" id="kobo.859.1">https://learn.microsoft.com/en-us/dotnet/standard/net-standard</span></span></a></li>
</ul>
<p><span class="koboSpan" id="kobo.860.1">Here are some popular open-source Roslyn Analyzers </span><span class="No-Break"><span class="koboSpan" id="kobo.861.1">on GitHub:</span></span></p>
<ul>
<li><em class="italic"><span class="koboSpan" id="kobo.862.1">Roslyn </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.863.1">Analyzers</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.864.1">: </span></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.865.1">https://github.com/dotnet/roslyn-analyzers</span></em></span></li>
<li><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.866.1">StyleCop</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.867.1">: </span></span><a href="https://github.com/DotNetAnalyzers/StyleCopAnalyzers"><span class="No-Break"><span class="koboSpan" id="kobo.868.1">https://github.com/DotNetAnalyzers/StyleCopAnalyzers</span></span></a></li>
</ul>
</div>
</body></html>