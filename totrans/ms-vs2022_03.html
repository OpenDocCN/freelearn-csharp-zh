<html><head></head><body>
  <div id="_idContainer090">
   <h1 class="chapter-number" id="_idParaDest-52">
    <a id="_idTextAnchor052">
    </a>
    <span class="koboSpan" id="kobo.1.1">
     3
    </span>
   </h1>
   <h1 id="_idParaDest-53">
    <a id="_idTextAnchor053">
    </a>
    <span class="koboSpan" id="kobo.2.1">
     Advanced Code Analysis and Refactoring
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.3.1">
     This chapter elevates our skills by focusing on advanced code analysis and refactoring techniques in Visual
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.4.1">
      Studio 2022.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.5.1">
     Understanding the fundamentals of code analysis, particularly through the lens of static code analysis powered by Roslyn, lays a robust foundation for identifying vulnerabilities and ensuring code correctness.
    </span>
    <span class="koboSpan" id="kobo.5.2">
     Moreover, with built-in IntelliCode, which harnesses machine learning to optimize code bases, you’ll learn how to enhance maintainability and
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.6.1">
      scalability effectively.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.7.1">
     Beyond these foundational concepts, we’ll also delve into the importance of code metrics, providing invaluable insights into evaluating the maintainability and security postures of your projects.
    </span>
    <span class="koboSpan" id="kobo.7.2">
     By using these metrics, you’ll gain the strategic foresight required to make informed decisions and enact targeted enhancements to your
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.8.1">
      code base.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.9.1">
     Throughout this chapter, I’ll illustrate these concepts with real-world code review refactoring case studies.
    </span>
    <span class="koboSpan" id="kobo.9.2">
     By exploring the practical applications of Visual Studio tools, you’ll not only grasp theoretical concepts but also understand how to implement them effectively in your day-to-day
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.10.1">
      development workflows.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.11.1">
     By the end of this chapter, you’ll emerge equipped with the knowledge and required tools to elevate the quality of your code, enhance security practices, and streamline maintenance efforts—all within the familiar and powerful environment of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.12.1">
      Visual Studio.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.13.1">
     In this chapter, we’re going to cover the following
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.14.1">
      main topics:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.15.1">
      Understanding code analysis in
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.16.1">
       Visual Studio
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.17.1">
      Utilizing static code analysis for quality assurance
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.18.1">
       and security
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.19.1">
      Leveraging IntelliCode for
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.20.1">
       code refactoring
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.21.1">
      Using code metrics for maintainability
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.22.1">
       and security
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.23.1">
      Refactoring
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.24.1">
       case studies
      </span>
     </span>
    </li>
   </ul>
   <h1 id="_idParaDest-54">
    <a id="_idTextAnchor054">
    </a>
    <span class="koboSpan" id="kobo.25.1">
     Technical requirements
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.26.1">
     While writing this chapter, I used the following version of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.27.1">
      Visual Studio:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.28.1">
      Visual Studio Enterprise 2022,
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.29.1">
       version
      </span>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.30.1">
       17.12.0
      </span>
     </span>
    </li>
    <li>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.31.1">
       Preview 1.0
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.32.1">
     The code files for this chapter can be found
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.33.1">
      at
     </span>
    </span>
    <a href="https://github.com/PacktPublishing/Mastering-Visual-Studio-2022/tree/main/ch03">
     <span class="No-Break">
      <span class="koboSpan" id="kobo.34.1">
       https://github.com/PacktPublishing/Mastering-Visual-Studio-2022/tree/main/ch03
      </span>
     </span>
    </a>
   </p>
   <h1 id="_idParaDest-55">
    <a id="_idTextAnchor055">
    </a>
    <span class="koboSpan" id="kobo.35.1">
     Understanding code analysis in Visual Studio
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.36.1">
     First, let’s discuss how Visual Studio and .NET work to analyze
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.37.1">
      our code.
     </span>
    </span>
   </p>
   <p>
    <strong class="bold">
     <span class="koboSpan" id="kobo.38.1">
      Code analysis
     </span>
    </strong>
    <span class="koboSpan" id="kobo.39.1">
     in Visual Studio 2022 is designed to help
    </span>
    <a id="_idIndexMarker183">
    </a>
    <span class="koboSpan" id="kobo.40.1">
     us improve the quality of our code.
    </span>
    <span class="koboSpan" id="kobo.40.2">
     It provides several tools and metrics to analyze and enhance code maintainability, readability, and performance.
    </span>
    <span class="koboSpan" id="kobo.40.3">
     By identifying potential issues and suggesting improvements, it aims to streamline the development process, reduce bugs, and improve overall
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.41.1">
      code quality.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.42.1">
     Visual Studio 2022 can perform code analysis in two
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.43.1">
      primary ways:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.44.1">
       Legacy analysis (FxCop static analysis)
      </span>
     </strong>
     <span class="koboSpan" id="kobo.45.1">
      : This method analyzes compiled code to identify issues.
     </span>
     <span class="koboSpan" id="kobo.45.2">
      It’s an old
     </span>
     <a id="_idIndexMarker184">
     </a>
     <span class="koboSpan" id="kobo.46.1">
      approach that
     </span>
     <a id="_idIndexMarker185">
     </a>
     <span class="koboSpan" id="kobo.47.1">
      only checks the code after it has
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.48.1">
       been compiled.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.49.1">
       .NET Compiler Platform-based code analyzers
      </span>
     </strong>
     <span class="koboSpan" id="kobo.50.1">
      : These are modern analyzers that analyze your code live as you
     </span>
     <a id="_idIndexMarker186">
     </a>
     <span class="koboSpan" id="kobo.51.1">
      type.
     </span>
     <span class="koboSpan" id="kobo.51.2">
      They are dynamic
     </span>
     <a id="_idIndexMarker187">
     </a>
     <span class="koboSpan" id="kobo.52.1">
      and can provide real-time feedback, making it easier to catch and fix issues early in the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.53.1">
       development process.
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.54.1">
     Now, let’s delve into the .NET Compiler
    </span>
    <a id="_idIndexMarker188">
    </a>
    <span class="koboSpan" id="kobo.55.1">
     Platform, also known as
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.56.1">
      Roslyn
     </span>
    </strong>
    <span class="koboSpan" id="kobo.57.1">
     , which revolutionizes code analysis capabilities in Visual Studio 2022.
    </span>
    <span class="koboSpan" id="kobo.57.2">
     Roslyn is a platform that exposes the C# and Visual Basic compilers’ code analysis capabilities to developers.
    </span>
    <span class="koboSpan" id="kobo.57.3">
     It provides a set of APIs that allow the creation of tools and applications focused on code analysis, refactoring,
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.58.1">
      and transformation.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.59.1">
     Here’s some benefit
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.60.1">
      of Roslyn:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.61.1">
       Rich language support
      </span>
     </strong>
     <span class="koboSpan" id="kobo.62.1">
      : Roslyn supports the C# and Visual Basic languages, providing comprehensive language
     </span>
     <a id="_idIndexMarker189">
     </a>
     <span class="koboSpan" id="kobo.63.1">
      features and syntax support for building custom developer tools
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.64.1">
       and extensions.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.65.1">
       Programmatic code manipulation
      </span>
     </strong>
     <span class="koboSpan" id="kobo.66.1">
      : With Roslyn, we can programmatically analyze, refactor, and generate code using .NET APIs, empowering them to automate repetitive tasks and improve code quality
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.67.1">
       and consistency.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.68.1">
       IDE extensibility
      </span>
     </strong>
     <span class="koboSpan" id="kobo.69.1">
      : Roslyn enables the development of custom IDE extensions and tools that enhance the functionality of Visual Studio and other .NET IDEs, extending their capabilities to support specialized workflows and
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.70.1">
       development scenarios.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.71.1">
       Open source community
      </span>
     </strong>
     <span class="koboSpan" id="kobo.72.1">
      : Roslyn is an open source project hosted on GitHub that fosters collaboration and contributions from the developer community.
     </span>
     <span class="koboSpan" id="kobo.72.2">
      Developers can contribute enhancements, bug fixes, and new features to the Roslyn code base, driving the innovation and evolution of
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.73.1">
       the platform.
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.74.1">
     Roslyn significantly reduces the difficulty of creating tools and applications focused on code, paving the way for innovation in various domains, including meta-programming, generating and transforming code, integrating interactive features into C# and Visual Basic languages, and embedding these languages into
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.75.1">
      specialized domains.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-56">
    <a id="_idTextAnchor056">
    </a>
    <span class="koboSpan" id="kobo.76.1">
     How Roslyn works
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.77.1">
     Roslyn revolutionizes the
    </span>
    <a id="_idIndexMarker190">
    </a>
    <span class="koboSpan" id="kobo.78.1">
     traditional compiler structure by decomposing it into distinct components.
    </span>
    <span class="koboSpan" id="kobo.78.2">
     Moreover, it provides access to each phase of the compiler pipeline through APIs that mirror the compiler’s
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.79.1">
      internal processes.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.80.1">
     Here’s an illustration of how this mirroring
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.81.1">
      is organized:
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer065">
     <span class="koboSpan" id="kobo.82.1">
      <img alt="Figure 3.1 – Compiler API and Complier Pipeline" src="image/B22218_03_1.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.83.1">
     Figure 3.1 – Compiler API and Complier Pipeline
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.84.1">
     The compiler API and compiler pipeline provide access to several
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.85.1">
      key phases:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.86.1">
       Parse Phase
      </span>
     </strong>
     <span class="koboSpan" id="kobo.87.1">
      : Source code undergoes tokenization and parsing, resulting in a syntax tree that adheres to the
     </span>
     <a id="_idIndexMarker191">
     </a>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.88.1">
       language’s grammar.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.89.1">
       Declaration Phase
      </span>
     </strong>
     <span class="koboSpan" id="kobo.90.1">
      : Declarations
     </span>
     <a id="_idIndexMarker192">
     </a>
     <span class="koboSpan" id="kobo.91.1">
      from both source code and imported metadata are analyzed to construct named symbols.
     </span>
     <span class="koboSpan" id="kobo.91.2">
      These symbols are organized into a hierarchical
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.92.1">
       symbol table.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.93.1">
       Bind Phase
      </span>
     </strong>
     <span class="koboSpan" id="kobo.94.1">
      : Identifiers within the code
     </span>
     <a id="_idIndexMarker193">
     </a>
     <span class="koboSpan" id="kobo.95.1">
      are matched to symbols, generating a semantic model that reflects the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.96.1">
       compiler’s analysis.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.97.1">
       Emit Phase
      </span>
     </strong>
     <span class="koboSpan" id="kobo.98.1">
      : The compiler accumulates
     </span>
     <a id="_idIndexMarker194">
     </a>
     <span class="koboSpan" id="kobo.99.1">
      all relevant information and emits it as an assembly.
     </span>
     <span class="koboSpan" id="kobo.99.2">
      This assembly is represented through an API that
     </span>
     <a id="_idIndexMarker195">
     </a>
     <span class="koboSpan" id="kobo.100.1">
      produces
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.101.1">
       Intermediate Language
      </span>
     </strong>
     <span class="koboSpan" id="kobo.102.1">
      (
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.103.1">
       IL
      </span>
     </strong>
     <span class="koboSpan" id="kobo.104.1">
      )
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.105.1">
       byte code.
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.106.1">
     This modular approach grants comprehensive access to information at each stage of the compiler pipeline.
    </span>
    <span class="koboSpan" id="kobo.106.2">
     It empowers developers with rich capabilities for code analysis and manipulation.
    </span>
    <span class="koboSpan" id="kobo.106.3">
     The availability of three-phase compiler APIs (syntax trees, semantic model, and workspace level) is particularly instrumental in facilitating robust
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.107.1">
      code analysis.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.108.1">
     First, the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.109.1">
      syntax trees
     </span>
    </strong>
    <span class="koboSpan" id="kobo.110.1">
     serve as a foundational
    </span>
    <a id="_idIndexMarker196">
    </a>
    <span class="koboSpan" id="kobo.111.1">
     representation of the structure of source code, encompassing both lexical and syntactic elements.
    </span>
    <span class="koboSpan" id="kobo.111.2">
     They are pivotal in various stages of software development, including compilation, code analysis, binding, refactoring, and IDE functionalities.
    </span>
    <span class="koboSpan" id="kobo.111.3">
     Offering a complete reflection of the source information, syntax trees maintain fidelity with the original text, ensuring immutability and thread safety.
    </span>
    <span class="koboSpan" id="kobo.111.4">
     This facilitates the natural manipulation of source code without direct
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.112.1">
      textual edits.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.113.1">
     Moving to semantics, the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.114.1">
      semantic model
     </span>
    </strong>
    <span class="koboSpan" id="kobo.115.1">
     delves
    </span>
    <a id="_idIndexMarker197">
    </a>
    <span class="koboSpan" id="kobo.116.1">
     deeper into the meaning behind the code.
    </span>
    <span class="koboSpan" id="kobo.116.2">
     It captures all semantic details within a single source file, shedding light on symbol references, expression types, diagnostics (errors and warnings), variable flow within source regions, and other nuanced aspects.
    </span>
    <span class="koboSpan" id="kobo.116.3">
     By encapsulating language rules, this model enables clear distinctions between program elements in source code and those from
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.117.1">
      precompiled libraries.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.118.1">
     At the workspace level, a central hub organizes information across entire solutions, streamlining code analysis and refactoring processes.
    </span>
    <span class="koboSpan" id="kobo.118.2">
     This layer consolidates project data into a cohesive object model, offering seamless access to compiler layer object models without the need for file parsing, configuration adjustments, or inter-project dependency management.
    </span>
    <span class="koboSpan" id="kobo.118.3">
     Crucially, it underpins the development of robust code analysis and refactoring tools within integrated development environments such as
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.119.1">
      Visual Studio.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-57">
    <a id="_idTextAnchor057">
    </a>
    <span class="koboSpan" id="kobo.120.1">
     How does Visual Studio 2022 use Roslyn?
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.121.1">
     Visual Studio 2022 uses the .NET
    </span>
    <a id="_idIndexMarker198">
    </a>
    <span class="koboSpan" id="kobo.122.1">
     Compiler Platform (Roslyn) to analyze and refactor C# or Visual Basic code in real time as developers write code.
    </span>
    <span class="koboSpan" id="kobo.122.2">
     This process is integrated into the development environment, providing
    </span>
    <a id="_idIndexMarker199">
    </a>
    <span class="koboSpan" id="kobo.123.1">
     immediate feedback on code style, quality, maintainability, design, and other issues.
    </span>
    <span class="koboSpan" id="kobo.123.2">
     In the subsequent sections, we’ll learn how Visual Studio 2022 utilizes Roslyn for analysis
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.124.1">
      and refactoring.
     </span>
    </span>
   </p>
   <h3>
    <span class="koboSpan" id="kobo.125.1">
     Analyzing with Roslyn analyzers
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.126.1">
     Visual Studio 2022 includes built-in code style analyzers (IDExxxx, e.g., IDE0001) and code quality analyzers (CAxxxx, e.g., CA1822) that inspect your code during design time in all open files.
    </span>
    <span class="koboSpan" id="kobo.126.2">
     These analyzers are part of the .NET 5 SDK and are enabled
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.127.1">
      by default.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.128.1">
     We can install external
    </span>
    <a id="_idIndexMarker200">
    </a>
    <span class="koboSpan" id="kobo.129.1">
     analyzers, such as
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.130.1">
      StyleCop
     </span>
    </strong>
    <span class="koboSpan" id="kobo.131.1">
     ,
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.132.1">
      Roslynator
     </span>
    </strong>
    <span class="koboSpan" id="kobo.133.1">
     ,
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.134.1">
      XUnit Analyzers
     </span>
    </strong>
    <span class="koboSpan" id="kobo.135.1">
     , and
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.136.1">
      SonarAnalyzer
     </span>
    </strong>
    <span class="koboSpan" id="kobo.137.1">
     , as NuGet packages
    </span>
    <a id="_idIndexMarker201">
    </a>
    <span class="koboSpan" id="kobo.138.1">
     or Visual Studio extensions.
    </span>
    <span class="koboSpan" id="kobo.138.2">
     These
    </span>
    <a id="_idIndexMarker202">
    </a>
    <span class="koboSpan" id="kobo.139.1">
     analyzers extend the built-in
    </span>
    <a id="_idIndexMarker203">
    </a>
    <span class="koboSpan" id="kobo.140.1">
     capabilities, allowing more specialized checks
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.141.1">
      and rules.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.142.1">
     Furthermore, we
    </span>
    <a id="_idIndexMarker204">
    </a>
    <span class="koboSpan" id="kobo.143.1">
     create our own custom analyzer using the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.144.1">
      Analyzer with Code Fix
     </span>
    </strong>
    <span class="koboSpan" id="kobo.145.1">
     template, which includes a
    </span>
    <a id="_idIndexMarker205">
    </a>
    <span class="koboSpan" id="kobo.146.1">
     VSIX extension and a separate project for the analyzer.
    </span>
    <span class="koboSpan" id="kobo.146.2">
     This can be deployed via NuGet.
    </span>
    <span class="koboSpan" id="kobo.146.3">
     That allows us to create our own custom analyzer.
    </span>
    <span class="koboSpan" id="kobo.146.4">
     The analyzer can show a squiggly line below the matching code and an entry in the error list, with optional code fixes.
    </span>
    <span class="koboSpan" id="kobo.146.5">
     This approach allows a more integrated development experience, with feedback and fixes available directly within
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.147.1">
      the IDE.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.148.1">
     For scenarios where analysis does not require integration with Visual Studio, such as on a build server, we can use the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.149.1">
      Standalone Code Analysis Tool
     </span>
    </strong>
    <span class="koboSpan" id="kobo.150.1">
     template.
    </span>
    <span class="koboSpan" id="kobo.150.2">
     This tool opens a solution workspace and analyzes
    </span>
    <a id="_idIndexMarker206">
    </a>
    <span class="koboSpan" id="kobo.151.1">
     projects without requiring VSIX extensions or NuGet packages to be installed in the project
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.152.1">
      or IDE.
     </span>
    </span>
   </p>
   <h3>
    <span class="koboSpan" id="kobo.153.1">
     Refactoring with Roslyn
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.154.1">
     Roslyn’s Syntax API parses C# code into a tree of nodes (class nodes, method nodes, etc.), enabling detailed manipulation of the code structure.
    </span>
    <span class="koboSpan" id="kobo.154.2">
     This API is crucial for automating code refactoring, such as
    </span>
    <a id="_idIndexMarker207">
    </a>
    <span class="koboSpan" id="kobo.155.1">
     automating the migration of applications to .
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.156.1">
      NET Core.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.157.1">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.158.1">
      SyntaxEditor
     </span>
    </strong>
    <span class="koboSpan" id="kobo.159.1">
     class is used to apply changes to the code tree.
    </span>
    <span class="koboSpan" id="kobo.159.2">
     It ensures that when a node is replaced or deleted, all its child nodes are updated accordingly, avoiding contention and exceptions.
    </span>
    <span class="koboSpan" id="kobo.159.3">
     This is particularly useful for refactoring scripts that need to modify the code based on certain patterns
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.160.1">
      or rules.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.161.1">
     The
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.162.1">
      Code Refactoring
     </span>
    </strong>
    <span class="koboSpan" id="kobo.163.1">
     template in Visual Studio
    </span>
    <a id="_idIndexMarker208">
    </a>
    <span class="koboSpan" id="kobo.164.1">
     allows the creation of a VSIX extension that integrates with the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.165.1">
      Quick Actions
     </span>
    </strong>
    <span class="koboSpan" id="kobo.166.1">
     menu in the IDE.
    </span>
    <span class="koboSpan" id="kobo.166.2">
     This enables developers to apply quick code fixes directly from the editor without needing to define additional analyzer IDs or show entries in the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.167.1">
      error list.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.168.1">
     Now that we have learned how Visual Studio uses Roslyn to help us analyze and refactor our code, let’s dive deeper into the use of static code analysis for quality assurance
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.169.1">
      and security.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-58">
    <a id="_idTextAnchor058">
    </a>
    <span class="koboSpan" id="kobo.170.1">
     Utilizing static code analysis for quality assurance and security
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.171.1">
     The built-in
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.172.1">
      code quality analysis
     </span>
    </strong>
    <span class="koboSpan" id="kobo.173.1">
     feature is enabled by default in Visual Studio for projects that target .NET 5 or later.
    </span>
    <span class="koboSpan" id="kobo.173.2">
     However, we can
    </span>
    <a id="_idIndexMarker209">
    </a>
    <span class="koboSpan" id="kobo.174.1">
     enable it for our older .NET project adding and
    </span>
    <a id="_idIndexMarker210">
    </a>
    <span class="koboSpan" id="kobo.175.1">
     setting to
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.176.1">
      true
     </span>
    </strong>
    <span class="koboSpan" id="kobo.177.1">
     the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.178.1">
      EnabeNETAnalyzers
     </span>
    </strong>
    <span class="koboSpan" id="kobo.179.1">
     property in the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.180.1">
      .
     </span>
    </strong>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.181.1">
       csproj
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.182.1">
      file.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.183.1">
     Static code analysis fosters a culture of continuous improvement and collaboration within development teams.
    </span>
    <span class="koboSpan" id="kobo.183.2">
     By providing actionable insights and recommendations, these tools facilitate constructive code reviews, foster knowledge sharing, and ultimately elevate the skill and proficiency
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.184.1">
      of developers.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-59">
    <a id="_idTextAnchor059">
    </a>
    <span class="koboSpan" id="kobo.185.1">
     Understanding how to use code analysis in Visual Studio
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.186.1">
     The code quality analysis will inspect our
    </span>
    <a id="_idIndexMarker211">
    </a>
    <span class="koboSpan" id="kobo.187.1">
     codebase for security, performance, design, and other potential areas for improvement.
    </span>
    <span class="koboSpan" id="kobo.187.2">
     By default, the analysis runs automatically, so we can see errors, warnings, and information directly when we are typing through squiggles under our code or on the error
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.188.1">
      list windows.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.189.1">
     If we write code like the one shown in
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.190.1">
       Figure 3
      </span>
     </em>
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.191.1">
      .2
     </span>
    </em>
    <span class="koboSpan" id="kobo.192.1">
     , we will see
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.193.1">
      squiggles appear:
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer066">
     <span class="koboSpan" id="kobo.194.1">
      <img alt="Figure 3.2 – Information squiggles" src="image/B22218_03_2.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.195.1">
     Figure 3.2 – Information squiggles
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.196.1">
     In this example, the analyzer informs us that our
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.197.1">
      using
     </span>
    </strong>
    <span class="koboSpan" id="kobo.198.1">
     statement can be simplified according to the feature introduced by
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.199.1">
      C# 8.0.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.200.1">
     The analysis rules are organized into categories: Design, Documentation, Globalization, Portability and Interoperability, Maintainability, Naming, Performance, Reliability, Security, Style, and Usage.
    </span>
    <span class="koboSpan" id="kobo.200.2">
     You can find detailed information about each rule category in the Microsoft
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.201.1">
      documentation:
     </span>
    </span>
    <a href="https://learn.microsoft.com/en-us/dotnet/fundamentals/code-analysis/categories">
     <span class="No-Break">
      <span class="koboSpan" id="kobo.202.1">
       https://learn.microsoft.com/en-us/dotnet/fundamentals/code-analysis/categories
      </span>
     </span>
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.203.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.204.1">
     Each rule has a severity
    </span>
    <a id="_idIndexMarker212">
    </a>
    <span class="koboSpan" id="kobo.205.1">
     level that determines
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.206.1">
      its behavior:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.207.1">
       Default
      </span>
     </strong>
     <span class="koboSpan" id="kobo.208.1">
      : This is the default severity level for rules that are enabled but do not have a specific severity set.
     </span>
     <span class="koboSpan" id="kobo.208.2">
      It typically means that the rule is active and will report issues, but the exact behavior (e.g., whether it’s treated as a warning, error, or suggestion) depends on the rule’s configuration or the default behavior of
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.209.1">
       the tool.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.210.1">
       Error
      </span>
     </strong>
     <span class="koboSpan" id="kobo.211.1">
      : When a rule is set to the Error severity level, any violation of the rule will be reported as an error.
     </span>
     <span class="koboSpan" id="kobo.211.2">
      This means that the code will not be compiled until the issue is resolved.
     </span>
     <span class="koboSpan" id="kobo.211.3">
      Errors are typically used for critical issues that must be fixed before the code can be
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.212.1">
       considered correct.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.213.1">
       Warning
      </span>
     </strong>
     <span class="koboSpan" id="kobo.214.1">
      : A rule set to Warning will report violations as warnings.
     </span>
     <span class="koboSpan" id="kobo.214.2">
      Warnings do not prevent the code from compiling, but they are typically used to indicate potential issues that should be addressed to improve code quality or maintainability.
     </span>
     <span class="koboSpan" id="kobo.214.3">
      Warnings can be configured to be treated as errors in certain build configurations, allowing developers to enforce stricter standards for
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.215.1">
       production code.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.216.1">
       Suggestion
      </span>
     </strong>
     <span class="koboSpan" id="kobo.217.1">
      : Rules with the Suggestion severity level report issues that are not critical but could improve the code.
     </span>
     <span class="koboSpan" id="kobo.217.2">
      These rules are typically used for stylistic issues or practices that are not required but are recommended.
     </span>
     <span class="koboSpan" id="kobo.217.3">
      Suggestions are often used in conjunction with code fixes that automatically apply the recommended changes, making it easier for developers to improve their
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.218.1">
       code quality.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.219.1">
       Silent
      </span>
     </strong>
     <span class="koboSpan" id="kobo.220.1">
      : A rule set to Silent will not report any issues, effectively disabling the rule.
     </span>
     <span class="koboSpan" id="kobo.220.2">
      This is useful for rules that are not relevant to your project or when you want to temporarily disable a rule without removing it from
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.221.1">
       your configuration.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.222.1">
       None
      </span>
     </strong>
     <span class="koboSpan" id="kobo.223.1">
      : This severity
     </span>
     <a id="_idIndexMarker213">
     </a>
     <span class="koboSpan" id="kobo.224.1">
      level is like Silent but is used to explicitly indicate that a rule should not be applied.
     </span>
     <span class="koboSpan" id="kobo.224.2">
      It’s a way to make the intention clear that the rule is
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.225.1">
       intentionally disabled.
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.226.1">
     Let’s see how we can use the level of severity to enhance the quality of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.227.1">
      our project.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-60">
    <a id="_idTextAnchor060">
    </a>
    <span class="koboSpan" id="kobo.228.1">
     Adjusting the level of severity
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.229.1">
     We can adjust the severity level of rules by right-clicking on the suggestion through the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.230.1">
      Error List
     </span>
    </strong>
    <span class="koboSpan" id="kobo.231.1">
     and selecting
    </span>
    <span class="No-Break">
     <strong class="bold">
      <span class="koboSpan" id="kobo.232.1">
       Set Severity
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.233.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.234.1">
     This allows us to prioritize and
    </span>
    <a id="_idIndexMarker214">
    </a>
    <span class="koboSpan" id="kobo.235.1">
     customize how Visual Studio presents and addresses potential issues identified by the rules.
    </span>
    <span class="koboSpan" id="kobo.235.2">
     Depending on the project’s requirements and development context, adjusting the severity levels can focus attention on critical issues while minimizing distractions from less
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.236.1">
      impactful ones.
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer067">
     <span class="koboSpan" id="kobo.237.1">
      <img alt="Figure 3.3 – The Set severity option" src="image/B22218_03_3.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.238.1">
     Figure 3.3 – The Set severity option
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.239.1">
     This action generates an
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.240.1">
      .editorconfig
     </span>
    </strong>
    <span class="koboSpan" id="kobo.241.1">
     file in our solution’s root containing the overridden severity rule, which we can share with our team to ensure consistent
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.242.1">
      coding practices.
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer068">
     <span class="koboSpan" id="kobo.243.1">
      <img alt="Figure 3.4 – .editorconfig file generated" src="image/B22218_03_4.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.244.1">
     Figure 3.4 – .editorconfig file generated
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.245.1">
     An alternative method of
    </span>
    <a id="_idIndexMarker215">
    </a>
    <span class="koboSpan" id="kobo.246.1">
     adjusting the severity level is through the
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.247.1">
      light bulb
     </span>
    </em>
    <span class="koboSpan" id="kobo.248.1">
     context menu, which also offers code fixes through
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.249.1">
      Quick Actions.
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer069">
     <span class="koboSpan" id="kobo.250.1">
      <img alt="Figure 3.5 – Setting the severity using the light bulb" src="image/B22218_03_5.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.251.1">
     Figure 3.5 – Setting the severity using the light bulb
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.252.1">
     During a code review, we
    </span>
    <a id="_idIndexMarker216">
    </a>
    <span class="koboSpan" id="kobo.253.1">
     might encounter practices that could be improved, as shown in
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.254.1">
       Figure 3
      </span>
     </em>
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.255.1">
       .6
      </span>
     </em>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.256.1">
      .
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer070">
     <span class="koboSpan" id="kobo.257.1">
      <img alt="Figure 3.6 – Pyramid code" src="image/B22218_03_6.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.258.1">
     Figure 3.6 – Pyramid code
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.259.1">
     For instance, a pyramid code
    </span>
    <a id="_idIndexMarker217">
    </a>
    <span class="koboSpan" id="kobo.260.1">
     structure might not trigger a squiggle, but the IDE might suggest simplifying an
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.261.1">
      if
     </span>
    </strong>
    <span class="koboSpan" id="kobo.262.1">
     statement (
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.263.1">
      IDE0046
     </span>
    </strong>
    <span class="koboSpan" id="kobo.264.1">
     ).
    </span>
    <span class="koboSpan" id="kobo.264.2">
     If you want to enforce a specific coding standard, you can set the severity level of this rule
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.265.1">
      to
     </span>
    </span>
    <span class="No-Break">
     <strong class="bold">
      <span class="koboSpan" id="kobo.266.1">
       Error
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.267.1">
      .
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer071">
     <span class="koboSpan" id="kobo.268.1">
      <img alt="Figure 3.7 – Change the severity level of IDE0046" src="image/B22218_03_7.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.269.1">
     Figure 3.7 – Change the severity level of IDE0046
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.270.1">
     Likewise, when we and our teammates encounter this rule, we are forced to refactor our code.
    </span>
    <span class="koboSpan" id="kobo.270.2">
     We can notice that Visual Studio provides four code fixes for
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.271.1">
      this Rule:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.272.1">
       Convert to a conditional expression
      </span>
     </strong>
     <span class="koboSpan" id="kobo.273.1">
      : This fix transforms an
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.274.1">
       if-else
      </span>
     </strong>
     <span class="koboSpan" id="kobo.275.1">
      statement into a conditional (
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.276.1">
       ternary) expression.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.277.1">
       Invert if
      </span>
     </strong>
     <span class="koboSpan" id="kobo.278.1">
      : This fix inverts the condition of an if statement and swaps the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.279.1">
       code blocks.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.280.1">
       Convert to a switch statement
      </span>
     </strong>
     <span class="koboSpan" id="kobo.281.1">
      : This fix is applicable when you have multiple conditions based on the same variable or expression.
     </span>
     <span class="koboSpan" id="kobo.281.2">
      It converts an if-else chain into a switch statement, which is more readable and maintainable for such case, like handling multiple conditions based on the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.282.1">
       same variable.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.283.1">
       Convert to a switch expression
      </span>
     </strong>
     <span class="koboSpan" id="kobo.284.1">
      : Like converting to a
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.285.1">
       switch
      </span>
     </strong>
     <span class="koboSpan" id="kobo.286.1">
      statement, this fix converts an
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.287.1">
       if-else
      </span>
     </strong>
     <span class="koboSpan" id="kobo.288.1">
      chain into a
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.289.1">
       switch
      </span>
     </strong>
     <span class="koboSpan" id="kobo.290.1">
      expression, which is a more concise and functional way to handle multiple conditions.
     </span>
     <span class="koboSpan" id="kobo.290.2">
      It’s available in C# 8.0
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.291.1">
       and later.
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.292.1">
     For better readability, I prefer to
    </span>
    <a id="_idIndexMarker218">
    </a>
    <span class="koboSpan" id="kobo.293.1">
     use Invert if in this example, but the IDE0046 rule force is used to turn it into a conditional expression.
    </span>
    <span class="koboSpan" id="kobo.293.2">
     Keep in mind that this is just an example, and we can adapt the level of severity of the analysis rules in our solution according to
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.294.1">
      our needs.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.295.1">
     As we have seen, adjusting the severity level generates a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.296.1">
      .editorConfig
     </span>
    </strong>
    <span class="koboSpan" id="kobo.297.1">
     file containing our custom configurations.
    </span>
    <span class="koboSpan" id="kobo.297.2">
     Let’s explore how we can generate such a file to easily share our Visual Studio settings with
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.298.1">
      our team.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-61">
    <a id="_idTextAnchor061">
    </a>
    <span class="koboSpan" id="kobo.299.1">
     Generating a .editorconfig file
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.300.1">
     What I recommend if you work in a
    </span>
    <a id="_idIndexMarker219">
    </a>
    <span class="koboSpan" id="kobo.301.1">
     team environment is
    </span>
    <a id="_idIndexMarker220">
    </a>
    <span class="koboSpan" id="kobo.302.1">
     to generate a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.303.1">
      .editorconfig
     </span>
    </strong>
    <span class="koboSpan" id="kobo.304.1">
     file that you can tweak according to
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.305.1">
      your needs.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.306.1">
     To generate a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.307.1">
      .editorconfig
     </span>
    </strong>
    <span class="koboSpan" id="kobo.308.1">
     file, we
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.309.1">
      right-click
     </span>
    </em>
    <span class="koboSpan" id="kobo.310.1">
     on our solution, and in the contextual menu, select
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.311.1">
      Add
     </span>
    </strong>
    <span class="koboSpan" id="kobo.312.1">
     |
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.313.1">
      New
     </span>
    </strong>
    <span class="No-Break">
     <strong class="bold">
      <span class="koboSpan" id="kobo.314.1">
       Editor Config
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.315.1">
      .
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer072">
     <span class="koboSpan" id="kobo.316.1">
      <img alt="Figure 3.8 – New EditorConfig" src="image/B22218_03_8.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.317.1">
     Figure 3.8 – New EditorConfig
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.318.1">
     This will generate a new
    </span>
    <a id="_idIndexMarker221">
    </a>
    <span class="koboSpan" id="kobo.319.1">
     file that will contain all configurations of our IDE.
    </span>
    <span class="koboSpan" id="kobo.319.2">
     In this file, we will retrieve all the rules of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.320.1">
      the
     </span>
    </span>
    <span class="No-Break">
     <strong class="bold">
      <span class="koboSpan" id="kobo.321.1">
       Analyzer
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.322.1">
      .
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer073">
     <span class="koboSpan" id="kobo.323.1">
      <img alt="Figure 3.9 – EditorConfig Analyzer" src="image/B22218_03_9.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.324.1">
     Figure 3.9 – EditorConfig Analyzer
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.325.1">
     This allows us to list and set the severity level of each
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.326.1">
      rule easily.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.327.1">
     Here, we can see that Visual
    </span>
    <a id="_idIndexMarker222">
    </a>
    <span class="koboSpan" id="kobo.328.1">
     Studio Analyzer provides 94 rules about security.
    </span>
    <span class="koboSpan" id="kobo.328.2">
     These rules cover all the topics of the OWASP Top Ten and more.
    </span>
    <span class="koboSpan" id="kobo.328.3">
     The OWASP Top 10 serves as a widely recognized reference
    </span>
    <a id="_idIndexMarker223">
    </a>
    <span class="koboSpan" id="kobo.329.1">
     document for developers and web application security, highlighting the most significant security vulnerabilities faced by web applications based on a collective agreement within
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.330.1">
      the industry.
     </span>
    </span>
   </p>
   <p class="callout-heading">
    <span class="koboSpan" id="kobo.331.1">
     Further reading
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.332.1">
     We can find all the security rules in
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.333.1">
      Microsoft documentation:
     </span>
    </span>
   </p>
   <p class="callout">
    <a href="https://learn.microsoft.com/en-us/visualstudio/code-quality/security-rules-rule-set-for-managed-code?view=vs-2019&amp;viewFallbackFrom=vs-2022">
     <span class="No-Break">
      <span class="koboSpan" id="kobo.334.1">
       https://learn.microsoft.com/en-us/visualstudio/code-quality/security-rules-rule-set-for-managed-code?view=vs-2019&amp;viewFallbackFrom=vs-2022
      </span>
     </span>
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.335.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.336.1">
     Now that we have learned how we can use static code analysis, let’s dive into a new feature.
    </span>
    <span class="koboSpan" id="kobo.336.2">
     Indeed, Visual Studio 2022 now integrates IntelliCode as a built-in feature, available to all subscriptions.
    </span>
    <span class="koboSpan" id="kobo.336.3">
     Let’s explore how it works and how we can leverage
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.337.1">
      its capabilities.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-62">
    <a id="_idTextAnchor062">
    </a>
    <span class="koboSpan" id="kobo.338.1">
     Leveraging IntelliCode for code refactoring
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.339.1">
     As developers, we need to
    </span>
    <a id="_idIndexMarker224">
    </a>
    <span class="koboSpan" id="kobo.340.1">
     constantly refactor our code to improve its structure, readability, or performance, especially when we are working with TDD, with respect to the flow explained in
    </span>
    <a href="B22218_01.xhtml#_idTextAnchor015">
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.341.1">
        Chapter 1
       </span>
      </em>
     </span>
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.342.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.343.1">
     One tool that has significantly
    </span>
    <a id="_idIndexMarker225">
    </a>
    <span class="koboSpan" id="kobo.344.1">
     enhanced our refactoring process is
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.345.1">
      IntelliCode
     </span>
    </strong>
    <span class="koboSpan" id="kobo.346.1">
     , which uses artificial intelligence and machine learning to offer intelligent suggestions and automate repetitive tasks.
    </span>
    <span class="koboSpan" id="kobo.346.2">
     IntelliCode is now integrated into Visual Studio 2022 for C#.
    </span>
    <span class="koboSpan" id="kobo.346.3">
     In this section, we’ll explore strategies for effective code refactoring using IntelliCode, drawing from our experience
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.347.1">
      and insight.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.348.1">
     First of all, we need to ensure that we have IntelliCode installed in our Visual Studio by going to the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.349.1">
      Options
     </span>
    </strong>
    <span class="koboSpan" id="kobo.350.1">
     menu through the top bar menu, which is
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.351.1">
      Tools
     </span>
    </strong>
    <span class="koboSpan" id="kobo.352.1">
     |
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.353.1">
      Options
     </span>
    </strong>
    <span class="koboSpan" id="kobo.354.1">
     |
    </span>
    <span class="No-Break">
     <strong class="bold">
      <span class="koboSpan" id="kobo.355.1">
       IntelliCode
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.356.1">
      .
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer074">
     <span class="koboSpan" id="kobo.357.1">
      <img alt="Figure 3.10 – IntelliCode Options" src="image/B22218_03_10.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.358.1">
     Figure 3.10 – IntelliCode Options
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.359.1">
     If you can't find IntelliCode in the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.360.1">
      Options
     </span>
    </strong>
    <span class="koboSpan" id="kobo.361.1">
     menu, install it with your Visual Studio Installer by ticking the
    </span>
    <span class="No-Break">
     <strong class="bold">
      <span class="koboSpan" id="kobo.362.1">
       IntelliCode
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.363.1">
      checkbox.
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer075">
     <span class="koboSpan" id="kobo.364.1">
      <img alt="Figure 3.11 – Visual Studio Installer IntelliCode" src="image/B22218_03_11.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.365.1">
     Figure 3.11 – Visual Studio Installer IntelliCode
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.366.1">
     Now that we’ve ensured that
    </span>
    <a id="_idIndexMarker226">
    </a>
    <span class="koboSpan" id="kobo.367.1">
     IntelliCode is enabled in Visual Studio, let’s
    </span>
    <a id="_idIndexMarker227">
    </a>
    <span class="koboSpan" id="kobo.368.1">
     explore how it can enhance our
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.369.1">
      coding experience.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-63">
    <a id="_idTextAnchor063">
    </a>
    <span class="koboSpan" id="kobo.370.1">
     Predicting code with whole-line autocompletion
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.371.1">
     IntelliCode, introduced in Visual Studio 2022, provides
    </span>
    <a id="_idIndexMarker228">
    </a>
    <span class="koboSpan" id="kobo.372.1">
     whole-line autocompletion with suggestions.
    </span>
    <span class="koboSpan" id="kobo.372.2">
     This feature is designed to streamline the development process, improve code quality, and
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.373.1">
      increase productivity.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.374.1">
     The following image shows
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.375.1">
      whole-line autocompletion:
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer076">
     <span class="koboSpan" id="kobo.376.1">
      <img alt="Figure 3.12 – Whole-line autocompletion from typing" src="image/B22218_03_12.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.377.1">
     Figure 3.12 – Whole-line autocompletion from typing
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.378.1">
     In
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.379.1">
       Figure 3
      </span>
     </em>
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.380.1">
      .12
     </span>
    </em>
    <span class="koboSpan" id="kobo.381.1">
     , we can see
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.382.1">
      gray text line prediction
     </span>
    </em>
    <span class="koboSpan" id="kobo.383.1">
     generated according to the context.
    </span>
    <span class="koboSpan" id="kobo.383.2">
     The prediction is
    </span>
    <a id="_idIndexMarker229">
    </a>
    <span class="koboSpan" id="kobo.384.1">
     based on a large amount of public, open source GitHub repositories.
    </span>
    <span class="koboSpan" id="kobo.384.2">
     The IntelliCode suggestions are seamlessly integrated with those from in the IntelliSense.
    </span>
    <span class="koboSpan" id="kobo.384.3">
     These IntelliCode recommendations are highlighted and easily indentifiable by the
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.385.1">
      black star
     </span>
    </em>
    <span class="koboSpan" id="kobo.386.1">
     icon located on the left of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.387.1">
      the suggestion.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.388.1">
     If we select another suggestion than one provided by the whole-line autocompletion, IntelliCode generates a new prediction according to
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.389.1">
      our choice.
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer077">
     <span class="koboSpan" id="kobo.390.1">
      <img alt="Figure 3.13 – Whole-line autocompletion from IntelliSense" src="image/B22218_03_13.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.391.1">
     Figure 3.13 – Whole-line autocompletion from IntelliSense
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.392.1">
     To accept the whole-line autocompletion, we just need to press
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.393.1">
      Tab
     </span>
    </em>
    <span class="koboSpan" id="kobo.394.1">
     or click on the
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.395.1">
      arrow
     </span>
    </em>
    <span class="koboSpan" id="kobo.396.1">
     that pops above the suggestion.
    </span>
    <span class="koboSpan" id="kobo.396.2">
     We can press
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.397.1">
      Esc
     </span>
    </em>
    <span class="koboSpan" id="kobo.398.1">
     or
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.399.1">
      Delete
     </span>
    </em>
    <span class="koboSpan" id="kobo.400.1">
     to
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.401.1">
      dismiss it.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.402.1">
     IntelliCode runs locally on the machine, providing whole-line autocompletion, which enhances code security and consideration for properties, unlike ChatGPT and other AI predictions tools, which are
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.403.1">
      generated inline.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.404.1">
     Now that we’ve seen
    </span>
    <a id="_idIndexMarker230">
    </a>
    <span class="koboSpan" id="kobo.405.1">
     how IntelliCode can help us generate code, let’s explore how it can assist us in understanding the code by providing direct access
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.406.1">
      to documentation.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-64">
    <a id="_idTextAnchor064">
    </a>
    <span class="koboSpan" id="kobo.407.1">
     Accessing GitHub documentation
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.408.1">
     When using external libraries or nuggets, we can
    </span>
    <a id="_idIndexMarker231">
    </a>
    <span class="koboSpan" id="kobo.409.1">
     encounter methods that we don’t know how to use efficiently.
    </span>
    <span class="koboSpan" id="kobo.409.2">
     IntelliCode provides a helpful feature called
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.410.1">
      API Usage Examples
     </span>
    </strong>
    <span class="koboSpan" id="kobo.411.1">
     , which provides practical examples of how to use
    </span>
    <a id="_idIndexMarker232">
    </a>
    <span class="koboSpan" id="kobo.412.1">
     these
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.413.1">
      methods effectively.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.414.1">
     To activate this feature, go to the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.415.1">
      Options
     </span>
    </strong>
    <span class="koboSpan" id="kobo.416.1">
     menu (see
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.417.1">
       Figure 3
      </span>
     </em>
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.418.1">
      .10
     </span>
    </em>
    <span class="koboSpan" id="kobo.419.1">
     ) and tick
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.420.1">
      Enable API
     </span>
    </strong>
    <span class="No-Break">
     <strong class="bold">
      <span class="koboSpan" id="kobo.421.1">
       Usage Examples
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.422.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.423.1">
     Now, we can hover our cursor on the method we want to know more about, and we get a link labeled
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.424.1">
      GitHub Examples
     </span>
    </strong>
    <span class="No-Break">
     <strong class="bold">
      <span class="koboSpan" id="kobo.425.1">
       and Documentation
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.426.1">
      :
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer078">
     <span class="koboSpan" id="kobo.427.1">
      <img alt="Figure 3.14 – GitHub Examples and Documentation link" src="image/B22218_03_14.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.428.1">
     Figure 3.14 – GitHub Examples and Documentation link
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.429.1">
     Upon clicking on the link (
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.430.1">
      GitHub Examples and Documentation
     </span>
    </strong>
    <span class="koboSpan" id="kobo.431.1">
     ), a side pin window opens with an example of the implementation of the method through several
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.432.1">
      GitHub repositories:
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer079">
     <span class="koboSpan" id="kobo.433.1">
      <img alt="Figure 3.15 – GitHub examples" src="image/B22218_03_15.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.434.1">
     Figure 3.15 – GitHub examples
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.435.1">
     This feature helps us to plan our refactoring according to the examples of implementation in other projects, using the experience of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.436.1">
      other developers.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.437.1">
     In the next section, let’s dive
    </span>
    <a id="_idIndexMarker233">
    </a>
    <span class="koboSpan" id="kobo.438.1">
     into code metrics, which point to the areas of our project where we need to do some refactoring to improve maintainability
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.439.1">
      and quality.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-65">
    <a id="_idTextAnchor065">
    </a>
    <span class="koboSpan" id="kobo.440.1">
     Code metrics, maintainability, and security
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.441.1">
     As developers, we rely on
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.442.1">
      code metrics
     </span>
    </strong>
    <span class="koboSpan" id="kobo.443.1">
     to evaluate the quality of a software system.
    </span>
    <span class="koboSpan" id="kobo.443.2">
     These quantitative measures provide insights into
    </span>
    <a id="_idIndexMarker234">
    </a>
    <span class="koboSpan" id="kobo.444.1">
     various aspects of our code, such as complexity, maintainability, and security.
    </span>
    <span class="koboSpan" id="kobo.444.2">
     By understanding these metrics, we can identify areas that may need improvement, ensuring that our code base remains manageable, secure,
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.445.1">
      and efficient.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-66">
    <a id="_idTextAnchor066">
    </a>
    <span class="koboSpan" id="kobo.446.1">
     Understanding the metrics
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.447.1">
     Visual Studio allows us to generate a report containing a list of metrics, such as
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.448.1">
      the following:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.449.1">
       Maintainability Index
      </span>
     </strong>
     <span class="koboSpan" id="kobo.450.1">
      assesses how easy it is to maintain code, giving a score from 0 to 100, where higher scores indicate
     </span>
     <a id="_idIndexMarker235">
     </a>
     <span class="koboSpan" id="kobo.451.1">
      better maintainability.
     </span>
     <span class="koboSpan" id="kobo.451.2">
      Ratings are color-coded: green (20-100) for
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.452.1">
       good
      </span>
     </em>
     <span class="koboSpan" id="kobo.453.1">
      , yellow (10-19) for
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.454.1">
       moderate
      </span>
     </em>
     <span class="koboSpan" id="kobo.455.1">
      , and red (0-9)
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.456.1">
       for
      </span>
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.457.1">
        low
       </span>
      </em>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.458.1">
       .
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.459.1">
       Cyclomatic Complexity
      </span>
     </strong>
     <span class="koboSpan" id="kobo.460.1">
      measures a
     </span>
     <a id="_idIndexMarker236">
     </a>
     <span class="koboSpan" id="kobo.461.1">
      code’s structural complexity by counting its different flow paths.
     </span>
     <span class="koboSpan" id="kobo.461.2">
      High complexity suggests more tests are needed for good coverage and
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.462.1">
       lower maintainability.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.463.1">
       Depth of Inheritance
      </span>
     </strong>
     <span class="koboSpan" id="kobo.464.1">
      gauges how
     </span>
     <a id="_idIndexMarker237">
     </a>
     <span class="koboSpan" id="kobo.465.1">
      many classes inherit from one another, with lower values being better to prevent
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.466.1">
       widespread changes.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.467.1">
       Class Coupling
      </span>
     </strong>
     <span class="koboSpan" id="kobo.468.1">
      measures how tightly
     </span>
     <a id="_idIndexMarker238">
     </a>
     <span class="koboSpan" id="kobo.469.1">
      classes are connected, with high coupling indicating
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.470.1">
       poor design.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.471.1">
       Lines of Source Code
      </span>
     </strong>
     <span class="koboSpan" id="kobo.472.1">
      counts all lines in a source file, while
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.473.1">
       Lines of Executable Code
      </span>
     </strong>
     <span class="koboSpan" id="kobo.474.1">
      approximates the
     </span>
     <a id="_idIndexMarker239">
     </a>
     <span class="koboSpan" id="kobo.475.1">
      number of
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.476.1">
       executable lines.
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.477.1">
     Now that we understand the metrics, let’s delve
    </span>
    <a id="_idIndexMarker240">
    </a>
    <span class="koboSpan" id="kobo.478.1">
     deeper into how to use them through
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.479.1">
      Visual Studio.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-67">
    <a id="_idTextAnchor067">
    </a>
    <span class="koboSpan" id="kobo.480.1">
     Using code metrics in Visual Studio 2022
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.481.1">
     Visual Studio 2022 provides a
    </span>
    <a id="_idIndexMarker241">
    </a>
    <span class="koboSpan" id="kobo.482.1">
     powerful suite of tools for
    </span>
    <a id="_idIndexMarker242">
    </a>
    <span class="koboSpan" id="kobo.483.1">
     analyzing code metrics.
    </span>
    <span class="koboSpan" id="kobo.483.2">
     Here are two ways to
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.484.1">
      use them:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.485.1">
      In the top bar menu, select
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.486.1">
       Analyze
      </span>
     </strong>
     <span class="koboSpan" id="kobo.487.1">
      |
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.488.1">
       Calculate Code Metrics
      </span>
     </strong>
     <span class="koboSpan" id="kobo.489.1">
      and choose if you want to calculate the metrics on a specific project or on
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.490.1">
       the solution
      </span>
     </span>
    </li>
   </ul>
   <div>
    <div class="IMG---Figure" id="_idContainer080">
     <span class="koboSpan" id="kobo.491.1">
      <img alt="Figure 3.16 – Calculate Code Metrics from the top menu" src="image/B22218_03_16.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.492.1">
     Figure 3.16 – Calculate Code Metrics from the top menu
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.493.1">
      Alternatively, you can
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.494.1">
       right-click
      </span>
     </em>
     <span class="koboSpan" id="kobo.495.1">
      directly on the solution or project you want to measure and, from the contextual menu, choose
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.496.1">
       Analyze and Code Cleanup
      </span>
     </strong>
     <span class="koboSpan" id="kobo.497.1">
      |
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.498.1">
       Calculate
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.499.1">
        Code Metrics
       </span>
      </strong>
     </span>
    </li>
   </ul>
   <div>
    <div class="IMG---Figure" id="_idContainer081">
     <span class="koboSpan" id="kobo.500.1">
      <img alt="Figure 3.17 – Calculate Code Metrics for a project" src="image/B22218_03_17.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.501.1">
     Figure 3.17 – Calculate Code Metrics for a project
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.502.1">
     After the analysis is complete, a
    </span>
    <a id="_idIndexMarker243">
    </a>
    <span class="koboSpan" id="kobo.503.1">
     window will open displaying the code
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.504.1">
      metrics results:
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer082">
     <span class="koboSpan" id="kobo.505.1">
      <img alt="Figure 3.18 – Code Metrics Results" src="image/B22218_03_18.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.506.1">
     Figure 3.18 – Code Metrics Results
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.507.1">
     Here, we can view metrics
    </span>
    <a id="_idIndexMarker244">
    </a>
    <span class="koboSpan" id="kobo.508.1">
     such as
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.509.1">
      Cyclomatic Complexity
     </span>
    </strong>
    <span class="koboSpan" id="kobo.510.1">
     ,
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.511.1">
      Depth of Inheritance
     </span>
    </strong>
    <span class="koboSpan" id="kobo.512.1">
     ,
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.513.1">
      Class Coupling
     </span>
    </strong>
    <span class="koboSpan" id="kobo.514.1">
     ,
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.515.1">
      Lines of Source code
     </span>
    </strong>
    <span class="koboSpan" id="kobo.516.1">
     , and
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.517.1">
      Lines of Executable code
     </span>
    </strong>
    <span class="koboSpan" id="kobo.518.1">
     .
    </span>
    <span class="koboSpan" id="kobo.518.2">
     We can apply a custom filter to clamp the result between the minimum and maximum values for a metric.
    </span>
    <span class="koboSpan" id="kobo.518.3">
     Furthermore, for better manipulation of the data, we can export the code metric results to an
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.519.1">
      Excel file.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.520.1">
     Understanding and utilizing code metrics is essential for maintaining high-quality software.
    </span>
    <span class="koboSpan" id="kobo.520.2">
     Visual Studio 2022 provides powerful tools for analyzing code metrics, helping developers identify and address issues relating to security and maintainability.
    </span>
    <span class="koboSpan" id="kobo.520.3">
     By focusing on these aspects, developers
    </span>
    <a id="_idIndexMarker245">
    </a>
    <span class="koboSpan" id="kobo.521.1">
     can ensure that their code bases remain robust, secure, and easy
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.522.1">
      to manage.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.523.1">
     In this section, we’ve
    </span>
    <a id="_idIndexMarker246">
    </a>
    <span class="koboSpan" id="kobo.524.1">
     navigated through tools that identify parts of code that need improvement and used IntelliCode for refactoring.
    </span>
    <span class="koboSpan" id="kobo.524.2">
     In the final section, let’s delve into a practical use case
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.525.1">
      of refactoring.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-68">
    <a id="_idTextAnchor068">
    </a>
    <span class="koboSpan" id="kobo.526.1">
     Refactoring case studies
    </span>
   </h1>
   <p>
    <strong class="bold">
     <span class="koboSpan" id="kobo.527.1">
      Refactoring
     </span>
    </strong>
    <span class="koboSpan" id="kobo.528.1">
     entails restructuring code while preserving its initial functionality.
    </span>
    <span class="koboSpan" id="kobo.528.2">
     The objective is to enhance the internal structure through incremental modifications without affecting the code’s external behavior.
    </span>
    <span class="koboSpan" id="kobo.528.3">
     To
    </span>
    <a id="_idIndexMarker247">
    </a>
    <span class="koboSpan" id="kobo.529.1">
     check the integrity of our code, we use unit tests (see
    </span>
    <a href="B22218_01.xhtml#_idTextAnchor015">
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.530.1">
        Chapter 1
       </span>
      </em>
     </span>
    </a>
    <span class="koboSpan" id="kobo.531.1">
     of this book).
    </span>
    <span class="koboSpan" id="kobo.531.2">
     Refactoring is the last step in the test-driven
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.532.1">
      design process.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.533.1">
     This section showcases a small piece of code containing bad practices.
    </span>
    <span class="koboSpan" id="kobo.533.2">
     We will see how to fix these issues efficiently with the help of Visual Studio.
    </span>
    <span class="koboSpan" id="kobo.533.3">
     Remember that norms and practices must be discussed with all teams and can change from one team
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.534.1">
      to another.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-69">
    <a id="_idTextAnchor069">
    </a>
    <span class="koboSpan" id="kobo.535.1">
     Handling common bad practice
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.536.1">
     Here’s a code with bad naming and a
    </span>
    <a id="_idIndexMarker248">
    </a>
    <span class="koboSpan" id="kobo.537.1">
     condition check that can be
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.538.1">
      easily simplified:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.539.1">
    public static bool canregister(int age)
    {
        if(age &gt; 18)
        {
            return true;
        }
        else
        {
            return false;
        }
    }</span></pre>
   <p>
    <span class="koboSpan" id="kobo.540.1">
     We will use the
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.541.1">
      light bulb
     </span>
    </em>
    <span class="koboSpan" id="kobo.542.1">
     to fix the
    </span>
    <a id="_idIndexMarker249">
    </a>
    <span class="koboSpan" id="kobo.543.1">
     naming violation (
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.544.1">
      IDE1006
     </span>
    </strong>
    <span class="koboSpan" id="kobo.545.1">
     ) provided by the live
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.546.1">
      code analyzer:
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer083">
     <span class="koboSpan" id="kobo.547.1">
      <img alt="Figure 3.19 – Fixing the name violation" src="image/B22218_03_19.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.548.1">
     Figure 3.19 – Fixing the name violation
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.549.1">
     After that, we can simplify the age check with the
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.550.1">
       light bulb
      </span>
     </em>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.551.1">
      :
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer084">
     <span class="koboSpan" id="kobo.552.1">
      <img alt="Figure 3.20 – Simplifying the age check" src="image/B22218_03_20.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.553.1">
     Figure 3.20 – Simplifying the age check
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.554.1">
     We can see that the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.555.1">
      Preview changes
     </span>
    </strong>
    <span class="koboSpan" id="kobo.556.1">
     window allows us to be more aggressive in fixing all occurrences in the different levels of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.557.1">
      our solution.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.558.1">
     Next, as our method
    </span>
    <a id="_idIndexMarker250">
    </a>
    <span class="koboSpan" id="kobo.559.1">
     contains only
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.560.1">
      return
     </span>
    </strong>
    <span class="koboSpan" id="kobo.561.1">
     , we can improve the readability by turning it into an
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.562.1">
      expression body
     </span>
    </strong>
    <span class="koboSpan" id="kobo.563.1">
     (a concise way to define the body of a method).
    </span>
    <span class="koboSpan" id="kobo.563.2">
     We will use the
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.564.1">
      screwdriver
     </span>
    </em>
    <span class="koboSpan" id="kobo.565.1">
     to
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.566.1">
      do this:
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer085">
     <span class="koboSpan" id="kobo.567.1">
      <img alt="Figure 3.21 – Using an expression body" src="image/B22218_03_21.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.568.1">
     Figure 3.21 – Using an expression body
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.569.1">
     The last bad practice to handle is the usage of the magic number.
    </span>
    <span class="koboSpan" id="kobo.569.2">
     A magic number refers to a numeric literal that appears directly in the source code without any explanation of its meaning or purpose.
    </span>
    <span class="koboSpan" id="kobo.569.3">
     It can be challenging to change or understand without proper context.
    </span>
    <span class="koboSpan" id="kobo.569.4">
     So, we will introduce a
    </span>
    <a id="_idIndexMarker251">
    </a>
    <span class="koboSpan" id="kobo.570.1">
     constant with a human-readable name to explain the purpose of this number.
    </span>
    <span class="koboSpan" id="kobo.570.2">
     We will once again use the
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.571.1">
      light bulb
     </span>
    </em>
    <span class="koboSpan" id="kobo.572.1">
     to
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.573.1">
      do this:
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer086">
     <span class="koboSpan" id="kobo.574.1">
      <img alt="Figure 3.22 – Introducing a constant" src="image/B22218_03_22.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.575.1">
     Figure 3.22 – Introducing a constant
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.576.1">
     Now we get a simple expression body, which is well named, and one that respects clean
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.577.1">
      code practices.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-70">
    <a id="_idTextAnchor070">
    </a>
    <span class="koboSpan" id="kobo.578.1">
     Generating an interface
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.579.1">
     For instance, imagine we
    </span>
    <a id="_idIndexMarker252">
    </a>
    <span class="koboSpan" id="kobo.580.1">
     get a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.581.1">
      AirTraffic
     </span>
    </strong>
    <span class="koboSpan" id="kobo.582.1">
     class with a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.583.1">
      RegisterAircraft
     </span>
    </strong>
    <span class="koboSpan" id="kobo.584.1">
     method.
    </span>
    <span class="koboSpan" id="kobo.584.2">
     Now to add abstraction to our code we want to create an
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.585.1">
      IAirTraffic
     </span>
    </strong>
    <span class="koboSpan" id="kobo.586.1">
     interface.
    </span>
    <span class="koboSpan" id="kobo.586.2">
     We’ll use the
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.587.1">
      screwdriver
     </span>
    </em>
    <span class="koboSpan" id="kobo.588.1">
     to effortlessly extract
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.589.1">
      the interface.
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer087">
     <span class="koboSpan" id="kobo.590.1">
      <img alt="Figure 3.23 – Extracting an interface" src="image/B22218_03_23.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.591.1">
     Figure 3.23 – Extracting an interface
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.592.1">
     This will open a window with
    </span>
    <a id="_idIndexMarker253">
    </a>
    <span class="koboSpan" id="kobo.593.1">
     options to allow us to choose the configuration of our interface.
    </span>
    <span class="koboSpan" id="kobo.593.2">
     We will keep the default choices to create the interface in a new file,
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.594.1">
      named
     </span>
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.595.1">
       IairTraffic.cs
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.596.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.597.1">
     Now, we are adding a new method,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.598.1">
      SendMessage
     </span>
    </strong>
    <span class="koboSpan" id="kobo.599.1">
     , and we want it to belong to the interface as well.
    </span>
    <span class="koboSpan" id="kobo.599.2">
     Again, we can use the
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.600.1">
      screwdriver
     </span>
    </em>
    <span class="koboSpan" id="kobo.601.1">
     to pull the new method up to
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.602.1">
      the interface:
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer088">
     <span class="koboSpan" id="kobo.603.1">
      <img alt="Figure 3.24 – Pulling the method up to interface" src="image/B22218_03_24.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.604.1">
     Figure 3.24 – Pulling the method up to interface
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.605.1">
     This refactoring ensures that all classes implementing
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.606.1">
      IAirTraffic
     </span>
    </strong>
    <span class="koboSpan" id="kobo.607.1">
     will have access to the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.608.1">
      SendMessage
     </span>
    </strong>
    <span class="koboSpan" id="kobo.609.1">
     method, promoting a consistent interface and
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.610.1">
      code reuse.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-71">
    <a id="_idTextAnchor071">
    </a>
    <span class="koboSpan" id="kobo.611.1">
     File-scoping our namespace
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.612.1">
     The
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.613.1">
      file-scoped namespace
     </span>
    </strong>
    <span class="koboSpan" id="kobo.614.1">
     feature, introduced in
    </span>
    <a id="_idIndexMarker254">
    </a>
    <span class="koboSpan" id="kobo.615.1">
     C# 10, offers a more concise approach to declaring namespaces.
    </span>
    <span class="koboSpan" id="kobo.615.2">
     It eliminates the need for curly braces to enclose the namespace body, streamlining the syntax and
    </span>
    <a id="_idIndexMarker255">
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.616.1">
      enhancing readability.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.617.1">
     By default, when we create classes in Visual Studio, it uses the older version of namespace, which wraps the entire content of the file using curly braces.
    </span>
    <span class="koboSpan" id="kobo.617.2">
     We can add a semicolon at the end of the declaration of the namespace and Visual Studio will automatically understand that you want to turn it in
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.618.1">
      file-scoped namespace.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.619.1">
     To avoid this repetitive action, we can set file-scoped namespace as the default in Visual Studio by using the top menu bar: select
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.620.1">
      Tools
     </span>
    </strong>
    <span class="koboSpan" id="kobo.621.1">
     |
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.622.1">
      Options
     </span>
    </strong>
    <span class="koboSpan" id="kobo.623.1">
     |
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.624.1">
      Text Editor
     </span>
    </strong>
    <span class="koboSpan" id="kobo.625.1">
     |
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.626.1">
      C#
     </span>
    </strong>
    <span class="koboSpan" id="kobo.627.1">
     |
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.628.1">
      Code Style
     </span>
    </strong>
    <span class="koboSpan" id="kobo.629.1">
     |
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.630.1">
      General
     </span>
    </strong>
    <span class="koboSpan" id="kobo.631.1">
     and change the namespace declaration value to
    </span>
    <span class="No-Break">
     <strong class="bold">
      <span class="koboSpan" id="kobo.632.1">
       File scoped
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.633.1">
      :
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer089">
     <span class="koboSpan" id="kobo.634.1">
      <img alt="Figure 3.25 – Making namespace declarations file scoped" src="image/B22218_03_25.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.635.1">
     Figure 3.25 – Making namespace declarations file scoped
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.636.1">
     If we work in teams, we can generate the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.637.1">
      .editorconfig
     </span>
    </strong>
    <span class="koboSpan" id="kobo.638.1">
     file directly for the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.639.1">
      Options
     </span>
    </strong>
    <span class="koboSpan" id="kobo.640.1">
     window by clicking on the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.641.1">
      Generate .editor file from setting
     </span>
    </strong>
    <span class="koboSpan" id="kobo.642.1">
     option, as we can see in
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.643.1">
       Figure 3
      </span>
     </em>
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.644.1">
       .25
      </span>
     </em>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.645.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.646.1">
     If we already have a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.647.1">
      .editorconfig
     </span>
    </strong>
    <span class="koboSpan" id="kobo.648.1">
     file, (created manually or generated by changing the severity level, as seen in the
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.649.1">
      Utilizing static code analysis for quality assurance and security
     </span>
    </em>
    <span class="koboSpan" id="kobo.650.1">
     section in this chapter), we can add the following line to set namespace declarations
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.651.1">
      to
     </span>
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.652.1">
       file_scoped
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.653.1">
      :
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.654.1">
csharp_style_namespace_declarations = file_scoped</span></pre>
   <p>
    <span class="koboSpan" id="kobo.655.1">
     If we want Visual Studio to trigger
    </span>
    <a id="_idIndexMarker256">
    </a>
    <span class="koboSpan" id="kobo.656.1">
     compile-time errors when file-scoped namespaces are not used, the syntax would be
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.657.1">
      as follows:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.658.1">
csharp_style_namespace_declarations = file_scoped:error</span></pre>
   <p>
    <span class="koboSpan" id="kobo.659.1">
     This allows us to commit the configuration to our Git repository, ensuring it’s shared with
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.660.1">
      our team.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-72">
    <a id="_idTextAnchor072">
    </a>
    <span class="koboSpan" id="kobo.661.1">
     Summary
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.662.1">
     In this chapter, we explored the inner workings of Roslyn within Visual Studio 2022, empowering developers to use its capabilities fully.
    </span>
    <span class="koboSpan" id="kobo.662.2">
     By mastering static code analysis, we can enhance quality assurance and security measures in our projects through nuanced control over severity levels and generating
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.663.1">
      .editorconfig
     </span>
    </strong>
    <span class="koboSpan" id="kobo.664.1">
     files and spreading them to
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.665.1">
      our team.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.666.1">
     We saw how IntelliCode redefines productivity, offering predictive coding via whole-line autocompletion and seamless access to
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.667.1">
      GitHub documentation.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.668.1">
     We navigated code metrics of maintainability and security, which equip us with invaluable insights that allow us to evaluate and improve code bases.
    </span>
    <span class="koboSpan" id="kobo.668.2">
     Armed with Visual Studio 2022’s built-in tools, projects can be optimized for long-term sustainability
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.669.1">
      and robustness.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.670.1">
     We concluded this chapter with practical refactoring case studies, addressing common pitfalls and demonstrating techniques such as interface generation and namespace refinement.
    </span>
    <span class="koboSpan" id="kobo.670.2">
     By analyzing real-world scenarios, we gained hands-on experience in applying advanced
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.671.1">
      refactoring principles.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.672.1">
     In the following chapter, we explore strategies for identifying performance bottlenecks, optimizing code execution, and leveraging Visual Studio 2022’s profiling tools to ensure peak performance in
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.673.1">
      our applications.
     </span>
    </span>
   </p>
  </div>
 </body></html>