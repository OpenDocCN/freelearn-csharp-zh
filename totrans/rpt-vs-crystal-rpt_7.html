<html><head></head><body><div class="chapter" title="Chapter&#xA0;7.&#xA0;Working with Charts"><div class="titlepage"><div><div><h1 class="title"><a id="ch07"/>Chapter 7. Working with Charts</h1></div></div></div><p>In this chapter we will see how to use charts in Crystal Reports. Crystal Reports<a id="id168" class="indexterm"/> supports many types of charts but we will create four reports that contain different samples of charts.</p><p>We will cover:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Types of charts</li><li class="listitem" style="list-style-type: disc">Creating charts</li><li class="listitem" style="list-style-type: disc">Using the Chart Expert</li></ul></div><p>We will use the same <a id="id169" class="indexterm"/>data table in our reports and see how to display this data in different charts. The first report will display data in a bar chart as we can see in the following screenshot:</p><div class="mediaobject"><img src="graphics/8026EN_07_01.jpg" alt="Working with Charts"/></div><p>The second report will display data in a pie chart<a id="id170" class="indexterm"/> as we can see in the following screenshot:</p><div class="mediaobject"><img src="graphics/8026EN_07_02.jpg" alt="Working with Charts"/></div><p>The third report will display data in a gauge chart<a id="id171" class="indexterm"/> as we can see in the following screenshot:</p><div class="mediaobject"><img src="graphics/8026EN_07_03.jpg" alt="Working with Charts"/></div><p>In the final report, we will see how to display different charts in one report. Refer to the following screenshot:</p><div class="mediaobject"><img src="graphics/8026EN_07_04.jpg" alt="Working with Charts"/></div><div class="section" title="Creating the reports data source"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec37"/>Creating the reports data source</h1></div></div></div><p>In this section we will <a id="id172" class="indexterm"/>create the data source that we will use in all the reports in this chapter. All the reports in this chapter display the relation between employees and orders. These reports display the number of orders for each employee.</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">The SQL query that we will use in our report looks like the following screenshot:<div class="mediaobject"><img src="graphics/8026EN_07_05.jpg" alt="Creating the reports data source"/></div></li><li class="listitem">We will <a id="id173" class="indexterm"/>create a new TableAdapter using the previous SQL query and we will name it <code class="literal">EmployeeOrdersTableAdapter</code>, as shown the following screenshot:<div class="mediaobject"><img src="graphics/8026EN_07_06.jpg" alt="Creating the reports data source"/></div></li></ol></div></div></div>
<div class="section" title="Creating the first report &#x2013; bar chart"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec38"/>Creating the first report – bar chart</h1></div></div></div><p>Let's start to create the first <a id="id174" class="indexterm"/>chart report. We will start with a bar chart.</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Add a new Crystal Reports to our application and name it <code class="literal">crEmpPerBar</code>. We will choose the <span class="strong"><strong>As a Blank Report</strong></span> option to see how we can add or modify our chart at any time after the report creation.</li><li class="listitem">Right-click on <span class="strong"><strong>Database Fields</strong></span> in <span class="strong"><strong>Field Explorer</strong></span> and select the <span class="strong"><strong>Database Expert</strong></span> option. As shown in the following screenshot, we will select our TableAdapter <span class="strong"><strong>EmployeeOrders</strong></span> as a data source:<div class="mediaobject"><img src="graphics/8026EN_07_07.jpg" alt="Creating the first report – bar chart"/></div></li><li class="listitem">Right-click on the<a id="id175" class="indexterm"/> report and navigate to <span class="strong"><strong>Insert</strong></span> | <span class="strong"><strong>Chart</strong></span> and drag it in <span class="strong"><strong>Section1 (Report Header)</strong></span>. As we can see in the following screenshot, in the <span class="strong"><strong>Type</strong></span> tab we will select <span class="strong"><strong>Bar</strong></span> as a chart type and <span class="strong"><strong>Side by side bar chart</strong></span> as the type of bar chart, from the submenu that comes up in the right window:<div class="mediaobject"><img src="graphics/8026EN_07_08.jpg" alt="Creating the first report – bar chart"/></div></li><li class="listitem">Navigate to the<a id="id176" class="indexterm"/> <span class="strong"><strong>Data</strong></span> tab as we can see in the following screenshot:<div class="mediaobject"><img src="graphics/8026EN_07_09.jpg" alt="Creating the first report – bar chart"/></div></li><li class="listitem">In this<a id="id177" class="indexterm"/> step we will see how to display data in a bar chart. We need to display the name of the employee on the X-axis and the numbers of orders on the Y-axis. We will add the <span class="strong"><strong>EmployeeOrders.fullName</strong></span> field to the upper-right list to display it on the X-axis and add the <span class="strong"><strong>EmployeeOrders.Quantity</strong></span> field to the lower list to display it on the Y-axis. We can display only a specific number of employees using the <span class="strong"><strong>TopN</strong></span> button as we have seen before in <span class="strong"><strong>Cross-Tab</strong></span>. We will keep the other options in the other tabs and click on the <span class="strong"><strong>OK</strong></span> button.</li><li class="listitem">We want to filter the orders by a period of date so we will add two filter parameters to our report with type <span class="strong"><strong>Date</strong></span>. We will name the first parameter <code class="literal">pmFrom</code> and the second one <code class="literal">pmTo</code>. Have a look at the following screenshot to see the filter code:<div class="mediaobject"><img src="graphics/8026EN_07_10.jpg" alt="Creating the first report – bar chart"/></div></li><li class="listitem">Go to the <a id="id178" class="indexterm"/>main form and double-click on the <span class="strong"><strong>btnBarChart</strong></span> button (<span class="strong"><strong>Bar chart</strong></span>) to navigate to the code window behind it. Write the code as shown in the following screenshot for the <code class="literal">click</code> event:<div class="mediaobject"><img src="graphics/8026EN_07_11.jpg" alt="Creating the first report – bar chart"/></div></li><li class="listitem">Run the application to test the result. Enter the <span class="strong"><strong>from</strong></span> and <span class="strong"><strong>to</strong></span> dates as shown in the following screenshot:<div class="mediaobject"><img src="graphics/8026EN_07_12.jpg" alt="Creating the first report – bar chart"/></div></li><li class="listitem">Click on the <span class="strong"><strong>Bar chart</strong></span> button to see the report result as shown in the following screenshot:<div class="mediaobject"><img src="graphics/8026EN_07_13.jpg" alt="Creating the first report – bar chart"/></div></li></ol></div><p>Now we will see how to update our report to get the required report, which we designed at the beginning of this chapter.</p><div class="section" title="Removing the legend"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec26"/>Removing the legend</h2></div></div></div><p>The legend is the <a id="id179" class="indexterm"/>box that appears on the right side as shown in the previous screenshot; by default it's displayed beside the chart. In the following steps we will see how to remove it:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Right-click on the chart and navigate to <span class="strong"><strong>Chart Options</strong></span> | <span class="strong"><strong>General</strong></span>. Navigate to the <span class="strong"><strong>Legend</strong></span> tab as shown in the following screenshot:<div class="mediaobject"><img src="graphics/8026EN_07_14.jpg" alt="Removing the legend"/></div></li><li class="listitem">Uncheck the <span class="strong"><strong>Show Legend</strong></span> checkbox. The dialog has many options that you can use. Try <a id="id180" class="indexterm"/>to change these options and test the result. Click on the <span class="strong"><strong>OK</strong></span> button.</li></ol></div></div><div class="section" title="Removing the chart's title"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec27"/>Removing the chart's title</h2></div></div></div><p>In the next few steps we will see how to<a id="id181" class="indexterm"/> remove or change the default chart title:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Right-click on our chart and navigate to <span class="strong"><strong>Chart Options</strong></span> | <span class="strong"><strong>Titles</strong></span>, as shown in the following screenshot:<div class="mediaobject"><img src="graphics/8026EN_07_15.jpg" alt="Removing the chart's title"/></div></li><li class="listitem">Clear the <span class="strong"><strong>Title</strong></span> textbox and the <span class="strong"><strong>Group Title</strong></span> textbox. Click on the <span class="strong"><strong>OK</strong></span> button.</li></ol></div></div><div class="section" title="Changing the chart's appearance"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec28"/>Changing the chart's appearance</h2></div></div></div><p>The Crystal Reports allows us to <a id="id182" class="indexterm"/>modify the appearance of our charts to meet the user requirements. In the following steps we will see how to achieve this:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Right-click on our chart and navigate to <span class="strong"><strong>Chart Options</strong></span> | <span class="strong"><strong>General</strong></span>.</li><li class="listitem">Navigate to the <span class="strong"><strong>Appearance</strong></span> tab; update the appearance properties as shown in the following screenshot:<div class="mediaobject"><img src="graphics/8026EN_07_16.jpg" alt="Changing the chart's appearance"/></div></li><li class="listitem">Select the<a id="id183" class="indexterm"/> <span class="strong"><strong>Use Depth</strong></span> checkbox. Change the <span class="strong"><strong>Depth</strong></span> value as shown in the preceding screenshot.</li><li class="listitem">Resize the chart size in the report to fit the report width.</li><li class="listitem">Run the application to test the result; we will see that the report is the same as the one we had designed before.</li></ol></div></div></div>
<div class="section" title="Creating the second report &#x2013; pie chart"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec39"/>Creating the second report – pie chart</h1></div></div></div><p>The second chart report that we will <a id="id184" class="indexterm"/>create is a pie chart. Let's start the work:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Add a new Crystal Reports to our application and name it <code class="literal">crEmpPerPie</code>. We will choose the <span class="strong"><strong>As a Blank Report</strong></span> option.</li><li class="listitem">Right-click on <span class="strong"><strong>Database Fields</strong></span> in <span class="strong"><strong>Field Explorer</strong></span> and select <span class="strong"><strong>Database Expert</strong></span>. We will choose our TableAdapter <span class="strong"><strong>EmployeeOrders</strong></span> as a data source.</li><li class="listitem">Right-click on the report and navigate to <span class="strong"><strong>Insert</strong></span> | <span class="strong"><strong>Chart</strong></span> and drag it in <span class="strong"><strong>Section1 (Report Header)</strong></span>. As shown in the following screenshot, in the <span class="strong"><strong>Type</strong></span> tab we will select <span class="strong"><strong>Pie</strong></span> as a chart type:<div class="mediaobject"><img src="graphics/8026EN_07_17.jpg" alt="Creating the second report – pie chart"/></div></li><li class="listitem">Move to the <a id="id185" class="indexterm"/><span class="strong"><strong>Data</strong></span> tab and select the data fields as we did in the previous report. Click on the <span class="strong"><strong>OK</strong></span> button.</li><li class="listitem">Add two <span class="strong"><strong>date</strong></span> filters as we did in the previous report.</li><li class="listitem">Go to the main form and double-click on the <span class="strong"><strong>btnPieChart</strong></span> button (<span class="strong"><strong>Pie chart</strong></span>) to navigate to the code window behind it. Write the code as shown in the following screenshot for the <code class="literal">click</code> event:<div class="mediaobject"><img src="graphics/8026EN_07_18.jpg" alt="Creating the second report – pie chart"/></div></li><li class="listitem">Run the application to test the result. We will see the report result as shown in the following screenshot:<div class="mediaobject"><img src="graphics/8026EN_07_19.jpg" alt="Creating the second report – pie chart"/></div></li></ol></div><p>Now we will see how to update our report to meet the required report that we designed at the beginning of this chapter.</p><div class="section" title="Removing the legend"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec29"/>Removing the legend</h2></div></div></div><p>In the next few steps <a id="id186" class="indexterm"/>we will remove the legend as we did before with the bar chart:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Right-click on our chart and navigate to <span class="strong"><strong>Chart Options</strong></span> | <span class="strong"><strong>General</strong></span>.</li><li class="listitem">Navigate to the <span class="strong"><strong>Legend</strong></span> tab.</li><li class="listitem">Unselect the <span class="strong"><strong>Show Legend</strong></span> checkbox.</li><li class="listitem">Click on the <span class="strong"><strong>OK</strong></span> button.</li></ol></div></div><div class="section" title="Removing the chart's title"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec30"/>Removing the chart's title</h2></div></div></div><p>In the next few steps we will<a id="id187" class="indexterm"/> remove the chart's title again, as we did before with the bar chart.</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Right-click on our chart and navigate to <span class="strong"><strong>Chart Options</strong></span> | <span class="strong"><strong>Titles</strong></span>.</li><li class="listitem">Clear the <span class="strong"><strong>Title</strong></span> textbox.</li><li class="listitem">Click on the <span class="strong"><strong>OK</strong></span> button.</li></ol></div></div><div class="section" title="Changing the chart's appearance"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec31"/>Changing the chart's appearance</h2></div></div></div><p>We will change the chart's <a id="id188" class="indexterm"/>appearance as we did before with the bar chart by performing the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Right-click on our chart and navigate to <span class="strong"><strong>Chart Options</strong></span> | <span class="strong"><strong>General</strong></span>.</li><li class="listitem">Navigate to the <span class="strong"><strong>Appearance</strong></span> tab; update the appearance properties as shown in the following screenshot:<div class="mediaobject"><img src="graphics/8026EN_07_20.jpg" alt="Changing the chart's appearance"/></div></li><li class="listitem">Resize the<a id="id189" class="indexterm"/> chart size in the report to fit the report width.</li></ol></div></div></div>
<div class="section" title="Creating the third report &#x2013; gauge chart"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec40"/>Creating the third report – gauge chart</h1></div></div></div><p>The next chart report that we will<a id="id190" class="indexterm"/> create is a gauge chart report. Let's start:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Add a new Crystal Reports to our application and name it <code class="literal">crEmpPerGauge</code>. We will choose the <span class="strong"><strong>As a Blank Report</strong></span> option.</li><li class="listitem">Right-click on <span class="strong"><strong>Database Fields</strong></span> in <span class="strong"><strong>Field Explorer</strong></span> and navigate to <span class="strong"><strong>Database Expert</strong></span>. We will choose our TableAdapter <span class="strong"><strong>EmployeeOrders</strong></span> as a data source.</li><li class="listitem">Right-click on the report and navigate to <span class="strong"><strong>Insert</strong></span> | <span class="strong"><strong>Chart</strong></span> and drag it in <span class="strong"><strong>Section1 (Report Header)</strong></span>. As shown in the following screenshot, in the <span class="strong"><strong>Type</strong></span> tab we will select <span class="strong"><strong>Gauge</strong></span> as a chart type:<div class="mediaobject"><img src="graphics/8026EN_07_21.jpg" alt="Creating the third report – gauge chart"/></div></li><li class="listitem">Navigate to the <a id="id191" class="indexterm"/><span class="strong"><strong>Data</strong></span> tab and choose the data fields as we did in the first report. Click on the <span class="strong"><strong>OK</strong></span> button.</li><li class="listitem">Add the two <span class="strong"><strong>date</strong></span> filters as we did in the first report.</li><li class="listitem">Go to main form and double-click on <span class="strong"><strong>btnGaugeChart</strong></span> button (<span class="strong"><strong>Gauge chart</strong></span>) to navigate to the code window behind it. Write the code as shown in the following screenshot for the <code class="literal">click</code> event:<div class="mediaobject"><img src="graphics/8026EN_07_22.jpg" alt="Creating the third report – gauge chart"/></div></li><li class="listitem">Run the application to test the result. We will see the report result as shown in the following screenshot:<div class="mediaobject"><img src="graphics/8026EN_07_23.jpg" alt="Creating the third report – gauge chart"/></div></li></ol></div><p>Now we will see <a id="id192" class="indexterm"/>how to update our report to meet the report that we had designed at the beginning of this chapter.</p><div class="section" title="Removing the legend"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec32"/>Removing the legend</h2></div></div></div><p>In the next few steps we <a id="id193" class="indexterm"/>will remove the legend as we did before with the bar chart:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Right-click on our chart and navigate to <span class="strong"><strong>Chart Options</strong></span> | <span class="strong"><strong>General</strong></span>.</li><li class="listitem">Navigate to the <span class="strong"><strong>Legend</strong></span> tab.</li><li class="listitem">Deselect the <span class="strong"><strong>Show Legend</strong></span> checkbox.</li><li class="listitem">Click on the <span class="strong"><strong>OK</strong></span> button.</li></ol></div></div><div class="section" title="Removing the chart's title"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec33"/>Removing the chart's title</h2></div></div></div><p>In the next few steps <a id="id194" class="indexterm"/>we will remove the chart's title as we did before with the bar chart:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Right-click on our chart and navigate to <span class="strong"><strong>Chart Options</strong></span> | <span class="strong"><strong>Titles</strong></span>.</li><li class="listitem">Clear the <span class="strong"><strong>Title</strong></span> textbox.</li><li class="listitem">Click on the <span class="strong"><strong>OK</strong></span> button.</li></ol></div></div><div class="section" title="Changing the chart's appearance"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec34"/>Changing the chart's appearance</h2></div></div></div><p>We will change the <a id="id195" class="indexterm"/>chart's appearance as we did before with the bar chart by performing the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Right-click on our chart and navigate to <span class="strong"><strong>Chart Options | General</strong></span>.</li><li class="listitem">Navigate to the <span class="strong"><strong>Appearance</strong></span> tab; update the appearance properties as shown in the following screenshot:<div class="mediaobject"><img src="graphics/8026EN_07_24.jpg" alt="Changing the chart's appearance"/></div></li><li class="listitem">Resize the <a id="id196" class="indexterm"/>chart size in the report to fit the report width.</li></ol></div></div></div>
<div class="section" title="Creating the fourth report &#x2013; all in one"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec41"/>Creating the fourth report – all in one</h1></div></div></div><p>In this report we use different <a id="id197" class="indexterm"/>charts in one report and display the <a id="id198" class="indexterm"/>data with the charts.</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Add new Crystal Reports to our application and name it <code class="literal">crEmpAllInOne</code>. We will choose the <span class="strong"><strong>As a Blank Report</strong></span> option.</li><li class="listitem">Right-click on <span class="strong"><strong>Database Fields</strong></span> in <span class="strong"><strong>Field Explorer</strong></span> and choose <span class="strong"><strong>Database Expert</strong></span>. We will choose our TableAdapter <span class="strong"><strong>EmployeeOrders</strong></span> as a data source.</li><li class="listitem">Right-click on the report and navigate to <span class="strong"><strong>Insert</strong></span> | <span class="strong"><strong>Chart</strong></span> and drag it in <span class="strong"><strong>Section1 (Report Header)</strong></span>. In the <span class="strong"><strong>Type</strong></span> tab we will select <span class="strong"><strong>Bar </strong></span>and resize the chart to fit the width of the report.</li><li class="listitem">Right-click on the report and navigate to <span class="strong"><strong>Insert</strong></span> | <span class="strong"><strong>Chart</strong></span> and drag it in <span class="strong"><strong>Section1 (Report Header)</strong></span>. In <span class="strong"><strong>Type</strong></span> tab we will select <span class="strong"><strong>Pie</strong></span> as a chart type and locate it under the <span class="strong"><strong>Bar</strong></span> chart and resize the chart to fit the width of the report.</li><li class="listitem">Right-click on the report and navigate to <span class="strong"><strong>Insert | Chart</strong></span> and drag it in <span class="strong"><strong>Section1 (Report Header)</strong></span>. In <span class="strong"><strong>Type</strong></span> tab we will select <span class="strong"><strong>Gauge</strong></span> as a chart type. Locate it under the <span class="strong"><strong>Pie</strong></span> chart and resize the chart to fit the width of the report.</li><li class="listitem">Update the appearance of all the three charts as we did before.</li><li class="listitem">Add two <span class="strong"><strong>date</strong></span> filters as we did in the previous report.</li><li class="listitem">Drag-and-drop the report <a id="id199" class="indexterm"/>fields to the <span class="strong"><strong>Details</strong></span> section and format them as shown in the <a id="id200" class="indexterm"/>following screenshot.<div class="mediaobject"><img src="graphics/8026EN_07_25.jpg" alt="Creating the fourth report – all in one"/></div></li><li class="listitem">Go to main form and double-click on the <span class="strong"><strong>btnAllInOne</strong></span> button (<span class="strong"><strong>All In One</strong></span>) to move to the code window behind it. Write the code as shown in the following screenshot for the <code class="literal">click</code> event:<div class="mediaobject"><img src="graphics/8026EN_07_26.jpg" alt="Creating the fourth report – all in one"/></div></li><li class="listitem">Run the application to test the result. It will be the same as the report we designed earlier.</li></ol></div></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec42"/>Summary</h1></div></div></div><p>In this chapter we learned how to use charts to build fantastic and powerful reports. We have seen that Crystal Reports support many types of charts and how easy it is to use these charts.</p><p>This chapter was the last one in our book. We learned how to create a reporting application from beginning to the end. I tried to give knowledge to the reader not only about tools such as Crystal Reports but also tried to teach them the skills and techniques that may help them to use these tools quickly and easily. We have seen how to design the application, and what tools we can use to create our application. We learned how to install our tools, how to use each tool, and how these tools communicate with each other. We learned Crystal Reports tools such as database expert, parameters, grouping, sorting, lines, and boxes. We learned to create different types of reports such as tabular, cross-tab and charts, and how to mix these types in one report. We learned how to display our reports in Visual Studio and passing parameter values dynamically using C# code.</p></div></body></html>