- en: Chapter 6. Working with Cross-Tab Reports
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In this chapter we will see one of the most important type of Crystal Reports:
    the Cross-Tab report. It is one of the most powerful tools in Crystal Reports.
    A Cross-Tab report is used to summarize data efficiently as we will see in this
    chapter.'
  prefs: []
  type: TYPE_NORMAL
- en: 'We will cover the following topics:'
  prefs: []
  type: TYPE_NORMAL
- en: Creating a Cross-Tab report
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Customizing the Cross-Tab appearance using the Cross-Tab Expert
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Doing page setup
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The Cross-Tab report is very useful for the user because it summarizes a lot
    of information in a simple form to give the user the information he needs. We
    can see the final report as shown in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Working with Cross-Tab Reports](img/6-1.jpg)'
  prefs: []
  type: TYPE_IMG
- en: As we see in the preceding screenshot, the report displays the sum of the product
    orders for each city. In our application, the user will select the product category
    and the country. The report will display the result shown in the previous screenshot.
  prefs: []
  type: TYPE_NORMAL
- en: Creating our report
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'So let''s start creating our report:'
  prefs: []
  type: TYPE_NORMAL
- en: The SQL query that we will use in our report is shown in the following screenshot:![Creating
    our report](img/6-2.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: We will create a new TableAdapter using this SQL query and name it `ProductsOrdersTableAdapter`,
    as seen in the following screenshot:![Creating our report](img/6-3.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Add a new crystal report to our application and name it `crProductsOrders`.
    As we see in the following screenshot, we can create our report by selecting the
    **Using the Report Wizard** option and then choosing **Cross-Tab** as an Expert,
    or we can select **As a Blank Report** and we will add the Cross-Tab from the
    report itself. We will take the second option to see how we can add or modify
    our Cross-Tab at any time after creating the report, so we will choose **As a
    Blank Report** as shown in the following screenshot:![Creating our report](img/6-4.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Right-click on **Database Fields** in **Field Explorer** and select **Database
    Expert**, and then a window appears, as shown in the following screenshot. As
    shown below, we will choose our TableAdapter **ProductsOrders** as a data source:![Creating
    our report](img/6-5.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Right-click on the report and navigate to **Insert** | **Cross-Tab** and drag
    it to **Section1 (Report Header)**. As we see in the following screenshot, we
    will add **ShipCountry** and **ShipCity** to the **Columns** list, **CategoryName**
    and **ProductName** to the **Rows** list, and **Quantity** to **Summarized Fields**
    list. From the **Style** tab, we can choose any style, however need but the original
    style is preferred. We will see how to use the **Customize Style** tab in the
    next few steps. Click on the **OK** button.![Creating our report](img/6-6.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Until now our report displays all the products and countries, so we will add
    two parameter fields to filter the report data by product categories and shipping
    countries. The first parameter field is **pmCountry** and the second one is **pmCategory**.
    See the following screenshot:![Creating our report](img/6-7.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Add a text object to the report as the report header and enter `Best-selling
    products` for the countries in it.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Go to the main form in our application, double-click on the **btnProductsOrdersByFilters**
    (**By filter**) button to navigate to the code behind, and write the code to display
    the report in our application, as shown in the following screenshot:![Creating
    our report](img/6-8.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Run the application to test the result. Choose **Dairy Products** from the **Category**
    list and **UK** from the **Country** list as we see in the following screenshot.
    Click on the **By filters** button to display the report.![Creating our report](img/6-9.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The report will look like the following screenshot:![Creating our report](img/6-10.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Customizing the Cross-Tab appearance
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In the next few steps, we will see how to update the report to resemble the
    design at the beginning of this chapter.
  prefs: []
  type: TYPE_NORMAL
- en: As we saw in the preceding screenshot, the two last columns and the last two
    rows have the same date, so we will hide the last column and the last row in our
    report.
  prefs: []
  type: TYPE_NORMAL
- en: Right-click in the top-left of the Cross-Tab and select **Cross-Tab Expert**,
    and navigate to the **Customize Style** tab. We will select the **Suppress Row
    Grand Totals** and **Suppress Column Grand Totals** checkboxes as we see in the
    following screenshot. Click on the **OK** button.![Customizing the Cross-Tab appearance](img/6-11.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Run the application to test the result. It will look like the following screenshot:![Customizing
    the Cross-Tab appearance](img/6-12.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: We can see in this report that the number of products displayed is more than
    the products that we have seen in the designed report in the beginning of this
    chapter. So, we need to sort the products according to the number of orders.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: In the designed report at the beginning of this chapter, we displayed the two
    products that have the top rate of orders only, so the report header is **Best-selling
    products for countries** and not all the products. In the next step, we will see
    how to control the number of products displayed in our report.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Right-click on the top left of the Cross-Tab, select **Group Sort Expert,**
    and navigate to the **ProductsOrders.ProductName** tab as shown in the following
    screenshot:![Customizing the Cross-Tab appearance](img/6-13.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: We will select the **Top N** value from the **For this group sort** list and
    enter `2` in the **where N is** textbox to display only two products in the Cross-Tab.
    Click on the **OK** button and run the application to see the result as shown
    in the following screenshot:![Customizing the Cross-Tab appearance](img/6-14.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: If we compare this report with the one designed in the beginning of this chapter,
    we will find no difference between them except the formatting of the text and
    the numbers. You can format it as per your need.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: In the next step, we will see how we can change the format of the grid lines
    and the background colors of the cells.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Right-click on the top left of the Cross-Tab and select **Cross-Tab Expert**
    and navigate to the **Customize Style** tab. As we see in the following screenshot,
    we will select the row or column we want to change the background color of and
    select the color we need to apply to it.![Customizing the Cross-Tab appearance](img/6-15.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on the **Format Grid Lines** button to format the Cross-Tab lines as we
    can see in the following screenshot. Select the line. The line color, style, or
    width can be altered as desired.![Customizing the Cross-Tab appearance](img/6-16.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on the **OK** button to save the changes and run the application to test
    the new appearance. This is shown in the following screenshot:![Customizing the
    Cross-Tab appearance](img/6-17.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: What if the user needs to display products of all categories to a specific country
    with the ability to filter data by the products category?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'We will make a small change to apply this request: we will change the parameter
    condition in our report as shown in the following screenshot:![Customizing the
    Cross-Tab appearance](img/6-18.jpg)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: When the user writes string `ALL` in the category list, the report will display
    all categories. Run the application and test the change, it will look like the
    following screenshot:![Customizing the Cross-Tab appearance](img/6-19.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Performing page setup
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'When we work with Cross-Tab we need to be careful with the page size because
    the width of the report grows dynamically. If we try to test the Cross-Tab by
    inputting the value `USA`, we will see that the report is divided into two parts
    as shown in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Performing page setup](img/6-20.jpg)'
  prefs: []
  type: TYPE_IMG
- en: This problem occurs because the value `USA` has many corresponding values for
    cities in our database and our report is designed to display and print in a portrait
    letter form. We can change the basic page settings by right-clicking on the report
    and navigating to **Design** | **Page Setup**. This is shown in the following
    screenshot. The page size has been changed to **A3** and the **Orientation** to
    **Landscape**.
  prefs: []
  type: TYPE_NORMAL
- en: '![Performing page setup](img/6-21.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'If we test by inputting the value `USA` again, the result will look like the
    following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Performing page setup](img/6-22.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter we have seen how useful Cross-Tab is. We learned to create Cross-Tab
    report and use the Cross-Tab Expert to control every part of the Cross-Tab. In
    the next chapter, we will see another fantastic tool in Crystal Reports; we will
    see how we can create reports containing charts.
  prefs: []
  type: TYPE_NORMAL
