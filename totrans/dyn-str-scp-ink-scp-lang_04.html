<html><head></head><body><div><div><h1 id="_idParaDest-49"><em class="italic"><a id="_idTextAnchor048"/>Chapter 3</em>: Sequences, Cycles, and Shuffling Text</h1>
			<p>This chapter introduces the concept of <strong class="bold">alternatives</strong>, programmable ways of introducing additional text, and advanced code that can react to loops. We will cover each type of alternative (<strong class="bold">sequence</strong>, <strong class="bold">cycle</strong>, and <strong class="bold">shuffle</strong>) in turn and look at how they can be combined with looping structures in ink. Next, we will examine <strong class="bold">multi-line alternatives</strong>, functionality for defining more complex structures based on the type of alternative used to create them. Finally, we will close the chapter with <strong class="bold">nested alternatives</strong>, the use of one or more alternatives inside each other.</p>
			<p>In this chapter, we will to cover the following main topics:</p>
			<ul>
				<li>Using alternatives</li>
				<li>Creating multi-line alternatives</li>
				<li>Nesting alternatives</li>
			</ul>
			<h1 id="_idParaDest-50"><a id="_idTextAnchor049"/>Technical requirements</h1>
			<p>The examples used in this chapter, in <code>*.ink</code> files, can be found online on GitHub: <a href="https://github.com/PacktPublishing/Dynamic-Story-Scripting-with-the-ink-Scripting-Language/tree/main/Chapter3">https://github.com/PacktPublishing/Dynamic-Story-Scripting-with-the-ink-Scripting-Language/tree/main/Chapter3</a>.</p>
			<h1 id="_idParaDest-51"><a id="_idTextAnchor050"/>Using alternatives</h1>
			<p>In <a href="B17597_02_Final_PG_ePub.xhtml#_idTextAnchor031"><em class="italic">Chapter 2</em></a>,<em class="italic"> Knots, Diverts, and Looping Patterns</em>, the<a id="_idIndexMarker088"/> use of opening, <code>{</code>, and closing, <code>}</code>, curly brackets signaled the use of a conditional option. Between using labels and conditions, options could become dynamic and react to the reader making choices between loops. However, curly brackets are used for more than conditional options. In ink, they also signal the use of any <em class="italic">code</em>, and one of the most common forms of code is the use of an <code>|</code>. Depending <a id="_idIndexMarker089"/>on the type of alternative used, different text effects can happen.</p>
			<h2 id="_idParaDest-52"><a id="_idTextAnchor051"/>Sequences</h2>
			<p>The<a id="_idIndexMarker090"/> first <a id="_idIndexMarker091"/>and default alternative is a <strong class="bold">sequence</strong>. As its name might suggest, a sequence is a series of values. They are accessed based on their name, <em class="italic">in sequence</em>:</p>
			<p class="SC---Link" lang="en-US" xml:lang="en-US">Example 1:</p>
			<pre>It was a {dark and stormy night|bright and shining day}.</pre>
			<p>In <em class="italic">Example 1</em>, a sequence is used. It has two elements, <code>dark and stormy night</code> and <code>bright and shining day</code>, with a vertical bar between them. When first run, the sequence would produce the following output:</p>
			<pre>It was a dark and stormy night.</pre>
			<p>In a sequence, any elements beyond the first are only shown when the sequence is run additional times. In other words, a sequence with more than one element works best inside a looping structure:</p>
			<p class="SC---Link" lang="en-US" xml:lang="en-US">Example 2:</p>
			<pre>She looked out the window.
-&gt; weather
== weather
+ What was the weather like?
    It was a {dark and stormy night|bright and shining day}.
    -&gt; weather
* Ignore the weather.
    -&gt; DONE</pre>
			<p>By diverting back to the knot, <code>weather</code>, a loop is created. This allows the second element of the sequence to be shown on the second loop:</p>
			<div><div><img src="img/Figure_3.1_B17597.jpg" alt="Figure 3.1 – Screenshot of Inky showing both elements from Example 2&#13;&#10;" width="582" height="384"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.1 – Screenshot of Inky showing both elements from Example 2</p>
			<p>A sequence<a id="_idIndexMarker092"/> only <a id="_idIndexMarker093"/>continues if new elements are within it. Once a sequence reaches its end, it stops on the last element. In <em class="italic">Example 2</em>, choosing the option <code>bright and shining day</code>, would be shown again:</p>
			<div><div><img src="img/Figure_3.2_B17597.jpg" alt="Figure 3.2 – Screenshot of Inky showing the repeating element from Example 2&#13;&#10;" width="510" height="424"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.2 – Screenshot of Inky showing the repeating element from Example 2</p>
			<p class="callout-heading">Important note</p>
			<p class="callout"><em class="italic">Example 2</em> follows a pattern established in <a href="B17597_02_Final_PG_ePub.xhtml#_idTextAnchor031"><em class="italic">Chapter 2</em></a><em class="italic">, Knots, Diverts, and Looping Patterns</em>, with two choices. The first loops the structure and the second breaks it. Always use choices when creating loops to avoid creating ones that cannot end!</p>
			<p>Sequences are best used in situations where a user might exhaust a series of elements and end on the last <a id="_idIndexMarker094"/>one. When a repeating sequence is needed, a<a id="_idIndexMarker095"/> different concept is used: <strong class="bold">cycles</strong>.</p>
			<h2 id="_idParaDest-53"><a id="_idTextAnchor052"/>Cycles</h2>
			<p>Like <a id="_idIndexMarker096"/>sequences, <code>&amp;</code>, in front of the first element in the set. This tells ink to <em class="italic">cycle</em> the elements and return to the first after the last:</p>
			<p class="SC---Link" lang="en-US" xml:lang="en-US">Example 3:</p>
			<pre>He flipped the calendar, looking at each month in turn.
-&gt; calendar
== calendar
+ [Flip pages]
    He saw the month was {&amp;January|February|March|April|May|      June|July|August|September|October|November|December}.
    -&gt; calendar
* Put down calendar.
    -&gt; DONE</pre>
			<p>In <em class="italic">Example 3</em>, the looping structure reruns the cycle, moving through all the months and then <em class="italic">cycling</em> back to the first element again:</p>
			<div><div><img src="img/Figure_3.3_B17597.jpg" alt="Figure 3.3 – Screenshot of ink showing all elements from the Example 3 cycle&#13;&#10;" width="1336" height="548"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.3 – Screenshot of ink showing all elements from the Example 3 cycle</p>
			<p>All alternatives can contain empty elements. For cycles, any blank elements count towards the <a id="_idIndexMarker098"/>total<a id="_idIndexMarker099"/> number. It is possible to create a cycle that shows elements only after a certain number of loops:</p>
			<p class="SC---Link" lang="en-US" xml:lang="en-US">Example 4:</p>
			<pre>He awoke to the sudden darkness. He tried to bend his elbows outward and his arms stopped against some sort of wall. Carefully bringing his arms up, he pressed his palms out and hit another surface inches from his face.
Desperate to figure out where he was, he remembered he still had his lighter in his pocket. Shifting the left side of his body against the wall, he reached the tips of his right hand into his back pocket and drew it out.
-&gt; lighter
== lighter
+ [Try lighter]
    {&amp;|||For a moment, there was light before the flame went out.}
    -&gt; lighter</pre>
			<p>Using empty elements with a cycle can be very effective for creating a situation where the reader must take an action multiple times before a result happens. In <em class="italic">Example 4</em>, the cycle has multiple empty elements separated by vertical bars. The last element, <code>For a moment, there was light before the flame went out.</code>, is only shown after<a id="_idIndexMarker100"/> the <a id="_idIndexMarker101"/>reader chooses the option <strong class="bold">Try lighter</strong> four times:</p>
			<div><div><img src="img/Figure_3.4_B17597.jpg" alt="Figure 3.4 – Screenshot of Inky showing Example 4's use of empty elements&#13;&#10;" width="786" height="373"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.4 – Screenshot of Inky showing Example 4's use of empty elements</p>
			<h2 id="_idParaDest-54"><a id="_idTextAnchor053"/>Shuffles</h2>
			<p><code>~</code>, appears before the first element in the set:</p>
			<p class="SC---Link" lang="en-US" xml:lang="en-US">Example 5:</p>
			<pre>The lucky number for today is {~1|2|3|4|5|6|7|8|9|10}.</pre>
			<p>Unlike sequences and cycles, shuffles do not show their elements in order. Combined with empty elements, as shown previously with cycles, the chances of an element being picked are always consistent with the total number of elements. This means that to create a shuffle where one of its elements is shown 1 of 10 runs, the code would be the following:</p>
			<p class="SC---Link" lang="en-US" xml:lang="en-US">Example 6:</p>
			<pre>One out of ten runs of this shuffle will produce the number 10: {~|||||||||10}</pre>
			<p>In <em class="italic">Example 6</em>, element <code>10</code> has a 10% chance of appearing. Most runs (90%) would not see it, creating a unique moment for those users encountering the event within their narrative <a id="_idIndexMarker104"/>experience <a id="_idIndexMarker105"/>of the story's content:</p>
			<div><div><img src="img/Figure_3.5_B17597.jpg" alt="Figure 3.5 – Screenshot of Inky showing the output of Example 6 without element 10&#13;&#10;" width="652" height="106"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.5 – Screenshot of Inky showing the output of Example 6 without element 10</p>
			<h1 id="_idParaDest-55"><a id="_idTextAnchor054"/>Creating multi-line alternatives</h1>
			<p>Sequences, cycles, and <a id="_idIndexMarker106"/>shuffles can be written using one single line of code. However, all alternatives can also be written using their multi-line form. For each of these, curly brackets are still used, but each element is on its own line with a dash, <code>-</code>, appearing before it.</p>
			<h2 id="_idParaDest-56"><a id="_idTextAnchor055"/>Multi-line cycles</h2>
			<p>To create a<a id="_idIndexMarker107"/> multi-line cycle, the keyword <code>cycle</code> is used with a colon, <code>:</code>, and with each element on its own line:</p>
			<p class="SC---Link" lang="en-US" xml:lang="en-US">Example 7:</p>
			<pre>He flipped the calendar, looking at each month in turn.
-&gt; calendar
== calendar
+ [Flip pages]
    He saw the month was &lt;&gt;{cycle:
    - January
    - February
    - March
    - April
    - May
    - June
    - July
    - August
    - September
    - October
    - November
    - December
    }&lt;&gt;.
    -&gt; calendar
* Put down calendar.
    -&gt; DONE</pre>
			<p>Any use of<a id="_idIndexMarker108"/> multi-line alternatives also introduces a new issue. Because each element is on its own line, each is also considered a <em class="italic">line</em> by ink. This means its output would introduce additional spacing between lines. To help with this issue, <strong class="bold">glue</strong> can be<a id="_idIndexMarker109"/> used between the multi-line alternative and the next text content.</p>
			<p class="callout-heading">Reminder </p>
			<p class="callout"><a href="B17597_01_Final_PG_ePub.xhtml#_idTextAnchor014"><em class="italic">Chapter 1</em></a><em class="italic">, Text, Flow, Choices, and Weaves</em>, introduced the concept of <strong class="bold">glue</strong>, the use of the less-than and greater-than symbols together. This concept <em class="italic">glues</em> one line to the end of the previous. With multi-line alternatives, the use of glue removes the additional space between its output and the next line of content.</p>
			<h2 id="_idParaDest-57"><a id="_idTextAnchor056"/>Multi-line sequences</h2>
			<p>Multi-line cycles use<a id="_idIndexMarker110"/> the keyword <code>cycle</code> and multi-line shuffles use the keyword <code>shuffle</code>. However, multi-line sequences use the keyword <code>stopping</code>:</p>
			<p class="SC---Link" lang="en-US" xml:lang="en-US">Example 8:</p>
			<pre>She looked out the window.
-&gt; weather
== weather
+ What was the weather like?
    It was a &lt;&gt;{stopping:
    - dark and stormy night
    - bright and shining day
    }&lt;&gt;.
    -&gt; weather
* Ignore the weather.
    -&gt; DONE</pre>
			<p>Multi-line sequences also introduce an important difference between themselves and their one-line forms: readability. Each element in a multi-line alternative is separated by a new line. In the one-line form, a sequence with a particularly long text element would be hard to differentiate between its end and the start of the next element in the alternative:</p>
			<pre>{This is one really long line that keeps going and going just to make sure that it wraps to a new line.|This is more content as part of this second element.}</pre>
			<p>Broken into new lines, the previous code can become much easier to edit and understand:</p>
			<p class="SC---Link" lang="en-US" xml:lang="en-US">Example 9:</p>
			<pre>{stopping:
- This is one really long line that keeps going and going to make sure that it wraps to a new line.
- This is more content as part of this second element.
}</pre>
			<h1 id="_idParaDest-58"><a id="_idTextAnchor057"/>Nesting alternatives</h1>
			<p>Sequences, cycles, and <a id="_idIndexMarker111"/>shuffles can all be nested <em class="italic">inside</em> each other. When this happens, the combined form is what is known as a <strong class="bold">nested alternative</strong>, where one alternative appears as the element of another.</p>
			<h2 id="_idParaDest-59"><a id="_idTextAnchor058"/>Combining cycles and shuffles</h2>
			<p>Within a looping <a id="_idIndexMarker112"/>structure, a cycle can be <a id="_idIndexMarker113"/>very useful to repeat content after a certain number of loops. When combined with a shuffle, random content can be selected from the shuffle and then repeated within the larger cycle. For example, to generate a new random number for each loop, a cycle with a single element using multiple shuffles would produce this effect using only one line of code:</p>
			<p class="SC---Link" lang="en-US" xml:lang="en-US">Example 10:</p>
			<pre>Her hands were sweating, and her head hurt. She just needed to enter the correct digits into the controls and the vault would open. Once she got in and away with the treasure inside, she could be done with this job and leave this life behind. She had sworn there would only be one more job like this one job ago. This was truly the last one, she decided again.
She wiped her forehead and considered the controls again.
-&gt; combination
== combination
What was the combination again?
+ [Was it {&amp;{~1|2|3|4|5}-{~1|2|3|4|5}-{~1|2|3|4|5}}?]
    -&gt; combination
* Give up on the controls. This was hopeless. She could not    remember the numbers.
    -&gt; DONE</pre>
			<p><em class="italic">Example 10</em> uses a cycle and three shuffles. Each time the loop runs, the cycle reruns. With only one element, it <em class="italic">cycles</em> again and reruns the shuffles, each of which picks a random number<a id="_idIndexMarker114"/> from one to five. This has the<a id="_idIndexMarker115"/> effect of generating a new three-digit number for each loop:</p>
			<div><div><img src="img/Figure_3.6_B17597.jpg" alt="Figure 3.6 – Screenshot of Inky showing random three-digit numbers across loops from Example 10" width="714" height="437"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.6 – Screenshot of Inky showing random three-digit numbers across loops from Example 10</p>
			<p>The code in <em class="italic">Example 10</em> also demonstrates something not previously made explicit about how alternatives work in ink. The elements of alternatives often have text content, and options are created from the text of choices. This means that alternatives can be used with choices to generate dynamic options. This also means that diverts can be elements of alternatives as well.</p>
			<p>For example, a set of diverts can be used with a shuffle to move the reader to different points at random based on the options they chose:</p>
			<p class="SC---Link" lang="en-US" xml:lang="en-US">Example 11:</p>
			<pre>They stood before the doorway at the end of the hallway. Without knowing where it would go, they reached out.
* [Open door]
    {~-&gt; treasure|-&gt; back_in_hallway}
== treasure
Yes! The room was full of treasure.
-&gt; DONE
== back_in_hallway
As the door opened, there was a flash, and they blinked several times before realizing what had happened. They were back in front of the door. No!
-&gt; DONE</pre>
			<p>When run, the<a id="_idIndexMarker116"/> combination of diverts and a<a id="_idIndexMarker117"/> shuffle in <em class="italic">Example 11</em> would randomly pick between two possible branches. The reader would either be diverted to the <code>treasure</code> or <code>back_in_hallway</code> knots.</p>
			<h2 id="_idParaDest-60"><a id="_idTextAnchor059"/>Shuffling shuffles</h2>
			<p>In<a id="_idIndexMarker118"/> both <em class="italic">Example 10</em> and <em class="italic">Example 11</em>, one type of alternative <a id="_idIndexMarker119"/>was combined with another. It is also possible to nest the same type of alternative. Shuffles can be nested within other shuffles to make advanced combinatorial results. For example, it is possible to generate a quick history of a fantasy kingdom by defining possible years and events, and then using one-line shuffles inside a multi-line shuffle to build a sentence describing the kingdom:</p>
			<p class="SC---Link" lang="en-US" xml:lang="en-US">Example 12:</p>
			<pre>It was the 
&lt;&gt; {shuffle:
- year {~1|2|3|4|5|6|7|8|9}{~1|2|3|4|5|6|7|8|9} of the New
    Era
- {~second|third|fourth|fifth|sixth|seventh} {~Year of the
    Frog|Year of the Snake}
   }
&lt;&gt; and our kingdom 
&lt;&gt; {shuffle:
- {~was doing well|was facing a crisis}
- {~was at war|was recovering from a war} with {~the
    giants|the elves|the humans}
   }
&lt;&gt;.</pre>
			<p>In <em class="italic">Example 12</em>, the use <a id="_idIndexMarker120"/>of the single-line shuffles creates all <a id="_idIndexMarker121"/>of the small details of the kingdom. These are then used within the larger multi-line shuffles for the major events. They build a history based on different elements <em class="italic">shuffled</em> together:</p>
			<div><div><img src="img/Figure_3.7_B17597.jpg" alt="Figure 3.7 – Screenshot of Inky showing of one of the many possible outputs of Example 12 " width="818" height="127"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.7 – Screenshot of Inky showing of one of the many possible outputs of Example 12 </p>
			<p>Alternatives and their multi-line forms can be very useful for detecting and acting on loops by using sequences and cycles to show new or change old content. Shuffles, with the ability to introduce randomness in a story, are an easy way to generate dynamic text in a story, as shown in <em class="italic">Example 12</em>.</p>
			<p>When combining different types of alternatives, such as those used in <em class="italic">Example 10</em>, these <em class="italic">nested</em> alternatives can generate complex content based on how each type works individually. However, what was not covered and is introduced in the next chapter is a way to save what is generated by an alternative and then compare values. As with the story used in <em class="italic">Example 10</em>, generating a random three-digit number is useful, but saving and remembering it is even better. <a href="B17597_04_Final_PG_ePub.xhtml#_idTextAnchor062"><em class="italic">Chapter 4</em></a>,<em class="italic"> Variables, Lists, and Functions</em>, introduces how to retain values across a story as generated by alternatives and changed because <a id="_idIndexMarker122"/>of a <a id="_idIndexMarker123"/>user's interactions in ink.</p>
			<h1 id="_idParaDest-61"><a id="_idTextAnchor060"/>Summary</h1>
			<p>In this chapter, we looked at the seemingly simple concept of alternatives. In ink, the three types of alternatives are sequences, cycles, and shuffles. Each provides a different way of accessing its elements. Sequences show each element in turn until its last one. Cycles repeat their elements, looping back to the first element after encountering the end. Shuffles select a random element from their set each time they are run, creating a way to introduce randomness to stories for the first time.</p>
			<p>Alternatives can also be expressed in both one-line and multi-line forms. When written in their longer multi-line forms, alternatives use a keyword for their type and have each element on a separate line. While much easier to read for an author, we reviewed how care must be taken to incorporate glue because of how ink interprets each line of text in a story.</p>
			<p>Finally, we learned alternatives can be combined in a nested form. An element of an alternative can be another alternative. When used together, this showed how, for example, a cycle and shuffle can be combined to regenerate random selections from multiple shuffles each time they are run. We also saw how the text of elements from alternatives can be used with choices and even how diverts can be elements of alternatives.</p>
			<p>In the next chapter, we will see how to create and access the values of variables in ink.</p>
			<h1 id="_idParaDest-62"><a id="_idTextAnchor061"/>Q&amp;A</h1>
			<ol>
				<li>What are the three types of alternatives in ink?</li>
				<li>What special symbol is used between elements in their single-line form?</li>
				<li>What special symbol is used before the first element in the set to create a cycle?</li>
				<li>What is the difference between a sequence and a cycle?</li>
				<li>What is unique about a shuffle?</li>
				<li>What is the keyword used to create a multi-line sequence?</li>
			</ol>
		</div>
	</div></body></html>