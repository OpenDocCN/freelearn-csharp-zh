<html><head></head><body>
  <div><h1 class="chapter-number" id="_idParaDest-181">
    <a id="_idTextAnchor182">
    </a>
    
     13
    
   </h1>
   <h1 id="_idParaDest-182">
    <a id="_idTextAnchor183">
    </a>
    
     Writing Your Own Project Template
    
   </h1>
   <p>
    
     In this chapter, we will dive into the world of Visual Studio by exploring how to create custom project templates.
    
    
     These templates are incredibly powerful tools that allow us to streamline our development process, ensuring that our team starts every project with a consistent structure and configuration.
    
    
     We’ll begin by breaking down the fundamental structures that make up a project template, giving you a solid foundation to build upon.
    
    
     As we progress, we’ll discover how to integrate parameters into our templates, allowing for dynamic customization at the point of project creation.
    
    
     Finally, we’ll delve into advanced features, teaching you how to extend your project templates into full-fledged solution templates that can handle complex,
    
    
     
      multi-project solutions.
     
    
   </p>
   <p>
    
     In this chapter, we’re going to cover the following
    
    
     
      main topics:
     
    
   </p>
   <ul>
    <li>
     
      Understanding project
     
     
      
       template structures
      
     
    </li>
    <li>
     
      Building a basic
     
     
      
       project template
      
     
    </li>
    <li>
     
      Customize project templates for
     
     
      
       different workflows
      
     
    </li>
    <li>
     
      Integrating
     
     
      
       template parameters
      
     
    </li>
    <li>
     
      Extending project templates with
     
     
      
       advanced features
      
     
    </li>
   </ul>
   <p>
    
     By the end of this chapter, you’ll not only have the knowledge to create and customize project templates, but you’ll also understand how to leverage these tools to enhance productivity and maintain consistency across
    
    
     
      your projects.
     
    
   </p>
   <h1 id="_idParaDest-183">
    <a id="_idTextAnchor184">
    </a>
    
     Technical requirements
    
   </h1>
   <p>
    
     While writing this chapter, I used the following version of
    
    
     
      Visual Studio:
     
    
   </p>
   <ul>
    <li>
     
      Visual Studio Enterprise 2022
     
     
      
       Version
      
     
     
      
       17.12.0
      
     
    </li>
    <li>
     
      
       Preview
      
     
     
      
       1.0
      
     
    </li>
   </ul>
   <p>
    
     The code files for this chapter can be found
    
    
     
      at
     
    
    <a href="https://github.com/PacktPublishing/Mastering-Visual-Studio-2022/tree/main/ch13">
     
      
       https://github.com/PacktPublishing/Mastering-Visual-Studio-2022/tree/main/ch13
      
     
    </a>
    
     
      .
     
    
   </p>
   <h1 id="_idParaDest-184">
    <a id="_idTextAnchor185">
    </a>
    
     Understanding project template structure
    
   </h1>
   <p>
    
     We all use templates when
    
    <a id="_idIndexMarker745">
    </a>
    
     we create a new project or a new item with Visual Studio.
    
    
     In this section, we will cover the difference between project and item templates and then see what files are involved in this process.
    
    
     Project templates in Visual Studio are powerful tools that help developers quickly set up new projects with predefined configurations and structures.
    
    
     On the other hand, we can create item templates for specific parts of the project.
    
    
     These templates provide a base that can be customized according to specific needs, streamlining the development process and ensuring consistency
    
    
     
      across projects.
     
    
   </p>
   <p>
    
     Both project templates and item templates in Visual Studio are reusable structures designed to simplify development by providing basic code frameworks and configurations that can be tailored to specific needs.
    
    
     Despite their similarities, they differ significantly in scope and application within the Visual
    
    
     
      Studio environment.
     
    
   </p>
   <p>
    <strong class="bold">
     
      Project templates
     
    </strong>
    
     serve as foundational blueprints for creating new projects.
    
    
     They include the entire project structure, necessary files, references, and configuration settings tailored to a specific project type (e.g., ASP.NET Core Web App, Class Library).
    
    
     When starting a new project in Visual Studio, we choose a project template that matches our requirements.
    
    
     This template establishes the initial project framework, including default namespaces, assembly references, and compiler options, saving time and ensuring consistency
    
    
     
      across projects.
     
    
   </p>
   <p>
    <strong class="bold">
     
      Item templates
     
    </strong>
    
     focus
    
    <a id="_idIndexMarker746">
    </a>
    
     on individual components within a project.
    
    
     These templates can range from simple file types (e.g., XML, HTML, CSS) to complex structures involving multiple files and resources.
    
    
     They are designed to quickly add predefined items to an existing project.
    
    
     We use item templates when adding new elements to our project via the
    
    <strong class="bold">
     
      Add New Item
     
    </strong>
    
     dialog box.
    
    
     This could include anything from a class file or interface to a pre-configured web page.
    
    
     Item templates enable the rapid inclusion of these elements without the need for
    
    
     
      manual configuration.
     
    
   </p>
   <p>
    
     The creation of new templates involves working with the different files described in the
    
    
     
      following points:
     
    
   </p>
   <ul>
    <li>
     <strong class="bold">
      
       Files to
      
     </strong>
     
      <strong class="bold">
       
        be created
       
      </strong>
     
     
      
       :
      
     
     <ul>
      <li>
       <strong class="bold">
        
         Source code files
        
       </strong>
       
        : These are the initial coding files included with the template.
       
       
        For example, a C# class library template might start with a default
       
       
        <strong class="source-inline">
         
          Class1.cs
         
        </strong>
       
       
        
         file.
        
       
      </li>
      <li>
       <strong class="bold">
        
         Embedded resources
        
       </strong>
       
        : This category includes images, configuration files, or other resources the project
       
       
        
         might require.
        
       
      </li>
      <li>
       <strong class="bold">
        
         Project files
        
       </strong>
       
        : These encompass the solution and project files (such as
       
       <strong class="source-inline">
        
         .sln
        
       </strong>
       
        and
       
       <strong class="source-inline">
        
         .csproj
        
       </strong>
       
        for C# projects) that outline the project’s structure
       
       
        
         and dependencies.
        
       
      </li>
     </ul>
    </li>
    <li>
     <strong class="source-inline">
      
       .
      
     </strong>
     
      <strong class="source-inline">
       
        vstemplate
       
      </strong>
     
     
      
       :
      
     
     <ul>
      <li>
       
        This XML file is essential for defining the template.
       
       
        It contains metadata such as the template’s name, description, icon, and
       
       
        
         project type.
        
       
      </li>
      <li>
       
        It outlines the files to be included in the project and specifies any additional parameters or wizard data that need to be processed when the template
       
       
        
         is instantiated.
        
       
      </li>
     </ul>
    </li>
    <li>
     <strong class="bold">
      
       Compressed into a
      
     </strong>
     
      <strong class="bold">
       
        ZIP file
       
      </strong>
     
     
      
       :
      
     
     <ul>
      <li>
       
        Once the template and its associated files are prepared, they are compressed into a
       
       <strong class="source-inline">
        
         .zip
        
       </strong>
       
        file.
       
       
        This file is placed in a specific folder where Visual Studio can
       
       
        
         recognize it.
        
       
      </li>
      <li>
       
        For project templates, the
       
       <strong class="source-inline">
        
         .zip
        
       </strong>
       
        file is placed in the
       
       <strong class="source-inline">
        
         \Documents\Visual Studio &lt;
        
       </strong>
       
        <strong class="source-inline">
         
          version&gt;\Templates\ProjectTemplates
         
        </strong>
       
       
        
         directory.
        
       
      </li>
      <li>
       
        For item templates, it goes into the
       
       <strong class="source-inline">
        
         \Documents\Visual Studio &lt;
        
       </strong>
       
        <strong class="source-inline">
         
          version&gt;\Templates\ItemTemplates
         
        </strong>
       
       
        
         directory.
        
       
      </li>
     </ul>
    </li>
   </ul>
   <p>
    
     Project templates in
    
    <a id="_idIndexMarker747">
    </a>
    
     Visual Studio provide a starting point for entire projects, offering a structured foundation based on the chosen template’s specifications.
    
    
     Conversely, item templates serve to expedite the addition of individual components or files within those projects, streamlining the development workflow by providing reusable pieces of code or resources.
    
    
     Understanding the distinction between these two types of templates can significantly enhance productivity and consistency in software
    
    
     
      development practices.
     
    
   </p>
   <p>
    
     Now, let’s learn how to create
    
    
     
      basic templates.
     
    
   </p>
   <h1 id="_idParaDest-185">
    <a id="_idTextAnchor186">
    </a>
    
     Building a basic project template
    
   </h1>
   <p>
    
     In this section, we will cover
    
    <a id="_idIndexMarker748">
    </a>
    
     the more convenient way to build a project template.
    
    
     The process consists of building a skeleton project with the minimum we need inside to fit with our company requirements for example.
    
    
     After that, we can export the existing project as a template using Visual Studio’s Export Template Wizard, by using the Visual Studio top bar menu:
    
    <strong class="bold">
     
      Project
     
    </strong>
    
     |
    
    
     <strong class="bold">
      
       Export Template…
      
     </strong>
    
    
     
      :
     
    
   </p>
   <div><div><img alt="Figure 13.1 – Export Template…" src="img/B22218_13_1.jpg"/>
     
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    
     Figure 13.1 – Export Template…
    
   </p>
   <p>
    
     The preceding action will open the
    
    <strong class="bold">
     
      Export Template
     
    </strong>
    
     <strong class="bold">
      
       Wizard
      
     </strong>
    
    
     
      window:
     
    
   </p>
   <div><div><img alt="Figure 13.2 – Export Template Wizard" src="img/B22218_13_2.jpg"/>
     
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    
     Figure 13.2 – Export Template Wizard
    
   </p>
   <p>
    
     First, we choose the type of
    
    <a id="_idIndexMarker749">
    </a>
    
     template we want to export; either
    
    <strong class="bold">
     
      Project template
     
    </strong>
    
     or
    
    
     <strong class="bold">
      
       Item template
      
     </strong>
    
    
     
      .
     
    
   </p>
   <p>
    
     Then, the tool allows us to define key details, such as the template’s name, description, icon, and
    
    
     
      preview images.
     
    
   </p>
   <div><div><img alt="Figure 13.3 – Select Template Options" src="img/B22218_13_3.jpg"/>
     
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    
     Figure 13.3 – Select Template Options
    
   </p>
   <p>
    
     Upon completion, the
    
    <a id="_idIndexMarker750">
    </a>
    
     project is bundled into a
    
    <strong class="source-inline">
     
      .zip
     
    </strong>
    
     file and saved to a chosen output location.
    
    
     Additionally, we can opt to directly import the template into Visual Studio for immediate utilization.
    
    
     To access and use our newly created template, open the dialog box for creating a
    
    
     
      new project.
     
    
   </p>
   <div><div><img alt="Figure 13.4 – Use the custom template" src="img/B22218_13_4.jpg"/>
     
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    
     Figure 13.4 – Use the custom template
    
   </p>
   <p>
    
     We can locate the template by searching for its name or browsing through the list.
    
    
     Keep in mind that filtering by
    
    <a id="_idIndexMarker751">
    </a>
    
     language or project type may not be supported for
    
    
     
      custom templates.
     
    
   </p>
   <p>
    
     Let’s explore how to
    
    
     
      custom templates.
     
    
   </p>
   <h1 id="_idParaDest-186">
    <a id="_idTextAnchor187">
    </a>
    
     Customizing project templates for different workflows
    
   </h1>
   <p>
    
     There are two
    
    <a id="_idIndexMarker752">
    </a>
    
     ways to update a Visual Studio template either by using the Export Template Wizard or by manually adjusting the files within
    
    
     
      the template.
     
    
   </p>
   <p>
    
     The first method is to utilize the Export Template Wizard by initiating a new project within the project template we are interested in modifying and then following
    
    
     
      these steps:
     
    
   </p>
   <ol>
    <li>
     
      Within the project, carry out the modifications we desire.
     
     
      This could encompass changing the output type, incorporating new files, or implementing
     
     
      
       other alterations.
      
     
    </li>
    <li>
     <strong class="bold">
      
       Export the modified template
      
     </strong>
     
      : With our project adjusted, head to
     
     <strong class="bold">
      
       Project
      
     </strong>
     
      |
     
     <strong class="bold">
      
       Export Template
      
     </strong>
     
      to access the Export
     
     
      
       Template Wizard.
      
     
    </li>
    <li>
     <strong class="bold">
      
       Conclude the export process
      
     </strong>
     
      : Adhere to the wizard’s instructions to successfully export our modified template as a
     
     <strong class="source-inline">
      
       .
      
     </strong>
     
      <strong class="source-inline">
       
        zip
       
      </strong>
     
     
      
       file.
      
     
    </li>
   </ol>
   <p>
    
     The other option is to apply the manual modification to a template by revising the
    
    <strong class="source-inline">
     
      .vstemplate
     
    </strong>
    
     by following
    
    
     
      these steps:
     
    
   </p>
   <ol>
    <li>
     <strong class="bold">
      
       Identify the template
      
     </strong>
     
      : Locate the
     
     <strong class="source-inline">
      
       .zip
      
     </strong>
     
      archive corresponding to the template we
     
     <a id="_idIndexMarker753">
     </a>
     
      intend to alter.
     
     
      Typically, this resides in
     
     <strong class="source-inline">
      
       %USERPROFILE%\Documents\Visual
      
     </strong>
     
      <strong class="source-inline">
       
        Studio &lt;version&gt;\Templates\ProjectTemplates
       
      </strong>
     
     
      
       .
      
     
    </li>
    <li>
     <strong class="bold">
      
       Unpack the archive
      
     </strong>
     
      : Extract the contents of the
     
     
      
       template archive.
      
     
    </li>
    <li>
     <strong class="bold">
      
       Edit the files
      
     </strong>
     
      : Undertake the necessary edits, additions, or deletions to the files within
     
     
      
       the template.
      
     
    </li>
    <li>
     <strong class="bold">
      
       Revise the .vstemplate file
      
     </strong>
     
      : Adjust the
     
     <strong class="source-inline">
      
       .vstemplate
      
     </strong>
     
      XML file to accurately represent the
     
     
      
       changes made.
      
     
    </li>
    <li>
     <strong class="bold">
      
       Archive the changes
      
     </strong>
     
      : Compress all the modified files back into a
     
     <strong class="source-inline">
      
       .
      
     </strong>
     
      <strong class="source-inline">
       
        zip
       
      </strong>
     
     
      
       archive.
      
     
    </li>
    <li>
     <strong class="bold">
      
       Implement the updated template
      
     </strong>
     
      : Transfer the newly compressed
     
     <strong class="source-inline">
      
       .zip
      
     </strong>
     
      file to the original directory, replacing the outdated
     
     
      
       template files.
      
     
    </li>
   </ol>
   <p>
    
     Customizing allows
    
    <a id="_idIndexMarker754">
    </a>
    
     us to use some parameters and variables in existing templates.
    
    
     Let’s see in the next section how to
    
    
     
      achieve that.
     
    
   </p>
   <h1 id="_idParaDest-187">
    <a id="_idTextAnchor188">
    </a>
    
     Integrating template parameters and variables
    
   </h1>
   <p>
    
     Now that we have
    
    <a id="_idIndexMarker755">
    </a>
    
     seen how to open an existing
    
    <strong class="source-inline">
     
      .vstemplate
     
    </strong>
    
     in order to customize it, in this section, we will explore how to leverage parameters to dynamically replace values within the template when it’s instantiated.
    
    
     Using parameters and variables in
    
    <strong class="source-inline">
     
      .vstemplate
     
    </strong>
    
     files with Visual Studio allows us to create dynamic templates that can adapt to different project names, namespaces, and other customizable aspects.
    
    
     This feature enhances the reusability and customization of our templates, making template creation a powerful tool for streamlining
    
    
     
      development workflows.
     
    
   </p>
   <p>
    <strong class="bold">
     
      Template parameters
     
    </strong>
    
     are
    
    <a id="_idIndexMarker756">
    </a>
    
     placeholders within our template that get replaced with actual values when the template is instantiated.
    
    
     These parameters can represent various aspects of our project, such as the project name, namespace, or even
    
    
     
      custom-defined values.
     
    
   </p>
   <p>
    
     Visual Studio provides a set of reserved template parameters that you can use directly in the templates.
    
    
     Here is the list of these reserved parameters, according to the
    
    
     
      Microsoft documentation:
     
    
   </p>
   <ul>
    <li>
     <strong class="source-inline">
      
       clrversion
      
     </strong>
     
      : The current version of
     
     <a id="_idIndexMarker757">
     </a>
     
      the
     
     <strong class="bold">
      
       common language
      
     </strong>
     
      <strong class="bold">
       
        runtime
       
      </strong>
     
     
      
       (
      
     
     
      <strong class="bold">
       
        CLR
       
      </strong>
     
     
      
       ).
      
     
    </li>
    <li>
     <strong class="source-inline">
      
       ext_*
      
     </strong>
     
      : The prefix added to any parameter to refer to variables of the parent template (
     
     
      
       e.g.,
      
     
     
      <strong class="source-inline">
       
        ext_safeprojectname
       
      </strong>
     
     
      
       ).
      
     
    </li>
    <li>
     <strong class="source-inline">
      
       guid[1-10]
      
     </strong>
     
      : A GUID used to replace the project GUID in a project file.
     
     
      Up to 10 unique GUIDs can be specified (
     
     
      
       e.g.,
      
     
     
      <strong class="source-inline">
       
        guid1
       
      </strong>
     
     
      
       ).
      
     
    </li>
    <li>
     <strong class="source-inline">
      
       itemname
      
     </strong>
     
      : The name of the file in which the parameter is
     
     
      
       being used.
      
     
    </li>
    <li>
     <strong class="source-inline">
      
       machinename
      
     </strong>
     
      : The current computer name (
     
     
      
       e.g.,
      
     
     
      <strong class="source-inline">
       
        Computer01
       
      </strong>
     
     
      
       ).
      
     
    </li>
    <li>
     <strong class="source-inline">
      
       projectname
      
     </strong>
     
      : The name provided by the user when the project was created.
     
     
      This applies only to
     
     
      
       project templates.
      
     
    </li>
    <li>
     <strong class="source-inline">
      
       registeredorganization
      
     </strong>
     
      : The registry key value
     
     
      
       from
      
     
     
      <strong class="source-inline">
       
        HKEY_LOCAL_MACHINE\Software\Microsoft\WindowsNT\CurrentVersion\RegisteredOrganization
       
      </strong>
     
     
      
       .
      
     
    </li>
    <li>
     <strong class="source-inline">
      
       rootnamespace
      
     </strong>
     
      : The root namespace of the current project followed by the subfolder of the current item, with slashes replaced
     
     
      
       by periods.
      
     
    </li>
    <li>
     <strong class="source-inline">
      
       defaultnamespace
      
     </strong>
     
      : The root namespace of the
     
     
      
       current project.
      
     
    </li>
    <li>
     <strong class="source-inline">
      
       safeitemname
      
     </strong>
     
      : The same as
     
     <strong class="source-inline">
      
       itemname
      
     </strong>
     
      but with all unsafe characters and spaces replaced by
     
     
      
       underscore characters.
      
     
    </li>
    <li>
     <strong class="source-inline">
      
       safeitemrootname
      
     </strong>
     
      : Same
     
     
      
       as
      
     
     
      <strong class="source-inline">
       
        safeitemname
       
      </strong>
     
     
      
       .
      
     
    </li>
    <li>
     <strong class="source-inline">
      
       safeprojectname
      
     </strong>
     
      : The name provided by the user when the project was created but with all unsafe characters and spaces removed.
     
     
      This applies only to
     
     
      
       project templates.
      
     
    </li>
    <li>
     <strong class="source-inline">
      
       targetframeworkversion
      
     </strong>
     
      : The current version of the target .
     
     
      
       NET Framework.
      
     
    </li>
    <li>
     <strong class="source-inline">
      
       time
      
     </strong>
     
      : The current time in a format based on Windows user settings (e.g.,
     
     
      
       DD/MM/YYYY 00:00:00).
      
     
    </li>
    <li>
     <strong class="source-inline">
      
       specifiedsolutionname
      
     </strong>
     
      : The
     
     <a id="_idIndexMarker758">
     </a>
     
      name of the solution.
     
     
      Behavior varies based on whether
     
     <strong class="bold">
      
       Place solution and project in the same directory
      
     </strong>
     
      or
     
     <strong class="bold">
      
       Create solution directory
      
     </strong>
     
      
       is checked.
      
     
    </li>
    <li>
     <strong class="source-inline">
      
       userdomain
      
     </strong>
     
      : The current
     
     
      
       user domain.
      
     
    </li>
    <li>
     <strong class="source-inline">
      
       username
      
     </strong>
     
      : The
     
     
      
       current username.
      
     
    </li>
    <li>
     <strong class="source-inline">
      
       webnamespace
      
     </strong>
     
      : The name of the current website, used in web form templates to guarantee unique
     
     
      
       class names.
      
     
    </li>
    <li>
     <strong class="source-inline">
      
       year
      
     </strong>
     
      : The current year in
     
     
      
       YYYY format.
      
     
    </li>
    <li>
     <strong class="source-inline">
      
       solutiondirectory
      
     </strong>
     
      : The directory of
     
     
      
       the solution.
      
     
    </li>
    <li>
     <strong class="source-inline">
      
       destinationdirectory
      
     </strong>
     
      : The path to the directory of the
     
     <strong class="source-inline">
      
       .csproj
      
     </strong>
     
      
       once created.
      
     
    </li>
   </ul>
   <p>
    
     These reserved parameters can be used to dynamically insert project-specific information into your templates.
    
    
     For instance, we can use the
    
    <strong class="source-inline">
     
      $safeprojectname$
     
    </strong>
    
     and
    
    <strong class="source-inline">
     
      $year$
     
    </strong>
    
     reserved parameters to dynamically generate the namespace and add a
    
    
     
      copyright notice.
     
    
   </p>
   <p>
    
     For this example, we will create a new template manually.
    
    
     This example will focus on creating a C# class library project template that uses several reserved template parameters to dynamically generate namespaces, class names, and file names based on user input and system information.
    
    
     Let’s get started with
    
    
     
      the steps:
     
    
   </p>
   <ol>
    <li>
     
      First, define the
     
     <a id="_idIndexMarker759">
     </a>
     
      structure of our project template in a
     
     <strong class="source-inline">
      
       .vstemplate
      
     </strong>
     
      file.
     
     
      This file specifies what gets created when the template
     
     
      
       is instantiated:
      
     
     <pre class="source-code">
&lt;VSTemplate Version="3.0.0"
  xmlns="http://schemas.microsoft.com/developer/
         vstemplate/2005"
  Type="Project"&gt;
  &lt;TemplateData&gt;
    &lt;Name&gt;Masterize VS ClassTemplate&lt;/Name&gt;
    &lt;Description&gt;TemplateParametre&lt;/Description&gt;
    &lt;ProjectType&gt;CSharp&lt;/ProjectType&gt;
    &lt;SortOrder&gt;1000&lt;/SortOrder&gt;
    &lt;CreateNewFolder&gt;true&lt;/CreateNewFolder&gt;
    &lt;DefaultName&gt;ClassTemplate&lt;/DefaultName&gt;
    &lt;ProvideDefaultName&gt;true&lt;/ProvideDefaultName&gt;
    &lt;LocationField&gt;Enabled&lt;/LocationField&gt;
    &lt;EnableLocationBrowseButton&gt;
      true
    &lt;/EnableLocationBrowseButton&gt;
    &lt;CreateInPlace&gt;true&lt;/CreateInPlace&gt;
    &lt;Icon&gt;__TemplateIcon.ico&lt;/Icon&gt;
  &lt;/TemplateData&gt;
  &lt;TemplateContent&gt;
    &lt;Project TargetFileName="ClassTemplate.csproj"
      File="ClassTemplate.csproj"
      ReplaceParameters="true"&gt;
      &lt;ProjectItem
        ReplaceParameters="true"
        TargetFileName="Class1.cs"&gt;
        Class1.cs
      &lt;/ProjectItem&gt;
      &lt;ProjectItem
        ReplaceParameters="true"&gt;
        Properties\AssemblyInfo.cs
      &lt;/ProjectItem&gt;
    &lt;/Project&gt;
  &lt;/TemplateContent&gt;
&lt;/VSTemplate&gt;</pre>
     <p class="list-inset">
      
       Notice that it’s common
      
      <a id="_idIndexMarker760">
      </a>
      
       practice to specify
      
      <strong class="source-inline">
       
        TargetFileName
       
      </strong>
      
       for every
      
      <strong class="source-inline">
       
        ProjectItem
       
      </strong>
      
       if you need them to have a specific name in the newly created project.
      
      
       The second
      
      <strong class="source-inline">
       
        &lt;ProjectItem&gt;
       
      </strong>
      
       (
      
      <strong class="source-inline">
       
        Properties\AssemblyInfo.cs
       
      </strong>
      
       ) does not have
      
      <strong class="source-inline">
       
        TargetFileName
       
      </strong>
      
       .
      
      
       If you want to ensure that this file has the same name in the new project, this is fine.
      
      
       If you want to replace parameters, it should also have the
      
      <strong class="source-inline">
       
        ReplaceParameters="true"
       
      </strong>
      
       attribute (as it
      
      
       
        currently does).
       
      
     </p>
    </li>
    <li>
     
      Next, create a C# class file named
     
     <strong class="source-inline">
      
       Class1.cs
      
     </strong>
     
      that will be part of our template.
     
     
      We’ll use the
     
     <strong class="source-inline">
      
       $safeprojectname$
      
     </strong>
     
      and
     
     <strong class="source-inline">
      
       $year$
      
     </strong>
     
      reserved parameters to dynamically generate the namespace and add a
     
     
      
       copyright notice:
      
     
     <pre class="source-code">
using System;
namespace $safeprojectname$
{
    /// &lt;summary&gt;
    /// Represents a simple class in the
    /// $safeprojectname$ project.
    /// Copyright (c) $year$ by Company name
    /// &lt;/summary&gt;
    public class Class1
    {
        public Class1()
        {
            Console.WriteLine(
                "Hello from $safeprojectname$!"
            );
        }
    }
}</pre>
    </li>
    <li>
     
      We will also
     
     <a id="_idIndexMarker761">
     </a>
     
      create an
     
     <strong class="source-inline">
      
       AssemblyInfo.cs
      
     </strong>
     
      file under a
     
     <strong class="source-inline">
      
       Properties
      
     </strong>
     
      folder within our template.
     
     
      This file will contain assembly metadata, and we’ll use the
     
     <strong class="source-inline">
      
       $projectname$
      
     </strong>
     
      ,
     
     <strong class="source-inline">
      
       $year$
      
     </strong>
     
      , and
     
     <strong class="source-inline">
      
       $username$
      
     </strong>
     
      reserved parameters to customize the assembly title
     
     
      
       and copyright:
      
     
     <pre class="source-code">
using System.Reflection;
using System.Runtime.CompilerServices;
[assembly: AssemblyTitle("$projectname$")]
[assembly: AssemblyDescription("A simple class library project.")]
[assembly: AssemblyCompany("Your Company")]
[assembly: AssemblyProduct("$projectname$")]
[assembly: AssemblyCopyright("Copyright © $year$ $username$. All rights reserved.")]
[assembly: AssemblyTrademark("")]
[assembly: AssemblyVersion("1.0.*")]</pre>
    </li>
    <li>
     
      After creating these
     
     <a id="_idIndexMarker762">
     </a>
     
      files, package them into a
     
     <strong class="source-inline">
      
       .zip
      
     </strong>
     
      file and place them in the Visual Studio templates directory or import them through Visual Studio’s
     
     
      
       template manager.
      
     
    </li>
   </ol>
   <p>
    
     When creating a new project based on this template, Visual Studio will prompt us for the project name and location.
    
    
     As a result, the
    
    <strong class="source-inline">
     
      Class1.cs
     
    </strong>
    
     file will be filled with the provided values:
    
   </p>
   <div><div><img alt="Figure 13.5 – Generate Class1" src="img/B22218_13_5.jpg"/>
     
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    
     Figure 13.5 – Generate Class1
    
   </p>
   <p>
    
     It will then replace the reserved parameters in the template files with the actual values, such as the safe project
    
    <a id="_idIndexMarker763">
    </a>
    
     name, current year, and username.
    
    
     In this example, I choose
    
    <strong class="source-inline">
     
      DummyTemplate
     
    </strong>
    
     as the project name and the system takes the current year to set the
    
    <strong class="source-inline">
     
      $
     
    </strong>
    
     <strong class="source-inline">
      
       year$
      
     </strong>
    
    
     
      parameter.
     
    
   </p>
   <p>
    
     At the point when we create a project from our custom template, you might notice that we can use the filter combo box to filter them.
    
    
     Within the
    
    <strong class="source-inline">
     
      &lt;TemplateData&gt;
     
    </strong>
    
     section of our
    
    <strong class="source-inline">
     
      .vstemplate
     
    </strong>
    
     file, we can add the following elements to
    
    
     
      specify tags:
     
    
   </p>
   <ul>
    <li>
     <strong class="source-inline">
      
       &lt;LanguageTag&gt;
      
     </strong>
     
      : This specifies the programming languages used in
     
     
      
       the template
      
     
    </li>
    <li>
     <strong class="source-inline">
      
       &lt;PlatformTag&gt;
      
     </strong>
     
      : This indicates the target platforms (e.g.,
     
     
      
       Windows, web)
      
     
    </li>
    <li>
     <strong class="source-inline">
      
       &lt;ProjectTypeTag&gt;
      
     </strong>
     
      : This describes the type of project (e.g., Class Library,
     
     
      
       Console Application)
      
     
    </li>
   </ul>
   <p>
    
     Each tag element should contain the name of the tag as its
    
    
     
      text content:
     
    
   </p>
   <pre class="source-code">
&lt;TemplateData&gt;
    …
    &lt;LanguageTag&gt;C#&lt;/LanguageTag&gt;
    &lt;PlatformTag&gt;Windows&lt;/PlatformTag&gt;
    &lt;ProjectTypeTag&gt;Class Library&lt;/ProjectTypeTag&gt;
&lt;/TemplateData&gt;</pre>
   <p>
    
     When updating our template this way, we can observe the tags that appear on the description in the
    
    
     
      template list.
     
    
   </p>
   <div><div><img alt="Figure 13.6 – Template list with tags" src="img/B22218_13_6.jpg"/>
     
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    
     Figure 13.6 – Template list with tags
    
   </p>
   <p>
    
     These tags allow us to
    
    <a id="_idIndexMarker764">
    </a>
    
     leverage the three filters upon the list when we are looking for
    
    
     
      a template.
     
    
   </p>
   <p>
    
     Sometimes, we need more than one project, and we expect to be more productive with a ready-to-use solution with multi-library projects to scaffold a clean architecture, for example; let’s see in the next section how we can
    
    
     
      achieve that.
     
    
   </p>
   <h1 id="_idParaDest-188">
    <a id="_idTextAnchor189">
    </a>
    
     Extending project templates with advanced features
    
   </h1>
   <p>
    
     In this section, we
    
    <a id="_idIndexMarker765">
    </a>
    
     will go further by creating what we can call a solution template by combining multiple
    
    
     
      project templates.
     
    
   </p>
   <p>
    
     Creating a multi-project solution template in Visual Studio involves several steps, including creating individual project templates, combining them into a single solution template, and configuring the solution template to instantiate multiple projects upon creation.
    
    
     Let’s
    
    
     
      get started:
     
    
   </p>
   <ol>
    <li>
     
      First, create the templates that will be included in the solution template.
     
     
      For that, follow the instructions provided in the
     
     <em class="italic">
      
       Building a basic project template
      
     </em>
     
      section of
     
     
      
       this chapter.
      
     
    </li>
    <li>
     
      Next, prepare a directory structure for the solution template.
     
     
      This involves creating a folder for the solution template and copying the unzipped contents of each project template into
     
     
      
       this directory.
      
     
    </li>
   </ol>
   <div><div><img alt="Figure 13.7 – Folder structure" src="img/B22218_13_7.jpg"/>
     
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    
     Figure 13.7 – Folder structure
    
   </p>
   <ol>
    <li value="3">
     
      For this example, I created three project templates to scaffold
     
     
      
       the solution.
      
     
    </li>
    <li>
     
      Now, create or modify a
     
     <strong class="source-inline">
      
       .vstemplate
      
     </strong>
     
      file in the root of the solution template directory.
     
     
      This file defines the structure of our solution template, including references to the individual project templates.
     
     
      In this file, we set the
     
     <strong class="bold">
      
       Project Type
      
     </strong>
     
      option to
     
     <strong class="source-inline">
      
       ProjectGroup
      
     </strong>
     
      to indicate that this template represents a collection of projects
     
     
      
       as follows:
      
     
     <pre class="source-code">
&lt;VSTemplate Version="3.0.0"
  xmlns="http://schemas.microsoft.com/developer/
         vstemplate/2005"
  Type="ProjectGroup"&gt;
  &lt;TemplateData&gt;
    &lt;Name&gt;CleanDummyArch&lt;/Name&gt;
    &lt;Description&gt;Dummy solution&lt;/Description&gt;
    &lt;ProjectType&gt;Web&lt;/ProjectType&gt;
    &lt;ProjectSubType&gt;CSharp&lt;/ProjectSubType&gt;
    &lt;SortOrder&gt;1000&lt;/SortOrder&gt;
    &lt;CreateNewFolder&gt;true&lt;/CreateNewFolder&gt;
    &lt;DefaultName&gt;DummySolution&lt;/DefaultName&gt;
    &lt;ProvideDefaultName&gt;true&lt;/ProvideDefaultName&gt;
    &lt;LocationField&gt;Enabled&lt;/LocationField&gt;
    &lt;EnableLocationBrowseButton&gt;
      True
    &lt;/EnableLocationBrowseButton&gt;
    &lt;CreateInPlace&gt;true&lt;/CreateInPlace&gt;
    &lt;Icon&gt;__TemplateIcon.ico&lt;/Icon&gt;
    &lt;LanguageTag&gt;C#&lt;/LanguageTag&gt;
    &lt;PlatformTag&gt;Windows&lt;/PlatformTag&gt;
    &lt;ProjectTypeTag&gt;Class Library&lt;/ProjectTypeTag&gt;
  &lt;/TemplateData&gt;
  &lt;TemplateContent&gt;
    &lt;ProjectCollection&gt;
      &lt;ProjectTemplateLink
        ProjectName="$safeprojectname$"&gt;
          Dummy\MyTemplate.vstemplate
      &lt;/ProjectTemplateLink&gt;
      &lt;ProjectTemplateLink
        ProjectName="$safeprojectname$.Application"&gt;
          Application\MyTemplate.vstemplate
      &lt;/ProjectTemplateLink&gt;
      &lt;ProjectTemplateLink
        ProjectName="$safeprojectname$.Models"&gt;
          Models\MyTemplate.vstemplate
      &lt;/ProjectTemplateLink&gt;
    &lt;/ProjectCollection&gt;
  &lt;/TemplateContent&gt;
&lt;/VSTemplate&gt;</pre>
    </li>
    <li>
     
      Inside
     
     <strong class="source-inline">
      
       &lt;TemplateContent&gt;
      
     </strong>
     
      , we use
     
     <strong class="source-inline">
      
       &lt;ProjectCollection&gt;
      
     </strong>
     
      instead of
     
     <strong class="source-inline">
      
       &lt;Project&gt;
      
     </strong>
     
      to define a collection of projects.
     
     
      Each child project is linked by a
     
     <strong class="source-inline">
      
       &lt;ProjectTemplateLink&gt;
      
     </strong>
     
      element that establishes the link, pointing to the relative path of the
     
     <a id="_idIndexMarker766">
     </a>
     
      project template within the solution
     
     
      
       template directory.
      
     
    </li>
    <li>
     
      Once our solution template is configured, we do
     
     
      
       the following:
      
     
     <ul>
      <li>
       
        We zip the contents of the solution template directory, including the modified
       
       <strong class="source-inline">
        
         .vstemplate
        
       </strong>
       
        file and the unzipped
       
       
        
         project templates
        
       
      </li>
      <li>
       
        We place the zipped file in the Visual Studio templates directory or import it through Visual Studio’s
       
       
        
         template manager
        
       
      </li>
     </ul>
    </li>
    <li>
     
      Finally, test the solution template by creating a new project from it in Visual Studio to ensure that it correctly generates a solution with all the desired projects, through
     
     
      <strong class="bold">
       
        Solution Explorer
       
      </strong>
     
     
      
       .
      
     
    </li>
   </ol>
   <div><div><img alt="Figure 13.8 – Solution architecture" src="img/B22218_13_8.jpg"/>
     
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    
     Figure 13.8 – Solution architecture
    
   </p>
   <p>
    
     As a result, we initiate
    
    <a id="_idIndexMarker767">
    </a>
    
     a solution with three projects as defined in the template.
    
    
     This process allows us to create a reusable template for a solution that includes multiple projects, streamlining the setup of new solutions based on predefined configurations, saving time and ensuring consistency
    
    
     
      across projects.
     
    
   </p>
   <h1 id="_idParaDest-189">
    <a id="_idTextAnchor190">
    </a>
    
     Summary
    
   </h1>
   <p>
    
     In this chapter, we’ve explored the art of crafting custom project templates in Visual Studio 2022, a crucial skill for any developer aiming to standardize and accelerate their workflow.
    
    
     We began by understanding the fundamental structures that form the backbone of project templates.
    
    
     We then delved into customization, showing you how to adapt these templates to suit different workflows, ensuring they meet the specific needs of your projects.
    
    
     From there, we explored the integration of parameters, allowing you to add dynamic elements to your templates for greater flexibility.
    
    
     Finally, we expanded our focus to include advanced features, enabling you to create solution templates that can manage intricate, multi-project solutions
    
    
     
      with ease.
     
    
   </p>
   <p>
    
     As we move forward, we’ll build on this knowledge by exploring another powerful aspect of Visual Studio: creating your own extensions.
    
    
     In the next chapter, we’ll dive into the world of custom tooling, where you’ll learn how to enhance your development environment even further by creating and deploying extensions tailored to your
    
    
     
      unique needs.
     
    
   </p>
  </div>
 </body></html>