<html><head></head><body>
<div class="Basic-Text-Frame" id="_idContainer301">
<h1 class="chapterNumber"><span class="koboSpan" id="kobo.1.1">19</span></h1>
<h1 class="chapterTitle" id="_idParaDest-376"><span class="koboSpan" id="kobo.2.1">Client Frameworks: Blazor</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.3.1">In this chapter, you will learn how to implement presentation layers based on client technologies. </span><span class="koboSpan" id="kobo.3.2">Applications based on server technologies, like ASP.NET Core MVC, run all application layers on the server, thus also creating on the server the HTML that encodes the whole UI. </span><span class="koboSpan" id="kobo.3.3">Applications based on client technologies, instead, run the whole presentation layer on the client machine (mobile device, desktop computer, laptop, etc.) thus interacting with a server just to exchange data with the web API.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.4.1">In other words, in an application based on client technology, the whole UI is created by code that runs on the user device, which also controls the whole user-application interaction. </span><span class="koboSpan" id="kobo.4.2">Both the business layer and the domain layer, instead, run on server machines to prevent users from violating business rules and authorization policies by hacking the code that runs on their devices.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.5.1">In turn, applications based on client technologies can be classified as single-page applications, which benefit from web standards, or as native applications, which are tied to specific operating systems and the advantages of specific device peculiarities. </span></p>
<p class="normal"><span class="koboSpan" id="kobo.6.1">Single-page applications are based on JavaScript or WebAssembly and run in any browser. </span><span class="koboSpan" id="kobo.6.2">As an example of a single-page application, we will analyze the Blazor WebAssembly framework</span></p>
<p class="normal"><span class="koboSpan" id="kobo.7.1">Blazor WebAssembly applications are developed in C# and use many technologies we already analyzed in </span><em class="italic"><span class="koboSpan" id="kobo.8.1">Chapter 17</span></em><span class="koboSpan" id="kobo.9.1">, </span><em class="italic"><span class="koboSpan" id="kobo.10.1">Presenting ASP.NET Core</span></em><span class="koboSpan" id="kobo.11.1">, such as dependency injection and Razor. </span><span class="koboSpan" id="kobo.11.2">Therefore, we strongly recommend studying </span><em class="italic"><span class="koboSpan" id="kobo.12.1">Chapter 17</span></em><span class="koboSpan" id="kobo.13.1">, </span><em class="italic"><span class="koboSpan" id="kobo.14.1">Presenting ASP.NET Core</span></em><span class="koboSpan" id="kobo.15.1">, and </span><em class="italic"><span class="koboSpan" id="kobo.16.1">Chapter 18</span></em><span class="koboSpan" id="kobo.17.1">, </span><em class="italic"><span class="koboSpan" id="kobo.18.1">Implementing Frontend Microservices with ASP.NET Core</span></em><span class="koboSpan" id="kobo.19.1">, before reading this chapter.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.20.1">As an example of native technologies, we will analyze native .NET MAUI Blazor, which is completely analogous to Blazor WebAssembly but instead of using browser WebAssembly, it uses .NET, which is compiled just in time into the assembly of the target device. </span><span class="koboSpan" id="kobo.20.2">Not being limited by browser restrictions, .NET MAUI Blazor can access all device features through adequate .NET libraries.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.21.1">More specifically, in this chapter, you will learn about the following subjects:</span></p>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.22.1">Comparison of the various types of client technologies</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.23.1">Blazor WebAssembly architecture</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.24.1">Blazor pages and components</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.25.1">Blazor forms and validation</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.26.1">Blazor advanced features, such as JavaScript interoperability, globalization, authentication, and more</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.27.1">Third-party tools for Blazor WebAssembly</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.28.1">.NET MAUI Blazor</span></li>
</ul>
<p class="normal"><span class="koboSpan" id="kobo.29.1">While there is also server-side Blazor, which runs on the server like ASP.NET Core MVC, this chapter discusses just Blazor WebAssembly and .NET MAUI Blazor, since the main focus of the chapter is client-side technology. </span><span class="koboSpan" id="kobo.29.2">Moreover, server-side Blazor can’t provide a performance that is comparable with other server-side technologies, like ASP.NET Core MVC, which we analyzed in </span><em class="italic"><span class="koboSpan" id="kobo.30.1">Chapter 17</span></em><span class="koboSpan" id="kobo.31.1">, </span><em class="italic"><span class="koboSpan" id="kobo.32.1">Presenting ASP.NET Core</span></em><span class="koboSpan" id="kobo.33.1">.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.34.1">The first section summarizes and compares the various kinds of client technologies, while the remainder of the chapter discusses in detail Blazor WebAssembly and .NET MAUI Blazor.</span></p>
<h1 class="heading-1" id="_idParaDest-377"><span class="koboSpan" id="kobo.35.1">Technical requirements</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.36.1">This chapter requires the free Visual Studio 2022 Community edition or better with all the database tools installed.</span></p>
<div class="note">
<p class="normal"><span class="koboSpan" id="kobo.37.1">All concepts are clarified with simple example applications based on the WWTravelClub book use case you can find in the </span><em class="italic"><span class="koboSpan" id="kobo.38.1">Using client technologies</span></em><span class="koboSpan" id="kobo.39.1"> section of </span><em class="italic"><span class="koboSpan" id="kobo.40.1">Chapter 21</span></em><span class="koboSpan" id="kobo.41.1">, </span><em class="italic"><span class="koboSpan" id="kobo.42.1">Case Study</span></em><span class="koboSpan" id="kobo.43.1">.</span></p>
</div>
<p class="normal"><span class="koboSpan" id="kobo.44.1">The code for this chapter is available at </span><a href="https://github.com/PacktPublishing/Software-Architecture-with-C-Sharp-12-and-.NET-8-4E"><span class="url"><span class="koboSpan" id="kobo.45.1">https://github.com/PacktPublishing/Software-Architecture-with-C-Sharp-12-and-.NET-8-4E</span></span></a><span class="koboSpan" id="kobo.46.1">.</span></p>
<h1 class="heading-1" id="_idParaDest-378"><span class="koboSpan" id="kobo.47.1">Comparison of the various types of client technologies</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.48.1">This </span><a id="_idIndexMarker1307"/><span class="koboSpan" id="kobo.49.1">section discusses the various types of client technologies:</span></p>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.50.1">Single-page applications, which run in the browser with all browser restrictions</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.51.1">Progressive applications, which run in the browser but can be installed like usual applications and can overcome some browser restrictions (after user permission is granted)</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.52.1">Native applications, which are tied to a specific device/operating system but can take full advantage of all device/operating system features</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.53.1">Cross-platform technologies, which, like native applications, can take full advantage of all device features but are compatible with several devices/operating systems</span></li>
</ul>
<h2 class="heading-2" id="_idParaDest-379"><span class="koboSpan" id="kobo.54.1">Single-page applications</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.55.1">There are</span><a id="_idIndexMarker1308"/><span class="koboSpan" id="kobo.56.1"> many reasons why web development has increased in recent decades, but the most basic one is the ability to deploy any new version of the application to many users at the same time. </span><span class="koboSpan" id="kobo.56.2">Moreover, the security policies that are automatically enforced by all browsers encourage the usage and diffusion of web applications.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.57.1">So, a good question </span><a id="_idIndexMarker1309"/><span class="koboSpan" id="kobo.58.1">here would be, why is web development not used today? </span><span class="koboSpan" id="kobo.58.2">The best answer would be a lack of connectivity. </span><span class="koboSpan" id="kobo.58.3">As a software architect, you need to be alert to this, as we discussed in </span><em class="italic"><span class="koboSpan" id="kobo.59.1">Chapter 2</span></em><span class="koboSpan" id="kobo.60.1">, </span><em class="italic"><span class="koboSpan" id="kobo.61.1">Non-Functional Requirements</span></em><span class="koboSpan" id="kobo.62.1">.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.63.1">Sometimes, it is not only a matter of having connectivity or not. </span><span class="koboSpan" id="kobo.63.2">Sometimes, a big problem is instability, and don’t forget the difficulties you will encounter from unexpected scenarios that web apps will generate once they’re out in the world.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.64.1">For instance, in the WWTravelClub case, there is a first user story that says: </span><em class="italic"><span class="koboSpan" id="kobo.65.1">“As a common user, I want to view promotional packages on the home page, so that I can easily find my next vacation.”</span></em><span class="koboSpan" id="kobo.66.1"> At first sight, you may determine that a web app is the only option, especially because there is also a system requirement that says: </span><em class="italic"><span class="koboSpan" id="kobo.67.1">“The system will run on the Windows, Linux, iOS, and Android platforms.”</span></em></p>
<p class="normal"><span class="koboSpan" id="kobo.68.1">However, imagine that a user browsed a lot of destinations and packages to find their perfect vacation, and they are going to reserve it when suddenly, the web application crashes because of a lack of web connectivity. </span><span class="koboSpan" id="kobo.68.2">In this situation, the user would lose all their browsing</span><a id="_idIndexMarker1310"/><span class="koboSpan" id="kobo.69.1"> effort and would be forced to start searching for the package from scratch once web connectivity is restored. </span><span class="koboSpan" id="kobo.69.2">The issue can </span><a id="_idIndexMarker1311"/><span class="koboSpan" id="kobo.70.1">be overcome just with an application that is able to save its state instead of crashing when there are web connectivity issues. </span><span class="koboSpan" id="kobo.70.2">This way, the user can complete their task as soon as web connectivity is restored, without wasting whatever effort they had already put in before the web connectivity issue.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.71.1">So maybe, for some parts of the solution, a native application with some data already downloaded would be a better option. </span><span class="koboSpan" id="kobo.71.2">However, the issue can also be solved with a particular kind of modern web application, progressive applications, which we will analyze in the next subsection.</span></p>
<h2 class="heading-2" id="_idParaDest-380"><span class="koboSpan" id="kobo.72.1">Progressive applications</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.73.1">Progressive </span><a id="_idIndexMarker1312"/><span class="koboSpan" id="kobo.74.1">web applications are single-page applications that run in the browser but can be installed like native applications. </span><span class="koboSpan" id="kobo.74.2">Moreover, they can run offline.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.75.1">Progressive applications </span><a id="_idIndexMarker1313"/><span class="koboSpan" id="kobo.76.1">are a new web standard that is supported by all mainstream browsers. </span><span class="koboSpan" id="kobo.76.2">If you require all the advantages of web applications, but you also need the ability to work offline like a native application, progressive web applications are the right choice for you.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.77.1">However, keep in mind that progressive web applications can’t ensure the same performance and flexibility as native applications.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.78.1">Blazor WebAssembly, as</span><a id="_idIndexMarker1314"/><span class="koboSpan" id="kobo.79.1"> we will describe in the next sections of this chapter, supports progressive web applications. </span><span class="koboSpan" id="kobo.79.2">Check</span><a id="_idIndexMarker1315"/><span class="koboSpan" id="kobo.80.1"> the </span><strong class="keyWord"><span class="koboSpan" id="kobo.81.1">Progressive Web Application</span></strong><span class="koboSpan" id="kobo.82.1"> checkbox that appears when you create a Blazor WebAssembly project. </span><span class="koboSpan" id="kobo.82.2">This is all you need to do to create a Blazor progressive web application.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.83.1">If you ship your Blazor application as a progressive application, you overcome the problem of the initial download time (4-8 seconds), which is the main disadvantage of Blazor. </span></p>
<p class="normal"><span class="koboSpan" id="kobo.84.1">While progressive web applications are installed applications, they automatically update to the last available version, because each time they are launched, they verify if a more recent version is available, and if there is one, they automatically download it before running. </span><span class="koboSpan" id="kobo.84.2">That is, they have the advantage of automatically running the most recent available version that characterizes all classical web applications.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.85.1">The option </span><a id="_idIndexMarker1316"/><span class="koboSpan" id="kobo.86.1">to install the Blazor progressive web application is not available during development because this would interfere with the usual modification test cycle. </span><span class="koboSpan" id="kobo.86.2">Therefore, you need to publish your application to test its progressive application peculiarities.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.87.1">It is worth</span><a id="_idIndexMarker1317"/><span class="koboSpan" id="kobo.88.1"> pointing out that progressive applications must be organized to take full advantage of their ability to work offline. </span><span class="koboSpan" id="kobo.88.2">Therefore, following repeated communication errors, the application should save all the data to be sent to the server in the browser’s local storage while waiting for a connection to be established successfully.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.89.1">It is also possible to maintain the whole application state in a centralized service so that the user can serialize and save it to local storage before quitting the application. </span><span class="koboSpan" id="kobo.89.2">This way, when the application is offline, data to be sent to the server is not lost because it remains in the application state that is saved to disk.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.90.1">When a progressive web application doesn’t fulfill your requirements because it is not able to use the specific device features you need, but you must support several different devices, you should consider cross-platform native applications, which have full access to all device features but can still support several hardware/software platforms. </span><span class="koboSpan" id="kobo.90.2">We will discuss them in the next subsection.</span></p>
<h2 class="heading-2" id="_idParaDest-381"><span class="koboSpan" id="kobo.91.1">Native applications</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.92.1">Native </span><a id="_idIndexMarker1318"/><span class="koboSpan" id="kobo.93.1">development </span><a id="_idIndexMarker1319"/><span class="koboSpan" id="kobo.94.1">can be considered the beginning of UI development. </span><span class="koboSpan" id="kobo.94.2">There was no concept of sharing code between machines with diverse hardware when the idea of assigning software production to another person/company originally emerged.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.95.1">This is the first good answer as to why we have good performance on native applications. </span><span class="koboSpan" id="kobo.95.2">We cannot forget that native apps run better just because they are near the hardware, most of the time connected to the OS directly or by using a framework, such as .NET. </span><span class="koboSpan" id="kobo.95.3">Be careful; we are not only talking about native mobile apps, but we are also discussing apps delivered in Windows, Linux, Mac, Android, or any other OS that can run apps.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.96.1">Considering this scenario, the big question is – when do I have to use a native app? </span><span class="koboSpan" id="kobo.96.2">There are some </span><a id="_idIndexMarker1320"/><span class="koboSpan" id="kobo.97.1">cases where this would be a good idea:</span></p>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.98.1">There is no need to deploy on different platforms.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.99.1">There is a huge connection to the hardware.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.100.1">The performance provided by a web client is not acceptable.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.101.1">The application needs device resources that can’t be accessed through a browser because of a browser’s security policies.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.102.1">The place where the application will run has connectivity problems.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.103.1">The worst case is the one where you need two things at the same time: better performance than a web client and different platforms. </span><span class="koboSpan" id="kobo.103.2">In this scenario, you will probably have to deliver two applications, and the way you have designed the backend of this solution will be extremely important for reducing maintenance and costs as regards development.</span></li>
</ul>
<p class="normal"><span class="koboSpan" id="kobo.104.1">The </span><a id="_idIndexMarker1321"/><span class="koboSpan" id="kobo.105.1">decision between developing native or not can be difficult to take </span><a id="_idIndexMarker1322"/><span class="koboSpan" id="kobo.106.1">without a </span><strong class="keyWord"><span class="koboSpan" id="kobo.107.1">proof of concept</span></strong><span class="koboSpan" id="kobo.108.1"> (</span><strong class="keyWord"><span class="koboSpan" id="kobo.109.1">POC</span></strong><span class="koboSpan" id="kobo.110.1">). </span><span class="koboSpan" id="kobo.110.2">As a software architect, you should be the one to recommend this kind of POC.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.111.1">Examples of native applications that you can develop with C# are the classical Windows Forms and Windows Presentation Foundation, which are specific to the Windows operating system. </span><span class="koboSpan" id="kobo.111.2">Also, there is Xamarin, a platform that allows for the development of applications that can be published on both Android and iOS.</span></p>
<h2 class="heading-2" id="_idParaDest-382"><span class="koboSpan" id="kobo.112.1">Cross-platform applications</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.113.1">Although</span><a id="_idIndexMarker1323"/><span class="koboSpan" id="kobo.114.1"> performance can be a difficult requirement to achieve, in </span><a id="_idIndexMarker1324"/><span class="koboSpan" id="kobo.115.1">many scenarios, due to the simplicity of the solution, this is not the Achilles’ heel of the application. </span><span class="koboSpan" id="kobo.115.2">Considering WWTravelClub, although it would be useful to have the offline experience mentioned before, the performance itself is not the most difficult one to achieve.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.116.1">In these scenarios, cross-platform technologies make total sense. </span><span class="koboSpan" id="kobo.116.2">Among them, it is worth mentioning Xamarin.Forms and the new .NET MAUI, which can be published on Android, iOS, and Windows.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.117.1">The advised choice of cross-platform application is .NET MAUI. </span><span class="koboSpan" id="kobo.117.2">However, at the moment, MAUI supports Windows and all </span><a id="_idIndexMarker1325"/><span class="koboSpan" id="kobo.118.1">main mobile platforms but not Linux. </span><span class="koboSpan" id="kobo.118.2">Uno Platform (</span><a href="https://platform.uno/"><span class="url"><span class="koboSpan" id="kobo.119.1">https://platform.uno/</span></span></a><span class="koboSpan" id="kobo.120.1">) also supports Linux together with all main mobile platforms but is not a Microsoft product maintained by Microsoft. </span><span class="koboSpan" id="kobo.120.2">Anyway, it can be downloaded as a Visual Studio extension.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.121.1">In this chapter, we </span><a id="_idIndexMarker1326"/><span class="koboSpan" id="kobo.122.1">will not analyze Uno or all the options offered by .NET MAUI but just .NET MAUI Blazor since it is very similar to Blazor WebAssembly. </span><span class="koboSpan" id="kobo.122.2">So, learning Blazor enables us to develop single-page applications, progressive applications, and cross-platform applications.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.123.1">.NET MAUI Blazor is described in the </span><em class="italic"><span class="koboSpan" id="kobo.124.1">.NET MAUI Blazor</span></em><span class="koboSpan" id="kobo.125.1"> section of this chapter, while the next section describes the basics of Blazor WebAssembly architecture.</span></p>
<h1 class="heading-1" id="_idParaDest-383"><span class="koboSpan" id="kobo.126.1">Blazor WebAssembly architecture</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.127.1">Blazor WebAssembly </span><a id="_idIndexMarker1327"/><span class="koboSpan" id="kobo.128.1">uses the new WebAssembly browser feature to execute the .NET runtime in the browser. </span><span class="koboSpan" id="kobo.128.2">This way, it enables all developers to use the whole .NET code base and ecosystem in the implementation of applications capable of running in any WebAssembly-compliant browser. </span><span class="koboSpan" id="kobo.128.3">WebAssembly was conceived as a high-performance alternative to JavaScript. </span><span class="koboSpan" id="kobo.128.4">It is an assembly capable of running in a browser and obeying the same limitations as JavaScript code. </span><span class="koboSpan" id="kobo.128.5">This means that WebAssembly code, like JavaScript code, runs in an isolated execution environment that has very limited access to all machine resources.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.129.1">WebAssembly differs from similar options from the past, like Flash and Silverlight, since it is an official W3C standard. </span><span class="koboSpan" id="kobo.129.2">More specifically, it became an official standard on December 5, 2019, so it is expected to have a long life. </span><span class="koboSpan" id="kobo.129.3">As a matter of fact, all mainstream browsers already support it.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.130.1">However, WebAssembly doesn’t bring just performance with it; it also creates the opportunity to run whole code bases associated with modern and advanced object-oriented languages such as C++ (direct compilation), Java (bytecode), and C# (.NET) in browsers.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.131.1">At the moment, Microsoft offers two frameworks that run .NET on top of WebAssembly, Blazor WebAssembly and Unity WebAssembly, which is the WebAssembly port of the Unity 3D graphic framework. </span><span class="koboSpan" id="kobo.131.2">Unity WebAssembly’s main purpose is the implementation of online video games that run in the browser, while </span><a id="_idIndexMarker1328"/><span class="koboSpan" id="kobo.132.1">Blazor WebAssembly is a </span><strong class="keyWord"><span class="koboSpan" id="kobo.133.1">single-page application</span></strong><span class="koboSpan" id="kobo.134.1"> framework that uses .NET instead of JavaScript or TypeScript.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.135.1">Before WebAssembly, presentation layers running in a browser could only be implemented in JavaScript, with all the problems associated with the maintenance of big code bases implemented in a language that is not strictly typed. </span><span class="koboSpan" id="kobo.135.2">However, we must consider that on one hand, the usage of TypeScript in part solves JavaScript’s lack of strict typing, and on the other hand, .NET brings with it the problem of the binary compatibility of modules implemented with different .NET versions.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.136.1">Anyway, with </span><a id="_idIndexMarker1329"/><span class="koboSpan" id="kobo.137.1">Blazor C#, developers can now implement complex applications in their favorite language, with all the comforts offered to this language by the C# compiler and Visual Studio.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.138.1">Moreover, with Blazor, all .NET developers can use the full power of the .NET framework, with the only limitations imposed by the browser security policies, for the implementation of presentation layers that run in the browser and that share libraries and classes with all other layers that run on the server side.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.139.1">The subsections that follow describe all the Blazor architectures. </span><span class="koboSpan" id="kobo.139.2">The first subsection explores the general concept of a single-page application, describing Blazor’s peculiarities.</span></p>
<h2 class="heading-2" id="_idParaDest-384"><span class="koboSpan" id="kobo.140.1">What is a single-page application?</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.141.1">A </span><strong class="keyWord"><span class="koboSpan" id="kobo.142.1">single-page application</span></strong><span class="koboSpan" id="kobo.143.1"> (</span><strong class="keyWord"><span class="koboSpan" id="kobo.144.1">SPA</span></strong><span class="koboSpan" id="kobo.145.1">) is an</span><a id="_idIndexMarker1330"/><span class="koboSpan" id="kobo.146.1"> HTML-based application, where the HTML is changed by code that runs in the browser instead of issuing a new request to the server and rendering a new HTML page from scratch. </span><span class="koboSpan" id="kobo.146.2">SPAs can simulate a multi-page experience by replacing complete page areas with new HTML.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.147.1">SPA frameworks are frameworks explicitly designed for implementing SPAs. </span><span class="koboSpan" id="kobo.147.2">Before WebAssembly, all SPA frameworks were based on JavaScript. </span><span class="koboSpan" id="kobo.147.3">The most famous JavaScript-based SPA frameworks are Angular, React.js, and Vue.js.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.148.1">All SPA frameworks provide ways to transform data into HTML to show to the user and rely on a module called </span><em class="italic"><span class="koboSpan" id="kobo.149.1">router</span></em><span class="koboSpan" id="kobo.150.1"> to simulate page changes. </span><span class="koboSpan" id="kobo.150.2">Typically, data fills in the placeholders of HTML templates and selects which parts of a template to render (</span><code class="inlineCode"><span class="koboSpan" id="kobo.151.1">if-like</span></code><span class="koboSpan" id="kobo.152.1"> constructs) and how many times to render it (</span><code class="inlineCode"><span class="koboSpan" id="kobo.153.1">for-like</span></code><span class="koboSpan" id="kobo.154.1"> constructs).</span></p>
<p class="normal"><span class="koboSpan" id="kobo.155.1">The Blazor template language is Razor, which we described in </span><em class="italic"><span class="koboSpan" id="kobo.156.1">Chapter 17</span></em><span class="koboSpan" id="kobo.157.1">, </span><em class="italic"><span class="koboSpan" id="kobo.158.1">Presenting ASP.NET Core</span></em><span class="koboSpan" id="kobo.159.1">.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.160.1">In order to increase modularity, code is organized into components, which are a kind of virtual HTML tag that, once rendered, generates actual HTML markup. </span><span class="koboSpan" id="kobo.160.2">Like HTML tags, components have attributes, which are usually called parameters, and custom events. </span><span class="koboSpan" id="kobo.160.3">It is up to the developer to ensure that each component uses its parameters to create proper HTML and to ensure that it generates adequate events. </span><span class="koboSpan" id="kobo.160.4">Components can be used inside other components in a hierarchical fashion.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.161.1">Components </span><a id="_idIndexMarker1331"/><span class="koboSpan" id="kobo.162.1">can be associated with URLs in the application web domain, in which case they are called pages. </span><span class="koboSpan" id="kobo.162.2">These URLs can be used in the usual HTML links and following them leads to the upload of the page into an application area thanks to framework services called routers.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.163.1">Some SPA frameworks also provide a predefined dependency injection engine in order to ensure better separation between components on one side and general-purpose services plus business code that runs in the browser on the other. </span><span class="koboSpan" id="kobo.163.2">Among the frameworks listed in this subsection, only Blazor and Angular have an out-of-the-box dependency injection engine.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.164.1">In order to reduce the overall application file size, SPA frameworks based on JavaScript usually compile all JavaScript code in a few JavaScript files and then perform so-called tree-shaking, that is, the removal of all unused code. </span><span class="koboSpan" id="kobo.164.2">This technique sensibly reduces the application load time.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.165.1">At the moment, instead, Blazor keeps all DLLs referenced by the main application separate and performs tree-shaking on each of them separately.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.166.1">The next subsection describes the Blazor architecture. </span><span class="koboSpan" id="kobo.166.2">We challenge you to create a Blazor WebAssembly project called </span><code class="inlineCode"><span class="koboSpan" id="kobo.167.1">BlazorReview</span></code><span class="koboSpan" id="kobo.168.1">, so you can inspect the code and the constructs explained throughout the chapter. </span><span class="koboSpan" id="kobo.168.2">To do this, select the </span><strong class="screenText"><span class="koboSpan" id="kobo.169.1">Blazor WebAssembly Standalone Application</span></strong><strong class="keyWord"> </strong><span class="koboSpan" id="kobo.170.1">option when creating a new project. </span><span class="koboSpan" id="kobo.170.2">Make sure to select </span><strong class="screenText"><span class="koboSpan" id="kobo.171.1">Individual Accounts</span></strong><span class="koboSpan" id="kobo.172.1"> as the authentication type and ensure that the </span><strong class="screenText"><span class="koboSpan" id="kobo.173.1">Include sample pages</span></strong><span class="koboSpan" id="kobo.174.1"> checkbox is checked, as shown in the picture below.</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.175.1"><img alt="" role="presentation" src="../Images/B19820_19_01.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.176.1">Figure 19.1: Creating the BlazorReview application</span></p>
<p class="normal"><span class="koboSpan" id="kobo.177.1">If you start </span><a id="_idIndexMarker1332"/><span class="koboSpan" id="kobo.178.1">the application, the application works properly, but if you try to log in, the following error message will appear: “There was an error trying to log you in: ‘Network Error’.” </span><span class="koboSpan" id="kobo.178.2">This is because you need to configure an identity-provider-authenticated user. </span><span class="koboSpan" id="kobo.178.3">As the default, the application is configured to use an OAuth-based identity provider web application. </span><span class="koboSpan" id="kobo.178.4">You need to just add the provider configuration data in a configuration file. </span><span class="koboSpan" id="kobo.178.5">We will look at this in more detail in the </span><em class="italic"><span class="koboSpan" id="kobo.179.1">Authentication and authorization</span></em><span class="koboSpan" id="kobo.180.1"> section.</span></p>
<h2 class="heading-2" id="_idParaDest-385"><span class="koboSpan" id="kobo.181.1">Loading and starting the application</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.182.1">The folder</span><a id="_idIndexMarker1333"/><span class="koboSpan" id="kobo.183.1"> structure of a Blazor WebAssembly application always includes an </span><code class="inlineCode"><span class="koboSpan" id="kobo.184.1">index.html</span></code><span class="koboSpan" id="kobo.185.1"> static HTML page. </span><span class="koboSpan" id="kobo.185.2">In our </span><code class="inlineCode"><span class="koboSpan" id="kobo.186.1">BlazorReview</span></code><span class="koboSpan" id="kobo.187.1"> project, </span><code class="inlineCode"><span class="koboSpan" id="kobo.188.1">index.html</span></code><span class="koboSpan" id="kobo.189.1"> is in </span><code class="inlineCode"><span class="koboSpan" id="kobo.190.1">BlazorReview-&gt;wwwroot-&gt;index.html</span></code><span class="koboSpan" id="kobo.191.1">. </span><span class="koboSpan" id="kobo.191.2">This page is the container where the </span><a id="_idIndexMarker1334"/><span class="koboSpan" id="kobo.192.1">Blazor application will create its HTML. </span><span class="koboSpan" id="kobo.192.2">It contains an HTML header with a </span><code class="inlineCode"><span class="koboSpan" id="kobo.193.1">viewport meta</span></code><span class="koboSpan" id="kobo.194.1"> declaration, the title, and CSS for the application’s overall styling. </span><span class="koboSpan" id="kobo.194.2">The Visual Studio default project template adds an application-specific CSS file and Bootstrap CSS, with a neutral style. </span><span class="koboSpan" id="kobo.194.3">You can replace the default </span><a id="_idIndexMarker1335"/><span class="koboSpan" id="kobo.195.1">Bootstrap CSS either with a customized style or a completely different CSS framework.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.196.1">The body contains the code that follows:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.197.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.198.1">body</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.199.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.200.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.201.1">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.202.1">id</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.203.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.204.1">"app"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.205.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.206.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.207.1">svg</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.208.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.209.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.210.1">"loading-progress"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.211.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.212.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.213.1">circle</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.214.1">r</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.215.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.216.1">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.217.1">40%"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.218.1">cx</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.219.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.220.1">"50%"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.221.1">cy</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.222.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.223.1">"50%"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.224.1"> /&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.225.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.226.1">circle</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.227.1">r</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.228.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.229.1">"40%"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.230.1">cx</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.231.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.232.1">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.233.1">50%"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.234.1">cy</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.235.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.236.1">"50%"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.237.1"> /&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.238.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.239.1">svg</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.240.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.241.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.242.1">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.243.1">id</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.244.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.245.1">"loading-progress-text"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.246.1">&gt;&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.247.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.248.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.249.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.250.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.251.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.252.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.253.1">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.254.1">id</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.255.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.256.1">"blazor-error-ui"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.257.1">&gt;</span></span><span class="koboSpan" id="kobo.258.1">
        An unhandled error has occurred.
    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.259.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.260.1">a</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.261.1">href</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.262.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.263.1">""</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.264.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.265.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.266.1">"reload"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.267.1">&gt;</span></span><span class="koboSpan" id="kobo.268.1">Reload</span><span class="hljs-tag"><span class="koboSpan" id="kobo.269.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.270.1">a</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.271.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.272.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.273.1">a</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.274.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.275.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.276.1">"dismiss"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.277.1">&gt;</span></span><span class="koboSpan" id="kobo.278.1"> / </span><span class="hljs-tag"><span class="koboSpan" id="kobo.279.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.280.1">a</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.281.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.282.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.283.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.284.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.285.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.286.1">script</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.287.1">src</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.288.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.289.1">"_content/Microsoft.AspNetCore.Components.WebAssembly.Authentication/AuthenticationService.js"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.290.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.291.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.292.1">script</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.293.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.294.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.295.1">script</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.296.1">src</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.297.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.298.1">"_framework/blazor.webassembly.js"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.299.1">&gt;&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.300.1">script</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.301.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.302.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.303.1">body</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.304.1">&gt;</span></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.305.1">The initial </span><code class="inlineCode"><span class="koboSpan" id="kobo.306.1">div</span></code><span class="koboSpan" id="kobo.307.1"> with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.308.1">app</span></code> <code class="inlineCode"><span class="koboSpan" id="kobo.309.1">id</span></code><span class="koboSpan" id="kobo.310.1"> is where the application will place the code it generates. </span><span class="koboSpan" id="kobo.310.2">Any markup placed inside this </span><code class="inlineCode"><span class="koboSpan" id="kobo.311.1">div</span></code><span class="koboSpan" id="kobo.312.1"> will appear just while the Blazor application is loading and starting, then it will be replaced by the application-generated HTML. </span><span class="koboSpan" id="kobo.312.2">As the default, it contains an </span><code class="inlineCode"><span class="koboSpan" id="kobo.313.1">svg</span></code><span class="koboSpan" id="kobo.314.1"> image and text that shows the loading progress, which are both controlled by the JavaScript code that takes care of loading the framework. </span><span class="koboSpan" id="kobo.314.2">The loading animation is based on a CSS animation contained in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.315.1">css/app.css</span></code><span class="koboSpan" id="kobo.316.1"> main application CSS file. </span><span class="koboSpan" id="kobo.316.2">However, you can replace both the default content and the CSS animation.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.317.1">The second </span><code class="inlineCode"><span class="koboSpan" id="kobo.318.1">div</span></code><span class="koboSpan" id="kobo.319.1"> is normally invisible and appears only when Blazor intercepts an unhandled exception.</span></p>
<p class="normal"><code class="inlineCode"><span class="koboSpan" id="kobo.320.1">blazor.webassembly.js</span></code><span class="koboSpan" id="kobo.321.1"> contains the JavaScript part of the Blazor framework. </span><span class="koboSpan" id="kobo.321.2">Among other things, it takes care of downloading the .NET runtime, together with all application DLLs. </span><span class="koboSpan" id="kobo.321.3">More specifically, </span><code class="inlineCode"><span class="koboSpan" id="kobo.322.1">blazor.webassembly.js</span></code><span class="koboSpan" id="kobo.323.1"> downloads the </span><code class="inlineCode"><span class="koboSpan" id="kobo.324.1">blazor.boot.json</span></code><span class="koboSpan" id="kobo.325.1"> file, which lists all application files with their hashes. </span></p>
<p class="normal"><span class="koboSpan" id="kobo.326.1">Then, </span><code class="inlineCode"><span class="koboSpan" id="kobo.327.1">blazor.webassembly.js</span></code><span class="koboSpan" id="kobo.328.1"> downloads all resources listed in this file and verifies their hashes. </span><span class="koboSpan" id="kobo.328.2">All resources downloaded by </span><code class="inlineCode"><span class="koboSpan" id="kobo.329.1">blazor.webassembly.js</span></code><span class="koboSpan" id="kobo.330.1"> are created when the application is built or published. </span><span class="koboSpan" id="kobo.330.2">Loading </span><code class="inlineCode"><span class="koboSpan" id="kobo.331.1">blazor.webassembly.js</span></code><span class="koboSpan" id="kobo.332.1"> periodically updates the </span><code class="inlineCode"><span class="koboSpan" id="kobo.333.1">--blazor-load-percentage</span></code><span class="koboSpan" id="kobo.334.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.335.1">--blazor-load-percentage-text</span></code><span class="koboSpan" id="kobo.336.1"> CSS variables with the loading percentage in numeric format and as text, respectively.</span></p>
<p class="normal"><code class="inlineCode"><span class="koboSpan" id="kobo.337.1">AuthenticationService.js</span></code><span class="koboSpan" id="kobo.338.1"> is added only when the project enables authentication and takes care</span><a id="_idIndexMarker1336"/><span class="koboSpan" id="kobo.339.1"> of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.340.1">OpenID Connect</span></code><span class="koboSpan" id="kobo.341.1"> protocol used by Blazor to exploit other identity providers, to get bearer tokens, which are the preferred authentication credentials for clients that interact with a server through web APIs.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.342.1">Authentication is discussed in more detail in the </span><em class="italic"><span class="koboSpan" id="kobo.343.1">Authentication and authorization</span></em><span class="koboSpan" id="kobo.344.1"> subsection later on in this chapter, while bearer tokens are discussed in the </span><em class="italic"><span class="koboSpan" id="kobo.345.1">REST service authorization and authentication</span></em><span class="koboSpan" id="kobo.346.1"> section of </span><em class="italic"><span class="koboSpan" id="kobo.347.1">Chapter 15</span></em><span class="koboSpan" id="kobo.348.1">, </span><em class="italic"><span class="koboSpan" id="kobo.349.1">Applying Service-Oriented Architectures with .NET</span></em><span class="koboSpan" id="kobo.350.1">.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.351.1">The Blazor application entry point is in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.352.1">BlazorReview-&gt;Program.cs</span></code><span class="koboSpan" id="kobo.353.1"> file. </span><span class="koboSpan" id="kobo.353.2">This file doesn’t contain a class but just the code that must be executed when the application is launched:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.354.1">var</span></span><span class="koboSpan" id="kobo.355.1"> builder = WebAssemblyHostBuilder.CreateDefault(args);
builder.RootComponents.Add&lt;App&gt;(</span><span class="hljs-string"><span class="koboSpan" id="kobo.356.1">"#app"</span></span><span class="koboSpan" id="kobo.357.1">);
builder.RootComponents.Add&lt; HeadOutlet&gt;(</span><span class="hljs-string"><span class="koboSpan" id="kobo.358.1">"head::after"</span></span><span class="koboSpan" id="kobo.359.1">);
</span><span class="hljs-comment"><span class="koboSpan" id="kobo.360.1">// Services added to the application</span></span>
<span class="hljs-comment"><span class="koboSpan" id="kobo.361.1">// Dependency Injection engine declared with statements like:</span></span>
<span class="hljs-comment"><span class="koboSpan" id="kobo.362.1">// builder.Services.Add...</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.363.1">await</span></span><span class="koboSpan" id="kobo.364.1"> builder.Build().RunAsync();
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.365.1">In fact, the new Blazor WebAssembly project template takes advantage of this new way to define the application entry point that was introduced starting from .NET 7.</span></p>
<p class="normal"><code class="inlineCode"><span class="koboSpan" id="kobo.366.1">WebAssemblyHostBuilder</span></code><span class="koboSpan" id="kobo.367.1"> is a builder for creating a </span><code class="inlineCode"><span class="koboSpan" id="kobo.368.1">WebAssemblyHost</span></code><span class="koboSpan" id="kobo.369.1">, which is a WebAssembly-specific implementation of the generic host discussed in the </span><em class="italic"><span class="koboSpan" id="kobo.370.1">Using generic hosts</span></em><span class="koboSpan" id="kobo.371.1"> subsection of </span><em class="italic"><span class="koboSpan" id="kobo.372.1">Chapter 11</span></em><span class="koboSpan" id="kobo.373.1">, </span><em class="italic"><span class="koboSpan" id="kobo.374.1">Applying a Microservice Architecture to Your Enterprise Application</span></em><span class="koboSpan" id="kobo.375.1"> (you are encouraged to review that subsection). </span><span class="koboSpan" id="kobo.375.2">The first builder configuration instruction declares the Blazor root component (</span><code class="inlineCode"><span class="koboSpan" id="kobo.376.1">App</span></code><span class="koboSpan" id="kobo.377.1">), which will contain the whole component tree, and specifies in which HTML tag of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.378.1">index.html</span></code><span class="koboSpan" id="kobo.379.1"> page to place it (</span><code class="inlineCode"><span class="koboSpan" id="kobo.380.1">#app</span></code><span class="koboSpan" id="kobo.381.1">). </span><span class="koboSpan" id="kobo.381.2">More specifically, </span><code class="inlineCode"><span class="koboSpan" id="kobo.382.1">RootComponents.Add</span></code><span class="koboSpan" id="kobo.383.1"> adds a hosted service that takes care of handling the whole Blazor component tree. </span><span class="koboSpan" id="kobo.383.2">We can run several Blazor WebAssembly user interfaces on the same HTML page by calling </span><code class="inlineCode"><span class="koboSpan" id="kobo.384.1">RootComponents.Add</span></code><span class="koboSpan" id="kobo.385.1"> several times, each time with a different HTML tag reference.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.386.1">As the </span><a id="_idIndexMarker1337"/><span class="koboSpan" id="kobo.387.1">default, just another root component is added, </span><code class="inlineCode"><span class="koboSpan" id="kobo.388.1">HeadOutlet</span></code><span class="koboSpan" id="kobo.389.1">, and is placed immediately after the </span><code class="inlineCode"><span class="koboSpan" id="kobo.390.1">HTML Head</span></code><span class="koboSpan" id="kobo.391.1"> tag. </span><span class="koboSpan" id="kobo.391.2">It is used to dynamically change the </span><code class="inlineCode"><span class="koboSpan" id="kobo.392.1">index.html</span></code><span class="koboSpan" id="kobo.393.1"> title (the text shown in the browser tab). </span><span class="koboSpan" id="kobo.393.2">For more information on the </span><code class="inlineCode"><span class="koboSpan" id="kobo.394.1">HeadOutlet</span></code><span class="koboSpan" id="kobo.395.1"> component, see the </span><em class="italic"><span class="koboSpan" id="kobo.396.1">Modifying HTML &lt;head&gt; content from Blazor component</span></em><span class="koboSpan" id="kobo.397.1">s subsection.</span></p>
<p class="normal"><code class="inlineCode"><span class="koboSpan" id="kobo.398.1">builder.Services</span></code><span class="koboSpan" id="kobo.399.1"> contains all the usual methods and extension methods to add services to the Blazor application dependency engine: </span><code class="inlineCode"><span class="koboSpan" id="kobo.400.1">AddScoped</span></code><span class="koboSpan" id="kobo.401.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.402.1">AddTransient</span></code><span class="koboSpan" id="kobo.403.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.404.1">AddSingleton</span></code><span class="koboSpan" id="kobo.405.1">, and so on. </span><span class="koboSpan" id="kobo.405.2">Like in ASP.NET Core MVC applications (</span><em class="italic"><span class="koboSpan" id="kobo.406.1">Chapter 17</span></em><span class="koboSpan" id="kobo.407.1">, </span><em class="italic"><span class="koboSpan" id="kobo.408.1">Presenting ASP.NET Core</span></em><span class="koboSpan" id="kobo.409.1">, and </span><em class="italic"><span class="koboSpan" id="kobo.410.1">Chapter 18</span></em><span class="koboSpan" id="kobo.411.1">, </span><em class="italic"><span class="koboSpan" id="kobo.412.1">Implementing Frontend Microservices with ASP.NET Core</span></em><span class="koboSpan" id="kobo.413.1">), services are the preferred places to implement business logic and store shared state. </span><span class="koboSpan" id="kobo.413.2">While in ASP.NET Core MVC services were usually passed to controllers, in Blazor WebAssembly, they are injected into components.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.414.1">The default project scaffolded by Visual Studio contains just two services, one for communicating with the server and the other for handling OAuth-based authentication. </span><span class="koboSpan" id="kobo.414.2">We will discuss both of them later on in this chapter.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.415.1">The next subsection explains how the root </span><code class="inlineCode"><span class="koboSpan" id="kobo.416.1">App</span></code><span class="koboSpan" id="kobo.417.1"> component simulates page changes.</span></p>
<h2 class="heading-2" id="_idParaDest-386"><span class="koboSpan" id="kobo.418.1">Routing</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.419.1">The root </span><code class="inlineCode"><span class="koboSpan" id="kobo.420.1">App</span></code><span class="koboSpan" id="kobo.421.1"> class </span><a id="_idIndexMarker1338"/><span class="koboSpan" id="kobo.422.1">referenced by the host-building code is defined in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.423.1">BlazorReview -&gt;App.razor</span></code><span class="koboSpan" id="kobo.424.1"> file. </span><code class="inlineCode"><span class="koboSpan" id="kobo.425.1">App</span></code><span class="koboSpan" id="kobo.426.1"> is a Blazor component, and like all Blazor components, it is defined in a file with a </span><code class="inlineCode"><span class="koboSpan" id="kobo.427.1">.razor</span></code><span class="koboSpan" id="kobo.428.1"> extension and uses Razor syntax enriched with component notation, that is, with HTML-like tags that represent other Blazor components. </span><span class="koboSpan" id="kobo.428.2">It contains the whole logic for handling application pages:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.429.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.430.1">CascadingAuthenticationState</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.431.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.432.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.433.1">Router</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.434.1">AppAssembly</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.435.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.436.1">"@typeof(App).Assembly"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.437.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.438.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.439.1">Found</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.440.1">Context</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.441.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.442.1">"routeData"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.443.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.444.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.445.1">AuthorizeRouteView</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.446.1">RouteData</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.447.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.448.1">"@routeData"</span></span>
<span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.449.1">DefaultLayout</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.450.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.451.1">"@typeof(MainLayout)"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.452.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.453.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.454.1">NotAuthorized</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.455.1">&gt;</span></span><span class="koboSpan" id="kobo.456.1">
         @*Template that specifies what to show
           when user is not authorized *@
        </span><span class="hljs-tag"><span class="koboSpan" id="kobo.457.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.458.1">NotAuthorized</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.459.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.460.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.461.1">AuthorizeRouteView</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.462.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.463.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.464.1">FocusOnNavigate</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.465.1">RouteData</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.466.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.467.1">"@routeData"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.468.1">Selector</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.469.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.470.1">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.471.1">h1"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.472.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.473.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.474.1">Found</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.475.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.476.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.477.1">NotFound</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.478.1">Layout</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.479.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.480.1">"@typeof(MainLayout)"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.481.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.482.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.483.1">PageTitle</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.484.1">&gt;</span></span><span class="koboSpan" id="kobo.485.1">Not found</span><span class="hljs-tag"><span class="koboSpan" id="kobo.486.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.487.1">PageTitle</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.488.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.489.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.490.1">LayoutView</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.491.1">Layout</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.492.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.493.1">"@typeof(MainLayout)"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.494.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.495.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.496.1">p</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.497.1">&gt;</span></span><span class="koboSpan" id="kobo.498.1">Sorry, there's nothing at this address.</span><span class="hljs-tag"><span class="koboSpan" id="kobo.499.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.500.1">p</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.501.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.502.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.503.1">LayoutView</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.504.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.505.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.506.1">NotFound</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.507.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.508.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.509.1">Router</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.510.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.511.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.512.1">CascadingAuthenticationState</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.513.1">&gt;</span></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.514.1">All tags in the preceding </span><a id="_idIndexMarker1339"/><span class="koboSpan" id="kobo.515.1">code represent either components or particular component parameters, called templates. </span><span class="koboSpan" id="kobo.515.2">Components will be discussed in detail throughout the chapter. </span><span class="koboSpan" id="kobo.515.3">For the moment, imagine them as a kind of custom HTML tags that we can somehow define with C# and Razor code. </span><span class="koboSpan" id="kobo.515.4">Templates, instead, are parameters that accept Razor markup as values. </span><span class="koboSpan" id="kobo.515.5">Templates are discussed in the </span><em class="italic"><span class="koboSpan" id="kobo.516.1">Templates and cascading parameters</span></em><span class="koboSpan" id="kobo.517.1"> subsection later on in this section.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.518.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.519.1">CascadingAuthenticationState</span></code><span class="koboSpan" id="kobo.520.1"> component only has the function of passing authentication and authorization information to all components of the component tree that is inside of it. </span><span class="koboSpan" id="kobo.520.2">The Blazor project template generates it only if one chooses to add authorization during project creation.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.521.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.522.1">Router</span></code><span class="koboSpan" id="kobo.523.1"> component is the actual application router. </span><span class="koboSpan" id="kobo.523.2">It scans the assembly passed in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.524.1">AppAssembly</span></code><span class="koboSpan" id="kobo.525.1"> parameter looking for components containing routing information, that is, for components that can work as pages. </span><span class="koboSpan" id="kobo.525.2">In the Blazor project template, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.526.1">Router</span></code><span class="koboSpan" id="kobo.527.1"> component is passed the assembly that contains the class of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.528.1">App</span></code><span class="koboSpan" id="kobo.529.1"> component, that is, the main application. </span><span class="koboSpan" id="kobo.529.2">Pages contained in other assemblies can be added through the </span><code class="inlineCode"><span class="koboSpan" id="kobo.530.1">AdditionalAssemblies</span></code><span class="koboSpan" id="kobo.531.1"> parameter, which accepts an </span><code class="inlineCode"><span class="koboSpan" id="kobo.532.1">IEnumerable</span></code><span class="koboSpan" id="kobo.533.1"> of assemblies.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.534.1">After that, the router intercepts all page changes performed either by code or through the usual </span><code class="inlineCode"><span class="koboSpan" id="kobo.535.1">&lt;a&gt;</span></code><span class="koboSpan" id="kobo.536.1"> HTML tags that point to an address inside of the application base address. </span><span class="koboSpan" id="kobo.536.2">Navigation can be handled by code by requiring a </span><code class="inlineCode"><span class="koboSpan" id="kobo.537.1">NavigationManager</span></code><span class="koboSpan" id="kobo.538.1"> instance from dependency injection.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.539.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.540.1">Router</span></code><span class="koboSpan" id="kobo.541.1"> component has two templates, one for the case where a page for the requested URI is found (</span><code class="inlineCode"><span class="koboSpan" id="kobo.542.1">Found</span></code><span class="koboSpan" id="kobo.543.1">), and the other for the case where it is not found (</span><code class="inlineCode"><span class="koboSpan" id="kobo.544.1">NotFound</span></code><span class="koboSpan" id="kobo.545.1">). </span><span class="koboSpan" id="kobo.545.2">When the application uses authorization, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.546.1">Found</span></code><span class="koboSpan" id="kobo.547.1"> template consists of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.548.1">AuthorizeRouteView</span></code><span class="koboSpan" id="kobo.549.1"> components, which further distinguish whether the user is authorized to access the selected page or not. </span><span class="koboSpan" id="kobo.549.2">When the application doesn’t use authorization, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.550.1">Found</span></code><span class="koboSpan" id="kobo.551.1"> template consists of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.552.1">RouteView</span></code><span class="koboSpan" id="kobo.553.1"> component:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.554.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.555.1">RouteView</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.556.1">RouteData</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.557.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.558.1">"@routeData"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.559.1">DefaultLayout</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.560.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.561.1">"@typeof(MainLayout)"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.562.1"> /&gt;</span></span>
</code></pre>
<p class="normal"><code class="inlineCode"><span class="koboSpan" id="kobo.563.1">RouteView</span></code><span class="koboSpan" id="kobo.564.1"> takes the</span><a id="_idIndexMarker1340"/><span class="koboSpan" id="kobo.565.1"> selected page and renders it inside the layout page specified by the </span><code class="inlineCode"><span class="koboSpan" id="kobo.566.1">DefaultLayout</span></code><span class="koboSpan" id="kobo.567.1"> parameter. </span><span class="koboSpan" id="kobo.567.2">This specification acts as a default since each page can override it by specifying a different layout page. </span><span class="koboSpan" id="kobo.567.3">In the Blazor project template, the default layout page is in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.568.1">BlazorReview-&gt;Layout-&gt;MainLayout.razor</span></code><span class="koboSpan" id="kobo.569.1"> file.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.570.1">Blazor layout pages work similarly to ASP.NET Core MVC layout pages, described in the </span><em class="italic"><span class="koboSpan" id="kobo.571.1">Reusing view code</span></em><span class="koboSpan" id="kobo.572.1"> subsection of </span><em class="italic"><span class="koboSpan" id="kobo.573.1">Chapter 17</span></em><span class="koboSpan" id="kobo.574.1">, </span><em class="italic"><span class="koboSpan" id="kobo.575.1">Presenting ASP.NET Core</span></em><span class="koboSpan" id="kobo.576.1">, the only difference being that the place to add the page markup is specified with </span><code class="inlineCode"><span class="koboSpan" id="kobo.577.1">@Body</span></code><span class="koboSpan" id="kobo.578.1">:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.579.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.580.1">article</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.581.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.582.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.583.1">"content px-4"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.584.1">&gt;</span></span><span class="koboSpan" id="kobo.585.1">
      @Body
</span><span class="hljs-tag"><span class="koboSpan" id="kobo.586.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.587.1">article</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.588.1">&gt;</span></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.589.1">If the application uses authorization, </span><code class="inlineCode"><span class="koboSpan" id="kobo.590.1">AuthorizeRouteView</span></code><span class="koboSpan" id="kobo.591.1"> works like </span><code class="inlineCode"><span class="koboSpan" id="kobo.592.1">RouteView</span></code><span class="koboSpan" id="kobo.593.1">, but it also allows the specification of a template for a case where the user is not authorized:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.594.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.595.1">NotAuthorized</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.596.1">&gt;</span></span><span class="koboSpan" id="kobo.597.1">
@if (!context.User.Identity.IsAuthenticated)
{
  </span><span class="hljs-tag"><span class="koboSpan" id="kobo.598.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.599.1">RedirectToLogin</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.600.1"> /&gt;</span></span><span class="koboSpan" id="kobo.601.1">
}
else
{
  </span><span class="hljs-tag"><span class="koboSpan" id="kobo.602.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.603.1">p</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.604.1">role</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.605.1"> =</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.606.1">"alert"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.607.1">&gt;</span></span><span class="koboSpan" id="kobo.608.1">You are not authorized to access this resource.</span><span class="hljs-tag"><span class="koboSpan" id="kobo.609.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.610.1">p</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.611.1">&gt;</span></span><span class="koboSpan" id="kobo.612.1">
}
</span><span class="hljs-tag"><span class="koboSpan" id="kobo.613.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.614.1">NotAuthorized</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.615.1">&gt;</span></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.616.1">If the user is not authenticated, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.617.1">RedirectToLogin</span></code><span class="koboSpan" id="kobo.618.1"> component uses a </span><code class="inlineCode"><span class="koboSpan" id="kobo.619.1">NavigationManager</span></code><span class="koboSpan" id="kobo.620.1"> instance to move to the login logic page; otherwise, it informs the users that they haven’t got enough privileges to access the selected page.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.621.1">Blazor WebAssembly also allows the lazy loading of assemblies to reduce the initial application loading time, but we will not discuss it here for lack of space. </span><span class="koboSpan" id="kobo.621.2">The </span><em class="italic"><span class="koboSpan" id="kobo.622.1">Further reading</span></em><span class="koboSpan" id="kobo.623.1"> section contains references to the official Blazor documentation.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.624.1">As we will discuss in more detail later on in this chapter, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.625.1">PageTitle</span></code><span class="koboSpan" id="kobo.626.1"> component enables the developer to set the page title that appears in the browser tabs. </span><span class="koboSpan" id="kobo.626.2">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.627.1">FocusOnNavigate</span></code><span class="koboSpan" id="kobo.628.1"> component, instead, sets the HTML focus on the first HTML element that satisfies the CSS selector passed in its </span><code class="inlineCode"><span class="koboSpan" id="kobo.629.1">Selector</span></code><span class="koboSpan" id="kobo.630.1"> parameter, immediately after a page is navigated.</span></p>
<h1 class="heading-1" id="_idParaDest-387"><span class="koboSpan" id="kobo.631.1">Blazor pages and components</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.632.1">In this section, you</span><a id="_idIndexMarker1341"/><span class="koboSpan" id="kobo.633.1"> will learn the fundamentals of Blazor components, including how to construct a component, the structure of components, how to attach </span><a id="_idIndexMarker1342"/><span class="koboSpan" id="kobo.634.1">events to HTML tags, how to specify the components’ characteristics, and how to use other components within your components. </span><span class="koboSpan" id="kobo.634.2">We have divided the content into several subsections:</span></p>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.635.1">Component structure</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.636.1">Templates and cascading parameters</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.637.1">Error handling</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.638.1">Events</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.639.1">Bindings</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.640.1">How Blazor updates HTML</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.641.1">Component lifecycle</span></li>
</ul>
<h2 class="heading-2" id="_idParaDest-388"><span class="koboSpan" id="kobo.642.1">Component structure</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.643.1">Components are</span><a id="_idIndexMarker1343"/><span class="koboSpan" id="kobo.644.1"> the core of all main client frameworks. </span><span class="koboSpan" id="kobo.644.2">They are the key ingredient to building modular UI, whose parts are easily modifiable and reusable. </span><span class="koboSpan" id="kobo.644.3">In a few words, they are the graphical counterpart of classes. </span><span class="koboSpan" id="kobo.644.4">In fact, just like classes, they allow encapsulation and code organization. </span><span class="koboSpan" id="kobo.644.5">Moreover, the component architecture allows the formal definition of efficacious UI update algorithms, as we will see in the </span><em class="italic"><span class="koboSpan" id="kobo.645.1">How Blazor updates HTML</span></em><span class="koboSpan" id="kobo.646.1"> section of this chapter.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.647.1">Components are defined in files with a </span><code class="inlineCode"><span class="koboSpan" id="kobo.648.1">.razor</span></code><span class="koboSpan" id="kobo.649.1"> extension. </span><span class="koboSpan" id="kobo.649.2">Once compiled, they become classes that inherit from </span><code class="inlineCode"><span class="koboSpan" id="kobo.650.1">ComponentBase</span></code><span class="koboSpan" id="kobo.651.1">. </span><span class="koboSpan" id="kobo.651.2">Like all other Visual Studio project elements, Blazor components are available through the </span><strong class="screenText"><span class="koboSpan" id="kobo.652.1">Add New Item</span></strong><span class="koboSpan" id="kobo.653.1"> menu. </span><span class="koboSpan" id="kobo.653.2">Usually, components to be used as pages are defined in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.654.1">Pages</span></code><span class="koboSpan" id="kobo.655.1"> folder, or in its subfolders, while other components are organized in different folders. </span><span class="koboSpan" id="kobo.655.2">Default Blazor projects add all their non-page components inside the </span><code class="inlineCode"><span class="koboSpan" id="kobo.656.1">Shared</span></code><span class="koboSpan" id="kobo.657.1"> folder, but you can organize them differently.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.658.1">By default, pages are assigned a namespace that corresponds to the path of the folder they are in. </span><span class="koboSpan" id="kobo.658.2">Thus, for instance, in our example project, all pages that are in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.659.1">BlazorReview-&gt;Pages</span></code><span class="koboSpan" id="kobo.660.1"> path are assigned to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.661.1">BlazorReview.Pages</span></code><span class="koboSpan" id="kobo.662.1"> namespace. </span></p>
<p class="normal"><span class="koboSpan" id="kobo.663.1">However, you can change this default namespace with an </span><code class="inlineCode"><span class="koboSpan" id="kobo.664.1">@namespace</span></code><span class="koboSpan" id="kobo.665.1"> declaration placed in the declaration area that is at the top of the file. </span><span class="koboSpan" id="kobo.665.2">This area may also contain other </span><a id="_idIndexMarker1344"/><span class="koboSpan" id="kobo.666.1">important declarations. </span><span class="koboSpan" id="kobo.666.2">The following is an example that shows all declarations:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.667.1">@page "/counter"
@layout MyCustomLayout
@namespace BlazorReview.Pages
@using Microsoft.AspNetCore.Authorization
@implements MyInterface
@inherits MyParentComponent
@typeparam T
@attribute [Authorize]
@inject NavigationManager navigation
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.668.1">The first two directives make sense only for components that must work as pages, while all others may appear in any component. </span><span class="koboSpan" id="kobo.668.2">Below is a detailed explanation of each declaration:</span></p>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.669.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.670.1">@layout</span></code><span class="koboSpan" id="kobo.671.1"> directive, when specified, overrides the default layout page with another component.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.672.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.673.1">@page</span></code><span class="koboSpan" id="kobo.674.1"> directive defines the path of the page (</span><strong class="keyWord"><span class="koboSpan" id="kobo.675.1">route</span></strong><span class="koboSpan" id="kobo.676.1">) within the application base URL. </span><span class="koboSpan" id="kobo.676.2">Thus, for instance, if our application runs at </span><code class="inlineCode"><span class="koboSpan" id="kobo.677.1">https://localhost:5001</span></code><span class="koboSpan" id="kobo.678.1">, then the URL of this page will be </span><code class="inlineCode"><span class="koboSpan" id="kobo.679.1">https://localhost:5001/counter</span></code><span class="koboSpan" id="kobo.680.1">. </span><span class="koboSpan" id="kobo.680.2">Page routes can also contain parameters, like in this example: </span><code class="inlineCode"><span class="koboSpan" id="kobo.681.1">/orderitem/{customer}/{order}</span></code><span class="koboSpan" id="kobo.682.1">. </span><span class="koboSpan" id="kobo.682.2">Parameter names must match public properties defined as parameters by the components. </span><span class="koboSpan" id="kobo.682.3">The match is case-insensitive. </span><span class="koboSpan" id="kobo.682.4">Parameters will be explained later on in this subsection.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.683.1">The string that instantiates each parameter is converted into the parameter type, and if this conversion fails, an exception is thrown. </span><span class="koboSpan" id="kobo.683.2">This behavior can be prevented by associating a type with each parameter, in which case, if the conversion to the specified type fails, the match with the page URL fails. </span><span class="koboSpan" id="kobo.683.3">Only elementary types are supported: </span><code class="inlineCode"><span class="koboSpan" id="kobo.684.1">/orderitem/{customer:int}/{order:int}</span></code><span class="koboSpan" id="kobo.685.1">. </span><span class="koboSpan" id="kobo.685.2">As a default, parameters are obligatory; that is, if they are not found, the match fails and the router tries other pages. </span><span class="koboSpan" id="kobo.685.3">However, you can make parameters optional by post-fixing them with a question mark: </span><code class="inlineCode"><span class="koboSpan" id="kobo.686.1">/orderitem/{customer?:int}/{order?:int}</span></code><span class="koboSpan" id="kobo.687.1">. </span><span class="koboSpan" id="kobo.687.2">If an optional parameter is not specified, the default for its type is used. </span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.688.1">From version 6, parameters can also be extracted from the query string: </span><code class="inlineCode"><span class="koboSpan" id="kobo.689.1">/orderitem/{customer:int}?order=123</span></code><span class="koboSpan" id="kobo.690.1">.</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.691.1">@namespace</span></code><span class="koboSpan" id="kobo.692.1"> overrides the default namespace of the component, while </span><code class="inlineCode"><span class="koboSpan" id="kobo.693.1">@using</span></code><span class="koboSpan" id="kobo.694.1"> is equivalent to the usual C# </span><code class="inlineCode"><span class="koboSpan" id="kobo.695.1">using</span></code><span class="koboSpan" id="kobo.696.1">. </span><span class="koboSpan" id="kobo.696.2">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.697.1">@using</span></code><span class="koboSpan" id="kobo.698.1"> declared in the special </span><code class="inlineCode"><span class="koboSpan" id="kobo.699.1">{project folder}-&gt;_Imports.razor</span></code><span class="koboSpan" id="kobo.700.1"> folder is automatically applied to all components.</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.701.1">@inherits</span></code><span class="koboSpan" id="kobo.702.1"> declares </span><a id="_idIndexMarker1345"/><span class="koboSpan" id="kobo.703.1">that the component is a subclass of another component, while </span><code class="inlineCode"><span class="koboSpan" id="kobo.704.1">@implements</span></code><span class="koboSpan" id="kobo.705.1"> declares that it implements an interface.</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.706.1">@typeparam</span></code><span class="koboSpan" id="kobo.707.1"> is used if the component is a generic class and declares the name of the generic parameter. </span><code class="inlineCode"><span class="koboSpan" id="kobo.708.1">@typeparam</span></code><span class="koboSpan" id="kobo.709.1"> also allows the specification of generic constraints with the same syntax used in classes: </span><code class="inlineCode"><span class="koboSpan" id="kobo.710.1">@typeparam T where T: class</span></code><span class="koboSpan" id="kobo.711.1">.</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.712.1">@attribute</span></code><span class="koboSpan" id="kobo.713.1"> declares any attribute applied to the component class. </span><span class="koboSpan" id="kobo.713.2">Property-level attributes are applied directly to properties defined in the code area, so they don’t need special notation. </span><span class="koboSpan" id="kobo.713.3">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.714.1">[Authorize]</span></code><span class="koboSpan" id="kobo.715.1"> attribute, applied to a component class used as a page, prevents unauthorized users from accessing the page. </span><span class="koboSpan" id="kobo.715.2">It works exactly in the same way as when it is applied to a controller or to an action method in ASP.NET Core MVC.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.716.1">Finally, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.717.1">@inject</span></code><span class="koboSpan" id="kobo.718.1"> directive requires a type instance to the dependency injection engine and inserts it in the field declared after the type name; in the previous example, in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.719.1">navigation</span></code><span class="koboSpan" id="kobo.720.1"> parameter.</span></li>
</ul>
<p class="normal"><span class="koboSpan" id="kobo.721.1">The middle part of the component file contains the HTML that will be rendered by the component with Razor markup, enriched with the possible invocation of child components.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.722.1">The bottom part of the file is enclosed by an </span><code class="inlineCode"><span class="koboSpan" id="kobo.723.1">@code</span></code><span class="koboSpan" id="kobo.724.1"> construct and contains fields, properties, and methods of the class that implements the component:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.725.1">@code{
 ...
 </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.726.1">private</span></span> <span class="hljs-built_in"><span class="koboSpan" id="kobo.727.1">string</span></span><span class="koboSpan" id="kobo.728.1"> myField=</span><span class="hljs-string"><span class="koboSpan" id="kobo.729.1">"0"</span></span><span class="koboSpan" id="kobo.730.1">;
 [</span><span class="hljs-meta"><span class="koboSpan" id="kobo.731.1">Parameter</span></span><span class="koboSpan" id="kobo.732.1">]
 </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.733.1">public</span></span> <span class="hljs-built_in"><span class="koboSpan" id="kobo.734.1">int</span></span><span class="koboSpan" id="kobo.735.1"> Quantity {</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.736.1">get</span></span><span class="koboSpan" id="kobo.737.1">; </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.738.1">set</span></span><span class="koboSpan" id="kobo.739.1">;}=</span><span class="hljs-number"><span class="koboSpan" id="kobo.740.1">0</span></span><span class="koboSpan" id="kobo.741.1">;
 </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.742.1">private</span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.743.1">void</span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="koboSpan" id="kobo.744.1">IncrementQuantity</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.745.1"> ()</span></span><span class="koboSpan" id="kobo.746.1">
 {
         Quantity++;
 }
 </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.747.1">private</span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.748.1">void</span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="koboSpan" id="kobo.749.1">DecrementQuantity</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.750.1"> ()</span></span><span class="koboSpan" id="kobo.751.1">
 {
        Quantity--;
        </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.752.1">if</span></span><span class="koboSpan" id="kobo.753.1"> (Quantity&lt;</span><span class="hljs-number"><span class="koboSpan" id="kobo.754.1">0</span></span><span class="koboSpan" id="kobo.755.1">) Quantity=</span><span class="hljs-number"><span class="koboSpan" id="kobo.756.1">0</span></span><span class="koboSpan" id="kobo.757.1">;
 }
 ...
</span><span class="koboSpan" id="kobo.757.2">}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.758.1">Public properties </span><a id="_idIndexMarker1346"/><span class="koboSpan" id="kobo.759.1">decorated with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.760.1">[Parameter]</span></code><span class="koboSpan" id="kobo.761.1"> attribute work as component parameters; that is, when the component is instantiated into another component, they are used to pass values to the decorated properties, and those values are passed to HTML elements in HTML markup:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.762.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.763.1">OrderItem</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.764.1">Quantity</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.765.1"> =</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.766.1">"2"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.767.1">Id</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.768.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.769.1">"123"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.770.1">/&gt;</span></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.771.1">Values can also be passed to component parameters by page route parameters, or query string parameters that match the property name in a case-invariant match:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.772.1">OrderItem/{id}/{quantity}
OrderItem/{id}?quantity = 123
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.773.1">However, the match with query string parameters is enabled only if the property is also decorated with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.774.1">SupplyParameterFromQuery</span></code><span class="koboSpan" id="kobo.775.1"> attribute:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.776.1">[</span><span class="hljs-meta"><span class="koboSpan" id="kobo.777.1">Parameter</span></span><span class="koboSpan" id="kobo.778.1">]
[</span><span class="hljs-meta"><span class="koboSpan" id="kobo.779.1">SupplyParameterFromQuery</span></span><span class="koboSpan" id="kobo.780.1">]
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.781.1">public</span></span> <span class="hljs-built_in"><span class="koboSpan" id="kobo.782.1">int</span></span><span class="koboSpan" id="kobo.783.1"> Quantity {</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.784.1">get</span></span><span class="koboSpan" id="kobo.785.1">; </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.786.1">set</span></span><span class="koboSpan" id="kobo.787.1">;}=</span><span class="hljs-number"><span class="koboSpan" id="kobo.788.1">0</span></span><span class="koboSpan" id="kobo.789.1">;
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.790.1">Component parameters can also accept complex types and functions:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.791.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.792.1">modal</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.793.1">title</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.794.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.795.1">'() =&gt; "Test title" '</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.796.1">.....</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.797.1">/&gt;</span></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.798.1">If components are generic, they must be passed type values for each generic parameter declared with </span><code class="inlineCode"><span class="koboSpan" id="kobo.799.1">typeparam</span></code><span class="koboSpan" id="kobo.800.1">:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.801.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.802.1">myGeneric</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.803.1">T</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.804.1">= </span></span><span class="hljs-string"><span class="koboSpan" id="kobo.805.1">"string"</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.806.1">.....</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.807.1">/&gt;</span></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.808.1">However, often, the compiler is able to infer generic types from the types of other parameters.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.809.1">Finally, the code enclosed in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.810.1">@code</span></code><span class="koboSpan" id="kobo.811.1"> directive can also be declared in a partial class with the same name and namespace as the component:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.812.1">public</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.813.1">partial</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.814.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.815.1">Counter</span></span><span class="koboSpan" id="kobo.816.1">
{
  [</span><span class="hljs-meta"><span class="koboSpan" id="kobo.817.1">Parameter</span></span><span class="koboSpan" id="kobo.818.1">]
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.819.1">public</span></span> <span class="hljs-built_in"><span class="koboSpan" id="kobo.820.1">int</span></span><span class="koboSpan" id="kobo.821.1"> CurrentCounter {</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.822.1">get</span></span><span class="koboSpan" id="kobo.823.1">; </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.824.1">set</span></span><span class="koboSpan" id="kobo.825.1">;}=</span><span class="hljs-number"><span class="koboSpan" id="kobo.826.1">0</span></span><span class="koboSpan" id="kobo.827.1">;
  ...
  </span><span class="koboSpan" id="kobo.827.2">...
</span><span class="koboSpan" id="kobo.827.3">}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.828.1">Usually, these </span><a id="_idIndexMarker1347"/><span class="koboSpan" id="kobo.829.1">partial classes are declared in the same folder as the component and with a filename equal to the component’s filename with a </span><code class="inlineCode"><span class="koboSpan" id="kobo.830.1">.cs</span></code><span class="koboSpan" id="kobo.831.1"> postfix added. </span><span class="koboSpan" id="kobo.831.2">Thus, for instance, the partial class associated with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.832.1">counter.razor</span></code><span class="koboSpan" id="kobo.833.1"> component will be </span><code class="inlineCode"><span class="koboSpan" id="kobo.834.1">counter.razor.cs</span></code><span class="koboSpan" id="kobo.835.1">.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.836.1">Each component may also have an associated CSS file, whose name must be the name of the component file plus the </span><code class="inlineCode"><span class="koboSpan" id="kobo.837.1">.css</span></code><span class="koboSpan" id="kobo.838.1"> postfix. </span><span class="koboSpan" id="kobo.838.2">Thus, for instance, the CSS file associated with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.839.1">counter.razor</span></code><span class="koboSpan" id="kobo.840.1"> component will be </span><code class="inlineCode"><span class="koboSpan" id="kobo.841.1">counter.razor.css</span></code><span class="koboSpan" id="kobo.842.1">. </span><span class="koboSpan" id="kobo.842.2">The CSS contained in this file is applied only to the component and has no effect on the remainder of the page. </span><span class="koboSpan" id="kobo.842.3">This is called CSS isolation, and at the moment, it is implemented by adding a unique attribute to all component HTML roots. </span><span class="koboSpan" id="kobo.842.4">Then, all selectors of the component CSS file are scoped to this attribute so that they can’t affect other HTML.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.843.1">Of course, we can also use global application CSS, and in fact, the Blazor template creates the </span><code class="inlineCode"><span class="koboSpan" id="kobo.844.1">wwwroot/css/app.css</span></code><span class="koboSpan" id="kobo.845.1"> file for this purpose.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.846.1">When the Blazor application is packaged, either during a build or during its publication, all isolated CSS is processed and placed in a unique CSS file called </span><code class="inlineCode"><span class="koboSpan" id="kobo.847.1">&lt;assembly name&gt;.Client.styles.css</span></code><span class="koboSpan" id="kobo.848.1">. </span><span class="koboSpan" id="kobo.848.2">That’s why the </span><code class="inlineCode"><span class="koboSpan" id="kobo.849.1">index.html</span></code><span class="koboSpan" id="kobo.850.1"> page of our </span><code class="inlineCode"><span class="koboSpan" id="kobo.851.1">BlazorReview</span></code><span class="koboSpan" id="kobo.852.1"> application contains the following CSS reference:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.853.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.854.1">head</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.855.1">&gt;</span></span><span class="koboSpan" id="kobo.856.1">
    ...
    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.857.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.858.1">link</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.859.1">href</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.860.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.861.1">"BlazorReview.Client.styles.css"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.862.1">rel</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.863.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.864.1">"stylesheet"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.865.1"> /&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.866.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.867.1">head</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.868.1">&gt;</span></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.869.1">It is worth mentioning that isolated CSS can also be obtained with pure CSS techniques, or using the </span><strong class="keyWord"><span class="koboSpan" id="kobo.870.1">Sass</span></strong><span class="koboSpan" id="kobo.871.1"> language, which compiles with CSS.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.872.1">Whenever a component decorates an </span><code class="inlineCode"><span class="koboSpan" id="kobo.873.1">IDictionary&lt;string, object&gt;</span></code><span class="koboSpan" id="kobo.874.1"> parameter with </span><code class="inlineCode"><span class="koboSpan" id="kobo.875.1">[Parameter(CaptureUnmatchedValues = true)]</span></code><span class="koboSpan" id="kobo.876.1">, then all unmatched parameters inserted into the tag, that is, all parameters without a matching component property, are added to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.877.1">IDictionary</span></code><span class="koboSpan" id="kobo.878.1"> as key-value pairs.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.879.1">This feature provides an easy way to forward parameters to HTML elements or ­other child components contained in the component markup. </span><span class="koboSpan" id="kobo.879.2">For instance, if we have a </span><code class="inlineCode"><span class="koboSpan" id="kobo.880.1">Detail</span></code><span class="koboSpan" id="kobo.881.1"> component that displays a detail view of the object passed in its </span><code class="inlineCode"><span class="koboSpan" id="kobo.882.1">Value</span></code><span class="koboSpan" id="kobo.883.1"> parameter, we </span><a id="_idIndexMarker1348"/><span class="koboSpan" id="kobo.884.1">can use this feature to forward all usual HTML attributes to the root HTML tag of the component, as shown in the following example:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.885.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.886.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.887.1">  @</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.888.1">attributes</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.889.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.890.1">"AdditionalAttributes"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.891.1">&gt;</span></span><span class="koboSpan" id="kobo.892.1">
...
</span><span class="hljs-tag"><span class="koboSpan" id="kobo.893.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.894.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.895.1">&gt;</span></span><span class="koboSpan" id="kobo.896.1">
@code{
 [Parameter(CaptureUnmatchedValues = true)]
 public Dictionary&lt;string, object&gt;
 AdditionalAttributes { get; set; }
 [Parameter]
 Public T Value {get; set;}
}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.897.1">This way, usual HTML attributes added to the component tag, for instance, </span><code class="inlineCode"><span class="koboSpan" id="kobo.898.1">class</span></code><span class="koboSpan" id="kobo.899.1">, are forwarded to the root </span><code class="inlineCode"><span class="koboSpan" id="kobo.900.1">div</span></code><span class="koboSpan" id="kobo.901.1"> of the components and used to style the component:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.902.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.903.1">Detail</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.904.1">Value</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.905.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.906.1">"myObject"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.907.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.908.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.909.1">"my-css-class"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.910.1">/&gt;</span></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.911.1">The next subsection explains how to pass markup-generating functions to components.</span></p>
<h2 class="heading-2" id="_idParaDest-389"><span class="koboSpan" id="kobo.912.1">Templates and cascading parameters</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.913.1">Blazor works</span><a id="_idIndexMarker1349"/><span class="koboSpan" id="kobo.914.1"> by building a data structure called a </span><strong class="keyWord"><span class="koboSpan" id="kobo.915.1">render tree</span></strong><span class="koboSpan" id="kobo.916.1">, which</span><a id="_idIndexMarker1350"/><span class="koboSpan" id="kobo.917.1"> is updated as the UI changes. </span><span class="koboSpan" id="kobo.917.2">At each change, Blazor locates the part of the HTML that must be rendered and uses the information contained in the </span><strong class="keyWord"><span class="koboSpan" id="kobo.918.1">render tree</span></strong><span class="koboSpan" id="kobo.919.1"> to update it.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.920.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.921.1">RenderFragment</span></code><span class="koboSpan" id="kobo.922.1"> delegate </span><a id="_idIndexMarker1351"/><span class="koboSpan" id="kobo.923.1">defines a function that is able to add further markup to a specific position of the </span><strong class="keyWord"><span class="koboSpan" id="kobo.924.1">render tree</span></strong><span class="koboSpan" id="kobo.925.1">. </span><span class="koboSpan" id="kobo.925.2">There is also </span><code class="inlineCode"><span class="koboSpan" id="kobo.926.1">RenderFragment&lt;T&gt;</span></code><span class="koboSpan" id="kobo.927.1">, which accepts a further argument you can use to drive the markup generation. </span><span class="koboSpan" id="kobo.927.2">For instance, you can pass a </span><code class="inlineCode"><span class="koboSpan" id="kobo.928.1">Customer</span></code><span class="koboSpan" id="kobo.929.1"> object to </span><code class="inlineCode"><span class="koboSpan" id="kobo.930.1">RenderFragment&lt;T&gt;</span></code><span class="koboSpan" id="kobo.931.1"> so that it can render all the data for that specific customer.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.932.1">You can define </span><code class="inlineCode"><span class="koboSpan" id="kobo.933.1">RenderFragment</span></code><span class="koboSpan" id="kobo.934.1"> or </span><code class="inlineCode"><span class="koboSpan" id="kobo.935.1">RenderFragment&lt;T&gt;</span></code><span class="koboSpan" id="kobo.936.1"> with C# code, but the simplest way is to define it in your components with Razor markup. </span><span class="koboSpan" id="kobo.936.2">The Razor compiler will take care of generating the proper C# code for you:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.937.1">RenderFragment myRenderFragment = @</span><span class="hljs-tag"><span class="koboSpan" id="kobo.938.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.939.1">p</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.940.1">&gt;</span></span><span class="koboSpan" id="kobo.941.1">The time is @DateTime.Now.</span><span class="hljs-tag"><span class="koboSpan" id="kobo.942.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.943.1">p</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.944.1">&gt;</span></span><span class="koboSpan" id="kobo.945.1">;
RenderFragment</span><span class="hljs-tag"><span class="koboSpan" id="kobo.946.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.947.1">Customer</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.948.1">&gt;</span></span><span class="koboSpan" id="kobo.949.1"> customerRenderFragment =
(item) =&gt; @</span><span class="hljs-tag"><span class="koboSpan" id="kobo.950.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.951.1">p</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.952.1">&gt;</span></span><span class="koboSpan" id="kobo.953.1">Customer name is @item.Name.</span><span class="hljs-tag"><span class="koboSpan" id="kobo.954.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.955.1">p</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.956.1">&gt;</span></span><span class="koboSpan" id="kobo.957.1">;
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.958.1">The</span><a id="_idIndexMarker1352"/><span class="koboSpan" id="kobo.959.1"> information </span><a id="_idIndexMarker1353"/><span class="koboSpan" id="kobo.960.1">on the location to add the markup is passed in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.961.1">RenderTreeBuilder</span></code><span class="koboSpan" id="kobo.962.1"> argument it receives as an argument. </span><span class="koboSpan" id="kobo.962.2">You can use </span><code class="inlineCode"><span class="koboSpan" id="kobo.963.1">RenderFragment</span></code><span class="koboSpan" id="kobo.964.1"> in your component Razor markup by simply invoking it as shown in the following example:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.965.1">RenderFragment myRenderFragment = ...
  </span><span class="koboSpan" id="kobo.965.2">...
</span><span class="hljs-tag"><span class="koboSpan" id="kobo.966.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.967.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.968.1">&gt;</span></span><span class="koboSpan" id="kobo.969.1">
  ...
  </span><span class="koboSpan" id="kobo.969.2">@myRenderFragment
  ...
</span><span class="hljs-tag"><span class="koboSpan" id="kobo.970.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.971.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.972.1">&gt;</span></span><span class="koboSpan" id="kobo.973.1">
  ...
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.974.1">The position where you invoke </span><code class="inlineCode"><span class="koboSpan" id="kobo.975.1">RenderFragment</span></code><span class="koboSpan" id="kobo.976.1"> defines the location where it will add its markup, since the component compiler is able to generate the right </span><code class="inlineCode"><span class="koboSpan" id="kobo.977.1">RenderTreeBuilder</span></code><span class="koboSpan" id="kobo.978.1"> argument to pass to it. </span><code class="inlineCode"><span class="koboSpan" id="kobo.979.1">RenderFragment&lt;T&gt;</span></code><span class="koboSpan" id="kobo.980.1"> delegates are invoked as shown here:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.981.1">Customer myCustomer = ...
  </span><span class="koboSpan" id="kobo.981.2">...
</span><span class="hljs-tag"><span class="koboSpan" id="kobo.982.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.983.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.984.1">&gt;</span></span><span class="koboSpan" id="kobo.985.1">
  ...
  </span><span class="koboSpan" id="kobo.985.2">@myRenderFragment(myCustomer)
  ...
</span><span class="hljs-tag"><span class="koboSpan" id="kobo.986.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.987.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.988.1">&gt;</span></span><span class="koboSpan" id="kobo.989.1">
  ...
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.990.1">Being functions, render fragments can be passed to component parameters like all other types. </span><span class="koboSpan" id="kobo.990.2">However, Blazor has a specific syntax to make it easier to simultaneously define and pass render fragments to c</span><a id="_idIndexMarker1354"/><span class="koboSpan" id="kobo.991.1">omponents: the </span><strong class="keyWord"><span class="koboSpan" id="kobo.992.1">template</span></strong><span class="koboSpan" id="kobo.993.1"> syntax. </span><span class="koboSpan" id="kobo.993.2">First, you define the parameters in your component:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.994.1">[</span><span class="hljs-meta"><span class="koboSpan" id="kobo.995.1">Parameter</span></span><span class="koboSpan" id="kobo.996.1">]
Public RenderFragment&lt;Customer&gt;CustomerTemplate {</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.997.1">get</span></span><span class="koboSpan" id="kobo.998.1">; </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.999.1">set</span></span><span class="koboSpan" id="kobo.1000.1">;}
[</span><span class="hljs-meta"><span class="koboSpan" id="kobo.1001.1">Parameter</span></span><span class="koboSpan" id="kobo.1002.1">]
Public RenderFragment Title {</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1003.1">get</span></span><span class="koboSpan" id="kobo.1004.1">; </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1005.1">set</span></span><span class="koboSpan" id="kobo.1006.1">;}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1007.1">Then, when you call the customer, you can do the following:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.1008.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1009.1">Detail</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1010.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1011.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1012.1">Title</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1013.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1014.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1015.1">h5</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1016.1">&gt;</span></span><span class="koboSpan" id="kobo.1017.1">This is a title</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1018.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1019.1">h5</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1020.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1021.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1022.1">Title</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1023.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1024.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1025.1">CustomerTemplate</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1026.1">Context</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1027.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1028.1">customer</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1029.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1030.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1031.1">p</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1032.1">&gt;</span></span><span class="koboSpan" id="kobo.1033.1">Customer name is @customer.Name.</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1034.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1035.1">p</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1036.1">&gt;</span></span><span class="koboSpan" id="kobo.1037.1">
  &lt;/</span><span class="hljs-name"><span class="koboSpan" id="kobo.1038.1">CustomerTemplate</span></span><span class="koboSpan" id="kobo.1039.1">&gt;
</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1040.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1041.1">Detail</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1042.1">&gt;</span></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1043.1">Each </span><code class="inlineCode"><span class="koboSpan" id="kobo.1044.1">RenderFragment</span></code><span class="koboSpan" id="kobo.1045.1"> parameter is </span><a id="_idIndexMarker1355"/><span class="koboSpan" id="kobo.1046.1">represented by a tag with the same </span><a id="_idIndexMarker1356"/><span class="koboSpan" id="kobo.1047.1">name as the parameter. </span><span class="koboSpan" id="kobo.1047.2">You can place the markup that defines </span><code class="inlineCode"><span class="koboSpan" id="kobo.1048.1">RenderFragment</span></code><span class="koboSpan" id="kobo.1049.1"> inside of it. </span><span class="koboSpan" id="kobo.1049.2">For the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1050.1">CustomerTemplate</span></code><span class="koboSpan" id="kobo.1051.1"> that has a parameter, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1052.1">Context</span></code><span class="koboSpan" id="kobo.1053.1"> keyword defines the parameter name inside the markup. </span><span class="koboSpan" id="kobo.1053.2">In our example, the chosen parameter name is </span><code class="inlineCode"><span class="koboSpan" id="kobo.1054.1">customer</span></code><span class="koboSpan" id="kobo.1055.1">.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1056.1">When a component has just one render fragment parameter, if it is named </span><code class="inlineCode"><span class="koboSpan" id="kobo.1057.1">ChildContent</span></code><span class="koboSpan" id="kobo.1058.1">, the template markup can be enclosed directly between the opening and closing tags of the component:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1059.1">[</span><span class="hljs-meta"><span class="koboSpan" id="kobo.1060.1">Parameter</span></span><span class="koboSpan" id="kobo.1061.1">]
Public RenderFragment&lt;Customer&gt; ChildContent {</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1062.1">get</span></span><span class="koboSpan" id="kobo.1063.1">; </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1064.1">set</span></span><span class="koboSpan" id="kobo.1065.1">;}
……………
……………
&lt;IHaveJustOneRenderFragment Context=customer&gt;
  &lt;p&gt;Customer name </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1066.1">is</span></span><span class="koboSpan" id="kobo.1067.1"> @customer.Name.&lt;/p&gt;
&lt;/IHaveJustOneRenderFragment&gt;
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1068.1">In order to familiarize ourselves with component templates, let’s modify the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1069.1">Pages-&gt;Weather.razor</span></code><span class="koboSpan" id="kobo.1070.1"> page so that, instead of using </span><code class="inlineCode"><span class="koboSpan" id="kobo.1071.1">foreach</span></code><span class="koboSpan" id="kobo.1072.1">, it uses a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1073.1">Repeater</span></code><span class="koboSpan" id="kobo.1074.1"> component.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1075.1">Let’s right-click on the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1076.1">Layout</span></code><span class="koboSpan" id="kobo.1077.1"> folder, select </span><strong class="screenText"><span class="koboSpan" id="kobo.1078.1">Add</span></strong><span class="koboSpan" id="kobo.1079.1"> and then </span><strong class="screenText"><span class="koboSpan" id="kobo.1080.1">Razor Component</span></strong><span class="koboSpan" id="kobo.1081.1">, and add a new </span><code class="inlineCode"><span class="koboSpan" id="kobo.1082.1">Repeater.razor</span></code><span class="koboSpan" id="kobo.1083.1"> component. </span><span class="koboSpan" id="kobo.1083.2">Then, replace the existing code with this:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1084.1">@typeparam T
@foreach(</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1085.1">var</span></span><span class="koboSpan" id="kobo.1086.1"> item </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1087.1">in</span></span><span class="koboSpan" id="kobo.1088.1"> Values)
{
  @ChildContent(item)
}
@code {
    [</span><span class="hljs-meta"><span class="koboSpan" id="kobo.1089.1">Parameter</span></span><span class="koboSpan" id="kobo.1090.1">]
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1091.1">public</span></span><span class="koboSpan" id="kobo.1092.1"> RenderFragment&lt;T&gt; ChildContent { </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1093.1">get</span></span><span class="koboSpan" id="kobo.1094.1">; </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1095.1">set</span></span><span class="koboSpan" id="kobo.1096.1">; }
    [</span><span class="hljs-meta"><span class="koboSpan" id="kobo.1097.1">Parameter</span></span><span class="koboSpan" id="kobo.1098.1">]
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1099.1">public</span></span><span class="koboSpan" id="kobo.1100.1"> IEnumerable&lt;T&gt; Values { </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1101.1">get</span></span><span class="koboSpan" id="kobo.1102.1">; </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1103.1">set</span></span><span class="koboSpan" id="kobo.1104.1">; }
}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1105.1">The component is defined with a generic parameter so that it can be used with any </span><code class="inlineCode"><span class="koboSpan" id="kobo.1106.1">IEnumerable</span></code><span class="koboSpan" id="kobo.1107.1">. </span><span class="koboSpan" id="kobo.1107.2">Now</span><a id="_idIndexMarker1357"/><span class="koboSpan" id="kobo.1108.1"> let’s replace the markup in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1109.1">tbody</span></code><span class="koboSpan" id="kobo.1110.1"> of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1111.1">Weather.razor</span></code><span class="koboSpan" id="kobo.1112.1"> component with this:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.1113.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1114.1">Repeater</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1115.1">Values</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1116.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1117.1">"forecasts"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1118.1">Context</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1119.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1120.1">"forecast"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1121.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1122.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1123.1">tr</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1124.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1125.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1126.1">td</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1127.1">&gt;</span></span><span class="koboSpan" id="kobo.1128.1">@forecast.Date.ToShortDateString()</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1129.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1130.1">td</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1131.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1132.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1133.1">td</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1134.1">&gt;</span></span><span class="koboSpan" id="kobo.1135.1">@forecast.TemperatureC</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1136.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1137.1">td</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1138.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1139.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1140.1">td</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1141.1">&gt;</span></span><span class="koboSpan" id="kobo.1142.1">@forecast.TemperatureF</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1143.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1144.1">td</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1145.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1146.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1147.1">td</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1148.1">&gt;</span></span><span class="koboSpan" id="kobo.1149.1">@forecast.Summary</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1150.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1151.1">td</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1152.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1153.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1154.1">tr</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1155.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1156.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1157.1">Repeater</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1158.1">&gt;</span></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1159.1">Since</span><a id="_idIndexMarker1358"/><span class="koboSpan" id="kobo.1160.1"> the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1161.1">Repeater</span></code><span class="koboSpan" id="kobo.1162.1"> component has just one template, and since we named it </span><code class="inlineCode"><span class="koboSpan" id="kobo.1163.1">ChildContent</span></code><span class="koboSpan" id="kobo.1164.1">, we can place our template markup directly within the component open and close tags. </span><span class="koboSpan" id="kobo.1164.2">Run it and verify that the page works properly. </span><span class="koboSpan" id="kobo.1164.3">You have learned how to use templates and that markup placed inside a component defines a template.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1165.1">An important predefined templated Blazor component is the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1166.1">CascadingValue</span></code><span class="koboSpan" id="kobo.1167.1"> component. </span><span class="koboSpan" id="kobo.1167.2">It renders the content placed inside of it with no changes, but passes a type instance to all its descendant components:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.1168.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1169.1">CascadingValue</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1170.1">Value</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1171.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1172.1">"new MyOptionsInstance{...}"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1173.1">&gt;</span></span><span class="koboSpan" id="kobo.1174.1">
……
&lt;/</span><span class="hljs-name"><span class="koboSpan" id="kobo.1175.1">CascadingValue</span></span><span class="koboSpan" id="kobo.1176.1">&gt;
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1177.1">All components placed inside of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1178.1">CascadingValue</span></code><span class="koboSpan" id="kobo.1179.1"> tag and all their descendant components can now capture the instance of </span><code class="inlineCode"><span class="koboSpan" id="kobo.1180.1">MyOptionsInstance</span></code><span class="koboSpan" id="kobo.1181.1"> passed in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1182.1">CascadingValue</span></code><span class="koboSpan" id="kobo.1183.1"> parameter. </span><span class="koboSpan" id="kobo.1183.2">It is enough that the component declares a public or private property with a type that is compatible with </span><code class="inlineCode"><span class="koboSpan" id="kobo.1184.1">MyOptionsInstance</span></code><span class="koboSpan" id="kobo.1185.1"> and that decorates it with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1186.1">CascadingParameter</span></code><span class="koboSpan" id="kobo.1187.1"> attribute:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1188.1">[</span><span class="hljs-meta"><span class="koboSpan" id="kobo.1189.1">CascadingParameter</span></span><span class="koboSpan" id="kobo.1190.1">]
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1191.1">private</span></span><span class="koboSpan" id="kobo.1192.1"> MyOptionsInstance options {</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1193.1">get</span></span><span class="koboSpan" id="kobo.1194.1">; </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1195.1">set</span></span><span class="koboSpan" id="kobo.1196.1">;}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1197.1">Matching is performed by type compatibility. </span><span class="koboSpan" id="kobo.1197.2">If there’s ambiguity with other cascaded parameters with a compatible type, we can specify the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1198.1">Name</span></code><span class="koboSpan" id="kobo.1199.1"> optional parameter of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1200.1">CascadingValue</span></code><span class="koboSpan" id="kobo.1201.1"> component and pass the same name to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1202.1">CascadingParameter</span></code><span class="koboSpan" id="kobo.1203.1"> attribute: </span><code class="inlineCode"><span class="koboSpan" id="kobo.1204.1">[CascadingParameter("myUnique name")]</span></code><span class="koboSpan" id="kobo.1205.1">.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1206.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.1207.1">CascadingValue</span></code><span class="koboSpan" id="kobo.1208.1"> tag also has an </span><code class="inlineCode"><span class="koboSpan" id="kobo.1209.1">IsFixed</span></code><span class="koboSpan" id="kobo.1210.1"> parameter that should be set to </span><code class="inlineCode"><span class="koboSpan" id="kobo.1211.1">true</span></code><span class="koboSpan" id="kobo.1212.1"> whenever possible for performance reasons. </span><span class="koboSpan" id="kobo.1212.2">In fact, propagating cascading values is very useful for passing options and settings, but it has a very high computational cost.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1213.1">When </span><code class="inlineCode"><span class="koboSpan" id="kobo.1214.1">IsFixed</span></code><span class="koboSpan" id="kobo.1215.1"> is set</span><a id="_idIndexMarker1359"/><span class="koboSpan" id="kobo.1216.1"> to </span><code class="inlineCode"><span class="koboSpan" id="kobo.1217.1">true</span></code><span class="koboSpan" id="kobo.1218.1">, propagation is performed just </span><a id="_idIndexMarker1360"/><span class="koboSpan" id="kobo.1219.1">once, the first time that each piece of content involved is rendered, and then no attempt is made to update the cascaded value during the content’s lifetime. </span><span class="koboSpan" id="kobo.1219.2">Thus, </span><code class="inlineCode"><span class="koboSpan" id="kobo.1220.1">IsFixed</span></code><span class="koboSpan" id="kobo.1221.1"> can be used whenever the pointer of the cascaded object is not changed during the content’s lifetime.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1222.1">An example of a cascading value is the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1223.1">CascadingAuthenticationState</span></code><span class="koboSpan" id="kobo.1224.1"> component we encountered in the </span><em class="italic"><span class="koboSpan" id="kobo.1225.1">Routing</span></em><span class="koboSpan" id="kobo.1226.1"> subsection, which cascades authentication and authorization information to all rendered components.</span></p>
<h2 class="heading-2" id="_idParaDest-390"><span class="koboSpan" id="kobo.1227.1">Error handling</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.1228.1">As the </span><a id="_idIndexMarker1361"/><span class="koboSpan" id="kobo.1229.1">default, when an error in a component occurs, the exception is intercepted by the .NET runtime, which automatically makes visible the error code contained in </span><code class="inlineCode"><span class="koboSpan" id="kobo.1230.1">index.html</span></code><span class="koboSpan" id="kobo.1231.1">:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.1232.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1233.1">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1234.1">id</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1235.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1236.1">"blazor-error-ui"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1237.1">&gt;</span></span><span class="koboSpan" id="kobo.1238.1">
        An unhandled error has occurred.
    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1239.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1240.1">a</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1241.1">href</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1242.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1243.1">""</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1244.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1245.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1246.1">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1247.1">reload"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1248.1">&gt;</span></span><span class="koboSpan" id="kobo.1249.1">Reload</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1250.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1251.1">a</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1252.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1253.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1254.1">a</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1255.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1256.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1257.1">"dismiss"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1258.1">&gt;</span></span><span class="koboSpan" id="kobo.1259.1"> / </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1260.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1261.1">a</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1262.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1263.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1264.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1265.1">&gt;</span></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1266.1">However, component errors can be intercepted and handled locally by enclosing the component inside an </span><code class="inlineCode"><span class="koboSpan" id="kobo.1267.1">ErrorBoundary</span></code><span class="koboSpan" id="kobo.1268.1"> component. </span><span class="koboSpan" id="kobo.1268.2">Below, the code of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1269.1">Repeater</span></code><span class="koboSpan" id="kobo.1270.1"> example in the previous subsection has been modified to locally handle errors that might occur in each row:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.1271.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1272.1">Repeater</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1273.1">Values</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1274.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1275.1">"forecasts"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1276.1">Context</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1277.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1278.1">"forecast"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1279.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1280.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1281.1">tr</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1282.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1283.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1284.1">ErrorBoundary</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1285.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1286.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1287.1">ChildContent</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1288.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1289.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1290.1">td</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1291.1">&gt;</span></span><span class="koboSpan" id="kobo.1292.1">@forecast.Date.ToShortDateString()</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1293.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1294.1">td</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1295.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1296.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1297.1">td</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1298.1">&gt;</span></span><span class="koboSpan" id="kobo.1299.1">@forecast.TemperatureC</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1300.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1301.1">td</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1302.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1303.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1304.1">td</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1305.1">&gt;</span></span><span class="koboSpan" id="kobo.1306.1">@forecast.TemperatureF</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1307.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1308.1">td</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1309.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1310.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1311.1">td</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1312.1">&gt;</span></span><span class="koboSpan" id="kobo.1313.1">@forecast.Summary</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1314.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1315.1">td</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1316.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1317.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1318.1">ChildContent</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1319.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1320.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1321.1">ErrorContent</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1322.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1323.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1324.1">td</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1325.1">colspan</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1326.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1327.1">"4"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1328.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1329.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1330.1">"my-error"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1331.1">&gt;</span></span><span class="koboSpan" id="kobo.1332.1">Nothing to see here. </span><span class="koboSpan" id="kobo.1332.2">Sorry!</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1333.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1334.1">td</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1335.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1336.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1337.1">ErrorContent</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1338.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1339.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1340.1">ErrorBoundary</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1341.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1342.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1343.1">tr</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1344.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1345.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1346.1">Repeater</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1347.1">&gt;</span></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1348.1">The </span><a id="_idIndexMarker1362"/><span class="koboSpan" id="kobo.1349.1">standard code is placed in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1350.1">ChildContent</span></code><span class="koboSpan" id="kobo.1351.1"> template, while the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1352.1">ErrorContent</span></code><span class="koboSpan" id="kobo.1353.1"> template is shown if there’s an error.</span></p>
<h2 class="heading-2" id="_idParaDest-391"><span class="koboSpan" id="kobo.1354.1">Events</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.1355.1">Both HTML tags and </span><a id="_idIndexMarker1363"/><span class="koboSpan" id="kobo.1356.1">Blazor components use attributes/parameters to get input. </span><span class="koboSpan" id="kobo.1356.2">HTML tags provide output to the remainder of the page through events, and Blazor allows C# functions to be attached to HTML </span><code class="inlineCode"><span class="koboSpan" id="kobo.1357.1">on{event name}</span></code><span class="koboSpan" id="kobo.1358.1"> attributes. </span><span class="koboSpan" id="kobo.1358.2">The syntax is shown in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1359.1">Pages-&gt;Counter.razor</span></code><span class="koboSpan" id="kobo.1360.1"> component:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1361.1">&lt;p role=</span><span class="hljs-string"><span class="koboSpan" id="kobo.1362.1">"status"</span></span><span class="koboSpan" id="kobo.1363.1">&gt;Current count: @currentCount&lt;/p&gt;
&lt;button </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1364.1">class</span></span><span class="koboSpan" id="kobo.1365.1">=</span><span class="hljs-string"><span class="koboSpan" id="kobo.1366.1">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1367.1">btn btn-primary"</span></span><span class="koboSpan" id="kobo.1368.1"> @onclick=</span><span class="hljs-string"><span class="koboSpan" id="kobo.1369.1">"IncrementCount"</span></span><span class="koboSpan" id="kobo.1370.1">&gt;Click me&lt;/button&gt;
@code {
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1371.1">private</span></span> <span class="hljs-built_in"><span class="koboSpan" id="kobo.1372.1">int</span></span><span class="koboSpan" id="kobo.1373.1"> currentCount = </span><span class="hljs-number"><span class="koboSpan" id="kobo.1374.1">0</span></span><span class="koboSpan" id="kobo.1375.1">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1376.1">private</span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1377.1">void</span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="koboSpan" id="kobo.1378.1">IncrementCount</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.1379.1">()</span></span><span class="koboSpan" id="kobo.1380.1">
    {
        currentCount++;
    }
}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1381.1">The function can also be passed inline as a lambda. </span><span class="koboSpan" id="kobo.1381.2">Moreover, it accepts the C# equivalent of the usual </span><code class="inlineCode"><span class="koboSpan" id="kobo.1382.1">event</span></code><span class="koboSpan" id="kobo.1383.1"> argument. </span><span class="koboSpan" id="kobo.1383.2">The </span><em class="italic"><span class="koboSpan" id="kobo.1384.1">Further reading</span></em><span class="koboSpan" id="kobo.1385.1"> section contains a link to the Blazor official documentation page that lists all supported events and their arguments.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1386.1">Since Blazor components are designed as enhanced versions of HTML elements—with added capabilities—they can also have events. </span><span class="koboSpan" id="kobo.1386.2">However, unlike standard HTML elements, both the features and implementations of these events in Blazor components are defined by the developer.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1387.1">Blazor events enable components to return output, too. </span><span class="koboSpan" id="kobo.1387.2">Component events are defined as parameters whose type is either </span><code class="inlineCode"><span class="koboSpan" id="kobo.1388.1">EventCallBack</span></code><span class="koboSpan" id="kobo.1389.1"> or </span><code class="inlineCode"><span class="koboSpan" id="kobo.1390.1">EventCallBack&lt;T&gt;</span></code><span class="koboSpan" id="kobo.1391.1">. </span><code class="inlineCode"><span class="koboSpan" id="kobo.1392.1">EventCallBack</span></code><span class="koboSpan" id="kobo.1393.1"> is the type of component event with no arguments while </span><code class="inlineCode"><span class="koboSpan" id="kobo.1394.1">EventCallBack&lt;T&gt;</span></code><span class="koboSpan" id="kobo.1395.1"> is the type of component event with an argument of type </span><code class="inlineCode"><span class="koboSpan" id="kobo.1396.1">T</span></code><span class="koboSpan" id="kobo.1397.1">. </span><span class="koboSpan" id="kobo.1397.2">In order to trigger an event, say </span><code class="inlineCode"><span class="koboSpan" id="kobo.1398.1">MyEvent</span></code><span class="koboSpan" id="kobo.1399.1">, the component calls:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1400.1">await</span></span><span class="koboSpan" id="kobo.1401.1"> MyEvent.InvokeAsync()
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1402.1">or</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1403.1">await</span></span><span class="koboSpan" id="kobo.1404.1"> MyIntEvent.InvokeAsync(arg)
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1405.1">These calls execute the handlers bound to the events or do nothing if no handler has been bound.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1406.1">Once defined, component</span><a id="_idIndexMarker1364"/><span class="koboSpan" id="kobo.1407.1"> events can be used exactly in the same way as HTML element events, the only difference being that there is no need to prefix the event name with an </span><code class="inlineCode"><span class="koboSpan" id="kobo.1408.1">@</span></code><span class="koboSpan" id="kobo.1409.1">, since </span><code class="inlineCode"><span class="koboSpan" id="kobo.1410.1">@</span></code><span class="koboSpan" id="kobo.1411.1"> in HTML events is needed to distinguish between the HTML attribute and the Blazor-added parameter with the same name:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1412.1">[</span><span class="hljs-meta"><span class="koboSpan" id="kobo.1413.1">Parameter</span></span><span class="koboSpan" id="kobo.1414.1">]
publicEventCallback MyEvent {</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1415.1">get</span></span><span class="koboSpan" id="kobo.1416.1">; </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1417.1">set</span></span><span class="koboSpan" id="kobo.1418.1">;}
[</span><span class="hljs-meta"><span class="koboSpan" id="kobo.1419.1">Parameter</span></span><span class="koboSpan" id="kobo.1420.1">]
publicEventCallback&lt;</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1421.1">int</span></span><span class="koboSpan" id="kobo.1422.1">&gt; MyIntEvent {</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1423.1">get</span></span><span class="koboSpan" id="kobo.1424.1">; </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1425.1">set</span></span><span class="koboSpan" id="kobo.1426.1">;}
...
</span><span class="koboSpan" id="kobo.1426.2">...
</span><span class="koboSpan" id="kobo.1426.3">&lt;ExampleComponent
MyEvent=</span><span class="hljs-string"><span class="koboSpan" id="kobo.1427.1">"() =&gt; ..."</span></span><span class="koboSpan" id="kobo.1428.1">
MyIntEvent = </span><span class="hljs-string"><span class="koboSpan" id="kobo.1429.1">"(i) =&gt;..."</span></span><span class="koboSpan" id="kobo.1430.1"> /&gt;
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1431.1">Actually, HTML element events are also </span><code class="inlineCode"><span class="koboSpan" id="kobo.1432.1">EventCallBack&lt;T&gt;</span></code><span class="koboSpan" id="kobo.1433.1"> events. </span><span class="koboSpan" id="kobo.1433.2">That is why both event types behave in exactly the same way. </span><code class="inlineCode"><span class="koboSpan" id="kobo.1434.1">EventCallBack</span></code><span class="koboSpan" id="kobo.1435.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.1436.1">EventCallBack&lt;T&gt;</span></code><span class="koboSpan" id="kobo.1437.1"> are structs, not delegates, since they contain a delegate, together with a pointer to the entity that must be notified that the event has been triggered. </span><span class="koboSpan" id="kobo.1437.2">Formally, this entity is represented by a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1438.1">Microsoft.AspNetCore.Components.IHandleEvent</span></code><span class="koboSpan" id="kobo.1439.1"> interface. </span><span class="koboSpan" id="kobo.1439.2">Needless to say, all components implement this interface. </span><span class="koboSpan" id="kobo.1439.3">The notification informs </span><code class="inlineCode"><span class="koboSpan" id="kobo.1440.1">IHandleEvent</span></code><span class="koboSpan" id="kobo.1441.1"> that a state change took place. </span><span class="koboSpan" id="kobo.1441.2">State changes play a fundamental role in the way Blazor updates the page HTML. </span><span class="koboSpan" id="kobo.1441.3">We will analyze them in detail in the next subsection.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1442.1">For HTML elements, Blazor also provides the possibility to stop the event’s default action and the event bubbling by adding the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1443.1">:preventDefault</span></code><span class="koboSpan" id="kobo.1444.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.1445.1">:stopPropagation</span></code><span class="koboSpan" id="kobo.1446.1"> directives to the attribute that specifies the event, like in these examples:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1447.1">@onkeypress=</span><span class="hljs-string"><span class="koboSpan" id="kobo.1448.1">"KeyHandler"</span></span><span class="koboSpan" id="kobo.1449.1"> @onkeypress:preventDefault=</span><span class="hljs-string"><span class="koboSpan" id="kobo.1450.1">"true"</span></span><span class="koboSpan" id="kobo.1451.1">
@onkeypress:stopPropagation  =</span><span class="hljs-string"><span class="koboSpan" id="kobo.1452.1">"true"</span></span>
</code></pre>
<h2 class="heading-2" id="_idParaDest-392"><span class="koboSpan" id="kobo.1453.1">Bindings</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.1454.1">Often, a component </span><a id="_idIndexMarker1365"/><span class="koboSpan" id="kobo.1455.1">parameter value must be kept synchronized with an external variable, property, or field. </span><span class="koboSpan" id="kobo.1455.2">The typical application of this kind of synchronization is an object property being edited in an input component or HTML tag. </span><span class="koboSpan" id="kobo.1455.3">Whenever the user changes the input value, the object property must be updated coherently, and vice versa. </span><span class="koboSpan" id="kobo.1455.4">The object property value must be copied into the component as soon as the component is rendered so that the user can edit it.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1456.1">Similar scenarios are handled by parameter-event pairs. </span><span class="koboSpan" id="kobo.1456.2">More specifically, from one side, the property is copied in the input component parameter. </span><span class="koboSpan" id="kobo.1456.3">From the other side, each time the input changes value, a component event that updates the property is triggered. </span><span class="koboSpan" id="kobo.1456.4">This way, property and input values are kept synchronized.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1457.1">This scenario is so common and useful that Blazor has a specific syntax for simultaneously defining the event and copying the property value into the parameter. </span><span class="koboSpan" id="kobo.1457.2">This simplified syntax requires that the event has the same name as the parameter involved in the interaction but with a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1458.1">Changed</span></code><span class="koboSpan" id="kobo.1459.1"> postfix.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1460.1">Suppose, for instance, that a component has a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1461.1">Value</span></code><span class="koboSpan" id="kobo.1462.1"> parameter. </span><span class="koboSpan" id="kobo.1462.2">Then, the corresponding event must be </span><code class="inlineCode"><span class="koboSpan" id="kobo.1463.1">ValueChanged</span></code><span class="koboSpan" id="kobo.1464.1">. </span><span class="koboSpan" id="kobo.1464.2">Moreover, each time the user changes the component value, the component must invoke the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1465.1">ValueChanged</span></code><span class="koboSpan" id="kobo.1466.1"> event by calling </span><code class="inlineCode"><span class="koboSpan" id="kobo.1467.1">await ValueChanged.InvokeAsync(arg)</span></code><span class="koboSpan" id="kobo.1468.1">. </span><span class="koboSpan" id="kobo.1468.2">With this in place, a property called </span><code class="inlineCode"><span class="koboSpan" id="kobo.1469.1">MyObject.MyProperty</span></code><span class="koboSpan" id="kobo.1470.1"> can be synchronized with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1471.1">Value</span></code><span class="koboSpan" id="kobo.1472.1"> property with the syntax shown here:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1473.1">&lt;MyComponent @bind-Value=</span><span class="hljs-string"><span class="koboSpan" id="kobo.1474.1">"MyObject.MyProperty"</span></span><span class="koboSpan" id="kobo.1475.1">/&gt;
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1476.1">The preceding syntax is called </span><code class="inlineCode"><span class="koboSpan" id="kobo.1477.1">binding</span></code><span class="koboSpan" id="kobo.1478.1">. </span><span class="koboSpan" id="kobo.1478.2">Blazor takes care of automatically attaching an event handler that updates the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1479.1">MyObject.MyProperty</span></code><span class="koboSpan" id="kobo.1480.1"> property to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1481.1">ValueChanged</span></code><span class="koboSpan" id="kobo.1482.1"> event.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1483.1">Bindings of HTML elements work in a similar way, but since the developer can’t decide the names of parameters and events, a slightly different convention must be used. </span><span class="koboSpan" id="kobo.1483.2">First of all, there is no need to specify the parameter name in the binding, since it is always the HTML input </span><code class="inlineCode"><span class="koboSpan" id="kobo.1484.1">value</span></code><span class="koboSpan" id="kobo.1485.1"> attribute. </span><span class="koboSpan" id="kobo.1485.2">Therefore, the binding is written simply as </span><code class="inlineCode"><span class="koboSpan" id="kobo.1486.1">@bind="object.MyProperty"</span></code><span class="koboSpan" id="kobo.1487.1">. </span><span class="koboSpan" id="kobo.1487.2">By default, the object property is updated on the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1488.1">change</span></code><span class="koboSpan" id="kobo.1489.1"> event, but you can specify a different event by adding the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1490.1">@bind-event: @bind-event="oninput"</span></code><span class="koboSpan" id="kobo.1491.1"> attribute.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1492.1">Moreover, bindings </span><a id="_idIndexMarker1366"/><span class="koboSpan" id="kobo.1493.1">of HTML inputs try to automatically convert the input string into the target type. </span><span class="koboSpan" id="kobo.1493.2">If the conversion fails, the input reverts to its initial value. </span><span class="koboSpan" id="kobo.1493.3">This behavior is quite primitive since, in the event of errors, no error message is provided to the user, and the culture settings are not taken into account properly (HTML5 inputs use invariant culture but text input must use the current culture). </span><span class="koboSpan" id="kobo.1493.4">We advise binding inputs only to string target types. </span><span class="koboSpan" id="kobo.1493.5">Blazor has specific components for handling dates and numbers that should be used whenever the target type is not a string. </span><span class="koboSpan" id="kobo.1493.6">We will describe these components in the </span><em class="italic"><span class="koboSpan" id="kobo.1494.1">Blazor forms and validation</span></em><span class="koboSpan" id="kobo.1495.1"> section.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1496.1">In order to familiarize ourselves with events, let’s write a component that synchronizes the content of an input-type text when the user clicks a confirmation button. </span><span class="koboSpan" id="kobo.1496.2">Let’s right-click on the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1497.1">Layout</span></code><span class="koboSpan" id="kobo.1498.1"> folder and add a new </span><code class="inlineCode"><span class="koboSpan" id="kobo.1499.1">ConfirmedText.razor</span></code><span class="koboSpan" id="kobo.1500.1"> component. </span><span class="koboSpan" id="kobo.1500.2">Then replace its code with this:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1501.1">&lt;input type=</span><span class="hljs-string"><span class="koboSpan" id="kobo.1502.1">"text"</span></span><span class="koboSpan" id="kobo.1503.1"> @bind=</span><span class="hljs-string"><span class="koboSpan" id="kobo.1504.1">"Value"</span></span><span class="koboSpan" id="kobo.1505.1"> @attributes=</span><span class="hljs-string"><span class="koboSpan" id="kobo.1506.1">"AdditionalAttributes"</span></span><span class="koboSpan" id="kobo.1507.1">/&gt;
&lt;button </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1508.1">class</span></span><span class="koboSpan" id="kobo.1509.1">=</span><span class="hljs-string"><span class="koboSpan" id="kobo.1510.1">"btn btn-secondary"</span></span><span class="koboSpan" id="kobo.1511.1"> @onclick=</span><span class="hljs-string"><span class="koboSpan" id="kobo.1512.1">"Confirmed"</span></span><span class="koboSpan" id="kobo.1513.1">&gt;@ButtonText&lt;/button&gt;
@code {
    [</span><span class="hljs-meta"><span class="koboSpan" id="kobo.1514.1">Parameter(CaptureUnmatchedValues = true)</span></span><span class="koboSpan" id="kobo.1515.1">]
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1516.1">public</span></span><span class="koboSpan" id="kobo.1517.1"> Dictionary&lt;</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1518.1">string</span></span><span class="koboSpan" id="kobo.1519.1">, </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1520.1">object</span></span><span class="koboSpan" id="kobo.1521.1">&gt; AdditionalAttributes { </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1522.1">get</span></span><span class="koboSpan" id="kobo.1523.1">; </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1524.1">set</span></span><span class="koboSpan" id="kobo.1525.1">; }
    [</span><span class="hljs-meta"><span class="koboSpan" id="kobo.1526.1">Parameter</span></span><span class="koboSpan" id="kobo.1527.1">]
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1528.1">public</span></span> <span class="hljs-built_in"><span class="koboSpan" id="kobo.1529.1">string</span></span><span class="koboSpan" id="kobo.1530.1"> Value {</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1531.1">get</span></span><span class="koboSpan" id="kobo.1532.1">; </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1533.1">set</span></span><span class="koboSpan" id="kobo.1534.1">;}
    [</span><span class="hljs-meta"><span class="koboSpan" id="kobo.1535.1">Parameter</span></span><span class="koboSpan" id="kobo.1536.1">]
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1537.1">public</span></span><span class="koboSpan" id="kobo.1538.1"> EventCallback&lt;</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1539.1">string</span></span><span class="koboSpan" id="kobo.1540.1">&gt; ValueChanged { </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1541.1">get</span></span><span class="koboSpan" id="kobo.1542.1">; </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1543.1">set</span></span><span class="koboSpan" id="kobo.1544.1">; }
    [</span><span class="hljs-meta"><span class="koboSpan" id="kobo.1545.1">Parameter</span></span><span class="koboSpan" id="kobo.1546.1">]
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1547.1">public</span></span> <span class="hljs-built_in"><span class="koboSpan" id="kobo.1548.1">string</span></span><span class="koboSpan" id="kobo.1549.1"> ButtonText { </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1550.1">get</span></span><span class="koboSpan" id="kobo.1551.1">; </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1552.1">set</span></span><span class="koboSpan" id="kobo.1553.1">; }
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1554.1">async</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.1555.1"> Task </span></span><span class="hljs-title"><span class="koboSpan" id="kobo.1556.1">Confirmed</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.1557.1">()</span></span><span class="koboSpan" id="kobo.1558.1">
    {
        </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1559.1">await</span></span><span class="koboSpan" id="kobo.1560.1"> ValueChanged.InvokeAsync(Value);
    }
}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1561.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.1562.1">ConfirmedText</span></code><span class="koboSpan" id="kobo.1563.1"> component exploits the button-click event to trigger the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1564.1">ValueChanged</span></code><span class="koboSpan" id="kobo.1565.1"> event. </span><span class="koboSpan" id="kobo.1565.2">Moreover, the component uses </span><code class="inlineCode"><span class="koboSpan" id="kobo.1566.1">@bind</span></code><span class="koboSpan" id="kobo.1567.1"> to synchronize its </span><code class="inlineCode"><span class="koboSpan" id="kobo.1568.1">Value</span></code><span class="koboSpan" id="kobo.1569.1"> parameter with the HTML input. </span><span class="koboSpan" id="kobo.1569.2">It is worth pointing out that the component uses </span><code class="inlineCode"><span class="koboSpan" id="kobo.1570.1">CaptureUnmatchedValues</span></code><span class="koboSpan" id="kobo.1571.1"> to forward all HTML attributes applied to its tag to the HTML input. </span><span class="koboSpan" id="kobo.1571.2">This way, users of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1572.1">ConfirmedText</span></code><span class="koboSpan" id="kobo.1573.1"> component can style the input field by simply adding </span><code class="inlineCode"><span class="koboSpan" id="kobo.1574.1">class</span></code><span class="koboSpan" id="kobo.1575.1"> and/or </span><code class="inlineCode"><span class="koboSpan" id="kobo.1576.1">style</span></code><span class="koboSpan" id="kobo.1577.1"> attributes to the component tag.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1578.1">Now, let’s use this component in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1579.1">Pages-&gt;Index.razor</span></code><span class="koboSpan" id="kobo.1580.1"> page by placing the following code at the end of </span><code class="inlineCode"><span class="koboSpan" id="kobo.1581.1">Home.razor</span></code><span class="koboSpan" id="kobo.1582.1">:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1583.1">&lt;ConfirmedText @bind-Value=</span><span class="hljs-string"><span class="koboSpan" id="kobo.1584.1">"textValue"</span></span><span class="koboSpan" id="kobo.1585.1"> ButtonText=</span><span class="hljs-string"><span class="koboSpan" id="kobo.1586.1">"Confirm"</span></span><span class="koboSpan" id="kobo.1587.1"> /&gt;
&lt;p&gt;
    Confirmed </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1588.1">value</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1589.1">is</span></span><span class="koboSpan" id="kobo.1590.1">: @textValue
&lt;/p&gt;
@code{
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1591.1">private</span></span> <span class="hljs-built_in"><span class="koboSpan" id="kobo.1592.1">string</span></span><span class="koboSpan" id="kobo.1593.1"> textValue = </span><span class="hljs-literal"><span class="koboSpan" id="kobo.1594.1">null</span></span><span class="koboSpan" id="kobo.1595.1">;
}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1596.1">If you run the</span><a id="_idIndexMarker1367"/><span class="koboSpan" id="kobo.1597.1"> project and play with the input and its </span><strong class="screenText"><span class="koboSpan" id="kobo.1598.1">Confirm</span></strong><span class="koboSpan" id="kobo.1599.1"> button, you will see that each time the </span><strong class="screenText"><span class="koboSpan" id="kobo.1600.1">Confirm</span></strong><span class="koboSpan" id="kobo.1601.1"> button is clicked, not only are the input values copied in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1602.1">textValue</span></code><span class="koboSpan" id="kobo.1603.1"> page property but also the content of the paragraph that is behind the component is coherently updated.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1604.1">We explicitly synchronized </span><code class="inlineCode"><span class="koboSpan" id="kobo.1605.1">textValue</span></code><span class="koboSpan" id="kobo.1606.1"> with the component with </span><code class="inlineCode"><span class="koboSpan" id="kobo.1607.1">@bind-Value</span></code><span class="koboSpan" id="kobo.1608.1">, but what takes care of keeping </span><code class="inlineCode"><span class="koboSpan" id="kobo.1609.1">textValue</span></code><span class="koboSpan" id="kobo.1610.1"> synchronized with the content of the paragraph? </span><span class="koboSpan" id="kobo.1610.2">The answer can be found in the next subsection.</span></p>
<h2 class="heading-2" id="_idParaDest-393"><span class="koboSpan" id="kobo.1611.1">How Blazor updates HTML</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.1612.1">When we write the</span><a id="_idIndexMarker1368"/><span class="koboSpan" id="kobo.1613.1"> content of a variable, property, or field in Razor markup with something like </span><code class="inlineCode"><span class="koboSpan" id="kobo.1614.1">@model.property</span></code><span class="koboSpan" id="kobo.1615.1">, Blazor not only renders the actual value of the variable, property, or field when the component is rendered but tries also to update the HTML each time that this value changes, with a process</span><a id="_idIndexMarker1369"/><span class="koboSpan" id="kobo.1616.1"> called </span><strong class="keyWord"><span class="koboSpan" id="kobo.1617.1">change detection</span></strong><span class="koboSpan" id="kobo.1618.1">. </span><span class="koboSpan" id="kobo.1618.2">Change detection is a feature of all the main SPA frameworks, but the way Blazor implements it is very simple and elegant.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1619.1">The basic idea is that once all HTML has been rendered, changes may occur only because of code executed inside of events. </span><span class="koboSpan" id="kobo.1619.2">That is why </span><code class="inlineCode"><span class="koboSpan" id="kobo.1620.1">EventCallBack</span></code><span class="koboSpan" id="kobo.1621.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.1622.1">EventCallBack&lt;T&gt;</span></code><span class="koboSpan" id="kobo.1623.1"> contain a reference to an </span><code class="inlineCode"><span class="koboSpan" id="kobo.1624.1">IHandleEvent</span></code><span class="koboSpan" id="kobo.1625.1">. </span><span class="koboSpan" id="kobo.1625.2">When a component binds a handler to an event, the Razor compiler creates an </span><code class="inlineCode"><span class="koboSpan" id="kobo.1626.1">EventCallBack</span></code><span class="koboSpan" id="kobo.1627.1"> or </span><code class="inlineCode"><span class="koboSpan" id="kobo.1628.1">EventCallBack&lt;T&gt;</span></code><span class="koboSpan" id="kobo.1629.1">, passing its struct constructor the function bound to the event, and the component where the function was defined (</span><code class="inlineCode"><span class="koboSpan" id="kobo.1630.1">IHandleEvent</span></code><span class="koboSpan" id="kobo.1631.1">).</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1632.1">Once the code of the handler has been executed, the Blazor runtime is notified that the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1633.1">IHandleEvent</span></code><span class="koboSpan" id="kobo.1634.1"> might have changed. </span><span class="koboSpan" id="kobo.1634.2">In fact, the handler code can only change the values of variables, properties, or fields of the component where the handler was defined. </span><span class="koboSpan" id="kobo.1634.3">In turn, this triggers a change detection process rooted in the component. </span><span class="koboSpan" id="kobo.1634.4">Blazor verifies which variables, properties, or fields used in the component Razor markup changed and updates the associated HTML.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1635.1">If a changed</span><a id="_idIndexMarker1370"/><span class="koboSpan" id="kobo.1636.1"> variable, property, or field is an input parameter of another component, then the HTML generated by that component might also need updates. </span><span class="koboSpan" id="kobo.1636.2">Accordingly, another change detection process rooted in that component is recursively triggered.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1637.1">The algorithm sketched previously discovers all relevant changes only if the following conditions are met:</span></p>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.1638.1">No component references data structures belonging to other components in an event handler.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.1639.1">All inputs to a component arrive through its parameters and not through method calls or other public members.</span></li>
</ul>
<p class="normal"><span class="koboSpan" id="kobo.1640.1">When there is a change that is not detected because of the failure of one of the preceding conditions, the developer must manually declare the possible change of the component. </span><span class="koboSpan" id="kobo.1640.2">This can be done by calling the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1641.1">StateHasChanged()</span></code><span class="koboSpan" id="kobo.1642.1"> component method. </span><span class="koboSpan" id="kobo.1642.2">Since this call might result in changes to the page’s HTML, its execution cannot take place asynchronously but must be queued in the HTML page’s UI thread. </span><span class="koboSpan" id="kobo.1642.3">This is done by passing the function to be executed to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1643.1">InvokeAsync</span></code><span class="koboSpan" id="kobo.1644.1"> component method.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1645.1">Summing up, the instruction to execute is </span><code class="inlineCode"><span class="koboSpan" id="kobo.1646.1">await InvokeAsync(StateHasChanged)</span></code><span class="koboSpan" id="kobo.1647.1">.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1648.1">The next subsection concludes the description of components with an analysis of their lifecycle and the associated lifecycle methods.</span></p>
<h2 class="heading-2" id="_idParaDest-394"><span class="koboSpan" id="kobo.1649.1">Component lifecycle</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.1650.1">Each </span><a id="_idIndexMarker1371"/><span class="koboSpan" id="kobo.1651.1">component lifecycle event has an associated method. </span><span class="koboSpan" id="kobo.1651.2">Some methods have both synchronous and asynchronous versions, some have just an asynchronous version, and some others have just a synchronous version.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1652.1">The component lifecycle starts with parameters passed to the component being copied in the associated component properties. </span><span class="koboSpan" id="kobo.1652.2">You can customize this step by overriding the following method:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1653.1">public</span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1654.1">override</span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1655.1">async</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.1656.1"> Task </span></span><span class="hljs-title"><span class="koboSpan" id="kobo.1657.1">SetParametersAsync</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.1658.1">(</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.1659.1">ParameterView parameters</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.1660.1">)</span></span><span class="koboSpan" id="kobo.1661.1">
{
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1662.1">await</span></span><span class="koboSpan" id="kobo.1663.1"> ...
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1664.1">await</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1665.1">base</span></span><span class="koboSpan" id="kobo.1666.1">.SetParametersAsync(parameters);
}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1667.1">Typically, customization consists of the modification of additional data structures, so the base method is called to also perform the default action of copying parameters in the associated properties.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1668.1">After that, there is the component initialization that is associated with the two methods:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1669.1">protected</span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1670.1">override</span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1671.1">void</span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="koboSpan" id="kobo.1672.1">OnInitialized</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.1673.1">()</span></span><span class="koboSpan" id="kobo.1674.1">
{
    ...
</span><span class="koboSpan" id="kobo.1674.2">}
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1675.1">protected</span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1676.1">override</span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1677.1">async</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.1678.1"> Task </span></span><span class="hljs-title"><span class="koboSpan" id="kobo.1679.1">OnInitializedAsync</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.1680.1">()</span></span><span class="koboSpan" id="kobo.1681.1">
{
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1682.1">await</span></span><span class="koboSpan" id="kobo.1683.1"> ...
</span><span class="koboSpan" id="kobo.1683.2">}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1684.1">They are </span><a id="_idIndexMarker1372"/><span class="koboSpan" id="kobo.1685.1">called once in the component lifetime, immediately after the component has been created and added to the render tree. </span><span class="koboSpan" id="kobo.1685.2">Please place any initialization code there, and not in the component constructor, as this will improve component testability. </span><span class="koboSpan" id="kobo.1685.3">This is because there, you have all parameters set and future Blazor versions might pool and reuse component instances.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1686.1">If the initialization code subscribes to some events or performs actions that need a cleanup when the component is destroyed, implement </span><code class="inlineCode"><span class="koboSpan" id="kobo.1687.1">IDisposable</span></code><span class="koboSpan" id="kobo.1688.1">, and place all the cleanup code in its </span><code class="inlineCode"><span class="koboSpan" id="kobo.1689.1">Dispose</span></code><span class="koboSpan" id="kobo.1690.1"> method. </span><span class="koboSpan" id="kobo.1690.2">Whenever a component implements </span><code class="inlineCode"><span class="koboSpan" id="kobo.1691.1">IDisposable</span></code><span class="koboSpan" id="kobo.1692.1">, Blazor calls its </span><code class="inlineCode"><span class="koboSpan" id="kobo.1693.1">Dispose</span></code><span class="koboSpan" id="kobo.1694.1"> method before destroying it.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1695.1">After the component has been initialized, and each time a component parameter changes, the following two methods are called:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1696.1">protected</span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1697.1">override</span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1698.1">async</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.1699.1"> Task </span></span><span class="hljs-title"><span class="koboSpan" id="kobo.1700.1">OnParametersSetAsync</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.1701.1">()</span></span><span class="koboSpan" id="kobo.1702.1">
{
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1703.1">await</span></span><span class="koboSpan" id="kobo.1704.1"> ...
</span><span class="koboSpan" id="kobo.1704.2">}
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1705.1">protected</span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1706.1">override</span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1707.1">void</span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="koboSpan" id="kobo.1708.1">OnParametersSet</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.1709.1">()</span></span><span class="koboSpan" id="kobo.1710.1">
{
    ...
</span><span class="koboSpan" id="kobo.1710.2">}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1711.1">They are the right place to update data structures that depend on the values of the component parameters.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1712.1">After that, the component is rendered or re-rendered. </span><span class="koboSpan" id="kobo.1712.2">You can prevent component re-rendering after an update by overriding the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1713.1">ShouldRender</span></code><span class="koboSpan" id="kobo.1714.1"> method:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1715.1">protected</span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1716.1">override</span></span><span class="hljs-function"> </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1717.1">bool</span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="koboSpan" id="kobo.1718.1">ShouldRender</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.1719.1">()</span></span><span class="koboSpan" id="kobo.1720.1">
{
...
</span><span class="koboSpan" id="kobo.1720.2">}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1721.1">Letting a </span><a id="_idIndexMarker1373"/><span class="koboSpan" id="kobo.1722.1">component re-render only if you are sure its HTML code will change is an advanced optimization technique used in the implementation of component libraries.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1723.1">The component rendering stage also involves the invocation of its children components. </span><span class="koboSpan" id="kobo.1723.2">Therefore, component rendering is considered complete only after all its descendant components have completed their rendering too. </span><span class="koboSpan" id="kobo.1723.3">When rendering is complete, the following methods are called:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1724.1">protected</span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1725.1">override</span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1726.1">void</span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="koboSpan" id="kobo.1727.1">OnAfterRender</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.1728.1">(</span></span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1729.1">bool</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.1730.1"> firstRender</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.1731.1">)</span></span><span class="koboSpan" id="kobo.1732.1">
{
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1733.1">if</span></span><span class="koboSpan" id="kobo.1734.1"> (firstRender)
    {
    }
...
</span><span class="koboSpan" id="kobo.1734.2">}
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1735.1">protected</span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1736.1">override</span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1737.1">async</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.1738.1"> Task </span></span><span class="hljs-title"><span class="koboSpan" id="kobo.1739.1">OnAfterRenderAsync</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.1740.1">(</span></span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1741.1">bool</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.1742.1"> firstRender</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.1743.1">)</span></span><span class="koboSpan" id="kobo.1744.1">
{
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1745.1">if</span></span><span class="koboSpan" id="kobo.1746.1"> (firstRender)
    {
        </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1747.1">await</span></span><span class="koboSpan" id="kobo.1748.1">...
        </span><span class="koboSpan" id="kobo.1748.2">...
    </span><span class="koboSpan" id="kobo.1748.3">}
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1749.1">await</span></span><span class="koboSpan" id="kobo.1750.1"> ...
</span><span class="koboSpan" id="kobo.1750.2">}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1751.1">Since when the preceding methods are called, all component HTML has been updated and all children components have executed all their lifetime methods, the preceding methods are the right places for performing the following operations:</span></p>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.1752.1">Calling JavaScript functions that manipulate the generated HTML. </span><span class="koboSpan" id="kobo.1752.2">JavaScript calls are described in the JavaScript interoperability subsection.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.1753.1">Processing information attached to parameters or cascaded parameters by descendant components. </span><span class="koboSpan" id="kobo.1753.2">In fact, tab-like components and other components might need to register some of their subparts in the root component, so </span><a id="_idIndexMarker1374"/><span class="koboSpan" id="kobo.1754.1">the root component typically cascades a data structure where some children components can register. </span><span class="koboSpan" id="kobo.1754.2">Code written in </span><code class="inlineCode"><span class="koboSpan" id="kobo.1755.1">AfterRender</span></code><span class="koboSpan" id="kobo.1756.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.1757.1">AfterRenderAsync</span></code><span class="koboSpan" id="kobo.1758.1"> can rely on the fact that all the parts have completed their registration.</span></li>
</ul>
<p class="normal"><span class="koboSpan" id="kobo.1759.1">The next section describes Blazor tools for collecting user input.</span></p>
<h1 class="heading-1" id="_idParaDest-395"><span class="koboSpan" id="kobo.1760.1">Blazor forms and validation</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.1761.1">Similar to all </span><a id="_idIndexMarker1375"/><span class="koboSpan" id="kobo.1762.1">major SPA frameworks, Blazor offers specific tools for processing user input while providing valid feedback to the user with error messages and immediate visual clues.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1763.1">In classic HTML websites, HTML forms are used to collect input, validate it, and send it to the server. </span><span class="koboSpan" id="kobo.1763.2">In client frameworks, data is not sent to the server by submitting forms, but forms retain their validation purpose. </span><span class="koboSpan" id="kobo.1763.3">More specifically, they act as validation units, that is, as a container for inputs that must be validated together because they belong to a unique task. </span><span class="koboSpan" id="kobo.1763.4">Accordingly, when a submit button is clicked, an overall validation is performed, and the system notifies of the result via events. </span><span class="koboSpan" id="kobo.1763.5">This way, the developer can define what to do in case of errors and what actions to take when the user has successfully completed their input.</span></p>
<div class="note">
<p class="normal"><span class="koboSpan" id="kobo.1764.1">It is worth pointing out that validation performed on the client side doesn’t ensure data integrity because a malicious user could easily hack all client validation rules because they have full access to the client-side code in their browser. </span><span class="koboSpan" id="kobo.1764.2">The purpose of client-side validation is just to provide immediate feedback to the user.</span></p>
</div>
<p class="normal"><span class="koboSpan" id="kobo.1765.1">Accordingly, the</span><a id="_idIndexMarker1376"/><span class="koboSpan" id="kobo.1766.1"> validation step must be repeated on the server side to enforce data integrity.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1767.1">Both server-side and client-side validation can be performed with the same code shared between the Blazor client and the server. </span><span class="koboSpan" id="kobo.1767.2">In fact, both the ASP.NET Core REST API and Blazor support validation based on validation attributes, so it is enough to share the same ViewModels equipped with validation attributes between the Blazor and server projects by putting them in a library that is referenced by both projects. </span><span class="koboSpan" id="kobo.1767.3">ASP.NET Core validation is discussed in the </span><em class="italic"><span class="koboSpan" id="kobo.1768.1">Server-side and client-side validation</span></em><span class="koboSpan" id="kobo.1769.1"> section of </span><em class="italic"><span class="koboSpan" id="kobo.1770.1">Chapter 17</span></em><span class="koboSpan" id="kobo.1771.1">, </span><em class="italic"><span class="koboSpan" id="kobo.1772.1">Presenting ASP.NET Core</span></em><span class="koboSpan" id="kobo.1773.1">.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1774.1">The whole</span><a id="_idIndexMarker1377"/><span class="koboSpan" id="kobo.1775.1"> toolset is known as </span><strong class="keyWord"><span class="koboSpan" id="kobo.1776.1">Blazor Forms</span></strong><span class="koboSpan" id="kobo.1777.1"> and consists of a form component called </span><code class="inlineCode"><span class="koboSpan" id="kobo.1778.1">EditForm</span></code><span class="koboSpan" id="kobo.1779.1">, various input components, a data annotation validator, a validation error summary, and validation error labels.</span></p>
<p class="normal"><code class="inlineCode"><span class="koboSpan" id="kobo.1780.1">EditForm</span></code><span class="koboSpan" id="kobo.1781.1"> takes care of orchestrating the state of all input components through an instance of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1782.1">EditContext</span></code><span class="koboSpan" id="kobo.1783.1"> class that is cascaded inside of the form. </span><span class="koboSpan" id="kobo.1783.2">The orchestration comes from the interaction of both input components and the data annotation validator with this </span><code class="inlineCode"><span class="koboSpan" id="kobo.1784.1">EditContext</span></code><span class="koboSpan" id="kobo.1785.1"> instance. </span><span class="koboSpan" id="kobo.1785.2">A validation summary and error message labels don’t take part in the orchestration but register to some </span><code class="inlineCode"><span class="koboSpan" id="kobo.1786.1">EditContext</span></code><span class="koboSpan" id="kobo.1787.1"> events to be informed about errors.</span></p>
<p class="normal"><code class="inlineCode"><span class="koboSpan" id="kobo.1788.1">EditForm</span></code><span class="koboSpan" id="kobo.1789.1"> must be passed the object whose properties must be rendered in its </span><code class="inlineCode"><span class="koboSpan" id="kobo.1790.1">Model</span></code><span class="koboSpan" id="kobo.1791.1"> parameter. </span><span class="koboSpan" id="kobo.1791.2">It is worth pointing out that input components bound to nested properties are not validated, so </span><code class="inlineCode"><span class="koboSpan" id="kobo.1792.1">EditForm</span></code><span class="koboSpan" id="kobo.1793.1"> must be passed a flattened ViewModel. </span><code class="inlineCode"><span class="koboSpan" id="kobo.1794.1">EditForm</span></code><span class="koboSpan" id="kobo.1795.1"> creates a new </span><code class="inlineCode"><span class="koboSpan" id="kobo.1796.1">EditContext</span></code><span class="koboSpan" id="kobo.1797.1"> instance, passes the object received in its </span><code class="inlineCode"><span class="koboSpan" id="kobo.1798.1">Model</span></code><span class="koboSpan" id="kobo.1799.1"> parameter in its constructor, and cascades it so it can interact with the form content.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1800.1">You can also directly pass an </span><code class="inlineCode"><span class="koboSpan" id="kobo.1801.1">EditContext</span></code><span class="koboSpan" id="kobo.1802.1"> custom instance in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1803.1">EditContext</span></code><span class="koboSpan" id="kobo.1804.1"> parameter of </span><code class="inlineCode"><span class="koboSpan" id="kobo.1805.1">EditForm</span></code><span class="koboSpan" id="kobo.1806.1"> instead of passing the object in its </span><code class="inlineCode"><span class="koboSpan" id="kobo.1807.1">Model</span></code><span class="koboSpan" id="kobo.1808.1"> parameter, in which case </span><code class="inlineCode"><span class="koboSpan" id="kobo.1809.1">EditForm</span></code><span class="koboSpan" id="kobo.1810.1"> will use your custom copy instead of creating a new instance. </span><span class="koboSpan" id="kobo.1810.2">Typically, you do this when you need to subscribe to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1811.1">EditContext</span></code> <code class="inlineCode"><span class="koboSpan" id="kobo.1812.1">OnValidationStateChanged</span></code><span class="koboSpan" id="kobo.1813.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.1814.1">OnFieldChanged</span></code><span class="koboSpan" id="kobo.1815.1"> events.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1816.1">When </span><code class="inlineCode"><span class="koboSpan" id="kobo.1817.1">EditForm</span></code><span class="koboSpan" id="kobo.1818.1"> is submitted with a </span><strong class="keyWord"><span class="koboSpan" id="kobo.1819.1">Submit</span></strong><span class="koboSpan" id="kobo.1820.1"> button and there are no errors, the form invokes its </span><code class="inlineCode"><span class="koboSpan" id="kobo.1821.1">OnValidSubmit</span></code><span class="koboSpan" id="kobo.1822.1"> callback, where you can place the code that uses and processes the user input. </span><span class="koboSpan" id="kobo.1822.2">If instead there are validation errors, they are displayed, and the form invokes its </span><code class="inlineCode"><span class="koboSpan" id="kobo.1823.1">OnInvalidSubmit</span></code><span class="koboSpan" id="kobo.1824.1"> callback.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1825.1">The state of each input is reflected in some CSS classes that are automatically added to them, namely </span><code class="inlineCode"><span class="koboSpan" id="kobo.1826.1">valid</span></code><span class="koboSpan" id="kobo.1827.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.1828.1">invalid</span></code><span class="koboSpan" id="kobo.1829.1">, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.1830.1">modified</span></code><span class="koboSpan" id="kobo.1831.1">. </span><span class="koboSpan" id="kobo.1831.2">You can use these classes to provide adequate visual feedback to the user. </span><span class="koboSpan" id="kobo.1831.3">The default Blazor template already provides some CSS for them.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1832.1">Here is a typical form:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.1833.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1834.1">EditForm</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1835.1">Model</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1836.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1837.1">"FixedInteger"</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.1838.1">OnValidSubmit</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1839.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1840.1">"@HandleValidSubmit"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1841.1"> &gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1842.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1843.1">DataAnnotationsValidator</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1844.1"> /&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1845.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1846.1">ValidationSummary</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1847.1"> /&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1848.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1849.1">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1850.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1851.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1852.1">"form-group"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1853.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1854.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1855.1">label</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1856.1">for</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1857.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1858.1">"integerfixed"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1859.1">&gt;</span></span><span class="koboSpan" id="kobo.1860.1">Integer value</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1861.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1862.1">label</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1863.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1864.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1865.1">InputNumber</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1866.1"> @</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.1867.1">bind-Value</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1868.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1869.1">"FixedInteger.Value"</span></span>
<span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1870.1">id</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1871.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1872.1">"integerfixed"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1873.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1874.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1875.1">"form-control"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1876.1"> /&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1877.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1878.1">ValidationMessage</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1879.1">For</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1880.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1881.1">"@(() =&gt; FixedInteger.Value)"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1882.1"> /&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1883.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1884.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1885.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1886.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1887.1">button</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1888.1">type</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1889.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1890.1">"submit"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1891.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1892.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1893.1">"btn btn-primary"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1894.1">&gt;</span></span><span class="koboSpan" id="kobo.1895.1"> Submit</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1896.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1897.1">button</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1898.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1899.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1900.1">EditForm</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1901.1">&gt;</span></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1902.1">The label is </span><a id="_idIndexMarker1378"/><span class="koboSpan" id="kobo.1903.1">a standard HTML label, while </span><code class="inlineCode"><span class="koboSpan" id="kobo.1904.1">InputNumber</span></code><span class="koboSpan" id="kobo.1905.1"> is a Blazor-specific component for number properties. </span><code class="inlineCode"><span class="koboSpan" id="kobo.1906.1">ValidationMessage</span></code><span class="koboSpan" id="kobo.1907.1"> is the error label that appears only in the event of a validation error. </span><span class="koboSpan" id="kobo.1907.2">By default, it is rendered with a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1908.1">validation-message</span></code><span class="koboSpan" id="kobo.1909.1"> CSS class. </span><span class="koboSpan" id="kobo.1909.2">The property associated with the error message is passed in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1910.1">for</span></code><span class="koboSpan" id="kobo.1911.1"> parameter with a parameterless lambda, as shown in the example.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1912.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.1913.1">DataAnnotationsValidator</span></code><span class="koboSpan" id="kobo.1914.1"> component adds a validation based on the usual .NET validation attributes, such as </span><code class="inlineCode"><span class="koboSpan" id="kobo.1915.1">RangeAttribute</span></code><span class="koboSpan" id="kobo.1916.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.1917.1">RequiredAttribute</span></code><span class="koboSpan" id="kobo.1918.1">, and so on. </span><span class="koboSpan" id="kobo.1918.2">You can also write your custom validation attributes by inheriting from the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1919.1">ValidationAttribute</span></code><span class="koboSpan" id="kobo.1920.1"> class.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1921.1">You can provide custom error messages in the validation attributes. </span><span class="koboSpan" id="kobo.1921.2">If they contain a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1922.1">{0}</span></code><span class="koboSpan" id="kobo.1923.1"> placeholder, this will be filled with the property display name declared in a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1924.1">DisplayAttribute</span></code><span class="koboSpan" id="kobo.1925.1">, if one is found, otherwise with the property name.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1926.1">Together with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1927.1">InputNumber</span></code><span class="koboSpan" id="kobo.1928.1"> component, Blazor also supports an </span><code class="inlineCode"><span class="koboSpan" id="kobo.1929.1">InputText</span></code><span class="koboSpan" id="kobo.1930.1"> component for </span><code class="inlineCode"><span class="koboSpan" id="kobo.1931.1">string</span></code><span class="koboSpan" id="kobo.1932.1"> properties, an </span><code class="inlineCode"><span class="koboSpan" id="kobo.1933.1">InputTextArea</span></code><span class="koboSpan" id="kobo.1934.1"> component for </span><code class="inlineCode"><span class="koboSpan" id="kobo.1935.1">string</span></code><span class="koboSpan" id="kobo.1936.1"> properties to be edited in an HTML </span><code class="inlineCode"><span class="koboSpan" id="kobo.1937.1">textarea</span></code><span class="koboSpan" id="kobo.1938.1">, an </span><code class="inlineCode"><span class="koboSpan" id="kobo.1939.1">InputCheckbox</span></code><span class="koboSpan" id="kobo.1940.1"> component for </span><code class="inlineCode"><span class="koboSpan" id="kobo.1941.1">bool</span></code><span class="koboSpan" id="kobo.1942.1"> properties, and an </span><code class="inlineCode"><span class="koboSpan" id="kobo.1943.1">InputDate</span></code><span class="koboSpan" id="kobo.1944.1"> component that renders </span><code class="inlineCode"><span class="koboSpan" id="kobo.1945.1">DateTime</span></code><span class="koboSpan" id="kobo.1946.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.1947.1">DateTimeOffset</span></code><span class="koboSpan" id="kobo.1948.1"> as dates. </span><span class="koboSpan" id="kobo.1948.2">They all work in exactly the same way as the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1949.1">InputNumber</span></code><span class="koboSpan" id="kobo.1950.1"> component. </span><span class="koboSpan" id="kobo.1950.2">No component is available for other HTML5 input types. </span><span class="koboSpan" id="kobo.1950.3">In particular, no component is available for rendering time or date and time, or for rendering numbers with a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1951.1">range</span></code><span class="koboSpan" id="kobo.1952.1"> widget.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1953.1">If you need HTML5 inputs that are not available as Blazor input form components, you are left with the option of implementing them yourself or of using a third-party library that supports them.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1954.1">You can implement rendering time or date and time by inheriting from the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1955.1">InputBase&lt;TValue&gt;</span></code><span class="koboSpan" id="kobo.1956.1"> class and overriding the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1957.1">BuildRenderTree</span></code><span class="koboSpan" id="kobo.1958.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.1959.1">FormatValueAsString</span></code><span class="koboSpan" id="kobo.1960.1">, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.1961.1">TryParseValueFromString</span></code><span class="koboSpan" id="kobo.1962.1"> methods. </span><span class="koboSpan" id="kobo.1962.2">The sources of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1963.1">InputNumber</span></code><span class="koboSpan" id="kobo.1964.1"> component show how to do this: </span><a href="https://github.com/dotnet/aspnetcore/blob/main/src/Components/Web/src/Forms/InputNumber.cs"><span class="url"><span class="koboSpan" id="kobo.1965.1">https://github.com/dotnet/aspnetcore/blob/main/src/Components/Web/src/Forms/InputNumber.cs</span></span></a><span class="koboSpan" id="kobo.1966.1">. </span><span class="koboSpan" id="kobo.1966.2">You can also use the third-party libraries described in the </span><em class="italic"><span class="koboSpan" id="kobo.1967.1">Third-party tools for Blazor WebAssembly</span></em><span class="koboSpan" id="kobo.1968.1"> section.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1969.1">Blazor also </span><a id="_idIndexMarker1379"/><span class="koboSpan" id="kobo.1970.1">has a specific component for rendering a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1971.1">select</span></code><span class="koboSpan" id="kobo.1972.1">, which works as in the following example:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.1973.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1974.1">InputSelect</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1975.1"> @</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.1976.1">bind-Value</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1977.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1978.1">"order.ProductColor"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1979.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1980.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1981.1">option</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1982.1">value</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1983.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1984.1">""</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1985.1">&gt;</span></span><span class="koboSpan" id="kobo.1986.1">Select a color ...</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1987.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1988.1">option</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1989.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1990.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1991.1">option</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1992.1">value</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1993.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1994.1">"Red"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1995.1">&gt;</span></span><span class="koboSpan" id="kobo.1996.1">Red</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1997.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1998.1">option</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1999.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2000.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2001.1">option</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2002.1">value</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2003.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2004.1">"Blue"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2005.1">&gt;</span></span><span class="koboSpan" id="kobo.2006.1">Blue</span><span class="hljs-tag"><span class="koboSpan" id="kobo.2007.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2008.1">option</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2009.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2010.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2011.1">option</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2012.1">value</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2013.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2014.1">"White"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2015.1">&gt;</span></span><span class="koboSpan" id="kobo.2016.1">White</span><span class="hljs-tag"><span class="koboSpan" id="kobo.2017.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2018.1">option</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2019.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2020.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2021.1">InputSelect</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2022.1">&gt;</span></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2023.1">Starting from .NET 6, </span><code class="inlineCode"><span class="koboSpan" id="kobo.2024.1">InputSelect</span></code><span class="koboSpan" id="kobo.2025.1"> can also be bound to </span><code class="inlineCode"><span class="koboSpan" id="kobo.2026.1">IEnnumerable&lt;T&gt;</span></code><span class="koboSpan" id="kobo.2027.1"> properties, in which case it is rendered as a multi-select.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2028.1">One can also render enumerations with a radio group thanks to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2029.1">InputRadioGroup</span></code><span class="koboSpan" id="kobo.2030.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.2031.1">InputRadio</span></code><span class="koboSpan" id="kobo.2032.1"> components, as shown in the following example:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.2033.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2034.1">InputRadioGroup</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2035.1">Name</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2036.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2037.1">"color"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2038.1"> @</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.2039.1">bind-Value</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2040.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2041.1">"order.Color"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2042.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2043.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2044.1">InputRadio</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2045.1">Name</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2046.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2047.1">"color"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2048.1">Value</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2049.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2050.1">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2051.1">AllColors.Red"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2052.1"> /&gt;</span></span><span class="koboSpan" id="kobo.2053.1"> Red</span><span class="hljs-tag"><span class="koboSpan" id="kobo.2054.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2055.1">br</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2056.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2057.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2058.1">InputRadio</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2059.1">Name</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2060.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2061.1">"color"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2062.1">Value</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2063.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2064.1">"AllColors.Blue"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2065.1"> /&gt;</span></span><span class="koboSpan" id="kobo.2066.1"> Blue</span><span class="hljs-tag"><span class="koboSpan" id="kobo.2067.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2068.1">br</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2069.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2070.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2071.1">InputRadio</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2072.1">Name</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2073.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2074.1">"color"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2075.1">Value</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2076.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2077.1">"AllColors.White"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2078.1"> /&gt;</span></span><span class="koboSpan" id="kobo.2079.1"> White</span><span class="hljs-tag"><span class="koboSpan" id="kobo.2080.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2081.1">br</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2082.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2083.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2084.1">InputRadioGroup</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2085.1">&gt;</span></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2086.1">Finally, Blazor also offers an </span><code class="inlineCode"><span class="koboSpan" id="kobo.2087.1">InputFile</span></code><span class="koboSpan" id="kobo.2088.1"> component together with all the tools for processing and uploading the file. </span><span class="koboSpan" id="kobo.2088.2">We will not cover this here, but the </span><em class="italic"><span class="koboSpan" id="kobo.2089.1">Further reading</span></em><span class="koboSpan" id="kobo.2090.1"> section contains links to the official documentation.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2091.1">The next section describes Blazor tools for modifying the host page </span><code class="inlineCode"><span class="koboSpan" id="kobo.2092.1">&lt;head&gt;</span></code><span class="koboSpan" id="kobo.2093.1"> tag.</span></p>
<h2 class="heading-2" id="_idParaDest-396"><span class="koboSpan" id="kobo.2094.1">Modifying HTML &lt;head&gt; content from Blazor components</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.2095.1">Since</span><a id="_idIndexMarker1380"/><span class="koboSpan" id="kobo.2096.1"> the whole component tree is placed inside the body of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2097.1">index.html</span></code><span class="koboSpan" id="kobo.2098.1"> host page, the components markup has no direct access to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2099.1">index.html</span></code><span class="koboSpan" id="kobo.2100.1"> host page </span><code class="inlineCode"><span class="koboSpan" id="kobo.2101.1">&lt;head&gt;</span></code><span class="koboSpan" id="kobo.2102.1"> tag. </span><span class="koboSpan" id="kobo.2102.2">Modifying the content of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2103.1">&lt;head&gt;</span></code><span class="koboSpan" id="kobo.2104.1"> tag is necessary when the developer would like to adapt the title shown in the browser tab to the actual Blazor page that is being displayed. </span><span class="koboSpan" id="kobo.2104.2">In fact, this title is contained within the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2105.1">&lt;head&gt;</span></code><span class="koboSpan" id="kobo.2106.1"> tag:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.2107.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2108.1">head</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2109.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2110.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2111.1">title</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2112.1">&gt;</span></span><span class="koboSpan" id="kobo.2113.1">This is the title shown in the browser tab</span><span class="hljs-tag"><span class="koboSpan" id="kobo.2114.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2115.1">title</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2116.1">&gt;</span></span><span class="koboSpan" id="kobo.2117.1">
    ...
</span><span class="hljs-tag"><span class="koboSpan" id="kobo.2118.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2119.1">head</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2120.1">&gt;</span></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2121.1">For this </span><a id="_idIndexMarker1381"/><span class="koboSpan" id="kobo.2122.1">reason, the .NET 6 version of Blazor introduced specific constructs for modifying the host page </span><code class="inlineCode"><span class="koboSpan" id="kobo.2123.1">&lt;head&gt;</span></code><span class="koboSpan" id="kobo.2124.1"> tag from inside Blazor components.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2125.1">First of all, we must inform the Blazor application about how to reach the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2126.1">&lt;head&gt;</span></code><span class="koboSpan" id="kobo.2127.1"> tag content. </span><span class="koboSpan" id="kobo.2127.2">This is done in </span><code class="inlineCode"><span class="koboSpan" id="kobo.2128.1">Program.cs</span></code><span class="koboSpan" id="kobo.2129.1"> with the same technique used to specify the Blazor application root:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.2130.1">var</span></span><span class="koboSpan" id="kobo.2131.1"> builder = WebAssemblyHostBuilder.CreateDefault(args);
builder.RootComponents.Add&lt;App&gt;(</span><span class="hljs-string"><span class="koboSpan" id="kobo.2132.1">"#app"</span></span><span class="koboSpan" id="kobo.2133.1">);
</span><span class="hljs-comment"><span class="koboSpan" id="kobo.2134.1">// The line below adds support for modifying</span></span>
<span class="hljs-comment"><span class="koboSpan" id="kobo.2135.1">// the &lt;head&gt; tag content</span></span><span class="koboSpan" id="kobo.2136.1">
builder.RootComponents.Add&lt;HeadOutlet&gt;(</span><span class="hljs-string"><span class="koboSpan" id="kobo.2137.1">"head::after"</span></span><span class="koboSpan" id="kobo.2138.1">);
...
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2139.1">After that, each component can replace the HTML title by specifying the new string inside a </span><code class="inlineCode"><span class="koboSpan" id="kobo.2140.1">PageTitle</span></code><span class="koboSpan" id="kobo.2141.1"> component instance:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.2142.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2143.1">PageTitle</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2144.1">&gt;</span></span><span class="koboSpan" id="kobo.2145.1">This string replaces the page title</span><span class="hljs-tag"><span class="koboSpan" id="kobo.2146.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2147.1">PageTitle</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2148.1">&gt;</span></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2149.1">Moreover, each component can append other HTML content to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2150.1">&lt;head&gt;</span></code><span class="koboSpan" id="kobo.2151.1"> tag by placing it inside a </span><code class="inlineCode"><span class="koboSpan" id="kobo.2152.1">HeadContent</span></code><span class="koboSpan" id="kobo.2153.1"> instance:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.2154.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2155.1">HeadContent</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2156.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2157.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2158.1">meta</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2159.1">name</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2160.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2161.1">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2162.1">description"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2163.1">content</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2164.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2165.1">"This is a page description"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2166.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2167.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2168.1">HeadContent</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2169.1">&gt;</span></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2170.1">In this section, you learned all that is needed to write a simple Blazor application that doesn’t exchange data with a server. </span><span class="koboSpan" id="kobo.2170.2">The next section analyzes some advanced features and will enable you to interact with a server to handle authentication, authorization, and more.</span></p>
<h1 class="heading-1" id="_idParaDest-397"><span class="koboSpan" id="kobo.2171.1">Blazor advanced features</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.2172.1">This section </span><a id="_idIndexMarker1382"/><span class="koboSpan" id="kobo.2173.1">provides short descriptions of various Blazor advanced features organized into subsections:</span></p>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.2174.1">References to components and HTML elements</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.2175.1">JavaScript interoperability</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.2176.1">Globalization and localization</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.2177.1">Authentication and authorization</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.2178.1">Communication with the server</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.2179.1">AOT compilation</span></li>
</ul>
<p class="normal"><span class="koboSpan" id="kobo.2180.1">Because of </span><a id="_idIndexMarker1383"/><span class="koboSpan" id="kobo.2181.1">a lack of space, we can’t give all the details of each feature, but the details are covered by links in the </span><em class="italic"><span class="koboSpan" id="kobo.2182.1">Further reading</span></em><span class="koboSpan" id="kobo.2183.1"> section. </span><span class="koboSpan" id="kobo.2183.2">We start with how to reference components and HTML elements defined in Razor markup.</span></p>
<h2 class="heading-2" id="_idParaDest-398"><span class="koboSpan" id="kobo.2184.1">References to components and HTML elements</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.2185.1">Sometimes, we</span><a id="_idIndexMarker1384"/><span class="koboSpan" id="kobo.2186.1"> might need a reference to </span><a id="_idIndexMarker1385"/><span class="koboSpan" id="kobo.2187.1">a component in order to call some of its methods. </span><span class="koboSpan" id="kobo.2187.2">This is the case, for instance, for a component that implements a modal window:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.2188.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2189.1">Modal</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2190.1"> @</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.2191.1">ref</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2192.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2193.1">"myModal"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2194.1">&gt;</span></span><span class="koboSpan" id="kobo.2195.1">
...
</span><span class="hljs-tag"><span class="koboSpan" id="kobo.2196.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2197.1">Modal</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2198.1">&gt;</span></span><span class="koboSpan" id="kobo.2199.1">
...
</span><span class="hljs-tag"><span class="koboSpan" id="kobo.2200.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2201.1">button</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2202.1">type</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2203.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2204.1">"button"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2205.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2206.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2207.1">"btn btn-primary"</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2208.1">   @</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.2209.1">onclick</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2210.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2211.1">"() =&gt; myModal.Show()"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2212.1">&gt;</span></span><span class="koboSpan" id="kobo.2213.1">
   Open modal
</span><span class="hljs-tag"><span class="koboSpan" id="kobo.2214.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2215.1">button</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2216.1">&gt;</span></span><span class="koboSpan" id="kobo.2217.1">
...
</span><span class="koboSpan" id="kobo.2217.2">@code{
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2218.1">private</span></span><span class="koboSpan" id="kobo.2219.1"> Modal  myModal {get; set;}
 ...
</span><span class="koboSpan" id="kobo.2219.2">}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2220.1">As the preceding example shows, references are captured with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2221.1">@ref</span></code><span class="koboSpan" id="kobo.2222.1"> directive. </span><span class="koboSpan" id="kobo.2222.2">The same </span><code class="inlineCode"><span class="koboSpan" id="kobo.2223.1">@ref</span></code><span class="koboSpan" id="kobo.2224.1"> directive can also be used to capture references to HTML elements. </span><span class="koboSpan" id="kobo.2224.2">HTML references have an </span><code class="inlineCode"><span class="koboSpan" id="kobo.2225.1">ElementReference</span></code><span class="koboSpan" id="kobo.2226.1"> type and are typically used to call JavaScript functions on HTML elements, as explained in the next subsection.</span></p>
<h2 class="heading-2" id="_idParaDest-399"><span class="koboSpan" id="kobo.2227.1">JavaScript interoperability</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.2228.1">Since Blazor </span><a id="_idIndexMarker1386"/><span class="koboSpan" id="kobo.2229.1">doesn’t expose all JavaScript features to C# code, and since it is convenient to take advantage of the huge JavaScript code base, sometimes it is necessary to invoke JavaScript functions. </span><span class="koboSpan" id="kobo.2229.2">Blazor allows this through the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2230.1">IJSRuntime</span></code><span class="koboSpan" id="kobo.2231.1"> interface that can be injected into a component via dependency injection.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2232.1">Once we have an </span><code class="inlineCode"><span class="koboSpan" id="kobo.2233.1">IJSRuntime</span></code><span class="koboSpan" id="kobo.2234.1"> instance, a JavaScript function that returns a value can be called as shown here:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.2235.1">T result = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2236.1">await</span></span><span class="koboSpan" id="kobo.2237.1"> jsRuntime.InvokeAsync&lt;T&gt;(
   </span><span class="hljs-string"><span class="koboSpan" id="kobo.2238.1">"&lt;name of JavaScript function or method&gt;"</span></span><span class="koboSpan" id="kobo.2239.1">, arg1, arg2....);
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2240.1">Functions </span><a id="_idIndexMarker1387"/><span class="koboSpan" id="kobo.2241.1">that do not return any argument can be invoked as shown here:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.2242.1">await</span></span><span class="koboSpan" id="kobo.2243.1"> jsRuntime.InvokeAsync(
   </span><span class="hljs-string"><span class="koboSpan" id="kobo.2244.1">"&lt;name of JavaScript function or method&gt;"</span></span><span class="koboSpan" id="kobo.2245.1">, arg1, arg2....);
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2246.1">Arguments can be either basic types or objects that can be serialized in JSON, while the name of the JavaScript function is a string that can contain dots that represent access to properties, sub-properties, and method names, such as the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2247.1">"myJavaScriptObject.myProperty.myMethod"</span></code><span class="koboSpan" id="kobo.2248.1"> string.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2249.1">Thus, for instance, we can save a string in the browser’s local storage with the following code:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.2250.1">await</span></span><span class="koboSpan" id="kobo.2251.1"> jsRuntime
    .InvokeVoidAsync(</span><span class="hljs-string"><span class="koboSpan" id="kobo.2252.1">"window.localStorage.setItem"</span></span><span class="koboSpan" id="kobo.2253.1">,
myLocalStorageKey, myStringToSave);
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2254.1">Arguments can also be </span><code class="inlineCode"><span class="koboSpan" id="kobo.2255.1">ElementReference</span></code><span class="koboSpan" id="kobo.2256.1"> instances captured with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2257.1">@ref</span></code><span class="koboSpan" id="kobo.2258.1"> directive, in which case they are received as HTML elements on the JavaScript side.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2259.1">The JavaScript functions invoked must be defined either in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2260.1">Index.html</span></code><span class="koboSpan" id="kobo.2261.1"> file or in JavaScript files referenced in </span><code class="inlineCode"><span class="koboSpan" id="kobo.2262.1">Index.html</span></code><span class="koboSpan" id="kobo.2263.1">.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2264.1">If you are writing a component library with a Razor library project, JavaScript files can be embedded together with CSS files as resources in the DLL library. </span><span class="koboSpan" id="kobo.2264.2">You just need to add a </span><code class="inlineCode"><span class="koboSpan" id="kobo.2265.1">wwwroot</span></code><span class="koboSpan" id="kobo.2266.1"> folder in the project root and place the needed CSS and JavaScript files in that folder or some subfolder of it. </span><span class="koboSpan" id="kobo.2266.2">After that, these files can be referenced as follows:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.2267.1">_content/</span><span class="hljs-tag"><span class="koboSpan" id="kobo.2268.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2269.1">dll</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2270.1">name</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2271.1">&gt;</span></span><span class="koboSpan" id="kobo.2272.1">/</span><span class="hljs-tag"><span class="koboSpan" id="kobo.2273.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2274.1">file</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2275.1">path</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2276.1">relative</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2277.1">to</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2278.1">wwwroot</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2279.1">&gt;</span></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2280.1">Accordingly, if the filename is </span><code class="inlineCode"><span class="koboSpan" id="kobo.2281.1">myJsFile.js</span></code><span class="koboSpan" id="kobo.2282.1">, the DLL name is </span><code class="inlineCode"><span class="koboSpan" id="kobo.2283.1">MyCompany.MyLibrary</span></code><span class="koboSpan" id="kobo.2284.1">, and the file is placed in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2285.1">js</span></code><span class="koboSpan" id="kobo.2286.1"> folder inside </span><code class="inlineCode"><span class="koboSpan" id="kobo.2287.1">wwwroot</span></code><span class="koboSpan" id="kobo.2288.1">, then its reference will be:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.2289.1">_content/MyCompany.MyLibrary/js/myJsFile.js
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2290.1">It is worth pointing out that all CSS files added to components (CSS isolation) we mentioned</span><a id="_idIndexMarker1388"/><span class="koboSpan" id="kobo.2291.1"> earlier in this chapter are compiled into a unique CSS file that is added as a DLL resource. </span><span class="koboSpan" id="kobo.2291.2">This file must be referenced in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2292.1">index.html</span></code><span class="koboSpan" id="kobo.2293.1"> page as:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.2294.1">&lt;assembly name&gt;.Client.styles.css
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2295.1">If your JavaScript files are organized as ES6 modules, you can avoid referencing them in </span><code class="inlineCode"><span class="koboSpan" id="kobo.2296.1">Index.html</span></code><span class="koboSpan" id="kobo.2297.1"> and can load the modules directly, as shown here:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.2298.1">// _content/MyCompany.MyLibrary/js/myJsFile.js  JavaScript file</span></span>
<span class="hljs-function"><span class="koboSpan" id="kobo.2299.1">export function </span></span><span class="hljs-title"><span class="koboSpan" id="kobo.2300.1">myFunction</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.2301.1"> ()</span></span><span class="koboSpan" id="kobo.2302.1">
{
...
</span><span class="koboSpan" id="kobo.2302.2">}
...
</span><span class="hljs-comment"><span class="koboSpan" id="kobo.2303.1">//C# code</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.2304.1">var</span></span><span class="koboSpan" id="kobo.2305.1"> module = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2306.1">await</span></span><span class="koboSpan" id="kobo.2307.1"> jsRuntime.InvokeAsync&lt;JSObjectReference&gt;(
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.2308.1">"import"</span></span><span class="koboSpan" id="kobo.2309.1">, </span><span class="hljs-string"><span class="koboSpan" id="kobo.2310.1">"./_content/MyCompany.MyLibrary/js/myJsFile.js"</span></span><span class="koboSpan" id="kobo.2311.1">);
...
</span><span class="koboSpan" id="kobo.2311.2">T res= </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2312.1">await</span></span><span class="koboSpan" id="kobo.2313.1"> module.InvokeAsync&lt;T&gt;(</span><span class="hljs-string"><span class="koboSpan" id="kobo.2314.1">"myFunction"</span></span><span class="koboSpan" id="kobo.2315.1">)
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2316.1">In addition, instance methods of C# objects can be called from JavaScript code, by taking the following steps:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.2317.1">Say the C# method is called </span><code class="inlineCode"><span class="koboSpan" id="kobo.2318.1">MyMethod</span></code><span class="koboSpan" id="kobo.2319.1">. </span><span class="koboSpan" id="kobo.2319.2">Decorate the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2320.1">MyMethod</span></code><span class="koboSpan" id="kobo.2321.1"> method with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2322.1">[JSInvokable]</span></code><span class="koboSpan" id="kobo.2323.1"> attribute.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.2324.1">Enclose the C# object in a </span><code class="inlineCode"><span class="koboSpan" id="kobo.2325.1">DotNetObjectReference</span></code><span class="koboSpan" id="kobo.2326.1"> instance and pass it to JavaScript with a JavaScript call:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.2327.1">var</span></span><span class="koboSpan" id="kobo.2328.1"> objRef = DotNetObjectReference.Create(myObjectInstance);
</span><span class="hljs-comment"><span class="koboSpan" id="kobo.2329.1">//pass objRef to JavaScript</span></span><span class="koboSpan" id="kobo.2330.1">
....
</span><span class="hljs-comment"><span class="koboSpan" id="kobo.2331.1">//dispose the DotNetObjectReference</span></span><span class="koboSpan" id="kobo.2332.1">
objRef.Dispose()
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.2333.1">On the JavaScript side, say the C# object is in a variable called </span><code class="inlineCode"><span class="koboSpan" id="kobo.2334.1">dotnetObject</span></code><span class="koboSpan" id="kobo.2335.1">. </span><span class="koboSpan" id="kobo.2335.2">Then, we just need to invoke:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.2336.1">dotnetObject.invokeMethodAsync(</span><span class="hljs-string"><span class="koboSpan" id="kobo.2337.1">"&lt;dll name&gt;"</span></span><span class="koboSpan" id="kobo.2338.1">, </span><span class="hljs-string"><span class="koboSpan" id="kobo.2339.1">"MyMethod"</span></span><span class="koboSpan" id="kobo.2340.1">, arg1, ...).
</span><span class="koboSpan" id="kobo.2340.2">then(result =&gt; {...})
</span></code></pre>
</li>
</ol>
<p class="normal"><span class="koboSpan" id="kobo.2341.1">The </span><strong class="keyWord"><span class="koboSpan" id="kobo.2342.1">Awesome Blazor</span></strong><span class="koboSpan" id="kobo.2343.1"> project (</span><a href="https://github.com/AdrienTorris/awesome-blazor"><span class="url"><span class="koboSpan" id="kobo.2344.1">https://github.com/AdrienTorris/awesome-blazor</span></span></a><span class="koboSpan" id="kobo.2345.1">) lists a lot of </span><a id="_idIndexMarker1389"/><span class="koboSpan" id="kobo.2346.1">open-source projects that use JavaScript’s interoperability to build .NET wrappers for </span><a id="_idIndexMarker1390"/><span class="koboSpan" id="kobo.2347.1">well-known JavaScript libraries. </span><span class="koboSpan" id="kobo.2347.2">There, you can find wrappers for 3D graphics JavaScript libraries, plot JavaScript libraries, and so on.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2348.1">The next section explains how to handle contents and number/date localization.</span></p>
<h2 class="heading-2" id="_idParaDest-400"><span class="koboSpan" id="kobo.2349.1">Globalization and localization</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.2350.1">As soon </span><a id="_idIndexMarker1391"/><span class="koboSpan" id="kobo.2351.1">as the Blazor application starts, both the application culture and the application UI culture are set to the browser culture. </span><span class="koboSpan" id="kobo.2351.2">However, the developer can change both of them by assigning the chosen cultures to </span><code class="inlineCode"><span class="koboSpan" id="kobo.2352.1">CultureInfo.DefaultThreadCurrentCulture</span></code><span class="koboSpan" id="kobo.2353.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.2354.1">CultureInfo.DefaultThreadCurrentUICulture</span></code><span class="koboSpan" id="kobo.2355.1">. </span><span class="koboSpan" id="kobo.2355.2">Typically, the application lets the user choose one of its supported cultures, or it accepts the browser culture only if it is supported; otherwise, it </span><a id="_idIndexMarker1392"/><span class="koboSpan" id="kobo.2356.1">falls back to a supported culture. </span><span class="koboSpan" id="kobo.2356.2">In fact, it is possible to support just a reasonable number of cultures because all application strings must be translated into all supported cultures.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2357.1">If the application must support a single culture, this culture can be set once and for all in </span><code class="inlineCode"><span class="koboSpan" id="kobo.2358.1">program.cs</span></code><span class="koboSpan" id="kobo.2359.1"> after the host has been built but before the host is run.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2360.1">This can be done by replacing await </span><code class="inlineCode"><span class="koboSpan" id="kobo.2361.1">builder.Build().RunAsync()</span></code><span class="koboSpan" id="kobo.2362.1"> with:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.2363.1">var</span></span><span class="koboSpan" id="kobo.2364.1"> host = builder.Build();
…
CultureInfo.DefaultThreadCurrentCulture = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2365.1">new</span></span><span class="koboSpan" id="kobo.2366.1"> CultureInfo(…);
CultureInfo.DefaultThreadCurrentUICulture = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2367.1">new</span></span><span class="koboSpan" id="kobo.2368.1"> CultureInfo(…);
…
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2369.1">await</span></span><span class="koboSpan" id="kobo.2370.1"> host.RunAsync();
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2371.1">If the application must support several languages, the code is similar, but the culture information must be taken from the browser’s local storage, where the user must be given the option to store it in some applications option page.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2372.1">Once the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2373.1">CurrentCulture</span></code><span class="koboSpan" id="kobo.2374.1"> is set, dates and numbers are automatically formatted according to the conventions of the chosen culture. </span><span class="koboSpan" id="kobo.2374.2">For the UI culture, the developer must manually provide resource files with the translations of all application strings in all supported cultures. </span><span class="koboSpan" id="kobo.2374.3">Blazor uses the same localization/globalization techniques, so please refer to the </span><em class="italic"><span class="koboSpan" id="kobo.2375.1">ASP.NET Core globalization</span></em><span class="koboSpan" id="kobo.2376.1"> section of </span><em class="italic"><span class="koboSpan" id="kobo.2377.1">Chapter 17</span></em><span class="koboSpan" id="kobo.2378.1">, </span><em class="italic"><span class="koboSpan" id="kobo.2379.1">Presenting ASP.NET Core</span></em><span class="koboSpan" id="kobo.2380.1">, for more details.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2381.1">There are two ways to use resource files. </span><span class="koboSpan" id="kobo.2381.2">With the first option, you create a resource file, say, </span><code class="inlineCode"><span class="koboSpan" id="kobo.2382.1">myResource.resx</span></code><span class="koboSpan" id="kobo.2383.1">, and then add all language-specific files: </span><code class="inlineCode"><span class="koboSpan" id="kobo.2384.1">myResource.it.resx</span></code><span class="koboSpan" id="kobo.2385.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.2386.1">myResource.pt.resx</span></code><span class="koboSpan" id="kobo.2387.1">, and so on. </span><span class="koboSpan" id="kobo.2387.2">In this case, Visual Studio creates a static class named </span><code class="inlineCode"><span class="koboSpan" id="kobo.2388.1">myResource</span></code><span class="koboSpan" id="kobo.2389.1"> whose static properties are the keys of each resource file. </span><span class="koboSpan" id="kobo.2389.2">These properties will automatically contain the localized strings corresponding to the current UI culture. </span><span class="koboSpan" id="kobo.2389.3">You can use these static properties wherever you like, and you can use pairs composed of a resource type and a resource name to set the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2390.1">ErrorMessageResourceType</span></code><span class="koboSpan" id="kobo.2391.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.2392.1">ErrorMessageResourceName</span></code><span class="koboSpan" id="kobo.2393.1"> properties of validation attributes or similar properties of other attributes. </span><span class="koboSpan" id="kobo.2393.2">This way, the attributes will use an automatically localized string.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2394.1">With the </span><a id="_idIndexMarker1393"/><span class="koboSpan" id="kobo.2395.1">second option, you add only language-specific resource files (</span><code class="inlineCode"><span class="koboSpan" id="kobo.2396.1">myResource.it.resx</span></code><span class="koboSpan" id="kobo.2397.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.2398.1">myResource.pt.resx</span></code><span class="koboSpan" id="kobo.2399.1">, and so on). </span><span class="koboSpan" id="kobo.2399.2">In this case, Visual Studio doesn’t create any class associated with the resource file, and you can use </span><a id="_idIndexMarker1394"/><span class="koboSpan" id="kobo.2400.1">resource files together with </span><code class="inlineCode"><span class="koboSpan" id="kobo.2401.1">IStringLocalizer</span></code><span class="koboSpan" id="kobo.2402.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.2403.1">IStringLocalizer&lt;T&gt;</span></code><span class="koboSpan" id="kobo.2404.1"> injected in components as you use them in ASP.NET Core MVC views (see the </span><em class="italic"><span class="koboSpan" id="kobo.2405.1">ASP.NET Core globalization</span></em><span class="koboSpan" id="kobo.2406.1"> section of </span><em class="italic"><span class="koboSpan" id="kobo.2407.1">Chapter 17</span></em><span class="koboSpan" id="kobo.2408.1">, </span><em class="italic"><span class="koboSpan" id="kobo.2409.1">Presenting ASP.NET Core</span></em><span class="koboSpan" id="kobo.2410.1">).</span></p>
<h2 class="heading-2" id="_idParaDest-401"><span class="koboSpan" id="kobo.2411.1">Authentication and authorization</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.2412.1">In the </span><em class="italic"><span class="koboSpan" id="kobo.2413.1">Routing</span></em><span class="koboSpan" id="kobo.2414.1"> subsection, we discussed how the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2415.1">CascadingAuthenticationState</span></code><span class="koboSpan" id="kobo.2416.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.2417.1">AuthorizeRouteView</span></code><span class="koboSpan" id="kobo.2418.1"> components prevent unauthorized users from accessing pages protected with an </span><code class="inlineCode"><span class="koboSpan" id="kobo.2419.1">[Authorize]</span></code><span class="koboSpan" id="kobo.2420.1"> attribute. </span><span class="koboSpan" id="kobo.2420.2">Let’s go deeper into the details of how page authorization works.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2421.1">In .NET applications, authentication </span><a id="_idIndexMarker1395"/><span class="koboSpan" id="kobo.2422.1">and authorization</span><a id="_idIndexMarker1396"/><span class="koboSpan" id="kobo.2423.1"> information is usually contained in a </span><code class="inlineCode"><span class="koboSpan" id="kobo.2424.1">ClaimsPrincipal</span></code><span class="koboSpan" id="kobo.2425.1"> instance. </span><span class="koboSpan" id="kobo.2425.2">In server applications, this instance is built when the user logs in, taking the required information from a database. </span><span class="koboSpan" id="kobo.2425.3">In Blazor WebAssembly, such information must be provided by some remote server that takes care of SPA authentication too. </span><span class="koboSpan" id="kobo.2425.4">Since there are several ways to provide authentication and authorization to a Blazor WebAssembly application, Blazor defines the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2426.1">AuthenticationStateProvider</span></code><span class="koboSpan" id="kobo.2427.1"> abstraction.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2428.1">Authentication and authorization providers inherit from the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2429.1">AuthenticationStateProvider</span></code><span class="koboSpan" id="kobo.2430.1"> abstract class and override its </span><code class="inlineCode"><span class="koboSpan" id="kobo.2431.1">GetAuthenticationStateAsync</span></code><span class="koboSpan" id="kobo.2432.1"> method, which returns </span><code class="inlineCode"><span class="koboSpan" id="kobo.2433.1">Task&lt;AuthenticationState&gt;</span></code><span class="koboSpan" id="kobo.2434.1">, where </span><code class="inlineCode"><span class="koboSpan" id="kobo.2435.1">AuthenticationState</span></code><span class="koboSpan" id="kobo.2436.1"> contains the authentication and authorization information. </span><span class="koboSpan" id="kobo.2436.2">Actually, </span><code class="inlineCode"><span class="koboSpan" id="kobo.2437.1">AuthenticationState</span></code><span class="koboSpan" id="kobo.2438.1"> contains just a </span><code class="inlineCode"><span class="koboSpan" id="kobo.2439.1">User</span></code><span class="koboSpan" id="kobo.2440.1"> property with a </span><code class="inlineCode"><span class="koboSpan" id="kobo.2441.1">ClaimsPrincipal</span></code><span class="koboSpan" id="kobo.2442.1">.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2443.1">Once we’ve </span><a id="_idIndexMarker1397"/><span class="koboSpan" id="kobo.2444.1">defined a concrete implementation of </span><code class="inlineCode"><span class="koboSpan" id="kobo.2445.1">AuthenticationStateProvider</span></code><span class="koboSpan" id="kobo.2446.1">, we must register it in the dependency</span><a id="_idIndexMarker1398"/><span class="koboSpan" id="kobo.2447.1"> engine container in the application’s </span><code class="inlineCode"><span class="koboSpan" id="kobo.2448.1">Program.cs</span></code><span class="koboSpan" id="kobo.2449.1"> file:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.2450.1">builder.services.AddScoped&lt;AuthenticationStateProvider,
   MyAuthStateProvider&gt;();
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2451.1">We will return to the predefined implementations of </span><code class="inlineCode"><span class="koboSpan" id="kobo.2452.1">AuthenticationStateProvider</span></code><span class="koboSpan" id="kobo.2453.1"> offered by Blazor after having described how Blazor uses authentication and authorization information provided by a registered </span><code class="inlineCode"><span class="koboSpan" id="kobo.2454.1">AuthenticationStateProvider</span></code><span class="koboSpan" id="kobo.2455.1">.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2456.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.2457.1">CascadingAuthenticationState</span></code><span class="koboSpan" id="kobo.2458.1"> component calls the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2459.1">GetAuthenticationStateAsync</span></code><span class="koboSpan" id="kobo.2460.1"> method of the registered </span><code class="inlineCode"><span class="koboSpan" id="kobo.2461.1">AuthenticationStateProvider</span></code><span class="koboSpan" id="kobo.2462.1"> and cascades the returned </span><code class="inlineCode"><span class="koboSpan" id="kobo.2463.1">Task&lt;AuthenticationState&gt;</span></code><span class="koboSpan" id="kobo.2464.1">. </span><span class="koboSpan" id="kobo.2464.2">You can intercept this cascading value with a </span><code class="inlineCode"><span class="koboSpan" id="kobo.2465.1">[CascadingParameter]</span></code><span class="koboSpan" id="kobo.2466.1"> defined as follows in your components:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.2467.1">[</span><span class="hljs-meta"><span class="koboSpan" id="kobo.2468.1">CascadingParameter</span></span><span class="koboSpan" id="kobo.2469.1">]
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2470.1">private</span></span><span class="koboSpan" id="kobo.2471.1"> Task&lt;AuthenticationState&gt; myAuthenticationStateTask { </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2472.1">get</span></span><span class="koboSpan" id="kobo.2473.1">; </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2474.1">set</span></span><span class="koboSpan" id="kobo.2475.1">; }
……
ClaimsPrincipal user = (</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2476.1">await</span></span><span class="koboSpan" id="kobo.2477.1"> myAuthenticationStateTask).User;
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2478.1">However, Blazor applications typically use </span><code class="inlineCode"><span class="koboSpan" id="kobo.2479.1">AuthorizeRouteView</span></code><span class="koboSpan" id="kobo.2480.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.2481.1">AuthorizeView</span></code><span class="koboSpan" id="kobo.2482.1"> components to control user access to content.</span></p>
<p class="normal"><code class="inlineCode"><span class="koboSpan" id="kobo.2483.1">AuthorizeRouteView</span></code><span class="koboSpan" id="kobo.2484.1"> prevents access to pages if the user doesn’t satisfy the prescriptions of the page’s </span><code class="inlineCode"><span class="koboSpan" id="kobo.2485.1">[Authorize]</span></code><span class="koboSpan" id="kobo.2486.1"> attribute; otherwise, the content in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2487.1">NotAuthorized</span></code><span class="koboSpan" id="kobo.2488.1"> template is rendered. </span><code class="inlineCode"><span class="koboSpan" id="kobo.2489.1">AuthorizeRouteView</span></code><span class="koboSpan" id="kobo.2490.1"> also has an </span><code class="inlineCode"><span class="koboSpan" id="kobo.2491.1">Authorizing</span></code><span class="koboSpan" id="kobo.2492.1"> template that is shown while user information is being retrieved.</span></p>
<p class="normal"><code class="inlineCode"><span class="koboSpan" id="kobo.2493.1">AuthorizeView</span></code><span class="koboSpan" id="kobo.2494.1"> can be used within components to show the markup it encloses only to authorized users. </span><span class="koboSpan" id="kobo.2494.2">It contains the same </span><code class="inlineCode"><span class="koboSpan" id="kobo.2495.1">Roles</span></code><span class="koboSpan" id="kobo.2496.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.2497.1">Policy</span></code><span class="koboSpan" id="kobo.2498.1"> parameters of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2499.1">[Authorize]</span></code><span class="koboSpan" id="kobo.2500.1"> attribute that you can use to specify the constraints the user must satisfy to access the content:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.2501.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2502.1">AuthorizeView</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2503.1">Roles</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2504.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2505.1">"Admin,SuperUser"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2506.1">&gt;</span></span><span class="koboSpan" id="kobo.2507.1">
//authorized content
</span><span class="hljs-tag"><span class="koboSpan" id="kobo.2508.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2509.1">AuthorizeView</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2510.1">&gt;</span></span>
</code></pre>
<p class="normal"><code class="inlineCode"><span class="koboSpan" id="kobo.2511.1">AuthorizeView</span></code><span class="koboSpan" id="kobo.2512.1"> can also specify </span><code class="inlineCode"><span class="koboSpan" id="kobo.2513.1">NotAuthorized</span></code><span class="koboSpan" id="kobo.2514.1"> and an </span><code class="inlineCode"><span class="koboSpan" id="kobo.2515.1">Authorizing</span></code><span class="koboSpan" id="kobo.2516.1"> template:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.2517.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2518.1">AuthorizeView</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2519.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2520.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2521.1">Authorized</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2522.1">&gt;</span></span><span class="koboSpan" id="kobo.2523.1">
    ...
  </span><span class="hljs-tag"><span class="koboSpan" id="kobo.2524.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2525.1">Authorized</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2526.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2527.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2528.1">Authorizing</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2529.1">&gt;</span></span><span class="koboSpan" id="kobo.2530.1">
    ...
  </span><span class="hljs-tag"><span class="koboSpan" id="kobo.2531.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2532.1">Authorizing</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2533.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2534.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2535.1">NotAuthorized</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2536.1">&gt;</span></span><span class="koboSpan" id="kobo.2537.1">
    ...
  </span><span class="hljs-tag"><span class="koboSpan" id="kobo.2538.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2539.1">NotAuthorized</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2540.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2541.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2542.1">AuthorizeView</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2543.1">&gt;</span></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2544.1">If one adds</span><a id="_idIndexMarker1399"/><span class="koboSpan" id="kobo.2545.1"> authorization while creating a Blazor </span><a id="_idIndexMarker1400"/><span class="koboSpan" id="kobo.2546.1">WebAssembly project, the following method call is added to the application dependency engine:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.2547.1">builder.Services.AddOidcAuthentication(options =&gt;
{
    </span><span class="hljs-comment"><span class="koboSpan" id="kobo.2548.1">// Configure your authentication provider options here.</span></span>
<span class="hljs-comment"><span class="koboSpan" id="kobo.2549.1">// For more information, see https://aka.ms/blazor-standalone-auth</span></span><span class="koboSpan" id="kobo.2550.1">
    builder.Configuration.Bind(</span><span class="hljs-string"><span class="koboSpan" id="kobo.2551.1">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2552.1">Local"</span></span><span class="koboSpan" id="kobo.2553.1">, options.ProviderOptions);
});
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2554.1">This method adds an </span><code class="inlineCode"><span class="koboSpan" id="kobo.2555.1">AuthenticationStateProvider</span></code><span class="koboSpan" id="kobo.2556.1"> that extracts the user information from the authentication cookie of an OAuth provider. </span><span class="koboSpan" id="kobo.2556.2">The OAuth protocol with the OAuth provider is performed with the help of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2557.1">AuthenticationService.js</span></code><span class="koboSpan" id="kobo.2558.1"> JavaScript file we saw in the </span><em class="italic"><span class="koboSpan" id="kobo.2559.1">Loading and starting the application</span></em><span class="koboSpan" id="kobo.2560.1"> subsection of this chapter. </span><span class="koboSpan" id="kobo.2560.2">The OAuth provider endpoint returns user information in the form of a bearer token that can, then, also be used to authenticate communications with the server’s web API. </span><span class="koboSpan" id="kobo.2560.3">Bearer tokens are described in detail in the </span><em class="italic"><span class="koboSpan" id="kobo.2561.1">REST service authorization and authentication</span></em><span class="koboSpan" id="kobo.2562.1"> and </span><em class="italic"><span class="koboSpan" id="kobo.2563.1">ASP.NET Core service authorization</span></em><span class="koboSpan" id="kobo.2564.1"> sections of </span><em class="italic"><span class="koboSpan" id="kobo.2565.1">Chapter 15</span></em><span class="koboSpan" id="kobo.2566.1">, </span><em class="italic"><span class="koboSpan" id="kobo.2567.1">Applying Service-Oriented Architectures with .NET</span></em><span class="koboSpan" id="kobo.2568.1">. </span><span class="koboSpan" id="kobo.2568.2">Blazor WebAssembly communication is described in the next subsection.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2569.1">The previous code takes the OAuth parameters from a configuration file you must add as </span><code class="inlineCode"><span class="koboSpan" id="kobo.2570.1">wwwroot/appsettings.json</span></code><span class="koboSpan" id="kobo.2571.1">:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2572.1">{</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.2573.1">"Local"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2574.1">:</span></span> <span class="hljs-punctuation"><span class="koboSpan" id="kobo.2575.1">{</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.2576.1">"Authority"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2577.1">:</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.2578.1">"{AUTHORITY}"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2579.1">,</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.2580.1">"ClientId"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2581.1">:</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.2582.1">"{CLIENT ID}"</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.2583.1">}</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.2584.1">}</span></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2585.1">If you use </span><a id="_idIndexMarker1401"/><span class="koboSpan" id="kobo.2586.1">Google as the authentication provider, </span><code class="inlineCode"><span class="koboSpan" id="kobo.2587.1">AUTHORITY</span></code><span class="koboSpan" id="kobo.2588.1"> is </span><code class="inlineCode"><span class="koboSpan" id="kobo.2589.1">https://accounts.google.com/</span></code><span class="koboSpan" id="kobo.2590.1">, while </span><code class="inlineCode"><span class="koboSpan" id="kobo.2591.1">CLIENT ID</span></code><span class="koboSpan" id="kobo.2592.1"> is the client ID you receive when </span><a id="_idIndexMarker1402"/><span class="koboSpan" id="kobo.2593.1">you register your Blazor application with the Google Developers program.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2594.1">Google needs some more parameters, namely the return URL to return once the authentication process is completed and the page to return to after a logout:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2595.1">{</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.2596.1">"Local"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2597.1">:</span></span> <span class="hljs-punctuation"><span class="koboSpan" id="kobo.2598.1">{</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.2599.1">"Authority"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2600.1">:</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.2601.1">"https://accounts.google.com/"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2602.1">,</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.2603.1">"ClientId"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2604.1">:</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.2605.1">"2...7-e...q.apps.googleusercontent.com"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2606.1">,</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.2607.1">"PostLogoutRedirectUri"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2608.1">:</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.2609.1">"https://localhost:5001/authentication/logout-callback"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2610.1">,</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.2611.1">"RedirectUri"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2612.1">:</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.2613.1">"https://localhost:5001/authentication/login-callback"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2614.1">,</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.2615.1">"ResponseType"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2616.1">:</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.2617.1">"id_token"</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.2618.1">}</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.2619.1">}</span></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2620.1">Where </span><code class="inlineCode"><span class="koboSpan" id="kobo.2621.1">https://localhost:5001</span></code><span class="koboSpan" id="kobo.2622.1"> must be replaced with the actual domain of the Blazor application.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2623.1">Before any authentication or if the authentication fails, an unauthenticated </span><code class="inlineCode"><span class="koboSpan" id="kobo.2624.1">ClaimsPrincipal</span></code><span class="koboSpan" id="kobo.2625.1"> is created. </span><span class="koboSpan" id="kobo.2625.2">This way, when the user tries to access a page that is protected by an </span><code class="inlineCode"><span class="koboSpan" id="kobo.2626.1">[Authorize]</span></code><span class="koboSpan" id="kobo.2627.1"> attribute, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2628.1">AuthorizeRouteView</span></code><span class="koboSpan" id="kobo.2629.1"> component invokes the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2630.1">RedirectToLogin</span></code><span class="koboSpan" id="kobo.2631.1"> component, which, in turn, navigates to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2632.1">Authentication.razor</span></code><span class="koboSpan" id="kobo.2633.1"> page, passing it a login request in its </span><code class="inlineCode"><span class="koboSpan" id="kobo.2634.1">action</span></code><span class="koboSpan" id="kobo.2635.1"> route parameter:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.2636.1">@page </span><span class="hljs-string"><span class="koboSpan" id="kobo.2637.1">"/authentication/{action}"</span></span><span class="koboSpan" id="kobo.2638.1">
@using Microsoft.AspNetCore.Components.WebAssembly.Authentication
&lt;RemoteAuthenticatorView Action=</span><span class="hljs-string"><span class="koboSpan" id="kobo.2639.1">"@Action"</span></span><span class="koboSpan" id="kobo.2640.1">  /&gt;
@code{
    [</span><span class="hljs-meta"><span class="koboSpan" id="kobo.2641.1">Parameter</span></span><span class="koboSpan" id="kobo.2642.1">] </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2643.1">public</span></span> <span class="hljs-built_in"><span class="koboSpan" id="kobo.2644.1">string</span></span><span class="koboSpan" id="kobo.2645.1"> Action { </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2646.1">get</span></span><span class="koboSpan" id="kobo.2647.1">; </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2648.1">set</span></span><span class="koboSpan" id="kobo.2649.1">; }
}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2650.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.2651.1">RemoteAuthenticatorView</span></code><span class="koboSpan" id="kobo.2652.1"> acts as an interface with the usual ASP.NET Core user login/registration system, and whenever it receives an “action” to perform, it redirects the user from the Blazor application to the proper ASP.NET Core server page (login, registration, logout, and user profile).</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2653.1">Once the </span><a id="_idIndexMarker1403"/><span class="koboSpan" id="kobo.2654.1">user logs in, they are redirected to </span><a id="_idIndexMarker1404"/><span class="koboSpan" id="kobo.2655.1">the Blazor application page that caused the login request. </span><span class="koboSpan" id="kobo.2655.2">The redirect URL is computed by the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2656.1">BlazorReview.Layout-&gt;RedirectToLogin.razor</span></code><span class="koboSpan" id="kobo.2657.1"> component, which extracts it from the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2658.1">NavigationManager</span></code><span class="koboSpan" id="kobo.2659.1"> and passes it to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2660.1">RemoteAuthenticatorView</span></code><span class="koboSpan" id="kobo.2661.1"> component. </span><span class="koboSpan" id="kobo.2661.2">This time, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2662.1">AuthenticationStateProvider</span></code><span class="koboSpan" id="kobo.2663.1"> is able to get the user information from the authentication cookie that has been created by the login operation.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2664.1">It is possible both to design a custom OAuth provider for your Blazor application or to design a completely custom way to get a bearer token with an internal login Blazor page without leaving the Blazor application. </span><span class="koboSpan" id="kobo.2664.2">In this last case, you must provide a custom implementation of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2665.1">AuthenticationStateProvider</span></code><span class="koboSpan" id="kobo.2666.1">. </span><span class="koboSpan" id="kobo.2666.2">More details on these advanced custom scenarios are available in the official documentation reference in the </span><em class="italic"><span class="koboSpan" id="kobo.2667.1">Further reading</span></em><span class="koboSpan" id="kobo.2668.1"> section.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2669.1">Having learned how to authenticate with an external OAuth provider and how to handle authorization within the Blazor application, we are ready to learn how to exchange data and how to authenticate with a REST API.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2670.1">The next subsection describes a Blazor WebAssembly-specific implementation of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2671.1">HttpClient</span></code><span class="koboSpan" id="kobo.2672.1"> class and related types.</span></p>
<h2 class="heading-2" id="_idParaDest-402"><span class="koboSpan" id="kobo.2673.1">Communication with the server</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.2674.1">Blazor WebAssembly </span><a id="_idIndexMarker1405"/><span class="koboSpan" id="kobo.2675.1">supports the same .NET </span><code class="inlineCode"><span class="koboSpan" id="kobo.2676.1">HttpClient</span></code><span class="koboSpan" id="kobo.2677.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.2678.1">HttpClientFactory</span></code><span class="koboSpan" id="kobo.2679.1"> classes described in the </span><em class="italic"><span class="koboSpan" id="kobo.2680.1">.NET HTTP clients</span></em><span class="koboSpan" id="kobo.2681.1"> section of </span><em class="italic"><span class="koboSpan" id="kobo.2682.1">Chapter 15</span></em><span class="koboSpan" id="kobo.2683.1">, </span><em class="italic"><span class="koboSpan" id="kobo.2684.1">Applying Service-Oriented Architectures with .NET</span></em><span class="koboSpan" id="kobo.2685.1">. </span><span class="koboSpan" id="kobo.2685.2">However, due to the communication limitations of browsers, their implementations are different and rely on the</span><a id="_idIndexMarker1406"/><span class="koboSpan" id="kobo.2686.1"> browser’s </span><strong class="keyWord"><span class="koboSpan" id="kobo.2687.1">fetch API</span></strong><span class="koboSpan" id="kobo.2688.1">.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2689.1">In fact, for security reasons, all browsers, do not allow direct opening of generic </span><strong class="keyWord"><span class="koboSpan" id="kobo.2690.1">TCP/IP</span></strong><span class="koboSpan" id="kobo.2691.1"> connections but force </span><a id="_idIndexMarker1407"/><span class="koboSpan" id="kobo.2692.1">all server communications to pass either through</span><a id="_idIndexMarker1408"/> <strong class="keyWord"><span class="koboSpan" id="kobo.2693.1">Ajax</span></strong><span class="koboSpan" id="kobo.2694.1"> or through the </span><strong class="keyWord"><span class="koboSpan" id="kobo.2695.1">fetch API</span></strong><span class="koboSpan" id="kobo.2696.1">. </span></p>
<p class="normal"><span class="koboSpan" id="kobo.2697.1">This way, when you attempt a communication toward a URL that differs from the domain where the browser downloaded the SPA, the browser automatically switches to the CORS protocol, thus informing the server that the communication was started by a browser application that was downloaded by a different domain and that might potentially be a phishing website.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2698.1">In turn, the </span><a id="_idIndexMarker1409"/><span class="koboSpan" id="kobo.2699.1">server accepts CORS communications just from well-known domains that are pre-listed in its code. </span><span class="koboSpan" id="kobo.2699.2">This way, the server is sure that the request can’t come from a phishing website.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2700.1">In </span><em class="italic"><span class="koboSpan" id="kobo.2701.1">Chapter 15</span></em><span class="koboSpan" id="kobo.2702.1">, </span><em class="italic"><span class="koboSpan" id="kobo.2703.1">Applying Service-Oriented Architectures with .NET</span></em><span class="koboSpan" id="kobo.2704.1">, we analyzed how to take advantage of </span><code class="inlineCode"><span class="koboSpan" id="kobo.2705.1">HttpClientFactory</span></code><span class="koboSpan" id="kobo.2706.1"> to define typed clients. </span><span class="koboSpan" id="kobo.2706.2">You can also define typed clients in Blazor with exactly the same syntax.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2707.1">However, since an authenticated Blazor application needs to send the bearer token created during the authentication process in each request to the application server, it is common to define a named client as shown here:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.2708.1">builder.Services.AddHttpClient(</span><span class="hljs-string"><span class="koboSpan" id="kobo.2709.1">"BlazorReview.ServerAPI"</span></span><span class="koboSpan" id="kobo.2710.1">, client =&gt;
         client.BaseAddress = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2711.1">new</span></span><span class="koboSpan" id="kobo.2712.1"> Uri(</span><span class="hljs-string"><span class="koboSpan" id="kobo.2713.1">"https://&lt;web api URL&gt;"</span></span><span class="koboSpan" id="kobo.2714.1">))
.AddHttpMessageHandler&lt;BaseAddressAuthorizationMessageHandler&gt;();
</span></code></pre>
<p class="normal"><code class="inlineCode"><span class="koboSpan" id="kobo.2715.1">AddHttpMessageHandler</span></code><span class="koboSpan" id="kobo.2716.1"> adds a </span><code class="inlineCode"><span class="koboSpan" id="kobo.2717.1">DelegatingHandler</span></code><span class="koboSpan" id="kobo.2718.1">, that is, a subclass of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2719.1">DelegatingHandler</span></code><span class="koboSpan" id="kobo.2720.1"> abstract class. </span><span class="koboSpan" id="kobo.2720.2">Implementations of </span><code class="inlineCode"><span class="koboSpan" id="kobo.2721.1">DelegatingHandler</span></code><span class="koboSpan" id="kobo.2722.1"> override its </span><code class="inlineCode"><span class="koboSpan" id="kobo.2723.1">SendAsync</span></code><span class="koboSpan" id="kobo.2724.1"> method in order to process each request and each relative response:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.2725.1">protected</span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2726.1">override</span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2727.1">async</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.2728.1"> Task&lt;HttpResponseMessage&gt; </span></span><span class="hljs-title"><span class="koboSpan" id="kobo.2729.1">SendAsync</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.2730.1">(</span></span>
<span class="hljs-params"><span class="koboSpan" id="kobo.2731.1">        HttpRequestMessage request,</span></span>
<span class="hljs-params"><span class="koboSpan" id="kobo.2732.1">        CancellationToken cancellationToken</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.2733.1">)</span></span><span class="koboSpan" id="kobo.2734.1">
{
</span><span class="hljs-comment"><span class="koboSpan" id="kobo.2735.1">//modify request</span></span><span class="koboSpan" id="kobo.2736.1">
   ...
</span><span class="koboSpan" id="kobo.2736.2">HttpResponseMessage= response = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2737.1">await</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.2738.1">base</span></span><span class="koboSpan" id="kobo.2739.1">.SendAsync(
   request, cancellationToken);
</span><span class="hljs-comment"><span class="koboSpan" id="kobo.2740.1">//modify response</span></span><span class="koboSpan" id="kobo.2741.1">
   ...
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2742.1">return</span></span><span class="koboSpan" id="kobo.2743.1"> response;
}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2744.1">If this bearer token is expired or is not found at all, it tries to get a new bearer token by using the authentication cookie received when the user manually logged in with the OAuth provider. </span><span class="koboSpan" id="kobo.2744.2">This way, it can obtain a fresh bearer token without requesting a new manual login. </span><span class="koboSpan" id="kobo.2744.3">If this attempt also fails, an </span><code class="inlineCode"><span class="koboSpan" id="kobo.2745.1">AccessTokenNotAvailableException</span></code><span class="koboSpan" id="kobo.2746.1"> is thrown. </span><span class="koboSpan" id="kobo.2746.2">Typically, this exception is captured and used to trigger a redirection to the login page by calling its </span><code class="inlineCode"><span class="koboSpan" id="kobo.2747.1">Redirect</span></code><span class="koboSpan" id="kobo.2748.1"> method, as shown below:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.2749.1">try</span></span><span class="koboSpan" id="kobo.2750.1">
{
        </span><span class="hljs-comment"><span class="koboSpan" id="kobo.2751.1">//server call here</span></span><span class="koboSpan" id="kobo.2752.1">
}
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2753.1">catch</span></span><span class="koboSpan" id="kobo.2754.1"> (AccessTokenNotAvailableException exception)
{
        exception.Redirect();
}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2755.1">If both</span><a id="_idIndexMarker1410"/><span class="koboSpan" id="kobo.2756.1"> the Blazor application and the Web API are deployed in different subfolders of the same domain, Blazor requests are issued without the CORS protocol, so they are automatically accepted by the server. </span><span class="koboSpan" id="kobo.2756.2">Otherwise, the ASP.NET Core server must enable CORS requests, and must list the Blazor application URL among the allowed CORS domains with something like:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.2757.1">builder.Services.AddCors(o =&gt; {
    o.AddDefaultPolicy(pbuilder =&gt;
    {
        pbuilder.AllowAnyMethod();
        pbuilder.WithHeaders(HeaderNames.ContentType, HeaderNames.Authorization);
        pbuilder.WithOrigins(https:</span><span class="hljs-comment"><span class="koboSpan" id="kobo.2758.1">//&lt;Blazor client url&gt;, …, https://&lt;Another client url&gt;);</span></span><span class="koboSpan" id="kobo.2759.1">
    });
 });
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2760.1">Then, you must also place the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2761.1">app.UseCors()</span></code><span class="koboSpan" id="kobo.2762.1"> middleware in the ASP.NET Core pipeline. </span></p>
<p class="normal"><span class="koboSpan" id="kobo.2763.1">The example data shown on the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2764.1">Weather</span></code><span class="koboSpan" id="kobo.2765.1"> page of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2766.1">ReviewBlazor</span></code><span class="koboSpan" id="kobo.2767.1"> application are downloaded from a static file located in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2768.1">wwwroot/sample-data</span></code><span class="koboSpan" id="kobo.2769.1"> folder of the same Blazor application, so a normal, not-CORS request is issued and no bearer token is needed to request. </span><span class="koboSpan" id="kobo.2769.2">Accordingly, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2770.1">Weather</span></code><span class="koboSpan" id="kobo.2771.1">page uses a default </span><code class="inlineCode"><span class="koboSpan" id="kobo.2772.1">HttpClient</span></code><span class="koboSpan" id="kobo.2773.1"> defined in </span><code class="inlineCode"><span class="koboSpan" id="kobo.2774.1">Program.cs</span></code><span class="koboSpan" id="kobo.2775.1"> as:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.2776.1">builder.Services.AddScoped(sp =&gt; </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2777.1">new</span></span><span class="koboSpan" id="kobo.2778.1"> HttpClient { BaseAddress = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2779.1">new</span></span><span class="koboSpan" id="kobo.2780.1"> Uri(builder.HostEnvironment.BaseAddress) });
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2781.1">The next subsection explains how to improve the performance of computation-intensive applications with Blazor AOT compilation.</span></p>
<h2 class="heading-2" id="_idParaDest-403"><span class="koboSpan" id="kobo.2782.1">AOT compilation</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.2783.1">Once</span><a id="_idIndexMarker1411"/><span class="koboSpan" id="kobo.2784.1"> uploaded in the browser, .NET assemblies are not </span><a id="_idIndexMarker1412"/><span class="koboSpan" id="kobo.2785.1">compiled </span><strong class="keyWord"><span class="koboSpan" id="kobo.2786.1">Just in Time</span></strong><span class="koboSpan" id="kobo.2787.1"> (</span><strong class="keyWord"><span class="koboSpan" id="kobo.2788.1">JIT</span></strong><span class="koboSpan" id="kobo.2789.1">) at their first execution as is the case for other platforms. </span><span class="koboSpan" id="kobo.2789.2">Instead, they are interpreted by a very fast interpreter. </span><span class="koboSpan" id="kobo.2789.3">Just the .NET runtime is pre-compiled and uploaded in the browser directly in WebAssembly.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2790.1">JIT compilation is avoided since it would considerably increase the application start time, which is already quite high because of the high application download size (about 10 MB). </span><span class="koboSpan" id="kobo.2790.2">In turn, the download size is high due to the .NET libraries that any Blazor application needs to work properly.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2791.1">In order to reduce download size, during the compilation in release mode, Blazor .NET assemblies are tree-shaken to remove all unused types and methods. </span><span class="koboSpan" id="kobo.2791.2">However, notwithstanding this tree-shaking, the typical download size remains quite high. </span><span class="koboSpan" id="kobo.2791.3">A good download improvement is achieved with the default caching of the .NET runtime, which reduces the download size to 2-4 MB. </span><span class="koboSpan" id="kobo.2791.4">However, the download size still remains high the first time a Blazor application is visited.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2792.1">Starting from .NET 6, Blazor offers an alternative to JIT compilation: </span><strong class="keyWord"><span class="koboSpan" id="kobo.2793.1">Ahead-of-Time</span></strong><span class="koboSpan" id="kobo.2794.1"> (</span><strong class="keyWord"><span class="koboSpan" id="kobo.2795.1">AOT</span></strong><span class="koboSpan" id="kobo.2796.1">) compilation. </span><span class="koboSpan" id="kobo.2796.2">With </span><a id="_idIndexMarker1413"/><span class="koboSpan" id="kobo.2797.1">AOT, all application assemblies are compiled into a unique WebAssembly file during the application publication.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2798.1">AOT compilation is very slow and may last something like 10-30 minutes, even in the case of small applications. </span><span class="koboSpan" id="kobo.2798.2">On the other hand, it must be executed only once when the application is published, so the compilation time doesn’t impact the application start time.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2799.1">Unfortunately, AOT compilation more than doubles the download size, since the compiled code is more verbose than the source .NET code. </span><span class="koboSpan" id="kobo.2799.2">Therefore, AOT should be adopted only in performance-critical applications that can trade a higher start time for better performance.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2800.1">.NET WebAssembly AOT compilation requires an additional build tool that must be installed as an optional .NET SDK workload in order to use it. </span><span class="koboSpan" id="kobo.2800.2">The first time, you can install it with the following shell command:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.2801.1">dotnet workload install wasm-tools
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2802.1">Instead, when a new .NET version is installed, we just need to launch the following command to update all previously installed workloads:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.2803.1">dotnet workload update
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2804.1">Once the AOT workload has been installed, AOT compilation can be enabled on a per-project basis by adding the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2805.1">&lt;RunAOTCompilation&gt;true&lt;/RunAOTCompilation&gt;</span></code><span class="koboSpan" id="kobo.2806.1"> declaration to the Blazor project file, as shown here:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.2807.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2808.1">Project</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2809.1">Sdk</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2810.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2811.1">"Microsoft.NET.Sdk.BlazorWebAssembly"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2812.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2813.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2814.1">PropertyGroup</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2815.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2816.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2817.1">TargetFramework</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2818.1">&gt;</span></span><span class="koboSpan" id="kobo.2819.1">net8.0</span><span class="hljs-tag"><span class="koboSpan" id="kobo.2820.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2821.1">TargetFramework</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2822.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2823.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2824.1">RunAOTCompilation</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2825.1">&gt;</span></span><span class="koboSpan" id="kobo.2826.1">true</span><span class="hljs-tag"><span class="koboSpan" id="kobo.2827.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2828.1">RunAOTCompilation</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2829.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2830.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2831.1">PropertyGroup</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2832.1">&gt;</span></span><span class="koboSpan" id="kobo.2833.1">
  ...
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2834.1">The next </span><a id="_idIndexMarker1414"/><span class="koboSpan" id="kobo.2835.1">section briefly discusses some of the most relevant third-party tools and libraries that complete Blazor’s official features and help increase productivity in Blazor projects.</span></p>
<h1 class="heading-1" id="_idParaDest-404"><span class="koboSpan" id="kobo.2836.1">Third-party tools for Blazor WebAssembly</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.2837.1">Notwithstanding</span><a id="_idIndexMarker1415"/><span class="koboSpan" id="kobo.2838.1"> Blazor being a young product, its third-party tool and product ecosystem is already quite rich. </span><span class="koboSpan" id="kobo.2838.2">Among the open source, free products, it is </span><a id="_idIndexMarker1416"/><span class="koboSpan" id="kobo.2839.1">worth mentioning the </span><strong class="keyWord"><span class="koboSpan" id="kobo.2840.1">Blazorise</span></strong><span class="koboSpan" id="kobo.2841.1"> project (</span><a href="https://github.com/stsrki/Blazorise"><span class="url"><span class="koboSpan" id="kobo.2842.1">https://github.com/stsrki/Blazorise</span></span></a><span class="koboSpan" id="kobo.2843.1">), which contains various free basic Blazor components (inputs, tabs, modals, and so on) that can be styled with various CSS frameworks, such as</span><a id="_idIndexMarker1417"/><span class="koboSpan" id="kobo.2844.1"> Bootstrap and Material. </span><span class="koboSpan" id="kobo.2844.2">It also contains a simple editable grid and a simple tree view.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2845.1">Also worth</span><a id="_idIndexMarker1418"/><span class="koboSpan" id="kobo.2846.1"> mentioning is </span><strong class="keyWord"><span class="koboSpan" id="kobo.2847.1">BlazorStrap</span></strong><span class="koboSpan" id="kobo.2848.1"> (</span><a href="https://github.com/chanan/BlazorStrap"><span class="url"><span class="koboSpan" id="kobo.2849.1">https://github.com/chanan/BlazorStrap</span></span></a><span class="koboSpan" id="kobo.2850.1">), which contains pure Blazor implementations of all Bootstrap 4 components and widgets.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2851.1">Among all the </span><a id="_idIndexMarker1419"/><span class="koboSpan" id="kobo.2852.1">commercial products, it is worth mentioning </span><strong class="keyWord"><span class="koboSpan" id="kobo.2853.1">Blazor Controls Toolkit</span></strong><span class="koboSpan" id="kobo.2854.1"> (</span><a href="https://blazorct.azurewebsites.net/"><span class="url"><span class="koboSpan" id="kobo.2855.1">https://blazorct.azurewebsites.net/</span></span></a><span class="koboSpan" id="kobo.2856.1">), which is a complete toolset for implementing commercial applications. </span><span class="koboSpan" id="kobo.2856.2">It contains all input types with their fallbacks in case they are not supported by the browser; all Bootstrap components; other basic components; a complete, advanced drag-and-drop framework; and advanced customizable and editable components, like detail views, detail lists, grids, and a tree-repeater (a generalization of the tree view). </span><span class="koboSpan" id="kobo.2856.3">All components are based on a sophisticated metadata representation system that enables the user to design the markup in a declarative way using data annotations and inline Razor declarations.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2857.1">Moreover, it </span><a id="_idIndexMarker1420"/><span class="koboSpan" id="kobo.2858.1">contains additional sophisticated </span><a id="_idIndexMarker1421"/><span class="koboSpan" id="kobo.2859.1">validation attributes, tools for undoing user input, tools for computing changes to send to the server, sophisticated client-side and server-side query tools based on the OData protocol, and tools to maintain and save the whole application state.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2860.1">It is also worth mentioning </span><a id="_idIndexMarker1422"/><span class="koboSpan" id="kobo.2861.1">the </span><strong class="keyWord"><span class="koboSpan" id="kobo.2862.1">bUnit</span></strong><span class="koboSpan" id="kobo.2863.1"> open-source project (</span><a href="https://github.com/egil/bUnit"><span class="url"><span class="koboSpan" id="kobo.2864.1">https://github.com/egil/bUnit</span></span></a><span class="koboSpan" id="kobo.2865.1">), which provides all the tools for testing Blazor components.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2866.1">The </span><strong class="keyWord"><span class="koboSpan" id="kobo.2867.1">Awesome Blazor</span></strong><span class="koboSpan" id="kobo.2868.1"> project (</span><a href="https://github.com/AdrienTorris/awesome-blazor"><span class="url"><span class="koboSpan" id="kobo.2869.1">https://github.com/AdrienTorris/awesome-blazor</span></span></a><span class="koboSpan" id="kobo.2870.1">) lists thousands</span><a id="_idIndexMarker1423"/><span class="koboSpan" id="kobo.2871.1"> of open-source and commercial Blazor resources, such as tutorials, posts, libraries, and example projects.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2872.1">A complete example of a Blazor WebAssembly application based on the WWTravelClub book use case can be found in the </span><em class="italic"><span class="koboSpan" id="kobo.2873.1">Using client technologies </span></em><span class="koboSpan" id="kobo.2874.1">section of </span><em class="italic"><span class="koboSpan" id="kobo.2875.1">Chapter 21, Case Study.</span></em><span class="koboSpan" id="kobo.2876.1"> The next section explains how to use Blazor to implement cross-platform applications. </span><span class="koboSpan" id="kobo.2876.2">The actual code is contained in the folder associated with this chapter in the GitHub repository of the book.</span></p>
<h1 class="heading-1" id="_idParaDest-405"><span class="koboSpan" id="kobo.2877.1">.NET MAUI Blazor</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.2878.1">.NET MAUI is Microsoft’s </span><a id="_idIndexMarker1424"/><span class="koboSpan" id="kobo.2879.1">advised choice to implement cross-platform applications. </span><span class="koboSpan" id="kobo.2879.2">In fact, .NET MAUI applications can be just-in-time compiled for all Windows, Android, iOS, and other Linux-based devices. </span><span class="koboSpan" id="kobo.2879.3">.NET MAUI contains a common abstraction of all target devices, and at the same time takes advantage of each device’s peculiarities by offering platform-specific libraries each containing platform-specific features of a target platform.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2880.1">We will not describe .NET MAUI in detail, but after a short introduction to .NET MAUI, we will focus just on .NET MAUI Blazor. </span><span class="koboSpan" id="kobo.2880.2">This way, by learning just Blazor, you will be able to develop single-page applications, progressive applications, and cross-platform applications.</span></p>
<h2 class="heading-2" id="_idParaDest-406"><span class="koboSpan" id="kobo.2881.1">What is .NET MAUI?</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.2882.1">.NET MAUI </span><a id="_idIndexMarker1425"/><span class="koboSpan" id="kobo.2883.1">extends Xamarin.Forms’ cross-platform capabilities from Android and iOS to also include Windows and macOS. </span><span class="koboSpan" id="kobo.2883.2">Thus, .NET MAUI is a cross-platform framework for creating both native mobile and desktop apps with C#.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2884.1">The basis of .NET MAUI is</span><a id="_idIndexMarker1426"/><span class="koboSpan" id="kobo.2885.1"> Xamarin.Forms. </span><span class="koboSpan" id="kobo.2885.2">In fact, Microsoft has provided a guide for migrating original Xamarin.Forms apps to .NET MAUI, as can be seen at the following link: </span><a href="https://docs.microsoft.com/en-us/dotnet/maui/get-started/migrate"><span class="url"><span class="koboSpan" id="kobo.2886.1">https://docs.microsoft.com/en-us/dotnet/maui/get-started/migrate</span></span></a><span class="koboSpan" id="kobo.2887.1">. </span><span class="koboSpan" id="kobo.2887.2">However, .NET MAUI has been conceived to be the new-generation framework for any native/desktop app development in C#:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.2888.1"><img alt="Interface gráfica do usuário, Site  Descrição gerada automaticamente" src="../Images/B19820_19_02.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.2889.1">Figure 19.2: .NET MAUI high-level architecture</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2890.1">There is a specific difference between Xamarin.Forms and .NET MAUI. </span><span class="koboSpan" id="kobo.2890.2">In Xamarin.Forms, there is a specific native project for any kind of device we would like to publish to on the app, while</span><a id="_idIndexMarker1427"/><span class="koboSpan" id="kobo.2891.1"> in .NET MAUI, this approach is based on as single project targeting multiple platforms.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2892.1">The next section explains how to use .NET MAUI to run a Blazor application as a native application.</span></p>
<h2 class="heading-2" id="_idParaDest-407"><span class="koboSpan" id="kobo.2893.1">Developing native applications with Blazor</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.2894.1">.NET MAUI is</span><a id="_idIndexMarker1428"/><span class="koboSpan" id="kobo.2895.1"> not installed by default when you install Visual Studio 2022, but you need to select the .NET MAUI workload in the Visual Studio installer. </span><span class="koboSpan" id="kobo.2895.2">Therefore, if you don’t see MAUI projects when you start a new </span><a id="_idIndexMarker1429"/><span class="koboSpan" id="kobo.2896.1">project in your Visual Studio installation, you need to run the Visual Studio installer and modify your existing installation with the addition of the .NET MAUI workload.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2897.1">Once you have the MAUI workload installed, in the project creation wizard, you should be able to select </span><strong class="screenText"><span class="koboSpan" id="kobo.2898.1">C#/All platforms/MAUI</span></strong><span class="koboSpan" id="kobo.2899.1">, and then select </span><strong class="screenText"><span class="koboSpan" id="kobo.2900.1">.NET MAUI Blazor Hybrid App</span></strong><span class="koboSpan" id="kobo.2901.1">, as shown here:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.2902.1"><img alt="" role="presentation" src="../Images/B19820_19_03.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.2903.1">Figure 19.3: Creating a .NET MAUI Blazor application</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2904.1">Create a</span><a id="_idIndexMarker1430"/><span class="koboSpan" id="kobo.2905.1"> MAUI Blazor project and call it </span><code class="inlineCode"><span class="koboSpan" id="kobo.2906.1">MAUIBlazorReview</span></code><span class="koboSpan" id="kobo.2907.1">. </span><span class="koboSpan" id="kobo.2907.2">The MAUI Blazor application contains the usual </span><code class="inlineCode"><span class="koboSpan" id="kobo.2908.1">Layout</span></code><span class="koboSpan" id="kobo.2909.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.2910.1">Pages</span></code><span class="koboSpan" id="kobo.2911.1"> folders where you can place your Blazor components and pages, but they are </span><a id="_idIndexMarker1431"/><span class="koboSpan" id="kobo.2912.1">placed inside a </span><code class="inlineCode"><span class="koboSpan" id="kobo.2913.1">Components</span></code><span class="koboSpan" id="kobo.2914.1"> folder. </span><span class="koboSpan" id="kobo.2914.2">It also contains a </span><code class="inlineCode"><span class="koboSpan" id="kobo.2915.1">wwwroot</span></code><span class="koboSpan" id="kobo.2916.1"> folder containing the usual </span><code class="inlineCode"><span class="koboSpan" id="kobo.2917.1">index.html</span></code><span class="koboSpan" id="kobo.2918.1"> page and all the CSS and JavaScript you might need. </span><span class="koboSpan" id="kobo.2918.2">Finally, it also contains the usual </span><code class="inlineCode"><span class="koboSpan" id="kobo.2919.1">_Imports.razor</span></code><span class="koboSpan" id="kobo.2920.1"> page where you can place all your default </span><code class="inlineCode"><span class="koboSpan" id="kobo.2921.1">using</span></code><span class="koboSpan" id="kobo.2922.1"> statements.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2923.1">A MAUI Blazor application also uses layout pages that you can place in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2924.1">Shared</span></code><span class="koboSpan" id="kobo.2925.1"> folder and may reference Razor libraries containing CSS components and JavaScript files.</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.2926.1"><img alt="" role="presentation" src="../Images/B19820_19_04.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.2927.1">Figure 19.4: .NET MAUI Blazor project</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2928.1">The only</span><a id="_idIndexMarker1432"/><span class="koboSpan" id="kobo.2929.1"> difference is that services, instead of being declared in </span><code class="inlineCode"><span class="koboSpan" id="kobo.2930.1">Program.cs</span></code><span class="koboSpan" id="kobo.2931.1"> files, are declared in </span><code class="inlineCode"><span class="koboSpan" id="kobo.2932.1">MauiProgram.cs</span></code><span class="koboSpan" id="kobo.2933.1"> together </span><a id="_idIndexMarker1433"/><span class="koboSpan" id="kobo.2934.1">with MAUI-specific code:</span></p>
<pre class="programlisting code"><code class="hljs-code"> <span class="hljs-keyword"><span class="koboSpan" id="kobo.2935.1">public</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.2936.1">static</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.2937.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.2938.1">MauiProgram</span></span><span class="koboSpan" id="kobo.2939.1">
    {
        </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2940.1">public</span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2941.1">static</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.2942.1"> MauiApp </span></span><span class="hljs-title"><span class="koboSpan" id="kobo.2943.1">CreateMauiApp</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.2944.1">()</span></span><span class="koboSpan" id="kobo.2945.1">
        {
            </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2946.1">var</span></span><span class="koboSpan" id="kobo.2947.1"> builder = MauiApp.CreateBuilder();
            builder
                .UseMauiApp&lt;App&gt;()
                .ConfigureFonts(fonts =&gt;
                {
                    fonts.AddFont(</span><span class="hljs-string"><span class="koboSpan" id="kobo.2948.1">"OpenSans-Regular.ttf"</span></span><span class="koboSpan" id="kobo.2949.1">, </span><span class="hljs-string"><span class="koboSpan" id="kobo.2950.1">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2951.1">OpenSansRegular"</span></span><span class="koboSpan" id="kobo.2952.1">);
                });
            builder.Services.AddMauiBlazorWebView();
</span><span class="hljs-meta"><span class="koboSpan" id="kobo.2953.1">            #</span></span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2954.1">if</span></span><span class="hljs-meta"><span class="koboSpan" id="kobo.2955.1"> DEBUG</span></span><span class="koboSpan" id="kobo.2956.1">
            builder.Services.AddBlazorWebViewDeveloperTools();
</span><span class="hljs-meta"> </span><span class="koboSpan" id="kobo.2957.1">builder.Logging.AddDebug();
</span><span class="hljs-meta"><span class="koboSpan" id="kobo.2958.1">            #</span></span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2959.1">endif</span></span>
<span class="hljs-comment"><span class="koboSpan" id="kobo.2960.1">//this is a service</span></span><span class="koboSpan" id="kobo.2961.1">
builder.Services.AddSingleton&lt;WeatherForecastService&gt;();
            </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2962.1">return</span></span><span class="koboSpan" id="kobo.2963.1"> builder.Build();
        }
    }
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2964.1">Attention </span><a id="_idIndexMarker1434"/><span class="koboSpan" id="kobo.2965.1">must be paid when using an </span><code class="inlineCode"><span class="koboSpan" id="kobo.2966.1">HttpClient</span></code><span class="koboSpan" id="kobo.2967.1"> class to communicate with a server. </span><span class="koboSpan" id="kobo.2967.2">Blazor web applications may use URLs relative to the domain where they were downloaded, while MAUI Blazor applications </span><a id="_idIndexMarker1435"/><span class="koboSpan" id="kobo.2968.1">must use absolute URLs since they are not associated with any default URL. </span><span class="koboSpan" id="kobo.2968.2">Therefore, an </span><code class="inlineCode"><span class="koboSpan" id="kobo.2969.1">HttpClient</span></code><span class="koboSpan" id="kobo.2970.1"> definition is added to the services with something like this:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.2971.1">builder.Services.AddScoped(sp =&gt; </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2972.1">new</span></span><span class="koboSpan" id="kobo.2973.1"> HttpClient
{ BaseAddress = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2974.1">new</span></span><span class="koboSpan" id="kobo.2975.1"> Uri(</span><span class="hljs-string"><span class="koboSpan" id="kobo.2976.1">"https://localhost:7215"</span></span><span class="koboSpan" id="kobo.2977.1">) });
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2978.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.2979.1">Platforms</span></code><span class="koboSpan" id="kobo.2980.1"> folder contains a subfolder for each platform supported by the application, where each subfolder contains platform-specific code.</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.2981.1"><img alt="" role="presentation" src="../Images/B19820_19_05.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.2982.1">Figure 19.5: Platforms folder</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2983.1">Supported folders can be changed by editing the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2984.1">TargetFrameworks</span></code><span class="koboSpan" id="kobo.2985.1"> element of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2986.1">MAUIBlazorReview.csproj</span></code><span class="koboSpan" id="kobo.2987.1"> file:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.2988.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2989.1">TargetFrameworks</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2990.1">&gt;</span></span><span class="koboSpan" id="kobo.2991.1">net8.0-android;net8.0-ios;net8.0-maccatalyst</span><span class="hljs-tag"><span class="koboSpan" id="kobo.2992.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2993.1">TargetFrameworks</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2994.1">&gt;</span></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2995.1">You can </span><a id="_idIndexMarker1436"/><span class="koboSpan" id="kobo.2996.1">select the platform to run the application from using the dropdown next to the green Visual Studio run button. </span><span class="koboSpan" id="kobo.2996.2">On </span><a id="_idIndexMarker1437"/><span class="koboSpan" id="kobo.2997.1">a Windows machine, you can select just Windows and Android. </span><span class="koboSpan" id="kobo.2997.2">If you select Android, an Android device simulator is launched.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2998.1">In order to debug for iOS/Mac platforms on a Windows machine, you need to connect an iOS/Mac device to your computer.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2999.1">When you build the project, the build may ask you to install an Android SDK version. </span><span class="koboSpan" id="kobo.2999.2">If this is the case, please follow the simple instructions in the error message.</span></p>
<h1 class="heading-1" id="_idParaDest-408"><span class="koboSpan" id="kobo.3000.1">Summary</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.3001.1">In this chapter, you learned about client-side technologies. </span><span class="koboSpan" id="kobo.3001.2">In particular, you learned what an SPA is and how to build one based on the Blazor WebAssembly framework. </span><span class="koboSpan" id="kobo.3001.3">The chapter first described the Blazor WebAssembly architecture, and then explained how to exchange input/output with Blazor components and the concept of binding.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.3002.1">After having explained Blazor’s general principles, the chapter focused on how to get user input while providing the user with adequate feedback and visual clues in the event of errors. </span><span class="koboSpan" id="kobo.3002.2">Then, the chapter provided a short description of advanced features, such as JavaScript interoperability, globalization, authentication with authorization, and client-server communication.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.3003.1">Finally, the last section explained how to use Blazor to implement cross-platform applications based on Microsoft MAUI and how to transform a Blazor WebAssembly project into a .NET MAUI Blazor project.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.3004.1">Complete examples of Blazor applications based on the WWTravelClub book use case can be found in the </span><em class="italic"><span class="koboSpan" id="kobo.3005.1">Using client technologies </span></em><span class="koboSpan" id="kobo.3006.1">section of </span><em class="italic"><span class="koboSpan" id="kobo.3007.1">Chapter 21</span></em><span class="koboSpan" id="kobo.3008.1">, </span><em class="italic"><span class="koboSpan" id="kobo.3009.1">Case Study</span></em><span class="koboSpan" id="kobo.3010.1">.</span></p>
<h1 class="heading-1" id="_idParaDest-409"><span class="koboSpan" id="kobo.3011.1">Questions</span></h1>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.3012.1">What is WebAssembly?</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.3013.1">What is an SPA?</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.3014.1">What is the purpose of the Blazor </span><code class="inlineCode"><span class="koboSpan" id="kobo.3015.1">router</span></code><span class="koboSpan" id="kobo.3016.1"> component?</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.3017.1">What is a Blazor page?</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.3018.1">What is the purpose of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3019.1">@namespace</span></code><span class="koboSpan" id="kobo.3020.1"> directive?</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.3021.1">What is an </span><code class="inlineCode"><span class="koboSpan" id="kobo.3022.1">EditContext</span></code><span class="koboSpan" id="kobo.3023.1">?</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.3024.1">What is the right place to initialize a component?</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.3025.1">What is the right place to process the user input?</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.3026.1">What is the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3027.1">IJSRuntime</span></code><span class="koboSpan" id="kobo.3028.1"> interface?</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.3029.1">What is the purpose of </span><code class="inlineCode"><span class="koboSpan" id="kobo.3030.1">@ref</span></code><span class="koboSpan" id="kobo.3031.1">?</span></li>
</ol>
<h1 class="heading-1" id="_idParaDest-410"><span class="koboSpan" id="kobo.3032.1">Further reading</span></h1>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.3033.1">The Blazor official documentation is available at </span><a href="https://docs.microsoft.com/en-us/aspnet/core/blazor"><span class="url"><span class="koboSpan" id="kobo.3034.1">https://docs.microsoft.com/en-us/aspnet/core/blazor</span></span></a><span class="koboSpan" id="kobo.3035.1">.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.3036.1">Lazy loading assemblies is described at </span><a href="https://docs.microsoft.com/en-US/aspnet/core/blazor/webassembly-lazy-load-assemblies"><span class="url"><span class="koboSpan" id="kobo.3037.1">https://docs.microsoft.com/en-US/aspnet/core/blazor/webassembly-lazy-load-assemblies</span></span></a><span class="koboSpan" id="kobo.3038.1">.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.3039.1">All HTML events supported by Blazor together with their event arguments are listed at </span><a href="https://docs.microsoft.com/en-us/aspnet/core/blazor/components/event-handling#event-arguments-1"><span class="url"><span class="koboSpan" id="kobo.3040.1">https://docs.microsoft.com/en-us/aspnet/core/blazor/components/event-handling#event-arguments-1</span></span></a><span class="koboSpan" id="kobo.3041.1">.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.3042.1">Blazor supports the same validation attributes as ASP.NET MVC, with the exception of </span><code class="inlineCode"><span class="koboSpan" id="kobo.3043.1">RemoteAttribute</span></code><span class="koboSpan" id="kobo.3044.1">: </span><a href="https://docs.microsoft.com/en-us/aspnet/core/mvc/models/validation#built-in-attributes"><span class="url"><span class="koboSpan" id="kobo.3045.1">https://docs.microsoft.com/en-us/aspnet/core/mvc/models/validation#built-in-attributes</span></span></a><span class="koboSpan" id="kobo.3046.1">.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.3047.1">A description of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3048.1">InputFile</span></code><span class="koboSpan" id="kobo.3049.1"> component, and how to use it, can be found here: </span><a href="https://docs.microsoft.com/en-US/aspnet/core/blazor/file-uploads"><span class="url"><span class="koboSpan" id="kobo.3050.1">https://docs.microsoft.com/en-US/aspnet/core/blazor/file-uploads</span></span></a><span class="koboSpan" id="kobo.3051.1">.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.3052.1">More details on Blazor localization and globalization are available here: </span><a href="https://docs.microsoft.com/en-US/aspnet/core/blazor/globalization-localization"><span class="url"><span class="koboSpan" id="kobo.3053.1">https://docs.microsoft.com/en-US/aspnet/core/blazor/globalization-localization</span></span></a><span class="koboSpan" id="kobo.3054.1">.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.3055.1">More details on Blazor authentication and all its related URLs are available here: </span><a href="https://docs.microsoft.com/en-US/aspnet/core/blazor/security/webassembly/"><span class="url"><span class="koboSpan" id="kobo.3056.1">https://docs.microsoft.com/en-US/aspnet/core/blazor/security/webassembly/</span></span></a><span class="koboSpan" id="kobo.3057.1">.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.3058.1">The Blazorise project: </span><a href="https://github.com/stsrki/Blazorise"><span class="url"><span class="koboSpan" id="kobo.3059.1">https://github.com/stsrki/Blazorise</span></span></a><span class="koboSpan" id="kobo.3060.1">.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.3061.1">BlazorStrap: </span><a href="https://github.com/chanan/BlazorStrap"><span class="url"><span class="koboSpan" id="kobo.3062.1">https://github.com/chanan/BlazorStrap</span></span></a><span class="koboSpan" id="kobo.3063.1">.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.3064.1">Blazor Controls Toolkit: </span><a href="https://blazorct.azurewebsites.net/"><span class="url"><span class="koboSpan" id="kobo.3065.1">https://blazorct.azurewebsites.net/</span></span></a><span class="koboSpan" id="kobo.3066.1">.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.3067.1">bUnit: </span><a href="https://github.com/egil/bUnit"><span class="url"><span class="koboSpan" id="kobo.3068.1">https://github.com/egil/bUnit</span></span></a><span class="koboSpan" id="kobo.3069.1">.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.3070.1">The Awesome Blazor project: </span><a href="https://github.com/AdrienTorris/awesome-blazor"><span class="url"><span class="koboSpan" id="kobo.3071.1">https://github.com/AdrienTorris/awesome-blazor</span></span></a><span class="koboSpan" id="kobo.3072.1">.</span></li>
</ul>
<h1 class="heading-1"><span class="koboSpan" id="kobo.3073.1">Learn more on Discord</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.3074.1">To join the Discord community for this book – where you can share feedback, ask questions to the authors, and learn about new releases – follow the QR code below:</span></p>
<p class="normal"><a href="https://packt.link/SoftwareArchitectureCSharp12Dotnet8"><span class="url"><span class="koboSpan" id="kobo.3075.1">https://packt.link/SoftwareArchitectureCSharp12Dotnet8</span></span></a></p>
<p class="normal"><span class="koboSpan" id="kobo.3076.1"><img alt="" role="presentation" src="../Images/QR_Code175081751210902046.png"/></span></p>
</div>
</body></html>