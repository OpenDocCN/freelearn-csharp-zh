- en: Chapter 4. Creating First Report
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter, we will see how to create a simple report and display this
    report in our application. We will begin by preparing the report data and connecting
    that data to our report. Then we will formulate our report data and display the
    resulting report in our application.
  prefs: []
  type: TYPE_NORMAL
- en: 'We will cover the following topics:'
  prefs: []
  type: TYPE_NORMAL
- en: Preparing a report data
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Adding a report to the application
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Using a database expert
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Choosing a report template
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Creating report sections
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Working with lines and boxes
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Using special fields
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Adding the report to a form
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Preparing a report data
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Before we begin to add Crystal Reports to our application, we need to understand
    the data that we will be displaying and know what data will be displayed in this
    report. Look at the design of the report in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Preparing a report data](img/4-1.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Selecting the report data
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'As we can see in the preceding screenshot, all report data comes from the `Employees`
    table. The **SELECT** query will appear as shown in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Selecting the report data](img/4-2.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'When we compare the report data with the data retrieved through the query,
    we will find two differences changes:'
  prefs: []
  type: TYPE_NORMAL
- en: '**The** **Full Name** **column**: The **Full Name** column is displayed in
    the report as one part but in the database it consists of three parts (**TitleOfCourtesy**,
    **FirstName**, and **LastName**). We can address this problem here in the `SELECT`
    query or in the report itself. We can concatenate the three fields into one field
    using the SQL query by the plus (`+`) operator, as shown in the following screenshot:![Selecting
    the report data](img/4-3.jpg)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**The** **Reports To** **column**: The **Reports To** column is displayed in
    the report as a name, but as we can see in the preceding screenshot it is displayed
    as number. If we look at the **Employee** table we will see that this table has
    a self-join relationship, see the following screenshot:![Selecting the report
    data](img/4-4.jpg)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'We can modify our query to display names rather than numbers in two ways:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Using subquery**: We will update the query to look like the following screenshot:![Selecting
    the report data](img/4-5.jpg)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Using self join**: We will update the query to look like the following screenshot:![Selecting
    the report data](img/4-6.jpg)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Creating a TableAdapter
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Here are the steps for creating a TableAdapter:'
  prefs: []
  type: TYPE_NORMAL
- en: Open **DataSet1** from **Solution Explorer**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Right-click on it and navigate to **Add** | **TableAdapter**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select your connection settings and click on the **Next** button.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select the **Use SQL Statements** option and click on the **Next** button.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Write our selection query as we see in the preceding screenshot and click on
    the **Next** button.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on the **Next** button on the subsequent screens and click on the **Finish**
    button for the last screen.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Change your adapter name as shown in the following screenshot:![Creating a TableAdapter](img/4-7.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Adding a report to the application
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this section, we will see how to add Crystal Reports to our application to
    display all **Employee** data from the database.
  prefs: []
  type: TYPE_NORMAL
- en: Right-click on our application (**Monitor**) in **Solution Explorer** and navigate
    to **Add** | **New Item**. We will get a result as shown in the following screenshot:![Adding
    a report to the application](img/4-8.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: From the menu on the left-hand side, select **Reporting** and select **Crystal
    Reports** from the options on the right-hand side. Change the name to `crAllEmployees.rpt`
    and click on the **Add** button. We will get a result as shown in the following
    screenshot:![Adding a report to the application](img/4-9.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: We have three options to create our report. From the preceding screenshot, we
    select **Standard** and use the report wizard to create the report. We will be
    using the other methods later and they will be explained in the following chapters.
    Click on the **OK** button to see the following screenshot:![Adding a report to
    the application](img/4-10.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: In this step, we will choose our TableAdapter that we created before to be used
    in this report. We will expand **Project Data** | **ADO.NET DataSets** | **Monitor.DataSet1**
    and choose the **Employees** TableAdapter and move it to the **Selected Tables**
    list. Then click on the **Next** button as shown in the following screenshot:![Adding
    a report to the application](img/4-11.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: In this step, we will choose the fields that we need to display in our report,
    we can add/remove these fields any time we need to after the report creation.
    Select all the required fields, move them to **Fields To Display** menu, and click
    on the **Next** button to see the following screenshot:![Adding a report to the
    application](img/4-12.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: In this step we can add a group to our report, but we don't need any grouping
    in this report. We will use grouping in other reports and we will see that we
    can add any group after report creation. Click on the **Next** button to see the
    following screenshot:![Adding a report to the application](img/4-13.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: In this step we can add a filter to our report, but we don't need any filter
    in this report. We will use filters in other reports and we can add any filter
    after the report is created. Click on the **Next** button to see the following
    screenshot:![Adding a report to the application](img/4-14.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: In this step we will choose the report style. You can browse the styles available
    and choose the one you like. We will choose the **Standard** style and click on
    the **Finish** button to see the following screenshot:![Adding a report to the
    application](img/4-15.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'This report has five main sections:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Section 1 (Report Header)**: Any data (text, image, and so on) inserted in
    this section will be displayed in the report for one time in the top of the first
    paper only'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Section 2 (Page Header)**: Any data (text, image, and so on) inserted in
    this section will be displayed in the header of each page in the report'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Section 3 (Details)**: This section displays the data from the data source
    containing multiple rows of returned results like Microsoft SQL Server in our
    sample'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Section 4 (Report Footer)**: Any data (text, image, and so on) inserted in
    this section will be displayed for one time in the end of the last page in the
    report only'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Section 5 (Page Footer)**: Any data (text, image, and so on) inserted in
    this section will be displayed in the footer of each page in the report'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'We need to add **All Employees** text as a header to our report so we will
    add it in the **Report Header** section:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Right-click on **Section2 (Report Header)** and navigate to **Insert** | **Text
    Object**.
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: Double-click on **Text Object** and enter `All Employees`.
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: Right-click on **Text Object** and choose **Format Object**, navigate to the
    **Font** tab, and change **Style** to **Bold** and **Size** to **12**. Navigate
    to the **Paragraph** tab, change **Alignment** to **Centered** and click on the
    **OK** button.
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: Move the **Text Object** to the horizontal middle of the section.
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: We will format all report objects and fields as we did with **All Employees**
    **Text Object** so the report will look like the following screenshot:![Adding
    a report to the application](img/4-16.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Working with lines and boxes
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this section we will see how to use boxes and lines to enhance our report
    design.
  prefs: []
  type: TYPE_NORMAL
- en: Right-click on **Section 2(Page Header)** and navigate to **Insert** | **Box**
    and draw a box around our fields as shown in the following screenshot:![Working
    with lines and boxes](img/4-17.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Right-click on **Section 2(Page Header)** and navigate to **Insert** | **Line**
    and draw a line as shown in the following screenshot:![Working with lines and
    boxes](img/4-18.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Add some lines between fields, as shown in the following screenshot:![Working
    with lines and boxes](img/4-19.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Using special fields
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In Crystal Reports, there are a lot of special fields that we can use in our
    reports; in this section we will see how to use these special fields.
  prefs: []
  type: TYPE_NORMAL
- en: 'We need to add the page number and total page number in the page footer to
    display the page location in the total page count. The steps for this purpose
    are as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: Right-click in our report and navigate to **Field Explorer**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: From **Filed Explorer**, open the **Special Fields** node and drag **Page N
    of M** to **Section5 (Page Footer)**. The **Page N of M** special field will replace
    **N** with the page number and **M** with the total pages count when we run the
    report. See the following screenshot:![Using special fields](img/4-20.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Adding the report to a form
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In the preceding steps, we have completed the report design; the next step is
    displaying this report when the user clicks on the **btnEmpAll** button.
  prefs: []
  type: TYPE_NORMAL
- en: First, we will add a form that we will use to display all reports; we will name
    this form `ReportForm`.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: From **Toolbox** **|** **Reporting**, drag-and-drop **crystalReportViewer**
    to **ReportForm** and name it `crystalReportViewer1`.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Double-click on **btnEmpAll** to navigate to the earlier code. We will see the
    `click` event of the **btnEmpAll** button.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: In the `click` event of the button **btnEmpAll**, enter the code as shown in
    the following screenshot:![Adding the report to a form](img/4-21.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'This code has three parts:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Prepare report data**: In the first three lines of code, we fill the dataset
    by the TableAdapter (**EmployeesTableAdapter**).'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Pass data to our report**: In the next two lines of code, we will pass the
    dataset to our report after we fill it with the data.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Display report in form**: In the last three lines of code we pass our report
    to **crystalReportViewer1** in **ReportForm** and open this form to display our
    report.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Run our application (Press *F5*) and click on the **btnEmpAll** button (**All**)
    to see our report, as shown in the following screenshot:![Adding the report to
    a form](img/4-22.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter, we learned how to create a simple report and display this report
    in our application. We have seen how to connect the report to the database and
    how to display and format the data in the report. In the next chapter, we will
    create new reports to learn grouping and sorting data. We will also learn how
    to use parameters to filter the table data.
  prefs: []
  type: TYPE_NORMAL
