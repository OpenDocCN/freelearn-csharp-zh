- en: Chapter 6. Working with Cross-Tab Reports
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第 6 章。处理交叉表报表
- en: 'In this chapter we will see one of the most important type of Crystal Reports:
    the Cross-Tab report. It is one of the most powerful tools in Crystal Reports.
    A Cross-Tab report is used to summarize data efficiently as we will see in this
    chapter.'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将看到 Crystal Reports 中最重要的一种类型：交叉表报表。它是 Crystal Reports 中最强大的工具之一。交叉表报表用于有效地汇总数据，正如我们将在本章中所见。
- en: 'We will cover the following topics:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将涵盖以下主题：
- en: Creating a Cross-Tab report
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建交叉表报表
- en: Customizing the Cross-Tab appearance using the Cross-Tab Expert
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用交叉表专家自定义交叉表外观
- en: Doing page setup
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 进行页面设置
- en: 'The Cross-Tab report is very useful for the user because it summarizes a lot
    of information in a simple form to give the user the information he needs. We
    can see the final report as shown in the following screenshot:'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 交叉表报表对用户非常有用，因为它以简单的方式汇总了大量信息，从而为用户提供所需的信息。我们可以看到最终报表，如下面的屏幕截图所示：
- en: '![Working with Cross-Tab Reports](img/6-1.jpg)'
  id: totrans-7
  prefs: []
  type: TYPE_IMG
  zh: '![处理交叉表报表](img/6-1.jpg)'
- en: As we see in the preceding screenshot, the report displays the sum of the product
    orders for each city. In our application, the user will select the product category
    and the country. The report will display the result shown in the previous screenshot.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 正如我们在前面的屏幕截图中所见，该报表显示了每个城市的订单产品总和。在我们的应用程序中，用户将选择产品类别和国家。报表将显示前面屏幕截图中的结果。
- en: Creating our report
  id: totrans-9
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建我们的报表
- en: 'So let''s start creating our report:'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，让我们开始创建我们的报表：
- en: The SQL query that we will use in our report is shown in the following screenshot:![Creating
    our report](img/6-2.jpg)
  id: totrans-11
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们在报表中将使用的 SQL 查询如下所示：![创建我们的报表](img/6-2.jpg)
- en: We will create a new TableAdapter using this SQL query and name it `ProductsOrdersTableAdapter`,
    as seen in the following screenshot:![Creating our report](img/6-3.jpg)
  id: totrans-12
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们将使用此 SQL 查询创建一个新的 TableAdapter，并将其命名为`ProductsOrdersTableAdapter`，如下面的屏幕截图所示：![创建我们的报表](img/6-3.jpg)
- en: Add a new crystal report to our application and name it `crProductsOrders`.
    As we see in the following screenshot, we can create our report by selecting the
    **Using the Report Wizard** option and then choosing **Cross-Tab** as an Expert,
    or we can select **As a Blank Report** and we will add the Cross-Tab from the
    report itself. We will take the second option to see how we can add or modify
    our Cross-Tab at any time after creating the report, so we will choose **As a
    Blank Report** as shown in the following screenshot:![Creating our report](img/6-4.jpg)
  id: totrans-13
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将一个新的水晶报表添加到我们的应用程序中，并将其命名为`crProductsOrders`。正如我们在下面的屏幕截图中所见，我们可以通过选择**使用报表向导**选项，然后选择**交叉表**作为专家，来创建我们的报表，或者我们可以选择**作为空白报表**，然后我们将在报表本身中添加交叉表。我们将选择第二个选项，以便在创建报表后随时添加或修改我们的交叉表，因此我们将选择**作为空白报表**，如下面的屏幕截图所示：![创建我们的报表](img/6-4.jpg)
- en: Right-click on **Database Fields** in **Field Explorer** and select **Database
    Expert**, and then a window appears, as shown in the following screenshot. As
    shown below, we will choose our TableAdapter **ProductsOrders** as a data source:![Creating
    our report](img/6-5.jpg)
  id: totrans-14
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**字段资源管理器**中的**数据库字段**上右键单击，并选择**数据库专家**，然后出现一个窗口，如下面的屏幕截图所示。如下所示，我们将选择我们的
    TableAdapter **ProductsOrders**作为数据源：![创建我们的报表](img/6-5.jpg)
- en: Right-click on the report and navigate to **Insert** | **Cross-Tab** and drag
    it to **Section1 (Report Header)**. As we see in the following screenshot, we
    will add **ShipCountry** and **ShipCity** to the **Columns** list, **CategoryName**
    and **ProductName** to the **Rows** list, and **Quantity** to **Summarized Fields**
    list. From the **Style** tab, we can choose any style, however need but the original
    style is preferred. We will see how to use the **Customize Style** tab in the
    next few steps. Click on the **OK** button.![Creating our report](img/6-6.jpg)
  id: totrans-15
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在报表上右键单击，导航到**插入** | **交叉表**，并将其拖到**Section1（报表页眉）**。正如我们在下面的屏幕截图中所见，我们将**ShipCountry**和**ShipCity**添加到**列**列表中，**CategoryName**和**ProductName**添加到**行**列表中，**Quantity**添加到**汇总字段**列表中。从**样式**选项卡中，我们可以选择任何样式，但首选原始样式。我们将在接下来的几个步骤中看到如何使用**自定义样式**选项卡。单击**确定**按钮。![创建我们的报表](img/6-6.jpg)
- en: Until now our report displays all the products and countries, so we will add
    two parameter fields to filter the report data by product categories and shipping
    countries. The first parameter field is **pmCountry** and the second one is **pmCategory**.
    See the following screenshot:![Creating our report](img/6-7.jpg)
  id: totrans-16
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 到目前为止，我们的报告显示了所有产品和国家，因此我们将添加两个参数字段来通过产品类别和运输国家筛选报告数据。第一个参数字段是**pmCountry**，第二个是**pmCategory**。请参阅以下截图：![创建我们的报告](img/6-7.jpg)
- en: Add a text object to the report as the report header and enter `Best-selling
    products` for the countries in it.
  id: totrans-17
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在报告中添加一个文本对象作为报告标题，并在其中输入`畅销产品`。
- en: Go to the main form in our application, double-click on the **btnProductsOrdersByFilters**
    (**By filter**) button to navigate to the code behind, and write the code to display
    the report in our application, as shown in the following screenshot:![Creating
    our report](img/6-8.jpg)
  id: totrans-18
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 进入我们应用程序的主表单，双击**btnProductsOrdersByFilters**（**按筛选器**）按钮以导航到代码背后，并编写代码以在我们的应用程序中显示报告，如图所示：![创建我们的报告](img/6-8.jpg)
- en: Run the application to test the result. Choose **Dairy Products** from the **Category**
    list and **UK** from the **Country** list as we see in the following screenshot.
    Click on the **By filters** button to display the report.![Creating our report](img/6-9.jpg)
  id: totrans-19
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 运行应用程序以测试结果。从**类别**列表中选择**乳制品**，从**国家**列表中选择**英国**，如图所示。点击**按筛选器**按钮以显示报告。![创建我们的报告](img/6-9.jpg)
- en: The report will look like the following screenshot:![Creating our report](img/6-10.jpg)
  id: totrans-20
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 报告将如下截图所示：![创建我们的报告](img/6-10.jpg)
- en: Customizing the Cross-Tab appearance
  id: totrans-21
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 自定义交叉表外观
- en: In the next few steps, we will see how to update the report to resemble the
    design at the beginning of this chapter.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 在接下来的几个步骤中，我们将看到如何更新报告以类似于本章开头的设计。
- en: As we saw in the preceding screenshot, the two last columns and the last two
    rows have the same date, so we will hide the last column and the last row in our
    report.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 如前一个截图所示，最后两列和最后两行有相同的日期，因此我们将在我们的报告中隐藏最后一列和最后一行。
- en: Right-click in the top-left of the Cross-Tab and select **Cross-Tab Expert**,
    and navigate to the **Customize Style** tab. We will select the **Suppress Row
    Grand Totals** and **Suppress Column Grand Totals** checkboxes as we see in the
    following screenshot. Click on the **OK** button.![Customizing the Cross-Tab appearance](img/6-11.jpg)
  id: totrans-24
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在交叉表的左上角右键单击，选择**交叉表专家**，然后导航到**自定义样式**选项卡。我们将选择以下截图中所见的**抑制行总计**和**抑制列总计**复选框。点击**确定**按钮。![自定义交叉表外观](img/6-11.jpg)
- en: Run the application to test the result. It will look like the following screenshot:![Customizing
    the Cross-Tab appearance](img/6-12.jpg)
  id: totrans-25
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 运行应用程序以测试结果。它看起来如下截图所示：![自定义交叉表外观](img/6-12.jpg)
- en: We can see in this report that the number of products displayed is more than
    the products that we have seen in the designed report in the beginning of this
    chapter. So, we need to sort the products according to the number of orders.
  id: totrans-26
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在这个报告中，我们可以看到显示的产品数量比我们在本章开头设计的报告中看到的多。因此，我们需要根据订单数量对产品进行排序。
- en: In the designed report at the beginning of this chapter, we displayed the two
    products that have the top rate of orders only, so the report header is **Best-selling
    products for countries** and not all the products. In the next step, we will see
    how to control the number of products displayed in our report.
  id: totrans-27
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在本章开头设计的报告中，我们只显示了订单率最高的两个产品，因此报告标题是**各国畅销产品**，而不是所有产品。在下一步中，我们将看到如何控制我们报告中显示的产品数量。
- en: Right-click on the top left of the Cross-Tab, select **Group Sort Expert,**
    and navigate to the **ProductsOrders.ProductName** tab as shown in the following
    screenshot:![Customizing the Cross-Tab appearance](img/6-13.jpg)
  id: totrans-28
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在交叉表的左上角右键单击，选择**分组排序专家**，然后导航到以下截图所示的**ProductsOrders.ProductName**选项卡：![自定义交叉表外观](img/6-13.jpg)
- en: We will select the **Top N** value from the **For this group sort** list and
    enter `2` in the **where N is** textbox to display only two products in the Cross-Tab.
    Click on the **OK** button and run the application to see the result as shown
    in the following screenshot:![Customizing the Cross-Tab appearance](img/6-14.jpg)
  id: totrans-29
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们将从**为此组排序**列表中选择**Top N**值，并在**N在哪里**文本框中输入`2`以在交叉表中仅显示两个产品。点击**确定**按钮并运行应用程序以查看以下截图所示的结果：![自定义交叉表外观](img/6-14.jpg)
- en: If we compare this report with the one designed in the beginning of this chapter,
    we will find no difference between them except the formatting of the text and
    the numbers. You can format it as per your need.
  id: totrans-30
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果我们将这个报告与本章开头设计的报告进行比较，我们会发现它们之间除了文本和数字的格式外没有区别。您可以按照您的需求进行格式化。
- en: In the next step, we will see how we can change the format of the grid lines
    and the background colors of the cells.
  id: totrans-31
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在下一步中，我们将看到如何更改网格线的格式和单元格的背景颜色。
- en: Right-click on the top left of the Cross-Tab and select **Cross-Tab Expert**
    and navigate to the **Customize Style** tab. As we see in the following screenshot,
    we will select the row or column we want to change the background color of and
    select the color we need to apply to it.![Customizing the Cross-Tab appearance](img/6-15.jpg)
  id: totrans-32
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 右键点击交叉表的左上角，选择**交叉表专家**并导航到**自定义样式**选项卡。正如我们在下面的屏幕截图中所见，我们将选择要更改背景颜色的行或列，并选择要应用的颜色。![自定义交叉表外观](img/6-15.jpg)
- en: Click on the **Format Grid Lines** button to format the Cross-Tab lines as we
    can see in the following screenshot. Select the line. The line color, style, or
    width can be altered as desired.![Customizing the Cross-Tab appearance](img/6-16.jpg)
  id: totrans-33
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**格式化网格线**按钮，将交叉表线条格式化，如图所示。选择线条。线条颜色、样式或宽度可以按需更改。![自定义交叉表外观](img/6-16.jpg)
- en: Click on the **OK** button to save the changes and run the application to test
    the new appearance. This is shown in the following screenshot:![Customizing the
    Cross-Tab appearance](img/6-17.jpg)
  id: totrans-34
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**确定**按钮保存更改并运行应用程序以测试新的外观。这如图所示：![自定义交叉表外观](img/6-17.jpg)
- en: What if the user needs to display products of all categories to a specific country
    with the ability to filter data by the products category?
  id: totrans-35
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果用户需要向特定国家显示所有类别的产品，并且能够通过产品类别过滤数据，会怎样？
- en: 'We will make a small change to apply this request: we will change the parameter
    condition in our report as shown in the following screenshot:![Customizing the
    Cross-Tab appearance](img/6-18.jpg)'
  id: totrans-36
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们将进行一个小改动以应用这个请求：我们将更改报告中的参数条件，如图所示：![自定义交叉表外观](img/6-18.jpg)
- en: When the user writes string `ALL` in the category list, the report will display
    all categories. Run the application and test the change, it will look like the
    following screenshot:![Customizing the Cross-Tab appearance](img/6-19.jpg)
  id: totrans-37
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 当用户在类别列表中写入字符串`ALL`时，报告将显示所有类别。运行应用程序并测试更改，结果将如图所示：![自定义交叉表外观](img/6-19.jpg)
- en: Performing page setup
  id: totrans-38
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 执行页面设置
- en: 'When we work with Cross-Tab we need to be careful with the page size because
    the width of the report grows dynamically. If we try to test the Cross-Tab by
    inputting the value `USA`, we will see that the report is divided into two parts
    as shown in the following screenshot:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们使用交叉表时，我们需要注意页面大小，因为报告的宽度会动态增长。如果我们尝试通过输入值`USA`来测试交叉表，我们会看到报告被分成两部分，如图所示：
- en: '![Performing page setup](img/6-20.jpg)'
  id: totrans-40
  prefs: []
  type: TYPE_IMG
  zh: '![执行页面设置](img/6-20.jpg)'
- en: This problem occurs because the value `USA` has many corresponding values for
    cities in our database and our report is designed to display and print in a portrait
    letter form. We can change the basic page settings by right-clicking on the report
    and navigating to **Design** | **Page Setup**. This is shown in the following
    screenshot. The page size has been changed to **A3** and the **Orientation** to
    **Landscape**.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 这个问题发生是因为我们的数据库中`USA`值对应的城市有很多，我们的报告设计为以竖排信纸形式显示和打印。我们可以通过右键点击报告并导航到**设计** |
    **页面设置**来更改基本页面设置。如图所示。页面大小已更改为**A3**，方向为**横幅**。
- en: '![Performing page setup](img/6-21.jpg)'
  id: totrans-42
  prefs: []
  type: TYPE_IMG
  zh: '![执行页面设置](img/6-21.jpg)'
- en: 'If we test by inputting the value `USA` again, the result will look like the
    following screenshot:'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们再次通过输入值`USA`进行测试，结果将类似于以下屏幕截图：
- en: '![Performing page setup](img/6-22.jpg)'
  id: totrans-44
  prefs: []
  type: TYPE_IMG
  zh: '![执行页面设置](img/6-22.jpg)'
- en: Summary
  id: totrans-45
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: In this chapter we have seen how useful Cross-Tab is. We learned to create Cross-Tab
    report and use the Cross-Tab Expert to control every part of the Cross-Tab. In
    the next chapter, we will see another fantastic tool in Crystal Reports; we will
    see how we can create reports containing charts.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们看到了交叉表有多有用。我们学习了如何创建交叉表报告并使用交叉表专家来控制交叉表的每个部分。在下一章中，我们将看到Crystal Reports中的另一个神奇工具；我们将看到如何创建包含图表的报告。
