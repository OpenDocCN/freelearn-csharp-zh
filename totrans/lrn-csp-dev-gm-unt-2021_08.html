<html><head></head><body><div id="sbo-rt-content"><div id="_idContainer304">&#13;
    <h1 class="chapterNumber">8</h1>&#13;
    <h1 id="_idParaDest-171" class="chapterTitle">Scripting Game Mechanics</h1>&#13;
    <p class="normal">In the last chapter, we focused on using code to move the player and camera, with a trip into Unity physics on the side. However, controlling a playable character isn't enough to make a compelling game; in fact, it's probably the one area that remains fairly constant across different titles.</p>&#13;
    <p class="normal">A game's unique spark comes from its core mechanics, and the feeling of power and agency those mechanics give to the players. Without fun and engrossing ways to affect the virtual environment you've created, your game doesn't stand a chance of repeat play, to say nothing of fun. As we venture into implementing the game's mechanics, we'll also be upgrading our knowledge of C# and its intermediate-level features.</p>&#13;
    <p class="normal">This chapter will build on the <em class="italic">Hero Born</em> prototype by focusing on individually implemented game mechanics, as well as the basics of system design and <strong class="keyword">user interfaces</strong> (<strong class="keyword">UIs</strong>). You'll be diving into the following topics:</p>&#13;
    <ul>&#13;
      <li class="bullet">Adding jumps</li>&#13;
      <li class="bullet">Shooting projectiles</li>&#13;
      <li class="bullet">Creating a game manager</li>&#13;
      <li class="bullet">Creating a GUI</li>&#13;
    </ul>&#13;
    <h1 id="_idParaDest-172" class="title">Adding jumps</h1>&#13;
    <p class="normal">Remember from the last chapter that Rigidbody components add simulated real-world physics to GameObjects, and Collider <a id="_idIndexMarker515"/>components interact with each other using Rigidbody objects.</p>&#13;
    <p class="normal">Another great thing that we didn't discuss in the previous chapter about using a Rigidbody component to control player movement is that we can easily add in different mechanics that rely on applied force, such as jumping. In this section, we'll get our player jumping and write our first utility function.</p>&#13;
    <div class="note">&#13;
      <p class="Information-Box--PACKT-">A utility function is a class method that performs some kind of grunt work so that we don't <a id="_idIndexMarker516"/>clutter up gameplay code—for instance, wanting to check whether the player capsule is touching the ground to jump. </p>&#13;
    </div>&#13;
    <p class="normal">Before that, you'll need to get acquainted with a new data type called enumerations, which you'll do in the following section.</p>&#13;
    <h2 id="_idParaDest-173" class="title">Introducing enumerations</h2>&#13;
    <p class="normal">By definition, an enumeration type is a set, or collection, of named constants that belong to the <a id="_idIndexMarker517"/>same variable. These are useful when you want a collection of different values, but with the added benefit of them all being of the same parent type.</p>&#13;
    <p class="normal">It's easier to show rather than tell with enumerations, so let's take a look at their syntax in the following code snippet:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-built_in">enum</span> PlayerAction { Attack, Defend, Flee };&#13;
</code></pre>&#13;
    <p class="normal">Let's break down how this works, as follows:</p>&#13;
    <ul>&#13;
      <li class="bullet">The <code class="Code-In-Text--PACKT-">enum</code> keyword declares the type followed by the variable name.</li>&#13;
      <li class="bullet">The different values an enum can have are written inside curly brackets, separated by a comma (except for the last item).</li>&#13;
      <li class="bullet">The <code class="Code-In-Text--PACKT-">enum</code> has to end with a semicolon, just like all other data types we've worked with.</li>&#13;
    </ul>&#13;
    <p class="normal">In this case, we're declaring a variable called <code class="Code-In-Text--PACKT-">PlayerAction</code>, of type <code class="Code-In-Text--PACKT-">enum</code>, which can be set to one of three values—<code class="Code-In-Text--PACKT-">Attack</code>, <code class="Code-In-Text--PACKT-">Defend</code>, or <code class="Code-In-Text--PACKT-">Flee</code>.</p>&#13;
    <p class="normal">To declare an enumeration variable, we use the following syntax:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">PlayerAction CurrentAction = PlayerAction.Defend;&#13;
</code></pre>&#13;
    <p class="normal">Again, we can break this down, as follows:</p>&#13;
    <ul>&#13;
      <li class="bullet">The type is set as <code class="Code-In-Text--PACKT-">PlayerAction</code>, since our enumeration is just like any other type, like a string or integer.</li>&#13;
      <li class="bullet">The variable is named <code class="Code-In-Text--PACKT-">currentAction</code> and set equal to a <code class="Code-In-Text--PACKT-">PlayerAction</code> value.</li>&#13;
      <li class="bullet">Each enum constant can be accessed using dot notation.</li>&#13;
    </ul>&#13;
    <p class="normal">Our c<code class="Code-In-Text--PACKT-">urrentAction</code> variable is now set to <code class="Code-In-Text--PACKT-">Defend</code>, but it can be changed to <code class="Code-In-Text--PACKT-">Attack</code> or <code class="Code-In-Text--PACKT-">Flee</code> at any time.</p>&#13;
    <p class="normal">Enumerations may look simple at first glance, but they are extremely powerful in the right situations. One of their <a id="_idIndexMarker518"/>most useful features is the ability to store underlying types, which is the next subject you'll be jumping into.</p>&#13;
    <h3 id="_idParaDest-174" class="title">Underlying types</h3>&#13;
    <p class="normal">Enums come with an <em class="italic">underlying type</em>, meaning that each constant inside the curly brackets has an <a id="_idIndexMarker519"/>associated value. The default underlying type is <code class="Code-In-Text--PACKT-">int</code> and starts at 0, just like arrays, with each sequential constant getting the next highest number.</p>&#13;
    <div class="note">&#13;
      <p class="Information-Box--PACKT-">Not all types are created equal—underlying types for enumerations are limited to <code class="Code-In-Text--PACKT-">byte</code>, <code class="Code-In-Text--PACKT-">sbyte</code>, <code class="Code-In-Text--PACKT-">short</code>, <code class="Code-In-Text--PACKT-">ushort</code>, <code class="Code-In-Text--PACKT-">int</code>, <code class="Code-In-Text--PACKT-">uint</code>, <code class="Code-In-Text--PACKT-">long</code>, and <code class="Code-In-Text--PACKT-">ulong</code>. These are called integral types, which are used to specify the size of numeric values that a variable can store.</p>&#13;
      <p class="Information-Box--PACKT-">This is a bit <a id="_idIndexMarker520"/>advanced for this book, but you'll be using <code class="Code-In-Text--PACKT-">int</code> in most cases. More information on these types can be found here: <a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/enum"><span class="url">https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/enum</span></a>. </p>&#13;
    </div>&#13;
    <p class="normal">For example, our <code class="Code-In-Text--PACKT-">PlayerAction</code> enumeration values right now are listed as follows, even though they aren't explicitly written out:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-built_in">enum</span> PlayerAction { Attack = <span class="hljs-number">0</span>, Defend = <span class="hljs-number">1</span>, Flee = <span class="hljs-number">2</span> };&#13;
</code></pre>&#13;
    <p class="normal">There's no rule that says underlying values need to start at <code class="Code-In-Text--PACKT-">0</code>; in fact, all you have to do is specify the first value and then C# increments the rest of the values for us, as illustrated in the following code snippet:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-built_in">enum</span> PlayerAction { Attack = <span class="hljs-number">5</span>, Defend, Flee };&#13;
</code></pre>&#13;
    <p class="normal">In the preceding example, <code class="Code-In-Text--PACKT-">Defend</code> equals <code class="Code-In-Text--PACKT-">6</code>, and <code class="Code-In-Text--PACKT-">Flee</code> equals <code class="Code-In-Text--PACKT-">7</code> automatically. However, if we wanted the <code class="Code-In-Text--PACKT-">PlayerAction</code> enum to hold non-sequential values, we could explicitly add them in, like this:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-built_in">enum</span> PlayerAction { Attack = <span class="hljs-number">10</span>, Defend = <span class="hljs-number">5</span>, Flee = <span class="hljs-number">0</span>};&#13;
</code></pre>&#13;
    <p class="normal">We can even change the underlying type of <code class="Code-In-Text--PACKT-">PlayerAction</code> to any of the approved types by adding a colon after the enum name, as follows:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-built_in">enum</span> PlayerAction :  <span class="code-highlight"><strong class="hljs-built_in-slc">byte</strong></span> { Attack, Defend, Flee };&#13;
</code></pre>&#13;
    <p class="normal">Retrieving an enum's underlying type takes an explicit conversion, but we've already covered those, so the following syntax shouldn't be a surprise:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-built_in">enum</span> PlayerAction { Attack = <span class="hljs-number">10</span>, Defend = <span class="hljs-number">5</span>, Flee = <span class="hljs-number">0</span>};&#13;
PlayerAction CurrentAction = PlayerAction.Attack;&#13;
<span class="code-highlight"><strong class="hljs-built_in-slc">int</strong></span> ActionCost = <span class="code-highlight"><strong class="hljs-slc">(</strong><strong class="hljs-built_in-slc">int</strong><strong class="hljs-slc">)</strong></span>CurrentAction;&#13;
</code></pre>&#13;
    <p class="normal">Since <code class="Code-In-Text--PACKT-">CurrentAction</code> is set to <code class="Code-In-Text--PACKT-">Attack</code>, <code class="Code-In-Text--PACKT-">ActionCost</code> would be <code class="Code-In-Text--PACKT-">10</code> in the above example code.</p>&#13;
    <p class="normal">Enumerations are extremely <a id="_idIndexMarker521"/>powerful tools in your programming arsenal. Your next challenge is to use your knowledge of enumerations to gather more specific user input from the keyboard.</p>&#13;
    <p class="normal">Now that we have a basic grasp of enumeration types, we can capture keyboard input using the <code class="Code-In-Text--PACKT-">KeyCode</code> enum. Update the <code class="Code-In-Text--PACKT-">PlayerBehavior</code> script with the following highlighted code, save it, and hit play:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">PlayerBehavior</span> : <span class="hljs-title">MonoBehaviour</span> &#13;
{&#13;
    <span class="hljs-comment">// ... No other variable changes needed ...</span>&#13;
 &#13;
    <span class="code-highlight"><strong class="hljs-comment-slc">// 1</strong></span>&#13;
    <span class="code-highlight"><strong class="hljs-keyword-slc">public</strong><strong class="hljs-slc"> </strong><strong class="hljs-built_in-slc">float</strong><strong class="hljs-slc"> JumpVelocity = </strong><strong class="hljs-number-slc">5f</strong><strong class="hljs-slc">;</strong></span>&#13;
    <span class="code-highlight"><strong class="hljs-keyword-slc">private</strong><strong class="hljs-slc"> </strong><strong class="hljs-built_in-slc">bool</strong><strong class="hljs-slc"> _isJumping;</strong></span>&#13;
 &#13;
    <span class="hljs-keyword">void</span><span class="hljs-function"> </span><span class="hljs-title">Start</span><span class="hljs-function">()</span>&#13;
    {&#13;
        _rb = GetComponent&lt;Rigidbody&gt;();&#13;
    }&#13;
 &#13;
    <span class="hljs-keyword">void</span><span class="hljs-function"> </span><span class="hljs-title">Update</span><span class="hljs-function">()</span>&#13;
    {&#13;
        <span class="code-highlight"><strong class="hljs-comment-slc">// 2</strong></span>&#13;
        <span class="code-highlight"><strong class="hljs-slc">_isJumping |= Input.GetKeyDown(KeyCode.Space);</strong></span>&#13;
        <span class="hljs-comment">// ... No other changes needed ...</span>&#13;
    }&#13;
 &#13;
    <span class="hljs-keyword">void</span><span class="hljs-function"> </span><span class="hljs-title">FixedUpdate</span><span class="hljs-function">()</span>&#13;
    {&#13;
        <span class="code-highlight"><strong class="hljs-comment-slc">// 3</strong></span>&#13;
        <span class="code-highlight"><strong class="hljs-keyword-slc">if</strong><strong class="hljs-slc">(_isJumping)</strong></span>&#13;
        <span class="code-highlight"><strong class="hljs-slc">{</strong></span>&#13;
            <span class="code-highlight"><strong class="hljs-comment-slc">// 4</strong></span>&#13;
            <span class="code-highlight"><strong class="hljs-slc">_rb.AddForce(Vector3.up * JumpVelocity, ForceMode.Impulse);</strong></span>&#13;
        <span class="code-highlight"><strong class="hljs-slc">}</strong></span>&#13;
        <span class="code-highlight"><strong class="hljs-comment-slc">// 5</strong></span>&#13;
        <span class="code-highlight"><strong class="hljs-slc">_isJumping = </strong><strong class="hljs-literal-slc">false</strong><strong class="hljs-slc">;</strong></span>&#13;
        <span class="hljs-comment">// ... No other changes needed ...</span>&#13;
    }&#13;
}&#13;
</code></pre>&#13;
    <p class="normal">Let's break down this code, as follows:</p>&#13;
    <ol>&#13;
      <li class="numbered">First, we create two new variables—a public variable to hold the amount of applied jump force we want and a private boolean to check if our player should be jumping.</li>&#13;
      <li class="numbered">We set the value of <code class="Code-In-Text--PACKT-">_isJumping</code> to the <code class="Code-In-Text--PACKT-">Input.GetKeyDown()</code> method, which returns a <code class="Code-In-Text--PACKT-">bool</code> value depending on whether a specified key is pressed.<ul>&#13;
          <li class="bullet-l2">We use the <code class="Code-In-Text--PACKT-">|=</code> operator to set <code class="Code-In-Text--PACKT-">_isJumping</code>, which is the logical <code class="Code-In-Text--PACKT-">or</code> condition. This operator <a id="_idIndexMarker522"/>makes sure that we don't have consecutive input checks override each other when the player is jumping.</li>&#13;
          <li class="bullet-l2">The method accepts a key parameter as either a <code class="Code-In-Text--PACKT-">string</code> or a <code class="Code-In-Text--PACKT-">KeyCode</code>, which is an enumeration type. We specify that we want to check for <code class="Code-In-Text--PACKT-">KeyCode.Space</code>.&#13;
    <div class="note">&#13;
      <p class="Information-Box--PACKT-">Checking for inputs in <code class="Code-In-Text--PACKT-">FixedUpdate</code> can sometimes lead to input loss or even double inputs because it doesn't run once per frame. This is why we're checking for inputs in <code class="Code-In-Text--PACKT-">Update</code> and then applying force or setting the velocity in <code class="Code-In-Text--PACKT-">FixedUpdate</code>.</p>&#13;
    </div></li>&#13;
        </ul>&#13;
      </li>&#13;
      <li class="numbered" value="3">We use an <code class="Code-In-Text--PACKT-">if</code> statement to check if <code class="Code-In-Text--PACKT-">_isJumping</code> is true, and trigger the jump mechanic if it is.</li>&#13;
      <li class="numbered">Since we already have the Rigidbody component stored, we can pass the <code class="Code-In-Text--PACKT-">Vector3</code> and <code class="Code-In-Text--PACKT-">ForceMode</code> parameters to <code class="Code-In-Text--PACKT-">RigidBody.AddForce()</code> and make the player jump.<ul>&#13;
          <li class="bullet-l2">We specify that the vector (or applied force) should be in the <code class="Code-In-Text--PACKT-">up</code> direction, multiplied by <code class="Code-In-Text--PACKT-">JumpVelocity</code>.</li>&#13;
          <li class="bullet-l2">The <code class="Code-In-Text--PACKT-">ForceMode</code> parameter determines how the force is applied and is also an <a id="_idIndexMarker523"/>enumeration type. <code class="Code-In-Text--PACKT-">Impulse</code> delivers an instant force to an object while taking its mass into account, which is perfect for a jump mechanic.&#13;
&#13;
    <div class="note">&#13;
      <p class="Information-Box--PACKT-">Other <code class="Code-In-Text--PACKT-">ForceMode</code> choices can <a id="_idIndexMarker524"/>be useful in different situations, all of which are detailed here: <a href="https://docs.unity3d.com/ScriptReference/ForceMode.html"><span class="url">https://docs.unity3d.com/ScriptReference/ForceMode.html</span></a>.</p>&#13;
    </div></li>&#13;
        </ul>&#13;
      </li>&#13;
      <li class="numbered" value="5">At the end of every <code class="Code-In-Text--PACKT-">FixedUpdate</code> frame, we reset <code class="Code-In-Text--PACKT-">_isJumping</code> to false so the input check knows a complete jump and the landing cycle has been completed.</li>&#13;
    </ol>&#13;
    <p class="normal">If you play the game now, you'll be able to move around and jump when you hit the spacebar. However, the mechanic allows you to keep jumping indefinitely, which isn't what we want. We'll work on limiting our jump mechanic to one at a time in the next section, using something called a layer mask.</p>&#13;
    <h2 id="_idParaDest-175" class="title">Working with layer masks</h2>&#13;
    <p class="normal">Think of layer masks as invisible groups that a GameObject can belong to, used by the physics system to determine anything from navigation to intersecting collider components. While more <a id="_idIndexMarker525"/>advanced uses of layer masks are outside the scope of this book, we'll create and use one to perform a simple check—whether the player capsule is touching the ground, in order to limit the player to one jump at a time.</p>&#13;
    <p class="normal">Before we can check that the player capsule is touching the ground, we need to add all the environment objects in our level to a custom layer mask. This will let us perform the actual collision calculation with the Capsule Collider component that's already attached to the player. Proceed as follows:</p>&#13;
    <ol>&#13;
      <li class="numbered" value="1">Select any environment GameObject in the <strong class="screenText">Hierarchy</strong> and in the corresponding <strong class="screenText">Inspector</strong> pane, click on <strong class="screenText">Layer</strong> | <strong class="screenText">Add Layer...</strong>, as illustrated in the following screenshot:<figure class="mediaobject"><img src="Images/B17573_08_01.png" alt="" width="427" height="238"/></figure>&#13;
        <p class="packt_figref">Figure 8.1: Selecting layers in the Inspector pane</p>&#13;
      </li>&#13;
      <li class="numbered">Add a new layer called <code class="Code-In-Text--PACKT-">Ground</code> by typing the name into the first available slot, which is Layer 6. Layers 0-5 are reserved for Unity's default layers, even though Layer 3 is empty, as <a id="_idIndexMarker526"/>illustrated in the following screenshot:<figure class="mediaobject"><img src="Images/B17573_08_02.png" alt="" width="314" height="359"/></figure>&#13;
        <p class="packt_figref">Figure 8.2: Adding layers in the Inspector pane</p>&#13;
      </li>&#13;
      <li class="numbered">Select the <strong class="screenText">Environment</strong> parent GameObject in the <strong class="screenText">Hierarchy</strong>, click on the <strong class="screenText">Layer</strong> dropdown, and select <strong class="screenText">Ground</strong>. <figure class="mediaobject"><img src="Images/B17573_08_03.png" alt="" width="327" height="208"/></figure>&#13;
    <p class="packt_figref">Figure 8.3: Setting a custom layer</p>&#13;
      </li>&#13;
    </ol>&#13;
&#13;
    <p class="normal">After you have selected the <strong class="screenText">Ground</strong> option shown in the following screenshot, click <strong class="screenText">Yes, change children</strong> when a <a id="_idIndexMarker527"/>dialog appears asking you if you want to change all child objects. Here, you've defined a new layer called <strong class="screenText">Ground</strong> and assigned every child object of <strong class="screenText">Environment</strong> to that layer.</p>&#13;
    <p class="normal">Going forward, all the objects on the <strong class="screenText">Ground</strong> layer can be checked to see if they intersect with a specific object. You'll use this in the following challenge to make sure the player can perform a jump if it's on the ground; no unlimited jump hacks here.</p>&#13;
    <p class="normal">Since we don't want code cluttering up the <code class="Code-In-Text--PACKT-">Update()</code> method, we'll do our layer mask calculations in a utility function and return a <code class="Code-In-Text--PACKT-">true</code> or <code class="Code-In-Text--PACKT-">false</code> value based on the outcome. To do so, proceed as follows:</p>&#13;
    <ol>&#13;
      <li class="numbered" value="1">Add the following highlighted code to <code class="Code-In-Text--PACKT-">PlayerBehavior</code> and play the scene again:&#13;
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">PlayerBehavior</span> : <span class="hljs-title">MonoBehaviour</span> &#13;
{&#13;
    <span class="code-highlight"><strong class="hljs-comment-slc">// 1</strong></span>&#13;
    <span class="code-highlight"><strong class="hljs-keyword-slc">public</strong><strong class="hljs-slc"> </strong><strong class="hljs-built_in-slc">float</strong><strong class="hljs-slc"> DistanceToGround = </strong><strong class="hljs-number-slc">0.1f</strong><strong class="hljs-slc">;</strong></span>&#13;
    <span class="code-highlight"><strong class="hljs-comment-slc">// 2</strong></span><span class="hljs-comment"> </span>&#13;
    <span class="code-highlight"><strong class="hljs-keyword-slc">public</strong><strong class="hljs-slc"> LayerMask GroundLayer;</strong></span>&#13;
    <span class="code-highlight"><strong class="hljs-comment-slc">// 3</strong></span>&#13;
    <span class="code-highlight"><strong class="hljs-keyword-slc">private</strong><strong class="hljs-slc"> CapsuleCollider _col;</strong></span>&#13;
    <span class="hljs-comment">// ... No other variable changes needed ...</span>&#13;
 &#13;
    <span class="hljs-keyword">void</span><span class="hljs-function"> </span><span class="hljs-title">Start</span><span class="hljs-function">()</span>&#13;
    {&#13;
        _rb = GetComponent&lt;Rigidbody&gt;();&#13;
 &#13;
        <span class="code-highlight"><strong class="hljs-comment-slc">// 4</strong></span>&#13;
        <span class="code-highlight"><strong class="hljs-slc">_col = GetComponent&lt;CapsuleCollider&gt;();</strong></span>&#13;
    }&#13;
 &#13;
    <span class="hljs-keyword">void</span><span class="hljs-function"> </span><span class="hljs-title">Update</span><span class="hljs-function">()</span>&#13;
    {&#13;
        <span class="hljs-comment">// ... No changes needed ...</span>&#13;
    }&#13;
 &#13;
    <span class="hljs-keyword">void</span><span class="hljs-function"> </span><span class="hljs-title">FixedUpdate</span><span class="hljs-function">()</span>&#13;
    {&#13;
        <span class="code-highlight"><strong class="hljs-comment-slc">// 5</strong></span>&#13;
        <span class="hljs-keyword">if</span>(<span class="code-highlight"><strong class="hljs-slc">IsGrounded() &amp;&amp;</strong></span> _isJumping)&#13;
        {&#13;
            _rb.AddForce(Vector3.up * JumpVelocity,&#13;
                 ForceMode.Impulse);&#13;
         }&#13;
         <span class="hljs-comment">// ... No other changes needed ...</span>&#13;
    }&#13;
 &#13;
    <span class="code-highlight"><strong class="hljs-comment-slc">// 6</strong></span>&#13;
    <span class="code-highlight"><strong class="hljs-keyword-slc">private</strong><strong class="hljs-function-slc"> </strong><strong class="hljs-built_in-slc">bool</strong><strong class="hljs-function-slc"> </strong><strong class="hljs-title-slc">IsGrounded</strong><strong class="hljs-function-slc">()</strong></span>&#13;
    <span class="code-highlight"><strong class="hljs-slc">{</strong></span>&#13;
        <span class="code-highlight"><strong class="hljs-comment-slc">// 7</strong></span>&#13;
        <span class="code-highlight"><strong class="hljs-slc">Vector3 capsuleBottom = </strong><strong class="hljs-keyword-slc">new</strong><strong class="hljs-slc"> Vector3(_col.bounds.center.x,</strong></span>&#13;
             <span class="code-highlight"><strong class="hljs-slc">_col.bounds.min.y, _col.bounds.center.z);</strong></span>&#13;
                &#13;
        <span class="code-highlight"><strong class="hljs-comment-slc">// 8</strong></span>&#13;
        <span class="code-highlight"><strong class="hljs-built_in-slc">bool</strong><strong class="hljs-slc"> grounded = Physics.CheckCapsule(_col.bounds.center,</strong></span>&#13;
            <span class="code-highlight"><strong class="hljs-slc">capsuleBottom, DistanceToGround, GroundLayer,</strong></span>&#13;
               <span class="code-highlight"><strong class="hljs-slc">QueryTriggerInteraction.Ignore);</strong></span>&#13;
                &#13;
        <span class="code-highlight"><strong class="hljs-comment-slc">// 9</strong></span>&#13;
        <span class="code-highlight"><strong class="hljs-keyword-slc">return</strong><strong class="hljs-slc"> grounded;</strong></span>&#13;
    <span class="code-highlight"><strong class="hljs-slc">}</strong></span>&#13;
<span class="code-highlight"><strong class="hljs-slc">}</strong></span>&#13;
</code></pre>&#13;
      </li>&#13;
      <li class="numbered">With the <code class="Code-In-Text--PACKT-">PlayerBehavior</code> script selected, set <strong class="screenText">Ground Layer</strong> in the <strong class="screenText">Inspector</strong> pane to <strong class="screenText">Ground</strong> from <a id="_idIndexMarker528"/>the <strong class="screenText">Ground Layer</strong> dropdown, as illustrated in the following screenshot:<figure class="mediaobject"><img src="Images/B17573_08_04.png" alt="" width="473" height="317"/></figure>&#13;
    <p class="packt_figref">Figure 8.4: Setting the Ground Layer</p>&#13;
      </li>&#13;
    </ol>&#13;
&#13;
    <p class="normal">Let's break down the preceding code, as follows:</p>&#13;
    <ol>&#13;
      <li class="numbered" value="1">We create a new variable for the distance we'll check between the player Capsule Collider and any <strong class="screenText">Ground Layer</strong> object.</li>&#13;
      <li class="numbered">We create a <code class="Code-In-Text--PACKT-">LayerMask</code> variable that we can set in the <strong class="screenText">Inspector</strong> and use for the collider detection.</li>&#13;
      <li class="numbered">We create a variable to store the player's Capsule Collider component.</li>&#13;
      <li class="numbered">We use <code class="Code-In-Text--PACKT-">GetComponent()</code> to find and return the Capsule Collider attached to the player.</li>&#13;
      <li class="numbered">We update the <code class="Code-In-Text--PACKT-">if</code> statement to check whether <code class="Code-In-Text--PACKT-">IsGrounded</code> returns <code class="Code-In-Text--PACKT-">true</code> and the spacebar is pressed <a id="_idIndexMarker529"/>before executing the jump code.</li>&#13;
      <li class="numbered">We declare the <code class="Code-In-Text--PACKT-">IsGrounded()</code> method with a <code class="Code-In-Text--PACKT-">bool</code> return type.</li>&#13;
      <li class="numbered">We create a local <code class="Code-In-Text--PACKT-">Vector3</code> variable to store the position at the bottom of the player's Capsule Collider, which we'll use to check for collisions with any objects on the <strong class="screenText">Ground</strong> layer.<ul>&#13;
          <li class="bullet-l2">All Collider components have a <code class="Code-In-Text--PACKT-">bounds</code> property, which gives us access to the min, max, and center positions of its <em class="italic">x</em>, <em class="italic">y</em>, and <em class="italic">z</em> axes.</li>&#13;
          <li class="bullet-l2">The bottom of the collider is the 3D point at center <em class="italic">x</em>, min <em class="italic">y</em>, and center <em class="italic">z</em>.</li>&#13;
        </ul>&#13;
      </li>&#13;
      <li class="numbered">We create a local <code class="Code-In-Text--PACKT-">bool</code> to store the result of the <code class="Code-In-Text--PACKT-">CheckCapsule()</code> method that we call from the <code class="Code-In-Text--PACKT-">Physics</code> class, which takes in the following five arguments:<ul>&#13;
          <li class="bullet-l2">The start of the capsule, which we set to the middle of the Capsule Collider since we only care about checking whether the bottom touches the ground.</li>&#13;
          <li class="bullet-l2">The end of the capsule, which is the <code class="Code-In-Text--PACKT-">capsuleBottom</code> position we've already calculated.</li>&#13;
          <li class="bullet-l2">The radius of the capsule, which is the <code class="Code-In-Text--PACKT-">DistanceToGround</code> already set.</li>&#13;
          <li class="bullet-l2">The layer mask we want to check collisions on, set to <code class="Code-In-Text--PACKT-">GroundLayer</code> in the <strong class="screenText">Inspector</strong>.</li>&#13;
          <li class="bullet-l2">The query trigger interaction, which determines whether the method should ignore colliders that are set as triggers. Since we want to ignore all triggers, we used the <code class="Code-In-Text--PACKT-">QueryTriggerInteraction.Ignore</code> enum.&#13;
&#13;
    <div class="note">&#13;
      <p class="Information-Box--PACKT-">We could also use the <code class="Code-In-Text--PACKT-">Distance</code> method from the <code class="Code-In-Text--PACKT-">Vector3</code> class to determine how far we are from the ground since we know the height of the player capsule. However, we're going to stick with using the <code class="Code-In-Text--PACKT-">Physics</code> class since that's the focus of this chapter.</p>&#13;
    </div></li>&#13;
        </ul>&#13;
      </li>&#13;
&#13;
      <li class="numbered" value="9">We return the value stored in <code class="Code-In-Text--PACKT-">grounded</code> at the end of the calculation.</li>&#13;
    </ol>&#13;
    <div class="note">&#13;
      <p class="Information-Box--PACKT-">We could have done the collision calculation manually, but that would require more complex 3D math than we have time to cover here. However, it's always a good idea to use built-in methods when available.</p>&#13;
    </div>&#13;
    <p class="normal">That was an involved piece of code that we just added into <code class="Code-In-Text--PACKT-">PlayerBehavior</code>, but when you break it down, the only <a id="_idIndexMarker530"/>new thing we did was use a method from the <code class="Code-In-Text--PACKT-">Physics</code> class. In plain English, we supplied <code class="Code-In-Text--PACKT-">CheckCapsule()</code> with a start and endpoint, a collision radius, and a layer mask. If the endpoint gets closer than the collision radius to an object on the layer mask, the method returns <code class="Code-In-Text--PACKT-">true</code>—meaning the player is touching the ground. If the player is in a mid-jump position, <code class="Code-In-Text--PACKT-">CheckCapsule()</code> returns <code class="Code-In-Text--PACKT-">false</code>. </p>&#13;
    <p class="normal">Since we're checking <code class="Code-In-Text--PACKT-">IsGround</code> in the <code class="Code-In-Text--PACKT-">if</code> statement every frame in <code class="Code-In-Text--PACKT-">Update()</code>, our player's jump skills are only allowed when touching the ground.</p>&#13;
    <p class="normal">That's all you're going to do with the jump mechanic, but the player still needs a way to interact and defend themself against the hordes of enemies that will eventually populate the arena. In the following section, you'll fix that gap by implementing a simple shooting mechanic.</p>&#13;
    <h1 id="_idParaDest-176" class="title">Shooting projectiles</h1>&#13;
    <p class="normal">Shooting mechanics are so common that it's hard to think of a first-person game without some variation <a id="_idIndexMarker531"/>present, and <em class="italic">Hero Born</em> is no different. In this section, we'll talk about how to instantiate GameObjects from Prefabs while the game is running, and use the skills we've learned to propel them forward using Unity physics.</p>&#13;
    <h2 id="_idParaDest-177" class="title">Instantiating objects</h2>&#13;
    <p class="normal">The concept of instantiating a GameObject in the game is similar to instantiating an instance of a class—both require <a id="_idIndexMarker532"/>starting values so that C# knows what kind of object we want to create and where it needs to be created. To create objects in the scene at runtime, we use the <code class="Code-In-Text--PACKT-">Instantiate()</code> method and provide a Prefab object, a starting position, and a starting rotation.</p>&#13;
    <p class="normal">Essentially, we can tell Unity to create a given object with all its components and scripts at this spot, looking in this direction, and then manipulate it as needed once it's born in the 3D space. Before we instantiate an object, you'll need to create the object Prefab itself, which is your next task.</p>&#13;
    <p class="normal">Before we can shoot any projectiles, we'll need a Prefab to use as a reference, so let's create that now, as follows:</p>&#13;
    <ol>&#13;
      <li class="numbered" value="1">Select <strong class="screenText">+</strong> | <strong class="screenText">3D</strong> <strong class="screenText">Object</strong> | <strong class="screenText">Sphere</strong> in the <strong class="screenText">Hierarchy</strong> panel and name it <code class="Code-In-Text--PACKT-">Bullet</code>.<ul>&#13;
          <li class="bullet-l2">Change its <strong class="screenText">Scale</strong> to 0.15 in the <em class="italic">x</em>, <em class="italic">y</em>, and <em class="italic">z</em> axes in the <strong class="screenText">Transform</strong> component.</li>&#13;
        </ul>&#13;
      </li>&#13;
      <li class="numbered">Select the <strong class="screenText">Bullet</strong> in the <strong class="screenText">Inspector</strong> and use the <strong class="screenText">Add Component</strong> button at the bottom to search <a id="_idIndexMarker533"/>for and add a <strong class="screenText">Rigidbody</strong> component, leaving all default properties as they are.</li>&#13;
      <li class="numbered">Create a new material in the <code class="Code-In-Text--PACKT-">Materials</code> folder using <strong class="screenText">Create</strong> | <strong class="screenText">Material</strong>, and name it <code class="Code-In-Text--PACKT-">Bullet_Mat</code>:<ul>&#13;
          <li class="bullet-l2">Change the <strong class="screenText">Albedo</strong> property to a deep yellow.</li>&#13;
          <li class="bullet-l2">Drag and drop the material from the <strong class="screenText">Materials</strong> folder onto the <code class="Code-In-Text--PACKT-">Bullet</code> GameObject in the <strong class="screenText">Hierarchy</strong> pane.</li>&#13;
        </ul>&#13;
        <figure class="mediaobject"><img src="Images/B17573_08_05.png" alt="" width="437" height="470"/></figure>&#13;
        <p class="packt_figref">Figure 8.5: Setting projectile properties</p>&#13;
      </li>&#13;
      <li class="numbered">Select the <strong class="screenText">Bullet</strong> in the <strong class="screenText">Hierarchy</strong> panel and drag it into the <code class="Code-In-Text--PACKT-">Prefabs</code> folder in the <strong class="screenText">Project</strong> panel. Then, delete <a id="_idIndexMarker534"/>it from the <strong class="screenText">Hierarchy</strong> to clean up the scene:<figure class="mediaobject"><img src="Images/B17573_08_06.png" alt="" width="671" height="670"/></figure>&#13;
    <p class="packt_figref">Figure 8.6: Creating a projectile Prefab</p>&#13;
      </li>&#13;
    </ol>&#13;
&#13;
    <p class="normal">You created and configured a <strong class="screenText">Bullet</strong> Prefab GameObject that can be instantiated as many times as we need in the game and updated as needed. This means you're ready for the next challenge—shooting projectiles.</p>&#13;
    <h2 id="_idParaDest-178" class="title">Adding the shooting mechanic</h2>&#13;
    <p class="normal">Now that we have a Prefab object to work with, we can instantiate and move copies of the Prefab whenever <a id="_idIndexMarker535"/>we hit the left mouse button to create a shooting mechanic, as follows:</p>&#13;
    <ol>&#13;
      <li class="numbered" value="1">Update the <code class="Code-In-Text--PACKT-">PlayerBehavior</code> script with the following code:&#13;
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">PlayerBehavior</span> : <span class="hljs-title">MonoBehaviour</span> &#13;
{&#13;
    <span class="code-highlight"><strong class="hljs-comment-slc">// 1</strong></span>&#13;
    <span class="code-highlight"><strong class="hljs-keyword-slc">public</strong><strong class="hljs-slc"> GameObject Bullet;</strong></span>&#13;
    <span class="code-highlight"><strong class="hljs-keyword-slc">public</strong><strong class="hljs-slc"> </strong><strong class="hljs-built_in-slc">float</strong><strong class="hljs-slc"> BulletSpeed = </strong><strong class="hljs-number-slc">100f</strong><strong class="hljs-slc">;</strong></span>&#13;
     &#13;
    <span class="code-highlight"><strong class="hljs-comment-slc">// 2</strong></span>&#13;
    <span class="code-highlight"><strong class="hljs-keyword-slc">private</strong><strong class="hljs-slc"> </strong><strong class="hljs-built_in-slc">bool</strong><strong class="hljs-slc"> _isShooting</strong></span>;&#13;
 &#13;
    <span class="hljs-comment">// ... No other variable changes needed ...</span>&#13;
 &#13;
    <span class="hljs-keyword">void</span><span class="hljs-function"> </span><span class="hljs-title">Start</span><span class="hljs-function">()</span>&#13;
    {&#13;
        <span class="hljs-comment">// ... No changes needed ...</span>&#13;
    }&#13;
 &#13;
    <span class="hljs-keyword">void</span><span class="hljs-function"> </span><span class="hljs-title">Update</span><span class="hljs-function">()</span>&#13;
    {&#13;
        <span class="code-highlight"><strong class="hljs-comment-slc">// 3</strong></span>&#13;
        <span class="code-highlight"><strong class="hljs-slc">_isShooting |= Input.GetMouseButtonDown(</strong><strong class="hljs-number-slc">0</strong><strong class="hljs-slc">);</strong></span>&#13;
        <span class="hljs-comment">// ... No other changes needed ...</span>&#13;
    }&#13;
 &#13;
    <span class="hljs-keyword">void</span><span class="hljs-function"> </span><span class="hljs-title">FixedUpdate</span><span class="hljs-function">()</span>&#13;
    {&#13;
        <span class="hljs-comment">// ... No other changes needed ...</span>&#13;
 &#13;
        <span class="code-highlight"><strong class="hljs-comment-slc">// 4</strong></span>&#13;
        <span class="code-highlight"><strong class="hljs-keyword-slc">if</strong><strong class="hljs-slc"> (_isShooting)</strong></span>&#13;
        <span class="code-highlight"><strong class="hljs-slc">{</strong></span>&#13;
            <span class="code-highlight"><strong class="hljs-comment-slc">// 5</strong></span>&#13;
            <span class="code-highlight"><strong class="hljs-slc">GameObject newBullet = Instantiate(Bullet,</strong></span>&#13;
                <span class="code-highlight"><strong class="hljs-keyword-slc">this</strong><strong class="hljs-slc">.transform.position + </strong><strong class="hljs-keyword-slc">new</strong><strong class="hljs-slc"> Vector3(</strong><strong class="hljs-number-slc">1</strong><strong class="hljs-slc">, </strong><strong class="hljs-number-slc">0</strong><strong class="hljs-slc">, </strong><strong class="hljs-number-slc">0</strong><strong class="hljs-slc">),</strong></span>&#13;
                   <span class="code-highlight"><strong class="hljs-keyword-slc">this</strong><strong class="hljs-slc">.transform.rotation);</strong></span>&#13;
            <span class="code-highlight"><strong class="hljs-comment-slc">// 6</strong></span>&#13;
            <span class="code-highlight"><strong class="hljs-slc">Rigidbody BulletRB = </strong></span>&#13;
                 <span class="code-highlight"><strong class="hljs-slc">newBullet.GetComponent&lt;Rigidbody&gt;();</strong></span>&#13;
 &#13;
            <span class="code-highlight"><strong class="hljs-comment-slc">// 7</strong></span>&#13;
            <span class="code-highlight"><strong class="hljs-slc">BulletRB.velocity = </strong><strong class="hljs-keyword-slc">this</strong><strong class="hljs-slc">.transform.forward *</strong></span> &#13;
                                            <span class="code-highlight"><strong class="hljs-slc">BulletSpeed;</strong></span>&#13;
        <span class="code-highlight"><strong class="hljs-slc">}</strong></span>&#13;
        <span class="code-highlight"><strong class="hljs-comment-slc">// 8</strong></span>&#13;
        <span class="code-highlight"><strong class="hljs-slc">_isShooting = </strong><strong class="hljs-literal-slc">false</strong><strong class="hljs-slc">;</strong></span>&#13;
    }&#13;
 &#13;
    <span class="hljs-keyword">private</span><span class="hljs-function"> </span><span class="hljs-built_in">bool</span><span class="hljs-function"> </span><span class="hljs-title">IsGrounded</span><span class="hljs-function">()</span>&#13;
    {&#13;
        <span class="hljs-comment">// ... No changes needed ...</span>&#13;
    }&#13;
}&#13;
</code></pre>&#13;
      </li>&#13;
      <li class="numbered">In the <strong class="screenText">Inspector</strong>, drag the <strong class="screenText">Bullet</strong> Prefab <a id="_idIndexMarker536"/>from the <strong class="screenText">Project</strong> panel into the <strong class="screenText">Bullet</strong> property of <code class="Code-In-Text--PACKT-">PlayerBehavior</code>, as illustrated in the following screenshot:<figure class="mediaobject"><img src="Images/B17573_08_07.png" alt="" width="755" height="370"/></figure>&#13;
        <p class="packt_figref">Figure 8.7: Setting the Bullet Prefab</p>&#13;
      </li>&#13;
      <li class="numbered">Play the game and use the left mouse button to fire projectiles in the direction the player is facing!</li>&#13;
    </ol>&#13;
    <p class="normal">Let's break down the code, as follows:</p>&#13;
    <ol>&#13;
      <li class="numbered" value="1">We create two <a id="_idIndexMarker537"/>variables: one to store the Bullet Prefab, the other to hold the Bullet speed.</li>&#13;
      <li class="numbered">Like our jumping mechanic, we use a boolean in the <code class="Code-In-Text--PACKT-">Update</code> method to check if our player should be shooting.</li>&#13;
      <li class="numbered">We set the value of <code class="Code-In-Text--PACKT-">_isShooting</code> using the <code class="Code-In-Text--PACKT-">or</code> logical operator and <code class="Code-In-Text--PACKT-">Input.GetMouseButtonDown()</code>, which returns <code class="Code-In-Text--PACKT-">true</code> if we're pushing the specified button, just like with <code class="Code-In-Text--PACKT-">Input.GetKeyDown()</code>.<ul>&#13;
          <li class="bullet-l2"><code class="Code-In-Text--PACKT-">GetMouseButtonDown()</code> takes an <code class="Code-In-Text--PACKT-">int</code> parameter to determine which mouse button we want to check for; <code class="Code-In-Text--PACKT-">0</code> is the left button, <code class="Code-In-Text--PACKT-">1</code> is the right button, and <code class="Code-In-Text--PACKT-">2</code> is the middle button or scroll wheel.</li>&#13;
        </ul>&#13;
      </li>&#13;
      <li class="numbered">Then we check if our player is supposed to be shooting using the <code class="Code-In-Text--PACKT-">_isShooting</code> input check variable.</li>&#13;
      <li class="numbered">We create a local GameObject variable every time the left mouse button is pressed:<ul>&#13;
          <li class="bullet-l2">We use the <code class="Code-In-Text--PACKT-">Instantiate()</code> method to assign a GameObject to <code class="Code-In-Text--PACKT-">newBullet</code> by passing in the <code class="Code-In-Text--PACKT-">Bullet</code> Prefab. We also use the player capsule's position to place the new <code class="Code-In-Text--PACKT-">Bullet</code> Prefab in front of the player to avoid any collisions.</li>&#13;
          <li class="bullet-l2">We append it as a <code class="Code-In-Text--PACKT-">GameObject</code> to explicitly cast the returned object to the <a id="_idIndexMarker538"/>same type as <code class="Code-In-Text--PACKT-">newBullet</code>, which in this case is a GameObject.</li>&#13;
        </ul>&#13;
      </li>&#13;
      <li class="numbered">We call <code class="Code-In-Text--PACKT-">GetComponent()</code> to return and store the Rigidbody component on <code class="Code-In-Text--PACKT-">newBullet</code>.</li>&#13;
      <li class="numbered">We set the <code class="Code-In-Text--PACKT-">velocity</code> property of the Rigidbody component to the player's <code class="Code-In-Text--PACKT-">transform.forward</code> direction multiplied by <code class="Code-In-Text--PACKT-">BulletSpeed</code>:<ul>&#13;
          <li class="bullet-l2">Changing the <code class="Code-In-Text--PACKT-">velocity</code> instead of using <code class="Code-In-Text--PACKT-">AddForce()</code> ensures that gravity doesn't pull our bullets down in an arc when fired.</li>&#13;
        </ul>&#13;
      </li>&#13;
      <li class="numbered">Finally, we set the <code class="Code-In-Text--PACKT-">_isShooting</code> value to <code class="Code-In-Text--PACKT-">false</code> so our shooting input is reset for the next input event.</li>&#13;
    </ol>&#13;
    <p class="normal">Again, you've significantly upgraded the logic the player script is using. You should now be able to use the mouse to shoot projectiles that fly straight out from the player's position.</p>&#13;
    <p class="normal">However, the problem now is that your game scene, and hierarchy, are flooded with spent Bullet objects. Your next task is to clean those objects up once they've been fired, to avoid any performance issues.</p>&#13;
    <h2 id="_idParaDest-179" class="title">Managing object build-up</h2>&#13;
    <p class="normal">Whether you're writing a completely code-based application or a 3D game, it's important to make sure that unused objects are regularly deleted to avoid overloading the program. Our bullets <a id="_idIndexMarker539"/>don't exactly play an important role after they are shot; they sort of just keep existing on the floor near whatever wall or object they collided with.</p>&#13;
    <p class="normal">With a mechanic such as shooting, this could result in hundreds, if not thousands, of bullets down the line, which is something we don't want. Your next challenge is to destroy each bullet after a set delay time.</p>&#13;
    <p class="normal">For this task, we can take the skills we've already learned and make the bullets responsible for their self-destructive behavior, as follows:</p>&#13;
    <ol>&#13;
      <li class="numbered" value="1">Create a new C# script in the <code class="Code-In-Text--PACKT-">Scripts</code> folder and name it <code class="Code-In-Text--PACKT-">BulletBehavior</code>.</li>&#13;
      <li class="numbered">Drag and drop the <code class="Code-In-Text--PACKT-">BulletBehavior</code> script onto the <code class="Code-In-Text--PACKT-">Bullet</code> Prefab in the <code class="Code-In-Text--PACKT-">Prefabs</code> folder and add the following code:&#13;
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">using</span> System.Collections;&#13;
<span class="hljs-keyword">using</span> System.Collections.Generic;&#13;
<span class="hljs-keyword">using</span> UnityEngine;&#13;
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">BulletBehavior</span> : <span class="hljs-title">MonoBehaviour</span> &#13;
{&#13;
    <span class="hljs-comment">// 1</span>&#13;
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">float</span> OnscreenDelay = <span class="hljs-number">3f</span>;&#13;
 &#13;
    <span class="hljs-keyword">void</span><span class="hljs-function"> </span><span class="hljs-title">Start</span><span class="hljs-function"> ()</span> &#13;
    {&#13;
        <span class="hljs-comment">// 2</span>&#13;
        Destroy(<span class="hljs-keyword">this</span>.gameObject, OnscreenDelay);&#13;
    }&#13;
}&#13;
</code></pre>&#13;
      </li>&#13;
    </ol>&#13;
    <p class="normal">Let's break down this code, as follows:</p>&#13;
    <ol>&#13;
      <li class="numbered" value="1">We declare a <code class="Code-In-Text--PACKT-">float</code> variable to store how long we want the Bullet Prefabs to remain in the scene <a id="_idIndexMarker540"/>after they are instantiated.</li>&#13;
      <li class="numbered">We use the <code class="Code-In-Text--PACKT-">Destroy()</code> method to delete the GameObject.<ul>&#13;
          <li class="bullet-l2"><code class="Code-In-Text--PACKT-">Destroy()</code> always needs an object as a parameter. In this case, we use the <code class="Code-In-Text--PACKT-">this</code> keyword to specify the object that the script is attached to.</li>&#13;
          <li class="bullet-l2"><code class="Code-In-Text--PACKT-">Destroy()</code> can optionally take an additional <code class="Code-In-Text--PACKT-">float</code> parameter as a delay, which we use to keep the bullets on screen for a short amount of time.</li>&#13;
        </ul>&#13;
      </li>&#13;
    </ol>&#13;
    <p class="normal">Play the game again, shoot some bullets, and watch as they are deleted from the <strong class="screenText">Hierarchy</strong> by themselves in the scene after a specific delay. This means that the bullet executes its defined behavior, without another script having to tell it what to do, which is an ideal application of the <em class="italic">Component</em> design pattern. </p>&#13;
    <p class="normal">Now that our housekeeping is done, you're going to learn about a key component of any well-designed and organized project—the manager class.</p>&#13;
    <h1 id="_idParaDest-180" class="title">Creating a game manager</h1>&#13;
    <p class="normal">A common misconception when learning to program is that all variables should automatically be made public, but in general, this is not a good idea. In my experience, variables should be thought <a id="_idIndexMarker541"/>of as protected and private from the start, and only made public if necessary. One way you'll see experienced programmers protect their data is through manager classes, and since we want to build good habits, we'll be following suit. Think of manager classes as a funnel where important variables and methods can be accessed safely.</p>&#13;
    <p class="normal">When I say safely, I mean just that, which might seem unfamiliar in a programming context. However, when you have different classes communicating and updating data with each other, things can get messy. That's why having a single contact point, such as a manager class, can keep this to a minimum. We'll get into how to do that effectively in the following section.</p>&#13;
    <h2 id="_idParaDest-181" class="title">Tracking player properties</h2>&#13;
    <p class="normal"><em class="italic">Hero Born</em> is a simple game, so the only two <a id="_idIndexMarker542"/>data points we need to keep track of <a id="_idIndexMarker543"/>are how many items the player has collected and how much health they have left. We want these variables to be private so that <a id="_idIndexMarker544"/>they can only be modified from the manager class, giving us control and safety. Your next challenge is to create a game manager for <em class="italic">Hero Born</em> and populate it with helpful functionality.</p>&#13;
    <p class="normal">Game manager classes will be a constant facet of any project you develop in the future, so let's learn how to properly create one, as follows:</p>&#13;
    <ol>&#13;
      <li class="numbered" value="1">Create a new C# script in the <code class="Code-In-Text--PACKT-">Scripts</code> folder and name it <code class="Code-In-Text--PACKT-">GameBehavior</code>.<div class="note">&#13;
          <p class="Information-Box--PACKT-">Usually, this script would be named <code class="Code-In-Text--PACKT-">GameManager</code>, but Unity reserves that name for its own scripts. If you ever create a script and a cogwheel icon shows up next to its name instead of the C# file icon, that tells you it's restricted.</p>&#13;
        </div>&#13;
      </li>&#13;
      <li class="numbered">Create a new empty game object in the <strong class="screenText">Hierarchy</strong> by using <strong class="screenText">+</strong> | <strong class="screenText">Create Empty</strong>, and name it <code class="Code-In-Text--PACKT-">Game_Manager</code>.</li>&#13;
      <li class="numbered">Drag and drop the <code class="Code-In-Text--PACKT-">GameBehavior.cs</code> script from the <strong class="screenText">Scripts</strong> folder onto the <code class="Code-In-Text--PACKT-">Game_Manager</code> object, as illustrated in the following screenshot:<figure class="mediaobject"><img src="Images/B17573_08_08.png" alt="" width="481" height="304"/></figure>&#13;
        <p class="packt_figref">Figure 8.8: Attaching the game manager script</p>&#13;
        <div class="note">&#13;
          <p class="Information-Box--PACKT-">Manager scripts, and other non-game files, are set up on empty objects to put them in the scene, even though they don't interact with the actual 3D space.</p>&#13;
        </div>&#13;
      </li>&#13;
      <li class="numbered">Add the <a id="_idIndexMarker545"/>following code to <code class="Code-In-Text--PACKT-">GameBehavior.cs</code>:&#13;
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">GameBehavior</span> : <span class="hljs-title">MonoBehaviour</span> &#13;
{&#13;
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">int</span> _itemsCollected = <span class="hljs-number">0</span>;&#13;
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">int</span> _playerHP = <span class="hljs-number">10</span>;&#13;
} &#13;
</code></pre>&#13;
      </li>&#13;
    </ol>&#13;
    <p class="normal">Let's break down this code. We added two <a id="_idIndexMarker546"/>new <code class="Code-In-Text--PACKT-">private</code> variables to hold the number of items picked up and how many lives the player has left; these are <code class="Code-In-Text--PACKT-">private</code> because they should only be modifiable in this class. If they were made <code class="Code-In-Text--PACKT-">public</code>, other classes could change them at will, which could lead to the variables storing incorrect or concurrent data.</p>&#13;
    <p class="normal">Having these variables declared as <code class="Code-In-Text--PACKT-">private</code> means that you are responsible for how they are accessed. The following topic on <code class="Code-In-Text--PACKT-">get</code> and <code class="Code-In-Text--PACKT-">set</code> properties will introduce you to a standard, safe way to accomplish this task going forward.</p>&#13;
    <h2 id="_idParaDest-182" class="title">The get and set properties</h2>&#13;
    <p class="normal">We've got our manager script and private variables set up, but how do<a id="_idIndexMarker547"/> we access them from other classes if they're private? While we could write separate public <a id="_idIndexMarker548"/>methods in <code class="Code-In-Text--PACKT-">GameBehavior</code> to handle passing new values to the private variables, let's see whether there is a better way of doing things.</p>&#13;
    <p class="normal">In this case, C# provides all <a id="_idIndexMarker549"/>variables with <code class="Code-In-Text--PACKT-">get</code> and <code class="Code-In-Text--PACKT-">set</code> properties, which are perfectly suited to our task. Think of these as methods that are automatically fired by the C# compiler <a id="_idIndexMarker550"/>whether we explicitly call them or not, similar to how <code class="Code-In-Text--PACKT-">Start()</code> and <code class="Code-In-Text--PACKT-">Update()</code> are executed by Unity when a scene starts.</p>&#13;
    <p class="normal"><code class="Code-In-Text--PACKT-">get</code> and <code class="Code-In-Text--PACKT-">set</code> properties can be added to any variable, with or without an initial value, as illustrated in the following code snippet:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> FirstName { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; };&#13;
<span class="hljs-comment">// OR</span>&#13;
<span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> LastName { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; } = <span class="hljs-string">"Smith"</span>;&#13;
</code></pre>&#13;
    <p class="normal">However, using them like this doesn't add any additional benefits; for that, you need to include a code block for each property, as illustrated in the following code snippet:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> FirstName&#13;
{&#13;
    <span class="hljs-keyword">get</span> {&#13;
        <span class="hljs-comment">// Code block executes when variable is accessed</span>&#13;
    }&#13;
    <span class="hljs-keyword">set</span> {&#13;
        <span class="hljs-comment">// Code block executes when variable is updated</span>&#13;
    }&#13;
}&#13;
</code></pre>&#13;
    <p class="normal">Now, the <code class="Code-In-Text--PACKT-">get</code> and <code class="Code-In-Text--PACKT-">set</code> properties are set up to execute additional logic, depending on where it's needed. We're not done yet though, as we still need to handle the new logic.</p>&#13;
    <p class="normal">Every <code class="Code-In-Text--PACKT-">get</code> code block needs to return a value, while every <code class="Code-In-Text--PACKT-">set</code> block needs to </p>&#13;
    <p class="normal">assign a value; this is <a id="_idIndexMarker551"/>where having a combination of a private variable, called a backing variable, and a <a id="_idIndexMarker552"/>public variable with <code class="Code-In-Text--PACKT-">get</code> and <code class="Code-In-Text--PACKT-">set</code> properties <a id="_idIndexMarker553"/>comes into play. The private <a id="_idIndexMarker554"/>variable remains protected, while the public variable allows controlled access from other classes, as shown in the following code snippet:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">private</span> <span class="hljs-built_in">string</span> _firstName&#13;
<span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> FirstName {&#13;
    <span class="hljs-keyword">get</span> { &#13;
        <span class="code-highlight"><strong class="hljs-keyword-slc">return</strong></span> _firstName;&#13;
    }&#13;
    <span class="hljs-keyword">set</span> {&#13;
        _firstName = <span class="code-highlight"><strong class="hljs-keyword-slc">value</strong></span>;&#13;
    }&#13;
}&#13;
</code></pre>&#13;
    <p class="normal">Let's break this down, as follows:</p>&#13;
    <ul>&#13;
      <li class="bullet">We can <code class="Code-In-Text--PACKT-">return</code> the value stored in the private variable from the <code class="Code-In-Text--PACKT-">get</code> property anytime another class needs it, without actually giving that outside class direct access.</li>&#13;
      <li class="bullet">We can update the private variable any time an outside class assigns a new value to the public variable, keeping them in sync.</li>&#13;
      <li class="bullet">The <code class="Code-In-Text--PACKT-">value</code> keyword is a stand-in for whatever new value is assigned.</li>&#13;
    </ul>&#13;
    <p class="normal">This can seem a little esoteric without an actual application, so let's update <code class="Code-In-Text--PACKT-">GameBehavior</code> with public variables with getter and setter properties to go along with our existing private variables.</p>&#13;
    <p class="normal">Now that we understand the syntax of the <code class="Code-In-Text--PACKT-">get</code> and <code class="Code-In-Text--PACKT-">set</code> property accessors, we can implement them in our manager class for greater efficiency and code readability.</p>&#13;
    <p class="normal">Update the code in <code class="Code-In-Text--PACKT-">GameBehavior</code>, as follows:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">GameBehavior</span> : <span class="hljs-title">MonoBehaviour</span> &#13;
{&#13;
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">int</span> _itemsCollected = <span class="hljs-number">0</span>; &#13;
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">int</span> _playerHP = <span class="hljs-number">10</span>;&#13;
 &#13;
    <span class="code-highlight"><strong class="hljs-comment-slc">// 1</strong></span>&#13;
    <span class="code-highlight"><strong class="hljs-keyword-slc">public</strong><strong class="hljs-slc"> </strong><strong class="hljs-built_in-slc">int</strong><strong class="hljs-slc"> Items</strong></span>&#13;
    <span class="code-highlight"><strong class="hljs-slc">{</strong></span>&#13;
        <span class="code-highlight"><strong class="hljs-comment-slc">// 2</strong></span>&#13;
        <span class="code-highlight"><strong class="hljs-keyword-slc">get</strong><strong class="hljs-slc"> { </strong><strong class="hljs-keyword-slc">return</strong><strong class="hljs-slc"> _itemsCollected; }</strong></span>&#13;
        <span class="code-highlight"><strong class="hljs-comment-slc">// 3</strong></span>&#13;
        <span class="code-highlight"><strong class="hljs-keyword-slc">set</strong><strong class="hljs-slc"> {</strong></span> &#13;
               <span class="code-highlight"><strong class="hljs-slc">_itemsCollected = </strong><strong class="hljs-keyword-slc">value</strong><strong class="hljs-slc">;</strong></span> &#13;
               <span class="code-highlight"><strong class="hljs-slc">Debug.LogFormat(</strong><strong class="hljs-string-slc">"Items: {0}"</strong><strong class="hljs-slc">, _itemsCollected);</strong></span>&#13;
        <span class="code-highlight"><strong class="hljs-slc">}</strong></span>&#13;
    <span class="code-highlight"><strong class="hljs-slc">}</strong></span>&#13;
    <span class="code-highlight"><strong class="hljs-comment-slc">// 4</strong></span>&#13;
    <span class="code-highlight"><strong class="hljs-keyword-slc">public</strong><strong class="hljs-slc"> </strong><strong class="hljs-built_in-slc">int</strong><strong class="hljs-slc"> HP</strong></span> &#13;
    <span class="code-highlight"><strong class="hljs-slc">{</strong></span>&#13;
        <span class="code-highlight"><strong class="hljs-keyword-slc">get</strong><strong class="hljs-slc"> { </strong><strong class="hljs-keyword-slc">return</strong><strong class="hljs-slc"> _playerHP; }</strong></span>&#13;
        <span class="code-highlight"><strong class="hljs-keyword-slc">set</strong><strong class="hljs-slc"> {</strong></span> &#13;
               <span class="code-highlight"><strong class="hljs-slc">_playerHP = </strong><strong class="hljs-keyword-slc">value</strong><strong class="hljs-slc">;</strong></span> &#13;
               <span class="code-highlight"><strong class="hljs-slc">Debug.LogFormat(</strong><strong class="hljs-string-slc">"Lives: {0}"</strong><strong class="hljs-slc">, _playerHP);</strong></span>&#13;
         <span class="code-highlight"><strong class="hljs-slc">}</strong></span>&#13;
    <span class="code-highlight"><strong class="hljs-slc">}</strong></span>&#13;
} &#13;
</code></pre>&#13;
    <p class="normal">Let's break down the code, as follows:</p>&#13;
    <ol>&#13;
      <li class="numbered" value="1">We declare <a id="_idIndexMarker555"/>a new <code class="Code-In-Text--PACKT-">public</code> variable called <code class="Code-In-Text--PACKT-">Items</code> with <code class="Code-In-Text--PACKT-">get</code> and <code class="Code-In-Text--PACKT-">set</code> properties.</li>&#13;
      <li class="numbered">We use the <code class="Code-In-Text--PACKT-">get</code> property to <code class="Code-In-Text--PACKT-">return</code> the value stored in <code class="Code-In-Text--PACKT-">_itemsCollected</code> whenever <code class="Code-In-Text--PACKT-">Items</code> are <a id="_idIndexMarker556"/>accessed from an outside class.</li>&#13;
      <li class="numbered">We use the <code class="Code-In-Text--PACKT-">set</code> property to assign <code class="Code-In-Text--PACKT-">_itemsCollected</code> to the new <code class="Code-In-Text--PACKT-">value</code> of <code class="Code-In-Text--PACKT-">Items</code> whenever it's <a id="_idIndexMarker557"/>updated, with an added <code class="Code-In-Text--PACKT-">Debug.LogFormat()</code> call to print out the modified value of <code class="Code-In-Text--PACKT-">_itemsCollected</code>.</li>&#13;
      <li class="numbered">We set up a <code class="Code-In-Text--PACKT-">public</code> variable <a id="_idIndexMarker558"/>called <code class="Code-In-Text--PACKT-">HP</code> with <code class="Code-In-Text--PACKT-">get</code> and <code class="Code-In-Text--PACKT-">set</code> properties to complement the private <code class="Code-In-Text--PACKT-">_playerHP</code> backing variable.</li>&#13;
    </ol>&#13;
    <p class="normal">Both private variables are now readable, but only through their public counterparts; they can only be changed in <code class="Code-In-Text--PACKT-">GameBehavior</code>. With this setup, we ensure that our private data can only be accessed and modified from specific contact points. This makes it easier to communicate with <code class="Code-In-Text--PACKT-">GameBehavior</code> from our other mechanical scripts, as well as to display the real-time data in the simple UI we'll create at the end of the chapter.</p>&#13;
    <p class="normal">Let's test this out by updating the <code class="Code-In-Text--PACKT-">Items</code> property when we successfully interact with an item pickup in the arena.</p>&#13;
    <h2 id="_idParaDest-183" class="title">Updating item collection</h2>&#13;
    <p class="normal">Now that we have <a id="_idIndexMarker559"/>our variables set up in <code class="Code-In-Text--PACKT-">GameBehavior</code>, we can update <code class="Code-In-Text--PACKT-">Items</code> every <a id="_idIndexMarker560"/>time we collect an <code class="Code-In-Text--PACKT-">Item</code> in the scene, as follows:</p>&#13;
    <ol>&#13;
      <li class="numbered" value="1">Add the following highlighted code to the <code class="Code-In-Text--PACKT-">ItemBehavior</code> script:&#13;
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">ItemBehavior</span> : <span class="hljs-title">MonoBehaviour</span> &#13;
{&#13;
    <span class="code-highlight"><strong class="hljs-comment-slc">// 1</strong></span>&#13;
    <span class="code-highlight"><strong class="hljs-keyword-slc">public</strong><strong class="hljs-slc"> GameBehavior GameManager;</strong></span>&#13;
    <span class="code-highlight"><strong class="hljs-keyword-slc">void</strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc">Start</strong><strong class="hljs-slc">()</strong></span>&#13;
    <span class="code-highlight"><strong class="hljs-slc">{</strong></span>&#13;
          <span class="code-highlight"><strong class="hljs-comment-slc">// 2</strong></span>&#13;
          <span class="code-highlight"><strong class="hljs-slc">GameManager = GameObject.Find(</strong><strong class="hljs-string-slc">"Game_Manager"</strong><strong class="hljs-slc">).GetComponent&lt;GameBehavior&gt;();</strong></span>&#13;
    <span class="code-highlight"><strong class="hljs-slc">}</strong></span>&#13;
    <span class="hljs-keyword">void</span><span class="hljs-function"> </span><span class="hljs-title">OnCollisionEnter</span><span class="hljs-function">(</span><span class="hljs-params">Collision collision</span><span class="hljs-function">)</span>&#13;
    {&#13;
        <span class="hljs-keyword">if</span> (collision.gameObject.name == <span class="hljs-string">"Player"</span>)&#13;
        {&#13;
            Destroy(<span class="hljs-keyword">this</span>.transform.parent.gameObject);&#13;
            Debug.Log(<span class="hljs-string">"Item collected!"</span>);&#13;
            <span class="code-highlight"><strong class="hljs-comment-slc">// 3</strong></span>&#13;
            <span class="code-highlight"><strong class="hljs-slc">GameManager.Items += </strong><strong class="hljs-number-slc">1</strong><strong class="hljs-slc">;</strong></span>&#13;
        }&#13;
    }&#13;
} &#13;
</code></pre>&#13;
      </li>&#13;
      <li class="numbered">Hit play and collect the pickup item to see the new console log print out from the manager script, as illustrated in the following screenshot:<figure class="mediaobject"><img src="Images/B17573_08_09.png" alt="" width="751" height="571"/></figure>&#13;
      </li>&#13;
    </ol>&#13;
    <p class="packt_figref">Figure 8.9: Collecting a pickup item</p>&#13;
    <p class="normal">Let's break down the code, as follows:</p>&#13;
    <ol>&#13;
      <li class="numbered" value="1">We create <a id="_idIndexMarker561"/>a new variable of the <code class="Code-In-Text--PACKT-">GameBehavior</code> type to store <a id="_idIndexMarker562"/>a reference to the attached script.</li>&#13;
      <li class="numbered">We use <code class="Code-In-Text--PACKT-">Start()</code> to initialize <code class="Code-In-Text--PACKT-">GameManager</code> by looking it up in the scene with <code class="Code-In-Text--PACKT-">Find()</code> and adding a call to <code class="Code-In-Text--PACKT-">GetComponent()</code>.<div class="note">&#13;
          <p class="Information-Box--PACKT-">You'll see this kind of code done in a single line quite often in Unity documentation and community projects. This is done for simplicity, but if you feel more comfortable writing out the <code class="Code-In-Text--PACKT-">Find()</code> and <code class="Code-In-Text--PACKT-">GetComponent()</code> calls separately, go right ahead; there's nothing wrong with clear, explicit formatting.</p>&#13;
        </div>&#13;
      </li>&#13;
      <li class="numbered">We increment the <code class="Code-In-Text--PACKT-">Items</code> property in the <code class="Code-In-Text--PACKT-">GameManager</code> class in <code class="Code-In-Text--PACKT-">OnCollisionEnter()</code> after the Item Prefab is destroyed.</li>&#13;
    </ol>&#13;
    <p class="normal">Since we already set up <code class="Code-In-Text--PACKT-">ItemBehavior</code> to take care of collision logic, it's easy to modify <code class="Code-In-Text--PACKT-">OnCollisionEnter()</code> to communicate with our manager class when an item is picked up by the player. Keep <a id="_idIndexMarker563"/>in mind that separating functionality like this is what makes <a id="_idIndexMarker564"/>the code more flexible and less likely to break as you make changes during development.</p>&#13;
    <p class="normal">The last piece <em class="italic">Hero Born</em> is missing is some kind of interface that displays game data to the player. In programming and game development, this is called a UI. Your final task in this chapter is to familiarize yourself with how Unity creates and handles the UI code.</p>&#13;
    <h1 id="_idParaDest-184" class="title">Creating a GUI</h1>&#13;
    <p class="normal">At this point, we have several scripts working together to give players access to movement, jumping, collecting, and shooting mechanics. However, we're still missing any kind of display or visual <a id="_idIndexMarker565"/>cue that shows our player's stats, as well as a way to win and lose the game. We'll focus on these two topics as we close out this last section.</p>&#13;
    <h2 id="_idParaDest-185" class="title">Displaying player stats</h2>&#13;
    <p class="normal">UIs are the visual components of any computer system. The mouse cursor, folder icons, and programs on your <a id="_idIndexMarker566"/>laptop are all UI elements. For our game, we want a simple display to let our players know how many items they've collected, their current <a id="_idIndexMarker567"/>health, and a textbox to give them updates when certain events happen.</p>&#13;
    <p class="normal">UI elements in Unity can be added in the following two ways:</p>&#13;
    <ul>&#13;
      <li class="bullet">Directly from the <strong class="screenText">+</strong> menu in the <strong class="screenText">Hierarchy</strong> panel, like with any other GameObject</li>&#13;
      <li class="bullet">Using the built-in GUI class in code</li>&#13;
    </ul>&#13;
    <p class="normal">We're going to stick with the first option, since the built-in GUI classes are part of the Unity legacy UI system, and we want to stay current, right? This isn't to say that you can't do everything programmatically, but for our prototype, the newer UI systems are a better fit.</p>&#13;
    <div class="note">&#13;
      <p class="Information-Box--PACKT-">If you're curious <a id="_idIndexMarker568"/>about programmatic UI in Unity, take a look at the documentation yourself: <a href="https://docs.unity3d.com/ScriptReference/GUI.html"><span class="url">https://docs.unity3d.com/ScriptReference/GUI.html</span></a>.</p>&#13;
    </div>&#13;
    <p class="normal">Your next task is to add a simple UI to the game scene that displays the items collected, player health, and <a id="_idIndexMarker569"/>progress information variables that are stored in <code class="Code-In-Text--PACKT-">GameBehavior.cs</code>.</p>&#13;
    <p class="normal">First, let's create three text objects in our scene. User interfaces in Unity work off of a canvas, which is exactly <a id="_idIndexMarker570"/>what it sounds like. Think of the canvas as a blank painting that you can draw on that Unity will render on top of the game world for you. Whenever you create your first UI element in the <strong class="screenText">Hierarchy</strong> panel, a <strong class="screenText">Canvas</strong> parent object is created along with it. </p>&#13;
    <ol>&#13;
      <li class="numbered" value="1">Right-click in the <strong class="screenText">Hierarchy</strong> panel and select <strong class="screenText">UI</strong> | <strong class="screenText">Text</strong> and name the new object <strong class="screenText">Health</strong>. This will create a <strong class="screenText">Canvas</strong> parent object and the new <strong class="screenText">Text</strong> object all at once:<figure class="mediaobject"><img src="Images/B17573_08_10.png" alt="" width="751" height="588"/></figure>&#13;
        <p class="packt_figref">Figure 8.10: Creating a Text element</p>&#13;
      </li>&#13;
      <li class="numbered">To see the canvas correctly, select <strong class="screenText">2D</strong> mode at the top of the <strong class="screenText">Scene</strong> tab. From this view, our entire <a id="_idIndexMarker571"/>level is that tiny white line in the lower-left hand corner. <ul>&#13;
          <li class="bullet-l2">Even though <a id="_idIndexMarker572"/>the <strong class="screenText">Canvas</strong> and level don't overlap in the scene, when the game plays Unity will automatically overlay them correctly.</li>&#13;
        </ul>&#13;
        <figure class="mediaobject"><img src="Images/B17573_08_11.png" alt="" width="751" height="348"/></figure>&#13;
        <p class="packt_figref">Figure 8.11: Canvas in the Unity editor</p>&#13;
      </li>&#13;
      <li class="numbered">If you select the <strong class="screenText">Health</strong> object in the <strong class="screenText">Hierarchy</strong>, you'll see that the new text object was created in the lower-left corner of the canvas by default, and it has a whole list of customizable properties, like text and color, in the <strong class="screenText">Inspector</strong> pane:<figure class="mediaobject"><img src="Images/B17573_08_12.png" alt="" width="751" height="277"/></figure>&#13;
        <p class="packt_figref">Figure 8.12: Text element on the Unity Canvas</p>&#13;
      </li>&#13;
      <li class="numbered">With the <strong class="screenText">Health</strong> object selected in the <strong class="screenText">Hierarchy</strong> pane, click on the <strong class="screenText">Anchor </strong>presets in the <strong class="screenText">Rect Transform</strong> component of the <strong class="screenText">Inspector</strong> and choose <strong class="screenText">Top Left</strong>.<ul>&#13;
          <li class="bullet-l2">Anchors set a <a id="_idIndexMarker573"/>UI element's point of reference on <a id="_idIndexMarker574"/>the canvas, meaning that whatever the size of the device screen, our health points will always be anchored to the top left of the screen:</li>&#13;
        </ul>&#13;
        <figure class="mediaobject"><img src="Images/B17573_08_13.png" alt="" width="750" height="776"/></figure>&#13;
        <p class="packt_figref">Figure 8.13: Setting anchor presets</p>&#13;
      </li>&#13;
      <li class="numbered">In the <strong class="screenText">Inspector</strong> pane, change the <strong class="screenText">Rect Transform</strong> position to <strong class="screenText">100</strong> on the <strong class="screenText">X</strong> axis and <strong class="screenText">–30</strong> on <a id="_idIndexMarker575"/>the <strong class="screenText">Y</strong> axis to position the text in the upper-right corner. Also change the <strong class="screenText">Text</strong> property to say <strong class="screenText">Player Health:</strong>. We'll be setting <a id="_idIndexMarker576"/>the actual value in code in a later step:<figure class="mediaobject"><img src="Images/B17573_08_14.png" alt="" width="750" height="751"/></figure>&#13;
        <p class="packt_figref">Figure 8.14: Setting text properties</p>&#13;
      </li>&#13;
      <li class="numbered">Repeat steps 1-5 to create a new UI <strong class="screenText">Text</strong> object and name it <strong class="screenText">Items</strong>:<ul>&#13;
          <li class="bullet-l2">Set the anchor presets to <strong class="screenText">Top Left</strong>, the <strong class="screenText">Pos X</strong> to <strong class="screenText">100</strong>, and the <strong class="screenText">Pos Y</strong> to <strong class="screenText">–60</strong></li>&#13;
          <li class="bullet-l2">Set <strong class="screenText">Text</strong> to <strong class="screenText">Items Collected:</strong> </li>&#13;
        </ul>&#13;
        <figure class="mediaobject"><img src="Images/B17573_08_15.png" alt="" width="754" height="280"/></figure>&#13;
        <p class="packt_figref">Figure 8.15: Creating another Text element</p>&#13;
      </li>&#13;
      <li class="numbered">Repeat <em class="italic">steps 1-5</em> to create <a id="_idIndexMarker577"/>a new UI <strong class="screenText">Text</strong> object and name it <strong class="screenText">Progress</strong>:<ul>&#13;
          <li class="bullet-l2">Set the anchor <a id="_idIndexMarker578"/>presets to <strong class="screenText">Bottom Center</strong>, the <strong class="screenText">Pos X</strong> to <strong class="screenText">0</strong>, the <strong class="screenText">Pos Y</strong> to <strong class="screenText">15</strong>, and the <strong class="screenText">Width</strong> to <strong class="screenText">280</strong></li>&#13;
          <li class="bullet-l2">Set <strong class="screenText">Text</strong> to <strong class="screenText">Collect all the items and win your freedom!</strong></li>&#13;
        </ul>&#13;
        <figure class="mediaobject"><img src="Images/B17573_08_16.png" alt="" width="752" height="286"/></figure>&#13;
      </li>&#13;
    </ol>&#13;
    <p class="packt_figref">Figure 8.16: Creating a progress text element</p>&#13;
    <p class="normal">Now that we have our UI set up, let's connect the variables we already have in our game manager script. Proceed as follows:</p>&#13;
    <ol>&#13;
      <li class="numbered" value="1">Update <code class="Code-In-Text--PACKT-">GameBehavior</code> with <a id="_idIndexMarker579"/>the following code to collect an <a id="_idIndexMarker580"/>item and display on-screen text when items are collected:&#13;
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment">// 1</span>&#13;
<span class="hljs-keyword">using</span> UnityEngine.UI; &#13;
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">GameBehavior</span> : <span class="hljs-title">MonoBehaviour</span> &#13;
{&#13;
    <span class="hljs-comment">// 2</span>&#13;
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> MaxItems = <span class="hljs-number">4</span>;&#13;
    <span class="hljs-comment">// 3</span>&#13;
    <span class="hljs-keyword">public</span> Text HealthText;     &#13;
    <span class="hljs-keyword">public</span> Text ItemText;&#13;
    <span class="hljs-keyword">public</span> Text ProgressText;&#13;
    <span class="hljs-comment">// 4</span>&#13;
    <span class="hljs-keyword">void</span><span class="hljs-function"> </span><span class="hljs-title">Start</span><span class="hljs-function">()</span>&#13;
    { &#13;
        ItemText.text += _itemsCollected;&#13;
        HealthText.text += _playerHP;&#13;
    }&#13;
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">int</span> _itemsCollected = <span class="hljs-number">0</span>;&#13;
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> Items&#13;
    {&#13;
        <span class="hljs-keyword">get</span> { <span class="hljs-keyword">return</span> _itemsCollected; }&#13;
        <span class="hljs-keyword">set</span> { &#13;
            _itemsCollected = <span class="hljs-keyword">value</span>; &#13;
            <span class="code-highlight"><strong class="hljs-comment-slc">// 5</strong></span>&#13;
            ItemText.text = <span class="hljs-string">"Items Collected: "</span> + Items;&#13;
            <span class="hljs-comment">// 6</span>&#13;
            <span class="hljs-keyword">if</span>(_itemsCollected &gt;= MaxItems)&#13;
            {&#13;
                ProgressText.text = <span class="hljs-string">"You've found all the items!"</span>;&#13;
            } &#13;
            <span class="hljs-keyword">else</span>&#13;
            {&#13;
                ProgressText.text = <span class="hljs-string">"Item found, only "</span> + (MaxItems - _itemsCollected) + <span class="hljs-string">" more to go!"</span>;&#13;
            }&#13;
        }&#13;
    }&#13;
 &#13;
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">int</span> _playerHP = <span class="hljs-number">10</span>;&#13;
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> HP &#13;
    {&#13;
        <span class="hljs-keyword">get</span> { <span class="hljs-keyword">return</span> _playerHP; }&#13;
        <span class="hljs-keyword">set</span> { &#13;
            _playerHP = <span class="hljs-keyword">value</span>;&#13;
            <span class="hljs-comment">// 7</span>&#13;
            HealthText.text = <span class="hljs-string">"Player Health: "</span> + HP;&#13;
            Debug.LogFormat(<span class="hljs-string">"Lives: {0}"</span>, _playerHP);&#13;
        }&#13;
    }&#13;
} &#13;
</code></pre>&#13;
      </li>&#13;
      <li class="numbered">Select <strong class="screenText">Game_Manager</strong> in the <strong class="screenText">Hierarchy</strong> and drag over our three text objects one by one into <a id="_idIndexMarker581"/>their corresponding <code class="Code-In-Text--PACKT-">GameBehavior</code> script fields <a id="_idIndexMarker582"/>in the <strong class="screenText">Inspector</strong>:<figure class="mediaobject"><img src="Images/B17573_08_17.png" alt="" width="758" height="211"/></figure>&#13;
        <p class="packt_figref">Figure 8.17: Dragging text elements to script components</p>&#13;
      </li>&#13;
      <li class="numbered">Run the game and take <a id="_idIndexMarker583"/>a look at our new onscreen <a id="_idIndexMarker584"/>GUI boxes, shown in the following screenshot:<figure class="mediaobject"><img src="Images/B17573_08_18.png" alt="" width="751" height="454"/></figure>&#13;
      </li>&#13;
    </ol>&#13;
    <p class="packt_figref">Figure 8.18: Testing UI elements in play mode</p>&#13;
    <p class="normal">Let's break down the code, as follows:</p>&#13;
    <ol>&#13;
      <li class="numbered" value="1">We add the <code class="Code-In-Text--PACKT-">UnityEngine.UI</code> namespace so we have access to the <strong class="screenText">Text</strong> variable type.</li>&#13;
      <li class="numbered">We create a new public variable for the max number of items in the level.</li>&#13;
      <li class="numbered">We create three new <strong class="screenText">Text</strong> variables, which we connect in the <strong class="screenText">Inspector</strong> panel.</li>&#13;
      <li class="numbered">Then, we use the <code class="Code-In-Text--PACKT-">Start</code> method to set the initial values of our health and items text using the <strong class="screenText">+=</strong> operator.</li>&#13;
      <li class="numbered">Every time an item is collected, we update the <code class="Code-In-Text--PACKT-">text</code> property of <strong class="screenText">ItemText</strong> to show the updated <code class="Code-In-Text--PACKT-">items</code> count.</li>&#13;
      <li class="numbered">We declare an <code class="Code-In-Text--PACKT-">if</code> statement in the set property of <code class="Code-In-Text--PACKT-">_itemsCollected</code>.<ul>&#13;
          <li class="bullet-l2">If the player has gathered more than or equal to <code class="Code-In-Text--PACKT-">MaxItems</code>, they've won, and <code class="Code-In-Text--PACKT-">ProgressText.text</code> is updated.</li>&#13;
          <li class="bullet-l2">Otherwise, <code class="Code-In-Text--PACKT-">ProgressText.text</code> shows how many items are still left to collect.</li>&#13;
        </ul>&#13;
      </li>&#13;
      <li class="numbered">Every time the player's health is damaged, which we'll cover in the next chapter, we update the <code class="Code-In-Text--PACKT-">text</code> property of <code class="Code-In-Text--PACKT-">HealthText</code> with the new value.</li>&#13;
    </ol>&#13;
    <p class="normal">When we play the <a id="_idIndexMarker585"/>game now, our three UI elements show up with the <a id="_idIndexMarker586"/>correct values; when an Item is collected, the <code class="Code-In-Text--PACKT-">ProgressText</code> and <code class="Code-In-Text--PACKT-">_itemsCollected</code> counts update, as illustrated in the following screenshot:</p>&#13;
    <figure class="mediaobject"><img src="Images/B17573_08_19.png" alt="" width="828" height="464"/></figure>&#13;
    <p class="packt_figref">Figure 8.19: Updating the UI text</p>&#13;
    <p class="normal">Every game can either be won or lost. In the last section of this chapter, your task is to implement those conditions and the UI that goes along with them.</p>&#13;
    <h2 id="_idParaDest-186" class="title">Win and loss conditions</h2>&#13;
    <p class="normal">We've implemented our core game mechanics and a simple UI, but <em class="italic">Hero Born</em> is still missing an important <a id="_idIndexMarker587"/>game design element: its win and loss conditions. These conditions will manage how the player wins or loses the game and execute <a id="_idIndexMarker588"/>different code depending on the situation.</p>&#13;
    <p class="normal">Back in the game document from <em class="chapterRef">Chapter 6</em>, <em class="italic">Getting Your Hands Dirty with Unity</em>, we set out our win and loss conditions as follows:</p>&#13;
    <ul>&#13;
      <li class="bullet">Collecting all items in the level with at least 1 health point remaining to win</li>&#13;
      <li class="bullet">Taking damage from enemies until health points are at 0 to lose</li>&#13;
    </ul>&#13;
    <p class="normal">These conditions are going to affect both our UI and game mechanics, but we've already set up <code class="Code-In-Text--PACKT-">GameBehavior</code> to handle <a id="_idIndexMarker589"/>this efficiently. Our <code class="Code-In-Text--PACKT-">get</code> and <code class="Code-In-Text--PACKT-">set</code> properties will handle any game-related logic and changes to the UI when a player wins or loses.</p>&#13;
    <p class="normal">We're going to implement <a id="_idIndexMarker590"/>the win condition logic in this section because we have the pickup system already in place. When we get to the enemy AI behavior in the next chapter, we'll add in the loss condition logic. Your next task is to determine when the game is won in code.</p>&#13;
    <p class="normal">We always want to give players clear and immediate feedback, so we'll start by adding in the logic for a win condition, as follows:</p>&#13;
    <ol>&#13;
      <li class="numbered" value="1">Update <code class="Code-In-Text--PACKT-">GameBehavior</code> to match the following code:&#13;
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">GameBehavior</span> : <span class="hljs-title">MonoBehaviour</span> &#13;
{ &#13;
    <span class="code-highlight"><strong class="hljs-comment-slc">// 1</strong></span>&#13;
    <span class="code-highlight"><strong class="hljs-keyword-slc">public</strong><strong class="hljs-slc"> Button WinButton;</strong></span>&#13;
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">int</span> _itemsCollected = <span class="hljs-number">0</span>;&#13;
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> Items&#13;
    {&#13;
        <span class="hljs-keyword">get</span> { <span class="hljs-keyword">return</span> _itemsCollected; }&#13;
        <span class="hljs-keyword">set</span>&#13;
        {&#13;
            _itemsCollected = <span class="hljs-keyword">value</span>;&#13;
            ItemText.text = <span class="hljs-string">"Items Collected: "</span> + Items;&#13;
 &#13;
            <span class="hljs-keyword">if</span> (_itemsCollected &gt;= MaxItems)&#13;
            {&#13;
                ProgressText.text = <span class="hljs-string">"You've found all the items!"</span>;&#13;
          &#13;
                <span class="code-highlight"><strong class="hljs-comment-slc">// 2</strong></span>&#13;
                <span class="code-highlight"><strong class="hljs-slc">WinButton.gameObject.SetActive(</strong><strong class="hljs-literal-slc">true</strong><strong class="hljs-slc">);</strong></span>&#13;
            }&#13;
            <span class="hljs-keyword">else</span>&#13;
            {&#13;
                ProgressText.text = <span class="hljs-string">"Item found, only "</span> + (MaxItems - _itemsCollected) + <span class="hljs-string">" more to go!"</span>;&#13;
            }&#13;
        }&#13;
    }&#13;
}&#13;
</code></pre>&#13;
      </li>&#13;
      <li class="numbered">Right-click in the <strong class="screenText">Hierarchy</strong> and <a id="_idIndexMarker591"/>select <strong class="screenText">UI</strong> | <strong class="screenText">Button</strong>, then <a id="_idIndexMarker592"/>name it <strong class="screenText">Win Condition</strong>:<ul>&#13;
          <li class="bullet-l2">Select <strong class="screenText">Win Condition</strong> and set the <strong class="screenText">Pos X</strong> and <strong class="screenText">Pos Y</strong> to <strong class="screenText">0</strong>, its <strong class="screenText">Width</strong> to <strong class="screenText">225</strong>, and its <strong class="screenText">Height</strong> to <strong class="screenText">115</strong>.</li>&#13;
        </ul>&#13;
        <figure class="mediaobject"><img src="Images/B17573_08_20.png" alt="" width="752" height="352"/></figure>&#13;
        <p class="packt_figref">Figure 8.20: Creating a UI button</p>&#13;
      </li>&#13;
      <li class="numbered">Click on the arrow to the right of the <strong class="screenText">Win Condition </strong>button to expand its text child object, then change the text to say <strong class="screenText">You won!</strong>:<figure class="mediaobject"><img src="Images/B17573_08_21.png" alt="" width="751" height="239"/></figure>&#13;
        <p class="packt_figref">Figure 8.21: Updating button text </p>&#13;
      </li>&#13;
      <li class="numbered">Select <a id="_idIndexMarker593"/>the <strong class="screenText">Win Condition</strong> parent object again and click the checkmark icon in the upper <a id="_idIndexMarker594"/>right of the <strong class="screenText">Inspector</strong>.<figure class="mediaobject"><img src="Images/B17573_08_22.png" alt="" width="750" height="453"/></figure>&#13;
        <p class="packt_figref">Figure 8.22: Deactivating the game object</p>&#13;
        <p class="bullet-para">This will hide the button until we've won the game:</p>&#13;
        <figure class="mediaobject"><img src="Images/B17573_08_23.png" alt="" width="752" height="353"/></figure>&#13;
        <p class="packt_figref">Figure 8.23: Testing the hidden UI button</p>&#13;
      </li>&#13;
      <li class="numbered">Select <strong class="screenText">Game_Manager</strong> in <a id="_idIndexMarker595"/>the <strong class="screenText">Hierarchy</strong> and drag the <strong class="screenText">Win Condition</strong> button <a id="_idIndexMarker596"/>from the <strong class="screenText">Hierarchy</strong> to the <strong class="screenText">Game Behavior (Script)</strong> in the <strong class="screenText">Inspector</strong>, just like we did with the text objects:<figure class="mediaobject"><img src="Images/B17573_08_24.png" alt="" width="751" height="549"/></figure>&#13;
        <p class="packt_figref">Figure 8.24: Dragging the UI button onto the script component</p>&#13;
      </li>&#13;
      <li class="numbered">Change <strong class="screenText">Max Items</strong> to <code class="Code-In-Text--PACKT-">1</code> in <a id="_idIndexMarker597"/>the <strong class="screenText">Inspector</strong> to test out the <a id="_idIndexMarker598"/>new screen, as illustrated in the following screenshot:<figure class="mediaobject"><img src="Images/B17573_08_25.png" alt="" width="751" height="435"/></figure>&#13;
    <p class="packt_figref">Figure 8.25: Showing the win screen</p>&#13;
      </li>&#13;
    </ol>&#13;
&#13;
    <p class="normal">Let's break down the code, as follows:</p>&#13;
    <ol>&#13;
      <li class="numbered" value="1">We created a UI button <a id="_idIndexMarker599"/>variable to connect to our Win Condition button in the <strong class="screenText">Hierarchy</strong>.</li>&#13;
      <li class="numbered">Since we set <a id="_idIndexMarker600"/>the Win Condition button as <strong class="screenText">Hidden</strong> when the game starts, we reactivate it when the game is won.</li>&#13;
    </ol>&#13;
    <p class="normal">With <strong class="screenText">Max Items</strong> set to <code class="Code-In-Text--PACKT-">1</code>, the <strong class="screenText">Win</strong> button will show up on collecting the only <code class="Code-In-Text--PACKT-">Pickup_Item</code> in the scene. Clicking the button doesn't do anything right now, but we'll address that in the following section.</p>&#13;
    <h2 id="_idParaDest-187" class="title">Pausing and restarting the game with using directives and namespaces</h2>&#13;
    <p class="normal">Right now, our <a id="_idIndexMarker601"/>win condition works as expected, but the <a id="_idIndexMarker602"/>player still has control over the capsule and doesn't <a id="_idIndexMarker603"/>have a way of restarting the game once it's over. Unity provides a property in the <code class="Code-In-Text--PACKT-">Time</code> class called <code class="Code-In-Text--PACKT-">timeScale</code>, which <a id="_idIndexMarker604"/>when set to <code class="Code-In-Text--PACKT-">0</code> freezes the game scene. However, to restart the game, we need access to a <strong class="keyword">namespace</strong> called <code class="Code-In-Text--PACKT-">SceneManagement</code> that isn't accessible from our classes by default.</p>&#13;
    <p class="normal">A namespace collects <a id="_idIndexMarker605"/>and groups a set of classes under a <a id="_idIndexMarker606"/>specific name to organize large projects <a id="_idIndexMarker607"/>and avoid conflicts between scripts that may share the same names. A <code class="Code-In-Text--PACKT-">using</code> directive needs to be added to a class to access a <a id="_idIndexMarker608"/>namespace's classes.</p>&#13;
    <p class="normal">All C# scripts created from Unity come with three default <code class="Code-In-Text--PACKT-">using</code> directives, shown in the following code snippet:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">using</span> System.Collections;&#13;
<span class="hljs-keyword">using</span> System.Collections.Generic;&#13;
<span class="hljs-keyword">using</span> UnityEngine;&#13;
</code></pre>&#13;
    <p class="normal">These allow access to common namespaces, but Unity and C# offer plenty more that can be added with the <code class="Code-In-Text--PACKT-">using</code> keyword followed by the name of the namespace.</p>&#13;
    <p class="normal">Since our game will need to be paused and restarted when a player wins or loses, this is a good time to use a namespace that isn't included in new C# scripts by default.</p>&#13;
    <ol>&#13;
      <li class="numbered" value="1">Add the following code to <code class="Code-In-Text--PACKT-">GameBehavior</code> and play:&#13;
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">using</span> System.Collections;&#13;
<span class="hljs-keyword">using</span> System.Collections.Generic;&#13;
<span class="hljs-keyword">using</span> UnityEngine;&#13;
<span class="hljs-keyword">using</span> UnityEngine.UI;&#13;
<span class="code-highlight"><strong class="hljs-comment-slc">// 1</strong></span>&#13;
<span class="code-highlight"><strong class="hljs-keyword-slc">using</strong><strong class="hljs-slc"> UnityEngine.SceneManagement;</strong></span>&#13;
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">GameBehavior</span> : <span class="hljs-title">MonoBehaviour</span> &#13;
{&#13;
    <span class="hljs-comment">// ... No changes needed ...</span>&#13;
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">int</span> _itemsCollected = <span class="hljs-number">0</span>;&#13;
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> Items&#13;
    {&#13;
        <span class="hljs-keyword">get</span> { <span class="hljs-keyword">return</span> _itemsCollected; }&#13;
        <span class="hljs-keyword">set</span> { &#13;
            _itemsCollected = <span class="hljs-keyword">value</span>;&#13;
 &#13;
            <span class="hljs-keyword">if</span> (_itemsCollected &gt;= MaxItems)&#13;
            {&#13;
                ProgressText.text = <span class="hljs-string">"You've found all the items!"</span>;&#13;
                WinButton.gameObject.SetActive(<span class="hljs-literal">true</span>);&#13;
                &#13;
                <span class="code-highlight"><strong class="hljs-comment-slc">// 2</strong></span>&#13;
                <span class="code-highlight"><strong class="hljs-slc">Time.timeScale = </strong><strong class="hljs-number-slc">0f</strong><strong class="hljs-slc">;</strong></span>&#13;
            }&#13;
            <span class="hljs-keyword">else</span>&#13;
            {&#13;
                ProgressText.text= <span class="hljs-string">"Item found, only "</span> + (MaxItems – _itemsCollected) + <span class="hljs-string">" more to go!"</span>;&#13;
            }&#13;
        }&#13;
    }&#13;
    <span class="code-highlight"><strong class="hljs-keyword-slc">public</strong><strong class="hljs-function-slc"> </strong><strong class="hljs-keyword-slc">void</strong><strong class="hljs-function-slc"> </strong><strong class="hljs-title-slc">RestartScene</strong><strong class="hljs-function-slc">()</strong></span>&#13;
    <span class="code-highlight"><strong class="hljs-slc">{</strong></span>&#13;
        <span class="code-highlight"><strong class="hljs-comment-slc">// 3</strong></span>&#13;
        <span class="code-highlight"><strong class="hljs-slc">SceneManager.LoadScene(</strong><strong class="hljs-number-slc">0</strong><strong class="hljs-slc">);</strong></span>&#13;
        <span class="code-highlight"><strong class="hljs-comment-slc">// 4</strong></span>&#13;
        <span class="code-highlight"><strong class="hljs-slc">Time.timeScale = </strong><strong class="hljs-number-slc">1f</strong><strong class="hljs-slc">;</strong></span>&#13;
    <span class="code-highlight"><strong class="hljs-slc">}</strong></span>&#13;
 &#13;
    <span class="hljs-comment">// ... No other changes needed ...</span>&#13;
}&#13;
</code></pre>&#13;
      </li>&#13;
      <li class="numbered">Select <strong class="screenText">Win Condition</strong> from the <strong class="screenText">Hierarchy</strong>, scroll down in the <strong class="screenText">Inspector</strong> to the <strong class="screenText">OnClick</strong> section <a id="_idIndexMarker609"/>of the <strong class="screenText">Button</strong> component, and hit the plus icon:<ul>&#13;
          <li class="bullet-l2">Every UI <a id="_idIndexMarker610"/>button has an <strong class="screenText">OnClick</strong> event, which means you can assign a method from a script to execute <a id="_idIndexMarker611"/>when the button is pushed.</li>&#13;
          <li class="bullet-l2">You can <a id="_idIndexMarker612"/>have multiple methods fire when a button is clicked, but we only need one in this case:</li>&#13;
        </ul>&#13;
        <figure class="mediaobject"><img src="Images/B17573_08_26.png" alt="" width="751" height="826"/></figure>&#13;
        <p class="packt_figref">Figure 8.26: OnClick section of the button</p>&#13;
      </li>&#13;
      <li class="numbered">From <a id="_idIndexMarker613"/>the <strong class="screenText">Hierarchy</strong>, drag the <strong class="screenText">Game_Manager</strong> into <a id="_idIndexMarker614"/>the slot underneath <strong class="screenText">Runtime</strong> to tell <a id="_idIndexMarker615"/>the button we want to choose a <a id="_idIndexMarker616"/>method from our manager script to fire when the button is pushed: <figure class="mediaobject"><img src="Images/B17573_08_27.png" alt="" width="750" height="184"/></figure>&#13;
        <p class="packt_figref">Figure 8.27: Setting the game manager object in On Click</p>&#13;
      </li>&#13;
      <li class="numbered">Select <a id="_idIndexMarker617"/>the <strong class="screenText">No Function</strong> dropdown and <a id="_idIndexMarker618"/>choose <strong class="screenText">GameBehavior</strong> | <strong class="screenText">RestartScene ()</strong> to set <a id="_idIndexMarker619"/>the method we want the <a id="_idIndexMarker620"/>button to execute:<figure class="mediaobject"><img src="Images/B17573_08_28.png" alt="" width="751" height="590"/></figure>&#13;
        <p class="packt_figref">Figure 8.28: Choosing the restart method for the button click</p>&#13;
      </li>&#13;
      <li class="numbered">Go <a id="_idIndexMarker621"/>to <strong class="screenText">Window</strong> | <strong class="screenText">Rendering</strong> | <strong class="screenText">Lighting</strong> and <a id="_idIndexMarker622"/>select <strong class="screenText">Generate Lighting</strong> at the <a id="_idIndexMarker623"/>bottom. Make sure <strong class="screenText">Auto Generate</strong> is not selected:</li>&#13;
    </ol>&#13;
    <div class="note">&#13;
      <p class="Information-Box--PACKT-">This step is necessary to address a Unity issue that reloads scenes without any lighting.</p>&#13;
    </div>&#13;
    <figure class="mediaobject"><img src="Images/B17573_08_29.png" alt="" width="658" height="595"/></figure>&#13;
    <p class="packt_figref">Figure 8.29: Lighting panel in the Unity editor</p>&#13;
    <p class="normal">Let's break <a id="_idIndexMarker624"/>down the code, as follows:</p>&#13;
    <ol>&#13;
      <li class="numbered" value="1">We add the <code class="Code-In-Text--PACKT-">SceneManagement</code> namespace with the <code class="Code-In-Text--PACKT-">using</code> keyword, which handles all <a id="_idIndexMarker625"/>scene-related logic like creating loading scenes.</li>&#13;
      <li class="numbered">We set <code class="Code-In-Text--PACKT-">Time.timeScale</code> to <code class="Code-In-Text--PACKT-">0</code> to pause the game when the win screen is displayed, which <a id="_idIndexMarker626"/>disables any input or movement.</li>&#13;
      <li class="numbered">We create a new <a id="_idIndexMarker627"/>method called <code class="Code-In-Text--PACKT-">RestartScene</code> and call <code class="Code-In-Text--PACKT-">LoadScene()</code> when the win screen button is clicked:<ul>&#13;
          <li class="bullet-l2"><code class="Code-In-Text--PACKT-">LoadScene()</code> takes <a id="_idIndexMarker628"/>in a scene index as an <code class="Code-In-Text--PACKT-">int</code> parameter.</li>&#13;
          <li class="bullet-l2">Because there is only one scene in our project, we use index <code class="Code-In-Text--PACKT-">0</code> to restart the game from the beginning.</li>&#13;
        </ul>&#13;
      </li>&#13;
      <li class="numbered">We reset <code class="Code-In-Text--PACKT-">Time.timeScale</code> to the default value of <code class="Code-In-Text--PACKT-">1</code> so that when the scene restarts, all controls and behaviors will be able to execute again.</li>&#13;
    </ol>&#13;
    <p class="normal">Now, when you collect an item and click on the win screen button, the level restarts, with all scripts and components restored to their original values and set up for another round!</p>&#13;
    <h1 id="_idParaDest-188" class="title">Summary</h1>&#13;
    <p class="normal">Congratulations! <em class="italic">Hero Born</em> is now a playable prototype. We implemented jumping and shooting mechanics, managed physics collisions and spawning objects, and added in a few basic UI elements to display feedback. We even got as far as resetting the level when the player wins.</p>&#13;
    <p class="normal">A lot of new topics were introduced in this chapter, and it's important to go back and make sure you understand what went into the code we wrote. Pay special attention to our discussions on enumerations, <code class="Code-In-Text--PACKT-">get</code> and <code class="Code-In-Text--PACKT-">set</code> properties, and namespaces. From here on in, the code is only going to get more complex as we dive further into the possibilities of the C# language.</p>&#13;
    <p class="normal">In the next chapter, we'll start working on getting our enemy GameObjects to take notice of our player when we get too close, resulting in a follow-and-shoot protocol that will up the stakes for our player.</p>&#13;
    <h1 id="_idParaDest-189" class="title">Pop quiz – working with mechanics</h1>&#13;
    <ol>&#13;
      <li class="numbered" value="1">What type of data do enumerations store?</li>&#13;
      <li class="numbered">How would you create a copy of a Prefab GameObject in an active scene?</li>&#13;
      <li class="numbered">Which variable properties allow you to add functionality when their value is referenced or modified?</li>&#13;
      <li class="numbered">Which Unity method displays all UI objects in the scene?</li>&#13;
    </ol>&#13;
    <h1 class="heading-1">JOIN us on Discord!</h1>&#13;
    <p class="normal">Read this book alongside other users, Unity/C# experts, and Harrison Ferrone. Ask questions, provide solutions to other readers, chat with the author via <em class="italic">Ask Me Anything sessions</em> and much more.</p>&#13;
<p class="normal">Join Now! </p>&#13;
    <p class="normal"><a href="https://packt.link/csharpunity2021"><span class="url">https://packt.link/csharpunity2021</span></a></p>&#13;
    <p class="normal"><span class="url"><img style="height: 8em; width: auto;" src="Images/QR_Code_9781801813945.png" alt="" width="354" height="354"/></span></p>&#13;
  </div>&#13;
</div></body></html>