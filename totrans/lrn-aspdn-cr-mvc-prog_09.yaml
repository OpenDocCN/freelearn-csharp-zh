- en: Chapter 9. Deployment of ASP.NET Core Application
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第9章。ASP.NET Core应用程序的部署
- en: Once we have completed the development for our ASP.NET core application, we
    need to deploy the application so that it can be accessed by our users.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦我们完成了我们的ASP.NET core应用程序的开发，我们需要部署应用程序，以便用户可以访问它。
- en: In any application, irrespective of whether it is the web, desktop, or mobile
    application, not all the functionalities have been achieved through code. In fact,
    you should not try to achieve everything through code.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在任何应用程序中，无论它是Web、桌面还是移动应用程序，并不是所有的功能都是通过代码实现的。实际上，你不应该试图通过代码实现所有功能。
- en: 'In this chapter, you are going to learn about the following topics:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，你将学习以下主题：
- en: Configuration in the ASP.NET Core application
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ASP.NET Core应用程序的配置
- en: Signing up to the Microsoft Azure platform
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在Microsoft Azure平台上注册
- en: Deploying the ASP.NET Core application to the Azure Cloud platform
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将ASP.NET Core应用程序部署到Azure云平台
- en: 'If you have built a web application using any of the previous versions of ASP.NET
    MVC, there will be a file by the name of `Web.config` (an XML file) where you
    can configure all the dependencies for your application. But in ASP.NET Core,
    there will be no `Web.config` file in your solution:'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你使用任何之前的ASP.NET MVC版本构建了Web应用程序，将有一个名为`Web.config`（一个XML文件）的文件，你可以在此配置应用程序的所有依赖项。但在ASP.NET
    Core中，你的解决方案中将没有`Web.config`文件：
- en: '![Deployment of ASP.NET Core Application](img/Image00131.jpg)'
  id: totrans-8
  prefs: []
  type: TYPE_IMG
  zh: '![ASP.NET Core应用程序的部署](img/Image00131.jpg)'
- en: Instead, we have `project.json` (a JSON file), where we will configure the dependencies
    for your application. Before discussing the contents of `project.json` , let us
    discuss a bit about JSON.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 相反，我们有`project.json`（一个JSON文件），其中我们将配置应用程序的依赖项。在讨论`project.json`的内容之前，让我们先简单谈谈JSON。
- en: 'JSON is an acronym of **JavaScript Object Notation** . It is the open standard
    data exchange format. It will be in human-readable text and consist of attribute/value
    pairs. Consider the following JSON, and let''s dissect it to see what it represents:'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: JSON是**JavaScript对象表示法**的缩写。它是一个开放标准的数据交换格式。它将以人类可读的文本形式存在，并包含属性/值对。考虑以下JSON，让我们分析一下它代表什么：
- en: '[PRE0]'
  id: totrans-11
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Each piece of data is an attribute value pair, separated by a colon. For example,
    `"DoorNo": 16` tells that the value for `DoorNo` variable is 16 in the first record.
    Each attribute value pair (sometimes called a property) is separated by a comma.
    For example, consider the following three properties:'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: '每个数据项都是一个属性值对，由冒号分隔。例如，`"DoorNo": 16`表示第一条记录中`DoorNo`变量的值为16。每个属性值对（有时称为属性）由逗号分隔。例如，考虑以下三个属性：'
- en: '[PRE1]'
  id: totrans-13
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Each record or object is contained within a pair of curly braces. For example,
    the following JSON data represents a record or an object:'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 每条记录或对象都包含在一对花括号内。例如，以下JSON数据代表一条记录或一个对象：
- en: '[PRE2]'
  id: totrans-15
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'Similar records can be grouped together and could be formed as an array (of
    objects). Square brackets are used to represent the array in JSON format as in
    the following example:'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 相似的记录可以分组在一起，并可以形成一个数组（对象数组）。在以下示例中，使用方括号表示JSON格式中的数组：
- en: '[PRE3]'
  id: totrans-17
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'If we have to represent the same data in XML format, you can do so as follows.
    Please note that for each piece of information, we should have a start tag and
    an end tag (ends with "`/` "):'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们需要以XML格式表示相同的数据，可以这样做。请注意，对于每条信息，我们都应该有一个开始标签和一个结束标签（以"`/`"结尾）：
- en: '[PRE4]'
  id: totrans-19
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: The project.json file
  id: totrans-20
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '`project.json`文件'
- en: 'All of the project configuration should go into the `project.json` file for
    the ASP.NET Core application. The following is the `project.json` file that was
    created when using the predefined ASP.NET Core web application template:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 所有项目配置都应该放入ASP.NET Core应用程序的`project.json`文件中。以下是在使用预定义的ASP.NET Core Web应用程序模板时创建的`project.json`文件：
- en: '![The project.json file](img/Image00132.jpg)'
  id: totrans-22
  prefs: []
  type: TYPE_IMG
  zh: '![`project.json`文件](img/Image00132.jpg)'
- en: There are different predefined nodes in this JSON file for different functionalities.
    Let us take some important nodes in this `project.json` file and discuss them.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个JSON文件中，针对不同的功能有不同的预定义节点。让我们讨论一下`project.json`文件中的一些重要节点。
- en: The dependencies node
  id: totrans-24
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '`dependencies`节点'
- en: The `dependencies` node lists all the dependencies for your ASP.NET Core application.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: '`dependencies`节点列出了你的ASP.NET Core应用程序的所有依赖项。'
- en: 'The following is a fragment of the `dependencies` node in the ASP.NET Core
    application. Each dependency is an attribute value pair where the attribute represents
    the dependency and the value represents the version of the dependency. If you
    need to provide more information for the dependency, you can have a nested JSON
    configuration as it is in `Microsoft.NETCore.App` :'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是在ASP.NET Core应用程序中的`dependencies`节点的片段。每个依赖项都是一个属性值对，其中属性代表依赖项，值代表依赖项的版本。如果您需要为依赖项提供更多信息，您可以使用嵌套JSON配置，就像在`Microsoft.NETCore.App`中那样：
- en: '[PRE5]'
  id: totrans-27
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: The frameworks node
  id: totrans-28
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 框架节点
- en: 'In this node, we mention the frameworks that we depend on for the ASP.NET Core
    application. `dotnet5.6` represents the full blown .NET framework and `dnxcore50`
    represents the .NET Core framework containing the subset of functionalities of
    the complete .NET framework:'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 在此节点中，我们提到了我们依赖的ASP.NET Core应用程序的框架。`dotnet5.6`代表完整的.NET框架，而`dnxcore50`代表包含完整.NET框架子集功能的.NET
    Core框架：
- en: '[PRE6]'
  id: totrans-30
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Microsoft Azure
  id: totrans-31
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 微软Azure
- en: Microsoft Azure is a cloud computing platform and infrastructure from Microsoft
    for building, deploying, and managing applications and services. It supports different
    programming languages and arrays of services.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 微软Azure是微软提供的云计算平台和基础设施，用于构建、部署和管理应用程序和服务。它支持不同的编程语言和服务数组。
- en: You can deploy your application in any server with **Internet Information Service**
    ( **IIS** ) in your network. But this restricts your application to being accessed
    only from within your network, assuming your server could only be accessed from
    within your network (as in most network setups). In this section, we are going
    to deploy the ASP.NET Core application in Microsoft Azure so that your users across
    the globe can access your application.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以将应用程序部署到任何具有您网络中**互联网信息服务**（**IIS**）的服务器上。但这将限制您的应用程序只能从您的网络内部访问，假设您的服务器只能从您的网络内部访问（如大多数网络设置）。在本节中，我们将部署ASP.NET
    Core应用程序到微软Azure，以便您的全球用户可以访问您的应用程序。
- en: Signing up to Microsoft Azure
  id: totrans-34
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 注册微软Azure
- en: 'In order for your application to be deployed to Azure, you need to have an
    account with Azure. You can create an Azure account for free and you''ll have
    sufficient credits to deploy your application for free within the first 30 days
    ( [https://azure.microsoft.com/en-in/](https://azure.microsoft.com/en-in/) ):'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 为了将您的应用程序部署到Azure，您需要有一个Azure账户。您可以免费创建一个Azure账户，并在前30天内有足够的信用额度免费部署您的应用程序（[https://azure.microsoft.com/en-in/](https://azure.microsoft.com/en-in/)）：
- en: '![Signing up to Microsoft Azure](img/Image00133.jpg)'
  id: totrans-36
  prefs: []
  type: TYPE_IMG
  zh: '![注册微软Azure](img/Image00133.jpg)'
- en: 'Click the **Try for free** button or **Free Account** link in the top right-hand
    corner and you''ll be forwarded to the following page:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 点击**免费试用**按钮或右上角的**免费账户**链接，您将被重定向到以下页面：
- en: '![Signing up to Microsoft Azure](img/Image00134.jpg)'
  id: totrans-38
  prefs: []
  type: TYPE_IMG
  zh: '![注册微软Azure](img/Image00134.jpg)'
- en: 'Click the **Start now** button and you''ll be redirected to the following page.
    Enter your Microsoft account credentials and click the **Sign In** button. If
    you don''t have a Microsoft account, you can create one by clicking on the  **sign
    up now** link at the bottom of the page:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 点击**立即开始**按钮，您将被重定向到以下页面。输入您的微软账户凭据并点击**登录**按钮。如果您没有微软账户，您可以通过点击页面底部的**立即注册**链接来创建一个：
- en: '![Signing up to Microsoft Azure](img/Image00135.jpg)'
  id: totrans-40
  prefs: []
  type: TYPE_IMG
  zh: '![注册微软Azure](img/Image00135.jpg)'
- en: 'As I have a Microsoft account already, I have signed in with my credentials.
    Once you have signed-in, you will be asked for details about your country, first
    name, second name, and your work phone, as follows:'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我已经有一个微软账户，我已经用我的凭据登录。一旦您登录，您将需要提供有关您的国家、名字、姓氏和您的办公电话的详细信息，如下所示：
- en: '![Signing up to Microsoft Azure](img/Image00136.jpg)'
  id: totrans-42
  prefs: []
  type: TYPE_IMG
  zh: '![注册微软Azure](img/Image00136.jpg)'
- en: 'Once you have entered all the necessary details, you will be asked for your
    country code and phone number so that Azure can text you or call you to verify
    you are a real person and not a robot ![Signing up to Microsoft Azure](img/Image00071.jpg)
    . If you choose the option of **text me** , you will get a code to your mobile
    phone; you need to enter it in the last field and click **Verify Code** :'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦您输入了所有必要的详细信息，您将需要提供您的国家代码和电话号码，以便Azure可以通过短信或电话验证您是一个真实的人，而不是机器人 ![注册微软Azure](img/Image00071.jpg)
    。如果您选择**短信给我**选项，您将收到一个手机短信中的验证码；您需要在最后一个字段中输入它并点击**验证码**：
- en: '![Signing up to Microsoft Azure](img/Image00137.jpg)'
  id: totrans-44
  prefs: []
  type: TYPE_IMG
  zh: '![注册微软Azure](img/Image00137.jpg)'
- en: 'Once you have been verified by phone, you need to enter your credit card information
    in the following form. You''ll be billed for approximately $1 and it will be refunded
    within five to six business days back to your account. This information is collected
    to identify the user''s identity and the user will not be billed unless the user
    explicitly opted for the paid service:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦通过电话验证，您需要在以下表单中输入您的信用卡信息。您将被收取大约 1 美元的费用，并在五到六个工作日内退还到您的账户。收集此信息是为了识别用户的身份，除非用户明确选择了付费服务，否则不会向用户收费：
- en: '![Signing up to Microsoft Azure](img/Image00138.jpg)'
  id: totrans-46
  prefs: []
  type: TYPE_IMG
  zh: '![注册 Microsoft Azure](img/Image00138.jpg)'
- en: 'Once you enter your credit card information and click **Next** , you will have
    to agree to the subscription agreement as the final step in the sign-up process:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦输入您的信用卡信息并点击**下一步**，您将需要在注册过程的最后一步同意订阅协议：
- en: '![Signing up to Microsoft Azure](img/Image00139.jpg)'
  id: totrans-48
  prefs: []
  type: TYPE_IMG
  zh: '![注册 Microsoft Azure](img/Image00139.jpg)'
- en: 'Once you click the **Sign up** button, it will take another five minutes to
    complete the process. You''ll be shown the following screen until the process
    completes:'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦点击**注册**按钮，完成过程将需要另外五分钟。您将看到以下屏幕，直到过程完成：
- en: '![Signing up to Microsoft Azure](img/Image00140.jpg)'
  id: totrans-50
  prefs: []
  type: TYPE_IMG
  zh: '![注册 Microsoft Azure](img/Image00140.jpg)'
- en: 'Once the sign-up process completes, you''ll be shown the following screen.
    You''ll also get a confirmation e-mail (to the e-mail ID that you gave in the
    first step) with the subscription details:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦完成注册过程，您将看到以下屏幕。您还将收到一封确认电子邮件（发送到您在第一步中提供的电子邮件地址），其中包含订阅详情：
- en: '![Signing up to Microsoft Azure](img/Image00141.jpg)'
  id: totrans-52
  prefs: []
  type: TYPE_IMG
  zh: '![注册 Microsoft Azure](img/Image00141.jpg)'
- en: Prerequisites to Azure deployment
  id: totrans-53
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Azure 部署先决条件
- en: In order to publish the ASP.NET Core application to Azure from the Visual Studio
    2015 Community Edition, you should have Visual Studio 2015 Update 2 installed
    (at least) and you should install/enable the SQL Server Data Tools.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 为了从 Visual Studio 2015 社区版将 ASP.NET Core 应用程序发布到 Azure，您应该安装（至少）Visual Studio
    2015 更新 2，并且应该安装/启用 SQL Server 数据工具。
- en: Note
  id: totrans-55
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: If you have the latest version of VS 2015, there is no need to install Update
    2.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您有 VS 2015 的最新版本，则无需安装更新 2。
- en: You can download the Visual Studio 2015 Update 2 from the URL at [https://www.visualstudio.com/en-us/news/vs2015-update2-vs.aspx](https://www.visualstudio.com/en-us/news/vs2015-update2-vs.aspx)
    and install it.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以从以下网址下载 Visual Studio 2015 更新 2：[https://www.visualstudio.com/en-us/news/vs2015-update2-vs.aspx](https://www.visualstudio.com/en-us/news/vs2015-update2-vs.aspx)
    并安装它。
- en: 'To install the SQL Server Data Tools, go to **Control Panel** | **Programs
    and Features** . Right-click on the **Microsoft Visual Studio Community 2015**
    and select the **Change** , option, as shown in the following screenshot:'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 要安装 SQL Server 数据工具，请转到**控制面板** | **程序和功能**。右键单击**Microsoft Visual Studio Community
    2015**并选择**更改**选项，如图下截图所示：
- en: '![Prerequisites to Azure deployment](img/Image00142.jpg)'
  id: totrans-59
  prefs: []
  type: TYPE_IMG
  zh: '![Azure 部署先决条件](img/Image00142.jpg)'
- en: 'Once you click on **Change** option, you will get the following window—where
    you have to choose the **Modify** button. Once you click the **Modify** button,
    you''ll be given an option where you can modify the Visual Studio installation
    options. I have selected **Microsoft SQL Server Data Tools**  , as depicted in
    the following screenshot:'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦点击**更改**选项，您将看到以下窗口——在这里您需要选择**修改**按钮。一旦点击**修改**按钮，您将获得一个选项，可以修改 Visual Studio
    安装选项。我已选择**Microsoft SQL Server 数据工具**，如图下截图所示：
- en: '![Prerequisites to Azure deployment](img/Image00143.jpg)'
  id: totrans-61
  prefs: []
  type: TYPE_IMG
  zh: '![Azure 部署先决条件](img/Image00143.jpg)'
- en: 'Once you click **Next** , Visual Studio will install the SQL Server Data Tools
    and once it is completed, you will get the following screen, which shows the setup
    completion status:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦点击**下一步**，Visual Studio 将安装 SQL Server 数据工具，一旦完成，您将看到以下屏幕，显示设置完成状态：
- en: '![Prerequisites to Azure deployment](img/Image00144.jpg)'
  id: totrans-63
  prefs: []
  type: TYPE_IMG
  zh: '![Azure 部署先决条件](img/Image00144.jpg)'
- en: Deploying the ASP.NET Core application in Azure
  id: totrans-64
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在 Azure 中部署 ASP.NET Core 应用程序
- en: 'Let''s create an ASP.NET Core application that we can deploy in Microsoft Azure:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们创建一个可以部署到 Microsoft Azure 的 ASP.NET Core 应用程序：
- en: '![Deploying the ASP.NET Core application in Azure](img/Image00145.jpg)'
  id: totrans-66
  prefs: []
  type: TYPE_IMG
  zh: '![在 Azure 中部署 ASP.NET Core 应用程序](img/Image00145.jpg)'
- en: 'The ASP.NET Core application will be created once you click the **OK** button:'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦点击**确定**按钮，ASP.NET Core 应用程序将被创建：
- en: '![Deploying the ASP.NET Core application in Azure](img/Image00146.jpg)'
  id: totrans-68
  prefs: []
  type: TYPE_IMG
  zh: '![在 Azure 中部署 ASP.NET Core 应用程序](img/Image00146.jpg)'
- en: 'As the default ASP.NET Core Web Application template uses the Entity Framework,
    we need to execute the following command in order to create the database migration:'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 由于默认的ASP.NET Core Web应用程序模板使用Entity Framework，我们需要执行以下命令来创建数据库迁移：
- en: '[PRE7]'
  id: totrans-70
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'Once you enter the command in **Command Prompt** (in the project''s path),
    the migration file will be created. This migration file will contain all the changes
    to the database. This migration will be applied at the time of deployment at Azure
    so that Azure can create the necessary database scripts for Azure deployment:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦您在**命令提示符**（在项目路径中）中输入命令，就会创建迁移文件。此迁移文件将包含对数据库的所有更改。此迁移将在Azure部署时应用，以便Azure可以创建必要的Azure部署数据库脚本：
- en: '![Deploying the ASP.NET Core application in Azure](img/Image00147.jpg)'
  id: totrans-72
  prefs: []
  type: TYPE_IMG
  zh: '![在Azure中部署ASP.NET Core应用程序](img/Image00147.jpg)'
- en: 'Once the database migration is completed, right-click on the created Core application
    and select the **Publish** option, as shown in the following screenshot:'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 数据库迁移完成后，右键单击创建的Core应用程序，并选择**发布**选项，如下截图所示：
- en: '![Deploying the ASP.NET Core application in Azure](img/Image00148.jpg)'
  id: totrans-74
  prefs: []
  type: TYPE_IMG
  zh: '![在Azure中部署ASP.NET Core应用程序](img/Image00148.jpg)'
- en: 'When you click the **Publish** option, you''ll be shown the following screen,
    depicting various publishing options available for you:'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 当您点击**发布**选项时，您将看到以下屏幕，展示了您可用的各种发布选项：
- en: '![Deploying the ASP.NET Core application in Azure](img/Image00149.jpg)'
  id: totrans-76
  prefs: []
  type: TYPE_IMG
  zh: '![在Azure中部署ASP.NET Core应用程序](img/Image00149.jpg)'
- en: 'Please select the  **Microsoft Azure App Service** option to publish the web
    application on the Microsoft Azure platform:'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 请选择  **Microsoft Azure App Service** 选项，以在Microsoft Azure平台上发布Web应用程序：
- en: '![Deploying the ASP.NET Core application in Azure](img/Image00150.jpg)'
  id: totrans-78
  prefs: []
  type: TYPE_IMG
  zh: '![在Azure中部署ASP.NET Core应用程序](img/Image00150.jpg)'
- en: 'Click on the **New** button, and you will get the following screen:'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 点击**新建**按钮，您将看到以下屏幕：
- en: '![Deploying the ASP.NET Core application in Azure](img/Image00151.jpg)'
  id: totrans-80
  prefs: []
  type: TYPE_IMG
  zh: '![在Azure中部署ASP.NET Core应用程序](img/Image00151.jpg)'
- en: You can change the web app name to whatever name you would like to have. I have
    changed the web app name to **learningmvc6** .
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以将Web应用程序的名称更改为您想要的任何名称。我已经将Web应用程序的名称更改为**learningmvc6**。
- en: Click on the **New** button beside the **Resource Group** and enter the name
    for the resource group. The resource group is just a tag where you can group all
    of your computing resources so that if you want to delete all the resources, you
    can just delete the resource group. For example, a resource group could comprise
    of a web server and a database server—you can think of it like a collection of
    resources.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 点击**资源组**旁边的**新建**按钮，并输入资源组的名称。资源组只是一个标签，您可以在其中分组所有计算资源，以便如果您想删除所有资源，只需删除资源组即可。例如，资源组可能包括一个Web服务器和一个数据库服务器——您可以将它视为资源集合。
- en: 'Now, click on the **New** button beside the **App Service Plan** . You will
    get the following window where you can choose the location and size of your web
    application container. Your location could be anywhere from South Central US to
    Europe, from Japan to Canada. Your application container could be anything from
    free to a machine with 7 GB RAM. I have chosen the free option as our objective
    is to deploy the ASP.NET Core application in a cloud environment rather than to
    deploy an application which is to be accessed by millions of users. Of course,
    you can achieve the same with ASP.NET Core and Microsoft Azure:'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，点击**App Service Plan**旁边的**新建**按钮。您将看到以下窗口，您可以在其中选择Web应用程序容器的位置和大小。您的位置可以从美国南部中心到欧洲，从日本到加拿大。您的应用程序容器可以是免费的，也可以是具有7
    GB RAM的机器。我选择了免费选项，因为我们的目标是部署ASP.NET Core应用程序到云环境，而不是部署一个将被数百万用户访问的应用程序。当然，您可以使用ASP.NET
    Core和Microsoft Azure实现相同的目标：
- en: '![Deploying the ASP.NET Core application in Azure](img/Image00152.jpg)'
  id: totrans-84
  prefs: []
  type: TYPE_IMG
  zh: '![在Azure中部署ASP.NET Core应用程序](img/Image00152.jpg)'
- en: Now, we can configure the SQL database which is available as an additional Azure
    service.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们可以配置作为附加Azure服务提供的SQL数据库。
- en: '![Deploying the ASP.NET Core application in Azure](img/Image00153.jpg)'
  id: totrans-86
  prefs: []
  type: TYPE_IMG
  zh: '![在Azure中部署ASP.NET Core应用程序](img/Image00153.jpg)'
- en: Click on the + button which is available at the top section which will lead
    us to the configuration of the SQL database.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 点击顶部区域可用的+按钮，这将带我们到SQL数据库的配置。
- en: '![Deploying the ASP.NET Core application in Azure](img/Image00154.jpg)'
  id: totrans-88
  prefs: []
  type: TYPE_IMG
  zh: '![在Azure中部署ASP.NET Core应用程序](img/Image00154.jpg)'
- en: 'If you have any existing SQL server in the Azure environment, you can use it.
    As I don''t have any such server, I am going to create a SQL server by clicking
    the  **New** button beside SQL Server:'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你已经在 Azure 环境中有一个现有的 SQL 服务器，你可以使用它。由于我没有这样的服务器，我将通过点击 SQL 服务器旁边的 **新建** 按钮来创建一个
    SQL 服务器：
- en: '![Deploying the ASP.NET Core application in Azure](img/Image00155.jpg)'
  id: totrans-90
  prefs: []
  type: TYPE_IMG
  zh: '![在 Azure 中部署 ASP.NET Core 应用程序](img/Image00155.jpg)'
- en: 'Please enter the administrator user name and password for the SQL Server and
    click **OK** . You will see the following screen:'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 请输入 SQL 服务器管理员用户名和密码，然后点击 **确定**。你将看到以下屏幕：
- en: '![Deploying the ASP.NET Core application in Azure](img/Image00156.jpg)'
  id: totrans-92
  prefs: []
  type: TYPE_IMG
  zh: '![在 Azure 中部署 ASP.NET Core 应用程序](img/Image00156.jpg)'
- en: 'Once you click **OK** , you will get the following screen:'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦你点击 **确定**，你将看到以下屏幕：
- en: '![Deploying the ASP.NET Core application in Azure](img/Image00157.jpg)'
  id: totrans-94
  prefs: []
  type: TYPE_IMG
  zh: '![在 Azure 中部署 ASP.NET Core 应用程序](img/Image00157.jpg)'
- en: 'Click **OK** on the preceding screen and we will see the **Create App Service**
    screen:'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 在上述屏幕上点击 **确定**，我们将看到 **创建应用服务** 屏幕：
- en: '![Deploying the ASP.NET Core application in Azure](img/Image00158.jpg)'
  id: totrans-96
  prefs: []
  type: TYPE_IMG
  zh: '![在 Azure 中部署 ASP.NET Core 应用程序](img/Image00158.jpg)'
- en: 'Click **Create** once we have configured all the required Azure services:'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦我们配置了所有必需的 Azure 服务，就点击 **创建**：
- en: '![Deploying the ASP.NET Core application in Azure](img/Image00159.jpg)'
  id: totrans-98
  prefs: []
  type: TYPE_IMG
  zh: '![在 Azure 中部署 ASP.NET Core 应用程序](img/Image00159.jpg)'
- en: 'The preceding screen shows the deployment configuration options, such as the
    **Site name** and **Destination URL** for our application. Click **Next** on the
    preceding screen:'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 上述屏幕显示了部署配置选项，例如我们应用程序的 **站点名称** 和 **目标 URL**。在上述屏幕上点击 **下一步**：
- en: '![Deploying the ASP.NET Core application in Azure](img/Image00160.jpg)'
  id: totrans-100
  prefs: []
  type: TYPE_IMG
  zh: '![在 Azure 中部署 ASP.NET Core 应用程序](img/Image00160.jpg)'
- en: It is important to note that you need to expand the **Databases** option and
    **Entity Framework Migrations** options and select both the checkboxes. The first
    checkbox represents the connection string that should be used at runtime and the
    second checkbox represents the database migration that should be applied on publication.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 需要注意的是，你需要展开 **数据库** 选项和 **Entity Framework 迁移** 选项，并选择两个复选框。第一个复选框代表运行时应该使用的连接字符串，第二个复选框代表在发布时应应用的数据库迁移。
- en: '![Deploying the ASP.NET Core application in Azure](img/Image00161.jpg)'
  id: totrans-102
  prefs: []
  type: TYPE_IMG
  zh: '![在 Azure 中部署 ASP.NET Core 应用程序](img/Image00161.jpg)'
- en: The preceding screen is the preview screen where you can see the files that
    would be deployed when you publish. This is an optional step—if you want to see
    the files, you can click the **Start Preview** button. Or else, you can click
    the **Publish** button to publish the web application in the Azure platform.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 上述屏幕是预览屏幕，其中你可以看到发布时将要部署的文件。这是一个可选步骤——如果你想查看文件，可以点击 **开始预览** 按钮。否则，你可以点击 **发布**
    按钮在 Azure 平台上发布网络应用程序。
- en: 'Once you click the **Publish** button, our ASP.NET Core application will be
    deployed in Azure and your application URL will be opened on successful publication.
    You will get the following screen:'
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦你点击 **发布** 按钮，我们的 ASP.NET Core 应用程序将在 Azure 中部署，并且你的应用程序 URL 将在成功发布后打开。你将看到以下屏幕：
- en: '![Deploying the ASP.NET Core application in Azure](img/Image00162.jpg)'
  id: totrans-105
  prefs: []
  type: TYPE_IMG
  zh: '![在 Azure 中部署 ASP.NET Core 应用程序](img/Image00162.jpg)'
- en: Deploying the ASP.NET Core web application in the Linux environment
  id: totrans-106
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在 Linux 环境中部署 ASP.NET Core 网络应用程序
- en: In this section of the chapter, we are going to learn how to create and deploy
    the ASP.NET Core web application in the Linux platform. I am going to deploy the
    application in the cloud using **Amazon Web Services** ( **AWS** ). Obviously,
    you don't need AWS to deploy the ASP.NET Core application on Linux. I am just
    using it so that I do not need to install Linux on my local machine. And another
    advantage of hosting with AWS (or any other public cloud service provider or any
    hosting provider) is that I can access the web application from anywhere as it
    will be publicly available.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章的这部分内容中，我们将学习如何在 Linux 平台上创建和部署 ASP.NET Core 网络应用程序。我将使用 **Amazon Web Services**
    ( **AWS** ) 在云端部署该应用程序。显然，你不需要 AWS 就能在 Linux 上部署 ASP.NET Core 应用程序。我只是用它来避免在我的本地机器上安装
    Linux。并且，使用 AWS（或任何其他公共云服务提供商或任何托管提供商）托管的一个优点是，我可以从任何地方访问网络应用程序，因为它将是公开可用的。
- en: 'We have the following prerequisites to create and deploy in the Linux environment:'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 我们有以下先决条件来创建和部署在 Linux 环境中：
- en: Linux machine
  id: totrans-109
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Linux 机器
- en: Putty client (if you are using a remote Linux machine)
  id: totrans-110
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Putty 客户端（如果你正在使用远程 Linux 机器）
- en: Creating a Linux machine
  id: totrans-111
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 创建 Linux 机器
- en: We are going to use AWS to create a Linux machine. The advantage of using AWS
    or any other cloud provider is that we can use their service only when we need
    it and we can wind down the machine when you are done with it. You only need to
    pay for the time when you are using it. For the first year, AWS has a free tier
    where you can host the machine (if it is eligible for the free tier) without having
    to pay anything. I have been using AWS for more than couple of years to try out
    many things in the cloud, hence I am not eligible for the free tier.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用AWS来创建一个Linux机器。使用AWS或其他任何云服务提供商的优势在于，我们只需在我们需要的时候使用他们的服务，并且当您完成使用后可以关闭机器。您只需为使用的时间付费。对于第一年，AWS有一个免费层，您可以免费托管机器（如果符合免费层条件），无需支付任何费用。我已经使用AWS超过几年时间，在云中尝试了许多事情，因此我不再符合免费层的条件。
- en: However, you can install Linux on your Windows PC by using any virtualization
    software. Ubuntu Linux has the option of booting up from the USB drive itself
    so that you don't need to disturb anything in your local PC.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，您可以通过使用任何虚拟化软件在Windows PC上安装Linux。Ubuntu Linux有从USB驱动器启动的选项，这样您就不需要打扰您的本地PC上的任何东西。
- en: 'Once you sign-up for an AWS account, you can go to the **EC2 dashboard** ,
    where you can create **EC2 instances** :'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦您注册了AWS账户，您就可以进入**EC2仪表板**，在那里您可以创建**EC2实例**：
- en: '![Creating a Linux machine](img/Image00163.jpg)'
  id: totrans-115
  prefs: []
  type: TYPE_IMG
  zh: '![创建Linux机器](img/Image00163.jpg)'
- en: Click **Launch Instance** in the preceding screen. A wizard will be launched
    where it will help you in selecting and configuring the instances. In this step,
    we are selecting the Ubuntu Linux server because of its ease of use.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一屏幕中点击**启动实例**。将启动一个向导，它将帮助您选择和配置实例。在这一步，我们选择Ubuntu Linux服务器，因为它易于使用。
- en: '![Creating a Linux machine](img/Image00164.jpg)'
  id: totrans-117
  prefs: []
  type: TYPE_IMG
  zh: '![创建Linux机器](img/Image00164.jpg)'
- en: 'There are different kinds of instances available in AWS ranging from **nano**
    (with 0.5 GB RAM) to large machines (with 1952 GB RAM). We are going to choose
    **micro** instance as it is eligible for the free tier:'
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: AWS中有不同类型的实例可供选择，从小型实例（0.5 GB RAM）到大机器（1952 GB RAM）。我们将选择**微型**实例，因为它符合免费层的条件：
- en: '![Creating a Linux machine](img/Image00165.jpg)'
  id: totrans-119
  prefs: []
  type: TYPE_IMG
  zh: '![创建Linux机器](img/Image00165.jpg)'
- en: 'In previous step, we can configure the instances for the cloud. We can create
    an auto scale group where the AWS cloud will spin up the instances automatically
    when the load is high. As our objective is to create and deploy the ASP.NET Core
    web application, we are going to leave the default values as they are and click
    **Next: Add Storage** to move to the next screen:'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一步中，我们可以配置云中的实例。我们可以创建一个自动扩展组，当负载高时，AWS云会自动启动实例。由于我们的目标是创建和部署ASP.NET Core
    Web应用程序，我们将保留默认值，并点击**下一步：添加存储**以进入下一屏幕：
- en: '![Creating a Linux machine](img/Image00166.jpg)'
  id: totrans-121
  prefs: []
  type: TYPE_IMG
  zh: '![创建Linux机器](img/Image00166.jpg)'
- en: 'The **micro** instances do not come with any external storage. Hence, we need
    to add the storage in order to use it. We have three options for storage to choose
    from: **General Purpose SSD** , **Provisioned SSD** , and **Magnetic SSD** . Out
    of the three, the **General Purpose SSD** is the storage that would be usually
    used.'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: '**微型**实例不附带任何外部存储。因此，我们需要添加存储才能使用它。我们有三种存储选项可供选择：**通用型SSD**、**预配SSD**和**磁SSD**。在这三种中，**通用型SSD**是通常会被使用的存储。'
- en: When your application is making high input-output operations, the throughput
    may come down. But in the Provisioned SSD you can maintain the required throughput
    from the storage device. Magnetic storage is just an old type of storage. We are
    going to use the General Purpose 8 GB **Solid State Drive** ( **SSD** ) as it
    serves our purpose well.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 当您的应用程序进行高输入输出操作时，吞吐量可能会下降。但在预配SSD中，您可以从存储设备中维持所需的吞吐量。磁存储只是旧式存储。我们将使用通用型8 GB
    **固态硬盘**（**SSD**），因为它很好地满足了我们的需求。
- en: '![Creating a Linux machine](img/Image00167.jpg)'
  id: totrans-124
  prefs: []
  type: TYPE_IMG
  zh: '![创建Linux机器](img/Image00167.jpg)'
- en: 'If you are using multiple instances, you can tag them so that you can control
    the instances by using the tag name. As we are going to launch only one instance,
    I am just going to leave it blank and move on to the next step:'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您正在使用多个实例，您可以给它们打标签，这样您就可以通过标签名称来控制实例。由于我们只将启动一个实例，我将直接跳到下一步：
- en: '![Creating a Linux machine](img/Image00168.jpg)'
  id: totrans-126
  prefs: []
  type: TYPE_IMG
  zh: '![创建Linux机器](img/Image00168.jpg)'
- en: In this step, we can configure the security group for the instance—which ports
    should be opened for the incoming traffic. The general rule in any configuration
    is to only open up the ports what you need and nothing else. You also need to
    tell the IP (or its range) from where the machine could be accessed from. As it
    is a demo application, we are going to open ports `22` , for **Secure Shell**
    ( **SSH** ); for using PuTTY, and `80` , for accessing the Core web application.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 在此步骤中，我们可以为实例配置安全组——应该打开哪些端口以供传入流量使用。在任何配置中的通用规则是只打开你需要的端口，而不是其他端口。你还需要告诉IP（或其范围），从哪里可以访问该机器。由于这是一个演示应用程序，我们将打开端口`22`，用于**安全外壳**（**SSH**）；使用PuTTY，以及`80`，用于访问核心Web应用程序。
- en: Once you have configured the Security Groups, click **Review and Launch** .
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦你配置了安全组，点击**审查和启动**。
- en: '![Creating a Linux machine](img/Image00169.jpg)'
  id: totrans-129
  prefs: []
  type: TYPE_IMG
  zh: '![创建Linux机器](img/Image00169.jpg)'
- en: 'On the following screen, you can review the chosen options:'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一个屏幕上，你可以查看所选选项：
- en: '![Creating a Linux machine](img/Image00170.jpg)'
  id: totrans-131
  prefs: []
  type: TYPE_IMG
  zh: '![创建Linux机器](img/Image00170.jpg)'
- en: You can click **Launch** once you are fine with the selected options. Otherwise,
    you can go back to the previous step to reconfigure them with the correct values.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 当你对所选选项满意时，可以点击**启动**。否则，你可以返回上一步重新配置它们为正确的值。
- en: 'When you click **Launch** , it will ask you to choose a key pair which you
    will be using to log into any AWS server. If you do not have one, you can create
    one. As I have created one already, I am going to use the existing one, as shown
    in the following screenshot:'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 当你点击**启动**时，它将要求你选择一个密钥对，你将使用它登录到任何AWS服务器。如果你没有，你可以创建一个。由于我已经创建了一个，我将使用现有的一个，如下截图所示：
- en: '![Creating a Linux machine](img/Image00171.jpg)'
  id: totrans-134
  prefs: []
  type: TYPE_IMG
  zh: '![创建Linux机器](img/Image00171.jpg)'
- en: 'Select the key pair and click **Launch Instances** . AWS will spin up new instances
    for us and the status will be shown (as in the following screenshot). The instance
    ID will also be available (boxed in the screenshot):'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 选择密钥对并点击**启动实例**。AWS将为我们启动新的实例，状态将显示（如下截图所示）。实例ID也将可用（在截图中已框出）：
- en: '![Creating a Linux machine](img/Image00172.jpg)'
  id: totrans-136
  prefs: []
  type: TYPE_IMG
  zh: '![创建Linux机器](img/Image00172.jpg)'
- en: 'Clicking on the blue colored link will fetch you the status (as shown in the
    following screenshot). The **Public DNS** and **Public IP** are important values
    which you will be using to connect to that server. Hence, I''ve boxed them in
    the screenshot:'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 点击蓝色链接将获取状态（如下截图所示）。**公共DNS**和**公共IP**是重要的值，你将使用它们来连接到该服务器。因此，我在截图中将它们框了起来：
- en: '![Creating a Linux machine](img/Image00173.jpg)'
  id: totrans-138
  prefs: []
  type: TYPE_IMG
  zh: '![创建Linux机器](img/Image00173.jpg)'
- en: Installing the PuTTY client
  id: totrans-139
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 安装PuTTY客户端
- en: Having created a new Linux server where we can create an ASP.NET 5 web application
    and host it, we need to install the PuTTY client, a small application that can
    send commands to the Linux server and receive the responses. As we are going to
    install the application in a Linux server, we need to have a way for connecting
    from your Windows PC to the Linux server. The PuTTY client application does exactly
    that.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 在创建了一个新的Linux服务器，我们可以在这里创建ASP.NET 5 Web应用程序并托管它之后，我们需要安装PuTTY客户端，这是一个可以将命令发送到Linux服务器并接收响应的小应用程序。由于我们将在Linux服务器上安装应用程序，我们需要一种方法从你的Windows
    PC连接到Linux服务器。PuTTY客户端应用程序正是这样做的。
- en: You can download the PuTTY client by visiting [http://www.chiark.greenend.org.uk/~sgtatham/putty/](http://www.chiark.greenend.org.uk/~sgtatham/putty/)
     .
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以通过访问 [http://www.chiark.greenend.org.uk/~sgtatham/putty/](http://www.chiark.greenend.org.uk/~sgtatham/putty/)
     下载PuTTY客户端。
- en: '![Installing the PuTTY client](img/Image00174.jpg)'
  id: totrans-142
  prefs: []
  type: TYPE_IMG
  zh: '![安装PuTTY客户端](img/Image00174.jpg)'
- en: 'Click on the **Download** link and select the link (boxed in the screenshot)
    in the following screen:'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 点击**下载**链接，并在下一个屏幕中选择截图中的链接（已框出）：
- en: '![Installing the PuTTY client](img/Image00175.jpg)'
  id: totrans-144
  prefs: []
  type: TYPE_IMG
  zh: '![安装PuTTY客户端](img/Image00175.jpg)'
- en: 'It will download the MSI file. Once it''s downloaded, launch the installer
    and you''ll be shown the following welcome screen:'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 它将下载MSI文件。下载完成后，启动安装程序，你将看到以下欢迎屏幕：
- en: '![Installing the PuTTY client](img/Image00176.jpg)'
  id: totrans-146
  prefs: []
  type: TYPE_IMG
  zh: '![安装PuTTY客户端](img/Image00176.jpg)'
- en: 'Click **Next** and you''ll see following screen:'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 点击**下一步**，你将看到以下屏幕：
- en: '![Installing the PuTTY client](img/Image00177.jpg)'
  id: totrans-148
  prefs: []
  type: TYPE_IMG
  zh: '![安装PuTTY客户端](img/Image00177.jpg)'
- en: 'Choose the installation folder—you can leave it as it is and click **Next**
    :'
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 选择安装文件夹——你可以保持默认设置并点击**下一步**：
- en: '![Installing the PuTTY client](img/Image00178.jpg)'
  id: totrans-150
  prefs: []
  type: TYPE_IMG
  zh: '![安装PuTTY客户端](img/Image00178.jpg)'
- en: 'Select the product features which you want to install. You can leave the default
    selection and click **Install** . Once it is installed, you will be shown the
    following screen:'
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 选择您想要安装的产品功能。您可以保留默认选择并点击 **安装**。安装完成后，您将看到以下屏幕：
- en: '![Installing the PuTTY client](img/Image00179.jpg)'
  id: totrans-152
  prefs: []
  type: TYPE_IMG
  zh: '![安装 PuTTY 客户端](img/Image00179.jpg)'
- en: 'Click **Finish** and launch the PuTTY application. It will open the PuTTY configuration
    window, where we are going to enter the hostname and authentication details. The
    hostname is `<username>@<public DNS>` . In our case, it is **ubuntu@ec2-107-22-121-81.compute-1.amazonaws.com**
    . Ubuntu is the default user for the Ubuntu AMI that we have chosen. We can get
    the public DNS value in the status window as shown earlier:'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 点击 **完成** 并启动 PuTTY 应用程序。它将打开 PuTTY 配置窗口，我们将在此输入主机名和认证详情。主机名是 `<username>@<public
    DNS>`。在我们的例子中，它是 **ubuntu@ec2-107-22-121-81.compute-1.amazonaws.com**。Ubuntu 是我们选择的
    Ubuntu AMI 的默认用户。我们可以在之前显示的状态窗口中获取公共 DNS 值：
- en: '![Installing the PuTTY client](img/Image00180.jpg)'
  id: totrans-154
  prefs: []
  type: TYPE_IMG
  zh: '![安装 PuTTY 客户端](img/Image00180.jpg)'
- en: 'For authentication, select **Connection** | **SSH** | **Auth** in the left-hand
    pane and select the `PPK` file (private key file) that we created earlier:'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 对于认证，在左侧面板中选择 **连接** | **SSH** | **认证**，并选择我们之前创建的 `PPK` 文件（私钥文件）：
- en: '![Installing the PuTTY client](img/Image00181.jpg)'
  id: totrans-156
  prefs: []
  type: TYPE_IMG
  zh: '![安装 PuTTY 客户端](img/Image00181.jpg)'
- en: Click **Open** . You'll get a warning asking you whether you trust this host.
    Click **yes** and you'll be shown the Command Prompt of the Linux screen.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 点击 **打开**。您将收到一个警告，询问您是否信任此主机。点击 **是**，您将看到 Linux 屏幕的命令提示符。
- en: '![Installing the PuTTY client](img/Image00182.jpg)'
  id: totrans-158
  prefs: []
  type: TYPE_IMG
  zh: '![安装 PuTTY 客户端](img/Image00182.jpg)'
- en: Next, we need to install .NET Core before creating the ASP.NET 5 application
    and eventually host them.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，在创建 ASP.NET 5 应用程序并最终托管它们之前，我们需要先安装 .NET Core。
- en: Installing of .NET Core in a Linux machine
  id: totrans-160
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Linux机器上安装.NET Core
- en: 'In order to install .NET Core on Ubuntu, we need to first set up the apt and
    get feed that hosts the package that we need. Enter the following commands:'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 为了在 Ubuntu 上安装 .NET Core，我们首先需要设置 apt 和获取包含我们所需包的源的 feed。输入以下命令：
- en: '[PRE8]'
  id: totrans-162
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'You will get the following screen:'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 您将看到以下屏幕：
- en: '![Installing of .NET Core in a Linux machine](img/Image00183.jpg)'
  id: totrans-164
  prefs: []
  type: TYPE_IMG
  zh: '![Linux机器上安装.NET Core的截图](img/Image00183.jpg)'
- en: 'Then update it by issuing the following command, which will download the required
    packages and install them:'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 然后通过以下命令更新它，该命令将下载所需的包并安装它们：
- en: '[PRE9]'
  id: totrans-166
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'You will see the following screen for this command:'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 对于此命令，您将看到以下屏幕：
- en: '![Installing of .NET Core in a Linux machine](img/Image00184.jpg)'
  id: totrans-168
  prefs: []
  type: TYPE_IMG
  zh: '![Linux机器上安装.NET Core的截图](img/Image00184.jpg)'
- en: 'Install the .NET Core with the following command:'
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 使用以下命令安装 .NET Core：
- en: '[PRE10]'
  id: totrans-170
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'The following screen will be displayed:'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 将会显示以下屏幕：
- en: '![Installing of .NET Core in a Linux machine](img/Image00185.jpg)'
  id: totrans-172
  prefs: []
  type: TYPE_IMG
  zh: '![Linux机器上安装.NET Core的截图](img/Image00185.jpg)'
- en: Creating a new ASP.NET 5 project
  id: totrans-173
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建一个新的 ASP.NET 5 项目
- en: 'Issue the following commands to create a new directory where we will create
    the ASP.NET 5 application. The first command ( `**mkdir**` - make directory) is
    for creating a directory in Linux and the second command ( `**cd**` - change directory)
    is for going inside the folder. And the last command is the command line to create
    a .NET Core application:'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 通过以下命令创建一个新的目录，我们将在此目录中创建 ASP.NET 5 应用程序。第一个命令（`**mkdir**` - 创建目录）是在 Linux 中创建目录，第二个命令（`**cd**`
    - 切换目录）是进入文件夹。最后一个命令是创建 .NET Core 应用程序的命令行：
- en: '[PRE11]'
  id: totrans-175
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'The following screen will be displayed:'
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 将会显示以下屏幕：
- en: '![Creating a new ASP.NET 5 project](img/Image00186.jpg)'
  id: totrans-177
  prefs: []
  type: TYPE_IMG
  zh: '![创建一个新的 ASP.NET 5 项目](img/Image00186.jpg)'
- en: This will create the .NET Core application, which has a couple of files—`Program.cs`
    and `project.json` . It's a bare minimum application that does not have even `Startup`
    file.
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 这将创建一个 .NET Core 应用程序，其中包含几个文件——`Program.cs` 和 `project.json`。这是一个最小化应用程序，甚至没有
    `Startup` 文件。
- en: 'We need to add the `Kestrel HTTP Server` package as a dependency in `project.json`
    . You can edit the file by issuing the command `**vi project.json**` . By default,
    the vi editor will open the file in read-only mode. You need to press *Esc* +
    *I* in order to make it to the edit mode. Add the line **"Microsoft.AspNetCore.Server.Kestrel":
    "1.0.0"**  as shown in the following screenshot:'
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: '我们需要在 `project.json` 中添加 `Kestrel HTTP Server` 包作为依赖项。您可以通过执行命令 `**vi project.json**`
    来编辑该文件。默认情况下，vi 编辑器将以只读模式打开文件。您需要按下 *Esc* + *I* 才能进入编辑模式。添加如下所示的行 **"Microsoft.AspNetCore.Server.Kestrel":
    "1.0.0"**，如图所示：'
- en: '![Creating a new ASP.NET 5 project](img/Image00187.jpg)'
  id: totrans-180
  prefs: []
  type: TYPE_IMG
  zh: '![创建一个新的 ASP.NET 5 项目](img/Image00187.jpg)'
- en: Press the Escape key and " *:"  * and type `wq`  to write into and quit the
    `vi` editor.
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 按下 Escape 键和 " *:"  * 并输入 `wq`  以写入并退出 `vi` 编辑器。
- en: 'As we have added the dependency, we need to restore the packages by executing
    the following command:'
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们添加了依赖项，我们需要通过执行以下命令来恢复包：
- en: '[PRE12]'
  id: totrans-183
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'Once you enter this command, all the packages will be restored as shown in
    the following screenshot:'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 当您输入此命令时，所有包都将如以下截图所示恢复：
- en: '![Creating a new ASP.NET 5 project](img/Image00188.jpg)'
  id: totrans-185
  prefs: []
  type: TYPE_IMG
  zh: '![创建新的 ASP.NET 5 项目](img/Image00188.jpg)'
- en: 'Create a new file, `Startup.cs` , with the following content. You can create
    a new file by issuing the command `**vi Startup.cs**` . As usual, we need to press
    *Esc* + *I*  to make the file in write and read mode. Paste the following content
    (you can paste it by right-clicking on the mouse after copying it from here):'
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 创建一个新文件，`Startup.cs`，内容如下。您可以通过输入命令 `**vi Startup.cs**` 来创建新文件。像往常一样，我们需要按下
    *Esc* + *I* 使文件处于可写和可读模式。粘贴以下内容（您可以通过在此处复制后右键单击鼠标粘贴）：
- en: '[PRE13]'
  id: totrans-187
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'Press *Esc* + *:*  and type `wq` , to save the file. Update the `Program.cs`
    file with the following content:'
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 按下 *Esc* + *:* 并输入 `wq` 以保存文件。更新 `Program.cs` 文件，内容如下：
- en: '[PRE14]'
  id: totrans-189
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'You''ll see the following screen:'
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 您将看到以下屏幕：
- en: '![Creating a new ASP.NET 5 project](img/Image00189.jpg)'
  id: totrans-191
  prefs: []
  type: TYPE_IMG
  zh: '![创建新的 ASP.NET 5 项目](img/Image00189.jpg)'
- en: 'We have created the ASP.NET Core web application. Now we need to install **Nginx**
    , a reverse proxy server, which enables you to offload work such as serving static
    content, caching, and compressing requests. You can configure Nginx to listen
    on a particular port (we''ll discuss the details later in this chapter). You can
    install Nginx by issuing the following command:'
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已创建 ASP.NET Core 网络应用程序。现在我们需要安装 **Nginx**，一个反向代理服务器，它使您能够卸载诸如服务静态内容、缓存和压缩请求等工作。您可以通过输入以下命令来配置
    Nginx 以监听特定端口（我们将在本章后面讨论细节）。您可以通过以下命令安装 Nginx：
- en: '[PRE15]'
  id: totrans-193
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'Once it is installed, you can issue the following command to start the service:'
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 安装完成后，您可以输入以下命令来启动服务：
- en: '[PRE16]'
  id: totrans-195
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'When you''ll run the command, you''ll see the following screen:'
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 当您运行命令时，您将看到以下屏幕：
- en: '![Creating a new ASP.NET 5 project](img/Image00190.jpg)'
  id: totrans-197
  prefs: []
  type: TYPE_IMG
  zh: '![创建新的 ASP.NET 5 项目](img/Image00190.jpg)'
- en: Configuring the Nginx server
  id: totrans-198
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 配置 Nginx 服务器
- en: 'Configure the Nginx server by modifying the file (`/etc/nginx/sites-available/default`
    ) to have the following content—so that Nginx will forward the request to ASP.NET.
    In order to modify this file, you need to have sufficient rights—try switching
    to a super user. The  `**Sudo su**` is the command for switching it to a super
    user. See the following code:'
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 通过修改文件（`/etc/nginx/sites-available/default`）以包含以下内容来配置 Nginx 服务器，以便 Nginx 将请求转发到
    ASP.NET。为了修改此文件，您需要足够的权限——尝试切换到超级用户。`**Sudo su**` 是切换到超级用户的命令。请参见以下代码：
- en: '[PRE17]'
  id: totrans-200
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'The code looks like the following:'
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: 代码看起来如下：
- en: '![Configuring the Nginx server](img/Image00191.jpg)'
  id: totrans-202
  prefs: []
  type: TYPE_IMG
  zh: '![配置 Nginx 服务器](img/Image00191.jpg)'
- en: 'Run the application by executing the following command:'
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 通过执行以下命令来运行应用程序：
- en: '[PRE18]'
  id: totrans-204
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'You will see the following screen:'
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: 您将看到以下屏幕：
- en: '![Configuring the Nginx server](img/Image00192.jpg)'
  id: totrans-206
  prefs: []
  type: TYPE_IMG
  zh: '![配置 Nginx 服务器](img/Image00192.jpg)'
- en: 'Now access the application from your browser using the public DNS (AWS created
    the public DNS when the instance was launched):'
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，使用公共 DNS（实例启动时 AWS 创建了公共 DNS）从浏览器访问应用程序：
- en: '![Configuring the Nginx server](img/Image00193.jpg)'
  id: totrans-208
  prefs: []
  type: TYPE_IMG
  zh: '![配置 Nginx 服务器](img/Image00193.jpg)'
- en: Voila! We have created the ASP.NET Core web application and launched it in the
    Linux box. We have even used the cloud through **Amazon Web Services** ( **AWS**
    ).
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 哇！我们已经在 Linux 箱子中创建了 ASP.NET Core 网络应用程序并启动了它。我们甚至通过 **Amazon Web Services**（**AWS**）使用了云服务。
- en: Summary
  id: totrans-210
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: In this chapter, you have learned about the different components available in
    the `project.json` file, where all the configuration of your ASP.NET Core goes.
    We have discussed how to sign up to the Microsoft Azure cloud platform and deploy
    the ASP.NET Core application in the Azure platform. We have also learned how to
    create and deploy the ASP.NET Core web application in Linux using Amazon Web Services
    in the cloud.
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，您学习了 `project.json` 文件中可用的不同组件，其中包含您所有 ASP.NET Core 的配置。我们讨论了如何注册 Microsoft
    Azure 云平台并在 Azure 平台上部署 ASP.NET Core 应用程序。我们还学习了如何在云中使用 Amazon Web Services 在
    Linux 中创建和部署 ASP.NET Core 网络应用程序。
