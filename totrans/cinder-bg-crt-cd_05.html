<html><head></head><body><div><div><div><div><h1 class="title"><a id="ch05"/>Chapter 5. Making Use of Images – Loading and Displaying</h1></div></div></div><p>In this chapter we will learn the following:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">How to load an image</li><li class="listitem" style="list-style-type: disc">How to display it on the screen</li><li class="listitem" style="list-style-type: disc">About general asset handling in Cinder</li></ul></div><p>You might make use of photographs, illustrations, or different image databases in your applications. To do so, you will need a way to load an image into your application and most importantly, to display it on the screen.</p><p>In this chapter we will learn the basics of Cinder file loading features and learn to load an image from the Web and local storage.</p><div><div><div><div><h1 class="title"><a id="ch05lvl1sec35"/>Loading an image</h1></div></div></div><p>Open TinderBox and <a class="indexterm" id="id167"/>create a new project with the name <code class="literal">BasicImages</code>. Open <code class="literal">xcode/BasicImages.xcodeproj</code> project file. Windows users should open the project file <code class="literal">vc10\BasicImages.sln</code>. Open <code class="literal">BasicImagesApp.cpp</code> in the editor.</p><p>First we are going to include some header files that declare functionality that is required to perform the things we want to get done.</p><p>Navigate to a point in the code where there are <code class="literal">#include</code> statements<a class="indexterm" id="id168"/> and add the following lines of code just after <code class="literal">#include "cinder/gl/gl.h"</code>:</p><div><pre class="programlisting">#include "cinder/ImageIo.h"
#include "cinder/gl/Texture.h"</pre></div><p>The first include statement loads code header that is responsible for the Cinder image input/output functionality, the second code header include allows us to use OpenGL textures for drawing images on the screen.</p><p>Next we need to<a class="indexterm" id="id169"/> declare a variable of type <code class="literal">gl::Texture</code> that will contain the actual image data. You can chose your own name for that, but I will call it <code class="literal">imgTexture</code>:</p><div><pre class="programlisting">gl::Texture imgTexture;</pre></div><p>Add the highlighted line of code just after <code class="literal">void draw();</code> in the <code class="literal">BasicImagesApp</code> class declaration:</p><div><pre class="programlisting">class BasicImagesApp : public AppBasic {
public:
  void setup();
  void update();
  void draw();
  <strong>gl::Texture imgTexture;</strong>
};</pre></div><p>Next, we need to select an image to be loaded into the application. So we are going to use some random image from the internet as it is the fastest way to get a visible image on the screen if you have an internet connection.</p><div><div><h3 class="title"><a id="note07"/>Note</h3><p>Before compiling and running the following example, try to open this URL <a class="ulink" href="http://rijnieks.lv/projects/cinder_begin_creative_coding/images/image.png">http://rijnieks.lv/projects/cinder_begin_creative_coding/images/image.png</a> in your browser. If you do not see an image, please find any other <code class="literal">*.png</code> or <code class="literal">*.jpg</code> image on the internet.</p></div></div><p>Add the following highlighted line of code in the setup method declaration:</p><div><pre class="programlisting">void BasicImagesApp::setup() {
<strong>  imgTexture = gl::Texture( loadImage( loadUrl( Url("http://rijnieks.lv/projects/cinder_begin_creative_coding/images/image.png") ) ) );</strong>
}</pre></div><p>The reason why we load it in the <code class="literal">setup()</code> is that we need to load the image just once. As loading images from the net takes some time, we don't want to delay our <code class="literal">draw()</code> or <code class="literal">update()</code> operations because the image is still loading. Cinder is about speed and we don't want to sacrifice it.</p><p>Now we need to add some code that will take care of displaying the image. Go to the implementation of the <code class="literal">draw()</code> method<a class="indexterm" id="id170"/> and add this code just after the <code class="literal">gl::clear( Color( 0, 0, 0 ) );</code> function:</p><div><pre class="programlisting">gl::draw( imgTexture, getWindowBounds() );</pre></div><p>Here we tell<a class="indexterm" id="id171"/> Cinder that we want to draw our <code class="literal">imgTexture</code> within the application window bounds (the image will be stretched so its width equals the window's width and its height equals the window's height). Try to compile and run the application. After a short delay an image should appear. If you try to resize the window, you can see that the image is being resized with it.</p><p>The member <a class="indexterm" id="id172"/>function <code class="literal">getWindowBounds()</code> returns an <code class="literal">Area</code> object<a class="indexterm" id="id173"/> and instead of using this function we can define the drawing area by ourselves. Try this:</p><div><pre class="programlisting">gl::draw( imgTexture, Area(100,100,540,380) );</pre></div><p>If you try to resize the window now, you will see that it does not affect the image as now it's display position and size is hardcoded in <code class="literal">Area(100,100,540,380)</code>.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch05lvl1sec36"/>Handling assets</h1></div></div></div><p>Now let's see what we <a class="indexterm" id="id174"/>need to create an application that will be used on a computer without an internet connection. We have to store our image somewhere on the computer.</p><p>Cinder has a predefined way of handling images and similar assets. If you created your project with TinderBox, you may have noticed that you have an <strong>assets</strong> directory in your project folder. If not, create one.</p><div><img alt="Handling assets" src="img/9564_05_01.jpg"/></div><p>Now copy your image file into the assets directory and change the <code class="literal">loadImage</code> code in the <code class="literal">setup()</code> implementation to the following:</p><div><pre class="programlisting">imgTexture = gl::Texture( loadImage( loadAsset( "MyImage.png" ) ) );</pre></div><p>As you can see we changed <code class="literal">loadUrl()</code> <a class="indexterm" id="id175"/>to <code class="literal">loadAsset()</code> <a class="indexterm" id="id176"/>and it actually seems simpler than the <code class="literal">loadUrl( Url( "http://..." ) )</code> approach. It's just that we do need to take care of our assets by ourselves.</p><p>Now try to move the <a class="indexterm" id="id177"/>assets directory one level up in the filesystem so it is next to the <code class="literal">BasicImages</code> folder as shown in the following screenshot:</p><div><img alt="Handling assets" src="img/9564_05_02.jpg"/></div><p>Try to compile and run our project and you will be surprised that the image still loads! Some people may think that this is the magic of caching or something similar but no, Cinder just automatically searches for the <code class="literal">assets</code> directory up to five levels above the executable. So you can choose at what level you want to store your assets, but in a way the default way may be the best as it allows you to use the same assets for your Mac OS X and Windows projects. If you are working on more than one project with the same assets, then you may move your <code class="literal">assets</code> directory<a class="indexterm" id="id178"/> to the projects folder level as we just did.</p><p>There is one small detail to it—if your image uses alpha transparency, you might get strange results. To draw images with alpha transparency, we have to enable alpha blending before drawing the image and disable it after it is drawn by adding the following code snippet:</p><div><pre class="programlisting">gl::enableAlphaBlending();
gl::draw( imgTexture, Rectf(100,100,540,380) );
gl::disableAlphaBlending();</pre></div><p>There is also a way of adding additional asset directories in case you have more than one group of projects using the same assets. The following line of code takes care of that:</p><div><pre class="programlisting">addAssetDirectory( "/Users/You/myOtherAssets/" );</pre></div><p>Note that you have to use an absolute path here, so this is not too good for cross-platform projects. In windows you might write something similar to the following:</p><div><pre class="programlisting">addAssetDirectory( "C:\Users\You\myOtherAssets\" );</pre></div><p>If you use assets, you have to remember to deploy the assets directory with your application.</p><p>There is a way that <a class="indexterm" id="id179"/>tells you how to include assets inside the application, but this topic is a bit outside the scope of this book. You should search the Internet for "Cinder resource management" if you want to know more about it.</p><p>The following is the full code of the application that we made in this chapter:</p><div><pre class="programlisting">#include "cinder/app/AppBasic.h"
#include "cinder/gl/gl.h"
#include "cinder/ImageIo.h"
#include "cinder/gl/Texture.h"

using namespace ci;
using namespace ci::app;
using namespace std;

class BasicImagesApp : public AppBasic {
public:
  void setup();
  void draw();
  gl::Texture imgTexture;
};

void BasicImagesApp::setup() {
  addAssetDirectory( "/Users/kr15h/myOtherAssets/" );
  imgTexture = gl::Texture( loadImage( loadAsset( "MyImage.png" ) ) );
}

void BasicImagesApp::draw() {
  gl::clear( Color( 0, 0, 0 ) );
  gl::enableAlphaBlending();
  gl::draw( imgTexture, Rectf(100,100,540,380) );
  gl::disableAlphaBlending();
}</pre></div><div><pre class="programlisting">CINDER_APP_BASIC( BasicImagesApp, RendererGl )</pre></div><p>Not a <a class="indexterm" id="id180"/>lot of code!</p></div>
<div><div><div><div><h1 class="title"><a id="ch05lvl1sec37"/>Summary</h1></div></div></div><p>In this chapter we learned how to load an image from the Internet as well as from local storage, assign it to an OpenGL texture, and draw it on the screen.</p><p>We gained a basic understanding on how asset management works in Cinder and that we don't have to worry about the location of the <code class="literal">assets</code> directory as long as it is less than five levels up from our application.</p><p>We also understood that we can use the <code class="literal">loadUrl()</code> and <code class="literal">loadAsset()</code> functions in the same way on Mac OS X and Windows.</p></div></body></html>