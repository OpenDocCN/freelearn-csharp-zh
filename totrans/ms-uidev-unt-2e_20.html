<html><head></head><body>
<div id="sbo-rt-content" class="calibre1"><div id="_idContainer585" class="calibre2">
<h1 class="chapter-number" id="_idParaDest-259"><a id="_idTextAnchor447" class="pcalibre pcalibre1 calibre6"/>16</h1>
<h1 id="_idParaDest-260" class="calibre5"><a id="_idTextAnchor448" class="pcalibre pcalibre1 calibre6"/>Utilizing World Space UI</h1>
<p class="calibre3">In <a href="B18327_06.xhtml#_idTextAnchor085" class="pcalibre pcalibre1 calibre6"><span><em class="italic">Chapter 6</em></span></a>, we discussed the three different Render Modes you can assign to a Canvas. We’ve used Screen Space-Overlay and Screen Space-Camera but haven’t used World Space yet. As described in <a href="B18327_02.xhtml#_idTextAnchor024" class="pcalibre pcalibre1 calibre6"><span><em class="italic">Chapter 2</em></span></a>, UI rendered in World Space is placed directly in the scene. We’ve already discussed the properties of World Space Canvas rendering, so this chapter will just look at when to use it and examples <span>of implementation.</span></p>
<p class="calibre3">In this chapter, we will discuss the <span>following topics:</span></p>
<ul class="calibre16">
<li class="calibre14">When to use World <span>Space UI</span></li>
<li class="calibre14">General techniques to consider when working with World <span>Space UI</span></li>
<li class="calibre14">Using World Space Canvases in a 2D game to create status indicators positioned relative <span>to characters</span></li>
<li class="calibre14">Using World Space Canvases to create health bars that hover over enemies’ heads in a <span>3D game</span></li>
</ul>
<h1 id="_idParaDest-261" class="calibre5"><a id="_idTextAnchor449" class="pcalibre pcalibre1 calibre6"/>Technical requirements</h1>
<p class="calibre3">You can find the relevant codes and asset files of this chapter <span>here: </span><a href="https://github.com/PacktPublishing/Mastering-UI-Development-with-Unity-2nd-Edition/tree/main/Chapter%2016" class="pcalibre pcalibre1 calibre6"><span>https://github.com/PacktPublishing/Mastering-UI-Development-with-Unity-2nd-Edition/tree/main/Chapter%2016</span></a></p>
<h1 id="_idParaDest-262" class="calibre5"><a id="_idTextAnchor450" class="pcalibre pcalibre1 calibre6"/>When to use World Space UI</h1>
<p class="calibre3">There are many reasons you may want to use <a id="_idIndexMarker959" class="pcalibre pcalibre1 calibre6"/>a World Space Canvas. The most common reasons for using this render mode are <span>the following:</span></p>
<ul class="calibre16">
<li class="calibre14">To have better control of individual UI objects’ positions in relation to objects in <span>the scene</span></li>
<li class="calibre14">To rotate or curve <span>UI elements</span></li>
</ul>
<p class="calibre3">For example, the game <em class="italic">Mojikara: Japanese Trainer</em> uses World Space Canvases to have rotated Panels and keep UI objects, such as Text, attached to 3D objects. As you can see from the following screenshot, the Panel on the left is rotated just slightly in 3D space, because it is on a World <a id="_idIndexMarker960" class="pcalibre pcalibre1 calibre6"/><span>Space Canvas:</span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer559">
<img alt="Figure 16.1: Mojikara: Japanese Trainer (image provided by Lisa Walkosz-Migliacio, Intropy Games)" src="image/B18327_16_01.jpg" class="calibre546"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.1: Mojikara: Japanese Trainer (image provided by Lisa Walkosz-Migliacio, Intropy Games)</p>
<p class="calibre3">Another example of rotated UI can be found in the game <em class="italic">Cloudbase Prime</em>, as shown in the following screenshot. It also used World Space rendering to create indicators that hover over objects <span>and characters.</span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer560">
<img alt="Figure 16.2: Cloudbase Prime (image provided by Tyrus Peace, Floating Island Games)" src="image/B18327_16_02.jpg" class="calibre547"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.2: Cloudbase Prime (image provided by Tyrus Peace, Floating Island Games)</p>
<p class="calibre3">All the UI in <em class="italic">Cloudbase Prime</em> was done<a id="_idIndexMarker961" class="pcalibre pcalibre1 calibre6"/> on World Space Canvases. This allowed the developer to create cool curving UI, <span>as follows:</span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer561">
<img alt="Figure 16.3: Cloudbase Prime (image provided by Tyrus Peace, Floating Island Games)" src="image/B18327_16_03.jpg" class="calibre548"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.3: Cloudbase Prime (image provided by Tyrus Peace, Floating Island Games)</p>
<p class="calibre3">Here, you can see how the UI looks in the Editor versus how it looks to the player. This gives a nice peek at how the UI <span>was built:</span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer562">
<img alt="Figure 16.4: Cloudbase Prime (image provided by Tyrus Peace, Floating Island Games)" src="image/B18327_16_04.jpg" class="calibre549"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.4: Cloudbase Prime (image provided by Tyrus Peace, Floating Island Games)</p>
<p class="calibre3">I recommend checking out the following <a id="_idIndexMarker962" class="pcalibre pcalibre1 calibre6"/>site to see more ways in which <em class="italic">Cloudbase Prime</em> has implemented World Space UI, as they are truly <span>beautiful: </span><a href="https://imgur.com/a/hxNgL" class="pcalibre pcalibre1 calibre6"><span>https://imgur.com/a/hxNgL</span></a><span>.</span></p>
<p class="calibre3">Another common usage of World Space UI is simulating computer screens and monitors within a scene. For example, I built the following UI for a friend’s VR game named <em class="italic">Cloud Rise</em>. The monitor was simulated by placing a World Space Canvas right on top of the in-game screen. I was then able to easily anchor and animate the UI; in the same way, I rendered the UI in <span>Screen Space.</span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer563">
<img alt="Figure 16.5: Cloud Rise (image provided by Meredith Wilson, Bedhouse Games)" src="image/B18327_16_05.jpg" class="calibre550"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.5: Cloud Rise (image provided by Meredith Wilson, Bedhouse Games)</p>
<p class="calibre3">In general, the interactive UIs of VR games are on World Space Canvases since the player cannot interact with <em class="italic">the screen</em>. Common<a id="_idIndexMarker963" class="pcalibre pcalibre1 calibre6"/> usages of VR UI are flat floating Panels or <span>wrapping Panels.</span></p>
<p class="calibre3">Hovering indicators are by far the most common use of World Space UI; they are specifically used for health bars over the heads of in-game characters, as shown in the following screenshot of <span><em class="italic">Iris Burning</em></span><span>:</span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer564">
<img alt="Figure 16.6: Iris Burning (image provided by William Preston, DCM Studios)" src="image/B18327_16_06.jpg" class="calibre551"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.6: Iris Burning (image provided by William Preston, DCM Studios)</p>
<p class="calibre3">Most people think of 3D games when they think of World Space UI because they think of UI that appears <em class="italic">far away</em>, but it is commonly used in 2D games as well! Management and RTS games use UI quite frequently to create buttons and progress bars, and other UI elements maintain their position<a id="_idIndexMarker964" class="pcalibre pcalibre1 calibre6"/> with the object they interact with. The World Space UI can be on one Canvas that encompasses all items on the screen, with individual UI items matching the 2D World Space coordinates of the items they represent, or they can be on individual Canvases of their respective items. We will cover how to create a 2D game using World Space UI in an example at the end of <span>the chapter.</span></p>
<p class="calibre3">Now, let’s explore how to use World <span>Space UI.</span></p>
<h1 id="_idParaDest-263" class="calibre5"><a id="_idTextAnchor451" class="pcalibre pcalibre1 calibre6"/>Appropriately scaling text in the Canvas</h1>
<p class="calibre3">Whenever a Canvas is created, it is initialized with <strong class="bold">Screen Space - Overlay</strong> as its <strong class="bold">Render Mode</strong>. Therefore, when you change the <strong class="bold">Render Mode</strong> property to <strong class="bold">World Space</strong>, the Canvas will be huge in <span>your scene.</span></p>
<p class="calibre3">When you scale down the Canvas to the <a id="_idIndexMarker965" class="pcalibre pcalibre1 calibre6"/>appropriate size in the scene, the text will likely be super blurry or not visible at all. Let’s say we created the following Canvas in <strong class="bold">Screen Space - Overlay</strong> but decided to put it in <span><strong class="bold">World Space</strong></span><span>:</span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer565">
<img alt="Figure 16.7: A Canvas in Screen Space - Overlay" src="image/B18327_16_07.jpg" class="calibre552"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.7: A Canvas in Screen Space - Overlay</p>
<p class="calibre3">Converting it to <strong class="bold">World Space</strong> doesn’t initially cause any problems, but once we scale it down to something like a <strong class="bold">Width</strong> of <strong class="source-inline">4</strong> and <strong class="bold">Height</strong> of <strong class="source-inline">3</strong> (since it was initially created with a 4:3 aspect ratio screen), the text <span>will disappear!</span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer566">
<img alt="Figure 16.8: A Canvas in Screen Space - Overlay" src="image/B18327_16_08.jpg" class="calibre553"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.8: A Canvas in Screen Space - Overlay</p>
<p class="calibre3">If I set the <strong class="bold">Text</strong> to allow <strong class="bold">Horizontal Overflow</strong> and <strong class="bold">Vertical Overflow</strong> you’ll see that it is huge when compared<a id="_idIndexMarker966" class="pcalibre pcalibre1 calibre6"/> to the Canvas! In the following screenshot, the tiny rectangle in the middle is <span>the Canvas:</span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer567">
<img alt="Figure 16.9: World Space Canvas with huge overflowing text example" src="image/B18327_16_09.jpg" class="calibre554"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.9: World Space Canvas with huge overflowing text example</p>
<p class="calibre3">To fix this, and to get it looking the way we want, we need to adjust the <strong class="bold">Dynamic Pixels Per Unit</strong> property on the <strong class="bold">Canvas Scaler</strong> component (initially discussed in <a href="B18327_06.xhtml#_idTextAnchor085" class="pcalibre pcalibre1 calibre6"><span><em class="italic">Chapter 6</em></span></a>). This property is initially set <span>to </span><span><strong class="source-inline">1</strong></span><span>.</span></p>
<p class="calibre3">Usually, to determine the new <strong class="bold">Dynamic Pixel Size</strong> value, I take the starting <strong class="bold">Width</strong> of the Canvas before I scale it down, which is <strong class="source-inline">905</strong>, divide it by the new <strong class="bold">Width</strong> <strong class="source-inline">4</strong>, and enter that division in my <strong class="bold">Dynamic Pixels Per Unit</strong> property. (Typing the actual division <strong class="source-inline">905/4</strong> in the box will perform <span>the calculation.)</span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer568">
<img alt="Figure 16.10: Dynamic Pixels Per Unit property adjusted" src="image/B18327_16_10.jpg" class="calibre555"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.10: Dynamic Pixels Per Unit property adjusted</p>
<p class="calibre3">However, that calculation didn’t get <a id="_idIndexMarker967" class="pcalibre pcalibre1 calibre6"/>the exact look I was looking for. So, I increased the size until it <span>looked right:</span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer569">
<img alt="Figure 16.11: Dynamic Pixels Per Unit property example in the Chapter16 scene" src="image/B18327_16_11.jpg" class="calibre556"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.11: Dynamic Pixels Per Unit property example in the Chapter16 scene</p>
<p class="calibre3">Every time you change the <strong class="bold">Width</strong> and <strong class="bold">Height</strong> of the Canvas, you will have to adjust the <strong class="bold">Dynamic Pixels Per Unit</strong> property. Decreasing the size of the Canvas will mean increasing the <strong class="bold">Dynamic Pixels Per Unit</strong> property, and increasing the size of the Canvas will mean decreasing<a id="_idIndexMarker968" class="pcalibre pcalibre1 calibre6"/> the size of the <strong class="bold">Dynamic Pixels Per </strong><span><strong class="bold">Unit</strong></span><span> property.</span></p>
<p class="calibre3">Here are two Canvases, both one-fourth the size of the one from the previous figure. In the top Canvas, I changed the <strong class="bold">Width</strong> and <strong class="bold">Height</strong> to <strong class="source-inline">1</strong> and <strong class="source-inline">.75</strong>. In the bottom Canvas, I changed the <strong class="bold">Scale X</strong> and <strong class="bold">Scale Y</strong> <span>to </span><span><strong class="source-inline">0.25</strong></span><span>:</span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer570">
<img alt="Figure 16.12: Width and Height change examples" src="image/B18327_16_12.jpg" class="calibre557"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.12: Width and Height change examples</p>
<p class="calibre3">In the first example, since I changed the <strong class="bold">Width</strong> and <strong class="bold">Height</strong> of the <a id="_idIndexMarker969" class="pcalibre pcalibre1 calibre6"/>Canvas to one-fourth of the size, I typed <strong class="source-inline">350*4</strong> in the <strong class="bold">Dynamic Pixels Per Unit</strong> property, and it automatically calculated <strong class="source-inline">1400</strong> for me (I love that Unity performs calculations in <span>the boxes).</span></p>
<p class="calibre3">However, in the second Canvas, I did not have to change the <strong class="bold">Dynamic Pixels Per Unit</strong> size, because scaling with the <strong class="bold">Scale</strong> property in this way does not require me to <span>change it.</span></p>
<p class="calibre3">The takeaway from this is that if your text isn’t displaying or looks incredibly blurry, adjust the <strong class="bold">Dynamic Pixels Per Unit</strong> property until it looks the way it should, or scale your Canvas by adjusting its <strong class="bold">Scale</strong> and not its <strong class="bold">Width</strong> <span>and </span><span><strong class="bold">Height</strong></span><span>.</span></p>
<p class="calibre3">Text scaling will be the most important <a id="_idIndexMarker970" class="pcalibre pcalibre1 calibre6"/>consideration with using World Space UI, but let’s review some other <span>important topics.</span></p>
<h1 id="_idParaDest-264" class="calibre5"><a id="_idTextAnchor452" class="pcalibre pcalibre1 calibre6"/>Other considerations when working in World Space</h1>
<p class="calibre3">For the most part, working with UI in <a id="_idIndexMarker971" class="pcalibre pcalibre1 calibre6"/>World Space isn’t much different than working with UI in Screen or Camera Space. There are a few things you have to keep in <span>mind, though.</span></p>
<p class="calibre3">When working with 3D scenes, you may want your UI to always face the player, regardless of how the player turns<a id="_idIndexMarker972" class="pcalibre pcalibre1 calibre6"/> the camera—this is known as a <em class="italic">billboard effect</em>. You can achieve this with a simple <strong class="source-inline">LookAt()</strong> function on the transform of the object in the <span><strong class="source-inline">Update()</strong></span><span> function:</span></p>
<pre class="source-code">
transform.LookAt(2*transform.position-theCamera.transform.position );</pre> <p class="calibre3">You can use a variation of the preceding code, depending on how you want the rotation <span>to behave.</span></p>
<p class="calibre3">Another consideration with 3D World Space UI is the distance it is away from the camera. You may want to have UI only render when it is a specific distance from the camera as it may be difficult to see when it is too <span>far away.</span></p>
<p class="calibre3">Depending on your project, using World Space Canvases may cause difficulties with Raycasting, making interacting with UI a problem. Tyrus Peace of Floating Island Games recommends creating your own physics layer if you end up having to create your own Raycasting system, as he did with <em class="italic">Cloudbase Prime</em>, shown earlier in <span>the chapter<a id="_idTextAnchor453" class="pcalibre pcalibre1 calibre6"/>.</span></p>
<h1 id="_idParaDest-265" class="calibre5"><a id="_idTextAnchor454" class="pcalibre pcalibre1 calibre6"/>Examples</h1>
<p class="calibre3">Working with World Space Canvases isn’t significantly different than working with Canvases in Screen and Camera Space. World Space Canvases offer many benefits. If you have an object that exists within your scene that has UI specifically tied to its location, it is helpful to use a World Space Canvas so that the UI follows it wherever it is. This removes the necessity of trying to convert the object’s World Space coordinates to Screen coordinates to ensure that the UI always lines up with the object. It also guarantees that the UI object will always display correctly with respect to the object’s location, even when the screen’s resolution changes. In this chapter, I will cover two common uses of World Space Canvases: one in 2D space and another in 3D space. Let’s begin with <span>2D space<a id="_idTextAnchor455" class="pcalibre pcalibre1 calibre6"/>.</span></p>
<h2 id="_idParaDest-266" class="calibre7"><a id="_idTextAnchor456" class="pcalibre pcalibre1 calibre6"/>2D World Space status indicators</h2>
<p class="calibre3">For this example, we will start a new scene. For you to not have to build out the scene, we will start with an Asset package that includes all <a id="_idIndexMarker973" class="pcalibre pcalibre1 calibre6"/>the <span>required items.</span></p>
<p class="calibre3">We’ll create UI that allows a character to have a status indicator pop up above his head. After the scene has played for 3 seconds, a status-indicating button will appear over the character’s head. Once the player clicks on the status indicator, a dialog will appear. After 5 seconds, the dialog will disappear. The status indicator will re-appear 10 <span>seconds later.</span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer571">
<img alt="Figure 16.13: 2D World Space UI example" src="image/B18327_16_13.jpg" class="calibre558"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.13: 2D World Space UI example</p>
<p class="calibre3">The art used in this example was accessed <span>from </span><a href="https://opengameart.org/content/medieval-rts-120" class="pcalibre pcalibre1 calibre6"><span>https://opengameart.org/content/medieval-rts-120</span></a><span>.</span></p>
<p class="calibre3">To create the status-indicating UI demonstrated by the previous example, complete the <span>following steps:</span></p>
<ol class="calibre13">
<li class="calibre14">Import the <span><strong class="source-inline">Chapter 16</strong></span><strong class="source-inline"> - Example 1-Start.unitypackage</strong> package. This package contains a scene with a background image and a 2D sprite named <strong class="source-inline">Mage</strong>. The <strong class="source-inline">Assets/Scripts/MageInteractions.cs</strong> script included with the package controls the timers on the appearance of the status indicator. This script requires two Canvas Group items—<strong class="source-inline">theExclamationPoint</strong> and <strong class="source-inline">theDialogBox</strong>—and contains a function, <strong class="source-inline">ShowTheDialogBox()</strong>, that can be called via a button’s <strong class="source-inline">On </strong><span><strong class="source-inline">Click()</strong></span><span> event.</span></li>
<li class="calibre14">We want the status indicator<a id="_idIndexMarker974" class="pcalibre pcalibre1 calibre6"/> and the dialog to be tied to the position of the <strong class="source-inline">Mage</strong> within the scene. Therefore, we will create a Canvas that is a child of the <strong class="source-inline">Mage</strong> in <span><strong class="bold">World Space</strong></span><span>.</span><p class="calibre3">Right-click on the <strong class="source-inline">Mage</strong> in the Hierarchy and add a UI Canvas as a child of <span>the </span><span><strong class="source-inline">Mage</strong></span><span>.</span></p></li>
<li class="calibre14">Select the newly created <strong class="source-inline">Canvas</strong>. Change the <strong class="bold">Render Mode</strong> on the <strong class="bold">Canvas</strong> component to <span><strong class="bold">World Space</strong></span><span>.</span></li>
<li class="calibre14">Assign the <strong class="source-inline">Main Camera</strong> to the <strong class="bold">Event </strong><span><strong class="bold">Camera</strong></span><span> slot.</span></li>
<li class="calibre14">Since this <strong class="source-inline">Canvas</strong> is a child of <strong class="source-inline">Mage</strong>, its coordinate system is relative to the <strong class="source-inline">Mage</strong>. To have it perfectly positioned over the <strong class="source-inline">Mage</strong>, change the <strong class="bold">Rect Transform</strong> component’s <strong class="bold">Pos X</strong> and <strong class="bold">Pos Y</strong> <span>to </span><span><strong class="source-inline">0</strong></span><span>.</span></li>
<li class="calibre14">The <strong class="source-inline">Canvas</strong> is significantly bigger than the <strong class="source-inline">Mage</strong>. Make the size more reasonable by changing the <strong class="bold">Rect Transform</strong> component’s <strong class="bold">Width</strong> and <strong class="bold">Height</strong> <span>to </span><span><strong class="source-inline">1</strong></span><span>.</span></li>
<li class="calibre14">Now that we have the <strong class="source-inline">Canvas</strong> scaled and positioned in the scene around the <strong class="source-inline">Mage</strong>, we can add UI elements to it. Right-click on <strong class="source-inline">Canvas</strong> in the Hierarchy and create a UI Button. Name the new <span>Button </span><span><strong class="source-inline">Alert</strong></span><span>.</span></li>
<li class="calibre14">Resize <strong class="source-inline">Alert</strong> to match the <strong class="source-inline">Canvas</strong> by setting its <strong class="bold">Rect Transform</strong> component’s stretch and anchor to stretch fully across <span>the Canvas.</span></li>
<li class="calibre14">Change the <strong class="bold">Source Image</strong> on the <strong class="source-inline">Alert</strong> Button’s <strong class="bold">Image</strong> component to the UI <strong class="source-inline">Knob</strong> image. It looks better as a circle than as the default <span>button sprite:</span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer572">
<img alt="Figure 16.14: Selecting the UI Knob image" src="image/B18327_16_14.jpg" class="calibre559"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.14: Selecting the UI Knob image</p>
<ol class="calibre13">
<li value="10" class="calibre14">Change the <strong class="source-inline">Text</strong> child of <strong class="source-inline">Alert</strong> to display an exclamation point instead <span>of </span><span><strong class="source-inline">Button</strong></span><span>.</span></li>
<li class="calibre14">The Button’s text is not <a id="_idIndexMarker975" class="pcalibre pcalibre1 calibre6"/>currently visible. To fix this, change the <strong class="bold">Dynamic Pixels Per Unit</strong> property on the <strong class="bold">Canvas Scalar</strong> component of Canvas <span>to </span><span><strong class="source-inline">1000</strong></span><span>.</span></li>
<li class="calibre14">Move the <strong class="source-inline">Alert</strong> Button so that it is positioned over the <span><strong class="source-inline">Mage</strong></span><span>’s head.</span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer573">
<img alt="Figure 16.15: Moving the exclamation point over the Mage’s head" src="image/B18327_16_15.jpg" class="calibre560"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.15: Moving the exclamation point over the Mage’s head</p>
<ol class="calibre13">
<li value="13" class="calibre14">Add a <strong class="bold">Canvas Group</strong> component to the <span><strong class="source-inline">Alert</strong></span><span> Button.</span></li>
<li class="calibre14">Set the <strong class="bold">Canvas Group</strong> component’s <strong class="bold">Alpha</strong> property to <strong class="source-inline">0</strong> and set both the <strong class="bold">Interactable</strong> and <strong class="bold">Blocks Raycasts</strong> properties <span>to </span><span><strong class="source-inline">False</strong></span><span>.</span></li>
<li class="calibre14">Give the <strong class="source-inline">Alert</strong> Button an <strong class="bold">On Click()</strong> event that calls the <strong class="source-inline">ShowTheDialogBox()</strong> function <a id="_idIndexMarker976" class="pcalibre pcalibre1 calibre6"/>on the <strong class="source-inline">MageInteractions</strong> script attached to <span>the </span><span><strong class="source-inline">Mage</strong></span><span>:</span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer574">
<img alt="Figure 16.16: The On Click() event of the Alert Button" src="image/B18327_16_16.jpg" class="calibre561"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.16: The On Click() event of the Alert Button</p>
<ol class="calibre13">
<li value="16" class="calibre14">Right-click on <strong class="source-inline">Canvas</strong> in the Hierarchy and create a UI Text object. Name the new Text <span>object </span><span><strong class="source-inline">Dialog</strong></span><span>.</span></li>
<li class="calibre14">Resize the <strong class="source-inline">Dialog</strong> object to match the <strong class="source-inline">Canvas</strong> by setting its <strong class="bold">Rect Transform</strong> component’s stretch and anchor to stretch fully across <span>the </span><span><strong class="source-inline">Canvas</strong></span><span>.</span></li>
<li class="calibre14">Change the <strong class="bold">Text</strong> component on the <strong class="source-inline">Dialog</strong> object to say <strong class="source-inline">Thanks!!!</strong>. Also, center-align the text and set the <strong class="bold">Horizontal Overflow</strong> property <span>to </span><span><strong class="bold">Overflow</strong></span><span>.</span></li>
<li class="calibre14">Move the <strong class="source-inline">Dialog</strong> object so<a id="_idIndexMarker977" class="pcalibre pcalibre1 calibre6"/> that it is positioned above the head of the <strong class="source-inline">Mage</strong>, <span>like so:</span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer575">
<img alt="Figure 16.17: The Dialog box" src="image/B18327_16_17.jpg" class="calibre562"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.17: The Dialog box</p>
<ol class="calibre13">
<li value="20" class="calibre14">Add a <strong class="bold">Canvas Group</strong> component to the <strong class="source-inline">Dialog</strong> <span>Text object.</span></li>
<li class="calibre14">Set the <strong class="bold">Canvas Group</strong> component’s <strong class="bold">Alpha</strong> property to <strong class="source-inline">0</strong> and set both the <strong class="bold">Interactable</strong> and the <strong class="bold">Blocks Raycasts</strong> properties <span>to </span><span><strong class="source-inline">False</strong></span><span>.</span></li>
<li class="calibre14">Select the <strong class="source-inline">Mage</strong> and add <strong class="source-inline">Alert</strong> to the <strong class="bold">The Exclamation Point</strong> property. Add <strong class="source-inline">Dialog</strong> to the <strong class="bold">The Dialog </strong><span><strong class="bold">Box</strong></span><span> property.</span></li>
</ol>
<p class="calibre3">If you play the game, you’ll see the exclamation point Button appear after 3 seconds. Clicking on the Button will make the Text appear. Try moving the Mage character around in the scene. You’ll see that no matter where he is, the exclamation point Button and Text appear over his head. This is a really helpful technique for creating UI elements that stay with <span>moving characters.</span></p>
<p class="calibre3">I know that the example is a bit boring the way it is now, but I recommend using some of the techniques discussed in the previous two chapters to add a nice bouncy animation to the exclamation point <a id="_idIndexMarker978" class="pcalibre pcalibre1 calibre6"/>and have the Text fade in <span>and ou<a id="_idTextAnchor457" class="pcalibre pcalibre1 calibre6"/>t.</span></p>
<h2 id="_idParaDest-267" class="calibre7"><a id="_idTextAnchor458" class="pcalibre pcalibre1 calibre6"/>3D hovering health bars</h2>
<p class="calibre3">Making World Space UI in a 3D scene takes a little <a id="_idIndexMarker979" class="pcalibre pcalibre1 calibre6"/>more work than making World Space UI in a 2D scene if the camera can be rotated and moved throughout the 3D space. If the camera can move and rotate, the UI likely needs to constantly <em class="italic">face</em> the camera. Otherwise, the player will not be able to see the <span>UI elements.</span></p>
<p class="calibre3">For this example, we will once again create a new scene. For you to not have to build the scene from scratch, we will start with an Asset package that includes all the <span>required items.</span></p>
<p class="calibre3">We’ll create a simple hovering health bar that constantly faces the camera. It will also receive clicks so that we can watch the health <span>bar reduce:</span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer576">
<img alt="Figure 16.18: Astronaut with a hovering health bar" src="image/B18327_16_18.jpg" class="calibre563"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.18: Astronaut with a hovering health bar</p>
<p class="calibre3">The art used in this example was accessed <span>from </span><a href="https://opengameart.org/content/space-kit" class="pcalibre pcalibre1 calibre6"><span>https://opengameart.org/content/space-kit</span></a><span>.</span></p>
<p class="calibre3">To create a health bar that always faces the camera and receives player-click input, complete the <span>following steps:</span></p>
<ol class="calibre13">
<li class="calibre14">Import the <span><strong class="source-inline">Chapter 16</strong></span><strong class="source-inline"> – Example 2 - Start.unitypackage</strong> package. This package contains a scene with a 3D character facing the camera. The camera has a simple <strong class="source-inline">RotatingCamera</strong> script attached to it that rotates the camera around the astronaut with the mouse. The package also contains a <strong class="source-inline">ReduceHealth</strong> script that is attached to the <strong class="source-inline">astronaut</strong> character. This script has a function, <strong class="source-inline">ReduceHealthBar</strong>, that we will call when the health bar above the character’s head is <span>clicked on.</span></li>
<li class="calibre14">We want the health bar to be tied to the position of the astronaut within the scene. Therefore, we will <a id="_idIndexMarker980" class="pcalibre pcalibre1 calibre6"/>create a Canvas that is a child of the astronaut in <span>World Space.</span><p class="calibre3">Right-click on the <strong class="source-inline">astronaut</strong> in the Hierarchy and add a UI Canvas as a child of <span>the </span><span><strong class="source-inline">astronaut</strong></span><span>.</span></p></li>
<li class="calibre14">Select the newly created <strong class="source-inline">Canvas</strong> and change the <strong class="bold">Render Mode</strong> on the <strong class="bold">Canvas</strong> component to <span><strong class="bold">World Space</strong></span><span>.</span></li>
<li class="calibre14">Assign the <strong class="source-inline">Camera</strong> to the <strong class="bold">Event </strong><span><strong class="bold">Camera</strong></span><span> slot.</span></li>
<li class="calibre14">Since this <strong class="source-inline">Canvas</strong> is a child of <strong class="source-inline">astronaut</strong>, its coordinate system is relative to <strong class="source-inline">astronaut</strong>. To have it perfectly positioned over the <strong class="source-inline">astronaut</strong>, change the <strong class="bold">Rect Transform</strong> component’s <strong class="bold">Pos X</strong> and <strong class="bold">Pos Y</strong> <span>to </span><span><strong class="source-inline">0</strong></span><span>.</span></li>
<li class="calibre14">The <strong class="source-inline">Canvas</strong> is significantly bigger than the <strong class="source-inline">astronaut</strong>. Make the size more reasonable by changing the <strong class="bold">Rect Transform</strong> component’s <strong class="bold">Width</strong> to <strong class="source-inline">10</strong> and the <strong class="bold">Height</strong> <span>to </span><span><strong class="source-inline">1</strong></span><span>.</span></li>
<li class="calibre14">Position the Canvas so that it is above the head of <span>the astronaut:</span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer577">
<img alt="Figure 16.19: Scaling the Canvas over the astronaut" src="image/B18327_16_19.jpg" class="calibre564"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.19: Scaling the Canvas over the astronaut</p>
<ol class="calibre13">
<li value="8" class="calibre14">Now that we have the <strong class="source-inline">Canvas</strong> scaled and<a id="_idIndexMarker981" class="pcalibre pcalibre1 calibre6"/> positioned in the scene around the astronaut, we can add UI elements to it. Right-click on <strong class="source-inline">Canvas</strong> in the Hierarchy and create a UI Button. Name the new button <span><strong class="source-inline">Health Bar</strong></span><span>.</span></li>
<li class="calibre14">Resize the <strong class="source-inline">Health Bar</strong> to match the <strong class="source-inline">Canvas</strong> by setting its <strong class="bold">Rect Transform</strong> component’s stretch and anchor to stretch fully across <span>the </span><span><strong class="source-inline">Canvas</strong></span><span>.</span></li>
<li class="calibre14">Change the <strong class="bold">Source Image</strong> on the <strong class="bold">Image</strong> component of the <strong class="source-inline">Health Bar</strong> to <strong class="bold">None</strong> to give it a white rectangle as <span>an image.</span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer578">
<img alt="Figure 16.20: Adding a blank image to the Button" src="image/B18327_16_20.jpg" class="calibre565"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.20: Adding a blank image to the Button</p>
<ol class="calibre13">
<li value="11" class="calibre14">Change the <strong class="source-inline">Text</strong> child of <strong class="source-inline">Health Bar</strong> to say <strong class="source-inline">Click to reduce </strong><span><strong class="source-inline">my health</strong></span><span>.</span></li>
<li class="calibre14">Set both the <strong class="bold">Horizontal Overflow</strong> and <strong class="bold">Vertical Overflow</strong> properties of the <strong class="bold">Text</strong> component on the <strong class="source-inline">Text</strong> child to <strong class="bold">Overflow</strong>. This will allow you to see the size the text is currently<a id="_idIndexMarker982" class="pcalibre pcalibre1 calibre6"/> rendering at in <span>the scene:</span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer579">
<img alt="Figure 16.21: The oversized text of the Health Bar" src="image/B18327_16_21.jpg" class="calibre566"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.21: The oversized text of the Health Bar</p>
<ol class="calibre13">
<li value="13" class="calibre14">Set the <strong class="bold">Text</strong>’s <strong class="bold">Font Size</strong> to <strong class="source-inline">10</strong> and deselect <strong class="bold">Raycast Target</strong> on the <span><strong class="bold">Text</strong></span><span> component.</span></li>
<li class="calibre14">Select the <strong class="source-inline">Canvas</strong> and hover over the <strong class="bold">Dynamic Pixels Per Unit</strong> property in the <strong class="bold">Canvas Scaler</strong> component until you see two arrows appear around your mouse cursor. Once you see those arrows, click, and drag to the right. This makes the property work like a slider, allowing<a id="_idIndexMarker983" class="pcalibre pcalibre1 calibre6"/> you to see how increasing the <strong class="bold">Dynamic Pixels Per Unit</strong> property continuously changes the way the text renders in the scene. Do this until the text fits within <span>the Canvas:</span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer580">
<img alt="Figure 16.22: The oversized text of the Health Bar" src="image/B18327_16_22.jpg" class="calibre567"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.22: The oversized text of the Health Bar</p>
<p class="callout-heading">Note</p>
<p class="callout">When trying to get the text to look nice in 3D space, if only changing the <strong class="bold">Dynamic Pixels Per Unit Size</strong> results in <em class="italic">choppy</em> text, change the property until the text looks perfectly crisp in the scene. Then, use a combination of changing the <strong class="bold">Rect Transform</strong> component’s <strong class="bold">Scale</strong> and <strong class="bold">Font Size</strong> of the Text object to find the <span><em class="italic">sweet spot</em></span><span>.</span></p>
<ol class="calibre13">
<li value="15" class="calibre14">Right-click on the <strong class="source-inline">Health Bar</strong> Button and add a UI Image as a child. Name the new Image <span><strong class="source-inline">Health Fill</strong></span><span>.</span></li>
<li class="calibre14">Resize <strong class="source-inline">Health Fill</strong> to match the Canvas <strong class="source-inline">Health Bar</strong> by setting its <strong class="bold">Rect Transform</strong> component’s stretch and anchor to stretch fully across the <span><strong class="source-inline">Health Bar</strong></span><span>.</span></li>
<li class="calibre14">Now, change the anchor and <a id="_idIndexMarker984" class="pcalibre pcalibre1 calibre6"/>pivot to <strong class="bold">left</strong> <strong class="bold">stretch</strong> so that it will <span>scale </span><span><em class="italic">leftward</em></span><span>.</span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer581">
<img alt="Figure 16.23: Left-stretching anchor" src="image/B18327_16_23.jpg" class="calibre568"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.23: Left-stretching anchor</p>
<ol class="calibre13">
<li value="18" class="calibre14">Reposition the <strong class="source-inline">Health Bar</strong> in the Hierarchy so that it is above <strong class="source-inline">Text</strong>. This will have the fill render behind the <span><strong class="source-inline">Text</strong></span><span> object.</span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer582">
<img alt="Figure 16.24: The Hierarchy of GameObjects" src="image/B18327_16_24.jpg" class="calibre569"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.24: The Hierarchy of GameObjects</p>
<ol class="calibre13">
<li value="19" class="calibre14">On the <strong class="bold">Image</strong> component of the <strong class="source-inline">Health Fill</strong>, change the <strong class="bold">Color</strong> property to red and deselect the <strong class="bold">Raycast </strong><span><strong class="bold">Target</strong></span><span> property.</span></li>
<li class="calibre14">Select the astronaut and<a id="_idIndexMarker985" class="pcalibre pcalibre1 calibre6"/> assign the <strong class="source-inline">Health Fill</strong> object to the <strong class="bold">Health Fill</strong> property on the <span><strong class="source-inline">ReduceHealth</strong></span><span> component.</span></li>
<li class="calibre14">Add an <strong class="bold">On Click()</strong> event to the <strong class="source-inline">Health Bar</strong> Button that calls the <strong class="source-inline">ReduceHealthBar</strong> function of the <strong class="source-inline">ReduceHealth</strong> script on <span>the astronaut:</span>
<div class="calibre2">
<div class="img---figure" id="_idContainer583">
<img alt="Figure 16.25: The OnClick() event of the Health Bar" src="image/B18327_16_25.jpg" class="calibre570"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.25: The OnClick() event of the Health Bar</p>
<p class="calibre3">Playing the game now should result in the <strong class="source-inline">Health Fill</strong> reducing its fill value when you click on the <strong class="source-inline">Health </strong><span><strong class="source-inline">Bar</strong></span><span> Button:</span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer584">
<img alt="Figure 16.26: The Health Bar button reducing" src="image/B18327_16_26.jpg" class="calibre571"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.26: The Health Bar button reducing</p></li>
</ol>
<ol class="calibre13">
<li value="22" class="calibre14">Now, we just need to add a billboard effect to the <strong class="source-inline">Canvas</strong>. Create a new script called <strong class="source-inline">BillboardPlane</strong> in the <span><strong class="source-inline">Assets/Scripts</strong></span><span> folder.</span></li>
<li class="calibre14">Change the script of the <strong class="source-inline">BillboardPlane</strong> class to <span>the following:</span><pre class="source-code">
public Camera theCamera;
void Update()
{
    transform.LookAt(2 * transform.position - theCamera.transform.position);
}</pre></li> <li class="calibre14">Attach the <strong class="source-inline">BillboardPlane</strong> script to <span>the Canvas.</span></li>
<li class="calibre14">Assign the <strong class="source-inline">Camera</strong> to the <strong class="bold">Camera</strong> slot in the <span><strong class="source-inline">BillboardPlane</strong></span><span> component.</span></li>
</ol>
<p class="calibre3">If you play the game now, you’ll see <a id="_idIndexMarker986" class="pcalibre pcalibre1 calibre6"/>that as you move the camera around, the health bar always faces the <strong class="source-inline">Camera</strong>. Try changing the <strong class="bold">Transform</strong> position of the camera in the scene to see the <strong class="source-inline">LookAt()</strong> function work <span>more drastically<a id="_idTextAnchor459" class="pcalibre pcalibre1 calibre6"/>.</span></p>
<h1 id="_idParaDest-268" class="calibre5"><a id="_idTextAnchor460" class="pcalibre pcalibre1 calibre6"/>Summary</h1>
<p class="calibre3"><strong class="bold">World Space</strong> UI is not significantly different in its implementation than UI that renders in the Camera or Screen Space. Adding UI to your World Space gives you the ability to create cool effects and gives you more control over your UI’s position relative to objects in <span>the scene.</span></p>
<p class="calibre3">In the next chapter, we will discuss how to optimize <span>Unity UI.</span></p>
</div>
</div></body></html>