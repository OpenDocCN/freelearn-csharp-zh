<html><head></head><body>
		<div id="_idContainer213">
			<h1 id="_idParaDest-118"><em class="italic"><a id="_idTextAnchor120"/>Chapter 6</em>: Purchasing In-Game Items and Advertisements</h1>
			<p>In this chapter, we will continue with building our shop scene by adding functionality such as introducing the player's in-game currency and looking at how to deduct and increase it. </p>
			<p>Monetization is when a game is free to download (typically titled <strong class="bold">free-to-play</strong>) and the developer encourages or offers the player to buy items, such as the latest weapon, extra art modification visuals, and more, with the player's real money (with a bank/debit card). Another way of creating profit from a free-to-play game is by offering adverts that are incorporated into the game. For example, if the player wants a new ship or an extra life, they can watch a 30-second advert at no real monetary cost to them, but as the developer, we can receive revenue when an advert is watched. Of course, a balance must be considered when a game is made, and some companies will use all sorts of addictive psychology to encourage the player to buy upgrades or watch as many adverts as possible. This could lead a single player to sometimes pay well into the thousands of their real money. It is up to you how you want to plan and make your own game outside of this book; but for this chapter, we will create our own shop that offers players the chance to watch an advert to gain extra in-game credits.</p>
			<p>We will cover the following topics in this chapter:</p>
			<ul>
				<li>Buying upgrades for our player's ship</li>
				<li>Buying items, watching adverts, and preparing to start a game</li>
				<li>Extending the <strong class="source-inline">PlayerSpawner</strong> script</li>
			</ul>
			<p>By the end of this chapter, we will understand the process of when to trigger an advert and how we can reward the player, while giving constant feedback. We will make use of the asset store and Unity's online dashboard system.</p>
			<p>Let's get started!</p>
			<h1 id="_idParaDest-119"><a id="_idTextAnchor121"/>The core exam skills covered in this chapter</h1>
			<p><em class="italic">We will cover programming core interactions in this chapter</em>:</p>
			<ul>
				<li>Implementing and configuring game object behavior and physics</li>
				<li>Implementing and configuring inputs and controls</li>
			</ul>
			<p><em class="italic">We will also cover developing application systems</em>:</p>
			<ul>
				<li>Interpreting scripts for the application interface flow, such as menu systems, UI navigation, and application settings</li>
				<li>Interpreting scripts for user-controlled customization, such as character creators, inventories, storefronts, and in-app purchases</li>
				<li>Analyzing scripts for user progression features, such as scoring, leveling, and in-game economies, utilizing technologies such as Unity Analytics and PlayerPrefs</li>
				<li>Analyzing scripts for two-dimensional overlays, such as <strong class="bold">Heads-Up Displays</strong> (<strong class="bold">HUDs</strong>), minimaps, and advertisements</li>
				<li>Identifying scripts for saving and retrieving application and user data</li>
			</ul>
			<p><em class="italic">We will also cover programming for scene and environment design</em>:</p>
			<ul>
				<li>Identifying methods for implementing game object instantiation, destruction, and management</li>
			</ul>
			<p><em class="italic">Finally, we will cover working in professional software development teams</em>:</p>
			<ul>
				<li>Recognizing techniques for structuring scripts for modularity, readability, and reusability</li>
			</ul>
			<h1 id="_idParaDest-120"><a id="_idTextAnchor122"/>Technical requirements</h1>
			<p>The project content for this chapter can be found at <a href="https://github.com/PacktPublishing/Unity-Certified-Programmer-Exam-Guide-Second-Edition/tree/main/Chapter_06">https://github.com/PacktPublishing/Unity-Certified-Programmer-Exam-Guide-Second-Edition/tree/main/Chapter_06</a>.</p>
			<p>You can download the entirety of each chapter's project files at <a href="https://github.com/PacktPublishing/Unity-Certified-Programmer-Exam-Guide-Second-Edition">https://github.com/PacktPublishing/Unity-Certified-Programmer-Exam-Guide-Second-Edition</a>.</p>
			<p>All of the content for this chapter is held in the chapter's <strong class="source-inline">unitypackage</strong> file. There is no <strong class="source-inline">Complete</strong> folder for this chapter.</p>
			<p>Check out the following video to see the <em class="italic">Code in Action</em>: <a href="https://bit.ly/3MASWFJ">https://bit.ly/3MASWFJ</a>.</p>
			<h1 id="_idParaDest-121"><a id="_idTextAnchor123"/>Buying upgrades for our player's ship</h1>
			<p>In this section, we will<a id="_idIndexMarker577"/> cover the process of buying upgrades for our player's ship. This includes the following:</p>
			<ul>
				<li>Credit balance</li>
				<li>Option to buy</li>
				<li>Letting the player know the item has been sold</li>
			</ul>
			<p>The following screenshot shows our shop scene with its selection grid and two purchased items marked as <strong class="bold">SOLD</strong>. Above the selection grid, to the left, is the user's current in-game bank balance and an image showing what the player's ship currently looks like with the two upgrades applied. Lastly, to the right is the option to buy the currently selected item, which is <strong class="bold">C. Bomb</strong>:</p>
			<div>
				<div id="_idContainer194" class="IMG---Figure">
					<img src="image/Figure_6.01_B18381.jpg" alt="Figure 6.1 – Our shop scene with currency, a sold sign, and an option to buy&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.1 – Our shop scene with currency, a sold sign, and an option to buy</p>
			<p>In this section, we will return to the script that is responsible for purchasing upgrades and applying them to the player's ship. In the <strong class="source-inline">PlayerShipBuild</strong> script, we will add global variables that will hold the player's weapon upgrades in an array, as well as game object buttons and the player's in-bank balance.</p>
			<p>We will then hook up each of these new variables to the text and game object buttons in our scene<a id="_idIndexMarker578"/> and from there, we will add our own methods to turn buttons on or off and to determine whether the player has enough in-game credits to make purchases.</p>
			<p>Let's start by entering these new variables into our shop scene by going to the <strong class="bold">Project</strong> window and opening the <strong class="source-inline">PlayerShipBuild</strong> script in the <strong class="source-inline">Assets/Script</strong> folder:</p>
			<ol>
				<li>Enter the following variables to our <strong class="source-inline">PlayerShipBuild</strong> script:<p class="source-code">[SerializeField]</p><p class="source-code">GameObject[] visualWeapons;</p><p class="source-code">[SerializeField]</p><p class="source-code">SOActorModel defaultPlayerShip;</p><p class="source-code">GameObject playerShip;</p><p class="source-code">GameObject buyButton;</p><p class="source-code">GameObject bankObj;</p><p class="source-code">int bank = 600;</p><p class="source-code">bool purchaseMade = false;</p></li>
			</ol>
			<p>We have mainly added game objects that hold the visualization of our shop scene, but we have also added a scriptable object that's used to give the player's ship its own property values, such as speed, health, what type of bullets are used, and more. We will make use of some of these variables in the next code block.</p>
			<ol>
				<li value="2">Next, we will update the <strong class="source-inline">PlayerShipBuild</strong> script by adding code to the <strong class="source-inline">Start</strong> function<a id="_idIndexMarker579"/> by getting a reference to the bank game object and the <strong class="bold">BUY?</strong> button in our shop scene:<p class="source-code">purchaseMade = false;</p><p class="source-code">bankObj = GameObject.Find("bank");</p><p class="source-code">bankObj.GetComponentInChildren&lt;TextMesh&gt;().text = bank.ToString();</p><p class="source-code">buyButton = textBoxPanel.transform.Find("BUY ?").gameObject;</p><p class="source-code">TurnOffPlayerShipVisuals();</p><p class="source-code">PreparePlayerShipForUpgrade();</p></li>
			</ol>
			<p>This code resets or assigns the variables to game objects in the <strong class="bold">Hierarchy</strong> window of the Unity Editor. I will explain these variables briefly here and go into more detail when we use them:</p>
			<ul>
				<li><strong class="source-inline">purchaseMade</strong> is a Boolean variable that will only accept a <strong class="source-inline">true</strong> or <strong class="source-inline">false</strong> value. We are setting it to <strong class="source-inline">false</strong> here as a form of reset.</li>
				<li><strong class="source-inline">bankObj</strong>: In the <strong class="bold">Hierarchy</strong> window, we have a game object called <strong class="source-inline">bank</strong>. We are assigning that game object of this variable for later.</li>
				<li>We then take the <strong class="source-inline">bank</strong> integer, which currently contains a value of <strong class="source-inline">600</strong>, and we cast (assign) it as a <strong class="source-inline">string</strong> value so that it displays the value in our shop scene under the three-dimensional model of the player's ship.</li>
				<li>The last variable is then assigned the <strong class="source-inline">BUY ?</strong> game object so that we can activate and deactivate the buy functionality whenever required in the <strong class="bold">Scene</strong> or <strong class="bold">Game</strong> window.</li>
				<li><strong class="source-inline">TurnOffPlayerShipVisuals</strong>: This method will reset the visuals of the player's ship.</li>
				<li><strong class="source-inline">PreparePlayerShipForUpgrade</strong>: This method creates a player's ship so that when it has all the upgrades applied, it can be sent into the game to be played.</li>
			</ul>
			<ol>
				<li value="3">Now that <a id="_idIndexMarker580"/>we have our variables made and assigned, we can move on to the conditions of the code. Scroll down in the script until you get to the following line:<p class="source-code">if (target.transform.Find("itemText"))</p></li>
				<li>Within the <strong class="source-inline">if</strong> statement, we are going to check whether the item we are attempting to buy has not already sold out in the shop (the only reason for an item to be sold out is because we have already bought it) and that we can afford it:<p class="source-code">if (target.transform.Find("itemText"))</p><p class="source-code"> { </p><p class="source-code">    TurnOffSelectionHighlights();</p><p class="source-code">    Select();</p><p class="source-code">    UpdateDescriptionBox();</p><p class="source-code"> //NOT ALREADY SOLD</p><p class="source-code"> if (target.transform.Find("itemText").GetComponent&lt;TextMesh&gt;().</p><p class="source-code">    text != "SOLD")</p><p class="source-code"> {</p><p class="source-code">    //can afford</p><p class="source-code">    Affordable();</p><p class="source-code">    //can not afford</p><p class="source-code">    LackOfCredits();</p><p class="source-code"> }</p><p class="source-code"> else if (target.transform.Find("itemText").GetComponent</p><p class="source-code">    &lt;TextMesh&gt;().text == "SOLD")</p><p class="source-code"> {</p><p class="source-code">    SoldOut();</p><p class="source-code"> }</p><p class="source-code">}</p></li>
			</ol>
			<p>We start by<a id="_idIndexMarker581"/> entering a comment to notify ourselves or any other programmer that at this point in the code, we are going to check whether the item we are attempting to buy is not already sold out. From here, we add an <strong class="source-inline">if</strong> statement condition that checks the <strong class="source-inline">target</strong> variable (the item we raycasted, as mentioned in the <em class="italic">Selecting game objects with raycasts</em> section of the previous chapter) to see whether it contains a <strong class="source-inline">TextMesh</strong> component holding a <strong class="source-inline">string</strong> (text) value that doesn't already hold the <strong class="source-inline">"SOLD"</strong> value. If it does, then we run the <strong class="source-inline">SoldOut</strong> method.</p>
			<p>If the item hasn't already sold out, then we run two methods—the first is <strong class="source-inline">Affordable</strong>, which means we're going to check whether we can buy the item with the current amount of credit we have. If we don't have enough credit, the <strong class="source-inline">LackOfCredits</strong> method is run.</p>
			<p>We have created three new methods, called <strong class="source-inline">Affordable</strong>, <strong class="source-inline">LackOfCredits</strong>, and <strong class="source-inline">SoldOut</strong>; let's now go through each one, starting with <strong class="source-inline">Affordable</strong>.</p>
			<ol>
				<li value="5">Outside of <a id="_idIndexMarker582"/>the <strong class="source-inline">AttemptSelection</strong> method, add the following code:<p class="source-code">  void Affordable()</p><p class="source-code">  {</p><p class="source-code">    if (bank &gt;=  System.Int32.Parse(target.transform.</p><p class="source-code">       GetComponent&lt;ShopPiece&gt;().ShopSelection.cost))</p><p class="source-code">    {</p><p class="source-code">      Debug.Log("CAN BUY");</p><p class="source-code">      buyButton.SetActive(true);</p><p class="source-code">    }</p><p class="source-code">  }</p></li>
			</ol>
			<p>The <strong class="source-inline">Affordable</strong> method checks whether the <strong class="source-inline">bank</strong> integer (which currently contains the value <strong class="source-inline">600</strong>) is equal or greater than the value of the button that we have selected (<strong class="source-inline">target</strong>).</p>
			<p>Next is an <strong class="source-inline">if</strong> statement that checks whether the <strong class="source-inline">bank</strong> integer value is greater than or equal to the <strong class="source-inline">string cost</strong> value of the selected item. Because we can't compare the value of a <strong class="source-inline">string</strong> variable to an <strong class="source-inline">int</strong> variable, we need to convert the <strong class="source-inline">string</strong> variable to an <strong class="source-inline">int</strong> variable. To do this, we use <strong class="source-inline">System.Int32.Parse()</strong> and enter the <strong class="source-inline">ShopSelection.cost</strong> string value in the parse brackets.</p>
			<p>If we can buy the item, then we set <strong class="source-inline">buyButton</strong> to active, which is a button the player can press to buy the item. Above <strong class="source-inline">buyButton.SetActive(true)</strong> is a log to Unity's <strong class="bold">Console</strong> window to confirm that a purchase is being made for bug-checking purposes.</p>
			<ol>
				<li value="6">The second method we wrote earlier was the <strong class="source-inline">LackOfCredits</strong> method, which checks in a similar way by casting the <strong class="source-inline">TextMesh</strong> component value if it's less than<a id="_idIndexMarker583"/> the <strong class="source-inline">bank</strong> integer value. If it is, we send a <strong class="source-inline">"CAN'T BUY"</strong> message to Unity's <strong class="bold">Console</strong> window:<p class="source-code">  void LackOfCredits()</p><p class="source-code">  {</p><p class="source-code">    if (bank &lt; System.Int32.Parse(target.transform.Find</p><p class="source-code">      ("itemText").GetComponent&lt;TextMesh&gt;().text))</p><p class="source-code">    {</p><p class="source-code">      Debug.Log("CAN'T BUY");</p><p class="source-code">    }</p><p class="source-code">  }</p><p class="callout-heading">Tip</p><p class="callout">There are multiple ways to get a reference from a game object and we use them throughout this book.</p><p class="callout">In the previous code, <strong class="source-inline">.Find</strong> is much slower compared to something like <strong class="source-inline">.GetComponent</strong> used on its own. <strong class="source-inline">.Find</strong> has to go through each game object until it finds the matching string—if it even exists.</p><p class="callout">We could also compare performance versus flexibility as well—for example, <strong class="source-inline">transform.GetChild</strong> (<a href="https://docs.unity3d.com/ScriptReference/Transform.GetChild.html">https://docs.unity3d.com/ScriptReference/Transform.GetChild.html</a>) will get the child that is specific to the number given to it in its parameter, which is also faster than using <strong class="source-inline">.Find</strong>. However, if the game object's hierarchy has changed during development, this would cause an error as it is no longer able to find the game object. The same could be said for <strong class="source-inline">.GetComponent</strong>, which can cause errors if it doesn't exist in the code.</p></li>
				<li>The third is the <strong class="source-inline">SoldOut</strong> method, which is currently set to log to the Unity Editor <strong class="bold">Console</strong> window saying <strong class="source-inline">SOLD OUT</strong>, but yet again, we could add other functionality to <a id="_idIndexMarker584"/>this at a later date, such as applying a sound effect or playing an animation:<p class="source-code">  void SoldOut()</p><p class="source-code">  {</p><p class="source-code">    Debug.Log("SOLD OUT");</p><p class="source-code">  }</p></li>
				<li>Make two empty methods. We will fill their content in later on in the chapter:<p class="source-code">void TurnOffPlayerShipVisuals()</p><p class="source-code">{</p><p class="source-code">}</p><p class="source-code">void PreparePlayerShipForUpgrade()</p><p class="source-code">{</p><p class="source-code">}</p></li>
				<li>Save the script and return to the Unity Editor.</li>
			</ol>
			<p>Reflecting on this section, we have coded in our variables and assigned them when the script begins with the <strong class="source-inline">Start</strong> function. We have also coded in a few methods that check the balance credit compared to the selected value.</p>
			<p>We can now move on to updating our player ship's visuals in the shop scene and we can also see what <a id="_idIndexMarker585"/>the player's ship looks like in the game.</p>
			<h2 id="_idParaDest-122"><a id="_idTextAnchor124"/>Updating visual representations of our player's ship</h2>
			<p>In this<a id="_idIndexMarker586"/> section, we are going to code in capability so that the player's ship visuals update when a purchase is made and create and update another ship behind the scenes so that it can be sent on to the next scene to play.</p>
			<p>In the <em class="italic">Selecting game objects with raycasts</em> section of the previous chapter, we dragged and dropped our <strong class="source-inline">SelectionQuad</strong> game objects from the <strong class="bold">Hierarchy</strong> window into the <strong class="bold">Inspector</strong> window.</p>
			<p>The following screenshot shows the majority of the <strong class="source-inline">shop</strong> game objects grayed out on the <strong class="bold">Inspector</strong> window so that we can focus on the new variable entries under <strong class="bold">Visual Weapons</strong>:</p>
			<div>
				<div id="_idContainer195" class="IMG---Figure">
					<img src="image/Figure_6.02_B18381.jpg" alt="Figure 6.2 – Visual Weapons displaying what will be attached to the player's ship&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.2 – Visual Weapons displaying what will be attached to the player's ship</p>
			<p>To update the housing of the potential player ship upgrades, we need to apply the following to the <strong class="source-inline">Visual Weapons</strong> game object array using the previous screenshot as reference:</p>
			<ol>
				<li value="1">Change the <strong class="bold">Size</strong> value to <strong class="source-inline">3</strong>.</li>
				<li>For the three empty game object fields, click on the circle on the right of the field, and in the dropdown, begin typing <strong class="source-inline">energy +1</strong> into the search bar.</li>
				<li>As soon as you see <strong class="bold">energy + 1</strong>, double-click it.</li>
				<li>Repeat this process for <strong class="source-inline">c. Bomb</strong>.</li>
				<li>Repeat this process for <strong class="source-inline">b. Shot</strong>.</li>
				<li>Lastly, update the <strong class="bold">Default Player Ship</strong> scriptable object field with the <strong class="source-inline">Player_Default</strong> asset file via the small remote circle to the right of it. We will<a id="_idIndexMarker587"/> go into more detail about this when we put it into practice in code.</li>
				<li>Save the scene and return to the <strong class="source-inline">PlayerShipBuild</strong> script.</li>
				<li>We can now enter the content for our <strong class="source-inline">TurnOffPlayerShipVisuals</strong> method. This method is implemented in the <strong class="source-inline">Start</strong> function to simply reset the scene so that the only visual representation is the three-dimensional model of the player's ship: <p class="source-code"> void TurnOffPlayerShipVisuals()</p><p class="source-code"> {</p><p class="source-code">   for (int i = 0; i &lt; visualWeapons.Length; i++)</p><p class="source-code"> {</p><p class="source-code">   visualWeapons[i].gameObject.SetActive(false);</p><p class="source-code"> }</p><p class="source-code">}</p></li>
			</ol>
			<p>The code runs a <strong class="source-inline">for</strong> loop that goes through each of the game objects in the array of the <strong class="source-inline">Visual Weapons</strong> object that we dragged and dropped into the <strong class="bold">Inspector</strong> window.</p>
			<p>We have updated our player's ship model so that when we buy an item, it will update in the <strong class="bold">Scene</strong>/<strong class="bold">Game</strong> window by simply manipulating the activity of our game objects.</p>
			<p>We are <a id="_idIndexMarker588"/>now going to focus more on the player's ship code and the two other buttons on the selection grid—<strong class="bold">BUY?</strong> and <strong class="bold">WATCH AD</strong>.</p>
			<h2 id="_idParaDest-123"><a id="_idTextAnchor125"/>Preparing our player's ship to be used in the game</h2>
			<p>This section is<a id="_idIndexMarker589"/> aimed at preparing our player's ship so that it can be sent to the next scene to play. We will create a standard ship first that the player will not be able to see, apart from a visual representation of it (there are two ships in the scene but the player can only see one).</p>
			<p>So, if the player makes some purchases in our shop, we need to create a ship and add its visual and physical upgrades so that we can see it in action in the next scene.</p>
			<p>We need to return to the <strong class="source-inline">PlayerShipBuild</strong> script and add the content to our empty <strong class="source-inline">PreparePlayerShipForUpgrade</strong> method to help support making a player's ship with its new upgrades:</p>
			<p class="source-code">  void PreparePlayerShipForUpgrade()</p>
			<p class="source-code">  {</p>
			<p class="source-code">    playerShip = GameObject.Instantiate(defaultPlayerShip.    actor);</p>
			<p class="source-code">       </p>
			<p class="source-code">    playerShip.GetComponent&lt;Player&gt;().enabled = false;</p>
			<p class="source-code">    playerShip.transform.position = new Vector3(0,10000,0);</p>
			<p class="source-code">    playerShip.GetComponent&lt;IActorTemplate&gt;</p>
			<p class="source-code">       ().ActorStats(defaultPlayerShip);</p>
			<p class="source-code">  }</p>
			<p>The method creates (<strong class="source-inline">instantiates</strong>) a <strong class="source-inline">Player_Ship</strong> game object from the <strong class="source-inline">Resources</strong> folder. We then turn off (<strong class="source-inline">enabled</strong> = <strong class="source-inline">false</strong>) its own script attachment; otherwise, we would be able to move and shoot with it in the shop scene.</p>
			<p>We then move the <strong class="source-inline">Player_Ship</strong> object completely out of the <strong class="bold">Scene</strong>/<strong class="bold">Game</strong> window view.</p>
			<p>Finally, we assign it the <strong class="source-inline">defaultPlayerShip</strong> asset file that we dragged and dropped into the scriptable object field in the <strong class="bold">Inspector</strong> window in the previous section.</p>
			<p>In this section, we revisited the <strong class="source-inline">PlayerShipBuild</strong> script and added more global variables and functionality to support the shop scene. Our game now has an in-game credit score and works out whether the player can afford a game item or not; the rest of the code in this section was for hiding game objects and preparing our player's ship to be carried over into the game scene.</p>
			<p>In the next section, we will carry on with the <strong class="source-inline">PlayerShipBuild</strong> script and look into actually starting<a id="_idIndexMarker590"/> a game to play with the player's ship. We will also look at how the player can buy in-game credits by watching adverts with the use of the Unity dashboard and Unity Monetization from the Asset store.</p>
			<h1 id="_idParaDest-124"><a id="_idTextAnchor126"/>Buying items, watching adverts, and preparing to start a game</h1>
			<p>In this <a id="_idIndexMarker591"/>section, we<a id="_idIndexMarker592"/> will look at adding three more buttons to our shop <a id="_idIndexMarker593"/>scene. The first is <strong class="source-inline">BUY?</strong> for when we want to purchase an item. The second is <strong class="source-inline">Watch Ad</strong>—as soon as the player presses this button, an advert will load; once it's finished, the player is rewarded with <strong class="source-inline">300</strong> credits. Lastly, we'll add the <strong class="source-inline">START</strong> button, which will take the player to the <strong class="source-inline">testLevel</strong> scene with the upgrades they have purchased (if any).</p>
			<p>We need to head back to the <strong class="source-inline">PlayerShipBuild</strong> script and scroll down to the <strong class="source-inline">AttemptSelection</strong> method, where we will add three <strong class="source-inline">else if</strong> statements to launch three different types of methods. The reason for this is that the three selections don't follow on from the scriptable object buttons; therefore, these items will never have outcomes such as <strong class="source-inline">SOLD</strong> or <strong class="source-inline">itemText</strong>.</p>
			<p>The following screenshot shows the complete <strong class="source-inline">AttemptSelection</strong> method with the focus drawn to the other three non-scriptable object buttons:</p>
			<div>
				<div id="_idContainer196" class="IMG---Figure">
					<img src="image/Figure_6.03_B18381.jpg" alt="Figure 6.3 – Our shop buttons with three alternative methods to load when pressed&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.3 – Our shop buttons with three alternative methods to load when pressed</p>
			<p>We are<a id="_idIndexMarker594"/> going to<a id="_idIndexMarker595"/> look<a id="_idIndexMarker596"/> at the <strong class="source-inline">BUY?</strong> button first as it relates to what we are covering in this section.</p>
			<h2 id="_idParaDest-125"><a id="_idTextAnchor127"/>Setting up the BUY? button</h2>
			<p>In this<a id="_idIndexMarker597"/> section, we will be hooking up the <strong class="bold">BUY?</strong> button so that it appears at the right time in the description panel. This button will only be displayed if the player hasn't already bought the item and if they have enough credits.</p>
			<p>The following screenshot shows our shop scene with the <strong class="bold">BUY?</strong> button highlighted:</p>
			<div>
				<div id="_idContainer197" class="IMG---Figure">
					<img src="image/Figure_6.04_B18381.jpg" alt="Figure 6.4 – BUY? button&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.4 – BUY? button</p>
			<p>Let's make a start by coding the <strong class="bold">BUY?</strong> button to work in our <strong class="source-inline">PlayerShipBuild</strong> script:</p>
			<ol>
				<li value="1">Open the <strong class="source-inline">PlayerShipBuild</strong> script.</li>
				<li>Scroll down to the <strong class="source-inline">AttemptSelection</strong> method after the curly brace, as in the following snippet:<p class="source-code">if (target.transform.Find("itemText"))</p><p class="source-code">        {</p><p class="source-code">            //CODE WE HAVE ENTERED...</p><p class="source-code">            //CODE WE HAVE ENTERED...</p><p class="source-code">            //CODE WE HAVE ENTERED...</p><p class="source-code">        }</p><p class="source-code">            &lt;---- BEGIN CODING "ELSE IF" HERE</p></li>
				<li>Add the following <strong class="source-inline">else if</strong> code, as indicated in the preceding code. We can also use the screenshot from the previous section as a reference:<p class="source-code">        else if(target.name == "BUY ?")</p><p class="source-code">        {</p><p class="source-code">          BuyItem();</p><p class="source-code">        }</p></li>
				<li>So, if the <a id="_idIndexMarker598"/>player clicks on the <strong class="bold">BUY?</strong> button (<strong class="source-inline">target.name</strong> equals the name of <strong class="bold">BUY?</strong>), a <strong class="source-inline">BuyItem</strong> method is called. Inside this method, the following code is executed: <p class="source-code">  void BuyItem()</p><p class="source-code">  {</p><p class="source-code">    Debug.Log("PURCHASED");</p><p class="source-code">    purchaseMade = true;</p><p class="source-code">    buyButton.SetActive(false);</p><p class="source-code">    tmpSelection.SetActive(false);</p></li>
			</ol>
			<p>We message the <strong class="bold">Console</strong> window in the Editor with a note that a purchase has been made for the Editor's debugging purposes to make sure that this area of code is acknowledged. This doesn't affect our code in any other way. We then set <strong class="source-inline">purchaseMade</strong> to <strong class="source-inline">true</strong>. This Boolean value is used later when we leave the shop scene to start the game. If <strong class="source-inline">purchaseMade</strong> is <strong class="source-inline">true</strong>, a set of procedures follows. The next line turns off the <strong class="source-inline">buyButton</strong> function as we no longer need to display the results. Finally, we remove the selection from the grid at the bottom of the screen as a refresh.</p>
			<p>Following on from the <strong class="source-inline">BuyItem</strong> method, we now turn our focus to the <strong class="source-inline">visualWeapons</strong> game object, which, if you remember from earlier in this chapter, covers the visual representation of what we have bought and what our player ship will look like when playing in a game.</p>
			<ol>
				<li value="5">Continuing on inside the <strong class="source-inline">BuyItem</strong> method, add the following code to name and make <a id="_idIndexMarker599"/>all cases of <strong class="source-inline">visualWeapons</strong> active:<p class="source-code">for (int i = 0; i &lt; visualWeapons.Length; i++)</p><p class="source-code"> {</p><p class="source-code">   if (visualWeapons[i].name ==</p><p class="source-code">     tmpSelection.transform.parent.gameObject.</p><p class="source-code">          GetComponent&lt;ShopPiece&gt;().ShopSelection.iconName)</p><p class="source-code">      {</p><p class="source-code">        visualWeapons[i].SetActive(true);</p><p class="source-code">      }</p><p class="source-code"> }</p></li>
			</ol>
			<p>We run a <strong class="source-inline">for</strong> loop to count how many <strong class="source-inline">visualWeapons</strong> objects we have in the array. Within the <strong class="source-inline">if</strong> statement, we check each <strong class="source-inline">visualWeapon</strong> name from the array to see whether it matches with the selection made in the selection grid's name. If it does, then we turn that particular <strong class="source-inline">visualWeapon</strong> object on so that we can see it in the shop selection.</p>
			<ol>
				<li value="6">Continuing on in the <strong class="source-inline">BuyItem</strong> method, we add another method to send our upgrades to our player's ship, along with our <strong class="source-inline">bank</strong> credit, with the following code:<p class="source-code">UpgradeToShip(tmpSelection.transform.parent.gameObject.GetComponent</p><p class="source-code">    &lt;ShopPiece&gt;().ShopSelection.iconName);</p><p class="source-code">  bank = bank - System.Int32.Parse(tmpSelection.transform.parent.</p><p class="source-code">     GetComponent&lt;ShopPiece&gt;().ShopSelection.cost);</p><p class="source-code"> </p><p class="source-code"> bankObj.transform.Find("bankText").GetComponent&lt;TextMesh&gt;().text </p><p class="source-code">     = bank.ToString();</p><p class="source-code"> tmpSelection.transform.parent.transform.Find("itemText").</p><p class="source-code">     GetComponent&lt;TextMesh&gt;().text = "SOLD";</p><p class="source-code">}</p></li>
			</ol>
			<p>We run another method, called <strong class="source-inline">UpgradeToShip</strong>. This method will load the game object<a id="_idIndexMarker600"/> of the item purchased to the player ship we play in our game; we will go into further detail about this method shortly.</p>
			<p>Next, we deduct from the <strong class="source-inline">bank</strong> value (using <strong class="source-inline">System.Int32.Parse</strong>, so it reads the <strong class="source-inline">string</strong> value as an <strong class="source-inline">int</strong> value) with the selection's <strong class="source-inline">cost</strong> scriptable object. We then represent the deduction by grabbing the reference from the bank's game object, called <strong class="source-inline">bankText</strong>, and updating its <strong class="source-inline">text</strong> value in the <strong class="source-inline">TextMesh</strong> component.</p>
			<p>Finally, we update the selection from the selection grid that the item has been sold. This is updated to the button's value text.</p>
			<p>That brings us to the end of the <strong class="source-inline">BuyItem</strong> method. But, as mentioned, we run the <strong class="source-inline">UpgradeToShip</strong> method, which loads the game object of that particular ship part and attaches it to a ship that is away from the screen.</p>
			<ol>
				<li value="7">Still, in the <strong class="source-inline">PlayerShipBuild</strong> script, let's add the <strong class="source-inline">UpgradeToShip</strong> method:<p class="source-code"> void UpgradeToShip(string upgrade)</p><p class="source-code"> {</p><p class="source-code"> GameObject shipItem = GameObject.Instantiate(Resources.Load</p><p class="source-code">    (upgrade)) as GameObject;</p><p class="source-code"> shipItem.transform.SetParent(playerShip.transform);</p><p class="source-code"> shipItem.transform.localPosition = Vector3.zero; </p><p class="source-code"> }</p></li>
			</ol>
			<p>The <strong class="source-inline">UpgradeToShip</strong> method <a id="_idIndexMarker601"/>takes a <strong class="source-inline">string</strong> parameter titled <strong class="source-inline">upgrade</strong>. Earlier, we sent it the following line of code:</p>
			<p class="source-code">tmpSelection.transform.parent.gameObject.GetComponent</p>
			<p class="source-code">   &lt;ShopPiece&gt;().ShopSelection.iconName</p>
			<p>This line of code came from the selection's scriptable object item name. This item's name (<strong class="source-inline">ShopSelection.iconName</strong>) is sent to <strong class="source-inline">UpgradeToShip</strong> as a <strong class="source-inline">string</strong> name (<strong class="source-inline">upgrade</strong>).</p>
			<p>Inside the <strong class="source-inline">UpgradeToShip</strong> method, we create (<strong class="source-inline">instantiate</strong>) a game object in the resources folder from the name of the shop's selection icon and store it in a game object variable, <strong class="source-inline">shipItem</strong>.</p>
			<p>We then attach this <strong class="source-inline">shipItem</strong> game object to our <strong class="source-inline">playerShip</strong> object. This is the <strong class="source-inline">playerShip</strong> object that is not in the <strong class="bold">Game</strong> window view but will be sent to the next scene—the game-playing scene.</p>
			<p>The <strong class="source-inline">shipItem</strong> game object's local position (its position compared to its parent game object, <strong class="source-inline">playerShip</strong>) is set to <strong class="source-inline">0</strong> (that is, its <em class="italic">x</em>, <em class="italic">y</em>, and <em class="italic">z</em> positions are set to <strong class="source-inline">0</strong>).</p>
			<ol>
				<li value="8">Save the script and return to the Unity Editor.</li>
				<li>Click on the <strong class="bold">Play</strong> button to begin play mode, and in the <strong class="bold">Game</strong> window, select the first item in the selection grid.</li>
			</ol>
			<p>We should now have the ability to buy this item. If we click on buy, the button will no longer say the value, but instead will display <strong class="bold">SOLD</strong>, and the <strong class="bold">BUY?</strong> button will disappear if we attempt to select the same item again.</p>
			<p>We have two <a id="_idIndexMarker602"/>buttons left to hook up and then we will have a fully functioning shop. Let's continue with the <strong class="bold">START</strong> button.</p>
			<h2 id="_idParaDest-126"><a id="_idTextAnchor128"/>Setting up the START button</h2>
			<p><strong class="bold">START</strong> is the <a id="_idIndexMarker603"/>button the player presses when they want to leave the shop scene and move on to playing the game. </p>
			<p>The following screenshot shows where the <strong class="bold">START</strong> button is located in the shop scene:</p>
			<div>
				<div id="_idContainer198" class="IMG---Figure">
					<img src="image/Figure_6.07_B18381.jpg" alt="Figure 6.5 – START button&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.5 – START button</p>
			<p>So, we can recall that in the previous section, we were coding in our <strong class="source-inline">AttemptSelection</strong> method, which runs when the player presses one of the buttons on the selection grid in the shop.</p>
			<p>At the bottom of this method are three <strong class="source-inline">else if</strong> statements. We have already set up one of the three buttons, the <strong class="bold">BUY?</strong> button, in the previous section. We will now move on to the next <strong class="source-inline">else if</strong> statement, which is the <strong class="bold">START</strong> button. The following<a id="_idIndexMarker604"/> screenshot shows the reference to the <strong class="source-inline">AttemptSelection</strong> method:</p>
			<div>
				<div id="_idContainer199" class="IMG---Figure">
					<img src="image/Figure_6.06_B18381.jpg" alt="Figure 6.6 – START button will load the StartGame() method&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.6 – START button will load the StartGame() method</p>
			<p>Next, we will be making sure that our player has purchased an item or upgrade from the shop (if anything) and load our first level:</p>
			<ol>
				<li value="1">So, at the bottom of the <strong class="source-inline">AttemptSelection</strong> method in our <strong class="source-inline">PlayerBuild</strong> script, enter the following <strong class="source-inline">if</strong> statement:<p class="source-code">        else if(target.name == "START")</p><p class="source-code">        {</p><p class="source-code">          StartGame();</p><p class="source-code">        }</p></li>
			</ol>
			<p>When our <strong class="source-inline">target</strong> game object selection carries the <strong class="source-inline">START</strong> game object name, we fall into the <strong class="source-inline">else if</strong> statement and run the <strong class="source-inline">StartGame</strong> method. This method is small and the majority of its code depends on whether a purchase has been made. </p>
			<ol>
				<li value="2">Continuing on<a id="_idIndexMarker605"/> in our <strong class="source-inline">PlayerShipBuild</strong> script, add the <strong class="source-inline">StartGame</strong> method:<p class="source-code">  void StartGame()</p><p class="source-code">  { </p><p class="source-code">      if (purchaseMade)</p><p class="source-code">  {</p><p class="source-code">    playerShip.name = "UpgradedShip";</p><p class="source-code">    if (playerShip.transform.Find("energy +1(Clone)"))</p><p class="source-code">    {</p><p class="source-code">       playerShip.GetComponent&lt;Player&gt;().Health = 2;</p><p class="source-code">    } </p><p class="source-code">    DontDestroyOnLoad(playerShip);</p><p class="source-code">   }</p><p class="source-code">   UnityEngine.SceneManagement.SceneManager.LoadScene("testLevel");</p><p class="source-code">  }</p></li>
			</ol>
			<p>If <strong class="source-inline">purchaseMade</strong> is set to <strong class="source-inline">true</strong>, we fall into the <strong class="source-inline">if</strong> statement and name our <strong class="source-inline">playerShip</strong> game object <strong class="source-inline">"UpgradedShip"</strong>. We then check whether the <strong class="source-inline">playerShip</strong> object has made a purchase for more health (<strong class="source-inline">"energy +1(Clone)"</strong>). If the player has bought more health, we will set our <strong class="source-inline">playerShip</strong> object's <strong class="source-inline">health</strong> value to <strong class="source-inline">2</strong>. This means that our player can get hit twice before dying.</p>
			<p>The <strong class="source-inline">DontDestroyOnLoad</strong> function takes the argument of <strong class="source-inline">playerShip</strong>, which means when the next scene loads, the <strong class="source-inline">playerShip</strong> game object will be carried over to the next scene.</p>
			<p>Finally, we start our <strong class="source-inline">testLevel</strong> scene.</p>
			<ol>
				<li value="3">Save the script.</li>
			</ol>
			<p>So, after a purchase (or no purchase) is made, our shop scene will close and our <strong class="source-inline">testLevel</strong> will open with or without any purchases made. However we will not see the visual upgrades until we update our <strong class="source-inline">PlayerSpawner</strong> script later on in the chapter.</p>
			<p>Return to the<a id="_idIndexMarker606"/> Unity Editor and run <strong class="bold">Play</strong> mode to check whether the player ship upgrade is carried over.</p>
			<p>Let's now move on to the final <strong class="source-inline">if else</strong> statement—the <strong class="bold">WATCH AD</strong> button.</p>
			<h2 id="_idParaDest-127"><a id="_idTextAnchor129"/>Setting up the WATCH AD button</h2>
			<p>The last <a id="_idIndexMarker607"/>button we will be covering in this chapter is the <strong class="bold">WATCH AD</strong> button. In a lot of mobile devices' (Android's/iOS') free-to-play games (the game is free to play but makes money back with in-game purchases or adverts), the option for the player to enhance their experience with the game is to receive upgrades and modifications, gain in-game credits, and more if the player watches a 30-second advert. After watching the advert, the player is rewarded with credit. In this section, we are going to create this functionality with our code and Unity's online dashboard.</p>
			<p>The following screenshot shows the location of the <strong class="bold">WATCH AD</strong> button in the selection grid:</p>
			<div>
				<div id="_idContainer200" class="IMG---Figure">
					<img src="image/Figure_6.07_B183811.jpg" alt=""/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.7 – WATCH AD button</p>
			<p>We need to<a id="_idIndexMarker608"/> turn on Unity's ad services in the Unity Editor and follow these steps:</p>
			<ol>
				<li value="1">As before, if the <strong class="bold">Services</strong> tab isn't available, we can find it under the Unity Editor <strong class="bold">Window</strong> tab | <strong class="bold">General</strong>, followed by <strong class="bold">Services</strong>, as in the following screenshot:</li>
			</ol>
			<div>
				<div id="_idContainer201" class="IMG---Figure">
					<img src="image/Figure_6.08_B18381.jpg" alt="Figure 6.8 – Services location&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.8 – Services location</p>
			<ol>
				<li value="2">Click<a id="_idIndexMarker609"/> on the <strong class="bold">Services</strong> tab and select <strong class="bold">Ads</strong>, as in the following screenshot:</li>
			</ol>
			<div>
				<div id="_idContainer202" class="IMG---Figure">
					<img src="image/Figure_6.09_B18381.jpg" alt="Figure 6.9 – Turning Ads ON&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.9 – Turning Ads ON</p>
			<p>In the previous screenshot, you may have a warning notification at the top of the <strong class="bold">Services</strong> window <a id="_idIndexMarker610"/>saying you don't have a project ID (marked with an <strong class="bold">*</strong> in the screenshot). If you don't have this warning, you can skip the next set of instructions and set up the Ads service.</p>
			<p>To fix the issue with no project ID set up, we need to attach ours by doing the following:</p>
			<ol>
				<li value="1">When we click the <strong class="bold">Ads</strong> section in the <strong class="bold">Services</strong> window, the <strong class="bold">Project Settings</strong> window appears. In the <strong class="bold">Project Settings</strong> window, <strong class="bold">Services</strong> would be expanded out from the list and <strong class="bold">Ads</strong> will be selected, as shown in the following screenshot:</li>
			</ol>
			<div>
				<div id="_idContainer203" class="IMG---Figure">
					<img src="image/Figure_6.10_B18381.jpg" alt="Figure 6.10 – Project Settings with no project ID&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.10 – Project Settings with no project ID</p>
			<ol>
				<li value="2">Click on <strong class="bold">Select organization</strong> under the <strong class="bold">Create a Unity Project ID</strong> heading.</li>
			</ol>
			<p>Your <a id="_idIndexMarker611"/>organization will be on the list. Click on it (this was created when you created your account with Unity. Mine is called retrophil).</p>
			<ol>
				<li value="3">Click the <strong class="bold">Create project ID</strong> button.</li>
			</ol>
			<p>It's likely the <strong class="bold">Console</strong> window will give off a few warnings, errors, and so on. Do not worry about these for now. Keep your attention on the <strong class="bold">Project Settings</strong> window.</p>
			<p>Next, you will be presented with the following update to the <strong class="bold">Project Settings</strong> window:</p>
			<div>
				<div id="_idContainer204" class="IMG---Figure">
					<img src="image/Figure_6.11_B18381.jpg" alt="Figure 6.11 – Project linked successfully&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.11 – Project linked successfully</p>
			<p>Let's continue<a id="_idIndexMarker612"/> setting up <strong class="bold">Ads</strong> in our project:</p>
			<ol>
				<li value="1">We are asked if our app is targeted at children under age 13. Our project isn't targeted for children in that range, so select <strong class="bold">No</strong> from the drop-down list.</li>
				<li>Click <strong class="bold">Save</strong>.</li>
			</ol>
			<p>Our project is now ready to have <strong class="bold">Ads</strong> turned on.</p>
			<ol>
				<li value="3">Click <strong class="bold">OFF</strong> to turn our <strong class="bold">Ads</strong> service <strong class="bold">ON</strong>, as shown in the following screenshot:</li>
			</ol>
			<div>
				<div id="_idContainer205" class="IMG---Figure">
					<img src="image/Figure_6.12_B18381.jpg" alt="Figure 6.12 – Ads Package&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.12 – Ads Package</p>
			<ol>
				<li value="4">Finally, we need to activate the <strong class="bold">Monetization</strong> service via <strong class="bold">Dashboard</strong>. To do that, click the <strong class="bold">Dashboard</strong> link in the <strong class="bold">Ads</strong> section. This will load the Unity Dashboard in a browser. In the <strong class="bold">Monetization</strong> section click <strong class="bold">Complete Activation</strong>, then <strong class="bold">Unity Ads</strong>. You will then be allocated your Game Ids. Return to the Unity Editor.</li>
			</ol>
			<p>By the time you're reading this book, it is likely there will be an update for the Ads Package; if<a id="_idIndexMarker613"/> possible, install 3.7.5 still as it's likely the later version will have a different/unfinished setup, meaning the following instructions will likely not relate or there might be unfinished methods. But if you want to (or have to) install the latest version, be sure to follow the Unity Ads documentation: <a href="https://docs.unity.com/ads/UnityAdsHome.html">https://docs.unity.com/ads/UnityAdsHome.html</a>.</p>
			<p>We are now at the point where Unity Ads is connected to our project. The <strong class="bold">Project Settings</strong> window also displays our Game Id for Android and iOS operating systems. These IDs are references for our game that the Google Play and Apple App Store will use to identify our game when it comes to sending adverts.</p>
			<p>Each game ID will be different, so your game ID will be different from mine. When it comes to entering your game ID code, make sure you refer to yours, not mine.</p>
			<p>We can now return to our <strong class="source-inline">PlayerShipBuild</strong> script and make a start with hooking up <a id="_idIndexMarker614"/>our <strong class="bold">WATCH AD</strong> button to display adverts.</p>
			<h3>Attaching Unity reward adverts to our script</h3>
			<p>In this <a id="_idIndexMarker615"/>section, we are going to take placement information and extra functionality from the <strong class="bold">Advertisement</strong> library to create our reward adverts:</p>
			<ol>
				<li value="1">In the Unity Editor, from the <strong class="bold">Project</strong> window, navigate to the <strong class="source-inline">Assets/Script</strong> folder, then take the following steps.</li>
				<li>Open the <strong class="source-inline">PlayerShipBuild</strong> script and at the top of the code that we need, import two extra libraries alongside our <strong class="source-inline">UnityEngine</strong> library:<p class="source-code"><strong class="bold">using System.Collections;</strong></p><p class="source-code"><strong class="bold">using UnityEngine;</strong></p><p class="source-code"><strong class="source-inline">using UnityEngine.Advertisements;</strong></p></li>
			</ol>
			<p><strong class="source-inline">System.Collections</strong> contain extra tools, such as <strong class="source-inline">IEnumerator</strong>, which is used for the <strong class="source-inline">StartCoroutine</strong> functions, which we will cover shortly.</p>
			<p>The other line of code imports Unity's <strong class="bold">Advertisement</strong> library, which we downloaded from our Ads Service, which will also be displayed in our Package Manager. Also, make sure you have Android selected as your platform in Build Settings. </p>
			<p class="callout-heading">What Is the Package Manager?</p>
			<p class="callout">Unity holds most of its add-ons/extra software and updates for components in the Package Manager. We can also check for updates for these packages. If you would like to know more about the Package Manager, check out the following link: <a href="https://docs.unity3d.com/Manual/Packages.html">https://docs.unity3d.com/Manual/Packages.html</a>.</p>
			<p>Next, we will add two interfaces to our <strong class="source-inline">PlayerShipBuild</strong> script as they are required for the Ads Services to work, <strong class="source-inline">IUnityAdsInitializationListener</strong> and <strong class="source-inline">IUnityAdsListener</strong>, and implement these in our class. These interfaces will give us callback (a callback is a method that runs when a process is done executing a specific task) methods to tell us what state our ads are in and when we can add code, such as rewards.</p>
			<p class="callout-heading">Further Information</p>
			<p class="callout">If you would like to know more about the Ads content, you can check out the Unity Documentation here: <a href="https://docs.unity.com/ads/UnityAPI.html">https://docs.unity.com/ads/UnityAPI.html</a>.</p>
			<p>Carrying on with the <strong class="source-inline">PlayerShipBuild</strong> script, we declare our class as follows:</p>
			<p class="source-code">public class PlayerShipBuild : MonoBehaviour, IUnityAdsListener, IUnityAdsInitializationListener</p>
			<p>Our script will <a id="_idIndexMarker616"/>underline these interfaces with error lines because we haven't implemented their methods. We can do this now and fill them out correctly later.</p>
			<p>Instead of typing the required methods out, we can highlight one of the interfaces in Visual Studio and let it type out the methods for us:</p>
			<ol>
				<li value="1">Continuing with the <strong class="source-inline">PlayerShipBuild</strong> script, highlight one of the interfaces with your mouse.</li>
			</ol>
			<div>
				<div id="_idContainer206" class="IMG---Figure">
					<img src="image/Figure_6.13_B18381.jpg" alt="Figure 6.13 – Highlighted interface&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.13 – Highlighted interface</p>
			<ol>
				<li value="2">A dropdown will appear with what needs adding to our class. Click on <strong class="bold">Show potential fixes</strong>.</li>
			</ol>
			<div>
				<div id="_idContainer207" class="IMG---Figure">
					<img src="image/Figure_6.14_B18381.jpg" alt="Figure 6.14 – Show potential fixes dialog box&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.14 – Show potential fixes dialog box</p>
			<ol>
				<li value="3">We will then be presented with a list of methods (A). Click <strong class="bold">Document</strong> (B) to confirm you <a id="_idIndexMarker617"/>want these added to our <strong class="source-inline">PlayerShipBuild</strong> class.</li>
				<li>If a box appears asking to confirm the changes, click <strong class="bold">Apply</strong>.</li>
				<li>Repeat this process for the other interface.</li>
				<li>Once done, scroll down to the bottom of the <strong class="source-inline">PlayerShipBuild</strong> script to see our extra methods.</li>
			</ol>
			<p>As mentioned, we will return to these methods and fill them out with regard to adding debug messages if an error occurs. The main method will be the <strong class="source-inline">OnUnityAdsDidFinish</strong> method, because that's where we will be rewarding the player with credit to their bank after watching an advert.</p>
			<p>We will now continue adding the variables that will hold the ids to distinguish what platform we are running on:</p>
			<ol>
				<li value="1">Scroll back up to the top of the <strong class="source-inline">PlayerShipBuild</strong> script and add the following global variables with the others:<p class="source-code">  [SerializeField] string androidGameId;</p><p class="source-code">  [SerializeField] string iOSGameId;</p><p class="source-code">  [SerializeField] bool testMode = true;</p><p class="source-code">  string adId = null;</p></li>
			</ol>
			<p><strong class="source-inline">androidGameId</strong> and <strong class="source-inline">iOSGameId</strong> will hold the game IDs that we saw earlier when setting up the Ads Service in the <strong class="bold">Project Settings</strong> folder.</p>
			<p><strong class="source-inline">testMode</strong> is set to <strong class="source-inline">true</strong>. On an actual device under test mode, you'll get a proper Unity video test ad. You can test skipping or watching it in full. When you disable test <a id="_idIndexMarker618"/>mode for release, live video ads from Unity Ads advertisers will appear.</p>
			<p><strong class="source-inline">adId</strong> will hold a string that will be an ID for what type of advert you want to load. We will go into this a bit more shortly.</p>
			<p>Seeing as we have made our new variables accessible from the <strong class="bold">Inspector</strong> window with the <strong class="source-inline">SerializeField</strong> attribute, we can add our Android and iOS Game Ids to these variables next.</p>
			<ol>
				<li value="2">Before we add any more code, save your <strong class="source-inline">PlayerShipBuild</strong> script and return to the Editor.</li>
				<li>In your shop scene, expand out the <strong class="bold">ShopManager</strong> game object in the <strong class="bold">Hierarchy</strong> window.</li>
				<li>Expand out <strong class="bold">BuyingSelection</strong> as well.</li>
				<li>Select the <strong class="bold">shop</strong> game object.</li>
				<li>In the <strong class="bold">Inspector</strong> window, we can see blank spaces for our Ids.</li>
				<li>So, all we need to do is open our <strong class="bold">Project Settings</strong> window.</li>
				<li>Select <strong class="bold">Services</strong> then <strong class="bold">Ads</strong> from the list.</li>
				<li>Copy the <strong class="bold">Android</strong> ID and paste it into the <strong class="bold">Android Game Id</strong> field in the <strong class="bold">Inspector</strong> window.</li>
				<li>Copy the <strong class="bold">iOS</strong> ID and <a id="_idIndexMarker619"/>paste that into the <strong class="bold">IOS Game Id</strong> field in the <strong class="bold">Inspector</strong> window.</li>
			</ol>
			<div>
				<div id="_idContainer208" class="IMG---Figure">
					<img src="image/Figure_6.15_B18381.jpg" alt="Figure 6.15 – Copy Game id from Project Settings to Inspector&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.15 – Copy Game id from Project Settings to Inspector</p>
			<p>We now need to add a function in our <strong class="source-inline">PlayerShipBuild</strong> script, that checks which device (iPhone/Samsung) is running our game. When we know which device is running, we can add the correct game ID and reward id to our advertisement initializer:</p>
			<ol>
				<li value="1">So, we can add an <strong class="source-inline">Awake</strong> function and inside it, we will call a function that we haven't added yet:<p class="source-code">void Awake()</p><p class="source-code">{</p><p class="source-code">CheckPlatform();</p><p class="source-code">}</p></li>
				<li>Now, we can move on to declaring the <strong class="source-inline">CheckPlatform</strong> function; in the next line down from the <strong class="source-inline">Awake</strong> function, we can add the following:<p class="source-code">  void CheckPlatform()</p><p class="source-code">  {</p><p class="source-code">    string<a id="_idIndexMarker620"/> gameId = null;</p></li>
			</ol>
			<p>We've declared our function name and added a <strong class="source-inline">gameId</strong> variable that defaults to null.</p>
			<ol>
				<li value="3">Next, we will use conditional compilation to differentiate between what platform we are playing our game on so we can hook up the correct ids:<p class="source-code">    #if UNITY_IOS</p><p class="source-code">    {</p><p class="source-code">      gameId = iOSGameId;</p><p class="source-code">      adId = "Rewarded_iOS";</p><p class="source-code">    }</p></li>
			</ol>
			<p>So, if we are using an iPhone/iPad device, we will assign the iOS game id to the variable called <strong class="source-inline">gameId</strong>. We will also be assigning the iOS reward to <strong class="source-inline">adId</strong>:  </p>
			<p class="source-code"><strong class="source-inline">    </strong>#elif UNITY_ANDROID</p>
			<p class="source-code">    {</p>
			<p class="source-code">      gameId = androidGameId;</p>
			<p class="source-code">      adId = "Rewarded_Android";</p>
			<p class="source-code">    }</p>
			<p class="source-code">    #endif</p>
			<p>And, as you've <a id="_idIndexMarker621"/>probably guessed, we have an "else if" (it is spelled <strong class="source-inline">elif</strong>) that checks for an Android operating system (Samsung, Google Pixel devices, and so on).</p>
			<ol>
				<li value="4">Finally, we send the chosen <strong class="source-inline">gameId</strong> and its test mode condition and receive our Unity Ads callback:<p class="source-code">    Advertisement.Initialize(gameId, testMode, false, this);</p><p class="source-code">  }</p><p class="callout-heading">Further Information</p><p class="callout">If you would like to know more about conditional compilation, check out this link: <a href="https://docs.unity3d.com/Manual/PlatformDependentCompilation.html">https://docs.unity3d.com/Manual/PlatformDependentCompilation.html</a>.</p></li>
			</ol>
			<p>As you can imagine, when we load up our <strong class="source-inline">SHOP</strong> scene, our game checks to see whether it's being played through a portable device. If it is being played through a portable device, it will send the correct ids out to Unity. Next, we will need to load the advert so if the player does request an advert, we have it ready to show.</p>
			<p>The next step is to load our advert with a small function. First, we need to check to see whether the Advertisement has finished initializing:</p>
			<ol>
				<li value="1">To check and load an advert for our game scroll up to the <strong class="source-inline">Start</strong> function and enter the following:<p class="source-code">StartCoroutine(WaitForAd());</p></li>
			</ol>
			<p>A coroutine will give us the ability to wait until the advert is initialized.</p>
			<ol>
				<li value="2">Outside<a id="_idIndexMarker622"/> of the <strong class="source-inline">Start</strong> function, enter the following code to check for when our advert can begin to load ready for the player:<p class="source-code">  IEnumerator WaitForAd()</p><p class="source-code">  {</p><p class="source-code">    while (!Advertisement.isInitialized)</p><p class="source-code">    {</p><p class="source-code">      yield return null;</p><p class="source-code">    }</p><p class="source-code">    LoadAd();</p><p class="source-code">  }</p></li>
			</ol>
			<p>The code will loop until our <strong class="source-inline">Advertisement</strong> is initialized.  Once it is initialized, the <strong class="source-inline">LoadAd</strong> method will run.</p>
			<p>The <strong class="source-inline">LoadAd</strong> method will add an event listener, which will callback to our methods when specific tasks have been completed (when an advert is ready to be viewed, if there was an error, if the advert has started playing) that we've implemented from our two interfaces. The other thing the <strong class="source-inline">LoadAd</strong> method will do is take whichever advert id has been sent to it and load an advert specifically for the platform.</p>
			<p>The next method is for our <strong class="source-inline">PlayerShipBuild</strong> script to load the advert ready.</p>
			<ol>
				<li value="3">Type the following:<p class="source-code">  void LoadAd()</p><p class="source-code">      {</p><p class="source-code">    Advertisement.AddListener(this);</p><p class="source-code">    Advertisement.Load(adId);</p><p class="source-code">  }</p></li>
			</ol>
			<p>It's important to<a id="_idIndexMarker623"/> note, whenever a Listener is added, remember to remove it when it's no longer required. If a listener is made, and the object is destroyed, this can cause issues as the listener may still be active. Also, if another listener is added that is doing the same job, you would be doubling or tripling callbacks, which in our case would mean doubling and tripling players' shop credits.</p>
			<p>We can now move on to setting up the <strong class="source-inline">WatchAdvert</strong> function, which will be the beginning of our advert to trigger on mobile devices when the player presses the <strong class="bold">WATCH AD</strong> button:</p>
			<ol>
				<li value="1">Still in the <strong class="source-inline">PlayerShipBuild</strong> script, scroll down to the <strong class="source-inline">AttemptSelection</strong> method, where we already have the two <strong class="source-inline">else if</strong> statements, and enter the final <strong class="source-inline">else if</strong> statement to trigger an advert when the player presses the <strong class="bold">WATCH</strong> <strong class="bold">AD</strong> button in our shop scene:<p class="source-code">        else if (target.name == "WATCH AD")</p><p class="source-code">        {</p><p class="source-code">          WatchAdvert();</p><p class="source-code">        }</p></li>
			</ol>
			<p>If this button is pressed, we run a method called <strong class="source-inline">WatchAdvert</strong>. We will talk about this method next.</p>
			<ol>
				<li value="2">Scroll to some space outside of all the other methods/functions and enter the following method to set up an advert for the player:<p class="source-code">void WatchAdvert()</p><p class="source-code">{</p><p class="source-code">Advertisement.Show(adId);</p><p class="source-code">}</p></li>
			</ol>
			<p>The <strong class="source-inline">WatchAdvert</strong> method is very simple. It runs the static <strong class="source-inline">Advertisement.Show</strong> method and takes the reward id.</p>
			<ol>
				<li value="3">Our Advert is<a id="_idIndexMarker624"/> nearly hooked up. We can now go down to the bottom of the script and fill in our callback methods.</li>
			</ol>
			<p>The methods and their purposes, in no particular order, are as follows:</p>
			<p><strong class="source-inline">OnInitializationComplete()</strong></p>
			<p>This method will run when our advert service has been initialized.</p>
			<p><strong class="source-inline">OnInitializationFailed(UnityAdsInitializationError error, string message)</strong></p>
			<p>If the advert service initialization has failed.</p>
			<p><strong class="source-inline">OnUnityAdsReady(string placementId)</strong></p>
			<p>When a Unity advert is ready to play.</p>
			<p><strong class="source-inline">OnUnityAdsDidError(string message)</strong></p>
			<p>An error happened with loading the advert.</p>
			<p><strong class="source-inline">OnUnityAdsDidStart(string placementId)</strong></p>
			<p>The advert has started playing.</p>
			<p><strong class="source-inline">OnUnityAdsDidFinish(string placementId, ShowResult showResult)</strong></p>
			<p>The advert has finished playing.</p>
			<p>Each of these methods has a line of code that fires an exception error because we haven't filled the methods in. It doesn't mean anything is wrong, it works more as a reminder.</p>
			<ol>
				<li value="4">Delete all lines of code that have this code in the following methods:<p class="source-code">throw new System.NotImplementedException();</p></li>
			</ol>
			<p>This will <a id="_idIndexMarker625"/>stop our errors. If you want to add a <strong class="source-inline">Debug.Log()</strong> to each of these methods, you can, so you know either of these methods fire. I will focus only on three of the methods, two of them for Initialization and one to add the reward to the shop's bank.</p>
			<ol>
				<li value="5">Scroll to the method called <strong class="source-inline">OnInitializationComplete()</strong> and within its curly braces, enter the following:<p class="source-code">Debug.Log("Unity Ads initialization complete.");</p></li>
				<li>For the second method, direct yourself to <strong class="source-inline">OnInitializationFailed(UnityAdsInitializationError error, string message)</strong> and enter the following code within its curly braces:<p class="source-code">Debug.Log($"Unity Ads Initialization Failed: {error.ToString()} - {message}");</p></li>
			</ol>
			<p>The <strong class="source-inline">$</strong> is used as an interpolation expression, which basically means whatever follows within curly braces will also be logged with the rest of the <strong class="source-inline">string</strong>. <strong class="source-inline">error</strong> will be the type of error, while <strong class="source-inline">message</strong> will carry a description of the error.</p>
			<p class="callout-heading">Information</p>
			<p class="callout">If you would like to know more about interpolation expressions, check out the following link: <a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/tokens/interpolated">https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/tokens/interpolated</a>.</p>
			<p>The last method is our reward given to the player. Navigate to the <strong class="source-inline">OnUnityAdsDidFinish(string placementId, ShowResult showResult)</strong> method.</p>
			<p>We will have three possible outcomes for if an advert is viewed. The possibilities are as follows:</p>
			<p><strong class="source-inline">Finished</strong>: Full advert has been watched.</p>
			<p><strong class="source-inline">Skipped</strong>: The advert was skipped.</p>
			<p><strong class="source-inline">Failed</strong>: Advert failed to load.</p>
			<p>These states <a id="_idIndexMarker626"/>will come from the <strong class="source-inline">showResult</strong> variable. Let's enter the three possible <strong class="source-inline">if</strong> statements and then we can fill the rest of the method in:</p>
			<ol>
				<li value="1">Within the <strong class="source-inline">OnUnityAdsDidFinish(string placementId, ShowResult showResult)</strong> method's curly braces, enter the following:<p class="source-code">if (showResult == ShowResult.Finished)</p><p class="source-code">  {</p><p class="source-code">        // REWARD PLAYER</p><p class="source-code">      }</p><p class="source-code">  else if (showResult == ShowResult.Skipped)</p><p class="source-code">  {</p><p class="source-code">        // DO NOT REWARD PLAYER</p><p class="source-code">      }</p><p class="source-code">  else if (showResult == ShowResult.Failed)</p><p class="source-code">  {</p><p class="source-code">        Debug.LogWarning ("The ad did not finish due to an error.");</p><p class="source-code">  }</p></li>
				<li>For our game, we only need to add content to the <strong class="source-inline">ShowResult.Finished</strong> statement. Replace <strong class="source-inline">// REWARD PLAYER</strong> with the following code to reward the player with <strong class="source-inline">300</strong> credits to their bank:<p class="source-code">Debug.Log("Unity Ads Rewarded Ad Completed");</p><p class="source-code">bank += 300;</p><p class="source-code">bankObj.GetComponentInChildren&lt;TextMesh&gt;().text = bank.ToString();</p></li>
			</ol>
			<p>The first<a id="_idIndexMarker627"/> line we entered is a simple log to say the advert has landed in the <strong class="source-inline">Finished</strong> state. Next, we add <strong class="source-inline">300</strong> credits to our existing bank. Finally, we send the value to the <strong class="source-inline">bankObj</strong> <strong class="source-inline">TextMesh</strong> <strong class="source-inline">text</strong> value.</p>
			<p>After the last <strong class="source-inline">else if</strong> in the <strong class="source-inline">OnUnityAdsDidFinish</strong> method, we finish by adding two lines of code. The first line loads another advert using the same reward id. The second line is a method that deselects all buttons in the shop (we covered this method in the last chapter).</p>
			<ol>
				<li value="3">So, still just outside the last <strong class="source-inline">else if</strong> curly brace, enter the following two lines:<p class="source-code">Advertisement.Load(placementId);</p><p class="source-code">TurnOffSelectionHighlights();</p></li>
			</ol>
			<p>We are now in a position to test our <strong class="bold">WATCH AD</strong> button in our shop scene to see whether our advert template will load:</p>
			<ol>
				<li value="1">Save the <strong class="source-inline">PlayerShipBuild</strong> script and return to the Unity Editor.</li>
				<li>Make sure your <strong class="bold">Build Settings</strong> are pointing to an Android build. Click the <strong class="bold">Play</strong> button in the Editor.</li>
				<li>In the <strong class="bold">Game</strong> window, click on the <strong class="bold">WATCH AD</strong> button. We should be presented with the following screen:</li>
			</ol>
			<div>
				<div id="_idContainer209" class="IMG---Figure">
					<img src="image/Figure_6.16_B18381.jpg" alt="Figure 6.16 – Unity's advert placeholder screen&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.16 – Unity's advert placeholder screen</p>
			<ol>
				<li value="4">Click on the <strong class="bold">Close</strong> button in the top-right corner.</li>
				<li>Hopefully, your on-screen credit should have gone from <strong class="source-inline">600</strong> to <strong class="source-inline">900</strong>.</li>
				<li>That is the end of adding the functionality for the <strong class="bold">WATCH AD</strong> button. Save the script.</li>
			</ol>
			<p>Our shop scene is complete and fully functioning with the ability to watch an advert to gain credits<a id="_idIndexMarker628"/> so that the player can purchase items to use in their game. We now need to expand the <strong class="source-inline">PlayerSpawner</strong> script to support new items that can potentially be added to the player ship.</p>
			<h1 id="_idParaDest-128"><a id="_idTextAnchor130"/>Extending the PlayerSpawner script</h1>
			<p>If an item is <a id="_idIndexMarker629"/>purchased from our shop scene, this will affect what happens to our game scene when our player's ship loads into the game. Our current <strong class="source-inline">PlayerSpawner</strong> script will not accommodate the <strong class="source-inline">shop</strong> scene ship, so we need to revisit this script to update its <strong class="source-inline">CreatePlayer</strong> method:</p>
			<ol>
				<li value="1">In the Unity Editor's <strong class="bold">Project</strong> window, locate and open the <strong class="source-inline">PlayerSpawner</strong> script (<strong class="source-inline">Assets/Script</strong>).</li>
				<li>At the top of the <strong class="source-inline">PlayerSpawner</strong> script, with the other variables, add a <strong class="source-inline">bool</strong> value:<p class="source-code"> bool upgradedShip = false;</p></li>
			</ol>
			<p>The <strong class="source-inline">upgradedShip</strong> Boolean will switch to <strong class="source-inline">true</strong> if a modified player ship is found in the level.</p>
			<ol>
				<li value="3">Scroll down to the <strong class="source-inline">Start</strong> function in the <strong class="source-inline">PlayerSpawner</strong> script and add this as the last line with the <strong class="source-inline">Start</strong> function:<p class="source-code">GetComponentInChildren&lt;Player&gt;().enabled = true;</p><p class="source-code">GameManager.Instance.CameraSetup();</p></li>
			</ol>
			<p>Currently, our <strong class="source-inline">PlayerShipBuild</strong> script disables the <strong class="source-inline">Player</strong> script in the <strong class="source-inline">shop</strong> scene, to <a id="_idIndexMarker630"/>stop the player from shooting in the <strong class="source-inline">shop</strong>. When we start our <strong class="source-inline">testLevel</strong>, we need to turn the <strong class="source-inline">Player</strong> script back on so they can move and shoot We also add the camera setup from being close up to the shop's display from all the way back on it's z-axis for our <strong class="source-inline">testLevel</strong> as a temporary fix.</p>
			<ol>
				<li value="4">Replace the content of the <strong class="source-inline">CreatePlayer</strong> method with the following code to update detection of what ship is in our scene:<p class="source-code">    //been shopping</p><p class="source-code">    if(GameObject.Find("UpgradedShip"))</p><p class="source-code">    {</p><p class="source-code">        upgradedShip = true;</p><p class="source-code">    }</p></li>
			</ol>
			<p>We first need to confirm that the <strong class="source-inline">PlayerSpawner</strong> script can see whether an upgrade has been purchased in the scene. If a purchase has been made, the modified player ship will carry over to the level scene. If this is the case, we set the <strong class="source-inline">upgradedShip</strong> variable to <strong class="source-inline">true</strong>.</p>
			<ol>
				<li value="5">Continuing on with the <strong class="source-inline">PlayerSpawner</strong> script, and still within the <strong class="source-inline">CreatePlayer</strong> method, we add an <strong class="source-inline">if</strong> statement, which instantiates the player:<p class="source-code">    //not shopped or died</p><p class="source-code">    //default ship build</p><p class="source-code">    if (!upgradedShip || GameManager.Instance.Died)</p><p class="source-code">    {</p><p class="source-code">        GameManager.Instance.Died = false;</p><p class="source-code">        actorModel = Object.Instantiate(Resources.Load</p><p class="source-code">          ("Player_Default")) </p><p class="source-code">              as SOActorModel;                                                                                         </p><p class="source-code">        playerShip = GameObject.Instantiate(actorModel.    actor,</p><p class="source-code">          this.transform.position, Quaternion.    Euler(270,180,0))</p><p class="source-code">            as GameObject;</p><p class="source-code">        playerShip.GetComponent&lt;IActorTemplate&gt;().</p><p class="source-code">          ActorStats(actorModel);</p><p class="source-code">    }</p></li>
			</ol>
			<p>Continuing on<a id="_idIndexMarker631"/> inside the <strong class="source-inline">CreatePlayer</strong> method, we will now need to check whether there is a player ship in the scene or whether the player has died. If there hasn't been an upgrade or the player has died, we will create a default player ship with the following code.</p>
			<p>Inside the <strong class="source-inline">if</strong> statement, we create our default player ship by doing the following:</p>
			<ol>
				<li value="1">Set the <strong class="source-inline">Died</strong> property to <strong class="source-inline">false</strong> to stop the <strong class="source-inline">if</strong> statement repeating if the player has died.</li>
				<li>Instantiate the <strong class="source-inline">Player_Default</strong> scriptable object, which contains all the standard properties for our player's ship, and store it in a variable named <strong class="source-inline">actorModel</strong>.</li>
				<li>Next, we instantiate our player's ship, position it, and rotate it in the correct direction.</li>
				<li>Finally, in this <strong class="source-inline">if</strong> statement, we issue the <strong class="source-inline">actorModel</strong> variable containing all the properties that the player ship game object needs.</li>
			</ol>
			<p>However, if our player has been shopping and bought one or more upgrades, this will <a id="_idIndexMarker632"/>fall into the <strong class="source-inline">else</strong> condition, where we will find a game object called <strong class="source-inline">UpgradedShip</strong>. We will attach this game object to our <strong class="source-inline">playerShip</strong> game object variable.</p>
			<ol>
				<li value="5">Enter the following code to set a store reference to <strong class="source-inline">playerShip</strong>:<p class="source-code">    //apply the shop upgrades</p><p class="source-code">    else</p><p class="source-code">    {</p><p class="source-code">        playerShip = GameObject.Find("UpgradedShip");</p><p class="source-code">    }</p></li>
			</ol>
			<p>With our <strong class="source-inline">playerShip</strong> game object stored as an instance, we can now set it up so that it's in the correct position and has the correct size, rotation, and so on.</p>
			<ol>
				<li value="6">Enter the following functions to set our <strong class="source-inline">playerShip</strong> object up for the start of a game:<p class="source-code">    playerShip.transform.rotation = Quaternion.Euler(0,180,0);</p><p class="source-code">    playerShip.transform.localScale = new Vector3(60,60,60);</p><p class="source-code">    playerShip.GetComponentInChildren&lt;ParticleSystem&gt;</p><p class="source-code">      ().transform.localScale = new Vector3(25,25,25);</p><p class="source-code">    playerShip.name = "Player";</p><p class="source-code">    playerShip.transform.SetParent(this.transform);</p><p class="source-code">    playerShip.transform.position = Vector3.zero;</p><p class="source-code">  GameManager.Instance.CameraSetup();</p><p class="source-code">  }</p><p class="source-code">}</p></li>
			</ol>
			<p>We then move on to the last bit of code for the <strong class="source-inline">PlayerSpawner</strong> script where our player's ship is set up ready to start. Take note that even if the player purchases an upgrade, this won't create any complications with regard to getting the reference of the player ship.</p>
			<ol>
				<li value="7">Set the rotation so the player's ship faces the correct way.</li>
				<li>Scale the player's ship correctly.</li>
				<li>Turn <a id="_idIndexMarker633"/>the <strong class="source-inline">Player</strong> script off so the player can't control the ship while it carries out its intro animation.</li>
				<li>Name the player's ship <strong class="source-inline">Player</strong>.</li>
				<li>Finally, set the player's ship as a child to the <strong class="source-inline">playerSpawner</strong> game object as it belongs to the <strong class="source-inline">playerSpawner</strong> game object.</li>
				<li>Go back to the <strong class="source-inline">GameManager</strong> script, scroll down to <strong class="source-inline">void CameraSetup()</strong> and change it's access modifier to <strong class="source-inline">public</strong>. So it reads <strong class="source-inline">public void CameraSetup()</strong>.</li>
				<li>Save the script.</li>
			</ol>
			<p>We have updated the player's ship so that it is created for a default ship or as a customized one from the shop scene. Also, we have made it aware of the <strong class="source-inline">PlayerTransition</strong> script so that when the player's ship is created, it won't get stuck in the screen boundaries or the player won't be in a position where they aren't able to control the ship until its introductory animation has finished.  </p>
			<p>Finally, we now need to create and add our <strong class="source-inline">b. Shot</strong> weapon asset to our game. The majority of the scripting has already been done; it just needs to be attached to the correct components.</p>
			<p>To give our <strong class="source-inline">b. Shot</strong> prefab weapon its behavior, we need to do the following:</p>
			<ol>
				<li value="1">In the <strong class="bold">Project</strong> window, navigate to <strong class="source-inline">Assets/Resources</strong> and select <strong class="source-inline">b. Shot</strong>.</li>
				<li>Now, in the <strong class="bold">Inspector</strong> window, click the <strong class="bold">Add Component</strong> button. Type <strong class="source-inline">BShot Component</strong> until it appears in the drop-down list, and then select it.</li>
			</ol>
			<p>We now need to apply our <strong class="source-inline">bShotComponent</strong> to the script.</p>
			<ol>
				<li value="3">Click the small, round remote circle next to the <strong class="bold">B Shot Bullet</strong> field and, from the drop-down list, select <strong class="source-inline">player_BshotBullet</strong>, as shown in the following screenshot:</li>
			</ol>
			<div>
				<div id="_idContainer210" class="IMG---Figure">
					<img src="image/Figure_6.17_B18381.jpg" alt="Figure 6.17 – B Shot Component script with player_BshotBullet game object&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.17 – B Shot Component script with player_BshotBullet game object</p>
			<p>Our <strong class="source-inline">b. Shot</strong> weapon <a id="_idIndexMarker634"/>will now fire. Next, we need to make the bullet travel, following a similar process as we did in <em class="italic">Chapter 2</em>, <em class="italic">Adding and Manipulating Objects</em>, where we made our first player bullet fire and travel across the screen. This means we can use the script we've already made and attach it to the <strong class="source-inline">player_BshotBullet</strong> prefab.</p>
			<p>To attach and customize the <strong class="source-inline">player_BshotBullet</strong> prefab, we need to do the following:</p>
			<ol>
				<li value="1">In the <strong class="bold">Project</strong> window, navigate to <strong class="source-inline">Assets/Prefab/Player</strong> and select <strong class="source-inline">player_BshotBullet</strong>.</li>
				<li>In the <strong class="bold">Inspector</strong> window, select the <strong class="bold">Add Component</strong> button. Type <strong class="source-inline">PlayerBullet</strong> until you see it in the drop-down list, and then select it.</li>
				<li>Back in the <strong class="bold">Project</strong> window, navigate to <strong class="source-inline">Assets/ScriptableObject</strong>.</li>
				<li>Right-click in the open space on the right side of the <strong class="bold">Project</strong> window and select <strong class="bold">Create</strong> | <strong class="bold">Create Actor</strong>.</li>
				<li>Name the new file in the <strong class="bold">Project</strong> window <strong class="source-inline">bShotBullet</strong> and select it.</li>
				<li>Give it the following values in the <strong class="bold">Inspector</strong> window:</li>
			</ol>
			<div>
				<div id="_idContainer211" class="IMG---Figure">
					<img src="image/Figure_6.18_B18381.jpg" alt="Figure 6.18 – ShotBullet Scriptable Object and its properties&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.18 – ShotBullet Scriptable Object and its properties</p>
			<p>We are <a id="_idIndexMarker635"/>approaching the end of this chapter. Now is the time to check everything out to see how it all plays out for us:</p>
			<ol>
				<li value="1">Save all the open scripts.</li>
				<li>Save the <strong class="bold">Shop</strong> scene.</li>
				<li>Click on <strong class="bold">Play</strong> mode in the Unity Editor.</li>
				<li>Try and buy all three ship upgrades (you will need to watch a couple of the Unity notification advert displays to get them all).</li>
				<li>Click on the <strong class="bold">START</strong> button and you should see a screen such as the following one with our ship holding all three upgrades:</li>
			</ol>
			<div>
				<div id="_idContainer212" class="IMG---Figure">
					<img src="image/Figure_6.19_B18381.jpg" alt="Figure 6.19 – Our player ship with all the upgrades&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.19 – Our player ship with all the upgrades</p>
			<p>Our player is fully equipped! If the player gets hit, they will lose a shield and the front cover on the ship will disappear. If the ship fires with the firepower upgrade, it will wipe out all the enemies. The atom bomb currently isn't programmed to do anything.</p>
			<p>If you have come across any issues with this final section, you can check the official Unity guide, which also contains other information about adverts and rewards, if you are interested (<a href="https://unityads.unity3d.com/help/unity/integration-guide-unity">https://unityads.unity3d.com/help/unity/integration-guide-unity</a>). Or compare our script and scene with the <strong class="source-inline">Complete</strong> folder of <strong class="source-inline">Chapter6</strong> from the downloaded project files link at the beginning of this chapter.</p>
			<p>Congratulations, you have reached the end of this chapter and also the end of the shop scene! Hopefully, you found this beneficial and can appreciate how Unity is keen to encourage developers to look at alternative ways of <a id="_idIndexMarker636"/>making money from a game with adverts instead of simply selling the games they develop. We will now summarize what we covered in this chapter and look at how we will build our game even further.</p>
			<h1 id="_idParaDest-129"><a id="_idTextAnchor131"/>Summary</h1>
			<p>In this chapter, we created a scene that we can interact with to modify our player with in-app purchases and that we can also use to gain more in-game credits by watching adverts on an iPhone or Android phone to buy more items to further upgrade the player. We will look at building the game on mobile in the <a href="B18381_Appendix_Epub.xhtml#_idTextAnchor245"><em class="italic">Appendix</em></a> section of this book, as well as how to hide the <strong class="bold">AD</strong> button on PC/macOS platforms.</p>
			<p>Finally, we carried all the items we bought over into the game, because of which the player's gameplay has been altered thanks to the modifications.</p>
			<p>As mentioned a few times in this chapter, the scene had already been made for us in terms of the art. The reason for this was to allow you to experience raycasting objects and to understand that this is an alternative way of interacting in a scene. But what if the platform we are playing this game on is an iPad? An iPad is more of a square shape, compared to the letterbox shape of an iPhone or Android phone. If this is the case, our game camera would clip parts of our shop scene out. </p>
			<p>You could also think of a more efficient way of using things such as <strong class="source-inline">.Find</strong> in your coding. If this is a concern of yours, don't worry—we address these issues in <a href="B18381_09_Epub.xhtml#_idTextAnchor161"><em class="italic">Chapter 9</em></a>, <em class="italic">Creating a 2D Shop Interface and In-Game HUD</em>, where we implement Unity's own event system. For now, however, let's look at what we will cover in the next chapter.</p>
			<p>In the next chapter, we are going to link up all of our scenes to create what we refer to as a game loop. This will help us understand the actual game layout as a whole.</p>
		</div>
	</body></html>