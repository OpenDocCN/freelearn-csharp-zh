<html><head></head><body>
		<div><h1 id="_idParaDest-31"><em class="italic"><a id="_idTextAnchor025"/>Chapter 2</em>: Scripting Concepts in Unity</h1>
			<p>In the previous chapter, we discussed <strong class="bold">scripting</strong> in Unity at a high level. In this chapter, we will introduce this topic in detail. We already know that Unity is internally written in C/C++, but it provides many C# APIs for game developers and allows us to implement game logic in C#. This means that not only can we write our own classes but also many built-in classes are available to us. So, before creating our own C# class, let's learn a bit about Unity's built-in classes first. The life cycle of Unity scripts is another important topic because we need to use different event functions provided by Unity to implement game logic. Then, we will introduce how to create a script in the Unity Editor and use it as a component.</p>
			<p>We will cover the following key topics in this chapter:</p>
			<ul>
				<li>Understanding the concepts of scripting in Unity</li>
				<li>The life cycle of a script instance</li>
				<li>Creating a script and using it as a component</li>
				<li>Packages and the Unity Package Manager</li>
			</ul>
			<h1 id="_idParaDest-32"><a id="_idTextAnchor026"/>Technical requirements</h1>
			<p>You can find complete code examples on GitHub under the following repository:  <a href="https://github.com/PacktPublishing/Game-Development-with-Unity-for-.NET-Developers">https://github.com/PacktPublishing/Game-Development-with-Unity-for-.NET-Developers</a>.</p>
			<p>Before starting, I want to mention that the following software will be used in this chapter:</p>
			<ul>
				<li>Visual Studio 2019</li>
				<li>Visual Studio Tools for Unity</li>
				<li>Unity 2020.3+</li>
			</ul>
			<h1 id="_idParaDest-33"><a id="_idTextAnchor027"/>Understanding the concepts of scripting in Unity</h1>
			<p>Let's get started with understanding the concepts of <a id="_idIndexMarker153"/>scripting in Unity. We know that Unity is not an open source engine; except for enterprise users and users who subscribe to the Pro plan, no one else can access Unity's source code. However, Unity's C# API is open source. Because the C# API is just a wrapper, it does not include the internal logic of the engine. But Unity's open source C# API is also a good reference for us to understand script programming in Unity. You can access it on GitHub: <a href="https://github.com/Unity-Technologies/UnityCsReference">https://github.com/Unity-Technologies/UnityCsReference</a>.</p>
			<h2 id="_idParaDest-34"><a id="_idTextAnchor028"/>GameObject-components architecture</h2>
			<p>First of all, I want to let you know that Unity is a <strong class="bold">component-based system</strong>. So, the two terms you often hear in Unity game development are <strong class="bold">GameObject</strong> and <strong class="bold">component</strong>. A GameObject<a id="_idIndexMarker154"/> is nothing more than a container for components. It represents an object in the game world, but it does not have any function itself. On the other hand, a component implements the real functionality and can be attached to a GameObject to provide the function for a specific object. </p>
			<div><div><img src="img/Figure_2.01_B17146.jpg" alt="Figure 2.1 – A Main Camera GameObject with a Camera component&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.1 – A Main Camera GameObject with a Camera component</p>
			<p>For example, you can find a <strong class="bold">Main Camera</strong> object in a default Scene in the Unity Editor. It is created by attaching a <strong class="bold">Camera</strong> component to a GameObject.</p>
			<p>You can enable or disable a set of functions attached to this object by enabling or disabling the<a id="_idIndexMarker155"/> GameObject, or enabling or disabling a specific component to enable or disable a specific function.</p>
			<p>This way is different from traditional object-oriented programming. It is a bit like LEGO blocks; when an object needs a certain type of function, you only need to add related components to it.</p>
			<h2 id="_idParaDest-35"><a id="_idTextAnchor029"/>Common classes in Unity</h2>
			<p>Unity provides a lot of <a id="_idIndexMarker156"/>built-in C# classes, so I will introduce some of the classes we often use in Unity development.</p>
			<h3>The MonoBehaviour class</h3>
			<p>In Unity<a id="_idIndexMarker157"/> development, the class you most often encounter is<a id="_idIndexMarker158"/> the <code>MonoBehaviour</code> class. This is because it is the base class from which every Unity script is derived.</p>
			<p>Let's create a new script file in the Unity Editor and name it <code>ChapterTwo.cs</code>.</p>
			<div><div><img src="img/Figure_2.02_B17146.jpg" alt="Figure 2.2 – A default script&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.2 – A default script</p>
			<p>Then, we open it in Visual Studio by double-clicking it. You can see our new <code>ChapterTwo</code> class derives from <code>MonoBehaviour</code>.</p>
			<p>So, why is <code>MonoBehaviour</code> so important? Because it provides a framework for game developers to interact with the Unity engine. For example, if you want to attach a script to a GameObject in the Scene, the class must inherit from the <code>MonoBehaviour</code> class; otherwise, the script cannot be added to the GameObject. When you try to attach a class that does not inherit from <code>MonoBehaviour</code> to a GameObject, the Unity Editor will pop up the following error message:</p>
			<div><div><img src="img/Figure_2.03_B17146.jpg" alt="Figure 2.3 – Can't add script error &#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.3 – Can't add script error </p>
			<p>Without the <code>MonoBehaviour</code> class, your code will not be able to access Unity's built-in methods and events, such as the <code>Start</code> and <code>Update</code> functions that will be created by default in each of your new script files. </p>
			<p><code>MonoBehaviour</code> is the <a id="_idIndexMarker159"/>most important class in Unity. <code>Start</code> and <code>Update</code> are the <a id="_idIndexMarker160"/>most common built-in functions in Unity. Every time you create a new script file, they will appear in this new file. But if you want to modify the template that creates the script, it is also possible; you only need to modify the script template stored here:</p>
			<ul>
				<li><code>%EDITOR_PATH%\Data\Resources\ScriptTemplates</code></li>
				<li><code>%EDITOR_PATH%/Data/Resources/ScriptTemplates</code></li>
			</ul>
			<div><div><img src="img/Figure_2.04_B17146.jpg" alt="Figure 2.4 – The ScriptTemplates folder&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.4 – The ScriptTemplates folder</p>
			<h3>The GameObject class</h3>
			<p>We already <a id="_idIndexMarker161"/>know that objects in a Scene are called <code>GameObject</code> class to represent it.</p>
			<p>When you create a new empty GameObject in a Scene, you'll find this new GameObject contains a name, a tag, a layer, and a <strong class="bold">Transform</strong> component. </p>
			<div><div><img src="img/Figure_2.05_B17146.jpg" alt="Figure 2.5 – A GameObject&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.5 – A GameObject</p>
			<p>You can modify <a id="_idIndexMarker163"/>whether it is a <em class="italic">static</em> object from the <strong class="bold">Inspector</strong> window <a id="_idIndexMarker164"/>as well. If the GameObject does not move during runtime, you should check the <strong class="bold">Static</strong> property checkbox in the upper-right corner of the <strong class="bold">Inspector</strong> window. This is because many systems in Unity can precalculate information about static GameObjects in the Editor to improve performance at runtime.</p>
			<p>As we mentioned earlier, a GameObject is a container that can contain various components. Therefore, in scripting, the <code>GameObject</code> class mainly provides a set of methods for managing components, such as the <code>AddComponent</code> method to add a new component to a GameObject and <code>GetComponent</code> to access a component attached to a GameObject.</p>
			<p>Let's create a built-in 3D Cube object in the Scene and look at the <strong class="bold">Inspector</strong> window of this cube.</p>
			<div><div><img src="img/Figure_2.06_B17146.jpg" alt="Figure 2.6 – Cube object in the Scene&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.6 – Cube object in the Scene</p>
			<p>As you can see in the previous screenshot, this GameObject is called <strong class="bold">Cube</strong>, and there are four components that are attached to this Cube object, namely, <strong class="bold">Transform</strong>, <strong class="bold">Cube (Mesh Filter)</strong>, <strong class="bold">Mesh Renderer</strong>, and <strong class="bold">Box Collider</strong>. These components provide rendering and physical simulation functions for this object. Therefore, a GameObject is just a container for components, and specific functions come from specific components. You can add a new component by clicking the <strong class="bold">Add Component</strong> button in the <strong class="bold">Inspector</strong> window, or you can add a component at runtime via code.</p>
			<p>In addition to <a id="_idIndexMarker165"/>components, the <code>GameObject</code> class also offers a<a id="_idIndexMarker166"/> collection of methods to find other GameObjects, send messages between GameObjects, or create and destroy a GameObject. For example, you can find GameObjects by using the <code>GameObject.Find</code> method, to find a GameObject by name and return it, or the <code>GameObject.FindWithTag</code> method, to find a GameObject by tag. You can also use the <code>Instantiate</code> method to create a new instance of a <code>GameObject</code>, and the <code>Destroy</code> method to destroy an instance of a <code>GameObject</code>.</p>
			<div><div><img src="img/Figure_2.07_B17146.jpg" alt="Figure 2.7 – [SerializeField] attribute in a class&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.7 – [SerializeField] attribute in a class</p>
			<p>It is worth noting<a id="_idIndexMarker167"/> that using certain methods to dynamically find a <a id="_idIndexMarker168"/>specific GameObject instance at runtime will bring additional overhead, so the easiest way to obtain a reference to another GameObject instance is to declare a public <code>GameObject</code> field or use the <code>[SerializeField]</code> attribute and declare a private field to maintain the encapsulation of the class. As shown in the previous screenshot, I prefer the second way. We will cover serialization in Unity further in later chapters.</p>
			<p>Now, you will find the <code>GameObject</code> field is visible in the <strong class="bold">Inspector</strong>. You can just drag a GameObject from the Scene or <strong class="bold">Hierarchy</strong> panel onto this variable to assign it.</p>
			<div><div><img src="img/Figure_2.08_B17146.jpg" alt="Figure 2.8 – A GameObject variable&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.8 – A GameObject variable</p>
			<h3>The Transform class</h3>
			<p>An <a id="_idIndexMarker169"/>instance of the <code>Transform</code> class will be created automatically when you create a new <a id="_idIndexMarker170"/>GameObject in the Scene. This is because every GameObject in the Scene has position, rotation, and scale properties and the <code>Transform</code> class is used to store and manipulate the position, rotation, and scale of the GameObject in Unity. So, it is impossible to create a GameObject in Unity without a <code>Transform</code> component and you cannot remove it from a GameObject as well.</p>
			<p>You can move, rotate, or scale a GameObject by modifying the properties of the <code>Transform</code> component in the Unity Editor directly, or you can modify them at runtime by accessing the instance of the <code>Transform</code> class.</p>
			<div><div><img src="img/Figure_2.09_B17146.jpg" alt="Figure 2.9 – The Transform component&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.9 – The Transform component</p>
			<h2 id="_idParaDest-36"><a id="_idTextAnchor030"/>Prefabs in Unity</h2>
			<p><strong class="bold">Prefab</strong> is an<a id="_idIndexMarker171"/> important concept in Unity. Game developers can use a Prefab to save GameObjects, components, and properties to reuse these resources when developing games with Unity. When instantiating a Prefab, the Prefab acts as a resource template. Next, let's see how to create a new Prefab in Unity.</p>
			<h3>How to create a Prefab</h3>
			<p>First, let's talk about <a id="_idIndexMarker172"/>how to create a Prefab. Take a "barbell" as an example. It consists of a <strong class="bold">Cube</strong> and two <strong class="bold">Sphere</strong> objects.</p>
			<div><div><img src="img/Figure_2.10_B17146.jpg" alt="Figure 2.10 – How to create a Prefab&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.10 – How to create a Prefab</p>
			<p>We can create a<a id="_idIndexMarker173"/> Prefab of this barbell object by following these steps:</p>
			<ol>
				<li>First, find the target GameObject named <strong class="bold">BarbellObject</strong> in the <strong class="bold">Hierarchy</strong> panel, as shown in <em class="italic">Figure 2.10</em>.</li>
				<li>Drag the target GameObject from the <strong class="bold">Hierarchy</strong> panel to the <strong class="bold">Project</strong> panel to create a Prefab of it. The newly created Prefab file is shown as a blue cube icon in the Unity Editor. </li>
			</ol>
			<div><div><img src="img/Figure_2.11_B17146.jpg" alt="Figure 2.11 – A Prefab file&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.11 – A Prefab file</p>
			<ol>
				<li value="3">At this point, if we look at the <strong class="bold">Hierarchy</strong> panel again, we can find that the name text of <strong class="bold">BarbellObject</strong> and the small cube icon on the left of it have changed from white to blue because it is now a Prefab instance. In this way, we can distinguish <a id="_idIndexMarker174"/>whether an object is a Prefab instance on the <strong class="bold">Hierarchy</strong> panel. </li>
			</ol>
			<div><div><img src="img/Figure_2.12_B17146.jpg" alt="Figure 2.12 – A Prefab instance&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.12 – A Prefab instance</p>
			<p>As you can see, creating a new Prefab is not complicated. Next, let's explore how to edit an already-created Prefab.</p>
			<h3>How to edit a Prefab</h3>
			<p>Unity provides<a id="_idIndexMarker175"/> two ways for developers to edit a Prefab, as follows: </p>
			<ul>
				<li>The first way is to edit a Prefab in Prefab Mode.</li>
				<li>The second way is to edit a Prefab via its instance.</li>
			</ul>
			<p>Let's start with Prefab Mode first.</p>
			<p>Prefab Mode is a mode specially designed to support editing Prefabs individually. Prefab Mode allows the content of the Prefab to be viewed and edited in a separate Scene. You can enter Prefab Mode in the following ways:</p>
			<ol>
				<li value="1">The first way is to click the arrow button of the Prefab instance in the <strong class="bold">Hierarchy</strong> view. </li>
			</ol>
			<div><div><img src="img/Figure_2.13_B17146.jpg" alt="Figure 2.13 – Entering Prefab Mode&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.13 – Entering Prefab Mode</p>
			<ol>
				<li value="2">The second way is to<a id="_idIndexMarker176"/> select the Prefab file in the <strong class="bold">Project</strong> panel. A button with the words <strong class="bold">Open Prefab</strong> will be displayed in the <strong class="bold">Inspector</strong> panel. Click it to enter Prefab Mode.</li>
			</ol>
			<div><div><img src="img/Figure_2.14_B17146.jpg" alt="Figure 2.14 – Entering Prefab Mode&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.14 – Entering Prefab Mode</p>
			<ol>
				<li value="3">You can also double-click the Prefab file in the <strong class="bold">Project</strong> panel to enter Prefab Mode.</li>
			</ol>
			<p>After entering<a id="_idIndexMarker177"/> Prefab Mode, you can modify the Prefab here and you can also find that a navigation bar will be displayed above the Scene view, as shown in the following screenshot:</p>
			<div><div><img src="img/Figure_2.15_B17146.jpg" alt="Figure 2.15 – Prefab Mode&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.15 – Prefab Mode</p>
			<ol>
				<li value="4">Use the navigation buttons to switch between the game Scene and Prefab Mode. In addition, at the top of the <strong class="bold">Hierarchy</strong> view, a title bar is also displayed that displays the name of the currently opened Prefab. Clicking the left arrow button in the title bar can also be used to return to the game Scene.</li>
			</ol>
			<p>In addition to Prefab Mode, we can also modify a Prefab by modifying the instance of the Prefab in the <strong class="bold">Hierarchy</strong> panel. Let's follow these steps to modify the <strong class="bold">BarbellObject</strong> Prefab:</p>
			<ol>
				<li value="1">Select one of the<a id="_idIndexMarker178"/> spheres in the <code>1</code> to <code>2</code>, as shown in the following screenshot:</li>
			</ol>
			<p class="figure-caption"> </p>
			<div><div><img src="img/Figure_2.16_B17146.jpg" alt="Figure 2.16 – Modifying the Prefab instance&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.16 – Modifying the Prefab instance</p>
			<ol>
				<li value="2">When the root node <a id="_idIndexMarker179"/>of the Prefab instance is selected, three buttons will appear in the <strong class="bold">Inspector</strong> panel, namely <strong class="bold">Open</strong>, <strong class="bold">Select</strong>, and <strong class="bold">Overrides</strong>. Click the <strong class="bold">Overrides</strong> drop-down window to view all modified data items, such as properties and components.</li>
			</ol>
			<div><div><img src="img/Figure_2.17_B17146.jpg" alt="Figure 2.17 – Opening the Overrides drop-down window&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.17 – Opening the Overrides drop-down window</p>
			<ol>
				<li value="3">In this <a id="_idIndexMarker180"/>drop-down window, we can discard or apply all modifications. Here, we should click the <strong class="bold">Apply All</strong> button to apply this modification to the Prefab.</li>
			</ol>
			<div><div><img src="img/Figure_2.18_B17146.jpg" alt="Figure 2.18 – Clicking the Apply All button&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.18 – Clicking the Apply All button</p>
			<p>Through the<a id="_idIndexMarker181"/> two methods described previously, we can easily modify a Prefab in Unity. Next, let's talk about how to instantiate a Prefab at runtime using C# code.</p>
			<h3>How to instantiate a Prefab</h3>
			<p>In Unity <a id="_idIndexMarker182"/>development, we can use the <code>Instantiate</code> method to create an instance of a Prefab at runtime. There are several variants of the <code>Instantiate</code> method. The commonly used Instantiate method variants are shown here:</p>
			<pre>public static Object <strong class="bold">Instantiate</strong>(Object original, Vector3
  position, Quaternion rotation);
public static Object <strong class="bold">Instantiate</strong>(Object original, Vector3
  position, Quaternion rotation, Transform parent);</pre>
			<p>We instantiate a Prefab using these two variants of the <code>Instantiate</code> method, both of which can be used to specify the instance's position and orientation, and the latter can also specify the instance's parent. </p>
			<p>Let's use the following example to learn how to instantiate a Prefab by calling the <code>Instantiate</code> method:</p>
			<ol>
				<li value="1">First, let's <a id="_idIndexMarker183"/>create a new script called <code>TestInstantiatePrefab</code>. In this script, we will assign a reference to a Prefab in the script and call <code>Instantiate</code> to create a new instance of this Prefab and assign a parent to the new object:<pre>using UnityEngine;
public class TestInstantiatePrefab : MonoBehaviour
{
    [SerializeField]
    private GameObject <strong class="bold">_prefab</strong>;
    [SerializeField]
    private Transform <strong class="bold">_parent</strong>;
    private GameObject _instance;
    private void Start()
    {
        var position = new Vector3(0f, 0f, 0f);
        var rotation = Quaternion.identity;
<strong class="bold">        _instance = Instantiate(_prefab, position,</strong>
<strong class="bold">          rotation, _parent)</strong>;
    }
}</pre></li>
				<li>Then, we also <a id="_idIndexMarker184"/>need to attach this script to a GameObject in the Scene, assign the Prefab to the <code>_prefab</code> field of this script, and assign this GameObject as the parent object of the instance of the Prefab that will be created later, as shown in the following screenshot: </li>
			</ol>
			<div><div><img src="img/Figure_2.19_B17146.jpg" alt="Figure 2.19 – Setting up the component and properties&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.19 – Setting up the component and properties</p>
			<ol>
				<li value="3">Click the <code>InstantiatePrefab</code> object:</li>
			</ol>
			<div><div><img src="img/Figure_2.20_B17146.jpg" alt="Figure 2.20 – Creating a new instance of a Prefab&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.20 – Creating a new instance of a Prefab</p>
			<p>In this section, we discussed an important concept in Unity, namely, Prefabs. By reading this section, you should understand what a Prefab is, how to create a Prefab, how to edit a Prefab, and how to instantiate a Prefab at runtime using C# code.</p>
			<h2 id="_idParaDest-37"><a id="_idTextAnchor031"/>Special folders in Unity</h2>
			<p>In addition to the <a id="_idIndexMarker186"/>commonly used classes and concepts introduced in the previous sections, there<a id="_idIndexMarker187"/> are also some special folders for different purposes in Unity. Some of these folders are related to scripting in Unity. They are as follows:</p>
			<ul>
				<li>The <code>Assets</code> folder</li>
				<li>The <code>Editor</code> folder</li>
				<li>The <code>Plugins</code> folder</li>
				<li>The <code>Resources</code> folder</li>
				<li>The <code>StreamingAssets</code> folder</li>
			</ul>
			<p>Let's look at each one. </p>
			<h3>The Assets folder</h3>
			<p>When a <a id="_idIndexMarker188"/>Unity project is created, an <code>Assets</code> folder is created to store various resources from models and <a id="_idIndexMarker189"/>textures to script files that will be used in this Unity project. This is also the folder you will mainly use when developing a Unity project.</p>
			<h3>The Editor folder</h3>
			<p>The <code>Editor</code> folder is <a id="_idIndexMarker190"/>used to store script files for the Editor. For example, you can add more <a id="_idIndexMarker191"/>functionality to the default Unity Editor by creating some Editor scripts in an Editor folder. Unity compiles the scripts in four independent stages according to the location of the script files. At each stage, Unity will create a separate C# project file (<code>.csproj</code>) for this stage. The scripts in the Editor folder will not be available at runtime. If the Editor folder is located in a <code>Plugins</code> folder, then a CSharp project file named <code>Assembly-CSharp-Editor-firstpass</code> will be created; otherwise, a CSharp project file named <code>Assembly-CSharp-Editor</code> will be created.</p>
			<h3>The Plugins folder</h3>
			<p>You should<a id="_idIndexMarker192"/> put the <a id="_idIndexMarker193"/>plugins or the code that needs to be compiled first in the <code>Plugins</code> folder, and Unity will compile the code in this folder first. A CSharp project file named <code>Assembly-CSharp-firstpass</code> will be created for the scripts located in this folder. Unity will create a CSharp project file named <code>Assembly-CSharp</code> for all other scripts that are in the <code>Assets</code> folder but not in the <code>Plugins</code> folder and the <code>Editor</code> folder.</p>
			<div><div><img src="img/Figure_2.21_B17146.jpg" alt="Figure 2.21 – CSharp project file for different stages&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.21 – CSharp project file for different stages</p>
			<p>There are some other special folders, such as the <code>Resources</code> folder and the <code>StreamingAssets</code> folder. We will introduce them in later chapters. </p>
			<p>In this section, we discussed the GameObject components architecture of Unity and introduced some of the most common built-in classes in Unity and some special folders related to scripts in Unity. Next, we will learn about another important topic related to scripting in Unity, that is, the life cycle of a script instance.</p>
			<h1 id="_idParaDest-38"><a id="_idTextAnchor032"/>The life cycle of a script instance</h1>
			<p>In the previous<a id="_idIndexMarker194"/> section, we introduced basic concepts of scripting in Unity. Now, we will explain another important topic regarding scripting in Unity: the life cycle of a script instance. </p>
			<p>We already know that the Unity C# API does not include the internal logic of the engine and the event functions on the script are triggered by the engine's C/C++ code. Therefore, in order to use the Unity engine correctly, it is very important to understand the order of execution for event functions and the life cycle of a C# script in Unity.</p>
			<p>We can divide the Unity event functions into the following categories depending on their purpose :</p>
			<ul>
				<li>Initialization</li>
				<li>Update</li>
				<li>Rendering</li>
			</ul>
			<p>Let's discuss them next.</p>
			<h2 id="_idParaDest-39"><a id="_idTextAnchor033"/>Initialization</h2>
			<p>If you are<a id="_idIndexMarker195"/> familiar with developing .NET applications, you may be surprised by script initialization in Unity because Unity scripts do not use constructors for initialization. Instead, Unity provides some engine event functions to initialize a script instance.</p>
			<p>Actually, we have already seen a Unity event function for initialization purposes. Yes, it is the <code>Start()</code> function created by default when creating a new script in Unity.</p>
			<p>However, the <code>Start()</code> function is not the first event function that will be triggered when a new instance of the script is created. When a Scene starts, the <code>Awake()</code> event function in each object in the Scene is always called before any <code>Start()</code> functions. Except for the fact that <code>Awake()</code> will be called first, <code>Start()</code> and <code>Awake()</code> work similarly. Both of them are called once during initialization. Now, you may have a question: since we already have the <code>Start</code> function, why do we still need the <code>Awake</code> function?</p>
			<p>This is because the Awake function is useful for separating initialization. For example, it is a good idea to use <code>Awake</code> to initialize an object's own references and variables before the game starts. This means that you should not access references to other objects in the Awake function, but should use <code>Start</code> to pass reference information of different objects.</p>
			<p>You may be confused, so let me show you some code. Let's consider a case where there are two classes, namely, <code>AwakeAndStartA</code> and <code>AwakeAndStartB</code>. In the first class, there is a <code>List&lt;int&gt;</code> variable and a <code>List&lt;int&gt;</code> property, and the <code>List</code> variable is set up in the Awake function of <code>AwakeAndStartA</code>:</p>
			<pre>public class AwakeAndStartA : MonoBehaviour
{
    private List&lt;int&gt; _listRef;
    public List&lt;int&gt; ListRef =&gt; _listRef;
    private void Awake()
    {
        _listRef = new List&lt;int&gt;();
    }
}</pre>
			<p>Now, we get <a id="_idIndexMarker196"/>the second class:</p>
			<pre>public class AwakeAndStartB : MonoBehaviour
{
    private void Awake()
    {
      var comp =
       GameObject.Find("A").GetComponent&lt;AwakeAndStartA&gt;();
      Debug.Log($"comp is null &gt; {comp is null}");
      Debug.Log(comp.ListRef.Count);
    }
}</pre>
			<p>The <code>AwakeAndStartB</code> class tries to get the reference of the <code>AwakeAndStartA</code><em class="italic"> </em>class and also access the <code>ListRef</code> property of <code>AwakeAndStartA</code> in its Awake function. </p>
			<p>If we run the code, we will get the following output; that is, object B can access object A, but not the variables or properties of object A in the Awake function. This is because we should not assume that a reference set up by one GameObject's Awake will be usable in another GameObject's Awake.</p>
			<div><div><img src="img/Figure_2.22_B17146.jpg" alt="Figure 2.22 – Null reference exceptions&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.22 – Null reference exceptions</p>
			<p>Therefore, in <a id="_idIndexMarker197"/>order to use <code>ListRef</code> in object B, we can get the reference in the Start function. Let's move the code for printing the number of elements contained in the list from the Awake function to the Start function:</p>
			<pre>public class AwakeAndStartB : MonoBehaviour
{
    private void Start()
    {
      var comp =
       GameObject.Find("A").GetComponent&lt;AwakeAndStartA&gt;();
      Debug.Log($"comp is null &gt; {comp is null}");
      Debug.Log(comp.ListRef.Count);
    }
}</pre>
			<p>This time, the <a id="_idIndexMarker198"/>code will print the correct number, as shown in <em class="italic">Figure 2.23</em>:</p>
			<div><div><img src="img/Figure_2.23_B17146.jpg" alt="Figure 2.23 – The number of elements contained in the list is 0&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.23 – The number of elements contained in the list is 0</p>
			<p>Another difference between the Start and Awake functions is that if a script component is not enabled in the Scene, its Start function will not be called but the Awake function will always be called, as you can see in the following screenshot:</p>
			<div><div><img src="img/Figure_2.24_B17146.jpg" alt="Figure 2.24 – The Awake function is always called&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.24 – The Awake function is always called</p>
			<p>There is a third <a id="_idIndexMarker199"/>event function for initialization, which is the <code>OnEnable</code> function. If the script component is enabled in the Scene, then this function will be called after the Awake function and before the Start function. However, there is a big difference between the <code>OnEnable</code> function and the Awake/Start function; that is, the <code>OnEnable</code> function could be called multiple times. This function is called when the component becomes enabled.</p>
			<h2 id="_idParaDest-40"><a id="_idTextAnchor034"/>Update</h2>
			<p>For a game, <code>Update</code> is a very <a id="_idIndexMarker200"/>important function because the gameplay logic is driven by <code>Update</code>. Unity offers three different <code>Update</code> functions for different purposes. They are as follows:</p>
			<ul>
				<li><code>FixedUpdate</code></li>
				<li><code>Update</code></li>
				<li><code>LateUpdate</code></li>
			</ul>
			<p><code>FixedUpdate</code> is used for physics simulations. So, you should not use this function if your game does not include physics simulations. The <code>FixedUpdate</code> function is called at every fixed framerate frame and it could be called multiple times in a single frame. This is because it is very important to ensure a fixed incremental time in a physical simulation. Now, you may be confused again. Let me explain it to you.</p>
			<p>By default, the physics simulation needs to be updated every 0.02 seconds. You can change this value in <strong class="bold">Project Settings</strong> | <strong class="bold">Time</strong> | <strong class="bold">Fixed Timestep</strong>.</p>
			<div><div><img src="img/Figure_2.25_B17146.jpg" alt="Figure 2.25 – Fixed Timestep setting&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.25 – Fixed Timestep setting</p>
			<p>Let's consider a <a id="_idIndexMarker201"/>case where the framerate of the game itself is low, for example, 25 FPS. This means that the game will take 0.04 seconds to update one frame. Then, the question is, how do we ensure a fixed incremental time for physics simulations?</p>
			<p>The answer is not complicated. Unity only needs to call <code>FixedUpdate</code> twice in each frame before calling the <code>Update</code> function, and in this example, <code>FixedUpdate</code> is called every 0.02 seconds. The following screenshot shows the result:</p>
			<div><div><img src="img/Figure_2.26_B17146.jpg" alt="Figure 2.26 – FixedUpdate is called twice in a frame&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.26 – FixedUpdate is called twice in a frame</p>
			<p>Therefore, only use the <code>FixedUpdate</code> function when using a physics simulation in your project. If your project does not include a physics simulation, then you should not use it.</p>
			<p>The <code>Update</code> function is another function that will be created by default when you are creating a new script. It is the most commonly used and most important function to implement any type of game logic in Unity. If the script component is enabled in a Scene, then <code>Update</code> will be called once per frame. </p>
			<p>The third function <a id="_idIndexMarker202"/>used to update is the <code>LateUpdate</code> function. As its name indicates, <code>LateUpdate</code> will be called after the <code>Update</code> function. So, we can use it to implement a two-step update in every frame. For example, you have a bunch of GameObjects in the Scene that need to be moved and rotated in the <code>Update</code> function, and you will use a camera in the Scene to track the movement of these GameObjects. In order to ensure that all GameObjects have moved completely, you can implement a smooth camera follow in the <code>LateUpdate</code> function.</p>
			<h2 id="_idParaDest-41"><a id="_idTextAnchor035"/>Rendering</h2>
			<p>For a game, in<a id="_idIndexMarker203"/> addition to the game logic, another important aspect is the game's graphics and rendering. Here, I will introduce three commonly used event functions of rendering. They are as follows:</p>
			<ul>
				<li><code>OnBecameVisible</code>/<code>OnBecameInvisible</code></li>
				<li><code>OnRenderImage</code></li>
				<li><code>OnGUI</code></li>
			</ul>
			<p><code>OnBecameVisible</code> will be called when the renderer is visible to any camera, while <code>OnBecameInvisible</code> is the opposite.</p>
			<div><div><img src="img/Figure_2.27_B17146.jpg" alt="Figure 2.27 – OnBecameVisible/OnBecameInvisible&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.27 – OnBecameVisible/OnBecameInvisible</p>
			<p>As you can see <a id="_idIndexMarker204"/>in the previous screenshot, when the Cube object moves out of the camera's field of view, <code>OnBecameInvisible</code> will be called, and if it enters the camera's field of view, <code>OnBecameVisible</code> will be called. </p>
			<p>If your game logic is very complex, then you can use <code>OnBecameVisible</code>/<code>OnBecameInvisible</code> to avoid unnecessary performance overhead. For example, when a GameObject moves out of view, the functions of the GameObject can be suspended.</p>
			<p><code>OnRenderImage</code> is useful<a id="_idIndexMarker205"/> for implementing <strong class="bold">postprocessing</strong> effects<a id="_idIndexMarker206"/> in Unity. This function will be called after the Scene is completely rendered, and then you can apply a fullscreen effect to the image, which can greatly improve the appearance of your game. The following screenshots show the difference between an image with postprocessing and an image without postprocessing:</p>
			<div><div><img src="img/Figure_2.28_B17146.jpg" alt="Figure 2.28 – Scene with no postprocessing (Unity)&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.28 – Scene with no postprocessing (Unity)</p>
			<p>As shown in <em class="italic">Figure 2.29</em>, applying <a id="_idIndexMarker207"/>postprocessing enhances the overall look of the Scene and delivers stunning effects:</p>
			<div><div><img src="img/Figure_2.29_B17146.jpg" alt="Figure 2.29 – Scene with postprocessing (Unity)&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.29 – Scene with postprocessing (Unity)</p>
			<p>It is worth noting that in order to use <code>OnRenderImage</code> correctly, you need to attach the script that implements this function to the GameObject that the Camera component is attached to:</p>
			<pre>public class PostProcessing : MonoBehaviour
{
[SerializeField] 
private Material _mat;
    private void OnRenderImage(RenderTexture src,
      RenderTexture dest)
    {
        Graphics.Blit(src, dest, _mat);
    }
}</pre>
			<p>Sometimes, you may need <a id="_idIndexMarker208"/>to create some UI to do some prototypes or conduct some tests. Then, <code>OnGUI</code> is an ideal option for you. You can<a id="_idIndexMarker209"/> create an <code>OnGUI</code> function:</p>
			<pre>public class OnGUITest : MonoBehaviour
{
    private void OnGUI()
    {
        if (GUI.Button(new Rect(10, 10, 200, 100),
          "Button"))
        {
            Debug.Log("Hello World!");
        }
    }
}</pre>
			<p>The GUI line is a <a id="_idIndexMarker210"/><code>if</code> statement. This is because the code in the <code>if</code> block needs to be executed when the button is clicked. Specifically, taking the preceding code as an example, when the game is running and the button is clicked, this <code>if</code> statement returns <code>true</code> and executes the <code>Debug.Log("Hello World")</code> line in the <code>if</code> block to print out <strong class="bold">Hello World</strong> in the <strong class="bold">Console </strong>window.</p>
			<div><div><img src="img/Figure_2.30_B17146.jpg" alt="Figure 2.30 – IMGUI&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.30 – IMGUI</p>
			<p>The preceding screenshot shows an IMGUI button and the message printed in the Console window by clicking this button.</p>
			<p>In this section, we explained the life cycle of a script instance and some commonly used event functions offered by the Unity engine. In the next section, we will explore how to create a script file that will interact with the engine and add it as a component to a GameObject in the Scene.</p>
			<h1 id="_idParaDest-42"><a id="_idTextAnchor036"/>Creating a script and using it as a component</h1>
			<p>In addition to Unity's built-in components, we can also create script components. When you create a script and attach it to a GameObject, you can see the component you created in the GameObject's <strong class="bold">Inspector</strong> window, just like Unity's built-in components.</p>
			<h2 id="_idParaDest-43"><a id="_idTextAnchor037"/>How to create a new script in Unity</h2>
			<p>It is <a id="_idIndexMarker211"/>very easy to create a new C# script in Unity. I will introduce <a id="_idIndexMarker212"/>two different ways to do it.</p>
			<p>Firstly, you can right-click the <strong class="bold">Project</strong> panel in the Unity Editor, and then a menu will pop up. You only need to select <strong class="bold">Create</strong> | <strong class="bold">C# Script</strong>, then the Unity Editor will create a C# file in the folder identified in the <strong class="bold">Project</strong> panel. </p>
			<div><div><img src="img/Figure_2.31_B17146.jpg" alt="Figure 2.31 – Creating a new C# script from the Create menu&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.31 – Creating a new C# script from the Create menu</p>
			<p>The filename of the new script is <code>NewBehaviourScript.cs</code> by default. You can change the name when creating it.</p>
			<div><div><img src="img/Figure_2.32_B17146.jpg" alt="Figure 2.32 – Changing the name of the script when creating it&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.32 – Changing the name of the script when creating it</p>
			<p>For example, in the<a id="_idIndexMarker213"/> previous screenshot, the new C# file will be created in the <code>Assets/Chapter 2/Scripts</code> folder. In this way, the newly created script will not <a id="_idIndexMarker214"/>be automatically attached to a GameObject in the Scene. You need to manually add it to a GameObject later.</p>
			<p>On the other hand, you can also create a script and attach this script to a GameObject directly. What you need to do is to select a GameObject in the Scene and click <code>Assets</code> folder of your project. </p>
			<div><div><img src="img/Figure_2.33_B17146.jpg" alt="Figure 2.33 – Creating a new script from the Inspector window&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.33 – Creating a new script from the Inspector window</p>
			<p>Similar to creating <a id="_idIndexMarker215"/>a new script in the <code>NewBehaviourScript.cs</code>.</p>
			<div><div><img src="img/Figure_2.34_B17146.jpg" alt="Figure 2.34 – Changing the name of the script when creating it&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.34 – Changing the name of the script when creating it</p>
			<p>If you want to open<a id="_idIndexMarker217"/> the script in the IDE, we have set Visual Studio 2019 as the <a id="_idIndexMarker218"/>IDE for the Unity project; you can double-click the script file to open it in Visual Studio 2019. You will find the name of the C# class is the same as the name of the script file. </p>
			<div><div><img src="img/Figure_2.35_B17146.jpg" alt="Figure 2.35 – C# class name and the filename of the script&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.35 – C# class name and the filename of the script</p>
			<h2 id="_idParaDest-44"><a id="_idTextAnchor038"/>Adding a script as a component to a GameObject in the Scene</h2>
			<p>In the previous section, we introduced how to create a new script and attach it to a GameObject automatically. But we still need to learn how to add a script to a GameObject manually in the Editor and add a script component to a GameObject through C# code at runtime. </p>
			<h3>Adding a script component to a GameObject in the Editor</h3>
			<p>The easiest way to add a <a id="_idIndexMarker219"/>script as a component to a<a id="_idIndexMarker220"/> GameObject in the Unity Editor is to drag the script file to the GameObject. </p>
			<p>However, the following two situations may cause the script to not be added to the GameObject:</p>
			<ul>
				<li>The filename and the class name are different. This is why the name of the script is the same as the class name when the script is created. However, you may change one of them by mistake. So, if you cannot add a script to a GameObject, check the filename and the class name first. </li>
				<li>The second reason is relatively obvious: there are compile errors in the script. In this situation, the <strong class="bold">Console</strong> window will print out the compile errors. You need to fix all of these errors so that you can add them to a GameObject. </li>
			</ul>
			<div><div><img src="img/Figure_2.36_B17146.jpg" alt="Figure 2.36 – Can't add script message&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.36 – Can't add script message</p>
			<p>You can also <a id="_idIndexMarker221"/>add a script component to <a id="_idIndexMarker222"/>the GameObject from the <strong class="bold">Inspector</strong> window. The following steps demonstrate how to do it:</p>
			<ol>
				<li value="1">Select the GameObject that you want to attach the script to.</li>
				<li>Click the <strong class="bold">Add Component</strong> button in the <strong class="bold">Inspector</strong> window. Not only will the scripts we created be added, but also lots of built-in components can be added to the GameObject.</li>
				<li>In order to quickly find the script that needs to be added, we can enter the name of the script in the search box.</li>
				<li>Finally, select the target script in the drop-down box.</li>
			</ol>
			<div><div><img src="img/Figure_2.37_B17146.jpg" alt="Figure 2.37 – Adding a component from the Inspector window&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.37 – Adding a component from the Inspector window</p>
			<h3>Adding a script component to a GameObject at runtime</h3>
			<p>In <a id="_idIndexMarker223"/>addition to manually adding script components to a GameObject in the Editor, we can also add components to a GameObject through C# code at runtime.</p>
			<p>Let's open the <code>Test.cs</code> file we just created in Visual Studio 2019 and add a new field, as shown here:</p>
			<pre>[SerializeField] 
private HelloWorld _helloWorld;</pre>
			<p class="callout-heading">Note</p>
			<p class="callout">A field is a variable of any type that is declared directly in a class or struct. </p>
			<p>Here, you can see that the name of the private field of the <code>HelloWorld</code> type is <code>_helloWorld</code>, and you will also find that a <code>[SerializeField]</code> attribute is placed on the declaration of <code>_helloWorld</code>. This is to allow Unity to serialize this private field. We will discuss the serialization system in Unity in later chapters, but you should understand that when Unity serializes a script, it only serializes public fields by default. If a variable can be serialized by Unity, then it can be displayed and modified in the Unity Editor. So, you can use a public field here. However, generally, it is a good idea to use fields only for variables that have private or protected accessibility. This is why Unity provides developers with the <code>[SerializeField]</code> attribute, which will force Unity to serialize private fields.</p>
			<p>Then, we<a id="_idIndexMarker224"/> add the Test script component to a GameObject in the Scene by dragging it to the GameObject.</p>
			<div><div><img src="img/Figure_2.38_B17146.jpg" alt="Figure 2.38 – A GameObject with a Test component&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.38 – A GameObject with a Test component</p>
			<p>You can see that there is the serialized field of the Test script component attached to the GameObject in the previous screenshot. The value of this field is <code>Test.cs</code> script to attach the <code>HelloWorld</code> script component to the same GameObject and assign a reference to this new <code>HelloWorld</code> component to this field.</p>
			<p>Because we only want the code to run once, we can modify the <code>Start</code> function, as follows:</p>
			<pre>    void Start()
    {
        _helloWorld =
          gameObject.<strong class="bold">AddComponent&lt;HelloWorld&gt;()</strong>;
    }</pre>
			<p>Here, we <a id="_idIndexMarker225"/>are calling the <code>AddComponent&lt;T&gt;</code> method, which is a generic method to add the <code>HelloWorld</code> component to this GameObject, and it will return the reference to the attached component, so we can assign this value to the <code>_helloWorld</code> field.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">A generic method is a method that is declared with type parameters. The preceding code shows how to call the <code>AddComponent&lt;T&gt;</code> method by using <code>HelloWorld</code> for the type argument.</p>
			<p>It is worth noting that in addition to the generic method, there is also a version of <code>AddComponent</code>, which is <code>AddComponent(string className)</code>, a method with a string argument. It has been deprecated, so you should no longer use this method, but instead use the generic version.</p>
			<p>Play the game by clicking the <strong class="bold">Play</strong> button in the Unity Editor. </p>
			<div><div><img src="img/Figure_2.39_B17146.jpg" alt="Figure 2.39 – Attaching the HelloWorld component at runtime&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.39 – Attaching the HelloWorld component at runtime</p>
			<p>Looking at<a id="_idIndexMarker226"/> the <code>HelloWorld</code> component attached to the GameObject, and the reference to this component is assigned to the field of the Test component.</p>
			<p>Well done. Now we have learned how to add components to the GameObjects in the Scene. Next, let's explore how to access components on the same GameObject or different GameObjects through C# code.</p>
			<h2 id="_idParaDest-45"><a id="_idTextAnchor039"/>Accessing a component attached to a GameObject</h2>
			<p>When<a id="_idIndexMarker227"/> we develop a Unity project, we often need to access other components, because we can reuse the functions defined by different components.</p>
			<p>Here, let's add some code to the <code>HelloWorld.cs</code> script to print a <strong class="bold">Hello World!</strong> message to the Console window in the Editor:</p>
			<pre>    public void SayHi()
    {
        Debug.Log("Hello World!");
    }</pre>
			<p class="callout-heading">Note</p>
			<p class="callout">The <code>Debug.Log</code> line in the <code>SayHi</code> method is a commonly used method to print messages that can help you debug your game to the Console window. The <code>Debug</code> class also offers many other methods, such as <code>LogError</code>, <code>LogWarning</code>, and <code>Assert</code>.</p>
			<p>We can think of this as a feature that we want to reuse in different scripts. Then, we also need to create a new script called <code>TestGetComponent.cs</code>. This is the script where we will place the code to access the <code>HelloWorld</code> component at runtime:</p>
			<pre>public class TestGetComponent : MonoBehaviour
{
    void Update()
    {
        var helloWorld =
          gameObject.<strong class="bold">GetComponent&lt;HelloWorld&gt;()</strong>;
        if (helloWorld == null)
        {
            return;
        }
        helloWorld.SayHi();
    }
}</pre>
			<p>As we<a id="_idIndexMarker228"/> already know that the <code>Update</code> function runs at every frame of the game, in order to demonstrate how to access a component, we can put the code in the <code>Update</code> function, as shown in the code of the <code>TestGetComponent</code> class. </p>
			<div><div><img src="img/Figure_2.40_B17146.jpg" alt="Figure 2.40 – A GameObject with the TestGetComponent component&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.40 – A GameObject with the TestGetComponent component</p>
			<p>Then, we <a id="_idIndexMarker229"/>attach the <code>TestGetComponent</code> script to the same GameObject as a component, play the game, and look at the Console window. The <strong class="bold">Hello World!</strong> message appears there.</p>
			<div><div><img src="img/Figure_2.41_B17146.jpg" alt="Figure 2.41 – Hello World! appears in the Console window&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.41 – Hello World! appears in the Console window</p>
			<p class="callout-heading">Note</p>
			<p class="callout">For performance reasons, it is recommended to not use this function in every frame.</p>
			<p>In this case, we accessed other components attached to the same GameObject. Additionally, we can also access other components on different GameObjects. </p>
			<p>Firstly, we need to get the reference of the target GameObject. Here, we can either assign the referenced object to this script in the Editor or use the <code>GameObject.Find</code> method to find the target object at runtime. From the perspective of game performance, don't call the <code>GameObject.Find</code> method to find the target object in a method such as <code>Update</code> that is called at every frame. If you can't assign a reference to your script in the Editor, for example, the referenced object is dynamically created at runtime, then you can use this method to find the target object and cache the target object instead of finding the target object at every frame. In this example, we can find the target<a id="_idIndexMarker230"/> object and cache it in the <code>Start</code> method, as shown:</p>
			<pre>private GameObject _targetGameObject;
    private void Start()
    {
        // Using Find method to find game objects is not
           recommended,
        // this is just to demonstrate how to call this
           method to find
        // the target object at runtime.
        <strong class="bold">_targetGameObject</strong> =
          GameObject.<strong class="bold">Find</strong>("GameObjectTest");
    }</pre>
			<p>Then, let's change the <code>Update</code> function of the <code>TestGetComponent</code> class, as follows:</p>
			<pre>    void Update()
{
 
        var helloWorld =
          <strong class="bold">_targetGameObject</strong>.GetComponent&lt;HelloWorld&gt;();
        if (helloWorld == null)
        {
            return;
        }
        helloWorld.SayHi();
    }</pre>
			<p>Here, we are using the <code>GameObject.Find(string name)</code> function to find a GameObject by name and return it. The name of the target GameObject is <code>GameObjectTest</code>. </p>
			<p>There are other<a id="_idIndexMarker231"/> functions that can be used to look for a GameObject at runtime, such as <code>GameObject.FindWithTag(string tag)</code>, which returns one active GameObject tagged <code>tag</code>. However, in order to use this function correctly, the tag must first be declared in the tag manager. You can manage these tags from <strong class="bold">Project Settings</strong> |<strong class="bold"> Tags and Layers</strong>.</p>
			<p>However, as we mentioned earlier, the <code>Find</code> method and its variants are not recommended to find GameObjects. This example is just to demonstrate how to call the method at runtime to find the target object if you need to find dynamically created objects at runtime.</p>
			<p>Next, we create a new GameObject and attach the <code>TestGetComponent</code> script to it. At the same time, remove the <code>TestGetComponent</code> script from the target GameObject named <code>GameObjectTest</code>.</p>
			<div><div><img src="img/Figure_2.42_B17146.jpg" alt="Figure 2.42 – A GameObject with the TestGetComponent component&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.42 – A GameObject with the TestGetComponent component</p>
			<p>Play the <a id="_idIndexMarker232"/>game and look at the Console window. The same <strong class="bold">Hello World!</strong> message appears there again. </p>
			<p>In this section, we learned how to create a new script in Unity and how to attach a script as a component to a GameObject, and also discussed how to access a component through code at runtime to reuse functions. Next, let's explore the Unity Package Manager and packages in Unity.</p>
			<h1 id="_idParaDest-46"><a id="_idTextAnchor040"/>Packages and the Unity Package Manager</h1>
			<p>If you are a .NET developer, then I believe that you must know the <strong class="bold">NuGet</strong> package manager. The Package Manager in<a id="_idIndexMarker233"/> Unity is very similar to NuGet, which enables game developers to share and consume useful code. But they are different. In Unity, you can reuse not only useful code but also digital assets, Shaders, plugins, and icons. A package in Unity is a container that includes the contents mentioned earlier. </p>
			<p>In this section, I will introduce packages and Package Manager in Unity so that you can understand the package mechanism in Unity and how to use the Unity Package Manager to manage packages.</p>
			<h2 id="_idParaDest-47"><a id="_idTextAnchor041"/>Unity Package Manager</h2>
			<p>Unity provides game developers with a tool called the<a id="_idIndexMarker234"/> Unity Package Manager to manage the packages in a project and add new packages to the project. We can open the Package Manager window by clicking <strong class="bold">Window</strong> | <strong class="bold">Package Manager</strong>.</p>
			<div><div><img src="img/Figure_2.43_B17146.jpg" alt="Figure 2.43 – Opening the Package Manager window from the Window menu&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.43 – Opening the Package Manager window from the Window menu</p>
			<p>By default, this window shows the installed packages in your project and the version of each package. If a new version of a package is available, there will be an <strong class="bold">upgrade</strong> icon beside the version number. You can also sort these packages, for example, in ascending order by name or descending order by release date.</p>
			<div><div><img src="img/Figure_2.44_B17146.jpg" alt="Figure 2.44 – Unity Package Manager&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.44 – Unity Package Manager</p>
			<p>On the right side of the <a id="_idIndexMarker235"/>window, detailed information on the currently selected package will be displayed, such as the package name, publisher, release date, version number, document link, and description. You can also remove a package from your project by clicking the <strong class="bold">Remove</strong> button in the lower-right corner.</p>
			<div><div><img src="img/Figure_2.45_B17146.jpg" alt="Figure 2.45 – Switching package lists&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.45 – Switching package lists</p>
			<p>This window can also display different lists. For example, you can view, download, and import assets purchased from the <a id="_idIndexMarker236"/>Unity Asset Store (<a href="https://assetstore.unity.com/">https://assetstore.unity.com/</a>) by selecting the <strong class="bold">My Assets</strong> option from the drop-down menu. </p>
			<p>The assets purchased from the Asset Store may be free or paid. The Asset Store provides a variety of assets, covering everything from textures, models, and animations to entire project examples.</p>
			<div><div><img src="img/Figure_2.46_B17146.jpg" alt="Figure 2.46 – Packages in Unity Registry&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.46 – Packages in Unity Registry</p>
			<p>You can also install a package<a id="_idIndexMarker237"/> from Unity Registry. By selecting the <strong class="bold">Unity Registry</strong> option from the drop-down menu, you can browse all packages registered in Unity Registry. If you want to install a package, you need to select it and click the <strong class="bold">Install</strong> button in the lower-right corner.</p>
			<p>In addition to installing a package from Unity Registry, the Unity Package Manager also provides other ways to install a package, that is, installing a new package from a local folder, installing a new package from a local tarball file, and installing a new package using a Git URL.</p>
			<div><div><img src="img/Figure_2.47_B17146.jpg" alt="Figure 2.47 – Installing a new package&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.47 – Installing a new package</p>
			<p>You can use <a id="_idIndexMarker238"/>these three different ways to add a new package by clicking the <strong class="bold">+</strong> button in the upper-left corner of the Package Manager window. </p>
			<p>Some of the built-in features of the Unity game engine are also provided as packages. You can view the list of all built-in packages by selecting the <strong class="bold">Built-in</strong> option from the drop-down menu. Here, you can manage these built-in features. You can reduce the runtime build size of your game by disabling packages that you do not need. For example, if you develop a game without VR or AR functionality, you can disable XR-related packages by clicking the <strong class="bold">Disable</strong> button in the lower-right corner of the <strong class="bold">Package Manager</strong> window. </p>
			<div><div><img src="img/Figure_2.48_B17146.jpg" alt="Figure 2.48 – Built-in packages&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.48 – Built-in packages</p>
			<h2 id="_idParaDest-48"><a id="_idTextAnchor042"/>Package</h2>
			<p>A package<a id="_idIndexMarker239"/> is a container that contains features to meet various needs of a project. You can add a new feature to your game by adding a package. For example, the <strong class="bold">AR Foundation</strong> package will provide AR functionality. You can also remove a package to reduce the size of your game. Therefore, the use of packages makes Unity game development more flexible and decoupled. </p>
			<p>However, if you are<a id="_idIndexMarker240"/> not careful, using a package may also make your game full of bugs. This is because different packages may be in different states. </p>
			<div><div><img src="img/Figure_2.49_B17146.jpg" alt="Figure 2.49 – Package life cycle with Unity Package Manager (Unity)&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.49 – Package life cycle with Unity Package Manager (Unity)</p>
			<p>A package developed and maintained by Unity may be in one of the following two states:</p>
			<ul>
				<li>Preview packages</li>
				<li>Verified packages</li>
			</ul>
			<p>A package in <a id="_idIndexMarker241"/>preview means <a id="_idIndexMarker242"/>that it is currently ready for testing, and it may go through many changes in later versions. Unity cannot guarantee future support for preview packages, so you should not use them in production.</p>
			<p>By default, you cannot find packages in the preview state in the Package Manager window. If you really need to use the preview packages, for example, to test new features for future projects, you can follow these steps to allow the Package Manager window to display the packages in the preview state:</p>
			<ol>
				<li value="1">Open the <strong class="bold">Project Settings</strong> window for the Package Manager by clicking the gear icon and then clicking the <strong class="bold">Advanced Project Settings</strong> item. </li>
			</ol>
			<div><div><img src="img/Figure_2.50_B17146.jpg" alt="Figure 2.50 – Advanced Project Settings&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.50 – Advanced Project Settings</p>
			<ol>
				<li value="2">Check <a id="_idIndexMarker243"/>the <strong class="bold">Enable Preview Packages</strong> option.</li>
			</ol>
			<div><div><img src="img/Figure_2.51_B17146.jpg" alt="Figure 2.51 – Package Manager settings&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.51 – Package Manager settings</p>
			<ol>
				<li value="3">Then, look at the<a id="_idIndexMarker244"/> Package Manager window. You will see that the preview packages <a id="_idIndexMarker245"/>appear in the package list. In the package list, all packages in the preview state are marked with <strong class="bold">Preview</strong>.</li>
			</ol>
			<div><div><img src="img/Figure_2.52_B17146.jpg" alt="Figure 2.52 – Preview packages&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.52 – Preview packages</p>
			<p>On the other hand, a package in the verified state means it can be used in production. A package will only be considered a verified package if it has been rigorously tested and Unity guarantees supporting that verified package. </p>
			<p>The Package Manager window displays the <a id="_idIndexMarker246"/>verified packages list by default. Packages in the<a id="_idIndexMarker247"/> verified state are marked with <strong class="bold">Verified</strong>.</p>
			<div><div><img src="img/Figure_2.53_B17146.jpg" alt="Figure 2.53 – Verified packages&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.53 – Verified packages</p>
			<h1 id="_idParaDest-49"><a id="_idTextAnchor043"/>Summary</h1>
			<p>In this chapter, we started by introducing some of the most commonly used classes in Unity script programming, and then explained the life cycle and important event functions of a script instance, as well as discussing how Unity initializes a script and how the game logic is updated in a script. </p>
			<p>We also discussed how to create a new script in Unity and how to attach a script as a component to a GameObject. In addition to manually adding components in the Editor, we can also use C# code to dynamically add a component or access a component at runtime.</p>
			<p>Finally, we demonstrated how to add or remove a package through the Unity Package Manager to provide a feature or reduce the size of the game. At the same time, we also explained the difference between preview packages and verified packages.</p>
			<p>In the next chapter, we will learn about the UI system in Unity and, at the same time, we will also introduce how to optimize UI performance in Unity.</p>
		</div>
	</body></html>