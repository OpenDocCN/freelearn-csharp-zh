<html><head></head><body>
<div class="Basic-Text-Frame" id="_idContainer055">
<h1 class="chapterNumber"><span class="koboSpan" id="kobo.1.1">2</span></h1>
<h1 class="chapterTitle" id="_idParaDest-44"><span class="koboSpan" id="kobo.2.1">Non-Functional Requirements</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.3.1">Once you have gathered the system requirements, it is time to think about the impact they have on the architectural design. </span><span class="koboSpan" id="kobo.3.2">Scalability, availability, resiliency, performance, multithreading, interoperability, security, and other aspects need to be analyzed so that we can meet user needs. </span><span class="koboSpan" id="kobo.3.3">We refer to these aspects as non-functional requirements.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.4.1">We will cover the following topics in this chapter:</span></p>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.5.1">Enabling scalability, availability, and resiliency with Azure and .NET 8</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.6.1">Performance issues that need to be considered when programming in C#</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.7.1">Software usability: how to design effective user interfaces</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.8.1">Interoperability with .NET 8</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.9.1">Achieving security by design</span></li>
</ul>
<p class="normal"><span class="koboSpan" id="kobo.10.1">The main purpose of discussing non-functional requirements here is that they are highly relevant to software architects: even though they are not so important to getting the software working in terms of functionality, they can make all the difference when comparing good software and bad software.</span></p>
<h1 class="heading-1" id="_idParaDest-45"><span class="koboSpan" id="kobo.11.1">Technical requirements</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.12.1">The samples provided in this chapter require Visual Studio 2022 Community Edition with the .NET 8 SDK installed.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.13.1">You can find the sample code for this chapter at </span><a href="https://github.com/PacktPublishing/Software-Architecture-with-C-Sharp-12-and-.NET-8-4E"><span class="url"><span class="koboSpan" id="kobo.14.1">https://github.com/PacktPublishing/Software-Architecture-with-C-Sharp-12-and-.NET-8-4E</span></span></a><span class="koboSpan" id="kobo.15.1">.</span></p>
<h1 class="heading-1" id="_idParaDest-46"><span class="koboSpan" id="kobo.16.1">Enabling scalability, availability, and resiliency with Azure and .NET 8</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.17.1">A quick search online</span><a id="_idIndexMarker088"/><span class="koboSpan" id="kobo.18.1"> for a definition of “scalability” returns</span><a id="_idIndexMarker089"/><span class="koboSpan" id="kobo.19.1"> something </span><a id="_idIndexMarker090"/><span class="koboSpan" id="kobo.20.1">along the lines</span><a id="_idIndexMarker091"/><span class="koboSpan" id="kobo.21.1"> of “the ability of a system</span><a id="_idIndexMarker092"/><span class="koboSpan" id="kobo.22.1"> to keep working well</span><a id="_idIndexMarker093"/><span class="koboSpan" id="kobo.23.1"> when there is an increase in demand.” </span><span class="koboSpan" id="kobo.23.2">When</span><a id="_idIndexMarker094"/><span class="koboSpan" id="kobo.24.1"> developers</span><a id="_idIndexMarker095"/><span class="koboSpan" id="kobo.25.1"> go by this definition, many of them incorrectly conclude that scalability</span><a id="_idIndexMarker096"/><span class="koboSpan" id="kobo.26.1"> only means adding more hardware</span><a id="_idIndexMarker097"/><span class="koboSpan" id="kobo.27.1"> to keep things</span><a id="_idIndexMarker098"/><span class="koboSpan" id="kobo.28.1"> working without stopping</span><a id="_idIndexMarker099"/><span class="koboSpan" id="kobo.29.1"> their apps.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.30.1">Scalability relies on hardware solutions to some extent. </span><span class="koboSpan" id="kobo.30.2">However, as a software architect, you need to be aware that good software will keep scalability in a sustainable model, which means that well-architected software can save a lot of money. </span><span class="koboSpan" id="kobo.30.3">Hence, scalability is not just a matter of hardware but also a matter of overall software design. </span><span class="koboSpan" id="kobo.30.4">The point here is that the running costs of a system should also be a factor in architectural decisions.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.31.1">In </span><em class="chapterRef"><span class="koboSpan" id="kobo.32.1">Chapter 1</span></em><span class="koboSpan" id="kobo.33.1">,</span><em class="italic"><span class="koboSpan" id="kobo.34.1"> Understanding the Importance of Software Architecture</span></em><span class="koboSpan" id="kobo.35.1">, while discussing software performance, we presented some good tips to overcome performance issues. </span><span class="koboSpan" id="kobo.35.2">The same tips will help you with scalability, too. </span><span class="koboSpan" id="kobo.35.3">The fewer resources we spend on each process, the more users an application can handle.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.36.1">Although scalability is important, cloud computing applications must be designed to work with system failures. </span><span class="koboSpan" id="kobo.36.2">Every time you guarantee that your application can recover from a failure without exposing the failure to the end user, you are creating a resilient application.</span></p>
<div class="note">
<p class="normal"><span class="koboSpan" id="kobo.37.1">You may find cloud architecture</span><a id="_idIndexMarker100"/><span class="koboSpan" id="kobo.38.1"> resiliency patterns at </span><a href="https://docs.microsoft.com/en-us/azure/architecture/framework/resiliency/reliability-patterns#resiliency"><span class="url"><span class="koboSpan" id="kobo.39.1">https://docs.microsoft.com/en-us/azure/architecture/framework/resiliency/reliability-patterns#resiliency</span></span></a><span class="koboSpan" id="kobo.40.1">.</span></p>
</div>
<p class="normal"><span class="koboSpan" id="kobo.41.1">The reason why resiliency is especially important in cloud scenarios is that the infrastructure provided to you may need a small amount of time to manage updates, resets, and even hardware upgrades. </span><span class="koboSpan" id="kobo.41.2">You are also more likely to have to work with multiple systems, and transient errors are likely to occur in communicating with them. </span><span class="koboSpan" id="kobo.41.3">That is why the non-functional requirement of resiliency has gained a higher profile in recent years.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.42.1">The possibility of having scalable and resilient solutions gets more exciting when you can enable high availability in the system. </span><span class="koboSpan" id="kobo.42.2">All the approaches presented in this book will help you to design solutions with good availability, but in some cases, you will need to design specific alternatives to achieve your specific goal.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.43.1">It is worth</span><a id="_idIndexMarker101"/><span class="koboSpan" id="kobo.44.1"> knowing</span><a id="_idIndexMarker102"/><span class="koboSpan" id="kobo.45.1"> that</span><a id="_idIndexMarker103"/><span class="koboSpan" id="kobo.46.1"> Azure </span><a id="_idIndexMarker104"/><span class="koboSpan" id="kobo.47.1">and .NET 8 web</span><a id="_idIndexMarker105"/><span class="koboSpan" id="kobo.48.1"> apps</span><a id="_idIndexMarker106"/><span class="koboSpan" id="kobo.49.1"> can</span><a id="_idIndexMarker107"/><span class="koboSpan" id="kobo.50.1"> be</span><a id="_idIndexMarker108"/><span class="koboSpan" id="kobo.51.1"> configured</span><a id="_idIndexMarker109"/><span class="koboSpan" id="kobo.52.1"> to achieve</span><a id="_idIndexMarker110"/><span class="koboSpan" id="kobo.53.1"> these</span><a id="_idIndexMarker111"/><span class="koboSpan" id="kobo.54.1"> non-functional</span><a id="_idIndexMarker112"/><span class="koboSpan" id="kobo.55.1"> requirements. </span><span class="koboSpan" id="kobo.55.2">Let us check this out in the following subsections.</span></p>
<h2 class="heading-2" id="_idParaDest-47"><span class="koboSpan" id="kobo.56.1">Creating a scalable web app in Azure</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.57.1">It is simple to create a web app</span><a id="_idIndexMarker113"/><span class="koboSpan" id="kobo.58.1"> in Azure that is ready for scaling. </span><span class="koboSpan" id="kobo.58.2">The reason why you must do so is to be able to maintain different numbers of users during different seasons. </span><span class="koboSpan" id="kobo.58.3">The more users you have, the more hardware you will need. </span><span class="koboSpan" id="kobo.58.4">Let us show you how to create a scalable web application in Azure.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.59.1">As soon as you log in to your Azure account, you will be able to create a new resource (web app, database, virtual machine, and so on), as you can see in the following screenshot:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.60.1"><img alt="" role="presentation" src="../Images/B19820_02_01.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.61.1">Figure 2.1: Microsoft Azure – Create a resource</span></p>
<p class="normal"><span class="koboSpan" id="kobo.62.1">After that, you can select </span><strong class="keyWord"><span class="koboSpan" id="kobo.63.1">App Services in Popular Options</span></strong><span class="koboSpan" id="kobo.64.1"> or even type it into the </span><strong class="keyWord"><span class="koboSpan" id="kobo.65.1">Search the Marketplace</span></strong><span class="koboSpan" id="kobo.66.1"> textbox. </span><span class="koboSpan" id="kobo.66.2">Then, you can choose to create a </span><strong class="keyWord"><span class="koboSpan" id="kobo.67.1">web app</span></strong><span class="koboSpan" id="kobo.68.1">. </span><span class="koboSpan" id="kobo.68.2">This action will take you to the following</span><a id="_idIndexMarker114"/><span class="koboSpan" id="kobo.69.1"> screen:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.70.1"><img alt="" role="presentation" src="../Images/B19820_02_02.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.71.1">Figure 2.2: Microsoft Azure – Creating a web app</span></p>
<p class="normal"><span class="koboSpan" id="kobo.72.1">The required </span><strong class="keyWord"><span class="koboSpan" id="kobo.73.1">Project Details</span></strong><span class="koboSpan" id="kobo.74.1"> are as follows:</span></p>
<ul>
<li class="bulletList"><strong class="keyWord"><span class="koboSpan" id="kobo.75.1">Subscription</span></strong><span class="koboSpan" id="kobo.76.1">: This is the account that will be charged for all application costs.</span></li>
<li class="bulletList"><strong class="keyWord"><span class="koboSpan" id="kobo.77.1">Resource Group</span></strong><span class="koboSpan" id="kobo.78.1">: This is the collection of resources you can define to organize policies and permissions. </span><span class="koboSpan" id="kobo.78.2">You may specify a new resource group name or add the web app to a group specified during the definition of other resources.</span></li>
</ul>
<p class="normal"><span class="koboSpan" id="kobo.79.1">Besides these, the </span><strong class="keyWord"><span class="koboSpan" id="kobo.80.1">Instance Details</span></strong><span class="koboSpan" id="kobo.81.1"> are as follows:</span></p>
<ul>
<li class="bulletList"><strong class="keyWord"><span class="koboSpan" id="kobo.82.1">Name</span></strong><span class="koboSpan" id="kobo.83.1">: As you can see, the web app name is the URL that your solution will assume after its creation. </span><span class="koboSpan" id="kobo.83.2">The name must be globally unique and is checked to ensure it is available.</span></li>
<li class="bulletList"><strong class="keyWord"><span class="koboSpan" id="kobo.84.1">Publish</span></strong><span class="koboSpan" id="kobo.85.1">: This parameter indicates whether the web app will be delivered directly, a static web app, or whether it is going to use Docker technology to publish content. </span><span class="koboSpan" id="kobo.85.2">Docker will be discussed in more detail in </span><em class="chapterRef"><span class="koboSpan" id="kobo.86.1">Chapter 11</span></em><span class="koboSpan" id="kobo.87.1">, </span><em class="italic"><span class="koboSpan" id="kobo.88.1">Applying a Microservice Architecture to Your Enterprise Application</span></em><span class="koboSpan" id="kobo.89.1">. </span><span class="koboSpan" id="kobo.89.2">If you opt for the Docker container publication, you will be able to configure the </span><strong class="keyWord"><span class="koboSpan" id="kobo.90.1">Image Source</span></strong><span class="koboSpan" id="kobo.91.1">, </span><strong class="keyWord"><span class="koboSpan" id="kobo.92.1">Access Type</span></strong><span class="koboSpan" id="kobo.93.1">, and </span><strong class="keyWord"><span class="koboSpan" id="kobo.94.1">Image</span></strong><span class="koboSpan" id="kobo.95.1"> and tag information to have it deployed to the web app.</span></li>
<li class="bulletList"><strong class="keyWord"><span class="koboSpan" id="kobo.96.1">Runtime stack</span></strong><span class="koboSpan" id="kobo.97.1">: This option is obviously only available when you decide to deliver code directly. </span><span class="koboSpan" id="kobo.97.2">You could define stacks for .NET, Go, Java, Node.js, PHP, Python, and Ruby.</span></li>
<li class="bulletList"><strong class="keyWord"><span class="koboSpan" id="kobo.98.1">Operating System</span></strong><span class="koboSpan" id="kobo.99.1">: This is the option for defining the OS that will host the web app. </span><span class="koboSpan" id="kobo.99.2">Both Windows and Linux may be used for .NET projects in the newest versions.</span></li>
<li class="bulletList"><strong class="keyWord"><span class="koboSpan" id="kobo.100.1">Region</span></strong><span class="koboSpan" id="kobo.101.1">: You may consider</span><a id="_idIndexMarker115"/><span class="koboSpan" id="kobo.102.1"> where you want to deploy your application; Azure has many different data centers all over the world.</span></li>
<li class="bulletList"><strong class="keyWord"><span class="koboSpan" id="kobo.103.1">Pricing Plans</span></strong><span class="koboSpan" id="kobo.104.1">: This is where you define the hardware plan that is used to handle the web app and the region of the servers. </span><span class="koboSpan" id="kobo.104.2">This choice defines application scalability, performance, and costs.</span></li>
<li class="bulletList"><strong class="keyWord"><span class="koboSpan" id="kobo.105.1">Zone redundancy: </span></strong><span class="koboSpan" id="kobo.106.1">Starting with premium pricing plans, you will be able to activate zone redundancy, which will increase the availability of the solution.</span></li>
<li class="bulletList"><strong class="keyWord"><span class="koboSpan" id="kobo.107.1">Deployment:</span></strong><span class="koboSpan" id="kobo.108.1"> It is possible to define the GitHub repository that is responsible for continuously deploying the application.</span></li>
<li class="bulletList"><strong class="keyWord"><span class="koboSpan" id="kobo.109.1">Networking:</span></strong><span class="koboSpan" id="kobo.110.1"> You may select the network behavior of the application according to its requirements and proposal.</span></li>
<li class="bulletList"><strong class="keyWord"><span class="koboSpan" id="kobo.111.1">Monitoring</span></strong><span class="koboSpan" id="kobo.112.1">: This is a useful Azure toolset for monitoring and troubleshooting web apps. </span><span class="koboSpan" id="kobo.112.2">In this section, you can enable </span><strong class="keyWord"><span class="koboSpan" id="kobo.113.1">Application Insights</span></strong><span class="koboSpan" id="kobo.114.1">. </span><span class="koboSpan" id="kobo.114.2">It is always recommended that you keep the same regions for the different components of your solution since this will save costs in terms of traffic exchange from one data center to another.</span></li>
</ul>
<p class="normal"><span class="koboSpan" id="kobo.115.1">Once you have created</span><a id="_idIndexMarker116"/><span class="koboSpan" id="kobo.116.1"> your web app, this application may be scaled in two conceptually different ways: vertically (</span><strong class="screenText"><span class="koboSpan" id="kobo.117.1">scale up</span></strong><span class="koboSpan" id="kobo.118.1">) and horizontally (</span><strong class="screenText"><span class="koboSpan" id="kobo.119.1">scale out</span></strong><span class="koboSpan" id="kobo.120.1">). </span><span class="koboSpan" id="kobo.120.2">Both are available in the web app settings, as you can see in the following screenshot:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.121.1"><img alt="" role="presentation" src="../Images/B19820_02_03.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.122.1">Figure 2.3: Scaling options for web apps</span></p>
<p class="normal"><span class="koboSpan" id="kobo.123.1">Let us check out the two types of scaling.</span></p>
<h3 class="heading-3" id="_idParaDest-48"><span class="koboSpan" id="kobo.124.1">Vertical scaling (scaling up)</span></h3>
<p class="normal"><span class="koboSpan" id="kobo.125.1">Scaling up means changing</span><a id="_idIndexMarker117"/><span class="koboSpan" id="kobo.126.1"> the specification of the hardware</span><a id="_idIndexMarker118"/><span class="koboSpan" id="kobo.127.1"> that will host your application. </span><span class="koboSpan" id="kobo.127.2">In Azure, you have the opportunity to start with free, shared hardware and move to an isolated machine in a few clicks. </span><span class="koboSpan" id="kobo.127.3">The following screenshot shows the user interface for scaling up a web app:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.128.1"><img alt="" role="presentation" src="../Images/B19820_02_04.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.129.1">Figure 2.4: Vertical scaling options</span></p>
<p class="normal"><span class="koboSpan" id="kobo.130.1">By choosing one of the options provided, you can select more powerful hardware (machines with more CPUs, storage, and RAM). </span><span class="koboSpan" id="kobo.130.2">Monitoring your application and its App Service plan will guide you on how to decide the best infrastructure for running your solution. </span><span class="koboSpan" id="kobo.130.3">It will also offer key insights, such as possible CPU, memory, and I/O bottlenecks.</span></p>
<h3 class="heading-3" id="_idParaDest-49"><span class="koboSpan" id="kobo.131.1">Horizontal scaling (scaling out)</span></h3>
<p class="normal"><span class="koboSpan" id="kobo.132.1">Scaling out means splitting</span><a id="_idIndexMarker119"/><span class="koboSpan" id="kobo.133.1"> requests between </span><a id="_idIndexMarker120"/><span class="koboSpan" id="kobo.134.1">more servers and using the same capacity instead of using more powerful machines. </span><span class="koboSpan" id="kobo.134.2">The load on all the servers is automatically balanced by the Azure infrastructure. </span><span class="koboSpan" id="kobo.134.3">This solution is advised when the overall load may change considerably in the future since horizontal scaling can automatically adapt to a given load. </span><span class="koboSpan" id="kobo.134.4">The following screenshot shows an automatic </span><strong class="screenText"><span class="koboSpan" id="kobo.135.1">Scale out</span></strong><span class="koboSpan" id="kobo.136.1"> strategy defined by two simple rules, triggered by CPU usage:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.137.1"><img alt="" role="presentation" src="../Images/B19820_02_05.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.138.1">Figure 2.5: Horizontal scaling sample</span></p>
<p class="normal"><span class="koboSpan" id="kobo.139.1">It is worth highlighting that you can choose to have a hardcoded instance count or implement rules for automatic scale in/out.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.140.1">A complete description of all the available</span><a id="_idIndexMarker121"/><span class="koboSpan" id="kobo.141.1"> autoscale rules is beyond</span><a id="_idIndexMarker122"/><span class="koboSpan" id="kobo.142.1"> the scope of this book. </span><span class="koboSpan" id="kobo.142.2">However, they are quite self-explanatory, and the </span><em class="italic"><span class="koboSpan" id="kobo.143.1">Further reading</span></em><span class="koboSpan" id="kobo.144.1"> section contains links to the full documentation.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.145.1">The </span><strong class="keyWord"><span class="koboSpan" id="kobo.146.1">Scale out</span></strong><span class="koboSpan" id="kobo.147.1"> feature is only available in paid service plans.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.148.1">In general, horizontal scaling</span><a id="_idIndexMarker123"/><span class="koboSpan" id="kobo.149.1"> is a way to guarantee</span><a id="_idIndexMarker124"/><span class="koboSpan" id="kobo.150.1"> availability in an application even with several simultaneous accesses. </span><span class="koboSpan" id="kobo.150.2">For sure, its use is not the only way to keep a system available, but it does help.</span></p>
<h2 class="heading-2" id="_idParaDest-50"><span class="koboSpan" id="kobo.151.1">Creating a scalable web app with .NET 8</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.152.1">Among all the available frameworks</span><a id="_idIndexMarker125"/><span class="koboSpan" id="kobo.153.1"> for implementing web apps, running</span><a id="_idIndexMarker126"/><span class="koboSpan" id="kobo.154.1"> web apps with ASP.NET Core in .NET 8 ensures good performance, together with low production and maintenance costs. </span><span class="koboSpan" id="kobo.154.2">The union of C#, a strongly typed and advanced general-purpose language, and continuous performance improvements achieved in ASP.NET Core distinguish this option as one of the best for enterprise development.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.155.1">The steps in this section will guide you through the creation of an ASP.NET Core Runtime 8-based web app. </span><span class="koboSpan" id="kobo.155.2">All the steps are quite simple, but some details require particular attention.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.156.1">It is worth mentioning that .NET 8 gives you the opportunity to develop for any platform – desktops (WPF, Windows Forms, and UWP), web (ASP.NET), cloud (Azure), mobile (Xamarin), gaming (Unity), IoT (ARM32 and ARM64), or AI (ML.NET and .NET for Apache Spark). </span><span class="koboSpan" id="kobo.156.2">So, the recommendation from now on is to only use .NET 8. </span><span class="koboSpan" id="kobo.156.3">In this scenario, you can run your web app on either Windows servers or cheaper Linux servers.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.157.1">Nowadays, Microsoft recommends classic .NET, just in case the features you need are not available in .NET Core/5+ or you are deploying your web app in an environment that does not support .NET Core. </span><span class="koboSpan" id="kobo.157.2">In any other case, you should prefer .NET Core/5+ because it allows you to do the following:</span></p>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.158.1">Run your web app in Windows, Linux, macOS, or Docker containers</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.159.1">Design your solution with microservices</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.160.1">Have high-performance and scalable systems</span></li>
</ul>
<p class="normal"><span class="koboSpan" id="kobo.161.1">Containers and microservices will be covered in </span><em class="chapterRef"><span class="koboSpan" id="kobo.162.1">Chapter 11</span></em><span class="koboSpan" id="kobo.163.1">,</span><em class="italic"><span class="koboSpan" id="kobo.164.1"> Applying a Microservice Architecture to Your Enterprise Application</span></em><span class="koboSpan" id="kobo.165.1">. </span><span class="koboSpan" id="kobo.165.2">There, you will get a better understanding of the advantages of these technologies. </span><span class="koboSpan" id="kobo.165.3">For now, it is enough to say that .NET 8 and microservices were designed for performance and scalability, which is why you should prefer .NET 8 in all your new projects. </span><span class="koboSpan" id="kobo.165.4">Besides, .NET 8 is guaranteed by Microsoft as a Long Term Support version, which means three years of patches and free support.</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.166.1"><img alt="" role="presentation" src="../Images/B19820_02_06.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.167.1">Figure 2.6: .NET 8 support policy</span></p>
<p class="normal"><span class="koboSpan" id="kobo.168.1">The following procedure</span><a id="_idIndexMarker127"/><span class="koboSpan" id="kobo.169.1"> will show you how to create an ASP.NET Core web</span><a id="_idIndexMarker128"/><span class="koboSpan" id="kobo.170.1"> app in Visual Studio 2022 with .NET 8:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.171.1">As soon as you start VS 2022, you will be able to click on </span><strong class="screenText"><span class="koboSpan" id="kobo.172.1">Create a new project</span></strong><span class="koboSpan" id="kobo.173.1">.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.174.1">Once you select </span><strong class="screenText"><span class="koboSpan" id="kobo.175.1">ASP.NET Core Web App</span></strong><span class="koboSpan" id="kobo.176.1">, you will be directed to a screen where you will be asked to set up </span><strong class="screenText"><span class="koboSpan" id="kobo.177.1">Project name</span></strong><span class="koboSpan" id="kobo.178.1">, </span><strong class="screenText"><span class="koboSpan" id="kobo.179.1">Location</span></strong><span class="koboSpan" id="kobo.180.1">, and </span><strong class="screenText"><span class="koboSpan" id="kobo.181.1">Solution name</span></strong><span class="koboSpan" id="kobo.182.1">:</span></li>
</ol>
<figure class="mediaobject"><span class="koboSpan" id="kobo.183.1"><img alt="" role="presentation" src="../Images/B19820_02_07.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.184.1">Figure 2.7: Creating an ASP.NET Core web application</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="3"><span class="koboSpan" id="kobo.185.1">After that, you</span><a id="_idIndexMarker129"/><span class="koboSpan" id="kobo.186.1"> will be able to select the .NET version</span><a id="_idIndexMarker130"/><span class="koboSpan" id="kobo.187.1"> to use. </span><span class="koboSpan" id="kobo.187.2">Select </span><strong class="screenText"><span class="koboSpan" id="kobo.188.1">.NET 8.0</span></strong><span class="koboSpan" id="kobo.189.1"> to get the most advanced and up-to-date platform.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.190.1">Click </span><strong class="screenText"><span class="koboSpan" id="kobo.191.1">Create</span></strong><span class="koboSpan" id="kobo.192.1"> to create your ASP.NET Core 8 web app.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.193.1">Now that you are done with adding the basic details, you can connect your web app project to your Azure account and publish it.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.194.1">If you right-click the project you created in Solution Explorer, you have the option to </span><strong class="screenText"><span class="koboSpan" id="kobo.195.1">Publish</span></strong><span class="koboSpan" id="kobo.196.1">.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.197.1">You will find different targets in terms of where to publish your web app. </span><span class="koboSpan" id="kobo.197.2">Select </span><strong class="screenText"><span class="koboSpan" id="kobo.198.1">Azure</span></strong><span class="koboSpan" id="kobo.199.1"> as the target:</span></li>
</ol>
<figure class="mediaobject"><span class="koboSpan" id="kobo.200.1"><img alt="" role="presentation" src="../Images/B19820_02_08.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.201.1">Figure 2.8: Targeting Azure to publish the app</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="8"><span class="koboSpan" id="kobo.202.1">Then, you will be able</span><a id="_idIndexMarker131"/><span class="koboSpan" id="kobo.203.1"> to decide the specific target</span><a id="_idIndexMarker132"/><span class="koboSpan" id="kobo.204.1"> to publish. </span><span class="koboSpan" id="kobo.204.2">Select </span><strong class="screenText"><span class="koboSpan" id="kobo.205.1">Azure App Service (Windows)</span></strong><span class="koboSpan" id="kobo.206.1"> for this demo.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.207.1">You may be required to define your Microsoft Account credentials at this time. </span><span class="koboSpan" id="kobo.207.2">This is because there is full integration between Visual Studio and Azure. </span><span class="koboSpan" id="kobo.207.3">This gives you the opportunity to view all the resources you created in the Azure portal in your development environment.</span></li>
</ol>
<figure class="mediaobject"><span class="koboSpan" id="kobo.208.1"><img alt="" role="presentation" src="../Images/B19820_02_09.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.209.1">Figure 2.9: Integration between Visual Studio and Azure</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="10"><span class="koboSpan" id="kobo.210.1">If you want to create</span><a id="_idIndexMarker133"/><span class="koboSpan" id="kobo.211.1"> a new web app using Visual </span><a id="_idIndexMarker134"/><span class="koboSpan" id="kobo.212.1">Studio, make sure to select the </span><strong class="screenText"><span class="koboSpan" id="kobo.213.1">Free Size</span></strong><span class="koboSpan" id="kobo.214.1"> tier of pricing during the App Service creation process so that this does not incur any costs:</span></li>
</ol>
<figure class="mediaobject"><span class="koboSpan" id="kobo.215.1"><img alt="" role="presentation" src="../Images/B19820_02_10.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.216.1">Figure 2.10: Creating a New Hosting Plan</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="11"><span class="koboSpan" id="kobo.217.1">The usual way to deploy</span><a id="_idIndexMarker135"/><span class="koboSpan" id="kobo.218.1"> using Visual Studio</span><a id="_idIndexMarker136"/><span class="koboSpan" id="kobo.219.1"> is by selecting </span><strong class="screenText"><span class="koboSpan" id="kobo.220.1">Publish Profile</span></strong><span class="koboSpan" id="kobo.221.1">, which generates a </span><code class="inlineCode"><span class="koboSpan" id="kobo.222.1">.pubxml</span></code><span class="koboSpan" id="kobo.223.1"> file, which is a Visual Studio publish profile. </span><span class="koboSpan" id="kobo.223.2">In this case, you currently have two modes for deployment.
    </span><p class="normal"><span class="koboSpan" id="kobo.224.1">The first, </span><strong class="screenText"><span class="koboSpan" id="kobo.225.1">Framework-dependent</span></strong><span class="koboSpan" id="kobo.226.1">, will require a web app configured with the target framework. </span><span class="koboSpan" id="kobo.226.2">The second, </span><strong class="screenText"><span class="koboSpan" id="kobo.227.1">Self-contained</span></strong><span class="koboSpan" id="kobo.228.1">, will not need this feature since the binaries of the framework will be published together with the application. </span><span class="koboSpan" id="kobo.228.2">Once the file</span><a id="_idIndexMarker137"/><span class="koboSpan" id="kobo.229.1"> is created and the options are selected, you just click</span><a id="_idIndexMarker138"/><span class="koboSpan" id="kobo.230.1"> on the </span><strong class="screenText"><span class="koboSpan" id="kobo.231.1">Publish</span></strong><span class="koboSpan" id="kobo.232.1"> button, and the process will start:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.233.1"><img alt="" role="presentation" src="../Images/B19820_02_11.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.234.1">Figure 2.11: Publish profile web deploy</span></p> </li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="12"><span class="koboSpan" id="kobo.235.1">It is worth mentioning that to publish ASP.NET Preview versions in </span><strong class="screenText"><span class="koboSpan" id="kobo.236.1">Framework-dependent</span></strong><span class="koboSpan" id="kobo.237.1"> mode, you must add an extension in the web app setup panel in the Azure portal, as shown in the following screenshot. </span><span class="koboSpan" id="kobo.237.2">However, consider using </span><strong class="screenText"><span class="koboSpan" id="kobo.238.1">Self-contained</span></strong><span class="koboSpan" id="kobo.239.1"> mode, especially when you are under preview versions and using Windows apps:</span></li>
</ol>
<figure class="mediaobject"><span class="koboSpan" id="kobo.240.1"><img alt="" role="presentation" src="../Images/B19820_02_12.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.241.1">Figure 2.12: Adding extensions in Azure App Service</span></p>
<div class="note">
<p class="normal"><span class="koboSpan" id="kobo.242.1">For more information</span><a id="_idIndexMarker139"/><span class="koboSpan" id="kobo.243.1"> on deploying ASP.NET Core 8.0 to Azure App Service, please refer to the following link: </span><a href="https://learn.microsoft.com/en-us/aspnet/core/host-and-deploy/azure-apps/?view=aspnetcore-8.0&amp;tabs=visual-studio"><span class="url"><span class="koboSpan" id="kobo.244.1">https://learn.microsoft.com/en-us/aspnet/core/host-and-deploy/azure-apps/?view=aspnetcore-8.0&amp;tabs=visual-studio</span></span></a><span class="koboSpan" id="kobo.245.1">.</span></p>
</div>
<p class="normal"><span class="koboSpan" id="kobo.246.1">Although publishing</span><a id="_idIndexMarker140"/><span class="koboSpan" id="kobo.247.1"> using Visual Studio 2022 may be considered a good option</span><a id="_idIndexMarker141"/><span class="koboSpan" id="kobo.248.1"> for demonstration, in the real world, it is almost impossible to keep your publishing strategy using it. </span><span class="koboSpan" id="kobo.248.2">For this reason, you might consider using a CI/CD flow based on GitHub Actions, which automatically enables deployment on the code being pushed to a GitHub repo. </span><span class="koboSpan" id="kobo.248.3">It is worth mentioning that you must be connected to a GitHub repo to access this new function. </span><span class="koboSpan" id="kobo.248.4">Let us use this new feature for this demonstration. </span><span class="koboSpan" id="kobo.248.5">We will discuss it in more depth in </span><em class="chapterRef"><span class="koboSpan" id="kobo.249.1">Chapter 8</span></em><em class="italic"><span class="koboSpan" id="kobo.250.1">, Understanding DevOps Principles and CI/CD</span></em><span class="koboSpan" id="kobo.251.1">.</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.252.1"><img alt="" role="presentation" src="../Images/B19820_02_13.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.253.1">Figure 2.13: Deploying a web app using GitHub actions</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.254.1">Once you have pushed</span><a id="_idIndexMarker142"/><span class="koboSpan" id="kobo.255.1"> your code, you can go to the GitHub Actions</span><a id="_idIndexMarker143"/><span class="koboSpan" id="kobo.256.1"> pane and select the way you want to deploy the web app.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.257.1">For this second demo, you can select </span><strong class="screenText"><span class="koboSpan" id="kobo.258.1">Deploy a .NET Core app to an Azure Web App</span></strong><span class="koboSpan" id="kobo.259.1">. </span><span class="koboSpan" id="kobo.259.2">With this option, you will have a YAML file created with all the instructions needed to connect your code to the web app.
    </span><figure class="mediaobject"><span class="koboSpan" id="kobo.260.1"><img alt="" role="presentation" src="../Images/B19820_02_14.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.261.1">Figure 2.14: YAML file used to deploy the application</span></p>
<div class="note">
<p class="normal"><span class="koboSpan" id="kobo.262.1">Depending on the web app you want to deploy, you will need a different script. </span><span class="koboSpan" id="kobo.262.2">These scripts are documented at </span><a href="https://github.com/Azure/webapps-deploy"><span class="url"><span class="koboSpan" id="kobo.263.1">https://github.com/Azure/webapps-deploy</span></span></a><span class="koboSpan" id="kobo.264.1">.</span></p>
</div></li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="3"><span class="koboSpan" id="kobo.265.1">Once you have set the correct</span><a id="_idIndexMarker144"/><span class="koboSpan" id="kobo.266.1"> script, you will be able to check</span><a id="_idIndexMarker145"/><span class="koboSpan" id="kobo.267.1"> the execution of the GitHub Action:</span></li>
</ol>
<figure class="mediaobject"><span class="koboSpan" id="kobo.268.1"><img alt="" role="presentation" src="../Images/B19820_02_15.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.269.1">Figure 2.15: GitHub Actions tab</span></p>
<p class="normal"><span class="koboSpan" id="kobo.270.1">Here, we described two ways</span><a id="_idIndexMarker146"/><span class="koboSpan" id="kobo.271.1"> to deploy a web app. </span><span class="koboSpan" id="kobo.271.2">In </span><em class="chapterRef"><span class="koboSpan" id="kobo.272.1">Chapter 8</span></em><em class="italic"><span class="koboSpan" id="kobo.273.1">, Understanding DevOps Principles and CI/CD</span></em><span class="koboSpan" id="kobo.274.1">, we will go further into </span><strong class="keyWord"><span class="koboSpan" id="kobo.275.1">Continuous Integration/Continuous Delivery</span></strong><span class="koboSpan" id="kobo.276.1"> (</span><strong class="keyWord"><span class="koboSpan" id="kobo.277.1">CI/CD</span></strong><span class="koboSpan" id="kobo.278.1">) strategies to guarantee all the steps</span><a id="_idIndexMarker147"/><span class="koboSpan" id="kobo.279.1"> required to get an application to production, that is, building, testing, deployment to staging, and deployment to production.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.280.1">Now that you have learned a great</span><a id="_idIndexMarker148"/><span class="koboSpan" id="kobo.281.1"> way to make your web apps run</span><a id="_idIndexMarker149"/><span class="koboSpan" id="kobo.282.1"> on Azure, using Visual Studio as a helpful tool, it is essential to understand some performance issues that may cause struggles while creating a solution.</span></p>
<h1 class="heading-1" id="_idParaDest-51"><span class="koboSpan" id="kobo.283.1">Performance issues that need to be considered when programming in C#</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.284.1">Nowadays, C# is one of the most</span><a id="_idIndexMarker150"/><span class="koboSpan" id="kobo.285.1"> used programming languages in the world, so awareness of C# programming best practices is fundamental for the design of good architectures that satisfy the most common non-functional requirements.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.286.1">The following sections mention a few simple but effective tips – the associated code samples are available in this book’s GitHub repository. </span><span class="koboSpan" id="kobo.286.2">It is worth mentioning that .NET Foundation</span><a id="_idIndexMarker151"/><span class="koboSpan" id="kobo.287.1"> has developed a library dedicated to benchmarking called BenchmarkDotNet. </span><span class="koboSpan" id="kobo.287.2">You may find it useful </span><a id="_idIndexMarker152"/><span class="koboSpan" id="kobo.288.1">for your scenarios. </span><span class="koboSpan" id="kobo.288.2">Check it out at </span><a href="https://benchmarkdotnet.org/"><span class="url"><span class="koboSpan" id="kobo.289.1">https://benchmarkdotnet.org/</span></span></a><span class="koboSpan" id="kobo.290.1">.</span></p>
<h2 class="heading-2" id="_idParaDest-52"><span class="koboSpan" id="kobo.291.1">String concatenation</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.292.1">This is a classic one! </span><span class="koboSpan" id="kobo.292.2">A naive concatenation</span><a id="_idIndexMarker153"/><span class="koboSpan" id="kobo.293.1"> of strings with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.294.1">+</span></code><span class="koboSpan" id="kobo.295.1"> string operator</span><a id="_idIndexMarker154"/><span class="koboSpan" id="kobo.296.1"> may cause serious performance issues since every time two strings are concatenated; their contents are copied into a new string.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.297.1">So, if we concatenate, for instance, 10 strings that have an average length of 100, the first operation has a cost of 200, the second one has a cost of </span><code class="inlineCode"><span class="koboSpan" id="kobo.298.1">200+100=300</span></code><span class="koboSpan" id="kobo.299.1">, the third one has a cost of </span><code class="inlineCode"><span class="koboSpan" id="kobo.300.1">300+100=400</span></code><span class="koboSpan" id="kobo.301.1">, and so on. </span><span class="koboSpan" id="kobo.301.2">It is not difficult to convince yourself that the overall cost grows as </span><code class="inlineCode"><span class="koboSpan" id="kobo.302.1">m*n</span></code><sup class="superscript"><span class="koboSpan" id="kobo.303.1">2</span></sup><span class="koboSpan" id="kobo.304.1">, where </span><code class="inlineCode"><span class="koboSpan" id="kobo.305.1">n</span></code><span class="koboSpan" id="kobo.306.1"> is the number of strings and </span><code class="inlineCode"><span class="koboSpan" id="kobo.307.1">m</span></code><span class="koboSpan" id="kobo.308.1"> is their average length. </span><code class="inlineCode"><span class="koboSpan" id="kobo.309.1">n</span></code><sup class="superscript"><span class="koboSpan" id="kobo.310.1">2</span></sup><span class="koboSpan" id="kobo.311.1"> is not too big for small </span><code class="inlineCode"><span class="koboSpan" id="kobo.312.1">n</span></code><span class="koboSpan" id="kobo.313.1"> (say, </span><code class="inlineCode"><span class="koboSpan" id="kobo.314.1">n &lt; 10</span></code><span class="koboSpan" id="kobo.315.1">), but it becomes quite big when </span><code class="inlineCode"><span class="koboSpan" id="kobo.316.1">n</span></code><span class="koboSpan" id="kobo.317.1"> reaches the magnitude of 100-1,000 and is unacceptable for magnitudes of 10,000-100,000.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.318.1">Let us look at this with some test code that compares naive concatenation with the same operation but performed with the help of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.319.1">StringBuilder</span></code><span class="koboSpan" id="kobo.320.1"> class (the code is available in this book’s GitHub repository):</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.321.1"><img alt="Text  Description automatically generated" src="../Images/B19820_02_16.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.322.1">Figure 2.16: Concatenation test code result</span></p>
<p class="normal"><span class="koboSpan" id="kobo.323.1">If you create a </span><code class="inlineCode"><span class="koboSpan" id="kobo.324.1">StringBuilder</span></code><span class="koboSpan" id="kobo.325.1"> class with something like </span><code class="inlineCode"><span class="koboSpan" id="kobo.326.1">var sb = new System.Text.StringBuilder()</span></code><span class="koboSpan" id="kobo.327.1">, and then you add each string to it with </span><code class="inlineCode"><span class="koboSpan" id="kobo.328.1">sb.Append(currString)</span></code><span class="koboSpan" id="kobo.329.1">, the strings are not copied; instead, their pointers are queued in a list. </span><span class="koboSpan" id="kobo.329.2">They are copied in the final string just once when you call </span><code class="inlineCode"><span class="koboSpan" id="kobo.330.1">sb.ToString()</span></code><span class="koboSpan" id="kobo.331.1"> to get the final result. </span><span class="koboSpan" id="kobo.331.2">Accordingly, the cost of </span><code class="inlineCode"><span class="koboSpan" id="kobo.332.1">StringBuilder</span></code><span class="koboSpan" id="kobo.333.1">-based concatenation grows simply as </span><code class="inlineCode"><span class="koboSpan" id="kobo.334.1">m*n</span></code><span class="koboSpan" id="kobo.335.1">.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.336.1">Of course, you will probably never find a piece of software with a function like the preceding one that concatenates 100,000 strings. </span><span class="koboSpan" id="kobo.336.2">However, you need to recognize pieces of code like these where the concatenation of some 20-100 strings, say, in a web server that handles several requests</span><a id="_idIndexMarker155"/><span class="koboSpan" id="kobo.337.1"> simultaneously might cause bottlenecks</span><a id="_idIndexMarker156"/><span class="koboSpan" id="kobo.338.1"> that damage your non-functional requirements for performance.</span></p>
<h2 class="heading-2" id="_idParaDest-53"><span class="koboSpan" id="kobo.339.1">Exceptions</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.340.1">Always remember</span><a id="_idIndexMarker157"/><span class="koboSpan" id="kobo.341.1"> that exceptions</span><a id="_idIndexMarker158"/><span class="koboSpan" id="kobo.342.1"> are much slower than normal code flow! </span><span class="koboSpan" id="kobo.342.2">So, the usage of </span><code class="inlineCode"><span class="koboSpan" id="kobo.343.1">try-catch</span></code><span class="koboSpan" id="kobo.344.1"> needs to be concise and essential; otherwise, you will have big performance issues.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.345.1">The following two samples compare the usage of </span><code class="inlineCode"><span class="koboSpan" id="kobo.346.1">try-catch</span></code><span class="koboSpan" id="kobo.347.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.348.1">Int32.TryParse</span></code><span class="koboSpan" id="kobo.349.1"> to check whether a string can be converted into an integer, as follows:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.350.1">private</span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.351.1">static</span></span><span class="hljs-function"> </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.352.1">string</span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="koboSpan" id="kobo.353.1">ParseIntWithTryParse</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.354.1">()</span></span><span class="koboSpan" id="kobo.355.1">
{
    </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.356.1">string</span></span><span class="koboSpan" id="kobo.357.1"> result = </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.358.1">string</span></span><span class="koboSpan" id="kobo.359.1">.Empty;
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.360.1">if</span></span><span class="koboSpan" id="kobo.361.1"> (</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.362.1">int</span></span><span class="koboSpan" id="kobo.363.1">.TryParse(result, </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.364.1">out</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.365.1">var</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.366.1">value</span></span><span class="koboSpan" id="kobo.367.1">))
        result = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.368.1">value</span></span><span class="koboSpan" id="kobo.369.1">.ToString();
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.370.1">else</span></span><span class="koboSpan" id="kobo.371.1">
        result = </span><span class="hljs-string"><span class="koboSpan" id="kobo.372.1">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.373.1">There is no int value"</span></span><span class="koboSpan" id="kobo.374.1">;
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.375.1">return</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.376.1">$"Final result: </span></span><span class="hljs-subst"><span class="koboSpan" id="kobo.377.1">{result}</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.378.1">"</span></span><span class="koboSpan" id="kobo.379.1">;
}
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.380.1">private</span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.381.1">static</span></span><span class="hljs-function"> </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.382.1">string</span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="koboSpan" id="kobo.383.1">ParseIntWithException</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.384.1">()</span></span><span class="koboSpan" id="kobo.385.1">
{
    </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.386.1">string</span></span><span class="koboSpan" id="kobo.387.1"> result = </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.388.1">string</span></span><span class="koboSpan" id="kobo.389.1">.Empty;
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.390.1">try</span></span><span class="koboSpan" id="kobo.391.1">
    {
        result = Convert.ToInt32(result).ToString();
    }
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.392.1">catch</span></span><span class="koboSpan" id="kobo.393.1"> (Exception)
    {
        result = </span><span class="hljs-string"><span class="koboSpan" id="kobo.394.1">"There is no int value"</span></span><span class="koboSpan" id="kobo.395.1">;
    }
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.396.1">return</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.397.1">$"Final result: </span></span><span class="hljs-subst"><span class="koboSpan" id="kobo.398.1">{result}</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.399.1">"</span></span><span class="koboSpan" id="kobo.400.1">;
}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.401.1">The second function does not look dangerous, but it is thousands of times slower than the first one:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.402.1"><img alt="Text  Description automatically generated" src="../Images/B19820_02_17.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.403.1">Figure 2.17: Exception test code result</span></p>
<p class="normal"><span class="koboSpan" id="kobo.404.1">To sum this up, exceptions must be used to deal with exceptional cases that break the normal flow of control, for instance, situations</span><a id="_idIndexMarker159"/><span class="koboSpan" id="kobo.405.1"> when operations must be aborted for some unexpected reasons, and control</span><a id="_idIndexMarker160"/><span class="koboSpan" id="kobo.406.1"> must be returned several levels up in the call stack.</span></p>
<h2 class="heading-2" id="_idParaDest-54"><span class="koboSpan" id="kobo.407.1">Multithreading environments for better results – dos and don’ts</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.408.1">If you want to take advantage</span><a id="_idIndexMarker161"/><span class="koboSpan" id="kobo.409.1"> of all the hardware</span><a id="_idIndexMarker162"/><span class="koboSpan" id="kobo.410.1"> that the system you are building provides, you must use multithreading. </span><span class="koboSpan" id="kobo.410.2">This way, when a thread is waiting for an operation to complete, the application can leave the CPU to other threads instead of wasting CPU time.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.411.1">On the other hand, no matter how hard Microsoft works to help with this, parallel code is not as simple as eating a piece of cake: it is error-prone and difficult to test and debug. </span><span class="koboSpan" id="kobo.411.2">The most important thing to remember as a software architect when you start considering using threads is </span><em class="italic"><span class="koboSpan" id="kobo.412.1">does your system require them?</span></em><span class="koboSpan" id="kobo.413.1"> Non-functional and some functional requirements will answer this question for you.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.414.1">As soon as you are sure that you need a multithreading</span><a id="_idIndexMarker163"/><span class="koboSpan" id="kobo.415.1"> system, you should decide on which technology is more adequate. </span><span class="koboSpan" id="kobo.415.2">There are a few options</span><a id="_idIndexMarker164"/><span class="koboSpan" id="kobo.416.1"> here, as follows:</span></p>
<ul>
<li class="bulletList"><strong class="keyWord"><span class="koboSpan" id="kobo.417.1">Creating an instance of</span></strong> <code class="inlineCode"><span class="koboSpan" id="kobo.418.1">System.Threading.Thread</span></code><span class="koboSpan" id="kobo.419.1">: This is a classic way of creating threads in C#. </span><span class="koboSpan" id="kobo.419.2">The entire thread life cycle will be in your hands. </span><span class="koboSpan" id="kobo.419.3">This is good when you are sure about what you are going to do, but you need to worry about every single detail of the implementation. </span><span class="koboSpan" id="kobo.419.4">The resulting code is hard to conceive and debug/test/maintain. </span><span class="koboSpan" id="kobo.419.5">So, to keep development costs acceptable, this approach should be confined to a few fundamental, performance-critical modules.</span></li>
<li class="bulletList"><strong class="keyWord"><span class="koboSpan" id="kobo.420.1">Managing threads using </span></strong><code class="inlineCode"><span class="koboSpan" id="kobo.421.1">System.Threading.ThreadPool</span></code><span class="koboSpan" id="kobo.422.1">: You can reduce the complexity of this implementation by using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.423.1">ThreadPool</span></code><span class="koboSpan" id="kobo.424.1"> class. </span><span class="koboSpan" id="kobo.424.2">Especially if you intend to develop a solution in which you will have many threads being executed, this could be a good option. </span><span class="koboSpan" id="kobo.424.3">It is worth mentioning that the .NET thread pool has been re-implemented in .NET 6 as a C# class, which will bring new possibilities for experimentation or customization.</span></li>
<li class="bulletList"><strong class="keyWord"><span class="koboSpan" id="kobo.425.1">Programming using</span></strong> <code class="inlineCode"><span class="koboSpan" id="kobo.426.1">System.Threading.Tasks.Parallel</span></code><span class="koboSpan" id="kobo.427.1"> classes: Since .NET Framework 4.0, you can use parallel classes to enable threads in a simpler way. </span><span class="koboSpan" id="kobo.427.2">This is good because you do not need to worry about the life cycle of the threads you create, but it will give you less control over what is happening in each thread.</span></li>
<li class="bulletList"><strong class="keyWord"><span class="koboSpan" id="kobo.428.1">Developing using asynchronous programming</span></strong><span class="koboSpan" id="kobo.429.1">: This is, for sure, the easiest way to develop multithreaded applications since the compiler takes on most of the work. </span><span class="koboSpan" id="kobo.429.2">Depending on the way you call an asynchronous method, you may have the </span><code class="inlineCode"><span class="koboSpan" id="kobo.430.1">Task</span></code><span class="koboSpan" id="kobo.431.1"> created running in parallel with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.432.1">Thread</span></code><span class="koboSpan" id="kobo.433.1"> that was used to call it or even keep that </span><code class="inlineCode"><span class="koboSpan" id="kobo.434.1">Thread</span></code><span class="koboSpan" id="kobo.435.1"> waiting without suspending for the </span><code class="inlineCode"><span class="koboSpan" id="kobo.436.1">Task</span></code><span class="koboSpan" id="kobo.437.1"> that was created to conclude. </span><span class="koboSpan" id="kobo.437.2">This way, asynchronous code mimics the behavior of classical synchronous code while keeping most of the performance advantages of general parallel programming:</span><ul>
<li class="bulletList"><span class="koboSpan" id="kobo.438.1">The overall behavior is deterministic and does not depend on the time taken by each task to complete, so non-reproducible bugs are less likely to happen, and the resulting code is easy to test/debug/maintain. </span><span class="koboSpan" id="kobo.438.2">Defining a method as an asynchronous task or not is the only choice left to the programmer; everything else is automatically handled by the runtime. </span><span class="koboSpan" id="kobo.438.3">The only thing you should be concerned about is which methods should have asynchronous behavior. </span><span class="koboSpan" id="kobo.438.4">It is worth mentioning that defining a method as </span><code class="inlineCode"><span class="koboSpan" id="kobo.439.1">async</span></code><span class="koboSpan" id="kobo.440.1"> does not mean it will execute on a separate thread. </span><span class="koboSpan" id="kobo.440.2">You may find useful information</span><a id="_idIndexMarker165"/><span class="koboSpan" id="kobo.441.1"> in a great sample at </span><a href="https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/concepts/async/"><span class="url"><span class="koboSpan" id="kobo.442.1">https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/concepts/async/</span></span></a><span class="koboSpan" id="kobo.443.1">.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.444.1">Later in this book, we will provide some simple examples of asynchronous programming. </span><span class="koboSpan" id="kobo.444.2">For more information about asynchronous programming</span><a id="_idIndexMarker166"/><span class="koboSpan" id="kobo.445.1"> and its related</span><a id="_idIndexMarker167"/><span class="koboSpan" id="kobo.446.1"> patterns, please check out </span><em class="italic"><span class="koboSpan" id="kobo.447.1">Task-Based Asynchronous Patterns</span></em><span class="koboSpan" id="kobo.448.1"> in the Microsoft documentation (</span><a href="https://docs.microsoft.com/en-us/dotnet/standard/asynchronous-programming-patterns/task-based-asynchronous-pattern-tap"><span class="url"><span class="koboSpan" id="kobo.449.1">https://docs.microsoft.com/en-us/dotnet/standard/asynchronous-programming-patterns/task-based-asynchronous-pattern-tap</span></span></a><span class="koboSpan" id="kobo.450.1">).
    </span><div class="packt_tip">
<p class="normal"><strong class="keyWord"><span class="koboSpan" id="kobo.451.1">TAP</span></strong><span class="koboSpan" id="kobo.452.1"> is the evolution</span><a id="_idIndexMarker168"/><span class="koboSpan" id="kobo.453.1"> of </span><strong class="keyWord"><span class="koboSpan" id="kobo.454.1">EAP</span></strong><span class="koboSpan" id="kobo.455.1"> (</span><strong class="keyWord"><span class="koboSpan" id="kobo.456.1">Event-Based Asynchronous Pattern</span></strong><span class="koboSpan" id="kobo.457.1">), which, in turn, is</span><a id="_idIndexMarker169"/><span class="koboSpan" id="kobo.458.1"> the successor to </span><strong class="keyWord"><span class="koboSpan" id="kobo.459.1">APM</span></strong><span class="koboSpan" id="kobo.460.1"> (</span><strong class="keyWord"><span class="koboSpan" id="kobo.461.1">Asynchronous Programming Model Pattern</span></strong><span class="koboSpan" id="kobo.462.1">).</span></p>
</div></li>
</ul>
</li>
</ul>
<p class="normal"><span class="koboSpan" id="kobo.463.1">No matter the option</span><a id="_idIndexMarker170"/><span class="koboSpan" id="kobo.464.1"> you choose, there are some dos and don’ts that, as a software </span><a id="_idIndexMarker171"/><span class="koboSpan" id="kobo.465.1">architect, you must pay attention to. </span><span class="koboSpan" id="kobo.465.2">These are as follows:</span></p>
<ul>
<li class="bulletList"><strong class="keyWord"><span class="koboSpan" id="kobo.466.1">Do use concurrent collections</span></strong><span class="koboSpan" id="kobo.467.1"> (</span><code class="inlineCode"><span class="koboSpan" id="kobo.468.1">System.Collections.Concurrent</span></code><span class="koboSpan" id="kobo.469.1">): As soon as you start a multithreading application, you have to use these collections. </span><span class="koboSpan" id="kobo.469.2">The reason for this is that your program will probably manage the same list, dictionary, and so on from different threads. </span><span class="koboSpan" id="kobo.469.3">The use of concurrent collections is the most convenient option for developing thread-safe programs.</span></li>
<li class="bulletList"><strong class="keyWord"><span class="koboSpan" id="kobo.470.1">Do worry about static variables</span></strong><span class="koboSpan" id="kobo.471.1">: It is not possible to say that static variables are prohibited in multithreading development, but you should pay attention to them. </span><span class="koboSpan" id="kobo.471.2">Again, multiple threads taking care of the same variable can cause a lot of trouble. </span><span class="koboSpan" id="kobo.471.3">If you decorate a static variable with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.472.1">[ThreadStatic]</span></code><span class="koboSpan" id="kobo.473.1"> attribute, each thread will see a different copy of that variable, hence solving the problem of several threads competing on the same value. </span><span class="koboSpan" id="kobo.473.2">However, </span><code class="inlineCode"><span class="koboSpan" id="kobo.474.1">ThreadStatic </span></code><span class="koboSpan" id="kobo.475.1">variables cannot be used for extra-thread communications since values written by a thread cannot be read by other threads. </span><span class="koboSpan" id="kobo.475.2">In asynchronous programming, </span><code class="inlineCode"><span class="koboSpan" id="kobo.476.1">AsyncLocal&lt;T&gt;</span></code><span class="koboSpan" id="kobo.477.1"> is the option for doing something like that.</span></li>
<li class="bulletList"><strong class="keyWord"><span class="koboSpan" id="kobo.478.1">Do test system performance after multithreading implementations</span></strong><span class="koboSpan" id="kobo.479.1">: Threads give you the ability to take full advantage of your hardware, but in some cases, badly written threads can waste CPU time just doing nothing! </span><span class="koboSpan" id="kobo.479.2">Similar situations may result in almost 100% CPU usage and unacceptable system slowdowns. </span><span class="koboSpan" id="kobo.479.3">In some cases, the problem can be mitigated or solved by adding a simple </span><code class="inlineCode"><span class="koboSpan" id="kobo.480.1">Thread.Sleep(1)</span></code><span class="koboSpan" id="kobo.481.1"> call in the main loop of some threads to prevent them from wasting too much CPU time, but you need to test this. </span><span class="koboSpan" id="kobo.481.2">A use case for this implementation is a Windows service with many threads running in the background.</span></li>
<li class="bulletList"><strong class="keyWord"><span class="koboSpan" id="kobo.482.1">Do not consider multithreading easy</span></strong><span class="koboSpan" id="kobo.483.1">: Multithreading is not as simple as it seems in some syntax</span><a id="_idIndexMarker172"/><span class="koboSpan" id="kobo.484.1"> implementations. </span><span class="koboSpan" id="kobo.484.2">While</span><a id="_idIndexMarker173"/><span class="koboSpan" id="kobo.485.1"> writing a multithreading application, you should consider things such as the synchronization of the user interface, threading termination, and coordination. </span><span class="koboSpan" id="kobo.485.2">In many cases, programs just stop working well due to bad implementation of multithreading.</span></li>
<li class="bulletList"><strong class="keyWord"><span class="koboSpan" id="kobo.486.1">Do not forget to plan the number of threads your system should have</span></strong><span class="koboSpan" id="kobo.487.1">: This is especially important for 32-bit programs. </span><span class="koboSpan" id="kobo.487.2">There is a limitation regarding how many threads you can have in any environment. </span><span class="koboSpan" id="kobo.487.3">You should consider this when you are designing your system.</span></li>
<li class="bulletList"><strong class="keyWord"><span class="koboSpan" id="kobo.488.1">Do not forget to end your threads</span></strong><span class="koboSpan" id="kobo.489.1">: If you do not have the correct termination procedure for each thread, you will probably have trouble with memory and handling</span><a id="_idIndexMarker174"/><span class="koboSpan" id="kobo.490.1"> leaks.</span></li>
</ul>
<p class="normal"><span class="koboSpan" id="kobo.491.1">Scalability, performance tips, and multithreading</span><a id="_idIndexMarker175"/><span class="koboSpan" id="kobo.492.1"> are the main tools we can use to tune machine performance. </span><span class="koboSpan" id="kobo.492.2">However, the effectiveness of the system you design depends on the overall performance of the entire processing pipeline, which includes both humans and machines. </span><span class="koboSpan" id="kobo.492.3">For this reason, in the next section, we will discuss how to design effective user interfaces.</span></p>
<h1 class="heading-1" id="_idParaDest-55"><span class="koboSpan" id="kobo.493.1">Software usability: how to design effective user interfaces</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.494.1">As a software architect, you cannot improve</span><a id="_idIndexMarker176"/><span class="koboSpan" id="kobo.495.1"> the performance of humans, but you can improve the performance of human-machine interaction by designing an effective </span><strong class="keyWord"><span class="koboSpan" id="kobo.496.1">user interface</span></strong><span class="koboSpan" id="kobo.497.1"> (</span><strong class="keyWord"><span class="koboSpan" id="kobo.498.1">UI</span></strong><span class="koboSpan" id="kobo.499.1">), that is, a UI that ensures fast interaction with humans, which, in turn, means the following:</span></p>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.500.1">The UI must be easy to learn to reduce the time that is needed for the target users to learn how to operate it. </span><span class="koboSpan" id="kobo.500.2">This constraint is fundamental if UI changes are frequent and for public websites that need to attract the greatest possible number of users.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.501.1">The UI must not cause any kind of slowdown in data insertion; data entry speed must be limited only by the user’s ability to type, not by system delays or additional gestures that could be avoided.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.502.1">Today, we must also consider the accessibility aspects of our solutions since doing so allows us to include more users.</span></li>
</ul>
<p class="normal"><span class="koboSpan" id="kobo.503.1">It is worth mentioning that we have UX experts in the market. </span><span class="koboSpan" id="kobo.503.2">As a software architect, you must decide when they are essential to the success of the project. </span><span class="koboSpan" id="kobo.503.3">The following are a few simple tips when it comes to designing </span><em class="italic"><span class="koboSpan" id="kobo.504.1">easy-to-learn</span></em><span class="koboSpan" id="kobo.505.1"> user interfaces:</span></p>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.506.1">Each input screen must state its purpose clearly.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.507.1">Use the language of the user, not the language of developers.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.508.1">Avoid complications. </span><span class="koboSpan" id="kobo.508.2">Design the UI with the average case in mind; more complicated cases can be handled with extra inputs that appear only when needed. </span><span class="koboSpan" id="kobo.508.3">Split complex screens into more input steps.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.509.1">Use past inputs to understand user intentions and to put users on the right path with messages and automatic UI changes, for instance, cascading drop-down menus.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.510.1">Error messages are not bad notes that the system gives to the users who do something that’s wrong, but they must explain how to insert the correct input.</span></li>
</ul>
<p class="normal"><span class="koboSpan" id="kobo.511.1">Fast UIs result from efficacious solutions to the following three requirements:</span></p>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.512.1">Input fields must be placed in the order they are usually filled, and it should be possible to move to the next input with the </span><em class="keystroke"><span class="koboSpan" id="kobo.513.1">Tab</span></em><span class="koboSpan" id="kobo.514.1"> or </span><em class="keystroke"><span class="koboSpan" id="kobo.515.1">Enter </span></em><span class="koboSpan" id="kobo.516.1">key. </span><span class="koboSpan" id="kobo.516.2">Moreover, fields that often remain empty should be placed at the bottom of the form. </span><span class="koboSpan" id="kobo.516.3">Simply put, the usage of the mouse while filling in a form should be minimized. </span><span class="koboSpan" id="kobo.516.4">This way, the number of user gestures is kept to a minimum. </span><span class="koboSpan" id="kobo.516.5">In a web application, once the optimal placement of input fields has been decided, it is enough to use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.517.1">tabindex</span></code><span class="koboSpan" id="kobo.518.1"> attribute to define the right way for users to move from one input field to the next with the </span><em class="keystroke"><span class="koboSpan" id="kobo.519.1">Tab</span></em><span class="koboSpan" id="kobo.520.1"> key.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.521.1">System reactions to user input must be as fast as possible. </span><span class="koboSpan" id="kobo.521.2">Error messages (or information ones) must appear as soon as the user leaves the input field. </span><span class="koboSpan" id="kobo.521.3">The simplest way to achieve this is to move most of the help and input validation logic to the client side so that system reactions do not need to pass through both communication lines and servers.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.522.1">Efficacious selection logic: Selecting an existing item should be as easy as possible; for example, selecting one out of some thousands of products in an offer must be possible with a few gestures and with no need to remember the exact product name or its barcode. </span><span class="koboSpan" id="kobo.522.2">The next subsection analyzes techniques we can use to decrease complexity to achieve fast selection.</span></li>
</ul>
<p class="normal"><span class="koboSpan" id="kobo.523.1">In </span><em class="chapterRef"><span class="koboSpan" id="kobo.524.1">Chapter 19</span></em><em class="italic"><span class="koboSpan" id="kobo.525.1">, Client Frameworks: Blazor</span></em><span class="koboSpan" id="kobo.526.1">, we will discuss how</span><a id="_idIndexMarker177"/><span class="koboSpan" id="kobo.527.1"> this Microsoft technology can help us with the challenges of building web-based applications with C# code in the frontend.</span></p>
<h2 class="heading-2" id="_idParaDest-56"><span class="koboSpan" id="kobo.528.1">Designing fast selection logic</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.529.1">When all possible choices</span><a id="_idIndexMarker178"/><span class="koboSpan" id="kobo.530.1"> are in the order of magnitude of 1-50, the usual drop-down menu is enough. </span><span class="koboSpan" id="kobo.530.2">For instance, take this currency selection drop-down menu:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.531.1"><img alt="A picture containing calendar  Description automatically generated" src="../Images/B19820_02_18.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.532.1">Figure 2.18: Simple drop-down menu</span></p>
<p class="normal"><span class="koboSpan" id="kobo.533.1">When the order of magnitude is higher but less than a few thousand, an autocomplete that shows the names of all the items that start with the characters typed by the user is usually a good choice:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.534.1"><img alt="Graphical user interface, text, application, chat or text message  Description automatically generated" src="../Images/B19820_02_19.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.535.1">Figure 2.19: Complex drop-down menu</span></p>
<p class="normal"><span class="koboSpan" id="kobo.536.1">A similar solution can be implemented with a low computational cost since all the main databases can efficiently select strings that start with a given substring.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.537.1">When names are quite complex, when searching</span><a id="_idIndexMarker179"/><span class="koboSpan" id="kobo.538.1"> for the characters that were typed in by the user, they should be extended inside each item string. </span><span class="koboSpan" id="kobo.538.2">This operation cannot be performed efficiently with the usual databases and requires ad hoc data structures, nor can we forget the debouncing aspect that can happen while typing as a performance issue.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.539.1">Finally, when we are searching inside descriptions composed of several words, more complex search patterns are needed. </span><span class="koboSpan" id="kobo.539.2">This is the case, for instance, with product descriptions. </span><span class="koboSpan" id="kobo.539.3">If the chosen database supports full-text search, the system can efficiently search for the occurrence of several words that have been typed by the user inside all the descriptions.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.540.1">However, when descriptions are made up of names instead of common words, it might be difficult for the user to remember a few exact names contained in the target description. </span><span class="koboSpan" id="kobo.540.2">This happens, for instance, with multi-country company names. </span><span class="koboSpan" id="kobo.540.3">In these cases, we need algorithms that find the best match for the character that was typed by the user. </span><span class="koboSpan" id="kobo.540.4">Substrings of the string that was typed by the user must be searched in different places of each description. </span><span class="koboSpan" id="kobo.540.5">In general, similar algorithms cannot be implemented efficiently with databases based on indexes but require all the descriptions to be loaded in memory and ranked somehow against the string that was typed by the user.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.541.1">The most famous algorithm</span><a id="_idIndexMarker180"/><span class="koboSpan" id="kobo.542.1"> in this class is probably the </span><strong class="keyWord"><span class="koboSpan" id="kobo.543.1">Levenshtein</span></strong><span class="koboSpan" id="kobo.544.1"> algorithm, which is used by most spellcheckers to find a word that best fits the one that was mistyped by the user. </span><span class="koboSpan" id="kobo.544.2">This algorithm minimizes the Levenshtein distance between the description and the string typed by the user, that is, the minimum number of character removals and additions needed to transform one string into another.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.545.1">The Levenshtein algorithm</span><a id="_idIndexMarker181"/><span class="koboSpan" id="kobo.546.1"> works great but has a very high computational cost. </span><span class="koboSpan" id="kobo.546.2">Here, we use a faster algorithm that works well for searching character occurrences in descriptions. </span><span class="koboSpan" id="kobo.546.3">Characters typed by the user do not need to occur consecutively in the description but must occur in the same order. </span><span class="koboSpan" id="kobo.546.4">Some characters may be missing. </span><span class="koboSpan" id="kobo.546.5">Each description is given a penalty that depends on the missing characters and on how far the occurrences of the characters typed by the user are from the others.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.547.1">More specifically, the algorithm ranks each description with two numbers:</span></p>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.548.1">The number of characters typed by the user that occurs in the description: the more characters contained in the description, the higher its rank.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.549.1">Each description is given a penalty equal to the total distance among the occurrences of the characters typed by the user in the description.</span></li>
</ul>
<p class="normal"><span class="koboSpan" id="kobo.550.1">The following screenshot shows how the word </span><strong class="screenText"><span class="koboSpan" id="kobo.551.1">Ireland</span></strong><span class="koboSpan" id="kobo.552.1"> is ranked against the string </span><strong class="screenText"><span class="koboSpan" id="kobo.553.1">ilad</span></strong><span class="koboSpan" id="kobo.554.1">, which was typed by the user:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.555.1"><img alt="A picture containing diagram  Description automatically generated" src="../Images/B19820_02_20.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.556.1">Figure 2.20: Sample of Levenshtein usage</span></p>
<p class="normal"><span class="koboSpan" id="kobo.557.1">The number of occurrences is four, while the total distance between character occurrences is three.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.558.1">Once all the descriptions have been</span><a id="_idIndexMarker182"/><span class="koboSpan" id="kobo.559.1"> rated, they are sorted according to the number of occurrences. </span><span class="koboSpan" id="kobo.559.2">Descriptions with the same number of occurrences are sorted according to the lowest penalties. </span><span class="koboSpan" id="kobo.559.3">The following is an autocomplete that implements the preceding algorithm:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.560.1"><img alt="Diagram  Description automatically generated with medium confidence" src="../Images/B19820_02_21.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.561.1">Figure 2.21: Levenshtein algorithm UI experience</span></p>
<p class="normal"><span class="koboSpan" id="kobo.562.1">The full class code, along with a test console</span><a id="_idIndexMarker183"/><span class="koboSpan" id="kobo.563.1"> project, is available in this book’s GitHub repository.</span></p>
<h2 class="heading-2" id="_idParaDest-57"><span class="koboSpan" id="kobo.564.1">Selecting from a huge number of items</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.565.1">Here, </span><em class="italic"><span class="koboSpan" id="kobo.566.1">huge</span></em><span class="koboSpan" id="kobo.567.1"> does not refer to the amount of space needed to store the data but to the difficulty the user has in remembering the features of each item. </span><span class="koboSpan" id="kobo.567.2">When an item must be selected from among more than 10,000-100,000 items, there is no hope of finding it by searching for character occurrences inside a description. </span><span class="koboSpan" id="kobo.567.3">Here, the user must be driven toward the right item through a hierarchy of categories.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.568.1">In this case, several user gestures are needed to perform a single selection. </span><span class="koboSpan" id="kobo.568.2">In other words, each selection requires interaction with several input fields. </span><span class="koboSpan" id="kobo.568.3">Once it is decided that the selection can’t be done with a single</span><a id="_idIndexMarker184"/><span class="koboSpan" id="kobo.569.1"> input field, the simplest option is cascading drop-down menus, that is, a chain of drop-down menus whose selection list depends on the values that were selected in the previous drop-down menus.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.570.1">For example, if the user needs to select a town located anywhere in the world, we may use the first drop-down menu to select the country, and once the country has been chosen, we may use this choice to populate a second one with all the towns in the selected country. </span><span class="koboSpan" id="kobo.570.2">A simple example is as follows:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.571.1"><img alt="" role="presentation" src="../Images/B19820_02_22.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.572.1">Figure 2.22: Cascading drop-down menu example</span></p>
<p class="normal"><span class="koboSpan" id="kobo.573.1">Clearly, each drop-down menu</span><a id="_idIndexMarker185"/><span class="koboSpan" id="kobo.574.1"> can be replaced by an autocomplete when required due to having a high number of options.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.575.1">If making the right selection can be done by intersecting several different hierarchies, cascading drop-down menus become inefficient too, and we need</span><a id="_idIndexMarker186"/><span class="koboSpan" id="kobo.576.1"> a filter form, as follows:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.577.1"><img alt="" role="presentation" src="../Images/B19820_02_23.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.578.1">Figure 2.23: Filter form sample</span></p>
<p class="normal"><span class="koboSpan" id="kobo.579.1">Now, let us understand interoperability with .NET 6.</span></p>
<h1 class="heading-1" id="_idParaDest-58"><span class="koboSpan" id="kobo.580.1">Interoperability with .NET 8</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.581.1">Since .NET Core, Microsoft</span><a id="_idIndexMarker187"/><span class="koboSpan" id="kobo.582.1"> has brought to C# developers the ability to deliver their software to various platforms. </span><span class="koboSpan" id="kobo.582.2">And you, as a software architect, need to pay attention to this, considering developing for Linux and macOS as a great opportunity to deliver new features to your customers. </span><span class="koboSpan" id="kobo.582.3">Therefore, we need to ensure performance and multi-platform support, two common non-functional requirements for many systems.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.583.1">Both console applications and web apps designed with .NET 8 in Windows are almost completely compatible with Linux and macOS, too. </span><span class="koboSpan" id="kobo.583.2">This means you do not have to build the app again to run it on these platforms.</span></p>
<div class="packt_tip">
<p class="normal"><span class="koboSpan" id="kobo.584.1">Microsoft offers scripts</span><a id="_idIndexMarker188"/><span class="koboSpan" id="kobo.585.1"> to help you install .NET on Linux and macOS. </span><span class="koboSpan" id="kobo.585.2">You can find them at </span><a href="https://docs.microsoft.com/dotnet/core/tools/dotnet-install-script"><span class="url"><span class="koboSpan" id="kobo.586.1">https://docs.microsoft.com/dotnet/core/tools/dotnet-install-script</span></span></a><span class="koboSpan" id="kobo.587.1">. </span><span class="koboSpan" id="kobo.587.2">Once you have the SDK installed, you just need to call </span><code class="inlineCode"><span class="koboSpan" id="kobo.588.1">dotnet</span></code><span class="koboSpan" id="kobo.589.1"> the same way you do in Windows.</span></p>
</div>
<p class="normal"><span class="koboSpan" id="kobo.590.1">However, you must be aware</span><a id="_idIndexMarker189"/><span class="koboSpan" id="kobo.591.1"> of some features that are not fully compatible with Linux and macOS systems. </span><span class="koboSpan" id="kobo.591.2">For instance, no equivalent to the Windows Registry exists in these OSes, and you must develop an alternative yourself. </span><span class="koboSpan" id="kobo.591.3">If needed, an encrypted JSON config file can be a good option.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.592.1">Another important point is that Linux is case-sensitive, while Windows is not. </span><span class="koboSpan" id="kobo.592.2">Please remember this when you work with files. </span><span class="koboSpan" id="kobo.592.3">Another important thing is that the Linux path separator is different from the Windows separator. </span><span class="koboSpan" id="kobo.592.4">You can use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.593.1">Path.PathSeparator</span></code><span class="koboSpan" id="kobo.594.1"> field and all the other </span><code class="inlineCode"><span class="koboSpan" id="kobo.595.1">Path</span></code><span class="koboSpan" id="kobo.596.1"> class members to ensure your code is multi-platform. </span><code class="inlineCode"><span class="koboSpan" id="kobo.597.1">Environment.NewLine</span></code><span class="koboSpan" id="kobo.598.1"> can also be useful in some situations.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.599.1">Besides, you can also adapt your code to the underlying OS by using the runtime checks provided by .NET 8, as follows:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.600.1">using</span></span><span class="koboSpan" id="kobo.601.1"> System.Runtime.InteropServices;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.602.1">if</span></span><span class="koboSpan" id="kobo.603.1"> (RuntimeInformation.IsOSPlatform(OSPlatform.Windows))
	Console.WriteLine(</span><span class="hljs-string"><span class="koboSpan" id="kobo.604.1">"Here you have Windows World!"</span></span><span class="koboSpan" id="kobo.605.1">);
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.606.1">else</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.607.1">if</span></span><span class="koboSpan" id="kobo.608.1">(RuntimeInformation.IsOSPlatform(OSPlatform.Linux))
	Console.WriteLine(</span><span class="hljs-string"><span class="koboSpan" id="kobo.609.1">"Here you have Linux World!"</span></span><span class="koboSpan" id="kobo.610.1">);
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.611.1">else</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.612.1">if</span></span><span class="koboSpan" id="kobo.613.1"> (RuntimeInformation.IsOSPlatform(OSPlatform.OSX))
	Console.WriteLine(</span><span class="hljs-string"><span class="koboSpan" id="kobo.614.1">"Here you have macOS World!"</span></span><span class="koboSpan" id="kobo.615.1">);
</span></code></pre>
<h2 class="heading-2" id="_idParaDest-59"><span class="koboSpan" id="kobo.616.1">Tip – creating a service in Linux</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.617.1">There are some good ways to create a service</span><a id="_idIndexMarker190"/><span class="koboSpan" id="kobo.618.1"> when you are developing</span><a id="_idIndexMarker191"/><span class="koboSpan" id="kobo.619.1"> on Windows, but how can we get the same result if we are developing for the Linux platform? </span><span class="koboSpan" id="kobo.619.2">The following script can be used to encapsulate a command-line .NET 8 app in Linux. </span><span class="koboSpan" id="kobo.619.3">The idea is that this service works like a Windows service. </span><span class="koboSpan" id="kobo.619.4">This can be useful, considering that most Linux installations are command-line-only and run without a user logged in:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.620.1">The first step is to create a file that will run the command-line app. </span><span class="koboSpan" id="kobo.620.2">The name of the app is </span><code class="inlineCode"><span class="koboSpan" id="kobo.621.1">app.dll</span></code><span class="koboSpan" id="kobo.622.1">, and it is installed in </span><code class="inlineCode"><span class="koboSpan" id="kobo.623.1">appfolder</span></code><span class="koboSpan" id="kobo.624.1">. </span><span class="koboSpan" id="kobo.624.2">The application will be checked every 5,000 milliseconds. </span><span class="koboSpan" id="kobo.624.3">This service was created on a CentOS 7 system. </span><span class="koboSpan" id="kobo.624.4">Using a Linux terminal, you can type this:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.625.1">cat &gt;sample.service&lt;&lt;EOF
[Unit]
Description=Your Linux Service
After=network.target
[Service]
ExecStart=/usr/bin/dotnet $(pwd)/appfolder/app.dll 5000
Restart=on-failure
[Install]
WantedBy=multi-user.target
EOF
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.626.1">Once the file has been created, you must copy the service file to a system location. </span><span class="koboSpan" id="kobo.626.2">After that, you must reload the system and enable the service so that it will restart on reboots:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.627.1">sudo cp sample.service /lib/systemd/system
sudo systemctl daemon-reload
sudo systemctl enable sample
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.628.1">Done! </span><span class="koboSpan" id="kobo.628.2">Now, you can start, stop, and check the service using the following commands. </span><span class="koboSpan" id="kobo.628.3">The whole input</span><a id="_idIndexMarker192"/><span class="koboSpan" id="kobo.629.1"> that you need to provide in your command-line app</span><a id="_idIndexMarker193"/><span class="koboSpan" id="kobo.630.1"> is as follows:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.631.1"># Start the service
sudo systemctl start sample
# View service status
sudo systemctl status sample
# Stop the service
sudo systemctl stop sample
</span></code></pre>
</li>
</ol>
<p class="normal"><span class="koboSpan" id="kobo.632.1">Now that we have learned about a few concepts, let us learn how to implement them in our use case.</span></p>
<h1 class="heading-1" id="_idParaDest-60"><span class="koboSpan" id="kobo.633.1">Achieving security by design</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.634.1">As we have seen up to this point</span><a id="_idIndexMarker194"/><span class="koboSpan" id="kobo.635.1"> in the book, the opportunities and techniques we have for developing software are incredible. </span><span class="koboSpan" id="kobo.635.2">If you add all the information you will read about in relation to cloud computing in the next chapters, you will see that the opportunities just increase, as does the complexity involved in maintaining this computing environment.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.636.1">As a software architect, you must understand that these opportunities come with many responsibilities. </span><span class="koboSpan" id="kobo.636.2">The world has changed a lot in recent years. </span><span class="koboSpan" id="kobo.636.3">The second decade of the 21st century has required lots of technology. </span><span class="koboSpan" id="kobo.636.4">Apps, social media, Industry 4.0, big data, and artificial intelligence are no longer future objectives but current projects that you will lead and deal with within your daily routine. </span><span class="koboSpan" id="kobo.636.5">However, the third decade of our century will require much more attention when it comes to cybersecurity.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.637.1">The world now regulates companies that manage personal data. </span><span class="koboSpan" id="kobo.637.2">For instance, the GDPR – the General Data Protection Regulation – is mandatory not only for European territory but also for the whole world; it has changed the way software is developed. </span><span class="koboSpan" id="kobo.637.3">There are many initiatives comparable to the GDPR that must be added to your glossary of techniques and regulations, considering that the software you design will be impacted by them.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.638.1">Security by design must be one of your areas of focus for designing new applications. </span><span class="koboSpan" id="kobo.638.2">This subject is huge, and it is not going to be completely covered in this book, but as a software architect, you must understand the necessity of having a specialist in the information security area in your team to guarantee the policies and practices needed to avoid cyber-attacks and maintain the confidentiality, privacy, integrity, authenticity, and availability of the services you architect.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.639.1">When it comes to protecting your ASP.NET Core application, it is worth mentioning that the framework has many features to help you out with that. </span><span class="koboSpan" id="kobo.639.2">For instance, it includes authentication and authorization patterns. </span><span class="koboSpan" id="kobo.639.3">In the OWASP Cheat Sheet Series, you can read about many other .NET practices.</span></p>
<div class="packt_tip">
<p class="normal"><span class="koboSpan" id="kobo.640.1">The </span><strong class="keyWord"><span class="koboSpan" id="kobo.641.1">Open Web Application Security Project</span></strong><span class="koboSpan" id="kobo.642.1">® (</span><strong class="keyWord"><span class="koboSpan" id="kobo.643.1">OWASP</span></strong><span class="koboSpan" id="kobo.644.1">) is a nonprofit foundation that works to improve</span><a id="_idIndexMarker195"/><span class="koboSpan" id="kobo.645.1"> the security of software. </span><span class="koboSpan" id="kobo.645.2">Check it out at </span><a href="https://owasp.org/"><span class="url"><span class="koboSpan" id="kobo.646.1">https://owasp.org/</span></span></a><span class="koboSpan" id="kobo.647.1">.</span></p>
</div>
<p class="normal"><span class="koboSpan" id="kobo.648.1">ASP.NET Core also provides features to help us out with the GDPR. </span><span class="koboSpan" id="kobo.648.2">Basically, there are APIs and templates to guide</span><a id="_idIndexMarker196"/><span class="koboSpan" id="kobo.649.1"> you in the implementation of policy declaration and cookie usage consent.</span></p>
<h2 class="heading-2" id="_idParaDest-61"><span class="koboSpan" id="kobo.650.1">List of practices for achieving a safe architecture</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.651.1">The following list of practices</span><a id="_idIndexMarker197"/><span class="koboSpan" id="kobo.652.1"> related to security certainly does not cover the entirety of the subject. </span><span class="koboSpan" id="kobo.652.2">However, these practices will help you, as a software architect, to explore some solutions related to this topic.</span></p>
<h2 class="heading-2" id="_idParaDest-62"><span class="koboSpan" id="kobo.653.1">Authentication</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.654.1">Define an authentication method</span><a id="_idIndexMarker198"/><span class="koboSpan" id="kobo.655.1"> for your web app. </span><span class="koboSpan" id="kobo.655.2">There are many authentication options available nowadays, from ASP.NET Core Identity to external provider authentication methods, such as Facebook or Google. </span><span class="koboSpan" id="kobo.655.3">As a software architect, you must consider who the target audience of the application is. </span><span class="koboSpan" id="kobo.655.4">It would also be worth considering using Azure </span><strong class="screenText"><span class="koboSpan" id="kobo.656.1">Active Directory</span></strong><span class="koboSpan" id="kobo.657.1"> (</span><strong class="screenText"><span class="koboSpan" id="kobo.658.1">AD</span></strong><span class="koboSpan" id="kobo.659.1">) as a starting point if you choose to go down this route.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.660.1">You may find it useful to design authentication associated with Azure AD, a component for managing the Active Directory of the company you are working for. </span><span class="koboSpan" id="kobo.660.2">This alternative is pretty good</span><a id="_idIndexMarker199"/><span class="koboSpan" id="kobo.661.1"> in some scenarios, especially</span><a id="_idIndexMarker200"/><span class="koboSpan" id="kobo.662.1"> for internal usage. </span><span class="koboSpan" id="kobo.662.2">Azure currently offers Active Directory for usage as </span><strong class="keyWord"><span class="koboSpan" id="kobo.663.1">B2B</span></strong><span class="koboSpan" id="kobo.664.1"> (</span><strong class="keyWord"><span class="koboSpan" id="kobo.665.1">Business to Business</span></strong><span class="koboSpan" id="kobo.666.1">) or </span><strong class="keyWord"><span class="koboSpan" id="kobo.667.1">B2C</span></strong><span class="koboSpan" id="kobo.668.1"> (</span><strong class="keyWord"><span class="koboSpan" id="kobo.669.1">Business to Consumer</span></strong><span class="koboSpan" id="kobo.670.1">).</span></p>
<p class="normal"><span class="koboSpan" id="kobo.671.1">Depending on the scenario</span><a id="_idIndexMarker201"/><span class="koboSpan" id="kobo.672.1"> of the solution you are building, you might need to implement </span><strong class="keyWord"><span class="koboSpan" id="kobo.673.1">MFA</span></strong><span class="koboSpan" id="kobo.674.1"> – </span><strong class="keyWord"><span class="koboSpan" id="kobo.675.1">Multi-Factor Authentication</span></strong><span class="koboSpan" id="kobo.676.1">. </span><span class="koboSpan" id="kobo.676.2">The idea of this pattern is to ask for at least two forms of proof of identity before allowing the solution to be used. </span><span class="koboSpan" id="kobo.676.3">It is worth mentioning that Azure AD facilitates this for you.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.677.1">You may also find it useful to implement authentication to your platform</span><a id="_idIndexMarker202"/><span class="koboSpan" id="kobo.678.1"> using as basis </span><strong class="keyWord"><span class="koboSpan" id="kobo.679.1">Microsoft Identity Platform</span></strong><span class="koboSpan" id="kobo.680.1">. </span><span class="koboSpan" id="kobo.680.2">In this case, the usage of the </span><strong class="keyWord"><span class="koboSpan" id="kobo.681.1">Microsoft Authentication Library</span></strong><span class="koboSpan" id="kobo.682.1"> (</span><strong class="keyWord"><span class="koboSpan" id="kobo.683.1">MSAL</span></strong><span class="koboSpan" id="kobo.684.1">) will facilitate your</span><a id="_idIndexMarker203"/><span class="koboSpan" id="kobo.685.1"> work hugely. </span><span class="koboSpan" id="kobo.685.2">Check how to implement it by reading its documentation at </span><a href="https://learn.microsoft.com/en-us/azure/active-directory/develop/msal-overview"><span class="url"><span class="koboSpan" id="kobo.686.1">https://learn.microsoft.com/en-us/azure/active-directory/develop/msal-overview</span></span></a><span class="koboSpan" id="kobo.687.1">.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.688.1">Do not forget that you must determine an authentication method for the APIs you provide. </span><span class="koboSpan" id="kobo.688.2">JSON Web Token is a pretty good pattern, and its usage is totally cross-platform.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.689.1">You must determine the authorization model you will use in your web app. </span><span class="koboSpan" id="kobo.689.2">There are four model options:</span></p>
<ul>
<li class="bulletList"><strong class="keyWord"><span class="koboSpan" id="kobo.690.1">Simple</span></strong><span class="koboSpan" id="kobo.691.1">, where you just use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.692.1">[Authorize]</span></code><span class="koboSpan" id="kobo.693.1"> attribute in the class or method.</span></li>
<li class="bulletList"><strong class="keyWord"><span class="koboSpan" id="kobo.694.1">Role-based</span></strong><span class="koboSpan" id="kobo.695.1">, in which you may declare </span><code class="inlineCode"><span class="koboSpan" id="kobo.696.1">Roles</span></code><span class="koboSpan" id="kobo.697.1"> for accessing the </span><code class="inlineCode"><span class="koboSpan" id="kobo.698.1">Controller</span></code><span class="koboSpan" id="kobo.699.1"> you are developing.</span></li>
<li class="bulletList"><strong class="keyWord"><span class="koboSpan" id="kobo.700.1">Claims-based</span></strong><span class="koboSpan" id="kobo.701.1">, where you can define values that must be received during the authentication to indicate that the user is authorized.</span></li>
<li class="bulletList"><strong class="keyWord"><span class="koboSpan" id="kobo.702.1">Policy-based</span></strong><span class="koboSpan" id="kobo.703.1">, in which there is a policy established to define the access in that </span><code class="inlineCode"><span class="koboSpan" id="kobo.704.1">Controller</span></code><span class="koboSpan" id="kobo.705.1">.</span></li>
</ul>
<p class="normal"><span class="koboSpan" id="kobo.706.1">You may also define a controller or method in a class as being fully accessible to any user by defining the </span><code class="inlineCode"><span class="koboSpan" id="kobo.707.1">[AllowAnonymous] </span></code><span class="koboSpan" id="kobo.708.1">attribute. </span><span class="koboSpan" id="kobo.708.2">Be sure this kind of implementation will not cause any vulnerabilities</span><a id="_idIndexMarker204"/><span class="koboSpan" id="kobo.709.1"> in the system you are designing.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.710.1">The model you decide to use will define exactly what each user will be able to do in the application.</span></p>
<h2 class="heading-2" id="_idParaDest-63"><span class="koboSpan" id="kobo.711.1">Sensitive data</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.712.1">While designing, you, as a software</span><a id="_idIndexMarker205"/><span class="koboSpan" id="kobo.713.1"> architect, will have to decide which part of the data you store is sensitive, and it will need to be protected. </span><span class="koboSpan" id="kobo.713.2">By connecting to Azure, your web app will be able to store protected data in components such as Azure Storage and Azure Key Vault. </span><span class="koboSpan" id="kobo.713.3">Storage in Azure will be discussed in </span><em class="chapterRef"><span class="koboSpan" id="kobo.714.1">Chapter 12</span></em><span class="koboSpan" id="kobo.715.1">, </span><em class="italic"><span class="koboSpan" id="kobo.716.1">Choosing Your Data Storage in the Cloud</span></em><span class="koboSpan" id="kobo.717.1">.</span></p>
<div class="packt_tip">
<p class="normal"><span class="koboSpan" id="kobo.718.1">It is highly recommended to check the </span><strong class="keyWord"><span class="koboSpan" id="kobo.719.1">Data Protection Framework</span></strong><span class="koboSpan" id="kobo.720.1"> that your solution will need to deal with, considering where it will be placed.</span></p>
</div>
<p class="normal"><span class="koboSpan" id="kobo.721.1">It is worth mentioning</span><a id="_idIndexMarker206"/><span class="koboSpan" id="kobo.722.1"> that Azure Key Vault is used to protect secrets your app may have. </span><span class="koboSpan" id="kobo.722.2">Consider using this solution when you have this kind of requirement.</span></p>
<h2 class="heading-2" id="_idParaDest-64"><span class="koboSpan" id="kobo.723.1">Web security</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.724.1">It is totally unacceptable</span><a id="_idIndexMarker207"/><span class="koboSpan" id="kobo.725.1"> to have a production solution deployed without the HTTPS protocol enabled. </span><span class="koboSpan" id="kobo.725.2">Azure Web Apps and ASP.NET Core solutions have various options to not only use but enforce the usage of this security protocol.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.726.1">There are many known attacks and malicious patterns, such as cross-site request forgery, open redirect, and cross-site scripting. </span><span class="koboSpan" id="kobo.726.2">ASP.NET Core provides APIs to solve them. </span><span class="koboSpan" id="kobo.726.3">You need to find the ones that are useful for your solution.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.727.1">Good programming practices, such as avoiding SQL injection by using parameters in your queries, is another important goal to achieve.</span></p>
<div class="packt_tip">
<p class="normal"><span class="koboSpan" id="kobo.728.1">You may find cloud</span><a id="_idIndexMarker208"/><span class="koboSpan" id="kobo.729.1"> architecture security patterns at </span><a href="https://docs.microsoft.com/en-us/azure/architecture/patterns/category/security"><span class="url"><span class="koboSpan" id="kobo.730.1">https://docs.microsoft.com/en-us/azure/architecture/patterns/category/security</span></span></a><span class="koboSpan" id="kobo.731.1">.</span></p>
</div>
<p class="normal"><span class="koboSpan" id="kobo.732.1">To finish, it is worth mentioning that security needs to be treated using the onion approach, which means that there are many layers of security to be implemented. </span><span class="koboSpan" id="kobo.732.2">You must have determined a policy to guarantee a process to access the data, including physical access for people who use the system you are developing. </span><span class="koboSpan" id="kobo.732.3">In addition, you also must develop a disaster recovery solution in case the system is attacked. </span><span class="koboSpan" id="kobo.732.4">The disaster recovery solution will depend on your cloud solution. </span><span class="koboSpan" id="kobo.732.5">We will discuss this later, in </span><em class="chapterRef"><span class="koboSpan" id="kobo.733.1">Chapter 10</span></em><span class="koboSpan" id="kobo.734.1">, </span><em class="italic"><span class="koboSpan" id="kobo.735.1">Deciding on the Best Cloud-Based Solution</span></em><span class="koboSpan" id="kobo.736.1">.</span></p>
<h1 class="heading-1" id="_idParaDest-65"><span class="koboSpan" id="kobo.737.1">Summary</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.738.1">Functional requirements that describe system behavior must be complemented with non-functional requirements that constrain system performance, scalability, availability, resilience, interoperability, usability, and security.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.739.1">Performance requirements come from response time and system load requirements. </span><span class="koboSpan" id="kobo.739.2">As a software architect, you should ensure you have the required performance at the minimum cost, building efficient algorithms and taking full advantage of the available hardware resources with multithreading.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.740.1">Scalability is the ability of a system to be adapted to an increasing load. </span><span class="koboSpan" id="kobo.740.2">Systems can be scaled vertically by providing more powerful hardware or horizontally by replicating and load balancing the same hardware, which increases the availability. </span><span class="koboSpan" id="kobo.740.3">The cloud, in general, and Azure can help us implement strategies dynamically, with no need to stop your application.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.741.1">Tools such as .NET 8 that run on several platforms can ensure interoperability, that is, the capability of your software to run on different target machines and with different operating systems (Windows, Linux, macOS, Android, and so on).</span></p>
<p class="normal"><span class="koboSpan" id="kobo.742.1">Usability is ensured by taking care of input field order, the effectiveness of the item selection logic, and how easy your system is to learn.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.743.1">Besides, the more complex your solution is, the better resilience it should have. </span><span class="koboSpan" id="kobo.743.2">The idea of resilience is not to guarantee that the solution does not fail. </span><span class="koboSpan" id="kobo.743.3">Instead, the idea is to guarantee that the solution has an action defined when each part of the software fails.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.744.1">As a software architect, you must consider security from the very beginning of the design. </span><span class="koboSpan" id="kobo.744.2">Following the guidelines to determine the correct patterns and having a security specialist on your team is the best way to comply with all the current regulations we have.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.745.1">In the next chapter, you will learn how Azure DevOps and GitHub can help us when it comes to collecting, defining, and documenting our requirements.</span></p>
<h1 class="heading-1" id="_idParaDest-66"><span class="koboSpan" id="kobo.746.1">Questions</span></h1>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.747.1">What are the two conceptual ways to scale a system?</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.748.1">Can you deploy your web app automatically from Visual Studio to Azure?</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.749.1">What is multithreading useful for?</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.750.1">What are the main advantages of the asynchronous pattern over other multithreading techniques?</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.751.1">Why is the order of input fields so important?</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.752.1">Why is the </span><code class="inlineCode"><span class="koboSpan" id="kobo.753.1">Path</span></code><span class="koboSpan" id="kobo.754.1"> class so important for interoperability?</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.755.1">What is the advantage of a .NET standard class library?</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.756.1">List the </span><em class="italic"><span class="koboSpan" id="kobo.757.1">most-used</span></em><span class="koboSpan" id="kobo.758.1"> types of .NET Visual Studio projects.</span></li>
</ol>
<h1 class="heading-1" id="_idParaDest-67"><span class="koboSpan" id="kobo.759.1">Further reading</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.760.1">The following are some books and links you may consider reading to gather more information in relation to this chapter:</span></p>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.761.1">Cloud computing models</span><ul>
<li class="bulletList"><a href="https://docs.microsoft.com/en-us/azure/architecture/best-practices/auto-scaling"><span class="url"><span class="koboSpan" id="kobo.762.1">https://docs.microsoft.com/en-us/azure/architecture/best-practices/auto-scaling</span></span></a></li>
<li class="bulletList"><a href="https://docs.microsoft.com/en-us/aspnet/core/host-and-deploy/azure-apps/"><span class="url"><span class="koboSpan" id="kobo.763.1">https://docs.microsoft.com/en-us/aspnet/core/host-and-deploy/azure-apps/</span></span></a></li>
</ul>
</li>
<li class="bulletList"><span class="koboSpan" id="kobo.764.1">Parallel programming</span><ul>
<li class="bulletList"><a href="https://docs.microsoft.com/en-us/dotnet/standard/parallel-processing-and-concurrency"><span class="url"><span class="koboSpan" id="kobo.765.1">https://docs.microsoft.com/en-us/dotnet/standard/parallel-processing-and-concurrency</span></span></a></li>
<li class="bulletList"><a href="https://docs.microsoft.com/en-us/dotnet/standard/parallel-programming/"><span class="url"><span class="koboSpan" id="kobo.766.1">https://docs.microsoft.com/en-us/dotnet/standard/parallel-programming/</span></span></a></li>
</ul>
</li>
<li class="bulletList"><span class="koboSpan" id="kobo.767.1">Performance improvements in .NET</span><ul>
<li class="bulletList"><a href="https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-8/"><span class="url"><span class="koboSpan" id="kobo.768.1">https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-8/</span></span></a></li>
<li class="bulletList"><a href="https://benchmarkdotnet.org/"><span class="url"><span class="koboSpan" id="kobo.769.1">https://benchmarkdotnet.org/</span></span></a></li>
</ul>
</li>
<li class="bulletList"><span class="koboSpan" id="kobo.770.1">Security aspects</span><ul>
<li class="bulletList"><a href="https://docs.microsoft.com/en-us/aspnet/core/security/"><span class="url"><span class="koboSpan" id="kobo.771.1">https://docs.microsoft.com/en-us/aspnet/core/security/</span></span></a></li>
<li class="bulletList"><a href="https://cheatsheetseries.owasp.org/cheatsheets/DotNet_Security_Cheat_Sheet.html"><span class="url"><span class="koboSpan" id="kobo.772.1">https://cheatsheetseries.owasp.org/cheatsheets/DotNet_Security_Cheat_Sheet.html</span></span></a></li>
<li class="bulletList"><a href="https://docs.microsoft.com/en-us/aspnet/core/security/gdpr"><span class="url"><span class="koboSpan" id="kobo.773.1">https://docs.microsoft.com/en-us/aspnet/core/security/gdpr</span></span></a></li>
<li class="bulletList"><a href="https://learn.microsoft.com/en-us/azure/active-directory/develop/msal-overview"><span class="url"><span class="koboSpan" id="kobo.774.1">https://learn.microsoft.com/en-us/azure/active-directory/develop/msal-overview</span></span></a></li>
</ul>
</li>
<li class="bulletList"><span class="koboSpan" id="kobo.775.1">Service consistency aspects</span><ul>
<li class="bulletList"><a href="https://docs.microsoft.com/en-us/azure/architecture/patterns/category/resiliency"><span class="url"><span class="koboSpan" id="kobo.776.1">https://docs.microsoft.com/en-us/azure/architecture/patterns/category/resiliency</span></span></a></li>
<li class="bulletList"><a href="https://docs.microsoft.com/en-us/azure/architecture/patterns/category/availability"><span class="url"><span class="koboSpan" id="kobo.777.1">https://docs.microsoft.com/en-us/azure/architecture/patterns/category/availability</span></span></a></li>
</ul>
</li>
<li class="bulletList"><span class="koboSpan" id="kobo.778.1">Dotnet support</span><ul>
<li class="bulletList"><a href="https://dotnet.microsoft.com/platform/support/policy"><span class="url"><span class="koboSpan" id="kobo.779.1">https://dotnet.microsoft.com/platform/support/policy</span></span></a></li>
</ul>
</li>
</ul>
<h1 class="heading-1"><span class="koboSpan" id="kobo.780.1">Learn more on Discord</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.781.1">To join the Discord community for this book – where you can share feedback, ask questions to the authors, and learn about new releases – follow the QR code below:</span></p>
<p class="normal"><a href="https://packt.link/SoftwareArchitectureCSharp12Dotnet8"><span class="url"><span class="koboSpan" id="kobo.782.1">https://packt.link/SoftwareArchitectureCSharp12Dotnet8</span></span></a></p>
<p class="normal"><span class="koboSpan" id="kobo.783.1"><img alt="" role="presentation" src="../Images/QR_Code175081751210902046.png"/></span></p>
</div>
</body></html>