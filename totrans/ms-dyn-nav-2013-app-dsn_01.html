<html><head></head><body><div><div><div><div><h1 class="title"><a id="ch01"/>Chapter 1. Introduction to Microsoft Dynamics NAV</h1></div></div></div><p>Once upon a time; this is how fairytales often start and even though the story of Microsoft Dynamics NAV is everything but a fairytale, it sure has some magic.</p><p>With more than 100,000 installations, it is one of the most popular ERP packages in the mid-market. In this book, we will go through the magic of the Dynamics NAV application. We'll see how Dynamics NAV will give better information on how our business is doing and provide a better insight where processes can be optimized or need to be changed.</p><p>In this chapter, we'll discuss the basic principles of the Microsoft Dynamics NAV application, how it's structured, and why. After reading this chapter, you will have a better understanding of what to expect when implementing and designing for Microsoft Dynamics NAV.</p><div><div><div><div><h1 class="title"><a id="ch01lvl1sec08"/>Versions and history</h1></div></div></div><p>At the time of <a class="indexterm" id="id0"/>publishing this book, Microsoft Dynamics NAV 2013R2, is the most recent version of the product. When the Windows version was first introduced in 1995, the product was<a class="indexterm" id="id1"/> called Navision Financials 1.0. The<a class="indexterm" id="id2"/> Danish software company that originally developed the product, Navision Software A/S, was <a class="indexterm" id="id3"/>not yet acquired by Microsoft and it was a revolution. It was a full Windows product and had all basic functionality that small companies needed. It is important to understand that the original version was targeted at smaller companies.</p><p>Since then, we have had many (20+) versions. All new versions contained new functionality and with it the product has become more mature and suitable for bigger companies as well. This was especially empowered with the support of the Microsoft SQL Server platform,<a class="indexterm" id="id4"/> allowing more concurrent users to work in the same application areas.</p><p>Until Version 5.0, the technology of the product did not change. The original intention of Microsoft was to release a new technology platform together with new functional changes. This turned out to be a<a class="indexterm" id="id5"/> very difficult task so they decided to split the technology into two releases. Version 5.0 contained new functionality and improvements while Version 2009, or 6.0, which is the technical release number, was a technology release.</p><p>The technical challenge <a class="indexterm" id="id6"/>was to migrate from the old C++ platform to .NET and to move from a two tier to a three tier technology. This was also the first release with a drastic change in the user interface. Microsoft Dynamics NAV 2009 contains an entirely new user interface, the Role Tailored Client, which is built new from the ground up — the existing (classic) user interface is the same with no changes. During this migration process, all application functionality was frozen although small improvements and bug fixes were made in 2009 SP1.</p><p>With Microsoft Dynamics NAV 2013, we have entered a new era where the transformation is complete. The product is converted to .NET and even supports limited use of DotNet Interoperability<a class="indexterm" id="id7"/> directly from the <a class="indexterm" id="id8"/>C/AL programming language. The classic user interface is discontinued as is the native database.</p><p>This book supports functionality from the 2013 release although most concepts relate back to the older versions.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec09"/>What is this book about</h1></div></div></div><p>The title of the book is Microsoft Dynamics NAV 2013 Application Design. What does application design mean? And what does it mean in Microsoft Dynamics NAV 2013?</p><p>Microsoft Dynamics NAV 2013<a class="indexterm" id="id9"/> is a complete ERP package, but unlike other ERP packages, it has a design capable of providing an open structure and a development platform. The idea is to provide 80 percent of the solution out of the box and allow the other 20 percent to be designed by qualified business application developers.</p><p>The partner channel is a unique part of Microsoft Dynamics NAV. From the moment Navision<a class="indexterm" id="id10"/> was introduced, company management decided that it would only make sense to have an indirect selling model and to let the resellers (called partners) have the availability to change the product and add new functionalities.</p><p>This book is about both the 80 percent and the 20 percent. We'll see that the percentages differ per industry where it is applied. Some industries have close to a 100 percent fit while others have a need for an 80 percent development.</p><p>So there is a very thin line in this book between using the standard application and designing changes and expanding the product. Although this is not a development book, we'll dive into code and objects in almost every chapter.</p><p>Reading this chapter will be more than enough to understand the code but if you want to know more, we highly recommend reading <em>Programming Microsoft Dynamics NAV 2013</em>, <em>David A. Studebaker</em>, <em>Christopher D. Studebaker</em>, <em>Packt Publishing</em>.</p><p>This book is not a manual for Microsoft Dynamics NAV 2013. It will give you a clear idea of how the structure of the application is laid out and about its possibilities. We do not want to replace or rewrite the Microsoft documentation but rather want to provide ideas that you might not have thought about.</p></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec10"/>Setup versus customization</h1></div></div></div><p>In Microsoft Dynamics NAV, the <a class="indexterm" id="id11"/>line between implementing and developing is very thin. Where you would perform a lot of setup in other ERP packages, you'll see that it often makes more sense in Dynamics NAV to make a change with the development tools.</p><p>The standard package is very complete in its functionality but does not support all industries. It is more a framework for partners to work with. In this book, we will explain this framework and what philosophy it is built on. Understanding this philosophy is critical to knowing how to expand the functionality.</p><p>However, expanding the functionality means customizing the application. Do end users in 2013 still want customized applications? Mostly, they will say they don't want their software customized, but in the next breath, they will say that the software should change to match their way of doing business, and that they should have to change their business to fit the software.</p><p>This is why Microsoft pushes their partners to create horizontal and vertical solutions on top of the standard product and release these solutions as products with their own versions as if they were a part of the standard applications. This way of using the partner channel is a unique concept that has proven to be very successful and make Microsoft Dynamics NAV useable in almost any industry.</p><p>Most companies, however, have such a unique way of working that they will always require more or less customized solutions. The total cost of ownership depends on the level of customizations and how these customizations are designed.</p><p>The key is in knowing when to do a setup and when to do a customization. Only a solid understanding of the application will help you determine which is correct.</p><p>After reading this book, you will know how to design your application best to have a good balance between cost of ownership and functionality.</p></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec11"/>The beauty of simplicity</h1></div></div></div><p>As discussed earlier, the <a class="indexterm" id="id12"/>application is designed to be expanded and changed by external partners. When this partner program was created, a decision was made that partners could only do a proper job if the application was completely open for them to add and change. This philosophy is very important to understand when you first start implementing or changing Microsoft Dynamics NAV.</p><p>Partners can change all business logic in the application. They can add new fields to tables and create their own tables. The only thing they cannot do is delete fields from the tables in the base application.</p><p>As you can see, Microsoft Dynamics NAV is an extremely flexible and open product with a lot of freedom. But with freedom comes responsibilities. In Dynamics NAV, you are responsible for the housekeeping in your system.</p><div><div><div><div><h2 class="title"><a id="ch01lvl2sec11"/>Horizontal versus vertical solutions</h2></div></div></div><p>Because<a class="indexterm" id="id13"/> of this open system, partners have created thousands of smaller and larger changes to the system. Some of these changes were bundled into new functional pieces and called add-ons. These add-ons are often solutions that change Dynamics NAV into a product for a specific industry rather than a generic ERP system. Other add-ons are specific features that can be used in all industries such as EDI or workflow. Microsoft calls the industry specific add-ons verticals and the generic add-ons horizontals.</p></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec12"/>Open source</h2></div></div></div><p>Even though Dynamics NAV has <a class="indexterm" id="id14"/>an open source for their partners, it does not come fully equipped with a development environment like most developers are used to. It has a customization tool that lets you customize the application like you would customize another ERP system with settings. This customization tool is a basic tool that is nice to work with but misses some development features such as version control or <a class="indexterm" id="id15"/>IntelliSense. This makes it more difficult to keep track of your changes. We will discuss how to use Team Foundation Server for Object Versioning in <a class="link" href="ch10.html" title="Chapter 10. Application Design">Chapter 10</a>, <em>Application Design</em>.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec12"/>Design patterns</h1></div></div></div><p>When <a class="indexterm" id="id16"/>customizing Microsoft Dynamics NAV, you can use proven concepts in the application. These proven concepts are called design patterns. There are <a class="indexterm" id="id17"/>three types of design patterns.</p><div><div><div><div><h2 class="title"><a id="ch01lvl2sec13"/>Architectural patterns</h2></div></div></div><p>Architectural patterns <a class="indexterm" id="id18"/>are the main data processes and table structures. Examples are master data, singleton tables, documents, and posting and archiving processes.</p></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec14"/>Design patterns</h2></div></div></div><p>Although this is <a class="indexterm" id="id19"/>the name that people use for the entire concept, design patterns are reusable elements to solve specific problems, such as number series and blocked entity.</p></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec15"/>Implementation patterns</h2></div></div></div><p>Different development techniques <a class="indexterm" id="id20"/>are called implementation patterns. Examples are proxy, façade, temporary datasets, and hooks.</p></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec16"/>APIs</h2></div></div></div><p>
<strong>Application programming interfaces</strong> (<strong>API</strong>s)<a class="indexterm" id="id21"/> are reusable blocks of code that generally do not change. They are as important to know to work with Dynamics NAV as .NET libraries are to work in C#. Within Microsoft Dynamics NAV, we have several building blocks that are reused but not changed. Examples are address formatting and the navigate page.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec13"/>Structure of this book</h1></div></div></div><p>This book will cover most functional elements of Dynamics NAV in a number of vertical industries. We will do this in a supply chain matrix. The specific industries we will look at are fashion, automotive, medicines, food, and furniture. For production and trade, we will look at the general process, and we will see how consultancy and distribution companies help in this process.</p><p>The following diagram shows how this book is structured:</p><div><img alt="Structure of this book" src="img/0365EN_01_01.jpg"/></div><p>For all these industries, we will look at what parts of the standard product can be utilized and where we need vertical solutions. We'll discuss how these vertical solutions will interface with the standard package or maybe even change the behavior of the standard product.</p><p>Two parts of the product, however, are so general in their use and usability for all industries that we'll discuss them in their own chapter. These are<a class="indexterm" id="id22"/> <strong>Financial Management</strong> and <a class="indexterm" id="id23"/>
<strong>Relationship Management</strong>.</p><p>To emphasize the strength of the vertical concept, we'll design and create a vertical solution for a distribution company.</p><p>Now, we will look at some of the basic concepts of the application.</p></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec14"/>The Role Tailored concept</h1></div></div></div><p>With the NAV 2009 release, Microsoft <a class="indexterm" id="id24"/>marketing decided to introduce the concept of Role Tailored ERP. Until now, most ERP systems were <a class="indexterm" id="id25"/>module driven, meaning the application has an area for finance, CRM, sales, purchasing, and so on. The access to the individual modules was separated. A purchaser needs to switch to sales in order to see the sales orders.</p><p>Most people in a company have specialized tasks that the ERP system should support. In a classic ERP interface, the users<a class="indexterm" id="id26"/> would have to decide themselves the location of the parts that they need. This has changed with the introduction of the Role Tailored concept.</p><div><img alt="The Role Tailored concept" src="img/0365EN_01_02.jpg"/></div><p>This screenshot shows a purchasers' Role Center. As you can see, all information for this person in <a class="indexterm" id="id27"/>the organization is in one place and usable in a workflow-like way. Also, the <strong>Sales Orders</strong> are accessible from the <strong>Main Menu</strong> window. It is completely different to the menu found in Version 5.0 or before.</p><div><img alt="The Role Tailored concept" src="img/0365EN_01_03.jpg"/></div><p>However, the Role Tailored concept<a class="indexterm" id="id28"/> is not new. Dynamics NAV partners have been implementing it for many years. In the classic menu, as seen in the preceding screenshot, it was extremely easy to <a class="indexterm" id="id29"/>create new menus and most companies implemented their own menus per role. When the Microsoft Outlook style menu was introduced in Version 4.0, end users could create shortcut Menu Suites, which also quickly became role centers. You can clearly see that the Role Tailored concept is like coming home for Dynamics NAV.</p><p>In Microsoft Dynamics NAV 2013, the Windows Client<a class="indexterm" id="id30"/> is no longer referred to as the Role Tailored Client as it was in Version 2009. All available clients are Role Tailored.</p></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec15"/>The building blocks</h1></div></div></div><p>To understand<a class="indexterm" id="id31"/> the development examples in this book, we will<a class="indexterm" id="id32"/> discuss some of the basic building blocks of Microsoft Dynamics NAV 2013.</p><div><img alt="The building blocks" src="img/0365EN_01_04.jpg"/></div><p>Like all database applications, it starts with tables. They contain all the information displayed in a structured way. It is important to understand that the tables of Microsoft Dynamics NAV are not completely normalized. The tables are structured in the way the user interface works. This makes it easy for nontechnical people to understand the data model. We'll discuss the unique structure of the application in <a class="link" href="ch02.html" title="Chapter 2. A Sample Application">Chapter 2</a>, <em>A Sample Application</em>.</p><p>Tables, however, not<a class="indexterm" id="id33"/> only contain data, but they contain business logic as well. As they are structured like the functionality in the database, tables contain simple functions like address validation and more complex functions for VAT and discount calculation.</p><p>Whenever <a class="indexterm" id="id34"/>functionality gets more complex or can be shared across the application, it is better to move them to the codeunit object. These are containers of business logic for a special purpose. Tables can also be used as a class without storing data. This allows more structured programming.</p><p>For the user interface, there are two object types: reports and pages. Reports are originally intended to be printed on paper but with the current status of technology, they are more and more used as information dashboards, combining management information with drill-through possibilities.</p><p>As the tables are structured in the way the application works, the pages are bound to one table. For people new to this concept, it sometimes takes a while to get used to this.</p><p>The Menu Suite defines the way the navigation is structured when people leave their <a class="indexterm" id="id35"/>Role Centers and go to the department pages. The Menu Suite<a class="indexterm" id="id36"/> is used for the <strong>Search</strong> window.</p><p>The last object type is an external interface object. XML ports make it possible to import and export data in and out of the system.</p><p>Query objects are<a class="indexterm" id="id37"/> introduced in Microsoft Dynamics NAV 2013 and allow developers to define SQL Server SELECT statements<a class="indexterm" id="id38"/> on the metadata level that can be used in <a class="indexterm" id="id39"/>C/AL code. It is possible to join multiple tables into one query. Query objects can also be exposed as <a class="indexterm" id="id40"/>OData web services.</p><p>For this book, the <a class="indexterm" id="id41"/>table and page objects are the most important to understand. Most of this book, however, can also be applied to older versions but then forms should be applied wherever this book addresses pages.</p><div><div><div><div><h2 class="title"><a id="ch01lvl2sec17"/>Tables as user interface and business logic</h2></div></div></div><p>The table object<a class="indexterm" id="id42"/> in Microsoft Dynamics NAV is very important. Since it is not normalized, it contains a lot of information about how the database works.</p><p>For example, the<a class="indexterm" id="id43"/> Job Card (88) is built on one table, the <a class="indexterm" id="id44"/>Job (167). This table contains all the fields required for this screen.</p><div><img alt="Tables as user interface and business logic" src="img/0365EN_01_05.jpg"/></div><p>In a traditional development environment, this screen would have a transaction <code class="literal">GetJobData</code> and <code class="literal">UpdateJobData</code>. These <a class="indexterm" id="id45"/>transactions would read the information from the database, map them to the screen, and save the information in the database if the user is finished. However, in Microsoft Dynamics NAV, all fields that are displayed in the interface are stored in one table. This makes it possible for the screen to have built-in triggers to get the data and update the database.</p><p>The table object then contains the business logic required for this document. Let's have a look at some of the fields in this table:</p><div><img alt="Tables as user interface and business logic" src="img/0365EN_01_06.jpg"/></div><p>In the preceding screenshot, we<a class="indexterm" id="id46"/> can see a lot of fields such as <strong>WIP Method</strong>, <strong>Currency Code</strong>, and so on, which are required for a job.</p><div><img alt="Tables as user interface and business logic" src="img/0365EN_01_07.jpg"/></div><p>When we click on the <strong>C/AL Code</strong> icon and we focus on currency code, we get the following result:</p><div><pre class="programlisting">Currency Code - OnValidate()
IF "Currency Code" &lt;&gt; xRec."Currency Code" THEN
  IF NOT JobLedgEntryExist THEN
    CurrencyUpdatePlanningLines
  ELSE
    ERROR(Text000,FIELDCAPTION("Currency Code"),TABLECAPTION);</pre></div><p>This contains business logic<a class="indexterm" id="id47"/> that gets executed every time something happens with this field. In this case, the currency factor is recalculated and updated in the sales lines.</p><p>So the tables in Microsoft Dynamics NAV are not just data containers, they are the foundation for both the business logic and the application workflow.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec16"/>Dynamics NAV in throughout supply chain</h1></div></div></div><p>The Dynamics NAV product<a class="indexterm" id="id48"/> is used almost everywhere in the business supply chain. This is mainly because it is a highly customizable ERP system. Dynamics NAV is used in the classical supply chain companies, such as manufacturing plants, wholesale companies, and in retail with or without many changes. But with an add-on, the product is also used in transportation companies or in the recycling industry.</p><p>In order to understand this better, it is important to know how companies work. A company is a person or a group of persons using materials and resources to deliver a product or a service to other companies or end consumers. A group of companies working together is called a <a class="indexterm" id="id49"/>supply chain. Dynamics NAV can be used in all these companies, although it is traditionally used in companies with five to 250 concurrent users.</p><p>In order to serve this process, Dynamics NAV has <a class="indexterm" id="id50"/>a list of the following basic modules:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>Financial management</strong>: Traditionally, this <a class="indexterm" id="id51"/>was used in companies to comply with federal <a class="indexterm" id="id52"/>regulations of bookkeeping. For entrepreneurs starting their business, this is usually the part they least like. However, good bookkeeping can give a clear view on the company's wellbeing and support strategic decisions with good financial information.</li><li class="listitem" style="list-style-type: disc"><strong>Inventory</strong>: Every <a class="indexterm" id="id53"/>company that grows will reach a certain point where it is no longer possible to handle inventory<a class="indexterm" id="id54"/> without a system. Keeping too much inventory is very expensive. A good inventory system can help you keep your stock as efficient as possible.</li><li class="listitem" style="list-style-type: disc"><strong>Relationship management (RM)</strong>: When<a class="indexterm" id="id55"/> it comes to people, a company is not only dealing <a class="indexterm" id="id56"/>with customers and vendors. RM will help you keep track of every company and person your company is dealing with.</li><li class="listitem" style="list-style-type: disc"><strong>Sales</strong>: The<a class="indexterm" id="id57"/> sales process is usually<a class="indexterm" id="id58"/> the place where businesses make money. The system will help you keep track of orders that your customers place.</li><li class="listitem" style="list-style-type: disc"><strong>Purchasing</strong>: The<a class="indexterm" id="id59"/> purchasing<a class="indexterm" id="id60"/> department is usually split in two pieces. One piece is the purchasing of goods the company needs for itself. This facility management can grow into a business of its own at large companies. The other purchasing part is buying the materials and resources you need for your sales process. For some trading companies, this can even be a drop shipment process where you never have the purchased goods in house.</li><li class="listitem" style="list-style-type: disc"><strong>Warehouse management</strong>: Warehouses<a class="indexterm" id="id61"/> are <a class="indexterm" id="id62"/>getting bigger and bigger, making the need for a system that supports the picking and put-away process even greater. This is usually tightly connected to the sales and purchase process.</li><li class="listitem" style="list-style-type: disc"><strong>Manufacturing</strong>: When <a class="indexterm" id="id63"/>you <a class="indexterm" id="id64"/>make products yourself, you need a system that helps you create a new item from one or more purchased materials and resources.</li><li class="listitem" style="list-style-type: disc"><strong>Jobs</strong>: In some <a class="indexterm" id="id65"/>companies, the process <a class="indexterm" id="id66"/>of delivering a service is so complex that it requires its own administration process. Time and billing is usually a very important process for these companies.</li><li class="listitem" style="list-style-type: disc"><strong>Service management</strong>: This <a class="indexterm" id="id67"/>supports <a class="indexterm" id="id68"/>the service process handling warranty and necessary periodical maintenance of your items.</li></ul></div></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec17"/>Some basic design patterns</h1></div></div></div><p>Microsoft Dynamics NAV <a class="indexterm" id="id69"/>has some basic design patterns that are reused throughout the application and are necessary to understand the concepts of this book.</p><div><div><div><div><h2 class="title"><a id="ch01lvl2sec18"/>Number series</h2></div></div></div><p>Databases need <a class="indexterm" id="id70"/>unique records. The application has two ways of making this happen.</p><p>Some tables <a class="indexterm" id="id71"/>have automatic incremental numbering that cannot be influenced. These are often accounting tables that have auditable purposes. Examples of these tables are G/L entries, G/L registers, and VAT entries.</p><p>The other way is using a flexible alphanumeric code. In some setup tables, users are free to create their own numbers like in the location table but most of the time, number series functionality is used. These can be influenced by the end user depending on their access rights. Let's have a closer look at them:</p><div><img alt="Number series" src="img/0365EN_01_08.jpg"/></div><p>Users can define their own numbering, usually starting with an alphanumeric character. Numbering can<a class="indexterm" id="id72"/> be done automatically, manually, or a<a class="indexterm" id="id73"/> combination of the two. Numbers can have a starting date and incremental number. This way you can number your Sales Invoices SI11-0001. SI means Sales Invoice, 11 means 2011, and 0001 is the incremental number.</p><p>For example, number series can be linked to each other making it possible to have a different number series for national and international customers.</p></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec19"/>Extended text</h2></div></div></div><p>Most master <a class="indexterm" id="id74"/>data tables in Microsoft Dynamics NAV have two description fields, but it is possible to add extra text.</p><p>The text <a class="indexterm" id="id75"/>can be defined for all languages in the system and made valid for a specific period.</p><p>We can enable or disable using the text for most documents available in the system, so we can have some long text for the <strong>Sales Quote</strong> and some shorter text for the <strong>Sales Invoice</strong>, as shown in the following screenshot:</p><div><img alt="Extended text" src="img/0365EN_01_09.jpg"/></div></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec20"/>Navigate</h2></div></div></div><p>The <a class="indexterm" id="id76"/>main reason <a class="indexterm" id="id77"/>Microsoft Dynamics NAV consultants like you to use numbers like SI11-0001 is because of the <a class="indexterm" id="id78"/>
<strong>Navigate</strong> functionality. This functionality makes it possible to find all information in the database linked to this document. If you name your Sales Invoice 110001 and your Purchase Invoice the same, the system would not be able to find the information at a detailed level.</p><div><img alt="Navigate" src="img/0365EN_01_10.jpg"/></div><p>When <a class="indexterm" id="id79"/>navigating to <strong>Posted Sales Invoice 103006</strong> in the CRONUS Demo database, we get all the information that is linked to this number.</p><p>Navigation shows <a class="indexterm" id="id80"/>both documents and entries. Using the <strong>Show</strong> option, we can drill down into the records and go even deeper into the information. Navigation is present at most pages that show posted transactions and historical data.</p></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec21"/>Setup tables</h2></div></div></div><p>An ERP application<a class="indexterm" id="id81"/> can be used in many different ways and to make it work in the way we want, we need to set it up correctly. We already discussed that Dynamics NAV has far less setup than other ERP packages and is more likely to be changed, but nonetheless there is setup work to do.</p><p>Every part of the application has<a class="indexterm" id="id82"/> its own setup table. There are also some application-wide or cross-application setup tables. During the implementation, we need to make sure to touch all of these tables. Changing these setups after the implementation should be done with great care.</p><p>The setup tables use the singleton table design pattern. The following table shows all Microsoft Dynamics NAV setup tables grouped by type:</p><div><table border="1"><colgroup><col style="text-align: left"/><col style="text-align: left"/></colgroup><thead><tr><th style="text-align: left" valign="bottom">
<p>Specific setup tables</p>
</th><th style="text-align: left" valign="bottom">
<p>Application-wide setup tables</p>
</th></tr></thead><tbody><tr><td style="text-align: left" valign="top">
<p>General ledger setup</p>
<p>Sales &amp; receivables setup</p>
<p>Purchases &amp; payables setup</p>
<p>Inventory setup</p>
<p>Resources setup</p>
<p>Jobs setup</p>
<p>Marketing setup</p>
<p>Human resources setup</p>
<p>Production schedule setup</p>
<p>FA setup</p>
<p>Nonstock item setup</p>
<p>Warehouse setup</p>
<p>Service Mgt. setup</p>
<p>Manufacturing setup</p>
</td><td style="text-align: left" valign="top">
<p>Source code setup</p>
<p>Change log setup</p>
<p>SMTP mail setup</p>
<p>Approval setup</p>
<p>Job queue setup</p>
<p>Online map setup</p>
<p>Interaction template setup</p>
<p>Employee portal setup</p>
<p>Notification setup</p>
<p>Order promising setup</p>
<p>BizTalk management setup</p>
</td></tr></tbody></table></div><p>When we open a setup from the application, we see some options, including the numbering we discussed earlier:</p><div><img alt="Setup tables" src="img/0365EN_01_11.jpg"/></div></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec22"/>Posting groups</h2></div></div></div><p>Microsoft Dynamics NAV is very<a class="indexterm" id="id83"/> flexible in its posting to the <a class="indexterm" id="id84"/>
<strong>General Ledger</strong>. This<a class="indexterm" id="id85"/> is set up in posting groups. These form a matrix that is filtered out by the application.</p><p>Most application areas have one or more posting group tables:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Customer posting group</li><li class="listitem" style="list-style-type: disc">Vendor posting group</li><li class="listitem" style="list-style-type: disc">Inventory posting group</li><li class="listitem" style="list-style-type: disc">Job posting group</li><li class="listitem" style="list-style-type: disc">Gen. business posting group</li><li class="listitem" style="list-style-type: disc">Gen. product posting group</li><li class="listitem" style="list-style-type: disc">Bank account posting group</li><li class="listitem" style="list-style-type: disc">VAT business posting group</li><li class="listitem" style="list-style-type: disc">VAT product posting group</li><li class="listitem" style="list-style-type: disc">FA posting <a class="indexterm" id="id86"/>group<div><div><h3 class="title"><a id="tip02"/>Tip</h3><p>We'll discuss posting groups in more detail in <a class="link" href="ch03.html" title="Chapter 3. Financial Management">Chapter 3</a>, <em>Financial Management</em>.</p></div></div></li></ul></div></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec23"/>Pricing</h2></div></div></div><p>When it <a class="indexterm" id="id87"/>comes to pricing<a class="indexterm" id="id88"/> and discounts, Microsoft Dynamics NAV has a very simple yet effective way of calculating.</p><p>All sales and purchase prices are stored in four simple tables:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">7002 – Sales Price</li><li class="listitem" style="list-style-type: disc">7004 – Sales Line Discount</li><li class="listitem" style="list-style-type: disc">7012 – Purchase Price</li><li class="listitem" style="list-style-type: disc">7014 – Purchase Line Discount</li></ul></div><p>The system finds the appropriate price by filtering down in these tables. The narrower the filter, the more likely the price is applied.</p><div><img alt="Pricing" src="img/0365EN_01_12.jpg"/></div><p>For example, the normal price of item <strong>1972-W</strong> on the item card is 97,480, but from <strong>1-1-2011</strong> it is <strong>843,345</strong>.</p><p>The filtering is <a class="indexterm" id="id89"/>done in <a class="indexterm" id="id90"/>codeunits Sales Price Calc. Mgt. (7000) and Purch. Price Calc. Mgt. (7010). We'll discuss this structure in <a class="link" href="ch02.html" title="Chapter 2. A Sample Application">Chapter 2</a>, <em>A Sample Application</em>, where we will also create such a structure for our own application.</p></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec24"/>Dimensions</h2></div></div></div><p>Throughout the application, an<a class="indexterm" id="id91"/> unlimited number of <a class="indexterm" id="id92"/>dimensions can be used to analyze the data. These dimensions are inherited from master data tables.</p><div><img alt="Dimensions" src="img/0365EN_01_13.jpg"/></div><p>The application has<a class="indexterm" id="id93"/> two global dimensions that are directly posted<a class="indexterm" id="id94"/> into each transaction. Six other dimensions can be defined as shortcut dimensions to be directly used in journals and documents. An unlimited number of additional dimensions can be added but need to be accessed with additional effort.</p><div><img alt="Dimensions" src="img/0365EN_01_14.jpg"/></div><p>The preceding screenshot shows how Global and Shortcut Dimensions can be used in a <strong>Sales Document</strong>.</p><p>Microsoft Dynamics NAV <a class="indexterm" id="id95"/>has built in OLAP possibilities. It <a class="indexterm" id="id96"/>allows us to create cubes to be analyzed within the application or in SQL Server analysis services.</p><div><img alt="Dimensions" src="img/0365EN_01_15.jpg"/></div><p>Although the cubes can be updated real time during posting, it is highly recommended to update them periodically in a batch. Also, the number of dimensions has an impact on the performance of the system.</p><p>Dimensions were redesigned in Microsoft Dynamics NAV 2013. The redesign has a huge impact on application performance and can reduce database size up to 30 percent.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec18"/>Architectural design patterns</h1></div></div></div><p>Microsoft Dynamics NAV <a class="indexterm" id="id97"/>has <a class="indexterm" id="id98"/>some specific architectural design patterns principles that are very important to understand before you can create your own structure. The building blocks are layered and reused and rely on each other in order to secure data integrity.</p><div><div><div><div><h2 class="title"><a id="ch01lvl2sec25"/>Master data</h2></div></div></div><p>The data model <a class="indexterm" id="id99"/>starts with master data. There are three types or levels of master data. They are all used in transactions. We differentiate supplemental, normal, and subsidiary master data.</p><p>Examples of supplemental<a class="indexterm" id="id100"/> data are currencies, locations, and payment terms. They often do not use a number series but allow us to create our own unique codes.</p><p>Examples of master data are <a class="indexterm" id="id101"/>G/L Accounts, customers, vendors, items, resources, and fixed assets. They are numbered using number series and have their own journal structure.</p><p>An example of a supplemental table is the item vendor table.</p></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec26"/>Journals</h2></div></div></div><p>Every<a class="indexterm" id="id102"/> transaction<a class="indexterm" id="id103"/> starts with a journal. Each journal can contain a number of sub-transactions that are treated by the system as one. This way the system is able to check, for example, whether the integrity of the system is maintained after the transaction is completed.</p><p>The following diagram shows how a journal is structured. <strong>PK</strong> means<a class="indexterm" id="id104"/> <strong>Primary Key</strong>, which is the unique identifier of the table:</p><div><img alt="Journals" src="img/0365EN_01_16.jpg"/></div><p>Every journal<a class="indexterm" id="id105"/> can contain one or more templates with one or<a class="indexterm" id="id106"/> more batches, allowing multiple users to have multiple templates and batches. A journal line has a source number field that refers to, for example, the G/L Account number or the item number we are changing. When we post the journal, the changes are stored in the entry table and all the lines. For the journal, a register is maintained allowing auditors to check if the transactions are consistent.</p></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec27"/>The general ledger</h2></div></div></div><p>To <a class="indexterm" id="id107"/>see how this <a class="indexterm" id="id108"/>works in the application, we can go to the <strong>Chart of Accounts</strong> and the <strong>General Journals</strong>, as shown in the following screenshot:</p><div><img alt="The general ledger" src="img/0365EN_01_17.jpg"/></div><p>If we<a class="indexterm" id="id109"/> select <strong>G/L Account 1140</strong> and drill down, we <a class="indexterm" id="id110"/>will see the details of this record.</p><p>These are created through journals, so let's open a journal:</p><div><img alt="The general ledger" src="img/0365EN_01_18.jpg"/></div><p>This journal contains<a class="indexterm" id="id111"/> two documents on the <a class="indexterm" id="id112"/>same posting date and the balance is zero. When we post this journal, the system will create the ledger entries and a register.</p><div><img alt="The general ledger" src="img/0365EN_01_19.jpg"/></div><p>This is the basic <a class="indexterm" id="id113"/>building block for Dynamics NAV. Everything <a class="indexterm" id="id114"/>in Dynamics NAV is built on top of a journal, registers, and entries.</p><div><img alt="The general ledger" src="img/0365EN_01_20.jpg"/></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec19"/>Balancing</h1></div></div></div><p>In any<a class="indexterm" id="id115"/> ERP system, totaling and balancing is crucial, and whether you are totaling the general ledger, customer payments, or inventory, it is important to know the balance of each account, customer, or item.</p><p>Traditionally, this <a class="indexterm" id="id116"/>requires calculating these balances and deciding a place to store the totals and subtotals. In Dynamics NAV, the system has built-in technology that will handle balancing and totaling for you.</p><p>This built-in technology is called <a class="indexterm" id="id117"/>
<strong>Sum Index Field Technology</strong> (<strong>SIFT</strong>). For Dynamics NAV, it is the key feature to its success.</p><p>The way it works is that, as a developer, you define your totaling on an index level. By associating the totaling fields with a key, the system knows that it has to maintain the totals for you.</p><p>In the original proprietary database, this technique was built in and invisible for the user, but in the SQL Server database, we can see how this works.</p><p>If we go in the CRONUS database and open the <strong>G/L Entry</strong> table with its keys, we see this information, as shown in the following screenshot:</p><div><img alt="Balancing" src="img/0365EN_01_21.jpg"/></div><p>Let's take key number two as an example. The key contains the fields G/L Account number and posting date. If we take a closer look at the <strong>SumIndexFields</strong> column, we see the following fields listed:</p><div><img alt="Balancing" src="img/0365EN_01_22.jpg"/></div><p>Notice that these are <a class="indexterm" id="id118"/>all fields of type decimal. This is mandatory for <code class="literal">SumIndexfields</code>.</p><div><div><h3 class="title"><a id="tip03"/>Tip</h3><p>From the SQL Server Management studio, you can see the generated data from the <code class="literal">SumIndexField</code> definition. Each key with <code class="literal">SumIndexField</code> generates a view in the database. In older versions (prior to 5 SP 1), the <code class="literal">SumIndexFields</code> are saved in tables.</p></div></div><p>So, now we know <a class="indexterm" id="id119"/>that we do not have to worry about maintaining the totals, we can spend our time on what's really important.</p></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec20"/>Flow fields and flow filters</h1></div></div></div><p>As<a class="indexterm" id="id120"/> discussed earlier, screens <a class="indexterm" id="id121"/>in Microsoft Dynamics NAV are built<a class="indexterm" id="id122"/> directly on one<a class="indexterm" id="id123"/> table. These table definitions contain all fields including the totals. However, these totals are not real database fields.</p><p>This can be <a class="indexterm" id="id124"/>illustrated <a class="indexterm" id="id125"/>by comparing the table definition in Microsoft Dynamics NAV to the table definition in SQL Server:</p><div><img alt="Flow fields and flow filters" src="img/0365EN_01_23.jpg"/></div><p>The <a class="indexterm" id="id126"/>fields <strong>Date Filter (28)</strong> to <strong>Budgeted Amount (33)</strong> are not actual fields in the database. They are helper fields to show data on screen.</p><p>Flow filters<a class="indexterm" id="id127"/> can have seven types; Sum, Average, Exist, Count, Min, Max, and Lookup and contain a query to the database. For example, Balance at Date (31) shows the following:</p><div><pre class="programlisting">Sum("G/L Entry".Amount 
  WHERE (G/L Account No.=FIELD(No.),
         G/L Account No.=FIELD(FILTER(Totaling)),
         Business Unit Code=FIELD(Business Unit Filter),
         Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
         Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
         Posting Date=FIELD(UPPERLIMIT(Date Filter))))</pre></div><p>This creates the sum of the field amount in the G/L Entry table (17) filtering on <strong>G/L Account</strong>, <strong>G/L Account No.</strong>, <strong>Business Unit Code</strong>, <strong>Global Dimension 1 &amp; 2 Code</strong>, and <strong>Posting Date</strong>.</p><p>Some of <a class="indexterm" id="id128"/>these filters<a class="indexterm" id="id129"/> are <a class="indexterm" id="id130"/>actual fields in the G/L Account table, but others are flow filters. Non-existing fields can be used as a runtime filter to <a class="indexterm" id="id131"/>limit the results of the query.</p><p>We will use and discuss more of these flow filters and flow fields later in this book.</p></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec21"/>More journals and entries</h1></div></div></div><p>So now that <a class="indexterm" id="id132"/>we know how a journal works, it might be interesting to build a posting diagram of Dynamics NAV. Dynamics NAV has a number of journals, registers, and entries built on top of each other.</p><p>The following table shows the <a class="indexterm" id="id133"/>most important journals, registers, and <a class="indexterm" id="id134"/>entries:</p><div><table border="1"><colgroup><col style="text-align: left"/><col style="text-align: left"/><col style="text-align: left"/></colgroup><thead><tr><th style="text-align: left" valign="bottom">
<p>Journals</p>
</th><th style="text-align: left" valign="bottom">
<p>Registers</p>
</th><th style="text-align: left" valign="bottom">
<p>Entries</p>
</th></tr></thead><tbody><tr><td style="text-align: left" valign="top">
<p>Gen. Journal Line (81)</p>
<p>Item Journal Line (83)</p>
<p>Res. Journal Line (207)</p>
<p>Job Journal Line (210)</p>
</td><td style="text-align: left" valign="top">
<p>G/L Register (45)</p>
<p>Item Register (46)</p>
<p>Resource Register (240)</p>
<p>Job Register (241)</p>
</td><td style="text-align: left" valign="top">
<p>G/L Entry (17)</p>
<p>Cust. Ledger Entry (21)</p>
<p>Vendor Ledger Entry (25)</p>
<p>Item Ledger Entry (32)</p>
<p>Job Ledger Entry (169)</p>
<p>Res. Ledger Entry (203)</p>
<p>VAT Entry (254)</p>
<p>Bank Account Ledger Entry (271)</p>
</td></tr></tbody></table></div><p>Please notice that when you look in the database, you'll find more of these tables, but these are the main building blocks.</p><p>Each journal is responsible for creating its own entries but may run another journal if that is required. For example, an Item Journal<a class="indexterm" id="id135"/> may generate G/L entries if required using a General Journal and a Job Journal may create Item Ledger Entries using the Item Journal.</p><p>We already discussed the <a class="indexterm" id="id136"/>G/L Entry table, which is used to store the basic financial information. This is the basic administration table.</p><p>The other entry tables are sub ledger tables. They store redundant information but have extra information for their specific use. A total of a sub ledger should always balance with the G/L. We'll see how that works in <a class="link" href="ch03.html" title="Chapter 3. Financial Management">Chapter 3</a>, <em>Financial Management</em>. Here are some more tables:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The Customer and Vendor Ledger Entry tables<a class="indexterm" id="id137"/> are used to store specific information about the accounts receivables. They are linked to Customer and Vendor master data tables.</li><li class="listitem" style="list-style-type: disc">The VAT Entry table<a class="indexterm" id="id138"/> stores specific information to make registration easier. Most companies do monthly or quarterly VAT registrations with one or more governmental agencies. VAT is different in many countries and could be different from what this book describes in localized country systems.</li><li class="listitem" style="list-style-type: disc">The bank account entries should show exactly what transactions we do on our bank accounts.</li></ul></div><p>The logistical part of the ERP package is handled by the Item Journal. Every item that is purchased, produced, or sold is handled though this journal. Services are handled through the Resource Journal. A resource can either be a person or a piece of equipment like a lift.</p><p>The Job Journal<a class="indexterm" id="id139"/> is an umbrella overlaying the entire application. It allows you to group transactions making it easier to analyze cost and profit for larger projects.</p><div><div><div><div><h2 class="title"><a id="ch01lvl2sec28"/>Posting schema</h2></div></div></div><p>When we combine<a class="indexterm" id="id140"/> all this information in a schema, we can create the following basic Microsoft Dynamics NAV posting schema:</p><div><img alt="Posting schema" src="img/0365EN_01_24.jpg"/></div><p>Here you can clearly<a class="indexterm" id="id141"/> see which journal is responsible for creating what entry. An entry table is always maintained by one process.</p><p>The <strong>General Journal</strong>
<a class="indexterm" id="id142"/> is the heart of the application where the basic financial information is created in the ledger entries. All the basic information is in the G/L Entry table which is grouped<a class="indexterm" id="id143"/> in the G/L Register, which is then always balanced. The<a class="indexterm" id="id144"/> <strong>Customer</strong>, <strong>Vendor</strong>, <strong>VAT</strong>, and <a class="indexterm" id="id145"/>
<strong>Bank Account Ledger</strong> entries<a class="indexterm" id="id146"/> are sub tables that always refer to a G/L register. We can never create one of these entries without touching this part of the application.</p></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec29"/>Sub and detailed entries</h2></div></div></div><p>When an entry<a class="indexterm" id="id147"/> is created, its basic structure should not be changed for audit ability. This is why most entries in Microsoft Dynamics NAV have sub or detailed entries.</p><p>The <strong>Customer</strong> and <strong>Vendor Ledger Entry</strong> <a class="indexterm" id="id148"/>have details for application, unrealized loss and gain, various discounts, and corrections. This way, we are able to keep track of what happens with an entry without changing the original information.</p><div><img alt="Sub and detailed entries" src="img/0365EN_01_25.jpg"/></div><p>The Item Ledger Entries<a class="indexterm" id="id149"/> have a wide variety of sub entries depending on what you are doing with the items.</p><p>One of the most <a class="indexterm" id="id150"/>important tables in Microsoft Dynamics NAV is the Value Entry table. Each Item Ledger Entry has one or more of these. This table is the soft bridge between the inventory and the financial part of the application.</p><p>Warehouse entries enable moving items within our organization without touching the basic inventory or financial application.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec22"/>Combining the journals into processes</h1></div></div></div><p>The journal <a class="indexterm" id="id151"/>and entry tables make it possible for us to do the basic balancing in our company but people in companies are not used to working with journals.</p><p>Traditionally, companies work with documents. This was also the case before ERP applications were introduced. A sales representative would travel through the country with a paper order block and then come back to the back office. The back office then ships the orders with shipping documents and invoices.</p><p>Microsoft Dynamics NAV supports working with documents. Traditionally, we divide the documents in sales and purchasing documents but the later versions of Microsoft Dynamics NAV also have warehouse documents. Other supported documents are reminders and service documents.</p><div><div><div><div><h2 class="title"><a id="ch01lvl2sec30"/>Document structure</h2></div></div></div><p>A <a class="indexterm" id="id152"/>document in Microsoft Dynamics NAV always has a header and lines. The header contains the basic information about the transaction, such as shipment dates, addresses, and payment terms.</p><p>The lines contain information about what is sold or purchased. This can be a variety of G/L Accounts, items, and resources.</p><p>A document can have different stages depending on the type of the transaction. A quote is a typical starting point in the sales or purchasing process. When a quote is approved, it can be promoted to an order, which is then shipped and invoiced. The process can be also reversed via a return order resulting in a credit memo.</p><div><img alt="Document structure" src="img/0365EN_01_26.jpg"/></div></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec31"/>Document transactions</h2></div></div></div><p>Transactions in the <a class="indexterm" id="id153"/>database can be started via documents. When a document is processed, the necessary journals are automatically populated. For example, when an order is shipped, the goods leave the warehouse, then an Item Journal is created and posted to handle this. When the invoice is posted, a General Journal is generated to create G/L Entries and a Customer or Vendor Ledger Entries.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec23"/>Other patterns</h1></div></div></div><p>The previously discussed pattern with journals and documents is by far the most important transaction structure. But Microsoft Dynamics NAV also has other structures as well.</p><p>The three most important other patterns are CRM, jobs, and manufacturing. These areas are all umbrella structures for other processes.</p><div><div><div><div><h2 class="title"><a id="ch01lvl2sec32"/>Relationship management</h2></div></div></div><p>Microsoft Dynamics NAV RM helps <a class="indexterm" id="id154"/>you to maintain master data and analyze transactional data. It is both at the very start of the data process and at the end.</p><p>We have already seen the customer, vendor, and bank master data records. But what if a vendor is also a customer, or vice versa. We don't want to maintain the same data twice. We might also want to keep extra information such as contact persons and the interests of our customers and vendors. We'll see more of that in <a class="link" href="ch04.html" title="Chapter 4. Relationship Management">Chapter 4</a>, <em>Relationship Management</em>.</p><p>There is also a need to analyze the data we have created with the document and journal structure.</p><div><img alt="Relationship management" src="img/0365EN_01_27.jpg"/></div></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec33"/>Jobs</h2></div></div></div><p>Sometimes, a project can be more comprehensive than just a purchase and/or a sales document. A project can take from several weeks to over a year and requires multiple documents.</p><p>The job structure in Dynamics NAV allows you to handle this. Every document and journal transaction can be attached to a job, making it easy to analyze profit and loss and even schedule your jobs.</p><p>The jobs module<a class="indexterm" id="id155"/> also allows you to do a calculation before you start the project and balance this calculation throughout the process.</p><div><img alt="Jobs" src="img/0365EN_01_28.jpg"/></div></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec34"/>Manufacturing</h2></div></div></div><p>When <a class="indexterm" id="id156"/>you produce your own items, you have different needs in your ERP process than when you only purchase the items you sell.</p><p>The manufacturing module of Microsoft Dynamics NAV allows you to handle this process. Basically what it does is create an item out of one or more other items and resources.</p><div><img alt="Manufacturing" src="img/0365EN_01_29.jpg"/></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec24"/>Summary</h1></div></div></div><p>In this chapter, we have covered the basic structure of Microsoft Dynamics NAV. We talked about the design philosophy, application objects, and the unique table structure. We discussed the Role Tailored Concept and its reflection to older versions of the product. We talked about some basic functions of the product-like number series and application setup. We also talked about the important basic posting structure and the way SIFT works. We discussed how the document structure overlays the journal structure and how the umbrella structure is on top of that.</p><p>In the next chapter, we will look at a sample industry application and its effect on the standard functionality.</p></div></body></html>