<html><head></head><body>
  <div><h1 class="chapterNumber">15</h1>
    <h1 class="chapterTitle" id="_idParaDest-545">Building Web Components Using Blazor</h1>
    <p class="normal">This chapter is about building web components using Blazor. These can be rich and interactive user interfaces that render as HTML and CSS to provide cross-platform browser support.</p>
    <p class="normal">There are many advantages to using .NET for client-side web development. You can write 99% of your code using C# instead of JavaScript and interop with JavaScript modules for the other 1%. You can share business logic between the server and the client. Blazor implements .NET Standard as well as the latest .NET 8 libraries, so you can use the extensive older .NET libraries, both from Microsoft and third parties.</p>
    <p class="normal">In the previous edition of this book, this chapter covered <strong class="keyWord">Blazor WebAssembly</strong>, a hosting model where the entire Blazor app and the .NET runtime were downloaded to the browser and executed there. One of the problems with Blazor WebAssembly is a slow initial startup experience for the visitor because a lot needs to be downloaded and executed on the client.</p>
    <p class="normal">Many .NET developers were frustrated with having to choose between different technologies to build web apps, because none of them are perfect and all have pros and cons.</p>
    <p class="normal">In this edition of the book, this chapter covers the new unified Blazor Full Stack model introduced with .NET 8. This enables you to mix the best of all worlds in a single project, including the following:</p>
    <ul>
      <li class="bulletList">Blazor components that execute on the client-side using WebAssembly. This replaces what is possible with a Blazor WebAssembly project.</li>
      <li class="bulletList">Blazor components that execute on the server-side and communicate live with the <strong class="keyWord">Document Object Model</strong> (<strong class="keyWord">DOM</strong>) in the browser, using SignalR to perform updates. This replaces what is possible with a Blazor Server project.</li>
      <li class="bulletList">Blazor components that provide <strong class="keyWord">static server rendering</strong> (<strong class="keyWord">SSR</strong>) and return an HTTP response, with static content that does not interact live with the server. This replaces what is possible with Razor Pages or Razor Views used in traditional ASP.NET Core websites.</li>
      <li class="bulletList">Blazor components that provide server-side streaming so that some content is shown to the visitor as soon as possible, while the rest streams to the browser in the background. This is a brand-new feature.</li>
      <li class="bulletList">A future release will enable Blazor to execute in any .NET process, like a console app, so that it can be used as a <strong class="keyWord">static site generator</strong> (<strong class="keyWord">SSG</strong>).</li>
    </ul>
    <p class="normal">This chapter will cover the following topics:</p>
    <ul>
      <li class="bulletList">Understanding Blazor</li>
      <li class="bulletList">Building Blazor components</li>
      <li class="bulletList">Building a Blazor data component</li>
      <li class="bulletList">Implementing caching using local storage</li>
    </ul>
    <h1 class="heading-1" id="_idParaDest-546">Understanding Blazor</h1>
    <p class="normal">Blazor is Microsoft’s <a id="_idIndexMarker1612"/>framework for web component development built on .NET.</p>
    <h2 class="heading-2" id="_idParaDest-547">Blazor hosting models</h2>
    <p class="normal">Blazor has multiple hosting models to <a id="_idIndexMarker1613"/>choose from:</p>
    <ul>
      <li class="bulletList"><strong class="keyWord">Blazor Server</strong>: All the components execute on the web server and user interface updates are sent to the <a id="_idIndexMarker1614"/>browser using SignalR. The nature of Blazor Server provides some key benefits, including complete .NET API<a id="_idIndexMarker1615"/> support, direct access to all server-side resources like databases, fast initial load time, and your code is protected because it never leaves the server. This hosting model was introduced with .NET Core 3.0 in November 2019.</li>
      <li class="bulletList"><strong class="keyWord">Blazor WebAssembly</strong>: All the components <a id="_idIndexMarker1616"/>execute in the web browser like other <strong class="keyWord">single page application </strong>(<strong class="keyWord">SPA</strong>) frameworks, for<a id="_idIndexMarker1617"/> example, React and Angular. Your .NET assemblies and the .NET runtime are downloaded to the browser and cached for future use. The nature of Blazor WebAssembly provides some key <a id="_idIndexMarker1618"/>benefits, including the ability to run the app offline when not connected to the network, to host the app on a static website or serve it from a <strong class="keyWord">content delivery network</strong> (<strong class="keyWord">CDN</strong>), and to <a id="_idIndexMarker1619"/>offload processing to the client, which increases scalability. This hosting model was introduced as an extension to .NET Core 3.1 in May 2020 and was built-in with .NET 5 in November 2020.</li>
      <li class="bulletList"><strong class="keyWord">Blazor Hybrid/.NET MAUI Blazor App</strong>: All the <a id="_idIndexMarker1620"/>components execute in a local web view <a id="_idIndexMarker1621"/>hosted in a native client app. The app can be built using .NET MAUI if the app needs<a id="_idIndexMarker1622"/> to be cross-platform, or using Windows Presentation Foundation or Windows Forms if you are only targeting Windows. The main benefit of Blazor Hybrid compared to the first two hosting models is access to native client capabilities that can provide a better user experience. This hosting model was introduced with .NET 7 in November 2022.</li>
      <li class="bulletList"><strong class="keyWord">Blazor Full Stack</strong>: Components can <a id="_idIndexMarker1623"/>execute on the server and <a id="_idIndexMarker1624"/>generate static markup, but each individual component can be switched to any of the following: streaming rendering, interactive server-side with live updates of the COM using SignalR, or interactive client-side with WebAssembly. This new hosting model was formerly known as Blazor United during .NET 8 previews. It was introduced as Blazor Full Stack with .NET 8 in November 2023. In future versions, I expect it to be simply known as Blazor.</li>
    </ul>
    <div><p class="normal"><strong class="keyWord">Good Practice</strong>: For new projects, <strong class="screenText">Blazor Web App</strong> should be your choice of project template. If you need a pure SPA project that can be hosted on Azure Static Web Apps or a CDN, then <strong class="screenText">Blazor WebAssembly</strong> <strong class="screenText">Standalone App</strong> will be your best choice because Blazor Web App requires a web server. For static websites, Blazor WebAssembly is still the right solution rather than the new Blazor Full Stack.</p>
    </div>
    <p class="normal">Instead of multiple <em class="italic">hosting models</em>, Blazor Full Stack has multiple equivalent <em class="italic">rendering modes</em>. The Blazor Server project template that hosted and executed its code on the server-side is now replaced by the <em class="italic">interactive server rendering mode</em>. The Blazor WebAssembly project templates that could be hosted even on a static website and execute their code on the client-side can now be replaced by the <em class="italic">interactive WebAssembly rendering mode</em>.</p>
    <p class="normal">Blazor supports the latest version of all four major web browsers – Chrome, Firefox, Edge, and Safari, on mobile and desktop platforms. Blazor Hybrid supports the latest web view components on the<a id="_idIndexMarker1625"/> three major platforms – Chrome on Android, Safari on iOS and macOS, and Edge WebView2 on Windows.</p>
    <div><p class="normal"><strong class="keyWord">More Information</strong>: The official Blazor documentation has a useful table to help you choose between the hosting models. You can find it at the following link: <a href="https://learn.microsoft.com/en-us/aspnet/core/blazor/hosting-models#which-blazor-hosting-model-should-i-choose">https://learn.microsoft.com/en-us/aspnet/core/blazor/hosting-models#which-blazor-hosting-model-should-i-choose</a>.</p>
    </div>
    <h2 class="heading-2" id="_idParaDest-548">Blazor components</h2>
    <p class="normal">Blazor is all about <strong class="keyWord">components</strong>. A component is a part of a web app, like a button, a grid, a form for gathering input<a id="_idIndexMarker1626"/> from the visitor, or even a whole page. Components can be reused and nested to build more complex components.</p>
    <p class="normal">A Blazor component usually consists of a Razor file with the file extension <code class="inlineCode">.razor</code>. Like Razor views in ASP.NET Core MVC or Razor Pages, Razor files used by Blazor components easily mix HTML and C# code. As well as the HTML elements that make up the user interface parts, and the<a id="_idIndexMarker1627"/> CSS used to style them, the Razor file also has a code block to implement event handling, properties, and other statements to provide the functionality of the component.</p>
    <p class="normal">For example, a Blazor component named <code class="inlineCode">ProgressBar.razor</code> could implement a progress bar using Bootstrap. It might define parameters for a minimum, maximum, and the current value of the progress bar, and have Boolean parameters to enable animation style and show the current value as text, as shown in the following markup:</p>
    <pre class="programlisting code"><code class="hljs-code">&lt;div class="progress"&gt;
  &lt;div class="progress-bar progress-bar-striped bg-info
              @(IsAnimated ? " progress-bar-animated" : "")"
       role="progressbar" aria-label="@LabelText" style="width: @Value%"
       aria-valuenow="@Value" aria-valuemin="@Minimum" aria-valuemax="@Maximum"&gt;
    @(ShowValue ? Value + "%" : "")
  &lt;/div&gt;
&lt;/div&gt;
@code {
  [Parameter]
  public int Value { get; set; } = 0;
  [Parameter]
  public int Minimum { get; set; } = 0;
  [Parameter]
  public int Maximum { get; set; } = 100;
  [Parameter]
  public bool IsAnimated { get; set; } = false;
  [Parameter]
  public bool ShowValue { get; set; } = false;
  [Parameter]
  public string? LabelText { get; set; } = "Progress bar";
}
</code></pre>
    <p class="normal">To embed an instance of the <a id="_idIndexMarker1628"/>component on a page, you use the component name as if it were an HTML element and set its parameters using HTML attributes, as shown in<a id="_idIndexMarker1629"/> the following markup:</p>
    <pre class="programlisting code"><code class="hljs-code">&lt;ProgressBar Value="25" IsAnimated="true" ShowValue="true" 
             LabelText="Progress of database deletion" /&gt;
</code></pre>
    <h2 class="heading-2" id="_idParaDest-549">Blazor routing to page components</h2>
    <p class="normal">The <code class="inlineCode">Router</code> component<a id="_idIndexMarker1630"/> in the <code class="inlineCode">App.razor</code> file enables routing to components, as shown in the following markup:</p>
    <pre class="programlisting code"><code class="hljs-code">&lt;Router AppAssembly="@typeof(Program).Assembly"&gt;
  &lt;Found Context="routeData"&gt;
    &lt;RouteView RouteData="@routeData" 
               DefaultLayout="@typeof(Layout.MainLayout)" /&gt;
    &lt;FocusOnNavigate RouteData="@routeData" Selector="h1" /&gt;
  &lt;/Found&gt;
&lt;/Router&gt;
</code></pre>
    <p class="normal">The <code class="inlineCode">Router</code> component scans the assembly specifically in its <code class="inlineCode">AppAssembly</code> parameter for components decorated with the <code class="inlineCode">[Route]</code> attribute, registering their URL paths.</p>
    <p class="normal">If a route match is found, then the context of the request is stored in a variable named <code class="inlineCode">routeData</code> and passed to the matching Razor file. The default layout is set to use a class defined in the file named <code class="inlineCode">MainLayout.razor</code>. </p>
    <p class="normal">The <code class="inlineCode">FocusOnNavigate</code> component has a <code class="inlineCode">Selector</code> property that must be set to a valid CSS selector. This could be a tag selector like the default <code class="inlineCode">h1</code>, or a more specific CSS selector that uses a CSS class or an ID. The setting is common across all components in your app, so you will <a id="_idIndexMarker1631"/>need to set one that works across all your components. In the Razor file, the focus is set to the first <code class="inlineCode">&lt;h1&gt;</code> element. If the Razor file contains a form, then you might want to set the first form input element like a text box to have the focus.</p>
    <p class="normal">For example, in a typical ASP.NET Core MVC project, an MVC controller could be decorated with the <code class="inlineCode">[Route]</code> attribute, as shown in the following code:</p>
    <pre class="programlisting code"><code class="hljs-code">[Route("customers")]
public class CustomersController
{
</code></pre>
    <p class="normal">An HTTP <code class="inlineCode">GET</code> request to the relative path <code class="inlineCode">/customers</code> would be matched to the route.</p>
    <p class="normal">To create an equivalent routable page component, add the <code class="inlineCode">@page</code> directive to the top of a component’s <code class="inlineCode">.razor</code> file, as shown in the following markup:</p>
    <pre class="programlisting code"><code class="hljs-code">@page "customers"
</code></pre>
    <p class="normal">A page component can have multiple <code class="inlineCode">@page</code> directives to register multiple routes.</p>
    <div><p class="normal">If you were to write code that uses reflection to find the <code class="inlineCode">component</code> class generated for you from the Razor markup file, then you would discover that it is decorated with the <code class="inlineCode">[Route]</code> attribute due to the <code class="inlineCode">@page</code> directive.</p>
    </div>
    <p class="normal">At runtime, the page component is merged with any specific layout that you have specified, just like an MVC view or Razor Page would be. By default, Blazor project templates define a file named <code class="inlineCode">MainLayout.razor</code> as the layout for page components.</p>
    <div><p class="normal"><strong class="keyWord">Good Practice</strong>: By convention, put routable page Blazor components in the <code class="inlineCode">Components\Pages</code> folder and non-page components in the <code class="inlineCode">Components</code> folder.</p>
    </div>
    <h2 class="heading-2" id="_idParaDest-550">How to pass route parameters</h2>
    <p class="normal">Blazor routes can include case-insensitive named parameters, and your code can most easily access the passed values <a id="_idIndexMarker1632"/>by binding the parameter to a property in the code block, using the <code class="inlineCode">[Parameter]</code> attribute, as shown in the following markup:</p>
    <pre class="programlisting code"><code class="hljs-code">@page "/employees/{country}"
&lt;div&gt;Country parameter as the value: @Country&lt;/div&gt;
@code {
  [Parameter]
  public string Country { get; set; }
}
</code></pre>
    <p class="normal">The recommended way to handle a parameter that should have a default value when it is missing is to suffix the parameter in the route with <code class="inlineCode">?</code>, using the <code class="inlineCode">null</code> coalescing operator in the <code class="inlineCode">OnParametersSet</code> method, as shown highlighted in the following markup:</p>
    <pre class="programlisting code"><code class="hljs-code">@page "/employees/{country<strong class="hljs-slc">?</strong>}"
&lt;div&gt;Country parameter as the value: @Country&lt;/div&gt;
@code {
  [Parameter]
  public string<strong class="hljs-slc">?</strong> Country { get; set; }
<strong class="hljs-slc">  </strong><strong class="hljs-keyword-slc">protected</strong><strong class="hljs-function-slc"> </strong><strong class="hljs-keyword-slc">override</strong><strong class="hljs-function-slc"> </strong><strong class="hljs-keyword-slc">void</strong><strong class="hljs-function-slc"> </strong><strong class="hljs-title-slc">OnParametersSet</strong><strong class="hljs-function-slc">()</strong>
<strong class="hljs-slc">  {</strong>
<strong class="hljs-slc">    </strong><strong class="hljs-comment-slc">// if the automatically set property is null</strong>
<strong class="hljs-slc">    </strong><strong class="hljs-comment-slc">// set its value to USA</strong>
<strong class="hljs-slc">    Country = Country ?? "USA";</strong>
<strong class="hljs-slc">  }</strong>
}
</code></pre>
    <h2 class="heading-2" id="_idParaDest-551">Setting parameters from a query string</h2>
    <p class="normal">You can also set component <a id="_idIndexMarker1633"/>properties using parameters<a id="_idIndexMarker1634"/> from a query string, as shown in the following code:</p>
    <pre class="programlisting code"><code class="hljs-code">[Parameter]
[SupplyParameterFromQuery(Name = "country")]
public string? Country { get; set; }
</code></pre>
    <h2 class="heading-2" id="_idParaDest-552">Route constraints for parameters</h2>
    <p class="normal">Route constraints validate that the data type is correct for a passed parameter. If a potential request with a parameter value<a id="_idIndexMarker1635"/> violates the constraint, then a match for that route is not made, and other routes will be evaluated instead. If no routes match, then a <code class="inlineCode">404</code> status code is returned.</p>
    <p class="normal">If you do not set constraints, then any value is acceptable as a route match, but a data type conversion exception may result when the value is converted into the C# method’s expected data type. Some route constraint examples are shown in <em class="italic">Table 15.1</em>:</p>
    <table class="table-container" id="table001-11">
      <tbody>
        <tr>
          <td class="table-cell">
            <p class="normal"><strong class="keyWord">Constraint example</strong></p>
          </td>
          <td class="table-cell">
            <p class="normal"><strong class="keyWord">Description</strong></p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">{isanimated:bool}</code></p>
          </td>
          <td class="table-cell">
            <p class="normal">The <code class="inlineCode">IsAnimated</code> property must be set to a valid Boolean value, for example, <code class="inlineCode">TRUE</code> or <code class="inlineCode">true</code>.</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">{hiredate:datetime}</code></p>
          </td>
          <td class="table-cell">
            <p class="normal">The <code class="inlineCode">HireDate</code> property must be a valid date/time value.</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">{price:decimal}</code></p>
          </td>
          <td class="table-cell">
            <p class="normal">The <code class="inlineCode">UnitPrice</code> property must be a valid <code class="inlineCode">decimal</code> value.</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">{shipweight:double}</code></p>
          </td>
          <td class="table-cell">
            <p class="normal">The <code class="inlineCode">ShipWeight</code> property must be a valid <code class="inlineCode">double</code> value.</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">{shipwidth:float}</code></p>
          </td>
          <td class="table-cell">
            <p class="normal">The <code class="inlineCode">ShipWidth</code> property must be a valid <code class="inlineCode">float</code> value.</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">{orderid:guid}</code></p>
          </td>
          <td class="table-cell">
            <p class="normal">The <code class="inlineCode">OrderId</code> property must be a valid <code class="inlineCode">Guid</code> value.</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">{categoryid:int}</code></p>
          </td>
          <td class="table-cell">
            <p class="normal">The <code class="inlineCode">CategoryId</code> property must be a valid <code class="inlineCode">int</code> value.</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">{nanoseconds:long}</code></p>
          </td>
          <td class="table-cell">
            <p class="normal">The <code class="inlineCode">Nanoseconds</code> property must be a valid <code class="inlineCode">long</code> value.</p>
          </td>
        </tr>
      </tbody>
    </table>
    <p class="packt_figref">Table 15.1: Route constraint examples</p>
    <div><p class="normal"><strong class="keyWord">Good Practice</strong>: Route constraints assume invariant culture, so your URLs must not be localized. For example, always use invariant culture formats to pass date and time parameter values.</p>
    </div>
    <h2 class="heading-2" id="_idParaDest-553">Base component classes</h2>
    <p class="normal">The <code class="inlineCode">OnParametersSet</code> method is defined<a id="_idIndexMarker1636"/> by the base class that components inherit from by default, named <code class="inlineCode">ComponentBase</code>, as shown in the following code:</p>
    <pre class="programlisting code"><code class="hljs-code">using Microsoft.AspNetCore.Components;
public abstract class ComponentBase : IComponent, IHandleAfterRender, IHandleEvent
{
  // members not shown
}
</code></pre>
    <p class="normal"><code class="inlineCode">ComponentBase</code> has some useful methods that you can call and override, as shown in <em class="italic">Table 15.2</em>:</p>
    <table class="table-container" id="table002-8">
      <tbody>
        <tr>
          <td class="table-cell">
            <p class="normal"><strong class="keyWord">Method(s)</strong></p>
          </td>
          <td class="table-cell">
            <p class="normal"><strong class="keyWord">Description</strong></p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">InvokeAsync</code></p>
          </td>
          <td class="table-cell">
            <p class="normal">Call this method to execute a function on the associated renderer’s synchronization context. This avoids the requirement to write thread-synchronizing code when accessing shared resources. Multiple threads are not allowed to access the rendering process at the same time. The use of <code class="inlineCode">InvokeAsync</code> means that only one thread will access components at any given moment, which eliminates the need to write thread-locking and synchronization code for shared state.</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">OnAfterRender</code>, </p>
            <p class="normal"><code class="inlineCode">OnAfterRenderAsync</code></p>
          </td>
          <td class="table-cell">
            <p class="normal">Override these methods to invoke code each time the component has been rendered.</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">OnInitialized</code>, </p>
            <p class="normal"><code class="inlineCode">OnInitializedAsync</code></p>
          </td>
          <td class="table-cell">
            <p class="normal">Override these methods to invoke code after the component has received its initial parameters from its parent in the render tree.</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">OnParametersSet</code>, </p>
            <p class="normal"><code class="inlineCode">OnParametersSetAsync</code></p>
          </td>
          <td class="table-cell">
            <p class="normal">Override these methods to invoke code after the component has received parameters and the values have been assigned to properties.</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">ShouldRender</code></p>
          </td>
          <td class="table-cell">
            <p class="normal">Override this method to indicate if the component should render.</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">StateHasChanged</code></p>
          </td>
          <td class="table-cell">
            <p class="normal">Call this method to cause the component to re-render.</p>
          </td>
        </tr>
      </tbody>
    </table>
    <p class="packt_figref">Table 15.2: Useful methods of ComponentBase</p>
    <h2 class="heading-2" id="_idParaDest-554">Blazor layouts</h2>
    <p class="normal">Blazor components can have shared layouts<a id="_idIndexMarker1637"/> in a similar way to MVC views and Razor Pages. You would create a <code class="inlineCode">.razor</code> component file and make it explicitly inherit from <code class="inlineCode">LayoutComponentBase</code>, as shown in the following markup:</p>
    <pre class="programlisting code"><code class="hljs-code">@inherits LayoutComponentBase
&lt;div&gt;
  ...
  @Body
  ...
&lt;/div&gt;
</code></pre>
    <p class="normal">The base class has a property named <code class="inlineCode">Body</code> that you can render in the markup at the correct place within the layout.</p>
    <p class="normal">You can set a default layout for components in the <code class="inlineCode">App.razor</code> file and its <code class="inlineCode">Router</code> component. To explicitly set a layout for a component, use the <code class="inlineCode">@layout</code> directive, as shown in the following markup:</p>
    <pre class="programlisting code"><code class="hljs-code">@page "/employees"
@layout AlternativeLayout
&lt;div&gt;
  ...
&lt;/div&gt;
</code></pre>
    <h2 class="heading-2" id="_idParaDest-555">How to navigate Blazor routes to page components</h2>
    <p class="normal">Microsoft provides a <a id="_idIndexMarker1638"/>dependency service named <code class="inlineCode">NavigationManager</code> that understands Blazor routing and the <code class="inlineCode">NavLink</code> component. The <code class="inlineCode">NavigateTo</code> method is used to go to the specified URL.</p>
    <p class="normal">In HTML, you use the <code class="inlineCode">&lt;a&gt;</code> element to define navigation links, as shown in the following markup:</p>
    <pre class="programlisting code"><code class="hljs-code">&lt;a href="/employees"&gt;Employees&lt;/a&gt;
</code></pre>
    <p class="normal">In Blazor, use the <code class="inlineCode">&lt;NavLink&gt;</code> component, as shown in the following markup:</p>
    <pre class="programlisting code"><code class="hljs-code">&lt;NavLink href="/employees"&gt;Employees&lt;/NavLink&gt;
</code></pre>
    <p class="normal">The <code class="inlineCode">NavLink</code> component is better than an anchor element because it automatically sets its class to <code class="inlineCode">active</code> if its <code class="inlineCode">href</code> is a match on the current location URL. If your CSS uses a different class name, then you can set the class name in the <code class="inlineCode">NavLink.ActiveClass</code> property.</p>
    <p class="normal">By default, in the matching algorithm, the <code class="inlineCode">href</code> is a path <em class="italic">prefix</em>, so if <code class="inlineCode">NavLink</code> has an <code class="inlineCode">href</code> of <code class="inlineCode">/employees</code>, as shown in the preceding code example, then it would match all the following paths and set<a id="_idIndexMarker1639"/> them all to have the <code class="inlineCode">active</code> class style:</p>
    <pre class="programlisting code"><code class="hljs-code">/employees
/employees/USA
/employees/UK/London
</code></pre>
    <p class="normal">To ensure that the matching algorithm only performs matches on <em class="italic">all</em> of the text in the path, (in other words, there is only a match when the whole complete text matches and not when just part of the path matches), then set the <code class="inlineCode">Match</code> parameter to <code class="inlineCode">NavLinkMatch.All</code>, as shown in the following code:</p>
    <pre class="programlisting code"><code class="hljs-code">&lt;NavLink href="/employees" Match="NavLinkMatch.All"&gt;Employees&lt;/NavLink&gt;
</code></pre>
    <p class="normal">If you set other attributes such as <code class="inlineCode">target</code>, they are passed through to the underlying <code class="inlineCode">&lt;a&gt;</code> element that is generated.</p>
    <h2 class="heading-2" id="_idParaDest-556">CSS and JavaScript isolation</h2>
    <p class="normal">Blazor components often need to provide<a id="_idIndexMarker1640"/> their own CSS to apply styling or JavaScript for activities that cannot be performed purely in C#, like access to browser APIs. To ensure this does not conflict with site-level CSS and JavaScript, Blazor supports CSS and JavaScript isolation. </p>
    <p class="normal">If you have a component named <code class="inlineCode">Home.razor</code>, simply create a CSS file named <code class="inlineCode">Home.razor.css</code>. The styles defined within this file will override any other styles in the project for this component, but not for the rest of the website.</p>
    <p class="normal">For JavaScript isolation, you do not use a naming convention in the same way as with CSS. Instead, Blazor enables JavaScript isolation using JavaScript modules, imported using the JavaScript interop feature of Blazor, as you will see later in this chapter.</p>
    <div><p class="normal">You can read more about JavaScript isolation at the following link: <a href="https://learn.microsoft.com/en-us/aspnet/core/blazor/javascript-interoperability/call-javascript-from-dotnet#javascript-isolation-in-javascript-modules">https://learn.microsoft.com/en-us/aspnet/core/blazor/javascript-interoperability/call-javascript-from-dotnet#javascript-isolation-in-javascript-modules</a>.</p>
    </div>
    <h1 class="heading-1" id="_idParaDest-557">Building Blazor components</h1>
    <p class="normal">With ASP.NET Core 8, Blazor<a id="_idIndexMarker1641"/> introduced a new project template to start a project that supports the most flexible hosting model and all rendering modes. It provides a basic template to run, and a <code class="inlineCode">Weather</code> component, which shows a table with five rows of random temperatures that uses streaming rendering.</p>
    <h2 class="heading-2" id="_idParaDest-558">Reviewing the new Blazor project template</h2>
    <p class="normal">First, we will create a Blazor Web App <a id="_idIndexMarker1642"/>project and review its important parts:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">Use your preferred code editor to create a new project and solution, using the Blazor Web App project template, as defined in the following list:<ul>
          <li class="bulletList">Project template: <strong class="screenText">Blazor Web App</strong> / <code class="inlineCode">blazor --interactivity None</code></li>
          <li class="bulletList">Project file and folder: <code class="inlineCode">Northwind.Blazor</code> </li>
          <li class="bulletList">Solution file and folder: <code class="inlineCode">Chapter15</code></li>
          <li class="bulletList"><strong class="screenText">Authentication type</strong>: None</li>
          <li class="bulletList"><strong class="screenText">Configure for HTTPS</strong>: Selected</li>
          <li class="bulletList"><strong class="screenText">Interactive render mode</strong>: None</li>
          <li class="bulletList"><strong class="screenText">Interactivity location</strong>: Per page/component</li>
          <li class="bulletList"><strong class="screenText">Include sample pages</strong>: Selected</li>
          <li class="bulletList"><strong class="screenText">Do not use top-level statements</strong>: Cleared</li>
        </ul>
      
    <div><p class="normal">If you are using Visual Studio Code or JetBrains Rider, then enter the following command at the command prompt or terminal in the <code class="inlineCode">Chapter15</code> folder: <code class="inlineCode">dotnet new blazor --interactivity None -o Northwind.Blazor</code>.</p>
    </div>
    <div><p class="normal"><strong class="keyWord">Good Practice</strong>: We have not selected the options to use interactive WebAssembly or server components so that we can build up your knowledge about how Blazor works step by step. In real-world projects, you are likely to want to select these options from the start. We have also selected sample pages, which you would likely want to clear in a real-world project.</p>
    </div></li>
    </ol>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="2">Build the <code class="inlineCode">Northwind.Blazor</code> project.</li>
      <li class="numberedList">In <code class="inlineCode">Northwind.Blazor.csproj</code>, note that it is identical to an ASP.NET Core project that uses the Web SDK and targets .NET 8.</li>
      <li class="numberedList">In the <code class="inlineCode">Northwind.Blazor</code> project, in <code class="inlineCode">Program.cs</code>, note that the statements enable the ASP.NET Core service collection and HTTP pipeline, with Blazor-specific statements to <a id="_idIndexMarker1643"/>add Razor components and then use them, as shown highlighted in the following code:
        <pre class="programlisting code"><code class="hljs-code">using Northwind.Blazor.Components;
var builder = WebApplication.CreateBuilder(args);
// Add services to the container.
<strong class="hljs-slc">builder.Services.AddRazorComponents();</strong>
var app = builder.Build();
// Configure the HTTP request pipeline.
if (!app.Environment.IsDevelopment())
{
  app.UseExceptionHandler("/Error", createScopeForErrors: true);
  // The default HSTS value is 30 days. You may want to change this for production scenarios, see https://aka.ms/aspnetcore-hsts.
  app.UseHsts();
}
app.UseHttpsRedirection();
app.UseStaticFiles();
app.UseAntiforgery();
<strong class="hljs-slc">app.MapRazorComponents&lt;App&gt;();</strong>
app.Run();
</code></pre>
      </li>
      <li class="numberedList">In the <code class="inlineCode">Northwind.Blazor</code> project, expand the <code class="inlineCode">Properties</code> folder, open the <code class="inlineCode">launchSettings.json</code> file, and for the <code class="inlineCode">applicationUrl</code> setting of <a id="_idIndexMarker1644"/>the <code class="inlineCode">https</code> profile, change the port numbers to <code class="inlineCode">5151</code> for <code class="inlineCode">https</code> and <code class="inlineCode">5152</code> for <code class="inlineCode">http</code>, as shown in the following setting:
        <pre class="programlisting code"><code class="hljs-code">"applicationUrl": "https://localhost:5151;http://localhost:5152",
</code></pre>
      </li>
      <li class="numberedList">Save the changes to the <code class="inlineCode">launchSettings.json</code> file.</li>
      <li class="numberedList">In the <code class="inlineCode">Northwind.Blazor</code> project, in the <code class="inlineCode">Components</code> folder, open <code class="inlineCode">App.razor</code>, as shown in the following markup:
        <pre class="programlisting code"><code class="hljs-code">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
  &lt;meta charset="utf-8" /&gt;
  &lt;meta name="viewport" content="width=device-width, initial-scale=1.0" /&gt;
  &lt;base href="/" /&gt;
  &lt;link rel="stylesheet" href="bootstrap/bootstrap.min.css" /&gt;
  &lt;link rel="stylesheet" href="app.css" /&gt;
  &lt;link rel="stylesheet" href="Northwind.Blazor.styles.css" /&gt;
  &lt;link rel="icon" type="image/png" href="favicon.png" /&gt;
  &lt;HeadOutlet /&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;Routes /&gt;
  &lt;script src="img/blazor.web.js"&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
      
    <p class="normal">Note the following:</p>
    <ul>
      <li class="bulletList">A <code class="inlineCode">&lt;HeadOutlet /&gt;</code> Blazor component to inject additional content into the <code class="inlineCode">&lt;head&gt;</code> section. This is one of the built-in components available in all Blazor projects.</li>
      <li class="bulletList">A <code class="inlineCode">&lt;Routes /&gt;</code> Blazor<a id="_idIndexMarker1645"/> component to define the custom routes in this project. This component can be completely customized by the developer because it is part of the current project, in a file named <code class="inlineCode">Routes.razor</code>.</li>
      <li class="bulletList">A script block for <code class="inlineCode">blazor.web.js</code> that manages communication back to the server for Blazor’s dynamic features, like downloading WebAssembly components in the background and later switching from server-side to client-side component execution.</li>
    </ul></li>
    </ol>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="8">In the <code class="inlineCode">Components</code> folder, in <code class="inlineCode">Routes.razor</code>, note that a <code class="inlineCode">&lt;Router&gt;</code> enables routing for all Blazor components found in the current assembly, and that if a matching route is found, then <code class="inlineCode">RouteView</code> is executed, which sets the default layout for the component to <code class="inlineCode">MainLayout</code> and passes any route data parameters to the component. For that component, the first <code class="inlineCode">&lt;h1&gt;</code> element in it will get the focus, as shown in the following code:
        <pre class="programlisting code"><code class="hljs-code">  &lt;Router AppAssembly="@typeof(Program).Assembly"&gt;
    &lt;Found Context="routeData"&gt;
      &lt;RouteView RouteData="@routeData" 
                 DefaultLayout="@typeof(Layout.MainLayout)" /&gt;
      &lt;FocusOnNavigate RouteData="@routeData" Selector="h1" /&gt;
    &lt;/Found&gt;
  &lt;/Router&gt;
</code></pre>
      </li>
      <li class="numberedList">In the <code class="inlineCode">Components</code> folder, in <code class="inlineCode">_Imports.razor</code>, note that this file imports some useful namespaces for use in all your custom Blazor components.</li>
      <li class="numberedList">In the <code class="inlineCode">Components\Layout</code> folder, note that <code class="inlineCode">MainLayout.razor</code> defines <code class="inlineCode">&lt;div&gt;</code> for a sidebar, containing a navigation menu that is implemented by the <code class="inlineCode">NavMenu.razor</code> component file in this project, and HTML5 elements like <code class="inlineCode">&lt;main&gt;</code> and <code class="inlineCode">&lt;article&gt;</code> for the content, as shown in the following markup:
        <pre class="programlisting code"><code class="hljs-code">@inherits LayoutComponentBase
&lt;div class="page"&gt;
  &lt;div class="sidebar"&gt;
    &lt;NavMenu /&gt;
  &lt;/div&gt;
  &lt;main&gt;
    &lt;div class="top-row px-4"&gt;
      &lt;a href="https://learn.microsoft.com/aspnet/core/" 
         target="_blank"&gt;About&lt;/a&gt;
    &lt;/div&gt;
    &lt;article class="content px-4"&gt;
        @Body
    &lt;/article&gt;
  &lt;/main&gt;
&lt;/div&gt;
</code></pre>
      </li>
      <li class="numberedList">In the <code class="inlineCode">Components\Layout</code> folder, open <code class="inlineCode">NavMenu.razor</code>, as shown in the following <a id="_idIndexMarker1646"/>markup:
        <pre class="programlisting code"><code class="hljs-code">&lt;div class="top-row ps-3 navbar navbar-dark"&gt;
  &lt;div class="container-fluid"&gt;
    &lt;a class="navbar-brand" href=""&gt;Northwind.Blazor&lt;/a&gt;
  &lt;/div&gt;
&lt;/div&gt;
&lt;input type="checkbox" title="Navigation menu" class="navbar-toggler" /&gt;
&lt;div class="nav-scrollable" 
     onclick="document.querySelector('.navbar-toggler').click()"&gt;
  &lt;nav class="flex-column"&gt;
    &lt;div class="nav-item px-3"&gt;
      &lt;NavLink class="nav-link" href="" Match="NavLinkMatch.All"&gt;
        &lt;span class="bi bi-house-door-fill-nav-menu" aria-hidden="true"&gt;&lt;/span&gt; Home
      &lt;/NavLink&gt;
    &lt;/div&gt;
    &lt;div class="nav-item px-3"&gt;
      &lt;NavLink class="nav-link" href="weather"&gt;
        &lt;span class="bi bi-list-nested-nav-menu" aria-hidden="true"&gt;
        &lt;/span&gt; Weather
      &lt;/NavLink&gt;
    &lt;/div&gt;
  &lt;/nav&gt;
&lt;/div&gt;
</code></pre>
      
    <p class="normal">Note the following:</p>
    <ul>
      <li class="bulletList">The <code class="inlineCode">NavMenu</code> component does not have a <code class="inlineCode">@page</code> directive because it does not use a shared layout or render as a page.</li>
      <li class="bulletList">It uses Bootstrap to provide a menu of choices that responsively adapts to the width of the viewport. It will collapse into a hamburger menu when there is not enough horizontal space, and then the visitor can toggle the navigation on and off.</li>
      <li class="bulletList">There are currently two menu items: <strong class="screenText">Home</strong> and <strong class="screenText">Weather</strong>. We will add more throughout this chapter.</li>
    </ul></li>
    </ol>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="12">In the <code class="inlineCode">Components\Pages</code> folder, in <code class="inlineCode">Home.razor</code>, note the <code class="inlineCode">@page</code> directive that configures a route for the root path to go to this page component, and then change the <a id="_idIndexMarker1647"/>heading from <code class="inlineCode">world</code> to <code class="inlineCode">Blazor Full Stack</code>, as shown highlighted in the following markup:
        <pre class="programlisting code"><code class="hljs-code">@page "/"
&lt;PageTitle&gt;Home&lt;/PageTitle&gt;
&lt;h1&gt;Hello, <strong class="hljs-slc">Blazor Full Stack</strong>!&lt;/h1&gt;
Welcome to your new app.
</code></pre>
      </li>
      <li class="numberedList">Start the <code class="inlineCode">Northwind.Blazor</code> project, using its <code class="inlineCode">https</code> profile without debugging:<ul>
          <li class="bulletList">If you are using Visual Studio 2022, then in <strong class="screenText">Solution Explorer</strong>, select the <code class="inlineCode">Northwind.Blazor</code> project to make it active. In the Visual Studio 2022 toolbar, select the <code class="inlineCode">https</code> profile as the <strong class="screenText">Startup Project</strong>, and <strong class="screenText">Google Chrome</strong> as the <strong class="screenText">Web Browser</strong>.</li>
          <li class="bulletList">If you are using Visual Studio Code, then at the command line or terminal, enter the following command:
            <pre class="programlisting con"><code class="hljs-con">dotnet run --launch-profile https
</code></pre>
          </li>
        </ul>
      </li>
      <li class="numberedList">In Chrome, note the left-side <a id="_idIndexMarker1648"/>navigation and the home page component, as shown in <em class="italic">Figure 15.1</em>:</li>
    </ol>
    <figure class="mediaobject"><img alt="" src="img/B19587_15_01.png"/></figure>
    <p class="packt_figref">Figure 15.1: A simple web page implemented as a Blazor page component</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="15">Finally, close the browser and shut down the web server.</li>
    </ol>
    <h2 class="heading-2" id="_idParaDest-559">Using Bootstrap icons</h2>
    <p class="normal">The older Blazor <a id="_idIndexMarker1649"/>project templates included all the Bootstrap icons. In the new project template, only three icons are defined using <strong class="keyWord">Scalable Vector Graphics</strong> (<strong class="keyWord">SVG</strong>). Let’s see how the team defined those icons, and then add some more for our own use:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">In the <code class="inlineCode">Components\Layout</code> folder, in the CSS stylesheet file named <code class="inlineCode">NavMenu.razor.css</code>, find the text <code class="inlineCode">bi-house</code>, and note the three icons defined using SVG, as partially shown in the following code:
        <pre class="programlisting code"><code class="hljs-code">.bi-house-door-fill-nav-menu {
    background-image: url("data:image/svg+xml,...");
}
.bi-plus-square-fill-nav-menu {
    background-image: url("data:image/svg+xml,...");
}
.bi-list-nested-nav-menu {
    background-image: url("data:image/svg+xml,...");
}
</code></pre>
      </li>
      <li class="numberedList">In your favorite browser, navigate to: <a href="https://icon-sets.iconify.design/bi/">https://icon-sets.iconify.design/bi/</a>, and note that <strong class="screenText">Bootstrap Icons</strong> have an MIT license and contain more than 2,000 icons.</li>
      <li class="numberedList">In the <strong class="screenText">Search Bootstrap Icons</strong> box, enter <code class="inlineCode">globe</code>, and note that six globe icons are found.</li>
      <li class="numberedList">Click the first globe, scroll down the page, and click the <strong class="screenText">SVG as data: URI</strong> button. Note that you could copy and paste the definition of this icon for use in the CSS stylesheet, but you do not need to because I have already created a CSS file for <a id="_idIndexMarker1650"/>you to use, with five icons defined for you to use in your Blazor project.</li>
      <li class="numberedList">In your favorite browser, navigate to: <a href="https://github.com/markjprice/apps-services-net8/blob/main/code/Chapter15/Northwind.Blazor/wwwroot/icons.css">https://github.com/markjprice/apps-services-net8/blob/main/code/Chapter15/Northwind.Blazor/wwwroot/icons.css</a>, download the file, and save it in your own project in its <code class="inlineCode">wwwroot</code> folder.</li>
      <li class="numberedList">In the <code class="inlineCode">Components</code> folder, in the <code class="inlineCode">App.razor</code> component, in the <code class="inlineCode">&lt;head&gt;</code>, add a <code class="inlineCode">&lt;link&gt;</code> element to reference the <code class="inlineCode">icons.css</code> stylesheet, as shown in the following markup:
        <pre class="programlisting code"><code class="hljs-code">&lt;link rel="stylesheet" href="icons.css" /&gt;
</code></pre>
      </li>
      <li class="numberedList">Save and close the file.</li>
    </ol>
    <h2 class="heading-2" id="_idParaDest-560">Referencing an EF Core class library and registering a data context</h2>
    <p class="normal">We will reference the EF Core<a id="_idIndexMarker1651"/> model that you created in <em class="chapterRef">Chapter 3</em>, <em class="italic">Building Entity Models for SQL Server Using EF Core</em>:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">In the <code class="inlineCode">Northwind.Blazor.csproj</code> project <a id="_idIndexMarker1652"/>file, treat warnings as errors, and add a project reference to the Northwind database context project, as shown in the following markup:
        <pre class="programlisting code"><code class="hljs-code">&lt;ItemGroup&gt;
  &lt;ProjectReference Include="..\..\Chapter03\Northwind.Common.DataContext
.SqlServer\Northwind.Common.DataContext.SqlServer.csproj" /&gt;
&lt;/ItemGroup&gt;
</code></pre>
      
    <div><p class="normal">The <code class="inlineCode">Include</code> path must not have a line break.</p>
    </div></li>
    </ol>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="2">At the command prompt or terminal, build the <code class="inlineCode">Northwind.Blazor</code> project using the <code class="inlineCode">dotnet build</code> command.</li>
      <li class="numberedList">In the <code class="inlineCode">Components</code> folder, in <code class="inlineCode">_Imports.razor</code>, import the namspaces to use asynchronous methods with EF Core and to with the Northwind <a id="_idIndexMarker1653"/>entity models, as<a id="_idIndexMarker1654"/> shown in the following code:
        <pre class="programlisting code"><code class="hljs-code">@using Microsoft.EntityFrameworkCore @* To use ToListAsync method. *@
@using Northwind.EntityModels @* To use NorthwindContext and so on. *@
</code></pre>
      
    <div><p class="normal">Importing the namespaces here means we do not have to import them at the top of <code class="inlineCode">.razor</code> files. The <code class="inlineCode">_Imports.razor</code> file only applies to <code class="inlineCode">.razor</code> files. If you use code-behind <code class="inlineCode">.cs</code> files to implement component code, then they must have namespaces imported separately, or use global usings to implicitly import the namespace. Note the statement to statically import the render mode type: <code class="inlineCode">@using static Microsoft.AspNetCore.Components.Web.RenderMode</code>.</p>
    </div></li>
    </ol>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="4">In <code class="inlineCode">Program.cs</code>, import the namespace to use the <code class="inlineCode">AddNorthwindContext</code> extension method, as shown in the following code:
        <pre class="programlisting code"><code class="hljs-code">using Northwind.EntityModels; // To use AddNorthwindContext method.
</code></pre>
      </li>
      <li class="numberedList">In the section that adds services to the container, add a statement that registers <code class="inlineCode">NorthwindContext</code> as a service, as shown in the following code:
        <pre class="programlisting code"><code class="hljs-code">builder.Services.AddNorthwindContext();
</code></pre>
      </li>
    </ol>
    <h2 class="heading-2" id="_idParaDest-561">Building a static server rendered component for data</h2>
    <p class="normal">Next, we will add a component<a id="_idIndexMarker1655"/> that can do the same job as a Razor Page or Razor View in a traditional ASP.NET Core website. It will not have any interactivity that requires the component to execute on the server or client.</p>
    <p class="normal">It will allow the visitor to see a table of products from the Northwind database:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">In the <code class="inlineCode">Components\Pages</code> folder, add a new file named <code class="inlineCode">Products.razor</code>. In Visual Studio 2022, the project item template is named <strong class="screenText">Razor Component</strong>. In JetBrains Rider, the project<a id="_idIndexMarker1656"/> item template is named <strong class="screenText">Blazor Component</strong>.
    <div><p class="normal"><strong class="keyWord">Good Practice</strong>: Component filenames must start with an uppercase letter, or you will have compile errors!</p>
    </div></li>
    </ol>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="2">In <code class="inlineCode">Products.razor</code>, set the route to <code class="inlineCode">/products</code>, inject a Northwind data context, define a table to render products, and write a code block to get the products when the page has initialized, as shown in the following markup:
        <pre class="programlisting code"><code class="hljs-code">@page "/products"
@inject NorthwindContext db
&lt;h1&gt;Products&lt;/h1&gt;
&lt;table class="table"&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Product ID&lt;/th&gt;
      &lt;th&gt;Product Name&lt;/th&gt;
      &lt;th&gt;Unit Price&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    @if ((products is null) || (products.Count == 0))
    {
      &lt;tr&gt;&lt;td colspan="4"&gt;No products found.&lt;/td&gt;&lt;/tr&gt;
    }
    else
    {
      @foreach (Product p in products)
      {
        &lt;tr&gt;
          &lt;td&gt;@p.ProductId&lt;/td&gt;
          &lt;td&gt;@p.ProductName&lt;/td&gt;
          &lt;td&gt;@(p.UnitPrice.HasValue ? 
            p.UnitPrice.Value.ToString("C") : "n/a")&lt;/td&gt;
        &lt;/tr&gt;
      }
    }
  &lt;/tbody&gt;
&lt;/table&gt;
@code {
  private List&lt;Product&gt;? products;
  protected override async Task OnInitializedAsync()
  {
    products = await db.Products.ToListAsync();
  }
}
</code></pre>
      </li>
      <li class="numberedList">In the <code class="inlineCode">Components\Layout</code> folder, in <code class="inlineCode">NavMenu.razor</code>, after the menu item to navigate to the home page, add a menu item to navigate to the products page, as shown in<a id="_idIndexMarker1657"/> the following markup:
        <pre class="programlisting code"><code class="hljs-code">&lt;div class="nav-item px-3"&gt;
  &lt;NavLink class="nav-link" href="products"&gt;
    &lt;span class="bi bi-globe" aria-hidden="true"&gt;&lt;/span&gt; Products
  &lt;/NavLink&gt;
&lt;/div&gt;
</code></pre>
      </li>
      <li class="numberedList">If your database server is not running, (for example, because you are hosting it in Docker, a virtual machine, or the cloud), then make sure to start it.</li>
      <li class="numberedList">Start the <code class="inlineCode">Northwind.Blazor</code> project, using its <code class="inlineCode">https</code> profile without debugging.</li>
      <li class="numberedList">In the left-side navigation, click <strong class="screenText">Products</strong>, and note the table of products.</li>
      <li class="numberedList">Close the browser and shut down the web server.</li>
    </ol>
    <h2 class="heading-2" id="_idParaDest-562">Building a component with server interactivity</h2>
    <p class="normal">Next, we will add a component that <a id="_idIndexMarker1658"/>requires some interactivity, so we will enable Blazer with SignalR to dynamically update the browser DOM live at runtime:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">In the <code class="inlineCode">Components</code> folder, add a new file named <code class="inlineCode">Counter.razor</code>.</li>
      <li class="numberedList">In <code class="inlineCode">Counter.razor</code>, define a label to render the current value of the counter number, and a button to increment it, and a code block to store the current counter value with a click event handler, to increment the number, as shown in the following<a id="_idIndexMarker1659"/> markup:
        <pre class="programlisting code"><code class="hljs-code">&lt;h3&gt;Counter: @CounterValue&lt;/h3&gt;
&lt;button id="buttonIncrement" @onclick="IncrementCounter"
  class="btn btn-outline-primary"&gt;Increment&lt;/button&gt;
@code {
  public int CounterValue { get; set; } = 0;
  public void IncrementCounter()
  {
    CounterValue++;
  }
}
</code></pre>
      
    <div><p class="normal">Note that this component will not act as a page, so we do not decorate it with the <code class="inlineCode">@page</code> directive or define a route to the component. It will only be used embedded in some other component.</p>
    </div></li>
    </ol>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="3">In the <code class="inlineCode">Components\Pages</code> folder, in <code class="inlineCode">Home.razor</code>, at the bottom of the page, render the counter component, as shown in the following markup:
        <pre class="programlisting code"><code class="hljs-code">&lt;Counter /&gt;
</code></pre>
      </li>
      <li class="numberedList">Start the <code class="inlineCode">Northwind.Blazor</code> project, using its <code class="inlineCode">https</code> profile without debugging.</li>
      <li class="numberedList">On the home page, click the button, and note that nothing happens. When you create a project using the Blazor Web App template with the <code class="inlineCode">--interactivity None</code> switch or the <strong class="screenText">Interactive render mode</strong> set to <strong class="screenText">None</strong>, no component interactivity is enabled in a Blazor Web App project.</li>
      <li class="numberedList">Close the browser and shut down the web server.</li>
      <li class="numberedList">In <code class="inlineCode">Program.cs</code>, at the end of the statement that adds Razor components, add a call to a method to add interactive server components, as shown highlighted in the following code:
        <pre class="programlisting code"><code class="hljs-code">builder.Services.AddRazorComponents()
<strong class="hljs-slc">  .AddInteractiveServerComponents();</strong>
</code></pre>
      </li>
      <li class="numberedList">In <code class="inlineCode">Program.cs</code>, at the end of the statement that maps Razor components, add a call to a method to <a id="_idIndexMarker1660"/>add interactive server render mode, as shown highlighted in the following code:
        <pre class="programlisting code"><code class="hljs-code">app.MapRazorComponents&lt;App&gt;()
<strong class="hljs-slc">  .AddInteractiveServerRenderMode();</strong>
</code></pre>
      </li>
      <li class="numberedList">In the <code class="inlineCode">Components</code> folder, in <code class="inlineCode">Counter.razor</code>, at the top of the file, add a directive to set render mode to interactive server, as shown in the following markup:
        <pre class="programlisting code"><code class="hljs-code">@rendermode InteractiveServer
</code></pre>
      </li>
      <li class="numberedList">Start the <code class="inlineCode">Northwind.Blazor</code> project, using its <code class="inlineCode">https</code> profile without debugging.</li>
      <li class="numberedList">In <strong class="screenText">Developer Tools</strong>, click the <strong class="screenText">Console</strong> tab, and note the <code class="inlineCode">blazor.web.js</code> files establishes a WebSocket connection, as shown in the following output:
        <pre class="programlisting con"><code class="hljs-con">[2023-10-20T11:25:52.498Z] Information: Normalizing '_blazor' to 'https://localhost:5151/_blazor'.
[2023-10-20T11:25:52.675Z] Information: WebSocket connected to wss://localhost:5151/_blazor?id=j6Fc0Mbay_jWkZTWfIqs_w.
</code></pre>
      </li>
      <li class="numberedList">In <strong class="screenText">Developer Tools</strong>, click the <strong class="screenText">Network</strong> tab, click <strong class="screenText">WS</strong> to filter by WebSockets, and refresh the home page.</li>
      <li class="numberedList">On the home page, click the <strong class="screenText">Increment</strong> button, note the counter increments, note the <strong class="screenText">_blazor?id=...</strong> request, select the request for <strong class="screenText">_blazor?id=...</strong>, and click the <strong class="screenText">Initiator</strong> tab, and note that the initiator was the <code class="inlineCode">blazor.web.js</code> file that is added to all pages by the <code class="inlineCode">App.razor</code> file, as shown in <em class="italic">Figure</em> <em class="italic">15.2</em>:</li>
    </ol>
    <figure class="mediaobject"><img alt="" src="img/B19587_15_02.png"/></figure>
    <p class="packt_figref">Figure 15.2: Blazor.web.js requests to SignalR on the server to update the DOM for live interactivity</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="14">Close the browser <a id="_idIndexMarker1661"/>and shut down the web server.</li>
    </ol>
    <h2 class="heading-2" id="_idParaDest-563">Building a Blazor progress bar component</h2>
    <p class="normal">In this section, we will build a<a id="_idIndexMarker1662"/> component to provide a progress bar. It will use Bootstrap classes to set a stripped light blue color, with options to animate the bar and show the current value of the progress as a percentage:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">In the <code class="inlineCode">Northwind.Blazor</code> project, in the <code class="inlineCode">Components</code> folder, add a new file named <code class="inlineCode">ProgressBar.razor</code>.</li>
      <li class="numberedList">In <code class="inlineCode">ProgressBar.razor</code>, add statements to render <code class="inlineCode">&lt;div&gt;</code> elements that use Bootstrap classes to define a progress bar with bindable parameters, setting various properties, as shown in the following markup:
        <pre class="programlisting code"><code class="hljs-code">@rendermode InteractiveServer
&lt;div class="progress"&gt;
  &lt;div class="progress-bar progress-bar-striped bg-info
              @(IsAnimated ? " progress-bar-animated" : "")"
       role="progressbar" aria-label="@LabelText" 
       style="width: @Value%" aria-valuenow="@Value" 
       aria-valuemin="@Minimum" aria-valuemax="@Maximum"&gt;
    @(ShowValue ? Value + "%" : "")
  &lt;/div&gt;
&lt;/div&gt;
@code {
  [Parameter]
  public int Value { get; set; } = 0;
  [Parameter]
  public int Minimum { get; set; } = 0;
  [Parameter]
  public int Maximum { get; set; } = 100;
  [Parameter]
  public bool IsAnimated { get; set; } = false;
  [Parameter]
  public bool ShowValue { get; set; } = false;
  [Parameter]
  public string? LabelText { get; set; } = "Progress bar";
}
</code></pre>
      </li>
      <li class="numberedList">In the <code class="inlineCode">Components\Pages</code> folder, in <code class="inlineCode">Home.razor</code>, at the bottom of the file, add statements to<a id="_idIndexMarker1663"/> define a Bootstrap row with two equal columns, and add a <code class="inlineCode">&lt;ProgressBar&gt;</code> component set to 25%, as shown in the following markup:
        <pre class="programlisting code"><code class="hljs-code">&lt;div class="row"&gt;
  &lt;div class="col"&gt;
    &lt;div class="alert alert-info"&gt;
      &lt;h4&gt;Progress of database deletion&lt;/h4&gt;
      &lt;ProgressBar Value="25" IsAnimated="true" ShowValue="true" 
                   LabelText="Progress of database deletion" /&gt;
    &lt;/div&gt;
  &lt;/div&gt;
  &lt;div class="col"&gt;
    More components coming soon.
  &lt;/div&gt;
&lt;/div&gt;
</code></pre>
      </li>
      <li class="numberedList">Start the <code class="inlineCode">Northind.Blazor</code> project, using its <code class="inlineCode">https</code> profile without debugging.</li>
      <li class="numberedList">Note the progress bar that shows the progress of the (simulated!) database deletion.</li>
      <li class="numberedList">Close the browser <a id="_idIndexMarker1664"/>and shut down the web server.</li>
    </ol>
    <h2 class="heading-2" id="_idParaDest-564">Building a Blazor dialog box component</h2>
    <p class="normal">In this section, we will build a<a id="_idIndexMarker1665"/> component to provide a popup dialog box for interaction with the website visitor. It will use Bootstrap classes to define a button that, when clicked, shows a dialog box with two buttons with configurable labels.</p>
    <p class="normal">By default, the Blazor Web App project template uses a local copy of Bootstrap 5.1 but only the CSS part. We will need to add a script tag to add the JavaScript parts of Bootstrap. We may as well upgrade to the latest version of Bootstrap and use the CDN version too.</p>
    <div><p class="normal">You can find the latest CDN links at the following link: <a href="https://getbootstrap.com/docs/5.3/getting-started/introduction/#cdn-links">https://getbootstrap.com/docs/5.3/getting-started/introduction/#cdn-links</a>.</p>
    </div>
    <p class="normal">The component will also define two event callbacks that can be handled by the parent to customize what code executes when the two buttons are clicked.</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">In <code class="inlineCode">App.razor</code>, comment out the <code class="inlineCode">&lt;link&gt;</code> to the local CSS file and add a reference to the latest CDN version, as shown highlighted in the following markup:
        <pre class="programlisting code"><code class="hljs-code"><strong class="hljs-slc">@*</strong>&lt;link rel="stylesheet" href="bootstrap/bootstrap.min.css" /&gt;<strong class="hljs-slc">*@</strong>
<strong class="hljs-slc">&lt;link rel="stylesheet" href="</strong><strong class="hljs-attribute-slc">https</strong><strong class="hljs-slc">://cdn.jsdelivr.net/npm/bootstrap@</strong><strong class="hljs-number-slc">5.3</strong><strong class="hljs-slc">.</strong><strong class="hljs-number-slc">2</strong><strong class="hljs-slc">/dist/css/bootstrap.min.css" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous"&gt;</strong>
</code></pre>
      </li>
      <li class="numberedList">In <code class="inlineCode">App.razor</code>, after the <code class="inlineCode">&lt;script&gt;</code> tag for Blazor, add a <code class="inlineCode">&lt;script&gt;</code> to the latest CDN version, and suppress error <code class="inlineCode">RZ/BL9992</code>, as shown in the following markup:
        <pre class="programlisting code"><code class="hljs-code">&lt;script src="img/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous" suppress-error="BL9992"&gt;&lt;/script&gt;
</code></pre>
      
    <div><p class="normal">We suppress the error BL9992 (also referred to as RZ9992), which warns that, “Script tags should not be placed inside components because they cannot be updated dynamically.” For more information, see <a href="https://aka.ms/AAe3qu3">https://aka.ms/AAe3qu3</a>.</p>
    </div></li>
    </ol>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="3">In the <code class="inlineCode">Northwind.Blazor</code> project, in the <code class="inlineCode">Components</code> folder, add a new file named <code class="inlineCode">DialogBox.razor</code>.</li>
      <li class="numberedList">In <code class="inlineCode">DialogBox.razor</code>, add statements to render <code class="inlineCode">&lt;div&gt;</code> elements that use Bootstrap classes <a id="_idIndexMarker1666"/>to define a button and modal dialog box with bindable parameters, setting various properties, as shown in the following markup:
        <pre class="programlisting code"><code class="hljs-code">@rendermode InteractiveServer
&lt;!-- Button to show the dialog box. --&gt;
&lt;button type="button" class="btn btn-primary" 
        data-bs-toggle="modal" data-bs-target="#dialogBox"&gt;
  @DialogTitle
&lt;/button&gt;
&lt;!-- Dialog box to popup. --&gt;
&lt;div class="modal fade" id="dialogBox"
     data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" 
     aria-labelledby="dialogBoxLabel" aria-hidden="true"&gt;
  &lt;div class="modal-dialog"&gt;
    &lt;div class="modal-content"&gt;
      &lt;div class="modal-header"&gt;
        &lt;h5 class="modal-title" id="dialogBoxLabel"&gt;@DialogTitle&lt;/h5&gt;
        &lt;button type="button" class="btn-close" 
                data-bs-dismiss="modal" aria-label="Close"&gt;&lt;/button&gt;
      &lt;/div&gt;
      &lt;div class="modal-body"&gt;
        @ChildContent
      &lt;/div&gt;
      &lt;div class="modal-footer"&gt;
        &lt;button type="button" class="btn btn-primary" 
                @onclick="OnClickPrimary"&gt;
            @PrimaryButtonText
        &lt;/button&gt;
        &lt;button type="button" class="btn btn-secondary" 
                data-bs-dismiss="modal" @onclick="OnClickSecondary"&gt;
            @SecondaryButtonText
        &lt;/button&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;
@code {
  [Parameter]
  public string? DialogTitle { get; set; }
  // ChildContent is a special name that is set automatically by any 
  // markup content within the component begin and end elements.
  [Parameter]
  public RenderFragment? ChildContent { get; set; }
  [Parameter]
  public string? PrimaryButtonText { get; set; } = "OK";
  [Parameter]
  public EventCallback&lt;MouseEventArgs&gt; OnClickPrimary { get; set; }
  [Parameter]
  public string? SecondaryButtonText { get; set; } = "Cancel";
  [Parameter]
  public EventCallback&lt;MouseEventArgs&gt; OnClickSecondary { get; set; }
}
</code></pre>
        <div><p class="normal">Note that the two buttons have default text values of <code class="inlineCode">OK</code> and <code class="inlineCode">Cancel</code>, and they both have event callback parameters that will have information about the mouse pointer passed as event arguments. Also, note the button with <code class="inlineCode">class="btn-close"</code> that visually appears as the <strong class="screenText">X</strong> button in the top-right corner to close the dialog.</p>
        </div>
      </li>
    </ol>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="5">In the <code class="inlineCode">Components\Pages</code> folder, in <code class="inlineCode">Home.razor</code>, at the top of the file, add statements to set render mode as the interactive server, as shown in the following markup:
        <pre class="programlisting code"><code class="hljs-code">@rendermode InteractiveServer
</code></pre>
      </li>
      <li class="numberedList">In the <code class="inlineCode">Components\Pages</code> folder, in <code class="inlineCode">Home.razor</code>, near the bottom of the file, replace the text <code class="inlineCode">More components coming soon</code> with statements to add a <code class="inlineCode">&lt;DialogBox&gt;</code> component that sets the two button labels to <code class="inlineCode">Yes</code> and <code class="inlineCode">No</code>, and then at the bottom of <a id="_idIndexMarker1667"/>the file, add a Razor code block to define event handlers for the two click events that output which button was clicked and the current position of the mouse pointer, as shown highlighted in the following markup:
        <pre class="programlisting code"><code class="hljs-code">  &lt;div class="col"&gt;
<strong class="hljs-slc">    &lt;DialogBox DialogTitle="Delete Database" </strong>
<strong class="hljs-slc">               PrimaryButtonText="Yes" OnClickPrimary="Yes_Click"</strong>
<strong class="hljs-slc">               SecondaryButtonText="No" OnClickSecondary="No_Click"&gt;</strong>
<strong class="hljs-slc">        Are you sure you want to delete the entire database? Really?</strong>
<strong class="hljs-slc">    &lt;/DialogBox&gt;</strong>
  &lt;/div&gt;
&lt;/div&gt;
<strong class="hljs-slc">@code {</strong>
<strong class="hljs-slc">  </strong><strong class="hljs-keyword-slc">private</strong><strong class="hljs-function-slc"> </strong><strong class="hljs-keyword-slc">void</strong><strong class="hljs-function-slc"> </strong><strong class="hljs-title-slc">Yes_Click</strong><strong class="hljs-function-slc">(</strong><strong class="hljs-params-slc">MouseEventArgs e</strong><strong class="hljs-function-slc">)</strong>
<strong class="hljs-slc">  {</strong>
<strong class="hljs-slc">    Console.WriteLine("User clicked 'Primary' </strong><strong class="hljs-function-slc">button </strong><strong class="hljs-title-slc">at</strong><strong class="hljs-function-slc"> (</strong><strong class="hljs-params-slc">{</strong><strong class="hljs-number-slc">0</strong><strong class="hljs-params-slc">}, {</strong><strong class="hljs-number-slc">1</strong><strong class="hljs-params-slc">}</strong><strong class="hljs-function-slc">).",</strong>
<strong class="hljs-function-slc">      arg0: e.ClientX, arg1: e.ClientY)</strong><strong class="hljs-slc">;</strong>
<strong class="hljs-slc">  }</strong>
<strong class="hljs-slc">  </strong><strong class="hljs-keyword-slc">private</strong><strong class="hljs-function-slc"> </strong><strong class="hljs-keyword-slc">void</strong><strong class="hljs-function-slc"> </strong><strong class="hljs-title-slc">No_Click</strong><strong class="hljs-function-slc">(</strong><strong class="hljs-params-slc">MouseEventArgs e</strong><strong class="hljs-function-slc">)</strong>
<strong class="hljs-slc">  {</strong>
<strong class="hljs-slc">    Console.WriteLine("User clicked 'Secondary' </strong><strong class="hljs-function-slc">button </strong><strong class="hljs-title-slc">at</strong><strong class="hljs-function-slc"> (</strong><strong class="hljs-params-slc">{</strong><strong class="hljs-number-slc">0</strong><strong class="hljs-params-slc">}, {</strong><strong class="hljs-number-slc">1</strong><strong class="hljs-params-slc">}</strong><strong class="hljs-function-slc">).",</strong>
<strong class="hljs-function-slc">      arg0: e.ClientX, arg1: e.ClientY)</strong><strong class="hljs-slc">;</strong>
<strong class="hljs-slc">  }</strong>
<strong class="hljs-slc">}</strong>
</code></pre>
      
    <div><p class="normal">Any content between the <code class="inlineCode">&lt;DialogBox&gt;</code> and <code class="inlineCode">&lt;/DialogBox&gt;</code> elements is automatically set as the <code class="inlineCode">ChildContent</code> property.</p>
    </div></li>
    </ol>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="7">Start the <code class="inlineCode">Northwind.Blazor</code> project, using its <code class="inlineCode">https</code> profile without debugging.</li>
      <li class="numberedList">Click the <strong class="screenText">Delete Database</strong> button, and<a id="_idIndexMarker1668"/> note the modal dialog box that pops up, as shown in <em class="italic">Figure 15.3</em>:</li>
    </ol>
    <figure class="mediaobject"><img alt="" src="img/B19587_15_03.png"/></figure>
    <p class="packt_figref">Figure 15.3: A pop-up modal dialog box that a Blazor component built using Bootstrap</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="9">Arrange the command prompt or terminal and the browser window so that you can see both.</li>
      <li class="numberedList">In the <strong class="screenText">Delete Database</strong> dialog box, click the <strong class="screenText">Yes</strong> button and <strong class="screenText">No</strong> button a few times (clicking the <strong class="screenText">No</strong> button or the <strong class="screenText">x</strong> button will close the dialog, so click the <strong class="screenText">Delete Database</strong> button again to reshow the dialog box), and note the messages written to the console, as shown in <em class="italic">Figure 15.4</em>:
    <figure class="mediaobject"><img alt="" src="img/B19587_15_04.png"/></figure>
    <p class="packt_figref">Figure 15.4: The dialog box component writing to the server console</p>
    <div><p class="normal">JavaScript in the client displays the Bootstrap dialog box. Clicks on the buttons trigger the SignalR connection over WebSockets to execute the component event handling code, executing on the server.</p>
    </div></li>
    </ol>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="11">Close the<a id="_idIndexMarker1669"/> browser, and shut down the web server.</li>
    </ol>
    <div><p class="normal">You can read more about the supported event arguments at the following link: <a href="https://learn.microsoft.com/en-us/aspnet/core/blazor/components/event-handling#event-arguments">https://learn.microsoft.com/en-us/aspnet/core/blazor/components/event-handling#event-arguments</a>.</p>
    </div>
    <h2 class="heading-2" id="_idParaDest-565">Building a Blazor alert component</h2>
    <p class="normal">In this section, we will build a <a id="_idIndexMarker1670"/>component to provide alerts to show messages to the website visitor. It will use Bootstrap classes to define a colorful area for the message, which can be dismissed. The message, title, icon, and color theme can be configured:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">In the <code class="inlineCode">Northwind.Blazor</code> project, in the <code class="inlineCode">Components</code> folder, add a new file named the <code class="inlineCode">Bootstrap.Constants.cs</code> file.</li>
      <li class="numberedList">In <code class="inlineCode">Bootstrap.Constants.cs</code>, add statements to define some static classes with <code class="inlineCode">string</code> constant values for common Bootstrap color themes and icons, as shown in the following code:
        <pre class="programlisting code"><code class="hljs-code">namespace Northwind.Blazor.Components;
public static class BootstrapColors
{
  public const string Primary = "primary";
  public const string Secondary = "secondary";
  public const string Danger = "danger";
  public const string Warning = "warning";
  public const string Success = "success";
  public const string Info = "info";
}
public static class BootstrapIcons
{
  public const string Globe = "bi bi-globe";
  public const string GlobeEmea = "bi bi-globe-europe-africa";
  public const string Pencil = "bi bi-pencil";
  public const string Trash = "bi bi-trash";
  public const string PlusSquare = "bi bi-plus-square";
  public const string InfoCircle = "bi bi-info-circle";
  public const string ExclamationTriangleFill =
    "bi bi-exclamation-triangle-fill";
}
</code></pre>
      </li>
      <li class="numberedList">In the <code class="inlineCode">Components</code> folder, add a new file named <code class="inlineCode">Alert.razor</code>.</li>
      <li class="numberedList">In <code class="inlineCode">Alert.razor</code>, add statements to render <code class="inlineCode">&lt;div&gt;</code> elements that use Bootstrap classes<a id="_idIndexMarker1671"/> to define a <code class="inlineCode">&lt;div&gt;</code> with bindable parameters, setting various properties, as shown in the following markup:
        <pre class="programlisting code"><code class="hljs-code">@rendermode InteractiveServer
&lt;div class="alert alert-@ColorTheme d-flex align-items-center
     @(IsDismissable ? " alert-dismissible fade show" : "")" role="alert"&gt;
  &lt;div&gt;
    &lt;h4 class="alert-heading"&gt;&lt;span class="@Icon" aria-hidden="true"&gt;
      &lt;/span&gt; @Title&lt;/h4&gt;
    @Message
    @if (IsDismissable)
    {
      &lt;button type="button" class="btn-close" 
              data-bs-dismiss="alert" aria-label="Close"&gt;&lt;/button&gt;
    }
  &lt;/div&gt;
&lt;/div&gt;
@code {
  [Parameter]
  public bool IsDismissable { get; set; } = true;
  [Parameter]
  public string ColorTheme { get; set; } = BootstrapColors.Primary;
  [Parameter]
  public string Icon { get; set; } = BootstrapIcons.InfoCircle;
  [Parameter]
  public string? Title { get; set; }
  [Parameter]
  public string? Message { get; set; }
}
</code></pre>
      </li>
      <li class="numberedList">In the <code class="inlineCode">Components\Pages</code> folder, in <code class="inlineCode">Home.razor</code>, add an <code class="inlineCode">Alert</code> element below the <code class="inlineCode">&lt;DialogBox&gt;</code> element, as shown in the following markup:
        <pre class="programlisting code"><code class="hljs-code">&lt;Alert IsDismissable="true" 
       Icon="@(BootstrapIcons.ExclamationTriangleFill)" 
       ColorTheme="@(BootstrapColors.Warning)" 
       Title="Warning" 
       Message="Deleting the database cannot be undone." /&gt;
</code></pre>
      </li>
      <li class="numberedList">Start the <code class="inlineCode">Northwind.Blazor</code> project, using<a id="_idIndexMarker1672"/> its <code class="inlineCode">https</code> profile without debugging.</li>
      <li class="numberedList">On the home page, note the warning alert, as shown in <em class="italic">Figure 15.5</em>:</li>
    </ol>
    <figure class="mediaobject"><img alt="" src="img/B19587_15_05.png"/></figure>
    <p class="packt_figref">Figure 15.5: The alert component with a dismiss button</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="8">Click the close button<a id="_idIndexMarker1673"/> to dismiss the warning.</li>
      <li class="numberedList">Close the browser, and shut down the web server.</li>
    </ol>
    <h1 class="heading-1" id="_idParaDest-566">Building a Blazor data component</h1>
    <p class="normal">In this section, we will build a<a id="_idIndexMarker1674"/> component that will list, create, and edit employees in the Northwind database.</p>
    <p class="normal">We will build it over several steps:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">Make a Blazor component that renders the name of an employee, set as a parameter.</li>
      <li class="numberedList">Make it work as a routable page as well as a component.</li>
      <li class="numberedList">Build and call an ASP.NET Core Minimal APIs web service.</li>
      <li class="numberedList">Call the web service in the component.</li>
    </ol>
    <h2 class="heading-2" id="_idParaDest-567">Making the component</h2>
    <p class="normal">We will add the new component to the <a id="_idIndexMarker1675"/>existing Blazor project:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">In the <code class="inlineCode">Northwind.Blazor</code> project, in the <code class="inlineCode">Components\Pages</code> folder, add a new file named <code class="inlineCode">Employees.razor</code>.</li>
      <li class="numberedList">Add statements to output a heading for the <code class="inlineCode">Employees</code> component and define a code block, defining a property to store the name of a country, as shown highlighted in the following markup:
        <pre class="programlisting code"><code class="hljs-code">@rendermode InteractiveServer
&lt;h1&gt;Employees <strong class="hljs-slc">@(</strong><strong class="hljs-built_in-slc">string</strong><strong class="hljs-slc">.IsNullOrWhiteSpace(Country)</strong>
<strong class="hljs-slc">    ? "Worldwide" : "</strong><strong class="hljs-keyword-slc">in</strong><strong class="hljs-slc"> " + Country)</strong>&lt;/h1&gt;
@code {
<strong class="hljs-slc">  [</strong><strong class="hljs-meta-slc">Parameter</strong><strong class="hljs-slc">]</strong>
<strong class="hljs-slc">  </strong><strong class="hljs-keyword-slc">public</strong><strong class="hljs-slc"> </strong><strong class="hljs-built_in-slc">string</strong><strong class="hljs-slc">? Country { </strong><strong class="hljs-keyword-slc">get</strong><strong class="hljs-slc">; </strong><strong class="hljs-keyword-slc">set</strong><strong class="hljs-slc">; }</strong>
}
</code></pre>
      </li>
      <li class="numberedList">In the <code class="inlineCode">Components\Pages</code> folder, in <code class="inlineCode">Home.razor</code>, after the welcome message, instantiate the <code class="inlineCode">Employees</code> component twice: once setting <code class="inlineCode">USA</code> as the <code class="inlineCode">Country</code> parameter, and <a id="_idIndexMarker1676"/>once without setting the country, as shown highlighted in the following markup:
        <pre class="programlisting code"><code class="hljs-code">&lt;h1&gt;Hello, Blazor Full Stack!&lt;/h1&gt;
Welcome to your new app.
<strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">Employees</strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc">Country</strong><strong class="hljs-tag-slc">=</strong><strong class="hljs-string-slc">"USA"</strong><strong class="hljs-tag-slc"> /&gt;</strong>
<strong class="hljs-tag-slc">&lt;</strong><strong class="hljs-name-slc">Employees</strong><strong class="hljs-tag-slc"> /&gt;</strong>
</code></pre>
      </li>
      <li class="numberedList">Start the <code class="inlineCode">Northwind.Blazor</code> project, using its <code class="inlineCode">https</code> profile without debugging.</li>
      <li class="numberedList">Start Chrome, navigate to <code class="inlineCode">https://localhost:5151/</code>, and note the <code class="inlineCode">Employees</code> components, as shown in <em class="italic">Figure 15.6</em>:</li>
    </ol>
    <figure class="mediaobject"><img alt="" src="img/B19587_15_06.png"/></figure>
    <p class="packt_figref">Figure 15.6: The Employees component, with the Country parameter set to USA and without parameters set</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="6">Close the browser, and shut down the web server.</li>
    </ol>
    <h2 class="heading-2" id="_idParaDest-568">Making the component a routable page component</h2>
    <p class="normal">It is simple to turn this <a id="_idIndexMarker1677"/>component into a routable page component with a route parameter for the country:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">In the <code class="inlineCode">Components\Pages</code> folder, in the <code class="inlineCode">Home.razor</code> component, remove the two <code class="inlineCode">&lt;Employee&gt;</code> elements because we will now use them as pages.</li>
      <li class="numberedList">In the <code class="inlineCode">Components\Pages</code> folder, in the <code class="inlineCode">Employees.razor</code> component, add a statement at the top of the file to register <code class="inlineCode">/employees</code> as its route, with an optional country route parameter, as shown highlighted in the following markup:
        <pre class="programlisting code"><code class="hljs-code">@rendermode InteractiveServer
<strong class="hljs-slc">@page "/employees/{country?}"</strong>
</code></pre>
      </li>
      <li class="numberedList">In the <code class="inlineCode">Components\Layout</code> folder, in <code class="inlineCode">NavMenu.razor</code>, add list item elements after <strong class="screenText">Products</strong> to navigate to show employees worldwide and in the USA or UK, as shown in the following markup:
        <pre class="programlisting code"><code class="hljs-code">&lt;div class="nav-item px-3"&gt;
  &lt;NavLink class="nav-link" href="employees" Match="NavLinkMatch.All"&gt;
    &lt;span class="bi bi-globe" aria-hidden="true"&gt;&lt;/span&gt; Worldwide
  &lt;/NavLink&gt;
&lt;/div&gt;
&lt;div class="nav-item px-3"&gt;
  &lt;NavLink class="nav-link" href="employees/USA"&gt;
    &lt;span class="bi bi-people" aria-hidden="true"&gt;&lt;/span&gt; Employees in USA
  &lt;/NavLink&gt;
&lt;/div&gt;
&lt;div class="nav-item px-3"&gt;
  &lt;NavLink class="nav-link" href="employees/UK"&gt;
    &lt;span class="bi bi-person" aria-hidden="true"&gt;&lt;/span&gt; Employees in UK
  &lt;/NavLink&gt;
&lt;/div&gt;
</code></pre>
      </li>
      <li class="numberedList">Start the <code class="inlineCode">Northwind.Blazor</code> project, using its <code class="inlineCode">https</code> profile without debugging.</li>
      <li class="numberedList">Start Chrome and navigate to <code class="inlineCode">https://localhost:5151/</code>.</li>
      <li class="numberedList">In the left navigation menu, click <strong class="screenText">Employees in USA</strong>. Note that the country name is correctly passed to the page component and that the component uses the same shared layout as the other page components, like <code class="inlineCode">Home.razor</code>. Also note the URL: <code class="inlineCode">https://localhost:5151/employees/USA</code>.</li>
      <li class="numberedList">Close Chrome, and <a id="_idIndexMarker1678"/>shut down the web server.</li>
    </ol>
    <h2 class="heading-2" id="_idParaDest-569">Getting entities into a component by building a web service</h2>
    <p class="normal">Now that you have seen the<a id="_idIndexMarker1679"/> minimum implementation of an entity component, we can add the functionality to get entities from the server. In this case, we will use the Northwind database context to get employees from the database and expose it as an ASP.NET Core Minimal APIs web service:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">Use your preferred code editor to add a project to the <code class="inlineCode">Chapter15</code> solution, as defined in the following list:<ul>
          <li class="bulletList">Project template: <strong class="screenText">ASP.NET Core Web API</strong> / web<code class="inlineCode">api</code></li>
          <li class="bulletList">Solution file and folder: <code class="inlineCode">Chapter15</code></li>
          <li class="bulletList">Project file and folder: <code class="inlineCode">Northwind.MinimalApi.Service</code></li>
          <li class="bulletList"><strong class="screenText">Authentication type</strong>: None</li>
          <li class="bulletList"><strong class="screenText">Configure for HTTPS</strong>: Selected</li>
          <li class="bulletList"><strong class="screenText">Enable Docker</strong>: Cleared</li>
          <li class="bulletList"><strong class="screenText">Enable OpenAPI support</strong>: Selected</li>
          <li class="bulletList"><strong class="screenText">Do not use top-level statements</strong>: Cleared</li>
          <li class="bulletList"><strong class="screenText">Use controllers</strong>: Cleared</li>
        </ul>
      </li>
      <li class="numberedList">Add a project reference to the Northwind database context project for SQL Server that you created in <em class="chapterRef">Chapter 3</em>, <em class="italic">Building Entity Models for SQL Server Using EF Core</em>, as shown in the following markup:
        <pre class="programlisting code"><code class="hljs-code">&lt;ItemGroup&gt;
  &lt;ProjectReference Include="..\..\Chapter03\Northwind.Common.DataContext
.SqlServer\Northwind.Common.DataContext.SqlServer.csproj" /&gt;
&lt;/ItemGroup&gt;
</code></pre>
      
    <div><p class="normal">The path cannot have a line break. If you did not complete the task of creating the class libraries in <em class="chapterRef">Chapter 3</em>, then download the solution projects from the GitHub repository.</p>
    </div></li>
    </ol>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="3">In the project file, change invariant globalization to <code class="inlineCode">false</code>, and treat warnings as errors, as <a id="_idIndexMarker1680"/>shown in the following markup:
        <pre class="programlisting code"><code class="hljs-code">&lt;Project Sdk="Microsoft.NET.Sdk.Web"&gt;
  &lt;PropertyGroup&gt;
    &lt;TargetFramework&gt;net8.0&lt;/TargetFramework&gt;
    &lt;Nullable&gt;enable&lt;/Nullable&gt;
    &lt;ImplicitUsings&gt;enable&lt;/ImplicitUsings&gt;
    &lt;InvariantGlobalization&gt;<strong class="hljs-literal-slc">false</strong>&lt;/InvariantGlobalization&gt;
<strong class="hljs-slc">    &lt;TreatWarningsAsErrors&gt;</strong><strong class="hljs-literal-slc">true</strong><strong class="hljs-slc">&lt;/TreatWarningsAsErrors&gt;</strong>
  &lt;/PropertyGroup&gt;
</code></pre>
      </li>
      <li class="numberedList">At the command prompt or terminal, build the <code class="inlineCode">Northwind.MinimalApi.Service</code> project to make sure the entity model class library projects outside the current solution are properly compiled, as shown in the following command:
        <pre class="programlisting con"><code class="hljs-con">dotnet build
</code></pre>
      </li>
      <li class="numberedList">In the <code class="inlineCode">Properties</code> folder, in <code class="inlineCode">launchSettings.json</code>, modify the <code class="inlineCode">applicationUrl</code> of the profile named <code class="inlineCode">https</code> to use port <code class="inlineCode">5153</code> and <code class="inlineCode">http</code> to use port <code class="inlineCode">5154</code>, as shown highlighted in the following configuration:
        <pre class="programlisting code"><code class="hljs-code">"profiles": {
  ...
<strong class="hljs-slc">  "https"</strong><strong class="hljs-punctuation-slc">:</strong><strong class="hljs-slc"> </strong><strong class="hljs-punctuation-slc">{</strong>
    "commandName": "Project",
    "dotnetRunMessages": true,
    "launchBrowser": true,
    "launchUrl": "swagger",
<strong class="hljs-slc">    "applicationUrl"</strong><strong class="hljs-punctuation-slc">:</strong><strong class="hljs-slc"> "https</strong><strong class="hljs-punctuation-slc">:</strong><strong class="hljs-comment-slc">//localhost:5153;http://localhost:5154",</strong>
    "environmentVariables": {
      "ASPNETCORE_ENVIRONMENT": "Development"
    }
</code></pre>
      </li>
      <li class="numberedList">In <code class="inlineCode">Program.cs</code>, import namespaces to work with Minimal APIs attributes, registering the Northwind database context extension method, and serialize JSON, as shown in the following code:
        <pre class="programlisting code"><code class="hljs-code">using Microsoft.AspNetCore.Mvc; // To use [FromServices].
using Northwind.EntityModels; // To use AddNorthwindContext.
using System.Text.Json.Serialization; // To use ReferenceHandler.
// Define an alias for the JsonOptions class.
using HttpJsonOptions = Microsoft.AspNetCore.Http.Json.JsonOptions;
</code></pre>
      </li>
      <li class="numberedList">In <code class="inlineCode">Program.cs</code>, at the <a id="_idIndexMarker1681"/>end of the section to configure services, before the call to <code class="inlineCode">Build</code>, add a statement to configure the Northwind database context and the registered dependency service for JSON options, setting its reference handler to preserve references, so that the reference between an employee and their manager does not cause a runtime exception due to circular references, as shown in the following code:
        <pre class="programlisting code"><code class="hljs-code">builder.Services.AddNorthwindContext();
builder.Services.Configure&lt;HttpJsonOptions&gt;(options =&gt;
{
  // If we do not preserve references then when the JSON serializer
  // encounters a circular reference it will throw an exception.
  Options.SerializerOptions.ReferenceHandler = ReferenceHandler.Preserve;
});
</code></pre>
      
    <div><p class="normal">Be careful to configure <code class="inlineCode">Microsoft.AspNetCore.Http.Json.JsonOptions</code> and not <code class="inlineCode">Microsoft.AspNetCore.Mvc.JsonOptions</code>! I have created an alias to make this explicit, since we need to import the <code class="inlineCode">Microsoft.AspNetCore.Mvc</code> namespace of other types.</p>
    </div></li>
    </ol>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="8">In <code class="inlineCode">Program.cs</code>, before the call to the <code class="inlineCode">app.Run()</code> method, add statements to define some<a id="_idIndexMarker1682"/> endpoints to <code class="inlineCode">GET</code> and <code class="inlineCode">POST</code> employees, as shown in the following code:
        <pre class="programlisting code"><code class="hljs-code">app.MapGet("api/employees", (
  [FromServices] NorthwindContext db) =&gt; 
    Results.Json(db.Employees))
  .WithName("GetEmployees")
  .Produces&lt;Employee[]&gt;(StatusCodes.Status200OK);
app.MapGet("api/employees/{id:int}", (
  [FromServices] NorthwindContext db,
  [FromRoute] int id) =&gt;
  {
    Employee? Employee = db.Employees.Find(id);
    if (employee == null)
    {
      return Results.NotFound();
    }
    else
    {
      return Results.Json(employee);
    }
  })
  .WithName("GetEmployeesById")
  .Produces&lt;Employee&gt;(StatusCodes.Status200OK)
  .Produces(StatusCodes.Status404NotFound);
app.MapGet("api/employees/{country}", (
  [FromServices] NorthwindContext db,
  [FromRoute] string country) =&gt;
    Results.Json(db.Employees.Where(employee =&gt; 
    employee.Country == country)))
  .WithName("GetEmployeesByCountry")
  .Produces&lt;Employee[]&gt;(StatusCodes.Status200OK);
app.MapPost("api/employees", async ([FromBody] Employee employee,
  [FromServices] NorthwindContext db) =&gt;
  {
    db.Employees.Add(employee);
    await db.SaveChangesAsync();
    return Results.Created($"api/employees/{employee.EmployeeId}", employee);
  })
  .Produces&lt;Employee&gt;(StatusCodes.Status201Created);
</code></pre>
      </li>
      <li class="numberedList">Optionally, delete<a id="_idIndexMarker1683"/> the statements to set up the <code class="inlineCode">weather</code> endpoint.<div><p class="normal">Due to the <code class="inlineCode">{id:int}</code> constraint, a <code class="inlineCode">GET</code> request to a path like <code class="inlineCode">api/employees/3</code> will map to the <code class="inlineCode">GetEmployeesById</code> endpoint, and a <code class="inlineCode">GET</code> request to a path like <code class="inlineCode">api/employess/USA</code> will map to the <code class="inlineCode">GetEmployeesByCountry</code> endpoint. When <code class="inlineCode">POST</code>-ing to the <code class="inlineCode">api/employees</code> endpoint, the response includes a URL to the newly created employee with its database-assigned ID.</p>
        </div>
      </li>
    </ol>
    <h2 class="heading-2" id="_idParaDest-570">Getting entities into a component by calling the web service</h2>
    <p class="normal">Now, we can add the functionality to<a id="_idIndexMarker1684"/> the entity component to call the web service:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">In the <code class="inlineCode">Northwind.Blazor</code> project, in its project file, add a package reference for QuickGrid, as shown in the following markup:
        <pre class="programlisting code"><code class="hljs-code">&lt;ItemGroup&gt;
  &lt;PackageReference Include=
    "Microsoft.AspNetCore.Components.QuickGrid" Version="8.0.0" /&gt;
&lt;/ItemGroup&gt;
</code></pre>
      </li>
      <li class="numberedList">Build the project to restore packages.</li>
      <li class="numberedList">In <code class="inlineCode">Program.cs</code>, import the namespace to work with HTTP headers, as shown in the following code:
        <pre class="programlisting code"><code class="hljs-code">using System.Net.Http.Headers; // To use MediaTypeWithQualityHeaderValue.
</code></pre>
      </li>
      <li class="numberedList">In the <code class="inlineCode">Northwind.Blazor</code> project, in <code class="inlineCode">Program.cs</code>, before the call to the <code class="inlineCode">builder.Build()</code>, add statements to configure an HTTP client factory to call the web service, as shown in the following code:
        <pre class="programlisting code"><code class="hljs-code">builder.Services.AddHttpClient(name: "Northwind.Blazor.Service",
  configureClient: options =&gt;
  {
    options.BaseAddress = new("https://localhost:5153/");
    options.DefaultRequestHeaders.Accept.Add(
      new MediaTypeWithQualityHeaderValue(
        "application/json", 1.0));
  });
</code></pre>
      </li>
      <li class="numberedList">In the <code class="inlineCode">Components</code> folder, in <code class="inlineCode">_Imports.razor</code>, import the namespaces to work with QuickGrid and serialize JSON, ensuring that the Blazor components we build do not need to import the namespaces individually, as shown<a id="_idIndexMarker1685"/> in the following markup:
        <pre class="programlisting code"><code class="hljs-code">@using Microsoft.AspNetCore.Components.QuickGrid
@using System.Text.Json @* To use JsonSerializerOptions. *@
@using System.Text.Json.Serialization @* To use ReferenceHandler. *@
</code></pre>
      </li>
      <li class="numberedList">In the <code class="inlineCode">Components\Pages</code> folder, in <code class="inlineCode">Employees.razor</code>, add statements to inject the HTTP client factory, and then use it to output a grid of either all employees or employees in the specific country, as shown highlighted in the following code:
        <pre class="programlisting code"><code class="hljs-code">@rendermode InteractiveServer
@page "/employees/{country?}"
<code class="codeHighlighted" style="font-weight: bold;">@inject IHttpClientFactory httpClientFactory</code>
&lt;h1&gt;
  Employees @(string.IsNullOrWhiteSpace(Country) ? "Worldwide" : "in " + Country)
&lt;/h1&gt;
<strong class="hljs-slc">&lt;QuickGrid Items="@employees" Class="table table-striped table-bordered"&gt;</strong>
<strong class="hljs-slc">  &lt;PropertyColumn Property="@(emp =&gt; emp.EmployeeId)" </strong>
<strong class="hljs-slc">                  Title="ID" /&gt;</strong>
<strong class="hljs-slc">  &lt;PropertyColumn Property="@(emp =&gt; emp.FirstName)" /&gt;</strong>
<strong class="hljs-slc">  &lt;PropertyColumn Property="@(emp =&gt; emp.LastName)" /&gt;</strong>
<strong class="hljs-slc">  &lt;PropertyColumn Property="@(emp =&gt; emp.City)" /&gt;</strong>
<strong class="hljs-slc">  &lt;PropertyColumn Property="@(emp =&gt; emp.Country)" /&gt;</strong>
<strong class="hljs-slc">  &lt;PropertyColumn Property="@(emp =&gt; emp.HireDate)" </strong>
<strong class="hljs-slc">                  Format="yyyy-MM-dd" /&gt;</strong>
<strong class="hljs-slc">&lt;/QuickGrid&gt;</strong>
@code {
  [Parameter]
  public string? Country { get; set; }
<strong class="hljs-comment-slc">  // QuickGrid works best if it binds to an IQueryable&lt;T&gt; sequence.</strong>
<strong class="hljs-keyword-slc">  private</strong><strong class="hljs-slc"> IQueryable&lt;Employee&gt;? employees;</strong>
  <strong class="hljs-keyword-slc">protected override async</strong><strong class="hljs-slc"> Task </strong><strong class="hljs-title-slc">OnParametersSetAsync</strong>()
  {
<strong class="hljs-slc">    Employee[]? employeesArray = </strong><strong class="hljs-title-slc">null</strong>;
<strong class="hljs-comment-slc">    </strong><strong class="hljs-comment-slc">// Employee entity has circular reference to itself so</strong>
<strong class="hljs-comment-slc">    // we must control how references are handled.</strong>
<strong class="hljs-slc">    JsonSerializerOptions jsonOptions = </strong><strong class="hljs-keyword-slc">new</strong><strong class="hljs-slc">()</strong>
<strong class="hljs-slc">      {</strong>
<strong class="hljs-slc">        ReferenceHandler = ReferenceHandler.Preserve,</strong>
<strong class="hljs-slc">        PropertyNameCaseInsensitive = </strong><strong class="hljs-title-slc">true</strong>
<strong class="hljs-slc">      };</strong>
<strong class="hljs-slc">    HttpClient client = httpClientFactory.CreateClient(</strong>
<strong class="hljs-slc">      "Northwind.Blazor.Service");</strong>
<strong class="hljs-slc">    </strong><strong class="hljs-built_in-slc">string</strong><strong class="hljs-slc"> path = "api/employees";</strong>
<strong class="hljs-slc">    </strong><strong class="hljs-keyword-slc">try</strong>
<strong class="hljs-slc">    {</strong>
<strong class="hljs-slc">      employeesArray = </strong>(<strong class="hljs-keyword-slc">await</strong><strong class="hljs-slc"> client.GetFromJsonAsync&lt;Employee[]?&gt;(</strong>
<strong class="hljs-slc">        path, jsonOptions));</strong>
<strong class="hljs-slc">    }</strong>
<strong class="hljs-slc">    </strong><strong class="hljs-keyword-slc">catch</strong><strong class="hljs-slc"> (Exception ex)</strong>
<strong class="hljs-slc">    {</strong>
<strong class="hljs-slc">      Console.WriteLine($"{ex.GetType()}: {ex.Message}");</strong>
<strong class="hljs-slc">    }</strong>
<strong class="hljs-slc">    </strong><strong class="hljs-keyword-slc">if</strong><strong class="hljs-slc"> (employeesArray </strong><strong class="hljs-keyword-slc">is </strong><strong class="hljs-keyword-slc">not</strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc">null</strong>)
<strong class="hljs-slc">    {</strong>
<strong class="hljs-slc">      employees = employeesArray.AsQueryable();</strong>
<strong class="hljs-slc">      </strong><strong class="hljs-keyword-slc">if</strong><strong class="hljs-slc"> (!</strong><strong class="hljs-built_in-slc">string</strong><strong class="hljs-slc">.IsNullOrWhiteSpace(Country))</strong>
<strong class="hljs-slc">      {</strong>
<strong class="hljs-slc">        employees = employees.Where(emp =&gt; emp.Country == Country);</strong>
<strong class="hljs-slc">      }</strong>
<strong class="hljs-slc">    }</strong>
<strong class="hljs-slc">  }</strong>
<strong class="hljs-slc">}</strong>
</code></pre>
      
    <div><p class="normal">Although the web service has an endpoint that allows you to return only employees in a specified country, later we will add caching for employees, so in this implementation we will request all employees and use client-side filtering for the bound data grid.</p>
    </div></li>
    </ol>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="7">If your database<a id="_idIndexMarker1686"/> server is not running, (for example, because you are hosting it in Docker, a virtual machine, or in the cloud), then make sure to start it.</li>
      <li class="numberedList">Start the <code class="inlineCode">Northwind.MinimalApi.Service</code> project, using its <code class="inlineCode">https</code> profile without debugging.</li>
      <li class="numberedList">Start the <code class="inlineCode">Northwind.Blazor</code> project, using its <code class="inlineCode">https</code> profile without debugging.</li>
      <li class="numberedList">Start Chrome, and navigate to <code class="inlineCode">https://localhost:5151/</code>.</li>
      <li class="numberedList">In the left navigation menu, click <strong class="screenText">Employees in USA</strong>, and note that the grid of employees loads from the web service and renders in the web page, as shown in <em class="italic">Figure 15.7</em>:</li>
    </ol>
    <figure class="mediaobject"><img alt="" src="img/B19587_15_07.png"/></figure>
    <p class="packt_figref">Figure 15.7: The grid of employees in the USA</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="12">In the left navigation menu, click <strong class="screenText">Employees in UK</strong>, and note that the grid of employees is filtered to only show employees in the UK.</li>
      <li class="numberedList">Close Chrome, and shut <a id="_idIndexMarker1687"/>down the web server.</li>
    </ol>
    <h1 class="heading-1" id="_idParaDest-571">Practicing and exploring</h1>
    <p class="normal">Test your knowledge and understanding by answering some questions, getting some hands-on practice, and exploring this chapter’s topics with deeper research.</p>
    <h2 class="heading-2" id="_idParaDest-572">Exercise 15.1 – Test your knowledge</h2>
    <p class="normal">Answer the following questions:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">What is the benefit of the new Blazor Full Stack hosting model in .NET 8 compared to the legacy hosting models like Blazor Server?</li>
      <li class="numberedList">Does Blazor WebAssembly support all features of the latest .NET APIs?</li>
      <li class="numberedList">What is the file extension for Blazor components?</li>
      <li class="numberedList">How do you set the default layout for all Blazor page components?</li>
      <li class="numberedList">How do you register a route for a Blazor page component?</li>
      <li class="numberedList">When would you set the <code class="inlineCode">Match</code> property of a <code class="inlineCode">&lt;NavLink&gt;</code> component to <code class="inlineCode">NavLinkMatch.All</code>?</li>
      <li class="numberedList">You have imported a custom namespace in the <code class="inlineCode">_Imports.razor</code> file, but when you try to use a class in that namespace in a code-behind file for the Blazor component, the class is not found. Why? How can you fix the issue?</li>
      <li class="numberedList">What must you do to a property in a component class to have it set to a query string parameter automatically?</li>
      <li class="numberedList">What is QuickGrid?</li>
      <li class="numberedList">How can a Blazor component access browser features like local storage?</li>
    </ol>
    <h2 class="heading-2" id="_idParaDest-573">Exercise 15.2 – Practice building Blazor components</h2>
    <p class="normal">Create a Blazor component named <code class="inlineCode">Carousel</code> that wraps the Bootstrap classes to work with carousels as a component, and then use it to show the eight categories in the Northwind database, including images.</p>
    <div><p class="normal">You can learn about the Bootstrap carousel at the following link: <a href="https://getbootstrap.com/docs/5.3/components/carousel/">https://getbootstrap.com/docs/5.3/components/carousel/</a>.</p>
    </div>
    <h2 class="heading-2" id="_idParaDest-574">Exercise 15.3 – Practice building an IndexedDB interop service</h2>
    <p class="normal">Browser local and session storage its okay for storing small amounts of data, but if you need a more robust and capable storage in the browser, then you can use the IndexedDB API.</p>
    <p class="normal">Create a Blazor service named <code class="inlineCode">IndexedDbService</code>, with a JavaScript module for interop, with the IndexedDB API, and then use it to cache the employees.</p>
    <div><p class="normal">You can learn more about the methods of the <code class="inlineCode">window.indexedDB</code> object at the following link: <a href="https://developer.mozilla.org/en-US/docs/Web/API/IndexedDB_API">https://developer.mozilla.org/en-US/docs/Web/API/IndexedDB_API</a>.</p>
    </div>
    <h2 class="heading-2" id="_idParaDest-575">Exercise 15.4 – Explore topics</h2>
    <p class="normal">Use the links on the following page to learn more details about the topics covered in this chapter:</p>
    <p class="normal"><a href="https://github.com/markjprice/apps-services-net8/blob/main/docs/book-links.md#chapter-15---building-web-components-using-blazor">https://github.com/markjprice/apps-services-net8/blob/main/docs/book-links.md#chapter-15---building-web-components-using-blazor</a></p>
    <h2 class="heading-2" id="_idParaDest-576">Exercise 15.5 – Explore Blazor WebAssembly topics</h2>
    <p class="normal">To read more about topics related specifically to Blazor WebAssembly projects, I have written an online-only section, found at the following link: <a href="https://github.com/markjprice/apps-services-net8/blob/main/docs/ch15-blazor-webassembly.md">https://github.com/markjprice/apps-services-net8/blob/main/docs/ch15-blazor-webassembly.md</a>.</p>
    <h2 class="heading-2" id="_idParaDest-577">Exercise 15.6 – Explore Progressive Web Apps with Blazor</h2>
    <p class="normal">To read more about topics related specifically to Blazor PWA support, I have written an online-only section, found at the following link: <a href="https://github.com/markjprice/apps-services-net8/blob/main/docs/ch15-blazor-pwa.md">https://github.com/markjprice/apps-services-net8/blob/main/docs/ch15-blazor-pwa.md</a>.</p>
    <h2 class="heading-2" id="_idParaDest-578">Exercise 15.7 – Leveraging Open Source Blazor Component Libraries</h2>
    <p class="normal">To learn how to use some common Blazor open-source components, I have written an online-only section, found at the following link: <a href="https://github.com/markjprice/apps-services-net8/blob/main/docs/ch15-blazor-libraries.md">https://github.com/markjprice/apps-services-net8/blob/main/docs/ch15-blazor-libraries.md</a>.</p>
    <h1 class="heading-1" id="_idParaDest-579">Summary</h1>
    <p class="normal">In this chapter, you learned:</p>
    <ul>
      <li class="bulletList">About some important concepts surrounding Blazor, like hosting models, components, routing, and how to pass parameters.</li>
      <li class="bulletList">How to build Blazor components with settable parameters, child content, and custom events.</li>
      <li class="bulletList">How to build Blazor components that get data from a web service.</li>
    </ul>
    <p class="normal">In the next chapter, you will learn how to build cross-platform apps for mobile and desktop devices, using .NET MAUI.</p>
    <h1 class="heading-1" id="_idParaDest-580">Learn more on Discord</h1>
    <p class="normal">To join the Discord community for this book – where you can share feedback, ask questions to the author, and learn about new releases – follow the QR code below:</p>
    <p class="normal"><a href="https://packt.link/apps_and_services_dotnet8">https://packt.link/apps_and_services_dotnet8</a></p>
    <p class="normal"><img alt="" src="img/QR_Code3048220001028652625.png"/></p>
  </div>
</body></html>