<html><head></head><body><div class="chapter" title="Chapter&#xA0;9.&#xA0;Interfacing"><div class="titlepage"><div><div><h1 class="title"><a id="ch09"/>Chapter 9. Interfacing</h1></div></div></div><p>When the first version of Microsoft Dynamics NAV for Windows was released in 1995, the system <a class="indexterm" id="id1144"/>was very closed. It was possible to import and export data using flat text files and that was basically it. These flat text files were placed on a floppy disk and sent by postal mail. Internet and e-mail were just coming, large USB sticks were a dream, and when the previous version of this book was released in 2009, OneDrive and Azure where being invented.</p><p>Since then, the world has changed tremendously. Internet, e-mail, SQL Server, .NET, and Azure changed the way we think about interfacing with applications and we are still changing. Today Microsoft Dynamics NAV 2013 has a completely open database and supports a wide range of interfacing possibilities, which we will learn in this chapter.</p><p>Version 1.0 of Navision ran on Windows 95, which later became an industry standard and for more than a decade, Windows was the only serious platform. Today, business people use iPads and Android tablets. Microsoft Dynamics NAV 2013 is one of few ERP platforms that can run cross-platform on all devices, even supporting login using Google or Facebook credentials.</p><p>In this chapter, we will first discuss the available interfacing technologies and the interfaces available in the standard product. Then we will talk about interfacing methodology and how to create reliable interfaces.</p><p>At the end of the chapter, we will create some sample interfaces and see how the future will further improve interfacing.</p><p>After reading this chapter, you will have a good understanding of what interfaces the product supports out of the box, what interfacing technologies to use, and how to design a solid business to business interface.</p><div class="section" title="Interface types"><div class="titlepage"><div><div><h1 class="title"><a id="ch09lvl1sec61"/>Interface types</h1></div></div></div><p>When<a class="indexterm" id="id1145"/> discussing an interface, we usually start with the technology, but before that, some other basic questions need answering, such as the following:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Does it need to import, export, or both?</li><li class="listitem" style="list-style-type: disc">Is it started manually or automatically?</li><li class="listitem" style="list-style-type: disc">Is the interface timer or event driven?</li></ul></div><p>Let's discuss these questions.</p><div class="section" title="Import and export"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec177"/>Import and export</h2></div></div></div><p>The<a class="indexterm" id="id1146"/> first question is whether the interface should only export data from<a class="indexterm" id="id1147"/> Microsoft Dynamics NAV or whether it would also import data to the system that then needs to be processed.</p><p>When importing and exporting, the data process can be started manually by an end user using data pulling or data pushing. The interface can also be event- (real time) or timer-driven (asynchronous).</p><div class="mediaobject"><img alt="Import and export" src="graphics/0365EN_09_01.jpg"/></div><div class="section" title="Manual"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec184"/>Manual</h3></div></div></div><p>When an<a class="indexterm" id="id1148"/> interface is manual, the first application has an export<a class="indexterm" id="id1149"/> process and another application has an import process. The end user first manually starts the export process and then manually starts the import process in another application, usually saving the data to a flat file. This is a classic approach to interfacing.</p><p>An example of manual interfacing is exporting telebanking information from Microsoft Dynamics NAV or sending XBRL files to your accountant.</p></div><div class="section" title="Data pulling"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec185"/>Data pulling</h3></div></div></div><p>When <a class="indexterm" id="id1150"/>using data pulling to export data, the interface is<a class="indexterm" id="id1151"/> started from an external application. This application will read the data from the database and process it.</p><p>When using data pulling to import data, the interface is started from the application, which reads and processes data from another application.</p></div><div class="section" title="Data pushing"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec186"/>Data pushing</h3></div></div></div><p>If an<a class="indexterm" id="id1152"/> interface uses data pushing, the exporting application <a class="indexterm" id="id1153"/>writes the data to the other data source. This method is used when the data in the other application does not need further processing. A typical example is exporting data from Microsoft Dynamics NAV to Microsoft Office applications such as Word or Excel.</p></div></div><div class="section" title="Event-driven versus timer-driven"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec178"/>Event-driven versus timer-driven</h2></div></div></div><p>When<a class="indexterm" id="id1154"/> data pushing or data pulling is <a class="indexterm" id="id1155"/>combined with the use of events or timers, there <a class="indexterm" id="id1156"/>is no longer a need for end user interference. The interface will then run automatically.</p><p>We will discuss these methods in detail later in this chapter when we discuss interface methodologies.</p></div></div></div>
<div class="section" title="Interfacing technologies"><div class="titlepage"><div><div><h1 class="title"><a id="ch09lvl1sec62"/>Interfacing technologies</h1></div></div></div><p>In <a class="indexterm" id="id1157"/>Microsoft Dynamics NAV, there are a wide range of methods to interface. Each method is useful for certain types of interfacing and less useful for other types. We will discuss all available methods in the C/SIDE development<a class="indexterm" id="id1158"/> platform.</p><div class="section" title="File"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec179"/>File</h2></div></div></div><p>Flat files<a class="indexterm" id="id1159"/> and XML files are both supported by Microsoft <a class="indexterm" id="id1160"/>Dynamics NAV. Flat files have been available since the introduction of the product in 1995 using data ports for the classic clients.</p><p>XML support was introduced in Version 3.60 as an extra option for data ports. Version 4.0 introduced the <code class="literal">XMLPort</code> object that replaced the data port for importing and exporting XML files.</p><p>Currently in Microsoft Dynamics NAV 2013, <code class="literal">XMLPort</code> objects are used both for XML and flat files. Additionally, C/AL has a <code class="literal">FILE</code> object that can be used to access files directly without using <code class="literal">XMLPort</code> objects.</p></div><div class="section" title="Automation control"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec180"/>Automation control</h2></div></div></div><p>The <a class="indexterm" id="id1161"/>implementation for Microsoft COM and <a class="indexterm" id="id1162"/>ActiveX in Microsoft Dynamics NAV is referred to as automation control.</p><p>Automation control or ActiveX allows software applications to be reused as an embedded part of another application. Most Microsoft applications support being used in such a way. Examples are Microsoft Office, Windows Scripting <a class="indexterm" id="id1163"/>Host, and <span class="strong"><strong>ActiveX Data Objects</strong></span> (<span class="strong"><strong>ADO</strong></span>).</p><p>Microsoft Dynamics NAV has support for automation control. Consuming automation control is done using interfaces exposing methods and properties. </p><p>The most commonly used and generic interface is iUnknown. This is also the only automation control interface supported by Microsoft Dynamics NAV. If the automation control uses other interfaces, a wrapper should be created in Visual Studio transforming the interface to iUnknown. We should also create a wrapper when the automation control needs to be embedded using a form control.</p><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note53"/>Note</h3><p>More<a class="indexterm" id="id1164"/> information about the iUnknown interface and COM technology can be found at <a class="ulink" href="http://en.wikipedia.org/wiki/IUnknown">http://en.wikipedia.org/wiki/IUnknown</a>.</p></div></div><div class="section" title="Events"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl4sec27"/>Events</h3></div></div></div><p>Most<a class="indexterm" id="id1165"/> automation controls allow data to be pushed. Using<a class="indexterm" id="id1166"/> events for automation control, it is also possible to start business logic in Microsoft Dynamics NAV when something happens in the other application.</p></div><div class="section" title="Limitations"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl4sec28"/>Limitations</h3></div></div></div><p>In <a class="indexterm" id="id1167"/>Microsoft Dynamics NAV 2013, automation control can only be used from the client side. All code that runs on the server side cannot use automation control objects.</p></div></div><div class="section" title="DotNet interoperability"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec181"/>DotNet interoperability</h2></div></div></div><p>The <a class="indexterm" id="id1168"/>support of .NET was introduced<a class="indexterm" id="id1169"/> as a replacement for automation control. It is possible to use a wide range of .NET objects directly in C/AL programming language. They can be used in both server side and client side.</p><p>Within the standard application, most automation interfaces are replaced with .NET interfaces such as the Excel interface, which we will discuss later in this chapter.</p><p>There are limitations using .NET in Microsoft Dynamics NAV, which are typically solved by creating wrapper DLL objects in C#. The Excel interface is an example of that too.</p><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note54"/>Note</h3><p>A good place to start learning about .NET in C/AL is <a class="ulink" href="http://www.vjeko.com">www.vjeko.com</a>. The limitations are discussed at <a class="ulink" href="http://vjeko.com/blog/top-10-things-i-miss-in-net-interoperability-in-nav-2013">http://vjeko.com/blog/top-10-things-i-miss-in-net-interoperability-in-nav-2013</a>.</p></div></div></div><div class="section" title="Client extensibility"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec182"/>Client extensibility</h2></div></div></div><p>Using <a class="indexterm" id="id1170"/>the page objects, the level of allowed<a class="indexterm" id="id1171"/> creativity in the user interface is very limited since the page objects do not provide WYSIWYG capabilities or allow the developer to determine control positions. Each client determines how the UI is rendered and the developer has no control. This is solved using client extensibility. This technology allows using all UI capabilities that Visual Studio and .NET offer, however, when developing for cross-platform, JavaScript should be used.</p><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note55"/>Note</h3><p>Refer to <a class="ulink" href="https://www.youtube.com/watch?v=WErBd1mlZFM">https://www.youtube.com/watch?v=WErBd1mlZFM</a> to learn how to get started with JavaScript add-ins for Microsoft Dynamics NAV.</p></div></div></div><div class="section" title="Open Database Connectivity (ODBC)/ADO"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec183"/>Open Database Connectivity (ODBC)/ADO</h2></div></div></div><p>
<span class="strong"><strong>Open Database Connectivity</strong></span> (<span class="strong"><strong>ODBC</strong></span>) was developed<a class="indexterm" id="id1172"/> in 1992 with the goal of allowing <a class="indexterm" id="id1173"/>all types of databases to exchange data in a unified way. ADO is the successor of ODBC and was developed in 1996.</p><p>ADO and ODBC for Microsoft Dynamics NAV allows both reading and writing in the application database as well as reading and writing to other databases.</p><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note56"/>Note</h3><p>Using ADO and ODBC more advanced requires basic knowledge of T-SQL Statements. Refer to <a class="ulink" href="http://www.differencebetween.com/difference-between-odbc-and-vs-ado/">http://www.differencebetween.com/difference-between-odbc-and-vs-ado/</a> for the differences between ADO and ODBC.</p></div></div><div class="section" title="Reading from Microsoft Dynamics NAV"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec188"/>Reading from Microsoft Dynamics NAV</h3></div></div></div><p>To read<a class="indexterm" id="id1174"/> data from the <a class="indexterm" id="id1175"/>database, you only need to have a valid ODBC driver installed on the Windows machine that you are using and credentials to log in to the database.</p><p>Let's create an example to import data from Microsoft Dynamics NAV using Excel.</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open Microsoft Excel and select <span class="strong"><strong>Data</strong></span> and then select <span class="strong"><strong>From SQL Server</strong></span> form <span class="strong"><strong>From Other Sources</strong></span>, as shown in the following screenshot:<div class="mediaobject"><img alt="Reading from Microsoft Dynamics NAV" src="graphics/0365EN_09_02.jpg"/><div class="caption"><p>From SQL Server</p></div></div></li><li class="listitem">Select a <span class="strong"><strong>Server name</strong></span> and valid <span class="strong"><strong>Credentials</strong></span>:<div class="mediaobject"><img alt="Reading from Microsoft Dynamics NAV" src="graphics/0365EN_09_03.jpg"/></div></li><li class="listitem">Select <a class="indexterm" id="id1176"/>a database <a class="indexterm" id="id1177"/>and the table that you want to view. In our example, we will select the <span class="strong"><strong>Customer</strong></span> table. Then select <span class="strong"><strong>Finish</strong></span> and <span class="strong"><strong>OK</strong></span>.<div class="mediaobject"><img alt="Reading from Microsoft Dynamics NAV" src="graphics/0365EN_09_04.jpg"/></div></li><li class="listitem">We now have the Microsoft Dynamics NAV Data in Excel.<div class="mediaobject"><img alt="Reading from Microsoft Dynamics NAV" src="graphics/0365EN_09_05.jpg"/></div><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note57"/>Note</h3><p>Since flow fields are not actual fields in the SQL Server database, we cannot use them in ODBC/ADO.</p></div></div></li></ol></div></div><div class="section" title="Writing to Microsoft Dynamics NAV"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec189"/>Writing to Microsoft Dynamics NAV</h3></div></div></div><p>Directly <a class="indexterm" id="id1178"/>writing data to the <a class="indexterm" id="id1179"/>Microsoft Dynamics NAV database using ODBC is not recommended as best practice. The reason for this is the missing business logic at this interface level.</p><p>When writing via ODBC, we directly address SQL Server without allowing the C/AL business logic to validate the data we create. The C/AL data normally ensures data integrity for the business rules we develop. The same applies when using the C/ODBC driver for the native database.</p><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note58"/>Note</h3><p>To work around this issue, the data can be saved in a special interface buffer table and processed by a C/AL transaction using an application server or started from the user interface.</p></div></div></div><div class="section" title="Talking to other databases"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec190"/>Talking to other databases</h3></div></div></div><p>To<a class="indexterm" id="id1180"/> use ODBC to read and write data from Microsoft Dynamics NAV to other databases, it is recommended to use <span class="strong"><strong>ActiveX Data Objects</strong></span> (<span class="strong"><strong>ADO</strong></span>). ADO is a Microsoft technology that allows using an ActiveX<a class="indexterm" id="id1181"/> interface to connect using ODBC. Using ADO allows us to both read and write to the database on the other end.</p><p>We <a class="indexterm" id="id1182"/>could even use ADO to connect to the Microsoft Dynamics NAV SQL Server database and run SQL Statements from C/AL code.</p><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note59"/>Note</h3><p>We will use ADO in the interface methodology section of this chapter.</p></div></div></div></div><div class="section" title="SQL Server interfacing"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec184"/>SQL Server interfacing</h2></div></div></div><p>Since<a class="indexterm" id="id1183"/> Microsoft Dynamics NAV runs<a class="indexterm" id="id1184"/> on top of a SQL Server database, we can use all available technologies in SQL Server to get data in and out. This offers a wide range of options that go beyond the scope of this book, but let's briefly discuss some of them:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Linked Servers</strong></span>: In SQL Server, it is possible to set up linked servers. This allows<a class="indexterm" id="id1185"/> us to send queries to other databases such as other SQL Servers, MS Access, or Oracle and create views based on this data.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Views</strong></span>: A view in<a class="indexterm" id="id1186"/> SQL Server is a saved query with a fixed result set that can be interpreted as a table. In C/Side, we can use a view as a data source for a table using the Linked Object property and create a page or report based on this data source.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>SQL Server Integration Services</strong></span>: This replaces<a class="indexterm" id="id1187"/> DTS Packages as the primary component for SQL Server to integrate with other databases. Using SSIS requires good knowledge and skills of both SQL Server and Microsoft Dynamics NAV.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Reporting Services</strong></span>: This is a <a class="indexterm" id="id1188"/>server-based reporting platform that can be integrated with SharePoint allowing users to design RDL reports based on T-SQL queries.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Analysis Services</strong></span>: This is Microsoft's answer to the OLAP, BI, and data mining<a class="indexterm" id="id1189"/> requirements of their customers.<div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="tip50"/>Tip</h3><p>Another SQL Server component we can use is the SQL Server Agent. This component allows us to schedule interface tasks that run directly on the database.</p></div></div></li></ul></div></div><div class="section" title="Microsoft Message Queue"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec185"/>Microsoft Message Queue</h2></div></div></div><p>
<span class="strong"><strong>Microsoft Message Queue</strong></span> (<span class="strong"><strong>MSMQ</strong></span>) allows applications <a class="indexterm" id="id1190"/>to integrate that run asynchronously with an unreliable connection. This interfacing technology is very popular<a class="indexterm" id="id1191"/> for websites that use information from Microsoft Dynamics NAV and send information back to the database.</p><p>The introduction of .NET Interoperability made using MSMQ in combination with Microsoft Dynamics NAV much easier. Using <code class="literal">System.Messaging.MessageQueue</code> only a few lines of C/AL code are required to post a message on a queue.</p><div class="section" title="Application server"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec191"/>Application server</h3></div></div></div><p>MSMQ<a class="indexterm" id="id1192"/> is always combined with using an application<a class="indexterm" id="id1193"/> server to handle the requests sent back by the website.</p><div class="mediaobject"><img alt="Application server" src="graphics/0365EN_09_07.jpg"/></div><p>The web users can be employees from the company using a web solution for timesheet registration or a PDA or customers using a web shop.</p><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note60"/>Note</h3><p>This blog entry at <a class="ulink" href="http://mibuso.com/blogs/ara3n/2011/01/10/using-ado-on-rtc-in-nav/">http://mibuso.com/blogs/ara3n/2011/01/10/using-ado-on-rtc-in-nav/</a> explains how to get started with MSMQ using .NET.</p></div></div></div></div><div class="section" title="Web services"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec186"/>Web services</h2></div></div></div><p>When it comes to real-time interfacing, web services is the first technology of choice. Web services allows you to use function libraries from applications inside other applications.</p><p>Microsoft<a class="indexterm" id="id1194"/> Dynamics NAV 2013 allows you to <a class="indexterm" id="id1195"/>expose all C/AL code as a web service using SOAP and OData protocols.</p><p>Consuming web services is a lot more difficult than exposing one. There is no standard framework of doing so. The two most commonly used solutions are consuming using XMLDOM .NET interop objects or wrapping the web service inside a Visual Studio <code class="literal">.dll</code> using service references.</p><div class="section" title="Exposing a NAV web service"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec192"/>Exposing a NAV web service</h3></div></div></div><p>In <a class="indexterm" id="id1196"/>Microsoft Dynamics NAV 2013, every <code class="literal">Page</code> object<a class="indexterm" id="id1197"/> and most codeunits can be exposed as a web service. This can be done using the <span class="strong"><strong>Web Service Table (2000000076)</strong></span>.</p><div class="mediaobject"><img alt="Exposing a NAV web service" src="graphics/0365EN_09_08.jpg"/></div><p>To publish a web service, select the object type and object ID and find a unique service name. Then select the <span class="strong"><strong>Published</strong></span> checkmark.</p><p>When publishing a web service, the URL is displayed making it easier to find it.</p></div><div class="section" title="Consuming a Microsoft Dynamics NAV web service"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec193"/>Consuming a Microsoft Dynamics NAV web service</h3></div></div></div><p>To consume the web service, an <a class="indexterm" id="id1198"/>address, <code class="literal">http://&lt;Server&gt;:&lt;WebServicePort&gt;/&lt;ServerInstance&gt;/WS/&lt;CompanyName&gt;/</code>, is generated <a class="indexterm" id="id1199"/>that is called from the other application.</p><div class="mediaobject"><img alt="Consuming a Microsoft Dynamics NAV web service" src="graphics/0365EN_09_09.jpg"/></div><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note61"/>Note</h3><p>The <code class="literal">SystemService</code> web service is always available and returns a list of available company names.</p></div></div></div></div></div>
<div class="section" title="Standard application interfaces"><div class="titlepage"><div><div><h1 class="title"><a id="ch09lvl1sec63"/>Standard application interfaces</h1></div></div></div><p>We<a class="indexterm" id="id1200"/> discussed all the available interface technologies for Microsoft Dynamics NAV. Let's have a look at how this has been implemented in the standard product.</p><p>In this book, we will not explore each interface in depth since that would almost require another book. We will just briefly discuss where to find all technologies we discussed in the standard application and indicate where a white paper or website can be found.</p><p>An example of flat file is Exporting Contacts. Microsoft Dynamics NAV allows us to export our contacts using an <span class="strong"><strong>XMLPort</strong></span>.</p><p>The <span class="strong"><strong>XMLPort</strong></span> for this functionality has number (5050) and uses the Format Variable Text. Other options are <span class="strong"><strong>Xml</strong></span> and <span class="strong"><strong>Fixed Text</strong></span>, as shown in the following screenshot:</p><div class="mediaobject"><img alt="Standard application interfaces" src="graphics/0365EN_09_11.jpg"/></div><p>
<span class="strong"><strong>XMLPorts</strong></span> have a node structure like pages. The <span class="strong"><strong>XMLPort</strong></span> starts with integer table as the first data type followed by the <span class="strong"><strong>Contact table</strong></span> fields.</p><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note62"/>Note</h3><p>More information about programming <span class="strong"><strong>XMLPorts</strong></span> can be found in <span class="emphasis"><em>Programming Dynamics NAV 2013</em></span>, <span class="emphasis"><em>David A. Studebaker</em></span>, <span class="emphasis"><em>Christopher D. Studebaker</em></span>, <span class="emphasis"><em>Packt Publishing</em></span>.</p></div></div><div class="section" title="Office integration"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec187"/>Office integration</h2></div></div></div><p>Microsoft <a class="indexterm" id="id1201"/>Dynamics NAV and Microsoft<a class="indexterm" id="id1202"/> Office are integrated to use with Word, Excel, and Outlook. We will first discuss the standard Word and Excel integration and discuss alternatives later. Lastly, we will briefly discuss the possibilities for Outlook integration.</p><div class="section" title="Word and Excel integration"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec194"/>Word and Excel integration</h3></div></div></div><p>In <a class="indexterm" id="id1203"/>Microsoft Dynamics NAV, each form or page can be <a class="indexterm" id="id1204"/>exported to Word and Excel. This<a class="indexterm" id="id1205"/> built-in <a class="indexterm" id="id1206"/>technology is automatically provided by the user interface and requires no effort from developers.</p><div class="mediaobject"><img alt="Word and Excel integration" src="graphics/0365EN_09_12.jpg"/><div class="caption"><p>Default presence of Excel and Word</p></div></div><div class="section" title="Style sheet tool"><div class="titlepage"><div><div><h4 class="title"><a id="ch09lvl4sec29"/>Style sheet tool</h4></div></div></div><p>To be <a class="indexterm" id="id1207"/>more flexible in the layout, Microsoft has released a style sheet tool for Microsoft Dynamics NAV and Word. This tool allows users to easily generate style sheets.</p><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note63"/>Note</h3><p>The<a class="indexterm" id="id1208"/> style sheet tool Version 3.0 can be downloaded from <a class="ulink" href="http://www.mibuso.com/dlinfo.asp?FileID=1543">http://www.mibuso.com/dlinfo.asp?FileID=1543</a>.</p></div></div><div class="mediaobject"><img alt="Style sheet tool" src="graphics/0365EN_09_13.jpg"/></div><p>The manual provided with the style sheet tool gives a good description about how to create the style sheets.</p><div class="mediaobject"><img alt="Style sheet tool" src="graphics/0365EN_09_14.jpg"/></div><p>Add the action to the action designer (under the appropriate group) with the following properties:</p><div class="informalexample"><pre class="programlisting">Expanded    Type    SubType    Name                Caption
0           Action             &lt;Action680&gt;         Style Sheets</pre></div><p>The <code class="literal">OnAction</code> trigger should contain the following line:</p><div class="informalexample"><pre class="programlisting">StyleSheetDataMgt.LoadStylesheetDataRTC(GETPOSITION,
  CURRENTKEY,PAGE::"&lt;&lt;PageName&gt;&gt;");</pre></div><p>Here, <code class="literal">StyleSheetDataMgt</code> is a variable of type codeunit, 682 (Style Sheet Data Management).</p><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note64"/>Note</h3><p>When this action is done for one page, it can be easily copied and pasted to other pages. Make sure you change the page name.</p></div></div></div></div></div><div class="section" title="Advanced Excel integration"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec188"/>Advanced Excel integration</h2></div></div></div><p>When <a class="indexterm" id="id1209"/>exporting information to Excel that needs to be combined from different parts of the application, using style <a class="indexterm" id="id1210"/>sheets is not the ideal way.</p><p>To support this, the <span class="strong"><strong>Excel Buffer</strong></span> table (370) can be used. This table can be populated with data and then sent to Excel using a simple C/AL command.</p><p>This is used in several parts of the application, for example, to import and export the budgets we discussed in <a class="link" href="ch03.html" title="Chapter 3. Financial Management">Chapter 3</a>, <span class="emphasis"><em>Financial Management</em></span>.</p><p>Let's create a sample codeunit that exports data to Excel using the Excel Buffer table:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Create a new codeunit and define a global variable of type record Excel buffer. This needs to be a temporary variable. Also, define the other variables as displayed in the following screenshot:<div class="mediaobject"><img alt="Advanced Excel integration" src="graphics/0365EN_09_15.jpg"/></div><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note65"/>Note</h3><p>Temporary record variables are not stored in the database; they're stored in the client memory. This allows multiple users to create the same records without blocking each other. It is also faster since all handling is done without the network and database.</p></div></div></li><li class="listitem">Create a new <code class="literal">EnterCell</code> function with the parameters displayed in the following screenshot:<div class="mediaobject"><img alt="Advanced Excel integration" src="graphics/0365EN_09_16.jpg"/></div></li><li class="listitem">Put<a class="indexterm" id="id1211"/> the C/AL code<a class="indexterm" id="id1212"/> in place that will handle the interface:<div class="informalexample"><pre class="programlisting">OnRun()
ExcelBufTemp.CreateBook(Cust.TABLECAPTION);

Cust.FIND('-');
REPEAT
  RowNo := RowNo + 1;
  EnterCell(RowNo, 1, Cust."No.", FALSE, FALSE, '');

  FormAddr.Customer(Addr, Cust);
  EnterCell(RowNo, 2, Addr[1], FALSE, FALSE, '');
  EnterCell(RowNo, 3, Addr[2], FALSE, FALSE, '');
  EnterCell(RowNo, 4, Addr[3], FALSE, FALSE, '');
  EnterCell(RowNo, 5, Addr[4], FALSE, FALSE, '');
  EnterCell(RowNo, 6, Addr[5], FALSE, FALSE, '');
  EnterCell(RowNo, 7, Addr[6], FALSE, FALSE, '');
  EnterCell(RowNo, 8, Addr[7], FALSE, FALSE, '');
  EnterCell(RowNo, 9, Addr[8], FALSE, FALSE, '');

UNTIL Cust.NEXT = 0;

ExcelBufTemp.WriteSheet(Cust.TABLECAPTION,COMPANYNAME,USERID);
ExcelBufTemp.CloseBook;
ExcelBufTemp.OpenExcel;
ExcelBufTemp.GiveUserControl;
EnterCell()
ExcelBufTemp.INIT;
ExcelBufTemp.VALIDATE("Row No.",RowNo);
ExcelBufTemp.VALIDATE("Column No.",ColumnNo);
ExcelBufTemp."Cell Value as Text" := CellValue;
ExcelBufTemp.Formula := '';
ExcelBufTemp.Bold := Bold;
ExcelBufTemp.Underline := UnderLine;
ExcelBufTemp.NumberFormat := NumberFormat;
ExcelBufTemp.INSERT;</pre></div></li></ol></div><p>This C/AL<a class="indexterm" id="id1213"/> code will browse the <a class="indexterm" id="id1214"/>customers in the database and format the addresses using the Address Format (365) codeunit.</p><p>The <span class="strong"><strong>Customer No.</strong></span> field and the result array <code class="literal">Addr[]</code> are saved in the Excel buffer table. Lastly, we start the C/AL functions to generate the Excel spreadsheet based on the data.</p><div class="mediaobject"><img alt="Advanced Excel integration" src="graphics/0365EN_09_17.jpg"/><div class="caption"><p>C/AL functions result</p></div></div></div><div class="section" title="Outlook integration"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec189"/>Outlook integration</h2></div></div></div><p>Microsoft <a class="indexterm" id="id1215"/>Dynamics NAV 2013 allows <a class="indexterm" id="id1216"/>different levels of interfacing with Microsoft Outlook:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">The Outlook part on the Role Center.</li><li class="listitem">Sending e-mails from pages using the <code class="literal">ExtendedDatatype</code> property.</li><li class="listitem">Using the Mail (397) or SMTP Mail (400) codeunits to send e-mails.</li><li class="listitem">Synchronize contacts and to-do's using the Outlook integration web service.</li><li class="listitem">Reading e-mail from exchange using the <span class="strong"><strong>E-Ma</strong></span><span class="strong"><strong>il – Logging</strong></span> functionality.</li><li class="listitem">Microsoft Dynamics NAV 2013 R2 can be connected to Office 365.</li></ol></div><div class="section" title="Outlook part"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec195"/>Outlook part</h3></div></div></div><p>On a Role <a class="indexterm" id="id1217"/>Center it is possible to activate the Outlook<a class="indexterm" id="id1218"/> System Part. This allows users to see their e-mail, agenda, and tasks directly on the Role Center.</p><div class="mediaobject"><img alt="Outlook part" src="graphics/0365EN_09_18.jpg"/></div><p>This functionality is built in the Windows client and cannot be changed using C/AL Code.</p></div><div class="section" title="ExtendedDatatype property"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec196"/>ExtendedDatatype property</h3></div></div></div><p>When<a class="indexterm" id="id1219"/> a <span class="strong"><strong>Text</strong></span> field in a table uses<a class="indexterm" id="id1220"/> the <code class="literal">ExtendedDatatype</code> property, <span class="strong"><strong>E-Mail</strong></span> the Windows client will automatically allow the users to directly send an e-mail to the address specified in the field.</p><div class="mediaobject"><img alt="ExtendedDatatype property" src="graphics/0365EN_09_19.jpg"/></div><p>This is also built-in functionality in the Windows client that cannot be influenced by C/AL code.</p><div class="mediaobject"><img alt="ExtendedDatatype property" src="graphics/0365EN_09_20.jpg"/></div></div><div class="section" title="Mail and SMTP mail codeunits"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec197"/>Mail and SMTP mail codeunits</h3></div></div></div><p>Before<a class="indexterm" id="id1221"/> the<a class="indexterm" id="id1222"/> introduction <a class="indexterm" id="id1223"/>of the <code class="literal">ExtendedDatatype</code> property, the<a class="indexterm" id="id1224"/> e-mails from Microsoft Dynamics NAV were sent using an Automation Control wrapper DLL to Microsoft Outlook. This is handled in codeunit 397 and can still be used to send e-mails directly From C/AL code.</p><p>Codeunit SMTP Mail (400) allows us to send e-mails directly to an SMTP server.</p></div><div class="section" title="Outlook synchronization"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec198"/>Outlook synchronization</h3></div></div></div><p>Microsoft <a class="indexterm" id="id1225"/>Outlook can be used as an <a class="indexterm" id="id1226"/>offline client for Microsoft Dynamics NAV. Every table can be synchronized to Microsoft Outlook when a connection with both systems is available. Using the Offline functionality in Outlook, users can view the data when they are on the road and even change the information or create new data.</p><p>This is done using the Outlook Synchronization web service that we discussed earlier this chapter.</p><div class="mediaobject"><img alt="Outlook synchronization" src="graphics/0365EN_09_21.jpg"/></div><p>The functionality is well documented by Microsoft.</p></div><div class="section" title="Exchange integration"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec199"/>Exchange integration</h3></div></div></div><p>To read <a class="indexterm" id="id1227"/>incoming e-mails, Microsoft Dynamics <a class="indexterm" id="id1228"/>NAV offers integration with Exchange Public folders. Information in these mailboxes can be read and used in Microsoft Dynamics NAV.</p><p>The handling of the interface is done using the Job Queue and the Application Server (NAS).</p><p>In the <span class="strong"><strong>Marketing Setup</strong></span>, which we discussed in <a class="link" href="ch04.html" title="Chapter 4. Relationship Management">Chapter 4</a>, <span class="emphasis"><em>Relationship Management</em></span>, we can set up the parameters for the exchange integration.</p><div class="mediaobject"><img alt="Exchange integration" src="graphics/0365EN_09_22.jpg"/></div><div class="section" title="Interaction log entries"><div class="titlepage"><div><div><h4 class="title"><a id="ch09lvl4sec30"/>Interaction log entries</h4></div></div></div><p>Each <a class="indexterm" id="id1229"/>e-mail read from Microsoft Exchange is<a class="indexterm" id="id1230"/> displayed in Microsoft Dynamics NAV as an interaction log entry.</p></div></div><div class="section" title="Office 365"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec200"/>Office 365</h3></div></div></div><p>Starting from version 2013 R2, Microsoft Dynamics NAV can be integrated into Office 365. This is<a class="indexterm" id="id1231"/> a cosmetic integration, which means from an<a class="indexterm" id="id1232"/> end-user perspective the applications are one and the same; however, the applications do not share data.</p><p>Microsoft Dynamics NAV can be set up to accept the Office 365 credentials, which makes it very easy for users to log in only once and use both platforms.</p><div class="mediaobject"><img alt="Office 365" src="graphics/0365EN_09_23.jpg"/><div class="caption"><p>Login with the Office 365 credentials</p></div></div></div></div><div class="section" title="SharePoint"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec190"/>SharePoint</h2></div></div></div><p>Microsoft Dynamics NAV 2013 RTM was shipped with a special SharePoint client. However, since<a class="indexterm" id="id1233"/> this was directly discontinued in R2 we will not discuss this.</p><p>In <a class="indexterm" id="id1234"/>Microsoft Dynamics NAV 2013 R2, the web client is SharePoint-compliant. To use Microsoft Dynamics NAV 2013 R2 in combination with SharePoint, it is possible to add web parts that connect to the web client.</p><p>It is possible to connect to both the on premise version of SharePoint and SharePoint Online.</p></div><div class="section" title="Client add-ins"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec191"/>Client add-ins</h2></div></div></div><p>Microsoft<a class="indexterm" id="id1235"/> Dynamics NAV 2013 ships with <a class="indexterm" id="id1236"/>one client add-in for Microsoft Connect. An example page object that uses the Connect control is Connect (9175).</p><div class="mediaobject"><img alt="Client add-ins" src="graphics/0365EN_09_25.jpg"/></div><p>Let's have a look at how this done.</p><div class="mediaobject"><img alt="Client add-ins" src="graphics/0365EN_09_26.jpg"/></div><p>The<a class="indexterm" id="id1237"/> page type of this page is <span class="strong"><strong>CardPart</strong></span> and <a class="indexterm" id="id1238"/>it has no source table. The only control on the page is <span class="strong"><strong>Parameters</strong></span>, which is a function with a Text (350) return value.</p><p>The <code class="literal">ControlAddIn</code> property points to the add-in that will be used when this page is started. This<a class="indexterm" id="id1239"/> add-in will replace the original control on the page.</p><p>In the <code class="literal">Parameters</code> function, a string is created to feed information into the connect add-in enabling it to show information that is interesting for the current role. This is done using a combination of other C/AL functions:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>Parameters()</strong></span>
InitCurrentRoleValues;

EXIT(Add(Version) + Add(Locale) + Add(Role) + Add(RoleID) + 
  Add(Serial));

<span class="strong"><strong>Add()</strong></span>
EXIT(Parameter + Separator);

<span class="strong"><strong>Version()</strong></span>
EXIT('version=' + FORMAT(ApplicationManagement.ApplicationVersion + ':' + 
  ApplicationManagement.ApplicationBuild,0,XMLFormat));

<span class="strong"><strong>Locale()</strong></span>
// Windows Language ID
EXIT('locale=' + FORMAT(CurrentLanguageID,0,XMLFormat));

Role()
// Profile ID (Any text entered in Profile ID)
EXIT('role=' + FORMAT(DELCHR(CurrentRole,'=',Separator),0,
  XMLFormat));

<span class="strong"><strong>RoleID()</strong></span>
// Role Center ID (Page ID)
EXIT('roleid=' + FORMAT(CurrentRoleID,0,XMLFormat));

<span class="strong"><strong>Serial()</strong></span>
// License ID
EXIT('serial=' + FORMAT(SERIALNUMBER,0,XMLFormat));

<span class="strong"><strong>Separator()</strong></span>
EXIT(';');

<span class="strong"><strong>XMLFormat()</strong></span>
EXIT(9);

<span class="strong"><strong>InitCurrentRoleValues()</strong></span>
CurrentLanguageID := GLOBALLANGUAGE;
CurrentRoleID := ApplicationManagement.DefaultRoleCenter;
CurrentRole := FORMAT(CurrentRoleID);
...</pre></div><p>In <a class="link" href="ch07.html" title="Chapter 7. Storage and Logistics">Chapter 7</a>, <span class="emphasis"><em>Storage and Logistics</em></span>, Client Extensibility and Bing Maps are used to show the<a class="indexterm" id="id1240"/> stops of a route on a map.</p><p>The <a class="indexterm" id="id1241"/>available libraries are stored in the client add-in table (2000000069).</p></div></div>
<div class="section" title="Interface methodologies"><div class="titlepage"><div><div><h1 class="title"><a id="ch09lvl1sec64"/>Interface methodologies</h1></div></div></div><p>So now <a class="indexterm" id="id1242"/>we have discussed interface types, interface technologies, and the built-in interfaces in Microsoft Dynamics NAV.</p><p>Let's design and develop a new business to business interface. We will use the objects from <a class="link" href="ch07.html" title="Chapter 7. Storage and Logistics">Chapter 7</a>, <span class="emphasis"><em>Storage and Logistics</em></span>, to create the interface.</p><div class="section" title="The scenario"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec192"/>The scenario</h2></div></div></div><p>One of our<a class="indexterm" id="id1243"/> customers wants to e-mail the shipments<a class="indexterm" id="id1244"/> from now on instead of faxing. The e-mail will contain an Excel file in a predefined format.</p></div><div class="section" title="The design"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec193"/>The design</h2></div></div></div><p>Let's bring <a class="indexterm" id="id1245"/>back the data model we designed for the <a class="indexterm" id="id1246"/>logistics part of the solution in <a class="link" href="ch07.html" title="Chapter 7. Storage and Logistics">Chapter 7</a>, <span class="emphasis"><em>Storage and Logistics</em></span>.</p><div class="mediaobject"><img alt="The design" src="graphics/0365EN_09_27.jpg"/></div><p>The process starts in the registration table. From a registration, we generate shipments and shipments are combined into a Route with stops.</p><p>So we need to move the data from the Excel sheet to the registration table.</p><div class="section" title="The mapping"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec201"/>The mapping</h3></div></div></div><p>When a <a class="indexterm" id="id1247"/>customer delivers us an Excel sheet with information, it seldom happens that they exactly use the same fields as our table. Therefore, we need to create a mapping. Each field in the Excel sheet needs to be mapped to a field and missing fields need to be identified and discussed.</p><p>The Excel Sheet we get from the customer looks like this:</p><div class="mediaobject"><img alt="The mapping" src="graphics/0365EN_09_28.jpg"/></div><p>Let's try to <a class="indexterm" id="id1248"/>map this information to our Logistics Registration Worksheet table, as follows:</p><div class="informaltable"><table border="1"><colgroup><col style="text-align: left"/><col style="text-align: left"/><col style="text-align: left"/><col style="text-align: left"/><col style="text-align: left"/></colgroup><thead><tr><th style="text-align: left" valign="bottom">
<p>Field number</p>
</th><th style="text-align: left" valign="bottom">
<p>Field name</p>
</th><th style="text-align: left" valign="bottom">
<p>Data type</p>
</th><th style="text-align: left" valign="bottom">
<p>Length</p>
</th><th style="text-align: left" valign="bottom">
<p>Mapped field</p>
</th></tr></thead><tbody><tr><td style="text-align: left" valign="top">
<p>1</p>
</td><td style="text-align: left" valign="top">
<p>Registration Batch</p>
</td><td style="text-align: left" valign="top">
<p>Code</p>
</td><td style="text-align: left" valign="top">
<p>10</p>
</td><td style="text-align: left" valign="top">
<p>-</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>2</p>
</td><td style="text-align: left" valign="top">
<p>Line No.</p>
</td><td style="text-align: left" valign="top">
<p>Integer</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>-</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>6</p>
</td><td style="text-align: left" valign="top">
<p>Shipment Date</p>
</td><td style="text-align: left" valign="top">
<p>Date</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>Date</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>8</p>
</td><td style="text-align: left" valign="top">
<p>Product No.</p>
</td><td style="text-align: left" valign="top">
<p>Code</p>
</td><td style="text-align: left" valign="top">
<p>20</p>
</td><td style="text-align: left" valign="top">
<p>Goods Code</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>10</p>
</td><td style="text-align: left" valign="top">
<p>Description</p>
</td><td style="text-align: left" valign="top">
<p>Text</p>
</td><td style="text-align: left" valign="top">
<p>50</p>
</td><td style="text-align: left" valign="top">
<p>Description</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>12</p>
</td><td style="text-align: left" valign="top">
<p>Unit of Measure</p>
</td><td style="text-align: left" valign="top">
<p>Text</p>
</td><td style="text-align: left" valign="top">
<p>10</p>
</td><td style="text-align: left" valign="top">
<p>-</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>16</p>
</td><td style="text-align: left" valign="top">
<p>Quantity</p>
</td><td style="text-align: left" valign="top">
<p>Decimal</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>Pallets</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>20</p>
</td><td style="text-align: left" valign="top">
<p>Length</p>
</td><td style="text-align: left" valign="top">
<p>Decimal</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>Length</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>21</p>
</td><td style="text-align: left" valign="top">
<p>Width</p>
</td><td style="text-align: left" valign="top">
<p>Decimal</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>Width</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>22</p>
</td><td style="text-align: left" valign="top">
<p>Height</p>
</td><td style="text-align: left" valign="top">
<p>Decimal</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>Height</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>31</p>
</td><td style="text-align: left" valign="top">
<p>Gross Weight</p>
</td><td style="text-align: left" valign="top">
<p>Decimal</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>-</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>32</p>
</td><td style="text-align: left" valign="top">
<p>Net Weight</p>
</td><td style="text-align: left" valign="top">
<p>Decimal</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>Weight</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>36</p>
</td><td style="text-align: left" valign="top">
<p>Units per Parcel</p>
</td><td style="text-align: left" valign="top">
<p>Decimal</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>-</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>37</p>
</td><td style="text-align: left" valign="top">
<p>Unit Volume</p>
</td><td style="text-align: left" valign="top">
<p>Decimal</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>-</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>53</p>
</td><td style="text-align: left" valign="top">
<p>Ship-to Name</p>
</td><td style="text-align: left" valign="top">
<p>Text</p>
</td><td style="text-align: left" valign="top">
<p>50</p>
</td><td style="text-align: left" valign="top">
<p>Delivery At</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>55</p>
</td><td style="text-align: left" valign="top">
<p>Ship-to Address</p>
</td><td style="text-align: left" valign="top">
<p>Text</p>
</td><td style="text-align: left" valign="top">
<p>50</p>
</td><td style="text-align: left" valign="top">
<p>Address</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>57</p>
</td><td style="text-align: left" valign="top">
<p>Ship-to City</p>
</td><td style="text-align: left" valign="top">
<p>Text</p>
</td><td style="text-align: left" valign="top">
<p>30</p>
</td><td style="text-align: left" valign="top">
<p>City</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>58</p>
</td><td style="text-align: left" valign="top">
<p>Ship-to Contact</p>
</td><td style="text-align: left" valign="top">
<p>Text</p>
</td><td style="text-align: left" valign="top">
<p>50</p>
</td><td style="text-align: left" valign="top">
<p>-</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>59</p>
</td><td style="text-align: left" valign="top">
<p>Ship-to Post Code</p>
</td><td style="text-align: left" valign="top">
<p>Code</p>
</td><td style="text-align: left" valign="top">
<p>20</p>
</td><td style="text-align: left" valign="top">
<p>Postal Code</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>60</p>
</td><td style="text-align: left" valign="top">
<p>Ship-to County</p>
</td><td style="text-align: left" valign="top">
<p>Text</p>
</td><td style="text-align: left" valign="top">
<p>30</p>
</td><td style="text-align: left" valign="top">
<p>-</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>61</p>
</td><td style="text-align: left" valign="top">
<p>Ship-to Country/Region Code</p>
</td><td style="text-align: left" valign="top">
<p>Code</p>
</td><td style="text-align: left" valign="top">
<p>10</p>
</td><td style="text-align: left" valign="top">
<p>-</p>
</td></tr></tbody></table></div><p>Most of the fields in the Excel sheet can be mapped to a field in our table.</p></div><div class="section" title="The gaps"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec202"/>The gaps</h3></div></div></div><p>Some fields<a class="indexterm" id="id1249"/> that are needed in NAV are not populated by the Excel sheet. For some fields this is okay, for example, the <span class="strong"><strong>Registration Batch</strong></span> and <span class="strong"><strong>Line No.</strong></span> fields are determined by the import.</p><p>Some other fields are more difficult. <span class="strong"><strong>Unit of Measure</strong></span>, <span class="strong"><strong>Gross Weight</strong></span>, <span class="strong"><strong>Units per Parcel</strong></span>, and <span class="strong"><strong>Unit Volume</strong></span> are left blank in the Excel sheet, but they are all needed in NAV.</p><p>For these fields, we need to come to an agreement with the customer. They need to either specify these fields or tell us whether they have default values. Let's look at our gaps and fill them in:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Unit of Measure</strong></span>: For this customer it is always "PALLET"</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Volume</strong></span>: This can be calculated using <code class="literal">Length x Width x Height</code></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Gross Weight</strong></span>: We agree that this is equal to net weight</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Units per Parcel</strong></span>: This is always 1</li></ul></div></div><div class="section" title="What if it does not work"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec203"/>What if it does not work</h3></div></div></div><p>Reading <a class="indexterm" id="id1250"/>the external data into the database is just one step in creating a reliable interface.</p><p>But what happens if the customer contacts us and says, "We sent you a file with 10 lines and the shipment document shows 9 lines". When we check our database the shipment does show 9 lines, but there is no way to check whether we imported the original 10 lines. At this stage, the imported Registration lines are deleted and the shipments are generated.</p><p>If this happens, we need traceability. In a well-designed interface, we should always create a table that exactly matches the imported data. This allows us to first check whether everything matches.</p><p>The data from this table can be processed but should not be deleted from the database and periodically cleaned up. This allows us to check whether things go wrong.</p><p>We will demonstrate this in a more advanced example.</p></div></div><div class="section" title="The scenario"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec194"/>The scenario</h2></div></div></div><p>The<a class="indexterm" id="id1251"/> implementation of our storage and logistics<a class="indexterm" id="id1252"/> add-on requires a real-time interface with a Radio Frequency application. The RF scanners are used for the pick process. The RF application uses its own database system with tables we should populate and read afterwards.</p><div class="mediaobject"><img alt="The scenario" src="graphics/0365EN_09_29.jpg"/></div><p>The RF<a class="indexterm" id="id1253"/> application has three tables. Our interface<a class="indexterm" id="id1254"/> needs to export data to the <span class="strong"><strong>Pick Lines </strong></span>table, and it needs<a class="indexterm" id="id1255"/> to<a class="indexterm" id="id1256"/> import data from the two remaining tables, <span class="strong"><strong>Finished Picks</strong></span> and <span class="strong"><strong>Exceptions</strong></span>.</p><div class="section" title="The interface type"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec204"/>The interface type</h3></div></div></div><p>This is <a class="indexterm" id="id1257"/>an import and export interface<a class="indexterm" id="id1258"/> that will use data pushing for the Pick Lines and data pulling for the Finished Picks and Exceptions. The interface will be timer-driven. Every minute we will poll for new data.</p></div><div class="section" title="The interface technology"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec205"/>The interface technology</h3></div></div></div><p>For this<a class="indexterm" id="id1259"/> interface, we will use a<a class="indexterm" id="id1260"/> combination of technologies that we discussed in this chapter. The main technology is DotNet interoperability.</p><div class="section" title="Active data objects"><div class="titlepage"><div><div><h4 class="title"><a id="ch09lvl4sec31"/>Active data objects</h4></div></div></div><p>The <a class="indexterm" id="id1261"/>Picking database runs on SQL Server so <a class="indexterm" id="id1262"/>we will use ADO to connect to the database and send T-SQL Statements to read and write data.</p></div></div><div class="section" title="Logging"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec206"/>Logging</h3></div></div></div><p>In this <a class="indexterm" id="id1263"/>interface, we will enable two types <a class="indexterm" id="id1264"/>of logging. The first log will be to duplicate the RF tables in Microsoft Dynamics NAV and use them as a buffer. A second log will be maintained where we will save a copy of all T-SQL statements we generate. This will enable us to see what we generated if something goes wrong.</p></div><div class="section" title="The design pattern"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec207"/>The design pattern</h3></div></div></div><p>Let's look <a class="indexterm" id="id1265"/>at the design of the interface <a class="indexterm" id="id1266"/>we will be developing for this project:</p><div class="mediaobject"><img alt="The design pattern" src="graphics/0365EN_09_30.jpg"/></div><p>The interface will be controlled from an <span class="strong"><strong>Application Server</strong></span>. Each minute it will execute a codeunit<a class="indexterm" id="id1267"/> that checks whether there are new <span class="strong"><strong>Storage Lines</strong></span> that need to<a class="indexterm" id="id1268"/> be exported. These lines will first be moved to the <span class="strong"><strong>RF Pick Lines</strong></span> buffer<a class="indexterm" id="id1269"/> table and then moved to the RF database using ADO and T-SQL. <span class="strong"><strong>New Finished Picks</strong></span> and <span class="strong"><strong>Exceptions</strong></span> from the RF database will be moved to Microsoft Dynamics NAV using the same technology and can then be processed.</p></div><div class="section" title="The solution"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec208"/>The solution</h3></div></div></div><p>To run<a class="indexterm" id="id1270"/> the interface, we have created three codeunits<a class="indexterm" id="id1271"/> and a table. The SQL Statement table is used to log each interface session.</p><div class="mediaobject"><img alt="The solution" src="graphics/0365EN_09_31.jpg"/></div><p>The <span class="strong"><strong>RF NAS Timer (123.456.730)</strong></span> codeunit is started from the <code class="literal">NASHandler</code> function in codeunit<a class="indexterm" id="id1272"/> <code class="literal">ApplicationManagement</code>. It uses an indefinite loop.</p><div class="mediaobject"><img alt="The solution" src="graphics/0365EN_09_32.jpg"/></div><p>Let's look at the C/AL code that is required to make this work:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>OnRun()</strong></span>

RFInt.CreateConnectionString;
RFLoop(600000);

RFLoop(MilisecondsBetweenPolls : Integer)
WHILE TRUE DO BEGIN
  IF NOT CODEUNIT.RUN(CODEUNIT::"RF Helper") THEN
    ParseError;
  COMMIT;
  MaxMilisecondsSleep := 10000;
  FOR Count := 1 TO MilisecondsBetweenPolls DIV MaxMilisecondsSleep DO
    SLEEP(MaxMilisecondsSleep);
  SLEEP(MilisecondsBetweenPolls MOD MaxMilisecondsSleep);
END;

<span class="strong"><strong>ParseError()</strong></span>
SELECTLATESTVERSION;
RFIntSetup.GET;
SynchID := RFIntSetup."Synchronization ID";

SQLStat.INIT;
SQLStat."SQL Statement 1" := 'ERROR : ' + GETLASTERRORTEXT;

SQLStat.Bold := TRUE;
SQLStat.SessionID := SynchID;
SQLStat.Type := SQLStat.Type::Error;
SQLStat.INSERT(TRUE);
COMMIT;</pre></div><p>The<a class="indexterm" id="id1273"/> <code class="literal">SLEEP</code> function is used to make sure the <a class="indexterm" id="id1274"/>interface only runs each minute. By breaking the <code class="literal">SLEEP</code> function into smaller intervals it is possible to stop the Windows Service that executes this C/AL code in between the <code class="literal">SLEEP</code> command.</p><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="tip51"/>Tip</h3><p>
<code class="literal">GETLASTERRORTEXT</code> is a C/AL function that returns the last error message that was<a class="indexterm" id="id1275"/> generated by the system. It can be used in combination with <code class="literal">IF CODEUNIT.RUN</code> syntax to catch runtime errors.</p></div></div><p>The RF Helper (123.456.732) codeunit is a wrapper codeunit that is used for error catching and maintaining readability.</p><p>During each run of the interface we create a new SQL Statement ID, which we can filter on to trace any errors:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>OnRun()</strong></span>
SELECTLATESTVERSION;
RFIntSetup.GET;
RFIntSetup."Synchronisation ID" := RFIntSetup."Synchronisation ID" + 1;
RFIntSetup.MODIFY;
SynchID := RFIntSetup."Synchronisation ID";

SQLStat.INIT;
SQLStat."SQL Statement 1" := 
  '-SYNCHRONISATION STARTED- ID = ' + FORMAT(SynchID) + ' -';
SQLStat.Bold := TRUE;
SQLStat.SessionID := SynchID;
SQLStat.Type := SQLStat.Type::StartStop;
SQLStat.INSERT(TRUE);

COMMIT;

CLEAR(RFInterface);
RFInterface.SetSynchID(SynchID);

StorageLn.LOCKTABLE;
IF StorageLn.FINDSET THEN REPEAT
  RFInterface.CreatePickLines(StorageLn);
UNTIL StorageLn.NEXT = 0;

COMMIT;

CLEAR(RFInterface);
RFInterface.SetSynchID(SynchID);
RFInterface.ReadFinishedPicks;

COMMIT;

CLEAR(RFInterface);
RFInterface.SetSynchID(SynchID);
RFInterface.ReadExceptions;

COMMIT;

SQLStat.INIT;
SQLStat."SQL Statement 1" := 
  '-SYNCHRONISATION STOPPED- ID = ' + FORMAT(SynchID) + ' -';
SQLStat.Bold := TRUE;
SQLStat.SessionID := SynchID;
SQLStat.Type := SQLStat.Type::StartStop;
SQLStat.INSERT(TRUE);

COMMIT;</pre></div><p>Then the three interface functions are triggered to synchronize the three required tables.</p><div class="section" title="COMMIT"><div class="titlepage"><div><div><h4 class="title"><a id="ch09lvl4sec32"/>COMMIT</h4></div></div></div><p>After each command we execute the <code class="literal">COMMIT</code> statement. This will make sure that everything in the database is stored up to that point. This is necessary since the ADO statements<a class="indexterm" id="id1276"/> we create are outside our transaction. If our interface<a class="indexterm" id="id1277"/> run rolls back, it might synchronize data that is already synchronized.</p><p>The <span class="strong"><strong>RF Interface (123.456.731)</strong></span>. Here, the actual ADO synchronization is done in this codeunit. This<a class="indexterm" id="id1278"/> codeunit is <code class="literal">SingleInstance</code>. This will keep the ADO connection alive during the NAS session:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>CreateConnectionString()</strong></span>
IF ConnActive THEN EXIT;


RFIntSetup.GET;
Database := RFIntSetup."Database Name";
Server := RFIntSetup."Server Name";

ConnString := 'Data Source=' + Server + ';' + 'Initial Catalog=' + Database + ';Trusted_Connection=True;';

SaveReadSQL('Connection ' + ConnString + ' opened on ' + FORMAT(CURRENTDATETIME),TRUE,0,0,0, '');

SQLCon := SQLCon.SqlConnection(ConnString);

SQLCon.Open;
ConnActive := TRUE;

<span class="strong"><strong>CloseConnectionString()</strong></span>
SQLCon.Close;

SaveReadSQL('Connection closed on ' + FORMAT(CURRENTDATETIME),TRUE,0,0,1, '');

CLEAR(SQLReader);
CLEAR(SQLCommand);
CLEAR(SQLCon);
ConnActive := FALSE;</pre></div><p>For the interface we use three DotNet variables.</p><div class="mediaobject"><img alt="COMMIT" src="graphics/0365EN_09_33.jpg"/></div><p>Let's have <a class="indexterm" id="id1279"/>a look at the three DotNet variables in more <a class="indexterm" id="id1280"/>detail:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">SQLConnection</code>: This<a class="indexterm" id="id1281"/> is used for the connection with the database and to execute the T-SQL statements</li><li class="listitem" style="list-style-type: disc"><code class="literal">SQLCommand</code>: The<a class="indexterm" id="id1282"/> result sets of a <code class="literal">SELECT</code> statement can be read using this</li><li class="listitem" style="list-style-type: disc"><code class="literal">SQLReader</code>: The<a class="indexterm" id="id1283"/> reader is used to read the data and convert data types between ADO and C/Side</li></ul></div></div><div class="section" title="Writing data"><div class="titlepage"><div><div><h4 class="title"><a id="ch09lvl4sec33"/>Writing data</h4></div></div></div><p>The RF<a class="indexterm" id="id1284"/> application needs data from the Storage Line<a class="indexterm" id="id1285"/> table. We first create a mapping to the RF application as we did with the Excel interface earlier in this chapter.</p><p>This mapping is saved in a buffer table for traceability:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>CreatePickLines()</strong></span>
CreateConnectionString;

SaveReadSQL('CreatePickLines',TRUE, 1, 8388608, 3, '');

PickID := COPYSTR(StorageLn."Document No." + FORMAT(StorageLn."Line No."), 1, 20);

SaveReadSQL('Pick Document : '+PickID,TRUE,3,16711680,7,'');

WITH RFPickLines DO BEGIN
  "Pick Code" := PickID;
  Quantity := StorageLn.Quantity;
  "Terminal ID" := 1;
  "Display 1" := StorageLn.Description;
  "Display 2" := 'Warehouse ' + StorageLn."Warehouse Code";
  "Display 3" := 'Region ' + StorageLn."Region Code";
  "Display 4" := 'Shelf ' + StorageLn."Shelf No.";
  INSERT;
  SQLStatement := 'INSERT INTO [RF Pick Lines]' +
                  '([Pick Code],'+
                   '[Quantity],'+
                   '[Terminal ID],'+
                   '[Display 1],'+
                   '[Display 2],'+
                   '[Display 3],'+
                   '[Display 4])'+
                   'VALUES('+
                   Quote + PickID + Quote      +','+
                   FORMAT(Quantity)            +','+
                   '1'                         +','+
                   Quote + "Display 1" + Quote +','+
                   Quote + "Display 2" + Quote +','+
                   Quote + "Display 3" + Quote +','+
                   Quote + "Display 4" + Quote + ')';
END;

ExecuteSQL(SQLStatement);

StorageLn.Exported := CURRENTDATETIME;
StorageLn.MODIFY;</pre></div><p>The<a class="indexterm" id="id1286"/> actual data is moved to the RF database using <a class="indexterm" id="id1287"/>an <code class="literal">INSERT</code> command.</p><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note66"/>Note</h3><p>To avoid exporting the same data twice we need to keep track of what we exported. The simplest way to do this is to create a new field called Exported. Making this field a DateTime also enables the traceability of the application.</p></div></div></div><div class="section" title="Reading data"><div class="titlepage"><div><div><h4 class="title"><a id="ch09lvl4sec34"/>Reading data</h4></div></div></div><p>When <a class="indexterm" id="id1288"/>reading data from the RF database, we also <a class="indexterm" id="id1289"/>send a T-SQL SELECT query for the data. We use the <code class="literal">SQLReader.Read</code> to browse through the records that are in the result set.</p><p>For each record in the result set, we create a record in our buffer table, which we then can use to update the information in the Storage Lines.</p><p>When reading data we do not want to import the same data twice. To avoid this, we need to store a unique identifier in a table that enables us to remember where we left in the last run:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>ReadFinishedPicks()</strong></span>
CreateConnectionString;

SaveReadSQL('ReadFinishedPicks',TRUE, 1, 8388608, 3, '');

RFIntSetup.GET;
LastSync := RFIntSetup."Last Finished Pick";


SQLCommand := SQLCon.CreateCommand();
SQLCommand.CommandText := SaveReadSQL('SELECT ' +
              '[Reference Entry No],' +
              '[Terminal ID],' +
              '[Duration],' +
              '[Ready Date Time]' +
    ' FROM [RF Finished Pick] WHERE [Reference Entry No] &gt; ' + 
      LastSync,FALSE,2,0,2, ''));

WHILE SQLReader.Read() DO BEGIN
  RFFinishedPick.INIT;
  RFFinishedPick."Reference Entry No." := 
    ReadInteger('Reference Entry No');
  RFFinishedPick."Terminal ID" := ReadInteger('Terminal ID');
  RFFinishedPick.Duration := ReadInteger('Duration');
  RFFinishedPick."Ready Date Time" := 
    ReadDateTime('Ready Date Time');
  RFFinishedPick.INSERT;
END;

RFIntSetup."Last Finished Pick" := Quote + FORMAT(RFFinishedPick."Reference Entry No.") + Quote;
RFIntSetup.MODIFY;

AdoRecordSet.Close;</pre></div><p>In <a class="indexterm" id="id1290"/>our <a class="indexterm" id="id1291"/>example, this unique identifier is <code class="literal">Reference Entry No</code>.</p></div><div class="section" title="Log, log, and log more"><div class="titlepage"><div><div><h4 class="title"><a id="ch09lvl4sec35"/>Log, log, and log more</h4></div></div></div><p>Although <a class="indexterm" id="id1292"/>much of the logging is done using the buffer tables, we also want to store the general process of the interface each time it runs. This is done using the SQL Statement table. Both the SQL Statements as well as the other events are stored there.</p><p>By using the <code class="literal">COMMIT</code> functionality, we can exactly see where it stopped by looking at the last record in this table. We can solve the problem that caused the interface to stop and restart the interface without losing data.</p><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note67"/>Note</h3><p>Never use the <code class="literal">COMMIT</code> statement unless there is a very good reason for it. C/SIDE will normally handle the transactions for you, enabling a full role back when <a class="indexterm" id="id1293"/>things go wrong. Creating a <code class="literal">COMMIT</code> statement in a normal C/SIDE transaction will prevent C/SIDE from rolling back.</p></div></div></div></div><div class="section" title="Testing"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec209"/>Testing</h3></div></div></div><p>Let's test <a class="indexterm" id="id1294"/>the interface we have just designed <a class="indexterm" id="id1295"/>and developed. In order to do this, we need to have records in the Storage Line table and the RF database needs to exist somewhere.</p><div class="section" title="The RF database"><div class="titlepage"><div><div><h4 class="title"><a id="ch09lvl4sec36"/>The RF database</h4></div></div></div><p>To test<a class="indexterm" id="id1296"/> the objects we have created for this solution, the <a class="indexterm" id="id1297"/>RF database should exist on your system. This database can be created using a T-SQL script and should be executed on a Microsoft SQL Server machine.</p><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note68"/>Note</h3><p>The script RF <code class="literal">database.sql</code> is part of the object files downloaded for this book.</p></div></div><p>Open the script in SQL Server Management Studio and click on <span class="strong"><strong>Execute</strong></span>.</p><div class="mediaobject"><img alt="The RF database" src="graphics/0365EN_09_34.jpg"/></div></div><div class="section" title="The test"><div class="titlepage"><div><div><h4 class="title"><a id="ch09lvl4sec37"/>The test</h4></div></div></div><p>Even though the C/AL code can run in the Windows client, we will run the test in the classic <a class="indexterm" id="id1298"/>client. The reason for this is that the interface will run in the NAS, which will execute the C/AL code the same way as the classic client. Another reason to use the classic client is that this is the interface for the DBA to perform all their tasks.</p><p>To start a test run, open page <span class="strong"><strong>RF Interface Setup</strong></span> (123.456.780) from the Object Designer.</p><p>Make sure that the Database and Server are correct. The server should be the SQL Server instance where the SQL Script was executed.</p><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note69"/>Note</h3><p>The ADO connection uses the Windows Account NT <code class="literal">AUTHORITY\NETWORK SERVICE</code> with Trusted connection. This user should have enough rights to insert and read data from the RF database.</p></div></div><div class="mediaobject"><img alt="The test" src="graphics/0365EN_09_35.jpg"/></div><p>To start a test run, click on the <span class="strong"><strong>Test</strong></span> button.</p></div></div><div class="section" title="Viewing the results"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec210"/>Viewing the results</h3></div></div></div><p>If everything <a class="indexterm" id="id1299"/>went well, the results <a class="indexterm" id="id1300"/>should show both in the log and in the buffer tables and the RF database. Let's check them all.</p><div class="section" title="SQL Statements"><div class="titlepage"><div><div><h4 class="title"><a id="ch09lvl4sec38"/>SQL Statements</h4></div></div></div><p>The SQL <a class="indexterm" id="id1301"/>Statement log can be opened by either<a class="indexterm" id="id1302"/> pushing the <span class="strong"><strong>Log</strong></span> button on the <span class="strong"><strong>RF Interface Setup</strong></span> form or opening the <span class="strong"><strong>SQL Statements</strong></span> (123.456.781) form from the Object Designer.</p><div class="mediaobject"><img alt="SQL Statements" src="graphics/0365EN_09_36.jpg"/><div class="caption"><p>SQL statements</p></div></div><p>The information on the form shows us exactly what the interface did during this run.</p></div><div class="section" title="The buffer tables"><div class="titlepage"><div><div><h4 class="title"><a id="ch09lvl4sec39"/>The buffer tables</h4></div></div></div><p>When<a class="indexterm" id="id1303"/> we open the buffer tables from the Object Designer, we <a class="indexterm" id="id1304"/>can see that the interface moved the data from the Storage Line table into the RF Pick Lines table.</p><div class="mediaobject"><img alt="The buffer tables" src="graphics/0365EN_09_37.jpg"/></div><p>The <span class="strong"><strong>RF Finished Pick</strong></span> and <span class="strong"><strong>RF Exceptions</strong></span> are also populated with the records from the RF database.</p></div><div class="section" title="The RF database"><div class="titlepage"><div><div><h4 class="title"><a id="ch09lvl4sec40"/>The RF database</h4></div></div></div><p>The last<a class="indexterm" id="id1305"/> thing to check is the data in the RF database. The data in both databases should now be <a class="indexterm" id="id1306"/>exactly the same.</p><div class="mediaobject"><img alt="The RF database" src="graphics/0365EN_09_38.jpg"/></div><p>This <a class="indexterm" id="id1307"/>can be checked from the SQL Server Management Studio.</p></div></div></div></div>
<div class="section" title="Interfacing into the future"><div class="titlepage"><div><div><h1 class="title"><a id="ch09lvl1sec65"/>Interfacing into the future</h1></div></div></div><p>Interfacing will become more and more important in the future as technology evolves. Newer technologies and faster Internet connections will allow us to integrate our applications better but will also make it more accessible for end users.</p><div class="section" title="Cloud-enabled Microsoft Dynamics NAV"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec195"/>Cloud-enabled Microsoft Dynamics NAV</h2></div></div></div><p>With <a class="indexterm" id="id1308"/>the release of version 2013 R2, Microsoft Dynamics NAV is now cloud-enabled. This means that the product is officially supported to run on the Microsoft Azure platform.</p></div></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch09lvl1sec66"/>Summary</h1></div></div></div><p>In this chapter, we looked at how Microsoft Dynamics NAV can interface with other applications.</p><p>We discussed the basics of interfacing, import versus export, and data pulling versus data pushing. An interface can be executed manually or by a timer or event.</p><p>Microsoft Dynamics NAV supports a wide range of interfacing technologies, such as files, automation control, .NET, ODBC, ADO, and web services.</p><p>It is also possible to integrate using SQL Server technologies. The Application Server (NAS) is often used for interfacing with other systems, for example, using Microsoft <span class="strong"><strong>Message Queuing</strong></span> or <span class="strong"><strong>Active Data Objects</strong></span> (<span class="strong"><strong>ADO</strong></span>).</p><p>The wide range of interfaces that come with the product have been discussed including all interfaces with Microsoft Office, Exchange, and SharePoint.</p><p>We designed and developed two business-to-business interfaces; one to import data manually from Microsoft Excel and the other to automatically import and export data to another database using ADO and a timer.</p><p>When designing an interface, reliability and traceability are the key elements. In the next chapter, we will talk about application design methodologies and principles.</p></div></body></html>