<html><head></head><body>
<div id="_idContainer101">
<h1 class="chapter-number" id="_idParaDest-89"><a id="_idTextAnchor274"/><span class="koboSpan" id="kobo.1.1">4</span></h1>
<h1 id="_idParaDest-90"><a id="_idTextAnchor275"/><span class="koboSpan" id="kobo.2.1">Building a News App Using .NET MAUI Shell</span></h1>
<p><span class="koboSpan" id="kobo.3.1">In this chapter, we will create a news app that leverages the </span><strong class="bold"><span class="koboSpan" id="kobo.4.1">Shell</span></strong><span class="koboSpan" id="kobo.5.1"> navigation functionality provided to us by the .NET MAUI team at Microsoft. </span><span class="koboSpan" id="kobo.5.2">The old way of doing this, which involved using </span><strong class="bold"><span class="koboSpan" id="kobo.6.1">ContentPage</span></strong><span class="koboSpan" id="kobo.7.1">, </span><strong class="bold"><span class="koboSpan" id="kobo.8.1">FlyoutPage</span></strong><span class="koboSpan" id="kobo.9.1">, </span><strong class="bold"><span class="koboSpan" id="kobo.10.1">TabbedPage</span></strong><span class="koboSpan" id="kobo.11.1">, or </span><strong class="bold"><span class="koboSpan" id="kobo.12.1">NavigationPage</span></strong><span class="koboSpan" id="kobo.13.1"> as the main page, as we did in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.14.1">Chapter 2</span></em></span><span class="koboSpan" id="kobo.15.1">, still works, but we are sure that you will enjoy the new way of defining the structure of your app. </span><span class="koboSpan" id="kobo.15.2">Also, you can mix and match the old </span><span class="No-Break"><span class="koboSpan" id="kobo.16.1">and new.</span></span></p>
<p><span class="koboSpan" id="kobo.17.1">By the end of this chapter, you will have learned how to define an app structure using Shell, consume data from a REST API, configure navigation, and pass data between views using </span><span class="No-Break"><span class="koboSpan" id="kobo.18.1">query-style routes.</span></span></p>
<p><span class="koboSpan" id="kobo.19.1">So, what is Shell, then? </span><span class="koboSpan" id="kobo.19.2">In Shell, you define the structure of your app using </span><strong class="bold"><span class="koboSpan" id="kobo.20.1">Extensible Application Markup Language</span></strong><span class="koboSpan" id="kobo.21.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.22.1">XAML</span></strong><span class="koboSpan" id="kobo.23.1">) instead of hiding it in spread-out pieces of code in your app. </span><span class="koboSpan" id="kobo.23.2">You can also navigate using routes, just like those fancy web developers </span><span class="No-Break"><span class="koboSpan" id="kobo.24.1">are doing.</span></span></p>
<p><span class="koboSpan" id="kobo.25.1">The following topics will be covered in </span><span class="No-Break"><span class="koboSpan" id="kobo.26.1">this chapter:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.27.1">Defining a Shell </span><span class="No-Break"><span class="koboSpan" id="kobo.28.1">navigation page</span></span></li>
<li><span class="koboSpan" id="kobo.29.1">Creating </span><span class="No-Break"><span class="koboSpan" id="kobo.30.1">a flyout</span></span></li>
<li><span class="koboSpan" id="kobo.31.1">Creating a </span><span class="No-Break"><span class="koboSpan" id="kobo.32.1">navigation bar</span></span></li>
<li><span class="koboSpan" id="kobo.33.1">Navigating using routes and passing data in </span><span class="No-Break"><span class="koboSpan" id="kobo.34.1">query strings</span></span></li>
<li><span class="koboSpan" id="kobo.35.1">Consuming data from a public </span><strong class="bold"><span class="koboSpan" id="kobo.36.1">representational state transfer</span></strong><span class="koboSpan" id="kobo.37.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.38.1">REST</span></strong><span class="koboSpan" id="kobo.39.1">) </span><strong class="bold"><span class="koboSpan" id="kobo.40.1">application programming </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.41.1">interface</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.42.1"> (</span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.43.1">API</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.44.1">)</span></span></li>
<li><span class="koboSpan" id="kobo.45.1">Adding content in the form of a </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.46.1">CollectionView</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.47.1"> control</span></span></li>
</ul>
<h1 id="_idParaDest-91"><a id="_idTextAnchor276"/><a id="_idTextAnchor277"/><span class="koboSpan" id="kobo.48.1">Technical requirements</span></h1>
<p><span class="koboSpan" id="kobo.49.1">To be able to complete this project, you will need to have Visual Studio for Mac or Windows installed, as well as the necessary .NET MAUI workload components. </span><span class="koboSpan" id="kobo.49.2">See </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.50.1">Chapter 1</span></em></span><span class="koboSpan" id="kobo.51.1">, </span><em class="italic"><span class="koboSpan" id="kobo.52.1">Introduction to .NET MAUI</span></em><span class="koboSpan" id="kobo.53.1">, for more details on how to set up </span><span class="No-Break"><span class="koboSpan" id="kobo.54.1">your environment.</span></span></p>
<p><span class="koboSpan" id="kobo.55.1">You can find the source code for this chapter </span><span class="No-Break"><span class="koboSpan" id="kobo.56.1">at </span></span><a href="https://github.com/PacktPublishing/MAUI-Projects-3rd-Edition"><span class="No-Break"><span class="koboSpan" id="kobo.57.1">https://github.com/PacktPublishing/MAUI-Projects-3rd-Edition</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.58.1">.</span></span></p>
<h1 id="_idParaDest-92"><a id="_idTextAnchor278"/><span class="koboSpan" id="kobo.59.1">Project overview</span></h1>
<p><span class="koboSpan" id="kobo.60.1">We will create a .NET MAUI project using the </span><strong class="bold"><span class="koboSpan" id="kobo.61.1">single-project</span></strong><span class="koboSpan" id="kobo.62.1"> feature as the code-sharing strategy. </span><span class="koboSpan" id="kobo.62.2">It will contain two parts, detailed </span><span class="No-Break"><span class="koboSpan" id="kobo.63.1">as </span></span><span class="No-Break"><a id="_idIndexMarker438"/><a id="_idIndexMarker439"/></span><span class="No-Break"><span class="koboSpan" id="kobo.64.1">follows:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.65.1">In the first part, we will create views and make them navigable </span><span class="No-Break"><span class="koboSpan" id="kobo.66.1">using Shell</span></span></li>
<li><span class="koboSpan" id="kobo.67.1">In the second part, we will add some content by consuming a </span><strong class="bold"><span class="koboSpan" id="kobo.68.1">REST API</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.69.1">for news</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.70.1">The second part is not needed to learn about Shell, but it will take you a bit further down the road to a </span><span class="No-Break"><span class="koboSpan" id="kobo.71.1">complete app.</span></span></p>
<p><span class="koboSpan" id="kobo.72.1">The build time for this project is about </span><span class="No-Break"><span class="koboSpan" id="kobo.73.1">1.5 hours.</span></span></p>
<h1 id="_idParaDest-93"><a id="_idTextAnchor279"/><a id="_idTextAnchor280"/><span class="koboSpan" id="kobo.74.1">Building the news app</span></h1>
<p><span class="koboSpan" id="kobo.75.1">This chapter will be all about building </span><a id="_idIndexMarker440"/><a id="_idIndexMarker441"/><span class="koboSpan" id="kobo.76.1">a news app from the beginning. </span><span class="koboSpan" id="kobo.76.2">It will guide you through every step, but it will not go into every detail. </span><span class="koboSpan" id="kobo.76.3">For that, we recommend </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.77.1">Chapter 2</span></em></span><span class="koboSpan" id="kobo.78.1">, </span><em class="italic"><span class="koboSpan" id="kobo.79.1">Building Our First .NET MAUI App</span></em><span class="koboSpan" id="kobo.80.1">, which goes into </span><span class="No-Break"><span class="koboSpan" id="kobo.81.1">more detail.</span></span></p>
<p><span class="No-Break"><span class="koboSpan" id="kobo.82.1">Happy coding!</span></span></p>
<h2 id="_idParaDest-94"><a id="_idTextAnchor281"/><span class="koboSpan" id="kobo.83.1">Setting up the project</span></h2>
<p><span class="koboSpan" id="kobo.84.1">This project, like all the rest, is a </span><strong class="bold"><span class="koboSpan" id="kobo.85.1">File</span></strong><span class="koboSpan" id="kobo.86.1"> | </span><strong class="bold"><span class="koboSpan" id="kobo.87.1">New</span></strong><span class="koboSpan" id="kobo.88.1"> | </span><strong class="bold"><span class="koboSpan" id="kobo.89.1">Project...</span></strong><span class="koboSpan" id="kobo.90.1">-style project. </span><span class="koboSpan" id="kobo.90.2">This means that we will not be importing any code at all. </span><span class="koboSpan" id="kobo.90.3">So, this first section</span><a id="_idIndexMarker442"/><a id="_idIndexMarker443"/><span class="koboSpan" id="kobo.91.1"> is all about creating the project and setting up the basic </span><span class="No-Break"><span class="koboSpan" id="kobo.92.1">project structure.</span></span></p>
<h3><a id="_idTextAnchor282"/><a id="_idTextAnchor283"/><span class="koboSpan" id="kobo.93.1">Creating the new project</span></h3>
<p><a id="_idTextAnchor284"/><span class="koboSpan" id="kobo.94.1">The first step is to </span><a id="_idIndexMarker444"/><a id="_idIndexMarker445"/><span class="koboSpan" id="kobo.95.1">create a new .NET </span><span class="No-Break"><span class="koboSpan" id="kobo.96.1">MAUI project:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.97.1">Open Visual Studio 2022 and select </span><strong class="bold"><span class="koboSpan" id="kobo.98.1">Create a </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.99.1">new project</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.100.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer089">
<span class="koboSpan" id="kobo.101.1"><img alt="Figure 4.1 – Visual Studio 2022" src="image/Figure_4.1_B19214.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.102.1">Figure 4.1 – Visual Studio 2022</span></p>
<p class="list-inset"><a id="_idTextAnchor285"/><span class="koboSpan" id="kobo.103.1">This will open the </span><strong class="bold"><span class="koboSpan" id="kobo.104.1">Create a new </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.105.1">project</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.106.1"> wizard.</span></span></p>
<ol>
<li value="2"><span class="koboSpan" id="kobo.107.1">In the search field, type</span><a id="_idIndexMarker446"/><a id="_idIndexMarker447"/><span class="koboSpan" id="kobo.108.1"> in </span><strong class="source-inline"><span class="koboSpan" id="kobo.109.1">maui</span></strong><span class="koboSpan" id="kobo.110.1"> and select the </span><strong class="bold"><span class="koboSpan" id="kobo.111.1">.NET MAUI App</span></strong><span class="koboSpan" id="kobo.112.1"> item from </span><span class="No-Break"><span class="koboSpan" id="kobo.113.1">the list:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer090">
<span class="koboSpan" id="kobo.114.1"><img alt="Figure 4.2 – Create a new project" src="image/Figure_4.2_B19214.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.115.1">Figure 4.2 – Create a new project</span></p>
<ol>
<li value="3"><span class="No-Break"><span class="koboSpan" id="kobo.116.1">Cl</span><a id="_idTextAnchor286"/><span class="koboSpan" id="kobo.117.1">ick </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.118.1">Next</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.119.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.120.1">Enter </span><strong class="source-inline"><span class="koboSpan" id="kobo.121.1">News</span></strong><span class="koboSpan" id="kobo.122.1"> as the </span><a id="_idIndexMarker448"/><a id="_idIndexMarker449"/><span class="koboSpan" id="kobo.123.1">name of the app, as shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.124.1">following screenshot:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer091">
<span class="koboSpan" id="kobo.125.1"><img alt="Figure 4.3 – Configure your new project" src="image/Figure_4.3_B19214.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.126.1">Figure 4.3 – Configure your new project</span></p>
<ol>
<li value="5"><span class="No-Break"><span class="koboSpan" id="kobo.127.1">Click </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.128.1">Next</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.129.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.130.1">The last step will prompt you for the version of .NET Core to support. </span><span class="koboSpan" id="kobo.130.2">At the time of writing, .NET 6 is available as </span><strong class="bold"><span class="koboSpan" id="kobo.131.1">Long-Term Support</span></strong><span class="koboSpan" id="kobo.132.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.133.1">LTS</span></strong><span class="koboSpan" id="kobo.134.1">), and .NET 7 is available as </span><strong class="bold"><span class="koboSpan" id="kobo.135.1">Standard Term Support</span></strong><span class="koboSpan" id="kobo.136.1">. </span><span class="koboSpan" id="kobo.136.2">For this book, we will assume that you will be using .</span><span class="No-Break"><span class="koboSpan" id="kobo.137.1">NET 7:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer092">
<span class="koboSpan" id="kobo.138.1"><img alt="Figure 4.4 – Additional information" src="image/Figure_4.4_B19214.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.139.1">Figure 4.4 – Additional information</span></p>
<ol>
<li value="7"><span class="koboSpan" id="kobo.140.1">Finalize the setup by clicking </span><strong class="bold"><span class="koboSpan" id="kobo.141.1">Create</span></strong><span class="koboSpan" id="kobo.142.1"> and wait for Visual Studio to create </span><span class="No-Break"><span class="koboSpan" id="kobo.143.1">the project.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.144.1">That’s it for </span><span class="No-Break"><span class="koboSpan" id="kobo.145.1">project creation.</span></span></p>
<p><span class="koboSpan" id="kobo.146.1">Let</span><a id="_idTextAnchor287"/><a id="_idTextAnchor288"/><a id="_idTextAnchor289"/><span class="koboSpan" id="kobo.147.1">’s continue by setting up the </span><a id="_idIndexMarker450"/><a id="_idIndexMarker451"/><span class="koboSpan" id="kobo.148.1">structure of </span><span class="No-Break"><span class="koboSpan" id="kobo.149.1">the app.</span></span></p>
<h2 id="_idParaDest-95"><span class="koboSpan" id="kobo.150.1">Crea</span><a id="_idTextAnchor290"/><a id="_idTextAnchor291"/><a id="_idTextAnchor292"/><span class="koboSpan" id="kobo.151.1">ting the structure of the app</span></h2>
<p><span class="koboSpan" id="kobo.152.1">In this section, we will start to build the </span><a id="_idIndexMarker452"/><a id="_idIndexMarker453"/><strong class="bold"><span class="koboSpan" id="kobo.153.1">Views</span></strong><span class="koboSpan" id="kobo.154.1"> and </span><strong class="bold"><span class="koboSpan" id="kobo.155.1">ViewModels</span></strong><span class="koboSpan" id="kobo.156.1"> of the app. </span><span class="koboSpan" id="kobo.156.2">The </span><em class="italic"><span class="koboSpan" id="kobo.157.1">Using MVVM – creating views and ViewModels</span></em><span class="koboSpan" id="kobo.158.1"> section in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.159.1">Chapter 2</span></em></span><span class="koboSpan" id="kobo.160.1"> contains more details on </span><strong class="bold"><span class="koboSpan" id="kobo.161.1">Model-View-ViewModel</span></strong><span class="koboSpan" id="kobo.162.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.163.1">MVVM</span></strong><span class="koboSpan" id="kobo.164.1">) as a design pattern. </span><span class="koboSpan" id="kobo.164.2">It’s recommended that you read that first if you don’t know what </span><span class="No-Break"><span class="koboSpan" id="kobo.165.1">MVVM is.</span></span></p>
<h3><span class="koboSpan" id="kobo.166.1">Crea</span><a id="_idTextAnchor293"/><a id="_idTextAnchor294"/><a id="_idTextAnchor295"/><a id="_idTextAnchor296"/><a id="_idTextAnchor297"/><span class="koboSpan" id="kobo.167.1">ting the ViewModel base class</span></h3>
<p><strong class="source-inline"><span class="koboSpan" id="kobo.168.1">ViewModel</span></strong><span class="koboSpan" id="kobo.169.1"> is the mediator between </span><strong class="source-inline"><span class="koboSpan" id="kobo.170.1">View</span></strong><span class="koboSpan" id="kobo.171.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.172.1">Model</span></strong><span class="koboSpan" id="kobo.173.1">. </span><span class="koboSpan" id="kobo.173.2">Let’s create a base class for </span><strong class="source-inline"><span class="koboSpan" id="kobo.174.1">ViewModels</span></strong><span class="koboSpan" id="kobo.175.1"> with common functionality that we can reuse. </span><span class="koboSpan" id="kobo.175.2">In</span><a id="_idIndexMarker454"/><a id="_idIndexMarker455"/><span class="koboSpan" id="kobo.176.1"> practice, </span><strong class="source-inline"><span class="koboSpan" id="kobo.177.1">ViewModel</span></strong><span class="koboSpan" id="kobo.178.1"> must implement an interface called </span><strong class="source-inline"><span class="koboSpan" id="kobo.179.1">INotifyPropertyChanged</span></strong><span class="koboSpan" id="kobo.180.1"> for MVVM to function. </span><span class="koboSpan" id="kobo.180.2">We will do so in the base class and will also add a little handy helper tool called </span><strong class="bold"><span class="koboSpan" id="kobo.181.1">CommunityToolkit.Mvvm</span></strong><span class="koboSpan" id="kobo.182.1"> that will save us a lot of time. </span><span class="koboSpan" id="kobo.182.2">Again, please check out </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.183.1">Chapter 2</span></em></span><span class="koboSpan" id="kobo.184.1">, </span><em class="italic"><span class="koboSpan" id="kobo.185.1">Building Our First .NET MAUI App</span></em><span class="koboSpan" id="kobo.186.1">, if you are feeling unsure </span><span class="No-Break"><span class="koboSpan" id="kobo.187.1">about MVVM.</span></span></p>
<p><span class="koboSpan" id="kobo.188.1">The first step is to create a base</span><a id="_idIndexMarker456"/><a id="_idIndexMarker457"/><span class="koboSpan" id="kobo.189.1"> class. </span><span class="koboSpan" id="kobo.189.2">Proceed </span><span class="No-Break"><span class="koboSpan" id="kobo.190.1">as follows:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.191.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.192.1">News</span></strong><span class="koboSpan" id="kobo.193.1"> project, create a folder </span><span class="No-Break"><span class="koboSpan" id="kobo.194.1">called </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.195.1">ViewModels</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.196.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.197.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.198.1">ViewModels</span></strong><span class="koboSpan" id="kobo.199.1"> folder, create a class </span><span class="No-Break"><span class="koboSpan" id="kobo.200.1">called </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.201.1">ViewModel</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.202.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.203.1">Change the existing class so that it looks </span><span class="No-Break"><span class="koboSpan" id="kobo.204.1">as follows:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.205.1">
namespace News.ViewModels;
public abstract class ViewModel
{
}</span></pre></li> </ol>
<p><span class="koboSpan" id="kobo.206.1">Excellent! </span><span class="koboSpan" id="kobo.206.2">Let’s implement </span><strong class="source-inline"><span class="koboSpan" id="kobo.207.1">INotifyPropertyChanged</span></strong><span class="koboSpan" id="kobo.208.1"> in the base </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.209.1">ViewModel</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.210.1"> class.</span></span></p>
<h4><span class="koboSpan" id="kobo.211.1">A quick recap of CommunityToolkit.Mvvm</span></h4>
<p><span class="koboSpan" id="kobo.212.1">CommunityToolkit.Mvvm is a NuGet package that </span><a id="_idIndexMarker458"/><a id="_idIndexMarker459"/><span class="koboSpan" id="kobo.213.1">contains a few source generators that can automatically generate the necessary implementation details for </span><strong class="source-inline"><span class="koboSpan" id="kobo.214.1">INotifyPropertyChanged</span></strong><span class="koboSpan" id="kobo.215.1">. </span><span class="koboSpan" id="kobo.215.2">More specifically, it will inject a call that will raise the </span><strong class="source-inline"><span class="koboSpan" id="kobo.216.1">PropertyChanged</span></strong><span class="koboSpan" id="kobo.217.1"> event whenever a setter is called. </span><span class="koboSpan" id="kobo.217.2">It also takes care of property dependencies; if I change the </span><strong class="source-inline"><span class="koboSpan" id="kobo.218.1">FirstName</span></strong><span class="koboSpan" id="kobo.219.1"> property, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.220.1">FullName</span></strong><span class="koboSpan" id="kobo.221.1"> read-only property will also get a </span><strong class="source-inline"><span class="koboSpan" id="kobo.222.1">PropertyChanged</span></strong><span class="koboSpan" id="kobo.223.1"> event. </span><span class="koboSpan" id="kobo.223.2">Before CommunityToolkit.Mvvm, you would have had to write this </span><span class="No-Break"><span class="koboSpan" id="kobo.224.1">code manually.</span></span></p>
<p><span class="koboSpan" id="kobo.225.1">It’s all explained in more detail in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.226.1">Chapter 2</span></em></span><span class="koboSpan" id="kobo.227.1">, </span><em class="italic"><span class="koboSpan" id="kobo.228.1">Building Our First .NET MAUI App</span></em><span class="koboSpan" id="kobo.229.1">. </span><span class="koboSpan" id="kobo.229.2">Have you </span><a id="_idTextAnchor298"/><span class="koboSpan" id="kobo.230.1">read </span><span class="No-Break"><span class="koboSpan" id="kobo.231.1">it yet?</span></span></p>
<h4><span class="koboSpan" id="kobo.232.1">Adding a reference to CommunityToolkit.Mvvm</span></h4>
<p><span class="koboSpan" id="kobo.233.1">CommunityToolkit.Mvvm and its </span><a id="_idIndexMarker460"/><a id="_idIndexMarker461"/><span class="koboSpan" id="kobo.234.1">dependencies are installed using NuGet. </span><span class="koboSpan" id="kobo.234.2">So, let’s install the </span><span class="No-Break"><span class="koboSpan" id="kobo.235.1">NuGet package:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.236.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.237.1">News</span></strong><span class="koboSpan" id="kobo.238.1"> project, install the CommunityToolkit.Mvvm NuGet package, </span><span class="No-Break"><span class="koboSpan" id="kobo.239.1">version 8.0.0.</span></span></li>
<li><span class="koboSpan" id="kobo.240.1">Accept any license </span><span class="No-Break"><span class="koboSpan" id="kobo.241.1">dialog boxes.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.242.1">This will install the relevant </span><span class="No-Break"><span class="koboSpan" id="kobo.243.1">NuGet packages.</span></span></p>
<h4><span class="koboSpan" id="kobo.244.1">Implementing INotifyPropertyChanged</span></h4>
<p><strong class="source-inline"><span class="koboSpan" id="kobo.245.1">ViewModel</span></strong><span class="koboSpan" id="kobo.246.1"> sits between </span><strong class="source-inline"><span class="koboSpan" id="kobo.247.1">View</span></strong><span class="koboSpan" id="kobo.248.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.249.1">Model</span></strong><span class="koboSpan" id="kobo.250.1">. </span><span class="koboSpan" id="kobo.250.2">When a change in </span><strong class="source-inline"><span class="koboSpan" id="kobo.251.1">ViewModel</span></strong><span class="koboSpan" id="kobo.252.1"> occurs, </span><strong class="source-inline"><span class="koboSpan" id="kobo.253.1">View</span></strong><span class="koboSpan" id="kobo.254.1"> must be notified. </span><span class="koboSpan" id="kobo.254.2">The mechanism for this is the </span><strong class="source-inline"><span class="koboSpan" id="kobo.255.1">INotifyPropertyChanged</span></strong><span class="koboSpan" id="kobo.256.1"> interface, which defines an event that the </span><a id="_idIndexMarker462"/><a id="_idIndexMarker463"/><span class="koboSpan" id="kobo.257.1">controls in </span><strong class="source-inline"><span class="koboSpan" id="kobo.258.1">View</span></strong><span class="koboSpan" id="kobo.259.1"> subscribe to. </span><span class="koboSpan" id="kobo.259.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.260.1">ObservableObject</span></strong><span class="koboSpan" id="kobo.261.1"> attribute is the magic that will generate the </span><strong class="source-inline"><span class="koboSpan" id="kobo.262.1">INotifyPropertyChanged</span></strong><span class="koboSpan" id="kobo.263.1"> implementation for us. </span><span class="koboSpan" id="kobo.263.2">Follow </span><span class="No-Break"><span class="koboSpan" id="kobo.264.1">these steps:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.265.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.266.1">News</span></strong><span class="koboSpan" id="kobo.267.1"> project, open </span><span class="No-Break"><span class="koboSpan" id="kobo.268.1">up </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.269.1">ViewModels.cs</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.270.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.271.1">Add the following code </span><span class="No-Break"><span class="koboSpan" id="kobo.272.1">in bold:</span></span><pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.273.1">using CommunityToolkit.Mvvm.ComponentModel;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.274.1">[ObservableObject]</span></strong><span class="koboSpan" id="kobo.275.1">
public abstract </span><strong class="bold"><span class="koboSpan" id="kobo.276.1">partial</span></strong><span class="koboSpan" id="kobo.277.1"> class ViewModel
{
}</span></pre></li> </ol>
<p><span class="koboSpan" id="kobo.278.1">This instructs CommunityToolkit.Mvvm to implement the </span><strong class="source-inline"><span class="koboSpan" id="kobo.279.1">INotifyPropertyChanged</span></strong><span class="koboSpan" id="kobo.280.1"> interface. </span><span class="koboSpan" id="kobo.280.2">The next step is all about reducing the number of lines of code that we will have to write. </span><span class="koboSpan" id="kobo.280.3">Normally, you would have to manually raise the </span><strong class="source-inline"><span class="koboSpan" id="kobo.281.1">PropertyChanged</span></strong><span class="koboSpan" id="kobo.282.1"> event from your code, but thanks to source generators, which write code at </span><a id="_idIndexMarker464"/><a id="_idIndexMarker465"/><span class="koboSpan" id="kobo.283.1">build time, we simply have to create normal properties and let CommunityToolkit.Mvvm do </span><span class="No-Break"><span class="koboSpan" id="kobo.284.1">the magic.</span></span></p>
<p><span class="koboSpan" id="kobo.285.1">Let’</span><a id="_idTextAnchor299"/><span class="koboSpan" id="kobo.286.1">s move on and create our </span><span class="No-Break"><span class="koboSpan" id="kobo.287.1">first </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.288.1">ViewModel</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.289.1">.</span></span></p>
<h4><span class="koboSpan" id="kobo.290.1">Crea</span><a id="_idTextAnchor300"/><a id="_idTextAnchor301"/><a id="_idTextAnchor302"/><span class="koboSpan" id="kobo.291.1">ting the HeadlinesViewModel class</span></h4>
<p><span class="koboSpan" id="kobo.292.1">We will now start to create some </span><strong class="source-inline"><span class="koboSpan" id="kobo.293.1">View</span></strong><span class="koboSpan" id="kobo.294.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.295.1">ViewModel</span></strong><span class="koboSpan" id="kobo.296.1"> placeholders that we will expand on during this chapter. </span><span class="koboSpan" id="kobo.296.2">We will not directly </span><a id="_idIndexMarker466"/><a id="_idIndexMarker467"/><span class="koboSpan" id="kobo.297.1">implement all graphical features; instead, we’ll keep it simple and think of all these pages as placeholders for what’s to </span><span class="No-Break"><span class="koboSpan" id="kobo.298.1">come next.</span></span></p>
<p><span class="koboSpan" id="kobo.299.1">The first one is the </span><strong class="source-inline"><span class="koboSpan" id="kobo.300.1">HeadlinesViewModel</span></strong><span class="koboSpan" id="kobo.301.1"> class, which will serve as the </span><strong class="source-inline"><span class="koboSpan" id="kobo.302.1">ViewModel</span></strong><span class="koboSpan" id="kobo.303.1"> for </span><strong class="source-inline"><span class="koboSpan" id="kobo.304.1">HeadlinesView</span></strong><span class="koboSpan" id="kobo.305.1">. </span><span class="koboSpan" id="kobo.305.2">Proceed </span><span class="No-Break"><span class="koboSpan" id="kobo.306.1">as follows:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.307.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.308.1">News</span></strong><span class="koboSpan" id="kobo.309.1"> project, under the </span><strong class="source-inline"><span class="koboSpan" id="kobo.310.1">ViewModels</span></strong><span class="koboSpan" id="kobo.311.1"> folder, create a new class </span><span class="No-Break"><span class="koboSpan" id="kobo.312.1">called </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.313.1">Head</span></strong></span><strong class="source-inline">
</strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.314.1">linesViewModel</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.315.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.316.1">Edit the class so that it inherits from the </span><strong class="source-inline"><span class="koboSpan" id="kobo.317.1">ViewModel</span></strong><span class="koboSpan" id="kobo.318.1"> base class, as shown in bold in the following </span><span class="No-Break"><span class="koboSpan" id="kobo.319.1">code snippet:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.320.1">
namespace News.ViewModels;
public class HeadlinesViewModel : </span><strong class="bold"><span class="koboSpan" id="kobo.321.1">ViewModel</span></strong><span class="koboSpan" id="kobo.322.1">
{
    public HeadlinesViewModel()
    {
    }
}</span></pre></li> </ol>
<p><span class="koboSpan" id="kobo.323.1">OK – not bad. </span><span class="koboSpan" id="kobo.323.2">It doesn’t do much yet, but we’ll just leave it for now. </span><span class="koboSpan" id="kobo.323.3">Let’s create the </span><span class="No-Break"><span class="koboSpan" id="kobo.324.1">matc</span><a id="_idTextAnchor303"/><span class="koboSpan" id="kobo.325.1">hing view.</span></span></p>
<h4><span class="koboSpan" id="kobo.326.1">Crea</span><a id="_idTextAnchor304"/><span class="koboSpan" id="kobo.327.1">ting HeadlinesView</span></h4>
<p><span class="koboSpan" id="kobo.328.1">This view will eventually show </span><a id="_idIndexMarker468"/><a id="_idIndexMarker469"/><span class="koboSpan" id="kobo.329.1">a list of news, but for now, it will be kept simple. </span><span class="koboSpan" id="kobo.329.2">Follow these steps to create </span><span class="No-Break"><span class="koboSpan" id="kobo.330.1">the page:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.331.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.332.1">News</span></strong><span class="koboSpan" id="kobo.333.1"> project, create a folder </span><span class="No-Break"><span class="koboSpan" id="kobo.334.1">named </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.335.1">Views</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.336.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.337.1">Right-click on the </span><strong class="source-inline"><span class="koboSpan" id="kobo.338.1">Views</span></strong><span class="koboSpan" id="kobo.339.1"> folder, select </span><strong class="bold"><span class="koboSpan" id="kobo.340.1">Add</span></strong><span class="koboSpan" id="kobo.341.1">, and then click </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.342.1">New Item...</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.343.1">.</span></span><p class="list-inset"><span class="koboSpan" id="kobo.344.1">If you are using Visual Studio 17.7 or later, click the </span><strong class="bold"><span class="koboSpan" id="kobo.345.1">Show all Templates</span></strong><span class="koboSpan" id="kobo.346.1"> button in the dialog that pops up. </span><span class="koboSpan" id="kobo.346.2">Otherwise, move on to the </span><span class="No-Break"><span class="koboSpan" id="kobo.347.1">next step.</span></span></p></li>
<li><span class="koboSpan" id="kobo.348.1">Under the </span><strong class="bold"><span class="koboSpan" id="kobo.349.1">C# Items</span></strong><span class="koboSpan" id="kobo.350.1"> node on the left, select </span><strong class="bold"><span class="koboSpan" id="kobo.351.1">.</span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.352.1">NET MAUI</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.353.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.354.1">Select </span><strong class="bold"><span class="koboSpan" id="kobo.355.1">.NET MAUI ContentPage (XAML)</span></strong><span class="koboSpan" id="kobo.356.1"> and name </span><span class="No-Break"><span class="koboSpan" id="kobo.357.1">it </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.358.1">HeadlinesView</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.359.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.360.1">Click </span><strong class="bold"><span class="koboSpan" id="kobo.361.1">Add</span></strong><span class="koboSpan" id="kobo.362.1"> to create </span><span class="No-Break"><span class="koboSpan" id="kobo.363.1">the page.</span></span><p class="list-inset"><span class="koboSpan" id="kobo.364.1">Refe</span><a id="_idTextAnchor305"/><span class="koboSpan" id="kobo.365.1">r to the following screenshot to view the </span><span class="No-Break"><span class="koboSpan" id="kobo.366.1">preceding information:</span></span></p></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer093">
<span class="koboSpan" id="kobo.367.1"><img alt="Figure 4.5 – Add New Item" src="image/Figure_4.5_B19214.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.368.1">Figure 4.5 – Add New Item</span></p>
<p><span class="koboSpan" id="kobo.369.1">Let’s add some placeholder code to </span><strong class="source-inline"><span class="koboSpan" id="kobo.370.1">HeadlinesView</span></strong><span class="koboSpan" id="kobo.371.1">, just to have something to navigate to and from. </span><span class="koboSpan" id="kobo.371.2">We will replace it with something hotter later on in this </span><a id="_idIndexMarker470"/><a id="_idIndexMarker471"/><span class="koboSpan" id="kobo.372.1">chapter, but to keep things simple, let’s add a label. </span><span class="koboSpan" id="kobo.372.2">To do so, proceed </span><span class="No-Break"><span class="koboSpan" id="kobo.373.1">as</span></span><span class="No-Break"><a id="_idIndexMarker472"/><a id="_idIndexMarker473"/></span><span class="No-Break"><span class="koboSpan" id="kobo.374.1"> follows:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.375.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.376.1">News</span></strong><span class="koboSpan" id="kobo.377.1"> project, under the </span><strong class="source-inline"><span class="koboSpan" id="kobo.378.1">Views</span></strong><span class="koboSpan" id="kobo.379.1"> folder, </span><span class="No-Break"><span class="koboSpan" id="kobo.380.1">open </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.381.1">HeadlinesView.xaml</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.382.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.383.1">Edit the XAML code by adding the following code marked </span><span class="No-Break"><span class="koboSpan" id="kobo.384.1">in bold:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.385.1">
&lt;?xml version="1.0" encoding="utf-8" ?&gt;
&lt;ContentPage 
             
    x:Class="News.Views.HeadlinesView"
    Title="</span><strong class="bold"><span class="koboSpan" id="kobo.386.1">Home</span></strong><span class="koboSpan" id="kobo.387.1">"&gt;
    &lt;VerticalStackLayout&gt;
        &lt;Label
            Text="</span><strong class="bold"><span class="koboSpan" id="kobo.388.1">HeadLinesView!</span></strong><span class="koboSpan" id="kobo.389.1">"
            VerticalOptions="Center"
            HorizontalOptions="Center" /&gt;
    &lt;/VerticalStackLayout&gt;
&lt;/ContentPage&gt;</span></pre></li> </ol>
<p><span class="koboSpan" id="kobo.390.1">This </span><a id="_idTextAnchor306"/><span class="koboSpan" id="kobo.391.1">will set the title of the page and add a label with the text </span><strong class="source-inline"><span class="koboSpan" id="kobo.392.1">HeadlinesView</span></strong><span class="koboSpan" id="kobo.393.1"> centered in the m</span><a id="_idTextAnchor307"/><span class="koboSpan" id="kobo.394.1">iddle of the page. </span><span class="koboSpan" id="kobo.394.2">Let’s move on and create </span><a id="_idIndexMarker474"/><a id="_idIndexMarker475"/><span class="koboSpan" id="kobo.395.1">some additional </span><span class="No-Break"><span class="koboSpan" id="kobo.396.1">view placeholders.</span></span></p>
<h4><span class="koboSpan" id="kobo.397.1">Creat</span><a id="_idTextAnchor308"/><span class="koboSpan" id="kobo.398.1">ing ArticleItem</span></h4>
<p><span class="koboSpan" id="kobo.399.1">The app will eventually display a list of articles where each article will be rendered using a reusable component. </span><span class="koboSpan" id="kobo.399.2">We will call this reusable component </span><strong class="source-inline"><span class="koboSpan" id="kobo.400.1">ArticleItem</span></strong><span class="koboSpan" id="kobo.401.1">. </span><span class="koboSpan" id="kobo.401.2">In .NET MAUI, a reusable component is called a </span><strong class="bold"><span class="koboSpan" id="kobo.402.1">ContentView</span></strong><span class="koboSpan" id="kobo.403.1">. </span><span class="koboSpan" id="kobo.403.2">Please don’t confuse this with an</span><a id="_idIndexMarker476"/><a id="_idIndexMarker477"/><span class="koboSpan" id="kobo.404.1"> MVVM View, which is represented by a page in .NET MAUI. </span><span class="koboSpan" id="kobo.404.2">We know that this is confusing, but the rule is that a .NET MAUI page is an MVVM View and a .NET MAUI ContentView is essentially a </span><span class="No-Break"><span class="koboSpan" id="kobo.405.1">reusable control.</span></span></p>
<p><span class="koboSpan" id="kobo.406.1">That said, let’s create the </span><strong class="source-inline"><span class="koboSpan" id="kobo.407.1">ArticleItem</span></strong><span class="koboSpan" id="kobo.408.1"> class, </span><span class="No-Break"><span class="koboSpan" id="kobo.409.1">as follows:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.410.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.411.1">News</span></strong><span class="koboSpan" id="kobo.412.1"> project, right-click the </span><strong class="source-inline"><span class="koboSpan" id="kobo.413.1">Views</span></strong><span class="koboSpan" id="kobo.414.1"> folder, select </span><strong class="bold"><span class="koboSpan" id="kobo.415.1">Add</span></strong><span class="koboSpan" id="kobo.416.1">, and then click </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.417.1">New Item...</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.418.1">.</span></span><p class="list-inset"><span class="koboSpan" id="kobo.419.1">If you are using Visual Studio 17.7 or later, click the </span><strong class="bold"><span class="koboSpan" id="kobo.420.1">Show all Templates</span></strong><span class="koboSpan" id="kobo.421.1"> button in the dialog that pops up. </span><span class="koboSpan" id="kobo.421.2">Otherwise, move on to the </span><span class="No-Break"><span class="koboSpan" id="kobo.422.1">next step.</span></span></p></li>
<li><span class="koboSpan" id="kobo.423.1">Under the </span><strong class="bold"><span class="koboSpan" id="kobo.424.1">C# Items</span></strong><span class="koboSpan" id="kobo.425.1"> node on the left, select </span><strong class="bold"><span class="koboSpan" id="kobo.426.1">.</span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.427.1">NET MAUI</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.428.1">.</span></span><p class="list-inset"><em class="italic"><span class="koboSpan" id="kobo.429.1">Important</span></em><span class="koboSpan" id="kobo.430.1">: Make sure that you select the </span><strong class="bold"><span class="koboSpan" id="kobo.431.1">ContentView</span></strong><span class="koboSpan" id="kobo.432.1"> template in the next step and </span><em class="italic"><span class="koboSpan" id="kobo.433.1">not</span></em><span class="koboSpan" id="kobo.434.1"> the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.435.1">ContentPage</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.436.1"> template.</span></span></p></li>
<li><span class="koboSpan" id="kobo.437.1">Select </span><strong class="bold"><span class="koboSpan" id="kobo.438.1">.NET MAUI ContentView (XAML)</span></strong><span class="koboSpan" id="kobo.439.1"> (important, remember?) and name </span><span class="No-Break"><span class="koboSpan" id="kobo.440.1">it </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.441.1">ArticleItem</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.442.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.443.1">Click </span><strong class="bold"><span class="koboSpan" id="kobo.444.1">Add</span></strong><span class="koboSpan" id="kobo.445.1"> to create </span><span class="No-Break"><span class="koboSpan" id="kobo.446.1">the view.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.447.1">Refer</span><a id="_idTextAnchor309"/><span class="koboSpan" id="kobo.448.1"> to the following screenshot to view the </span><span class="No-Break"><span class="koboSpan" id="kobo.449.1">preceding information:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer094">
<span class="koboSpan" id="kobo.450.1"><img alt="Figure 4.6 – Add New Item – ArticleItem.xaml" src="image/Figure_4.6_B19214.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.451.1">Figure 4.6 – Add New Item – ArticleItem.xaml</span></p>
<p><span class="koboSpan" id="kobo.452.1">We don</span><a id="_idTextAnchor310"/><span class="koboSpan" id="kobo.453.1">’t need to alter the XAML code that’s been generated at this point, so we’ll simply leave it </span><span class="No-Break"><span class="koboSpan" id="kobo.454.1">as is.</span></span></p>
<h4><span class="koboSpan" id="kobo.455.1">Creati</span><a id="_idTextAnchor311"/><span class="koboSpan" id="kobo.456.1">ng ArticleView</span></h4>
<p><span class="koboSpan" id="kobo.457.1">In the previous section, we created the </span><strong class="source-inline"><span class="koboSpan" id="kobo.458.1">ArticleItem</span></strong><span class="koboSpan" id="kobo.459.1"> content view. </span><span class="koboSpan" id="kobo.459.2">This view (</span><strong class="source-inline"><span class="koboSpan" id="kobo.460.1">ArticleView</span></strong><span class="koboSpan" id="kobo.461.1">) will contain </span><strong class="source-inline"><span class="koboSpan" id="kobo.462.1">WebView</span></strong><span class="koboSpan" id="kobo.463.1"> to display each article. </span><span class="koboSpan" id="kobo.463.2">But</span><a id="_idIndexMarker478"/><a id="_idIndexMarker479"/><span class="koboSpan" id="kobo.464.1"> for the moment, let’s just add </span><strong class="source-inline"><span class="koboSpan" id="kobo.465.1">ArticleView</span></strong><span class="koboSpan" id="kobo.466.1"> as a placeholder. </span><span class="koboSpan" id="kobo.466.2">Follow these steps to </span><span class="No-Break"><span class="koboSpan" id="kobo.467.1">do so:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.468.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.469.1">News</span></strong><span class="koboSpan" id="kobo.470.1"> project, right-click the </span><strong class="source-inline"><span class="koboSpan" id="kobo.471.1">Views</span></strong><span class="koboSpan" id="kobo.472.1"> folder, select </span><strong class="bold"><span class="koboSpan" id="kobo.473.1">Add</span></strong><span class="koboSpan" id="kobo.474.1">, and then click </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.475.1">New Item...</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.476.1">.</span></span><p class="list-inset"><span class="koboSpan" id="kobo.477.1">If you are using Visual Studio 17.7 or later, click the </span><strong class="bold"><span class="koboSpan" id="kobo.478.1">Show all Templates</span></strong><span class="koboSpan" id="kobo.479.1"> button in the dialog that pops up. </span><span class="koboSpan" id="kobo.479.2">Otherwise, move on to the </span><span class="No-Break"><span class="koboSpan" id="kobo.480.1">next step.</span></span></p></li>
<li><span class="koboSpan" id="kobo.481.1">Select </span><strong class="bold"><span class="koboSpan" id="kobo.482.1">.NET MAUI</span></strong><span class="koboSpan" id="kobo.483.1"> under the </span><strong class="bold"><span class="koboSpan" id="kobo.484.1">C# Items</span></strong><span class="koboSpan" id="kobo.485.1"> node on </span><span class="No-Break"><span class="koboSpan" id="kobo.486.1">the left.</span></span></li>
<li><span class="koboSpan" id="kobo.487.1">Select </span><strong class="bold"><span class="koboSpan" id="kobo.488.1">.NET MAUI ContentPage (XAML)</span></strong><span class="koboSpan" id="kobo.489.1"> and name </span><span class="No-Break"><span class="koboSpan" id="kobo.490.1">it </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.491.1">ArticleView</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.492.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.493.1">Click </span><strong class="bold"><span class="koboSpan" id="kobo.494.1">Add</span></strong><span class="koboSpan" id="kobo.495.1"> to create </span><span class="No-Break"><span class="koboSpan" id="kobo.496.1">the page.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.497.1">Since </span><a id="_idTextAnchor312"/><span class="koboSpan" id="kobo.498.1">this view is also a placeholder view at the moment, we’ll just add a label to indicate the type of page. </span><span class="koboSpan" id="kobo.498.2">Edit the content by following </span><span class="No-Break"><span class="koboSpan" id="kobo.499.1">these steps:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.500.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.501.1">News</span></strong><span class="koboSpan" id="kobo.502.1"> project, </span><span class="No-Break"><span class="koboSpan" id="kobo.503.1">open </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.504.1">ArticleView.xaml</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.505.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.506.1">Edit the XAML code by adding the following code marked </span><span class="No-Break"><span class="koboSpan" id="kobo.507.1">in bold:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.508.1">
&lt;?xml version="1.0" encoding="utf-8" ?&gt;
&lt;ContentPage 
             
    x:Class="News.Views.ArticleView"
    Title="ArticleView"&gt;
    &lt;VerticalStackLayout&gt;
        &lt;Label
            Text="</span><strong class="bold"><span class="koboSpan" id="kobo.509.1">ArticleView!</span></strong><span class="koboSpan" id="kobo.510.1">"
            VerticalOptions="Center"
            HorizontalOptions="Center" /&gt;
    &lt;/VerticalStackLayout&gt;
&lt;/ContentPage&gt;</span></pre></li> </ol>
<p><span class="koboSpan" id="kobo.511.1">Alright – just one more view to mock </span><a id="_idIndexMarker480"/><a id="_idIndexMarker481"/><span class="koboSpan" id="kobo.512.1">before we can start to wire </span><span class="No-Break"><span class="koboSpan" id="kobo.513.1">things up.</span></span></p>
<h4><span class="koboSpan" id="kobo.514.1">Creati</span><a id="_idTextAnchor313"/><a id="_idTextAnchor314"/><span class="koboSpan" id="kobo.515.1">ng AboutView</span></h4>
<p><span class="koboSpan" id="kobo.516.1">The last view will be created in the same way as</span><a id="_idIndexMarker482"/><a id="_idIndexMarker483"/><span class="koboSpan" id="kobo.517.1"> all the others. </span><span class="koboSpan" id="kobo.517.2">Proceed </span><span class="No-Break"><span class="koboSpan" id="kobo.518.1">as follows:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.519.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.520.1">News</span></strong><span class="koboSpan" id="kobo.521.1"> project, right-click the </span><strong class="source-inline"><span class="koboSpan" id="kobo.522.1">Views</span></strong><span class="koboSpan" id="kobo.523.1"> folder, select </span><strong class="bold"><span class="koboSpan" id="kobo.524.1">Add</span></strong><span class="koboSpan" id="kobo.525.1">, and then click </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.526.1">New Item...</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.527.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.528.1">Under the </span><strong class="bold"><span class="koboSpan" id="kobo.529.1">C# Items</span></strong><span class="koboSpan" id="kobo.530.1"> node on the left, select </span><strong class="bold"><span class="koboSpan" id="kobo.531.1">.</span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.532.1">NET MAUI</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.533.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.534.1">Select </span><strong class="bold"><span class="koboSpan" id="kobo.535.1">.NET MAUI ContentPage (XAML)</span></strong><span class="koboSpan" id="kobo.536.1"> and name </span><span class="No-Break"><span class="koboSpan" id="kobo.537.1">it </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.538.1">AboutView</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.539.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.540.1">Click </span><strong class="bold"><span class="koboSpan" id="kobo.541.1">Add</span></strong><span class="koboSpan" id="kobo.542.1"> to create </span><span class="No-Break"><span class="koboSpan" id="kobo.543.1">the page.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.544.1">This view is the only view that will stay a placeholder view. </span><span class="koboSpan" id="kobo.544.2">It’s up to you to do something with it if you choose to build something cool out of this project later. </span><span class="koboSpan" id="kobo.544.3">So, we will only add a label that states that this </span><span class="No-Break"><span class="koboSpan" id="kobo.545.1">is </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.546.1">AboutView</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.547.1">:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.548.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.549.1">News</span></strong><span class="koboSpan" id="kobo.550.1"> project, </span><span class="No-Break"><span class="koboSpan" id="kobo.551.1">open </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.552.1">AboutView.xaml</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.553.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.554.1">Edit the XAML code by adding the following code marked </span><span class="No-Break"><span class="koboSpan" id="kobo.555.1">in bold:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.556.1">
&lt;?xml version="1.0" encoding="utf-8" ?&gt;
&lt;ContentPage 
             
    x:Class="News.Views.AboutView"
    Title="AboutView"&gt;
    &lt;VerticalStackLayout&gt;
        &lt;Label
            Text="</span><strong class="bold"><span class="koboSpan" id="kobo.557.1">AboutView!</span></strong><span class="koboSpan" id="kobo.558.1">"
            VerticalOptions="Center"
            HorizontalOptions="Center" /&gt;
    &lt;/VerticalStackLayout&gt;
&lt;/ContentPage&gt;</span></pre></li> </ol>
<p><span class="koboSpan" id="kobo.559.1">With that, we have all the views we need to start wiring the app up. </span><span class="koboSpan" id="kobo.559.2">The first step is to configure </span><span class="No-Break"><span class="koboSpan" id="kobo.560.1">depend</span><a id="_idTextAnchor315"/><span class="koboSpan" id="kobo.561.1">ency injection.</span></span></p>
<h3><span class="koboSpan" id="kobo.562.1">Wiring</span><a id="_idTextAnchor316"/><span class="koboSpan" id="kobo.563.1"> up dependency injection</span></h3>
<p><span class="koboSpan" id="kobo.564.1">By using dependency injection as a </span><a id="_idIndexMarker484"/><a id="_idIndexMarker485"/><span class="koboSpan" id="kobo.565.1">pattern, we can keep our code cleaner and more testable. </span><span class="koboSpan" id="kobo.565.2">This app will use constructor injection, which means that all dependencies that a class has must be passed through its constructor. </span><span class="koboSpan" id="kobo.565.3">The container then constructs objects for you, so you don’t have to care too much about the dependency chain. </span><span class="koboSpan" id="kobo.565.4">Since .NET MAUI already includes a dependency injection framework, called Microsoft.Extensions.DependencyInjection, there is nothing extra </span><span class="No-Break"><span class="koboSpan" id="kobo.566.1">to install.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.567.1">Confused about dependency injection?</span></p>
<p class="callout"><span class="koboSpan" id="kobo.568.1">Check out the </span><em class="italic"><span class="koboSpan" id="kobo.569.1">Wiring up a dependency injection</span></em><span class="koboSpan" id="kobo.570.1"> section in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.571.1">Chapter 2</span></em></span><span class="koboSpan" id="kobo.572.1">, </span><em class="italic"><span class="koboSpan" id="kobo.573.1">Building Our First .NET MAUI App</span></em><span class="koboSpan" id="kobo.574.1">, for more details on </span><span class="No-Break"><span class="koboSpan" id="kobo.575.1">depend</span><a id="_idTextAnchor317"/><span class="koboSpan" id="kobo.576.1">ency injection.</span></span></p>
<h4><span class="koboSpan" id="kobo.577.1">Regist</span><a id="_idTextAnchor318"/><a id="_idTextAnchor319"/><span class="koboSpan" id="kobo.578.1">ering Views and ViewModels with dependency injection</span></h4>
<p><span class="koboSpan" id="kobo.579.1">When registering classes with the container, it is</span><a id="_idIndexMarker486"/><a id="_idIndexMarker487"/><span class="koboSpan" id="kobo.580.1"> recommended to use extension methods to group the types. </span><span class="koboSpan" id="kobo.580.2">The extension methods will take a single parameter and return a single value, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.581.1">MauiAppBuilder</span></strong><span class="koboSpan" id="kobo.582.1"> instance. </span><span class="koboSpan" id="kobo.582.2">This is how the </span><strong class="bold"><span class="koboSpan" id="kobo.583.1">Builder</span></strong><span class="koboSpan" id="kobo.584.1"> pattern is implemented and it allows us to chain the methods on the builder defined in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.585.1">CreateMauiApp</span></strong><span class="koboSpan" id="kobo.586.1"> method. </span><span class="koboSpan" id="kobo.586.2">For this app, we have </span><strong class="source-inline"><span class="koboSpan" id="kobo.587.1">Views</span></strong><span class="koboSpan" id="kobo.588.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.589.1">ViewModels</span></strong><span class="koboSpan" id="kobo.590.1"> to register for now. </span><span class="koboSpan" id="kobo.590.2">Let’s create </span><span class="No-Break"><span class="koboSpan" id="kobo.591.1">the method:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.592.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.593.1">News</span></strong><span class="koboSpan" id="kobo.594.1"> project, open the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.595.1">MauiProgram.cs</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.596.1"> fil</span><a id="_idTextAnchor320"/><span class="koboSpan" id="kobo.597.1">e.</span></span></li>
<li><span class="koboSpan" id="kobo.598.1">Make the following changes to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.599.1">MauiProgram</span></strong><span class="koboSpan" id="kobo.600.1"> class; the changes are highlighted in </span><span class="No-Break"><span class="koboSpan" id="kobo.601.1">the code:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.602.1">
public static class MauiProgram
{
    public static MauiApp CreateMauiApp()
    {
        var builder = MauiApp.CreateBuilder();
        builder
            .UseMauiApp&lt;App&gt;()
            .ConfigureFonts(fonts =&gt;
            {
                fonts.AddFont("OpenSans-Regular.ttf", "OpenSansRegular");
                fonts.AddFont("OpenSans-Semibold.ttf", "OpenSansSemibold");
</span><strong class="bold"><span class="koboSpan" id="kobo.603.1">            })</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.604.1">        .RegisterAppTypes();</span></strong><span class="koboSpan" id="kobo.605.1">
        return builder.Build();
    }
    </span><strong class="bold"><span class="koboSpan" id="kobo.606.1">public static MauiAppBuilder RegisterAppTypes(this MauiAppBuilder mauiAppBuilder)</span></strong><span class="koboSpan" id="kobo.607.1">
    </span><strong class="bold"><span class="koboSpan" id="kobo.608.1">{</span></strong><span class="koboSpan" id="kobo.609.1">
        </span><strong class="bold"><span class="koboSpan" id="kobo.610.1">// ViewModels</span></strong><span class="koboSpan" id="kobo.611.1">
        </span><strong class="bold"><span class="koboSpan" id="kobo.612.1">mauiAppBuilder.Services.AddTransient&lt;ViewModels.</span></strong><span class="koboSpan" id="kobo.613.1">
        </span><strong class="bold"><span class="koboSpan" id="kobo.614.1">HeadlinesViewModel&gt;();</span></strong><span class="koboSpan" id="kobo.615.1">
        </span><strong class="bold"><span class="koboSpan" id="kobo.616.1">// Views</span></strong><span class="koboSpan" id="kobo.617.1">
        </span><strong class="bold"><span class="koboSpan" id="kobo.618.1">mauiAppBuilder.Services.AddTransient&lt;Views.AboutView&gt;();</span></strong><span class="koboSpan" id="kobo.619.1">
        </span><strong class="bold"><span class="koboSpan" id="kobo.620.1">mauiAppBuilder.Services.AddTransient&lt;Views.</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.621.1">ArticleView&gt;();</span></strong><span class="koboSpan" id="kobo.622.1">
        </span><strong class="bold"><span class="koboSpan" id="kobo.623.1">mauiAppBuilder.Services.AddTransient&lt;Views.</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.624.1">HeadlinesView&gt;();</span></strong><span class="koboSpan" id="kobo.625.1">
        </span><strong class="bold"><span class="koboSpan" id="kobo.626.1">return mauiAppBuilder;</span></strong><span class="koboSpan" id="kobo.627.1">
    </span><strong class="bold"><span class="koboSpan" id="kobo.628.1">}</span></strong><span class="koboSpan" id="kobo.629.1">
}</span></pre></li> </ol>
<p><span class="koboSpan" id="kobo.630.1">The .N</span><a id="_idTextAnchor321"/><span class="koboSpan" id="kobo.631.1">ET MAUI </span><strong class="source-inline"><span class="koboSpan" id="kobo.632.1">MauiAppBuilder</span></strong><span class="koboSpan" id="kobo.633.1"> class exposes the </span><strong class="source-inline"><span class="koboSpan" id="kobo.634.1">Services</span></strong><span class="koboSpan" id="kobo.635.1"> property, which is the dependency injection container. </span><span class="koboSpan" id="kobo.635.2">We simply need to add the types we want dependency injection to know about; the container will do the rest for us. </span><span class="koboSpan" id="kobo.635.3">Think of a builder as something that collects a lot of information on what needs to be done, and then finally builds the object we need. </span><span class="koboSpan" id="kobo.635.4">It’s a very useful pattern on its own, by </span><span class="No-Break"><span class="koboSpan" id="kobo.636.1">the way.</span></span></p>
<p><span class="koboSpan" id="kobo.637.1">We're only using the builder for one thing at the </span><a id="_idIndexMarker488"/><a id="_idIndexMarker489"/><span class="koboSpan" id="kobo.638.1">moment. </span><span class="koboSpan" id="kobo.638.2">Later on, we will use it to register any class in the assembly that inherits from our abstract </span><strong class="source-inline"><span class="koboSpan" id="kobo.639.1">ViewModel</span></strong><span class="koboSpan" id="kobo.640.1"> class. </span><span class="koboSpan" id="kobo.640.2">The container is now prepared for us to ask for </span><span class="No-Break"><span class="koboSpan" id="kobo.641.1">these types.</span></span></p>
<p><span class="koboSpan" id="kobo.642.1">Now, we need to make some graphical touches to our app. </span><span class="koboSpan" id="kobo.642.2">We will rely on </span><strong class="bold"><span class="koboSpan" id="kobo.643.1">Font Awesome</span></strong><span class="koboSpan" id="kobo.644.1"> to do </span><span class="No-Break"><span class="koboSpan" id="kobo.645.1">the magic.</span></span></p>
<h3><span class="koboSpan" id="kobo.646.1">Downl</span><a id="_idTextAnchor322"/><a id="_idTextAnchor323"/><a id="_idTextAnchor324"/><span class="koboSpan" id="kobo.647.1">oading and configuring Font Awesome</span></h3>
<p><span class="koboSpan" id="kobo.648.1">Font Awesome is a free collection of images </span><a id="_idIndexMarker490"/><a id="_idIndexMarker491"/><span class="koboSpan" id="kobo.649.1">packaged into a font. </span><span class="koboSpan" id="kobo.649.2">.NET MAUI has excellent support for using Font Awesome in toolbars, navigation bars, and all over </span><a id="_idIndexMarker492"/><a id="_idIndexMarker493"/><span class="koboSpan" id="kobo.650.1">the place. </span><span class="koboSpan" id="kobo.650.2">It’s not strictly needed to make this app, but we think that it’s worth the extra round trip since you are most likely going to need something like this in your new </span><span class="No-Break"><span class="koboSpan" id="kobo.651.1">killer app.</span></span></p>
<p><span class="koboSpan" id="kobo.652.1">The fi</span><a id="_idTextAnchor325"/><span class="koboSpan" id="kobo.653.1">rst step is to download </span><span class="No-Break"><span class="koboSpan" id="kobo.654.1">the font.</span></span></p>
<h4><span class="koboSpan" id="kobo.655.1">Downlo</span><a id="_idTextAnchor326"/><span class="koboSpan" id="kobo.656.1">ading Font Awesome</span></h4>
<p><span class="koboSpan" id="kobo.657.1">Downloading the font is straightforward. </span><span class="koboSpan" id="kobo.657.2">Please</span><a id="_idIndexMarker494"/><a id="_idIndexMarker495"/><span class="koboSpan" id="kobo.658.1"> note the renaming of the file – it’s not needed but it’s easier to edit configuration files and such if they have simpler names. </span><span class="koboSpan" id="kobo.658.2">Follow these steps to acquire and copy the font to </span><span class="No-Break"><span class="koboSpan" id="kobo.659.1">each project:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.660.1">Browse </span><span class="No-Break"><span class="koboSpan" id="kobo.661.1">to </span></span><a href="https://fontawesome.com/download"><span class="No-Break"><span class="koboSpan" id="kobo.662.1">https://fontawesome.com/download</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.663.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.664.1">Click the </span><strong class="bold"><span class="koboSpan" id="kobo.665.1">Free for Desktop</span></strong><span class="koboSpan" id="kobo.666.1"> button to download </span><span class="No-Break"><span class="koboSpan" id="kobo.667.1">Font Awesome.</span></span></li>
<li><span class="koboSpan" id="kobo.668.1">Unzip the downloaded file, then locate the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.669.1">otfs</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.670.1"> folder.</span></span></li>
<li><span class="koboSpan" id="kobo.671.1">Rename the </span><strong class="source-inline"><span class="koboSpan" id="kobo.672.1">Font Awesome 5 Free-Solid-900.otf</span></strong><span class="koboSpan" id="kobo.673.1"> file to </span><strong class="source-inline"><span class="koboSpan" id="kobo.674.1">FontAwesome.otf</span></strong><span class="koboSpan" id="kobo.675.1"> (you can keep the original name, but it’s just less to type if you rename it). </span><span class="koboSpan" id="kobo.675.2">Your filename may be different since Font Awesome is continually updating but it should </span><span class="No-Break"><span class="koboSpan" id="kobo.676.1">be similar.</span></span></li>
<li><span class="koboSpan" id="kobo.677.1">Copy </span><strong class="source-inline"><span class="koboSpan" id="kobo.678.1">FontAwesome.otf</span></strong><span class="koboSpan" id="kobo.679.1"> to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.680.1">Resources/Fonts</span></strong><span class="koboSpan" id="kobo.681.1"> folder in the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.682.1">News</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.683.1"> project.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.684.1">Alright – now, we need to register Font Awesome with .</span><span class="No-Break"><span class="koboSpan" id="kobo.685.1">NET MAUI.</span></span></p>
<h4><span class="koboSpan" id="kobo.686.1">Configuring .NET MAUI to use Font Awesome</span></h4>
<p><span class="koboSpan" id="kobo.687.1">It would be nice if all we needed to do </span><a id="_idIndexMarker496"/><a id="_idIndexMarker497"/><a id="_idIndexMarker498"/><span class="koboSpan" id="kobo.688.1">was to copy the font file into the project folders. </span><span class="koboSpan" id="kobo.688.2">A lot does happen with just that action. </span><span class="koboSpan" id="kobo.688.3">The default .NET MAUI template includes all the fonts in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.689.1">Resources/Fonts</span></strong><span class="koboSpan" id="kobo.690.1"> folder with the following item definition in the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.691.1">News.csproj</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.692.1"> file:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.693.1">
&lt;!-- Custom Fonts --&gt;
&lt;MauiFont Include="Resources\Fonts\*" /&gt;</span></pre> <p><span class="koboSpan" id="kobo.694.1">This ensures that the font files are processed and included in the app package automatically. </span><span class="koboSpan" id="kobo.694.2">What is left is to register the font with the .NET MAUI runtime so that it is available to our XAML resources. </span><span class="koboSpan" id="kobo.694.3">To do that, add the following highlighted line to the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.695.1">MauiProgram.cs</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.696.1"> file:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.697.1">
.ConfigureFonts(fonts =&gt;
{
    </span><strong class="bold"><span class="koboSpan" id="kobo.698.1">fonts.AddFont("FontAwesome.otf", "FontAwesome");</span></strong><span class="koboSpan" id="kobo.699.1">
    fonts.AddFont("OpenSans-Regular.ttf", "OpenSansRegular");
    fonts.AddFont("OpenSans-Semibold.ttf", "OpenSansSemibold");
})</span></pre> <p><span class="koboSpan" id="kobo.700.1">This line adds an alias that we can use in the next section to create static resources. </span><span class="koboSpan" id="kobo.700.2">The first parameter is the filename for the font file, while the second is the alias for the font that we can use in the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.701.1">FontFamily</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.702.1"> attribute.</span></span></p>
<p><span class="koboSpan" id="kobo.703.1">All that is left is to define some icons in a </span><span class="No-Break"><span class="koboSpan" id="kobo.704.1">resource dictionary.</span></span></p>
<h4><span class="koboSpan" id="kobo.705.1">Deﬁnin</span><a id="_idTextAnchor327"/><a id="_idTextAnchor328"/><span class="koboSpan" id="kobo.706.1">g some icons in the resource dictionary</span></h4>
<p><span class="koboSpan" id="kobo.707.1">Now that we have defined the font, we </span><a id="_idIndexMarker499"/><a id="_idIndexMarker500"/><span class="koboSpan" id="kobo.708.1">will put that to use and define five icons to use in our app. </span><span class="koboSpan" id="kobo.708.2">We’ll add the XAML first; then, we’ll examine one of the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.709.1">FontImage</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.710.1"> tags.</span></span></p>
<p><span class="koboSpan" id="kobo.711.1">Proceed </span><span class="No-Break"><span class="koboSpan" id="kobo.712.1">as follows:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.713.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.714.1">News</span></strong><span class="koboSpan" id="kobo.715.1"> project, </span><span class="No-Break"><span class="koboSpan" id="kobo.716.1">open </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.717.1">App.xaml</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.718.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.719.1">Add the following code marked in bold under the existing </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.720.1">ResourceDictionary.MergedDictionaries</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.721.1"> tag:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.722.1">
&lt;ResourceDictionary&gt;
  &lt;ResourceDictionary.MergedDictionaries&gt;
    &lt;ResourceDictionary Source="Resources/Styles/Colors.xaml" /&gt;
    &lt;ResourceDictionary Source="Resources/Styles/Styles.xaml" /&gt;
  &lt;/ResourceDictionary.MergedDictionaries&gt;
</span><strong class="bold"><span class="koboSpan" id="kobo.723.1">  &lt;FontImage x:Key="HomeIcon" FontFamily="FontAwesome" Glyph</span><a id="_idTextAnchor329"/><span class="koboSpan" id="kobo.724.1">="&amp;#xf015;" Size="22" Color="Black" /&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.725.1">  &lt;FontImage x:Key="HeadlinesIcon" FontFamily="FontAwesome" Glyph="&amp;#xf70e;" Size="22" /&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.726.1">  &lt;FontImage x:Key="NewsIcon" FontFamily=" FontAwesome" Glyph="&amp;#xf1ea;" Size="22" /&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.727.1">  &lt;FontImage x:Key="SettingsIcon" FontFamily="FontAwesome" Glyph="&amp;#xf013;" Size="22" Color="Black" /&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.728.1">  &lt;FontImage x:Key="AboutIcon" FontFamily="FontAwesome" Glyph="&amp;#xf05a;" Size="22" Color="Black" /&gt;</span></strong><span class="koboSpan" id="kobo.729.1">
&lt;/ResourceDictionary&gt;</span></pre></li> </ol>
<p><strong class="source-inline"><span class="koboSpan" id="kobo.730.1">FontImage</span></strong><span class="koboSpan" id="kobo.731.1"> is a class that can be used anywhere in .NET MAUI that expects an </span><strong class="source-inline"><span class="koboSpan" id="kobo.732.1">ImageSource</span></strong><span class="koboSpan" id="kobo.733.1"> object. </span><span class="koboSpan" id="kobo.733.2">It’s designed to render one character (or glyph) into an image. </span><span class="koboSpan" id="kobo.733.3">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.734.1">FontImage</span></strong><span class="koboSpan" id="kobo.735.1"> class needs a few attributes to work, detailed </span><span class="No-Break"><span class="koboSpan" id="kobo.736.1">as follows:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.737.1">A key for reference that will be used by other views in </span><span class="No-Break"><span class="koboSpan" id="kobo.738.1">the application.</span></span></li>
<li><span class="koboSpan" id="kobo.739.1">A </span><strong class="source-inline"><span class="koboSpan" id="kobo.740.1">FontFamily</span></strong><span class="koboSpan" id="kobo.741.1"> resource that uses the alias reference back to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.742.1">Font</span></strong><span class="koboSpan" id="kobo.743.1"> resource that we defined in the </span><span class="No-Break"><span class="koboSpan" id="kobo.744.1">preceding section.</span></span></li>
<li><span class="koboSpan" id="kobo.745.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.746.1">Glyph</span></strong><span class="koboSpan" id="kobo.747.1"> object, which represents the image to be shown. </span><span class="koboSpan" id="kobo.747.2">To find which image these cryptic values refer to, check out </span><a href="http://fontawesome.com"><span class="koboSpan" id="kobo.748.1">fontawesome.com</span></a><span class="koboSpan" id="kobo.749.1">, click on </span><strong class="bold"><span class="koboSpan" id="kobo.750.1">Icons</span></strong><span class="koboSpan" id="kobo.751.1">, select </span><strong class="bold"><span class="koboSpan" id="kobo.752.1">free and open-source icons</span></strong><span class="koboSpan" id="kobo.753.1">, and </span><span class="No-Break"><span class="koboSpan" id="kobo.754.1">start browsing.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.755.1">Size</span></strong><span class="koboSpan" id="kobo.756.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.757.1">Color</span></strong><span class="koboSpan" id="kobo.758.1">. </span><span class="koboSpan" id="kobo.758.2">These are not strictly needed but they’re nice to define. </span><span class="koboSpan" id="kobo.758.3">They are used for a few of the icons in this app so that they render properly for </span><span class="No-Break"><span class="koboSpan" id="kobo.759.1">light themes.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.760.1">Font Awesome is now installed and configured. </span><span class="koboSpan" id="kobo.760.2">We’ve done a lot of work to get to the actual</span><a id="_idTextAnchor330"/><span class="koboSpan" id="kobo.761.1"> topic of this chapter. </span><span class="koboSpan" id="kobo.761.2">It’s time to define </span><span class="No-Break"><span class="koboSpan" id="kobo.762.1">the shell!</span></span></p>
<h3><span class="koboSpan" id="kobo.763.1">Defini</span><a id="_idTextAnchor331"/><span class="koboSpan" id="kobo.764.1">ng the shell</span></h3>
<p><span class="koboSpan" id="kobo.765.1">As stated earlier, .NET MAUI Shell is the</span><a id="_idIndexMarker501"/><a id="_idIndexMarker502"/><span class="koboSpan" id="kobo.766.1"> newest way of defining the structure of your app. </span><span class="koboSpan" id="kobo.766.2">The different projects in this book use alternate ways of defining the overall structure of the app, but .NET MAUI Shell is, in our opinion, the best way of defining the UI structure. </span><span class="koboSpan" id="kobo.766.3">We hope you find it as exciting as </span><span class="No-Break"><span class="koboSpan" id="kobo.767.1">we do!</span></span></p>
<h4><span class="koboSpan" id="kobo.768.1">Deﬁnin</span><a id="_idTextAnchor332"/><a id="_idTextAnchor333"/><a id="_idTextAnchor334"/><span class="koboSpan" id="kobo.769.1">g the basic structure</span></h4>
<p><span class="koboSpan" id="kobo.770.1">We’re going to start by defining a basic structure </span><a id="_idIndexMarker503"/><a id="_idIndexMarker504"/><span class="koboSpan" id="kobo.771.1">for the app without really adding any of our defined views to it. </span><span class="koboSpan" id="kobo.771.2">After that, we’ll add the actual views one by one. </span><span class="koboSpan" id="kobo.771.3">But let’s start by adding some content and creating </span><strong class="source-inline"><span class="koboSpan" id="kobo.772.1">ContentPage</span></strong><span class="koboSpan" id="kobo.773.1"> objects using XAML directly. </span><span class="koboSpan" id="kobo.773.2">Follow these two steps to </span><span class="No-Break"><span class="koboSpan" id="kobo.774.1">do so:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.775.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.776.1">News</span></strong><span class="koboSpan" id="kobo.777.1"> project, open the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.778.1">AppShell.xaml</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.779.1"> file.</span></span></li>
<li><span class="koboSpan" id="kobo.780.1">Alter the file so that it looks like the </span><span class="No-Break"><span class="koboSpan" id="kobo.781.1">following code:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.782.1">
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;Shell 
       
    
</span><strong class="bold"><span class="koboSpan" id="kobo.783.1">    x:Class="News.AppShell"&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.784.1">    &lt;FlyoutItem Title="Home" Icon="{StaticResource HomeIcon}"&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.785.1">      &lt;ShellContent Title="Headlines" Icon="{StaticResource HeadlinesIcon}" &gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.786.1">      &lt;ContentPage Title="Headlines" /&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.787.1">      &lt;/ShellContent&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.788.1">      &lt;Tab Title="News" Icon="{StaticResource NewsIcon}"&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.789.1">        &lt;ContentPage Title="Local" /&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.790.1">        &lt;ContentPage Title="Global" /&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.791.1">      &lt;/Tab&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.792.1">    &lt;/FlyoutItem&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.793.1">    &lt;FlyoutItem Title="Settings" Icon="{StaticResource SettingsIcon}"&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.794.1">      &lt;ContentPage Title="Settings" /&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.795.1">    &lt;/FlyoutItem&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.796.1">    &lt;ShellContent Title="About" Icon="{StaticResource AboutIcon}"&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.797.1">      &lt;ContentPage Title="About"/&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.798.1">    &lt;/ShellContent&gt;</span></strong><span class="koboSpan" id="kobo.799.1">
&lt;/Shell&gt;</span></pre></li> </ol>
<p><span class="koboSpan" id="kobo.800.1">Let’s </span><a id="_idTextAnchor335"/><span class="koboSpan" id="kobo.801.1">break this down. </span><span class="koboSpan" id="kobo.801.2">First, by default, the .NET MAUI Shell template disables the flyout menu. </span><span class="koboSpan" id="kobo.801.3">Since we want to use it in this app, you must remove the line that disables it. </span><span class="koboSpan" id="kobo.801.4">The direct children of Shell itself are two </span><strong class="source-inline"><span class="koboSpan" id="kobo.802.1">FlyoutItem</span></strong><span class="koboSpan" id="kobo.803.1"> objects and one </span><strong class="source-inline"><span class="koboSpan" id="kobo.804.1">ShellContent</span></strong><span class="koboSpan" id="kobo.805.1"> object. </span><span class="koboSpan" id="kobo.805.2">All three of these have </span><strong class="source-inline"><span class="koboSpan" id="kobo.806.1">Title</span></strong><span class="koboSpan" id="kobo.807.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.808.1">Icon</span></strong><span class="koboSpan" id="kobo.809.1"> properties defined, as shown in the following screenshot. </span><span class="koboSpan" id="kobo.809.2">The icons are referenced to the Font Awesome resources we created earlier. </span><span class="koboSpan" id="kobo.809.3">This will render a flyout, as shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.810.1">following screenshot:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer095">
<span class="koboSpan" id="kobo.811.1"><img alt="Figure 4.7 – The app flyout" src="image/Figure_4.7_B19214.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.812.1">Figure 4.7 – The app flyout</span></p>
<p><span class="koboSpan" id="kobo.813.1">The flyout is accessible by swiping in from the left. </span><strong class="source-inline"><span class="koboSpan" id="kobo.814.1">Flyout</span></strong><span class="koboSpan" id="kobo.815.1"> objects can have multiple children, while the </span><strong class="source-inline"><span class="koboSpan" id="kobo.816.1">ShellContent</span></strong><span class="koboSpan" id="kobo.817.1"> element can only have a </span><span class="No-Break"><span class="koboSpan" id="kobo.818.1">single child.</span></span></p>
<p><span class="koboSpan" id="kobo.819.1">The </span><strong class="bold"><span class="koboSpan" id="kobo.820.1">Home</span></strong><span class="koboSpan" id="kobo.821.1"> flyout item is the most complex </span><a id="_idIndexMarker505"/><a id="_idIndexMarker506"/><span class="koboSpan" id="kobo.822.1">example. </span><span class="koboSpan" id="kobo.822.2">It has two children; </span><strong class="source-inline"><span class="koboSpan" id="kobo.823.1">ShellContent</span></strong><span class="koboSpan" id="kobo.824.1"> with a page with the title </span><strong class="bold"><span class="koboSpan" id="kobo.825.1">Headlines</span></strong><span class="koboSpan" id="kobo.826.1"> and a tab that defines two child pages on its own. </span><span class="koboSpan" id="kobo.826.2">The first level of children will render the tab bar at the bottom of the app, as shown in the following screenshot. </span><span class="koboSpan" id="kobo.826.3">The second level of children, under the </span><strong class="bold"><span class="koboSpan" id="kobo.827.1">Tab</span></strong><span class="koboSpan" id="kobo.828.1"> element with the </span><strong class="bold"><span class="koboSpan" id="kobo.829.1">News</span></strong><span class="koboSpan" id="kobo.830.1"> title, will be rendered as a tab bar directly under the title of the navigation bar at </span><span class="No-Break"><span class="koboSpan" id="kobo.831.1">the top:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer096">
<span class="koboSpan" id="kobo.832.1"><img alt="Figure 4.8 – The Shell tabs and pages" src="image/Figure_4.8_B19214.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.833.1">Figure 4.8 – The Shell tabs and pages</span></p>
<p><span class="koboSpan" id="kobo.834.1">The </span><strong class="bold"><span class="koboSpan" id="kobo.835.1">Sett</span><a id="_idTextAnchor336"/><a id="_idTextAnchor337"/><span class="koboSpan" id="kobo.836.1">ings</span></strong><span class="koboSpan" id="kobo.837.1"> and </span><strong class="bold"><span class="koboSpan" id="kobo.838.1">About</span></strong><span class="koboSpan" id="kobo.839.1"> flyouts will simply render the pages that </span><span class="No-Break"><span class="koboSpan" id="kobo.840.1">they define.</span></span></p>
<h3><span class="koboSpan" id="kobo.841.1">Making t</span><a id="_idTextAnchor338"/><a id="_idTextAnchor339"/><span class="koboSpan" id="kobo.842.1">he app run</span></h3>
<p><span class="koboSpan" id="kobo.843.1">It’s time to try the app out and see whether it looks</span><a id="_idIndexMarker507"/><a id="_idIndexMarker508"/><span class="koboSpan" id="kobo.844.1"> like the screenshots shown throughout this chapter. </span><span class="koboSpan" id="kobo.844.2">The app should now run. </span><span class="koboSpan" id="kobo.844.3">If not, stay calm and simply go through the code again. </span><span class="koboSpan" id="kobo.844.4">Once you are done navigating around the app, we can create a news service to fetch news from, an</span><a id="_idTextAnchor340"/><span class="koboSpan" id="kobo.845.1">d extend all those views that </span><span class="No-Break"><span class="koboSpan" id="kobo.846.1">we’ve created.</span></span></p>
<h2 id="_idParaDest-96"><span class="koboSpan" id="kobo.847.1">Creating</span><a id="_idTextAnchor341"/><span class="koboSpan" id="kobo.848.1"> the news service</span></h2>
<p><span class="koboSpan" id="kobo.849.1">To find cool content, we’ll</span><a id="_idIndexMarker509"/><a id="_idIndexMarker510"/><span class="koboSpan" id="kobo.850.1"> consume an already existing </span><strong class="source-inline"><span class="koboSpan" id="kobo.851.1">News</span></strong><span class="koboSpan" id="kobo.852.1"> API provided by </span><a href="http://newsapi.org"><span class="koboSpan" id="kobo.853.1">newsapi.org</span></a><span class="koboSpan" id="kobo.854.1">. </span><span class="koboSpan" id="kobo.854.2">To do so, we must register for an API key that we can use to request the news. </span><span class="koboSpan" id="kobo.854.3">If you aren’t comfortable with doing so, you can mock the news service if you would like, instead of using </span><span class="No-Break"><span class="koboSpan" id="kobo.855.1">the API.</span></span></p>
<p><span class="koboSpan" id="kobo.856.1">The first thing we must do is obtain an </span><span class="No-Break"><span class="koboSpan" id="kobo.857.1">API key.</span></span></p>
<h3><span class="koboSpan" id="kobo.858.1">Obtainin</span><a id="_idTextAnchor342"/><a id="_idTextAnchor343"/><a id="_idTextAnchor344"/><span class="koboSpan" id="kobo.859.1">g an API key</span></h3>
<p><span class="koboSpan" id="kobo.860.1">The process</span><a id="_idIndexMarker511"/><a id="_idIndexMarker512"/><span class="koboSpan" id="kobo.861.1"> of registering is pretty </span><a id="_idIndexMarker513"/><a id="_idIndexMarker514"/><span class="koboSpan" id="kobo.862.1">straightforward. </span><span class="koboSpan" id="kobo.862.2">Be aware, however, that the UI of </span><a href="http://newsapi.org"><span class="koboSpan" id="kobo.863.1">newsapi.org</span></a><span class="koboSpan" id="kobo.864.1"> might have changed by the time you </span><span class="No-Break"><span class="koboSpan" id="kobo.865.1">read this.</span></span></p>
<p><span class="koboSpan" id="kobo.866.1">OK – let’s get </span><span class="No-Break"><span class="koboSpan" id="kobo.867.1">that key:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.868.1">Browse </span><span class="No-Break"><span class="koboSpan" id="kobo.869.1">to </span></span><a href="https://newsapi.org/"><span class="No-Break"><span class="koboSpan" id="kobo.870.1">https://newsapi.org/</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.871.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.872.1">Click </span><strong class="bold"><span class="koboSpan" id="kobo.873.1">Get </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.874.1">API key</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.875.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.876.1">Fill out the form, as illustrated in the </span><span class="No-Break"><span class="koboSpan" id="kobo.877.1">following screenshot:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer097">
<span class="koboSpan" id="kobo.878.1"><img alt="Figure 4.9 – Register for API ﻿key" src="image/Figure_4.9_B19214.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.879.1">Figure 4.9 – Register for API key</span></p>
<ol>
<li value="4"><span class="koboSpan" id="kobo.880.1">Copy the </span><a id="_idTextAnchor345"/><span class="koboSpan" id="kobo.881.1">API key provided on the next page, as illustrated in the </span><span class="No-Break"><span class="koboSpan" id="kobo.882.1">following screenshot:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer098">
<span class="koboSpan" id="kobo.883.1"><img alt="Figure 4.10 – Registration complete" src="image/Figure_4.10_B19214.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.884.1">Figure 4.10 – Registration complete</span></p>
<p><span class="koboSpan" id="kobo.885.1">Now, we need a place to store the key for easy access. </span><span class="koboSpan" id="kobo.885.2">We’ll create a static class that will hold the key for us. </span><span class="koboSpan" id="kobo.885.3">Proceed </span><span class="No-Break"><span class="koboSpan" id="kobo.886.1">as follows:</span></span><a id="_idIndexMarker515"/><a id="_idIndexMarker516"/></p>
<ol>
<li><span class="koboSpan" id="kobo.887.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.888.1">News</span></strong><span class="koboSpan" id="kobo.889.1"> project, create a new class called </span><strong class="source-inline"><span class="koboSpan" id="kobo.890.1">Settings</span></strong><span class="koboSpan" id="kobo.891.1"> in the </span><span class="No-Break"><span class="koboSpan" id="kobo.892.1">root folder.</span></span></li>
<li><span class="koboSpan" id="kobo.893.1">Add the code shown in the following snippet, replacing the placeholder text with the API key you obtained in the </span><span class="No-Break"><span class="koboSpan" id="kobo.894.1">preceding steps:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.895.1">
namespace News;
internal static class Settings
{
    public static string NewsApiKey =&gt; "</span><strong class="bold"><span class="koboSpan" id="kobo.896.1">&lt;Your APIKEY Here&gt;</span></strong><span class="koboSpan" id="kobo.897.1">";
}</span></pre></li> </ol>
<p><span class="koboSpan" id="kobo.898.1">The important thing here is that you copy and paste the key into the file. </span><span class="koboSpan" id="kobo.898.2">Now, we </span><span class="No-Break"><span class="koboSpan" id="kobo.899.1">need models.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.900.1">A note on tokens and other secrets</span></p>
<p class="callout"><span class="koboSpan" id="kobo.901.1">This is not a recommended way to store an API key or any other token that should be secured in your app. </span><span class="koboSpan" id="kobo.901.2">To securely store tokens and other data, you should use </span><strong class="bold"><span class="koboSpan" id="kobo.902.1">secure storage</span></strong><span class="koboSpan" id="kobo.903.1"> (see </span><a href="https://learn.microsoft.com/en-us/dotnet/maui/platform-integration/storage/secure-storage"><span class="koboSpan" id="kobo.904.1">https://learn.microsoft.com/en-us/dotnet/maui/platform-integration/storage/secure-storage</span></a><span class="koboSpan" id="kobo.905.1">) and obtain the data from a secure server, preferably gated by some form of user authentication. </span><span class="koboSpan" id="kobo.905.2">You could also require the user to provide the API key through a settings page – </span><span class="No-Break"><span class="koboSpan" id="kobo.906.1">hint, hint.</span></span></p>
<h3><span class="koboSpan" id="kobo.907.1">Creating t</span><a id="_idTextAnchor346"/><a id="_idTextAnchor347"/><a id="_idTextAnchor348"/><span class="koboSpan" id="kobo.908.1">he models</span></h3>
<p><span class="koboSpan" id="kobo.909.1">The data returned from the API needs to go somewhere, and the most convenient way of accessing it would be to deserialize</span><a id="_idIndexMarker517"/><a id="_idIndexMarker518"/><span class="koboSpan" id="kobo.910.1"> the data into </span><strong class="bold"><span class="koboSpan" id="kobo.911.1">Plain Old CLR Objects</span></strong><span class="koboSpan" id="kobo.912.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.913.1">POCO</span></strong><span class="koboSpan" id="kobo.914.1">, also known as regular C# classes). </span><span class="koboSpan" id="kobo.914.2">We usually call these POCO</span><a id="_idIndexMarker519"/><a id="_idIndexMarker520"/><span class="koboSpan" id="kobo.915.1"> objects models, and they usually like to live in a folder called </span><strong class="source-inline"><span class="koboSpan" id="kobo.916.1">Models</span></strong><span class="koboSpan" id="kobo.917.1">. </span><span class="koboSpan" id="kobo.917.2">Let’s create </span><span class="No-Break"><span class="koboSpan" id="kobo.918.1">our models:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.919.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.920.1">News</span></strong><span class="koboSpan" id="kobo.921.1"> project, create a new folder </span><span class="No-Break"><span class="koboSpan" id="kobo.922.1">called </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.923.1">Models</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.924.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.925.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.926.1">Models</span></strong><span class="koboSpan" id="kobo.927.1"> folder, add a new class </span><span class="No-Break"><span class="koboSpan" id="kobo.928.1">called </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.929.1">NewsApiModels</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.930.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.931.1">Add the following code to </span><span class="No-Break"><span class="koboSpan" id="kobo.932.1">the class:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.933.1">
namespace News.Models;
using System;
using System.Collections.Generic;
using System.Text.Json.Serialization;
public class Source
{
    [JsonPropertyName("id")]
    public string Id { get; set; }
    [JsonPropertyName("name")]
    public string Name { get; set; }
}
public class Article
{
    [JsonPropertyName("source")]
    public Source Source { get; set; }
    [JsonPropertyName("author")]
    public string Author { get; set; }
    [JsonPropertyName("title")]
    public string Title { get; set; }
    [JsonPropertyName("description")]
    public string Description { get; set; }
    [JsonPropertyName("url")]
    public string Url { get; set; }
    [JsonPropertyName("urlToImage")]
    public string UrlToImage { get; set; }
    [JsonPropertyName("publishedAt")]
    public DateTime PublishedAt { get; set; }
    [JsonPropertyName("content")]
    public string Content { get; set; }
}
public class NewsResult
{
    [JsonPropertyName("status")]
    public string Status { get; set; }
    [JsonPropertyName("totalResults")]
    public int TotalResults { get; set; }
    [JsonPropertyName("articles")]
    public List&lt;Article&gt; Articles { get; set; }
}</span></pre></li> </ol>
<p><span class="koboSpan" id="kobo.934.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.935.1">JsonPropertyName</span></strong><span class="koboSpan" id="kobo.936.1"> attributes on each property allow the </span><strong class="source-inline"><span class="koboSpan" id="kobo.937.1">System.Text.Json</span></strong><span class="koboSpan" id="kobo.938.1"> deserializer to map the name from the JSON received from the web API into the C# object. </span><span class="koboSpan" id="kobo.938.2">When we call the API, the API will return a </span><strong class="source-inline"><span class="koboSpan" id="kobo.939.1">NewsResult</span></strong><span class="koboSpan" id="kobo.940.1"> object that </span><a id="_idIndexMarker521"/><a id="_idIndexMarker522"/><span class="koboSpan" id="kobo.941.1">will, in turn, contain a list of articles. </span><span class="koboSpan" id="kobo.941.2">The next step is to create a service that will wrap the API and allow us to access the </span><span class="No-Break"><span class="koboSpan" id="kobo.942.1">latest news.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.943.1">Tip for creating POCO classes</span></p>
<p class="callout"><span class="koboSpan" id="kobo.944.1">If you ever need to create a class model </span><a id="_idIndexMarker523"/><a id="_idIndexMarker524"/><span class="koboSpan" id="kobo.945.1">out of a bunch of </span><strong class="bold"><span class="koboSpan" id="kobo.946.1">JavaScript Object Notation</span></strong><span class="koboSpan" id="kobo.947.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.948.1">JSON</span></strong><span class="koboSpan" id="kobo.949.1">), you can use the </span><strong class="bold"><span class="koboSpan" id="kobo.950.1">Paste JSON as Classes</span></strong><span class="koboSpan" id="kobo.951.1"> tool in Visual Studio for Windows (</span><strong class="bold"><span class="koboSpan" id="kobo.952.1">Edit</span></strong><span class="koboSpan" id="kobo.953.1"> | </span><strong class="bold"><span class="koboSpan" id="kobo.954.1">Paste Special</span></strong><span class="koboSpan" id="kobo.955.1"> | </span><strong class="bold"><span class="koboSpan" id="kobo.956.1">Paste JSON </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.957.1">as Classes</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.958.1">).</span></span></p>
<h3><a id="_idTextAnchor349"/><span class="koboSpan" id="kobo.959.1">Creating a</span><a id="_idTextAnchor350"/><span class="koboSpan" id="kobo.960.1"> service class</span></h3>
<p><span class="koboSpan" id="kobo.961.1">The service class will wrap the API so that we can</span><a id="_idIndexMarker525"/><a id="_idIndexMarker526"/><span class="koboSpan" id="kobo.962.1"> access it in a nice .NET-ish kind </span><span class="No-Break"><span class="koboSpan" id="kobo.963.1">of way.</span></span></p>
<p><span class="koboSpan" id="kobo.964.1">But we’ll </span><a id="_idTextAnchor351"/><span class="koboSpan" id="kobo.965.1">start by defining an enum that will define the scope of the news that </span><span class="No-Break"><span class="koboSpan" id="kobo.966.1">we request.</span></span></p>
<h4><span class="koboSpan" id="kobo.967.1">Creating t</span><a id="_idTextAnchor352"/><span class="koboSpan" id="kobo.968.1">he NewsScope enum</span></h4>
<p><span class="koboSpan" id="kobo.969.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.970.1">NewsScope</span></strong><span class="koboSpan" id="kobo.971.1"> enum defines the </span><a id="_idIndexMarker527"/><a id="_idIndexMarker528"/><span class="koboSpan" id="kobo.972.1">different kinds of news that our service supports. </span><span class="koboSpan" id="kobo.972.2">Let’s add it by following these </span><span class="No-Break"><span class="koboSpan" id="kobo.973.1">few steps:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.974.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.975.1">News</span></strong><span class="koboSpan" id="kobo.976.1"> project, create a new folder </span><span class="No-Break"><span class="koboSpan" id="kobo.977.1">called </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.978.1">Services</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.979.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.980.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.981.1">Services</span></strong><span class="koboSpan" id="kobo.982.1"> folder, add a new file </span><span class="No-Break"><span class="koboSpan" id="kobo.983.1">called </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.984.1">NewsScope.cs</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.985.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.986.1">Add the following code to </span><span class="No-Break"><span class="koboSpan" id="kobo.987.1">that file:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.988.1">
namespace News.Services;
public enum NewsScope
{
    Headlines,
    Local,
    Global
}</span></pre></li> </ol>
<p><span class="koboSpan" id="kobo.989.1">The next step is to create the </span><strong class="source-inline"><span class="koboSpan" id="kobo.990.1">NewsService</span></strong><span class="koboSpan" id="kobo.991.1"> class that will wrap </span><a id="_idTextAnchor353"/><span class="koboSpan" id="kobo.992.1">the call to the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.993.1">News</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.994.1"> API.</span></span></p>
<h4><span class="koboSpan" id="kobo.995.1">Creating the NewsService class</span></h4>
<p><span class="koboSpan" id="kobo.996.1">The purpose of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.997.1">NewsService</span></strong><span class="koboSpan" id="kobo.998.1"> class is to </span><a id="_idIndexMarker529"/><a id="_idIndexMarker530"/><span class="koboSpan" id="kobo.999.1">wrap the HTTP calls to the news REST API and make them easily accessible to our code in the form of regular .NET method calls. </span><span class="koboSpan" id="kobo.999.2">To make it easier to replace the source of the news – for example, to use a mock in tests – we will use </span><span class="No-Break"><span class="koboSpan" id="kobo.1000.1">an interface.</span></span></p>
<p><span class="koboSpan" id="kobo.1001.1">To create the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1002.1">INewsService</span></strong><span class="koboSpan" id="kobo.1003.1"> interface, follow </span><span class="No-Break"><span class="koboSpan" id="kobo.1004.1">these steps:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.1005.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1006.1">Services</span></strong><span class="koboSpan" id="kobo.1007.1"> folder, create a new interface </span><span class="No-Break"><span class="koboSpan" id="kobo.1008.1">called </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1009.1">INewsService</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1010.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.1011.1">Edit the interface so that it looks </span><span class="No-Break"><span class="koboSpan" id="kobo.1012.1">like this:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.1013.1">
namespace News.Services;
using News.Models;
public interface INewsService
{
    public Task&lt;NewsResult&gt; GetNews(NewsScope scope);
}</span></pre></li> </ol>
<p><span class="koboSpan" id="kobo.1014.1">Creating the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1015.1">NewsService</span></strong><span class="koboSpan" id="kobo.1016.1"> class is now quite straightforward. </span><span class="koboSpan" id="kobo.1016.2">Follow </span><span class="No-Break"><span class="koboSpan" id="kobo.1017.1">these steps:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.1018.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1019.1">Services</span></strong><span class="koboSpan" id="kobo.1020.1"> folder, create a new class </span><span class="No-Break"><span class="koboSpan" id="kobo.1021.1">called </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1022.1">NewsService</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1023.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.1024.1">Edit the class so that it looks </span><span class="No-Break"><span class="koboSpan" id="kobo.1025.1">like this:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.1026.1">
namespace News.Services;
using News.Models;
using System.Net.Http.Json;
public class NewsService : INewsService, IDisposable
{
    private bool disposedValue;
    const string UriBase = "https://newsapi.org/v2";
    readonly HttpClient httpClient = new() {
        BaseAddress = new(UriBase),
        DefaultRequestHeaders = { { "user-agent", "maui-projects-news/1.0" } }
    };
    public async Task&lt;NewsResult&gt; GetNews(NewsScope scope)
    {
        NewsResult result;
        string url = GetUrl(scope);
        try
        {
            result = await httpClient.GetFromJsonAsync&lt;NewsResult&gt;(url);
        }
        catch (Exception ex) {
            result = new() { Articles = new() { new() { Title = $"HTTP Get failed: {ex.Message}", PublishedAt = DateTime.Now} } };
        }
        return result;
    }
    private string GetUrl(NewsScope scope) =&gt; scope switch
    {
        NewsScope.Headlines =&gt; Headlines,
        NewsScope.Global =&gt; Global,
        NewsScope.Local =&gt; Local,
        _ =&gt; throw new Exception("Undefined scope")
    };
    private static string Headlines =&gt; $"{UriBase}/top-headlines?country=us&amp;apiKey={Settings.NewsApiKey}";
    private static string Local =&gt; $"{UriBase}/everything?q=local&amp;apiKey={Settings.NewsApiKey}";
    private static string Global =&gt; $"{UriBase}/everything?q=global&amp;apiKey={Settings.NewsApiKey}";
    protected virtual void Dispose(bool disposing)
    {
        if (!disposedValue)
        {
            if (disposing)
            {
                httpClient.Dispose();
            }
            disposedValue = true;
        }
    }
    public void Dispose()
    {
        // Do not change this code. </span><span class="koboSpan" id="kobo.1026.2">Put cleanup code in 'Dispose(bool disposing)' method
        Dispose(disposing: true);
        GC.SuppressFinalize(this);
    }
}</span></pre></li> </ol>
<p><span class="koboSpan" id="kobo.1027.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.1028.1">NewsService</span></strong><span class="koboSpan" id="kobo.1029.1"> class is composed of five methods; I know there are technically eight, but we will get to that in </span><span class="No-Break"><span class="koboSpan" id="kobo.1030.1">a moment.</span></span></p>
<p><span class="koboSpan" id="kobo.1031.1">The first method, </span><strong class="source-inline"><span class="koboSpan" id="kobo.1032.1">GetNews</span></strong><span class="koboSpan" id="kobo.1033.1">, is the method that we will eventually call from our app. </span><span class="koboSpan" id="kobo.1033.2">It takes one parameter, </span><strong class="source-inline"><span class="koboSpan" id="kobo.1034.1">scope</span></strong><span class="koboSpan" id="kobo.1035.1">, which is the enum that we created earlier. </span><span class="koboSpan" id="kobo.1035.2">Depending on the value of this parameter, we will get different types of news. </span><span class="koboSpan" id="kobo.1035.3">The first thing this method does is resolve the URL to call, and it does so by calling the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1036.1">GetUrl</span></strong><span class="koboSpan" id="kobo.1037.1"> method with </span><span class="No-Break"><span class="koboSpan" id="kobo.1038.1">the scope.</span></span></p>
<p><span class="koboSpan" id="kobo.1039.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.1040.1">GetUrl</span></strong><span class="koboSpan" id="kobo.1041.1"> method uses a switch expression to resolve the URL and, depending on the value of the scope parameter passed, returns one of three URLs. </span><span class="koboSpan" id="kobo.1041.2">The URL points to the REST API of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1042.1">News</span></strong><span class="koboSpan" id="kobo.1043.1"> API with some predefined query parameters and the API key that we </span><span class="No-Break"><span class="koboSpan" id="kobo.1044.1">registered for.</span></span></p>
<p><span class="koboSpan" id="kobo.1045.1">When we’ve resolved the correct URL, we are ready to make the HTTP request and download the news in the form of JSON. </span><span class="koboSpan" id="kobo.1045.2">The built-in </span><strong class="source-inline"><span class="koboSpan" id="kobo.1046.1">HttpClient</span></strong><span class="koboSpan" id="kobo.1047.1"> class in .NET does a fine job of fetching the JSON for us. </span><span class="koboSpan" id="kobo.1047.2">All that is left after acquiring the data </span><a id="_idIndexMarker531"/><a id="_idIndexMarker532"/><span class="koboSpan" id="kobo.1048.1">is to deserialize it into the news models that we </span><span class="No-Break"><span class="koboSpan" id="kobo.1049.1">defined earlier.</span></span></p>
<p><span class="koboSpan" id="kobo.1050.1">Let’s say a word or two about the remainder of the methods and the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1051.1">HttpClient</span></strong><span class="koboSpan" id="kobo.1052.1"> class. </span><strong class="source-inline"><span class="koboSpan" id="kobo.1053.1">HttpClient</span></strong><span class="koboSpan" id="kobo.1054.1"> is now the recommended class to use when requesting data from the web. </span><span class="koboSpan" id="kobo.1054.2">It is a much safer implementation than was previously available. </span><span class="koboSpan" id="kobo.1054.3">It has been shipping with .NET 5+ and is available as a separate NuGet package for previous versions. </span><span class="koboSpan" id="kobo.1054.4">With that, there are a few peculiarities when </span><span class="No-Break"><span class="koboSpan" id="kobo.1055.1">using </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1056.1">HttpClient</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1057.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.1058.1">First, </span><strong class="source-inline"><span class="koboSpan" id="kobo.1059.1">HttpClient</span></strong><span class="koboSpan" id="kobo.1060.1"> can hold onto native resources, so it must be properly disposed of. </span><span class="koboSpan" id="kobo.1060.2">To properly dispose of </span><strong class="source-inline"><span class="koboSpan" id="kobo.1061.1">HttpClient</span></strong><span class="koboSpan" id="kobo.1062.1">, we need to derive from and implement </span><strong class="source-inline"><span class="koboSpan" id="kobo.1063.1">IDisposable</span></strong><span class="koboSpan" id="kobo.1064.1">. </span><span class="koboSpan" id="kobo.1064.2">This is the reason for the extra methods that are in the class, </span><strong class="source-inline"><span class="koboSpan" id="kobo.1065.1">Dispose(bool)</span></strong><span class="koboSpan" id="kobo.1066.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.1067.1">Dispose()</span></strong><span class="koboSpan" id="kobo.1068.1">. </span><span class="koboSpan" id="kobo.1068.2">All they do is make sure that the instance of </span><strong class="source-inline"><span class="koboSpan" id="kobo.1069.1">HttpClient</span></strong><span class="koboSpan" id="kobo.1070.1"> is disposed </span><span class="No-Break"><span class="koboSpan" id="kobo.1071.1">of properly.</span></span></p>
<p><span class="koboSpan" id="kobo.1072.1">Second, </span><strong class="source-inline"><span class="koboSpan" id="kobo.1073.1">HttpClient</span></strong><span class="koboSpan" id="kobo.1074.1"> will pool those native resources, so it is recommended that you reuse an instance of </span><strong class="source-inline"><span class="koboSpan" id="kobo.1075.1">HttpClient</span></strong><span class="koboSpan" id="kobo.1076.1"> as much as possible. </span><span class="koboSpan" id="kobo.1076.2">This is the reason for creating the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1077.1">HttpClient</span></strong><span class="koboSpan" id="kobo.1078.1"> instance in the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1079.1">NewsService</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1080.1"> constructor.</span></span></p>
<p><span class="koboSpan" id="kobo.1081.1">Final word – since the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1082.1">GetFromJsonAsync</span></strong><span class="koboSpan" id="kobo.1083.1"> call can throw an exception and it is called from an </span><strong class="source-inline"><span class="koboSpan" id="kobo.1084.1">async</span></strong><span class="koboSpan" id="kobo.1085.1"> method, you must handle the exception; otherwise, it will be lost on the executing thread and your only indication that something is wrong will be</span><a id="_idIndexMarker533"/><a id="_idIndexMarker534"/><span class="koboSpan" id="kobo.1086.1"> the fact that you have no items. </span><span class="koboSpan" id="kobo.1086.2">For this app, we are just going to create a </span><strong class="source-inline"><span class="koboSpan" id="kobo.1087.1">NewsResult</span></strong><span class="koboSpan" id="kobo.1088.1"> object that contains one </span><strong class="source-inline"><span class="koboSpan" id="kobo.1089.1">Article</span></strong><span class="koboSpan" id="kobo.1090.1"> that has the exception in it so that something is displayed. </span><span class="koboSpan" id="kobo.1090.2">There are much better ways of handling errors, but this will do for </span><span class="No-Break"><span class="koboSpan" id="kobo.1091.1">this app.</span></span></p>
<p><span class="koboSpan" id="kobo.1092.1">The next step is to wire up the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1093.1">NewsService</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1094.1"> class.</span></span></p>
<h2 id="_idParaDest-97"><span class="koboSpan" id="kobo.1095.1">Wiring up</span><a id="_idTextAnchor354"/><a id="_idTextAnchor355"/><a id="_idTextAnchor356"/><span class="koboSpan" id="kobo.1096.1"> the NewsService class</span></h2>
<p><span class="koboSpan" id="kobo.1097.1">We are now ready to wire up</span><a id="_idIndexMarker535"/><a id="_idIndexMarker536"/><span class="koboSpan" id="kobo.1098.1"> the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1099.1">NewsService</span></strong><span class="koboSpan" id="kobo.1100.1"> class in our app and integrate it with a real news source. </span><span class="koboSpan" id="kobo.1100.2">We will extend all the existing </span><strong class="source-inline"><span class="koboSpan" id="kobo.1101.1">ViewModels</span></strong><span class="koboSpan" id="kobo.1102.1"> that we have and define the UI element</span><a id="_idTextAnchor357"/><span class="koboSpan" id="kobo.1103.1">s to be able to render the news in </span><span class="No-Break"><span class="koboSpan" id="kobo.1104.1">the </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1105.1">Views</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1106.1">.</span></span></p>
<h3><span class="koboSpan" id="kobo.1107.1">Extending </span><a id="_idTextAnchor358"/><span class="koboSpan" id="kobo.1108.1">the HeadlinesViewModel class</span></h3>
<p><span class="koboSpan" id="kobo.1109.1">In MVVM, </span><strong class="source-inline"><span class="koboSpan" id="kobo.1110.1">ViewModel</span></strong><span class="koboSpan" id="kobo.1111.1"> is the place to handle the logic of the app. </span><span class="koboSpan" id="kobo.1111.2">The model is the news data that we will get from our </span><strong class="source-inline"><span class="koboSpan" id="kobo.1112.1">NewsService</span></strong><span class="koboSpan" id="kobo.1113.1"> class. </span><span class="koboSpan" id="kobo.1113.2">We will now </span><a id="_idIndexMarker537"/><a id="_idIndexMarker538"/><span class="koboSpan" id="kobo.1114.1">extend the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1115.1">HeadlinesViewModel</span></strong><span class="koboSpan" id="kobo.1116.1"> class so that it uses </span><strong class="source-inline"><span class="koboSpan" id="kobo.1117.1">NewsService</span></strong><span class="koboSpan" id="kobo.1118.1"> to </span><span class="No-Break"><span class="koboSpan" id="kobo.1119.1">fetch news:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.1120.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1121.1">News</span></strong><span class="koboSpan" id="kobo.1122.1"> project, expand the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1123.1">ViewModels</span></strong><span class="koboSpan" id="kobo.1124.1"> folder and open the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1125.1">HeadlinesViewModel.cs</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1126.1"> file.</span></span></li>
<li><span class="koboSpan" id="kobo.1127.1">Add the following code marked in bold and resolve </span><span class="No-Break"><span class="koboSpan" id="kobo.1128.1">the references:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.1129.1">
namespace News.ViewModels;
</span><strong class="bold"><span class="koboSpan" id="kobo.1130.1">using System.Threading.Tasks;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1131.1">using System.Web;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1132.1">using CommunityToolkit.Mvvm.ComponentModel;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1133.1">using CommunityToolkit.Mvvm.Input;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1134.1">using News.Models;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1135.1">using News.Services;</span></strong><span class="koboSpan" id="kobo.1136.1">
public </span><strong class="bold"><span class="koboSpan" id="kobo.1137.1">partial</span></strong><span class="koboSpan" id="kobo.1138.1"> class HeadlinesViewModel : ViewModel
{
</span><strong class="bold"><span class="koboSpan" id="kobo.1139.1">    private readonly INewsService newsService;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1140.1">    [ObservableProperty]</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1141.1">    private NewsResult currentNews;</span></strong><span class="koboSpan" id="kobo.1142.1">
    public HeadlinesViewModel(</span><strong class="bold"><span class="koboSpan" id="kobo.1143.1">INewsService newsService</span></strong><span class="koboSpan" id="kobo.1144.1">)
    {
        </span><strong class="bold"><span class="koboSpan" id="kobo.1145.1">this.newsService = newsService;</span></strong><span class="koboSpan" id="kobo.1146.1">
    }
</span><strong class="bold"><span class="koboSpan" id="kobo.1147.1">    public async Task Initialize(string scope) =&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1148.1">        await Initialize(scope.ToLower() switch</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1149.1">        {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1150.1">            "local" =&gt; NewsScope.Local,</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1151.1">            "global" =&gt; NewsScope.Global,</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1152.1">            "headlines" =&gt; NewsScope.Headlines,</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1153.1">            _ =&gt; NewsScope.Headlines</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1154.1">        });</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1155.1">    public async Task Initialize(NewsScope scope)</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1156.1">    {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1157.1">        CurrentNews = await newsService.GetNews(scope);</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1158.1">    }</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1159.1">    [RelayCommand]</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1160.1">    public void ItemSelected(object selectedItem)</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1161.1">    {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1162.1">        var selectedArticle = selectedItem as Article;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1163.1">        var url = HttpUtility.UrlEncode(selectedArticle.Url);</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1164.1">        // Placeholder for more code later on</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1165.1">    }</span></strong><span class="koboSpan" id="kobo.1166.1">
}</span></pre></li> </ol>
<p><span class="koboSpan" id="kobo.1167.1">Since we are using (constructor) dependency injection, we need to inject our dependencies into the constructor. </span><span class="koboSpan" id="kobo.1167.2">The only dependency this </span><strong class="source-inline"><span class="koboSpan" id="kobo.1168.1">ViewModel</span></strong><span class="koboSpan" id="kobo.1169.1"> has is </span><strong class="source-inline"><span class="koboSpan" id="kobo.1170.1">NewsService</span></strong><span class="koboSpan" id="kobo.1171.1">, and we store it internally in the class as </span><span class="No-Break"><span class="koboSpan" id="kobo.1172.1">a field.</span></span></p>
<p><span class="koboSpan" id="kobo.1173.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.1174.1">CurrentNews</span></strong><span class="koboSpan" id="kobo.1175.1"> property is defined to get </span><a id="_idIndexMarker539"/><a id="_idIndexMarker540"/><span class="koboSpan" id="kobo.1176.1">something to bind the </span><span class="No-Break"><span class="koboSpan" id="kobo.1177.1">UI to.</span></span></p>
<p><span class="koboSpan" id="kobo.1178.1">Then, we have two </span><strong class="source-inline"><span class="koboSpan" id="kobo.1179.1">Initialize</span></strong><span class="koboSpan" id="kobo.1180.1"> methods – one that takes </span><strong class="source-inline"><span class="koboSpan" id="kobo.1181.1">scope</span></strong><span class="koboSpan" id="kobo.1182.1"> as an enum and one that takes </span><strong class="source-inline"><span class="koboSpan" id="kobo.1183.1">scope</span></strong><span class="koboSpan" id="kobo.1184.1"> as a string. </span><span class="koboSpan" id="kobo.1184.2">The string overload of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1185.1">Initialize</span></strong><span class="koboSpan" id="kobo.1186.1"> method will be used in XAML. </span><span class="koboSpan" id="kobo.1186.2">It simply translates the string into the enum representation of </span><strong class="source-inline"><span class="koboSpan" id="kobo.1187.1">scope</span></strong><span class="koboSpan" id="kobo.1188.1"> and then calls the other </span><strong class="source-inline"><span class="koboSpan" id="kobo.1189.1">Initialize</span></strong><span class="koboSpan" id="kobo.1190.1"> method, which, in turn, calls the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1191.1">GetNews(...)</span></strong><span class="koboSpan" id="kobo.1192.1"> method on the </span><span class="No-Break"><span class="koboSpan" id="kobo.1193.1">news service.</span></span></p>
<p><span class="koboSpan" id="kobo.1194.1">The property at the end, </span><strong class="source-inline"><span class="koboSpan" id="kobo.1195.1">ItemSelected</span></strong><span class="koboSpan" id="kobo.1196.1">, returns a .NET MAUI command that we will wire up to respond to when the user of the app selects an item. </span><span class="koboSpan" id="kobo.1196.2">Half of the method is implemented from the start. </span><span class="koboSpan" id="kobo.1196.3">The selected item will be passed into the method. </span><span class="koboSpan" id="kobo.1196.4">Then, we encode the URL to the article since we will be passing it as a query parameter when we navigate within the app. </span><span class="koboSpan" id="kobo.1196.5">We will get back to the navigation part in </span><span class="No-Break"><span class="koboSpan" id="kobo.1197.1">a while.</span></span></p>
<p><span class="koboSpan" id="kobo.1198.1">If you are curious about the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1199.1">ObservableProperty</span></strong><span class="koboSpan" id="kobo.1200.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.1201.1">RelayCommand</span></strong><span class="koboSpan" id="kobo.1202.1"> attributes, refresh your memory by reviewing </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.1203.1">Chapter 2</span></em></span><span class="koboSpan" id="kobo.1204.1">, </span><em class="italic"><span class="koboSpan" id="kobo.1205.1">Building Our First .NET </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.1206.1">MAUI App</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.1207.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.1208.1">Now that we have the code to fetch the data, we’ll move on to defining the UI to </span><span class="No-Break"><span class="koboSpan" id="kobo.1209.1">display it.</span></span></p>
<h3><span class="koboSpan" id="kobo.1210.1">Extending </span><a id="_idTextAnchor359"/><a id="_idTextAnchor360"/><a id="_idTextAnchor361"/><span class="koboSpan" id="kobo.1211.1">HeadlinesView</span></h3>
<p><strong class="source-inline"><span class="koboSpan" id="kobo.1212.1">HeadlinesView</span></strong><span class="koboSpan" id="kobo.1213.1"> is a shared view that will be used in several places in the app. </span><span class="koboSpan" id="kobo.1213.2">The purpose of this view is to display a list of articles and to allow for </span><a id="_idIndexMarker541"/><a id="_idIndexMarker542"/><span class="koboSpan" id="kobo.1214.1">navigation from one article into a web browser that will display the </span><span class="No-Break"><span class="koboSpan" id="kobo.1215.1">entire article.</span></span></p>
<p><span class="koboSpan" id="kobo.1216.1">To extend </span><strong class="source-inline"><span class="koboSpan" id="kobo.1217.1">HeadlinesView</span></strong><span class="koboSpan" id="kobo.1218.1"> we must do two things – first, must we edit the XAML and define the UI; then, we need to add some code to initialize it. </span><span class="koboSpan" id="kobo.1218.2">Proceed </span><span class="No-Break"><span class="koboSpan" id="kobo.1219.1">as follows:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.1220.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1221.1">News</span></strong><span class="koboSpan" id="kobo.1222.1"> project, expand the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1223.1">Views</span></strong><span class="koboSpan" id="kobo.1224.1"> folder and open the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1225.1">HeadlinesView.xaml</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1226.1"> file.</span></span></li>
<li><span class="koboSpan" id="kobo.1227.1">Edit the XAML, as shown in the following </span><span class="No-Break"><span class="koboSpan" id="kobo.1228.1">code block:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.1229.1">
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;ContentPage 
             
</span><strong class="bold"><span class="koboSpan" id="kobo.1230.1">    </span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1231.1">    </span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1232.1">    </span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1233.1">    x:Name="headlinesview"</span></strong><span class="koboSpan" id="kobo.1234.1">
    x:Class="News.Views.HeadlinesView"
</span><strong class="bold"><span class="koboSpan" id="kobo.1235.1">              x:DataType="viewModels:HeadlinesViewModel"</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1236.1">    Title="Home" Padding="14"&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1237.1">  &lt;CollectionView ItemsSource="{Binding CurrentNews.Articles}"&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1238.1">    &lt;CollectionView.EmptyView&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1239.1">      &lt;Label Text="Loading" /&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1240.1">    &lt;/CollectionView.EmptyView&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1241.1">    &lt;CollectionView.ItemTemplate&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1242.1">      &lt;DataTemplate x:DataType="models:Article"&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1243.1">        &lt;ContentView&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1244.1">          &lt;ContentView.GestureRecognizers&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1245.1">            &lt;TapGestureRecognizer Command="{Binding BindingContext.ItemSelectedCommand, Source={x:Reference headlinesview}}" CommandParameter="{Binding .}" /&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1246.1">          &lt;/ContentView.GestureRecognizers&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1247.1">          &lt;views:ArticleItem /&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1248.1">        &lt;/ContentView&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1249.1">      &lt;/DataTemplate&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1250.1">    &lt;/CollectionView.ItemTemplate&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1251.1">  &lt;/CollectionView&gt;</span></strong><span class="koboSpan" id="kobo.1252.1">
&lt;/ContentPage&gt;</span></pre></li> </ol>
<p><strong class="source-inline"><span class="koboSpan" id="kobo.1253.1">HeadlinesV</span><a id="_idTextAnchor362"/><span class="koboSpan" id="kobo.1254.1">iew</span></strong><span class="koboSpan" id="kobo.1255.1"> uses </span><strong class="source-inline"><span class="koboSpan" id="kobo.1256.1">CollectionView</span></strong><span class="koboSpan" id="kobo.1257.1"> to display the list of articles. </span><span class="koboSpan" id="kobo.1257.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.1258.1">ItemsSource</span></strong><span class="koboSpan" id="kobo.1259.1"> property is set to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1260.1">CurrentNews.Articles</span></strong><span class="koboSpan" id="kobo.1261.1"> property of </span><strong class="source-inline"><span class="koboSpan" id="kobo.1262.1">ViewModel</span></strong><span class="koboSpan" id="kobo.1263.1">, which, after loading news, should contain a list of news. </span><span class="koboSpan" id="kobo.1263.2">While the list is empty or loading, we display a loading label, defined within the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1264.1">CollectionView.EmptyView</span></strong><span class="koboSpan" id="kobo.1265.1"> element. </span><span class="koboSpan" id="kobo.1265.2">You could, of course, create any valid UI inside of that tag to create a cooler </span><span class="No-Break"><span class="koboSpan" id="kobo.1266.1">loading screen.</span></span></p>
<p><span class="koboSpan" id="kobo.1267.1">Each article in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1268.1">CurrentNews.Articles</span></strong><span class="koboSpan" id="kobo.1269.1"> list will be rendered using whatever is inside the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1270.1">CollectionView.ItemTemplate</span></strong><span class="koboSpan" id="kobo.1271.1"> element, and it’s what’s inside of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1272.1">ContentView</span></strong><span class="koboSpan" id="kobo.1273.1"> element that will represent the actual item. </span><span class="koboSpan" id="kobo.1273.2">The article will be rendered using an </span><strong class="source-inline"><span class="koboSpan" id="kobo.1274.1">ArticleItem</span></strong><span class="koboSpan" id="kobo.1275.1"> view, which is a custom control that we defined earlier. </span><span class="koboSpan" id="kobo.1275.2">We will define this view after we are done with </span><span class="No-Break"><span class="koboSpan" id="kobo.1276.1">this view.</span></span></p>
<p><span class="koboSpan" id="kobo.1277.1">To enable navigation from the view, we need to </span><a id="_idIndexMarker543"/><a id="_idIndexMarker544"/><span class="koboSpan" id="kobo.1278.1">detect when a user clicks on a specific article. </span><span class="koboSpan" id="kobo.1278.2">We can do so by adding </span><strong class="source-inline"><span class="koboSpan" id="kobo.1279.1">TapGestureRecognizer</span></strong><span class="koboSpan" id="kobo.1280.1"> and binding it to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1281.1">ItemSelectedCommand</span></strong><span class="koboSpan" id="kobo.1282.1"> property of the root </span><strong class="source-inline"><span class="koboSpan" id="kobo.1283.1">ViewModel</span></strong><span class="koboSpan" id="kobo.1284.1">. </span><span class="koboSpan" id="kobo.1284.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.1285.1">Source={x:Reference headlinesview}}</span></strong><span class="koboSpan" id="kobo.1286.1"> snippet is what references the current context back to the root of the page, not the current article in the list that we are iterating. </span><span class="koboSpan" id="kobo.1286.2">If we didn’t specify the source, the binding engine would try to bind the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1287.1">ItemSelectedCommand</span></strong><span class="koboSpan" id="kobo.1288.1"> property to a property defined in the current article of the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1289.1">CurrentNews.Articles</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1290.1"> property.</span></span></p>
<p><span class="koboSpan" id="kobo.1291.1">That’s all for the GUI part. </span><span class="koboSpan" id="kobo.1291.2">Now, we need to alter the code-behind to enable initialization based on data that we will pass from the XAML itself. </span><span class="koboSpan" id="kobo.1291.3">Follow these steps to make </span><span class="No-Break"><span class="koboSpan" id="kobo.1292.1">it happen:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.1293.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1294.1">News</span></strong><span class="koboSpan" id="kobo.1295.1"> project, open the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1296.1">HeadlinesView.xaml.cs</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.1297.1">code-behind file.</span></span></li>
<li><span class="koboSpan" id="kobo.1298.1">Add the following code marked in bold to </span><span class="No-Break"><span class="koboSpan" id="kobo.1299.1">the file:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.1300.1">
namespace News.Views
using System.Threading.Tasks;
using News.Services;
</span><strong class="bold"><span class="koboSpan" id="kobo.1301.1">using News.ViewModels;</span></strong><span class="koboSpan" id="kobo.1302.1">
public partial class HeadlinesView : ContentPage
{
    </span><strong class="bold"><span class="koboSpan" id="kobo.1303.1">readonly HeadlinesViewModel viewModel;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1304.1">    public HeadlinesView(HeadlinesViewModel viewModel)</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1305.1">    {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1306.1">        this.viewModel = viewModel;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1307.1">        InitializeComponent();</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1308.1">        Task.Run(async () =&gt; await Initialize(GetScopeFromRoute()));</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1309.1">    }</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1310.1">    private async Task Initialize(string scope)</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1311.1">    {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1312.1">        BindingContext = viewModel;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1313.1">        await viewModel.Initialize(scope);</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1314.1">    }</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1315.1">    private string GetScopeFromRoute()</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1316.1">    {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1317.1">        var route = Shell.Current.CurrentState.Location</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1318.1">        .OriginalString.Split("/").LastOrDefault();</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1319.1">        return route;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1320.1">    }</span></strong><span class="koboSpan" id="kobo.1321.1">
}</span></pre></li> </ol>
<p><span class="koboSpan" id="kobo.1322.1">Usually, we don’t want to add code to the code-behind of a view directly, but we need to make an exception so that arguments can be passed from XAML to </span><span class="No-Break"><span class="koboSpan" id="kobo.1323.1">our </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1324.1">ViewModel</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1325.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.1326.1">Based on the routing information that was used to create the view, we will initialize </span><strong class="source-inline"><span class="koboSpan" id="kobo.1327.1">ViewModel</span></strong><span class="koboSpan" id="kobo.1328.1"> differently. </span><span class="koboSpan" id="kobo.1328.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.1329.1">GetScopeFromRoute</span></strong><span class="koboSpan" id="kobo.1330.1"> method will parse the location information from </span><strong class="source-inline"><span class="koboSpan" id="kobo.1331.1">Shell</span></strong><span class="koboSpan" id="kobo.1332.1"> to determine which scope is used to query the news</span><a id="_idIndexMarker545"/><a id="_idIndexMarker546"/><span class="koboSpan" id="kobo.1333.1"> service. </span><span class="koboSpan" id="kobo.1333.2">Then, we can call a private method that creates an instance of </span><strong class="source-inline"><span class="koboSpan" id="kobo.1334.1">HeadlinesViewModel</span></strong><span class="koboSpan" id="kobo.1335.1"> for us, sets it as the binding context of the view, and calls the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1336.1">Initialize()</span></strong><span class="koboSpan" id="kobo.1337.1"> method on </span><strong class="source-inline"><span class="koboSpan" id="kobo.1338.1">ViewModel</span></strong><span class="koboSpan" id="kobo.1339.1">, which makes the REST call to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1340.1">News</span></strong><span class="koboSpan" id="kobo.1341.1"> API. </span><span class="koboSpan" id="kobo.1341.2">We will define the routes when we edit the </span><span class="No-Break"><span class="koboSpan" id="kobo.1342.1">shell file.</span></span></p>
<p><span class="koboSpan" id="kobo.1343.1">But first, we need to extend </span><strong class="source-inline"><span class="koboSpan" id="kobo.1344.1">ContentView</span></strong><span class="koboSpan" id="kobo.1345.1"> of </span><strong class="source-inline"><span class="koboSpan" id="kobo.1346.1">ArticleItem</span></strong><span class="koboSpan" id="kobo.1347.1"> so that it displays a single-row item in th</span><a id="_idTextAnchor363"/><span class="koboSpan" id="kobo.1348.1">e </span><span class="No-Break"><span class="koboSpan" id="kobo.1349.1">news lists.</span></span></p>
<h3><span class="koboSpan" id="kobo.1350.1">Extending </span><a id="_idTextAnchor364"/><span class="koboSpan" id="kobo.1351.1">ContentView of ArticleItem</span></h3>
<p><strong class="source-inline"><span class="koboSpan" id="kobo.1352.1">ContentView</span></strong><span class="koboSpan" id="kobo.1353.1"> of </span><strong class="source-inline"><span class="koboSpan" id="kobo.1354.1">ArticleItem</span></strong><span class="koboSpan" id="kobo.1355.1"> represents one item</span><a id="_idIndexMarker547"/><span class="koboSpan" id="kobo.1356.1"> in a list of news, as shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.1357.1">following screenshot:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer099">
<span class="koboSpan" id="kobo.1358.1"><img alt="Figure 4.11 – A sample news item" src="image/Figure_4.11_B19214.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.1359.1">Figure 4.11 – A sample news item</span></p>
<p><span class="koboSpan" id="kobo.1360.1">To create the layout shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.1361.1">Figure 4</span></em></span><em class="italic"><span class="koboSpan" id="kobo.1362.1">.11</span></em><span class="koboSpan" id="kobo.1363.1">, we will use a </span><strong class="source-inline"><span class="koboSpan" id="kobo.1364.1">Grid</span></strong><span class="koboSpan" id="kobo.1365.1"> control. </span><span class="koboSpan" id="kobo.1365.2">Follow these steps to create </span><span class="No-Break"><span class="koboSpan" id="kobo.1366.1">the layout:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.1367.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1368.1">News</span></strong><span class="koboSpan" id="kobo.1369.1"> project, expand the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1370.1">Views</span></strong><span class="koboSpan" id="kobo.1371.1"> folder and open the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1372.1">ArticleItem.xaml</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1373.1"> file.</span></span></li>
<li><span class="koboSpan" id="kobo.1374.1">Edit the XAML code, as shown in the following </span><span class="No-Break"><span class="koboSpan" id="kobo.1375.1">code block:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.1376.1">
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;ContentView 
    
             
    x:Class="News.Views.ArticleItem"
    x:DataType="models:Article"&gt;
  &lt;Grid Margin="0"&gt;
    &lt;Grid.RowDefinitions&gt;
      &lt;RowDefinition Height="10" /&gt;
      &lt;RowDefinition Height="40" /&gt;
      &lt;RowDefinition Height="15" /&gt;
      &lt;RowDefinition Height="10" /&gt;
      &lt;RowDefinition Height="1" /&gt;
    &lt;/Grid.RowDefinitions&gt;
    &lt;Grid.ColumnDefinitions&gt;
      &lt;ColumnDefinition Width="65" /&gt;
      &lt;ColumnDefinition Width="*" /&gt;
    &lt;/Grid.ColumnDefinitions&gt;
    &lt;Label Grid.Row="1" Grid.Column="1" Text="{Binding Title}" Padding="10,0" FontSize="Small" FontAttributes="Bold" /&gt;
    &lt;Label Grid.Row="2" Grid.Column="1" Text="{Binding PublishedAt, StringFormat='{0:MMMM d, yyyy}'}" Padding="10,0,0,0" FontSize="Micro" /&gt;
    &lt;Border Grid.Row="1" Grid.RowSpan="2" StrokeShape="RoundRectangle 15,15,15,15" Padding="0" Margin="0,0,0,0" BackgroundColor="#667788" &gt;
      &lt;Image Source="{Binding UrlToImage}" Aspect="AspectFill" HeightRequest="55" HorizontalOptions="Center" VerticalOptions="Center" /&gt;
    &lt;/Border&gt;
    &lt;BoxView Grid.Row="4" Grid.ColumnSpan="2" BackgroundColor="LightGray" /&gt;
  &lt;/Grid&gt;
&lt;/ContentView&gt;</span></pre></li> </ol>
<p><span class="koboSpan" id="kobo.1377.1">The preceding XAML code defines a grid layout with two columns and five rows. </span><span class="koboSpan" id="kobo.1377.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.1378.1">Grid.Row</span></strong><span class="koboSpan" id="kobo.1379.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.1380.1">Grid.Column</span></strong><span class="koboSpan" id="kobo.1381.1"> attributes </span><a id="_idIndexMarker548"/><span class="koboSpan" id="kobo.1382.1">position child elements into the grid, while the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1383.1">Grid.ColumnSpan</span></strong><span class="koboSpan" id="kobo.1384.1"> attribute allows for a control to span </span><span class="No-Break"><span class="koboSpan" id="kobo.1385.1">multiple columns.</span></span></p>
<p><span class="koboSpan" id="kobo.1386.1">A rounded image can be achieved using a </span><strong class="source-inline"><span class="koboSpan" id="kobo.1387.1">Border</span></strong><span class="koboSpan" id="kobo.1388.1"> element with </span><strong class="source-inline"><span class="koboSpan" id="kobo.1389.1">StrokeShape="RoundRectangle 15,15,15,15"</span></strong><span class="koboSpan" id="kobo.1390.1"> specified in conjunction with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1391.1">Image</span></strong> <strong class="source-inline"><span class="koboSpan" id="kobo.1392.1">Aspect</span></strong><span class="koboSpan" id="kobo.1393.1"> attribute set </span><span class="No-Break"><span class="koboSpan" id="kobo.1394.1">to </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1395.1">AspectFill</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1396.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.1397.1">Strings in labels can be formatted directly in the binding statement. </span><span class="koboSpan" id="kobo.1397.2">Check out the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1398.1">Text="{Binding PublishedAt, StringFormat='{0:MMMM d, yyyy}'}"</span></strong><span class="koboSpan" id="kobo.1399.1"> line of code, which formats a date into a specific </span><span class="No-Break"><span class="koboSpan" id="kobo.1400.1">string format.</span></span></p>
<p><span class="koboSpan" id="kobo.1401.1">Lastly, the gray divider line is </span><strong class="source-inline"><span class="koboSpan" id="kobo.1402.1">BoxView</span></strong><span class="koboSpan" id="kobo.1403.1"> at the end of the </span><span class="No-Break"><span class="koboSpan" id="kobo.1404.1">XAML code.</span></span></p>
<p><span class="koboSpan" id="kobo.1405.1">Now that we have created </span><strong class="source-inline"><span class="koboSpan" id="kobo.1406.1">NewsService</span></strong><span class="koboSpan" id="kobo.1407.1"> and fixed all its related views, it’s time to make</span><a id="_idTextAnchor365"/><span class="koboSpan" id="kobo.1408.1"> use </span><span class="No-Break"><span class="koboSpan" id="kobo.1409.1">of them.</span></span><a id="_idTextAnchor366"/></p>
<h3><span class="koboSpan" id="kobo.1410.1">Adding to dependency injection</span></h3>
<p><span class="koboSpan" id="kobo.1411.1">Since </span><strong class="source-inline"><span class="koboSpan" id="kobo.1412.1">HeadlinesViewModel</span></strong><span class="koboSpan" id="kobo.1413.1"> depends on </span><strong class="source-inline"><span class="koboSpan" id="kobo.1414.1">INewsService</span></strong><span class="koboSpan" id="kobo.1415.1">, we need to register it in our dependency injection container (please see the </span><em class="italic"><span class="koboSpan" id="kobo.1416.1">Wiring up dependency injection</span></em><span class="koboSpan" id="kobo.1417.1"> section in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.1418.1">Chapter 2</span></em></span><span class="koboSpan" id="kobo.1419.1"> for more details </span><a id="_idIndexMarker549"/><span class="koboSpan" id="kobo.1420.1">on dependency injection in .NET MAUI). </span><span class="koboSpan" id="kobo.1420.2">Follow these steps to </span><span class="No-Break"><span class="koboSpan" id="kobo.1421.1">do so:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.1422.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1423.1">News</span></strong><span class="koboSpan" id="kobo.1424.1"> project, open the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1425.1">MauiProgram.cs</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1426.1"> file.</span></span></li>
<li><span class="koboSpan" id="kobo.1427.1">Locate the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1428.1">RegisterAppTypes()</span></strong><span class="koboSpan" id="kobo.1429.1"> method and add the following line marked </span><span class="No-Break"><span class="koboSpan" id="kobo.1430.1">in bold:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.1431.1">
public static MauiAppBuilder RegisterAppTypes(this MauiAppBuilder mauiAppBuilder)
{
</span><strong class="bold"><span class="koboSpan" id="kobo.1432.1">    // Services</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1433.1">     mauiAppBuilder.Services.AddSingleton&lt;Services.INewsService&gt;((serviceProvider) =&gt; new Services.NewsService());</span></strong><span class="koboSpan" id="kobo.1434.1">
    // ViewModels
    mauiAppBuilder.Services.AddTransient&lt;ViewModels.HeadlinesViewModel&gt;();
    //Views
    mauiAppBuilder.Services.AddTransient&lt;Views.AboutView&gt;();
    mauiAppBuilder.Services.AddTransient&lt;Views.ArticleView&gt;();
    mauiAppBuilder.Services.AddTransient&lt;Views.HeadlinesView&gt;();
    return mauiAppBuilder;
</span><a id="_idTextAnchor367"/><span class="koboSpan" id="kobo.1435.1">}</span></pre></li> </ol>
<p><span class="koboSpan" id="kobo.1436.1">This will allow for the dependency </span><a id="_idIndexMarker550"/><span class="koboSpan" id="kobo.1437.1">injection </span><span class="No-Break"><span class="koboSpan" id="kobo.1438.1">of </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1439.1">NewsServic</span><a id="_idTextAnchor368"/><a id="_idTextAnchor369"/><span class="koboSpan" id="kobo.1440.1">e</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1441.1">.</span></span></p>
<h3><span class="koboSpan" id="kobo.1442.1">Adding a ContentTemplate attribute</span></h3>
<p><span class="koboSpan" id="kobo.1443.1">So far, we only have placeholder </span><a id="_idIndexMarker551"/><span class="koboSpan" id="kobo.1444.1">code in our </span><strong class="source-inline"><span class="koboSpan" id="kobo.1445.1">AppShell</span></strong><span class="koboSpan" id="kobo.1446.1"> file. </span><span class="koboSpan" id="kobo.1446.2">Let’s replace this with actual content, </span><span class="No-Break"><span class="koboSpan" id="kobo.1447.1">as follows:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.1448.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1449.1">News</span></strong><span class="koboSpan" id="kobo.1450.1"> project, </span><span class="No-Break"><span class="koboSpan" id="kobo.1451.1">open </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1452.1">AppShell.xaml</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1453.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.1454.1">Locate the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1455.1">FlyoutItem</span></strong><span class="koboSpan" id="kobo.1456.1"> element with the title set </span><span class="No-Break"><span class="koboSpan" id="kobo.1457.1">to </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1458.1">Home</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1459.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.1460.1">Edit the XAML so that the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1461.1">ShellContent</span></strong><span class="koboSpan" id="kobo.1462.1"> element becomes self-closing, add the following </span><strong class="source-inline"><span class="koboSpan" id="kobo.1463.1">ContentTemplate</span></strong><span class="koboSpan" id="kobo.1464.1"> attribute marked in bold, and replace the contents of the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1465.1">Tab</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1466.1"> element:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.1467.1">
&lt;Shell
    x:Class="News.AppShell"
    
    
    </span><strong class="bold"><span class="koboSpan" id="kobo.1468.1"/></strong><span class="koboSpan" id="kobo.1469.1">
    &gt;
</span><strong class="bold"><span class="koboSpan" id="kobo.1470.1">    &lt;FlyoutItem Title="Home" Icon="{StaticResource HomeIcon}"&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1471.1">        &lt;ShellContent Title="Headlines" Route="headlines" Icon="{StaticResource HeadlinesIcon}" ContentTemplate="{DataTemplate views:HeadlinesView}" /&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1472.1">        &lt;Tab Title="News" Route="news" Icon="{StaticResource NewsIcon}"&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1473.1">            &lt;ShellContent Title="Local" Route="local" ContentTemplate="{DataTemplate views:HeadlinesView}" /&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1474.1">            &lt;ShellContent Title="Global" Route="global" ContentTemplate="{DataTemplate views:HeadlinesView}" /&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1475.1">        &lt;/Tab&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1476.1">    &lt;/FlyoutItem&gt;</span></strong><span class="koboSpan" id="kobo.1477.1">
    &lt;FlyoutItem Title="Settings" Icon="{StaticResource SettingsIcon}"&gt;
        &lt;ContentPage Title="Settings" /&gt;
    &lt;/FlyoutItem&gt;
    &lt;ShellContent Title="About" Icon="{StaticResource AboutIcon}"&gt;
        &lt;ContentPage Title="About"/&gt;
    &lt;/ShellContent&gt;
&lt;/She</span><a id="_idTextAnchor370"/><span class="koboSpan" id="kobo.1478.1">ll&gt;</span></pre></li> </ol>
<p><span class="koboSpan" id="kobo.1479.1">Two things are going on </span><a id="_idIndexMarker552"/><span class="koboSpan" id="kobo.1480.1">here. </span><span class="koboSpan" id="kobo.1480.2">The first is that we specify the content of </span><strong class="source-inline"><span class="koboSpan" id="kobo.1481.1">ShellContent</span></strong><span class="koboSpan" id="kobo.1482.1"> using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1483.1">ContentTemplate</span></strong><span class="koboSpan" id="kobo.1484.1"> attribute. </span><span class="koboSpan" id="kobo.1484.2">This means that we point to the type of view that we want to have created when the shell becomes visible. </span><span class="koboSpan" id="kobo.1484.3">Usually, you want to defer the creation of a view until right before it is going to be displayed, and the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1485.1">ContentTemplate</span></strong><span class="koboSpan" id="kobo.1486.1"> attribute gives you that. </span><span class="koboSpan" id="kobo.1486.2">Notice that the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1487.1">Route</span></strong><span class="koboSpan" id="kobo.1488.1"> attribute for that </span><strong class="source-inline"><span class="koboSpan" id="kobo.1489.1">FlyoutItem</span></strong><span class="koboSpan" id="kobo.1490.1"> is set </span><span class="No-Break"><span class="koboSpan" id="kobo.1491.1">to </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1492.1">headlines</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1493.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.1494.1">The second thing is that we have the same thing going on below for the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1495.1">Local</span></strong><span class="koboSpan" id="kobo.1496.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.1497.1">Global</span></strong><span class="koboSpan" id="kobo.1498.1"> news but instead </span><a id="_idIndexMarker553"/><span class="koboSpan" id="kobo.1499.1">using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1500.1">local</span></strong><span class="koboSpan" id="kobo.1501.1"> and </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1502.1">global</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1503.1"> routes.</span></span></p>
<p><span class="koboSpan" id="kobo.1504.1">If you run the app at this point, you should end up with something that looks like the </span><span class="No-Break"><span class="koboSpan" id="kobo.1505.1">following screensh</span><a id="_idTextAnchor371"/><span class="koboSpan" id="kobo.1506.1">ot:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer100">
<span class="koboSpan" id="kobo.1507.1"><img alt="Figure 4.12 – The main list view" src="image/Figure_4.12_B19214.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.1508.1">Figure 4.12 – The main list view</span></p>
<p><span class="koboSpan" id="kobo.1509.1">The last thing we need to implement is how we can view the articles when we tap on the item in</span><a id="_idTextAnchor372"/> <span class="No-Break"><span class="koboSpan" id="kobo.1510.1">the l</span><a id="_idTextAnchor373"/><span class="koboSpan" id="kobo.1511.1">ist.</span></span></p>
<h2 id="_idParaDest-98"><a id="_idTextAnchor374"/><span class="koboSpan" id="kobo.1512.1">Handling navigation</span></h2>
<p><span class="koboSpan" id="kobo.1513.1">We are on the home stretch now for this app. </span><span class="koboSpan" id="kobo.1513.2">The only thing we need to do is implement navigation to </span><a id="_idIndexMarker554"/><span class="koboSpan" id="kobo.1514.1">the article view, which will display the entire article in a web view. </span><span class="koboSpan" id="kobo.1514.2">Since we are using Shell, we will be navigating using routes. </span><span class="koboSpan" id="kobo.1514.3">Routes can be registered directly in the Shell markup – for example, in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1515.1">AppShell.xaml</span></strong><span class="koboSpan" id="kobo.1516.1"> file. </span><span class="koboSpan" id="kobo.1516.2">We can do this by using </span><strong class="source-inline"><span class="koboSpan" id="kobo.1517.1">Route</span></strong><span class="koboSpan" id="kobo.1518.1"> attributes on the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1519.1">ShellContent</span></strong><span class="koboSpan" id="kobo.1520.1"> elements, as we did in the </span><span class="No-Break"><span class="koboSpan" id="kobo.1521.1">previous section.</span></span></p>
<p><span class="koboSpan" id="kobo.1522.1">In the following code, we will add a route programmatically and register a view to handle it for us. </span><span class="koboSpan" id="kobo.1522.2">We will also create a navigation service to abstract the concept of navigation </span><span class="No-Break"><span class="koboSpan" id="kobo.1523.1">a</span><a id="_idTextAnchor375"/><span class="koboSpan" id="kobo.1524.1"> bit.</span></span></p>
<p><span class="koboSpan" id="kobo.1525.1">So, buckle up, and let’s finish </span><span class="No-Break"><span class="koboSpan" id="kobo.1526.1">this</span><a id="_idTextAnchor376"/><span class="koboSpan" id="kobo.1527.1"> app!</span></span></p>
<h3><span class="koboSpan" id="kobo.1528.1">Creating the navigation service</span></h3>
<p><span class="koboSpan" id="kobo.1529.1">The first step is to define an interface that will wrap .NET MAUI navigation. </span><span class="koboSpan" id="kobo.1529.2">Why do we do this? </span><span class="koboSpan" id="kobo.1529.3">Well, it’s a good practice</span><a id="_idIndexMarker555"/><span class="koboSpan" id="kobo.1530.1"> to separate the interfaces from the implementati</span><a id="_idTextAnchor377"/><span class="koboSpan" id="kobo.1531.1">on; it makes unit testing easier, and </span><a id="_idTextAnchor378"/><span class="No-Break"><span class="koboSpan" id="kobo.1532.1">so on.</span></span></p>
<h4><span class="koboSpan" id="kobo.1533.1">Creating the INavigation interface</span></h4>
<p><span class="koboSpan" id="kobo.1534.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.1535.1">INavigation</span></strong><span class="koboSpan" id="kobo.1536.1"> interface is simple, and we will </span><a id="_idIndexMarker556"/><span class="koboSpan" id="kobo.1537.1">overshoot the target a little bit. </span><span class="koboSpan" id="kobo.1537.2">We are only interested in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1538.1">NavigateTo</span></strong><span class="koboSpan" id="kobo.1539.1"> method, but we will add the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1540.1">PushModal()</span></strong><span class="koboSpan" id="kobo.1541.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.1542.1">PopModal()</span></strong><span class="koboSpan" id="kobo.1543.1"> methods since it is likely that you will use them if you continue extending </span><span class="No-Break"><span class="koboSpan" id="kobo.1544.1">the app.</span></span></p>
<p><span class="koboSpan" id="kobo.1545.1">Adding the navigation interface is simple, as the following </span><span class="No-Break"><span class="koboSpan" id="kobo.1546.1">steps illustrate:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.1547.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1548.1">News</span></strong><span class="koboSpan" id="kobo.1549.1"> project, expand the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1550.1">ViewModels</span></strong><span class="koboSpan" id="kobo.1551.1"> folder and add a new file </span><span class="No-Break"><span class="koboSpan" id="kobo.1552.1">called </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1553.1">INavigate.cs</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1554.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.1555.1">Add the following code to </span><span class="No-Break"><span class="koboSpan" id="kobo.1556.1">the file:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.1557.1">
namespace News.ViewModels;
public interface INavigate
{
    Task NavigateTo(string route);
    Task PushModal(Page page);
    Task PopModal();
}</span></pre></li> </ol>
<p><span class="koboSpan" id="kobo.1558.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.1559.1">NavigateTo()</span></strong><span class="koboSpan" id="kobo.1560.1"> method declaration takes the route we want to navigate to. </span><span class="koboSpan" id="kobo.1560.2">This is the method that we will be calling. </span><span class="koboSpan" id="kobo.1560.3">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.1561.1">PushModal()</span></strong><span class="koboSpan" id="kobo.1562.1"> method adds a new page on top of the navigation stack as a modal page, forcing the user only to interact with this specific page. </span><span class="koboSpan" id="kobo.1562.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.1563.1">PopModal()</span></strong><span class="koboSpan" id="kobo.1564.1"> method </span><a id="_idIndexMarker557"/><span class="koboSpan" id="kobo.1565.1">removes it from the navigation stack. </span><span class="koboSpan" id="kobo.1565.2">So, if you use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1566.1">PushModal()</span></strong><span class="koboSpan" id="kobo.1567.1"> method, make sure that you give the user a way to pop it off </span><span class="No-Break"><span class="koboSpan" id="kobo.1568.1">the stack.</span></span></p>
<p><span class="koboSpan" id="kobo.1569.1">Otherwise, you will be stuck viewing the modal </span><span class="No-Break"><span class="koboSpan" id="kobo.1570.1">page </span><a id="_idTextAnchor379"/><span class="koboSpan" id="kobo.1571.1">forever.</span></span></p>
<p><span class="koboSpan" id="kobo.1572.1">That’s all for the interface. </span><span class="koboSpan" id="kobo.1572.2">Let’s create an implementation using .NET </span><span class="No-Break"><span class="koboSpan" id="kobo.1573.1">MAU</span><a id="_idTextAnchor380"/><span class="koboSpan" id="kobo.1574.1">I Shell.</span></span></p>
<h4><span class="koboSpan" id="kobo.1575.1">Implementing the INavigate interface using .NET MAUI Shell</span></h4>
<p><span class="koboSpan" id="kobo.1576.1">The implementation is very straightforward </span><a id="_idIndexMarker558"/><span class="koboSpan" id="kobo.1577.1">since each method is only calling .NET MAUI static methods provided by the </span><span class="No-Break"><span class="koboSpan" id="kobo.1578.1">Shell API.</span></span></p>
<p><span class="koboSpan" id="kobo.1579.1">Create the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1580.1">Navigator</span></strong><span class="koboSpan" id="kobo.1581.1"> class, as shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.1582.1">following steps:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.1583.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1584.1">News</span></strong><span class="koboSpan" id="kobo.1585.1"> project, add a new class </span><span class="No-Break"><span class="koboSpan" id="kobo.1586.1">called </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1587.1">Navigator</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1588.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.1589.1">Add the following code to </span><span class="No-Break"><span class="koboSpan" id="kobo.1590.1">the class:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.1591.1">
namespace News;
using News.ViewModels;
public class Navigator : INavigate
{
    public async Task NavigateTo(string route) =&gt; await Shell.Current.GoToAsync(route);
    public async Task PushModal(Page page) =&gt; await Shell.Current.Navigation.PushModalAsync(page);
    public async Task PopModal() =&gt; await Shell.Current.Navigation.PopModal</span><a id="_idTextAnchor381"/><span class="koboSpan" id="kobo.1592.1">A</span><a id="_idTextAnchor382"/><span class="koboSpan" id="kobo.1593.1">sync();
}</span></pre></li> </ol>
<p><span class="koboSpan" id="kobo.1594.1">This is simply pass-through code that calls already existing methods. </span><span class="koboSpan" id="kobo.1594.2">Now, we need to register the type with our</span><a id="_idIndexMarker559"/><span class="koboSpan" id="kobo.1595.1"> dependency injection container so that it can be consumed by the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1596.1">ViewMo</span><a id="_idTextAnchor383"/><span class="koboSpan" id="kobo.1597.1">del</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1598.1"> class.</span></span></p>
<h4><span class="koboSpan" id="kobo.1599.1">Registering the Navigator class with dependency injection</span></h4>
<p><span class="koboSpan" id="kobo.1600.1">For the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1601.1">ViewModel</span></strong><span class="koboSpan" id="kobo.1602.1"> class and its descendants to have access to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1603.1">Navigator</span></strong><span class="koboSpan" id="kobo.1604.1"> instance, we will have to register it with the</span><a id="_idIndexMarker560"/><span class="koboSpan" id="kobo.1605.1"> container, just like we did with </span><strong class="source-inline"><span class="koboSpan" id="kobo.1606.1">NewService</span></strong><span class="koboSpan" id="kobo.1607.1">; just follow </span><span class="No-Break"><span class="koboSpan" id="kobo.1608.1">these steps:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.1609.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1610.1">News</span></strong><span class="koboSpan" id="kobo.1611.1"> project, open the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1612.1">MauiProgram.cs</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1613.1"> file.</span></span></li>
<li><span class="koboSpan" id="kobo.1614.1">Find the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1615.1">RegisterAppTypes</span></strong><span class="koboSpan" id="kobo.1616.1"> method and add the following </span><span class="No-Break"><span class="koboSpan" id="kobo.1617.1">highlighted code:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.1618.1">
public static MauiAppBuilder RegisterAppTypes(this MauiAppBuilder mauiAppBuilder)
{
    // Services
    mauiAppBuilder.Services.AddSingleton&lt;Services.INewsService&gt;((serviceProvider) =&gt; new Services.NewsService());
</span><strong class="bold"><span class="koboSpan" id="kobo.1619.1">    mauiAppBuilder.Services.AddSingleton&lt;ViewModels.INavigate&gt;((serviceProvider) =&gt; new Navigator());</span></strong><span class="koboSpan" id="kobo.1620.1">
    // ViewModels
…
}</span></pre></li> </ol>
<p><span class="koboSpan" id="kobo.1621.1">Now, we can add the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1622.1">INavigate</span></strong><span class="koboSpan" id="kobo.1623.1"> interface </span><a id="_idIndexMarker561"/><span class="koboSpan" id="kobo.1624.1">to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1625.1">ViewModel</span></strong><span class="koboSpan" id="kobo.1626.1"> class and </span><span class="No-Break"><span class="koboSpan" id="kobo.1627.1">its descendants.</span></span></p>
<h4><span class="koboSpan" id="kobo.1628.1">Adding the INavigate interface to the ViewModel class</span></h4>
<p><span class="koboSpan" id="kobo.1629.1">To be able to access </span><strong class="source-inline"><span class="koboSpan" id="kobo.1630.1">Navigator</span></strong><span class="koboSpan" id="kobo.1631.1">, we</span><a id="_idIndexMarker562"/><span class="koboSpan" id="kobo.1632.1"> must extend the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1633.1">ViewModel</span></strong><span class="koboSpan" id="kobo.1634.1"> base class, making it available to all </span><strong class="source-inline"><span class="koboSpan" id="kobo.1635.1">ViewModels</span></strong><span class="koboSpan" id="kobo.1636.1">. </span><span class="koboSpan" id="kobo.1636.2">Proceed </span><span class="No-Break"><span class="koboSpan" id="kobo.1637.1">as follows:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.1638.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1639.1">News</span></strong><span class="koboSpan" id="kobo.1640.1"> project, open the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1641.1">ViewModels</span></strong><span class="koboSpan" id="kobo.1642.1"> folder, and then open the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1643.1">ViewModel.cs</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1644.1"> file.</span></span></li>
<li><span class="koboSpan" id="kobo.1645.1">Add the following highlighted code to </span><span class="No-Break"><span class="koboSpan" id="kobo.1646.1">the class:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.1647.1">
public abstract class ViewModel
{
    </span><strong class="bold"><span class="koboSpan" id="kobo.1648.1">public INavigate Navigation { get; init; }</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1649.1">    internal ViewModel(INavigate navigation) =&gt; Navigation = navigation;</span></strong><span class="koboSpan" id="kobo.1650.1">
}</span></pre></li> <li><span class="koboSpan" id="kobo.1651.1">Open the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1652.1">HeadlinesViewModel.cs</span></strong><span class="koboSpan" id="kobo.1653.1"> file and make the highlighted changes to </span><span class="No-Break"><span class="koboSpan" id="kobo.1654.1">the constructor:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.1655.1">
public HeadlinesViewModel(INewsService newsService</span><strong class="bold"><span class="koboSpan" id="kobo.1656.1">, INavigate navigation) : base (navigation)</span></strong></pre></li> </ol>
<p><span class="koboSpan" id="kobo.1657.1">The base </span><strong class="source-inline"><span class="koboSpan" id="kobo.1658.1">ViewModel</span></strong><span class="koboSpan" id="kobo.1659.1"> now exposes the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1660.1">Navigator</span></strong><span class="koboSpan" id="kobo.1661.1"> property through the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1662.1">INavigate</span></strong><span class="koboSpan" id="kobo.1663.1"> interface. </span><span class="koboSpan" id="kobo.1663.2">At this </span><a id="_idIndexMarker563"/><span class="koboSpan" id="kobo.1664.1">point, we are ready to wire up the navigation to our</span><a id="_idTextAnchor384"/><a id="_idTextAnchor385"/> <span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1665.1">Article</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1666.1"> view.</span></span></p>
<h3><span class="koboSpan" id="kobo.1667.1">Navigating using routes</span></h3>
<p><span class="koboSpan" id="kobo.1668.1">Routes are a very handy way to navigate since they abstract the creation of the page away. </span><span class="koboSpan" id="kobo.1668.2">All we need to know is the route to the view we want to navigate to – .NET MAUI Shell takes care of the rest for us. </span><span class="koboSpan" id="kobo.1668.3">If you are familiar with how web navigation works, you might recognize the </span><a id="_idIndexMarker564"/><span class="koboSpan" id="kobo.1669.1">way that we pass arguments in routes. </span><span class="koboSpan" id="kobo.1669.2">They are passed as </span><span class="No-Break"><span class="koboSpan" id="kobo.1670.1">qu</span><a id="_idTextAnchor386"/><a id="_idTextAnchor387"/><a id="_idTextAnchor388"/><span class="koboSpan" id="kobo.1671.1">ery parameters.</span></span></p>
<h4><span class="koboSpan" id="kobo.1672.1">Finalizing the ItemSelected command</span></h4>
<p><span class="koboSpan" id="kobo.1673.1">Previously, we </span><a id="_idIndexMarker565"/><span class="koboSpan" id="kobo.1674.1">defined the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1675.1">ItemSelected</span></strong><span class="koboSpan" id="kobo.1676.1"> method in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1677.1">HeadlinesViewModel</span></strong><span class="koboSpan" id="kobo.1678.1"> class. </span><span class="koboSpan" id="kobo.1678.2">Now, it’s time to add code that will perform the navigation </span><span class="No-Break"><span class="koboSpan" id="kobo.1679.1">to </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1680.1">ArticleView</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1681.1">:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.1682.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1683.1">News</span></strong><span class="koboSpan" id="kobo.1684.1"> project, expand the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1685.1">ViewModels</span></strong><span class="koboSpan" id="kobo.1686.1"> folder and </span><span class="No-Break"><span class="koboSpan" id="kobo.1687.1">open </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1688.1">HeadlinesViewModel.cs</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1689.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.1690.1">Locate the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1691.1">ItemSelected</span></strong><span class="koboSpan" id="kobo.1692.1"> method and add the following line marked </span><span class="No-Break"><span class="koboSpan" id="kobo.1693.1">in bold:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.1694.1">
[RelayCommand]
public </span><strong class="bold"><span class="koboSpan" id="kobo.1695.1">async Task</span></strong><span class="koboSpan" id="kobo.1696.1"> ItemSelected(object selectedItem)
{
    var selectedArticle = selectedItem as Article;
    var url = HttpUtility.UrlEncode(selectedArticle.Url);
    </span><strong class="bold"><span class="koboSpan" id="kobo.1697.1">await Navigation.NavigateTo($"articleview?url={url}");</span></strong><span class="koboSpan" id="kobo.1698.1">
}</span></pre></li> </ol>
<p><span class="koboSpan" id="kobo.1699.1">Here, we define a route called </span><strong class="source-inline"><span class="koboSpan" id="kobo.1700.1">articleview</span></strong><span class="koboSpan" id="kobo.1701.1"> that takes a query-line parameter called </span><strong class="source-inline"><span class="koboSpan" id="kobo.1702.1">url</span></strong><span class="koboSpan" id="kobo.1703.1"> that points to the URL of the article itself. </span><span class="koboSpan" id="kobo.1703.2">It will look something like this: </span><strong class="source-inline"><span class="koboSpan" id="kobo.1704.1">articleview?url=www.mypage.com</span></strong><span class="koboSpan" id="kobo.1705.1">. </span><span class="koboSpan" id="kobo.1705.2">Only the data passed after the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1706.1">url=</span></strong><span class="koboSpan" id="kobo.1707.1"> argument must be </span><strong class="bold"><span class="koboSpan" id="kobo.1708.1">URL encoded</span></strong><span class="koboSpan" id="kobo.1709.1">, meaning that we need to encode it to replace characters that would interfere with the route itself. </span><span class="koboSpan" id="kobo.1709.2">The URL encoding is done through the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1710.1">HttpUtility.UrlEncode()</span></strong><span class="koboSpan" id="kobo.1711.1"> method, which is defined in </span><strong class="source-inline"><span class="koboSpan" id="kobo.1712.1">System.Web</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.1713.1">for us.</span></span></p>
<p><span class="koboSpan" id="kobo.1714.1">The preceding </span><strong class="source-inline"><span class="koboSpan" id="kobo.1715.1">NavigateTo()</span></strong><span class="koboSpan" id="kobo.1716.1"> method call uses this encoded data in the query parameter. </span><span class="koboSpan" id="kobo.1716.2">On the recipient side of the </span><a id="_idIndexMarker566"/><span class="koboSpan" id="kobo.1717.1">navigation call, we need to handle the incomi</span><a id="_idTextAnchor389"/><a id="_idTextAnchor390"/><span class="koboSpan" id="kobo.1718.1">ng </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1719.1">url</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1720.1"> parameter.</span></span></p>
<h4><span class="koboSpan" id="kobo.1721.1">Extending ArticleView so that it receives query data</span></h4>
<p><strong class="source-inline"><span class="koboSpan" id="kobo.1722.1">ArticleView</span></strong><span class="koboSpan" id="kobo.1723.1"> is responsible </span><a id="_idIndexMarker567"/><span class="koboSpan" id="kobo.1724.1">for rendering the article for us. </span><span class="koboSpan" id="kobo.1724.2">To keep things simple (and also illustrate that you don’t always need </span><strong class="source-inline"><span class="koboSpan" id="kobo.1725.1">ViewModel</span></strong><span class="koboSpan" id="kobo.1726.1">), we will not define </span><strong class="source-inline"><span class="koboSpan" id="kobo.1727.1">ViewModel</span></strong><span class="koboSpan" id="kobo.1728.1"> for this class; instead, we will define </span><strong class="source-inline"><span class="koboSpan" id="kobo.1729.1">BindingContext</span></strong><span class="koboSpan" id="kobo.1730.1"> as an instance of the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1731.1">UrlWe</span><a id="_idTextAnchor391"/><span class="koboSpan" id="kobo.1732.1">bViewSource</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1733.1"> class.</span></span></p>
<p><span class="koboSpan" id="kobo.1734.1">Add the following code to the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1735.1">ArticleView.xaml.cs</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1736.1"> file:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.1737.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1738.1">News</span></strong><span class="koboSpan" id="kobo.1739.1"> project, expand the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1740.1">Views</span></strong><span class="koboSpan" id="kobo.1741.1"> folder and open the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1742.1">ArticleView.xaml.cs</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1743.1"> file.</span></span></li>
<li><span class="koboSpan" id="kobo.1744.1">Add the following code marked in bold to </span><span class="No-Break"><span class="koboSpan" id="kobo.1745.1">the file:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.1746.1">
namespace News.Views;
</span><strong class="bold"><span class="koboSpan" id="kobo.1747.1">using System.Web;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1748.1">[QueryProperty("Url", "url")]</span></strong><span class="koboSpan" id="kobo.1749.1">
public partial class ArticleView : ContentPage
{
</span><strong class="bold"><span class="koboSpan" id="kobo.1750.1">    public string Url</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1751.1">    {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1752.1">        set</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1753.1">        {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1754.1">            BindingContext = new UrlWebViewSource</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1755.1">            {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1756.1">                Url = HttpUtility.UrlDecode(value)</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1757.1">            };</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1758.1">        }</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1759.1">    }</span></strong><span class="koboSpan" id="kobo.1760.1">
    public ArticleView()
    {
        InitializeComponent();
    }
}</span></pre></li> </ol>
<p><strong class="source-inline"><span class="koboSpan" id="kobo.1761.1">ArticleView</span></strong><span class="koboSpan" id="kobo.1762.1"> is dependent on a URL being set, and we do so by defining a set-only property called </span><strong class="source-inline"><span class="koboSpan" id="kobo.1763.1">Url</span></strong><span class="koboSpan" id="kobo.1764.1">. </span><span class="koboSpan" id="kobo.1764.2">When this property is set, it creates a new instance of </span><strong class="source-inline"><span class="koboSpan" id="kobo.1765.1">UrlWebViewSource</span></strong><span class="koboSpan" id="kobo.1766.1"> with the </span><a id="_idIndexMarker568"/><span class="koboSpan" id="kobo.1767.1">value of the property and assigns it to the page’s </span><strong class="source-inline"><span class="koboSpan" id="kobo.1768.1">BindingContext</span></strong><span class="koboSpan" id="kobo.1769.1">. </span><span class="koboSpan" id="kobo.1769.2">This setter is called by the Shell framework since we added an attribute called </span><strong class="source-inline"><span class="koboSpan" id="kobo.1770.1">QueryProperty</span></strong><span class="koboSpan" id="kobo.1771.1"> to the class itself. </span><span class="koboSpan" id="kobo.1771.2">It takes two arguments – the first is which property to set, while the second is the name of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1772.1">url</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.1773.1">query parameter.</span></span></p>
<p><span class="koboSpan" id="kobo.1774.1">Since the data comes URL encoded, we need to decode it using the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1775.1">HttpUtility.UrlDecode()</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1776.1"> method.</span></span></p>
<p><span class="koboSpan" id="kobo.1777.1">With that, we have a binding context that points to the web page we want to display. </span><span class="koboSpan" id="kobo.1777.2">Now, we just need to</span><a id="_idIndexMarker569"/><span class="koboSpan" id="kobo.1778.1"> define </span><a id="_idTextAnchor392"/><a id="_idTextAnchor393"/><a id="_idTextAnchor394"/><strong class="source-inline"><span class="koboSpan" id="kobo.1779.1">WebView</span></strong><span class="koboSpan" id="kobo.1780.1"> in </span><span class="No-Break"><span class="koboSpan" id="kobo.1781.1">the XAML.</span></span></p>
<h4><span class="koboSpan" id="kobo.1782.1">Extending ArticleView with WebView</span></h4>
<p><span class="koboSpan" id="kobo.1783.1">This page only has one purpose, and that is to </span><a id="_idIndexMarker570"/><span class="koboSpan" id="kobo.1784.1">display the web page from the URL that we passed to it. </span><span class="koboSpan" id="kobo.1784.2">Let’s add a </span><strong class="source-inline"><span class="koboSpan" id="kobo.1785.1">WebView</span></strong><span class="koboSpan" id="kobo.1786.1"> control to the page, </span><span class="No-Break"><span class="koboSpan" id="kobo.1787.1">as follows:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.1788.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1789.1">News</span></strong><span class="koboSpan" id="kobo.1790.1"> project, expand the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1791.1">Views</span></strong><span class="koboSpan" id="kobo.1792.1"> folder and </span><span class="No-Break"><span class="koboSpan" id="kobo.1793.1">open </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1794.1">ArticleView.xaml</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1795.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.1796.1">Add the following </span><span class="No-Break"><span class="koboSpan" id="kobo.1797.1">highlighted XAML:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.1798.1">
&lt;?xml version="1.0" encoding="utf-8" ?&gt;
&lt;ContentPage 
             
    x:Class="News.Views.ArticleView"
    Title="ArticleView"&gt;
    </span><strong class="bold"><span class="koboSpan" id="kobo.1799.1">&lt;WebView Source="{Binding .}" /&gt;</span></strong><span class="koboSpan" id="kobo.1800.1">
&lt;/ContentPage&gt;</span></pre></li> </ol>
<p><span class="koboSpan" id="kobo.1801.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.1802.1">WebView</span></strong><span class="koboSpan" id="kobo.1803.1"> control will take up all available space in the view. </span><span class="koboSpan" id="kobo.1803.2">The source will be set to </span><strong class="source-inline"><span class="koboSpan" id="kobo.1804.1">.</span></strong><span class="koboSpan" id="kobo.1805.1">, meaning that it will be the same as the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1806.1">BindingContext</span></strong><span class="koboSpan" id="kobo.1807.1"> property of </span><strong class="source-inline"><span class="koboSpan" id="kobo.1808.1">ViewModel</span></strong><span class="koboSpan" id="kobo.1809.1">. </span><span class="koboSpan" id="kobo.1809.2">In this case, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1810.1">BindingContext</span></strong><span class="koboSpan" id="kobo.1811.1"> property is a </span><strong class="source-inline"><span class="koboSpan" id="kobo.1812.1">UrlWebViewSource</span></strong><span class="koboSpan" id="kobo.1813.1"> instance, which is exactly what </span><strong class="source-inline"><span class="koboSpan" id="kobo.1814.1">WebView</span></strong><span class="koboSpan" id="kobo.1815.1"> needs to navigate and display </span><span class="No-Break"><span class="koboSpan" id="kobo.1816.1">the content.</span></span></p>
<p><span class="koboSpan" id="kobo.1817.1">We’ve only got one step left – our app needs to know about the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1818.1">ArticleView</span></strong><span class="koboSpan" id="kobo.1819.1"> route an</span><a id="_idTextAnchor395"/><a id="_idTextAnchor396"/><span class="koboSpan" id="kobo.1820.1">d what to do </span><span class="No-Break"><span class="koboSpan" id="kobo.1821.1">with it.</span></span></p>
<h4><span class="koboSpan" id="kobo.1822.1">Registering the route</span></h4>
<p><span class="koboSpan" id="kobo.1823.1">As mentioned previously, routes </span><a id="_idIndexMarker571"/><span class="koboSpan" id="kobo.1824.1">can be added declaratively in the XAML (</span><strong class="source-inline"><span class="koboSpan" id="kobo.1825.1">Route="MyDucks"</span></strong><span class="koboSpan" id="kobo.1826.1">) or code, as </span><span class="No-Break"><span class="koboSpan" id="kobo.1827.1">shown here:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.1828.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1829.1">News</span></strong><span class="koboSpan" id="kobo.1830.1"> project, open the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1831.1">AppShell.xaml.cs</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1832.1"> file.</span></span></li>
<li><span class="koboSpan" id="kobo.1833.1">Add the following lines of code marked </span><span class="No-Break"><span class="koboSpan" id="kobo.1834.1">in bold:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.1835.1">
namespace News;
public partial class AppShell : Shell
{
    public AppShell()
    {
        InitializeComponent();
        Routing.RegisterRoute("articleview", typeof(Views.ArticleView));
    }
}</span></pre></li> </ol>
<p><span class="koboSpan" id="kobo.1836.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.1837.1">RegisterRoute()</span></strong><span class="koboSpan" id="kobo.1838.1"> method takes two arguments – the first is the route we want to use, and it’s the one that we specify in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1839.1">NavigateTo()</span></strong><span class="koboSpan" id="kobo.1840.1"> calls. </span><span class="koboSpan" id="kobo.1840.2">The second is the type of page (view) that we want to create – in our case, we want to </span><span class="No-Break"><span class="koboSpan" id="kobo.1841.1">create </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1842.1">ArticleView</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1843.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.1844.1">Cool! </span><span class="koboSpan" id="kobo.1844.2">That wraps it up. </span><span class="koboSpan" id="kobo.1844.3">The app should now run, and you should be able to navigate to the article from any of your </span><strong class="source-inline"><span class="koboSpan" id="kobo.1845.1">Colle</span><a id="_idTextAnchor397"/><span class="koboSpan" id="kobo.1846.1">ctionViews</span></strong><span class="koboSpan" id="kobo.1847.1">. </span><span class="No-Break"><span class="koboSpan" id="kobo.1848.1">Good work!</span></span></p>
<h1 id="_idParaDest-99"><a id="_idTextAnchor398"/><span class="koboSpan" id="kobo.1849.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.1850.1">In this chapter, we learned how to define a navigation structure using .NET MAUI Shell, how to navigate to views using routes, and how to pass arguments between views in the form of a query string. </span><span class="koboSpan" id="kobo.1850.2">There is a lot more to Shell, but this should get you started and confident enough to start exploring the Shell APIs. </span><span class="koboSpan" id="kobo.1850.3">Also, keep in mind that the Shell APIs are constantly evolving, so make sure you check out the latest </span><span class="No-Break"><span class="koboSpan" id="kobo.1851.1">features available.</span></span></p>
<p><span class="koboSpan" id="kobo.1852.1">We also learned how to create an API client for an arbitrary REST API, which always comes in handy since most of the apps you will write need to communicate with a server at some point. </span><span class="koboSpan" id="kobo.1852.2">There is a very good chance that the server will expose its data and functionality through a </span><span class="No-Break"><span class="koboSpan" id="kobo.1853.1">REST API.</span></span></p>
<p><span class="koboSpan" id="kobo.1854.1">If you are interested in extending the app even further, try designing your own </span><strong class="bold"><span class="koboSpan" id="kobo.1855.1">About</span></strong><span class="koboSpan" id="kobo.1856.1"> page, or allow the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1857.1">News</span></strong><span class="koboSpan" id="kobo.1858.1"> API key to be set through </span><span class="No-Break"><span class="koboSpan" id="kobo.1859.1">the settings.</span></span></p>
<p><span class="koboSpan" id="kobo.1860.1">The next project will be about creating a match-making app, and how to create a swiping-enabled yes/no image selector app using nothing but .NET MAUI to render and animate cross-platform </span><span class="No-Break"><span class="koboSpan" id="kobo.1861.1">UI controls.</span></span></p>
</div>
</body></html>