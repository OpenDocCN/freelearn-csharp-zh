# *第一章*：文本、流程、选择和编织

本章通过考察分支叙事以及ink如何支持创建它们，介绍了非线性叙事的核心概念。在这些概念的基础上，本章还回顾了使用线条、它们内部的文本，以及如何将它们结合起来的方法。

在ink中创建非线性、交互式叙事的核心元素中，选择被解释，以及如何最佳地使用它们。在需要大型分支结构的情况下，以及如何使用聚集点将这些编织简化为更简单的部分，讨论了选择的编织和集合。

本章将涵盖以下主要内容：

+   将分支叙事视为流程

+   创建选择和编织

+   消失和粘性选择

# 技术要求

本章中使用的示例，在`*.ink`文件中，可以在GitHub上找到：[https://github.com/PacktPublishing/Dynamic-Story-Scripting-with-the-ink-Scripting-Language/tree/main/Chapter1](https://github.com/PacktPublishing/Dynamic-Story-Scripting-with-the-ink-Scripting-Language/tree/main/Chapter1)。

# 将分支叙事视为流程

当读者手持一本实体书时，他们通过翻页来阅读故事。页与页之间的移动也是一种在故事中的移动。读者所体验到的被称为**叙事**。故事是将其内容打包成不同部分的过程，这些部分被称为**页面**。然而，读者的叙事是他们在这些页面间体验故事的过程。

在数字环境中，没有物理页面。故事中的文字可以存储为简单的文本文件的一部分，或者捆绑在更复杂的东西中。数字故事的各个部分，即实体书中的页面，也可以更容易地排列，读者可能会以不同的配置体验它们，从而从相同的故事内容中创造出新的叙事。

考虑以下示例，其中每个句子都是故事的一部分：

[PRE0]

如果从第一句到最后一句话按顺序阅读，有一个故事，其中主要部分是太阳照耀、云朵到来，但随后云朵离开，太阳再次照耀。然而，如果重新排列这些部分会发生什么呢？

示例 1：

[PRE1]

通过不同的顺序，为读者创造一个新的叙事。在这个版本中，故事的发展从太阳升起和照耀开始。接下来，云朵移动进来，开始下雨。在任何情况下，只使用了三个事件，但它们的顺序影响了读者的叙事体验。

## 非线性叙事

在第二个例子中，故事仍然是有意义的。然而，这次事件从云彩开始，过渡到阳光照耀，并以云彩返回结束。第二个例子在事件之间的移动，是**非线性叙事**的一个例子，其中事件或故事的部分以新的或不同的方式体验，不同于创作或最初编写的方式。这种进展不是从故事的一个部分到另一个部分的线性，但仍然创建了一个连贯的叙事：

![Figure 1.1 – Mapping nonlinear storytelling](img/Figure_1.1_B17597.jpg)

![Figure 1.1 – Mapping nonlinear storytelling](img/Figure_1.1_B17597.jpg)

图1.1 – 非线性叙事映射

通过导航非线性故事创建的结构通常被比作*树*。它们从树干开始，然后，随着遇到不同的部分，就会形成一个*分支模式*，每个**分支**代表从故事的一端到另一端的部分移动。非线性故事的叙事遍历创建了一个*分支叙事*，其中不同的部分被或未被遇到。体验到的叙事地图代表了故事整体树及其部分的特定分支。

虽然非线性叙事可以用印刷书籍来完成，但通常要困难得多。在数字环境中，事件可以被分成不同的部分，重新排列它们通常就像选择它们并将它们拖到同一文档的不同部分一样简单。将故事表示为数据所带来的这种后果使得编写处理不同部分排列的代码也变得更容易。这被称为*叙事脚本*。

## 介绍墨水

**墨水**是一种*叙事脚本语言*。它决定了读者接下来应该阅读故事中的哪一部分。当用户点击或按下按钮时，墨水编写的代码会在不同的分支之间做出决定，并确定他们何时应该访问。根据作者编写的规则，代码甚至可以重复相同的故事部分，并使用新的值。

因为墨水是为编写叙事而设计的，所以它将故事中的导航理解为一个特殊的概念，称为**流**。当读者通过不同的部分移动时，他们正在创造自己的体验叙事，墨水称之为流。实际上，作者遇到的最常见的错误之一是故事的流*耗尽*。即使是在编写具有不同分支的非线性故事时，故事也必须有一个开始和结束。即使每次用户遍历故事的部分时，叙事的开始和结束之间的所有部分都会改变，这两个点仍然定义了可能分支的范围。

## 文本向下流动

流的概念也扩展到在墨水中如何理解代码。在墨水中，跨越故事的任何移动都是从代码的顶部*向下*到底部，除非告诉它导航到故事中的不同部分。

本章前面分享的示例故事也是代码示例。ink旨在创建分支叙事，并提供了编写代码来创建这些结构的能力。这意味着在ink中，故事中不包含任何其他特殊字符或语法的文本或单词都是有效的。

ink中行内的间距很重要。因为文本被视为一种代码形式，ink假设任何使用间距都是作者有意为之的选择。例如，在单词之间添加额外的空格不会被其输出移除：

[PRE2]

输出：

[PRE3]

ink会忽略任何空行。它假设文本的每一行都是重要的，并且它们之间的任何间距都应该被视为对故事本身不重要的事物而被忽略。

示例 2：

[PRE4]

输出：

[PRE5]

## 最小的单位是行

在引入非线性叙事时，将三行作为故事的一部分并不是一个错误。ink故事中最小的单位是一行：

[PRE6]

因为ink认为文本是代码的一部分，所以只有四个单词的单行是完全有效的故事。添加更多行也会扩展将展示给读者的内容，但单行本身也可以是一个故事：

[PRE7]

在ink中，术语*行*的使用很重要。在阅读物理书籍时，故事中最小的单位通常是句子。这通常是更大作品中最小的完整思想。在数字环境中，特别是在ink中，行是最小的单位。当ink加载故事时，它逐行通过故事。它将每一行视为与最后一行同等重要。

随着更复杂代码的引入，行的概念也会变得更加重要。然而，就像单行示例一样，一个故事不需要复杂才能变得重要。对ink来说，一个故事由行组成。这可以是一行，也可能是多行。

## 粘合行

作者可能需要使用多行文本作为一行“代码”。在这些情况下，ink提供了一个名为`<>`的概念，当它们一起使用时，它们会将一行内容粘接到下一行，创建一个长行：

示例 3：

[PRE8]

输出：

[PRE9]

使用粘合剂时的间距很重要。就像单行内的间距一样，ink尊重作者在单行中呈现文本时的选择。当使用粘合剂时，这些间距也被尊重。

如果每个单词后面没有空格，那么在前面示例中使用的粘合剂会将所有单词粘合在一起：

[PRE10]

输出：

[PRE11]

## 使用注释作为对作者的笔记

作为一种脚本语言，ink还提供了在故事代码中包含注释的能力。借鉴更通用的编程术语，ink将这些注释称为**注释**。它们以两个斜杠开始，然后包含注释的内容。行中的任何部分也被视为注释的一部分：

示例 4：

[PRE12]

当运行时，故事的文本会被视为其代码。然而，任何注释的使用都不会出现在故事的输出中。注释仅设计给人类观众，允许作者向其他观众解释代码，或者更普遍地，作为作者或其团队其他成员关于如何工作的笔记。

### 使用Inky

为了帮助作者更快地在墨水中开发故事，**Inkle Studios**创建了一个名为**Inky**的程序。这个编辑工具允许作者编写代码，并预览其输出：

![图1.2 – Inky编辑器的截图

](img/Figure_1.2_B17597.jpg)

图1.2 – Inky编辑器的截图

虽然最初由Inkle Studios开发，但Inky现在是一个开源项目，社区经常会有数十个提交来修复小问题或添加新功能。通常每年会推出一个新的小版本。

在撰写本文时，Inky没有Windows安装程序，但为macOS X和Linux系统提供构建。在Windows或Linux上运行时，需要将ZIP文件解压缩到现有文件夹中，并运行`Inky.exe`（Windows）或`Inky`（Linux）文件以打开编辑器。

### 使用Inky

Inky提供了一个具有两个窗格的界面：

+   左边是编写墨水代码的地方。

+   右边显示了代码开发时的预览。

这使用户能够快速看到他们的代码将如何根据所使用的代码产生不同的输出。

Inky最有用的功能是能够“回退”故事到一个较早的点并尝试不同的叙事分支。这允许作者更快地测试故事的不同分支，而不需要每次都重新启动故事。

![图1.3 – “回退单个选择”和“重新启动故事”按钮

](img/Figure_1.3_B17597.jpg)

图1.3 – “回退单个选择”和“重新启动故事”按钮

重要提示

本书将使用Inky的截图来展示不同代码产生的结果输出。

# 创建选择和编织

当代码选择故事的一部分来为用户生成一个新的可能叙事时，这可能会很有趣，但大多数用户希望对接下来发生的事情有所输入。他们想要一个互动式的故事。在墨水（ink）中，交互性是通过向用户展示选择来实现的。根据读者做出的选择，叙事可以以不同的方式分支。

## 制作编织

墨水中的选择是另一个重要概念——**编织（weaves）**的一部分。当用户从一个部分创建到另一个部分的流程时，他们经常会遇到故事中的交叉点，根据所做出的选择，可能会有分支的可能。这就是墨水中的所谓**编织**。这些是选择集合，其中每一个都有可能以不同的方式分支故事。

选择在墨水中使用星号`*`来编写。在墨水中，可能看起来像事物列表的东西，实际上是一个单一的编织中的不同选择：

[PRE13]

在之前的代码中，以星号开头的每一行都是一个选择。它从星号开始，延伸到行的末尾。行中的所有内容都成为选择的一部分。每一行的新星号在编织中创建一个新的选择：

[PRE14]

在编织中的每个选择都有分支叙事的潜力。在之前的代码中，有两个选择。然而，在每个选择之后还有另一行代码。当运行时，ink 会理解每个选择之后的每一行代码都是读者选择的结果。为了更好地视觉区分选择的结果，选择之后的行通常在开头缩进。

将之前的代码更改为使用缩进将如下所示：

示例 6：

[PRE15]

## 选择中的选择

选择也可以出现在其他选择内部。这些是子选择，并使用额外的星号来表示它们是编织前一层的结果：

示例 7：

[PRE16]

在之前的代码中，有两个选择，每个选择都引出自己的选择，从中心集合分支出来。这是一个**复杂编织**的例子。编织的第一层是初始的两个选择。然后，每个选择的后果是另一个编织，最后以文本结束。根据用户的流程，他们可能在移动到这些部分时只看到整体故事的一部分。

在复杂的编织中，一个可能分支的输出如下，供读者阅读：

输出

[PRE17]

故事中的不同分支序列也可能产生以下输出：

[PRE18]

## 选择性选择输出

使用选择时，选择的文本本身会出现在其输出中。这可以通过使用与选择相关的特殊概念**选择性输出**来改变。通过在选择的行中的任何文本周围使用开闭方括号，它将不会作为选择的结果出现在输出中：

[PRE19]

在之前的代码中，无论读者做出何种选择，输出结果都会相同：

[PRE20]

当选择的内容与展示给读者的内容不同时，使用**选项**这个词。选择是通过代码在 ink 中创建的。最终展示给读者的内容是一个*选项*。

在更高级的代码示例中，ink 可以动态生成选择。在这些情况下，与选择性输出一样，理解选择作为开发者编写的内容以及选项作为读者选择的内容是很重要的。通常，这些可以是同一件事，但在 ink 中编写代码时，它们不必是同一件事。

选择性输出还允许通过选择性显示选项中的文本来创建更动态的输出。使用选择性输出的一个影响是，一行中的闭合方括号表示向读者展示内容的结束。该行上任何额外的文本都将被忽略：

示例 8：

[PRE21]

可能的输出：

[PRE22]

从读者的角度来看，之前的代码会显示三个选项。每个选项都会读作`我剪断了电线`。然而，选择性输出的使用是告诉墨迹忽略每个颜色的附加文本。在做出选择后，用户会看到选择的结果作为新的一行，使用方括号排除任何包含的内容。

选择性输出通常可以用来*隐藏*在读者必须选择一个选项然后才能看到该行的附加文本的信息。

## 汇集点

编织中的每个选择都可能分支一个叙事。然而，有时需要将一个或多个分支汇集回它们开始的地方。而不是走向新的方向，可以使用汇集点将更复杂的编织折叠成一个*中心点*。在墨迹中，*汇集点*是通过在行上使用单个减号(`-`)来创建的：

[PRE23]

在之前的代码中，有两个选择，每个选择下又有两个子选择。然而，在编织的底部有一个*汇集点*。无论选择哪个分支跨过第一个编织层然后进入下一层，流动总是会汇集在最后一行。这就是汇集点的力量：它们允许一个具有多层复杂编织的结构折叠成一个单一点。

汇集点的放置很重要。在墨迹中，故事从上到下流动。如果汇集点出现在编织之前，它就会被忽略。如果没有东西可以汇集，汇集点就什么也不做。这也只影响编织。在没有编织*上方*作为折叠点的故事中，多个汇集点将不会产生任何作用。

汇集点一次只作用于一个编织。作为编织的最后一行，它们的作用是*汇集*选择。然而，它们一次只适用于一个分支结构。每个编织需要一个新的汇集点来将这些分支重新汇集在一起：

示例 9：

[PRE24]

在之前的代码中，既使用了选择性输出也使用了汇集点来创造两个编织，每个编织有两个选择的错觉。由于它们使用了汇集点，每个结果的输出都是各自的最后一行。选项呈现给读者，但代码本身会折叠每个编织的任何可能的分支，并将故事从第一个编织流向第二层。

# 消失和粘性选择

编织的默认行为是沿着其选择提供的其中一个分支引导故事的流动。当读者做出选择时，其他选项*消失*，所选择的分支成为故事的当前流动。即使在用Inky测试故事时回放，似乎在任何时候编织只有一个有效的分支。

预测读者可能会重新访问故事的一部分，并且可能会看到之前没有见过的选择的情况，墨水使用粘性选择的概念来再次向读者展示相同的选择。使用粘性选择，每次重访时每个选项都保持 *开放*，并且可以在将来再次使用：

[PRE25]

粘性选择使用加号 (`+`) 创建。它们可以被视为聚集点的对立面。而不是折叠编织，粘性选择 *保持开放* 编织中使用不同分支的选项。任何作为编织一部分创建的粘性选择总是 *粘性的*，即使它是编织中唯一的：

示例 10：

[PRE26]

在之前的代码中，有两种选择：

+   第一种是粘性选择。

+   第二次访问代码时，它将被移除。

在示例中，`boulder` 可以忽略一次，但下次读者再次访问这部分时，他们只会看到一个选项：`推动巨石`。

在故事只从上到下流动的示例中，粘性选择似乎用处不大。做出任何选择后，故事都会沿着分支流向故事的下一个较低部分，而不管选择类型如何：

[PRE27]

在前面的示例中，有一个包含两个粘性选择的单一编织。在从上到下移动故事时，编织会被访问一次，然后任一选择会分支出去，并在最后再次汇合。

同样的例子可以用其他选择类型来制作。

示例 11：

[PRE28]

两个代码示例的不同之处在于它们的意图。在第一个示例中，读者可能可以重新访问故事的同一部分并再次看到选择。在第二个示例中，选择是单向的。通过在编织中做出选择，它们不能在故事中重新访问。一旦做出选择，基本选择就是永久的。唯一改变这种意图的方法是使用粘性选择，当使用时它们会 *添加* 自己回到编织中。

在下一章，[*第二章*](B17597_02_Final_PG_ePub.xhtml#_idTextAnchor031)，*结、转向和循环模式*，我们将开始检查循环并控制故事在更复杂结构中的流动。循环将允许我们多次回到故事中的同一部分。在这些情况下，粘性选择将成为为玩家创建选项的默认用法。因为粘性选择保持开放，它们允许作者创建一个编织，玩家可以在其中多次选择相同的选项。

# 摘要

本章为您提供了对术语故事、内容和叙述的解释，以及读者可能从其内容中体验到的内容。我们探讨了非线性叙述，即故事的部分可以以不同于它们被书写或最初创作的顺序体验。接下来，我们学习了分支叙述，这是一种描述体验非线性故事的方式，其中不同的序列、分支被探索而不是其他。通过使用代码（脚本），我们看到了通过控制读者体验故事内容的时间来创建不同叙述的方法。

ink是一种叙述脚本语言。我们将通过故事中的移动理解为一个称为流的概念。我们发现，通过使用不同类型的选项创建的每个交叉点都被称为编织物。通过使用选项，我们看到了编织的不同层次和更多分支是可能的。对于编织物变得过于复杂的情况，我们可以使用聚集点。这会将编织物折叠成单个点或线。

在下一章中，我们将开始使用结，故事的部分标记区域，以及偏离，在这些部分之间移动，来构建非线性叙述和分支叙述的概念。我们将开始使用选项将读者移动到特定的结或重复相同的编织物。

# 问题

1.  故事和叙述之间的区别是什么？

1.  墨水如何理解流的概念？

1.  如何将多行文本合并为一行？

1.  墨水编织物是由什么制成的？

1.  有哪些不同的选择类型？

1.  如何使用选择性输出在选项中隐藏信息以供读者阅读？

1.  为什么粘性选择可能是向读者展示选项的首选方式？
