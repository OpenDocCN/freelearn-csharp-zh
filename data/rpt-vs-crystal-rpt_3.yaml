- en: Chapter 3. Selecting the Data
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第3章。选择数据
- en: Reports are formatted presentation of data. Reports are used to present the
    information stored in database(s). Hence the first step is to connect to a database
    to read data from it. In this chapter, we will see how we can connect to the database
    and run SQL queries using Microsoft Visual Studio. We will also talk about DataSet
    and TableAdapter and see how we can use them to fill the ComboBoxes in our application.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 报告是数据的格式化展示。报告用于展示存储在数据库（s）中的信息。因此，第一步是连接到数据库以从中读取数据。在本章中，我们将看到如何使用Microsoft
    Visual Studio连接到数据库并运行SQL查询。我们还将讨论DataSet和TableAdapter，并了解如何使用它们来填充我们应用程序中的ComboBoxes。
- en: 'In this chapter, we will cover:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将涵盖：
- en: SQL query in Visual Studio
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Visual Studio中的SQL查询
- en: Populate the ComboBoxes with data
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用数据填充ComboBoxes
- en: SQL queries in Microsoft Visual Studio
  id: totrans-5
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Microsoft Visual Studio中的SQL查询
- en: Generally SQL queries are categorized into data definition language and data
    manipulation language.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 通常SQL查询分为数据定义语言和数据操作语言。
- en: There are many types of SQL queries such as Select, Update, Delete, and Insert
    query. In this book we will talk only about the Select query because reports use
    the Select query. We will use Northwind database in our example queries and we
    will use Microsoft Visual Studio to run all SQL queries. So first, we need to
    connect to our database.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 有许多类型的SQL查询，如选择查询、更新查询、删除查询和插入查询。在本书中，我们将只讨论选择查询，因为报告使用选择查询。在我们的示例查询中，我们将使用Northwind数据库，并使用Microsoft
    Visual Studio来运行所有SQL查询。因此，首先，我们需要连接到我们的数据库。
- en: Connecting to our database
  id: totrans-8
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 连接到我们的数据库
- en: Open our application, Monitor, in Microsoft Visual Studio.
  id: totrans-9
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在Microsoft Visual Studio中打开我们的应用程序，Monitor。
- en: Click on **View** and click on **Server Explorer**.
  id: totrans-10
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**视图**并点击**服务器资源管理器**。
- en: In **Server Explorer**, right-click on **Data Connections** and select **Add
    Connection...**. A dialog box similar to the one shown in the next screenshot
    will appear:![Connecting to our database](img/3-1.jpg)
  id: totrans-11
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**服务器资源管理器**中，右键单击**数据连接**并选择**添加连接...**。将出现一个类似于下一张截图的对话框：![连接到我们的数据库](img/3-1.jpg)
- en: Make sure that **Data source:** is **Microsoft SQL Server(SqlClient)**.
  id: totrans-12
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 确保在**数据源**中**Microsoft SQL Server(SqlClient)**。
- en: Because we have installed Microsoft SQL Server on our machine, we can type in
    `localhost` as the server name or write the machine name.
  id: totrans-13
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 因为我们已经在我们的机器上安装了Microsoft SQL Server，所以我们可以输入`localhost`作为服务器名称或写入机器名称。
- en: Select **Use SQL Server Authentication** and enter `sa` as the **User name:**
    and enter your password that you used while installing Microsoft SQL Server.
  id: totrans-14
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择**使用SQL Server身份验证**，并以`sa`作为**用户名**输入，并输入您在安装Microsoft SQL Server时使用的密码。
- en: Enter `Northwind` in the database field and click on the **Test Connection**
    button.
  id: totrans-15
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在数据库字段中输入`Northwind`并点击**测试连接**按钮。
- en: If a message box pops up saying that the test succeeded, it means we can go
    ahead. If not, reenter the data or troubleshoot if there is any connection problem
    with SQL Server.
  id: totrans-16
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果弹出一个消息框说测试成功，这意味着我们可以继续进行。如果没有，重新输入数据或者如果与SQL Server有任何连接问题，进行故障排除。
- en: Click on the **OK** button to connect to the database, and we will see our database
    in the **Server Explorer**, as shown in to the following screenshot:![Connecting
    to our database](img/3-2.jpg)
  id: totrans-17
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**确定**按钮以连接到数据库，我们将在**服务器资源管理器**中看到我们的数据库，如图所示：![连接到我们的数据库](img/3-2.jpg)
- en: Add database diagram
  id: totrans-18
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 添加数据库图表
- en: 'To understand the Northwind database and relation between its tables we will
    create a new database diagram:'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 为了理解Northwind数据库及其表之间的关系，我们将创建一个新的数据库图表：
- en: Right-click on **Database Diagrams** and choose **Add New Diagram**. Click on
    **Yes** in the confirmation message box
  id: totrans-20
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 右键单击**数据库图表**并选择**添加新图表**。在确认消息框中点击**是**。
- en: Select all tables in the **Add Tables** dialog and click on the **Add** button.
    We can see all the tables and relations between these tables in the next diagram.
  id: totrans-21
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**添加表**对话框中，选择所有表并点击**添加**按钮。我们可以在下一张图表中看到所有表以及这些表之间的关系。
- en: Save the diagram with the default name `Diagram1`.![Add database diagram](img/3-3.jpg)
  id: totrans-22
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用默认名称`Diagram1`保存图表。![添加数据库图表](img/3-3.jpg)
- en: Test queries
  id: totrans-23
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 测试查询
- en: 'We need a tool to run queries and test results. Microsoft Visual Studio has
    a good IDE to run SQL queries. We can see this IDE by right-clicking on any table
    name in our database in **Server Explorer** and selecting **New Query**. Then
    we will choose the tables that we will use in our query from the **Add Table**
    dialog box and click on the **OK** button. Refer to the following screenshot:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 我们需要一个工具来运行查询并测试结果。Microsoft Visual Studio 有一个很好的 IDE 来运行 SQL 查询。我们可以在 **服务器资源管理器**
    中通过右键单击数据库中的任何表名并选择 **新建查询** 来查看此 IDE。然后，我们将从 **添加表** 对话框中选择我们将用于查询的表，并点击 **确定**
    按钮。参见图表：
- en: '![Test queries](img/3-4.jpg)'
  id: totrans-25
  prefs: []
  type: TYPE_IMG
  zh: '![测试查询](img/3-4.jpg)'
- en: As we can see in the previous screenshot, there are four sections in our Query
    IDE. Section one displays all tables we used in our query, section two displays
    simple query builder, section three displays SQL query code, and section four
    displays the query result. In our discussion we will talk about sections three
    and four.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 如前一个截图所示，我们的查询 IDE 中有四个部分。第一部分显示我们在查询中使用的所有表，第二部分显示简单的查询构建器，第三部分显示 SQL 查询代码，第四部分显示查询结果。在我们的讨论中，我们将讨论第三和第四部分。
- en: Populate the ComboBoxes with data
  id: totrans-27
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 用数据填充组合框
- en: 'In our application, we have many ComboBoxes. How do we populate them with data?
    In this section we will populate the ComboBoxes with data and talk about the basics
    of select SQL query. We have four main steps to populate any ComboBox in our application:
    SQL query, `TableAdapter`, `DataSource`, and Load Event. Before we start filling
    the first ComboBox, we need to add DataSet to our application to save the retrieved
    data by TableAdapter, in to it.'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的应用程序中，我们有许多组合框。我们如何用数据填充它们？在本节中，我们将用数据填充组合框，并讨论选择 SQL 查询的基础知识。我们填充应用程序中任何组合框的主要步骤有四个：SQL
    查询、`TableAdapter`、`DataSource` 和加载事件。在我们开始填充第一个组合框之前，我们需要将数据集添加到我们的应用程序中，以便通过
    TableAdapter 保存检索到的数据。
- en: Add DataSet to the application
  id: totrans-29
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 将数据集添加到应用程序
- en: Right-click on the Monitor application in the Solution Explorer and navigate
    to **Add** | **New Item**.
  id: totrans-30
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在解决方案资源管理器中右键单击 Monitor 应用程序，并导航到 **添加** | **新建项**。
- en: From the dialog box select **DataSet** and we will keep it with the default
    name `DataSet1`.
  id: totrans-31
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从对话框中选择 **数据集**，我们将使用默认名称 `DataSet1`。
- en: Populate the cbEmpTitle ComboBox
  id: totrans-32
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 填充 cbEmpTitle 组合框
- en: '**Select data**: We need to populate this ComboBox with all employees'' titles
    without any duplication.'
  id: totrans-33
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**选择数据**：我们需要用所有员工的职称填充此组合框，且不包含任何重复。'
- en: As we can see in the following screenshot, we can use a `Select` query to select
    `Title` from `Employees` table and the `DISTINCT` keyword to avoid duplication.
  id: totrans-34
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如以下截图所示，我们可以使用 `Select` 查询从 `Employees` 表中选择 `Title`，并使用 `DISTINCT` 关键字避免重复。
- en: '![Populate the cbEmpTitle ComboBox](img/3-5.jpg)'
  id: totrans-35
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![填充 cbEmpTitle 组合框](img/3-5.jpg)'
- en: '**Create TableAdapter**: Open `DataSet1`, right-click on it and navigate to
    **Add** | **TableAddapter**, as shown in the following screenshot:![Populate the
    cbEmpTitle ComboBox](img/3-6.jpg)'
  id: totrans-36
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**创建 TableAdapter**：打开 `DataSet1`，右键单击它并导航到 **添加** | **TableAdapter**，如图所示：![填充
    cbEmpTitle 组合框](img/3-6.jpg)'
- en: 'In this step, we can create a new connection string to our database or use
    the connection string that we created to connect to our database in **Server Explorer**.
    Here we will use the one we created before and then click on the **Next** button;
    as we will see the following screenshot:'
  id: totrans-37
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在此步骤中，我们可以创建一个新的连接字符串到我们的数据库或使用我们在 **服务器资源管理器** 中创建的连接字符串来连接到我们的数据库。这里我们将使用之前创建的连接字符串，然后点击
    **下一步** 按钮；我们将看到以下截图：
- en: '![Populate the cbEmpTitle ComboBox](img/3-7.jpg)'
  id: totrans-38
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![填充 cbEmpTitle 组合框](img/3-7.jpg)'
- en: 'In our application, we will use the SQL statement to access the database, so
    select **Use SQL Statements** and click on the **Next** button to see the following
    screenshot:'
  id: totrans-39
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在我们的应用程序中，我们将使用 SQL 语句来访问数据库，因此选择 **使用 SQL 语句** 并点击 **下一步** 按钮以查看以下截图：
- en: '![Populate the cbEmpTitle ComboBox](img/3-8.jpg)'
  id: totrans-40
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![填充 cbEmpTitle 组合框](img/3-8.jpg)'
- en: 'In this dialog we will write the SQL query that we prepared in the previous
    step and click on the **Next** button to see the following screenshot:'
  id: totrans-41
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在此对话框中，我们将编写之前步骤中准备的 SQL 查询，然后点击 **下一步** 按钮以查看以下截图：
- en: '![Populate the cbEmpTitle ComboBox](img/3-9.jpg)'
  id: totrans-42
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![填充 cbEmpTitle 组合框](img/3-9.jpg)'
- en: 'In this dialog we will change the method names to `FillTitle` and `GetTitle`
    then click on the **Next** button to see the following screenshot:'
  id: totrans-43
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在这个对话框中，我们将方法名称更改为 `FillTitle` 和 `GetTitle`，然后点击 **下一步** 按钮以查看以下截图：
- en: '![Populate the cbEmpTitle ComboBox](img/3-10.jpg)'
  id: totrans-44
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![填充 cbEmpTitle 组合框](img/3-10.jpg)'
- en: 'We need to see this dialog to be sure that all the processes are configured
    successfully, then click on the **Finish** button to see the TableAdapter shown
    in the following screenshot:'
  id: totrans-45
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 我们需要看到这个对话框来确保所有过程都配置成功，然后点击**完成**按钮以查看以下截图所示的TableAdapter：
- en: '![Populate the cbEmpTitle ComboBox](img/3-11.jpg)'
  id: totrans-46
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![填充cbEmpTitle组合框](img/3-11.jpg)'
- en: In the previous screenshot, we changed the DataTable name to `EmpTitle` and
    TableAdapter name to `EmpTitleTableAdapter`.
  id: totrans-47
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在上一张截图中，我们将DataTable名称更改为`EmpTitle`，并将TableAdapter名称更改为`EmpTitleTableAdapter`。
- en: '**Set comboboxDataSource**: Open the Main Form; right-click on it and select
    **View Code**. We will create a new method to publish our ComboBox data. Refer
    to the following screenshot:![Populate the cbEmpTitle ComboBox](img/3-12.jpg)'
  id: totrans-48
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**设置组合框数据源**：打开主表单；右键单击它并选择**查看代码**。我们将创建一个新的方法来发布我们的组合框数据。参考以下截图：![填充cbEmpTitle组合框](img/3-12.jpg)'
- en: In the `PublishEmpTitle` method, we create the object from `DataSet1` named
    `ds` and create another object from `EmpTitleTableAdapter` named `Adapter`. Then
    we fill our dataset `ds` by t`ableadapterAdapter` using the `FillTitle` method.
    In the end, we assign the `cbEmpTitleDataSource` to `ds` and `DisplayMember` to
    Title.
  id: totrans-49
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在`PublishEmpTitle`方法中，我们从`DataSet1`创建名为`ds`的对象，并从`EmpTitleTableAdapter`创建另一个名为`Adapter`的对象。然后我们通过`TableAdapterAdapter`使用`FillTitle`方法填充我们的数据集`ds`。最后，我们将`cbEmpTitleDataSource`分配给`ds`和`DisplayMember`到标题。
- en: '**Update Load event**: In the Main Form Load event `MainForm_Load`, we will
    call our method `PublishEmpTitle` as we can see in the following screenshot:![Populate
    the cbEmpTitle ComboBox](img/3-13.jpg)'
  id: totrans-50
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**更新加载事件**：在主表单的加载事件`MainForm_Load`中，我们将调用我们的方法`PublishEmpTitle`，如下截图所示：![填充cbEmpTitle组合框](img/3-13.jpg)'
- en: '**Test the result**: Run our application to test the result. We can see that
    our ComboBox title is now filled with data; as seen in the following screenshot:![Populate
    the cbEmpTitle ComboBox](img/3-14.jpg)'
  id: totrans-51
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**测试结果**：运行我们的应用程序以测试结果。我们可以看到我们的组合框标题现在已填充了数据；如下截图所示：![填充cbEmpTitle组合框](img/3-14.jpg)'
- en: Populate the cbEmpCity ComboBox
  id: totrans-52
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 填充cbEmpCity组合框
- en: '**Select data**: We need to fill this ComboBox with all cities without any
    duplication. Refer to the following screenshot:![Populate the cbEmpCity ComboBox](img/3-15.jpg)'
  id: totrans-53
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**选择数据**：我们需要将所有城市填充到这个组合框中，且不能有重复。参考以下截图：![填充cbEmpCity组合框](img/3-15.jpg)'
- en: '**Create TableAdapter**: Please follow the same steps as in the last section
    to create the TableAdapter and name it as `EmpCity`. The TableAdapter will look
    like the following screenshot:![Populate the cbEmpCity ComboBox](img/3-16.jpg)'
  id: totrans-54
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**创建TableAdapter**：请按照上一节中的相同步骤创建TableAdapter，并将其命名为`EmpCity`。TableAdapter将类似于以下截图：![填充cbEmpCity组合框](img/3-16.jpg)'
- en: '**Set comboboxDataSource**: Refer to the code in the following screenshot:![Populate
    the cbEmpCity ComboBox](img/3-17.jpg)'
  id: totrans-55
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**设置组合框数据源**：参考以下截图中的代码：![填充cbEmpCity组合框](img/3-17.jpg)'
- en: '**Update Load event**: Refer to the code in the following screenshot:![Populate
    the cbEmpCity ComboBox](img/3-18.jpg)'
  id: totrans-56
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**更新加载事件**：参考以下截图中的代码：![填充cbEmpCity组合框](img/3-18.jpg)'
- en: '**Test the result**: The result will look like the following screenshot:![Populate
    the cbEmpCity ComboBox](img/3-19.jpg)'
  id: totrans-57
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**测试结果**：结果将类似于以下截图：![填充cbEmpCity组合框](img/3-19.jpg)'
- en: Populate the cbEmpCountry ComboBox
  id: totrans-58
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 填充cbEmpCountry组合框
- en: '**Select data**: We need to fill this ComboBox with all employee countries
    without any duplication, as shown in the following screenshot:![Populate the cbEmpCountry
    ComboBox](img/3-20.jpg)'
  id: totrans-59
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**选择数据**：我们需要将所有员工国家填充到这个组合框中，且不能有重复，如下截图所示：![填充cbEmpCountry组合框](img/3-20.jpg)'
- en: '**Create TableAdapter**: Please follow the same steps as before to create the
    TableAdapter. The TableAdapter will look like the following screenshot:![Populate
    the cbEmpCountry ComboBox](img/3-21.jpg)'
  id: totrans-60
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**创建TableAdapter**：请按照之前的步骤创建TableAdapter。TableAdapter将类似于以下截图：![填充cbEmpCountry组合框](img/3-21.jpg)'
- en: '**Set comboboxDataSource**: Refer to the code in the following screenshot:![Populate
    the cbEmpCountry ComboBox](img/3-22.jpg)'
  id: totrans-61
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**设置组合框数据源**：参考以下截图中的代码：![填充cbEmpCountry组合框](img/3-22.jpg)'
- en: '**Update Load event**: Refer to the code in the following screenshot:![Populate
    the cbEmpCountry ComboBox](img/3-23.jpg)'
  id: totrans-62
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**更新加载事件**：参考以下截图中的代码：![填充cbEmpCountry组合框](img/3-23.jpg)'
- en: '**Test the result**: The result will look like the following screenshot:![Populate
    the cbEmpCountry ComboBox](img/3-24.jpg)'
  id: totrans-63
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**测试结果**：结果将类似于以下截图：![填充cbEmpCountry组合框](img/3-24.jpg)'
- en: Populate the cbProductsCategory ComboBox
  id: totrans-64
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 填充cbProductsCategory组合框
- en: '**Select data**: We need to fill this ComboBox with all product categories
    without any duplication. Refer to the following screenshot:![Populate the cbProductsCategory
    ComboBox](img/3-25.jpg)'
  id: totrans-65
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**选择数据**：我们需要填充这个组合框，包含所有产品类别，且不重复。请参考以下截图：![填充cbProductsCategory组合框](img/3-25.jpg)'
- en: '**Create TableAdapter**: Again, please follow the same steps as before to create
    the TableAdapter. The TableAdapter will look like the following screenshot:![Populate
    the cbProductsCategory ComboBox](img/3-26.jpg)'
  id: totrans-66
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**创建TableAdapter**：再次，请按照之前的步骤创建TableAdapter。TableAdapter将类似于以下截图：![填充cbProductsCategory组合框](img/3-26.jpg)'
- en: '**Set comboboxDataSource**: Refer to the code in the following screenshot:![Populate
    the cbProductsCategory ComboBox](img/3-27.jpg)'
  id: totrans-67
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**设置组合框数据源**：请参考以下截图中的代码：![填充cbProductsCategory组合框](img/3-27.jpg)'
- en: '**Update Load event**: Refer to the code in the following screenshot:![Populate
    the cbProductsCategory ComboBox](img/3-28.jpg)'
  id: totrans-68
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**更新加载事件**：请参考以下截图中的代码：![填充cbProductsCategory组合框](img/3-28.jpg)'
- en: '**Test the result**: The result will look like the following screenshot:![Populate
    the cbProductsCategory ComboBox](img/3-29.jpg)'
  id: totrans-69
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**测试结果**：结果将类似于以下截图：![填充cbProductsCategory组合框](img/3-29.jpg)'
- en: Populate cbOrdersCountry ComboBox
  id: totrans-70
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 填充cbOrdersCountry组合框
- en: '**Select data**: We need to fill this ComboBox with all the countries in the
    `Customers` table without any duplication. Refer to the following screenshot:![Populate
    cbOrdersCountry ComboBox](img/3-30.jpg)'
  id: totrans-71
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**选择数据**：我们需要填充这个组合框，包含`Customers`表中的所有国家，且不重复。请参考以下截图：![填充cbOrdersCountry组合框](img/3-30.jpg)'
- en: '**Create TableAdapter**: Please follow the same steps as before to create the
    TableAdapter. The TableAdapter will look like the following screenshot:![Populate
    cbOrdersCountry ComboBox](img/3-31.jpg)'
  id: totrans-72
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**创建TableAdapter**：请按照之前的步骤创建TableAdapter。TableAdapter将类似于以下截图：![填充cbOrdersCountry组合框](img/3-31.jpg)'
- en: '**Set comboboxDataSource**: Refer to the code in the following screenshot:![Populate
    cbOrdersCountry ComboBox](img/3-32.jpg)'
  id: totrans-73
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**设置组合框数据源**：请参考以下截图中的代码：![填充cbOrdersCountry组合框](img/3-32.jpg)'
- en: '**Update Load event**: To do this, please refer to the code in the following
    screenshot:![Populate cbOrdersCountry ComboBox](img/3-33.jpg)'
  id: totrans-74
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**更新加载事件**：为此，请参考以下截图中的代码：![填充cbOrdersCountry组合框](img/3-33.jpg)'
- en: '**Test the result**: The result will look like the following screenshot:![Populate
    cbOrdersCountry ComboBox](img/3-34.jpg)'
  id: totrans-75
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**测试结果**：结果将类似于以下截图：![填充cbOrdersCountry组合框](img/3-34.jpg)'
- en: Summary
  id: totrans-76
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: Valid data is more critical than the report design, so we need to select the
    right data before displaying this data in the report. Before we start any reporting
    application, we need to understand the database/data very well to ensure that
    our report has the correct data. In this chapter, we learned how to write our
    Select query in Visual Studio and how to run this query. We learned how to fill
    the ComboBox using the DataAdapter. In the next chapter, we begin to use Crystal
    Reports and we will see how to display this report in our application.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 有效数据比报表设计更为关键，因此我们在报表中显示这些数据之前需要选择正确的数据。在我们开始任何报表应用程序之前，我们需要非常了解数据库/数据，以确保我们的报表包含正确的数据。在本章中，我们学习了如何在Visual
    Studio中编写我们的选择查询以及如何运行此查询。我们学习了如何使用DataAdapter填充ComboBox。在下一章中，我们将开始使用Crystal
    Reports，我们将看到如何在我们的应用程序中显示这个报表。
