<html><head></head><body>
<div><div><h1 class="chapter-number" id="_idParaDest-259"><a id="_idTextAnchor447" class="pcalibre pcalibre1 calibre6"/>16</h1>
<h1 id="_idParaDest-260" class="calibre5"><a id="_idTextAnchor448" class="pcalibre pcalibre1 calibre6"/>Utilizing World Space UI</h1>
<p class="calibre3">In <a href="B18327_06.xhtml#_idTextAnchor085" class="pcalibre pcalibre1 calibre6"><em class="italic">Chapter 6</em></a>, we discussed the three different Render Modes you can assign to a Canvas. We’ve used Screen Space-Overlay and Screen Space-Camera but haven’t used World Space yet. As described in <a href="B18327_02.xhtml#_idTextAnchor024" class="pcalibre pcalibre1 calibre6"><em class="italic">Chapter 2</em></a>, UI rendered in World Space is placed directly in the scene. We’ve already discussed the properties of World Space Canvas rendering, so this chapter will just look at when to use it and examples of implementation.</p>
<p class="calibre3">In this chapter, we will discuss the following topics:</p>
<ul class="calibre16">
<li class="calibre14">When to use World Space UI</li>
<li class="calibre14">General techniques to consider when working with World Space UI</li>
<li class="calibre14">Using World Space Canvases in a 2D game to create status indicators positioned relative to characters</li>
<li class="calibre14">Using World Space Canvases to create health bars that hover over enemies’ heads in a 3D game</li>
</ul>
<h1 id="_idParaDest-261" class="calibre5"><a id="_idTextAnchor449" class="pcalibre pcalibre1 calibre6"/>Technical requirements</h1>
<p class="calibre3">You can find the relevant codes and asset files of this chapter here: <a href="https://github.com/PacktPublishing/Mastering-UI-Development-with-Unity-2nd-Edition/tree/main/Chapter%2016" class="pcalibre pcalibre1 calibre6">https://github.com/PacktPublishing/Mastering-UI-Development-with-Unity-2nd-Edition/tree/main/Chapter%2016</a></p>
<h1 id="_idParaDest-262" class="calibre5"><a id="_idTextAnchor450" class="pcalibre pcalibre1 calibre6"/>When to use World Space UI</h1>
<p class="calibre3">There are many reasons you may want to use <a id="_idIndexMarker959" class="pcalibre pcalibre1 calibre6"/>a World Space Canvas. The most common reasons for using this render mode are the following:</p>
<ul class="calibre16">
<li class="calibre14">To have better control of individual UI objects’ positions in relation to objects in the scene</li>
<li class="calibre14">To rotate or curve UI elements</li>
</ul>
<p class="calibre3">For example, the game <em class="italic">Mojikara: Japanese Trainer</em> uses World Space Canvases to have rotated Panels and keep UI objects, such as Text, attached to 3D objects. As you can see from the following screenshot, the Panel on the left is rotated just slightly in 3D space, because it is on a World <a id="_idIndexMarker960" class="pcalibre pcalibre1 calibre6"/>Space Canvas:</p>
<div><div><img alt="Figure 16.1: Mojikara: Japanese Trainer (image provided by Lisa Walkosz-Migliacio, Intropy Games)" src="img/B18327_16_01.jpg" class="calibre546"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.1: Mojikara: Japanese Trainer (image provided by Lisa Walkosz-Migliacio, Intropy Games)</p>
<p class="calibre3">Another example of rotated UI can be found in the game <em class="italic">Cloudbase Prime</em>, as shown in the following screenshot. It also used World Space rendering to create indicators that hover over objects and characters.</p>
<div><div><img alt="Figure 16.2: Cloudbase Prime (image provided by Tyrus Peace, Floating Island Games)" src="img/B18327_16_02.jpg" class="calibre547"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.2: Cloudbase Prime (image provided by Tyrus Peace, Floating Island Games)</p>
<p class="calibre3">All the UI in <em class="italic">Cloudbase Prime</em> was done<a id="_idIndexMarker961" class="pcalibre pcalibre1 calibre6"/> on World Space Canvases. This allowed the developer to create cool curving UI, as follows:</p>
<div><div><img alt="Figure 16.3: Cloudbase Prime (image provided by Tyrus Peace, Floating Island Games)" src="img/B18327_16_03.jpg" class="calibre548"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.3: Cloudbase Prime (image provided by Tyrus Peace, Floating Island Games)</p>
<p class="calibre3">Here, you can see how the UI looks in the Editor versus how it looks to the player. This gives a nice peek at how the UI was built:</p>
<div><div><img alt="Figure 16.4: Cloudbase Prime (image provided by Tyrus Peace, Floating Island Games)" src="img/B18327_16_04.jpg" class="calibre549"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.4: Cloudbase Prime (image provided by Tyrus Peace, Floating Island Games)</p>
<p class="calibre3">I recommend checking out the following <a id="_idIndexMarker962" class="pcalibre pcalibre1 calibre6"/>site to see more ways in which <em class="italic">Cloudbase Prime</em> has implemented World Space UI, as they are truly beautiful: <a href="https://imgur.com/a/hxNgL" class="pcalibre pcalibre1 calibre6">https://imgur.com/a/hxNgL</a>.</p>
<p class="calibre3">Another common usage of World Space UI is simulating computer screens and monitors within a scene. For example, I built the following UI for a friend’s VR game named <em class="italic">Cloud Rise</em>. The monitor was simulated by placing a World Space Canvas right on top of the in-game screen. I was then able to easily anchor and animate the UI; in the same way, I rendered the UI in Screen Space.</p>
<div><div><img alt="Figure 16.5: Cloud Rise (image provided by Meredith Wilson, Bedhouse Games)" src="img/B18327_16_05.jpg" class="calibre550"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.5: Cloud Rise (image provided by Meredith Wilson, Bedhouse Games)</p>
<p class="calibre3">In general, the interactive UIs of VR games are on World Space Canvases since the player cannot interact with <em class="italic">the screen</em>. Common<a id="_idIndexMarker963" class="pcalibre pcalibre1 calibre6"/> usages of VR UI are flat floating Panels or wrapping Panels.</p>
<p class="calibre3">Hovering indicators are by far the most common use of World Space UI; they are specifically used for health bars over the heads of in-game characters, as shown in the following screenshot of <em class="italic">Iris Burning</em>:</p>
<div><div><img alt="Figure 16.6: Iris Burning (image provided by William Preston, DCM Studios)" src="img/B18327_16_06.jpg" class="calibre551"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.6: Iris Burning (image provided by William Preston, DCM Studios)</p>
<p class="calibre3">Most people think of 3D games when they think of World Space UI because they think of UI that appears <em class="italic">far away</em>, but it is commonly used in 2D games as well! Management and RTS games use UI quite frequently to create buttons and progress bars, and other UI elements maintain their position<a id="_idIndexMarker964" class="pcalibre pcalibre1 calibre6"/> with the object they interact with. The World Space UI can be on one Canvas that encompasses all items on the screen, with individual UI items matching the 2D World Space coordinates of the items they represent, or they can be on individual Canvases of their respective items. We will cover how to create a 2D game using World Space UI in an example at the end of the chapter.</p>
<p class="calibre3">Now, let’s explore how to use World Space UI.</p>
<h1 id="_idParaDest-263" class="calibre5"><a id="_idTextAnchor451" class="pcalibre pcalibre1 calibre6"/>Appropriately scaling text in the Canvas</h1>
<p class="calibre3">Whenever a Canvas is created, it is initialized with <strong class="bold">Screen Space - Overlay</strong> as its <strong class="bold">Render Mode</strong>. Therefore, when you change the <strong class="bold">Render Mode</strong> property to <strong class="bold">World Space</strong>, the Canvas will be huge in your scene.</p>
<p class="calibre3">When you scale down the Canvas to the <a id="_idIndexMarker965" class="pcalibre pcalibre1 calibre6"/>appropriate size in the scene, the text will likely be super blurry or not visible at all. Let’s say we created the following Canvas in <strong class="bold">Screen Space - Overlay</strong> but decided to put it in <strong class="bold">World Space</strong>:</p>
<div><div><img alt="Figure 16.7: A Canvas in Screen Space - Overlay" src="img/B18327_16_07.jpg" class="calibre552"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.7: A Canvas in Screen Space - Overlay</p>
<p class="calibre3">Converting it to <code>4</code> and <code>3</code> (since it was initially created with a 4:3 aspect ratio screen), the text will disappear!</p>
<div><div><img alt="Figure 16.8: A Canvas in Screen Space - Overlay" src="img/B18327_16_08.jpg" class="calibre553"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.8: A Canvas in Screen Space - Overlay</p>
<p class="calibre3">If I set the <strong class="bold">Text</strong> to allow <strong class="bold">Horizontal Overflow</strong> and <strong class="bold">Vertical Overflow</strong> you’ll see that it is huge when compared<a id="_idIndexMarker966" class="pcalibre pcalibre1 calibre6"/> to the Canvas! In the following screenshot, the tiny rectangle in the middle is the Canvas:</p>
<div><div><img alt="Figure 16.9: World Space Canvas with huge overflowing text example" src="img/B18327_16_09.jpg" class="calibre554"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.9: World Space Canvas with huge overflowing text example</p>
<p class="calibre3">To fix this, and to get it looking the way we want, we need to adjust the <code>1</code>.</p>
<p class="calibre3">Usually, to determine the new <code>905</code>, divide it by the new <code>4</code>, and enter that division in my <code>905/4</code> in the box will perform the calculation.)</p>
<div><div><img alt="Figure 16.10: Dynamic Pixels Per Unit property adjusted" src="img/B18327_16_10.jpg" class="calibre555"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.10: Dynamic Pixels Per Unit property adjusted</p>
<p class="calibre3">However, that calculation didn’t get <a id="_idIndexMarker967" class="pcalibre pcalibre1 calibre6"/>the exact look I was looking for. So, I increased the size until it looked right:</p>
<div><div><img alt="Figure 16.11: Dynamic Pixels Per Unit property example in the Chapter16 scene" src="img/B18327_16_11.jpg" class="calibre556"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.11: Dynamic Pixels Per Unit property example in the Chapter16 scene</p>
<p class="calibre3">Every time you change the <strong class="bold">Width</strong> and <strong class="bold">Height</strong> of the Canvas, you will have to adjust the <strong class="bold">Dynamic Pixels Per Unit</strong> property. Decreasing the size of the Canvas will mean increasing the <strong class="bold">Dynamic Pixels Per Unit</strong> property, and increasing the size of the Canvas will mean decreasing<a id="_idIndexMarker968" class="pcalibre pcalibre1 calibre6"/> the size of the <strong class="bold">Dynamic Pixels Per </strong><strong class="bold">Unit</strong> property.</p>
<p class="calibre3">Here are two Canvases, both one-fourth the size of the one from the previous figure. In the top Canvas, I changed the <code>1</code> and <code>.75</code>. In the bottom Canvas, I changed the <code>0.25</code>:</p>
<div><div><img alt="Figure 16.12: Width and Height change examples" src="img/B18327_16_12.jpg" class="calibre557"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.12: Width and Height change examples</p>
<p class="calibre3">In the first example, since I changed the <code>350*4</code> in the <code>1400</code> for me (I love that Unity performs calculations in the boxes).</p>
<p class="calibre3">However, in the second Canvas, I did not have to change the <strong class="bold">Dynamic Pixels Per Unit</strong> size, because scaling with the <strong class="bold">Scale</strong> property in this way does not require me to change it.</p>
<p class="calibre3">The takeaway from this is that if your text isn’t displaying or looks incredibly blurry, adjust the <strong class="bold">Dynamic Pixels Per Unit</strong> property until it looks the way it should, or scale your Canvas by adjusting its <strong class="bold">Scale</strong> and not its <strong class="bold">Width</strong> and <strong class="bold">Height</strong>.</p>
<p class="calibre3">Text scaling will be the most important <a id="_idIndexMarker970" class="pcalibre pcalibre1 calibre6"/>consideration with using World Space UI, but let’s review some other important topics.</p>
<h1 id="_idParaDest-264" class="calibre5"><a id="_idTextAnchor452" class="pcalibre pcalibre1 calibre6"/>Other considerations when working in World Space</h1>
<p class="calibre3">For the most part, working with UI in <a id="_idIndexMarker971" class="pcalibre pcalibre1 calibre6"/>World Space isn’t much different than working with UI in Screen or Camera Space. There are a few things you have to keep in mind, though.</p>
<p class="calibre3">When working with 3D scenes, you may want your UI to always face the player, regardless of how the player turns<a id="_idIndexMarker972" class="pcalibre pcalibre1 calibre6"/> the camera—this is known as a <em class="italic">billboard effect</em>. You can achieve this with a simple <code>LookAt()</code> function on the transform of the object in the <code>Update()</code> function:</p>
<pre class="source-code">
transform.LookAt(2*transform.position-theCamera.transform.position );</pre> <p class="calibre3">You can use a variation of the preceding code, depending on how you want the rotation to behave.</p>
<p class="calibre3">Another consideration with 3D World Space UI is the distance it is away from the camera. You may want to have UI only render when it is a specific distance from the camera as it may be difficult to see when it is too far away.</p>
<p class="calibre3">Depending on your project, using World Space Canvases may cause difficulties with Raycasting, making interacting with UI a problem. Tyrus Peace of Floating Island Games recommends creating your own physics layer if you end up having to create your own Raycasting system, as he did with <em class="italic">Cloudbase Prime</em>, shown earlier in the chapter<a id="_idTextAnchor453" class="pcalibre pcalibre1 calibre6"/>.</p>
<h1 id="_idParaDest-265" class="calibre5"><a id="_idTextAnchor454" class="pcalibre pcalibre1 calibre6"/>Examples</h1>
<p class="calibre3">Working with World Space Canvases isn’t significantly different than working with Canvases in Screen and Camera Space. World Space Canvases offer many benefits. If you have an object that exists within your scene that has UI specifically tied to its location, it is helpful to use a World Space Canvas so that the UI follows it wherever it is. This removes the necessity of trying to convert the object’s World Space coordinates to Screen coordinates to ensure that the UI always lines up with the object. It also guarantees that the UI object will always display correctly with respect to the object’s location, even when the screen’s resolution changes. In this chapter, I will cover two common uses of World Space Canvases: one in 2D space and another in 3D space. Let’s begin with 2D space<a id="_idTextAnchor455" class="pcalibre pcalibre1 calibre6"/>.</p>
<h2 id="_idParaDest-266" class="calibre7"><a id="_idTextAnchor456" class="pcalibre pcalibre1 calibre6"/>2D World Space status indicators</h2>
<p class="calibre3">For this example, we will start a new scene. For you to not have to build out the scene, we will start with an Asset package that includes all <a id="_idIndexMarker973" class="pcalibre pcalibre1 calibre6"/>the required items.</p>
<p class="calibre3">We’ll create UI that allows a character to have a status indicator pop up above his head. After the scene has played for 3 seconds, a status-indicating button will appear over the character’s head. Once the player clicks on the status indicator, a dialog will appear. After 5 seconds, the dialog will disappear. The status indicator will re-appear 10 seconds later.</p>
<div><div><img alt="Figure 16.13: 2D World Space UI example" src="img/B18327_16_13.jpg" class="calibre558"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.13: 2D World Space UI example</p>
<p class="calibre3">The art used in this example was accessed from <a href="https://opengameart.org/content/medieval-rts-120" class="pcalibre pcalibre1 calibre6">https://opengameart.org/content/medieval-rts-120</a>.</p>
<p class="calibre3">To create the status-indicating UI demonstrated by the previous example, complete the following steps:</p>
<ol class="calibre13">
<li class="calibre14">Import the <code>Chapter 16</code><code> - Example 1-Start.unitypackage</code> package. This package contains a scene with a background image and a 2D sprite named <code>Mage</code>. The <code>Assets/Scripts/MageInteractions.cs</code> script included with the package controls the timers on the appearance of the status indicator. This script requires two Canvas Group items—<code>theExclamationPoint</code> and <code>theDialogBox</code>—and contains a function, <code>ShowTheDialogBox()</code>, that can be called via a button’s <code>On </code><code>Click()</code> event.</li>
<li class="calibre14">We want the status indicator<a id="_idIndexMarker974" class="pcalibre pcalibre1 calibre6"/> and the dialog to be tied to the position of the <code>Mage</code> within the scene. Therefore, we will create a Canvas that is a child of the <code>Mage</code> in <code>Mage</code> in the Hierarchy and add a UI Canvas as a child of the <code>Mage</code>.</p></li>
<li class="calibre14">Select the newly created <code>Canvas</code>. Change the <strong class="bold">Render Mode</strong> on the <strong class="bold">Canvas</strong> component to <strong class="bold">World Space</strong>.</li>
<li class="calibre14">Assign the <code>Main Camera</code> to the <strong class="bold">Event </strong><strong class="bold">Camera</strong> slot.</li>
<li class="calibre14">Since this <code>Canvas</code> is a child of <code>Mage</code>, its coordinate system is relative to the <code>Mage</code>. To have it perfectly positioned over the <code>Mage</code>, change the <code>0</code>.</li>
<li class="calibre14">The <code>Canvas</code> is significantly bigger than the <code>Mage</code>. Make the size more reasonable by changing the <code>1</code>.</li>
<li class="calibre14">Now that we have the <code>Canvas</code> scaled and positioned in the scene around the <code>Mage</code>, we can add UI elements to it. Right-click on <code>Canvas</code> in the Hierarchy and create a UI Button. Name the new Button <code>Alert</code>.</li>
<li class="calibre14">Resize <code>Alert</code> to match the <code>Canvas</code> by setting its <strong class="bold">Rect Transform</strong> component’s stretch and anchor to stretch fully across the Canvas.</li>
<li class="calibre14">Change the <code>Alert</code> Button’s <code>Knob</code> image. It looks better as a circle than as the default button sprite:</li>
</ol>
<div><div><img alt="Figure 16.14: Selecting the UI Knob image" src="img/B18327_16_14.jpg" class="calibre559"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.14: Selecting the UI Knob image</p>
<ol class="calibre13">
<li value="10" class="calibre14">Change the <code>Text</code> child of <code>Alert</code> to display an exclamation point instead of <code>Button</code>.</li>
<li class="calibre14">The Button’s text is not <a id="_idIndexMarker975" class="pcalibre pcalibre1 calibre6"/>currently visible. To fix this, change the <code>1000</code>.</li>
<li class="calibre14">Move the <code>Alert</code> Button so that it is positioned over the <code>Mage</code>’s head.</li>
</ol>
<div><div><img alt="Figure 16.15: Moving the exclamation point over the Mage’s head" src="img/B18327_16_15.jpg" class="calibre560"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.15: Moving the exclamation point over the Mage’s head</p>
<ol class="calibre13">
<li value="13" class="calibre14">Add a <code>Alert</code> Button.</li>
<li class="calibre14">Set the <code>0</code> and set both the <code>False</code>.</li>
<li class="calibre14">Give the <code>Alert</code> Button an <code>ShowTheDialogBox()</code> function <a id="_idIndexMarker976" class="pcalibre pcalibre1 calibre6"/>on the <code>MageInteractions</code> script attached to the <code>Mage</code>:</li>
</ol>
<div><div><img alt="Figure 16.16: The On Click() event of the Alert Button" src="img/B18327_16_16.jpg" class="calibre561"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.16: The On Click() event of the Alert Button</p>
<ol class="calibre13">
<li value="16" class="calibre14">Right-click on <code>Canvas</code> in the Hierarchy and create a UI Text object. Name the new Text object <code>Dialog</code>.</li>
<li class="calibre14">Resize the <code>Dialog</code> object to match the <code>Canvas</code> by setting its <code>Canvas</code>.</li>
<li class="calibre14">Change the <code>Dialog</code> object to say <code>Thanks!!!</code>. Also, center-align the text and set the <strong class="bold">Horizontal Overflow</strong> property to <strong class="bold">Overflow</strong>.</li>
<li class="calibre14">Move the <code>Dialog</code> object so<a id="_idIndexMarker977" class="pcalibre pcalibre1 calibre6"/> that it is positioned above the head of the <code>Mage</code>, like so:</li>
</ol>
<div><div><img alt="Figure 16.17: The Dialog box" src="img/B18327_16_17.jpg" class="calibre562"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.17: The Dialog box</p>
<ol class="calibre13">
<li value="20" class="calibre14">Add a <code>Dialog</code> Text object.</li>
<li class="calibre14">Set the <code>0</code> and set both the <code>False</code>.</li>
<li class="calibre14">Select the <code>Mage</code> and add <code>Alert</code> to the <code>Dialog</code> to the <strong class="bold">The Dialog </strong><strong class="bold">Box</strong> property.</li>
</ol>
<p class="calibre3">If you play the game, you’ll see the exclamation point Button appear after 3 seconds. Clicking on the Button will make the Text appear. Try moving the Mage character around in the scene. You’ll see that no matter where he is, the exclamation point Button and Text appear over his head. This is a really helpful technique for creating UI elements that stay with moving characters.</p>
<p class="calibre3">I know that the example is a bit boring the way it is now, but I recommend using some of the techniques discussed in the previous two chapters to add a nice bouncy animation to the exclamation point <a id="_idIndexMarker978" class="pcalibre pcalibre1 calibre6"/>and have the Text fade in and ou<a id="_idTextAnchor457" class="pcalibre pcalibre1 calibre6"/>t.</p>
<h2 id="_idParaDest-267" class="calibre7"><a id="_idTextAnchor458" class="pcalibre pcalibre1 calibre6"/>3D hovering health bars</h2>
<p class="calibre3">Making World Space UI in a 3D scene takes a little <a id="_idIndexMarker979" class="pcalibre pcalibre1 calibre6"/>more work than making World Space UI in a 2D scene if the camera can be rotated and moved throughout the 3D space. If the camera can move and rotate, the UI likely needs to constantly <em class="italic">face</em> the camera. Otherwise, the player will not be able to see the UI elements.</p>
<p class="calibre3">For this example, we will once again create a new scene. For you to not have to build the scene from scratch, we will start with an Asset package that includes all the required items.</p>
<p class="calibre3">We’ll create a simple hovering health bar that constantly faces the camera. It will also receive clicks so that we can watch the health bar reduce:</p>
<div><div><img alt="Figure 16.18: Astronaut with a hovering health bar" src="img/B18327_16_18.jpg" class="calibre563"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.18: Astronaut with a hovering health bar</p>
<p class="calibre3">The art used in this example was accessed from <a href="https://opengameart.org/content/space-kit" class="pcalibre pcalibre1 calibre6">https://opengameart.org/content/space-kit</a>.</p>
<p class="calibre3">To create a health bar that always faces the camera and receives player-click input, complete the following steps:</p>
<ol class="calibre13">
<li class="calibre14">Import the <code>Chapter 16</code><code> – Example 2 - Start.unitypackage</code> package. This package contains a scene with a 3D character facing the camera. The camera has a simple <code>RotatingCamera</code> script attached to it that rotates the camera around the astronaut with the mouse. The package also contains a <code>ReduceHealth</code> script that is attached to the <code>astronaut</code> character. This script has a function, <code>ReduceHealthBar</code>, that we will call when the health bar above the character’s head is clicked on.</li>
<li class="calibre14">We want the health bar to be tied to the position of the astronaut within the scene. Therefore, we will <a id="_idIndexMarker980" class="pcalibre pcalibre1 calibre6"/>create a Canvas that is a child of the astronaut in World Space.<p class="calibre3">Right-click on the <code>astronaut</code> in the Hierarchy and add a UI Canvas as a child of the <code>astronaut</code>.</p></li>
<li class="calibre14">Select the newly created <code>Canvas</code> and change the <strong class="bold">Render Mode</strong> on the <strong class="bold">Canvas</strong> component to <strong class="bold">World Space</strong>.</li>
<li class="calibre14">Assign the <code>Camera</code> to the <strong class="bold">Event </strong><strong class="bold">Camera</strong> slot.</li>
<li class="calibre14">Since this <code>Canvas</code> is a child of <code>astronaut</code>, its coordinate system is relative to <code>astronaut</code>. To have it perfectly positioned over the <code>astronaut</code>, change the <code>0</code>.</li>
<li class="calibre14">The <code>Canvas</code> is significantly bigger than the <code>astronaut</code>. Make the size more reasonable by changing the <code>10</code> and the <code>1</code>.</li>
<li class="calibre14">Position the Canvas so that it is above the head of the astronaut:</li>
</ol>
<div><div><img alt="Figure 16.19: Scaling the Canvas over the astronaut" src="img/B18327_16_19.jpg" class="calibre564"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.19: Scaling the Canvas over the astronaut</p>
<ol class="calibre13">
<li value="8" class="calibre14">Now that we have the <code>Canvas</code> scaled and<a id="_idIndexMarker981" class="pcalibre pcalibre1 calibre6"/> positioned in the scene around the astronaut, we can add UI elements to it. Right-click on <code>Canvas</code> in the Hierarchy and create a UI Button. Name the new button <code>Health Bar</code>.</li>
<li class="calibre14">Resize the <code>Health Bar</code> to match the <code>Canvas</code> by setting its <code>Canvas</code>.</li>
<li class="calibre14">Change the <code>Health Bar</code> to <strong class="bold">None</strong> to give it a white rectangle as an image.</li>
</ol>
<div><div><img alt="Figure 16.20: Adding a blank image to the Button" src="img/B18327_16_20.jpg" class="calibre565"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.20: Adding a blank image to the Button</p>
<ol class="calibre13">
<li value="11" class="calibre14">Change the <code>Text</code> child of <code>Health Bar</code> to say <code>Click to reduce </code><code>my health</code>.</li>
<li class="calibre14">Set both the <code>Text</code> child to <strong class="bold">Overflow</strong>. This will allow you to see the size the text is currently<a id="_idIndexMarker982" class="pcalibre pcalibre1 calibre6"/> rendering at in the scene:</li>
</ol>
<div><div><img alt="Figure 16.21: The oversized text of the Health Bar" src="img/B18327_16_21.jpg" class="calibre566"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.21: The oversized text of the Health Bar</p>
<ol class="calibre13">
<li value="13" class="calibre14">Set the <code>10</code> and deselect <strong class="bold">Raycast Target</strong> on the <strong class="bold">Text</strong> component.</li>
<li class="calibre14">Select the <code>Canvas</code> and hover over the <strong class="bold">Dynamic Pixels Per Unit</strong> property in the <strong class="bold">Canvas Scaler</strong> component until you see two arrows appear around your mouse cursor. Once you see those arrows, click, and drag to the right. This makes the property work like a slider, allowing<a id="_idIndexMarker983" class="pcalibre pcalibre1 calibre6"/> you to see how increasing the <strong class="bold">Dynamic Pixels Per Unit</strong> property continuously changes the way the text renders in the scene. Do this until the text fits within the Canvas:</li>
</ol>
<div><div><img alt="Figure 16.22: The oversized text of the Health Bar" src="img/B18327_16_22.jpg" class="calibre567"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.22: The oversized text of the Health Bar</p>
<p class="callout-heading">Note</p>
<p class="callout">When trying to get the text to look nice in 3D space, if only changing the <strong class="bold">Dynamic Pixels Per Unit Size</strong> results in <em class="italic">choppy</em> text, change the property until the text looks perfectly crisp in the scene. Then, use a combination of changing the <strong class="bold">Rect Transform</strong> component’s <strong class="bold">Scale</strong> and <strong class="bold">Font Size</strong> of the Text object to find the <em class="italic">sweet spot</em>.</p>
<ol class="calibre13">
<li value="15" class="calibre14">Right-click on the <code>Health Bar</code> Button and add a UI Image as a child. Name the new Image <code>Health Fill</code>.</li>
<li class="calibre14">Resize <code>Health Fill</code> to match the Canvas <code>Health Bar</code> by setting its <code>Health Bar</code>.</li>
<li class="calibre14">Now, change the anchor and <a id="_idIndexMarker984" class="pcalibre pcalibre1 calibre6"/>pivot to <strong class="bold">left</strong> <strong class="bold">stretch</strong> so that it will scale <em class="italic">leftward</em>.</li>
</ol>
<div><div><img alt="Figure 16.23: Left-stretching anchor" src="img/B18327_16_23.jpg" class="calibre568"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.23: Left-stretching anchor</p>
<ol class="calibre13">
<li value="18" class="calibre14">Reposition the <code>Health Bar</code> in the Hierarchy so that it is above <code>Text</code>. This will have the fill render behind the <code>Text</code> object.</li>
</ol>
<div><div><img alt="Figure 16.24: The Hierarchy of GameObjects" src="img/B18327_16_24.jpg" class="calibre569"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.24: The Hierarchy of GameObjects</p>
<ol class="calibre13">
<li value="19" class="calibre14">On the <code>Health Fill</code>, change the <strong class="bold">Color</strong> property to red and deselect the <strong class="bold">Raycast </strong><strong class="bold">Target</strong> property.</li>
<li class="calibre14">Select the astronaut and<a id="_idIndexMarker985" class="pcalibre pcalibre1 calibre6"/> assign the <code>Health Fill</code> object to the <code>ReduceHealth</code> component.</li>
<li class="calibre14">Add an <code>Health Bar</code> Button that calls the <code>ReduceHealthBar</code> function of the <code>ReduceHealth</code> script on the astronaut:
<div><div><img alt="Figure 16.25: The OnClick() event of the Health Bar" src="img/B18327_16_25.jpg" class="calibre570"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.25: The OnClick() event of the Health Bar</p>
<p class="calibre3">Playing the game now should result in the <code>Health Fill</code> reducing its fill value when you click on the <code>Health </code><code>Bar</code> Button:</p>
<div><div><img alt="Figure 16.26: The Health Bar button reducing" src="img/B18327_16_26.jpg" class="calibre571"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 16.26: The Health Bar button reducing</p></li>
</ol>
<ol class="calibre13">
<li value="22" class="calibre14">Now, we just need to add a billboard effect to the <code>Canvas</code>. Create a new script called <code>BillboardPlane</code> in the <code>Assets/Scripts</code> folder.</li>
<li class="calibre14">Change the script of the <code>BillboardPlane</code> class to the following:<pre class="source-code">
public Camera theCamera;
void Update()
{
    transform.LookAt(2 * transform.position - theCamera.transform.position);
}</pre></li> <li class="calibre14">Attach the <code>BillboardPlane</code> script to the Canvas.</li>
<li class="calibre14">Assign the <code>Camera</code> to the <code>BillboardPlane</code> component.</li>
</ol>
<p class="calibre3">If you play the game now, you’ll see <a id="_idIndexMarker986" class="pcalibre pcalibre1 calibre6"/>that as you move the camera around, the health bar always faces the <code>Camera</code>. Try changing the <code>LookAt()</code> function work more drastically<a id="_idTextAnchor459" class="pcalibre pcalibre1 calibre6"/>.</p>
<h1 id="_idParaDest-268" class="calibre5"><a id="_idTextAnchor460" class="pcalibre pcalibre1 calibre6"/>Summary</h1>
<p class="calibre3"><strong class="bold">World Space</strong> UI is not significantly different in its implementation than UI that renders in the Camera or Screen Space. Adding UI to your World Space gives you the ability to create cool effects and gives you more control over your UI’s position relative to objects in the scene.</p>
<p class="calibre3">In the next chapter, we will discuss how to optimize Unity UI.</p>
</div>
</div></body></html>