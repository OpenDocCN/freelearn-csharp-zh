<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">Virtual Reality and Extra Features</h1>
                </header>
            
            <article>
                
<p>In this chapter, we will cover the following topics:</p>
<ul>
<li>Saving screenshots from the game</li>
<li>Saving and loading player data – using static properties</li>
<li>Saving and loading player data – using PlayerPrefs</li>
<li>Loading game data from a text file map</li>
<li>UI Slider to change game quality settings</li>
<li>Pausing the game</li>
<li>Implementing slow motion</li>
<li>Gizmo to show the currently selected object in the scene panel</li>
<li>Editor snap-to grid drawn by Gizmo</li>
<li>Creating a VR project</li>
<li>Adding 360-degree videos to a VR project</li>
<li>Editing VR content inside a VR environment <span>–</span> the XR Editor</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Introduction</h1>
                </header>
            
            <article>
                
<p>There are too many features in Unity 2018 to all be covered in a single book. In this chapter, we will present a set of recipes illustrating VR game development in Unity, plus a range of additional Unity features that we wanted to include.</p>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">The Big picture</h1>
                </header>
            
            <article>
                
<p><span>Apart from plain text, there are three sections below will give you an idea of what this chapter is about.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Virtual reality</h1>
                </header>
            
            <article>
                
<p>VR is about presenting to the player an immersive audio-visual experience, engaging enough for them to lose themselves in exploring and interacting with the game world that has been created.</p>
<p>From one point of view, VR simply requires two cameras in order to generate the images for each eye to give that 3D effect. But effective VR needs content, UI controls, and tools to help create them. In this chapter, we will explore recipes that work with 360-degree videos, and Unity's XR Editor toolset.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Gizmos</h1>
                </header>
            
            <article>
                
<p>Gizmos are another kind of Unity editor customization. Gizmos are visual aids for game designers that are provided in the scene panel. They can be useful as setup aids (to help us know what we are doing), or for debugging (understanding why objects aren't behaving as expected).</p>
<p>Gizmos are not drawn through Editor scripts, but as part of Monobehaviours, so they only work for GameObjects in the current scene. Gizmo drawing is usually performed in two methods:</p>
<ul>
<li><kbd><span class="CodeInTextPACKT">OnDrawGizmos()</span></kbd>: This is executed every frame, for every GameObject in the hierarchy</li>
<li><kbd><span class="CodeInTextPACKT">OnDrawGizmosSelect()</span></kbd>: This is executed every frame, for just the/those GameObject(s) that are currently selected in the hierarchy</li>
</ul>
<p>Gizmo graphical drawing makes it simple to draw lines, cubes, and spheres. More complex shapes can also be drawn with meshes, and you can also display 2D image icons (located in the Project folder: <kbd>Assets</kbd> | <kbd>Gizmos</kbd>).</p>
<p>Several recipes in this chapter illustrate how Gizmos can be useful. Often, new GameObjects created from Editor Extensions will have helpful Gizmos associated with them.</p>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Saving/Loading data at runtime</h1>
                </header>
            
            <article>
                
<p><span>When loading/saving data either locally, it is important to keep in mind the data types that can be used. When writing C# code, our variables can be of any type permitted by the language, but when communicated by the web interface, or to a local storage using Unity's </span><strong><span class="KeyWordPACKT">PlayerPrefs</span></strong><span> class, we are restricted in the types of data that we can work with.</span> <span>When using the </span><strong><span class="KeyWordPACKT">PlayerPrefs</span></strong><span> class, we are limited to saving and loading integers, floats, and strings. We provide several recipes illustrating ways to save and load data at Run-Time, including the use of static variables, PlayerPrefs, and a public TextAsset containing text-format data for a 2D game level.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Saving screenshots from the game</h1>
                </header>
            
            <article>
                
<p>In this recipe, we will learn how to take in-game snapshots, and save them in an external file. Better yet, we will make it possible to choose between three different methods.</p>
<p>This technique only works in the Unity<span> </span><span class="packt_screen"><span class="ScreenTextPACKT">Editor</span></span>, or when you build to a<span> </span><strong>standalone</strong><span> </span>Windows or Mac executable (it will not work for Web Player builds, for example):</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/c7a5b736-647a-4670-b147-d9761244cf2e.png" style="width:36.83em;height:10.92em;"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>To follow this recipe, please import the screenshots package, which is available in the<span> </span><kbd><span class="CodeInTextPACKT">16_01</span></kbd><span> </span>folder, to your project. The package includes a m<span class="ScreenTextPACKT">ain camera</span>, cube, and sphere—something to be able to recognize when the screenshot is taken!</p>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<p>To save the screenshots from your game, follow these steps:</p>
<ol>
<li>Create a new 3D project.</li>
<li>Import the screenshots package by choosing the following menu:<span> </span><kbd><span class="ScreenTextPACKT"><strong>Assets | Import Package | Custom Package</strong>...</span></kbd></li>
<li>Open the scene provided in the screenshots package.</li>
<li>Create a C#<span> </span><kbd><span class="ScreenTextPACKT">CaptureScreenshot</span></kbd><span> </span><span>script class </span>and add an instance object as a component to the<span> </span><span class="packt_screen">M<span class="ScreenTextPACKT">ain Camera</span></span><span class="ScreenTextPACKT">:</span></li>
</ol>
<pre style="padding-left: 60px">using System.Collections;<br/> using UnityEngine;<br/> using System.IO;<br/> <br/> public class CaptureScreenshot : MonoBehaviour {<br/>     public string prefix = "Screenshot";<br/>     public enum CaptureMethod {<br/>         SCREENSHOT_PNG,<br/>         READ_PIXELS_PNG,<br/>         READ_PIXELS_JPG<br/>     };<br/>     public CaptureMethod captureMethod = CaptureMethod.SCREENSHOT_PNG;<br/>     public int screenshotScale = 1;<br/> <br/>     // A slider from 0 to 100 from which to set JPG quality<br/>     [Range(0, 100)]<br/>     public int jpgQuality = 75;<br/> <br/>     private Texture2D texture;<br/>     string date;<br/> <br/>     void  Update () {<br/>         if (Input.GetKeyDown (KeyCode.P)){<br/>             TakeShot();<br/>         }<br/>     }<br/> <br/>     private void TakeShot() {<br/>         date = System.DateTime.Now.ToString("_d-MMM-yyyy-HH-mm-ss-f");<br/> <br/>         if (CaptureMethod.SCREENSHOT_PNG == captureMethod){<br/>             string fileExtension = ".png";<br/>             string filename = prefix + date + fileExtension;<br/>             ScreenCapture.CaptureScreenshot(filename, screenshotScale);<br/>         } else {<br/>             StartCoroutine(ReadPixels());<br/>         }<br/>     }<br/> <br/>     IEnumerator  ReadPixels () {<br/>         byte[] bytes;<br/>         yield return new WaitForEndOfFrame();<br/> <br/>         int screenWidth = Screen.width;<br/>         int screenHeight = Screen.height;<br/>         Rect screenRectangle = new Rect(0, 0, screenWidth, screenHeight);<br/>         texture = new Texture2D (screenWidth, screenHeight, TextureFormat.RGB24, false);<br/>         texture.ReadPixels(screenRectangle, 0, 0);<br/>         texture.Apply();<br/> <br/>         switch(captureMethod){<br/>             case CaptureMethod.READ_PIXELS_JPG:<br/>                 bytes = texture.EncodeToJPG(jpgQuality);<br/>                 WriteBytesToFile(bytes, ".jpg");<br/>                 break;<br/> <br/>             case CaptureMethod.READ_PIXELS_PNG:<br/>             default:<br/>                 bytes = texture.EncodeToPNG();<br/>                 WriteBytesToFile(bytes, ".png");<br/>                 break;<br/>         }<br/>     }<br/> <br/>     void WriteBytesToFile(byte[] bytes, string fileExtension) {<br/>         Destroy (texture);<br/>         string filename = prefix + date + fileExtension;<br/>         string path = Application.dataPath;<br/>         path = Path.Combine(path, "..");<br/>         path = Path.Combine(path, filename);<br/>         File.WriteAllBytes(path, bytes);<br/>     }<br/> } </pre>
<ol start="5">
<li>With the<span> </span><span class="packt_screen">M<span class="ScreenTextPACKT">ain C</span><span class="ScreenTextPACKT">amera</span></span><span> </span>selected in the<span> </span><span class="packt_screen">Hierarchy</span><span class="ScreenTextPACKT">,</span> in the<span> </span><span class="packt_screen"><span class="ScreenTextPACKT">Inspector</span></span><span> </span>access the<span> </span><span class="packt_screen"><span class="ScreenTextPACKT">CaptureScreenshot (Scripted)</span></span><span> </span>component.<span> </span><span class="ScreenTextPACKT">Set</span><span> </span><span class="packt_screen"><span class="ScreenTextPACKT">Capture Method</span></span><span> </span>as<span> </span><kbd><span class="ScreenTextPACKT">SCREENSHOT_PNG</span></kbd>. Change<span> </span><span class="ScreenTextPACKT"><span class="packt_screen">Screenshot Scale</span></span><span> </span>to<span> </span><kbd><span class="ScreenTextPACKT">2</span></kbd>.</li>
</ol>
<p style="padding-left: 60px">If you want your image file's name to start with something other than the word<span> </span><span class="packt_screen"><span class="ScreenTextPACKT">Screenshot</span></span>, then change it in the<span> </span><span class="packt_screen"><span class="ScreenTextPACKT">Prefix</span></span><span> </span>field:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/c6583298-da92-4e8c-8f3c-f324ec43468d.png" style="width:20.50em;height:8.08em;"/></div>
<ol start="6">
<li>Play the scene. A new screenshot with twice the original size will be saved in your project folder every time you press<span> </span><em>P</em>.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>For each frame the<span> </span><kbd><span class="CodeInTextPACKT">Update()</span></kbd><span> </span>methods tests whether the<span> </span><em>P</em><span> </span>key has been pressed. If pressed, the<span> </span><kbd><span class="CodeInTextPACKT">TakeShot()</span></kbd> method is invoked.</p>
<p>Method<span> </span><kbd><span class="CodeInTextPACKT">TakeShot()</span></kbd><span> </span>captures an image of the screen is and stores the image as a file in the main Unity project directory (that is, alongside the<span> </span><span class="packt_screen"><span class="ScreenTextPACKT">Assets</span></span><span> </span>and<span> </span><span class="ScreenTextPACKT"><span class="packt_screen">Library</span><span> </span><span>directories</span>, and so on</span>). The public settings of the<span> </span><span class="packt_screen"><span class="ScreenTextPACKT">CaptureScreenshot (Scripted)</span></span><span> </span>of<span> </span><span class="packt_screen"><span class="ScreenTextPACKT">MainCamera</span></span><span> </span>determine the properties of the image file created by the project.</p>
<p>The three types of screenshot image are defined as an<span> </span><span class="ScreenTextPACKT"><span class="packt_screen">enumerated type</span></span>:</p>
<ul>
<li><kbd><span class="CodeInTextPACKT">SCREENSHOT_PNG</span></kbd>: built-in Unity function<span> </span><kbd><span class="CodeInTextPACKT">CaptureScreenshot()</span></kbd>. This is capable of scaling the original screen size, which can be set by our Capture Scale public property.</li>
<li><kbd><span class="CodeInTextPACKT">READ_PIXELS_PNG</span></kbd>:<span> </span><kbd><span class="CodeInTextPACKT">ReadPixels()</span></kbd><span> </span>function used, encoded to PNG.</li>
<li><kbd><span class="CodeInTextPACKT">READ_PIXELS_JPG</span></kbd>:<span> </span><kbd><span class="CodeInTextPACKT">ReadPixels()</span></kbd><span> </span>function used, encoded to JPG.</li>
</ul>
<p>The image data captured by the ReadPixels function is written to file by the built-in Unity function<span> </span><kbd><span class="CodeInTextPACKT">WriteAllBytes()</span></kbd><span> </span>in our<span> </span><kbd><span class="CodeInTextPACKT">WriteBytesToFile(...)</span></kbd><span> </span>method.</p>
<p>In all cases, the file created will have the appropriate<span> </span><em>.png</em><span> </span>or<span> </span><em>.jpg</em><span> </span>file extension, to match its image file format.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">There's more...</h1>
                </header>
            
            <article>
                
<p>We have included the options using the<span> </span><kbd><span class="CodeInTextPACKT">ReadPixel</span></kbd><span> </span>function as a demonstration of how to save your images to a disk without using Unity's<span> </span><kbd><span class="ScreenTextPACKT">CaptureScreenshot()</span></kbd><span> </span>function. One advantage of this method is that it can be adapted to capture and save only a portion of the screen—if a different-sized rectangle is defined.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Saving and loading player data – using static properties</h1>
                </header>
            
            <article>
                
<p>Keeping track of the player's progress and user settings during a game is vital to give your game a greater feeling of depth and content. In this recipe, we will learn how to make our game remember the player's score between the different levels (scenes).</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>We have included a complete project in a Unity package named<span> </span><span class="ScreenTextPACKT"><span class="packt_screen">game_HigherOrLower</span></span><span> </span>in the<span> </span><kbd><span class="ScreenTextPACKT">16_02</span></kbd><span> </span>folder. To follow this recipe, we will import this package as the starting point.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<p>To save and load player data, follow these steps:</p>
<ol>
<li>Create a new 2D project and import the<span> </span><span class="packt_screen"><span class="ScreenTextPACKT">game_HigherOrLower</span></span><span> </span>package.</li>
<li>Add each of the scenes to the build in the sequence (<span class="ScreenTextPACKT"><span class="packt_screen">scene0_mainMenu</span></span>, then<span> </span><span class="packt_screen"><span class="ScreenTextPACKT">scene1_gamePlaying</span></span>, and so on).</li>
<li>Make yourself familiar with the game by playing it a few times and examining the content of the scenes. The game starts on the<span> </span><span class="packt_screen"><span class="ScreenTextPACKT">scene0_mainMenu</span></span><span> </span>scene, inside the<span> </span><kbd><span class="ScreenTextPACKT">Scenes</span></kbd><span> </span>folder.</li>
</ol>
<ol start="4">
<li>Let's create a class to store the number of correct and incorrect guesses made by the user. Create a new C# script called<span> </span><kbd><span class="ScreenTextPACKT">Player</span></kbd><span> </span>with the following code:</li>
</ol>
<pre style="padding-left: 60px">using UnityEngine;<br/> <br/> public class Player : MonoBehaviour {<br/>   public static int scoreCorrect = 0;<br/>   public static int scoreIncorrect = 0;<br/> } </pre>
<ol start="5">
<li>In the lower-left corner of the<span> </span><span class="packt_screen"><span class="ScreenTextPACKT">scene0_mainMenu</span></span><span> </span>scene, create a<span> </span><span class="ScreenTextPACKT"><span class="packt_screen">UI Text GameObject</span></span><span> </span>named<span> </span><span class="packt_screen"><span class="ScreenTextPACKT">Text</span><span> </span><span class="ScreenTextPACKT">- score</span></span>, containing the placeholder text<span> </span><span class="ScreenTextPACKT"><span class="packt_screen">Score: 99 / 99</span></span>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/d166200b-9a58-4460-9fd0-4050c3345e43.png" style="width:24.92em;height:11.25em;"/></div>
<ol start="6">
<li>Next, attach the following C# script to the <span class="ScreenTextPACKT"><span class="packt_screen">UI GameObject Text</span></span>—score:</li>
</ol>
<pre style="padding-left: 60px">using UnityEngine;<br/> using System.Collections;<br/> <br/> using UnityEngine.UI;<br/> <br/> public class UpdateScoreText : MonoBehaviour {<br/>   void Start(){<br/>     Text scoreText = GetComponent&lt;Text&gt;();<br/>     int totalAttempts = Player.scoreCorrect + Player.scoreIncorrect;<br/>     string scoreMessage = "Score = ";<br/>     scoreMessage += Player.scoreCorrect + " / " + totalAttempts;<br/> <br/>     scoreText.text = scoreMessage;<br/>   }<br/> } </pre>
<ol start="7">
<li>In the<span> </span><kbd>scene2_gameWon</kbd><span> </span>scene, attach the following C# script to the<span> </span><span class="ScreenTextPACKT"><span class="packt_screen">Main Camera</span></span>:</li>
</ol>
<pre style="padding-left: 60px">using UnityEngine;<br/> <br/> public class IncrementCorrectScore : MonoBehaviour {<br/>   void Start () {<br/>     Player.scoreCorrect++;<br/>   }<br/> } </pre>
<ol start="8">
<li>In the<span> </span><kbd>scene3_gameLost</kbd><span> </span>scene, attach the following C# script to the<span> </span><span class="packt_screen"><span class="ScreenTextPACKT">Main Camera</span></span>:</li>
</ol>
<pre style="padding-left: 60px">using UnityEngine;<br/> <br/> public class IncrementIncorrectScore : MonoBehaviour {<br/>   void Start () {<br/>     Player.scoreIncorrect++;<br/>   }<br/> } </pre>
<ol start="9">
<li>Save your scripts, and play the game. As you progress from level (scene) to level, you will find that the score and the player's name are remembered, until you quit the application.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>The Player class uses static (class) properties<span> </span><kbd><span class="CodeInTextPACKT">scoreCorrect</span></kbd><span> </span>and<span> </span><kbd><span class="CodeInTextPACKT">scoreIncorrect</span></kbd><span> </span>to store the current total number of correct and incorrect guesses. Since these are public static properties, any object from any scene can access (set or get) these values, since the static properties are remembered from scene to scene. This class also provides the public static method called<span> </span><kbd><span class="CodeInTextPACKT">ZeroTotals()</span></kbd><span> </span>that resets both the values to zero.</p>
<p>When the<span> </span><span class="ScreenTextPACKT"><span class="packt_screen">scene0_mainMenu</span></span><span> </span>scene is loaded, all the<span> </span><kbd><span class="ScreenTextPACKT">GameObjects</span></kbd><span> </span>with scripts will have their<span> </span><kbd><span class="CodeInTextPACKT">Start()</span></kbd><span> </span>methods executed. The<span> </span><span class="ScreenTextPACKT"><span class="packt_screen">UI Text GameObject</span></span><span> </span>called<span> </span><span class="packt_screen">T<span class="ScreenTextPACKT">ext-score</span></span><span> </span>has an instance of the<span> </span><kbd><span class="CodeInTextPACKT">UpdateScoreText</span></kbd><span> </span>class as s script component, so that the scripts<span> </span><kbd><span class="CodeInTextPACKT">Start()</span></kbd><span> </span>method will be executed, which retrieves the correct and incorrect totals from the<span> </span><span class="packt_screen"><span class="ScreenTextPACKT">Player</span></span><span> </span>class, creates the<span> </span><kbd><span class="CodeInTextPACKT">scoreMessage</span></kbd><span> </span>string about the current score, and updates the text property so that the user sees the current score.</p>
<p>When the game is running and the user guesses correctly (higher), then the<span> </span><span class="ScreenTextPACKT"><span class="packt_screen">scene2_gameWon</span></span><span> </span>scene is loaded. So, the<span> </span><kbd><span class="CodeInTextPACKT">Start()</span></kbd><span> </span>method, of the<span> </span><kbd><span class="ScreenTextPACKT">IncrementCorrectScore</span></kbd><span> </span>script component, of the<span> </span><span class="packt_screen">M<span class="ScreenTextPACKT">ain Camera</span></span><span> </span>in this scene is executed, which adds 1 to the<span> </span><kbd><span class="CodeInTextPACKT">scoreCorrect</span></kbd><span> </span>variable of the<span> </span><kbd><span class="ScreenTextPACKT">Player</span></kbd><span> </span>class.</p>
<p>When the game is running and the user guesses wrongly (lower), then the scene<span> </span><span class="ScreenTextPACKT"><span class="packt_screen">scene3_gameLost</span></span><span> </span>is loaded. So, the<span> </span><kbd><span class="CodeInTextPACKT">Start()</span></kbd><span> </span>method, of the<span> </span><kbd><span class="ScreenTextPACKT">IncrementIncorrectScore</span></kbd><span> </span>script component, of the<span> </span><span class="packt_screen">M<span class="ScreenTextPACKT">ain Camera</span></span><span> </span>in this scene is executed, which adds 1 to the<span> </span><kbd><span class="CodeInTextPACKT">scoreIncorrect</span></kbd><span> </span>variable of the<span> </span><kbd><span class="ScreenTextPACKT">Player</span></kbd><span> </span>class.</p>
<p>The next time the user visits the main menu scene, the new values of the correct and incorrect totals will be read from the<span> </span><kbd><span class="ScreenTextPACKT">Player</span></kbd><span> </span>class, and the<span> </span><span class="ScreenTextPACKT"><span class="packt_screen">UI Text</span></span><span> </span>on the screen will inform the user of their updated total score for the game.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">There's more...</h1>
                </header>
            
            <article>
                
<p>There are some details that you don't want to miss.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Hiding the score before the first attempt is completed</h1>
                </header>
            
            <article>
                
<p>Showing a score of zero out of zero isn't very professional. Let's add some logic so that the score is only displayed (a non-empty string) if the total number of attempts is greater than zero:</p>
<pre>void Start(){<br/>   Text scoreText = GetComponent&lt;Text&gt;();<br/>   int totalAttempts = Player.scoreCorrect + Player.scoreIncorrect;<br/> <br/>   // default is empty string<br/>   string scoreMessage = "";<br/>   if( totalAttempts &gt; 0){<br/>     scoreMessage = "Score = ";<br/>     scoreMessage += Player.scoreCorrect + " / " + totalAttempts;<br/>   }<br/> <br/>   scoreText.text = scoreMessage;<br/> } </pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">See also</h1>
                </header>
            
            <article>
                
<p>Refer to the following recipe in this chapter for more information:</p>
<ul>
<li>Saving and loading player data - using PlayerPrefs</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Saving and loading player data – using PlayerPrefs</h1>
                </header>
            
            <article>
                
<p>While the previous recipe illustrates how the static properties allow a game to remember values between different scenes, these values are forgotten once the game application has quit. Unity provides the<span> </span><kbd><span class="ScreenTextPACKT">PlayerPrefs</span></kbd><span> </span>feature to allow a game to store and retrieve data, between the different game-playing sessions:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/44b8a09b-8c00-466a-9589-7b93c8fe6902.png" style="width:23.67em;height:14.17em;"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>This recipe builds upon the previous recipe, so make a copy of that project and work on the copy.</p>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<p>To save and load the player data using<span> </span><kbd>PlayerPrefs</kbd>, follow these steps:</p>
<ol>
<li>Delete the C# script called<span> </span><kbd><span class="ScreenTextPACKT">Player</span></kbd>.</li>
<li>Edit the C# script called<span> </span><kbd><span class="ScreenTextPACKT">UpdateScoreText</span></kbd><span> </span>by replacing the<span> </span><kbd><span class="ScreenTextPACKT">Start()</span></kbd><span> </span>method<span> </span> with the following:</li>
</ol>
<pre style="padding-left: 60px">void Start(){<br/>   Text scoreText = GetComponent&lt;Text&gt;();<br/> <br/>   int scoreCorrect = PlayerPrefs.GetInt("scoreCorrect");<br/>   int scoreIncorrect = PlayerPrefs.GetInt("scoreIncorrect");<br/> <br/>   int totalAttempts = scoreCorrect + scoreIncorrect;<br/>   string scoreMessage = "Score = ";<br/>   scoreMessage += scoreCorrect + " / " + totalAttempts;<br/> <br/>   scoreText.text = scoreMessage;<br/> } </pre>
<ol start="3">
<li>Now edit the C# script called<span> </span><kbd><span class="ScreenTextPACKT">IncrementCorrectScore</span></kbd><span> </span>by replacing the<span> </span><kbd><span class="ScreenTextPACKT">Start()</span></kbd><span> </span>method with the following code:</li>
</ol>
<pre style="padding-left: 60px">void Start () {<br/>   int newScoreCorrect = 1 + PlayerPrefs.GetInt("scoreCorrect");<br/>   PlayerPrefs.SetInt("scoreCorrect", newScoreCorrect);<br/> } </pre>
<ol start="4">
<li>Now edit the C# script called<span> </span><kbd><span class="ScreenTextPACKT">IncrementIncorrectScore</span></kbd><span> </span>by replacing the<span> </span><kbd><span class="ScreenTextPACKT">Start()</span></kbd><span> </span>method with the following code:</li>
</ol>
<pre style="padding-left: 60px">void Start () {<br/>   int newScoreIncorrect = 1 + PlayerPrefs.GetInt("scoreIncorrect");<br/>   PlayerPrefs.SetInt("scoreIncorrect", newScoreIncorrect);<br/> } </pre>
<ol start="5">
<li>Save your scripts and play the game. Quit from Unity and then restart the application. You will find that the player's name, level, and score are now kept between the game sessions.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>We had no need for the Player class, since this recipe uses the built-in runtime class called<span> </span><kbd>PlayerPrefs</kbd>, provided by Unity.</p>
<p>Unity's<span> </span><kbd><span class="ScreenTextPACKT">PlayerPrefs</span></kbd><span> </span>runtime class is capable of storing and accessing information (the string, int, and float variables) in the user's machine. Values are stored in a plist file (Mac) or the registry (Windows), in a similar way to web browser cookies, and, therefore, remembered between game application sessions.</p>
<p>Values for the total correct and incorrect scores are stored by the<span> </span><kbd><span class="CodeInTextPACKT">Start()</span></kbd><span> </span>methods in the<span> </span><kbd><span class="CodeInTextPACKT">IncrementCorrectScore</span></kbd><span> </span>and<span> </span><kbd><span class="CodeInTextPACKT">IncrementIncorrectScore</span></kbd><span> </span>classes. These methods use the<span> </span><kbd><span class="CodeInTextPACKT">PlayerPrefs.GetInt("")</span></kbd><span> </span>method to retrieve the old total, add 1 to it, and then store the incremented total using the<span> </span><kbd><span class="CodeInTextPACKT">PlayerPrefs.SetInt("")</span></kbd><span> </span>method.</p>
<p>These correct and incorrect totals are then read each time the<span> </span><span class="packt_screen"><span class="ScreenTextPACKT">scene0_mainMenu</span></span><span> </span>scene is loaded, and the score totals are displayed via the<span> </span><span class="ScreenTextPACKT"><span class="packt_screen">UI Text</span></span><span> </span>object on the screen.</p>
<p>For more information on<span> </span><kbd><span class="ScreenTextPACKT">PlayerPrefs</span></kbd>, see Unity's online documentation<span> </span>at <span class="URLPACKT"><a href="http://docs.unity3d.com/ScriptReference/PlayerPrefs.html">http://docs.unity3d.com/ScriptReference/PlayerPrefs.html</a>.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">See also</h1>
                </header>
            
            <article>
                
<p>Refer to the following recipe in this chapter for more information:</p>
<ul>
<li>Saving and loading player data - using static properties</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Loading game data from a text file map</h1>
                </header>
            
            <article>
                
<p>Rather than, for every level of a game, having to create and place every<span> </span><span class="packt_screen"><span class="ScreenTextPACKT">GameObject</span></span><span> </span>on the screen by hand, a better approach can be to create the text files of rows, and columns of characters, where each character corresponds to the type of<span> </span><span class="packt_screen"><span class="ScreenTextPACKT">GameObject</span></span><span> </span>that is to be created in the corresponding location.</p>
<p class="mce-root"/>
<p class="mce-root"/>
<p>In this recipe, we'll use a text file and set of prefab sprites to display a graphical version of a text data file for a screen from the classic game,<span> </span><em>NetHack</em>:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/1ff4de70-894c-4bcf-a779-42270d17972e.png"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>In the<span> </span><kbd><span class="CodeInTextPACKT">16_04</span></kbd><span> </span>folder, we have provided the following two files for this recipe:</p>
<ul>
<li><kbd><span class="CodeInTextPACKT">level1.txt</span></kbd><span> </span>(a text file, representing a level)</li>
<li><kbd><span class="CodeInTextPACKT">absurd128.png</span></kbd><span> </span>(a 128 x 128 sprite sheet for NetHack).</li>
</ul>
<p>The level data came from the NetHack Wikipedia page, and the sprite sheet came from SourceForge:</p>
<ul>
<li><a href="http://en.wikipedia.org/wiki/NetHack"><span class="URLPACKT">http://en.wikipedia.org/wiki/NetHack</span></a></li>
<li><a href="http://sourceforge.net/projects/noegnud/files/tilesets_nethack-3.4.1/absurd%20128x128/"><span class="URLPACKT">http://sourceforge.net/projects/noegnud/files/tilesets_nethack-3.4.1/absurd%20128x128/</span></a></li>
</ul>
<p>Note that we also included a Unity package with all the prefabs set up, since this can be a laborious task.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<p>To load game data from a text file map, do the following:</p>
<ol>
<li>Import text file<span> </span><kbd><span class="ScreenTextPACKT">level1.txt</span></kbd>, and image file<span> </span><kbd><span class="ScreenTextPACKT">absurd128.png</span></kbd>.</li>
<li>Select<span> </span><kbd><span class="ScreenTextPACKT">absurd128.png</span></kbd><span> </span>in the<span> </span><span class="ScreenTextPACKT">Inspector</span>, and set<span> </span><span class="ScreenTextPACKT"><span class="packt_screen">Texture Type</span></span><span> </span>to<span> </span><span class="ScreenTextPACKT"><span class="packt_screen">Sprite (2D/uGUI)</span>,</span><span> </span>and<span> </span><span class="ScreenTextPACKT"><span class="packt_screen">Sprite Mode</span></span><span> </span>to<span> </span><span class="packt_screen"><span class="ScreenTextPACKT">Multiple</span></span>.</li>
<li>Edit this sprite in the<span> </span><span class="packt_screen"><span class="ScreenTextPACKT">Sprite Editor</span></span>, choosing<span> </span><span class="packt_screen"><span class="ScreenTextPACKT">Type</span></span><span> </span>as<span> </span><span class="packt_screen"><span class="ScreenTextPACKT">Grid</span></span><span> </span>and<span> </span><span class="ScreenTextPACKT"><span class="packt_screen">Pixel Size</span></span><span> </span>as<span> </span><span class="ScreenTextPACKT"><span class="packt_screen">128 x 128</span></span>, and apply these settings:</li>
</ol>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/66dfa1d5-50ee-4d6d-b1d3-1c1929b60936.png" style="width:36.83em;height:16.33em;"/></div>
<ol start="4">
<li>In the<span> </span><span class="packt_screen"><span class="ScreenTextPACKT">Project</span></span><span> </span>panel, click on the right-facing white triangle to explode the icon, to show all the sprites in this sprite sheet individually:</li>
</ol>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/2ded1048-60a8-4cf8-8995-c97902e90837.png" style="width:29.08em;height:14.83em;"/></div>
<ol start="5">
<li>Drag the<span> </span><span class="packt_screen"><span class="ScreenTextPACKT">Spri</span><span class="ScreenTextPACKT">te</span></span><span> </span>called<span> </span><span class="packt_screen"><span class="CodeInTextPACKT">absurd1</span><span class="CodeInTextPACKT">28_175</span></span><span> </span>on to the scene.</li>
<li>Create a new<span> </span><span class="packt_screen"><span class="ScreenTextPACKT">Prefab</span></span><span> </span>named<span> </span><kbd><span class="CodeInTextPACKT">corpse_175</span></kbd><span> </span>in the<span> </span><span class="ScreenTextPACKT">Project</span><span> </span>panel, and drag onto this blank prefab<span> </span><span class="packt_screen"><span class="ScreenTextPACKT">Sprite</span></span><span> </span><kbd><span class="CodeInTextPACKT">absurd128_175</span></kbd><span> </span>from the scene. Now delete the sprite instance from the scene. You have now created a<span> </span><span class="packt_screen">prefab</span><span> </span>containing the<span> </span><kbd><span class="ScreenTextPACKT">Sprite 175</span></kbd>.</li>
</ol>
<ol start="7">
<li>Repeat this process for the following sprites (that is, create prefabs for each one):
<ul>
<li><kbd>– floor_848</kbd></li>
<li><kbd>– corridor_849</kbd></li>
<li><kbd>– horiz_1034</kbd></li>
<li><kbd>– vert_1025</kbd></li>
<li><kbd>– door_844</kbd></li>
<li><kbd>– potion_675</kbd></li>
<li><kbd>– chest_586</kbd></li>
<li><kbd>– alter_583</kbd></li>
<li><kbd>– stairs_up_994</kbd></li>
<li><kbd>– stairs_down_993</kbd></li>
<li><kbd>– wizard_287</kbd></li>
</ul>
</li>
<li>Select the<span> </span><span class="packt_screen">M<span class="ScreenTextPACKT">ain Camera</span></span><span> </span>in the<span> </span><span class="packt_screen">Inspector</span>, and ensure that it is set to an<span> </span><span class="ScreenTextPACKT">Orthographic</span><span> </span>camera, sized<span> </span><span class="packt_screen"><span class="ScreenTextPACKT">20</span></span>, with<span> </span><span class="ScreenTextPACKT"><span class="packt_screen">Clear Flags</span></span><span> </span>as<span> </span><span class="ScreenTextPACKT"><span class="packt_screen">Solid Color</span></span><span> </span>and<span> </span><span class="packt_screen">Ba<span class="ScreenTextPACKT">ckground</span></span><span> </span>as<span> </span><span class="packt_screen"><span class="ScreenTextPACKT">Black</span></span>.</li>
<li>Attach the following C# code to the<span> </span><span class="packt_screen">M<span class="ScreenTextPACKT">ain Camera</span></span><span> </span>as the script class called<span> </span><kbd><span class="ScreenTextPACKT">LoadMapFromTextfile</span></kbd>:</li>
</ol>
<pre style="padding-left: 60px">using UnityEngine;<br/> using System.Collections;<br/> <br/> using System.Collections.Generic;<br/> <br/> public class LoadMapFromTextfile : MonoBehaviour<br/> {<br/>   public TextAsset levelDataTextFile;<br/> <br/>   public GameObject floor_848;<br/>   public GameObject corridor_849;<br/>   public GameObject horiz_1034;<br/>   public GameObject vert_1025;<br/>   public GameObject corpse_175;<br/>   public GameObject door_844;<br/>   public GameObject potion_675;<br/>   public GameObject chest_586;<br/>   public GameObject alter_583;<br/>   public GameObject stairs_up_994;<br/>   public GameObject stairs_down_993;<br/>   public GameObject wizard_287;<br/> <br/>   public Dictionary&lt;char, GameObject&gt; dictionary = new Dictionary&lt;char, GameObject&gt;();<br/> <br/>   void Awake(){<br/>     char newlineChar = '\n';<br/> <br/>     dictionary['.'] = floor_848;<br/>     dictionary['#'] = corridor_849;<br/>     dictionary['('] = chest_586;<br/>     dictionary['!'] = potion_675;<br/>     dictionary['_'] = alter_583;<br/>     dictionary['&gt;'] = stairs_down_993;<br/>     dictionary['&lt;'] = stairs_up_994;<br/>     dictionary['-'] = horiz_1034;<br/>     dictionary['|'] = vert_1025;<br/>     dictionary['+'] = door_844;<br/>     dictionary['%'] = corpse_175;<br/>     dictionary['@'] = wizard_287;<br/> <br/>     string[] stringArray = levelDataTextFile.text.Split(newlineChar);<br/>     BuildMaze( stringArray );<br/>   }<br/> <br/>   private void BuildMaze(string[] stringArray){<br/>     int numRows = stringArray.Length;<br/> <br/>     float yOffset = (numRows / 2);<br/> <br/>     for(int row=0; row &lt; numRows; row++){<br/>       string currentRowString = stringArray[row];<br/>       float y = -1 * (row - yOffset);<br/>       CreateRow(currentRowString, y);<br/>     }<br/>   }<br/> <br/>   private void CreateRow(string currentRowString, float y) {<br/>     int numChars = currentRowString.Length;<br/>     float xOffset = (numChars/2);<br/> <br/>     for(int charPos = 0; charPos &lt; numChars; charPos++){<br/>       float x = (charPos - xOffset);<br/>       char prefabCharacter = currentRowString[charPos];<br/> <br/>       if (dictionary.ContainsKey(prefabCharacter)){<br/>         CreatePrefabInstance( dictionary[prefabCharacter], x, y);<br/>       }<br/>     }<br/>   }<br/> <br/>   private void CreatePrefabInstance(GameObject objectPrefab, float x, float y){<br/>     float z = 0;<br/>     Vector3 position = new Vector3(x, y, z);<br/>     Quaternion noRotation = Quaternion.identity;<br/>     Instantiate (objectPrefab, position, noRotation);<br/>   }<br/> } </pre>
<ol start="10">
<li>With the<span> </span><span class="packt_screen">M<span class="ScreenTextPACKT">ai</span><span class="ScreenTextPACKT">n Camera</span></span><span> </span>selected, drag the appropriate prefabs on to the prefabs slots in the<span> </span><span class="packt_screen"><span class="ScreenTextPACKT">Inspector</span></span>, for the<span> </span><kbd><span class="ScreenTextPACKT">LoadMapFromTextfile</span></kbd><span> </span>Script component.</li>
<li>When you run the scene, you will see that a sprite-based Nethack map will appear, using your prefabs.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>The Sprite sheet was automatically sliced up into hundreds of 128 x 128 pixel<span> </span><span class="ScreenTextPACKT">Sprite</span><span> </span>squares. We created the prefab objects from some of these sprites so that the copies can be created at runtime when needed.</p>
<p>The text file called<span> </span><kbd><span class="CodeInTextPACKT">level1.txt</span></kbd><span> </span>contains the lines of text characters. Each non-space character represents where a sprite prefab should be instantiated (column =<span> </span><em>x</em>; row = y). A C# dictionary variable named<span> </span><em>dictionary</em><span> </span>is declared and initialized in the<span> </span><kbd><span class="CodeInTextPACKT">Start()</span></kbd><span> </span>method to associate the specific prefab<span> </span><span class="packt_screen"><span class="ScreenTextPACKT">GameObjects</span></span><span> </span>with some particular characters in the text file.</p>
<p>The<span> </span><kbd><span class="CodeInTextPACKT">Awake()</span></kbd><span> </span>method splits the string into an array using the newline character as a separator. So, now, we have<span> </span><kbd><span class="CodeInTextPACKT">stringArray</span></kbd><span> </span>with an entry for each row of the text data.<span> </span> The<span> </span><kbd><span class="CodeInTextPACKT">BuildMaze(...)</span></kbd><span> </span>method is called with the<span> </span><kbd><span class="CodeInTextPACKT">stringArray</span></kbd>.</p>
<p>The<span> </span><kbd><span class="CodeInTextPACKT">BuildMaze(...)</span></kbd><span> </span>method interrogates the array to find its length (the number of rows of data for this level), and sets<span> </span><kbd><span class="CodeInTextPACKT">yOffSet</span></kbd><span> </span>to half this value. This is done to allow the placing of the prefabs half above<span> </span><em>y</em><span> </span>= 0, and half below, so (0,0,0) is the center of the level map. A for-loop is used to read each row's string from the array. It passes it to the<span> </span><kbd><span class="CodeInTextPACKT">CreateRow(...)</span></kbd><span> </span>method along with the<span> </span><em>y</em>-value corresponding to the current row.</p>
<p>The<span> </span><kbd><span class="CodeInTextPACKT">CreateRow(...)</span></kbd><span> </span>method extracts the length of the string, and sets<span> </span><kbd><span class="CodeInTextPACKT">xOffSet</span></kbd><span> </span>to half this value. This is done to allow the placing of the prefabs half to the left of<span> </span><em>x</em><span> </span>= 0 and half to the right, so (0,0,0) is the center of the level map. A<span> </span><span class="ScreenTextPACKT"><span class="packt_screen">for-loop</span></span><span> </span>is used to read each character from the current row's string, and (if there is an entry in our dictionary for that character) then the<span> </span><kbd><span class="CodeInTextPACKT">CreatePrefabInstance (...)</span></kbd><span> </span>method is called, passing the prefab reference in the dictionary for that character, and the<span> </span><em>x</em><span> </span>and<span> </span><em>y</em><span> </span>value.</p>
<p>The<span> </span><span class="CodeInTextPACKT">CreatePrefabInstance(...)</span><span> </span>method instantiates the given prefab at a position of<span> </span><em>x, y, z,</em> where<span> </span><em>z</em><span> </span>is always zero, and there is no rotation (<kbd><span class="CodeInTextPACKT">Quarternion.identity</span></kbd>).</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">UI Slider to change game quality settings</h1>
                </header>
            
            <article>
                
<p>In this recipe, we will show you how the player can control the quality settings by providing a <span class="ScreenTextPACKT"><span class="packt_screen">UI Slider</span></span> for the player. From this, they can choose from an array of possible quality settings for the current project:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/7317d68b-1e05-4c46-bc2d-ad9db6ded1df.png"/></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>For this recipe, we have prepared a package named <kbd><span class="ScreenTextPACKT">BallGame</span></kbd> containing two <span class="KeyWordPACKT">scenes</span>. The package is in the <kbd>16_05</kbd> folder.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<p>To create a player UI to change the game's quality settings, do the following:</p>
<ol>
<li>Create a new 3D project and import the <kbd><span class="ScreenTextPACKT">BallGame</span></kbd> package.</li>
<li>Open the scene named <kbd><span class="ScreenTextPACKT">scene0_ballCourt</span></kbd>.</li>
</ol>
<ol start="3">
<li>In the scene, create a new <span class="ScreenTextPACKT"><span class="packt_screen">UI Panel</span></span> named <kbd><span class="ScreenTextPACKT">Panel-quality</span></kbd> by choosing menu: <span class="packt_screen"><span class="ScreenTextPACKT">Create |</span> <span class="ScreenTextPACKT">UI | Panel</span></span>.</li>
<li>With the GameObject <span class="ScreenTextPACKT"><span class="packt_screen">Panel-quality</span></span> selected in the <span class="KeyWordPACKT">Hierarchy</span>, create a new <span class="ScreenTextPACKT">UI Slider</span> named <span class="ScreenTextPACKT"><span class="packt_screen">Slider-quality</span> </span>by choosing menu: <span class="ScreenTextPACKT"><span class="packt_screen">Create | UI | Slider</span></span>. This GameObject should be childed to <span class="ScreenTextPACKT"><span class="packt_screen">Panel-quality</span></span>.</li>
<li>With <span class="ScreenTextPACKT"><span class="packt_screen">Panel-quality</span></span> selected in the <span class="KeyWordPACKT">Hierarchy</span>, create a new <span class="ScreenTextPACKT">UI Text</span> GameObject named <span class="ScreenTextPACKT">Text-quality</span> by choosing menu: <span class="ScreenTextPACKT"><span class="packt_screen">Create | UI | Text</span></span>. This GameObject should be childed to GameObject <span class="ScreenTextPACKT"><span class="packt_screen">Panel-quality</span></span>. In the <span class="KeyWordPACKT"><strong>Inspector</strong>,</span> set its <span class="ScreenTextPACKT">Transform Position</span> Y value to <span class="packt_screen">-25</span>.</li>
<li>Create a new C# script class named <kbd><span class="ScreenTextPACKT">QualityChooser</span></kbd>, and attach an instance object as a component to the <span class="ScreenTextPACKT"><span class="packt_screen">First Person Controller</span></span>:</li>
</ol>
<pre>    using UnityEngine;<br/>     using UnityEngine.UI;<br/>     using System.Collections;<br/> <br/>     public class QualityChooser : MonoBehaviour {<br/>         public GameObject panelGo;<br/>         public Slider slider;<br/>         public Text textLabel;<br/> <br/>         void Awake () {<br/>             slider.maxValue = QualitySettings.names.Length - 1;<br/>             slider.value = QualitySettings.GetQualityLevel();<br/>             SetQualitySliderActive(true);<br/>         }<br/> <br/>         public void SetQualitySliderActive(bool active) {<br/>             Cursor.visible = active;<br/>             panelGo.SetActive(active);<br/>         }<br/> <br/>         public void UpdateQuality(float sliderFloat) {<br/>             int qualityInt = Mathf.RoundToInt (sliderFloat);<br/>             QualitySettings.SetQualityLevel (qualityInt);<br/>             textLabel.text = QualitySettings.names [qualityInt];<br/>         }<br/>     } </pre>
<ol start="7">
<li>In the <strong><span class="KeyWordPACKT">Hierarchy,</span></strong> select the <span class="ScreenTextPACKT"><span class="packt_screen">First Person Controller</span></span>. Then, from the <strong>Inspector</strong>, access the Quality Chooser component, and populate the <span class="ScreenTextPACKT"><span class="packt_screen">panelGo</span></span>, Slide, and Text Label public fields with the UI GameObjects <span class="ScreenTextPACKT"><span class="packt_screen">Panel-quality</span></span>, <span class="ScreenTextPACKT"><span class="packt_screen">Slider</span>,</span> and <span class="ScreenTextPACKT"><span class="packt_screen">Text</span>:</span></li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/877bda8e-a671-4a58-be55-82c660062529.png"/></p>
<ol start="8">
<li>From the <strong><span class="KeyWordPACKT">Hierarc</span><span class="KeyWordPACKT">hy</span></strong> panel, select <span class="ScreenTextPACKT"><span class="packt_screen">S<span class="packt_screen">l</span>ider</span></span>. Then, from the <strong><span class="KeyWordPACKT">Inspector</span>,</strong> for the <span class="ScreenTextPACKT"><span class="packt_screen">Slider</span></span> component, find the list named <span class="ScreenTextPACKT"><span class="packt_screen">On Value Changed (Single)</span></span>, and click on the <span class="packt_screen">+</span> sign to add a command.</li>
<li>Drag the <span class="ScreenTextPACKT"><span class="packt_screen">First Person Controller</span></span> from the <strong><span class="KeyWordPACKT">Hierarchy</span></strong> into the <strong><span class="ScreenTextPACKT">Game Object</span></strong> field of the new command. Then, use the function selector to find the <span class="ScreenTextPACKT">UpdateQuality</span> function in the <span class="ScreenTextPACKT">Dynamic float</span> section (<span class="ScreenTextPACKT"><span class="packt_screen">No Function | QualityChooser | Dynamic float | UpdateQuality</span></span>):</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/37dddf3e-3e1c-497d-afea-7eb3bf15d05c.png" style="width:40.50em;height:22.08em;"/></p>
<ol start="10">
<li>When you play the <span class="KeyWordPACKT">scene</span>, you should be able to drag the quality slider to change the quality settings.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>You created a panel containing a <span class="ScreenTextPACKT"><span class="packt_screen">UI Slider</span></span> and a <span class="ScreenTextPACKT"><span class="packt_screen">UI Text</span></span> object.</p>
<p><span class="CodeInTextPACKT">The <kbd>SetQualitySliderActive(...)</kbd></span> method receives a true/false value, and uses this to show/hide the mouse cursor and the <span class="ScreenTextPACKT"><span class="packt_screen">UI Panel</span></span>.</p>
<p>The <span class="CodeInTextPACKT"><kbd>UpdateQuality(...)</kbd> method</span> receives a float value from the <span class="ScreenTextPACKT">Slider <kbd>OnChange</kbd></span> event. This value is converted to an integer, which is to be the index of the selected quality setting. This index is used both to select the project quality setting, and also to update the <span class="ScreenTextPACKT"><span class="packt_screen">UI Text</span></span> label with the name of the currently selected quality setting.</p>
<p>When the <span class="KeyWordPACKT"><span class="packt_screen">Scene</span></span> begins, in the <span class="CodeInTextPACKT"><kbd>Awake()</kbd> method, </span>the <span class="ScreenTextPACKT"><span class="packt_screen">UI Slider</span></span> has its maximum value set to 1 less then the number of project quality items (for example, if there are five items, the slider will be from 0 to 4). Also, the <span class="ScreenTextPACKT"><span class="packt_screen">UI Slider</span></span> is moved to the position corresponding to the current quality level, and the <kbd><span class="CodeInTextPACKT">SetQualitySliderActive(...)</span></kbd> method is invoked with the true value in order to display both the mouse pointer and the <span class="ScreenTextPACKT"><span class="packt_screen">UI Panel</span></span> showing the slide and text label.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">There's more...</h1>
                </header>
            
            <article>
                
<p>Here are some ways to go further with this recipe.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Seeing/editing the list of quality settings</h1>
                </header>
            
            <article>
                
<p>You can view and modify the quality settings available for a project by choosing menu: <span class="ScreenTextPACKT"><span class="packt_screen">Edit | Project Settings | Quality</span>:</span></p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/211f0b70-908b-4097-a20d-db4b63cd639c.png" style="width:27.67em;height:17.17em;"/></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Pausing the game</h1>
                </header>
            
            <article>
                
<p>As compelling as your next game will be, you should always let players pause it for a short break. Sometimes, a game pause is used to let the player rest, but another reason might be to change some game setting such as volume or graphics quality.</p>
<p>Pausing the game usually involves a combination of freezing a game action, and also hiding or revealing UI items, to display a message to the player and provide UI controls to change settings.</p>
<p>In this recipe, we will implement a simple and effective pause screen that hides the previous recipe's quality settings slide when the game is being played, and reveals it when the game has been paused.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>This recipe builds on the previous one, so make a copy of that and use that copy.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<p>To pause your game upon pressing the <em><span class="KeyPACKT">Esc</span></em> key, follow these steps:</p>
<ol>
<li>Select the <span class="ScreenTextPACKT"><span class="packt_screen">First Person Controller</span></span>, and in the <span class="packt_screen">Inspector</span>, enable the following components:
<ul>
<li><span class="ScreenTextPACKT"><span class="packt_screen">Character Controller</span></span></li>
<li><span class="ScreenTextPACKT"><span class="packt_screen">Mouse Look (Script)</span></span></li>
<li><span class="ScreenTextPACKT"><span class="packt_screen">Character Motor (Script)</span></span></li>
<li><span class="ScreenTextPACKT"><span class="packt_screen">FPS Input Controller (Script)</span></span></li>
<li><span class="ScreenTextPACKT"><span class="packt_screen">Shooter (Script)</span></span></li>
</ul>
</li>
<li>Add the following C# script called <kbd><span class="ScreenTextPACKT">PauseGame</span></kbd> to <span class="ScreenTextPACKT"><span class="packt_screen">First Person Controller</span></span>:</li>
</ol>
<pre>    using UnityEngine;<br/>     using UnityEngine.UI;<br/>     using System.Collections;<br/> <br/>     public class PauseGame : MonoBehaviour {<br/>         private bool isPaused = false;<br/>         private QualityChooser qualityChooser;<br/> <br/>         void Start () {<br/>             qualityChooser = GetComponent&lt;QualityChooser&gt;();<br/>         }<br/> <br/>         void Update () {<br/>             if (Input.GetKeyDown(KeyCode.Escape)) {<br/>                 isPaused = !isPaused;<br/>                 SetPause ();<br/>             }<br/>         }<br/> <br/>         private void SetPause() {<br/>             float timeScale = !isPaused ? 1f : 0f;<br/>             Time.timeScale = timeScale;<br/>             GetComponent&lt;MouseLook&gt; ().enabled = !isPaused;<br/>             qualityChooser.SetQualitySliderActive(isPaused);<br/>         }        <br/>     } </pre>
<ol start="3">
<li>Edit the <kbd><span class="ScreenTextPACKT">QualityCo</span><span class="ScreenTextPACKT">ntroller</span></kbd> script class, and, in the <kbd><span class="CodeInTextPACKT">Awake()</span></kbd> method, change the last line to pass false (not true) to the <span class="CodeInTextPACKT"><kbd>SetQualitySliderActive(...)</kbd> method:</span></li>
</ol>
<pre>        void Awake () {<br/>             slider.maxValue = QualitySettings.names.Length - 1;<br/>             slider.value = QualitySettings.GetQualityLevel();<br/>             SetQualitySliderActive(false);<br/>         } </pre>
<ol start="4">
<li>When you play the <span class="KeyWordPACKT"><span class="packt_screen">Scene</span></span>, you should be able to pause/resume the game by pressing the <em><span class="KeyPACKT">Esc</span></em> key, which will also display/hide the slider that controls the game's quality settings.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>To pause a Unity game with a script, we need to set the game's <span class="KeyWordPACKT">Time Scale</span> to 0 (and set it back to 1 to resume). The <span class="CodeInTextPACKT"><kbd>SetPause()</kbd> method</span> does these actions according to the value of the <kbd><span class="CodeInTextPACKT">isPaused</span></kbd> variable:</p>
<ul>
<li><span class="CodeInTextPACKT"><kbd>isPause</kbd>= <kbd>true</kbd></span>: Time Scale 0 (pause the game), disable <kbd><span class="ScreenTextPACKT">MouseLook</span></kbd> component, and activate the quality slider and mouse cursor</li>
<li><span class="CodeInTextPACKT"><kbd>isPause</kbd> = <kbd>false</kbd></span>: Time Scale 1 (resume the game), enable <kbd><span class="ScreenTextPACKT">MouseLook</span></kbd> component, and deactivate the quality slider and mouse cursor:</li>
</ul>
<p class="CDPAlignCenter CDPAlign"><img src="assets/9cf70e8d-e179-416b-812e-8f205e312650.png"/></p>
<p>In the <span class="CodeInTextPACKT"><kbd>Update()</kbd> method,</span> a test is made for each frame, whether or not the <em><span class="KeyPACKT">Esc</span></em> key has been pressed. If pressed, the value of <kbd><span class="CodeInTextPACKT">isPaused</span></kbd> is toggled, and the <kbd><span class="CodeInTextPACKT">SetPause()</span></kbd> method is invoked.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">There's more...</h1>
                </header>
            
            <article>
                
<p>Here are some ways to go further with this recipe.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Learning more about quality settings</h1>
                </header>
            
            <article>
                
<p>Our code for changing quality settings is a modification of an example given by Unity's documentation. If you want to learn more about this subject, check out the following link: <span class="URLPACKT"><a href="http://docs.unity3d.com/ScriptReference/QualitySettings.html">http://docs.unity3d.com/ScriptReference/QualitySettings.html</a>.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Offering the user further game settings</h1>
                </header>
            
            <article>
                
<p>You could add more <span class="packt_screen">UI panels</span> to be activated when the game is paused, for example, for sound volume controls, save/load buttons, and so on.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Implementing slow motion</h1>
                </header>
            
            <article>
                
<p>Since Remedy Entertainment's <span class="KeyWordPACKT"><em>Max Payne</em> video game,</span> slow motion, or bullet time, has become a popular feature in games. For example, Criterion's <em><span class="KeyWordPACKT">Burnout</span></em> series has successfully explored the slow motion effect in the racing genre. In this recipe, we will implement a slow motion effect that is triggered by pressing the mouse's right button.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>For this recipe, we will use the same package as the previous recipes, <span class="ScreenTextPACKT"><kbd>BallGame</kbd>, which is</span> in the <kbd>16_07</kbd> folder.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<p>To implement slow motion, follow these steps:</p>
<ol>
<li>Import the <kbd><span class="ScreenTextPACKT">BallGame</span></kbd> package into your project and, from the <span class="KeyWordPACKT"><span class="packt_screen">Project</span></span> panel, open the level named <kbd><span class="ScreenTextPACKT">scene1_ballGame</span>.</kbd></li>
<li>Create a C# script class called <kbd><span class="ScreenTextPACKT">BulletTime</span>,</kbd> and add an instance object as a component to the <span class="ScreenTextPACKT"><span class="packt_screen">First Person Controller</span></span> GameObject:</li>
</ol>
<pre>    using UnityEngine;<br/>     using UnityEngine.UI;<br/>     using System.Collections;<br/> <br/>     public class BulletTime : MonoBehaviour {<br/>         public float slowSpeed = 0.1f;<br/>         public float totalTime = 10f;<br/>         public float recoveryRate = 0.5f;<br/>         public Slider EnergyBar;<br/>         private float elapsed = 0f;<br/>         private bool isSlow = false;<br/> <br/>         void Update (){        <br/>             if (Input.GetButtonDown ("Fire2") &amp;&amp; elapsed &lt; totalTime)<br/>                 SetSpeed (slowSpeed);</pre>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mceNonEditable"/>
<pre><br/>             if (Input.GetButtonUp ("Fire2"))<br/>                 SetSpeed (1f);<br/> <br/>             if (isSlow) {<br/>                 elapsed += Time.deltaTime / sloSpeed;<br/> <br/>                 if (elapsed &gt;= totalTime)<br/>                     SetSpeed (1f);                  <br/>             } else {<br/>                 elapsed -= Time.deltaTime * recoveryRate;<br/>                 elapsed = Mathf.Clamp (elapsed, 0, totalTime);<br/>             }<br/> <br/>             float remainingTime = (totalTime - elapsed) / totalTime;<br/>             EnergyBar.value = remainingTime;<br/>         }<br/> <br/>         private void SetSpeed (float speed) {<br/>             Time.timeScale = speed;<br/>             Time.fixedDeltaTime = 0.02f * speed;<br/>             isSlow = !(speed &gt;= 1.0f);  <br/>         }<br/>     } </pre>
<ol start="3">
<li>Add a <span class="ScreenTextPACKT"><span class="packt_screen">UI Slider</span></span> to the <span class="KeyWordPACKT">scene</span> named <span class="ScreenTextPACKT"><span class="packt_screen">Slider-energy</span> by</span> choosing menu: <span class="ScreenTextPACKT"><span class="packt_screen">Create | UI | Slider</span></span>. Please note that it will be created as a child of the existing <span class="ScreenTextPACKT">Canvas</span> object.</li>
<li>Select <span class="ScreenTextPACKT"><span class="packt_screen">Slider-energy</span></span> and, from the <span class="ScreenTextPACKT"><span class="packt_screen">Rect Transform</span></span> component in the <span class="KeyWordPACKT"><span class="packt_screen">Inspector</span></span>, set its <span class="ScreenTextPACKT"><span class="packt_screen">Anchors</span></span> as follows:
<ul>
<li><span class="ScreenTextPACKT"><span class="packt_screen">Min X: 0, Y: 1</span></span></li>
<li><span class="ScreenTextPACKT"><span class="packt_screen">Max X: 0.5, Y: 1</span></span></li>
<li><span class="ScreenTextPACKT"><span class="packt_screen">Pivot X: 0, Y: 1</span></span></li>
</ul>
</li>
</ol>
<ol start="5">
<li>Select <span class="ScreenTextPACKT"><span class="packt_screen">Slider-energy</span></span> and, from the <span class="ScreenTextPACKT"><span class="packt_screen">Rect Transform</span></span> component in the <span class="KeyWordPACKT"><span class="packt_screen">Inspector</span></span>, set its <span class="ScreenTextPACKT"><span class="packt_screen">Position</span></span> as follows:
<ul>
<li><span class="ScreenTextPACKT"><span class="packt_screen">Left: 0</span></span></li>
<li><span class="ScreenTextPACKT"><span class="packt_screen">Pos Y: 0</span></span></li>
<li><span class="ScreenTextPACKT"><span class="packt_screen">Pos Z: 0</span></span></li>
<li><span class="ScreenTextPACKT"><span class="packt_screen">Right: 0</span></span></li>
<li><span class="ScreenTextPACKT"><span class="packt_screen">Height: 50</span>:</span></li>
</ul>
</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/1b621a49-cd9e-4080-9a33-cfc487c413be.png"/></p>
<ol start="6">
<li>In the <span class="packt_screen">Inspector</span>, set the slider's child <strong>GameObject</strong> <span class="ScreenTextPACKT"><span class="packt_screen">Handle Slide Area</span> as inactive:</span></li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/b52387fa-64fc-4b45-84f7-942d5b95f989.png" style="width:31.42em;height:11.75em;"/></p>
<ol start="7">
<li>Finally, select the <span class="ScreenTextPACKT"><span class="packt_screen">First Person Controller</span></span> from the <span class="packt_screen">Hierarchy</span>. Then, find the <span class="ScreenTextPACKT"><span class="packt_screen">Bullet Time</span></span> component, and drag the GameObject <span class="ScreenTextPACKT"><span class="packt_screen">Slider-energy</span></span> from the <span class="KeyWordPACKT"><span class="packt_screen">Hierarchy</span></span> into its <span class="ScreenTextPACKT"><span class="packt_screen">Energy Bar</span></span> slot.</li>
<li>Play your game. You should be able to activate slow motion by holding down the right mouse button (or whatever alternative you have set for the Input axis <span class="ScreenTextPACKT">Fire2</span>). The slider will act as a progress bar that slowly shrinks, indicating the remaining bullet time you have.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>Basically, all we need to do to have the slow motion effect is decrease the <kbd><span class="CodeInTextPACKT">Time.timeScale</span></kbd> variable. In our script, we do that by using the <kbd><span class="CodeInTextPACKT">slowSpeed</span></kbd> variable. Please note that we also need to adjust the <kbd>Time.fixedDeltaTime</kbd> variable, updating the physics simulation of our game.</p>
<p>In order to make the experience more challenging, we have also implemented a sort of energy bar to indicate how much bullet time the player has left (the initial value is given, in seconds, by the <kbd><span class="ScreenTextPACKT">totalTime</span></kbd> variable). Whenever the player is not using bullet time, he/she has his/her quota filled according to the <kbd><span class="ScreenTextPACKT">recoveryRate</span></kbd> variable.</p>
<p>Regarding the <span class="ScreenTextPACKT"><span class="packt_screen">UI Slider</span></span>, we have used the <span class="ScreenTextPACKT">Rect Transform</span> settings to place it on the top-left corner and set its dimensions to half of the screen's width and 50 pixels tall. Also, we have hidden the handle slide area to make it similar to a traditional energy bar. Finally, instead of allowing direct interaction from the player with the slider, we have used the <kbd><span class="ScreenTextPACKT">BulletTime</span></kbd> script to change the slider's value.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">There's more...</h1>
                </header>
            
            <article>
                
<p>Some suggestions on how you can improve your slow motion effect even further are described in the following subsections.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Customizing the slider</h1>
                </header>
            
            <article>
                
<p>Don't forget that you can personalize the slider's appearance by creating your own sprites, or even by changing the slider's fill color based on the slider's value.</p>
<p>Try adding the following lines of code to the end of the <kbd>Update</kbd> function:</p>
<pre>    GameObject fill = GameObject.Find("Fill").gameObject;<br/>     Color sliderColor =  Color.Lerp(Color.red, Color.green, remainingTime);<br/>     fill.GetComponent&lt;Image&gt; ().color = sliderColor; </pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Adding Motion Blur</h1>
                </header>
            
            <article>
                
<p><span class="ScreenTextPACKT">Motion Blur</span> is an image effect that's frequently identified with slow motion. Once attached to the camera, it can be enabled or disabled depending on the speed float value. For more information on the <span class="ScreenTextPACKT">Motion Blur</span> post-processing image effect, refer to the following links:</p>
<ul>
<li><a href="https://github.com/Unity-Technologies/PostProcessing/wiki/Motion-Blur"><span class="URLPACKT">https://github.com/Unity-Technologies/PostProcessing/wiki/Motion-Blur</span></a></li>
<li><a href="https://docs.unity3d.com/Packages/com.unity.postprocessing@2.0/manual/Motion-Blur.html"><span class="URLPACKT">https://docs.unity3d.com/Packages/com.unity.postprocessing@2.0/manual/Motion-Blur.html</span></a></li>
<li><a href="https://docs.unity3d.com/Packages/com.unity.postprocessing@2.0/manual/Manipulating-the-Stack.html"><span class="URLPACKT">https://docs.unity3d.com/Packages/com.unity.postprocessing@2.0/manual/Manipulating-the-Stack.html</span></a></li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Creating sonic ambience</h1>
                </header>
            
            <article>
                
<p><em><span class="KeyWordPACKT">Max Payne</span></em> famously used a strong, heavy heartbeat sound as sonic ambience. You could also try lowering the sound effects volume to convey the character's focus when in slow motion. Plus, using audio filters on the camera could be an interesting option.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Using Gizmo to show the currently selected object in a scene panel</h1>
                </header>
            
            <article>
                
<p>Gizmos are visual aids that are provided to game designers in the <span class="KeyWordPACKT">scene</span> panel. In this recipe, we'll highlight the <strong>GameObject</strong> that is currently selected in the <span class="KeyWordPACKT"><strong>Hierarchy</strong> in the <span class="packt_screen">Scene</span> panel:</span></p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/c7f152c1-9628-4647-9481-676bbfc23ce3.png"/></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<p>To create a Gizmo to show the selected object in the <span class="packt_screen">Scene</span> panel, follow these steps:</p>
<ol>
<li>Create a new 3D project.</li>
<li>Create a <span class="ScreenTextPACKT">3D cube by </span>choosing menu: <span class="packt_screen"><span class="ScreenTextPACKT">Create | 3D Object | Cube</span></span>.</li>
<li>Create a C# script class called <kbd><span class="ScreenTextPACKT">GizmoHighlightSelected</span></kbd>, and add an instance object as a component to the <strong><span class="ScreenTextPACKT">3D Cube</span></strong>:</li>
</ol>
<pre>    using UnityEngine;<br/> <br/>     public class GizmoHighlightSelected : MonoBehaviour {<br/>         public float radius = 5.0f;<br/> <br/>         void OnDrawGizmosSelected() {<br/>             Gizmos.color = Color.red;<br/>             Gizmos.DrawWireSphere(transform.position, radius);<br/> <br/>             Gizmos.color = Color.yellow;<br/>             Gizmos.DrawWireSphere(transform.position, radius - 0.1f);<br/> <br/>             Gizmos.color = Color.green;<br/>             Gizmos.DrawWireSphere(transform.position, radius - 0.2f);<br/>         }<br/>     } </pre>
<ol start="4">
<li>Make lots of duplicates of the <span class="ScreenTextPACKT"><span class="packt_screen">3D Cube</span></span>, distributing them randomly around the <span class="KeyWordPACKT">scene</span>.</li>
<li>When you select one <span class="ScreenTextPACKT">cube</span> in the <span class="KeyWordPACKT">Hierarchy</span>, you should see three colored wireframe spheres drawn around the selected <strong>GameObject</strong> in the <span class="packt_screen">Scene</span> panel.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>When an object is selected in a <span class="KeyWordPACKT">scene</span>, if it contains a scripted component that includes the <span class="CodeInTextPACKT"><kbd>OnDrawGizmosSelected()</kbd> method</span>, then that method is invoked. Our method draws three concentric wireframe spheres in three different colors around the selected object.</p>
<p>You can learn more from the Gizmos Unity manual entry at <span class="URLPACKT"><a href="https://docs.unity3d.com/Manual/GizmosMenu.html">https://docs.unity3d.com/Manual/GizmosMenu.html</a>.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Editor snap-to grid drawn by Gizmo</h1>
                </header>
            
            <article>
                
<p>If the positioning of objects needs to be restricted to specific increments, it is useful to have a grid drawn in the <span class="KeyWordPACKT">scene</span> panel to help ensure that new objects are positioned based on those values, and also code to snap objects to that grid.</p>
<p>In this recipe, we'll use Gizmos to draw a grid with a customizable grid size, color, number of lines, and line length. The result of following this recipe will be as follows:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/ca48e620-10dd-4f23-8869-30f6b9ec56b5.png"/></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<p>To create a Gizmo to show the selected object in the <span class="KeyWordPACKT"><span class="packt_screen">Scene</span></span> panel, follow these steps:</p>
<ol>
<li>Create a new 3D project.</li>
<li>For the <span class="KeyWordPACKT"><span class="packt_screen">Scene</span></span> panel, turn off the <span class="ScreenTextPACKT"><span class="packt_screen">Skybox</span></span> view (or simply toggle off all the visual settings) so that you have a plain background for your grid work:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/edc2955b-cb99-479a-9bd6-36a6262e21bf.png"/></p>
<ol start="3">
<li>The display, and updating the child objects, will be performed by a script class called <kbd><span class="ScreenTextPACKT">GridGizmo</span>.</kbd> Create a new C# script class called <kbd><span class="ScreenTextPACKT">GridGizmo</span></kbd> which contains the following:</li>
</ol>
<pre>    using System.Collections;<br/>     using System.Collections.Generic;<br/>     using UnityEngine;<br/> <br/>     public class GridGizmo : MonoBehaviour {<br/>         [SerializeField]<br/>         public int grid = 2;<br/> <br/>         public void SetGrid(int grid) {<br/>             this.grid = grid;<br/>             SnapAllChildren();<br/>         }<br/> <br/>         [SerializeField]<br/>         public Color gridColor = Color.red;<br/> <br/>         [SerializeField]<br/>         public int numLines = 6;<br/> <br/>         [SerializeField]<br/>         public int lineLength = 50;<br/> <br/>         private void SnapAllChildren() {<br/>             foreach (Transform child in transform)<br/>                 SnapPositionToGrid(child);<br/>         }<br/> <br/>         void OnDrawGizmos() {<br/>             Gizmos.color = gridColor;<br/> <br/>             int min = -lineLength;<br/>             int max = lineLength;<br/> <br/>             int n = -1 * RoundForGrid(numLines / 2);<br/>             for (int i = 0; i &lt; numLines; i++) {<br/>                 Vector3 start = new Vector3(min, n, 0);<br/>                 Vector3 end = new Vector3(max, n, 0); <br/>                 Gizmos.DrawLine(start, end);<br/> <br/>                 start = new Vector3(n, min, 0);<br/>                 end = new Vector3(n, max, 0); <br/>                 Gizmos.DrawLine(start, end);<br/> <br/>                 n += grid;<br/>             }<br/>         }<br/> <br/>         public int RoundForGrid(int n) {<br/>             return (n/ grid) * grid;<br/>         }<br/> <br/>         public int RoundForGrid(float n) {<br/>             int posInt = (int) (n / grid);<br/>             return posInt * grid;<br/>         }<br/> <br/>         public void SnapPositionToGrid(Transform transform) {<br/>             transform.position = new Vector3 (<br/>                 RoundForGrid(transform.position.x),<br/>                 RoundForGrid(transform.position.y),<br/>                 RoundForGrid(transform.position.z)<br/>             );<br/>         }<br/>     } </pre>
<ol start="4">
<li>Let's use an <span class="KeyWordPACKT">Editor</span> script to add a new menu item to the <strong>GameObject</strong> menu. Create a folder named <kbd><span class="ScreenTextPACKT">Editor</span></kbd>, and in that folder, create a new C# script class called <kbd><span class="ScreenTextPACKT">EditorGridGizmoMenuItem</span>,</kbd> which contains the following:</li>
</ol>
<pre>    using UnityEngine;<br/>     using UnityEditor;<br/>     using System.Collections;<br/> <br/>     public class EditorGridGizmoMenuItem : Editor {<br/>         [MenuItem("GameObject/Create New Snapgrid", false, 10000)]<br/>         static void CreateCustomEmptyGameObject(MenuCommand menuCommand) {<br/>             GameObject gameObject = new GameObject("___snap-to-grid___");<br/> <br/>             gameObject.transform.parent = null;<br/>             gameObject.transform.position = Vector3.zero;<br/>             gameObject.AddComponent&lt;GridGizmo&gt;();        <br/>         }<br/>     } </pre>
<p class="mce-root"/>
<ol start="5">
<li>Now, let's add another <strong><span class="KeyWordPACKT">Editor</span></strong> script for a custom <span class="KeyWordPACKT">Inspector</span> display (and updater) for the <kbd><span class="ScreenTextPACKT">GridGizmo</span></kbd> components. Also, in your <strong><span class="ScreenTextPACKT">Editor</span></strong> folder, create a new C# script class called <kbd><span class="ScreenTextPACKT">EditorGridGizmo</span>,</kbd> which contains the following:</li>
</ol>
<pre>    using UnityEngine;<br/>     using UnityEditor;<br/>     using System.Collections;<br/> <br/>     [CustomEditor(typeof(GridGizmo))]<br/>     public class EditorGridGizmo : Editor {<br/>         private GridGizmo gridGizmoObject;<br/>         private int grid;<br/>         private Color gridColor;<br/>         private int numLines;<br/>         private int lineLength;<br/> <br/>         private string[] gridSizes = {<br/>             "1", "2", "3", "4", "5"<br/>         };<br/> <br/>         void OnEnable() {<br/>             gridGizmoObject = (GridGizmo)target;<br/>             grid = serializedObject.FindProperty("grid").intValue;<br/>             gridColor = serializedObject.FindProperty("gridColor").colorValue;<br/>             numLines = serializedObject.FindProperty("numLines").intValue;<br/>             lineLength = serializedObject.FindProperty("lineLength").intValue;<br/>         }<br/> <br/>         public override void OnInspectorGUI() {<br/>             serializedObject.Update ();<br/> <br/>             int gridIndex = grid - 1;<br/>             gridIndex =  EditorGUILayout.Popup("Grid size:",  gridIndex, gridSizes);                <br/>             gridColor = EditorGUILayout.ColorField("Color:", gridColor);<br/>             numLines =  EditorGUILayout.IntField("Number of grid lines",  numLines);<br/>             lineLength =  EditorGUILayout.IntField("Length of grid lines",  lineLength);<br/> <br/>             grid = gridIndex + 1;<br/>             gridGizmoObject.SetGrid(grid);  <br/>             gridGizmoObject.gridColor = gridColor;<br/>             gridGizmoObject.numLines = numLines;    <br/>             gridGizmoObject.lineLength = lineLength;    <br/>             serializedObject.ApplyModifiedProperties ();<br/>             sceneView.RepaintAll();<br/>         }        <br/>     } </pre>
<ol start="6">
<li>Add a new <kbd><span class="ScreenTextPACKT">GizmoG</span><span class="ScreenTextPACKT">rid</span></kbd> GameObject to the scene by choosing menu: <span class="ScreenTextPACKT"><span class="packt_screen">GameObject | Create New Snapgrid</span></span>. A new <span class="packt_screen">GameObject</span> named ___<span class="ScreenTextPACKT"><span class="packt_screen">snap-to-grid</span>___</span> should be added to the <span class="KeyWordPACKT"><span class="packt_screen">Hierarchy</span>:</span></li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/513c2646-a955-4770-9b14-51dedb35c136.png" style="width:23.92em;height:12.75em;"/></p>
<ol start="7">
<li>Select <span class="packt_screen">GameObject</span> ___<span class="ScreenTextPACKT"><span class="packt_screen">snap-to-grid</span>___</span>, and modify some of its properties in the <span class="packt_screen">Inspector</span>. You can change the grid size, the color of the grid lines, the number of lines, and their length:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/5a2e5b99-a671-492f-bb5f-dfd780a2b2f9.png"/></p>
<ol start="8">
<li>Create a <strong>3D Cube</strong> by choosing menu: <span class="ScreenTextPACKT"><span class="packt_screen">Create | 3D Object | Cube</span></span>. Now, drag the <strong><span class="ScreenTextPACKT">3D Cube</span></strong> into the <span class="KeyWordPACKT"><span class="packt_screen">Hierarchy</span></span> and child it to <span class="packt_screen">GameObject</span> ___<span class="ScreenTextPACKT"><span class="packt_screen">snap-to-grid</span>___</span>.</li>
</ol>
<ol start="9">
<li>We now need a small script class so that, each time the <span class="packt_screen">GameObject</span> is moved (in <span class="KeyWordPACKT">Editor</span> mode), it asks for its position to be snapped by the parent scripted component <kbd><span class="ScreenTextPACKT">SnapToGizmoGrid</span>.</kbd> Create a C# script class called <kbd><span class="ScreenTextPACKT">SnapToGizmoGrid</span></kbd> and add an instance object as a component to the <strong><span class="ScreenTextPACKT">3D Cube</span></strong>:</li>
</ol>
<pre>    using System.Collections;<br/>     using System.Collections.Generic;<br/>     using UnityEngine;<br/> <br/>     [ExecuteInEditMode]<br/>     public class SnapToGridGizmo : MonoBehaviour {<br/>         public void Update()<br/>         {<br/>     #if UNITY_EDITOR<br/>             transform.parent.GetComponent&lt;GridGizmo&gt;().SnapPositionToGrid(transform);<br/>     #endif<br/>         }<br/>     } </pre>
<ol start="10">
<li>Make lots of duplicates of the <span class="ScreenTextPACKT">3D cube</span>, distributing them randomly around the scene—you'll find that they snap to the grid.</li>
<li>Select <span class="packt_screen">GameObject ___<span class="ScreenTextPACKT">snap-to-grid___</span> again</span>, and modify some of its properties in the <span class="KeyWordPACKT">Inspector</span>. You'll see that the changes are instantly visible in the <span class="KeyWordPACKT">scene</span>, and that all child objects that have a scripted component of <kbd><span class="ScreenTextPACKT">SnapToGizmoGrid</span></kbd> are snapped to any new grid size changes.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>The <kbd><span class="ScreenTextPACKT">EditorGridGizmoMenuItem</span></kbd> script class adds a new item to the <span class="packt_screen">GameObject</span> menu. When selected, a new <span class="packt_screen">GameObject</span> is added to the Hierarchy named ___<span class="ScreenTextPACKT"><span class="packt_screen">snap-to-grid</span>___</span>, positioned at (<span class="ScreenTextPACKT"><span class="packt_screen">0, 0, 0</span></span>), and containing an instance object component of the <span class="ScreenTextPACKT"><kbd>GridGizmo</kbd> script class.</span></p>
<p><kbd><span class="ScreenTextPACKT">GridGizmo</span></kbd> draws a 2D grid based on public properties for grid size, color, number of lines, and line length. Regarding the <span class="CodeInTextPACKT"><kbd>SetGrid(...)</kbd> method, </span>as well as updating the integer grid size variable grid, it also invokes the <span class="CodeInTextPACKT"><kbd>SnapAllChildren()</kbd> method,</span> so that each time the grid size is changed, all child <span class="packt_screen">GameObjects</span> are snapped into the new grid positions.</p>
<p>The <kbd><span class="ScreenTextPACKT">SnapToGridGizmo</span></kbd> script class includes an <span class="ScreenTextPACKT">Editor</span> attribute <kbd><span class="CodeInTextPACKT">[ExecuteInEditMode]</span></kbd> so that it will receive <kbd><span class="CodeInTextPACKT">Update()</span></kbd> messages when its properties are changed at d<span class="KeyWordPACKT">esign time</span> in the <span class="KeyWordPACKT">Editor</span>. Each time <kbd><span class="CodeInTextPACKT">Update()</span></kbd> is invoked, it calls <span>the</span><span> </span><kbd><span class="CodeInTextPACKT">SnapPositionToGrid(...)</span></kbd><span> method in its parent</span> <kbd><span class="ScreenTextPACKT">GridGizmo</span></kbd> <span>instance object so that its position is snapped based on the current settings of the grid. To ensure this logic and code is not compiled into any final b</span><span class="KeyWordPACKT">uild</span> <span>of the game, the contents of</span> <kbd><span class="CodeInTextPACKT">Update()</span></kbd> <span>are wrapped in an</span> <span class="CodeInTextPACKT">#if UNITY_EDITOR</span> <span>compiler test. Such content is removed before a build is compiled for the final game.</span></p>
<p>The <span class="ScreenTextPACKT"><kbd>EditorGridGizmo</kbd> script class</span> is a custom <span class="KeyWordPACKT">Editor Inspector</span> component. This allows for both control of which properties are displayed in the <span class="packt_screen">Inspector</span>, how they are displayed, and it allows actions to be performed when any values are changed. So, for example, after changes have been saved, the <span class="CodeInTextPACKT"><kbd>sceneView.RepaintAll()</kbd> statement</span> ensures that the grid is re-displayed, since it results in an <kbd><span class="CodeInTextPACKT">OnDrawGizmos()</span></kbd> message being sent.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Creating a VR project</h1>
                </header>
            
            <article>
                
<p>In this recipe, we will go through the steps for setting up a basic VR scene in Unity, using the Vive VR headset on a Windows computer.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>You need Steam VR with the <span class="ScreenTextPACKT">Standing Only</span> or <span class="ScreenTextPACKT">Room-scale</span> set up. If you have not done so yet, then follow these steps to set up your Vive headset so that it's ready for Unity game development:</p>
<ol>
<li>Install <span class="ScreenTextPACKT">Steam</span></li>
<li>Install <span class="ScreenTextPACKT">Steam VR</span></li>
<li>Plug in your Vive headset</li>
<li>From the Steam application window, run <span class="ScreenTextPACKT">Steam VR</span> (click VR at top right of the Steam app window):</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/c968814d-26da-4034-ad69-7ea398d8950a.png"/></p>
<ol start="5">
<li>Steam VR should run. Then, choose the <span class="ScreenTextPACKT"><span class="packt_screen">Run Room Setup</span></span> menu item:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/336bc099-aeed-459a-9ea2-844b3b60c6be.png" style="width:26.08em;height:15.17em;"/></p>
<ol start="6">
<li>Position your <strong><span class="KeyWordPACKT">Light</span> <span class="KeyWordPACKT">House</span><span class="KeyWordPACKT">s</span></strong> to cover the space in the room that you want to use.</li>
<li>From the Room Setup screen, choose your room setup: <span class="ScreenTextPACKT"><span class="packt_screen">Standing Only</span></span> or <span class="ScreenTextPACKT"><span class="packt_screen">Room-Scale</span></span>:
<ul>
<li><span class="ScreenTextPACKT"><span class="packt_screen">Standing Only</span></span>:
<ul>
<li>Use the headset to set the center</li>
<li>Use the headset to locate the floor</li>
</ul>
</li>
<li><span class="ScreenTextPACKT"><span class="packt_screen">Room-Scale</span></span>:
<ul>
<li>Position your <span class="KeyWordPACKT">Light Houses</span> to cover the space you want to use</li>
<li>Calibrate the floor by putting hand controllers on the floor</li>
<li>Walk around room, using hand controllers with the trigger to trace the space you can safely move around</li>
</ul>
</li>
</ul>
</li>
<li>You can now explore <span class="ScreenTextPACKT"><span class="packt_screen">Steam VR Home</span></span>.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<p>To create a basic VR Unity project, follow these steps:</p>
<ol>
<li>Start a new 3D project.</li>
</ol>
<div class="packt_infobox">Either work with a new 3D Unity project, or make a backup of any project to which you are about to add VR features to, since you will be adding a package that makes changes to many settings, and it could mess up settings in an existing project.</div>
<ol start="2">
<li>Delete the <span class="ScreenTextPACKT"><span class="packt_screen">Main Camera</span></span> from the <span class="KeyWordPACKT"><span class="packt_screen">Scene</span></span>.</li>
<li>Display the Unity <span class="ScreenTextPACKT"><span class="packt_screen">Player</span></span> settings in the <span class="KeyWordPACKT"><span class="packt_screen">Inspector</span></span> by choosing menu: <span class="packt_screen"><span class="ScreenTextPACKT">Edit | Project</span> <span class="ScreenTextPACKT">Settings | Player</span></span>.</li>
<li>Check the <span class="ScreenTextPACKT"><span class="packt_screen">Virtual Reality Supported</span></span> option near the bottom of the <span class="KeyWordPACKT"><span class="packt_screen">Inspector</span></span>:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/4a3109a7-9e28-4f96-b4f8-59339bf45b32.png"/></p>
<ol start="5">
<li>Ensure that you are logged into your Unity Account (before accessing the <strong><span class="KeyWordPACKT">Asset Store</span></strong>).</li>
<li>Visit the <span class="KeyWordPACKT"><strong>Asset Store</strong> and</span> search for <span class="ScreenTextPACKT"><span class="packt_screen">Steam VR</span></span> from the Valve Corporation:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/b1c09bc6-95bd-47ba-aff2-7269daf0fa41.png"/></p>
<ol start="7">
<li>Download and import the package (you'll be warned about having made a backup before importing...).</li>
<li>Choose your preferred options from any pop-up about builds:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/c9c88ce1-ab59-4890-bb43-55cefc8b9fbc.png" style="width:21.50em;height:19.50em;"/></p>
<ol start="9">
<li>Drag into the <span class="KeyWordPACKT"><span class="packt_screen">Scene</span></span> a clone of the <span class="ScreenTextPACKT"><span class="packt_screen">[CameraRig]</span></span> prefab from folder: <span class="ScreenTextPACKT"><span class="packt_screen">Project | SteamVR | Prefabs</span></span>. You'll see a 3D space representing your room setup (our examples show the rectangular-based space from the <span class="ScreenTextPACKT"><span class="packt_screen">Standing only</span></span> room setup):</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/4248b37c-4498-47d4-8677-b47024033440.png"/></p>
<ol start="10">
<li>Run the <span class="KeyWordPACKT"><span class="packt_screen">Scene</span></span>, put on your VR headset, and pick up your hand controllers. You should see 3D representations of the position, trigger settings, and so on of your hand controllers in the virtual space.</li>
<li>Import/create 3D Objects in your <span class="KeyWordPACKT">scene <span>-</span></span> for example, add a <strong><span class="ScreenTextPACKT">3D Cube</span></strong> to the <span class="KeyWordPACKT">scene</span> inside the room space of the <span class="ScreenTextPACKT"><span class="packt_screen">CameraRig</span></span>.</li>
</ol>
<ol start="12">
<li>Run the <span class="KeyWordPACKT"><span class="packt_screen">Scene</span></span>, and try moving a virtual hand controller to collide with your <span class="ScreenTextPACKT">3D cube:</span></li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/e831433d-d831-4f4e-985c-20d6afba9e68.png"/></p>
<ol start="13">
<li>Test the physics by adding a <span class="ScreenTextPACKT"><span class="packt_screen">Rigid Body</span></span> component to the <span class="ScreenTextPACKT"><span class="packt_screen">3D Cube</span></span> (and turn off gravity), adding/making the <span class="ScreenTextPACKT"><span class="packt_screen">Box Collider</span></span> to the GameObject <span class="ScreenTextPACKT"><span class="packt_screen">Controller (right)</span> smaller.</span></li>
<li>Run the <span class="KeyWordPACKT">scene</span> <span>-</span> you should be able to push the <strong><span class="ScreenTextPACKT">3D Cube</span></strong> with the virtual hand controller.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>You've learned to set up Vive and locate and install the <span class="ScreenTextPACKT"><span class="packt_screen">Steam VR</span></span> package.</p>
<p>This package contains prefabs so that the headset and handset work in the standing/room space you set up.</p>
<p>You created a Unity project with the Vive prefabs. You then added a <span class="ScreenTextPACKT"><span class="packt_screen">3D Cube</span></span> to the <span class="KeyWordPACKT">scene</span> and interacted with it by adding colliders to the cube and a hand controller GameObject.</p>
<div class="packt_infobox">This was tested with <span class="ScreenTextPACKT"><span class="packt_screen">Unity 2017.4.9 LTS</span></span>, since it wasn't fully working with a 2018 version at the time of writing.</div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">There's more...</h1>
                </header>
            
            <article>
                
<p>Here are some suggestions for taking this recipe further.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Exploring free VR/XR samples/tutorials</h1>
                </header>
            
            <article>
                
<p>Some good sources of free sample VR projects to explore include the following:</p>
<ul>
<li class="SourceCode">Unity Technologies VR Samples: <span class="URLPACKT"><span><a href="https://assetstore.unity.com/packages/essentials/tutorial-projects/vr-samples-51519">https://assetstore.unity.com/packages/essentials/tutorial-projects/vr-samples-51519</a>:<br/></span></span></li>
</ul>
<p class="CDPAlignCenter CDPAlign"><img src="assets/85037417-68e6-4b71-97c0-9dcd3bf12294.png" style="width:27.67em;height:7.33em;"/></p>
<ul>
<li class="SourceCode">A good tutorial on Vive and Unity from <span class="KeyWordPACKT"><strong>Ray Wenderlick</strong>:</span> <a href="https://www.raywenderlich.com/792-htc-vive-tutorial-for-unity"><span class="URLPACKT"><span>https://www.raywenderlich.com/792-htc-vive-tutorial-for-unity</span></span></a></li>
<li class="SourceCode">Valve Lab Renderer on the Unity <strong><span class="KeyWordPACKT">Asset Store</span></strong>: <a href="https://assetstore.unity.com/packages/tools/the-lab-renderer-63141"><span class="URLPACKT"><span>https://assetstore.unity.com/packages/tools/the-lab-renderer-63141</span></span></a></li>
<li class="SourceCode">Vive input utility on the Unity <strong><span class="KeyWordPACKT">Asset Store</span></strong>: <a href="https://assetstore.unity.com/packages/tools/integration/vive-input-utility-64219"><span class="URLPACKT">https://assetstore.unity.com/packages/tools/integration/vive-input-utility-64219</span></a></li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Setup with Oculus Rift</h1>
                </header>
            
            <article>
                
<p>The Oculus Rift setup is similar to that with the Vive, although it actually integrates a little better with Unity. You need to do the following:</p>
<ol>
<li>Install the Oculus runtime.</li>
<li>Setup for room/standing for the Infrared Cameras.</li>
<li>There is no need download any package, and no need to remove the <span class="ScreenTextPACKT"><span class="packt_screen">Main Camera</span></span>.</li>
</ol>
<p>You can learn more about this at the Oculus Rift Unity documentation site: <span class="ScreenTextPACKT"><a href="https://developer.oculus.com/documentation/unity/latest/concepts/book-unity-gsg/">https://developer.oculus.com/documentation/unity/latest/concepts/book-unity-gsg/</a>.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Using a Single Pass if working with the Lightweight Rendering Pipeline</h1>
                </header>
            
            <article>
                
<p>If you're using the <span class="KeyWordPACKT"><strong>Lightweight Rendering Scripted Pipeline</strong>, </span>then you need to choose <span class="ScreenTextPACKT"><span class="packt_screen">Single Pass</span></span> for the <span class="ScreenTextPACKT">Stereo <kbd>RenderingMethod*</kbd></span> property when setting up XR in the settings, having chosen menu: <span class="ScreenTextPACKT"><span class="packt_screen">Edit | Project Settings | Player</span>:</span></p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/83728dea-ec7e-42df-b271-f7baaf42f31f.png"/></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Adding 360-degree videos to a VR project</h1>
                </header>
            
            <article>
                
<p><span>Google Earth VR is great fun! This screenshot from a live VR session shows the virtual hand controller, and a virtual screen menu showing photos and text about 6 suggested locations to visit:</span></p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/bc4d85ec-70eb-4248-b0ae-d1a5d2d2a560.png" style="width:44.67em;height:22.33em;"/></p>
<p>Affordable, 360-degree cameras means that it's easy to create your own, or find free online 360-degree images and video clips. In this recipe, we'll learn how to add a 360-degree video clip as a Skybox in a VR project. You will also learn how the 360-degree video clips can be played on the surface of 3D objects, including the inside of a sphere—a bit like <span class="KeyWordPACKT"><strong>Google Earth</strong> <strong>VR</strong></span> mode when you raise the sphere to your head to view its 360-degree image contents:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/75d955a8-4647-4f29-a940-7c7caf872ba1.png" style="width:45.92em;height:21.75em;"/></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>For this recipe, we have provided a short <kbd><span class="ScreenTextPACKT">Snowboarding_Polar.mp4</span></kbd> video in the <kbd>16_07</kbd> folder. This project builds on the previous one (a basic VR project), so make a copy of that and work on the copy.</p>
<div class="packt_infobox">Special thanks to <span class="KeyWordPACKT">Kris Szczurowski</span> for permission to use his snowboarding 360-degree video clip, and for his help with these VR project recipes. Good luck with the PhD!</div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<p>To add 360-degree videos to a VR project, follow these steps:</p>
<ol>
<li>Import your 360-degree polar format video clip into your Unity project (in our example, this is <kbd><span class="ScreenTextPACKT">Snowboarding_Polar.mp4</span></kbd>).</li>
<li>Select the video asset in the <span class="KeyWordPACKT"><span class="packt_screen">Project</span></span> panel, and in the <span class="KeyWordPACKT"><span class="packt_screen">Inspector</span>,</span> make a note of its resolution (we'll need this later), for example, <span class="ScreenTextPACKT"><span class="packt_screen">2,560 x 1,280</span></span>:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/ff1ec98d-08af-4b97-84cd-72fa612bff4b.png"/></p>
<ol start="3">
<li>Create a new empty GameObject named <span class="ScreenTextPACKT"><span class="packt_screen">video-player</span> by </span>choosing menu: <span class="ScreenTextPACKT"><span class="packt_screen">Create | Empty</span></span>.</li>
<li>Select <span class="ScreenTextPACKT"><span class="packt_screen">video-player</span></span> in the <span class="KeyWordPACKT"><span class="packt_screen">Hierarchy</span></span>, and in the <span class="KeyWordPACKT"><span class="packt_screen">Inspector</span>,</span> add a component <strong><span class="ScreenTextPACKT">Video</span> <span class="ScreenTextPACKT">Player</span></strong> component by choosing: <span class="ScreenTextPACKT"><span class="packt_screen">Add Component | Video | Video Player</span></span>.</li>
<li>From the <span class="KeyWordPACKT"><span class="packt_screen">Project</span></span> panel, drag your video asset file, for example, <kbd><span class="ScreenTextPACKT">Snowboarding_Polar</span></kbd>, into the <span class="ScreenTextPACKT"><span class="packt_screen">Video Clip</span></span> property of the <span class="ScreenTextPACKT"><span class="packt_screen">Video Player</span></span> component.</li>
<li>Create a new <span class="ScreenTextPACKT"><span class="packt_screen">Render Texture</span></span> asset file named <kbd><span class="ScreenTextPACKT">VideoRenderTexture</span></kbd> by choosing menu: <span class="ScreenTextPACKT"><span class="packt_screen">Create | Render Texture</span></span>.</li>
<li>Set the <span class="ScreenTextPACKT">Resolution</span> of the <kbd><span class="ScreenTextPACKT">VideoRenderTexture</span></kbd> to match the video asset resolution, for example, <span class="ScreenTextPACKT"><span class="packt_screen">2,560 x 1,280</span></span>:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/c7c5b0c4-f7d1-474c-98cf-3673af46ca4e.png"/></p>
<ol start="8">
<li>In the <span class="packt_screen"><span class="KeyWordPACKT">Hierarc</span><span class="KeyWordPACKT">hy</span></span><span class="KeyWordPACKT">,</span> select <span class="packt_screen">GameObject</span> <span class="ScreenTextPACKT">video-player</span>, and for the <span class="ScreenTextPACKT"><span class="packt_screen">Video Player</span></span> component, set the target texture to be <kbd><span class="ScreenTextPACKT">VideoRenderTexture</span>.</kbd></li>
<li>Create a new <span class="KeyWordPACKT"><span class="packt_screen">Material</span></span> named <kbd><span class="ScreenTextPACKT">video_m</span></kbd> by choosing menu: <span class="ScreenTextPACKT"><span class="packt_screen">Create | Material</span></span>.</li>
<li>With <kbd><span class="ScreenTextPACKT">video_m</span></kbd> selected in the <span class="KeyWordPACKT"><span class="packt_screen">Project</span></span> panel, change its <strong>Shader</strong> to <span class="ScreenTextPACKT"><span class="packt_screen">Skybox | Panoramic</span></span>:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/ebada947-0ba7-4ab0-9554-1767103f2731.png"/></p>
<ol start="11">
<li>In the <span class="KeyWordPACKT"><span class="packt_screen">Inspector</span></span>, for the <span class="ScreenTextPACKT">Spherical HDR</span> property, click the <span class="ScreenTextPACKT"><span class="packt_screen">Select</span></span> button and choose <span class="ScreenTextPACKT">Texture <kbd>VideoRenderTexture:</kbd></span></li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/c47c37b3-eadc-4341-93da-4e2ff85c51c1.png"/></p>
<ol start="12">
<li>Open the <span class="ScreenTextPACKT"><span class="packt_screen">Lighting</span> <span class="packt_screen">Settings</span></span> panel, choose menu: <span class="packt_screen"><span class="ScreenTextPACKT">Window | Rendering | Lighting</span> <span class="ScreenTextPACKT">Settings</span></span>. In the <span class="KeyWordPACKT"><span class="packt_screen">Inspector</span>,</span> set the <span class="packt_screen"><span class="ScreenTextPACKT">Skybox</span> <span class="ScreenTextPACKT">Material</span></span> to <kbd><span class="ScreenTextPACKT">video_m:</span></kbd></li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/abb53f02-7924-4d3f-919c-8aacc58207b6.png" style="width:34.67em;height:8.92em;"/></p>
<ol start="13">
<li>Play the <span class="KeyWordPACKT"><span class="packt_screen">Scene</span></span>, put on your VR headset, and you should see the 360-degree video playing all around you.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>You have created a GameObject with a <span class="ScreenTextPACKT"><span class="packt_screen">Video Player</span></span> component, and made it play your 360-degree video. You made this component render to a <span class="ScreenTextPACKT"><span class="packt_screen">Render Texture</span></span> of the same dimensions as your video.</p>
<p>You created a <span class="ScreenTextPACKT"><span class="packt_screen">Skybox-panomaric</span></span> <strong><span class="KeyWordPACKT">Material</span>,</strong> and selected your <span class="ScreenTextPACKT"><span class="packt_screen">Render Texture</span></span> as the <span class="ScreenTextPACKT"><span class="packt_screen">Texture</span></span> for this <strong><span class="KeyWordPACKT">Material</span></strong>. You then set this <strong><span class="KeyWordPACKT">Material</span></strong> as the <span class="ScreenTextPACKT"><span class="packt_screen">Skybox</span></span> for the <span class="packt_screen"><span class="ScreenTextPACKT">Lighting</span> <span class="ScreenTextPACKT">Settings</span></span>.</p>
<div class="packt_infobox"><br/>
This was tested with <span class="ScreenTextPACKT"><span class="packt_screen">Unity 2017.4.9 LTS</span></span>, since it wasn't fully working with a 2018 version at the time of writing.</div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">There's more...</h1>
                </header>
            
            <article>
                
<p>Here are some suggestions for taking this recipe further.</p>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Playing 360-degree videos on the surface of a 3D object</h1>
                </header>
            
            <article>
                
<p>To play 360-degree videos on the surface of a 3D object, perform the aforementioned steps, but do not set the Skybox to <kbd><span class="ScreenTextPACKT">video_m</span></kbd>. Instead, set the <span class="ScreenTextPACKT"><span class="packt_screen">Material</span></span> of the <span class="ScreenTextPACKT"><span class="packt_screen">Mesh Renderer</span></span> component of your 3D object to <kbd><span class="ScreenTextPACKT">video_m</span></kbd>:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/f0d10053-1637-4007-a206-ffdc5c7c0a2a.png"/></p>
<p>This works for 3D objects with inverted normals, for example, a hollow 3D Sphere that you can look at from the inside.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Working with VR content inside a VR environment – the XR Editor</h1>
                </header>
            
            <article>
                
<p>An exciting project from Unity is the <span class="ScreenTextPACKT"><span class="packt_screen">XR-Editor</span></span>, which is a VR environment that allows you to edit a scene in VR. The project provides great examples of VR UI elements, including 3D menus and laser pointer selectors. It allows you to see <span class="KeyWordPACKT">Console</span> reports in the environment and interact with the <span class="KeyWordPACKT"><span class="packt_screen">Hierarchy</span></span> of GameObjects: <span>In this screenshot we can see the main Workspace menu displayed on the virtual left hand controller, and the virtual right hand controller is being presented as a rotary menu for actions that can be performed on the currently selected GameObject.</span></p>
<p><span>The 'Select Parent' option is currently selected in this rotary menu:</span></p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/72c28544-4eea-466e-9f79-189bf674f627.png"/></p>
<p>In this recipe, we will set up the XR-Editor for use in a Unity project.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>Start this recipe with a copy of the Basic VR project created in the recipe before the previous one.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it ...</h1>
                </header>
            
            <article>
                
<p>To work with VR content inside a VR environment in the XR Editor, do the following:</p>
<ol>
<li>Install the <span class="ScreenTextPACKT"><span class="packt_screen">TextMeshPro</span></span> package, choosing menu: <span class="ScreenTextPACKT"><span class="packt_screen">Window | Package Manager</span></span>, and selecting <span class="ScreenTextPACKT"><span class="packt_screen">Text Mesh Pro</span></span>.</li>
<li>Download the <span class="ScreenTextPACKT"><span class="packt_screen">Editor XR</span></span> package from the links on the Unity blog page:
<ul>
<li><a href="http://rebrand.ly/EditorVR-package"><span class="URLPACKT">http://rebrand.ly/EditorVR-package</span></a></li>
<li><a href="https://blogs.unity3d.com/2016/12/15/editorvr-experimental-build-available-today/"><span class="URLPACKT">https://blogs.unity3d.com/2016/12/15/editorvr-experimental-build-available-today/</span></a></li>
</ul>
</li>
<li>Import the <span class="ScreenTextPACKT"><span class="packt_screen">EditorXR-package</span></span> package into your project.</li>
</ol>
<ol start="4">
<li>Agree to the prompt on-screen about patching the <span class="ScreenTextPACKT"><span class="packt_screen">Input Manager</span></span> settings:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/f65fe051-8584-4922-9545-ae429c19dfc1.png" style="width:24.42em;height:9.67em;"/></p>
<ol start="5">
<li>There should be a new item on the Window Menu, <span class="ScreenTextPACKT"><span class="packt_screen">Window | EditorXR</span></span>. Choose this menu item:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/25a2b73d-bd37-400e-a1f5-570d17506e68.png"/></p>
<ol start="6">
<li>A new, floating EditorXR application window should now be created:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/41b2e007-5428-42a2-845a-a9d6dae982d3.png"/></p>
<ol start="7">
<li>Put on your VR headset and start creating. Do NOT run the <span class="KeyWordPACKT">scene—</span><span class="ScreenTextPACKT"><span class="packt_screen">Editor XR</span></span> works at <strong>Design Time</strong>, not <strong><span class="KeyWordPACKT">Run-Time</span></strong>, so do NOT play the <strong><span class="KeyWordPACKT">Scene</span></strong>.</li>
<li>You display the main menu by directing the laser pointer of one virtual hand controller onto the menu bar on the other hand controller:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/694c1e4c-c9b3-4614-9c5e-b6b7ef75dbd6.png" style="width:36.67em;height:15.08em;"/></p>
<ol start="9">
<li>You'll then get a cube-like, multi-sided, rotatable main menu, from which you can choose items with the laser pointer. <span>For example on the <span class="packt_screen">Workspaces</span> side of the menu object there are options to display the <strong>Console</strong>, <strong>Hierarchy</strong>, <strong>Inspector</strong>, <strong>Locked Objects</strong>, <strong>MiniWorld</strong> and <strong>Profiler</strong> panels:</span></li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/252da0f6-8be2-4779-95f9-c480a27e1848.png" style="width:13.75em;height:15.25em;"/></p>
<ol start="10">
<li>You can choose the <span class="ScreenTextPACKT"><span class="packt_screen">Primatives</span></span> menu where you can create new 3D objects:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/9d1278e2-8370-40c3-aeff-9a1b50d9d616.png" style="width:24.75em;height:16.33em;"/></p>
<ol start="11">
<li>With a GameObject selected, a wheel-menu offers actions, such as deleting or selecting the parent, and so on:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/daf5e253-5abc-4994-a196-e00930081c13.png" style="width:18.50em;height:17.42em;"/></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>In this recipe, you learned how to install and start interacting with Unity's <span class="ScreenTextPACKT"><span class="packt_screen">Editor-XR</span></span>.</p>
<div class="packt_infobox">This was tested with <span class="ScreenTextPACKT"><span class="packt_screen">Unity 2017.4.9 LTS</span></span>, since it wasn't fully working with a 2018 version at the time of writing.</div>
<p>You can learn more about <span class="ScreenTextPACKT"><span class="packt_screen">Editor XR/VR</span></span> at the Unity blog at <span class="URLPACKT"><a href="https://blogs.unity3d.com/2016/12/15/editorvr-experimental-build-available-today/">https://blogs.unity3d.com/2016/12/15/editorvr-experimental-build-available-today/</a><a href="https://blogs.unity3d.com/2016/12/15/editorvr-experimental-build-available-today/">.</a></span></p>


            </article>

            
        </section>
    </body></html>