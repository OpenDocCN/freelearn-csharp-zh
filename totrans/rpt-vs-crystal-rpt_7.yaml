- en: Chapter 7. Working with Charts
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第7章。与图表一起工作
- en: In this chapter we will see how to use charts in Crystal Reports. Crystal Reports
    supports many types of charts but we will create four reports that contain different
    samples of charts.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将看到如何在Crystal Reports中使用图表。Crystal Reports支持许多类型的图表，但我们将创建包含不同图表样本的四个报告。
- en: 'We will cover:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将涵盖：
- en: Types of charts
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 图表类型
- en: Creating charts
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建图表
- en: Using the Chart Expert
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用图表专家
- en: 'We will use the same data table in our reports and see how to display this
    data in different charts. The first report will display data in a bar chart as
    we can see in the following screenshot:'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将在我们的报告中使用相同的数据表，并查看如何以不同的图表显示这些数据。第一份报告将以柱形图的形式显示数据，正如以下截图所示：
- en: '![Working with Charts](img/8026EN_07_01.jpg)'
  id: totrans-7
  prefs: []
  type: TYPE_IMG
  zh: '![与图表一起工作](img/8026EN_07_01.jpg)'
- en: 'The second report will display data in a pie chart as we can see in the following
    screenshot:'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 第二份报告将以饼图的形式显示数据，正如我们在以下截图中所见：
- en: '![Working with Charts](img/8026EN_07_02.jpg)'
  id: totrans-9
  prefs: []
  type: TYPE_IMG
  zh: '![与图表一起工作](img/8026EN_07_02.jpg)'
- en: 'The third report will display data in a gauge chart as we can see in the following
    screenshot:'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 第三份报告将以仪表图的形式显示数据，正如我们在以下截图中所见：
- en: '![Working with Charts](img/8026EN_07_03.jpg)'
  id: totrans-11
  prefs: []
  type: TYPE_IMG
  zh: '![与图表一起工作](img/8026EN_07_03.jpg)'
- en: 'In the final report, we will see how to display different charts in one report.
    Refer to the following screenshot:'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 在最终报告中，我们将看到如何在一份报告中显示不同的图表。请参考以下截图：
- en: '![Working with Charts](img/8026EN_07_04.jpg)'
  id: totrans-13
  prefs: []
  type: TYPE_IMG
  zh: '![与图表一起工作](img/8026EN_07_04.jpg)'
- en: Creating the reports data source
  id: totrans-14
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建报告数据源
- en: In this section we will create the data source that we will use in all the reports
    in this chapter. All the reports in this chapter display the relation between
    employees and orders. These reports display the number of orders for each employee.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将创建我们将用于本章所有报告的数据源。本章的所有报告都显示了员工与订单之间的关系。这些报告显示了每个员工的订单数量。
- en: The SQL query that we will use in our report looks like the following screenshot:![Creating
    the reports data source](img/8026EN_07_05.jpg)
  id: totrans-16
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们在报告中使用的SQL查询如下截图所示：![创建报告数据源](img/8026EN_07_05.jpg)
- en: We will create a new TableAdapter using the previous SQL query and we will name
    it `EmployeeOrdersTableAdapter`, as shown the following screenshot:![Creating
    the reports data source](img/8026EN_07_06.jpg)
  id: totrans-17
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们将使用之前的SQL查询创建一个新的TableAdapter，并将其命名为`EmployeeOrdersTableAdapter`，如下截图所示：![创建报告数据源](img/8026EN_07_06.jpg)
- en: Creating the first report – bar chart
  id: totrans-18
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建第一个报告 – 柱形图
- en: Let's start to create the first chart report. We will start with a bar chart.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们开始创建第一个图表报告。我们将从柱形图开始。
- en: Add a new Crystal Reports to our application and name it `crEmpPerBar`. We will
    choose the **As a Blank Report** option to see how we can add or modify our chart
    at any time after the report creation.
  id: totrans-20
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 向我们的应用程序添加一个新的Crystal Reports，并将其命名为`crEmpPerBar`。我们将选择**作为一个空白报告**选项，以了解我们如何在报告创建后随时添加或修改我们的图表。
- en: Right-click on **Database Fields** in **Field Explorer** and select the **Database
    Expert** option. As shown in the following screenshot, we will select our TableAdapter
    **EmployeeOrders** as a data source:![Creating the first report – bar chart](img/8026EN_07_07.jpg)
  id: totrans-21
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 右键点击**字段资源管理器**中的**数据库字段**，并选择**数据库专家**选项。正如以下截图所示，我们将选择我们的TableAdapter **EmployeeOrders**作为数据源：![创建第一个报告
    – 柱形图](img/8026EN_07_07.jpg)
- en: Right-click on the report and navigate to **Insert** | **Chart** and drag it
    in **Section1 (Report Header)**. As we can see in the following screenshot, in
    the **Type** tab we will select **Bar** as a chart type and **Side by side bar
    chart** as the type of bar chart, from the submenu that comes up in the right
    window:![Creating the first report – bar chart](img/8026EN_07_08.jpg)
  id: totrans-22
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 右键点击报告，导航到**插入** | **图表**，并将其拖入**Section1（报告页眉）**。正如以下截图所示，在**类型**选项卡中，我们将选择**柱形图**作为图表类型，并从右窗口出现的下拉菜单中选择**并列柱形图**![创建第一个报告
    – 柱形图](img/8026EN_07_08.jpg)
- en: Navigate to the **Data** tab as we can see in the following screenshot:![Creating
    the first report – bar chart](img/8026EN_07_09.jpg)
  id: totrans-23
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到**数据**选项卡，正如以下截图所示：![创建第一个报告 – 柱形图](img/8026EN_07_09.jpg)
- en: In this step we will see how to display data in a bar chart. We need to display
    the name of the employee on the X-axis and the numbers of orders on the Y-axis.
    We will add the **EmployeeOrders.fullName** field to the upper-right list to display
    it on the X-axis and add the **EmployeeOrders.Quantity** field to the lower list
    to display it on the Y-axis. We can display only a specific number of employees
    using the **TopN** button as we have seen before in **Cross-Tab**. We will keep
    the other options in the other tabs and click on the **OK** button.
  id: totrans-24
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在此步骤中，我们将看到如何以柱状图的形式显示数据。我们需要在X轴上显示员工姓名，在Y轴上显示订单数量。我们将把**EmployeeOrders.fullName**字段添加到右上角的列表中，以便在X轴上显示，并将**EmployeeOrders.Quantity**字段添加到下方的列表中，以便在Y轴上显示。我们可以使用**TopN**按钮仅显示特定数量的员工，就像我们在**交叉表**中看到的那样。我们将保持其他选项在其他选项卡中，并点击**确定**按钮。
- en: We want to filter the orders by a period of date so we will add two filter parameters
    to our report with type **Date**. We will name the first parameter `pmFrom` and
    the second one `pmTo`. Have a look at the following screenshot to see the filter
    code:![Creating the first report – bar chart](img/8026EN_07_10.jpg)
  id: totrans-25
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们想按日期段过滤订单，因此我们将向报告中添加两个类型为**日期**的过滤器参数。我们将第一个参数命名为`pmFrom`，第二个参数命名为`pmTo`。查看以下截图以了解过滤器代码：![创建第一个报告
    – 柱状图](img/8026EN_07_10.jpg)
- en: Go to the main form and double-click on the **btnBarChart** button (**Bar chart**)
    to navigate to the code window behind it. Write the code as shown in the following
    screenshot for the `click` event:![Creating the first report – bar chart](img/8026EN_07_11.jpg)
  id: totrans-26
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 转到主表单，双击**btnBarChart**按钮（**柱状图**）以导航到其背后的代码窗口。为`click`事件编写如图下截图所示的代码：![创建第一个报告
    – 柱状图](img/8026EN_07_11.jpg)
- en: Run the application to test the result. Enter the **from** and **to** dates
    as shown in the following screenshot:![Creating the first report – bar chart](img/8026EN_07_12.jpg)
  id: totrans-27
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 运行应用程序以测试结果。输入如图下截图所示的**从**和**到**日期：![创建第一个报告 – 柱状图](img/8026EN_07_12.jpg)
- en: Click on the **Bar chart** button to see the report result as shown in the following
    screenshot:![Creating the first report – bar chart](img/8026EN_07_13.jpg)
  id: totrans-28
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**柱状图**按钮，查看如图下截图所示的报告结果：![创建第一个报告 – 柱状图](img/8026EN_07_13.jpg)
- en: Now we will see how to update our report to get the required report, which we
    designed at the beginning of this chapter.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们将看到如何更新我们的报告以获取我们在本章开头设计的所需报告。
- en: Removing the legend
  id: totrans-30
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 移除图例
- en: 'The legend is the box that appears on the right side as shown in the previous
    screenshot; by default it''s displayed beside the chart. In the following steps
    we will see how to remove it:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 图例是如图下截图所示出现在右侧的框；默认情况下，它显示在图表旁边。在以下步骤中，我们将看到如何移除它：
- en: Right-click on the chart and navigate to **Chart Options** | **General**. Navigate
    to the **Legend** tab as shown in the following screenshot:![Removing the legend](img/8026EN_07_14.jpg)
  id: totrans-32
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 右键点击图表，导航到**图表选项** | **常规**。导航到**图例**选项卡，如图下截图所示：![移除图例](img/8026EN_07_14.jpg)
- en: Uncheck the **Show Legend** checkbox. The dialog has many options that you can
    use. Try to change these options and test the result. Click on the **OK** button.
  id: totrans-33
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 取消选择**显示图例**复选框。对话框有许多可用的选项。尝试更改这些选项并测试结果。点击**确定**按钮。
- en: Removing the chart's title
  id: totrans-34
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 移除图表的标题
- en: 'In the next few steps we will see how to remove or change the default chart
    title:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 在接下来的几个步骤中，我们将看到如何移除或更改默认的图表标题：
- en: Right-click on our chart and navigate to **Chart Options** | **Titles**, as
    shown in the following screenshot:![Removing the chart's title](img/8026EN_07_15.jpg)
  id: totrans-36
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 右键点击我们的图表，导航到**图表选项** | **标题**，如图下截图所示：![移除图表标题](img/8026EN_07_15.jpg)
- en: Clear the **Title** textbox and the **Group Title** textbox. Click on the **OK**
    button.
  id: totrans-37
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 清除**标题**文本框和**分组标题**文本框。点击**确定**按钮。
- en: Changing the chart's appearance
  id: totrans-38
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 更改图表的外观
- en: 'The Crystal Reports allows us to modify the appearance of our charts to meet
    the user requirements. In the following steps we will see how to achieve this:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: Crystal Reports 允许我们修改图表的外观以满足用户需求。在以下步骤中，我们将看到如何实现这一点：
- en: Right-click on our chart and navigate to **Chart Options** | **General**.
  id: totrans-40
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 右键点击我们的图表，导航到**图表选项** | **常规**。
- en: Navigate to the **Appearance** tab; update the appearance properties as shown
    in the following screenshot:![Changing the chart's appearance](img/8026EN_07_16.jpg)
  id: totrans-41
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到**外观**选项卡；更新外观属性，如图下截图所示：![更改图表的外观](img/8026EN_07_16.jpg)
- en: Select the **Use Depth** checkbox. Change the **Depth** value as shown in the
    preceding screenshot.
  id: totrans-42
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择**使用深度**复选框。更改**深度**值，如图所示。
- en: Resize the chart size in the report to fit the report width.
  id: totrans-43
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 调整报告中的图表大小以适应报告宽度。
- en: Run the application to test the result; we will see that the report is the same
    as the one we had designed before.
  id: totrans-44
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 运行应用程序以测试结果；我们将看到报告与之前设计的相同。
- en: Creating the second report – pie chart
  id: totrans-45
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建第二个报告 – 饼图
- en: 'The second chart report that we will create is a pie chart. Let''s start the
    work:'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 我们接下来要创建的第二个图表报告是一个饼图。让我们开始工作：
- en: Add a new Crystal Reports to our application and name it `crEmpPerPie`. We will
    choose the **As a Blank Report** option.
  id: totrans-47
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将一个新的Crystal Reports添加到我们的应用程序中，命名为`crEmpPerPie`。我们将选择**作为一个空白报告**选项。
- en: Right-click on **Database Fields** in **Field Explorer** and select **Database
    Expert**. We will choose our TableAdapter **EmployeeOrders** as a data source.
  id: totrans-48
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 右键点击**字段资源管理器**中的**数据库字段**并选择**数据库专家**。我们将选择我们的TableAdapter **EmployeeOrders**作为数据源。
- en: Right-click on the report and navigate to **Insert** | **Chart** and drag it
    in **Section1 (Report Header)**. As shown in the following screenshot, in the
    **Type** tab we will select **Pie** as a chart type:![Creating the second report
    – pie chart](img/8026EN_07_17.jpg)
  id: totrans-49
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 右键点击报告并导航到**插入** | **图表**，将其拖入**Section1（报告页眉）**。如图所示，在**类型**选项卡中，我们将选择**饼图**作为图表类型：![创建第二个报告
    – 饼图](img/8026EN_07_17.jpg)
- en: Move to the **Data** tab and select the data fields as we did in the previous
    report. Click on the **OK** button.
  id: totrans-50
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 移动到**数据**选项卡并选择数据字段，就像我们在之前的报告中做的那样。点击**确定**按钮。
- en: Add two **date** filters as we did in the previous report.
  id: totrans-51
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 添加两个**日期**过滤器，就像我们在之前的报告中做的那样。
- en: Go to the main form and double-click on the **btnPieChart** button (**Pie chart**)
    to navigate to the code window behind it. Write the code as shown in the following
    screenshot for the `click` event:![Creating the second report – pie chart](img/8026EN_07_18.jpg)
  id: totrans-52
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 转到主窗体，双击**btnPieChart**按钮（**饼图**）以导航到其背后的代码窗口。为`click`事件编写如图所示的代码：![创建第二个报告
    – 饼图](img/8026EN_07_18.jpg)
- en: Run the application to test the result. We will see the report result as shown
    in the following screenshot:![Creating the second report – pie chart](img/8026EN_07_19.jpg)
  id: totrans-53
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 运行应用程序以测试结果。我们将看到如图所示的报告结果：![创建第二个报告 – 饼图](img/8026EN_07_19.jpg)
- en: Now we will see how to update our report to meet the required report that we
    designed at the beginning of this chapter.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们将看到如何更新我们的报告以满足我们在本章开头设计的所需报告。
- en: Removing the legend
  id: totrans-55
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 删除图例
- en: 'In the next few steps we will remove the legend as we did before with the bar
    chart:'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 在接下来的几个步骤中，我们将像之前处理条形图那样删除图例：
- en: Right-click on our chart and navigate to **Chart Options** | **General**.
  id: totrans-57
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 右键点击我们的图表并导航到**图表选项** | **常规**。
- en: Navigate to the **Legend** tab.
  id: totrans-58
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到**图例**选项卡。
- en: Unselect the **Show Legend** checkbox.
  id: totrans-59
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 取消选择**显示图例**复选框。
- en: Click on the **OK** button.
  id: totrans-60
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**确定**按钮。
- en: Removing the chart's title
  id: totrans-61
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 删除图表的标题
- en: In the next few steps we will remove the chart's title again, as we did before
    with the bar chart.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 在接下来的几个步骤中，我们将再次删除图表的标题，就像我们之前处理条形图时做的那样。
- en: Right-click on our chart and navigate to **Chart Options** | **Titles**.
  id: totrans-63
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 右键点击我们的图表并导航到**图表选项** | **标题**。
- en: Clear the **Title** textbox.
  id: totrans-64
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 清除**标题**文本框。
- en: Click on the **OK** button.
  id: totrans-65
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**确定**按钮。
- en: Changing the chart's appearance
  id: totrans-66
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 更改图表的外观
- en: 'We will change the chart''s appearance as we did before with the bar chart
    by performing the following steps:'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将按照之前处理条形图的方式更改图表的外观，执行以下步骤：
- en: Right-click on our chart and navigate to **Chart Options** | **General**.
  id: totrans-68
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 右键点击我们的图表并导航到**图表选项** | **常规**。
- en: Navigate to the **Appearance** tab; update the appearance properties as shown
    in the following screenshot:![Changing the chart's appearance](img/8026EN_07_20.jpg)
  id: totrans-69
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到**外观**选项卡；更新外观属性，如图所示：![更改图表的外观](img/8026EN_07_20.jpg)
- en: Resize the chart size in the report to fit the report width.
  id: totrans-70
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 调整报告中的图表大小以适应报告宽度。
- en: Creating the third report – gauge chart
  id: totrans-71
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建第三个报告 – 仪表图
- en: 'The next chart report that we will create is a gauge chart report. Let''s start:'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 我们接下来要创建的下一个图表报告是一个仪表图报告。让我们开始：
- en: Add a new Crystal Reports to our application and name it `crEmpPerGauge`. We
    will choose the **As a Blank Report** option.
  id: totrans-73
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将一个新的Crystal Reports添加到我们的应用程序中，命名为`crEmpPerGauge`。我们将选择**作为一个空白报告**选项。
- en: Right-click on **Database Fields** in **Field Explorer** and navigate to **Database
    Expert**. We will choose our TableAdapter **EmployeeOrders** as a data source.
  id: totrans-74
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**字段资源管理器**中右键单击**数据库字段**，然后导航到**数据库专家**。我们将选择我们的TableAdapter **EmployeeOrders**作为数据源。
- en: Right-click on the report and navigate to **Insert** | **Chart** and drag it
    in **Section1 (Report Header)**. As shown in the following screenshot, in the
    **Type** tab we will select **Gauge** as a chart type:![Creating the third report
    – gauge chart](img/8026EN_07_21.jpg)
  id: totrans-75
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 右键单击报告，然后导航到**插入** | **图表**，并将其拖动到**Section1（报告页眉）**。如图所示，在**类型**选项卡中，我们将选择**仪表图**作为图表类型：![创建第三个报告
    – 仪表图](img/8026EN_07_21.jpg)
- en: Navigate to the **Data** tab and choose the data fields as we did in the first
    report. Click on the **OK** button.
  id: totrans-76
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到**数据**选项卡，并选择数据字段，就像我们在第一个报告中做的那样。点击**确定**按钮。
- en: Add the two **date** filters as we did in the first report.
  id: totrans-77
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 添加两个**日期**过滤器，就像我们在第一个报告中做的那样。
- en: Go to main form and double-click on **btnGaugeChart** button (**Gauge chart**)
    to navigate to the code window behind it. Write the code as shown in the following
    screenshot for the `click` event:![Creating the third report – gauge chart](img/8026EN_07_22.jpg)
  id: totrans-78
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 前往主表单，双击**btnGaugeChart**按钮（**仪表图**）以导航到其背后的代码窗口。为`click`事件编写如下截图所示的代码：![创建第三个报告
    – 仪表图](img/8026EN_07_22.jpg)
- en: Run the application to test the result. We will see the report result as shown
    in the following screenshot:![Creating the third report – gauge chart](img/8026EN_07_23.jpg)
  id: totrans-79
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 运行应用程序以测试结果。我们将看到如下截图所示的报告结果：![创建第三个报告 – 仪表图](img/8026EN_07_23.jpg)
- en: Now we will see how to update our report to meet the report that we had designed
    at the beginning of this chapter.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们将了解如何更新我们的报告以满足我们在本章开头设计的报告。
- en: Removing the legend
  id: totrans-81
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 移除图例
- en: 'In the next few steps we will remove the legend as we did before with the bar
    chart:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 在接下来的几个步骤中，我们将像之前处理柱状图那样移除图例：
- en: Right-click on our chart and navigate to **Chart Options** | **General**.
  id: totrans-83
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 右键单击我们的图表，然后导航到**图表选项 | 一般**。
- en: Navigate to the **Legend** tab.
  id: totrans-84
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到**图例**选项卡。
- en: Deselect the **Show Legend** checkbox.
  id: totrans-85
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 取消选择**显示图例**复选框。
- en: Click on the **OK** button.
  id: totrans-86
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**确定**按钮。
- en: Removing the chart's title
  id: totrans-87
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 移除图表的标题
- en: 'In the next few steps we will remove the chart''s title as we did before with
    the bar chart:'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 在接下来的几个步骤中，我们将像之前处理柱状图那样移除图表的标题：
- en: Right-click on our chart and navigate to **Chart Options** | **Titles**.
  id: totrans-89
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 右键单击我们的图表，然后导航到**图表选项** | **标题**。
- en: Clear the **Title** textbox.
  id: totrans-90
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 清除**标题**文本框。
- en: Click on the **OK** button.
  id: totrans-91
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**确定**按钮。
- en: Changing the chart's appearance
  id: totrans-92
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 更改图表的外观
- en: 'We will change the chart''s appearance as we did before with the bar chart
    by performing the following steps:'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将通过以下步骤更改图表的外观，就像之前处理柱状图那样：
- en: Right-click on our chart and navigate to **Chart Options | General**.
  id: totrans-94
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 右键单击我们的图表，然后导航到**图表选项 | 一般**。
- en: Navigate to the **Appearance** tab; update the appearance properties as shown
    in the following screenshot:![Changing the chart's appearance](img/8026EN_07_24.jpg)
  id: totrans-95
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到**外观**选项卡；更新外观属性，如下截图所示：![更改图表的外观](img/8026EN_07_24.jpg)
- en: Resize the chart size in the report to fit the report width.
  id: totrans-96
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在报告中调整图表大小以适应报告宽度。
- en: Creating the fourth report – all in one
  id: totrans-97
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建第四个报告 – 一体化
- en: In this report we use different charts in one report and display the data with
    the charts.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 在本报告中，我们在一个报告中使用不同的图表，并使用图表显示数据。
- en: Add new Crystal Reports to our application and name it `crEmpAllInOne`. We will
    choose the **As a Blank Report** option.
  id: totrans-99
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 向我们的应用程序添加新的Crystal Reports，并将其命名为`crEmpAllInOne`。我们将选择**作为一个空白报告**选项。
- en: Right-click on **Database Fields** in **Field Explorer** and choose **Database
    Expert**. We will choose our TableAdapter **EmployeeOrders** as a data source.
  id: totrans-100
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**字段资源管理器**中右键单击**数据库字段**并选择**数据库专家**。我们将选择我们的TableAdapter **EmployeeOrders**作为数据源。
- en: Right-click on the report and navigate to **Insert** | **Chart** and drag it
    in **Section1 (Report Header)**. In the **Type** tab we will select **Bar** and
    resize the chart to fit the width of the report.
  id: totrans-101
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 右键单击报告，然后导航到**插入** | **图表**，并将其拖动到**Section1（报告页眉）**。在**类型**选项卡中，我们将选择**柱状图**并调整图表大小以适应报告宽度。
- en: Right-click on the report and navigate to **Insert** | **Chart** and drag it
    in **Section1 (Report Header)**. In **Type** tab we will select **Pie** as a chart
    type and locate it under the **Bar** chart and resize the chart to fit the width
    of the report.
  id: totrans-102
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 右键单击报告，然后导航到**插入** | **图表**，并将其拖动到**Section1（报告页眉）**。在**类型**选项卡中，我们将选择**饼图**作为图表类型，并将其定位在**柱状图**下方，调整图表大小以适应报告宽度。
- en: Right-click on the report and navigate to **Insert | Chart** and drag it in
    **Section1 (Report Header)**. In **Type** tab we will select **Gauge** as a chart
    type. Locate it under the **Pie** chart and resize the chart to fit the width
    of the report.
  id: totrans-103
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 右键点击报告，导航到**插入 | 图表**并将它拖入**Section1（报告页眉）**。在**类型**选项卡中，我们将选择**仪表**作为图表类型。在**饼图**下找到它，并调整图表大小以适应报告的宽度。
- en: Update the appearance of all the three charts as we did before.
  id: totrans-104
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 更新所有三个图表的外观，就像我们之前做的那样。
- en: Add two **date** filters as we did in the previous report.
  id: totrans-105
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 添加两个**日期**过滤器，就像我们在上一个报告中做的那样。
- en: Drag-and-drop the report fields to the **Details** section and format them as
    shown in the following screenshot.![Creating the fourth report – all in one](img/8026EN_07_25.jpg)
  id: totrans-106
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将报告字段拖放到**详细信息**部分，并按照以下截图所示进行格式化。![创建第四个报告 – 全部在一个中](img/8026EN_07_25.jpg)
- en: Go to main form and double-click on the **btnAllInOne** button (**All In One**)
    to move to the code window behind it. Write the code as shown in the following
    screenshot for the `click` event:![Creating the fourth report – all in one](img/8026EN_07_26.jpg)
  id: totrans-107
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 前往主窗体，双击**btnAllInOne**按钮（**全部在一个中**）以进入其背后的代码窗口。为`click`事件编写以下截图所示的代码：![创建第四个报告
    – 全部在一个中](img/8026EN_07_26.jpg)
- en: Run the application to test the result. It will be the same as the report we
    designed earlier.
  id: totrans-108
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 运行应用程序以测试结果。它将与我们之前设计的报告相同。
- en: Summary
  id: totrans-109
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: In this chapter we learned how to use charts to build fantastic and powerful
    reports. We have seen that Crystal Reports support many types of charts and how
    easy it is to use these charts.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: '在本章中，我们学习了如何使用图表构建出色且强大的报告。我们看到了Crystal Reports支持许多类型的图表，以及使用这些图表是多么容易。 '
- en: This chapter was the last one in our book. We learned how to create a reporting
    application from beginning to the end. I tried to give knowledge to the reader
    not only about tools such as Crystal Reports but also tried to teach them the
    skills and techniques that may help them to use these tools quickly and easily.
    We have seen how to design the application, and what tools we can use to create
    our application. We learned how to install our tools, how to use each tool, and
    how these tools communicate with each other. We learned Crystal Reports tools
    such as database expert, parameters, grouping, sorting, lines, and boxes. We learned
    to create different types of reports such as tabular, cross-tab and charts, and
    how to mix these types in one report. We learned how to display our reports in
    Visual Studio and passing parameter values dynamically using C# code.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 这本书的最后一章。我们学习了如何从头到尾创建一个报告应用程序。我试图向读者提供关于Crystal Reports等工具的知识，同时也尝试教授他们可能帮助他们快速轻松使用这些工具的技能和技术。我们学习了如何设计应用程序，以及我们可以使用哪些工具来创建我们的应用程序。我们学习了如何安装我们的工具，如何使用每个工具，以及这些工具之间是如何相互通信的。我们学习了Crystal
    Reports工具，如数据库专家、参数、分组、排序、线条和框。我们学习了如何创建不同类型的报告，如表格、交叉表和图表，以及如何在一份报告中混合这些类型。我们学习了如何在Visual
    Studio中显示我们的报告，并使用C#代码动态传递参数值。
