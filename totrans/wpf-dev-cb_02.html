<html><head></head><body>
        

                            
                    Using WPF Standard Controls
                
            
            
                
<p>In this chapter, we will cover the following recipes:</p>
<ul>
<li>Using the <kbd>TextBlock</kbd> control to add plain text</li>
<li>Using <kbd>Label</kbd> to add other controls in text</li>
<li>Providing a user option to input text</li>
<li>Adding images in your application UI</li>
<li>Working with ready-to-use 2D shapes</li>
<li>Adding tooltips to show additional information</li>
<li>Adding a standard menu to the WPF application</li>
<li>Providing extra functionalities using the context menu</li>
<li>Adding user options with radio buttons and checkboxes</li>
<li>Working with the progress bar control</li>
<li>Using the <kbd>Slider</kbd> control to pick a numeric value</li>
<li>Using the calendar control in your application</li>
<li>Listing items in a <kbd>ListBox</kbd> control</li>
<li>Providing options to select from a ComboBox</li>
<li>Adding a status bar to your window</li>
<li>Adding a toolbar panel to perform quick tasks</li>
</ul>
<h1 id="uuid-b5262cf2-c4d3-4360-8aa6-f73b9d0df74b">Introduction</h1>
<p>Every UI Framework must provide the standard controls to design the application UI and <strong>Windows Presentation Foundation</strong> (<strong>WPF</strong>) is one of them. WPF provides a set of standard controls and UI elements such as <kbd>TextBlock</kbd>, <kbd>TextBox</kbd>, <kbd>Button</kbd>, <kbd>Image</kbd>, various shapes, <kbd>ProgressBar</kbd>, <kbd>Slider</kbd>, various menus, <kbd>Toolbar</kbd>, <kbd>ListBox</kbd>, <kbd>ComboBox</kbd>, <kbd>DataGrid</kbd>, and more.</p>
<p>As you can see from the following diagram, UI controls can be of two typesâ€”<strong>ItemsControl</strong> and <strong>ContentControl</strong>, which inherit from <kbd>Control</kbd> class. All the panels available in WPF share the same base class <kbd>Panel</kbd>. The <kbd>Control</kbd> and <kbd>Panel</kbd> class have the base <strong>FrameworkElement</strong>, which again inherits from the <strong>UIElement</strong>. It has the base class as the <strong>DependencyObject</strong> and the superbase as the <strong>Object</strong>:</p>
<div><div><img src="img/e83d2e8a-1116-4709-be6b-2f19213d7589.png" style=""/></div>
</div>
<p>Every control has some common set of properties exposed. This includes <kbd>FontFamily</kbd>, <kbd>FontSize</kbd>, <kbd>FontStyle</kbd>, <kbd>Foreground</kbd>, <kbd>Background</kbd>, <kbd>BorderBrush</kbd>, <kbd>BorderThickness</kbd>, and more. Every framework element exposes additional properties such as <kbd>Width</kbd>, <kbd>MaxWidth</kbd>, <kbd>MinWidth</kbd>, <kbd>ToolTip</kbd>, <kbd>Height</kbd>, <kbd>Name</kbd>, <kbd>Language</kbd>, <kbd>Margin</kbd>, and more. When using any element in the UI, you will use these common properties to set the UIElement's style and other parameters.</p>
<h1 id="uuid-79d1981e-52e2-4974-ade6-6a0880767c2f">Using the TextBlock control to add plain text</h1>
<p>The <kbd>TextBlock</kbd> control in WPF is a lightweight UI element, which is used to display text content to the screen. Almost everywhere, you will use this element in your application UI to display plain text in a single line or a multiline format. To add simple plain text, you can either write <kbd>&lt;TextBlock Text="Text message" /&gt;</kbd> or <kbd>&lt;TextBlock&gt;Text message&lt;/TextBlock&gt;</kbd> in your XAML page.</p>
<p>In this recipe, we will explore more about this UI element.</p>
<h2 id="uuid-398a3a34-27f8-4b90-871e-32a62a3185b4">Getting ready</h2>
<p>To get started, open your Visual Studio IDE, and create a new WPF project called <kbd>CH02.TextBlockDemo</kbd>.</p>
<h2 id="uuid-5bc80922-f9ad-444d-9165-faaed544a89f">How to do it...</h2>
<p>Now open the <kbd>MainWindow.xaml</kbd>, and follow these steps to add <kbd>TextBlock</kbd> control with various formatting options:</p>
<ol>
<li>First, change the pre-existing <kbd>Grid</kbd> panel to a <kbd>StackPanel</kbd>.</li>
<li>Now add the following two <kbd>TextBlock</kbd> controls to it, which will have plain text in them:</li>
</ol>
<pre style="padding-left: 90px">&lt;TextBlock Text="1. This is a TextBlock control, with 'Text'   <br/>   property" Margin="10 5" /&gt; 
&lt;TextBlock Margin="10 5"&gt; 
   2. This is a TextBlock control, having text as Content 
&lt;/TextBlock&gt; </pre>
<ol start="3">
<li>Add the following XAML to have a few more <kbd>TextBlock</kbd> controls, with some basic text formatting applied to them:</li>
</ol>
<pre style="padding-left: 90px">&lt;TextBlock Text="3. This is a TextBlock control, having text    <br/>           formatting" 
           FontWeight="Bold"  
           FontStyle="Italic"  
           TextDecorations="Underline" 
           Foreground="Red" 
           Margin="10 5" /&gt; 
&lt;TextBlock Text="4. TextBlock with different FontFamily" 
           FontFamily="Lucida Handwriting" 
           FontSize="16" Foreground="Blue" 
           Margin="10 5" /&gt; 
&lt;TextBlock Text="5. This is a TextBlock control, <br/>           having long text<br/>           content, wrapped automatically using <br/>           'TextWrapping' property." 
           TextWrapping="Wrap" 
           Margin="10 5" /&gt; 
&lt;TextBlock Text="6. This is a TextBlock control, <br/>           having long text content, trimmed <br/>           automatically using  <br/>           'TextTrimming' property." 
           TextTrimming="CharacterEllipsis" 
           Margin="10 5" /&gt; </pre>
<ol start="4">
<li>Let's build the project and run it. You will see the following UI on the screen:
<div><img src="img/b3cc071e-0e83-4da9-a642-65145fa8a9ec.png" style=""/></div>
</li>
</ol>
<h2 id="uuid-0de25ca8-c221-4dae-8cbf-4323c552fe98">How it works...</h2>
<p>For the first two <kbd>TextBlock</kbd> controls, the UI will have a plain text on it. The third <kbd>TextBlock</kbd> control will have <strong>Bold</strong>, <strong>Italic</strong>, and <strong>Underline </strong>applied to it, by specifying the <kbd>FontWeight</kbd>, <kbd>FontStyle</kbd>, and <kbd>TextDecoration</kbd> properties of the control. Also, the foreground color of it has been set to <em>red</em>, by specifying the <kbd>Foreground</kbd> property.</p>
<p>You can also set a different font to your <kbd>TextBlock</kbd> control. Use the <kbd>FontFamily</kbd> property to set it. As you can see, the fourth <kbd>TextBlock</kbd> control has a <strong>Lucida Handwriting</strong> font applied to it.</p>
<p>When you have a long text, which is not viewable in a single line, you can either wrap it to multiline or trim it, based on the available space. <kbd>TextWrapping="Wrap"</kbd>, in the fifth <kbd>TextBlock</kbd> spans it to multiline. Try making the window bigger or smaller, and you will see that the <kbd>TextBlock</kbd> automatically adjusts itself to match the available space, whereas, the text of the sixth <kbd>TextBlock</kbd> control trims with the <kbd>TextTrimming</kbd> property set to character ellipsis (three dots at the end). This says that more text is available but it has been <kbd>cropped.</kbd></p>
<p>As an alternative to <kbd>CharacterEllipsis</kbd>, you may use <kbd>WordEllipsis</kbd>, which will trim the text at the end of the last possible word, instead of the last possible character.</p>
<h2 id="uuid-9029ff96-061f-4325-a1fb-5cd8943199e4">There's more...</h2>
<p>The <kbd>TextBlock</kbd> control also supports inline formatting. Just like HTML tags, you can surround a text content with <kbd>Bold</kbd>, <kbd>Italic</kbd>, and <kbd>Underline</kbd> tags to format it, as shown in the following XAML code:</p>
<pre style="padding-left: 60px">&lt;TextBlock Margin="10, 5"&gt; 
    7. TextBlock with &lt;Bold&gt;Bold&lt;/Bold&gt;, &lt;Italic&gt;Italics&lt;/Italic&gt;, &lt;Underline&gt;Underlined&lt;/Underline&gt; text 
&lt;/TextBlock&gt; </pre>
<p>You can also add a line break to a text content, like this:</p>
<pre style="padding-left: 60px">&lt;TextBlock Margin="10, 5"&gt; 
    8. TextBlock with LineBreak&lt;LineBreak/&gt; in between the text 
&lt;/TextBlock&gt; </pre>
<p>The following XAML code demonstrates how to add a hyperlink element to a <kbd>TextBlock</kbd> control that matches the style of your Windows theme:</p>
<pre style="padding-left: 60px">&lt;TextBlock Margin="10, 5"&gt; 
    9. TextBlock with a &lt;Hyperlink NavigateUri="http://www.kunal-chowdhury.com"&gt;Hyperlink&lt;/Hyperlink&gt; text in it 
&lt;/TextBlock&gt; </pre>
<p>The <kbd>NavigateUri</kbd> property is used to define the URL that you wish to navigate to.</p>
<p>You can use the <kbd>Span</kbd> element to set the style of individual text content that includes font style, size, foreground color, and so on. It also allows you to specify other inline elements inside it. The <kbd>Run</kbd> element allows you to style a text content using all the available properties of the <kbd>Span</kbd> element. The following example demonstrates how easy it is to use the <kbd>Span</kbd> and <kbd>Run</kbd> elements inside a <kbd>TextBlock</kbd> control:</p>
<pre style="padding-left: 60px">&lt;TextBlock Margin="10, 5" 
    TextWrapping="Wrap"&gt; 
    10. This is a &lt;Span&gt;&lt;Bold&gt;TextBlock&lt;/Bold&gt;&lt;/Span&gt; control, with &lt;Span Foreground="Brown"&gt;Span&lt;/Span&gt; Elements and &lt;Run TextDecorations="Underline"&gt;Run&lt;/Run&gt; commands in it 
&lt;/TextBlock&gt; </pre>
<p>The <kbd>Span</kbd> element may contain other inline elements, but a <kbd>Run</kbd> element can contain only plain text.</p>
<p>Running the preceding example will result in the following output:</p>
<div><div><img src="img/ac786411-589f-4d00-a3dd-aeb3f4f9b488.png" style=""/></div>
</div>
<h1 id="uuid-e981221c-2190-44a9-b95d-331c5a894f23">Using Label to add other controls in text</h1>
<p>The <kbd>Label</kbd> control is another way of representing text in WPF application. It looks like what <kbd>TextBlock</kbd> control offers, but instead of having only text support, it can also host any kind of other controls. It exposes the <kbd>Content</kbd> property to host text and other controls.</p>
<p>In this recipe, we will explore how to use the <kbd>Label</kbd> control in a  WPF.</p>
<h2 id="uuid-313c85cc-f35e-45e8-aa9b-48292a8727f3">Getting ready</h2>
<p>To get started with this control, open Visual Studio to create an application based on the WPF project template and call it <kbd>CH02.LabelDemo</kbd>.</p>
<h2 id="uuid-80ca68d1-ce83-4e07-877e-ebe1fc7f3806">How to do it...</h2>
<p>Once the project gets created, follow these simple steps to add text in your application UI, using the <kbd>Label</kbd> control:</p>
<ol>
<li>Open the <kbd>MainWindow.xaml</kbd> file to change the application UI.</li>
<li>Replace the existing <kbd>Grid</kbd> panel with the following XAML code:</li>
</ol>
<pre style="padding-left: 90px">&lt;StackPanel Margin="10 10 10 20"&gt; 
    &lt;Label Content="1. This is a Label control" /&gt; 
    &lt;Label Content="2. A Label control with text formatting" 
            FontWeight="Bold" Foreground="Red" 
            FontStyle="Italic"/&gt; 
    &lt;Label&gt; 
        &lt;StackPanel Orientation="Horizontal"&gt; 
            &lt;TextBlock Text="3. A Rectangle" /&gt; 
            &lt;Rectangle Width="20" Height="20" Fill="Red" <br/>            Margin="10 0" /&gt; 
            &lt;TextBlock Text="inside a Label control" /&gt; 
        &lt;/StackPanel&gt; 
    &lt;/Label&gt; 
&lt;/StackPanel&gt; </pre>
<ol start="3">
<li>Now build and run the application. You will see the following output on the screen:
<div><img src="img/c1e62b20-d3d3-47ca-8ed6-12bd94fed2ce.png" style=""/></div>
</li>
</ol>
<h2 id="uuid-3668c806-6da5-4fb4-aa88-690966549f71">How it works...</h2>
<p>The first control added in the <kbd>StackPanel</kbd> is a very basic label, which has plain text as its <kbd>Content</kbd> property. The second <kbd>Label</kbd> control also contains plain text, but has various formatting (such as, <kbd>FontWeight</kbd>, <kbd>Foreground</kbd>, and <kbd>FontStyle</kbd>) applied to it to give it a bold, italic, and red color look to its style.</p>
<p>As the <kbd>Label</kbd> control derives from <kbd>System.Windows.Controls.ContentControl</kbd>, it also supports adding other controls to its content. The third label added to the UI is a little different than the previous two examples. It not only contains text, but also other controls,  such as <kbd>StackPanel</kbd>, <kbd>TextBlock</kbd>, and a <kbd>Rectangle</kbd>, owing to its <kbd>Content</kbd> property.</p>
<p>In the preceding example, for the third label, the <kbd>TextBlock</kbd> control is used to hold the actual text content, and <kbd>StackPanel</kbd> is used as a panel control to hold both the <kbd>TextBlock</kbd> and the <kbd>Rectangle</kbd>.</p>
<p>A point to remember is that <kbd>Label</kbd> is heavier than a <kbd>TextBlock</kbd>. So, when you need to render a plain text on the UI, prefer <kbd>TextBlock</kbd> only.</p>
<h2 id="uuid-1a5b2b8e-f8ec-4c5f-9a76-1bce9d0b8a35">There's more...</h2>
<p>In Windows and other operating systems, it's a widespread practice to access the controls in a window by holding the <em>Alt</em> key and then pressing a character defined as its access key. For example, to open the File menu of any Windows application, we use <em>Alt</em> + <em>F</em>. Here, the character <em>F</em> is the access key, which gets invoked when we press <em>Alt</em>.</p>
<p>Let's learn how to add an access key to labels in the WPF application, using the <kbd>Label</kbd> control. Create a new project called <kbd>CH02.LabelAccessKeyDemo</kbd>, open the <kbd>MainWindow.xaml</kbd> page, and replace the default <kbd>Grid</kbd> by a <kbd>StackPanel</kbd>. Now add two labels and two textboxes inside the <kbd>StackPanel</kbd>, as follows:</p>
<pre style="padding-left: 60px">&lt;StackPanel Margin="10 10 10 20"&gt; 
    &lt;Label Content="Enter _Username:" 
            Target="{Binding ElementName=txbUsername}" /&gt; 
    &lt;TextBox x:Name="txbUsername" Margin="6 0" /&gt; 
 
    &lt;Label Content="Enter _Password:" 
            Target="{Binding ElementName=txbPassword}" /&gt; 
    &lt;TextBox x:Name="txbPassword" Margin="6 0" /&gt; 
&lt;/StackPanel&gt; </pre>
<p>Now run the application. Press <em>Alt</em> + <em>U</em> to activate the access key for the first label, and place the focus on the <kbd>txbUsername</kbd> field. Press <em>Alt</em> + <em>P</em> to automatically focus on the <kbd>txbPassword</kbd> field:</p>
<div><img src="img/2e48a981-b8a1-4b6d-b84a-5c9a13596a5a.png" style=""/></div>
<p>The Windows Form application uses "<kbd>&amp;</kbd>" as its access key specifier, but in the WPF application it's a little different, as it uses XML notation to create the UI. So, in the WPF application, if you want to add an access key specifier to labels, you need to specify <kbd>_</kbd> (underscore) before the character which you want to highlight.</p>
<p>For example, adding <kbd>_</kbd> before the <kbd>U</kbd> in Username, activates the said label when <em>Alt</em> + <em>U</em> is pressed. It's a similar case for the Password field, in the preceding example.</p>
<p>The frequently used practice is to use the first character that's not already used as an access key of another control. But, on a need basis, you can specify any character part of the label content.</p>
<p>The <kbd>Target</kbd> property of the <kbd>Label</kbd> control passes the instruction to the designated control to activate automatically when the access key gets triggered by the user. The <kbd>ElementName</kbd> property, which is present in the binding (<kbd>Target="{Binding ElementName=txbPassword}"</kbd>), tells the name of the control where you want to send the activation instruction.</p>
<h1 id="uuid-9afccfc2-1bcd-4e1f-9b6e-ada166020350">Providing a user option to input text</h1>
<p>The <kbd>TextBox</kbd> control in WPF is used to allow the user to input plain text in a single line or multiline format. A single-line textbox is the commonly used control for form inputs; whereas the multiline textbox is used like an editor.</p>
<h2 id="uuid-7688e53d-69b9-4ad8-ae0f-9ee61be27a07">Getting ready</h2>
<p>Open your Visual Studio IDE, and create a new project named <kbd>CH02.TextBoxDemo</kbd>, based on the WPF application template.</p>
<h2 id="uuid-65cc92c8-4f77-41f1-956d-936f9cd33606">How to do it...</h2>
<p>Once the project gets created, follow the mentioned steps to play with some of the <kbd>TextBox</kbd> properties:</p>
<ol>
<li>Open the <kbd>MainWindow.xaml</kbd> page, and replace the default <kbd>Grid</kbd> with a <kbd>StackPanel</kbd> so that we can add the controls in a stacked fashion.</li>
<li>Now add five <kbd>TextBox</kbd> controls inside the <kbd>StackPanel</kbd>, and set various properties, as follows:</li>
</ol>
<pre style="padding-left: 90px">&lt;StackPanel Margin="10 10 10 20"&gt;<br/>        &lt;TextBox Height="30" Margin="10 5"<br/>                 Text="Hello"/&gt;<br/>        &lt;TextBox Text="Hello WPF!"<br/>                 FontSize="18" Foreground="Blue"<br/>                 FontWeight="Bold"<br/>                 Height="30" Margin="10 5"/&gt;<br/>        &lt;TextBox Text="This is a 'ReadOnly' TextBox control"<br/>                 IsReadOnly="True" Height="30" Margin="10 5"/&gt;<br/>        &lt;TextBox Text="This is a 'Disabled' TextBox control"<br/>                 IsEnabled="False" Height="30" Margin="10 5"/&gt;<br/>        &lt;TextBox TextWrapping="Wrap" AcceptsReturn="True"<br/>                 Height="60" VerticalScrollBarVisibility="Auto"<br/>                 Margin="10 5"&gt;<br/>            This is multiline textbox.<br/>            User can press 'Enter' key to move to next line.<br/>        &lt;/TextBox&gt;<br/>    &lt;/StackPanel&gt;</pre>
<ol start="3">
<li>Run the application so that it has the following UI on the screen:
<div><img src="img/693d146f-aec0-4187-bd03-d11145e6e1ad.png" style=""/></div>
</li>
</ol>
<h2 id="uuid-9e526676-4f66-486d-9414-eec1e2e6f936">How it works...</h2>
<p>The first <kbd>TextBox</kbd> control, which we added to the <kbd>StackPanel</kbd>, is the simplest one, and when it is rendered in the UI, it contains empty text. The user can enter any plain text here. You can also specify text from code, by using the <kbd>Text</kbd> property, as shown in the second control.</p>
<p>You can also define a range of styles for the text of the <kbd>TextBox</kbd> control. As shown in the second control, we specified <kbd>FontSize</kbd>, <kbd>Foreground</kbd>, <kbd>FontWeight</kbd>. You can specify other properties too, as part of any control.</p>
<p>The third one is a <kbd>ReadOnly</kbd> textbox, which you can define by setting the <kbd>IsReadOnly</kbd> property value to <kbd>True</kbd>. When you want to disable a <kbd>TextBox</kbd>, set its <kbd>IsEnabled</kbd> property to <kbd>False</kbd>, as shown in the fourth example.</p>
<p>The fifth example demonstrates how easy it is to define a multiline textbox. Just set its <kbd>AcceptsReturn</kbd> property to <kbd>True</kbd> and <kbd>TextWrapping</kbd> to <kbd>Wrap</kbd>. The control will behave like a multiline text editor.</p>
<h2 id="uuid-7857eda1-498e-41fe-ada6-51d45fe940e3">There's more...</h2>
<p>When you are using <kbd>TextBox</kbd> as a multiline text-input control, don't forget to set its <kbd>VerticalScrollBarVisibility</kbd>. This will allow your user to scroll the text content. As shown in the last example, set it to <kbd>Auto</kbd> to make it enabled on demand, based on its content.</p>
<h3 id="uuid-addde97e-f305-430f-a5d6-1055e97a2f37">Windows Clipboard support</h3>
<p>The <kbd>TextBox</kbd> control automatically supports the <strong>Windows Clipboard</strong>. Right-click on it to see the context menu pop up in the screen with common clipboard functions, such as Select all, Cut, Copy, and Paste. Along with these functions, it also supports the common keyboard shortcuts for clipboard operations, undo/redo, by default.</p>
<h3 id="uuid-1ffd2942-fd04-4c6f-bf57-ef46e957e084">Adding spellcheck support</h3>
<p>The attached <kbd>SpellCheck.IsEnabled</kbd> property allows you to add spellcheck support to the <kbd>TextBox</kbd> control. Set it to <kbd>True</kbd> to enable it. Let's add a multiline textbox in the UI with this feature enabled:</p>
<pre style="padding-left: 60px">&lt;TextBox TextWrapping="Wrap" AcceptsReturn="True" 
         Height="60" VerticalScrollBarVisibility="Auto" 
         SpellCheck.IsEnabled="True" 
         Margin="10 5" /&gt; </pre>
<p>Now run the application to have a window with a multiline text-input field in the UI. Enter some text with some spelling mistakes. You will see that the wrongly spelled words get highlighted with red underline. Right-click on it to see a context menu, which suggests words from the dictionary.</p>
<p>As shown in the following screenshot, select the one that is best suited in this context:</p>
<div><img src="img/19d967d7-39fe-4348-8165-c31aa4f066fd.png" style=""/></div>
<h1 id="uuid-f8c588a5-85fb-42f9-934a-4305c2d4ab52">Adding images to your application UI</h1>
<p>Images are used to create a UI that looks good, with a background, icons, and thumbnails, and they convey more information to the user. In WPF, the <kbd>Image</kbd> element is used to display images. Let's take a look at this.</p>
<h2 id="uuid-8901e4f6-88ce-40c6-9457-da0396278eb3">Getting ready</h2>
<p>To get started with images in WPF, launch your Visual Studio IDE and create a WPF project called <kbd>CH02.ImageDemo</kbd>, and add an image called <kbd>demoImage.jpg</kbd>.</p>
<h2 id="uuid-3d098932-212c-4dbc-8008-879064428170">How to do it...</h2>
<p>Let's follow these steps to add images in the <kbd>MainWindow.xaml</kbd> page:</p>
<ol>
<li>Open the <kbd>MainWindow.xaml</kbd> page, and replace the existing <kbd>Grid</kbd> with a <kbd>StackPanel</kbd>. Set its <kbd>Orientation</kbd> property to <kbd>Horizontal</kbd> so that the items added to this panel stack themselves horizontally.</li>
<li>Add four images to the <kbd>StackPanel</kbd>, and set their <kbd>Source</kbd> property to <kbd>demoImage.jpg</kbd>, which is available within the project directory.</li>
</ol>
<p> </p>
<ol start="3">
<li>Set the width and the height of each image to <kbd>100</kbd>.</li>
<li>For the first image, set its <kbd>Stretch</kbd> property to <kbd>None</kbd>.</li>
<li>For the second image, set its <kbd>Stretch</kbd> property to <kbd>Fill</kbd>.</li>
<li>For the third and fourth images, set their <kbd>Stretch</kbd> property to <kbd>Uniform</kbd> and <kbd>UniformToFill</kbd>, respectively.</li>
<li>Here's the complete XAML code, to which you can refer:</li>
</ol>
<pre style="padding-left: 90px">&lt;StackPanel Orientation="Horizontal"&gt; 
    &lt;Image Source="demoImage.jpg" 
           Stretch="None" 
           Width="100" Height="100"  
           Margin="10 10 5 10" /&gt; 
    &lt;Image Source="demoImage.jpg" 
           Stretch="Fill" 
           Width="100" Height="100"  
           Margin="10 10 5 10" /&gt; 
    &lt;Image Source="demoImage.jpg" 
           Stretch="Uniform" 
           Width="100" Height="100"  
           Margin="10 10 5 10" /&gt; 
    &lt;Image Source="demoImage.jpg" 
           Stretch="UniformToFill" 
           Width="100" Height="100"  
           Margin="10 10 5 10" /&gt; 
&lt;/StackPanel&gt; </pre>
<ol start="8">
<li>Let's build and run the application. You will see the following output in the application UI:
<div><img src="img/3f2a1bb2-785d-412a-98fd-61b871504c94.png" style=""/></div>
</li>
</ol>
<h2 id="uuid-8f511d39-7838-4cbc-b233-af5e33b58e15">How it works...</h2>
<p>In XAML, the <kbd>Source</kbd> property of the <kbd>Image</kbd> control is the path of the image file that you want to display. When you access the same from code, it's a <kbd>BitmapImage</kbd>.</p>
<p>The <kbd>Stretch</kbd> property of an image describes how it should be stretched to fill the destination. For the first image, that we set as <kbd>Stretch= "None"</kbd>, it preserves the original size of the image. When you set it as <kbd>Fill</kbd>, for the second image in the example, the content is resized to fill the destination dimensions without preserving its aspect ratio.</p>
<p>For the third and fourth image, setting it to <kbd>Uniform</kbd> and <kbd>UniformToFill</kbd>, respectively, set its content resized to fit in the destination dimensions while preserving its native aspect ratio. But for the fourth case, if the aspect ratio of the destination image differs from the source, the source content is clipped to fit in the destination dimensions.</p>
<p>The default value of the image <kbd>Stretch</kbd> property is <kbd>Uniform</kbd>. That means, when you add an image to the UI, by default, it sets its content resized to fit in the destination dimensions.</p>
<h2 id="uuid-0718b485-cb0b-4c68-b319-2d5a8ecb300b">There's more...</h2>
<p>You can also set an image in XAML by creating a <kbd>BitmapImage</kbd> instance and assigning it to its <kbd>Source</kbd> property. The <kbd>BitmapImage</kbd> instance exposes the <kbd>UriSource</kbd> property to set the image path. Here's an example of how to set the image source in XAML, using the <kbd>BitmapImage</kbd> element:</p>
<pre style="padding-left: 60px">&lt;Image&gt; 
    &lt;Image.Source&gt; 
        &lt;BitmapImage UriSource="demoImage.jpg" /&gt; 
    &lt;/Image.Source&gt; 
&lt;/Image&gt; </pre>
<p>You can also rotate an image by setting the <kbd>Rotation</kbd> property of <kbd>BitmapImage</kbd>. It contains four values <kbd>Rotate0</kbd>, <kbd>Rotate90</kbd>, <kbd>Rotate180</kbd>, and <kbd>Rotate270</kbd>. Here's an example to demonstrate how to rotate an image by 180 degrees:</p>
<pre style="padding-left: 60px">&lt;Image&gt; 
    &lt;Image.Source&gt; 
        &lt;BitmapImage UriSource="demoImage.jpg" 
                     Rotation="Rotate180"/&gt; 
    &lt;/Image.Source&gt; 
&lt;/Image&gt; </pre>
<p>Additionally, you can also use the <kbd>StretchDirection</kbd> property of an <kbd>Image</kbd> control. The value indicates how the image is scaled. There are three values <kbd>UpOnly</kbd>, <kbd>DownOnly</kbd>, and <kbd>Both</kbd>. The content scales upward, downward, or in both directions, based on the size of the image content.</p>
<h1 id="uuid-814b7459-845e-4bad-8d1c-4dc5b4474899">Working with ready-to-use 2D shapes</h1>
<p>In WPF, a <kbd>Shape</kbd> is an <kbd>UIElement</kbd> that enables you to draw a 2D shape in your application. There are a couple of ready-to-use shapes already provided by WPF, and they are as follows:</p>
<ul>
<li>Rectangle</li>
<li>Ellipse</li>
<li>Line</li>
<li>Polyline</li>
<li>Polygon</li>
<li>Path</li>
</ul>
<p>All of these <kbd>UIElements</kbd> expose some common properties to draw the shape. The <kbd>Stroke</kbd> and <kbd>StrokeThickness</kbd> properties describe the color and the thickness to draw the shape's outline. The <kbd>Fill</kbd> property describes the color used to decorate the interior of the shape.</p>
<p>In this recipe, we will learn how to create various shapes.</p>
<h2 id="uuid-a9e9dd61-1ba1-40ad-9f34-b917fc20c166">Getting ready</h2>
<p>Let's begin with creating a new project. Open your Visual Studio, and create a WPF project called  <kbd>CH02.ShapesDemo</kbd>. As we will be creating multiple shapes, we will be using the <kbd>UniformGrid</kbd> panel to host the shapes in this demonstration. You can learn more about this panel in the next chapter.</p>
<h2 id="uuid-e33ffd51-1bf6-4f1c-bd52-035ea2fd393a">How to do it...</h2>
<p>Follow these steps to create various shapes in your application:</p>
<ol>
<li>Open your <kbd>MainWindow.xaml</kbd> file, and replace the existing <kbd>Grid</kbd> panel with <kbd>UniformGrid</kbd>. Set its maximum columns count to <kbd>3</kbd>, by setting its <kbd>Column</kbd> property.</li>
<li>Let's add our first shape, a <kbd>Rectangle</kbd>. Add the following XAML code inside the <kbd>UniformGrid</kbd>:</li>
</ol>
<pre style="padding-left: 90px">&lt;Rectangle Width="200" Height="100" 
           Stroke="DarkBlue" StrokeThickness="5" 
           Fill="SkyBlue" Margin="10 5" /&gt; </pre>
<ol start="3">
<li>Now let's add an <kbd>Ellipse</kbd>, which you can change to a circle by setting the same value to its <kbd>Height</kbd> and <kbd>Width</kbd> properties. Add the following code to create the ellipse:</li>
</ol>
<pre style="padding-left: 90px">&lt;Ellipse Width="200" Height="100" 
         Stroke="DarkBlue" StrokeThickness="5" 
         Fill="SkyBlue" Margin="10 5" /&gt; </pre>
<ol start="4">
<li>To add a <kbd>Line</kbd> in the panel, add the following XAML:</li>
</ol>
<pre style="padding-left: 90px">&lt;Line X1="10" Y1="80" X2="190" Y2="20" 
      Stroke="DarkBlue" StrokeThickness="5" 
      Margin="10 5" /&gt; </pre>
<ol start="5">
<li><kbd>Polyline</kbd> is a series of connected straight lines. Add the following XAML to easily create a polyline shape, where the line is being drawn based on the data points provided in the <kbd>Points</kbd> property:</li>
</ol>
<pre style="padding-left: 90px">&lt;Polyline Points="10,60 60,180 100,20 180,80 120,140" 
          Stroke="DarkBlue" StrokeThickness="5" 
          Margin="10 5" /&gt; </pre>
<ol start="6">
<li>Similarly, you can add a <kbd>Polygon</kbd> shape to the UI. Add the following code inside the <kbd>UniformGrid</kbd> to draw the shape:</li>
</ol>
<pre style="padding-left: 90px">&lt;Polygon Points="10,60 60,180 100,20 180,80 120,140" 
         Fill="SkyBlue" Stroke="DarkBlue"  
         StrokeThickness="5" Margin="10 5" /&gt;</pre>
<ol start="7">
<li>To add a <kbd>Path</kbd> shape control, add the following XAML code:</li>
</ol>
<pre style="padding-left: 90px">&lt;Path Data="M10,60 60,180 C100,20 180,80 120,140" 
      Stroke="DarkBlue" StrokeThickness="5"  
      Margin="10 5" /&gt; </pre>
<ol start="8">
<li>Now let's build your project and run the application. You will see the following shapes on the screen, as we have added the preceding code:
<div><img src="img/ab6686d8-03b9-4a1d-a145-0a8b80cdd096.png" style=""/></div>
</li>
</ol>
<h2 id="uuid-0f4f3f34-688e-4682-9666-0676b1ebb60c">How it works...</h2>
<p>A rectangular shape is being drawn by setting the <kbd>Height</kbd> and <kbd>Width</kbd> properties of the <kbd>Rectangle</kbd> class, along with the stroke color and the thickness of it. To create a square, you can use this shape by setting its dimension properly.</p>
<p>In the second example, a circular shape has been drawn using the <kbd>Ellipse</kbd> control. It uses the same property sets to create the shape. To make it a complete circle, set its <kbd>Height</kbd> and <kbd>Width</kbd> to the same value.</p>
<p>If you want to draw a straight line in the UI, use the <kbd>Line</kbd> class. It exposes four properties to draw the line. Set the <kbd>X1</kbd> and <kbd>Y1</kbd> properties to mark the starting point; set <kbd>X2</kbd> and <kbd>Y2</kbd> properties to mark the ending point of the line. In the preceding example, a line has been drawn from the  (<kbd>10</kbd>,<kbd>80</kbd>) coordinate point to the (<kbd>190</kbd>,<kbd>20</kbd>) coordinate point.</p>
<p>In the fourth example, we have seen how to create a series of connected straight lines using the <kbd>Polyline</kbd> shape control. You need to set the (<em>X</em>, <em>Y</em>) coordinate points of the lines in its <kbd>Points</kbd> property. In the preceding example, it creates the shape connecting the following coordinate points (<kbd>10</kbd>,<kbd>60</kbd>), (<kbd>60</kbd>,<kbd>180</kbd>), (<kbd>100</kbd>,<kbd>20</kbd>), (<kbd>180</kbd>,<kbd>80</kbd>), and (<kbd>120</kbd>,<kbd>140</kbd>).</p>
<p><kbd>Polygon</kbd> also uses the same concept to draw a series of lines, but it completes the connected series of lines to draw a closed shape.</p>
<p>Using the <kbd>Path</kbd> control, in the sixth example, you can draw a series of connected lines and curves. The <kbd>Data</kbd> property is used to set the geometry that specifies the shape to be drawn. The data points always start with <kbd>M</kbd> to begin drawing the lines. In any part, if you want to create a curve, prefix the character <kbd>C</kbd> at that point.</p>
<h2 id="uuid-f5e91b28-4d0b-404d-ae87-ab50b05ec9bf">There's more...</h2>
<p>The <kbd>PathGeometry</kbd> objects are used to draw lines, curves, arcs, and complex shapes. WPF provides two classes to describe the geometric paths using the mini language <strong>Path Markup Syntax</strong>.</p>
<p>You can learn more about it here:<br/>
 <a href="http://bit.ly/path-markup-syntax">http://bit.ly/path-markup-syntax</a></p>
<p>If you want to draw simple shapes, you can use the <kbd>EllipseGeometry</kbd>, <kbd>LineGeometry</kbd>, and <kbd>RectangleGeometry</kbd> objects. Composite geometries are created by <kbd>GeometryGroup</kbd> and to create combine geometries, use the <kbd>CombineGeometry</kbd>.</p>
<p>Let's take the following example to demonstrate a complex path geometry using a <kbd>PathSegmentCollection</kbd> of three segments:</p>
<pre style="padding-left: 30px">&lt;Path Stroke="DarkBlue" StrokeThickness="5"&gt; 
    &lt;Path.Data&gt; 
        &lt;PathGeometry&gt; 
            &lt;PathGeometry.Figures&gt; 
                &lt;PathFigureCollection&gt; 
                    &lt;PathFigure StartPoint="10,100"&gt; 
                        &lt;PathFigure.Segments&gt; 
                            &lt;PathSegmentCollection&gt; 
                                &lt;ArcSegment Point="40,80" /&gt; 
                                &lt;BezierSegment Point1="100,300"  
                                               Point2="100,-100"  
                                               Point3="200,150" /&gt; 
                                &lt;BezierSegment Point1="100,200"  
                                               Point2="200,-10"  
                                               Point3="100,150" /&gt; 
                            &lt;/PathSegmentCollection&gt; 
                        &lt;/PathFigure.Segments&gt; 
                    &lt;/PathFigure&gt; 
                &lt;/PathFigureCollection&gt; 
            &lt;/PathGeometry.Figures&gt; 
        &lt;/PathGeometry&gt; 
    &lt;/Path.Data&gt; 
&lt;/Path&gt; </pre>
<p>The collection consists of one <kbd>ArcSegment</kbd> and two <kbd>BeizerSegments</kbd> to set the geometry points to draw the following shape, but you can also add additional segments, such as <kbd>LineSegment</kbd>, <kbd>PolyBeizerSegment</kbd>, <kbd>PolyLineSegment</kbd>, <kbd>PolyQuadraticBeizerSegment</kbd>, and <kbd>QuadraticBeizerSegment</kbd> to create a more complex path:</p>
<div><img src="img/a66c8f25-8bc5-43b5-89da-aa953de19b19.png" style=""/></div>
<p>Note that all shapes are stretchable. You can use the <kbd>Stretch</kbd> property to define a shape's stretching behavior. If you set it to <kbd>None</kbd>, the <kbd>Shape</kbd> object will not be stretchable. If you set it to <kbd>Fill</kbd>, <kbd>Uniform</kbd>, or <kbd>UniformToFill</kbd>, the <kbd>Shape</kbd> content will be stretched to fill the space with or without preserving the aspect ratio.</p>
<h1 id="uuid-a707e7b0-8819-4d94-84dc-6baf5f285c96">Adding tooltips to show additional information</h1>
<p>Tooltips are used to show additional information about a specific control or a link when hovering your mouse over it. The <kbd>FrameworkElement</kbd> class exposes a property named <kbd>Tooltip</kbd>, which you can find on all the controls available in WPF.</p>
<p>In this recipe, we will learn how to work with the tooltips in WPF. We will also cover how to design a tooltip using other controls.</p>
<h2 id="uuid-285cc904-d88d-4956-a936-a41e1de339b5">Getting ready</h2>
<p>Open your Visual Studio IDE and create a new WPF application project called <kbd>CH02.TooltipDemo</kbd>.</p>
<h2 id="uuid-5bcc1394-2f15-46b5-99d6-c911e814554d">How to do it...</h2>
<p>Open the <kbd>MainWindow.xaml</kbd> page, and then follow these steps to add simple tooltips to the UI:</p>
<ol>
<li>First, replace the default <kbd>Grid</kbd> with a <kbd>StackPanel</kbd>, and set its <kbd>Orientation</kbd> property to <kbd>Horizontal</kbd> to have some horizontally stacked items.</li>
<li>Add three buttons to the <kbd>StackPanel</kbd>, and set their <kbd>ToolTip</kbd> property. To add a show duration of the tooltip, set its <kbd>ToolTipService.ShowDuration</kbd> attached property to a value in milliseconds. You can use the following XAML as a reference:</li>
</ol>
<pre style="padding-left: 90px">&lt;StackPanel Orientation="Horizontal" 
            HorizontalAlignment="Center" 
            Margin="20"&gt; 
    &lt;Button Content="New" Width="60" Height="30"  
            ToolTip="Create a New file" 
            Margin="4" /&gt; 
    &lt;Button Content="Open" Width="60" Height="30"  
            ToolTip="Open a file" 
            ToolTipService.ShowDuration="2000" 
            Margin="4" /&gt; 
    &lt;Button Content="Save" Width="60" Height="30" 
            ToolTip="Clicking on this button, <br/>            saves the file to disk" 
            Margin="4" /&gt; 
&lt;/StackPanel&gt; </pre>
<ol start="3">
<li>Run the application, and hover over the buttons to see the tooltip pop up on the screen, as shown in the following screenshot:
<div><img src="img/8d2ddd15-8dd4-447a-8b81-f3a657b88836.png" style=""/></div>
</li>
</ol>
<h2 id="uuid-d0f1ffdc-d567-4e82-8bc1-bc237a2bfd5c">How it works...</h2>
<p>The <kbd>ToolTip</kbd> property, when set in any WPF control, gets visible when you hover over the control. Apart from this, the <kbd>ToolTipService</kbd> class has a bunch of attached properties to help you set various behaviors of the tooltip.</p>
<p>Like the second example, as shown earlier, if you hover over the <kbd>Open</kbd> button, the <kbd>Tooltip</kbd> property will be visible on screen for 2 seconds. This is because we set the <kbd>ShowDuration</kbd> property of the <kbd>ToolTipService</kbd> to <kbd>2000</kbd> milliseconds (2 seconds).</p>
<p>You can also use the <kbd>ToolTipService.ShowOnDisabled</kbd> property to show or hide a <kbd>Tooltip</kbd> on an element that is disabled. The <kbd>HasDropShadow</kbd> property of the class ensures whether the <kbd>Tooltip</kbd> will have a shadow on it.</p>
<h2 id="uuid-5a2d8fde-096c-441e-8260-04d426415eb0">There's more...</h2>
<p>As the <kbd>ToolTip</kbd> property is of <kbd>object</kbd> type, you can assign anything to it, including various UI controls. Hence, it helps you to customize the UI of the tooltip with a much richer experience.</p>
<p>Let's modify the <kbd>Tooltip</kbd> property of the third button in the preceding example. Place a few <kbd>TextBlock</kbd> and <kbd>Border</kbd> controls in a <kbd>StackPanel</kbd> to design the UI, as shared in the following XAML code snippet:</p>
<pre style="padding-left: 60px">&lt;Button Content="Save" Width="60" Height="30"  
    Margin="4"&gt; 
    &lt;Button.ToolTip&gt; 
        &lt;StackPanel&gt; 
            &lt;TextBlock FontWeight="Bold" 
                       Text="Save File" /&gt; 
            &lt;TextBlock Text="Clicking on this button, <br/>                       saves the file to disk" 
                       FontSize="10" /&gt; 
            &lt;Border BorderBrush="Silver"  
                    BorderThickness="0,1,0,0"  
                    Margin="0 4" /&gt; 
            &lt;TextBlock FontStyle="Italic" 
                       FontSize="9" 
                       Text="Press F1 for more help" /&gt; 
        &lt;/StackPanel&gt; 
    &lt;/Button.ToolTip&gt; 
&lt;/Button&gt; </pre>
<p>When you run the application, hover over the third button to see the customized UI of the tooltip for that button, as shown in the following screenshot:</p>
<div><img src="img/7fc67f6d-3aa2-4225-8c13-26b74a759b48.png" style=""/></div>
<p>The <kbd>ToolTipService</kbd> class also exposes a few additional properties, such as <kbd>HorizontalOffset</kbd> and <kbd>VerticalOffset</kbd> to position <kbd>Tooltip</kbd> in a specific position on the screen.</p>
<h1 id="uuid-d557cc93-6cfb-4c1f-b1e1-8cc24b071808">Adding a standard menu to the WPF application</h1>
<p>One of the most common parts of WPF applications is the menu, as it gives various options within a very little space. WPF comes with a control named <kbd>Menu</kbd>, to hold items named <kbd>MenuItem</kbd>.</p>
<p>Let's learn more about this menu control and how to add it to Windows applications.</p>
<h2 id="uuid-78ce4937-2aa5-4ed7-a9cc-fb0bbf5d76cf">Getting ready</h2>
<p>Open your Visual Studio, and create a new WPF project called <kbd>CH02.MenuDemo</kbd>.</p>
<h2 id="uuid-e84c5d0e-3e3c-4656-acd0-352da76459e1">How to do it...</h2>
<p>Follow these steps to add menus to your WPF application:</p>
<ol>
<li>Open the <kbd>MainWindow.xaml</kbd> page, and replace the default <kbd>Grid</kbd> with a <kbd>DockPanel</kbd>. We will discuss more about this panel in the next chapter.</li>
<li>Now add the <kbd>Menu</kbd> control inside the <kbd>DockPanel</kbd>. This will create the base to hold all the menu items.</li>
<li>You can then add root-level menu items and sub-menu items in a hierarchical fashion, as shown in the following code snippet:</li>
</ol>
<pre style="padding-left: 90px">&lt;DockPanel&gt; 
    &lt;Menu&gt; 
        &lt;MenuItem Header="File"&gt; 
            &lt;MenuItem Header="New" /&gt; 
            &lt;MenuItem Header="Open" /&gt; 
            &lt;MenuItem Header="Save" /&gt; 
            &lt;Separator /&gt; 
            &lt;MenuItem Header="Exit" /&gt; 
        &lt;/MenuItem&gt; 
        &lt;MenuItem Header="Edit"&gt; 
            &lt;MenuItem Header="Undo" /&gt; 
            &lt;MenuItem Header="Redo" /&gt; 
        &lt;/MenuItem&gt; 
    &lt;/Menu&gt; 
&lt;/DockPanel&gt; </pre>
<ol start="4">
<li>Run the application to see the following window containing the added menu items:
<div><img src="img/87d60ca0-d2a4-4bad-94e6-b5de9b81b094.png" style=""/></div>
</li>
</ol>
<h2 id="uuid-ec5b2483-74ce-4f87-ac23-cffbb2fa3840">How it works...</h2>
<p>When you add the first menu item under the <kbd>&lt;Menu&gt;</kbd> tag, it creates the root-level menu item; for example, File menu, Edit menu. Each root menu item can contain one or more hierarchical sub-menu items. In the preceding example, the File menu contains four sub-menu items.</p>
<p>The header property of the <kbd>MenuItem</kbd> is used to add the label of each item. When you want to add a separator, you can do so by adding the  <kbd>&lt;Separator /&gt;</kbd> tag, as shown in the preceding example. A separator does not need any <kbd>Header</kbd> content.</p>
<h2 id="uuid-b1613f24-8454-4f23-abc3-d748387e1857">There's more...</h2>
<p>You can further customize a menu entry to have an icon, a check-mark, a shortcut key, or a keyboard access specifier. Let's discuss each of them.</p>
<h3 id="uuid-485d4e53-1a53-4632-8b80-a68ec26d972d">Adding an access key to menus</h3>
<p>It's a general practice to access application menus by holding the <em>Alt</em> key and then pressing the character defined as its access key. For example, to open the File menu of any Windows application, we use <em>Alt</em> + <em>F</em>, and to access the File | New menu, we use <em>Alt</em> + <em>F</em>, <em>N</em>. Here, the character <em>F</em> and <em>N</em> are used as access keys that are invoked when we press <em>Alt</em>.</p>
<p>In the WPF application, you need to specify <kbd>_</kbd> (underscore) before the character you want to highlight as the access key. For example, adding <kbd>_</kbd> before the <kbd>F</kbd> in File menu header content activates the said menu when <em>Alt</em> + <em>F</em> is pressed:</p>
<pre style="padding-left: 60px">&lt;MenuItem Header="_File"&gt; 
      &lt;MenuItem Header="_New" /&gt; 
      &lt;MenuItem Header="_Open" /&gt; 
&lt;/MenuItem&gt; </pre>
<p>The frequently used practice is to use the first character that's not already used as an access key of another control. But, on a need basis, you can specify any character part of the label content.</p>
<h3 id="uuid-4f1841fb-f40a-4456-ad13-53afc66b4ffc">Adding icons to menus</h3>
<p>You can add icons to menus to give a better look to the application's menu items. The  <kbd>MenuItem</kbd> element contains a property named <kbd>Icon</kbd> to add an image icon or a Unicode character as an icon to it.</p>
<p>Let's add a Unicode character to add an icon for the Open and Save menu items:<br/></p>
<div><img src="img/6bda3a86-7da1-4640-a4e6-db3e65fc6d4a.png" style=""/></div>
<p>Run the application now to see the icons added to the said menus, as shown in the following screenshot:</p>
<div><img src="img/5b0694bb-2137-483a-b028-5184ac645a9b.png" style=""/></div>
<h3 id="uuid-d9d48b57-7cf0-4d1c-b3a2-78a986d808e6">Adding checkable menu items</h3>
<p>You can add checkable menu items too. The WPF menu item exposes two properties to handle this. The <kbd>IsCheckable</kbd> property tells the menu item that it can handle check/uncheck options. When <kbd>IsCheckable</kbd> is set to <kbd>True</kbd>, it sets to the check/uncheck icon on an alternate click of that menu item.</p>
<p>You can also programmatically check/uncheck a menu item. Set its <kbd>IsChecked</kbd> property to <kbd>True</kbd> or <kbd>False</kbd>. Make sure to set <kbd>IsCheckable="True"</kbd>. Let's add the following menu item, under the Edit menu:</p>
<pre style="padding-left: 60px">&lt;MenuItem Header="Save _settings on exit" 
          IsCheckable="True" IsChecked="True" /&gt; </pre>
<h3 id="uuid-fe417fe2-eda9-4485-9cda-e736d48469e3">Adding click-event handlers to menus</h3>
<p>Menus are not just to add to the application; you need to perform some actions on the menu with a click by adding the <kbd>Click</kbd> event handler, as shown in the following code snippet:</p>
<pre style="padding-left: 60px">&lt;MenuItem Header="E_xit" Click="OnExitMenuClicked" /&gt; </pre>
<p>In the code behind, implement the handler, as shown in the following code:</p>
<pre style="padding-left: 60px">private void OnExitMenuClicked(object sender, RoutedEventArgs e) 
{ 
    MessageBox.Show("'Exit' menu item clicked!"); 
    Environment.Exit(0); 
} </pre>
<p>This will first show a message box and then exit the application when the user clicks on the Exit menu item.</p>
<h1 id="uuid-09d7d350-fa8e-4f62-80be-3377b2449e59">Providing extra functionalities using the context menu</h1>
<p>The context menu provides a vital role in any Windows applications offering additional functionalities to the user, within that context. This is often done relevant to a single control or a window.</p>
<p>When you right-click on a control or a window, you can provide a popup context menu to the user, to perform single-click actions. WPF provides a <kbd>ContextMenu</kbd> property to all framework elements to hold a <kbd>ContextMenu</kbd>, having hierarchical <kbd>MenuItems</kbd>.</p>
<p>Consider this recipe to learn more about adding a context menu in your WPF application.</p>
<h2 id="uuid-c9a8eaeb-c976-4466-a441-4887c585979f">Getting ready</h2>
<p>Create a new project named <kbd>CH02.ContextMenuDemo</kbd>, using the WPF application project template of Visual Studio.</p>
<h2 id="uuid-2ebc5039-dc9a-4221-a941-67b27cab5ef2">How to do it...</h2>
<p>Follow these steps to add a context menu to a <kbd>TextBlock</kbd> control. The same steps can be followed to add a context menu to any of the controls inheriting <kbd>FrameworkElement</kbd>:</p>
<ol>
<li>Open the <kbd>MainWindow.xaml</kbd> file to modify the application UI.</li>
<li>Replace the entire <kbd>Grid</kbd> block with the following XAML code:</li>
</ol>
<pre style="padding-left: 90px">&lt;Grid&gt; 
    &lt;TextBlock Text="Right-click on me to open Context Menu!" 
        Margin="10"&gt; 
        &lt;TextBlock.ContextMenu&gt; 
            &lt;ContextMenu&gt; 
                &lt;MenuItem Header="Menu item 1" /&gt; 
                &lt;MenuItem Header="Menu item 2" 
                    InputGestureText="Ctrl + R, Ctrl + G"/&gt; 
                &lt;Separator /&gt; 
                &lt;MenuItem Header="Menu item 3" 
                          IsCheckable="True"  
                          IsChecked="True" /&gt; 
            &lt;/ContextMenu&gt; 
        &lt;/TextBlock.ContextMenu&gt; 
    &lt;/TextBlock&gt; 
&lt;/Grid&gt; </pre>
<ol start="3">
<li>Run the application. You will see a text saying Right-click on me to open Context Menu!.</li>
</ol>
<p> </p>
<ol start="4">
<li>Right-click on the window. You will see the following context menu pop up on the screen:
<div><img src="img/c711319d-e3e4-4b76-8f6f-ac764520cb7f.png" style=""/></div>
</li>
</ol>
<h2 id="uuid-daa8b341-eb97-4f18-97bd-90d1e13cb7b5">How it works...</h2>
<p>As you see from the preceding example, each <kbd>FrameworkElement</kbd> exposes a property named <kbd>ContextMenu</kbd>, which can hold a <kbd>ContextMenu</kbd> item. Just like the menu, as we learnt in the previous recipe, the context menu can also hold multiple items as <kbd>MenuItem</kbd>, and each menu item can again hold one or more menu items to make the context menu hierarchical.</p>
<p>Labels of menu items are assigned by setting its <kbd>Header</kbd> property. You can also set icons for each menu item, by assigning an image or a Unicode character to its <kbd>Icon</kbd> property. If you have binded a command to the menu, you can assign the shortcut key text as <kbd>InputGestureText</kbd> property.</p>
<p>Additionally, you can create checkable context menu items. As shown in the Menu item 3, you can set the <kbd>IsCheckable</kbd> property to <kbd>True</kbd>, to make the menu checkable. Then you can use the <kbd>IsCheck</kbd> property to show/hide the check mark on it.</p>
<p>To add a separator between a group of context menu items, you can use the <kbd>&lt;Separator /&gt;</kbd> tag, as shown in the preceding example.</p>
<h1 id="uuid-1a4a3df1-e87e-4845-9b7b-f871643373ab">Adding user options with radio buttons and checkboxes</h1>
<p>Radio buttons and check boxes have a vital role in Windows Application Development. They are mostly used to provide the user an option to select from a group of items. Radio buttons allow you to select one from a group of options, whereas a checkbox allows you to toggle an option.</p>
<p>In this recipe, we will learn how to use <kbd>RadioButton</kbd> and <kbd>CheckBox</kbd> controls in the WPF application.</p>
<h2 id="uuid-0795cc0c-9fc3-42c3-96a6-1ebff48fb571">Getting ready</h2>
<p>To get started, open your Visual Studio IDE, and create a new project named <kbd>CH02.OptionSelectorsDemo</kbd>. Make sure you select the WPF application project template.</p>
<h2 id="uuid-cb114a73-0644-4514-bda1-df3738416fe9">How to do it...</h2>
<p>Open the <kbd>MainWindow.xaml</kbd> page, and follow these steps to add a set of radio buttons and checkbox controls to it:</p>
<ol>
<li>First, replace the default <kbd>Grid</kbd> panel with a <kbd>StackPanel</kbd> to hold items stacked vertically.</li>
<li>Now add the following <kbd>StackPanel</kbd> with a set of radio buttons with a <kbd>GroupName="rdoGroup1"</kbd>:</li>
</ol>
<pre style="padding-left: 90px">&lt;StackPanel Orientation="Horizontal"&gt; 
    &lt;RadioButton GroupName="rdoGroup1" 
                 Content="Radio 1" 
                 IsChecked="True" 
                 Margin="4" /&gt; 
    &lt;RadioButton GroupName="rdoGroup1" 
                 Content="Radio 2" 
                 Margin="4" /&gt; 
    &lt;RadioButton GroupName="rdoGroup1" 
                 Content="Radio 3" 
                 Margin="4" /&gt; 
&lt;/StackPanel&gt;</pre>
<ol start="3">
<li>Add another set of radios, with the <kbd>GroupName="rdoGroup2"</kbd>, in a horizontally placed <kbd>StackPanel</kbd>, and add it to the root <kbd>StackPanel</kbd>:</li>
</ol>
<pre style="padding-left: 90px">&lt;StackPanel Orientation="Horizontal"&gt; 
    &lt;RadioButton GroupName="rdoGroup2" 
                 Content="Radio 1" 
                 Margin="4" /&gt; 
    &lt;RadioButton GroupName="rdoGroup2" 
                 Content="Radio 2" 
                 IsChecked="True" 
                 Margin="4" /&gt; 
    &lt;RadioButton GroupName="rdoGroup2" 
                 Content="Radio 3" 
                 Margin="4" /&gt; 
&lt;/StackPanel&gt; </pre>
<ol start="4">
<li>Now place the following <kbd>CheckBox</kbd> controls in a horizontal <kbd>StackPanel</kbd> and add it to the root:</li>
</ol>
<pre style="padding-left: 90px">&lt;StackPanel Orientation="Horizontal"&gt; 
    &lt;CheckBox Content="Checkbox 1" 
              IsChecked="True" 
              Margin="4" /&gt; 
    &lt;CheckBox Content="Checkbox 2" 
              IsChecked="True" 
              Margin="4" /&gt; 
    &lt;CheckBox Content="Checkbox 3" 
              Margin="4" /&gt; 
&lt;/StackPanel&gt;</pre>
<ol start="5">
<li>Run the application, which will give you the following output on screen:
<div><img src="img/34fdcd90-9735-4fe5-9315-6f5121fdd8ce.png" style=""/></div>
</li>
<li>Select a few of the radio and checkbox controls to feel the behavior.</li>
</ol>
<h2 id="uuid-a50c3a55-f027-4220-be1e-6bbd2fa92acb">How it works...</h2>
<p>The first set of radio button controls are placed in a group with the same name <kbd>rdoGroup1</kbd>. When a group name is set to a set of radio buttons, the selection follows that. The first radio button in that group is by default selected, by setting its <kbd>IsChecked</kbd> property to <kbd>True</kbd>. If you select any other radio button within that group, the previous selection resets to unchecked status.</p>
<p>The same is true for the second group too, but selection of one group does not affect the other group. So, when you check one radio button from the first group, it will not uncheck the radio buttons from the other group.</p>
<p>This is not the same for <kbd>CheckBox</kbd> controls. <kbd>Checkbox</kbd> controls allow you to have many checked items. When you select a checkbox, it can just toggle from one state to another.</p>
<p>Both the radio button and checkbox control expose the <kbd>IsChecked</kbd> property to return a Boolean value to tell whether the control is checked or unchecked.</p>
<h2 id="uuid-130378c3-404b-42f1-87e1-11da50beeea4">There's more...</h2>
<p>To disable the radio button or the checkbox control, set its <kbd>IsEnabled</kbd> property to <kbd>False</kbd>. Both the controls expose two eventsâ€”<kbd>Checked</kbd> and <kbd>Unchecked</kbd>. When you register the events, the <kbd>Checked</kbd> event of the control will trigger when you check that. Similarly, the <kbd>Unchecked</kbd> event will trigger when you uncheck that.</p>
<h1 id="uuid-e9a9e791-076c-433d-a7ca-4925216483b9">Working with the progress bar control</h1>
<p>When you perform a lengthy task in the background, you probably would like to add a progress indicator in your application UI to give a visual indication that some work is in progress. WPF provides us with a control name, <kbd>ProgressBar</kbd>, to show a percentage value of the work between 0% to 100%, in general.</p>
<p>In this recipe, we will learn about the progress bar control and its various properties.</p>
<h2 id="uuid-b7f7eb7b-9d58-440c-84b8-08f080219a8a">Getting ready</h2>
<p>Let's open the Visual Studio and create a new WPF application project. Name it <kbd>CH02.ProgressBarDemo</kbd>.</p>
<h2 id="uuid-f01dd1c4-9b0c-406e-ad7c-d24944a34fd5">How to do it...</h2>
<p>Once the project gets created, follow these steps to add a progress indicator to the application's UI:</p>
<ol>
<li>Open the <kbd>MainWindow.xaml</kbd>, and replace the existing <kbd>Grid</kbd> panel with a <kbd>StackPanel</kbd>, so that, we can add our controls stacked vertically.</li>
<li>As shown in the following code snippet, add three <kbd>ProgressBar</kbd> controls in the <kbd>StackPanel</kbd>:</li>
</ol>
<pre style="padding-left: 90px">&lt;StackPanel Margin="10"&gt; 
    &lt;TextBlock Text="Progress Indicator set at: 20%" /&gt; 
    &lt;ProgressBar Height="30" 
                    Margin="0 4" 
                    Minimum="0" 
                    Maximum="100" 
                    Value="20" /&gt; 
         
    &lt;TextBlock Text="Progress Indicator set at: 70%" /&gt; 
    &lt;ProgressBar Height="30" 
                    Margin="0 4" 
                    Minimum="0" 
                    Maximum="100" 
                    Value="70" /&gt; 
         
    &lt;TextBlock Text="Progress Indicator set at:<br/>     Indeterminate" /&gt; 
    &lt;ProgressBar Height="30" 
                    Margin="0 4" 
                    Minimum="0" 
                    Maximum="100" 
                    IsIndeterminate="True" /&gt; 
&lt;/StackPanel&gt; </pre>
<ol start="3">
<li>Set the <kbd>Minimum</kbd> and <kbd>Maximum</kbd> properties of both the three controls to <kbd>0</kbd> (zero) and <kbd>100</kbd> (hundred) respectively.</li>
</ol>
<p> </p>
<ol start="4">
<li>As shared in the preceding XAML code snippet, set the <kbd>Value</kbd> of the first progress bar to <kbd>20</kbd>, and the second progress bar to <kbd>70</kbd>.</li>
<li>Set the <kbd>IsIndeterminate</kbd> property of the third progress bar to <kbd>True</kbd>.</li>
<li>Now run the application. You will see the following output for the XAML code we shared earlier:
<div><img src="img/e4d047ef-e99a-4c8e-8021-b1abe517703d.png" style=""/></div>
</li>
</ol>
<h2 id="uuid-6448fdba-8a92-4e9a-8e55-1532d75ba223">How it works...</h2>
<p>The value of the first progress indicator is set to <kbd>20</kbd>, whereas the second progress indicator is set to <kbd>70</kbd>. This denotes that the 20% and 70% job is done respectively. As and when you progress with the task, you can just increment the value to have the visual indication of the progress in the UI, with the <kbd>ProgressBar</kbd> control.</p>
<p>For the third <kbd>ProgressBar</kbd> control, in the preceding example, it's a bit different. When you are unsure about the total job to be done, you can set its <kbd>IsIndeterminate</kbd> property to <kbd>True</kbd>, as shown in the preceding screenshot. When your job is done, you can stop the indeterminate state and set its <kbd>Value</kbd> to 100.</p>
<h1 id="uuid-f7ba32ef-77f2-44bf-887d-1cebdcc0d4a2">Using the Slider control to pick a numeric value</h1>
<p>The <kbd>Slider</kbd> control is used to pick a numeric value by dragging a thumb button along a horizontal or vertical line. This is often used to provide a visualization of a playing video and as a volume indicator.</p>
<p>WPF provides us a control named <kbd>Slider</kbd> to quickly implement this in your application UI, and, with a lot of properties for various configurations. Let's learn more about it, in this recipe.</p>
<h2 id="uuid-668babd0-0685-4416-8643-f26bc1573585">Getting ready</h2>
<p>First, create a project named <kbd>CH02.SliderDemo</kbd>, based on the WPF application template.</p>
<h2 id="uuid-dd20737b-6c9d-4a1e-bb22-22862379bcd4">How to do it...</h2>
<p>Integration of the slider in WPF is very easy. Just place <kbd>&lt;Slider /&gt;</kbd> in your XAML page, and it will start working. But to customize it further, let's follow these steps:</p>
<ol>
<li>Open the <kbd>MainWindow.xaml</kbd> page, and replace the default <kbd>Grid</kbd> with a <kbd>StackPanel</kbd>.</li>
<li>Now add a <kbd>Slider</kbd> and a <kbd>TextBlock</kbd> control inside the <kbd>StackPanel</kbd>, as shown in the following XAML snippet:</li>
</ol>
<pre style="padding-left: 90px">&lt;StackPanel Margin="10"&gt; 
    &lt;Slider x:Name="slider" 
            Minimum="0" Maximum="100"                 
            Value="25" 
            SmallChange="1" 
            LargeChange="5" /&gt; 
    &lt;TextBlock Margin="4"&gt; 
        &lt;Run Text="Current slider value: " /&gt; 
        &lt;Run Text="{Binding Value, ElementName=slider}" /&gt; 
    &lt;/TextBlock&gt; 
&lt;/StackPanel&gt;</pre>
<ol start="3">
<li>Run the application. You will see a <kbd>Slider</kbd> control in the UI, along with a text that shows the current value, which is set to <kbd>25</kbd>. Move the slider thumb to right, and it will show you the currently selected value. In our demonstration, it's now <kbd>65</kbd>, as shown in the following screenshot:
<div><img src="img/3a973d7c-a749-4983-99f3-0789b373ba4d.png" style=""/></div>
</li>
</ol>
<h2 id="uuid-f43e2add-9840-48c2-bc90-a8f6978d4218">How it works...</h2>
<p>It works based on the current value. The property named <kbd>Value</kbd>, provides us with an integer, which denotes the current position. You can programmatically set it to move the slider thumb to a smaller or larger value.</p>
<p>The <kbd>Minimum</kbd> and <kbd>Maximum</kbd> properties denote the minimum and maximum value that the slider can accept. In our example, we set it to <kbd>0</kbd> (zero) and <kbd>100</kbd> (hundred), respectively.</p>
<p>The other control, <kbd>TextBlock</kbd>, in our example code, has a data binding to the <kbd>Value</kbd> property of the slider that we have in the XAML. It displays the current value of the slider in a plain text format.</p>
<h2 id="uuid-126fcd17-321c-4b9b-8a2e-20ec3dd88b5d">There's more...</h2>
<p>You can also enable the tick display in a slider control, to provide a better indication of the thumb placement. Use the <kbd>TickPlacement</kbd> property to turn on the tick markers. It has four values <kbd>None</kbd>, <kbd>TopLeft</kbd>, <kbd>BottomRight</kbd>, and <kbd>Both</kbd>. Let's add <kbd>TickPlacement="BottomRight"</kbd> in our previous slider control.</p>
<p>The <kbd>TickFrequency</kbd> property is used to set the range of possible values between <kbd>0</kbd> and <kbd>100</kbd>. Let's add <kbd>TickFrequency="20"</kbd> to our code and then run the application again. You will see the following screen:</p>
<div><img src="img/2a495a98-7121-427d-974e-17f4c3e648ef.png" style=""/></div>
<p>As shown in the preceding screenshot, you can see that some dots are added to the bottom of the slider. They represent the tick. As we have added <kbd>TickFrequency</kbd> as <kbd>20</kbd>, it divided the entire slider range to <kbd>100/20 = 5</kbd> sections.</p>
<p>In general, moving the slider will not snap to the tick. Thus, you will observe the thumb placed between ticks. Use the <kbd>IsSnapToTickEnabled</kbd> property and set it to <kbd>True</kbd>, to make sure that the thumb always stays on the tick marker only. In this case, dragging the slider will move the thumb based on the tick frequency count.</p>
<h1 id="uuid-23f30052-4ce4-46ee-9bf7-849021fc1b9e">Using the Calendar control in your application</h1>
<p>The <kbd>Calendar</kbd> control, part of the <kbd>System.Windows.Controls</kbd> namespace, allows you to create a visual calendar in WPF applications. It allows you to select a date or a collection of dates. As it inherits from the <kbd>Control</kbd> class, all common properties and events from <kbd>Control</kbd> class are available to it.</p>
<p>In this recipe, we will learn more about <kbd>Calendar</kbd> control and how to use that.</p>
<h2 id="uuid-eb1df3c5-c8f1-4e44-9fd6-f1a9306afe44">Getting ready</h2>
<p>To get started with this recipe, let's create a WPF application project named <kbd>CH02.CalendarDemo</kbd>.</p>
<h2 id="uuid-f78ab2ea-3a36-4796-9ac4-2f59e0cc24aa">How to do it...</h2>
<p>Follow these steps to add the basic controls to the main window:</p>
<ol>
<li>Open the <kbd>MainWindow.xaml</kbd> page.</li>
<li>Inside the default <kbd>Grid</kbd> panel, add the tag <kbd>&lt;Calendar /&gt;</kbd> to create the basic calendar control in the application UI.</li>
<li>To retrieve the date selected by the user, register the <kbd>SelectedDatesChanged</kbd> event to it, as shown in the following code snippet:</li>
</ol>
<pre style="padding-left: 90px">&lt;Grid Margin="10"&gt; 
    &lt;Calendar SelectedDatesChanged="OnSelectedDateChanged"  
      HorizontalAlignment="Left" /&gt; 
&lt;/Grid&gt; </pre>
<ol start="4">
<li>Add the associated event handler (<kbd>OnSelectedDateChanged</kbd>) in the code-behind class (<kbd>MainWindow.xaml.cs</kbd>), as shown in the following code, to retrieve the selected date and show it in a message box:</li>
</ol>
<pre style="padding-left: 90px">private void OnSelectedDateChanged(object sender,  
 SelectionChangedEventArgs e) 
{ 
    MessageBox.Show("You selected: " +  
      ((DateTime)e.AddedItems[0]).ToString("dd-MMM-yyyy")); 
} </pre>
<ol start="5">
<li>Let's run the application. You will see the following UI on the screen:
<div><img src="img/6faaf605-cc79-453c-8efb-ed6b7a45dc60.png" style=""/></div>
</li>
<li>Once you select a date from the calendar, the selected date will be shown in a message box, like this:
<div><img src="img/02bf24de-b18e-408e-91f1-38da3fcb53d3.png" style=""/></div>
</li>
<li>Select a different date. This will show the message to the UI with the newly selected date.</li>
</ol>
<h2 id="uuid-d227a551-e719-4d7f-9efb-7d36972962fd">How it works...</h2>
<p>WPF <kbd>Calendar</kbd> control provides you with the basic UI to begin the calendar integration in your application. The top two arrow-heads, allow you to navigate back and forth to other months and select the desired date from the calendar.</p>
<p>The navigation also supports year view and decade view, so, you can select the desired year and month very easily. Click on the month name (in our case, it's August 2017) present at the top, to navigate to the year view. When you are in the year view, it will show you the Janâ€“Dec month range, and clicking on the year will navigate you to the decade view where you can select the desired year.</p>
<h2 id="uuid-5526be36-6882-4416-a4ac-58bcdcc1ce71">There's more...</h2>
<p>The <kbd>Calendar</kbd> control exposes many properties and events for you to customize the behavior and look of the control. Let's discuss this further.</p>
<h3 id="uuid-8fd7d832-cc76-4342-8c8c-8086a892d458">The SelectionModes property</h3>
<p>The <kbd>SelectionMode</kbd> property allows you to get or set the value indicating what kind of selections are allowed on the calendar. There are four values available, named <kbd>None</kbd>, <kbd>SingleDate</kbd>, <kbd>SingleRange</kbd>, and <kbd>MultipleRange</kbd>. The <kbd>enum</kbd> value <kbd>SingleDate</kbd> is default, and allows you to select only a single date. But when you want multi-selection, set it as <kbd>MultipleRange</kbd>:</p>
<pre style="padding-left: 60px">&lt;Calendar SelectionMode="MultipleRange" /&gt; </pre>
<h3 id="uuid-bc7a5239-f2b9-47cd-87c5-ecb6a1416cf2">The DisplayDate property</h3>
<p>The <kbd>Calendar</kbd> control allows you to set the start and end display dates. The <kbd>DisplayDate</kbd> property represents the current date to display; whereas, setting the <kbd>DisplayDateStart</kbd> and <kbd>DisplayDateEnd</kbd> properties limits you to select only the dates from the period ranging from the start date to the end date.</p>
<p>The following XAML code demonstrates how to set the <kbd>DisplayDate</kbd>, <kbd>DisplayDateStart</kbd>, and <kbd>DisplayDateEnd</kbd> properties in <kbd>Calendar</kbd> control:</p>
<pre style="padding-left: 60px">&lt;Calendar SelectionMode="MultipleRange" 
          DisplayDateStart="8/10/2017" 
          DisplayDateEnd="8/21/2017" 
          DisplayDate="8/16/2017" /&gt; </pre>
<p>Run the application now to see the following output:</p>
<div><img src="img/810c4ae3-71da-430f-be41-ae9a57dc53b6.png" style=""/></div>
<h3 id="uuid-d55c850d-d0b8-4313-81a4-e7656d7082d3">The DisplayMode property</h3>
<p>The <kbd>DisplayMode</kbd> property allows you to select the format of the calendar, which can be a month, a year, or a decade. When you launch a basic calendar, by default, it shows the month view:</p>
<div><img src="img/bea06995-55f1-4e70-a9e8-de56c0d77db6.png" style=""/></div>
<p>But a user can easily navigate from month to year to decade by clicking the header text of the <kbd>Calendar</kbd> control.</p>
<p>To change the display mode from code, you can set the <kbd>DisplayMode</kbd> property to <kbd>Month</kbd>, <kbd>Year</kbd>, or <kbd>Decade</kbd>:</p>
<pre style="padding-left: 60px">&lt;Calendar DisplayMode="Month" /&gt; &lt;!-- default mode --&gt; 
&lt;Calendar DisplayMode="Year" /&gt; 
&lt;Calendar DisplayMode="Decade" /&gt; </pre>
<p>The user can initiate the downward transitions by clicking any of the calendar cells, and they can easily navigate from decade to year to month and select the correct date.</p>
<h3 id="uuid-c195149a-713f-4aab-91cd-2c685536c878">The BlackoutDates property</h3>
<p>You can choose ranges of dates to be non-selectable despite being displayed. You can implement the same by using the calendar's <kbd>BlackoutDates</kbd> property, which takes a collection of <kbd>CalendarDateRange</kbd> objects.</p>
<p>The following <kbd>Calendar</kbd> control will block the date range from August 1<sup>st</sup>, 2017 to August 8<sup>th</sup>, 2017, and August 21<sup>st</sup>, 2017 to August 31<sup>st</sup>, 2017:</p>
<pre style="padding-left: 60px">&lt;Calendar&gt; 
    &lt;Calendar.BlackoutDates&gt; 
        &lt;CalendarDateRange Start="8/1/2017" End="8/8/2017" /&gt; 
        &lt;CalendarDateRange Start="8/21/2017" End="8/31/2017" /&gt; 
    &lt;/Calendar.BlackoutDates&gt; 
&lt;/Calendar&gt; </pre>
<p>All non-selection dates are marked by a cross, as shown in the following screenshot:</p>
<div><img src="img/20a6f4fa-8982-412d-aab4-754c42ae1736.png" style=""/></div>
<h1 id="uuid-5a42bef7-fd9c-4cfe-864a-dbd6248ea0ba">Listing items in a Listbox control</h1>
<p>In WPF, the <kbd>ListBox</kbd> control is used to display a list of items. Users can select one or more items from the list, depending on the <kbd>SelectionMode</kbd> specified.</p>
<p>In this recipe, we are going to learn how to create a <kbd>ListBox</kbd> control and use it in WPF applications.</p>
<h2 id="uuid-faa798b7-9569-4ad1-9eb8-69f4c30a7504">Getting ready</h2>
<p>Open your Visual Studio IDE and create a new WPF application project, called <kbd>CH02.ListBoxDemo</kbd>.</p>
<h2 id="uuid-8d1e4de1-4536-4180-b924-fee47237c803">How to do it...</h2>
<p>Adding a <kbd>ListBox</kbd> control in the UI is as easy as writing a <kbd>&lt;ListBox /&gt;</kbd> tag in any XAML page. But to hold the data in it, you will have to use its properties properly. Follow these steps to add a <kbd>ListBox</kbd> control with some static data:</p>
<ol>
<li>Open the <kbd>MainWindow.xaml</kbd> page of the WPF project.</li>
<li>Under the default <kbd>Grid</kbd> panel, add the <kbd>&lt;ListBox&gt;&lt;/ListBox&gt;</kbd> tag to add the control.</li>
<li>Add a few <kbd>ListBoxItem</kbd> inside the control, as shared here:</li>
</ol>
<pre style="padding-left: 90px">&lt;ListBox x:Name="lstBox" 
         Width="120" Height="85" 
         Margin="10 10 20 5"&gt; 
    &lt;ListBoxItem Content="Item 1" /&gt; 
    &lt;ListBoxItem Content="Item 2" IsSelected="True" /&gt; 
    &lt;ListBoxItem Content="Item 3" /&gt; 
    &lt;ListBoxItem Content="Item 4" /&gt; 
    &lt;ListBoxItem Content="Item 5" /&gt; 
&lt;/ListBox&gt; </pre>
<ol start="4">
<li>Add two buttons labelled <kbd>+</kbd> and <kbd>-</kbd> to perform the <kbd>add</kbd> and <kbd>delete</kbd> operations on the said <kbd>Listbox</kbd> control. Register the <kbd>Click</kbd> event of both the buttons:</li>
</ol>
<pre style="padding-left: 90px">&lt;StackPanel Orientation="Horizontal" 
            HorizontalAlignment="Center"&gt; 
    &lt;Button Content="+" 
            Width="20" Height="20" 
            Margin="0 0 4 0" 
            Click="OnAddItemClicked" /&gt; 
    &lt;Button Content="-"  
            Width="20" Height="20" 
            Margin="0 0 4 0" 
            Click="OnDeleteItemClicked" /&gt; 
&lt;/StackPanel&gt; </pre>
<ol start="5">
<li>In the code-behind file, <kbd>MainWindow.xaml.cs</kbd>, implement the button-click event handler as shown here:</li>
</ol>
<pre style="padding-left: 90px">private void OnAddItemClicked(object sender,  
 RoutedEventArgs e) 
{ 
    var itemsCount = lstBox.Items.Count; 
    var newitem = new ListBoxItem  
                  { 
                    Content = "Item " + (itemsCount + 1) 
                  }; 
 
    lstBox.Items.Add(newitem); 
    lstBox.SelectedItem = newitem; 
} 
 
private void OnDeleteItemClicked(object sender,  
 RoutedEventArgs e) 
{ 
    var selectedItem = lstBox.SelectedItem; 
    if (selectedItem != null) 
    { 
        lstBox.Items.Remove(selectedItem); 
        lstBox.SelectedIndex = 0; 
    } 
} </pre>
<ol start="6">
<li>Now run the application. You will see the following UI in the screen:
<div><img src="img/217b3d74-43b9-4416-add8-c85ded5b4d5d.png" style=""/></div>
</li>
</ol>
<h2 id="uuid-b860fbd8-2fbc-4710-83cc-a76e7a787a38">How it works...</h2>
<p>In the preceding example, the <kbd>ListBox</kbd> control contains five items as <kbd>ListBoxItem</kbd>. When you launch the application, by default, the second item is selected due to its property <kbd>IsSelected</kbd> being set to <kbd>True</kbd>.</p>
<p>The two buttons are used to <kbd>add</kbd> or <kbd>delete</kbd> items in the <kbd>Listbox</kbd> control. Click on the <kbd>+</kbd> button to trigger the <kbd>OnAddItemClicked</kbd> event, which will create a new instance of the <kbd>ListBoxItem</kbd> and add it to the <kbd>ListBox</kbd> control. Scroll the list to see the newly added entry. As the <kbd>SelectedItem</kbd> property of the <kbd>ListBox</kbd> is assigned with the latest item, it will now get selected, removing the previous selection.</p>
<p>Click on the <kbd>-</kbd> button to trigger the <kbd>OnDeleteItemClicked</kbd> event. This will get the current selected item, and, if it is not <kbd>null</kbd>, it will be removed from the <kbd>ListBox</kbd> control. The property <kbd>SelectedIndex</kbd> will set to <kbd>0</kbd> (zero), to select the first element after deletion.</p>
<h2 id="uuid-0e242ee8-e037-4c32-9217-b22ca71bbde6">There's more...</h2>
<p><kbd>ListBox</kbd> has numerous properties to perform specific actions. Let's learn a few of them. Later in this section, we will also cover how to add a customized <kbd>ListBoxItem</kbd> having additional UI controls.</p>
<h3 id="uuid-5e77ceb7-b062-43bc-b4df-477072996731">Implementing multi selection</h3>
<p><kbd>ListBox</kbd> supports multi selection. By default, when the <kbd>SelectionMode</kbd> property is set to <kbd>Single</kbd>, it only accepts a single selection of items. If you set <kbd>SelectionMode</kbd> to <kbd>Multiple</kbd>, it will accept multi selection. The <kbd>Extended</kbd> mode allows you to perform single selection, but if you press the <em>Ctrl</em> key while selecting items, it will act as a multi selection.</p>
<h3 id="uuid-daea6362-f336-49b8-93b4-0922aaeabdd2">Customizing the ListBoxItem with multiple controls</h3>
<p>You can easily customize the <kbd>ListBoxItem</kbd>, by adding additional UI controls to it. Consider the following XAML code snippet, where we have added a <kbd>ListBox</kbd>, which has four <kbd>ListBoxItem</kbd>:</p>
<pre style="padding-left: 60px">&lt;ListBox Width="150" Margin="20 10 10 10"&gt; 
    &lt;ListBoxItem&gt; 
        &lt;StackPanel Orientation="Horizontal"&gt; 
            &lt;Rectangle Width="10" 
                       Height="10" 
                       Fill="Red" 
                       Margin="0 0 8 0" /&gt; 
            &lt;TextBlock Text="Red (#FFFF0000)" /&gt; 
        &lt;/StackPanel&gt; 
    &lt;/ListBoxItem&gt; 
    &lt;ListBoxItem IsSelected="True"&gt; 
        &lt;StackPanel Orientation="Horizontal"&gt; 
            &lt;Rectangle Width="10" 
                       Height="10" 
                       Fill="Green" 
                       Margin="0 0 8 0" /&gt; 
            &lt;TextBlock Text="Green (#FF00FF00)" /&gt; 
        &lt;/StackPanel&gt; 
    &lt;/ListBoxItem&gt; 
    &lt;ListBoxItem&gt; 
        &lt;StackPanel Orientation="Horizontal"&gt; 
            &lt;Rectangle Width="10" 
                       Height="10" 
                       Fill="Blue" 
                       Margin="0 0 8 0" /&gt; 
            &lt;TextBlock Text="Red (#FF0000FF)" /&gt; 
        &lt;/StackPanel&gt; 
    &lt;/ListBoxItem&gt; 
&lt;/ListBox&gt; </pre>
<p>If you see the preceding code snippet, each <kbd>ListBoxItem</kbd> has a <kbd>StackPanel</kbd> to hold a <kbd>Rectangle</kbd> control and a <kbd>TextBlock</kbd> control. If you run the preceding code, you will see the following UI:</p>
<div><img src="img/5b1ef087-c85a-4fb9-a882-c73d1ad90c1f.png" style=""/></div>
<p>In the preceding screenshot, notice the way the items have been listed. Each item consists of a rectangle to preview the color that is listed as an item. This is more useful when displaying information on an entity.</p>
<p>Generally, this is done using the <kbd>DataTemplate</kbd> property of <kbd>ListBox</kbd> control, which we will learn in the later chapters of this book.</p>
<h1 id="uuid-6bc111f4-464a-4b07-bfc5-a324f2280533">Providing options to select from a ComboBox</h1>
<p>A <kbd>ComboBox</kbd> control is an items control and works like <kbd>ListBox</kbd>, but only one item from the list is selectable. A <kbd>ListBox</kbd> control by default lists multiple items on screen, but <kbd>ComboBox</kbd> control displays the scrollable list only on a user click. Thus, it takes up a lot less space.</p>
<p>This recipe will talk about <kbd>ComboBox</kbd> control and how to use it.</p>
<h2 id="uuid-d6e6895f-e6ae-46a7-b140-97655f811ca3">Getting ready</h2>
<p>Begin with creating a new WPF application project, called  <kbd>CH02.ComboBoxDemo</kbd>, using your Visual Studio IDE.</p>
<h2 id="uuid-83e40a1e-bca6-4a86-9163-25a5119590ec">How to do it...</h2>
<p>Follow these simple steps to add a <kbd>ComboBox</kbd> control in your application UI:</p>
<ol>
<li>Replace the default <kbd>Grid</kbd> with a <kbd>StackPanel</kbd> to host UI controls horizontally stacked.</li>
<li>Add the following XAML code, inside the <kbd>StackPanel</kbd>, to have a simple <kbd>ComboBox</kbd> control with some items in it:</li>
</ol>
<pre style="padding-left: 90px">&lt;ComboBox Width="150" Height="26" 
    Margin="10"&gt; 
    &lt;ComboBoxItem Content="Item 1" /&gt; 
    &lt;ComboBoxItem Content="Item 2" IsSelected="True" /&gt; 
    &lt;ComboBoxItem Content="Item 3" /&gt; 
    &lt;ComboBoxItem Content="Item 4" /&gt; 
    &lt;ComboBoxItem Content="Item 5" /&gt; 
&lt;/ComboBox&gt; </pre>
<ol start="3">
<li>Add another <kbd>ComboBox</kbd> to have customized items, as shown in the following example code:</li>
</ol>
<pre style="padding-left: 90px">&lt;ComboBox Width="150" Height="26" 
    Margin="10"&gt; 
    &lt;ComboBoxItem&gt; 
        &lt;StackPanel Orientation="Horizontal"&gt; 
            &lt;Rectangle Width="10" 
                       Height="10" 
                       Fill="Red" 
                       Margin="0 0 8 0" /&gt; 
            &lt;TextBlock Text="Red (#FFFF0000)" /&gt; 
        &lt;/StackPanel&gt; 
    &lt;/ComboBoxItem&gt; 
    &lt;ComboBoxItem&gt; 
        &lt;StackPanel Orientation="Horizontal"&gt; 
            &lt;Rectangle Width="10" 
                       Height="10" 
                       Fill="Green" 
                       Margin="0 0 8 0" /&gt; 
            &lt;TextBlock Text="Green (#FF00FF00)" /&gt; 
        &lt;/StackPanel&gt; 
    &lt;/ComboBoxItem&gt; 
    &lt;ComboBoxItem&gt; 
        &lt;StackPanel Orientation="Horizontal"&gt; 
            &lt;Rectangle Width="10" 
                       Height="10" 
                       Fill="Blue" 
                       Margin="0 0 8 0" /&gt; 
            &lt;TextBlock Text="Red (#FF0000FF)" /&gt; 
        &lt;/StackPanel&gt; 
    &lt;/ComboBoxItem&gt; 
&lt;/ComboBox&gt; </pre>
<ol start="4">
<li>Now run the application, which will look like the following screenshot, with an expandable pop up menu:</li>
</ol>
<div><img src="img/6d69e062-04c5-425e-be18-71c0c25a84b9.png"/></div>
<h2 id="uuid-2eb8737a-e705-4981-8c2f-fb91aa73e733">How it works...</h2>
<p>Though a <kbd>ComboBox</kbd> control is like <kbd>ListBox</kbd>, it does not show the list of items by default. A user intervention is required to display the items. The UI of a <kbd>ComboBox</kbd> is a combination of three controls:</p>
<ul>
<li>A <strong>TextBox</strong>, which displays the selected item</li>
<li>A <strong>Button</strong>, which is used to show or hide available items</li>
<li>A <strong>Popup</strong>, which displays a list of items inside a scrollable pane and gives the user the option to select one item from the available list</li>
</ul>
<p><kbd>ComboBox</kbd> contains a collection of <kbd>ComboBoxItem</kbd>. You can add those to its <kbd>Items</kbd> property. When you click on the arrow-head, the list of items will pop up in the screen, as demonstrated in the preceding screenshot. To preselect an item from code, set its <kbd>IsSelected</kbd> property to <kbd>True</kbd>.</p>
<p>You can also add custom contents to a <kbd>ComboBoxItem</kbd> to represent a better UI component. The second <kbd>ComboBox</kbd> in the preceding example, demonstrates how easy it is to customize the UI.</p>
<p>Just like <kbd>ListBox</kbd>, it also exposes <kbd>SelectedItem</kbd>, <kbd>SelectedIndex</kbd>, <kbd>SelectedValue</kbd> properties to help you to easily set or get the selected item.</p>
<h2 id="uuid-9460a2c4-e4ac-4469-8b80-7eecacad8b8f">There's more...</h2>
<p>The <kbd>ComboBox</kbd> control is not editable by default. But you can control this behavior to provide the user with the option to manually enter the desired value, directly in the <kbd>ComboBox</kbd> control. The <kbd>IsEditable</kbd> property is used to add this functionality. Set it to <kbd>True</kbd>, to change it to an editable <kbd>ComboBox</kbd>. Consider the following code:</p>
<pre style="padding-left: 60px">&lt;ComboBox Width="150" Height="26" 
    Margin="10" IsEditable="True"&gt; 
    &lt;ComboBoxItem Content="Item 1" /&gt; 
    &lt;ComboBoxItem Content="Item 2" IsSelected="True" /&gt; 
    &lt;ComboBoxItem Content="Item 3" /&gt; 
    &lt;ComboBoxItem Content="Item 4" /&gt; 
    &lt;ComboBoxItem Content="Item 5" /&gt; 
&lt;/ComboBox&gt; </pre>
<p>If you run the preceding code, you can see the following UI, where the control now allows you to enter text to it:</p>
<div><img src="img/185b9bbd-49e8-47a8-94b9-010674e662c0.png" style=""/></div>
<h1 id="uuid-d018fed0-1722-40b0-9cb3-7bfe090edcab">Adding a status bar to your window</h1>
<p>The status bar is used to show various information about the current state of the application. You can use this to show cursor position, word counts, progress of tasks, and more. Generally, a status bar is placed at the bottom of the window whereas the menus, toolbars are placed at the top.</p>
<p>In this recipe, we will learn how to add a status bar in a WPF window.</p>
<h2 id="uuid-5296518f-6894-4c82-a9e7-8f60f3cf3449">Getting ready</h2>
<p>To get started with the status bar, let's create a WPF application project called <kbd>CH02.StatusBarDemo</kbd>.</p>
<h2 id="uuid-cb6aa101-33e1-465e-8f74-57f82db0904e">How to do it...</h2>
<p>Once you create the WPF project, open the <kbd>MainWindow.xaml</kbd> page and follow these steps to add the <kbd>StatusBar</kbd> control to the window:</p>
<ol>
<li>Inside the <kbd>Grid</kbd> panel, add a <kbd>StatusBar</kbd> tag and set its <kbd>Height</kbd> to <kbd>26</kbd> and <kbd>VerticalAlignment</kbd> to <kbd>Bottom</kbd>.</li>
</ol>
<p> </p>
<ol start="2">
<li>Now change its items panel template to host a <kbd>Grid</kbd> with five columns (we will discuss more about grid columns in the next chapter), as shown here:</li>
</ol>
<pre style="padding-left: 60px">&lt;StatusBar.ItemsPanel&gt; 
    &lt;ItemsPanelTemplate&gt; 
        &lt;Grid&gt; 
            &lt;Grid.ColumnDefinitions&gt; 
                &lt;ColumnDefinition Width="Auto" /&gt; 
                &lt;ColumnDefinition Width="Auto" /&gt; 
                &lt;ColumnDefinition Width="*" /&gt; 
                &lt;ColumnDefinition Width="Auto" /&gt; 
                &lt;ColumnDefinition Width="Auto" /&gt; 
            &lt;/Grid.ColumnDefinitions&gt; 
        &lt;/Grid&gt; 
    &lt;/ItemsPanelTemplate&gt; 
&lt;/StatusBar.ItemsPanel&gt; </pre>
<ol start="3">
<li>Now, inside the <kbd>StatusBar</kbd> tag, add the controls that you want to show. Let's add two <kbd>StatusBarItem</kbd>; one having a plain text content and the other with a <kbd>ProgressBar</kbd> control. Place two separators in between, as shown in the following XAML snippet:</li>
</ol>
<pre style="padding-left: 90px">&lt;StatusBarItem Content="Running Process..." 
  Grid.Column="0"/&gt; 
&lt;Separator Width="1" Grid.Column="1" /&gt; 
&lt;Separator Width="1" Grid.Column="3" /&gt; 
&lt;StatusBarItem Grid.Column="4"&gt; 
    &lt;ProgressBar IsIndeterminate="True" 
                 Width="100" Height="15" /&gt; 
&lt;/StatusBarItem&gt; </pre>
<ol start="4">
<li>Here's the complete XAML code, which you need to place inside the default <kbd>Grid</kbd> panel:</li>
</ol>
<pre style="padding-left: 90px">&lt;StatusBar Height="26" VerticalAlignment="Bottom"&gt; 
    &lt;StatusBar.ItemsPanel&gt; 
        &lt;ItemsPanelTemplate&gt; 
            &lt;Grid&gt; 
                &lt;Grid.ColumnDefinitions&gt; 
                    &lt;ColumnDefinition Width="Auto" /&gt; 
                    &lt;ColumnDefinition Width="Auto" /&gt; 
                    &lt;ColumnDefinition Width="*" /&gt; 
                    &lt;ColumnDefinition Width="Auto" /&gt; 
                    &lt;ColumnDefinition Width="Auto" /&gt; 
                &lt;/Grid.ColumnDefinitions&gt; 
            &lt;/Grid&gt; 
        &lt;/ItemsPanelTemplate&gt; 
    &lt;/StatusBar.ItemsPanel&gt; 
 
    &lt;StatusBarItem Content="Running Process..." 
     Grid.Column="0"/&gt; 
    &lt;Separator Width="1" Grid.Column="1" /&gt; 
    &lt;Separator Width="1" Grid.Column="3" /&gt; 
    &lt;StatusBarItem Grid.Column="4"&gt; 
        &lt;ProgressBar IsIndeterminate="True" 
                     Width="100" Height="15" /&gt; 
    &lt;/StatusBarItem&gt; 
&lt;/StatusBar&gt; </pre>
<ol start="5">
<li>Once your UI is ready, let's run the application. You will see the following screen:
<div><img src="img/d61f4392-43fa-4873-8663-81289c776b9c.png" style=""/></div>
</li>
</ol>
<h2 id="uuid-18e7d261-f11c-477a-84c1-83869af20ecb">How it works...</h2>
<p>In the preceding example, we have placed a plain text content Running Process... as a <kbd>StatusBarItem</kbd> inside the first column of the <kbd>Grid</kbd>. The second and fourth columns of the <kbd>Grid</kbd> contain a <kbd>Separator</kbd> control, having one pixel width. The fifth column contains a <kbd>ProgressBar</kbd> control, having an indeterminate state.</p>
<p>When you resize the window, the status bar will follow its parent to resize itself automatically and position it to the bottom of the window. Instead of <kbd>Grid</kbd>, you can also use <kbd>DockPanel</kbd> to dock the status bar at the bottom.</p>
<h1 id="uuid-a809fd40-c9eb-44b3-9032-fa4701f0f0a2">Adding a toolbar panel to perform quick tasks</h1>
<p>In any windows-based application, you can find a toolbar, usually placed just below the main menu of a window. It contains a set of controls to provide easy access to common functions.</p>
<p>WPF offers you a <kbd>ToolBarTray</kbd> element to host one or more <kbd>ToolBar</kbd> controls, containing various UI controls. It provides you with some extra features, such as an automatic overflowing mechanism and a manual repositioning feature.</p>
<p>In this recipe, we will learn how to work with toolbars in a WPF application.</p>
<h2 id="uuid-831ee2f3-f548-4205-94e6-2585f4075245">Getting ready</h2>
<p>To begin with, open your Visual Studio IDE and create a new WPF application project called <kbd>CH03.ToolBarDemo</kbd>.</p>
<h2 id="uuid-212a3681-c5bf-4ad4-9e85-7e2a08b0f2ae">How to do it...</h2>
<p>Once the project gets created, follow these steps to add a toolbar in the application window:</p>
<ol>
<li>Open the <kbd>MainWindow.xaml</kbd> page from the Solution Explorer.</li>
<li>Now, replace the existing <kbd>Grid</kbd> with a <kbd>DockPanel</kbd> so that we can host the toolbar docking to the top of the window.</li>
<li>Add a <kbd>ToolBarTray</kbd> element inside the <kbd>DockPanel</kbd> and dock it to <kbd>Top</kbd>.</li>
<li>Add a <kbd>ToolBar</kbd> control inside the <kbd>ToolBarTray</kbd> and then add a few buttons inside it, as shown in the following XAML markup:</li>
</ol>
<pre style="padding-left: 90px">&lt;ToolBarTray DockPanel.Dock="Top"&gt; 
    &lt;ToolBar&gt; 
        &lt;Button Content="B" FontWeight="Bold" 
                Width="20" 
                Click="OnBoldButtonClicked"/&gt; 
        &lt;Button Content="I" FontStyle="Italic" 
                Width="20"/&gt; 
        &lt;Button Width="20"&gt; 
            &lt;TextBlock Text="U"  
                       TextDecorations="Underline"/&gt; 
        &lt;/Button&gt; 
    &lt;/ToolBar&gt; 
&lt;/ToolBarTray&gt; </pre>
<ol start="5">
<li>Add a <kbd>TextBox</kbd> control inside the <kbd>DockPanel</kbd>, just below the <kbd>ToolBarTray</kbd>, so that, it can cover the remaining space of the window. Give it the following name <kbd>txtBox</kbd>.</li>
<li>You can add a multiple toolbar inside a <kbd>ToolBarTray</kbd>. You can also add other controls inside a <kbd>ToolBar</kbd>. Let's add the following <kbd>ToolBar</kbd> with a <kbd>ComboBox</kbd> inside it. Place it just after the first <kbd>ToolBar</kbd> control:</li>
</ol>
<pre style="padding-left: 90px">&lt;ToolBar&gt; 
    &lt;ComboBox Width="50"&gt; 
        &lt;ComboBoxItem Content="8"/&gt; 
        &lt;ComboBoxItem Content="10"/&gt; 
        &lt;ComboBoxItem Content="12"/&gt; 
        &lt;ComboBoxItem Content="14"  
                      IsSelected="True"/&gt; 
        &lt;ComboBoxItem Content="16"/&gt; 
    &lt;/ComboBox&gt; 
&lt;/ToolBar&gt; </pre>
<ol start="7">
<li>Here's the complete XAML code to take as a reference:</li>
</ol>
<pre style="padding-left: 90px">&lt;DockPanel&gt; 
    &lt;ToolBarTray DockPanel.Dock="Top"&gt; 
        &lt;ToolBar&gt; 
            &lt;Button Content="B" FontWeight="Bold" 
                    Width="20"  
                    Click="OnBoldButtonClicked"/&gt; 
            &lt;Button Content="I" FontStyle="Italic" 
                    Width="20"/&gt; 
            &lt;Button Width="20"&gt; 
                &lt;TextBlock Text="U"  
                           TextDecorations="Underline"/&gt; 
            &lt;/Button&gt; 
        &lt;/ToolBar&gt; 
        &lt;ToolBar&gt; 
            &lt;ComboBox Width="50"&gt; 
                &lt;ComboBoxItem Content="8"/&gt; 
                &lt;ComboBoxItem Content="10"/&gt; 
                &lt;ComboBoxItem Content="12"/&gt; 
                &lt;ComboBoxItem Content="14"  
                              IsSelected="True"/&gt; 
                &lt;ComboBoxItem Content="16"/&gt; 
            &lt;/ComboBox&gt; 
        &lt;/ToolBar&gt; 
    &lt;/ToolBarTray&gt; 
    &lt;TextBox x:Name="txtBox" Text="Sample Text" 
       AcceptsReturn="True" TextWrapping="Wrap" /&gt; 
&lt;/DockPanel&gt; </pre>
<ol start="8">
<li>As we have associated a click event of the first button of the first toolbar, we need to write the event body. Open the <kbd>MainWindow.xaml.cs</kbd> file, and add the following button-click event implementation inside the class:</li>
</ol>
<pre style="padding-left: 90px">private void OnBoldButtonClicked(object sender,  
 RoutedEventArgs e) 
{ 
    txtBox.FontWeight =  
        txtBox.FontWeight == FontWeights.Bold ? 
        FontWeights.Normal : FontWeights.Bold; 
} </pre>
<ol start="9">
<li>Once you run the application, you will see the following UI containing two toolbars inside a toolbar panel:
<div><img src="img/2f71918f-75d8-4677-997c-f811c8b63b30.png" style=""/></div>
</li>
<li>Click on the first button (denoted by the character B). You will see that the text Sample Text becomes bold. If you click the same button again, the text will change the font weight to normal:
<div><img src="img/18536de1-fec6-4eb6-ac9c-b2c4f968544d.png" style=""/></div>
</li>
</ol>
<h2 id="uuid-52693071-ee3e-47fc-badb-1be9853a9514">How it works...</h2>
<p>A <kbd>ToolBarTray</kbd> can contain one or more <kbd>ToolBar</kbd> controls. Each <kbd>ToolBar</kbd> control can contain one or more controls inside it. A <kbd>ToolBar</kbd> control can also remain empty. When you start adding other controls to it, the toolbar starts changing its size and position, based on the available space.</p>
<p>The controls placed inside a <kbd>ToolBar</kbd> can have its associated events registered. If you want, you can also use command bindings to have a more granular association between the view and the code.</p>
<p>In the preceding example, the first button, denoted by the character B, stands for applying <kbd>Bold</kbd> weightage to the associated <kbd>TextBox</kbd>. When you click it for the first time, the <kbd>FontWeight</kbd> property of the text will set it to <kbd>Bold</kbd>. When you click it again, it will set to <kbd>Normal</kbd>. By following the same logic, you can add a <kbd>Click</kbd> event for other buttons and a <kbd>SelectionChange</kbd> event for the combobox, as shown in the preceding example.</p>


            

            
        
    </body></html>