<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">Networking</h1>
                </header>
            
            <article>
                
<p class="mce-root">In this chapter, we will be looking at these recipes:</p>
<ul>
<li>A library that displays an IP address and the name using sockets</li>
<li>Creating a classic Windows application to use the library</li>
<li>Creating a library that sends mail</li>
<li>Creating a WPF application to use the library</li>
<li>Creating a library to call a REST API</li>
<li>Creating an ASP.NET MVC application to use the library</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Technical requirements</h1>
                </header>
            
            <article>
                
<p>Readers should have a basic knowledge of C#. They should also have a basic knowledge of using Visual Studio, installing packages using NuGet, and referencing libraries within projects from other projects.</p>
<p class="mce-root">The code files for this chapter can be found on GitHub:<br/>
<a href="https://github.com/PacktPublishing/DotNET-Standard-2-Cookbook/tree/master/Chapter07">https://github.com/PacktPublishing/DotNET-Standard-2-Cookbook/tree/master/Chapter07</a></p>
<p class="mce-root">Check out the following video to see the code in action:<br/>
<a href="https://goo.gl/Wj2VD9">https://goo.gl/Wj2VD9</a></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Introduction</h1>
                </header>
            
            <article>
                
<p>Microsoft .NET Framework provides you with a set of class libraries that make it easy to work with internet services. These libraries allow you to easily integrate services with your applications. In this chapter, we will be using a few of these classes within the System.Net namespace. We will be looking at how to get these into a .NET Standard 2.0 library, and use it across different flavors of .NET applications.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">A library that displays an IP address and the name using sockets</h1>
                </header>
            
            <article>
                
<p>In this recipe, we will be building a .NET Standard 2.0 class library that displays the IP address of the current machine you are on. Then, we will be creating an application that uses the library.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>Make sure you have the latest Visual Studio 2017 installed and configured for creating a .NET Standard 2.0 library before you start building the library.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<ol>
<li>Open Visual Studio 2017.</li>
<li>Click <span class="packt_screen">File</span> | <span class="span">Project</span><span class="span"> </span>to create a project. </li>
<li>In the <span class="packt_screen">New Project</span> dialog box, expand the <span class="packt_screen">Other Project Types</span> node in the left pane and select <span class="packt_screen">Visual Studio Solutions</span>. In the right pane, select <span class="packt_screen">Blank Solution</span><span class="span">.</span></li>
</ol>
<ol start="4">
<li>In the <span class="packt_screen">Name:</span> textbox, type <kbd>Chapter7.Networking</kbd> and in the <span class="packt_screen">Location:</span> textbox select a path from the drop-down box or click on the <span class="packt_screen">Browse...</span> button to locate a path:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/2b9e3189-dc93-40b8-9d4e-caf36033eb12.png" style="width:49.83em;height:7.17em;"/></div>
<ol start="5">
<li>Click <span class="packt_screen">OK</span>.</li>
<li>Now your <span class="packt_screen">Solution Explorer</span> (<em>Ctrl</em> + <em>Alt</em> + <em>L</em>) should look like this:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-790 image-border" src="assets/838c1674-4e35-4551-94fd-6e6f5d7d6164.png" style="width:36.75em;height:10.58em;"/></div>
<ol start="7">
<li>Now, click the right mouse button on the <kbd>Chapter7.Networking</kbd> label in the <span class="packt_screen">Solution Explorer</span> and select <span class="packt_screen">Add</span> | <span class="packt_screen">New Project</span><span class="span">.</span></li>
<li>In the <span class="packt_screen">New Project</span> dialog box, expand the <span class="packt_screen">Visual C#</span> node.</li>
</ol>
<ol start="9">
<li>Select <span class="packt_screen">.NET Standard</span> in the left pane and <span class="packt_screen">Class Library (.NET Standard)</span> in the right pane:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-791 image-border" src="assets/21c4f4da-9275-4c60-8a5b-5142ed401e7a.png" style="width:48.58em;height:33.67em;"/></div>
<ol start="10">
<li>In the <span class="packt_screen">Name:</span> textbox, type <kbd>Chapter7.Networking.ReadIPLib</kbd>, leave the other defaults as is, and click <span class="packt_screen">OK</span>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/77cd7188-bea5-46f5-b06a-e64fa211d5e4.png" style="width:50.75em;height:4.75em;"/></div>
<ol start="11">
<li>Now the <span class="packt_screen">Solution Explorer</span> (<em>Ctrl</em> + <em>Alt</em> + <em>L</em>) should look like this:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-792 image-border" src="assets/a3be1d0b-3751-454c-98fe-19073dd02b04.png" style="width:27.67em;height:12.08em;"/></div>
<ol start="12">
<li>Now, select <kbd>Class1.cs</kbd> in the <span class="packt_screen">Solution Explorer</span> and press <em>F2</em> to rename the file to <kbd>IPReader.cs</kbd>.</li>
<li>Answer <span class="packt_screen">Yes</span> to the confirmation dialog box that asks to rename the class name as well.</li>
<li>Double-click on the <kbd>IPReader.cs</kbd> label in the <span class="packt_screen">Solution Explorer</span>.</li>
<li>Let's scroll up in the code window and add the following <kbd>using</kbd> directive:</li>
</ol>
<pre>      using System.Net;<br/>      using System.Net.Sockets;<br/>      using System.Collections.Generic;</pre>
<ol start="16">
<li>Now, let's create this <kbd>public</kbd> method inside the <kbd>IPReader</kbd> class:</li>
</ol>
<pre>      public List&lt;string&gt; GetMyIPAddress()<br/>      {<br/>          var hostName = Dns.GetHostName();<br/>          var hostAddress = Dns.GetHostAddresses(hostName);<br/><br/>          var ipList = new List&lt;string&gt;();<br/><br/>          foreach (var ipaddres in hostAddress)<br/>          {<br/>              if (ipaddres.AddressFamily == AddressFamily.InterNetwork)<br/>              {<br/>                  ipList.Add(ipaddres.ToString());<br/>              }<br/>          }<br/><br/>          return ipList;<br/>      }</pre>
<ol start="17">
<li>Press <em>Ctrl</em> + <em>Shift</em> + <em>B</em> for a quick build to check the syntax.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>In steps 1 to 11, we added a blank solution and added a .NET Standard 2.0 class library to the solution. In these steps, we have given proper names to the solution and the project. Then, in step 12 we changed the name of the default <kbd>Class1.cs</kbd> generated from Visual Studio. In step 15, we added the required <kbd>using</kbd> directive to the code. We have mainly used <kbd>System.Net</kbd> and<span class="span"> </span><kbd>System.Net.Sockets</kbd> to access the required classes and read the IP address, and then added the <kbd>System.Collecitons.Generic</kbd> namespace to create a generic <kbd>string List</kbd> to hold the IP addresses.</p>
<p>In step 16, we added a public method that will read all the available IP addresses of the local machine you are on. In the first line, we stored the host name of the system in a variable and in the second line we used it to get the host addresses. Then, we created an empty list to store the IP addresses.</p>
<p>After that, we used a <kbd>foreach</kbd> loop to go through all the IP addresses we found and store them in the list after checking whether it was an IP address on the internal network. Finally, we returned the list of IP addresses we stored.</p>
<p>In step 17, we did a quick build to check syntax.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Creating a classic Windows application to use the library</h1>
                </header>
            
            <article>
                
<p>In this recipe, we will be creating a classic Windows application to use the library. We will be creating a UI using the Visual Studio designer, adding code to use the library, and displaying the list of IP addresses picked from the library itself.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>Make sure you have the latest version of Visual Studio 2017 and have completed the previous recipe. We will be using the solution we built in the previous recipe.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<ol>
<li>Open Visual Studio 2017.</li>
<li>Now open the solution from the previous recipe. Click<span> </span><span class="packt_screen">File</span><span> </span>|<span> </span><span class="packt_screen">Open</span><span> </span>|<span> </span><span class="packt_screen">Open Project/Solution</span><span> </span>or press<span> </span><em>Ctrl</em> + <em>Shift</em> + <em>O</em><span> </span>and select the <kbd>Chapter7.Networkings</kbd> solution. </li>
<li>Press <em>Ctrl</em> + <em>Shift</em> + <em>B</em> for a quick build to check everything is fine. </li>
<li>Now, click on the <kbd>Chapter7.Networking</kbd> solution label. Click<span> </span><span class="packt_screen">File</span><span> </span>|<span> </span><span class="packt_screen">Add</span><span> </span>|<span> </span><span class="packt_screen">New Project</span>.</li>
<li>In the<span> </span><span class="packt_screen">Add New Project</span><span> </span>template dialog box, expand the <span class="packt_screen">Visual C#</span> node in the left pane. </li>
<li>Select <span class="packt_screen">Windows Classic Desktop</span> and select <span class="packt_screen"><span><span class="span">Windows Forms</span></span> <span class="span">App (.NET Framework)</span></span><span> </span>in the right pane:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/2857fe40-c3c8-4da0-9238-566772d8e242.png" style="width:50.25em;height:34.83em;"/></div>
<ol start="7">
<li>In the <span class="packt_screen">Name:</span> textbox, type <kbd>Chapter7.Networking.IPListWindows</kbd> as the name of the project. The rest of the fields can be left at the defaults: </li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/f1a83087-173a-46b6-8a26-000f925c4c92.png"/></div>
<ol start="8">
<li>Click <span class="packt_screen">OK</span>.</li>
<li>Now the <span class="packt_screen">Solution Explorer</span> (press <em>Ctrl</em> + <em>Alt</em> + <em>L</em>) should look like this: </li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-793 image-border" src="assets/1aad3cd0-98bf-4ea6-985d-b94f311704f2.png" style="width:25.33em;height:21.92em;"/></div>
<ol start="10">
<li>Click the right mouse button on the <span class="packt_screen">References</span> label in <kbd>Chapter7.Networking.IPListWindows</kbd>.</li>
<li>Select <span class="packt_screen">Add Reference</span>.</li>
</ol>
<ol start="12">
<li>In the <span class="packt_screen">Reference Manager</span>, click on the <span class="packt_screen">Projects</span> label in the right pane: </li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-794 image-border" src="assets/ad375516-6a63-4fac-8ea3-555df7fdecca.png" style="width:131.17em;height:52.83em;"/></div>
<ol start="13">
<li>Check the <span class="span"><kbd>Chapter7.Networking.ReadIPLib</kbd> </span>project in the left pane.</li>
<li>Click <span class="packt_screen">OK</span>.</li>
<li>Now click on the <kbd>Form1.cs</kbd> from the project list and rename it to <kbd>MainForm.cs</kbd>.</li>
<li>Answer <span class="packt_screen">Yes</span> to the confirmation dialog box.</li>
<li>Now click on the <span class="packt_screen">MainForm.cs[Design]</span> tab.</li>
<li>From the toolbox, add a <span class="span"><span class="packt_screen">Button</span></span> control and a <span class="span"><span class="packt_screen">ListBox</span></span> control to the <span class="span"><span class="packt_screen">MainWindow</span></span> form:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-795 image-border" src="assets/4c3b684b-5859-46da-8353-f7f9fb3d5ccd.png" style="width:21.25em;height:18.25em;"/></div>
<ol start="19">
<li>Select the button and press <em>F4</em> to load the <span class="packt_screen">Properties</span> window.</li>
<li>Now change the following properties:<br/>
<table>
<tbody>
<tr>
<td><strong><span class="span">Control</span></strong></td>
<td><strong><span class="span">Property</span></strong></td>
<td><strong><span class="span">Value</span></strong></td>
</tr>
<tr>
<td><span class="packt_screen">Form</span></td>
<td><span class="packt_screen">Text</span></td>
<td><kbd>IP List</kbd></td>
</tr>
<tr>
<td><span class="packt_screen">Button</span></td>
<td><span class="packt_screen">Name</span></td>
<td><kbd>ShowButton</kbd></td>
</tr>
<tr>
<td><span class="packt_screen">Button</span></td>
<td><span class="packt_screen">Text</span></td>
<td><kbd>Show IP List</kbd></td>
</tr>
<tr>
<td><span class="packt_screen">ListBox</span></td>
<td><span class="packt_screen">Name</span></td>
<td><kbd>IPListBox</kbd></td>
</tr>
</tbody>
</table>
</li>
<li>Double-click on the <span class="packt_screen">Show IP List</span> button to reach the code window.</li>
<li>Scroll up till you reach the <kbd><span class="span">using</span></kbd> directives.</li>
<li>Add the following <kbd>using</kbd> directive to the last line of the directives:</li>
</ol>
<pre>      using Chapter7.Networking.ReadIPLib;</pre>
<ol start="24">
<li>Now, again scroll down till you reach the <kbd><span class="span">ShowButton_Click()</span></kbd> method.</li>
<li>Type the following code inside the method:</li>
</ol>
<pre>      var ipLib = new IPReader();<br/>      IPListBox.Items.AddRange(ipLib.GetMyIPAddress().ToArray());</pre>
<ol start="26">
<li>Now press <em>F5</em> to debug the code.</li>
<li>Click on the <span class="packt_screen">Show IP List</span> button.</li>
<li>You should see output like this:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-796 image-border" src="assets/02f98440-554a-4201-bbbb-59898822dd99.png" style="width:27.83em;height:15.25em;"/></div>
<ol start="29">
<li>Close the window.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>In steps 1 to 10, we opened the previously built solution and did a quick build to check everything was intact. Then, we added a Classic Windows Forms application to the solution. In steps 11 to 14, we added the reference to the .NET Standard 2.0 class library that we built in the previous recipe. In steps 15 to 20, we renamed the main window and then we added the UI. Finally, we changed the properties of the controls in a meaningful way.</p>
<p>In step 23, we referenced the class library in the code. In step 25, we created an instance of the <kbd><span class="span">IPReader</span></kbd> class and then used the <kbd><span class="span">GetMyIPAddress()</span></kbd> method. In the same line, we output the return <kbd><span class="span">List&lt;string&gt;</span></kbd> as an array and used the <kbd><span class="span">ListBox</span></kbd>, <kbd><span class="span">AddRange</span></kbd> method to populate the list box.</p>
<p>In steps 26 to 29, we executed the code and tested the results.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Creating a library that sends mail</h1>
                </header>
            
            <article>
                
<p>In this recipe, we will be looking at another area of the <kbd>System.Net</kbd> namespace. We will be using it to create and send an email. Mainly, we will be looking at the <kbd><span class="span">SmptClient</span></kbd> class to do the hard work for us.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>Make sure you have the latest version of Visual Studio 2017 and all the updates installed. We will be building a .NET Standard 2.0 library to send an email.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<ol>
<li>Open Visual Studio 2017.</li>
<li>Click <span class="span"><span class="packt_screen">File</span></span> | <span class="span"><span class="packt_screen">New</span></span> | <span class="span"><span class="packt_screen">Project</span> </span>to create a project. </li>
<li>In the <span class="packt_screen">New Project</span> dialog box, expand the <span class="span"><span class="packt_screen">Other Project Types</span></span> node in the left pane and select <span class="span"><span class="packt_screen">Visual Studio Solutions</span></span>. In the right pane, select <span class="span"><span class="packt_screen">Blank Solution</span>.</span></li>
</ol>
<ol start="4">
<li>In the <span class="span"><span class="packt_screen">Name:</span></span> textbox, type <kbd>Chapter7.MailBox</kbd> and in the <span class="span"><span class="packt_screen">Location:</span></span> textbox select a path from the drop-down box or click on the <span class="packt_screen">Browse...</span> button to locate a path:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/93cddef5-a4c6-4865-b65a-94eb88d7dd2e.png" style="width:50.42em;height:7.25em;"/></div>
<ol start="5">
<li>Click <span class="packt_screen">OK</span>.</li>
<li>Now your <span class="packt_screen">Solution Explorer</span> (<em>Ctrl</em> + <em>Alt</em> + <em><span class="span">L</span></em>) should look like this:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-797 image-border" src="assets/d5cd10dd-f7bd-49f3-827a-f8acf459cbb8.png" style="width:36.08em;height:9.92em;"/></div>
<ol start="7">
<li>Now, click the right mouse button on the <kbd>Chapter7.MailBox</kbd> label in the <span class="packt_screen">Solution Explorer</span> and select <span class="span"><span class="packt_screen">Add</span></span> | <span class="span"><span class="packt_screen">New Project</span></span>.</li>
<li>In the <span class="packt_screen">New Project</span> dialog box, expand the <span class="span"><span class="packt_screen">Visual C#</span></span> node.</li>
<li>Select <span class="packt_screen">.NET Standard</span> in the left pane and <span class="packt_screen">Class Library (.NET Standard)</span> in the right pane:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/0f43fcd3-fcb5-4047-8fff-49de0e96d419.png"/></div>
<ol start="10">
<li>In the <span class="packt_screen">Name:</span> textbox, type <kbd>Chapter7.MailBox.MailerLib</kbd>, leave the other defaults as is, and click <span class="span"><span class="packt_screen">OK</span></span>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/5af711fc-96d5-4897-be09-8e4001ea0741.png"/></div>
<ol start="11">
<li>Now the <span class="packt_screen">Solution Explorer</span> (<em>Ctrl</em> + <em>Alt</em> + <em><span class="span">L</span></em>) should look like this:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-798 image-border" src="assets/b99018d5-a3eb-45eb-9804-a1ddfb0f9ce8.png" style="width:33.00em;height:13.67em;"/></div>
<ol start="12">
<li>Now, select <kbd>Class1.cs</kbd> in the <span class="packt_screen">Solution Explorer</span> and press <em>F2</em> to rename the file to <kbd>SendMail.cs</kbd>.</li>
<li>Answer <span class="span"><span class="packt_screen">Yes</span></span> to the confirmation dialog box that asks to rename the class name as well.</li>
<li>Now double-click on the <kbd>SendMail.cs</kbd> label in the <span class="packt_screen">Solution Explorer</span>.</li>
<li>Let's scroll up in the code window and add the following <kbd><span class="span">using</span></kbd> directive:</li>
</ol>
<pre>      using System.Net;<br/>      using System.Net.Mail;</pre>
<ol start="16">
<li>Add the following four properties to the <kbd><span class="span">SendMail</span></kbd> class:</li>
</ol>
<pre>      public string From { get; set; }<br/>      public string To { get; set; }<br/>      public string Subject { get; set; }<br/>      public string Body { get; set; }</pre>
<ol start="17">
<li>Finally, add this <kbd>public</kbd> method to create and send mail:</li>
</ol>
<pre>      public void Send()<br/>      {<br/>          var toAddress = new MailAddress(To);<br/>          var fromAddress = new MailAddress(From);<br/>    <br/>          var message = new MailMessage(fromAddress, toAddress);<br/>          message.Subject = Subject;<br/>          message.Body = Body;<br/><br/>          var credentials = new NetworkCredential("&lt;your_smtp_username&gt;", "&lt;your_smtp_password&gt;"); <br/>    <br/>          var smtp = new SmtpClient();<br/>          smtp.Host = "&lt;smtp_host&gt;";<br/>          smtp.Port = &lt;port&gt;;<br/>          smtp.EnableSsl = true;<br/>          smtp.Credentials = credentials;<br/>          smtp.DeliveryMethod = SmtpDeliveryMethod.Network;<br/><br/>          smtp.Send(message); <br/>      }</pre>
<ol start="18">
<li>Let's press <em>Ctrl</em> + <em>Shift</em> + <em>B</em> for a quick build.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>In steps 1 to 11, we created a blank solution and added a .NET Standard 2.0 class library project to it. Then, we properly named the solution and its project. In steps 12 to 14, we renamed the default class generated from Visual Studio. In step 15, we added the necessary namespaces to send a mail in the <kbd><span class="span">using</span></kbd> directive section. In step 16, we added four properties to the main class. These properties will store the mail addresses, subject, and the body of the mail.</p>
<p>In step 17, we wrote the actual code to prepare and send the mail. In the first two lines, we used the from and to addresses and converted them to <kbd><span class="span">MailAddress</span></kbd> type. Then, we created a <kbd><span class="span">MailMessage</span></kbd> and attached the body and the subject, along with the addresses. Then, we created the network credentials required to access the given SMTP server.</p>
<p>Then, we created an <kbd><span class="span">SmtpClient</span></kbd> object, attached the credentials, and sent the mail. Finally, we did a quick build to check the syntax.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Creating a WPF application to use the library</h1>
                </header>
            
            <article>
                
<p>In this recipe, we will be creating a Windows Presentation Foundation application to use the library we have created. We will be creating a UI to send an email using the library.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>Make sure you have completed the previous recipe for sending an email. If you have completed it, open it up and do a quick build to check everything works fine.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<ol>
<li>Open Visual Studio 2017.</li>
<li>Now open the solution from the previous recipe. Click<span> </span><span class="span"><span class="packt_screen">File</span></span><span> </span>|<span> </span><span class="span"><span class="packt_screen">Open</span></span><span> </span>|<span> </span><span class="span"><span class="packt_screen">Open Project/Solution</span></span><span> </span>or press<span> </span><span class="span"><em>Ctrl</em> + <em>Shift</em> + <em>O</em></span><span> </span>and select the <kbd>Chapter7.MailBox</kbd> solution. </li>
<li>Press <em>Ctrl</em> + <em>Shift</em> + <em><span class="span">B</span></em> for a quick build to check everything is fine. </li>
<li>Click on the <kbd>Chapter7.MailBox</kbd> solution label. Click<span> </span><span class="span"><span class="packt_screen">File</span></span><span> </span>|<span> </span><span class="span"><span class="packt_screen">Add</span></span><span> </span>|<span> </span><span class="span"><span class="packt_screen">New Project</span></span>.</li>
<li>In the<span> </span><span class="span"><span class="packt_screen">Add New Project</span></span><span> </span>template dialog box, expand the <span class="packt_screen">Visual C#</span> node in the left pane. </li>
<li>Select <span class="span"><span class="packt_screen">Windows Classic Desktop</span></span> and select <span class="packt_screen"><span><span class="span">WPF</span></span> <span class="span">App (.NET Framework)</span></span><span> </span>in the right pane:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/bb2b6901-75b8-4ee1-9fa1-81519d178fa5.png"/></div>
<ol start="7">
<li>Now, in the <span class="packt_screen">Name:</span> textbox type <kbd>Chapter7.MailBox.WPFMail</kbd> as the name of the project. The rest of the fields can be left at the defaults: </li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/82fb0d48-1ada-4117-946f-012ea816ac81.png" style="width:48.08em;height:4.50em;"/></div>
<ol start="8">
<li>Click <span class="packt_screen">OK</span>.</li>
<li>Now the <span class="packt_screen">Solution Explorer</span> (press <em>Ctrl</em> + <em>Alt</em> + <em><span class="span">L</span></em>) should look like this: </li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-799 image-border" src="assets/1fb688fa-0973-4347-9a75-36dfdb59b54a.png" style="width:33.42em;height:23.58em;"/></div>
<ol start="10">
<li>Click the right mouse button on the <span class="span"><span class="packt_screen">References</span></span> label in <kbd>Chapter7.MailBox.WPFMail</kbd>.</li>
<li>Select <span class="span"><span class="packt_screen">Add Reference</span></span>.</li>
</ol>
<ol start="12">
<li>In the <span class="packt_screen">Reference Manager</span>, click on the <span class="packt_screen">Projects</span> label in the right pane: </li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-800 image-border" src="assets/574883d9-dcd3-4406-90ff-e5d2a36efa34.png" style="width:130.58em;height:46.33em;"/></div>
<ol start="13">
<li>Check the <span class="span"><kbd>Chapter7.MailBox.MailerLib</kbd> </span>project in the left pane.</li>
<li>Click <span class="packt_screen">OK</span>.</li>
<li>Now click on the <kbd>MainWindow.xaml</kbd> tab.</li>
<li>From the toolbox, add four <span class="span"><span class="packt_screen">TextBox</span></span> controls and a <span class="span"><span class="packt_screen">Button</span></span> control to the <span class="span"><span class="packt_screen">MainWindow</span></span> form. Arrange them as shown:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-801 image-border" src="assets/58afb945-b867-48b4-bfc4-d8c2a4efca3b.png" style="width:32.25em;height:22.75em;"/></div>
<ol start="17">
<li>Select the <span class="span"><span class="packt_screen">TextBox</span></span> and press <em>F4</em> to load the <span class="packt_screen">Properties</span> window.</li>
<li>Now change the following properties (from the top as per the previous UI):<br/>
<table>
<tbody>
<tr>
<td><strong><span class="span">Control</span></strong></td>
<td><strong><span class="span">Property</span></strong></td>
<td><strong><span class="span">Value</span></strong></td>
</tr>
<tr>
<td><span class="packt_screen">TextBox</span></td>
<td><span class="packt_screen">Name</span></td>
<td><kbd>FromTextBox</kbd></td>
</tr>
<tr>
<td><span class="packt_screen">TextBox</span></td>
<td><span class="packt_screen">Text</span></td>
<td><kbd>From Address</kbd></td>
</tr>
<tr>
<td><span class="packt_screen">TextBox</span></td>
<td><span class="packt_screen">Name</span></td>
<td><kbd>ToTextBox</kbd></td>
</tr>
<tr>
<td><span class="packt_screen">TextBox</span></td>
<td><span class="packt_screen">Text</span></td>
<td><kbd>To Address</kbd></td>
</tr>
<tr>
<td><span class="packt_screen">TextBox</span></td>
<td><span class="packt_screen">Name</span></td>
<td><kbd>SubjectTextBox</kbd></td>
</tr>
<tr>
<td><span class="packt_screen">TextBox</span></td>
<td><span class="packt_screen">Text</span></td>
<td><kbd>Subject</kbd></td>
</tr>
<tr>
<td><span class="packt_screen">TextBox</span></td>
<td><span class="packt_screen">Name</span></td>
<td><kbd>BodyTextBox</kbd></td>
</tr>
<tr>
<td><span class="packt_screen">TextBox</span></td>
<td><span class="packt_screen">Text</span></td>
<td><kbd>Body</kbd></td>
</tr>
<tr>
<td><span class="packt_screen">TextBox</span></td>
<td><span class="packt_screen">AcceptReturn</span> (<em>turning on this property will make the text box multi-line</em>)</td>
<td><span class="packt_screen">True</span></td>
</tr>
<tr>
<td><span class="packt_screen">Button</span></td>
<td><span class="packt_screen">Name</span></td>
<td><kbd>SendButton</kbd></td>
</tr>
<tr>
<td><span class="packt_screen">Button</span></td>
<td><span class="packt_screen">Text</span></td>
<td><kbd>Send</kbd></td>
</tr>
</tbody>
</table>
</li>
<li>Now your UI should look like this:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-802 image-border" src="assets/fcb61820-7c21-481e-b69e-becef42cf0c5.png" style="width:35.33em;height:25.00em;"/></div>
<ol start="20">
<li>Double-click on the <span class="span"><span class="packt_screen">Send</span></span> button to open up the code window.</li>
<li>Scroll up till you reach the <kbd>using</kbd> directives.</li>
<li>Add the following <kbd>using</kbd> directive to the last line of the directives:</li>
</ol>
<pre>      using Chapter7.MailBox.MailerLib;</pre>
<ol start="23">
<li>Scroll down until you reach the <kbd>SendButton_Click()</kbd> method and add the following code:</li>
</ol>
<pre>      var mailer = new SendMail();<br/><br/>      mailer.From = FromTextBox.Text;<br/>      mailer.To = ToTextBox.Text;<br/>      mailer.Subject = SubjectTextBox.Text;<br/>      mailer.Body = BodyTextBox.Text;<br/><br/>      mailer.Send();<br/><br/>      MessageBox.Show("Your mail has been sent");</pre>
<ol start="24">
<li>Make sure you have changed the required credentials in the library for your SMTP server.</li>
<li>Let's test our application by pressing <em>F5</em>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-803 image-border" src="assets/1c961489-ef1a-4231-9c84-34e124f7920b.png" style="width:30.50em;height:21.17em;"/></div>
<ol start="26">
<li>Click <span class="packt_screen">OK</span> and close the window.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>In steps 1 to 14, we opened the solution with the library. Then, we added a WPF application project to the solution. Later, we added the reference to the class library. In steps 16 to 20, we built the UI and changed a few properties. In step 22, we created the reference to the library at the code level.</p>
<p>Finally, we added the code for a button click, which is straightforward, created an instance of the <kbd>SendMail</kbd> class, and then populated the properties from the UI itself. Finally, in steps 24 and 25 we tested the output.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Creating a library to call a REST API</h1>
                </header>
            
            <article>
                
<p>In this recipe, we will be looking at a .NET Standard 2.0 library that calls a REST API. RESTful APIs are services that allow you to access its functionality through HTTP. We will be using the <kbd>System.Net.Http</kbd> namespace inside the library to send a message to an API and get back the results.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>Make sure you have the latest version of Visual Studio 2017. Also make sure you have a basic understanding of accessing a web service, what a <kbd>GET</kbd> method is, what a <kbd>POST</kbd> method is, and so on. We will be using a test API service provided by <kbd>JSONPlaceHolder</kbd>. It's a simple REST API test bed for developers.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<ol>
<li>Open Visual Studio 2017.</li>
<li>Click <span class="span"><span class="packt_screen">File</span></span> | <span class="span"><span class="packt_screen">New</span></span> | <span class="span"><span class="packt_screen">Project</span> </span>to create a project. </li>
<li>In the <span class="packt_screen">New Project</span> dialog box, expand the <span class="span"><span class="packt_screen">Other Project Types</span></span> node in the left pane and select <span class="span"><span class="packt_screen">Visual Studio Solutions</span></span>. In the right pane, select <span class="span"><span class="packt_screen">Blank Solution</span>.</span></li>
</ol>
<ol start="4">
<li>In the <span class="span"><span class="packt_screen">Name:</span></span> textbox, type <kbd>Chapter7.RestAPI</kbd> and in the <span class="span"><span class="packt_screen">Location:</span></span> textbox select a path from the drop-down box or click on the <span class="packt_screen">Browse...</span> button to locate a path:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-804 image-border" src="assets/e66020c2-8865-4489-b4af-ae36a24d6f68.png" style="width:43.58em;height:8.33em;"/></div>
<ol start="5">
<li>Click <span class="packt_screen">OK</span>.</li>
<li>Now your <span class="packt_screen">Solution Explorer</span> (<em>Ctrl</em> + <em>Alt</em> + <em><span class="span">L</span></em>) should look like this:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-805 image-border" src="assets/da4df78c-8fa1-4e53-9303-e29983c2f6c9.png" style="width:49.75em;height:13.67em;"/></div>
<ol start="7">
<li>Now, click the right mouse button on the <kbd>Chapter7.RestAPI</kbd> label in the <span class="packt_screen">Solution Explorer</span> and select <span class="span"><span class="packt_screen">Add</span></span> | <span class="span"><span class="packt_screen">New Project</span>.</span></li>
<li>In the <span class="packt_screen">New Project</span> dialog box, expand the <span class="span"><span class="packt_screen">Visual C#</span></span> node.</li>
</ol>
<ol start="9">
<li>Select <span class="packt_screen">.NET Standard</span> in the left pane and <span class="packt_screen">Class Library (.NET Standard)</span> in the right pane:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-806 image-border" src="assets/59a03e8e-44af-4782-a237-64e336b958eb.png" style="width:156.58em;height:108.42em;"/></div>
<ol start="10">
<li>Now, in the <span class="packt_screen">Name:</span> textbox type <kbd>Chapter7.RestAPI.RestLib</kbd>, leave the other defaults as they are, and click <span class="span"><span class="packt_screen">OK</span></span>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-807 image-border" src="assets/85f42896-0ce2-43ad-87c6-be4f6161438b.png" style="width:122.08em;height:14.33em;"/></div>
<ol start="11">
<li>Now the <span class="packt_screen">Solution Explorer</span> (<em>Ctrl</em> + <em>Alt</em> + <em><span class="span">L</span></em>) should look like this:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-808 image-border" src="assets/2b97c05d-429c-4c5a-9158-ed5bbacf5b1b.png" style="width:38.08em;height:15.83em;"/></div>
<ol start="12">
<li>Now, select <kbd>Class1.cs</kbd> in the <span class="packt_screen">Solution Explorer</span> and press <em>F2</em> to rename the file to <kbd>PostsReader.cs</kbd>.</li>
<li>Answer <span class="span"><span class="packt_screen">Yes</span></span> to the confirmation dialog box that asks to rename the class name as well.</li>
<li>Now, double-click on the <kbd>PostsReader.cs</kbd> label in the <span class="packt_screen">Solution Explorer</span>.</li>
<li>Let's scroll up in the code window and add the following <kbd><span class="span">using</span></kbd> directive:</li>
</ol>
<pre>      using System.Net.Http;<br/>      using System.Threading.Tasks;</pre>
<ol start="16">
<li>Now, create this class-wide <kbd>private</kbd> variable to hold the URL:</li>
</ol>
<pre>      private string _serviceURL;</pre>
<ol start="17">
<li>Let's create the default constructor to update the previous variable:</li>
</ol>
<pre>      public PostsReader(string serviceURL)<br/>      {<br/>          _serviceURL = serviceURL;<br/>      }</pre>
<ol start="18">
<li>Finally, let's add the method to read from the REST service:</li>
</ol>
<pre>      public async Task&lt;string&gt; GetPostById(int id)<br/>      {<br/>          string output; <br/><br/>          using (var httpClient = new HttpClient())<br/>          {<br/><br/>              Uri uri = new Uri($"{_serviceURL}/posts/{id}");<br/>              using (HttpResponseMessage response = <br/>                  await httpClient.GetAsync(uri))<br/>              {<br/>                  output = await response.Content.ReadAsStringAsync();<br/>              }<br/>          }<br/>          <br/>          return output;<br/>      }</pre>
<ol start="19">
<li>Press <em>Ctrl</em> + <em>Shift</em> + <em><span class="span">B</span></em> for a quick build to check the syntax.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>In steps 1 to 11, we created an empty solution. Then we added a .NET Standard 2.0 library to that solution. Again, as a good practice we properly named the solution and the class library project. In steps 12 and 13, we changed the name of the default <kbd>Class1.cs</kbd> created by Visual Studio. In step 15, we added <kbd>using</kbd> directives required for our task. In step 16, we created a class-wide private variable to hold the service URL. Then, in step 16 we created the default constructor with a <kbd>string</kbd> parameter that updates the private variable in step 15.</p>
<p>In step 18, we created the <kbd>public</kbd> method that did the actual work of reading the RESTful API. In the first line of code, we created a <kbd>string</kbd> variable that held the output from the service. Then, we created an instance of the <kbd><span class="span">HttpClient</span></kbd> class inside a <kbd><span class="span">using</span></kbd> statement. This is a good practice that will make sure the class is destroyed after we exit the <kbd><span class="span">using</span></kbd> statement.</p>
<p>Then we populated the <strong>Universal Resource Indicator</strong> (<strong>URI</strong>) to the service. After that, we did the actual call to the service and stored it inside a <kbd><span class="span">HttpResponseMessage</span></kbd> variable. Finally, we got the output from the response and returned the output.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Creating an ASP.NET MVC application to use the library</h1>
                </header>
            
            <article>
                
<p>In this recipe, we will be creating an ASP.NET MVC application to use the library we have created.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>Make sure you have completed the previous recipe. If not, you need to complete it before going through this one. If you have already done it, open it and do a quick build before we start.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it..</h1>
                </header>
            
            <article>
                
<ol>
<li>Open Visual Studio 2017.</li>
<li>Now open the solution from the previous recipe. Click<span> </span><span class="span"><span class="packt_screen">File</span></span><span> </span>|<span> </span><span class="span"><span class="packt_screen">Open</span></span><span> </span>|<span> </span><span class="span"><span class="packt_screen">Open Project/Solution</span></span><span> </span>or press<span> </span><span class="span"><em>Ctrl</em> + <em>Shift</em> + <em>O</em></span><span> </span>and select the <kbd>Chapter7.RestAPI</kbd> solution. </li>
<li>Press<span> </span><em>Ctrl</em><span> </span>+<span> </span><em>Shift</em><span> </span>+<span> </span><em><span class="span">B</span></em><span> </span>for a quick build to check everything is fine. </li>
<li>Now click on the <kbd>Chapter7.RestAPI</kbd> solution label. Click<span> </span><span class="span"><span class="packt_screen">File</span></span><span> </span>|<span> </span><span class="span"><span class="packt_screen">Add</span></span><span> </span>|<span> </span><span class="span"><span class="packt_screen">New Project</span></span>.</li>
<li>In the<span> </span><span class="span"><span class="packt_screen">Add New Project</span></span><span> </span>template dialog box, expand the <span class="span"><span class="packt_screen">Visual C#</span></span> node in the left pane. </li>
<li>Select <span class="packt_screen">Web</span> and select <span class="span"><span class="packt_screen">ASP.NET Web Application (.NET Framework)</span></span> in the right pane:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/faf4537a-9012-4a0b-90b3-6d565ab89c6a.png"/></div>
<ol start="7">
<li>Now, in the <span class="span"><span class="packt_screen">Name:</span></span> textbox type <kbd>Chapter7.RestAPI.RestMVC</kbd> as the name and leave the <span class="span"><span class="packt_screen">Location:</span></span> textbox at its default value:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/5198b734-2d06-44ed-867f-cb7ca9c4d757.png"/></div>
<ol start="8">
<li>In the <span class="packt_screen">New ASP.NET Web Application</span> dialog box, select <span class="packt_screen">Empty</span> from the template list.</li>
</ol>
<ol start="9">
<li>Select <span class="packt_screen">MVC</span> for the <span class="packt_screen">Add folders and core references for:</span> option:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-810 image-border" src="assets/2536cab0-2ef4-4409-9fb6-b89acef01432.png" style="width:129.92em;height:85.00em;"/></div>
<ol start="10">
<li>Leave the rest as is and click <span class="packt_screen">OK</span> to create the default <span class="packt_screen">ASP.NET MVC Web</span> application template. </li>
</ol>
<ol start="11">
<li>Now <span class="packt_screen">Solution Explorer</span> should look like this: </li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-811 image-border" src="assets/9812b404-a8a7-46c2-a28a-4ec6f9e397e0.png" style="width:33.58em;height:33.58em;"/></div>
<ol start="12">
<li>Now, click the right mouse button on the <span class="packt_screen">References</span> label under the <kbd>Chapter7.RestAPI.RestMVC</kbd> project and select <span class="packt_screen">Add Reference</span>.</li>
</ol>
<ol start="13">
<li>In the <span class="packt_screen">Reference Manager</span> dialog box, select <span class="packt_screen">Projects</span> in the left pane and select <kbd>Chapter7.RestAPI.RestLib</kbd> in the right pane:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-812 image-border" src="assets/c72f1dd8-5969-4779-a36d-7bd41ffe9ce7.png" style="width:61.67em;height:24.75em;"/></div>
<ol start="14">
<li> Click <span class="packt_screen">OK</span>.</li>
<li>Now, click the right mouse button on the <kbd><span class="span">Controllers</span></kbd> folder inside the <kbd>Chapter7.RestAPI.RestMVC</kbd> project. </li>
<li>Select <span class="span"><span class="packt_screen">Add</span></span> | <span class="span"><span class="packt_screen">Controller</span></span>.</li>
</ol>
<ol start="17">
<li>In the <span class="span"><span class="packt_screen">Add Scaffold</span></span> dialog box, select <span class="span"><span class="packt_screen">MVC 5 Controller - Empty</span></span> from the template list and click <span class="span"><span class="packt_screen">Add</span></span>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-813 image-border" src="assets/57bc63dd-4140-4a3e-9d76-35f34aa6fdd8.png" style="width:156.25em;height:107.92em;"/></div>
<ol start="18">
<li>Now, in the <span class="packt_screen">Add Controller</span> dialog box type <kbd>HomeController</kbd> in the <span class="packt_screen">Controller name:</span> textbox:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-814 image-border" src="assets/5b6a25b8-c003-4ece-b956-5cdfa3410f68.png" style="width:39.92em;height:9.42em;"/></div>
<ol start="19">
<li>Click <span class="span"><span class="packt_screen">Add</span></span>.</li>
<li>Double-click on the <kbd>HomeController.cs</kbd> label under the <kbd>Controllers</kbd> folder.</li>
<li>In the code window, click the right mouse button on the <kbd><span class="span">Index()</span></kbd> method name and select <span class="span"><span class="packt_screen">Add View</span></span>.</li>
<li>Leave the defaults in the <span class="span"><span class="packt_screen">Add View</span></span> dialog box and click <span class="span"><span class="packt_screen">Add</span></span>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-815 image-border" src="assets/68ce1334-981b-46ac-a75b-5da006e03360.png" style="width:96.83em;height:54.42em;"/></div>
<ol start="23">
<li>Click on the <kbd>HomeController.cs</kbd> tab in the code window.</li>
<li>Add this <kbd><span class="span">using</span></kbd> directive at the top of the code, next to the last line of all the directives:</li>
</ol>
<pre>      using System.Threading.Tasks;<br/>      using System.Web.Script.Serialization;<br/>      using Chapter7.RestAPI.RestLib;</pre>
<ol start="25">
<li>Now change the <kbd>default Index()</kbd> action to the following:</li>
</ol>
<pre>      public async Task&lt;ActionResult&gt; Index()</pre>
<ol start="26">
<li>Add the following code inside the <kbd>Index()</kbd> method:</li>
</ol>
<pre>      var service = "https://jsonplaceholder.typicode.com";<br/>      var restClient = new PostsReader(service);<br/><br/>      var result = await restClient.GetPostById(1);<br/>      ViewBag.Post = new JavaScriptSerializer().Deserialize&lt;Dictionary<br/>          &lt;string, string&gt;&gt;(result);<br/><br/>      return View();</pre>
<ol start="27">
<li> Now, let's open up the <kbd>Index.cshtml</kbd> file and add the following code beneath the <kbd>&lt;h2&gt;Index&lt;/h2&gt;</kbd> tag:</li>
</ol>
<pre>      @{<br/>          var post = (Dictionary&lt;string, string&gt;)ViewBag.Post;<br/>      }<br/><br/>      @foreach (var item in post)<br/>      {<br/>          &lt;p&gt;<br/>              &lt;strong&gt;@item.Key&lt;/strong&gt; : @item.Value<br/>          &lt;/p&gt;<br/>      }</pre>
<ol start="28">
<li>Now, make sure you have set your <span class="packt_screen">MVC project</span> as the default project.</li>
<li>Press <em>F5</em> and you should see an output like this:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-816 image-border" src="assets/ed71174e-1108-42fb-ad57-bb4071e63887.png" style="width:142.83em;height:70.42em;"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>In steps 1 to 11, we opened the solution and added an ASP.NET MVC project. Then, we gave a proper name to the project. In steps 12 and 13, we added the reference to the library we built in the previous recipe. In steps 16 to 18, we added an empty controller to the project. Then, in steps 21 and 22 we added a view to the <kbd><span class="span">Index()</span></kbd> action in the <kbd><span class="span">HomeController</span></kbd>.</p>
<p>In step 23, we added the code-level reference to the library itself and added two more namespaces required for our task. In step 24, we changed the <kbd><span class="span">Index()</span></kbd> action to an <kbd>async</kbd> method. This is required since we will be using an <kbd>async</kbd> method from the library itself. In step 26, we created the service URL for our test bed. Then, we created an instance of the <kbd><span class="span">PostsReader</span></kbd> class. In the third line, we used the <kbd><span class="span">GetPostById()</span></kbd> method to get the result from the service. Again, in the fourth line of code, we used a method from the <kbd><span class="span">JavaScriptSerializer</span></kbd> class to deserialize the output that came from the service to a <span class="span">Dictionary</span>.</p>
<p>Finally, we stored the result in a <kbd><span class="span">ViewBag</span></kbd> and passed it to the <kbd>Index</kbd> view. In step 27, we got the Dictionary out of the <kbd><span class="span">ViewBag</span></kbd> and displayed the content using <kbd><span class="span">Razor</span></kbd> syntax.</p>
<p>Finally, we tested the output in step 29.</p>


            </article>

            
        </section>
    </body></html>