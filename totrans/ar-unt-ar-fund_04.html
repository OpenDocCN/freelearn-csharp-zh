<html><head></head><body><div id="sbo-rt-content"><div id="_idContainer056">
			<h1 id="_idParaDest-62"><em class="italic"><a id="_idTextAnchor064"/>Chapter 3</em><strong class="bold">: Improving the Developer Workflow</strong></h1>
			<p>When developing for <strong class="bold">Augmented Reality</strong> (<strong class="bold">AR</strong>), like any software development, it's important to understand your tools, learn how to troubleshoot when you get "stuck," and endeavor to make your overall developer workflow more efficient. In this chapter, we will consider some best practices, techniques, and advanced tools for troubleshooting and testing AR applications in development. </p>
			<p>Unity is generally quite friendly for developing for mobile devices. For example, you will normally use the Editor Play-mode to preview your scene in the Editor, allowing rapid<strong class="bold"> </strong><em class="italic">develop-test-update-repeat</em> cycles. And with an <em class="italic">editor remote tool</em>, you can run and test on your target mobile device without having to do builds each time.</p>
			<p>But Augmented Reality imposes unique challenges because it requires sensor input on the remote device, including a live camera feed and motion sensors. It also requires AR processing built into the mobile software (Android, iOS) that detects features in the environment (such as planes or faces) and tracks your physical device in the real world. Your app requires this data, but it's remote and not normally available to Unity in the Editor Play mode. In this chapter, we'll explore various techniques and tools to deal with this and improve AR development workflows.</p>
			<p>In this chapter, you will learn about the following:</p>
			<ul>
				<li>Troubleshooting with log messages</li>
				<li>Debugging with a debugger</li>
				<li>Testing with an editor remote tool </li>
				<li>Simulating environments with the Unity project MARS</li>
			</ul>
			<p>If you're impatient and want to begin developing an AR project right away, you may skip this chapter and jump into <a href="B15145_04_Final_SB_epub.xhtml#_idTextAnchor077"><em class="italic">Chapter 4</em></a>, <em class="italic">Creating an AR User Framework</em>, where we start our first real project. If that's the case, go ahead but please plan to come back here as soon as you realize this chapter can help you.</p>
			<h1 id="_idParaDest-63"><a id="_idTextAnchor065"/>Technical requirements</h1>
			<p>This chapter does not have special technical requirements other than a working development system with Unity installed, a project set up with the XR Plugin and the AR Foundation package, and the ability to successfully build and run on your target device, as given in <a href="B15145_01_Final_SB_epub.xhtml#_idTextAnchor013"><em class="italic">Chapter 1</em></a>, <em class="italic">Setting Up for AR Development</em>. The scripts and assets created in this chapter can be found in this book's GitHub repository: <a href="https://github.com/PacktPublishing/Augmented-Reality-with-Unity-AR-Foundation">https://github.com/PacktPublishing/Augmented-Reality-with-Unity-AR-Foundation</a>. </p>
			<h1 id="_idParaDest-64"><a id="_idTextAnchor066"/>Troubleshooting with log messages</h1>
			<p>If (and when) an<a id="_idIndexMarker247"/> error occurs while developing or running your Unity project, the first thing you must do is consult the <strong class="bold">Console</strong> window for messages. The <strong class="bold">Console</strong> window is where you'll find all kinds of messages including asset import warnings, compiler errors, runtime errors in play mode, build problems when you <strong class="bold">Build And Run</strong>, and others. Compiler errors (such as coding syntax errors) may prevent the scene from running at all (and the <strong class="bold">Play</strong> button will become disabled). </p>
			<p>There are three levels of console messages: <strong class="bold">Info</strong>, <strong class="bold">Warning</strong> (shown in orange), and <strong class="bold">Error</strong> (shown in red). You can filter the messages using the toggle buttons in the <strong class="bold">Console</strong> window toolbar, as highlighted in the following screen capture:</p>
			<div>
				<div id="_idContainer036" class="IMG---Figure">
					<img src="Images/Figure_3.01-ConsoleNullExceptionError.jpg" alt="Figure 3.1 – The Console window showing a null exception error&#13;&#10;" width="695" height="273"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.1 – The Console window showing a null exception error</p>
			<p>Runtime errors, such as the <strong class="bold">ArgumentNullException</strong> error shown in the preceding screenshot, can occur during<a id="_idIndexMarker248"/> program execution when you try to use a variable that is not set to any value (more precisely, when its value is <strong class="source-inline">null</strong>).</p>
			<p class="callout-heading">Tip: "Warning" messages can be extraneous</p>
			<p class="callout">I generally ignore the warning messages in the Unity Editor's <strong class="bold">Console</strong> window, unless I'm deliberately looking for something, as they're often verbose, not relevant to my own problem solving, and thus become noise instead of information. You can hide warning messages by un-clicking the <strong class="bold">Warning</strong> button in the Console toolbar.</p>
			<p>In the <strong class="bold">Console</strong> window, you can often click on an error message to see more details. You might see a list of messages detailing the <strong class="bold">stack trace</strong> that provides the runtime state of the program when the error occurred. A stack trace shows the filenames and line numbers in <a id="_idIndexMarker249"/>components and Unity code. Although sometimes insightful, you generally will not be interested in traces that refer to built-in Unity or system code. Rather, you'll want to focus on your own scripts. So, look for messages that reference scripts located in your own <strong class="source-inline">Assets/</strong> folder. In the preceding screenshot, <em class="italic">Figure 3.1</em>, the null exception error occurred on line 27 of the <strong class="source-inline">MyScript.cs</strong> file when it was calling the C# <strong class="source-inline">System.Int32.Parse</strong> function.</p>
			<p class="callout-heading">Tip: Read your Console messages carefully</p>
			<p class="callout">A common mistake I often see by novice and experienced developers alike is not reading error messages carefully. When you're in the flow of things, it's often too easy to assume you know what the message is saying and not really read it, missing key clues needed for troubleshooting. </p>
			<p>You can also write a message to the Console from your own scripts, using <strong class="source-inline">Debug.Log</strong> calls. </p>
			<h2 id="_idParaDest-65"><a id="_idTextAnchor067"/>Using Debug.Log</h2>
			<p>When writing C# scripts, you can log your own messages to the Console using <strong class="source-inline">Debug.Log()</strong> function calls. This is the most common method of checking and understanding what is going <a id="_idIndexMarker250"/>on inside your code when it is running. <strong class="source-inline">Debug.Log</strong> messages appear as <em class="italic">Info</em> messages in the Console (you can also call <strong class="source-inline">Debug.LogError()</strong> to have them appear as <em class="italic">Error</em> messages instead). </p>
			<p>For example, suppose I'm trying to locate the root cause of an error in my project. And suppose there are several <strong class="source-inline">MonoBehaviour</strong> scripts that I'm developing related to this problem. I may place log statements at the entry of specific functions and other log statements to print out specific variables that I am suspicious of. Take the following code, for example, for a script named <strong class="source-inline">MyScript.cs</strong>:</p>
			<p class="source-code">// MyScript.cs</p>
			<p class="source-code">using UnityEngine;</p>
			<p class="source-code">class MyScript : MonoBehaviour</p>
			<p class="source-code">{</p>
			<p class="source-code">     public int number;</p>
			<p class="source-code">     void Start()</p>
			<p class="source-code">     {</p>
			<p class="source-code">          number = 10;</p>
			<p class="source-code">     }</p>
			<p class="source-code">     void Update()</p>
			<p class="source-code">     {</p>
			<p class="source-code">          if (number &gt;= 0)</p>
			<p class="source-code">          {</p>
			<p class="source-code">               Debug.Log("in MyScript Update, count = " +                           number);</p>
			<p class="source-code">               DoSomething();</p>
			<p class="source-code">               number -= 1; // reduce number by one</p>
			<p class="source-code">          }</p>
			<p class="source-code">     }</p>
			<p class="source-code">     private void DoSomething()</p>
			<p class="source-code">     {</p>
			<p class="source-code">          Debug.Log("inside DoSomething");</p>
			<p class="source-code">          number = -1; // accidently set number to minus-1</p>
			<p class="source-code">          // other code…</p>
			<p class="source-code">     }</p>
			<p class="source-code">}</p>
			<p>In C# you can <a id="_idIndexMarker251"/>combine (concatenate) text strings using the plus (<strong class="source-inline">+</strong>) operator. In our example, the integer <strong class="source-inline">number</strong> is concatenated to the message string (in <strong class="source-inline">Update</strong>), and C# automatically converts the number to a string value first.</p>
			<p>Add this script to your scene by creating an empty GameObject (<strong class="bold">GameObject</strong> | <strong class="bold">Create Empty</strong>) and dragging the script file from the <strong class="bold">Project</strong> window onto the GameObject. Then click <strong class="bold">Play</strong>. </p>
			<p>When this code runs, what I see in the <strong class="bold">Console</strong> window is shown in the following screen capture: </p>
			<div>
				<div id="_idContainer037" class="IMG---Figure">
					<img src="Images/Figure_3.02-ConsoleDoSomething.jpg" alt="Figure 3.2 – Console messages about my Debug.Log statements&#13;&#10;" width="466" height="134"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.2 – Console messages about my Debug.Log statements</p>
			<p>This will reveal that <strong class="source-inline">DoSomething</strong> is only called once rather than 10 times as expected. Can you figure out why?</p>
			<p>Studying the code in <strong class="source-inline">Update</strong> does not<a id="_idIndexMarker252"/> explain why <strong class="source-inline">DoSomething</strong> was only called once. From there I can re-examine the logic to determine why and when <strong class="source-inline">number</strong> prematurely becomes less than zero. You can see the bug is in the <strong class="source-inline">DoSomething</strong> function itself where it "accidentally" sets <strong class="source-inline">number = -1</strong>, causing the condition in <strong class="source-inline">Update</strong> to never call <strong class="source-inline">DoSomething</strong> after the first time. You may have been stumped while fixated on the <strong class="source-inline">Update</strong> code, but then discovered the bug actually occurs deeper in the program.</p>
			<p class="callout-heading">Tip: Bug hunting? It's probably not where you're looking</p>
			<p class="callout">Here's a funny story. A man leaves a bar and sees a drunk guy walking around in circles near a lamppost, searching the sidewalk. "Hey pal, what's the matter?". The drunk replies, "I lost my keys." So together they keep looking. Finally, the man asks, "Are you sure you dropped them here?". The other responds, "Well, I dropped them over there. But the light's better here." Keep this in mind when you're trying to find a bug – it's often exactly <em class="italic">not</em> where you're looking, otherwise you probably would have found it already!</p>
			<p>So far, we've been using the <strong class="bold">Console</strong> window to log messages using the Unity Editor play mode. In fact, the Console is so useful for troubleshooting, you may also want to see your debug messages while running your project on your remote device. Next, let's consider how you can use the Console while running on a mobile device connected via USB.</p>
			<h2 id="_idParaDest-66"><a id="_idTextAnchor068"/>Using the Console with a mobile device</h2>
			<p>You can use Console logs while running your app on your mobile device, provided the app was built with <strong class="bold">Development Mode</strong> enabled, and the device is attached to the Unity Editor <a id="_idIndexMarker253"/>via a USB cable (or equivalent). To set this up, use the following steps:</p>
			<ol>
				<li>Open the <strong class="bold">Build Settings</strong> window using <strong class="bold">File</strong> | <strong class="bold">Build Settings</strong>.</li>
				<li>Check the <strong class="bold">Development Mode</strong> checkbox.</li>
				<li>Click the <strong class="bold">Build And Run</strong> button.</li>
				<li>After the app successfully builds, installs on the device, launches, and starts to run, any <strong class="source-inline">Debug.Log</strong> calls will appear in the Console if you attach it to the application.<p>In the Unity <strong class="bold">Console</strong> window toolbar, select the <strong class="bold">Editor</strong> button and select the process running on your mobile device. For example, the following screenshot shows me attaching the <strong class="bold">Editor Console</strong> to my Android device:</p></li>
			</ol>
			<div>
				<div id="_idContainer038" class="IMG---Figure">
					<img src="Images/Figure_3.03_-ConsoleAndroid.jpg" alt="Figure 3.3 – Console window attached to an Android device&#13;&#10;" width="692" height="262"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.3 – Console window attached to an Android device</p>
			<p>It's that easy.</p>
			<p>There are other kinds of logs provided by Unity and by your device's operating system. In the <strong class="bold">Console</strong> window, use the three-dot context menu at the top right to access the full Player logs and Editor logs files. On Android, you can also get more detailed messages from your Android device using <em class="italic">logcat</em>. </p>
			<h3>Using logcat with Android devices</h3>
			<p>On Android mobile devices you can monitor any and all log messages from Android itself and any apps running <a id="_idIndexMarker254"/>on the device (including your own Unity one) using a tool called <strong class="bold">logcat</strong>. You can install and use <em class="italic">logcat</em> directly inside the Unity Editor from the Package Manager with the following steps:</p>
			<ol>
				<li value="1">Use <strong class="bold">Window</strong> | <strong class="bold">Package Manager</strong> to open the <strong class="bold">Package Manager</strong> window.</li>
				<li>In the filter select list at the top left, choose <strong class="bold">Unity Registry</strong>.</li>
				<li>Use the search input field at the top right to look for <strong class="source-inline">logcat</strong>.</li>
				<li>Select the package and click the <strong class="bold">Install</strong> button.</li>
				<li>After the package installs, open the <strong class="bold">Logcat</strong> window using <strong class="bold">Window</strong> | <strong class="bold">Analysis</strong> | <strong class="bold">Android Logcat</strong>.</li>
			</ol>
			<p>With <em class="italic">logcat</em> installed and its window open, you can run your app on your connected mobile device. It now does not require being built in <strong class="bold">Development Mode</strong> enabled nor attached to the Editor Console. You'll discover there is a lot going on inside your device; messages may be streaming from all the running tasks, not just your own application! The <strong class="bold">Android Logcat</strong> window offers ways to filter the messages to show only those coming from your app, while your app is running on the device:</p>
			<ul>
				<li>Use the filter drop-down list and choose your app. </li>
				<li>Enter search expressions to filter the message stream. </li>
			</ul>
			<p>A screen capture of the <strong class="bold">Android Logcat</strong> window is shown in the following figure:</p>
			<div>
				<div id="_idContainer039" class="IMG---Figure">
					<img src="Images/Figure_3.04-LogcatWindow.jpg" alt="Figure 3.4 – Android Logcat window&#13;&#10;" width="1215" height="599"/>
				</div>
			</div>
			<p class="figure-caption"> </p>
			<p class="figure-caption">Figure 3.4 – Android Logcat window</p>
			<p>I realize the text in <a id="_idIndexMarker255"/>this screen capture is probably too small to read here! This screenshot is intended to give you a feel of what the window provides.</p>
			<p class="callout-heading">Info: Using the Android adb command-line tool</p>
			<p class="callout">If you are developing for an <a id="_idIndexMarker256"/>Android device, I recommend you also install the Android <strong class="bold">adb</strong> (Android Debug Bridge) command-line tool. (This is what Unity uses internally for watching Console logs and running the Logcat window.) If you have installed the full <em class="italic">Android Studio</em> (<a href="https://developer.android.com/studio">https://developer.android.com/studio</a>), it may already be present on your system. Otherwise, you can install just the command-line tools by navigating to <a href="https://developer.android.com/studio#downloads">https://developer.android.com/studio#downloads</a> and scrolling down the page to the <em class="italic">Command line tools only</em> section to find the download link for your platform. </p>
			<p class="callout">With adb installed (and in your command path), you can run a variety of device actions.  For more details, see <a href="https://developer.android.com/studio/command-line/adb">https://developer.android.com/studio/command-line/adb</a>. For example, the <strong class="source-inline">adb devices</strong> command will list the Android device it presently sees connected to your computer. <strong class="source-inline">adb logcat</strong> will show the internal device logs. To filter the logs for only Unity-related messages, use the <strong class="source-inline">adb logcat -v time -s Unity command</strong>. </p>
			<p>Using the Unity Editor <strong class="bold">Console</strong> and <strong class="source-inline">logcat</strong> is great, but what can you do if you want to troubleshoot an app without the mobile device attached to your computer? This can certainly be the case with <a id="_idIndexMarker257"/>augmented reality applications that require moving within your environment. One solution is you could create a <em class="italic">virtual</em> console window, explained next. </p>
			<p class="callout-heading">Info: Using the Xcode console for iOS devices</p>
			<p class="callout">If you're developing for iOS, there is no equivalent to logcat in Unity. However, you can view logs from your device using the Xcode log console. Open the console using <strong class="bold">View</strong> | <strong class="bold">Debug Area</strong> | <strong class="bold">Activate Console</strong>.</p>
			<h2 id="_idParaDest-67"><a id="_idTextAnchor069"/>Simulating a Console window in your app</h2>
			<p>A strategy for capturing console logs, even when your device is detached from the development computer, is to provide a "virtual console" window in your application. This window would be <a id="_idIndexMarker258"/>for development, not production. The idea is to replace <strong class="source-inline">Debug.Log</strong> calls with a wrapper function, which optionally outputs to a text object on an in-app text area when running a development build. </p>
			<p>We will talk about Unity <strong class="bold">Canvas</strong> objects and UI components more in <a href="B15145_04_Final_SB_epub.xhtml#_idTextAnchor077"><em class="italic">Chapter 4</em></a>,<em class="italic"> Creating an AR User Framework</em>, so I offer the steps here with only limited explanation. </p>
			<p>To implement the wrapper function, use the following steps:</p>
			<ol>
				<li value="1">In the <strong class="bold">Project</strong> window, navigate to your <strong class="source-inline">scripts/</strong> folder (create one if you don't have one yet).</li>
				<li><em class="italic">Right-click</em> in the <strong class="source-inline">scripts</strong> folder, select <strong class="bold">Create</strong> | <strong class="bold">C# Script</strong>, and name the script <strong class="source-inline">ScreenLog</strong>.</li>
				<li>Open the script for <a id="_idIndexMarker259"/>editing and replace the default code with the following:<p class="source-code">// ScreenLog.cs</p><p class="source-code">using UnityEngine;</p><p class="source-code">using UnityEngine.UI;</p><p class="source-code">public class ScreenLog : MonoBehaviour</p><p class="source-code">{</p><p class="source-code">    public Text logText;</p><p class="source-code">    public static ScreenLog Instance { get; private set; }</p><p class="source-code">    void Awake()</p><p class="source-code">    {</p><p class="source-code">        if (!Instance)</p><p class="source-code">            Instance = this;</p><p class="source-code">    }</p><p class="source-code">    private void Start()</p><p class="source-code">    {</p><p class="source-code">        logText.text = "";</p><p class="source-code">    }</p><p class="source-code">    private void _log(string msg)</p><p class="source-code">    {</p><p class="source-code">        if (logText)</p><p class="source-code">            logText.text += msg + "\n";</p><p class="source-code">    }</p><p class="source-code">    public static void Log(string msg)</p><p class="source-code">    {</p><p class="source-code">        if (Instance)</p><p class="source-code">            Instance._log(msg);</p><p class="source-code">        Debug.Log(msg);</p><p class="source-code">    } }</p></li>
			</ol>
			<p>We implement <strong class="source-inline">ScreenLog</strong> as a <strong class="bold">singleton</strong> class (using the <strong class="source-inline">public static ScreenLog Instance</strong> variable), ensuring there will only be one instance of <strong class="source-inline">ScreenLog</strong> in the scene <a id="_idIndexMarker260"/>and providing the ability to address the <strong class="source-inline">Log</strong> function as a class method. (We'll discuss <em class="italic">class</em> versus <em class="italic">instance</em> methods and the <em class="italic">singleton pattern</em> more in the next chapter.) This way, you're able to call <strong class="source-inline">ScreenLog.Log()</strong> from anywhere in your own code.</p>
			<p>Next, we'll add a text window to the app, and toggle its visibility with a <em class="italic">Debug</em> button in the UI. (As mentioned, we are going to cover the Unity UI in more detail in later chapters.) First, let's assume your AR application will be used on a mobile device in portrait orientation with a screen space Canvas to contain the text area:</p>
			<ol>
				<li value="1">From the main menu, create a new Canvas by selecting <strong class="bold">GameObject</strong> | <strong class="bold">UI</strong> | <strong class="bold">Canvas</strong>, and rename it <strong class="source-inline">Debug Canvas</strong>. This will also add an <strong class="bold">Event System</strong> game object to the scene if one is not already present.</li>
				<li>To edit the <em class="italic">Screen Space</em> Canvas, let's switch the <strong class="bold">Scene</strong> window to a 2D view by clicking the <strong class="bold">2D</strong> button in the <strong class="bold">Scene</strong> window toolbar. </li>
				<li>It's also helpful to arrange the <strong class="bold">Game</strong> window and <strong class="bold">Scene</strong> window side by side. Because we're <a id="_idIndexMarker261"/>developing for AR, set the <strong class="bold">Game</strong> window's display to a fixed portrait aspect ratio, such as <strong class="bold">2160x1080 Portrait</strong> using the dimension select list in the <strong class="bold">Game</strong> window's top toolbar. This layout can be seen in the following screenshot: </li>
			</ol>
			<div>
				<div id="_idContainer040" class="IMG---Figure">
					<img src="Images/Figure_3.05-SceneGameSidebyside.jpg" alt="Figure 3.5 – The Scene and Game windows side by side with the portrait device view set up&#13;&#10;" width="932" height="585"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.5 – The Scene and Game windows side by side with the portrait device view set up</p>
			<p>(This screenshot was captured after all these steps were completed; your Canvas does not have the scrolling text area yet.)</p>
			<p>Next, we'll add a scrolling text area where we'll write the log messages:</p>
			<ol>
				<li value="1">In the <strong class="bold">Hierarchy</strong> window, select <strong class="bold">Debug Canvas</strong>. Then right-click, and select <strong class="bold">UI</strong> | <strong class="bold">Scroll View</strong>.</li>
				<li>Resize and place the <strong class="bold">Scroll View</strong> in a convenient area of the screen. Use the <strong class="bold">Anchor Presets</strong> menu <a id="_idIndexMarker262"/>to help align the panel along specific edges of the screen. For example, to anchor it to the top of the screen, select the <strong class="bold">Anchor Presets button</strong> | <strong class="bold">Stretch-Top</strong> and then <em class="italic">Shift</em> + <em class="italic">Alt</em> + click <strong class="bold">Stretch-Top</strong> and set its <strong class="bold">Height</strong> to <strong class="source-inline">400</strong>. The resulting <strong class="bold">Rect Transform</strong> has <strong class="bold">Left, Right</strong>: (<strong class="source-inline">0, 0)</strong>, <strong class="bold">Pos Y</strong>: <strong class="source-inline">0</strong>, <strong class="bold">Anchor Min</strong>: <strong class="source-inline">(0, 1)</strong>, <strong class="bold">Anchor Max</strong>: <strong class="source-inline">(1, 1)</strong>, and <strong class="bold">Pivot</strong>: <strong class="source-inline">(0.5, 1)</strong>. The <strong class="bold">Rect Transform</strong> component and the location of the <strong class="bold">Anchor Presets</strong> menu button are shown in the following screenshot:<div id="_idContainer041" class="IMG---Figure"><img src="Images/Figure_3.06-RectTransform.jpg" alt="Figure 3.6 – The Rect Transform component with the Anchor Presets button highlighted&#13;&#10;" width="503" height="217"/></div><p class="figure-caption">Figure 3.6 – The Rect Transform component with the Anchor Presets button highlighted</p></li>
				<li>Allow only vertical scrolling by un-checking the <strong class="bold">Scroll Rect</strong> | <strong class="bold">Horizontal</strong> checkbox. </li>
				<li>Then double-click <strong class="bold">Debug Canvas</strong> in <strong class="bold">Hierarchy</strong> to bring it into focus (you might need to double-click it twice).</li>
				<li>In <strong class="bold">Hierarchy</strong>, unfold <strong class="bold">Scroll View</strong> (the triangle icon) and its <strong class="bold">Viewport</strong>. Select the child <strong class="bold">Content</strong> object and set its anchors and size by selecting <strong class="bold">Rect Transform</strong> | <strong class="bold">Anchor Presets</strong> | <strong class="bold">Stretch-Stretch</strong>, and <em class="italic">Shift</em> + <em class="italic">Alt</em> + click <strong class="bold">Stretch-Stretch</strong> to fill the Viewport. </li>
			</ol>
			<p>The <strong class="bold">Inspector</strong> window for <strong class="bold">Scroll View</strong> is shown in the following screenshot:</p>
			<div>
				<div id="_idContainer042" class="IMG---Figure">
					<img src="Images/Figure_3.07-ScrollViewInspector.jpg" alt="Figure 3.7 – Scroll View property settings&#13;&#10;" width="598" height="536"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.7 – Scroll View property settings</p>
			<p>Now we can work on the text element itself:</p>
			<ol>
				<li value="1">On the <strong class="bold">Content</strong> object, <em class="italic">right-click</em> | <strong class="bold">Create</strong> | <strong class="bold">UI</strong> | <strong class="bold">Text</strong>. Rename it <strong class="source-inline">Debug Text</strong>. (Note, you may prefer to use <em class="italic">TextMesh Pro</em> text elements, which give you more control <a id="_idIndexMarker263"/>over the typography and padding without any performance costs—introduced in the next chapter.)</li>
				<li>With the <strong class="bold">Debug Text</strong> game object selected, have it fill the <strong class="bold">Content</strong> area by using <strong class="bold">Anchor Presets</strong> | <strong class="bold">Stretch-Stretch</strong>, and <em class="italic">Shift</em> + <em class="italic">Alt</em> + click <strong class="bold">Stretch-Stretch</strong>. </li>
				<li>For reference, enter a placeholder string in the <strong class="bold">Text</strong> | <strong class="bold">Text</strong> property, such as <strong class="source-inline">[Log message]</strong>.</li>
				<li>Adjust <strong class="bold">Font Size</strong>, for example, to <strong class="source-inline">36</strong>.</li>
				<li>Set <strong class="bold">Alignment</strong> to <strong class="bold">Bottom</strong>.</li>
				<li>Change <strong class="bold">Vertical Overflow</strong> to <strong class="bold">Overflow</strong> (instead of <strong class="bold">Truncate</strong>).</li>
				<li>Personally, I like white text on a black background for the Console. If you agree, in <strong class="bold">Scroll View</strong> | <strong class="bold">Image</strong> | <strong class="bold">Color</strong>, set <strong class="bold">R, G, B</strong> to <strong class="source-inline">0</strong> and <strong class="bold">Alpha</strong> to <strong class="source-inline">200</strong>, and in <strong class="bold">Debug Text</strong> | <strong class="bold">Text</strong> | <strong class="bold">Color</strong>, set <strong class="bold">R, G, B</strong> to <strong class="source-inline">255</strong>.</li>
			</ol>
			<p>The resulting <a id="_idIndexMarker264"/>GameObject <strong class="bold">Hierarchy</strong> and <strong class="bold">Inspector</strong> settings for the <strong class="bold">Debug Text</strong> object are shown in the following screenshot:</p>
			<div>
				<div id="_idContainer043" class="IMG---Figure">
					<img src="Images/Figure_3.08-DebugTextInspector.jpg" alt="Figure 3.8 – Debug Canvas Hierarchy and Debug Text settings&#13;&#10;" width="982" height="719"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.8 – Debug Canvas Hierarchy and Debug Text settings</p>
			<p>Next, we will add our script to the scene:</p>
			<ol>
				<li value="1">With <strong class="bold">Debug Canvas</strong> selected in the <strong class="bold">Hierarchy</strong> window, locate the <strong class="bold">ScreenLog</strong> script in the <strong class="bold">Project</strong> window and drag the script file onto the <strong class="bold">Debug Canvas</strong> GameObject.</li>
				<li>With <strong class="bold">Debug Canvas</strong> still <a id="_idIndexMarker265"/>selected, locate the <strong class="bold">Debug Text</strong> GameObject in the <strong class="bold">Hierarchy</strong> window, drag it into the <strong class="bold">Inspector</strong>, and drop it onto the <strong class="bold">Log Text</strong> slot on the <strong class="bold">Screen Log</strong> component, as shown in the following screenshot:</li>
			</ol>
			<div>
				<div id="_idContainer044" class="IMG---Figure">
					<img src="Images/Figure_3.09-CanvasScreenLogText.jpg" alt="Figure 3.9 – Setting the Log Text reference to the Debug Text GameObject&#13;&#10;" width="752" height="214"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.9 – Setting the Log Text reference to the Debug Text GameObject</p>
			<p>We can now add a Debug button to the UI to toggle the text panel, as follows:</p>
			<ol>
				<li value="1"><em class="italic">Right-click</em> on <strong class="bold">Debug Canvas</strong> in <strong class="bold">Hierarchy</strong> and select <strong class="bold">UI</strong> | <strong class="bold">Button</strong> from the menu, to make it a child of the Canvas object. Rename the GameObject to <strong class="source-inline">Debug Button</strong>.</li>
				<li>Size and place <a id="_idIndexMarker266"/>the button on your screen. For example, set its <strong class="bold">Rect Transform</strong> | <strong class="bold">Width, Height</strong> to (<strong class="source-inline">175, 175</strong>), and anchor it to the lower left of the screen using <strong class="bold">Rect Transform</strong> | <strong class="bold">Anchor Presets</strong> | <strong class="bold">Bottom-Left</strong> and <em class="italic">Shift</em> + <em class="italic">Alt</em> + <strong class="bold">Bottom-Left</strong>, then set <strong class="bold">Pos X, Pos Y</strong> to (<strong class="source-inline">30, 30</strong>). </li>
				<li>In <strong class="bold">Hierarchy</strong>, unfold <strong class="bold">Debug Button</strong> and select its child <strong class="bold">Text</strong> object. In the <strong class="bold">Inspector</strong>, change its <strong class="bold">Text</strong> content to <strong class="source-inline">Debug</strong>. You can also adjust its font properties from here, such as setting <strong class="bold">Font Size</strong> to <strong class="source-inline">36</strong>.</li>
				<li>To change the Debug button into a toggle button, replace the <strong class="bold">Button</strong> component with a <strong class="bold">Toggle</strong> component. <p>In <strong class="bold">Hierarchy</strong>, select the <strong class="bold">Debug Button</strong> object. In the <strong class="bold">Inspector</strong>, use the three-dot context menu icon on the <strong class="bold">Button</strong> component (or right-click on the component) and select <strong class="bold">Remove Component</strong>. </p></li>
				<li>Then click <strong class="bold">Add Component</strong>, search <strong class="source-inline">toggle</strong>, and add a <strong class="bold">Toggle</strong> component.</li>
				<li>Now we'll configure <a id="_idIndexMarker267"/>the toggle to handle On Value Changed events. In the <strong class="bold">Toggle</strong> | <strong class="bold">On Value Changed</strong> properties, click the small <strong class="bold">+</strong> icon at the bottom right.</li>
				<li>Drag the <strong class="bold">Scroll View</strong> object from the <strong class="bold">Hierarchy</strong> window onto the on-click event's <strong class="bold">None (Object)</strong> slot. Then, in the <strong class="bold">Function</strong> selector, choose <strong class="bold">Game Object</strong> | <strong class="bold">Dynamic Bool</strong> | <strong class="bold">SetActive</strong>. <p>The <strong class="bold">Toggle</strong> component now has the following settings:</p><div id="_idContainer045" class="IMG---Figure"><img src="Images/Figure_3.10-ButtonToggleInspector.jpg" alt="Figure 3.10 – Debug Button set up with a Toggle component&#13;&#10;" width="612" height="647"/></div><p class="figure-caption">Figure 3.10 – Debug Button set up with a Toggle component</p></li>
				<li>Lastly, save this rig as a prefab that you can reuse in other scenes. Drag <strong class="bold">Debug Canvas</strong> from <a id="_idIndexMarker268"/>the <strong class="bold">Hierarchy</strong> window into your <strong class="source-inline">Prefabs/</strong> folder in the <strong class="bold">Project</strong> window. (If you don't have a <strong class="source-inline">Prefabs</strong> folder, create one first. The folder name is not required, it's by convention.) <p>And remember, if you make new changes to this Canvas (or children) in <strong class="bold">Hierarchy</strong>, save those changes to the prefab asset using <strong class="bold">Overrides</strong> | <strong class="bold">Apply All</strong>. </p></li>
			</ol>
			<p>With this setup, we can now use the <strong class="source-inline">ScreenLog.Log()</strong> function instead of <strong class="source-inline">Debug.Log()</strong> anywhere <a id="_idIndexMarker269"/>you want to add an info message in your code, as shown in the following screen capture from my phone:</p>
			<div>
				<div id="_idContainer046" class="IMG---Figure">
					<img src="Images/Figure_3.11-VirtualConsoleOnPhone.jpg" alt="Figure 3.11 – Screenshot of my phone using the virtual console&#13;&#10;" width="570" height="1013"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.11 – Screenshot of my phone using the virtual console</p>
			<p>An advantage of this approach is you can modify it to selectively provide a status message log even for end users, not just your own development.</p>
			<p class="callout-heading">Info: Third-party virtual consoles</p>
			<p class="callout">Aside from rolling your own as we do in this chapter, there are third-party virtual console packages you can find in the <a id="_idIndexMarker270"/>Asset Store, with a range of features and costs. The <em class="italic">Lunar Mobile Console – Free</em> asset, for example, is easy to<a id="_idIndexMarker271"/> install and use – see <a href="https://assetstore.unity.com/packages/tools/gui/lunar-mobile-console-free-82881">https://assetstore.unity.com/packages/tools/gui/lunar-mobile-console-free-82881</a>. These tend to be strictly for development purposes and are not appropriate for exposing log messages to end users.</p>
			<p>To get a deeper insight into what their code is doing, many programmers like to use a debugger tool provided by <strong class="bold">Integrated development environments</strong> (<strong class="bold">IDEs</strong>) such as Visual Studio. </p>
			<h1 id="_idParaDest-68"><a id="_idTextAnchor070"/>Debugging with a debugger</h1>
			<p>Professional software developers are familiar with code <strong class="bold">debuggers</strong>, used to test and debug programs by <a id="_idIndexMarker272"/>stopping the execution at specific lines of code and examining the state of the memory and other runtime conditions. In this section, I will give you an introduction to using the Visual Studio debugger <a id="_idIndexMarker273"/>with Unity projects. The debugger can be used in both the Unity Editor play mode, as well as in your builds running on the attached device.</p>
			<p>With a debugger, you can set a <strong class="bold">breakpoint</strong> at a specific line of code, where the execution will stop at that line, allowing you to query the values of variables, and wait for you to step through or continue the execution of the program.</p>
			<p>To use a debugger in the Editor play mode you do not need to make any special changes, provided <a id="_idIndexMarker274"/>you are already using Visual Studio for your code editor (or another supported <strong class="bold">interactive development environment</strong> (<strong class="bold">IDE</strong>) such as <strong class="bold">VS Code</strong> or <strong class="bold">JetBrains Rider</strong>). You can configure Unity for <a id="_idIndexMarker275"/>your preferred <a id="_idIndexMarker276"/>editor/debugger using <strong class="bold">Edit</strong> | <strong class="bold">Preferences</strong> | <strong class="bold">External Tools</strong>. For example, in the following screenshot, you can see my Unity install has <strong class="bold">External Script Editor</strong> set to a <strong class="bold">Visual Studio Community</strong> version:</p>
			<div>
				<div id="_idContainer047" class="IMG---Figure">
					<img src="Images/Figure_3.12-ExternalEditor.jpg" alt="Figure 3.12 – You can set your default code editor in the Unity Preferences window&#13;&#10;" width="777" height="349"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.12 – You can set your default code editor in the Unity Preferences window</p>
			<p>With Visual Studio <a id="_idIndexMarker277"/>opened for your project (choose <strong class="bold">Assets</strong> | <strong class="bold">Open C# Project</strong>), you can do more than edit your scripts. You can debug them too. For example, you can set a breakpoint by clicking in the left margin on the <a id="_idIndexMarker278"/>line you would like to debug. The following screen capture shows the <strong class="source-inline">MyScript.cs</strong> script is open, and I've created a breakpoint on line 25, indicated in VS Code by a red dot on the screen:</p>
			<div>
				<div id="_idContainer048" class="IMG---Figure">
					<img src="Images/Figure_3.13-VSBreakpoint.jpg" alt="Figure 3.13 – Setting a breakpoint in Visual Studio&#13;&#10;" width="802" height="421"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.13 – Setting a breakpoint in Visual Studio</p>
			<p>To attach the <a id="_idIndexMarker279"/>debugger to your Unity Editor session, use the <strong class="bold">Attach To Unity</strong> button in the top toolbar. Back in Unity, if you <a id="_idIndexMarker280"/>have not yet enabled C# debugging, you will get a prompt like the following: </p>
			<div>
				<div id="_idContainer049" class="IMG---Figure">
					<img src="Images/Figure_3.14-EnableDebuggingDialog.jpg" alt="Figure 3.14 – Unity prompt to enable debugging&#13;&#10;" width="471" height="313"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.14 – Unity prompt to enable debugging</p>
			<p>Click one of the <strong class="bold">Enable</strong> buttons.</p>
			<p>Note that Debug <a id="_idIndexMarker281"/>Mode can be toggled using the corresponding icon in the bottom-right corner of the Editor window.</p>
			<p>Once debugging is enabled and you click <strong class="bold">Play</strong> in the Editor, if and when a breakpoint line is reached in <a id="_idIndexMarker282"/>your code, execution will stop, and Visual Studio will be given focus on your desktop. The current line of code will be highlighted in yellow on your screen:</p>
			<div>
				<div id="_idContainer050" class="IMG---Figure">
					<img src="Images/Figure_3.15-VSDebugging.jpg" alt="Figure 3.15 – Debugging a line of code in the Visual Studio debugger&#13;&#10;" width="1117" height="803"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.15 – Debugging a line of code in the Visual Studio debugger</p>
			<p>There are also <a id="_idIndexMarker283"/>debugging windows where <a id="_idIndexMarker284"/>you can examine the current values of variables in the script, the current call stack, and so on.</p>
			<p>While debugging, the <em class="italic">debugger toolbar</em> is also active at the top of the window, depicted in the following screenshot: </p>
			<div>
				<div id="_idContainer051" class="IMG---Figure">
					<img src="Images/Figure_3.16-DebuggerToolbar.jpg" alt="Figure 3.16 – The debugger toolbar&#13;&#10;" width="356" height="92"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.16 – The debugger toolbar</p>
			<p>The <strong class="bold">Continue</strong> button (1) will continue running from here until it reaches another breakpoint. The <strong class="bold">Stop</strong> button (2) will disable the debugger mode, and the step buttons (3) do the following: <strong class="bold">Step Into</strong> follows the code into the body of a function call, <strong class="bold">Step Over</strong> will run to the next line of code in the current file, and <strong class="bold">Step Up</strong> takes you up the call stack one level.</p>
			<p>You can also run the debugger on code running on your attached mobile device.</p>
			<h2 id="_idParaDest-69"><a id="_idTextAnchor071"/>Debugging on a remote device</h2>
			<p>To run the <a id="_idIndexMarker285"/>debugger on your project running on your mobile device, you must first enable <strong class="bold">Script Debugging</strong> and <strong class="bold">Development Build</strong> in the project's <strong class="bold">Build Settings</strong>. Use the following steps:</p>
			<ol>
				<li value="1">Open the <strong class="bold">Build Settings</strong> window using <strong class="bold">File</strong> | <strong class="bold">Build Settings</strong>.</li>
				<li>Check the <strong class="bold">Development Build</strong> checkbox.</li>
				<li>Check the <strong class="bold">Script Debugging</strong> checkbox.</li>
				<li>Optionally, check the <strong class="bold">Wait For Managed Debugger</strong> checkbox.</li>
				<li>When you're ready, click <strong class="bold">Build And Run</strong>.</li>
			</ol>
			<p>When the app is running on the device, attach your debugger to the remote process as follows:</p>
			<ol>
				<li value="1">In Visual Studio, select from the main menu <strong class="bold">Debug</strong> | <strong class="bold">Attach Unity Debugger</strong>.</li>
				<li>A dialog box will appear with a list of potential processes, as depicted in the following screenshot. Choose the process that you want to attach and click <strong class="bold">OK</strong>:</li>
			</ol>
			<div>
				<div id="_idContainer052" class="IMG---Figure">
					<img src="Images/Figure_3.17-ChooseUnityProcess.jpg" alt="" width="500" height="242"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.17 – Attaching the Visual Studio debugger to a Unity process on a mobile phone</p>
			<p>You can now set and examine breakpoints in the app running on your device. Note, once you close the app <a id="_idIndexMarker286"/>on your phone, the debugger also stops in Visual Studio and detaches. </p>
			<p>The <strong class="bold">Wait For Managed Debugger</strong> build option is useful if you need to start the debugger before Unity starts running. Since Visual Studio needs a process to attach to, the app will start up, then wait for you to attach the debugger, as shown in the following screenshot:</p>
			<div>
				<div id="_idContainer053" class="IMG---Figure">
					<img src="Images/Figure_3.18-AttachDebugger.jpg" alt="Figure 3.18 – Prompt on phone waiting for a debugger to be attached&#13;&#10;" width="871" height="348"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.18 – Prompt on phone waiting for a debugger to be attached</p>
			<p>In fact, we need this in our little example because the <strong class="source-inline">Update</strong> function in <strong class="source-inline">MyScript</strong> will likely be called before I get a chance to attach the debugger.  </p>
			<p class="callout-heading">Info: Additional Unity debugging tools</p>
			<p class="callout">Unity provides more windows and tools you can use to debug your projects and gain insight into what is going on under the hood. For troubleshooting Input System actions, see <strong class="bold">Window</strong> | <strong class="bold">Analysis</strong> | <strong class="bold">Input Debugger</strong>. For deep analysis and profiling, there is the <strong class="bold">Profiler</strong>, <strong class="bold">Frame Debugger</strong>, and <strong class="bold">Physics Debugger</strong> also under the <strong class="bold">Window</strong> | <strong class="bold">Analysis</strong> menu. For the UI, there's the <strong class="bold">Immediate Mode GUI</strong> (<strong class="bold">IMGUI</strong>) debugger at <strong class="bold">Window</strong> | <strong class="bold">Analysis</strong> | <strong class="bold">IMGUI Debugger</strong>, and when customizing the Unity Editor user interface, see the <strong class="bold">Window</strong> | <strong class="bold">UI Toolkit</strong> | <strong class="bold">Debugger</strong> (UI Toolkit is expected to be extended for use in your own apps in the future). There's even a <strong class="bold">Window</strong> | <strong class="bold">Render Pipeline</strong> | <strong class="bold">Render Pipeline Debug</strong> window.</p>
			<p>Wouldn't it also be good if you could click <strong class="bold">Play</strong> to run the project on your mobile device without having to <strong class="bold">Build And Run</strong> every time? Let's look at <em class="italic">editor remote tools</em> next. </p>
			<h1 id="_idParaDest-70"><a id="_idTextAnchor072"/>Testing with an editor remote tool</h1>
			<p>Developers <a id="_idIndexMarker287"/>have been using Unity for many years to develop <a id="_idIndexMarker288"/>games and applications for iOS and Android devices. You want the ability to click <strong class="bold">Play</strong> in the Unity Editor and run the current scene remotely on your attached mobile device. Having an iterative <em class="italic">develop-test-update-repeat</em> cycle is key to more efficient and effective development.</p>
			<p>To facilitate this developer workflow, Unity provides an application called <strong class="bold">Unity Remote 5</strong> that <a id="_idIndexMarker289"/>you install on your phone and then connect to the Unity Editor. It is available for both Android (<a href="https://play.google.com/store/apps/details?id=com.unity3d.mobileremote">https://play.google.com/store/apps/details?id=com.unity3d.mobileremote</a>) and iOS (<a href="https://apps.apple.com/us/app/unity-remote-4/id871767552">https://apps.apple.com/us/app/unity-remote-4/id871767552</a>). It allows you to use a mobile device to view and test your project live, inside the Unity Editor, without having to build each time. The device acts as a "remote control" for the scene running in the Editor Play-mode, including screen touch, accelerometer, gyroscope, and webcam input. </p>
			<p>Unfortunately, Remote 5 is not suitable for AR development. A remote tool from Unity compatible with AR Foundation has been long promised and is expected, but as I am writing this, it does not exist. Perhaps it will be available by the time you are reading this as a free core Unity feature, so try searching the Unity Forums (<a href="https://forum.unity.com/?gq=AR%20Foundation%20Editor%20Play%20Mode">https://forum.unity.com/?gq=AR%20Foundation%20Editor%20Play%20Mode</a>). </p>
			<p>As is often the case in large developer communities, at least one talented individual has stepped up and produced a remote tool for AR Foundation, available on the Unity Asset Store. The <em class="italic">AR Foundation Editor Remote</em> tool<a id="_idIndexMarker290"/> by Kyrylo Kuzyk can be found at <a href="https://assetstore.unity.com/packages/tools/utilities/ar-foundation-editor-remote-168773">https://assetstore.unity.com/packages/tools/utilities/ar-foundation-editor-remote-168773</a><span class="hidden">.</span> It is not free and, at the present time, it does not support the new Input System, only the legacy Input Manager.</p>
			<p>If you choose to purchase the <a id="_idIndexMarker291"/>package, you can install it using the Package <a id="_idIndexMarker292"/>Manager as follows:</p>
			<ol>
				<li value="1">Open <strong class="bold">Package Manager</strong> using <strong class="bold">Window</strong> | <strong class="bold">Package Manager</strong>.</li>
				<li>Filter the list for <strong class="bold">My Assets</strong> using the select list at the top left of the window.</li>
				<li>Find the <strong class="bold">AR Foundation Editor Remote</strong> package, click <strong class="bold">Download</strong> (if necessary), then click <strong class="bold">Import</strong>. And then in the <strong class="bold">Import</strong> dialog box, click the <strong class="bold">Import</strong> button.</li>
				<li>The package is installed in the <strong class="source-inline">Plugins/ARFoundationRemoteInstaller/</strong> folder. The installer should run automatically. Note there is a <strong class="source-inline">Documentation</strong> file as well.</li>
			</ol>
			<p>To use the AR Foundation Editor Remote tool, take the following steps as outlined in the documentation:</p>
			<ol>
				<li value="1">Go to <strong class="bold">Edit</strong> | <strong class="bold">Project Settings</strong> | <strong class="bold">XR Plug-in Management</strong> | the <strong class="bold">Desktop</strong> tab.</li>
				<li>Check the <strong class="bold">AR Foundation Remote</strong> checkbox.</li>
				<li>Ensure your project is targeting your mobile device platform in <strong class="bold">File</strong> | <strong class="bold">Build Settings</strong>.</li>
				<li>In the <strong class="bold">Project</strong> window, navigate to <strong class="source-inline">Plugins/ARFoundationRemoteInstaller</strong>, select the <strong class="bold">Installer</strong> asset, and view the <strong class="bold">Inspector</strong> window as shown in the following screenshot:<div id="_idContainer054" class="IMG---Figure"><img src="Images/Figure_3.19-ARRemoteInstaller.jpg" alt="Figure 3.19 – The AR Foundation Remote Installer&#13;&#10;" width="595" height="344"/></div><p class="figure-caption">Figure 3.19 – The AR Foundation Remote Installer</p></li>
				<li>Click the <strong class="bold">Install AR Companion App</strong> button.<p>Let it build and install the companion app on your <a id="_idIndexMarker293"/>device.</p></li>
				<li>In the <strong class="bold">Project</strong> window, navigate <a id="_idIndexMarker294"/>to the <strong class="source-inline">Plugins/ARFoundationRemoteInstaller/Resources/</strong> folder and select the <strong class="bold">Settings</strong> object.</li>
				<li>Following the instructions on your phone screen and enter the given IP address in the <strong class="bold">Settings</strong> | <strong class="bold">AR Companion App IP</strong> field in the <strong class="bold">Inspector</strong> window.</li>
			</ol>
			<p>You're now set up. When you want to use AR Foundation Remote, ensure the AR Companion app is running on your phone. Then, click <strong class="bold">Play</strong> to run your scene using the mobile device as a remote.</p>
			<p>Using an editor remote tool lets you use the Unity Editor Play-mode with your mobile device. Camera and other sensing data is input into your <strong class="bold">Game</strong> window so you can test in your real-world environment without having to use <strong class="bold">Build And Run</strong>. </p>
			<p>What if, instead of playing your app on your mobile device, we inverted this approach by bringing your real-world environment into the Unity Editor? Unity is pioneering this innovative approach with Unity MARS.</p>
			<h1 id="_idParaDest-71"><a id="_idTextAnchor073"/>Simulating with Unity MARS</h1>
			<p><strong class="bold">Unity MARS</strong> (an acronym for <em class="italic">Mixed Augmented Reality Studio</em>) (<a href="https://unity.com/products/unity-mars">https://unity.com/products/unity-mars</a>) is a <a id="_idIndexMarker295"/>product solution from Unity Technologies that solves many of the<a id="_idIndexMarker296"/> issues with developing Augmented Reality applications discussed thus far in this chapter, and much more. </p>
			<p>What is MARS? With MARS you can author and test complex AR applications within the Unity Editor with runtime logic for a range of target physical world environments. </p>
			<p>Consider this one scenario: You are developing an AR <a id="_idIndexMarker297"/>application for museum visitors, where they point their <a id="_idIndexMarker298"/>mobile device at an exhibit or artwork and the app recognizes it and delivers additional information and infotainment, providing a much-enhanced learning experience. But you are at your desk, in your office, across town, or in a different city. How do you develop and test your app? Rather than making travel plans, you could use MARS to bring the target physical space into the Unity Editor and <em class="italic">develop-test-update-repeat</em> from the comfort of your own desk.</p>
			<p>With MARS you can capture and assemble real-world assets such as locations, objects, and props, then drag and drop them into Unity to test them. It supports tracking planes, images, faces, and many other kinds of semantically meaningful data, or <em class="italic">traits</em>. The MARS documentation can be found at <a href="mailto:https://docs.unity3d.com/Packages/com.unity.mars@1.0/manual/index.html">https://docs.unity3d.com/Packages/com.unity.mars@1.0/manual/index.html</a>. </p>
			<p>The first step in this museum scenario may be to capture the museum's physical environment sensor readings for use at your workstation. The MARS Companion app, described more in this section, can serve this purpose. Likewise, MARS includes a collection of sample environment templates you can use out of the box. The following image, for example, shows a <strong class="bold">Simulation View</strong> of a kitchen along with a <strong class="bold">Device View </strong>in the same space:</p>
			<div>
				<div id="_idContainer055" class="IMG---Figure">
					<img src="Images/Figure_3.20-MARSscreenshot.jpg" alt="Figure 3.20 – MARS Simulation and Device views&#13;&#10;" width="1650" height="625"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.20 – MARS Simulation and Device views</p>
			<p>With MARS you <a id="_idIndexMarker299"/>have environment simulations that can run either in Edit-mode or Play-mode. You can preview the execution of a scene in Edit-mode, where proxy objects <a id="_idIndexMarker300"/>of the real world are copied into the <strong class="bold">Simulation</strong> scene view, which is separate from the normal project <strong class="bold">Scene</strong> view. You can also start and stop a <em class="italic">continuous</em> <strong class="bold">Simulation</strong> view that is more analogous to the normal Play-mode in Unity. The data fed into the simulation can be synthetic, recorded, or live data. You can then test your project against a wide variety of indoor and outdoor spaces. For a more complete explanation of how MARS simulation works, I recommend this article: <a href="https://blogs.unity3d.com/2020/08/14/a-look-at-how-simulation-works-in-unity-mars">https://blogs.unity3d.com/2020/08/14/a-look-at-how-simulation-works-in-unity-mars</a>. </p>
			<p>MARS provides additional high-level tools and intelligent components that address common challenges for AR developers. Physical environments are not always so predictable. The MARS procedural authoring framework simulates real-world objects, conditions, and actions including "fuzzy authoring" where you specify minimum and maximum measurements for physical features when the app is deciding where and when to let the user interact. </p>
			<p>MARS is built on AR Foundation, so it works with all supported AR devices and platforms. Presently, there is a separate annual license fee to use Unity MARS after a trial period. </p>
			<p>Using MARS you may still be faced with how to capture your target environment geometry and surface feature for use in simulations. That's where the MARS Companion app comes in.</p>
			<h2 id="_idParaDest-72"><a id="_idTextAnchor074"/>Capturing with the MARS Companion app</h2>
			<p>The MARS Companion app can be used to capture real-world data and bring it into the Unity Editor for use with Unity MARS. </p>
			<p>Using the app, you <a id="_idIndexMarker301"/>can scan a room, take pictures, and record video, capturing and saving this data to the cloud. This data can then be made available to the Unity Editor using the MARS authoring studio. </p>
			<p>The app also has limited authoring features that let you create content and layout assets on your device. This could be useful, for example, troubleshooting edge cases where lighting or environment features are ambiguous or difficult to scan. </p>
			<p>At this time, the <a id="_idIndexMarker302"/>MARS Companion app is still in Beta (<a href="https://forum.unity.com/threads/unity-mars-companion-app-open-beta-announcement.1037638/">https://forum.unity.com/threads/unity-mars-companion-app-open-beta-announcement.1037638/</a>) and may eventually be decoupled from MARS for use as an editor remote tool (see the previous section in this chapter). </p>
			<p>Unity MARS is a powerful new framework for augmented reality development. It represents Unity's long-term commitment to the AR industry, users, developers, and device manufacturers. Like most Unity packages and modules, it can also be extended with custom behaviors, data extensions, queries, and other add-on modules. </p>
			<p>I have not attempted to provide a tutorial for MARS in this chapter (it could be a whole separate book), and <em class="italic">we will not be using MARS in the projects in this book</em>. Nonetheless, you are more than welcome to improve your workflow using MARS with the projects in this book if you want. </p>
			<h1 id="_idParaDest-73"><a id="_idTextAnchor075"/>Summary</h1>
			<p>By its nature, augmented reality mixes the physical and virtual worlds, and that presents unique challenges to AR developers. We develop on a desktop or laptop computer, but the target device for the application is an untethered mobile device. While running an app in Unity Play-mode, an AR scene still needs sensor inputs from the remote device. </p>
			<p>In this chapter, we covered a spectrum of tools and techniques that can help with developing and troubleshooting your augmented reality applications using Unity. We started with a basic, classic "print statement," using <strong class="source-inline">Debug.Log()</strong> where you can output log messages to the <strong class="bold">Console</strong> window for insight into what is happening in your code. Initially, you might use this just in Play-mode, but we saw how you can build and run your project, and still attach it to the Unity <strong class="bold">Console</strong> window to monitor log messages with the app running on your mobile device. Then we built a virtual console window and wrote a <strong class="source-inline">ScreenLog.Log()</strong> wrapper function to optionally let you view log messages on your device without being tethered to Unity at all.</p>
			<p>For deeper understanding and to debug your applications, you can use a debugger like the one provided in Visual Studio. While debugging, you can set breakpoints, examine variable values, and step through the code. You can run the debugger both on Unity Play-mode and on applications built and running on your mobile device. </p>
			<p>You could also use an editor remote tool—an app that runs on the mobile device and connects to the Unity Editor so you can use the Play-mode and receive input data from the attached device.</p>
			<p>Then we took a brief tour of Unity MARS. This AR development studio framework inverts the ordinary remote development paradigm. Rather than running your app on a remote device to capture environment sensor data, MARS lets you use environment sensor simulations directly in the Unity Editor. This provides the opportunity to greatly improve your development workflow and test your application for a wide range of physical environments without leaving your desk.</p>
			<p>You are now ready to get started building AR applications. In the next chapter, we develop a framework for controlling user interaction in AR projects. This framework will be saved and used as a template for building and managing the user interfaces in each of the projects in this book.</p>
		</div>
	</div></body></html>