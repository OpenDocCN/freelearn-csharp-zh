<html><head></head><body>
		<div><h1 id="_idParaDest-122"><a id="_idTextAnchor122"/>Chapter 10: Publishing Projects</h1>
			<p>After finishing a <strong class="bold">proof of concept</strong> (<strong class="bold">POC</strong>) or a <strong class="bold">minimum viable product</strong> (<strong class="bold">MVP</strong>), (which means a demo or pilot project with the main functionalities implemented, as discussed in <a href="B17873_08_ePub.xhtml#_idTextAnchor100"><em class="italic">Chapter 8</em></a>, <em class="italic">Web Tools and Hot Reload</em>), we need to deploy our changes to see how the project works in a real scenario and share the published project with our customers. Visual Studio has a set of tools to deploy our projects. We can choose an option to deploy the project in our local environment, but we can also use services in the cloud.</p>
			<p>In this chapter, you will learn how to deploy your project with just a few clicks and Visual Studio 2022. These tools will help you to save time and reduce complexity when you need to deploy. </p>
			<p>We will discuss and review the following topics, which are the options to publish projects with Visual Studio 2022:</p>
			<ul>
				<li>The options to publish a project</li>
				<li>Publishing in a folder </li>
				<li>Publishing in <strong class="bold">internet information services</strong> (<strong class="bold">IIS</strong>)</li>
				<li>Publishing in Microsoft Azure</li>
			</ul>
			<p>Let's dive in and learn all about publishing projects.</p>
			<h1 id="_idParaDest-123"><a id="_idTextAnchor123"/>Technical requirements</h1>
			<p>To publish a project following the steps provided in this chapter, you must have previously installed Visual Studio 2022 with the web development workload, as shown in <a href="B17873_01_ePub.xhtml#_idTextAnchor013"><em class="italic">Chapter 1</em></a>, <em class="italic">Getting Started with Visual Studio 2022</em>. It's important to have the SPA base project that you created in <a href="B17873_04_ePub.xhtml#_idTextAnchor052"><em class="italic">Chapter 4</em></a>, <em class="italic">Creating Projects and Templates</em>.</p>
			<p>For the <em class="italic">Publishing in Microsoft Azure</em> section, you will need to have an Azure account with credits to complete the deployment.</p>
			<p>You can check out the changes made to the project at the following link: <a href="https://github.com/PacktPublishing/Hands-On-Visual-Studio-2022/tree/main/Chapter10">https://github.com/PacktPublishing/Hands-On-Visual-Studio-2022/tree/main/Chapter10</a>.</p>
			<h1 id="_idParaDest-124"><a id="_idTextAnchor124"/>The options to publish a project </h1>
			<p>Visual Studio <a id="_idIndexMarker409"/>has two ways to access the <strong class="bold">Publish</strong> option and then display the possibilities incorporated to deploy a project. </p>
			<p>In the menu, we can access this option by navigating to <strong class="bold">Build</strong> | <strong class="bold">Publish [Project name]</strong>. By default, the main project in the current solution is selected, as shown here:</p>
			<div><div><img src="img/Figure_10.01_B17873.jpg" alt="Figure 10.1 – The Publish SPAProject option in the Build menu&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 10.1 – The Publish SPAProject option in the Build menu</p>
			<p>Another possibility is to right-click on the project that we want to publish in the <strong class="bold">Solution Explorer</strong> tab (see <em class="italic">Figure 10.2</em>):</p>
			<div><div><img src="img/Figure_10.02_B17873.jpg" alt="Figure 10.2 – The Publish… option on the menu after right-clicking&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 10.2 – The Publish… option on the menu after right-clicking</p>
			<p>Whatever the <a id="_idIndexMarker410"/>chosen option, Visual Studio will display a modal window to give you the deployment types supported for the main project in the solution or the project selected, as illustrated in the following screenshot:</p>
			<div><div><img src="img/Figure_10.03_B17873.jpg" alt="Figure 10.3 – The options to publish a project in Visual Studio&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 10.3 – The options to publish a project in Visual Studio</p>
			<p>Let's review <a id="_idIndexMarker411"/>these options one by one:</p>
			<ul>
				<li><strong class="bold">Azure</strong>: The project will be deployed in Azure using a service, depending on the technology used.</li>
				<li><strong class="bold">Docker Container Registry</strong>: This option helps us publish a Docker container, including our website.</li>
				<li><strong class="bold">Folder</strong>: This option publishes the project in a folder chosen in the filesystem.</li>
				<li><strong class="bold">FTP/FTPS Server</strong>: With this option, the files of the publication will be transferred to an FTP server.</li>
				<li><strong class="bold">Web Server (IIS)</strong>: Deploys the project in IIS, the default server in Windows.</li>
				<li><strong class="bold">Import Profile</strong>: Allows us to import another configuration to publish a project already created.</li>
			</ul>
			<p>We will review some of these options in the following sections. We will convert the project with the <strong class="bold">Azure</strong>, <strong class="bold">Folder</strong>, and <strong class="bold">Web Server (IIS)</strong> options because <strong class="bold">Docker Container Registry</strong> is a little more complex to set up, and for FTP/FTPS server, we need to have an FTP server running, which is not very common in modern solutions.</p>
			<p>At this point, you know <a id="_idIndexMarker412"/>how to access the <strong class="bold">Publish</strong> option that Visual Studio contains to deploy a web application. Let's now explore a few preferred options to publish a project in Visual Studio.</p>
			<h1 id="_idParaDest-125"><a id="_idTextAnchor125"/>Publishing in a folder</h1>
			<p>One of the most <a id="_idIndexMarker413"/>common options for publishing a project is to use our filesystem and save the site in a folder, including all the resources to use it in a local server, such as IIS, Apache, or NGINX. Visual Studio has an option to publish our projects with this approach easily.</p>
			<p>You can use any option to navigate to the publishing functionality, which we reviewed in the <em class="italic">The options to publish a project</em> section, and then select <strong class="bold">Folder</strong>, followed by a click on <strong class="bold">Next</strong>:</p>
			<div><div><img src="img/Figure_10.04_B17873.jpg" alt="Figure 10.4 – The Folder option to publish a project&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 10.4 – The Folder option to publish a project</p>
			<p>In the next window, we can <a id="_idIndexMarker414"/>specify the folder where we want to save the published project using the <strong class="bold">Browse…</strong> option. We can use absolute and relative paths. Then, we can finish the configuration by clicking on <strong class="bold">Finish</strong>:</p>
			<div><div><img src="img/Figure_10.05_B17873.jpg" alt="Figure 10.5 – The folder location to publish the project&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 10.5 – The folder location to publish the project</p>
			<p class="callout-heading">Important Note</p>
			<p class="callout">The folder selected must be empty. If you select a folder that contains files, this could create conflicts in the files. Visual Studio will try to replace the files with the same name using the files generated in the publishing process.</p>
			<p>After completing <a id="_idIndexMarker415"/>the publishing configuration, Visual Studio will generate a file with the <code>.pubxml</code> extension that contains the options we chose before in XML format. Now, we can use the <strong class="bold">Publish</strong> button to publish the project in the selected folder:</p>
			<div><div><img src="img/Figure_10.06_B17873.jpg" alt="Figure 10.6 – The .pubxml file created with the configuration&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 10.6 – The .pubxml file created with the configuration</p>
			<p>After clicking <a id="_idIndexMarker416"/>on <strong class="bold">Publish</strong>, Visual Studio will show a <strong class="bold">Publishing to Folder…</strong> message and a console log, where you can check all the steps performed during this process. In <em class="italic">Figure 10.7</em>, you can see the log in the <strong class="bold">Output</strong> panel:</p>
			<div><div><img src="img/Figure_10.7_B17873.jpg" alt="Figure 10.7 – Publishing in progress after clicking on Publish&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 10.7 – Publishing in progress after clicking on Publish</p>
			<p>Finally, after waiting for some seconds, we will see a <strong class="bold">Publish succeeded</strong> confirmation message, which means the process was completed with no issues (see <em class="italic">Figure 10.8</em>):</p>
			<div><div><img src="img/Figure_10.08_B17873.jpg" alt="Figure 10.8 – The publish success message and the publish folder&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 10.8 – The publish success message and the publish folder</p>
			<p>In <em class="italic">Figure 10.8</em>, we can <a id="_idIndexMarker417"/>see that the folder on the right side contains all the files associated with the publication of our projects. </p>
			<p>We have some additional settings that we can change using the pencil icon:</p>
			<div><div><img src="img/Figure_10.09_B17873.jpg" alt="Figure 10.9 – The option to delete an existing file in the target location&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 10.9 – The option to delete an existing file in the target location</p>
			<p>After <a id="_idIndexMarker418"/>clicking the <strong class="bold">Delete existing files</strong> option, we will see some additional settings that we can change according to our needs (see <em class="italic">Figure 10.10</em>):</p>
			<div><div><img src="img/Figure_10.10_B17873.jpg" alt="Figure 10.10 – Additional settings to publish a project&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 10.10 – Additional settings to publish a project</p>
			<p>Let's review <a id="_idIndexMarker419"/>all the options in <em class="italic">Figure 10.10</em>:</p>
			<ul>
				<li><strong class="bold">Configuration</strong>: We can choose between <strong class="bold">Debug</strong> and <strong class="bold">Release</strong>. The latter is optimized for production. </li>
				<li><strong class="bold">Target Framework</strong>: Normally, it's the same version used in the project, but we can select a specific version to run our project.</li>
				<li><strong class="bold">Deployment Mode</strong>: We can select <strong class="bold">Framework-dependent</strong>, which means the framework should be installed on the server, or <strong class="bold">Self-contained</strong>, which means the publication will include the framework and all the dependencies to run the project. </li>
				<li><strong class="bold">Target Runtime</strong>: This is the system architecture and operating system where the application will be published.</li>
				<li><strong class="bold">Delete all existing files prior to publish</strong>: This allows Visual Studio to delete all the existing files in the folder selected for publishing the project.<p class="callout-heading">Important Note</p><p class="callout">It's best practice to check the <strong class="bold">Delete all existing files prior to publish</strong> option to avoid conflict with existing files during the publishing process. </p></li>
			</ul>
			<p>You now know <a id="_idIndexMarker420"/>how to publish in a folder in Visual Studio. You only need to select the folder where you prefer to deploy your application and then use the publish option. </p>
			<h1 id="_idParaDest-126"><a id="_idTextAnchor126"/>Publishing in IIS</h1>
			<p>IIS is the most <a id="_idIndexMarker421"/>popular server in the Windows ecosystem. It is included by default in all Windows Server versions, and there is an option to install it on Windows.</p>
			<p>To install IIS in Windows 8, 10, 11, or later, you can follow this guide in the <em class="italic">Step 1 – Install IIS and ASP.NET</em> section of the Microsoft document:</p>
			<p><a href="https://docs.microsoft.com/windows/msix/app-installer/web-install-iis">https://docs.microsoft.com/windows/msix/app-installer/web-install-iis</a></p>
			<p>You can easily deploy a web application in IIS using Visual Studio. First, you need to open the <strong class="bold">Publish</strong> option that we reviewed in the <em class="italic">The options to publish a project</em> section and select <strong class="bold">Web Server (IIS)</strong> (see <em class="italic">Figure 10.11</em>):</p>
			<div><div><img src="img/Figure_10.11_B17873.jpg" alt="Figure 10.11 – The Web server (IIS) option to publish a project&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 10.11 – The Web server (IIS) option to publish a project</p>
			<p class="callout-heading">Important Note</p>
			<p class="callout">If you already <a id="_idIndexMarker422"/>have a <code>.pubxml</code> file in the publishing profiles folder, you need to delete it to create a new one with a new configuration.</p>
			<p>After selecting <strong class="bold">Web Server (IIS)</strong>, you can click on <strong class="bold">Next</strong> and continue with the process. You will see two options to choose from (see <em class="italic">Figure 10.12</em>):</p>
			<div><div><img src="img/Figure_10.12_B17873.jpg" alt="Figure 10.12 – The options to deploy in IIS – Web Deploy and Web Deploy Package&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 10.12 – The options to deploy in IIS – Web Deploy and Web Deploy Package</p>
			<p>We have <a id="_idIndexMarker423"/>two options for deploying in IIS:</p>
			<ul>
				<li><strong class="bold">Web Deploy</strong>: Deploy <a id="_idIndexMarker424"/>the folder, including all the files, in IIS.</li>
				<li><code>.zip</code> file, including <a id="_idIndexMarker425"/>all the files within the publishing folder.</li>
			</ul>
			<p>In this case, we will select <strong class="bold">Web Deploy</strong> and click on <strong class="bold">Next</strong>. </p>
			<p>You need to fill in the <strong class="bold">Server</strong>, <strong class="bold">Site name</strong>, and <strong class="bold">Destination URL</strong> fields (see <em class="italic">Figure 10.13</em>):</p>
			<div><div><img src="img/Figure_10.13_B17873.jpg" alt="Figure 10.13 – The configuration to publish on a default web site in IIS&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 10.13 – The configuration to publish on a default web site in IIS</p>
			<p>We will use <a id="_idIndexMarker426"/>the default website created in IIS. If you are already using this site with another application, you can set up another site name in IIS. </p>
			<p>Using the <strong class="bold">Validate Connection</strong> button, you can check whether Visual Studio can create the site and complete the publication using the setup provided. You can use the <strong class="bold">Finish</strong> button to complete the setup.</p>
			<p class="callout-heading">Important Note</p>
			<p class="callout">You need to execute Visual Studio as admin to give access to IIS; otherwise, you will receive an error. </p>
			<p>After completing all the steps, you will get a <strong class="bold">Ready to publish</strong> message and some options to edit the configuration. We are ready to use the <strong class="bold">Publish</strong> button:</p>
			<div><div><img src="img/Figure_10.14_B17873.jpg" alt="Figure 10.14 – The project ready to publish using IIS&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 10.14 – The project ready to publish using IIS</p>
			<p>Automatically, Visual Studio will open in a new window in the browser, with the URL of the site that <a id="_idIndexMarker427"/>we set up in the configuration (see <em class="italic">Figure 10.13</em>) in the <code>http://localhost</code>:</p>
			<div><div><img src="img/Figure_10.15_B17873.jpg" alt="Figure 10.15 – The project running in IIS after publishing it&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 10.15 – The project running in IIS after publishing it</p>
			<p>You just learned <a id="_idIndexMarker428"/>how to deploy a web application in IIS using Visual Studio. Visual Studio minimizes the steps to complete the setup and sets all the files in a folder inside IIS. Now, let's review another way to deploy an application using Azure.</p>
			<h1 id="_idParaDest-127"><a id="_idTextAnchor127"/>Publishing in Microsoft Azure</h1>
			<p><strong class="bold">Azure</strong> is a cloud <a id="_idIndexMarker429"/>provider created by Microsoft, and it's one of the most popular <a id="_idIndexMarker430"/>among start-ups and .NET developers. Since Azure and Visual Studio are supported by the same company and community, there is good integration between the technologies.</p>
			<p>To deploy our SPAProject in Azure, we need to select a publish option using the method we reviewed in the <em class="italic">The options to publish a project</em> section, select <strong class="bold">Azure</strong>, and then on the next screen, select <strong class="bold">Azure App Service (Windows)</strong>:</p>
			<div><div><img src="img/Figure_10.16_B17873.jpg" alt="Figure 10.16 – The possibilities to publish in Azure&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 10.16 – The possibilities to publish in Azure</p>
			<p>Remember <a id="_idIndexMarker431"/>to delete any <code>.pubxml</code> file in the project to create a new configuration. </p>
			<p class="callout-heading">Important Note</p>
			<p class="callout">To complete the steps in this section and publish the SPAProject in Azure, you will need an Azure account with credits. </p>
			<p>Visual Studio provides some options to deploy in Azure. Let's review them:</p>
			<ul>
				<li><strong class="bold">Azure App Service (Windows)</strong>: Publish <a id="_idIndexMarker432"/>the project in a <strong class="bold">platform as a service</strong> (<strong class="bold">PaaS</strong>) container <a id="_idIndexMarker433"/>using Windows as the operating system.</li>
				<li><strong class="bold">Azure App Service (Linux)</strong>: Publish <a id="_idIndexMarker434"/>the project in a PaaS container using Linux as the operating system.</li>
				<li><strong class="bold">Azure App Service Container</strong>: Run <a id="_idIndexMarker435"/>up a container in an Azure App using an Azure App Service container.</li>
				<li><strong class="bold">Azure Container Registry</strong>: Publish <a id="_idIndexMarker436"/>the application as a Docker image.</li>
				<li><strong class="bold">Azure Virtual Machine</strong>: Publish <a id="_idIndexMarker437"/>a folder in a virtual machine and then manually use IIS to run the app.</li>
			</ul>
			<p>After clicking on <strong class="bold">Next</strong>, you will get a new window to perform authentication in Azure and connect <a id="_idIndexMarker438"/>with the services and resources in Azure for your account:</p>
			<div><div><img src="img/Figure_10.17_B17873.jpg" alt="Figure 10.17 – The Azure account sign-in&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 10.17 – The Azure account sign-in</p>
			<p>In <em class="italic">Figure 10.17</em>, we see a <a id="_idIndexMarker439"/>new window, where we need to authenticate with Azure using the <strong class="bold">Sign In…</strong> button to continue with the setup and integrate Visual Studio with the resources in our Azure account. After performing the authentication, we can select the subscription and create a new web app instance using the green cross button (see <em class="italic">Figure 10.18</em>):</p>
			<div><div><img src="img/Figure_10.18_B17873.jpg" alt="Figure 10.18 – The option to select a subscription and create a new app service&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 10.18 – The option to select a subscription and create a new app service</p>
			<p>We need <a id="_idIndexMarker440"/>to select a hosting plan for our SPAProject: </p>
			<div><div><img src="img/Figure_10.19_B17873.jpg" alt="Figure 10.19 – The hosting plan for a new app service&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 10.19 – The hosting plan for a new app service</p>
			<p>In this case, we can use a free plan in Azure with limited time to run our web app. It's perfect <a id="_idIndexMarker441"/>for performing demos and trying this publishing functionality.</p>
			<p class="callout-heading">Important Note</p>
			<p class="callout">To analyze and compare other plans in Azure, you can navigate to the following link: <a href="https://azure.microsoft.com/pricing/details/app-service/windows/">https://azure.microsoft.com/pricing/details/app-service/windows/</a>.</p>
			<p>After creating the hosting plan, we can finish the configuration by choosing a name and resource group for our project (see <em class="italic">Figure 10.20</em>):</p>
			<div><div><img src="img/Figure_10.20_B17873.jpg" alt="Figure 10.20 – The app service configuration for our SAPProject&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 10.20 – The app service configuration for our SAPProject</p>
			<p>In <em class="italic">Figure 10.21</em>, we can see <a id="_idIndexMarker442"/>a preview of the project created, and we can complete using the <strong class="bold">Finish</strong> button:</p>
			<div><div><img src="img/Figure_10.21_B17873.jpg" alt="Figure 10.21 – The web app for the created SPAProject&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 10.21 – The web app for the created SPAProject</p>
			<p>Finally, in the <a id="_idIndexMarker443"/>last step, we have two options to complete the integration with Azure (see <em class="italic">Figure 10.22</em>):</p>
			<div><div><img src="img/Figure_10.22_B17873.jpg" alt="Figure 10.22 – The deployment options in Azure&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 10.22 – The deployment options in Azure</p>
			<p>Let's review <a id="_idIndexMarker444"/>these options to choose:</p>
			<ul>
				<li><code>.pubxml</code> file with the configuration. We need to publish the project manually using the <strong class="bold">Publish </strong>button.</li>
				<li><code>.yml</code> file <a id="_idIndexMarker446"/>that contains <strong class="bold">continuous integration</strong> (<strong class="bold">CI</strong>) and <strong class="bold">continuous deployment</strong> (<strong class="bold">CD</strong>) configurations to deploy the project after every change in code.</li>
			</ul>
			<p>For this example, we will choose <strong class="bold">Publish (generates pubxml file)</strong> and click on <strong class="bold">Finish</strong> to complete the setup. </p>
			<p>As with <em class="italic">Figure 10.14,</em> we will see the <code>.pubxml</code> file created and the <strong class="bold">Publish</strong> button. Click on <strong class="bold">Publish</strong> to publish our project in Azure. After publishing the project, Visual Studio will open the site using the URL from Azure: </p>
			<div><div><img src="img/Figure_10.23_B17873.jpg" alt="Figure 10.23 – The SPAProject running using an app service in Azure&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 10.23 – The SPAProject running using an app service in Azure</p>
			<p>In <em class="italic">Figure 10.23</em>, we can see a new tab opened by Visual Studio that shows the URL of our project in Azure. This URL has the name of the project followed by the <code>azurewebsites.net</code> domain.</p>
			<p>You now know <a id="_idIndexMarker447"/>how to publish a project in Azure using only the UI in Visual Studio and some clicks. To see more details about the integration between Visual Studio and Azure, check out this link: <a href="https://docs.microsoft.com/aspnet/core/tutorials/publish-to-azure-webapp-using-vs">https://docs.microsoft.com/aspnet/core/tutorials/publish-to-azure-webapp-using-vs</a>.</p>
			<p>After reviewing the main options to deploy an application using Visual Studio, we conclude this chapter.</p>
			<h1 id="_idParaDest-128"><a id="_idTextAnchor128"/>Summary</h1>
			<p>After reading this chapter, you know how to navigate in Visual Studio to access the <code>.pubxml</code> file.</p>
			<p>In <a href="B17873_11_ePub.xhtml#_idTextAnchor130"><em class="italic">Chapter 11</em></a>, <em class="italic">Implementing Git Integration</em>, we will review all the tools included in Visual Studio to connect with Git repositories and GitHub in particular. You will learn how to see the status of your changes using a visual interface and publish your project in a public or private repository easily.</p>
		</div>
	</body></html>