<html><head></head><body>
<div id="_idContainer010">
<h1 class="chapter-number" id="_idParaDest-16"><a id="_idTextAnchor015"/><span class="koboSpan" id="kobo.1.1">1</span></h1>
<h1 id="_idParaDest-17"><a id="_idTextAnchor016"/><span class="koboSpan" id="kobo.2.1">Technical Debt, Code Smells, and Refactoring</span></h1>
<p><span class="koboSpan" id="kobo.3.1">New software projects start out clean and optimistic, but quickly grow in complexity and difficulty to maintain until the code is difficult to understand, brittle to change, and impossible </span><span class="No-Break"><span class="koboSpan" id="kobo.4.1">to test.</span></span></p>
<p><span class="koboSpan" id="kobo.5.1">If you’ve worked with code for any length of time, chances are you’ve come across code like this. </span><span class="koboSpan" id="kobo.5.2">In fact, if you’ve been in development for even a little bit of time, it’s likely you’ve </span><em class="italic"><span class="koboSpan" id="kobo.6.1">written</span></em><span class="koboSpan" id="kobo.7.1"> code you </span><span class="No-Break"><span class="koboSpan" id="kobo.8.1">now regret.</span></span></p>
<p><span class="koboSpan" id="kobo.9.1">It could be that the code is hard to read or understand. </span><span class="koboSpan" id="kobo.9.2">Maybe the code is inefficient or prone to errors. </span><span class="koboSpan" id="kobo.9.3">Perhaps the code was built under a certain set of business assumptions that later changed. </span><span class="koboSpan" id="kobo.9.4">Maybe the code simply no longer conforms to the standards you and your team have agreed to. </span><span class="koboSpan" id="kobo.9.5">Whatever the reason, bad code feels like it is practically everywhere in codebases of any significant size </span><span class="No-Break"><span class="koboSpan" id="kobo.10.1">or age.</span></span></p>
<p><span class="koboSpan" id="kobo.11.1">This code litters our software projects and reduces our development speed, causes us to introduce bugs, and generally makes us less happy and productive as </span><span class="No-Break"><span class="koboSpan" id="kobo.12.1">software engineers.</span></span></p>
<p><span class="koboSpan" id="kobo.13.1">In this book, we’ll talk about how technical debt arises and what we can do about it through the process of refactoring, guided by tests and </span><span class="No-Break"><span class="koboSpan" id="kobo.14.1">code analysis.</span></span></p>
<p><span class="koboSpan" id="kobo.15.1">In this chapter, we’re going to cover the following </span><span class="No-Break"><span class="koboSpan" id="kobo.16.1">main topics:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.17.1">Understanding technical debt and </span><span class="No-Break"><span class="koboSpan" id="kobo.18.1">legacy code</span></span></li>
<li><span class="koboSpan" id="kobo.19.1">Identifying </span><span class="No-Break"><span class="koboSpan" id="kobo.20.1">code smells</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.21.1">Introducing refactoring</span></span></li>
</ul>
<h1 id="_idParaDest-18"><a id="_idTextAnchor017"/><span class="koboSpan" id="kobo.22.1">Understanding technical debt and legacy code</span></h1>
<p><span class="koboSpan" id="kobo.23.1">While computer science education, books, tutorials, and online courses all focus on creating new projects from scratch, the reality is that almost all development jobs you’ll have will center around understanding, maintaining, and expanding pre-existing code that may not meet your </span><span class="No-Break"><span class="koboSpan" id="kobo.24.1">current standards.</span></span></p>
<p><span class="koboSpan" id="kobo.25.1">This pre-existing code is referred to as </span><strong class="bold"><span class="koboSpan" id="kobo.26.1">legacy code</span></strong><span class="koboSpan" id="kobo.27.1">. </span><span class="koboSpan" id="kobo.27.2">You almost always inherit some amount of legacy code when joining a new </span><a id="_idIndexMarker000"/><span class="koboSpan" id="kobo.28.1">project. </span><span class="koboSpan" id="kobo.28.2">This can be a large amount of code for pre-existing projects or a smaller set of libraries your code must </span><span class="No-Break"><span class="koboSpan" id="kobo.29.1">work with.</span></span></p>
<p><span class="koboSpan" id="kobo.30.1">There are many different definitions of the term </span><em class="italic"><span class="koboSpan" id="kobo.31.1">legacy code</span></em><span class="koboSpan" id="kobo.32.1">. </span><span class="koboSpan" id="kobo.32.2">One that stands out to me from my readings is Michael C. </span><span class="koboSpan" id="kobo.32.3">Feather’s definition, in </span><em class="italic"><span class="koboSpan" id="kobo.33.1">Working Effectively with Legacy Code</span></em><span class="koboSpan" id="kobo.34.1">, that legacy code is </span><em class="italic"><span class="koboSpan" id="kobo.35.1">code </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.36.1">without tests</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.37.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.38.1">While I like Michael’s definition and believe testing is critically important, as we’ll see in </span><em class="italic"><span class="koboSpan" id="kobo.39.1">Part 2</span></em><span class="koboSpan" id="kobo.40.1"> of this book, I personally define legacy code </span><span class="No-Break"><span class="koboSpan" id="kobo.41.1">as follows:</span></span></p>
<p><em class="italic"><span class="koboSpan" id="kobo.42.1">Legacy code refers to any pre-existing code that would be implemented significantly differently were it </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.43.1">rewritten today.</span></em></span></p>
<p><span class="koboSpan" id="kobo.44.1">One key factor in legacy code is that it is </span><em class="italic"><span class="koboSpan" id="kobo.45.1">code you don’t currently fully understand</span></em><span class="koboSpan" id="kobo.46.1"> and as a result, its presence causes some degree of anxiety </span><span class="No-Break"><span class="koboSpan" id="kobo.47.1">and apprehension.</span></span></p>
<p><span class="koboSpan" id="kobo.48.1">This anxiety you feel when</span><a id="_idIndexMarker001"/><span class="koboSpan" id="kobo.49.1"> maintaining old systems is a prime symptom of something called </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.50.1">technical debt</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.51.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.52.1">Simply put, technical debt is </span><em class="italic"><span class="koboSpan" id="kobo.53.1">the negative effect of legacy code on future </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.54.1">development efforts</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.55.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.56.1">In other words, legacy code has a certain amount of inherent </span><em class="italic"><span class="koboSpan" id="kobo.57.1">risk</span></em><span class="koboSpan" id="kobo.58.1"> that bad things will happen when the code is modified. </span><span class="koboSpan" id="kobo.58.2">These bad things could be bugs that are introduced due to the brittleness of the pre-existing code (or our lack of understanding of it), slower development speed, or even catastrophic issues such as critical bugs or security breaches from out-of-date security practices or </span><span class="No-Break"><span class="koboSpan" id="kobo.59.1">deprecated dependencies.</span></span></p>
<p><span class="koboSpan" id="kobo.60.1">What’s worse is that technical debt will only grow over time – particularly if </span><span class="No-Break"><span class="koboSpan" id="kobo.61.1">left unchecked.</span></span></p>
<h2 id="_idParaDest-19"><a id="_idTextAnchor018"/><span class="koboSpan" id="kobo.62.1">Where technical debt comes from</span></h2>
<p><span class="koboSpan" id="kobo.63.1">Before we</span><a id="_idIndexMarker002"/><span class="koboSpan" id="kobo.64.1"> move on, I want to address a common point of confusion I see in organizations: technical debt is not the same thing as </span><span class="No-Break"><span class="koboSpan" id="kobo.65.1">bad code.</span></span></p>
<p><span class="koboSpan" id="kobo.66.1">Certainly, some of the technical debt we have in our systems may be simply poor-quality code. </span><span class="koboSpan" id="kobo.66.2">It could be that an inexperienced developer wrote it and didn’t properly benefit from code review by other developers. </span><span class="koboSpan" id="kobo.66.3">Sometimes, projects are in a rush and the team didn’t have time to write the code properly to begin with, and never got to go back and clean </span><span class="No-Break"><span class="koboSpan" id="kobo.67.1">it up.</span></span></p>
<p><span class="koboSpan" id="kobo.68.1">Sometimes, “quick and dirty” code written for prototypes makes it into production applications when “throwaway prototypes” get hastily promoted to actual production applications, as we’ll explore in </span><a href="B21324_15.xhtml#_idTextAnchor316"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.69.1">Chapter 15</span></em></span></a><em class="italic"><span class="koboSpan" id="kobo.70.1">: Communicating </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.71.1">Technical Debt</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.72.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.73.1">Of course, there are other causes of technical debt </span><span class="No-Break"><span class="koboSpan" id="kobo.74.1">as well.</span></span></p>
<p><span class="koboSpan" id="kobo.75.1">Sometimes, the development team is under the impression that they are building software to accomplish a specific task and then that task changes as business needs evolve and new information is discovered. </span><span class="koboSpan" id="kobo.75.2">In these cases, teams often don’t start over with the code they were writing. </span><span class="koboSpan" id="kobo.75.3">They simply evolve the old code to suit the new task at hand. </span><span class="koboSpan" id="kobo.75.4">The result is code that works but isn’t ideally suited for the </span><span class="No-Break"><span class="koboSpan" id="kobo.76.1">new task.</span></span></p>
<p><span class="koboSpan" id="kobo.77.1">This change in </span><a id="_idIndexMarker003"/><span class="koboSpan" id="kobo.78.1">requirements is normal and even expected in software development environments. </span><span class="koboSpan" id="kobo.78.2">Modern software development occurs in an agile manner where requirements and plans naturally evolve over time and understanding them up-front is </span><span class="No-Break"><span class="koboSpan" id="kobo.79.1">virtually impossible.</span></span></p>
<p><span class="koboSpan" id="kobo.80.1">Even if development teams understood requirements perfectly and wrote perfect code, this code will eventually become a form of technical debt due to the changing nature of </span><span class="No-Break"><span class="koboSpan" id="kobo.81.1">software engineering.</span></span></p>
<p><span class="koboSpan" id="kobo.82.1">In software development, tools and libraries change over time. </span><span class="koboSpan" id="kobo.82.2">At the time of writing, </span><strong class="bold"><span class="koboSpan" id="kobo.83.1">.NET 8</span></strong><span class="koboSpan" id="kobo.84.1"> and </span><strong class="bold"><span class="koboSpan" id="kobo.85.1">C# 12</span></strong><span class="koboSpan" id="kobo.86.1"> are the</span><a id="_idIndexMarker004"/><span class="koboSpan" id="kobo.87.1"> latest ways to run C# code, but these technologies will go out of support</span><a id="_idIndexMarker005"/><span class="koboSpan" id="kobo.88.1"> at some point in the future only to be replaced by </span><span class="No-Break"><span class="koboSpan" id="kobo.89.1">newer versions.</span></span></p>
<p><span class="koboSpan" id="kobo.90.1">Even entire ways of thinking about software can change. </span><span class="koboSpan" id="kobo.90.2">Over the last twenty years, organizations have </span><a id="_idIndexMarker006"/><span class="koboSpan" id="kobo.91.1">shifted</span><a id="_idIndexMarker007"/><span class="koboSpan" id="kobo.92.1"> from having their own on-premises servers to using cloud hosting on </span><strong class="bold"><span class="koboSpan" id="kobo.93.1">Azure</span></strong><span class="koboSpan" id="kobo.94.1">, </span><strong class="bold"><span class="koboSpan" id="kobo.95.1">AWS</span></strong><span class="koboSpan" id="kobo.96.1">, or </span><strong class="bold"><span class="koboSpan" id="kobo.97.1">Google Cloud</span></strong><span class="koboSpan" id="kobo.98.1">. </span><span class="koboSpan" id="kobo.98.2">Even the very nature of what a server is has changed with</span><a id="_idIndexMarker008"/><span class="koboSpan" id="kobo.99.1"> technologies, including containerization</span><a id="_idIndexMarker009"/><span class="koboSpan" id="kobo.100.1"> technologies such</span><a id="_idIndexMarker010"/><span class="koboSpan" id="kobo.101.1"> as </span><strong class="bold"><span class="koboSpan" id="kobo.102.1">Docker</span></strong><span class="koboSpan" id="kobo.103.1">, </span><strong class="bold"><span class="koboSpan" id="kobo.104.1">platform as a service</span></strong><span class="koboSpan" id="kobo.105.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.106.1">PaaS</span></strong><span class="koboSpan" id="kobo.107.1">) offerings such </span><a id="_idIndexMarker011"/><span class="koboSpan" id="kobo.108.1">as </span><strong class="bold"><span class="koboSpan" id="kobo.109.1">Azure App Services</span></strong><span class="koboSpan" id="kobo.110.1">, and serverless </span><a id="_idIndexMarker012"/><span class="koboSpan" id="kobo.111.1">computing offerings </span><a id="_idIndexMarker013"/><span class="koboSpan" id="kobo.112.1">such as </span><strong class="bold"><span class="koboSpan" id="kobo.113.1">Azure Functions</span></strong><span class="koboSpan" id="kobo.114.1"> and </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.115.1">AWS Lambda</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.116.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.117.1">Nowadays, newer AI technologies</span><a id="_idIndexMarker014"/><span class="koboSpan" id="kobo.118.1"> such as </span><strong class="bold"><span class="koboSpan" id="kobo.119.1">ChatGPT</span></strong><span class="koboSpan" id="kobo.120.1"> and </span><strong class="bold"><span class="koboSpan" id="kobo.121.1">GitHub Copilot Chat</span></strong><span class="koboSpan" id="kobo.122.1"> are </span><a id="_idIndexMarker015"/><span class="koboSpan" id="kobo.123.1">poised to change what it even means to be a software developer, and this only underscores how much constant change is at the heart of the software </span><span class="No-Break"><span class="koboSpan" id="kobo.124.1">engineering industry.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.125.1">Change in software projects</span></p>
<p class="callout"><span class="koboSpan" id="kobo.126.1">In software development, change is a constant and can be unpredictable and sudden. </span><span class="koboSpan" id="kobo.126.2">All this change leads to code that was once considered perfect to later be considered a significant risk to the ongoing success of </span><span class="No-Break"><span class="koboSpan" id="kobo.127.1">the business.</span></span></p>
<p><span class="koboSpan" id="kobo.128.1">In other words, technical debt is</span><a id="_idIndexMarker016"/><span class="koboSpan" id="kobo.129.1"> to some degree or another an unavoidable part of software development. </span><span class="koboSpan" id="kobo.129.2">Thankfully, you can take some steps to reduce the rate at which it accumulates (as we’ll discuss in </span><em class="italic"><span class="koboSpan" id="kobo.130.1">Part 2</span></em><span class="koboSpan" id="kobo.131.1"> of this book). </span><span class="koboSpan" id="kobo.131.2">Fortunately, we can detect technical debt through its symptoms, </span><span class="No-Break"><span class="koboSpan" id="kobo.132.1">or “smells.”</span></span></p>
<h1 id="_idParaDest-20"><a id="_idTextAnchor019"/><span class="koboSpan" id="kobo.133.1">Identifying code smells</span></h1>
<p><span class="koboSpan" id="kobo.134.1">So, how do you know</span><a id="_idIndexMarker017"/><span class="koboSpan" id="kobo.135.1"> whether your code </span><span class="No-Break"><span class="koboSpan" id="kobo.136.1">has issues?</span></span></p>
<p><span class="koboSpan" id="kobo.137.1">How do you know whether food has spoiled, clothing needs to be washed, or a diaper needs changing? </span><span class="koboSpan" id="kobo.137.2">It turns out that it just </span><span class="No-Break"><span class="koboSpan" id="kobo.138.1">smells bad.</span></span></p>
<p><span class="koboSpan" id="kobo.139.1">There are some metrics about what constitutes “good” and “bad” code, and we’ll explore them in </span><a href="B21324_12.xhtml#_idTextAnchor259"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.140.1">Chapter 12</span></em></span></a><em class="italic"><span class="koboSpan" id="kobo.141.1">: Code Analysis in Visual Studio</span></em><span class="koboSpan" id="kobo.142.1"> and </span><a href="B21324_16.xhtml#_idTextAnchor341"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.143.1">Chapter 16</span></em></span></a><em class="italic"><span class="koboSpan" id="kobo.144.1">: Adopting Code Standards</span></em><span class="koboSpan" id="kobo.145.1">. </span><span class="koboSpan" id="kobo.145.2">Smelly code can be subjective to some degree or another. </span><span class="koboSpan" id="kobo.145.3">A developer who wrote a section of code or frequently modifies that portion of code may find the code to be more tolerable than a developer encountering the code for the </span><span class="No-Break"><span class="koboSpan" id="kobo.146.1">first time.</span></span></p>
<p><span class="koboSpan" id="kobo.147.1">While not all pieces of technical debt are identical, it turns out that many pieces of legacy code share a set of </span><span class="No-Break"><span class="koboSpan" id="kobo.148.1">common symptoms.</span></span></p>
<p><span class="koboSpan" id="kobo.149.1">These symptoms are commonly referred to as “code smells” and can include </span><span class="No-Break"><span class="koboSpan" id="kobo.150.1">the following:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.151.1">It’s difficult to understand what it does or </span><em class="italic"><span class="koboSpan" id="kobo.152.1">why</span></em><span class="koboSpan" id="kobo.153.1"> it </span><span class="No-Break"><span class="koboSpan" id="kobo.154.1">does it</span></span></li>
<li><span class="koboSpan" id="kobo.155.1">You or people on your team avoid working </span><span class="No-Break"><span class="koboSpan" id="kobo.156.1">with it</span></span></li>
<li><span class="koboSpan" id="kobo.157.1">It’s slower to modify than other areas or tends to break </span><span class="No-Break"><span class="koboSpan" id="kobo.158.1">when modified</span></span></li>
<li><span class="koboSpan" id="kobo.159.1">It’s hard to test </span><span class="No-Break"><span class="koboSpan" id="kobo.160.1">or debug</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.161.1">New code starts out good and pristine, but real code that lives in a business setting evolves over time as more capabilities are required and additional features and fixes are introduced. </span><span class="koboSpan" id="kobo.161.2">As that happens, code that was once nice and neat starts to accumulate </span><span class="No-Break"><span class="koboSpan" id="kobo.162.1">code smells.</span></span></p>
<p><span class="koboSpan" id="kobo.163.1">Not all code is </span><a id="_idIndexMarker018"/><span class="koboSpan" id="kobo.164.1">created equal, and not all code lasts as long as other pieces of code. </span><span class="koboSpan" id="kobo.164.2">Certainly, there are things we can do to make our code more resilient (as we’ll see in </span><a href="B21324_08.xhtml#_idTextAnchor173"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.165.1">Chapter 8</span></em></span></a><em class="italic"><span class="koboSpan" id="kobo.166.1">: Avoiding Code Anti-Patterns with SOLID</span></em><span class="koboSpan" id="kobo.167.1">). </span><span class="koboSpan" id="kobo.167.2">However, at some point in time, your nice and shiny new code will start to get smelly and will need to be cleaned up through a process </span><span class="No-Break"><span class="koboSpan" id="kobo.168.1">called refactoring.</span></span></p>
<h1 id="_idParaDest-21"><a id="_idTextAnchor020"/><span class="koboSpan" id="kobo.169.1">Introducing refactoring</span></h1>
<p><strong class="bold"><span class="koboSpan" id="kobo.170.1">Refactoring</span></strong><span class="koboSpan" id="kobo.171.1"> is </span><a id="_idIndexMarker019"/><span class="koboSpan" id="kobo.172.1">one of those words that doesn’t make a lot of sense to newer programmers, but here’s a </span><span class="No-Break"><span class="koboSpan" id="kobo.173.1">simple definition:</span></span></p>
<p><em class="italic"><span class="koboSpan" id="kobo.174.1">Refactoring is the act of changing the shape or form of code without changing its functionality </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.175.1">or behavior</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.176.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.177.1">There are two key </span><span class="No-Break"><span class="koboSpan" id="kobo.178.1">concepts here:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.179.1">The first concept is that refactoring is an effort to improve the maintainability of existing code. </span><span class="koboSpan" id="kobo.179.2">Sometimes, restructuring means introducing a new variable, method, or class. </span><span class="koboSpan" id="kobo.179.3">Other times, refactoring simply changes how individual lines of code are arranged or which language features are used. </span><span class="koboSpan" id="kobo.179.4">Even something as simple as renaming a variable could be considered a small act </span><span class="No-Break"><span class="koboSpan" id="kobo.180.1">of refactoring.</span></span></li>
<li><span class="koboSpan" id="kobo.181.1">The second concept in this definition is that refactoring does not alter the </span><em class="italic"><span class="koboSpan" id="kobo.182.1">behavior</span></em><span class="koboSpan" id="kobo.183.1"> of the code in question. </span><span class="koboSpan" id="kobo.183.2">Refactoring is a structural change done to bring some piece of technical merit without altering the existing behavior of your code. </span><span class="koboSpan" id="kobo.183.3">If a method typically returned a certain value before you refactored it and now it returns a different value, that is a </span><em class="italic"><span class="koboSpan" id="kobo.184.1">change</span></em><span class="koboSpan" id="kobo.185.1"> and not </span><span class="No-Break"><span class="koboSpan" id="kobo.186.1">a refactoring.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.187.1">Refactoring also should provide some benefit to the engineering team. </span><span class="koboSpan" id="kobo.187.2">The code resulting from refactoring should be easier to understand, less likely to break when changed, and have less technical debt and fewer code smells than the starting </span><span class="No-Break"><span class="koboSpan" id="kobo.188.1">code did.</span></span></p>
<p><span class="koboSpan" id="kobo.189.1">Every line of code the development team produces should have a business value. </span><span class="koboSpan" id="kobo.189.2">Refactoring is no different, except the business value it produces should be more maintainable code with fewer issues and delays arising from </span><span class="No-Break"><span class="koboSpan" id="kobo.190.1">its presence.</span></span></p>
<p><span class="koboSpan" id="kobo.191.1">Sometimes, we try to improve our code through refactoring and we accidentally introduce new behavior – typically in the form of new bugs. </span><span class="koboSpan" id="kobo.191.2">This makes our refactoring become an unintentional change in the software that can result in emergency fixes to restore code to a </span><span class="No-Break"><span class="koboSpan" id="kobo.192.1">working state.</span></span></p>
<p><span class="koboSpan" id="kobo.193.1">Breaking code while refactoring can be a critical problem and a significant barrier to being allowed to perform refactored code in the future, which in turn can allow technical debt </span><span class="No-Break"><span class="koboSpan" id="kobo.194.1">to thrive.</span></span></p>
<p><span class="koboSpan" id="kobo.195.1">In </span><em class="italic"><span class="koboSpan" id="kobo.196.1">Part 2</span></em><span class="koboSpan" id="kobo.197.1"> of this book, we’ll explore ways of safely </span><a id="_idIndexMarker020"/><span class="koboSpan" id="kobo.198.1">refactoring your code so that you don’t accidentally introduce bugs, while in </span><em class="italic"><span class="koboSpan" id="kobo.199.1">Part 4</span></em><span class="koboSpan" id="kobo.200.1">, we’ll discuss getting organizational buy-in to refactor your code, and what to do when a defect does arise out of your </span><span class="No-Break"><span class="koboSpan" id="kobo.201.1">refactoring efforts.</span></span></p>
<h2 id="_idParaDest-22"><a id="_idTextAnchor021"/><span class="koboSpan" id="kobo.202.1">Refactoring tools in Visual Studio</span></h2>
<p><span class="koboSpan" id="kobo.203.1">Thankfully, all editions of </span><strong class="bold"><span class="koboSpan" id="kobo.204.1">Visual Studio</span></strong><span class="koboSpan" id="kobo.205.1"> now</span><a id="_idIndexMarker021"/><span class="koboSpan" id="kobo.206.1"> include refactoring tools built into the editor that allow you to quickly perform a set of common refactorings in a reliable and </span><span class="No-Break"><span class="koboSpan" id="kobo.207.1">repeatable manner.</span></span></p>
<p><span class="koboSpan" id="kobo.208.1">In </span><a href="B21324_02.xhtml#_idTextAnchor026"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.209.1">Chapter 2</span></em></span></a><em class="italic"><span class="koboSpan" id="kobo.210.1">: Introduction to Refactoring</span></em><span class="koboSpan" id="kobo.211.1"> and the remaining chapters in </span><em class="italic"><span class="koboSpan" id="kobo.212.1">Part 1</span></em><span class="koboSpan" id="kobo.213.1">, we’ll see a number of refactorings in</span><a id="_idIndexMarker022"/><span class="koboSpan" id="kobo.214.1"> action. </span><span class="koboSpan" id="kobo.214.2">Here’s a preview of some of the refactoring </span><a id="_idIndexMarker023"/><span class="koboSpan" id="kobo.215.1">options Visual Studio provides </span><span class="No-Break"><span class="koboSpan" id="kobo.216.1">the user:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer009">
<span class="koboSpan" id="kobo.217.1"><img alt="Figure 1.1 – Visual Studio Quick Actions context menu showing a set of refactoring operations" src="image/B21324_01_01.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.218.1">Figure 1.1 – Visual Studio Quick Actions context menu showing a set of refactoring operations</span></p>
<p><span class="koboSpan" id="kobo.219.1">Tool-assisted refactorings such as</span><a id="_idIndexMarker024"/><span class="koboSpan" id="kobo.220.1"> these are fantastic for a </span><span class="No-Break"><span class="koboSpan" id="kobo.221.1">few </span></span><span class="No-Break"><a id="_idIndexMarker025"/></span><span class="No-Break"><span class="koboSpan" id="kobo.222.1">reasons:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.223.1">They are fast </span><span class="No-Break"><span class="koboSpan" id="kobo.224.1">and efficient</span></span></li>
<li><span class="koboSpan" id="kobo.225.1">They are reliable </span><span class="No-Break"><span class="koboSpan" id="kobo.226.1">and repeatable</span></span></li>
<li><span class="koboSpan" id="kobo.227.1">They </span><em class="italic"><span class="koboSpan" id="kobo.228.1">rarely</span></em> <span class="No-Break"><span class="koboSpan" id="kobo.229.1">introduce defects</span></span></li>
</ul>
<p class="callout-heading"><span class="koboSpan" id="kobo.230.1">Caution</span></p>
<p class="callout"><span class="koboSpan" id="kobo.231.1">Note that I use the word </span><em class="italic"><span class="koboSpan" id="kobo.232.1">rarely</span></em><span class="koboSpan" id="kobo.233.1"> when talking about bugs introduced by refactoring tools. </span><span class="koboSpan" id="kobo.233.2">There are a few rare scenarios where using the built-in refactoring tools without thinking about their actions may introduce bugs into your application. </span><span class="koboSpan" id="kobo.233.3">We’ll talk specifically about those areas as we encounter them in the </span><span class="No-Break"><span class="koboSpan" id="kobo.234.1">following chapters.</span></span></p>
<p><span class="koboSpan" id="kobo.235.1">Over the rest of </span><em class="italic"><span class="koboSpan" id="kobo.236.1">Part 1</span></em><span class="koboSpan" id="kobo.237.1">, we’ll explore using these tools to quickly and effectively refactor your C# applications and talk about the types of scenarios in which you might use each one </span><span class="No-Break"><span class="koboSpan" id="kobo.238.1">of these.</span></span></p>
<p><span class="koboSpan" id="kobo.239.1">With all that our tools can do, it is important to remember that these tools are just one way of refactoring code. </span><span class="koboSpan" id="kobo.239.2">Often, the most effective ways of removing code smells involve a combination of writing code yourself and using the built-in </span><span class="No-Break"><span class="koboSpan" id="kobo.240.1">refactoring tools.</span></span></p>
<p><span class="koboSpan" id="kobo.241.1">Refactoring’s key </span><a id="_idIndexMarker026"/><span class="koboSpan" id="kobo.242.1">value is the long-term health of an organization, but </span><a id="_idIndexMarker027"/><span class="koboSpan" id="kobo.243.1">many obstacles to refactoring can come from the organization itself. </span><span class="koboSpan" id="kobo.243.2">To help illustrate the practical aspects of refactoring in a real organization, each chapter will involve a case study from a fictitious organization. </span><span class="koboSpan" id="kobo.243.3">Some chapters will focus entirely on code from the case study while others, such as this chapter, will conclude with a dedicated case study section. </span><span class="koboSpan" id="kobo.243.4">These case study sections illustrate the concepts of the chapter applied to a </span><span class="No-Break"><span class="koboSpan" id="kobo.244.1">fictitious organization.</span></span></p>
<p><span class="koboSpan" id="kobo.245.1">Let’s meet our first case study section and see how technical debt and legacy code affect a </span><span class="No-Break"><span class="koboSpan" id="kobo.246.1">typical company.</span></span></p>
<h1 id="_idParaDest-23"><a id="_idTextAnchor022"/><span class="koboSpan" id="kobo.247.1">Case study – Cloudy Skies Airlines</span></h1>
<p><span class="koboSpan" id="kobo.248.1">The rest</span><a id="_idIndexMarker028"/><span class="koboSpan" id="kobo.249.1"> of this book will follow code examples from an airline called </span><strong class="bold"><span class="koboSpan" id="kobo.250.1">Cloudy Skies Airlines</span></strong><span class="koboSpan" id="kobo.251.1">, or </span><strong class="bold"><span class="koboSpan" id="kobo.252.1">Cloudy Skies</span></strong><span class="koboSpan" id="kobo.253.1"> for short. </span><span class="koboSpan" id="kobo.253.2">Through these examples, we should be able to see how technical debt and refactoring can apply to a “real” organization and </span><span class="No-Break"><span class="koboSpan" id="kobo.254.1">its software.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.255.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.256.1">Cloudy Skies is a fictitious airline company created for this book for teaching purposes only. </span><span class="koboSpan" id="kobo.256.2">Any resemblance to any real company is purely coincidental. </span><span class="koboSpan" id="kobo.256.3">Additionally, I have never worked in aviation, so the code examples presented in the book are likely significantly different from actual software systems used in </span><span class="No-Break"><span class="koboSpan" id="kobo.257.1">the industry.</span></span></p>
<p><span class="koboSpan" id="kobo.258.1">Cloudy Skies is an airline that’s been around for the past 50 years and currently operates a little over 500 jets in its fleet, serving around 70 cities in </span><span class="No-Break"><span class="koboSpan" id="kobo.259.1">its region.</span></span></p>
<p><span class="koboSpan" id="kobo.260.1">Twenty years ago, the airline made a major move and started replacing its aging software systems with custom in-house applications built by its development team. </span><span class="koboSpan" id="kobo.260.2">Cloudy Skies chose to use .NET and C#. </span><span class="koboSpan" id="kobo.260.3">The initial systems performed well and resulted in increased developer productivity and high-performance software applications, so Cloudy Skies continued to migrate its applications </span><span class="No-Break"><span class="koboSpan" id="kobo.261.1">to .NET.</span></span></p>
<p><span class="koboSpan" id="kobo.262.1">As time went by, the airline and its systems grew. </span><span class="koboSpan" id="kobo.262.2">The engineering team at Cloudy Skies was once held in high esteem as the pride and joy of the organization and a key to </span><span class="No-Break"><span class="koboSpan" id="kobo.263.1">its future.</span></span></p>
<p><span class="koboSpan" id="kobo.264.1">However, management has been somewhat frustrated by its engineering team over the past few years. </span><span class="koboSpan" id="kobo.264.2">Some of its key complaints include </span><span class="No-Break"><span class="koboSpan" id="kobo.265.1">the following:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.266.1">Product managers are frustrated by large estimates for seemingly simple changes to existing systems, and a growing amount of time between software releases due to long implementation times and </span><span class="No-Break"><span class="koboSpan" id="kobo.267.1">numerous bugs.</span></span></li>
<li><span class="koboSpan" id="kobo.268.1">The Quality Assurance department has been overwhelmed by a growing number of bugs present in the software, a tendency for the same things to break repeatedly, and bugs appearing in seemingly unrelated areas when changes occur in other parts of </span><span class="No-Break"><span class="koboSpan" id="kobo.269.1">the application.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.270.1">For its part, the engineering team feels overwhelmed by the code it’s working with. </span><span class="koboSpan" id="kobo.270.2">Strategic initiatives have been pushed aside for years while the organization has the team focus on urgent changes or tight deadlines for new releases. </span><span class="koboSpan" id="kobo.270.3">As a result, nobody has had time to address the growing amount of technical debt the team </span><span class="No-Break"><span class="koboSpan" id="kobo.271.1">is facing.</span></span></p>
<p><span class="koboSpan" id="kobo.272.1">The Cloudy Skies codebase is constantly growing in complexity to account for each new feature or “special case” added to the system. </span><span class="koboSpan" id="kobo.272.2">This complexity in turn makes the application harder to test, understand, and modify, which has led to difficulties in onboarding new developers and some experienced developers leaving </span><span class="No-Break"><span class="koboSpan" id="kobo.273.1">the organization.</span></span></p>
<p><span class="koboSpan" id="kobo.274.1">Out of frustration after several severe delays and high-profile bugs, Cloudy Skies brings in a new engineering manager and empowers the team to make changes to ensure the airline can stay efficient and effective in the years </span><span class="No-Break"><span class="koboSpan" id="kobo.275.1">to come.</span></span></p>
<p><span class="koboSpan" id="kobo.276.1">This engineering manager determines that the primary cause of these problems is technical debt and that targeted refactoring of the most critical areas throughout the suite of applications could significantly reduce risk and improve the team’s effectiveness </span><span class="No-Break"><span class="koboSpan" id="kobo.277.1">going forward.</span></span></p>
<p><span class="koboSpan" id="kobo.278.1">To its </span><a id="_idIndexMarker029"/><span class="koboSpan" id="kobo.279.1">credit, management agrees and allows the team to allocate resources to pay down technical debt and improve the maintainability of the code </span><span class="No-Break"><span class="koboSpan" id="kobo.280.1">through refactoring.</span></span></p>
<p><span class="koboSpan" id="kobo.281.1">Throughout the rest of this book, we’ll follow aspects of this fictitious team’s journey in paying down technical debt and paving the way to a better future </span><span class="No-Break"><span class="koboSpan" id="kobo.282.1">through refactoring.</span></span></p>
<h1 id="_idParaDest-24"><a id="_idTextAnchor023"/><span class="koboSpan" id="kobo.283.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.284.1">Legacy code is an unavoidable byproduct of the forces of time and constant change that are present in software development projects. </span><span class="koboSpan" id="kobo.284.2">This legacy code becomes a breeding ground for technical debt, which threatens our productivity as developers and the quality of </span><span class="No-Break"><span class="koboSpan" id="kobo.285.1">our software.</span></span></p>
<p><span class="koboSpan" id="kobo.286.1">While technical debt can arise due to a number of reasons, refactoring is the cure. </span><span class="koboSpan" id="kobo.286.2">Refactoring reworks existing code into a more maintainable and less risky form, reducing our technical debt and helping us control our </span><span class="No-Break"><span class="koboSpan" id="kobo.287.1">legacy code.</span></span></p>
<p><span class="koboSpan" id="kobo.288.1">The more you understand the causes and effects of technical debt in your code, the better you’ll find yourself equipped to explain technical debt to others in your organization, advocate for refactoring, and avoid things that cause your code to decline in effectiveness </span><span class="No-Break"><span class="koboSpan" id="kobo.289.1">over time.</span></span></p>
<p><span class="koboSpan" id="kobo.290.1">In the next chapter, we’ll explore refactoring in more depth by walking through a set of targeted changes to improve a piece of sample code from the Cloudy Skies </span><span class="No-Break"><span class="koboSpan" id="kobo.291.1">Airlines codebase.</span></span></p>
<h1 id="_idParaDest-25"><a id="_idTextAnchor024"/><span class="koboSpan" id="kobo.292.1">Questions</span></h1>
<ol>
<li><span class="koboSpan" id="kobo.293.1">What is the difference between technical debt and </span><span class="No-Break"><span class="koboSpan" id="kobo.294.1">legacy code?</span></span></li>
<li><span class="koboSpan" id="kobo.295.1">What are some causes of </span><span class="No-Break"><span class="koboSpan" id="kobo.296.1">technical debt?</span></span></li>
<li><span class="koboSpan" id="kobo.297.1">What are some of the effects of </span><span class="No-Break"><span class="koboSpan" id="kobo.298.1">technical debt?</span></span></li>
<li><span class="koboSpan" id="kobo.299.1">Is it possible to avoid </span><span class="No-Break"><span class="koboSpan" id="kobo.300.1">technical debt?</span></span></li>
<li><span class="koboSpan" id="kobo.301.1">Is it possible to get to a point where your code cannot be </span><span class="No-Break"><span class="koboSpan" id="kobo.302.1">refactored further?</span></span></li>
</ol>
<h1 id="_idParaDest-26"><a id="_idTextAnchor025"/><span class="koboSpan" id="kobo.303.1">Further reading</span></h1>
<p><span class="koboSpan" id="kobo.304.1">You can find more information about technical debt, legacy code, and refactoring at the </span><span class="No-Break"><span class="koboSpan" id="kobo.305.1">following URLs:</span></span></p>
<ul>
<li><em class="italic"><span class="koboSpan" id="kobo.306.1">Defining Technical </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.307.1">Debt</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.308.1">: </span></span><a href="https://killalldefects.com/2019/12/23/defining-technical-debt/"><span class="No-Break"><span class="koboSpan" id="kobo.309.1">https://killalldefects.com/2019/12/23/defining-technical-debt/</span></span></a></li>
<li><em class="italic"><span class="koboSpan" id="kobo.310.1">Identify Technical </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.311.1">Debt</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.312.1">: </span></span><a href="https://learn.microsoft.com/en-us/training/modules/identify-technical-debt/"><span class="No-Break"><span class="koboSpan" id="kobo.313.1">https://learn.microsoft.com/en-us/training/modules/identify-technical-debt/</span></span></a><a href="https://learn.microsoft.com/en-us/training/modules/identify-technical-debt/ "/></li>
<li><em class="italic"><span class="koboSpan" id="kobo.314.1">The True Cost of Technical </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.315.1">Debt</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.316.1">: </span></span><a href="https://killalldefects.com/2019/11/09/the-true-cost-of-technical-debt/"><span class="No-Break"><span class="koboSpan" id="kobo.317.1">https://killalldefects.com/2019/11/09/the-true-cost-of-technical-debt/</span></span></a><a href="https://killalldefects.com/2019/11/09/the-true-cost-of-technical-debt/ "/></li>
<li><em class="italic"><span class="koboSpan" id="kobo.318.1">Code </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.319.1">refactoring</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.320.1">: </span></span><a href="https://en.wikipedia.org/wiki/Code_refactoring"><span class="No-Break"><span class="koboSpan" id="kobo.321.1">https://en.wikipedia.org/wiki/Code_refactoring</span></span></a></li>
</ul>
</div>
</body></html>