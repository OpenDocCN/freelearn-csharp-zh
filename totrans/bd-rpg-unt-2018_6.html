<html><head></head><body>
        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Inventory System</h1>
                
            
            <article>
                
<p class="calibre3"> The inventory system is one of the most critical components of an RPG. It will be used to store all important game elements that the player will need in your game environment. This chapter will guide you on how to create a simple generic inventory system that can be utilized and extended as you see fit.</p>
<p class="calibre3">Here is a breakdown of the chapter:</p>
<ul class="calibre11">
<li class="calibre12">Designing an inventory system
<ul class="calibre32">
<li class="calibre12">Weighted inventory</li>
<li class="calibre12">Determining item types</li>
</ul>
</li>
<li class="calibre12">Creating an inventory item
<ul class="calibre32">
<li class="calibre12">Creating the prefab</li>
<li class="calibre12">Adding an inventory item agent</li>
<li class="calibre12">Inventory items defined as prefabs</li>
</ul>
</li>
<li class="calibre12">Designing an inventory interface
<ul class="calibre32">
<li class="calibre12">Creating the inventory UI framework</li>
<li class="calibre12">Designing a dynamic item viewer
<ul class="calibre32">
<li class="calibre12">Adding a scroll view</li>
<li class="calibre12">Adding elements to PanelItem and Scroll View</li>
<li class="calibre12">Adding txtItemElement dynamically</li>
</ul>
</li>
<li class="calibre12">Building the final inventory item UI</li>
</ul>
</li>
<li class="calibre12">Integrating the UI with the actual inventory system
<ul class="calibre32">
<li class="calibre12">Hooking the category buttons and displaying the data</li>
<li class="calibre12">Testing the inventory system</li>
</ul>
</li>
<li class="calibre12">Inventory items and the player character
<ul class="calibre32">
<li class="calibre12">Applying inventory items</li>
<li class="calibre12">How it looks</li>
</ul>
</li>
</ul>
<p class="calibre3">There is a lot of work ahead of us in this chapter. Let's get started!</p>
<p class="calibre3"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Designing an inventory system</h1>
                
            
            <article>
                
<p class="calibre3">As with everything else we have discussed thus far, designing your <strong class="calibre5">inventory system</strong> will also be heavily dependent on your game. There are many different types of inventory system mechanics that you can study and choose based on its relevance to your game.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Weighted inventory</h1>
                
            
            <article>
                
<p class="calibre3">I will be leaning towards implementing what is called the <strong class="calibre5">weighted inventory</strong>. In this type of inventory system, each item or piece of equipment is assigned a numerical value that represents the weight of the item. This, in return, is used to determine how much inventory the player can carry at any given time during game play. This makes sense for our RPG, if you think about it.</p>
<p class="calibre3">Consider the following as an example: assume you are a hiker who wants to climb Mount Ararat. The climb itself will take a certain amount of time. During the climb, you will need to carry with you the necessary equipment to complete the journey or climb. Realistically, there are several crucial items that you, as the hiker, will need to carry with you, such as those shown in the following list:</p>
<ul class="calibre11">
<li class="calibre12">Clothing</li>
<li class="calibre12">Tents</li>
<li class="calibre12">Sleeping bags</li>
<li class="calibre12">Boots</li>
<li class="calibre12">Ice breakers</li>
<li class="calibre12">Food</li>
<li class="calibre12">Light source</li>
<li class="calibre12">Personal items</li>
</ul>
<p class="calibre3">Each one of the categories listed above has a specific weight associated to it in real life. Therefore, when you are planning your hike, you will need to plan ahead and see how you can meet your climbing needs, while in the meantime also reducing the amount of items and the total weight of the items you will need to carry on your back during the journey. The actual logistics are a little more involved, but you get the picture.</p>
<p class="calibre3"/>
<p class="calibre3">It is no different in our RPG. The player character can only carry a certain number of items and/or equipment with them for their journey. For instance, the player character cannot carry twenty different types of weapon at any given time! It would be just impossible, realistically speaking. So it would be a nice touch to put some realism into the game play.</p>
<p class="calibre3">Also, just like in real life, the heavier the equipment one has to carry, the more energy it will take. So, we can also incorporate such a system for our game. For instance, carrying too many weapons will have a major effect on the player character over a long period of time. First of all, it will reduce its speed and movement drastically; secondly, it can have a major impact on the health of the player. This is where your creativity and design skills will come into play. You are the master of the game, and you determine how you want to implement it!</p>
<p class="calibre3">I am going to keep it simple for the sake of demonstration!</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Determining item types</h1>
                
            
            <article>
                
<p class="calibre3">For starters, we will concentrate on some of the basic item types that we would like to define in our game, such as weapons, armor, and clothing. On top of this, we can also add health packets, potions, and collectibles.</p>
<p class="calibre3">We will create three new scripts named <kbd class="calibre13">BaseItem.cs</kbd>, <kbd class="calibre13">InventoryItem.c</kbd>, and <kbd class="calibre13">InventorySystem.cs</kbd>. The <kbd class="calibre13">BaseItem</kbd> class will hold the generic properties for all items, just like the <kbd class="calibre13">BaseCharacter</kbd> class we defined previously. The <kbd class="calibre13">InventoryItem</kbd> class will inherit the <kbd class="calibre13">BaseItem</kbd> class and define the item type.</p>
<p class="calibre3">A listing of <kbd class="calibre13">BaseItem.cs</kbd> is as follows:</p>
<pre class="calibre18">using System;<br class="title-page-name"/>using UnityEngine;<br class="title-page-name"/>namespace com.noorcon.rpg2e<br class="title-page-name"/>{<br class="title-page-name"/>[Serializable]<br class="title-page-name"/>public class BaseItem<br class="title-page-name"/>{<br class="title-page-name"/>public enum ItemCatrgory<br class="title-page-name"/>{<br class="title-page-name"/>Weapon = 0,<br class="title-page-name"/>Armour = 1,<br class="title-page-name"/>Clothing = 2,<br class="title-page-name"/>Health = 3,<br class="title-page-name"/>Potion = 4<br class="title-page-name"/>}<br class="title-page-name"/>[SerializeField]<br class="title-page-name"/>private string name;<br class="title-page-name"/>[SerializeField]<br class="title-page-name"/>private string description;<br class="title-page-name"/>public string Name<br class="title-page-name"/>{<br class="title-page-name"/>get { return name; }<br class="title-page-name"/>set { name = value; }<br class="title-page-name"/>}<br class="title-page-name"/>public string Description<br class="title-page-name"/>{<br class="title-page-name"/>get { return description; }<br class="title-page-name"/>set { description = value; }<br class="title-page-name"/>}<br class="title-page-name"/>}<br class="title-page-name"/>}</pre>
<p class="calibre3">The main idea in the preceding code is <kbd class="calibre13">ItemCateogry</kbd>. At the moment, I have kept it to only five different types of category that the inventory would keep track of.</p>
<div class="packt_infobox">A category could have multiple item types. For instance, there are different types of weapons and so on.</div>
<p class="calibre3">A listing of <kbd class="calibre13">InventoryItem.cs</kbd> is as follows:</p>
<pre class="calibre18">using System;<br class="title-page-name"/>using UnityEngine;<br class="title-page-name"/>namespace com.noorcon.rpg2e<br class="title-page-name"/>{<br class="title-page-name"/>[Serializable]<br class="title-page-name"/>public class InventoryItem : BaseItem<br class="title-page-name"/>{<br class="title-page-name"/>[SerializeField]<br class="title-page-name"/>private ItemCatrgory category;<br class="title-page-name"/>[SerializeField]<br class="title-page-name"/>private float strength;<br class="title-page-name"/>[SerializeField]<br class="title-page-name"/>private float weight;<br class="title-page-name"/>public ItemCatrgory Category<br class="title-page-name"/>{<br class="title-page-name"/>get { return category; }<br class="title-page-name"/>set { category = value; }<br class="title-page-name"/>}<br class="title-page-name"/>public float Strength<br class="title-page-name"/>{<br class="title-page-name"/>get { return strength; }<br class="title-page-name"/>set { strength = value; }<br class="title-page-name"/>}<br class="title-page-name"/>public float Weight<br class="title-page-name"/>{<br class="title-page-name"/>get { return weight; }<br class="title-page-name"/>set { weight = value; }<br class="title-page-name"/>}<br class="title-page-name"/>}<br class="title-page-name"/>}</pre>
<p class="calibre3">The preceding code implements more properties or attributes for the items to be used in the inventory. For now, let's just keep it the way it is; we can always change it in the future.</p>
<p class="calibre3">The next important script is the actual script that will be used to manage the inventory. There are many ways to implement the logic for the inventory system. Again keeping things simple, the current script will have five <kbd class="calibre13">List</kbd> datatypes of type <kbd class="calibre13">InventoryItem</kbd>, one for each item category.</p>
<p class="calibre3">A listing of <kbd class="calibre13">InventorySystem.cs</kbd> is as follows:</p>
<pre class="calibre18">using System.Collections.Generic;<br class="title-page-name"/>using UnityEngine;<br class="title-page-name"/>namespace com.noorcon.rpg2e<br class="title-page-name"/>{<br class="title-page-name"/>public class InventorySystem<br class="title-page-name"/>{<br class="title-page-name"/>[SerializeField]<br class="title-page-name"/>private List&lt;InventoryItem&gt; weapons = new List&lt;InventoryItem&gt;();<br class="title-page-name"/>[SerializeField]<br class="title-page-name"/>private List&lt;InventoryItem&gt; armour = new List&lt;InventoryItem&gt;();<br class="title-page-name"/>[SerializeField]<br class="title-page-name"/>private List&lt;InventoryItem&gt; clothing = new List&lt;InventoryItem&gt;();<br class="title-page-name"/>[SerializeField]<br class="title-page-name"/>private List&lt;InventoryItem&gt; health = new List&lt;InventoryItem&gt;();<br class="title-page-name"/>[SerializeField]<br class="title-page-name"/>private List&lt;InventoryItem&gt; potion = new List&lt;InventoryItem&gt;();<br class="title-page-name"/>private InventoryItem selectedWeapon;<br class="title-page-name"/>private InventoryItem selectedArmour;<br class="title-page-name"/>public InventoryItem SelectedWeapon<br class="title-page-name"/>{<br class="title-page-name"/>get { return selectedWeapon; }<br class="title-page-name"/>set { selectedWeapon = value; }<br class="title-page-name"/>}<br class="title-page-name"/>public InventoryItem SelectedArmour<br class="title-page-name"/>{<br class="title-page-name"/>get { return selectedArmour; }<br class="title-page-name"/>set { selectedArmour = value; }<br class="title-page-name"/>}<br class="title-page-name"/>public InventorySystem()<br class="title-page-name"/>{<br class="title-page-name"/>ClearInventory();<br class="title-page-name"/>}<br class="title-page-name"/>public void ClearInventory()<br class="title-page-name"/>{<br class="title-page-name"/>weapons.Clear();<br class="title-page-name"/>armour.Clear();<br class="title-page-name"/>clothing.Clear();<br class="title-page-name"/>health.Clear();<br class="title-page-name"/>potion.Clear();<br class="title-page-name"/>}<br class="title-page-name"/>// this function will add an inventory item<br class="title-page-name"/>public void AddItem(InventoryItem item)<br class="title-page-name"/>{<br class="title-page-name"/>switch (item.Category)<br class="title-page-name"/>{<br class="title-page-name"/>case BaseItem.ItemCatrgory.Armour:<br class="title-page-name"/>{<br class="title-page-name"/>armour.Add(item);<br class="title-page-name"/>break;<br class="title-page-name"/>}<br class="title-page-name"/>case BaseItem.ItemCatrgory.Clothing:<br class="title-page-name"/>{<br class="title-page-name"/>clothing.Add(item);<br class="title-page-name"/>break;<br class="title-page-name"/>}<br class="title-page-name"/>case BaseItem.ItemCatrgory.Health:<br class="title-page-name"/>{<br class="title-page-name"/>health.Add(item);<br class="title-page-name"/>break;<br class="title-page-name"/>}<br class="title-page-name"/>case BaseItem.ItemCatrgory.Potion:<br class="title-page-name"/>{<br class="title-page-name"/>potion.Add(item);<br class="title-page-name"/>break;<br class="title-page-name"/>}<br class="title-page-name"/>case BaseItem.ItemCatrgory.Weapon:<br class="title-page-name"/>{<br class="title-page-name"/>weapons.Add(item);<br class="title-page-name"/>break;<br class="title-page-name"/>}<br class="title-page-name"/>}<br class="title-page-name"/>}</pre>
<p class="calibre3"/>
<p class="calibre3"/>
<p class="calibre3"/>
<p class="calibre3"/>
<p class="calibre3"/>
<p class="calibre3"/>
<p class="calibre3"/>
<p class="calibre3"><span class="calibre6">We won't have direct access to the lists that will be used to contain the inventory items. For now, we have implemented two functions, <kbd class="calibre13">AddItem()</kbd></span><span class="calibre6"> and </span><kbd class="calibre13">DeleteItem()</kbd><span class="calibre6">, which will handle the two basics features of the inventory, adding an item to it and removing an item from it. These two functions will take an </span><kbd class="calibre13">InventoryItem</kbd><span class="calibre6"> object, and based on</span> <kbd class="calibre13">ItemCategory</kbd><span class="calibre6">, be added or removed from the appropriate list within the inventory, as shown in the following code:</span></p>
<pre class="calibre18">// this function will remove an inventory item<br class="title-page-name"/>public void DeleteItem(InventoryItem item)<br class="title-page-name"/>{<br class="title-page-name"/>switch (item.Category)<br class="title-page-name"/>{<br class="title-page-name"/>case BaseItem.ItemCatrgory.Armour:<br class="title-page-name"/>{<br class="title-page-name"/>armour.Remove(item);<br class="title-page-name"/>break;<br class="title-page-name"/>}<br class="title-page-name"/>case BaseItem.ItemCatrgory.Clothing:<br class="title-page-name"/>{<br class="title-page-name"/>clothing.Remove(item);<br class="title-page-name"/>break;<br class="title-page-name"/>}<br class="title-page-name"/>case BaseItem.ItemCatrgory.Health:<br class="title-page-name"/>{<br class="title-page-name"/>health.Remove(item);<br class="title-page-name"/>break;<br class="title-page-name"/>}<br class="title-page-name"/>case BaseItem.ItemCatrgory.Potion:<br class="title-page-name"/>{<br class="title-page-name"/>potion.Remove(item);<br class="title-page-name"/>break;<br class="title-page-name"/>}<br class="title-page-name"/>case BaseItem.ItemCatrgory.Weapon:<br class="title-page-name"/>{<br class="title-page-name"/>weapons.Remove(item);<br class="title-page-name"/>break;<br class="title-page-name"/>}<br class="title-page-name"/>}<br class="title-page-name"/>}<br class="title-page-name"/>}<br class="title-page-name"/>}</pre>
<p class="calibre3">The basics are in place. Now we will need to integrate this with the <kbd class="calibre13">GameMaster.cs</kbd> script. To do so, we will need to create a new variable of type <kbd class="calibre13">InventorySystem</kbd> named <kbd class="calibre13">INVENTORY</kbd>, initialized in the <kbd class="calibre13">Awake()</kbd> function of the <kbd class="calibre13">GameMaster.cs</kbd> script.</p>
<p class="calibre3"/>
<p class="calibre3">The following listing illustrates just the new addition:</p>
<pre class="calibre18">public static GameMaster instance;<br class="title-page-name"/>// let's have a reference to the player character<br class="title-page-name"/>// and start position of player character<br class="title-page-name"/>public GameObject PlayerCharacterGameObject;<br class="title-page-name"/>public GameObject StartPosition;<br class="title-page-name"/>public GameObject CharacterCustomization;<br class="title-page-name"/>public PlayerCharacter PlayerCharacterData;<br class="title-page-name"/>public InventorySystem Inventory;<br class="title-page-name"/>public GameLevelController LevelController;<br class="title-page-name"/>public GameAudioController AudioController;<br class="title-page-name"/>// Ref to UI Elements ...<br class="title-page-name"/>public bool DisplaySettings = false;<br class="title-page-name"/>public UiController Ui;<br class="title-page-name"/>void Awake()<br class="title-page-name"/>{<br class="title-page-name"/>// simple singlton<br class="title-page-name"/>if (instance == null)<br class="title-page-name"/>{<br class="title-page-name"/>instance = this;<br class="title-page-name"/>// initialize level controller<br class="title-page-name"/>instance.LevelController = new GameLevelController();<br class="title-page-name"/>// initialize audio controller<br class="title-page-name"/>instance.AudioController = new GameAudioController();<br class="title-page-name"/>instance.AudioController.audioSource = instance.GetComponent&lt;AudioSource&gt;();<br class="title-page-name"/>instance.AudioController.SetDefaultVolume();<br class="title-page-name"/>// initialize Inventory System<br class="title-page-name"/>instance.Inventory = new InventorySystem();<br class="title-page-name"/>InventoryItem tmpInvItem = new InventoryItem();<br class="title-page-name"/>tmpInvItem.Category = BaseItem.ItemCatrgory.Clothing;<br class="title-page-name"/>tmpInvItem.Name = "Testing";<br class="title-page-name"/>tmpInvItem.Description = "Testing clothing item type";<br class="title-page-name"/>tmpInvItem.Strength = 0.5f;<br class="title-page-name"/>tmpInvItem.Weight = 0.2f;<br class="title-page-name"/>instance.Inventory.AddItem(tmpInvItem);<br class="title-page-name"/>}<br class="title-page-name"/>else if (instance != this)<br class="title-page-name"/>{<br class="title-page-name"/>Destroy(this);<br class="title-page-name"/>}<br class="title-page-name"/>// keep the game object when moving from<br class="title-page-name"/>// one scene to the next scene<br class="title-page-name"/>DontDestroyOnLoad(this);<br class="title-page-name"/>}</pre>
<p class="calibre3">Notice that we are actually creating an <kbd class="calibre13">InventoryItem</kbd> object and inserting it into <kbd class="calibre13">InventorySystem</kbd> for testing purposes. Another great feature is that you can see <kbd class="calibre13">InventorySystem</kbd> during design time since we have serialized the classes and the fields. Take a look at the following screenshot:</p>
<div class="mce-root1"><img src="../images/00114.gif" class="calibre106"/></div>
<p class="calibre3">The preceding screenshot displays the inventory system as seen in the <span class="calibre6">Inspector Window</span> when you select the <kbd class="calibre13">GameMaster</kbd> object. When you run the game to test it, you will see the following update:</p>
<div class="mce-root1"><img src="../images/00115.jpeg" class="calibre107"/></div>
<p class="calibre3">Notice how the data reflects appropriately in the inventory system, as expected! The <span class="calibre6">CLOTHING </span>list has increased its size to 1, and the <kbd class="calibre13">InventoryItem</kbd> object within the list is properly stored and displayed for testing and debugging. We have one clothing item named <span class="calibre6">Testing</span>, with the given description, a <span class="calibre6">Strength</span> of <span class="calibre6">0.5</span>, and a <span class="calibre6">Weight</span> of <span class="calibre6">0.2</span>.</p>
<p class="calibre3">So far, so good. Now we need to actually create the items that will be used to visually represent our inventory items! This is discussed in the following section.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Creating an inventory item</h1>
                
            
            <article>
                
<p class="calibre3">It is now time to actually create the items (assets) we are going to use for our inventory system. I will be creating one item type from each item category to keep things simple. This section will again be highly dependent on how you have modeled your character models. As discussed earlier in the book, i<span class="calibre6">n my particular model, </span>all of the character's essential parts are embedded within the <strong class="calibre5">fbx</strong>. In this case, you will need to navigate down your model's hierarchy and extract the mesh for the specific armor or weapon, or anything else you will be using for the inventory.</p>
<div class="packt_infobox">You can also use independent models representing your inventory items that may or may not be related to your character model's mesh. These items are just used for visual representation within the world, so that the player can pick them up.</div>
<div class="mce-root1"><img src="../images/00116.jpeg" class="calibre108"/></div>
<div class="mce-root2">Creating asset prefabs</div>
<p class="calibre3">If you recall from the character customization scene, we had already gone through the model and identified the parts we wanted to have the player be able to enable or disable based on the selection they made through the interface.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Creating the prefab</h1>
                
            
            <article>
                
<p class="calibre3">If you have not already done so, go ahead and create a folder in your <span class="calibre6">Project Window</span> named <span class="calibre6">Prefabs</span>. Within this folder, go ahead and create a new folder and name it <span class="calibre6">InventoryItems</span>, and then create a sub-folder named <span class="calibre6">ShoulderPads</span>. You are welcome to use a different naming and folder structure if you choose, as long as you are comfortable and it is organized for you to work with.</p>
<p class="calibre3">To create a prefab, you simply need to take an existing GameObject that is present in the <span class="calibre6">Scene Window</span> and drag it into the <span class="calibre6">Project Window</span>. To keep things organized, we will be using the structure defined in the previous paragraph. So you will need to navigate to the <span class="calibre6">ShoulderPads</span> folder in the project window, and then simply drag one of the shoulder pad meshes from your model and drop it into the <span class="calibre6">ShoulderPads</span> folder. Take a look at the following screenshot:</p>
<div class="mce-root1"><img src="../images/00117.jpeg" class="calibre45"/></div>
<div class="mce-root2"><span>Creating asset prefabs</span></div>
<p class="calibre3">Observe, when you create a prefab, the prefab will be an exact copy of the GameObject in the active scene! In this case, my mesh is disabled in the scene; therefore, when I create a prefab of the mesh, it will also be disabled! Since it is disabled, when you drag the newly created prefab into the scene as a new GameObject, it will be invisible; you will need to enable it.</p>
<p class="calibre3"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Adding an inventory item agent</h1>
                
            
            <article>
                
<p class="calibre3">We need the means to interact with our inventory items. In order to do this, we will need to create a new script that will handle our interaction with the inventory items during game play. This will be coded in the <kbd class="calibre13">InventoryItemAgent.cs</kbd> script. At the moment, the script will just enable us to interact with the <kbd class="calibre13">InventoryItem</kbd> object through the IDE.</p>
<p class="calibre3">A listing of the script is as follows:</p>
<pre class="calibre18">using UnityEngine;<br class="title-page-name"/>namespace com.noorcon.rpg2e<br class="title-page-name"/>{<br class="title-page-name"/>public class InventoryItemAgent : MonoBehaviour<br class="title-page-name"/>{<br class="title-page-name"/>public InventoryItem Item;<br class="title-page-name"/>}<br class="title-page-name"/>}</pre>
<p class="calibre3">Very simply, in order for us to be able to interact with the GameObject, we would need to use a script that inherits <em class="calibre14">MonoBehaviour</em>. Go ahead and attach this script to your prefab. Now you can easily set up your inventory items visually. Take a look at the following screenshot:</p>
<div class="mce-root1"><img src="../images/00118.jpeg" class="calibre109"/></div>
<div class="mce-root2">Inventory item agent</div>
<p class="calibre3"/>
<p class="calibre3"/>
<p class="calibre3">In the preceding screenshot, you can see that we have created a GameObject from the prefab and, using the <span class="calibre6">InventoryItemAgent</span> component, we have access to the properties of the <span class="calibre6">InventoryItem</span> object. Utilizing this concept, you can now create your prefabs for the different types of inventory item.</p>
<div class="packt_tip">If you are applying your changes in the scene window, make sure you apply them to the original prefab so that it keeps it in memory.<br class="calibre47"/>
<br class="calibre47"/>
Caution: When you apply changes to a prefab, all instances of the prefab get updated with the new attributes.</div>
<p class="calibre3">At the moment we have implemented an easy way to define our inventory items, but we still need to implement user interaction with the items. The logic for the interaction will be implemented in the <kbd class="calibre13">InventoryItemAgent.cs</kbd> script. First we need to identify who we are colliding with; in this case, we want to make sure it is the player that is going to collect the item. Second, we need to store the data in <kbd class="calibre13">GameMaster</kbd>, and also remove <kbd class="calibre13">GameObject</kbd> from the active scene. The last two parts will be handled by <kbd class="calibre13">GameMaster</kbd>, as you will see.</p>
<p class="calibre3">The new code listing for <kbd class="calibre13">InventoryItemAgent.cs</kbd> is as follows:</p>
<pre class="calibre18">using UnityEngine;<br class="title-page-name"/>namespace com.noorcon.rpg2e<br class="title-page-name"/>{<br class="title-page-name"/>public class InventoryItemAgent : MonoBehaviour<br class="title-page-name"/>{<br class="title-page-name"/>public InventoryItem Item;<br class="title-page-name"/>public void OnTriggerEnter(Collider c)<br class="title-page-name"/>{<br class="title-page-name"/>// make sure we are colliding with the player<br class="title-page-name"/>if (c.gameObject.tag.Equals("Player"))<br class="title-page-name"/>{<br class="title-page-name"/>// Make a copy of the Inventory Item Object<br class="title-page-name"/>InventoryItem myItem = new InventoryItem();<br class="title-page-name"/>myItem.CopyInventoryItem(Item);<br class="title-page-name"/>// Add the item to our inventory<br class="title-page-name"/>GameMaster.instance.Inventory.AddItem(myItem);<br class="title-page-name"/>// Destroy the GameObject from the scene<br class="title-page-name"/>GameMaster.instance.RpgDestroy(gameObject);<br class="title-page-name"/>}<br class="title-page-name"/>}<br class="title-page-name"/>}<br class="title-page-name"/>}</pre>
<p class="calibre3"/>
<p class="calibre3">I have created a new function in the <kbd class="calibre13">InventoryItem.cs</kbd> script called <kbd class="calibre13">CoptInventoryItem()</kbd>. This function is used to make a copy of one <kbd class="calibre13">InventoryItem</kbd> object into another one. The code for the newly added function in the <kbd class="calibre13">InventoryItem</kbd> class is as follows:</p>
<pre class="calibre18">public void CopyInventoryItem(InventoryItem item)<br class="title-page-name"/>{<br class="title-page-name"/>Category = item.Category;<br class="title-page-name"/>Description = item.Description;<br class="title-page-name"/>Name = item.Name;<br class="title-page-name"/>Strength = item.Strength;<br class="title-page-name"/>Weight = item.Weight;<br class="title-page-name"/>}</pre>
<p class="calibre3">We have already seen how to add an item to the inventory using <kbd class="calibre13">GameMaster</kbd>. However, we need to add a new function that will handle the destruction of <kbd class="calibre13">GameObjects</kbd> in our game. This is done by the <kbd class="calibre13">RPG_Destroy()</kbd> function.</p>
<div class="packt_tip">You cannot use <kbd class="calibre85">Destroy()</kbd>, <kbd class="calibre85">DestroyImmediate()</kbd>, or <kbd class="calibre85">DestroyObject()</kbd> since they are part of all <kbd class="calibre85">GameObjects</kbd> in Unity. Therefore, be cautious of your naming convention within your own classes.</div>
<p class="calibre3">The listing of the new function is as follows:</p>
<pre class="calibre18">public void RpgDestroy(GameObject obj)<br class="title-page-name"/>{<br class="title-page-name"/>Destroy(obj);<br class="title-page-name"/>}</pre>
<p class="calibre3">One final component that needs to be added to your prefabs representing the inventory items is a <em class="calibre14">Collider</em>. Take a look at the following screenshot:</p>
<div class="mce-root1"><img src="../images/00119.jpeg" class="calibre45"/></div>
<div class="mce-root2">Mesh collider</div>
<p class="calibre3">I used a<span class="calibre6"> </span><span class="calibre6">Mesh Collider</span><span class="calibre6"> to keep things simple. A collider can be added by selecting the </span><span class="calibre6">Add Component | Physics | Mesh Collider</span><span class="calibre6"> from the </span><span class="calibre6">Inspector Window</span>, as shown in the following screenshot:</p>
<div class="mce-root1"><img src="../images/00120.jpeg" class="calibre110"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Inventory items defined as prefabs</h1>
                
            
            <article>
                
<p class="calibre3">The following figure shows some of the inventory item prefabs I have created for demonstration purposes:</p>
<div class="mce-root1"><img src="../images/00121.jpeg" class="calibre45"/></div>
<div class="mce-root2">Inventory prefab sample</div>
<p class="calibre3"/>
<p class="calibre3">The key for all of this to work is to make sure that your prefabs have the <kbd class="calibre13">InventoryItemAgent.cs</kbd> script as well as a <kbd class="calibre13">Collider</kbd> component attached to the prefabs. Then you will need to provide the inventory item data through the IDE uniquely identifying each one.</p>
<p class="calibre3">The following table lists the data for each inventory item defined:</p>
<table border="1" class="calibre111">
<tbody class="calibre112">
<tr class="calibre113">
<td class="calibre114">
<p class="calibre3"><strong class="calibre5">Prefab</strong></p>
</td>
<td class="calibre114">
<p class="calibre3"><strong class="calibre5">Name</strong></p>
</td>
<td class="calibre114">
<p class="calibre3"><strong class="calibre5">Description</strong></p>
</td>
<td class="calibre114">
<p class="calibre3"><strong class="calibre5">Category</strong></p>
</td>
<td class="calibre114">
<p class="calibre3"><strong class="calibre5">Strength</strong></p>
</td>
<td class="calibre114">
<p class="calibre3"><strong class="calibre5">Weight</strong></p>
</td>
</tr>
<tr class="calibre113">
<td class="calibre114">
<p class="calibre3">Helmet</p>
</td>
<td class="calibre114">
<p class="calibre3">HL01</p>
</td>
<td class="calibre114">
<p class="calibre3">Brass Helmet with Two Horns</p>
</td>
<td class="calibre114">
<p class="calibre3">Armor</p>
</td>
<td class="calibre114">
<p class="calibre3">0.2</p>
</td>
<td class="calibre114">
<p class="calibre3">0.2</p>
</td>
</tr>
<tr class="calibre113">
<td class="calibre114"/>
<td class="calibre114">
<p class="calibre3">HL02</p>
</td>
<td class="calibre114">
<p class="calibre3">Brass Helmet Face Protection</p>
</td>
<td class="calibre114">
<p class="calibre3">Armor</p>
</td>
<td class="calibre114">
<p class="calibre3">0.3</p>
</td>
<td class="calibre114">
<p class="calibre3">0.25</p>
</td>
</tr>
<tr class="calibre113">
<td class="calibre114"/>
<td class="calibre114">
<p class="calibre3">HL03</p>
</td>
<td class="calibre114">
<p class="calibre3">Bronze Helmet Protecting Face</p>
</td>
<td class="calibre114">
<p class="calibre3">Armor</p>
</td>
<td class="calibre114">
<p class="calibre3">0.3</p>
</td>
<td class="calibre114">
<p class="calibre3">0.3</p>
</td>
</tr>
<tr class="calibre113">
<td class="calibre114"/>
<td class="calibre114">
<p class="calibre3">HL04</p>
</td>
<td class="calibre114">
<p class="calibre3">Bronze Helmet</p>
</td>
<td class="calibre114">
<p class="calibre3">Armor</p>
</td>
<td class="calibre114">
<p class="calibre3">0.2</p>
</td>
<td class="calibre114">
<p class="calibre3">0.25</p>
</td>
</tr>
<tr class="calibre113">
<td class="calibre114">
<p class="calibre3">Shield</p>
</td>
<td class="calibre114">
<p class="calibre3">SL01</p>
</td>
<td class="calibre114">
<p class="calibre3">Iron Shield</p>
</td>
<td class="calibre114">
<p class="calibre3">Armor</p>
</td>
<td class="calibre114">
<p class="calibre3">0.3</p>
</td>
<td class="calibre114">
<p class="calibre3">0.3</p>
</td>
</tr>
<tr class="calibre113">
<td class="calibre114"/>
<td class="calibre114">
<p class="calibre3">SL02</p>
</td>
<td class="calibre114">
<p class="calibre3">Wooden Shield</p>
</td>
<td class="calibre114">
<p class="calibre3">Armor</p>
</td>
<td class="calibre114">
<p class="calibre3">0.2</p>
</td>
<td class="calibre114">
<p class="calibre3">0.2</p>
</td>
</tr>
<tr class="calibre113">
<td class="calibre114">
<p class="calibre3">Shoulder Pads</p>
</td>
<td class="calibre114">
<p class="calibre3">SP01</p>
</td>
<td class="calibre114">
<p class="calibre3">Shoulder Pad 01</p>
</td>
<td class="calibre114">
<p class="calibre3">Armor</p>
</td>
<td class="calibre114">
<p class="calibre3">0.1</p>
</td>
<td class="calibre114">
<p class="calibre3">0.2</p>
</td>
</tr>
<tr class="calibre113">
<td class="calibre114"/>
<td class="calibre114">
<p class="calibre3">SP02</p>
</td>
<td class="calibre114">
<p class="calibre3">Shoulder Pad 02</p>
</td>
<td class="calibre114">
<p class="calibre3">Armor</p>
</td>
<td class="calibre114">
<p class="calibre3">0.1</p>
</td>
<td class="calibre114">
<p class="calibre3">0.2</p>
</td>
</tr>
<tr class="calibre113">
<td class="calibre114"/>
<td class="calibre114">
<p class="calibre3">SP03</p>
</td>
<td class="calibre114">
<p class="calibre3">Shoulder Pad 03</p>
</td>
<td class="calibre114">
<p class="calibre3">Armor</p>
</td>
<td class="calibre114">
<p class="calibre3">0.15</p>
</td>
<td class="calibre114">
<p class="calibre3">0.25</p>
</td>
</tr>
<tr class="calibre113">
<td class="calibre114"/>
<td class="calibre114">
<p class="calibre3">SP04</p>
</td>
<td class="calibre114">
<p class="calibre3">Shoulder Pad 04</p>
</td>
<td class="calibre114">
<p class="calibre3">Armor</p>
</td>
<td class="calibre114">
<p class="calibre3">0.2</p>
</td>
<td class="calibre114">
<p class="calibre3">0.25</p>
</td>
</tr>
<tr class="calibre113">
<td class="calibre114">
<p class="calibre3">Weapons</p>
</td>
<td class="calibre114">
<p class="calibre3">Axe1</p>
</td>
<td class="calibre114">
<p class="calibre3">Single Head</p>
</td>
<td class="calibre114">
<p class="calibre3">Weapon</p>
</td>
<td class="calibre114">
<p class="calibre3">0.2</p>
</td>
<td class="calibre114">
<p class="calibre3">0.1</p>
</td>
</tr>
<tr class="calibre113">
<td class="calibre114"/>
<td class="calibre114">
<p class="calibre3">Axe2</p>
</td>
<td class="calibre114">
<p class="calibre3">Double Head</p>
</td>
<td class="calibre114">
<p class="calibre3">Weapon</p>
</td>
<td class="calibre114">
<p class="calibre3">0.25</p>
</td>
<td class="calibre114">
<p class="calibre3">0.2</p>
</td>
</tr>
<tr class="calibre113">
<td class="calibre114"/>
<td class="calibre114">
<p class="calibre3">Club1</p>
</td>
<td class="calibre114">
<p class="calibre3">Wooden Club</p>
</td>
<td class="calibre114">
<p class="calibre3">Weapon</p>
</td>
<td class="calibre114">
<p class="calibre3">0.2</p>
</td>
<td class="calibre114">
<p class="calibre3">0.1</p>
</td>
</tr>
</tbody>
</table>
<p class="calibre3"> </p>
<p class="calibre3">Again, the data is arbitrary: you decide what best suits your game and game design. Usually, you will have a table that would be loaded with such information, and your game manager will handle preloading it at runtime from the server.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Designing an inventory interface</h1>
                
            
            <article>
                
<p class="calibre3">It is now time to think about how we are going to visualize the inventory during game play. Creating a user interface for any game is a challenging task. You need to have a balanced approach about the amount of information you want to display on the screen at playtime, without interfering with the game play. In the meantime, you want to make sure that the player has the most crucial and important information necessary to complete their mission to hand.</p>
<p class="calibre3"/>
<p class="calibre3">With that said, let's look at how we can design a simple user interface to enable the player with the basics of interacting with the inventory system. Here is a list of minimum features that the player should be able to perform:</p>
<ul class="calibre11">
<li class="calibre12">Display the inventory at any time during game play</li>
<li class="calibre12">Navigate based on category</li>
<li class="calibre12">See what items are listed under each category</li>
<li class="calibre12">Be able to remove an item from the inventory</li>
<li class="calibre12">Be able to consume an item from the inventory</li>
<li class="calibre12">See what inventory items are already in use by the player</li>
</ul>
<p class="calibre3">The preceding list will give us a good start for implementing our inventory interface. Let's start by identifying the categories that will need to be displayed. The categories are defined as an <strong class="calibre5">enum</strong> named <kbd class="calibre13">ItemCategory</kbd> in the <kbd class="calibre13">BaseItem</kbd> class.</p>
<p class="calibre3">We have the following: weapons, armor, clothing, health, and potion. Take a look at the following screenshot:</p>
<div class="mce-root1"><img src="../images/00122.jpeg" class="calibre115"/></div>
<p class="calibre3">The preceding screenshot shows a concept I am leaning towards for the implementation of the inventory interface. The interface can be constructed by utilizing the following UI elements:</p>
<ul class="calibre11">
<li class="calibre12">Buttons</li>
<li class="calibre12">Panels</li>
<li class="calibre12">Text</li>
<li class="calibre12">Images</li>
</ul>
<p class="calibre3">Each category will have a button, and there will be one main panel containing the list of items per category, as illustrated in the preceding diagram. Each item will be contained in its own panel, which will contain an image of the inventory item, the item description, and two buttons that can be used to add or remove the item from the inventory system.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Creating the inventory UI framework</h1>
                
            
            <article>
                
<p class="calibre3">Let's start by first implementing the initial framework for our inventory system graphical interface. In the main scene of your project, go ahead and create a new <em class="calibre14">Canvas</em> GameObject if you have not done so already.</p>
<p class="calibre3">To do so, right-click on the <span class="calibre6">Hierarchy</span> <em class="calibre14">Window,</em> and select <span class="calibre6">UI | Panel</span>. This will automatically create a <span class="calibre6">Canvas</span> GameObject and a Panel UI Element as a child to the canvas.</p>
<p class="calibre3">Rename this panel <span class="calibre6">PanelInventory</span>. This will be the main panel that will contain everything else. Now, let's go ahead and start building the buttons that will represent our main categories.</p>
<p class="calibre3">Similarly, right-click on the <span class="calibre6">PanelInventory</span> GameObject and select <span class="calibre6">UI | Button</span>. This will make sure that the newly created button becomes a child of the <span class="calibre6">PanelInventory</span>. If, for whatever reason, this is not the case in the <span class="calibre6">Hierarchy Window</span> after the creation of the button(s), simply drag the newly created button(s) under the <span class="calibre6">PanelInventory</span> panel. Do this for all five categories. Rename the buttons appropriately, such as <span class="calibre6">butWeaponsCategory</span> and so on.</p>
<p class="calibre3">Change the caption of the button so that it reflects the button's function. Also, rename the <span class="calibre6">Text</span> element to something like the following: <span class="calibre6">txtWeaponsCategory</span> and so on. Take a look at the following screenshot:</p>
<div class="mce-root1"><img src="../images/00123.jpeg" class="calibre45"/></div>
<div class="mce-root2">Inventory UI</div>
<p class="calibre3">Finally, add a new <span class="calibre6">Panel</span> element to the <span class="calibre6">PanelInventory</span> again, by selecting the <span class="calibre6">PanelInventory</span> GameObject and right-clicking and selecting <span class="calibre6">UI | Panel</span>. Rename the newly created panel to <span class="calibre6">PanelCategory</span>. Take a look at the following screenshot:</p>
<div class="mce-root1"><img src="../images/00124.jpeg" class="calibre116"/></div>
<p class="calibre3">Your inventory user interface should look something like the preceding screenshot. Before we get more involved, let's go ahead and hook up some of the basics for showing and hiding the inventory interface for the player. To do this, we will need to modify the <kbd class="calibre13">UiController.cs</kbd><em class="calibre14">,</em> <kbd class="calibre13">GameLevelController.cs</kbd>, and also the <kbd class="calibre13">GameMaster.cs</kbd> scripts.</p>
<p class="calibre3">I will not be listing the whole source file as we will do this later on in the chapter. The changes for each script for now are as follows:</p>
<ul class="calibre11">
<li class="calibre12"><kbd class="calibre13">UiController.cs</kbd>: Added a new function named <kbd class="calibre13">DisplayInventory()</kbd> and a new variable to reference the inventory canvas named <kbd class="calibre13">InventoryCanvas</kbd>. See the following code:</li>
</ul>
<pre class="calibre18">      public void DisplayInventory() 
      { 
         InventoryCanvas.gameObject.SetActive(GameMaster.instance.DisplayInventory); 
         Debug.Log("Display Inventory Function"); 
      } </pre>
<ul class="calibre11">
<li class="calibre12"><kbd class="calibre13">GameLevelController.cs</kbd>: Updated the <kbd class="calibre13">OnlevelWasLoaded()</kbd> function to assign the <kbd class="calibre13">uiController</kbd> GameObject to the <kbd class="calibre13">GameMaster</kbd> instance, if one is present. See the following code:</li>
</ul>
<pre class="calibre18">         if (GameObject.FindGameObjectWithTag("Ui")) 
         { 
            GameMaster.instance.Ui  
               = GameObject.FindGameObjectWithTag("Ui").GetComponent&lt;UiController&gt;(); 
         } </pre>
<ul class="calibre11">
<li class="calibre12"><kbd class="calibre13">GameMaster.cs</kbd>: Modified the <kbd class="calibre13">Update()</kbd> function to check and see if the J key was pressed and released. This in turn toggled a Boolean variable to see if we are supposed to show or hide the inventory interface. See the following code:</li>
</ul>
<pre class="calibre18">void Update()<br class="title-page-name"/>{<br class="title-page-name"/>if (instance.LevelController.CurrentScene.name != SceneName.MainMenu)<br class="title-page-name"/>{<br class="title-page-name"/>if (Input.GetKeyUp(KeyCode.I))<br class="title-page-name"/>{<br class="title-page-name"/>instance.DisplayInventory = !DisplayInventory;<br class="title-page-name"/>instance.Ui.DisplayInventory();<br class="title-page-name"/>}<br class="title-page-name"/>}<br class="title-page-name"/>}</pre>
<p class="calibre3">If you test your scene from the main menu, you will be able to test out the interface and toggle it on and off.</p>
<div class="packt_tip">Don't forget that you will need to disable the Canvas for the inventory system during design time, or at runtime when the game loads initially.</div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Designing a dynamic item viewer</h1>
                
            
            <article>
                
<p class="calibre3">The next challenge for us is to create a method to dynamically populate the inventory items and displaying them properly on the user interface. We are going to use two new UI elements that we have not used before. We will be using a s<em class="calibre14">croll view</em> to give us the ability to scroll through the items when needed.</p>
<p class="calibre3"/>
<p class="calibre3">Let's first get the scroll view set up and look at how to add a simple UI prefab to the scroll view. Once this is done, we can go ahead and enhance the UI prefab to handle what we have outlined in the previous section.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Adding a scroll view</h1>
                
            
            <article>
                
<p class="calibre3">The next few screenshots will illustrate how to add a scroll view functionality to your user interface:</p>
<div class="mce-root1"><img src="../images/00125.jpeg" class="calibre45"/></div>
<div class="mce-root2">Adding a scroll view</div>
<p class="calibre3"/>
<p class="calibre3">Go to the scene where you have created your Inventory UI, and select the <em class="calibre14">PanelCategory</em> in the <em class="calibre14">Canvas</em>. Right-click and select <em class="calibre14">UI | Scroll View</em> to add a scroll view UI element. Take a look at the following screenshot:</p>
<div class="mce-root1"><img src="../images/00126.jpeg" class="calibre45"/></div>
<div class="mce-root2"><span>Adding Scroll View</span></div>
<p class="calibre3">You should now have a scroll view UI element with associated children under your <em class="calibre14">PanelCategory</em> panel. The children will be <em class="calibre14">Viewport</em>, <em class="calibre14">Scrollbar Horizontal</em>, and <em class="calibre14">Scrollbar Vertical</em>.</p>
<div class="packt_infobox">Make your adjustment to the scroll view UI element before you delete the children.</div>
<p class="calibre3"/>
<p class="calibre3">We are going to make some modifications to the default scroll view. Go ahead and delete the following from <em class="calibre14">Scroll View:</em> the <em class="calibre14">Scrollbar Horizontal</em>, <em class="calibre14">Scrollbar Vertical</em>, and the <em class="calibre14">Viewport</em> child elements. After you are done, your screen should look something like the preceding screenshot. Now take a look at the following screenshot:</p>
<div class="mce-root1"><img src="../images/00127.jpeg" class="calibre45"/></div>
<div class="mce-root2">Layout adjustment</div>
<p class="calibre3">Next, we need to add a <span class="calibre6">Panel</span> element as a child to our <span class="calibre6">Scroll View</span>. Go ahead and select the scroll view, right-click, and select <span class="calibre6">UI | Panel</span>. Rename the newly added panel <span class="calibre6">PanelItem</span>. We need to add two layout components to our <span class="calibre6">PanelItem</span>. To do this, select <span class="calibre6">PanelItem</span>, and from the <span class="calibre6">Inspector Window</span> select <span class="calibre6">Add Component | Layout | Vertical Layout Group</span>, and once more select <span class="calibre6">Add Component | Layout | Content Size Filter</span>. Take a look at the following screenshot:</p>
<p class="calibre3"/>
<p class="calibre3"/>
<p class="calibre3"/>
<div class="mce-root1"><img src="../images/00128.jpeg" class="calibre45"/></div>
<div class="mce-root2">Layout adjustment</div>
<p class="calibre3">Go ahead and modify the following attributes under the <span class="calibre6">Vertical Layout Group</span> components. Set the <span class="calibre6">Left</span>, <span class="calibre6">Right</span>, <span class="calibre6">Top</span>, and <span class="calibre6">Bottom Padding</span> to <span class="calibre6">3</span>. Set the <span class="calibre6">Spacing</span> to <span class="calibre6">0</span>, change the <span class="calibre6">Child Alignment</span> to <span class="calibre6">Upper Left</span>, and set the <span class="calibre6">Child Force Expand</span> to <span class="calibre6">True</span> for both <span class="calibre6">Width</span> and <span class="calibre6">Height</span>.</p>
<p class="calibre3">For the <span class="calibre6">Content Size Filter</span> component, set the <span class="calibre6">Horizontal Fit</span> to <span class="calibre6">Unconstrained</span> and the <span class="calibre6">Vertical Fit</span> to <span class="calibre6">Min Size</span>.</p>
<p class="calibre3">Finally, in the <span class="calibre6">Rect Transform</span> component, change the <span class="calibre6">Anchor Point</span> to <span class="calibre6">Top Center</span>, and modify the <span class="calibre6">Pos Y</span> to <span class="calibre6">-10</span>.</p>
<p class="calibre3">At this point we have the basic framework in place. The next step it to populate our newly created <span class="calibre6">Scroll</span><span class="calibre6">View</span>!</p>
<p class="calibre3"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Adding elements to PanelItem and Scroll View</h1>
                
            
            <article>
                
<p class="calibre3">For starters, let's go ahead and add a <em class="calibre14">Text</em> element under the <kbd class="calibre13">PanelItem</kbd> panel. Again select the <kbd class="calibre13">PanelItem</kbd> element and right-click and select <span class="calibre6">UI</span> | <span class="calibre6">Text.</span> Next select the text element and rename it to <kbd class="calibre13">txtItemElement</kbd>. We need to add a new component to the <span class="calibre6">Text</span> element, from the <span class="calibre6">Inspector Window</span> go ahead and select <span class="calibre6">Add Component</span> | <span class="calibre6">Layout</span> | <span class="calibre6">Layout Element</span>.</p>
<p class="calibre3">Modify the <span class="calibre6">Min Height</span> attribute of the <span class="calibre6">Layout Element</span> component to <span class="calibre6">20</span>. Take a look at the following screenshot:</p>
<div class="mce-root1"><img src="../images/00129.jpeg" class="calibre45"/></div>
<div class="mce-root2">Modification</div>
<p class="calibre3"/>
<p class="calibre3">The preceding screenshot illustrates the setup of the <kbd class="calibre13">InventoryItem</kbd> element and UI. Now take a look at the following screenshot:</p>
<div class="mce-root1"><img src="../images/00130.jpeg" class="calibre45"/></div>
<div class="mce-root2">Adding an inventory item</div>
<p class="calibre3">We need a means to access and modify the <span class="calibre6">Text</span> attribute of the new <kbd class="calibre13">Text</kbd> UI element. In order to do this, we need to create a new script called <span class="calibre6">InventoryItemUI.cs</span>. The code will just have a public variable that will reference the <kbd class="calibre13">Text</kbd> element. The listing is as follows:</p>
<pre class="calibre18">using UnityEngine;<br class="title-page-name"/>using UnityEngine.UI;<br class="title-page-name"/>namespace com.noorcon.rpg2e<br class="title-page-name"/>{<br class="title-page-name"/>    public class InventoryItemUi : MonoBehaviour<br class="title-page-name"/>    {<br class="title-page-name"/>        public Text txtItemElement;<br class="title-page-name"/>    }<br class="title-page-name"/>}</pre>
<p class="calibre3"/>
<p class="calibre3"/>
<p class="calibre3"/>
<p class="calibre3"/>
<p class="calibre3"/>
<p class="calibre3"/>
<p class="calibre3">Finally, drag and drop the <kbd class="calibre13">Text</kbd> element from the hierarchy window into the <span class="calibre6">TextItemElement</span> attribute of the <span class="calibre6">Invento</span><span class="calibre6">ryItemUI</span> component attached to the <span class="calibre6">txtItemElement</span> object. Refer to the preceding screenshot.</p>
<div class="packt_tip">The script is used to self-reference. We will use it to modify the text component of the <kbd class="calibre85">Text</kbd> UI element.</div>
<p class="calibre3">Now we will need to create a <span class="calibre6">Prefab</span> of the <span class="calibre6">txtItemElement</span> by dragging and dropping it into a designated folder. I have created a new folder under my <span class="calibre6">Prefabs</span> folder named it <em class="calibre14">UI</em> and have created the prefab in that folder. Refer to the preceding screenshot.</p>
<p class="calibre3">You can now delete the <span class="calibre6">txtItemElement</span> from the <span class="calibre6">Hierarchy Window</span> under the <span class="calibre6">PanelItem</span> object. We will be adding them dynamically during runtime.</p>
<p class="calibre3">There is one last configuration you will need to do before we move forward. You will need to add a <kbd class="calibre13">Mask</kbd> component to the <kbd class="calibre13">ScrollView</kbd> UI element. Select the <span class="calibre6">Scroll View</span> from the <span class="calibre6">Hierarchy Window</span>, and from the <span class="calibre6">Inspector Window</span> select <span class="calibre6">Add Component | UI | Mask</span>. After the addition of the <span class="calibre6">Mask</span> component, make sure that the <span class="calibre6">Show Mask Graphics</span> attribute is <em class="calibre14">unchecked</em>.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Adding txtItemElement dynamically</h1>
                
            
            <article>
                
<p class="calibre3">Now it is time to add our inventory item placeholder dynamically to the <kbd class="calibre13">PanelItem</kbd> UI element. To do so, we will use the <kbd class="calibre13">UiController.cs</kbd> script. Go ahead and open up the script and add the following variable to the class:</p>
<pre class="calibre18">public Transform InventoryPanelItem<br class="title-page-name"/>public GameObject InventoryItemElement;</pre>
<p class="calibre3">In the designer, you will need to assign the <kbd class="calibre13">PanelItem</kbd> UI element from the <em class="calibre14">Canvas</em> GameObject and the <kbd class="calibre13">txtItemElement</kbd> prefab from the prefab folder.</p>
<p class="calibre3">Next, we are going to modify the <kbd class="calibre13">Update()</kbd> function so that when we press the <span class="calibre6">H</span> key on the keyboard, it will go ahead and instantiate a new <kbd class="calibre13">InventoryItemElement</kbd> and make it a child element of the <kbd class="calibre13">PanelItem</kbd> object.</p>
<p class="calibre3">The listing of the code is as follows:</p>
<pre class="calibre18">public void Update()<br class="title-page-name"/>{<br class="title-page-name"/>if (Input.GetKeyUp(KeyCode.H))<br class="title-page-name"/>{<br class="title-page-name"/>GameObject newButton<br class="title-page-name"/>= Instantiate(InventoryItemElement) as GameObject;<br class="title-page-name"/>InventoryItemUi txtItem<br class="title-page-name"/>= newButton.GetComponent&lt;InventoryItemUi&gt;();<br class="title-page-name"/>txtItem.txtItemElement.text<br class="title-page-name"/>= string.Format("New Item {0}", Time.time);<br class="title-page-name"/>newButton.transform.SetParent(InventoryPanelItem);<br class="title-page-name"/>}<br class="title-page-name"/>}</pre>
<p class="calibre3">The preceding code listing simply instantiates the prefab and makes it a child of the <kbd class="calibre13">PanelItem</kbd> element. We are also changing the caption of the element and placing it with a timestamp to see the uniqueness of each UI element.</p>
<p class="calibre3">The outcome is shown in the following screenshot:</p>
<div class="mce-root1"><img src="../images/00131.jpeg" class="calibre45"/></div>
<div class="mce-root2">Inventory view</div>
<p class="calibre3">At this point, we have put together the main elements to have our inventory interface list items dynamically and be able to scroll through them.</p>
<p class="calibre3"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Building the final inventory item UI</h1>
                
            
            <article>
                
<p class="calibre3">To create the actual <span class="calibre6">Inventory Item</span> user interface, we are going to need to use several UI elements. We will need a panel to be the container of the item. Within the <em class="calibre14">Panel</em>, we are going to need to use an <em class="calibre14">Image</em>, a <em class="calibre14">Text</em>, and two <em class="calibre14">Button</em> UI elements.</p>
<div class="packt_tip">Note: I will not be going through the steps of how to put the panel together. You should know how to create user interfaces by now.<br class="calibre47"/>
<br class="calibre47"/>
Just make sure that you add the <em class="calibre30">Layout Element</em> component and <em class="calibre30">Inventory Item UI</em> script to the panel that will be the base for the inventory item.</div>
<div class="mce-root1"><img src="../images/00132.jpeg" class="calibre45"/></div>
<div class="mce-root2">Panel containing inventory item UI elements</div>
<p class="calibre3"/>
<p class="calibre3">The following figure illustrates the UI component that has been developed for displaying the inventory item. Since the UI component has been modified, we also have to update the <kbd class="calibre13">InventoryItemUI.cs</kbd> script to contain a reference to all of the new UI elements in the <em class="calibre14">Panel</em>.</p>
<p class="calibre3">The listing of the new <kbd class="calibre13">InventoryItemUi.cs</kbd> is as follows:</p>
<pre class="calibre18">using UnityEngine;<br class="title-page-name"/>using UnityEngine.UI;<br class="title-page-name"/>namespace com.noorcon.rpg2e<br class="title-page-name"/>{<br class="title-page-name"/>public class InventoryItemUi : MonoBehaviour<br class="title-page-name"/>{<br class="title-page-name"/>public Image ItemElementImage;<br class="title-page-name"/>public Text ItemElementText;<br class="title-page-name"/>public Button AddButton;<br class="title-page-name"/>public Button DeleteButton;<br class="title-page-name"/>}<br class="title-page-name"/>}</pre>
<p class="calibre3">We also need to update the <kbd class="calibre13">UiController.cs</kbd> script to handle the new prefab accordingly.</p>
<p class="calibre3">The listing for the new UI prefab in <kbd class="calibre13">UiController.cs</kbd> is as follows:</p>
<pre class="calibre18">public void Update()<br class="title-page-name"/>{<br class="title-page-name"/>if (Input.GetKeyUp(KeyCode.H))<br class="title-page-name"/>{<br class="title-page-name"/>GameObject newItem<br class="title-page-name"/>= Instantiate(InventoryItemElement) as GameObject;<br class="title-page-name"/>InventoryItemUi txtItem<br class="title-page-name"/>= newItem.GetComponent&lt;InventoryItemUi&gt;();<br class="title-page-name"/>txtItem.ItemElementText.text<br class="title-page-name"/>= string.Format("Adding New Item {0}", Time.time);<br class="title-page-name"/>// button triggers<br class="title-page-name"/>txtItem.AddButton.GetComponent&lt;Button&gt;().onClick.AddListener(() =&gt; {<br class="title-page-name"/>Debug.Log(string.Format("You have clicked ADD Button for {0}",<br class="title-page-name"/>txtItem.ItemElementText.text));<br class="title-page-name"/>});<br class="title-page-name"/>txtItem.DeleteButton.GetComponent&lt;Button&gt;().onClick.AddListener(() =&gt;<br class="title-page-name"/>{<br class="title-page-name"/>Debug.Log(string.Format("You have clicked DELETE Button for {0}",<br class="title-page-name"/>txtItem.ItemElementText.text));<br class="title-page-name"/>Destroy(newItem);<br class="title-page-name"/>});</pre>
<p class="calibre3"/>
<pre class="calibre18">newItem.transform.SetParent(InventoryPanelItem);<br class="title-page-name"/>}<br class="title-page-name"/>}</pre>
<p class="calibre3">In the preceding listing , the main concept I want to point out is the implementation of the <kbd class="calibre13">onClick()</kbd> event handler for the buttons within the prefab.</p>
<p class="calibre3">Since we are dynamically generating our UI, and hence the buttons, we need to be able to trigger the <kbd class="calibre13">onClick()</kbd> function somehow; this is done by adding a listener, as shown in the code.</p>
<p class="calibre3">For now, when you click the <span class="calibre6">AddButton</span> button, you will get an output on the <span class="calibre6">Console Window</span> with the appropriate caption. When you click the <span class="calibre6">DeleteButton</span> button, you will get another output on the <span class="calibre6">Console Window</span>, with the appropriate caption. Then the item will be destroyed, that is, removed from the inventory.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Integrating the UI with the actual inventory system</h1>
                
            
            <article>
                
<p class="calibre3">We have seen and implemented the concepts necessary to make our inventory system UI work properly. Now it is time to actually fill the user interface with the actual data that is stored in <kbd class="calibre13">GameMaster</kbd>.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Hooking the category buttons and displaying the data</h1>
                
            
            <article>
                
<p class="calibre3">Using the <kbd class="calibre13">UiController.cs</kbd> script, we are going to create five new methods that will handle the proper visualization of our inventory system. We are going to add the following five functions:</p>
<ul class="calibre11">
<li class="calibre12"><kbd class="calibre13">DisplayWeaponsCategory()</kbd></li>
<li class="calibre12"><kbd class="calibre13">DisplayArmourCategory()</kbd></li>
<li class="calibre12"><kbd class="calibre13">DisplayClothingCategory()</kbd></li>
<li class="calibre12"><kbd class="calibre13">DisplayHealthCategory()</kbd></li>
<li class="calibre12"><kbd class="calibre13">DisplayPotionsCategory()</kbd></li>
</ul>
<p class="calibre3"/>
<p class="calibre3">We also need to clear the existing inventory items from the panel when the user switches from one category to the next. This will require a private function named <kbd class="calibre13">ClearInventoryItemPanel()</kbd>, which will just do that.</p>
<p class="calibre3">The listing for the new <kbd class="calibre13">UiController.cs</kbd> script is as follows:</p>
<pre class="calibre18">using UnityEngine;<br class="title-page-name"/>using UnityEngine.UI;<br class="title-page-name"/>namespace com.noorcon.rpg2e<br class="title-page-name"/>{<br class="title-page-name"/>public class UiController : MonoBehaviour<br class="title-page-name"/>{<br class="title-page-name"/>[Header("Settings Window")]<br class="title-page-name"/>public RectTransform OptionsPanel;<br class="title-page-name"/>public Slider ControlMainVolume;<br class="title-page-name"/>public Slider ControlFXVolume;<br class="title-page-name"/>[Header("Inventory Window")]<br class="title-page-name"/>public RectTransform InventoryCanvas;<br class="title-page-name"/>[Tooltip("root for inventory items")]<br class="title-page-name"/>public Transform InventoryPanelItem;<br class="title-page-name"/>[Tooltip("prefab representing invenotry item UI")]<br class="title-page-name"/>public GameObject InventoryItemElement;<br class="title-page-name"/>public void Update()<br class="title-page-name"/>{<br class="title-page-name"/>if (Input.GetKeyUp(KeyCode.H))<br class="title-page-name"/>{<br class="title-page-name"/>GameObject newItem<br class="title-page-name"/>= Instantiate(InventoryItemElement) as GameObject;<br class="title-page-name"/>InventoryItemUi txtItem<br class="title-page-name"/>= newItem.GetComponent&lt;InventoryItemUi&gt;();<br class="title-page-name"/>txtItem.ItemElementText.text<br class="title-page-name"/>= string.Format("Adding New Item {0}", Time.time);<br class="title-page-name"/>// button triggers<br class="title-page-name"/>txtItem.AddButton.GetComponent&lt;Button&gt;().onClick.AddListener(() =&gt; {<br class="title-page-name"/>Debug.Log(string.Format("You have clicked ADD Button for {0}",<br class="title-page-name"/>txtItem.ItemElementText.text));<br class="title-page-name"/>});<br class="title-page-name"/>txtItem.DeleteButton.GetComponent&lt;Button&gt;().onClick.AddListener(() =&gt;<br class="title-page-name"/>{<br class="title-page-name"/>Debug.Log(string.Format("You have clicked DELETE Button for {0}",<br class="title-page-name"/>txtItem.ItemElementText.text));<br class="title-page-name"/>Destroy(newItem);<br class="title-page-name"/>});<br class="title-page-name"/>newItem.transform.SetParent(InventoryPanelItem);<br class="title-page-name"/>}<br class="title-page-name"/>}<br class="title-page-name"/>public void DisplaySettings()<br class="title-page-name"/>{<br class="title-page-name"/>GameMaster.instance.DisplaySettings = !GameMaster.instance.DisplaySettings;<br class="title-page-name"/>OptionsPanel.gameObject.SetActive(GameMaster.instance.DisplaySettings);<br class="title-page-name"/>}<br class="title-page-name"/>public void MainVolume()<br class="title-page-name"/>{<br class="title-page-name"/>GameMaster.instance.MasterVolume(ControlMainVolume.vale);<br class="title-page-name"/>}<br class="title-page-name"/>public void FXVolume()<br class="title-page-name"/>{<br class="title-page-name"/>GameMaster.instance.SoundFxVolume(ControlFXVolume.value);<br class="title-page-name"/>}<br class="title-page-name"/>#region INVENTORY UI FUNCTIONS<br class="title-page-name"/>public void DisplayInventory()<br class="title-page-name"/>{<br class="title-page-name"/>InventoryCanvas.gameObject.SetActive(GameMaster.instan<br class="title-page-name"/>e.DisplayInventory);<br class="title-page-name"/>Debug.Log("Display Inventory Function");<br class="title-page-name"/>}<br class="title-page-name"/>public void DisplayWeaponsCategory()<br class="title-page-name"/>{<br class="title-page-name"/>if (GameMaster.instance.DisplayInventory)<br class="title-page-name"/>{<br class="title-page-name"/>ClearInventoryPanelItems();<br class="title-page-name"/>foreach (InventoryItem item in GameMaster.instance.Inventory.Weapons)<br class="title-page-name"/>{<br class="title-page-name"/>GameObject newItem<br class="title-page-name"/>= Instantiate(InventoryItemElement) as GameObject;<br class="title-page-name"/>InventoryItemUI txtItem<br class="title-page-name"/>= newItem.GetComponent&lt;InventoryItemUI&gt;();<br class="title-page-name"/>txtItem.txtItemElement.text =<br class="title-page-name"/>string.Format("Name: {0}, Description: {1}, Strength: {2}, Weight: {3}",<br class="title-page-name"/>item.Name,<br class="title-page-name"/>item.Description,<br class="title-page-name"/>item.Strength,<br class="title-page-name"/>item.Weight);<br class="title-page-name"/><a href="https://github.com/PacktPublishing/Building-an-RPG-with-Unity-2018-Second-Edition" class="calibre83">...</a></pre>
<p class="calibre3">We also had to some modifications to the <kbd class="calibre13">InventorySystem.cs</kbd> script to make it possible for us to access properties storing the data more easily.</p>
<p class="calibre3">The new listing of the script is as follows:</p>
<pre class="calibre18">using System;<br class="title-page-name"/>using System.Collections.Generic;<br class="title-page-name"/>using UnityEngine;<br class="title-page-name"/>namespace com.noorcon.rpg2e<br class="title-page-name"/>{<br class="title-page-name"/>[Serializable]<br class="title-page-name"/>public class InventorySystem<br class="title-page-name"/>{<br class="title-page-name"/>[SerializeField]<br class="title-page-name"/>private List&lt;InventoryItem&gt; weapons = new List&lt;InventoryItem&gt;();<br class="title-page-name"/>[SerializeField]<br class="title-page-name"/>private List&lt;InventoryItem&gt; armour = new List&lt;InventoryItem&gt;();<br class="title-page-name"/>[SerializeField]<br class="title-page-name"/>private List&lt;InventoryItem&gt; clothing = new List&lt;InventoryItem&gt;();<br class="title-page-name"/>[SerializeField]<br class="title-page-name"/>private List&lt;InventoryItem&gt; health = new List&lt;InventoryItem&gt;();<br class="title-page-name"/>[SerializeField]<br class="title-page-name"/>private List&lt;InventoryItem&gt; potion = new List&lt;InventoryItem&gt;();<br class="title-page-name"/>public List&lt;InventoryItem&gt; Weapons<br class="title-page-name"/>{<br class="title-page-name"/>get { return weapons; }<br class="title-page-name"/>}<br class="title-page-name"/>public List&lt;InventoryItem&gt; Armour<br class="title-page-name"/>{<br class="title-page-name"/>get { return armour; }<br class="title-page-name"/>}<br class="title-page-name"/>public List&lt;InventoryItem&gt; Clothing<br class="title-page-name"/>{<br class="title-page-name"/>get { return clothing; }<br class="title-page-name"/>}<br class="title-page-name"/>public List&lt;InventoryItem&gt; Health<br class="title-page-name"/>{<br class="title-page-name"/>get { return health; }<br class="title-page-name"/>}<br class="title-page-name"/>public List&lt;InventoryItem&gt; Potion<br class="title-page-name"/>{<br class="title-page-name"/>get { return potion; }<br class="title-page-name"/>}<br class="title-page-name"/>private InventoryItem selectedWeapon;<br class="title-page-name"/>private InventoryItem selectedArmour;<br class="title-page-name"/>public InventoryItem SelectedWeapon<br class="title-page-name"/>{<br class="title-page-name"/>get { return selectedWeapon; }<br class="title-page-name"/>set { selectedWeapon = value; }<br class="title-page-name"/>}<br class="title-page-name"/>public InventoryItem SelectedArmour<br class="title-page-name"/>{<br class="title-page-name"/>get { return selectedArmour; }<br class="title-page-name"/>set { selectedArmour = value; }<br class="title-page-name"/>}<br class="title-page-name"/>public InventorySystem()<br class="title-page-name"/>{<br class="title-page-name"/>ClearInventory();<br class="title-page-name"/>}<br class="title-page-name"/>public void ClearInventory()<br class="title-page-name"/>{<br class="title-page-name"/>weapons.Clear();<br class="title-page-name"/>armour.Clear();<br class="title-page-name"/>clothing.Clear();<br class="title-page-name"/>health.Clear();<br class="title-page-name"/>potion.Clear();<br class="title-page-name"/>}<br class="title-page-name"/>// this function will add an inventory item<br class="title-page-name"/>public void AddItem(InventoryItem item)<br class="title-page-name"/>{<br class="title-page-name"/>switch (item.Category)<br class="title-page-name"/>{<br class="title-page-name"/>case BaseItem.ItemCatrgory.Armour:<br class="title-page-name"/>{<br class="title-page-name"/>armour.Add(item);<br class="title-page-name"/>break;<br class="title-page-name"/>}<br class="title-page-name"/>case BaseItem.ItemCatrgory.Clothing:<br class="title-page-name"/>{<br class="title-page-name"/>clothing.Add(item);<br class="title-page-name"/>break;<br class="title-page-name"/>}<br class="title-page-name"/>case BaseItem.ItemCatrgory.Health:<br class="title-page-name"/>{<br class="title-page-name"/>health.Add(item);<br class="title-page-name"/>break;<br class="title-page-name"/>}<br class="title-page-name"/>case BaseItem.ItemCatrgory.Potion:<br class="title-page-name"/><a href="https://github.com/PacktPublishing/Building-an-RPG-with-Unity-2018-Second-Edition" class="calibre83">...</a></pre>
<p class="calibre3">Notice that I have removed the code from the <kbd class="calibre13">Update()</kbd> function in the <kbd class="calibre13">UiController.cs</kbd> script as it was only for testing purposes.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Testing the inventory system</h1>
                
            
            <article>
                
<p class="calibre3">For testing purposes, I have placed a number of the inventory item prefabs created earlier in this chapter. Take a look at the following screenshot:</p>
<div class="mce-root1"><img src="../images/00133.jpeg" class="calibre45"/></div>
<div class="mce-root2">Inventory items to be collected</div>
<p class="calibre3">Start the game from the main menu and go through the character customization scene to save the character player and start the game. Once you are in the playable scene, go ahead and collect a few of the items that have been placed throughout the scene. Take a look at the following screenshot:</p>
<div class="mce-root1"><img src="../images/00134.jpeg" class="calibre45"/></div>
<div class="mce-root2">Item inserted into inventory - 1</div>
<p class="calibre3">Notice in the following screenshot that I have selected the <kbd class="calibre13">_GameMaster</kbd> GameObject to display the <span class="calibre6">Inventory</span> data in the <span class="calibre6">Inspector Window</span>:</p>
<div class="mce-root1"><img src="../images/00135.jpeg" class="calibre45"/></div>
<div class="mce-root2"><span>Item inserted into inventory - 2</span></div>
<p class="calibre3"/>
<p class="calibre3">We have picked up two weapon types and two armor types. The weapons items we have picked up are: <span class="calibre6">Axe 2</span>. The armor items we have picked up are: <span class="calibre6">Leg Plate</span>, <span class="calibre6">SP1</span>, <span class="calibre6">Knee Pad</span>, and <span class="calibre6">SP3</span>, as indicated in the <span class="calibre6">Inspector Window</span>. Take a look at the following screenshot:</p>
<div class="mce-root1"><img src="../images/00136.jpeg" class="calibre45"/></div>
<div class="mce-root2"><span>Item inserted into inventory - 3</span></div>
<p class="calibre3"/>
<p class="calibre3"><span class="calibre6">Notice that in the </span><span class="calibre6">Game Window</span><span class="calibre6">, when we bring up the </span><span class="calibre6">Inventory Window</span><span class="calibre6"> for display and click the </span><span class="calibre6">weapons</span><span class="calibre6"> button, we get two listings. The listings display the proper data for each inventory item in the category. Take a look at the following screenshot:</span></p>
<div class="mce-root1"><img src="../images/00137.jpeg" class="calibre45"/></div>
<div class="mce-root2">Armour category</div>
<p class="calibre3">To illustrate the <kbd class="calibre13">onClick()</kbd> event for the add button, please see the following screenshot from the <span class="calibre6">Console Window</span>:</p>
<div class="mce-root1"><img src="../images/00138.jpeg" class="calibre45"/></div>
<div class="mce-root2">Inventory item properties</div>
<p class="calibre3"><span class="calibre6">To list the armor items in the inventory, we will click the <span class="calibre6">armour</span> button. The following screenshot displays the items in the <span class="calibre6">armour</span> category in the inventory based on our data:</span></p>
<div class="mce-root1"><img src="../images/00139.jpeg" class="calibre117"/></div>
<p class="calibre3"/>
<p class="calibre3">We have come a long way. Let's take a moment to put things in perspective.</p>
<div class="packt_infobox"><br class="calibre47"/>
We first created the following scripts to lay the foundation for our inventory system in the game:<br class="calibre47"/>
<kbd class="calibre85">BaseItem.cs</kbd><br class="calibre47"/>
<kbd class="calibre85">InventoryItem.cs</kbd><br class="calibre47"/>
<kbd class="calibre85">InventoryItemAgent.cs</kbd><br class="calibre47"/>
<kbd class="calibre85">InventorySystem.cs</kbd><br class="calibre47"/>
The next step was to create the prefabs for each inventory item and add them to the <kbd class="calibre85">InventoryItemAgent.cs</kbd> script. This in turn allowed us to assign the necessary data to identify the prefab as an inventory item during game play.<br class="calibre47"/>
Next, we started work on the design and development of the user interface for the inventory system. We created a sketch of how we would like the inventory window to look  and implemented the framework using the build in UI architecture.<br class="calibre47"/>
Slowly adding to the UI and applying different concepts and new elements, we built the final user interface for the inventory system.<br class="calibre47"/>
<br class="calibre47"/>
Finally, we used the prefabs to test the complete addition and removal of the inventory items from the user interface.</div>
<p class="calibre3">The next challenge we face is how to actually apply the inventory items to the player character.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Inventory items and the player character</h1>
                
            
            <article>
                
<p class="calibre3">Now that we have seen how to create the inventory system, we need to be able to utilize it during game play to apply changes to our player character. In this section, we will examine how to do just that!</p>
<p class="calibre3">Here are some of the new features we need to work on:</p>
<ul class="calibre11">
<li class="calibre12">Applying a selected inventory item to the player character</li>
<li class="calibre12">Performing accounting on both the player character and the inventory system</li>
<li class="calibre12">Updating the game state accordingly</li>
</ul>
<p class="calibre3"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Applying inventory items</h1>
                
            
            <article>
                
<p class="calibre3">We need to make some design decisions on how we are going to handle applying the inventory items to the player character, and in turn how the system will handle the event. For instance, let's assume the player character has acquired several weapons; let's say Weapons A, B, and C.</p>
<p class="calibre3">Let's also assume that initially, the player does not have any active weapons. Now, the player selects to activate Weapon A. For this scenario, we would just use the inventory item data and activate Weapon A for the player, taking into consideration all of the accounting that comes with the weapon.</p>
<p class="calibre3">Now, the player wants to change his/her weapon to Weapon B because it is more powerful and they will need it to defeat the boss. Since the player already has Weapon A active, what are we going to do with it before we activate Weapon B? Do we put it back into the game world, or do we put it back into our inventory for later use?</p>
<p class="calibre3">In our case, once you have an item in the inventory, it will stay with you until you actually delete it from the inventory, in which case it will be destroyed. We need to make a few code modifications, and also some prefab modifications, to have everything working together.</p>
<p class="calibre3">Let's start with the <kbd class="calibre13">InventoryItem.cs</kbd> script. We are going to add new data to store the type of the inventory item. This is necessary because we have a category, and within the category we have different types of items. This is especially true for the <span class="calibre6">Armour</span> category! For instance, we have a Helmet, a Shield, a Shoulder Pad, and so on.</p>
<p class="calibre3">The code listing is as follows:</p>
<pre class="calibre18">using System;<br class="title-page-name"/>using UnityEngine;<br class="title-page-name"/>namespace com.noorcon.rpg2e<br class="title-page-name"/>{<br class="title-page-name"/>[Serializable]<br class="title-page-name"/>public class InventoryItem : BaseItem<br class="title-page-name"/>{<br class="title-page-name"/>public enum ItemType<br class="title-page-name"/>{<br class="title-page-name"/>Helmet = 0,<br class="title-page-name"/>Shield = 1,<br class="title-page-name"/>ShoulderPad = 2,<br class="title-page-name"/>KneePad = 3,<br class="title-page-name"/>Boots = 4,<br class="title-page-name"/>Weapon = 5<br class="title-page-name"/>}<br class="title-page-name"/>[SerializeField]<br class="title-page-name"/>private ItemCatrgory category;<br class="title-page-name"/>[SerializeField]<br class="title-page-name"/>private ItemType type;<br class="title-page-name"/>[SerializeField]<br class="title-page-name"/>private float strength;<br class="title-page-name"/>[SerializeField]<br class="title-page-name"/>private float weight;<br class="title-page-name"/>public ItemCatrgory Category<br class="title-page-name"/>{<br class="title-page-name"/>get { return category; }<br class="title-page-name"/>set { category = value; }<br class="title-page-name"/>}<br class="title-page-name"/>public ItemType Type<br class="title-page-name"/>{<br class="title-page-name"/>get { return type; }<br class="title-page-name"/>set { type = value; }<br class="title-page-name"/>}<br class="title-page-name"/>public float Strength<br class="title-page-name"/>{<br class="title-page-name"/>get { return strength; }<br class="title-page-name"/>set { strength = value; }<br class="title-page-name"/>}<br class="title-page-name"/>public float Weight<br class="title-page-name"/>{<br class="title-page-name"/>get { return weight; }<br class="title-page-name"/>set { weight = value; }<br class="title-page-name"/>}<br class="title-page-name"/>public void CopyInventoryItem(InventoryItem item)<br class="title-page-name"/>{<br class="title-page-name"/>Category = item.Category;<br class="title-page-name"/>Description = item.Description;<br class="title-page-name"/>Name = item.Name;<br class="title-page-name"/>Strength = item.Strength;<br class="title-page-name"/>Weight = item.Weight;<br class="title-page-name"/>}<br class="title-page-name"/>}<br class="title-page-name"/>}</pre>
<p class="calibre3"/>
<p class="calibre3">When you make the update to your script, make sure to go back into the IDE and select the proper type for each prefab we have created, to represent your inventory items. Take a look at the following screenshot:</p>
<div class="mce-root1"><img src="../images/00140.jpeg" class="calibre45"/></div>
<div class="mce-root2">Inventory item type field</div>
<p class="calibre3">You will need to update the <span class="calibre6">Type</span> field for each prefab you have created for your inventory items.</p>
<p class="calibre3">We also need to update the <kbd class="calibre13">PlayerCharacter.cs</kbd> script. We are going to make the original data variables private and create public properties to access them. This way, if we need to perform any extra work prior to, or after, setting or getting the property value, we can do so easily.</p>
<p class="calibre3">The listing for the <kbd class="calibre13">PlayerCharacter.cs</kbd> script is as follows:</p>
<pre class="calibre18">using System;<br class="title-page-name"/>using UnityEngine;<br class="title-page-name"/>namespace com.noorcon.rpg2e<br class="title-page-name"/>{<br class="title-page-name"/>public delegate void WeaponChangedEventHandler(PlayerCharacter.WeaponType weapon);<br class="title-page-name"/>[Serializable]<br class="title-page-name"/>public class PlayerCharacter : BaseCharacter<br class="title-page-name"/>{<br class="title-page-name"/>public enum ShoulderPad<br class="title-page-name"/>{<br class="title-page-name"/>none = 0,<br class="title-page-name"/>SP01 = 1,<br class="title-page-name"/>SP02 = 2,<br class="title-page-name"/>SP03 = 3,<br class="title-page-name"/>SP04 = 4<br class="title-page-name"/>};<br class="title-page-name"/>// Older version of the model<br class="title-page-name"/>public enum BodyType { normal = 1, BT01 = 2, BT02 = 3 };<br class="title-page-name"/>// New support for character model<br class="title-page-name"/>public float BodyFat = 0.0f;<br class="title-page-name"/>public float BodySkinny = 0.0f;<br class="title-page-name"/>// Shoulder Pad<br class="title-page-name"/>public ShoulderPad selectedShoulderPad = ShoulderPad.none;<br class="title-page-name"/>public BodyType selectedBodyType = BodyType.normal;<br class="title-page-name"/>public bool kneePad = false;<br class="title-page-name"/>public bool legPlate = false;<br class="title-page-name"/>public enum WeaponType<br class="title-page-name"/>{<br class="title-page-name"/>none = 0,<br class="title-page-name"/>axe1 = 1,<br class="title-page-name"/>axe2 = 2,<br class="title-page-name"/>club1 = 3,<br class="title-page-name"/>club2 = 4,<br class="title-page-name"/>falchion = 5,<br class="title-page-name"/>gladius = 6,<br class="title-page-name"/>mace = 7,<br class="title-page-name"/>maul = 8,<br class="title-page-name"/>scimitar = 9,<br class="title-page-name"/>spear = 10,<br class="title-page-name"/>sword1 = 11,<br class="title-page-name"/>sword2 = 12,<br class="title-page-name"/>sword3 = 13<br class="title-page-name"/>};<br class="title-page-name"/>[SerializeField]<br class="title-page-name"/>private WeaponType selectedWeapon = WeaponType.none;<br class="title-page-name"/>public WeaponType SelectedWeapon<br class="title-page-name"/>{<br class="title-page-name"/>get { return selectedWeapon; }<br class="title-page-name"/>set { selectedWeapon = value; }<br class="title-page-name"/>}<br class="title-page-name"/>public enum HelmetType { none = 0, HL01 = 1, HL02 = 2, HL03 = 3, HL04 = 4 };<br class="title-page-name"/>[SerializeField]<br class="title-page-name"/>private HelmetType selectedHelmet = HelmetType.none;<br class="title-page-name"/>public HelmetType SelectedHelmet<br class="title-page-name"/>{<br class="title-page-name"/>get { return selectedHelmet; }<br class="title-page-name"/>set { selectedHelmet = value; }<br class="title-page-name"/>}<br class="title-page-name"/>public enum ShieldType { none = 0, SL01 = 1, SL02 = 2 };<br class="title-page-name"/>[SerializeField]<br class="title-page-name"/>private ShieldType selectedShield = ShieldType.none;<br class="title-page-name"/>public ShieldType SelectedShield<br class="title-page-name"/>{<br class="title-page-name"/>get { return selectedShield; }<br class="title-page-name"/>set { selectedShield = value; }<br class="title-page-name"/>}<br class="title-page-name"/>public int SkinId = 1;<br class="title-page-name"/>public enum ClothingType { none=0, CT01=1, CT02=2, CT03=3, CT04=4 };<br class="title-page-name"/>[SerializeField]<br class="title-page-name"/>private ClothingType selectedClothing = ClothingType.none;<br class="title-page-name"/>public ClothingType SelectedClothing<br class="title-page-name"/>{<br class="title-page-name"/>get { return selectedClothing; }<br class="title-page-name"/>set { selectedClothing = value; }<br class="title-page-name"/>}<br class="title-page-name"/>public enum ShoeType { none = 0, BT01 = 1, BT02 = 2 };<br class="title-page-name"/>[SerializeField]<br class="title-page-name"/>private ShoeType selectedShoe = ShoeType.none;<br class="title-page-name"/>public ShoeType SelectedShoe<br class="title-page-name"/>{<br class="title-page-name"/>get { return selectedShoe; }<br class="title-page-name"/>set { selectedShoe = value; }<br class="title-page-name"/>}<br class="title-page-name"/>[SerializeField]<br class="title-page-name"/>private InventoryItem selectedArmour;<br class="title-page-name"/>public InventoryItem SelectedArmour<br class="title-page-name"/>{<br class="title-page-name"/>get { return selectedArmour; }<br class="title-page-name"/>set { selectedArmour = value; }<br class="title-page-name"/>}<br class="title-page-name"/>}<br class="title-page-name"/>}</pre>
<p class="calibre3"/>
<p class="calibre3">The next code modification will be on the <kbd class="calibre13">BarbarianCharacterCustomization.cs</kbd> script. Since this script has been used in the character customization scene, we can utilize the same script and expand it to apply the visual changes to our player character. But before we can utilize this script, we will need to copy the actual component from the <kbd class="calibre13">Base</kbd> GameObject defined in our character customization scene, and paste it into the <kbd class="calibre13">PC_C6</kbd> GameObject representing our player character!</p>
<div class="packt_tip">When you copy a component using the gear menu in the <em class="calibre30">Inspector Window</em>, all the configurations, links, and references stay intact! When you paste the component, again using the gear menu in the <em class="calibre30">Inspector Window</em>, you will have an exact copy of the component. This will eliminate the need for us to rewire all of the GameObjects to their references in the script.</div>
<p class="calibre3">The following two screenshots illustrate the copy of the component from the <kbd class="calibre13">_Base</kbd> GameObject to the <kbd class="calibre13">PC_C6</kbd> GameObject:</p>
<div class="mce-root1"><img src="../images/00141.jpeg" class="calibre45"/></div>
<div class="mce-root2">Using the gear icon to copy and paste a component</div>
<p class="calibre3"/>
<p class="calibre3"/>
<p class="packt_figref">The <kbd class="calibre118">_Base</kbd> GameObject has the customization script attached to it, as illustrated in the preceding screenshot, c<span class="calibre6">opying the values from the <kbd class="calibre118">_Base</kbd></span><span class="calibre6"> GameObject to transfer over to PC-C6 object. Take a look at the following screenshot:</span></p>
<div class="mce-root1"><img src="../images/00142.jpeg" class="calibre45"/></div>
<div class="mce-root2"><span>Using the gear icon to copy and paste a component</span></div>
<p class="calibre3">This works because the script is actually referencing the different parts of the <kbd class="calibre13">PC_C6</kbd> GameObject hierarchy in the first place. The difference was that it used to be attached to the <kbd class="calibre13">_Base</kbd> GameObject for the customization.</p>
<div class="packt_tip">Note: Can they both be active at the same time, in the same scene, at this point? Yes! However, if you have the time, you might want to redo your UI event triggers to use the <kbd class="calibre85">PC_CC</kbd> GameObject, and then you can remove the <kbd class="calibre85">BarbarianCharacterCustomization.cs</kbd> script from the <kbd class="calibre85">_Base</kbd> GameObject.</div>
<p class="calibre3"/>
<p class="calibre3"/>
<p class="calibre3">Now we actually need to modify the <kbd class="calibre13">BarbarianCharacterCustomization.cs</kbd> script to activate the different parts of the player character model using the data it will receive from the <kbd class="calibre13">GameMaster.cs</kbd> script.</p>
<p class="calibre3">A partial listing of the <kbd class="calibre13">CharacterCustomization.cs</kbd> script is as follows:</p>
<pre class="calibre18">        void DisableWeapons()<br class="title-page-name"/>        {<br class="title-page-name"/>            AXE_01LOD0.SetActive(false);<br class="title-page-name"/>            AXE_02LOD0.SetActive(false);<br class="title-page-name"/>            CLUB_01LOD0.SetActive(false);<br class="title-page-name"/>            CLUB_02LOD0.SetActive(false);<br class="title-page-name"/>            FALCHION_LOD0.SetActive(false);<br class="title-page-name"/>            GLADIUS_LOD0.SetActive(false);<br class="title-page-name"/>            MACE_LOD0.SetActive(false);<br class="title-page-name"/>            MAUL_LOD0.SetActive(false);<br class="title-page-name"/>            SCIMITAR_LOD0.SetActive(false);<br class="title-page-name"/>            SPEAR_LOD0.SetActive(false);<br class="title-page-name"/>            SWORD_BASTARD_LOD0.SetActive(false);<br class="title-page-name"/>            SWORD_BOARD_01LOD0.SetActive(false);<br class="title-page-name"/>            SWORD_SHORT_LOD0.SetActive(false);<br class="title-page-name"/>        }<br class="title-page-name"/><br class="title-page-name"/>    public void SetWeaponType(Slider id)<br class="title-page-name"/>    {<br class="title-page-name"/>      try<br class="title-page-name"/>      {<br class="title-page-name"/>        PlayerCharacter.WeaponType weapon = (PlayerCharacter.WeaponType)Convert.ToInt32(id.value);<br class="title-page-name"/><br class="title-page-name"/>        PlayerCharacterData.SelectedWeapon = weapon;<br class="title-page-name"/>      }<br class="title-page-name"/>      catch<br class="title-page-name"/>      {<br class="title-page-name"/>        PlayerCharacterData.SelectedWeapon = PlayerCharacter.WeaponType.none;<br class="title-page-name"/>      }<br class="title-page-name"/><br class="title-page-name"/>            // disable weapons<br class="title-page-name"/>            DisableWeapons();<br class="title-page-name"/><br class="title-page-name"/>      switch (Convert.ToInt32(id.value))<br class="title-page-name"/>      {<br class="title-page-name"/>        case 0:<br class="title-page-name"/>          {<br class="title-page-name"/>                        DisableWeapons();<br class="title-page-name"/>            break;<br class="title-page-name"/>          }<br class="title-page-name"/>        case 1:<br class="title-page-name"/>          {<br class="title-page-name"/>            AXE_01LOD0.SetActive(true);<br class="title-page-name"/>            break;<br class="title-page-name"/>          }<br class="title-page-name"/>        case 2:<br class="title-page-name"/>          {<br class="title-page-name"/>            AXE_02LOD0.SetActive(true);<br class="title-page-name"/>            break;<br class="title-page-name"/>          }<br class="title-page-name"/>        case 3:<br class="title-page-name"/>          {<br class="title-page-name"/>            CLUB_01LOD0.SetActive(true);<br class="title-page-name"/>            break;<br class="title-page-name"/>          }<br class="title-page-name"/>        case 4:<br class="title-page-name"/>          {<br class="title-page-name"/>            CLUB_02LOD0.SetActive(true);<br class="title-page-name"/>            break;<br class="title-page-name"/>          }<br class="title-page-name"/>        case 5:<br class="title-page-name"/>          {<br class="title-page-name"/>            FALCHION_LOD0.SetActive(true);<br class="title-page-name"/>            break;<br class="title-page-name"/>          }<br class="title-page-name"/>        case 6:<br class="title-page-name"/>          {<br class="title-page-name"/>            GLADIUS_LOD0.SetActive(true);<br class="title-page-name"/>            break;<br class="title-page-name"/>          }<br class="title-page-name"/>        case 7:<br class="title-page-name"/>          {<br class="title-page-name"/>            MACE_LOD0.SetActive(true);<br class="title-page-name"/>            break;<br class="title-page-name"/>          }<br class="title-page-name"/>        case 8:<br class="title-page-name"/>          {<br class="title-page-name"/>            MAUL_LOD0.SetActive(true);<br class="title-page-name"/>            break;<br class="title-page-name"/>          }<br class="title-page-name"/>        case 9:<br class="title-page-name"/>          {<br class="title-page-name"/>            SCIMITAR_LOD0.SetActive(true);<br class="title-page-name"/>            break;<br class="title-page-name"/>          }<br class="title-page-name"/>        case 10:<br class="title-page-name"/>          {<br class="title-page-name"/>            SPEAR_LOD0.SetActive(true);<br class="title-page-name"/>            break;<br class="title-page-name"/>          }<br class="title-page-name"/>        case 11:<br class="title-page-name"/>          {<br class="title-page-name"/>            SWORD_BASTARD_LOD0.SetActive(true);<br class="title-page-name"/>            break;<br class="title-page-name"/>          }<br class="title-page-name"/>        case 12:<br class="title-page-name"/>          {<br class="title-page-name"/>            SWORD_BOARD_01LOD0.SetActive(true);<br class="title-page-name"/>            break;<br class="title-page-name"/>          }<br class="title-page-name"/>        case 13:<br class="title-page-name"/>          {<br class="title-page-name"/>            SWORD_SHORT_LOD0.SetActive(true);<br class="title-page-name"/>            break;<br class="title-page-name"/>          }<br class="title-page-name"/>      }<br class="title-page-name"/>    }</pre>
<p class="calibre3">I have not listed the whole script as it would take many pages. But the basic concept is to overload the <kbd class="calibre13">SetXXXXX()</kbd> functions so that they will perform the necessary tasks based on the parameters coming in, as for the preceding example, <kbd class="calibre13">PlayerCharacter.WeaponType</kbd>.</p>
<p class="calibre3">The next script that needs to be modified is the <kbd class="calibre13">UiController.cs</kbd> script. This is where we will modify the five functions we created previously, to actually apply the changes to the player character. Let's look at one of the functions that have been modified, without listing the whole code, as follows:</p>
<pre class="calibre18">  public void DisplayWeaponsCategory() 
  { 
    if(GameMaster.instance.DISPLAY_INVENTORY) 
    { 
      this.ClearInventoryItemsPanel(); 
 
      foreach (InventoryItem item in GameMaster.instance.INVENTORY.WEAPONS) 
      { 
        GameObject objItem = GameObject.Instantiate(this.InventoryItemElement) as GameObject; 
        InventoryItemUI invItem = objItem.GetComponent&lt;InventoryItemUI&gt;(); 
        invItem.txtItemElement.text = 
          string.Format("Name: {0}, Description: {1}, Strength: {2}, Weight: {3}", 
                                  item.NAME, 
                                  item.DESCRIPTION, 
                                  item.STRENGTH, 
                                  item.WEIGHT); 
 
        invItem.item = item; 
 
        // add button triggers 
        invItem.butAdd.GetComponent&lt;Button&gt;().onClick.AddListener(() =&gt; 
        { 
          Debug.Log(string.Format("You have clicked button add for {0}, {1}", invItem.txtItemElement.text, invItem.item.NAME)); 
 
          // let's apply the selected item to the player character 
          GameMaster.instance.PC_CC.SELECTED_WEAPON = (PC.WEAPON_TYPE)Enum.Parse(typeof(PC.WEAPON_TYPE), invItem.item.NAME); 
          GameMaster.instance.PlayerWeaponChanged(); 
        }); 
 
        // delete button triggers 
        invItem.butDelete.GetComponent&lt;Button&gt;().onClick.AddListener(() =&gt; 
        { 
          Debug.Log(string.Format("You have clicked button delete for {0}", invItem.txtItemElement.text)); 
          Destroy(objItem); 
        }); 
 
        objItem.transform.SetParent(this.PanelItem); 
      } 
 
    } 
  }  </pre>
<p class="calibre3">Notice that we are also saving the <em class="calibre14">item</em> from the <kbd class="calibre13">foreach</kbd> loop into the <kbd class="calibre13">invItem.item</kbd> variable. This is important, to make sure the <kbd class="calibre13">OnClick()</kbd> listener is picking up the current <kbd class="calibre13">InventoryItem</kbd> variable from the list.</p>
<p class="calibre3">The bulk of the work is done in <kbd class="calibre13">onClick.AddListener()</kbd> for each button. We basically set the selected weapon using <kbd class="calibre13">GameMaster.instance</kbd> to store, and then we are calling the <kbd class="calibre13">PlayerWeaponChanged()</kbd> function to handle some more features. This will be demonstrated in the next code listing.</p>
<div class="packt_tip">You will need to handle each add button listener in a similar fashion, based on how you have designed and implemented your code and your prefabs.</div>
<p class="calibre3"/>
<p class="calibre3">Finally, we are going to make some modifications to the <kbd class="calibre13">GameMaster.cs</kbd> script. The listing is as follows:</p>
<pre class="calibre18">using UnityEngine; 
using UnityEngine.UI; 
using UnityEngine.SceneManagement; 
 
using System.Collections; 
using System; 
 
public class GameMaster : MonoBehaviour 
{ 
  public static GameMaster instance; 
 
  // let's have a reference to the player character GameObject 
  public GameObject PC_GO; 
 
  // reference to player Character Customization 
  public PC PC_CC; 
  public InventorySystem INVENTORY; 
 
  public GameObject START_POSITION; 
 
  public GameObject CHARACTER_CUSTOMIZATION; 
 
  public LevelController LEVEL_CONTROLLER; 
  public AudioController AUDIO_CONTROLLER; 
 
  // Ref to UI Elements ... 
  public bool DISPLAY_SETTINGS = false; 
  public bool DISPLAY_INVENTORY = false; 
 
  public UIController UI; 
 
  void Awake() 
  { 
    // simple singlton 
    if (instance == null) 
    { 
      instance = this; 
 
      instance.DISPLAY_INVENTORY = false; 
      instance.DISPLAY_SETTINGS = false; 
 
      // initialize Level Controller 
      instance.LEVEL_CONTROLLER = new LevelController(); 
 
      // initialize Audio Controller 
      instance.AUDIO_CONTROLLER = new AudioController(); 
      instance.AUDIO_CONTROLLER.AUDIO_SOURCE = GameMaster.instance.GetComponent&lt;AudioSource&gt;(); 
      instance.AUDIO_CONTROLLER.SetDefaultVolume(); 
 
      // initialize Inventory System 
      instance.INVENTORY = new InventorySystem(); 
 
    } 
    else if (instance != this) 
    { 
      Destroy(this); 
    } 
 
    // keep the game object when moving from 
    // one scene to the next scene 
    DontDestroyOnLoad(this); 
  } 
 
<a href="https://github.com/PacktPublishing/Building-an-RPG-with-Unity-2018-Second-Edition" class="calibre83">....</a></pre>
<p class="calibre3"><span class="calibre6">The only function I want you to take a note of is the </span><kbd class="calibre13">PlayerArmourChanged()</kbd><span class="calibre6"> function. It is because of this function that we have to add the new </span><em class="calibre14">Type</em><span class="calibre6"> data variable and datatype to the </span><kbd class="calibre13">InventoryItem</kbd><span class="calibre6"> class. Take a look at the following code:</span></p>
<pre class="calibre18">  // for each level/scene that has been loaded 
  // do some of the preparation work 
  void OnLevelWasLoaded() 
  { 
    GameMaster.instance.LEVEL_CONTROLLER.OnLevelWasLoaded(); 
  } 
 
  // Use this for initialization 
  void Start() 
  { 
    // let's find a reference to the UI controller of the loaded scene 
    if (GameObject.FindGameObjectWithTag("UI") != null) 
    { 
      GameMaster.instance.UI = GameObject.FindGameObjectWithTag("UI").GetComponent&lt;UIController&gt;(); 
    } 
 
    GameMaster.instance.UI.SettingsCanvas.gameObject.SetActive(GameMaster.instance.DISPLAY_SETTINGS); 
  } 
 
  // Update is called once per frame 
  void Update() 
  { 
    // only when we are in the game level 
    if(instance.LEVEL_CONTROLLER.CURRENT_SCENE.name==SceneName.Level_1) 
    { 
      if (Input.GetKeyUp(KeyCode.J)) 
      { 
        //Debug.Log("Pressing J"); 
        instance.DISPLAY_INVENTORY = !instance.DISPLAY_INVENTORY; 
        instance.UI.DisplayInventory(); 
      } 
    } 
  } 
 
  public void MasterVolume(float volume) 
  { 
    GameMaster.instance.AUDIO_CONTROLLER.MasterVolume(volume); 
  } 
 
  public void StartGame() 
  { 
    GameMaster.instance.LoadLevel(); 
  } 
 
  public void LoadLevel() 
  { 
    GameMaster.instance.LEVEL_CONTROLLER.LoadLevel(); 
  } 
 
  public void RPG_Destroy(GameObject obj) 
  { 
    Destroy(obj); 
  } 
} </pre>
<p class="calibre3">We have a lot of different types of armor, and we needed a way to distinguish between them. Based on the armor type, we would then call the appropriate function to activate them on the player character.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">How it looks</h1>
                
            
            <article>
                
<p class="calibre3">This chapter was a bit involved with regard to configuring your GameObjects and prefabs, and, more importantly, the code that went along to glue everything together. I have tried to keep things as simple as possible. Having said that, there are a few items that we have not discussed and incorporated in the chapter—the topics relating to leveling up, XP, and Quests. If you truly study and understand the Inventory System, you can very easily drive and expand it to cover all other parts. Unfortunately, we won't be able to implement everything in one book. </p>
<p class="calibre3">Following is a screenshot illustrating the player character prior to picking up the inventory items placed on the level. Notice that <kbd class="calibre13">INVENOTRY</kbd> is empty in the <kbd class="calibre13">GameMaster</kbd> object. Also, there are no selected items in the <kbd class="calibre13">PC-C6</kbd> object:</p>
<div class="mce-root1"><img src="../images/00143.jpeg" class="calibre45"/></div>
<div class="mce-root2">Player character data</div>
<p class="calibre3">After I move the player character to pick up the inventory items, I will use the hot-key programmed to bring up the inventory window. In my case, the <span class="calibre6">J</span> key. The following screenshot captures the interaction:</p>
<div class="mce-root1"><img src="../images/00144.jpeg" class="calibre45"/></div>
<div class="mce-root2">Player Character Data Inventory</div>
<p class="calibre3">Now, let's look at how things change when we apply a few of the inventory items to the player character. You can see the changes applied in the preceding screenshot, in the inventory collection.</p>
<p class="calibre3"/>
<p class="calibre3"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Summary</h1>
                
            
            <article>
                
<p class="calibre3">There is a lot covered in this chapter. The core of the chapter was to create a usable inventory system. We began the chapter by discussing weighted inventories, and gave a brief overview of the concept. We then determined the item types we are going to be using for our game.</p>
<p class="calibre3">We created the scripts <kbd class="calibre13">BaseItem.cs</kbd>, <kbd class="calibre13">InventoryItem.cs</kbd>, and <kbd class="calibre13">InventorySystem.cs</kbd>. These scripts were then utilized as a starting point to design and develop our inventory. We then updated the <kbd class="calibre13">GameMaster.cs</kbd> script, to test the basics of the newly created scripts and be able to view the data within the Unity IDE by serializing the attributes. We did this by instantiating an <kbd class="calibre13">InventoryItem</kbd> and inserting it into the <kbd class="calibre13">InventorySystem</kbd>, and validated the operation visually through the IDE.</p>
<p class="calibre3">The next step was to actually create the inventory item prefabs. This section covered how to navigate and find your customizable inventory items if your model included everything on the actual fbx model, how to extract it from the model, and how to convert it into a prefab for later use. Then we created a new script, called <kbd class="calibre13">InventoryItemAgent.cs</kbd>, which was attached to every prefab created to represent an inventory item. This script basically gives us the ability to set the data for each inventory item from within the IDE. Very useful! We also had to attach a collider to each prefab, to handle collision and trigger a pick-up call when the player collides with the object.</p>
<p class="calibre3">Once we had the basics in place, we started looking at how to design and implement the user interface for our inventory system. We discussed the categories that we want to represent, as well as how the items within each category will be listed/displayed for the player during game play. We implemented the initial framework for the inventory window and integrated it with the game.</p>
<p class="calibre3">Now we are ready to discuss how to create a dynamic item viewer that can be populated during runtime and represent the inventory items we have collected correctly. We introduced some new user interface concepts, such as scroll view and how to utilize layouts in our interface. We did a quick test with a simple placeholder to just display the name of the item. Once we got the mechanics working, we implemented the main inventory item control panel and converted it into a prefab, to be instantiated at runtime when needed.</p>
<p class="calibre3">Finally, we worked on the integration of the inventory system with the inventory UI, with the GameMaster and player character, to have the final implementation. This required that we update and modify more scripts.</p>
<p class="calibre3">By the end of the chapter, you have a fully functional inventory system that can be expanded as needed.</p>


            </article>

            
        </section>
    </body></html>