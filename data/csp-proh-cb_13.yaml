- en: Chapter 13. Creating a Web Application in Azure
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第 13 章。在 Azure 中创建 Web 应用程序
- en: 'This chapter will introduce you to Azure. If you have never worked with Azure
    before, the interface might seem a bit daunting. Azure, however, is actually not
    all that complicated and is a tremendous benefit to any developer. In this chapter,
    we will have a look at doing the following:'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将向您介绍 Azure。如果您以前从未使用过 Azure，界面可能看起来有些令人畏惧。然而，Azure 实际上并不那么复杂，并且对任何开发者来说都是巨大的好处。在本章中，我们将探讨以下内容：
- en: Creating a database in Azure for testing
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 Azure 中创建用于测试的数据库
- en: Creating a web application and hosting on Azure
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 Azure 上创建 Web 应用程序并进行托管
- en: Using virtual machines on Azure
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 Azure 上使用虚拟机
- en: Introduction
  id: totrans-5
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 简介
- en: Azure allows developers to be more productive. It is a series of cloud services
    that developers can use to build apps, protect data, and provide high availability
    to your applications irrespective of what you are building. Mobile apps, enterprise
    apps, web, **internet of things** (**IoT**)… all are welcome on Azure.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: Azure 允许开发者提高生产力。这是一系列开发者可以用来构建应用程序、保护数据和为您的应用程序提供高可用性的云服务，无论您正在构建什么。移动应用程序、企业应用程序、Web、**物联网**（**IoT**）……所有这些都欢迎在
    Azure 上。
- en: You can create apps with .NET, JavaScript, PHP, Node.js, Python, and even run
    Linux containers. Azure also allows you to only pay for what you actually use,
    allowing you to easily scale as your needs grow.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以使用 .NET、JavaScript、PHP、Node.js、Python 创建应用程序，甚至运行 Linux 容器。Azure 还允许您只为您实际使用的部分付费，使您能够随着需求的增长轻松扩展。
- en: Creating a database in Azure for testing
  id: totrans-8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在 Azure 中创建用于测试的数据库
- en: Creating a database in Azure is really a straightforward process. A lot of work
    has gone into making the process really streamlined with an all-too-familiar wizard-type
    interface.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Azure 中创建数据库实际上是一个非常直接的过程。为了使过程更加流畅，已经投入了大量工作，使其具有一个过于熟悉的向导式界面。
- en: Getting ready
  id: totrans-10
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: 'To start working with Azure, you will need to have an Azure account. You can
    create a free trial account. For more information on Azure pricing, have a look
    at the following URL: [https://azure.microsoft.com/en-us/pricing/](https://azure.microsoft.com/en-us/pricing/).'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 要开始使用 Azure，您需要一个 Azure 账户。您可以创建一个免费试用账户。有关 Azure 定价的更多信息，请查看以下 URL：[https://azure.microsoft.com/en-us/pricing/](https://azure.microsoft.com/en-us/pricing/)。
- en: How to do it…
  id: totrans-12
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作…
- en: After you have logged in to your Azure account, you will be taken to your **Dashboard**.
    From here you can see any items you may have pinned. To the left, you will see
    the menu. We just want to create a SQL database, so click on the **SQL databases**
    menu item:![How to do it…](img/B05391_13_01.jpg)
  id: totrans-13
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 登录到您的 Azure 账户后，您将被带到您的**仪表板**。从这里您可以查看您可能已固定的任何项目。在左侧，您将看到菜单。我们只想创建一个 SQL 数据库，因此点击**SQL
    数据库**菜单项：![如何操作…](img/B05391_13_01.jpg)
- en: If this is the first time you are using Azure, you will not have any databases
    available in the **Default Directory**. Click on **Add** to create a new database:![How
    to do it…](img/B05391_13_02.jpg)
  id: totrans-14
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果这是您第一次使用 Azure，您在**默认目录**中将没有任何可用的数据库。点击**添加**以创建一个新的数据库：![如何操作…](img/B05391_13_02.jpg)
- en: You will now be presented with a form that you can use to specify the database
    details. As you can see, you will probably not have a server selected. This is
    because you probably don't have one yet. Click on **Server Configure required
    setting**:![How to do it…](img/B05391_13_03.jpg)
  id: totrans-15
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，您将看到一个表单，您可以使用它来指定数据库详细信息。如您所见，您可能没有选择服务器。这可能是因为您可能还没有服务器。点击**服务器配置所需设置**：![如何操作…](img/B05391_13_03.jpg)
- en: You will be given the option to create a new server. This is where you will
    also create the **Server admin login**:![How to do it…](img/B05391_13_04.jpg)
  id: totrans-16
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您将有机会创建一个新的服务器。这也是您创建**服务器管理员登录**的地方：![如何操作…](img/B05391_13_04.jpg)
- en: When you have created your server, you will be taken back to the database setup
    screen. The server you created is now selected for you:![How to do it…](img/B05391_13_05.jpg)
  id: totrans-17
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 当您创建了自己的服务器后，您将被带回到数据库设置屏幕。您创建的服务器现在已被选中：![如何操作…](img/B05391_13_05.jpg)
- en: When you click the **Create** button, Azure will start deploying your database
    to the server you created:![How to do it…](img/B05391_13_06.jpg)
  id: totrans-18
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 当您点击**创建**按钮时，Azure 将开始将您的数据库部署到您创建的服务器上：![如何操作…](img/B05391_13_06.jpg)
- en: This process can take a couple of minutes, so be patient while it completes.
    When the database deployment is completed, you will see a notification in the
    notifications tab at the top of the Azure portal:![How to do it…](img/B05391_13_07.jpg)
  id: totrans-19
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 此过程可能需要几分钟，所以在它完成时请耐心等待。当数据库部署完成后，你将在 Azure 门户顶部的通知标签页中看到一个通知：![如何操作…](img/B05391_13_07.jpg)
- en: You might need to refresh your SQL databases screen to see the newly deployed
    database. In order to complete the next steps, click on the created database in
    the databases list:![How to do it…](img/B05391_13_08.jpg)
  id: totrans-20
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你可能需要刷新你的 SQL 数据库屏幕以查看新部署的数据库。为了完成下一步，点击数据库列表中创建的数据库：![如何操作…](img/B05391_13_08.jpg)
- en: The properties and settings for the created database are then displayed. Here
    you can see the **Resource group** you selected, along with the **Server name**
    and other properties. Of particular interest is the **Connection strings** property:![How
    to do it…](img/B05391_13_09.jpg)
  id: totrans-21
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建的数据库的属性和设置随后将显示出来。在这里，你可以看到你选择的**资源组**，以及**服务器名称**和其他属性。特别值得注意的是**连接字符串**属性：![如何操作…](img/B05391_13_09.jpg)
- en: Clicking on the **Connection strings** will display the connection strings for
    the different providers for the database you created. Make a note of the **ADO.NET(SQL
    authentication)** string:![How to do it…](img/B05391_13_10.jpg)
  id: totrans-22
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**连接字符串**将显示你创建的数据库的不同提供者的连接字符串。记下**ADO.NET(SQL 身份验证)**字符串：![如何操作…](img/B05391_13_10.jpg)
- en: Going back to the previous screen, click on the **Server name** property. It
    is here that you will find the **Firewall** settings. You need to add a rule to
    the firewall to allow your computer to connect to this database:![How to do it…](img/B05391_13_11.jpg)
  id: totrans-23
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 返回到上一个屏幕，点击**服务器名称**属性。在这里，你会找到**防火墙**设置。你需要向防火墙添加一个规则，以允许你的计算机连接到此数据库：![如何操作…](img/B05391_13_11.jpg)
- en: Clicking on the **Show firewall settings**, you will see that you can add a
    client IP. By default, the machine's IP address you are accessing the **Firewall
    settings** from is displayed in the **Client IP address** field. Click on the
    **Add client IP** to add your current machine's IP address to allow it through
    the firewall. You can change the **RULE NAME** to something more user friendly:![How
    to do it…](img/B05391_13_12.jpg)
  id: totrans-24
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**显示防火墙设置**，你会看到你可以添加客户端 IP。默认情况下，你访问**防火墙设置**时显示的机器 IP 地址将在**客户端 IP 地址**字段中。点击**添加客户端
    IP**以将你当前机器的 IP 地址添加到防火墙中允许通过。你可以将**规则名称**改为更友好的名称：![如何操作…](img/B05391_13_12.jpg)
- en: Note
  id: totrans-25
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: You can also define a different IP address here to give a colleague access to
    this database from their machine.
  id: totrans-26
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 你也可以在此处定义不同的 IP 地址，以便同事可以从他们的机器访问此数据库。
- en: After you have added your firewall rules, open up SQL Server Management Studio
    on your local development machine. In the **Object Explorer**, click on the **Connect
    Object Explorer** button:![How to do it…](img/B05391_13_13.jpg)
  id: totrans-27
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在你已经添加了防火墙规则后，在你的本地开发机器上打开 SQL Server Management Studio。在**对象资源管理器**中，点击**连接对象资源管理器**按钮：![如何操作…](img/B05391_13_13.jpg)
- en: Have a look at the connection string you made a note of earlier. After the server
    portion in the connection string, I copied the server name as `tcp:srvcookbook.database.windows.net`.
    Paste that in the **Server** **name** field in the **Connect to Server** screen.
    Lastly, enter the **Login** and **Password** you defined when creating the server
    on Azure. Click on the **Connect** button:![How to do it…](img/B05391_13_14.jpg)
  id: totrans-28
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 看一下你之前记下的连接字符串。在连接字符串的服务器部分之后，我将服务器名称复制为 `tcp:srvcookbook.database.windows.net`。将其粘贴到**连接到服务器**屏幕中的**服务器名称**字段。最后，输入你在
    Azure 上创建服务器时定义的**登录名**和**密码**。点击**连接**按钮：![如何操作…](img/B05391_13_14.jpg)
- en: SQL Server Management Studio will now connect to the `CookbookDb` database on
    Azure:![How to do it…](img/B05391_13_15.jpg)
  id: totrans-29
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: SQL Server Management Studio 将现在连接到 Azure 上的 `CookbookDb` 数据库：![如何操作…](img/B05391_13_15.jpg)
- en: How it works…
  id: totrans-30
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的…
- en: 'Azure is the perfect place to store your database. It is secure and accessible
    to only those developers you choose. You need to be aware that if your IP address
    changes, you might need to reconfigure the firewall rule on your Azure database.
    This does, however, bode well for security, because you can be assured that your
    data is secure. For more information on databases in Azure, have a look at the
    following documentation: [https://azure.microsoft.com/en-us/documentation/services/sql-database/](https://azure.microsoft.com/en-us/documentation/services/sql-database/).'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: Azure 是存储数据库的完美之地。它安全，并且只有你选择的开发者可以访问。你需要意识到，如果你的 IP 地址发生变化，你可能需要重新配置 Azure
    数据库上的防火墙规则。然而，这对安全性来说是个好兆头，因为你可以确信你的数据是安全的。有关 Azure 中数据库的更多信息，请参阅以下文档：[https://azure.microsoft.com/en-us/documentation/services/sql-database/](https://azure.microsoft.com/en-us/documentation/services/sql-database/)。
- en: Creating a web application and hosting on Azure
  id: totrans-32
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在 Azure 上创建网络应用并进行托管
- en: One of the things a web developer does more often than not is to deploy a web
    application for (**user acceptance testing**) **UAT** or developer testing purposes.
    Azure makes this process very convenient for you by providing a seamless publishing
    experience from within Visual Studio. To publish a web application or website
    to Azure, you first need to create a web application on Azure to publish your
    website to.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 网络开发者经常要做的事情之一是为（**用户验收测试**）**UAT**或开发者测试目的部署网络应用。Azure 通过在 Visual Studio 内提供无缝的发布体验，使这个过程对你来说非常方便。要将网络应用或网站发布到
    Azure，你首先需要在 Azure 上创建一个网络应用来发布你的网站。
- en: Getting ready
  id: totrans-34
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: 'To start working with Azure, you will need to have an Azure account. You can
    create a free trial account. For more information on Azure pricing, have a look
    at the following URL: [https://azure.microsoft.com/en-us/pricing/](https://azure.microsoft.com/en-us/pricing/).'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 要开始使用 Azure，你需要有一个 Azure 账户。你可以创建一个免费试用账户。有关 Azure 定价的更多信息，请查看以下 URL：[https://azure.microsoft.com/en-us/pricing/](https://azure.microsoft.com/en-us/pricing/)。
- en: How to do it…
  id: totrans-36
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作…
- en: After you have logged in to your Azure account, you will be taken to your **Dashboard**.
    From here you can see any items you may have pinned. To the left, you will see
    the menu. We want to create a website, so click on the **App Services** menu item:![How
    to do it…](img/B05391_13_16.jpg)
  id: totrans-37
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 登录到你的 Azure 账户后，你将被带到你的**仪表板**。从这里你可以看到你可能已经固定的任何项目。在左侧，你会看到一个菜单。我们想要创建一个网站，所以点击**应用服务**菜单项：![如何操作…](img/B05391_13_16.jpg)
- en: If this is your first time using Azure, you probably will not have any app services
    to display. Click on **Add** to create a new one:![How to do it…](img/B05391_13_17.jpg)
  id: totrans-38
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果你第一次使用 Azure，你可能不会显示任何应用服务。点击**添加**来创建一个新的：![如何操作…](img/B05391_13_17.jpg)
- en: Give the app service a name and select or create a **Resource Group**:![How
    to do it…](img/B05391_13_18.jpg)
  id: totrans-39
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 给应用服务起一个名字，并选择或创建一个**资源组**：![如何操作…](img/B05391_13_18.jpg)
- en: When you click the **Create** button, Azure starts the deployment. This process
    can take several minutes to complete, so go grab a cup of coffee while you wait:![How
    to do it…](img/B05391_13_19.jpg)
  id: totrans-40
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 当你点击**创建**按钮时，Azure 开始部署。这个过程可能需要几分钟才能完成，所以你可以趁等待的时候去拿一杯咖啡：![如何操作…](img/B05391_13_19.jpg)
- en: When the deployment is finished, you will receive a notification in the notifications
    menu:![How to do it…](img/B05391_13_20.jpg)
  id: totrans-41
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 部署完成后，你将在通知菜单中收到通知：![如何操作…](img/B05391_13_20.jpg)
- en: Refreshing the **App Services** section, you will see the **cookbookdemo** web
    app that we have just created. You might need to click on the **Refresh** button
    before the **cookbookdemo** web app becomes visible:![How to do it…](img/B05391_13_21.jpg)
  id: totrans-42
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 刷新**应用服务**部分，你会看到我们刚刚创建的**cookbookdemo**网络应用。你可能需要点击**刷新**按钮，**cookbookdemo**网络应用才会变得可见：![如何操作…](img/B05391_13_21.jpg)
- en: Clicking on the **cookbookdemo** web app will display the properties. Take special
    notice of the **URL** in the upper-right corner:![How to do it…](img/B05391_13_22.jpg)
  id: totrans-43
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**cookbookdemo**网络应用将显示属性。特别注意右上角的**URL**：![如何操作…](img/B05391_13_22.jpg)
- en: If you click on this URL, you will be taken to the default placeholder site
    for your web application. It is time to publish our website to Azure:![How to
    do it…](img/B05391_13_23.jpg)
  id: totrans-44
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果你点击这个 URL，你将被带到你的网络应用的默认占位符网站。是时候将我们的网站发布到 Azure 了：![如何操作…](img/B05391_13_23.jpg)
- en: Start Visual Studio and create or open a website you want to publish. I have
    created a simple website that I want to publish:![How to do it…](img/B05391_13_24.jpg)
  id: totrans-45
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启动 Visual Studio 并创建或打开你想要发布的网站。我已经创建了一个简单的网站，想要发布：![如何操作…](img/B05391_13_24.jpg)
- en: Right-click on your website project and click on **Publish** **Web App** from
    the context menu:![How to do it…](img/B05391_13_25.jpg)
  id: totrans-46
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 右键单击你的网站项目，然后从上下文菜单中选择**发布** **Web应用程序**：![如何做…](img/B05391_13_25.jpg)
- en: The **Publish Web**screen is displayed. Here you can see various publish targets
    available to you. We simply want to publish our application to Azure. Select **Microsoft
    Azure Web Apps** as a publish target:![How to do it…](img/B05391_13_26.jpg)
  id: totrans-47
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**发布Web**屏幕将显示。在这里，你可以看到可用的各种发布目标。我们只想将我们的应用程序发布到Azure。选择**Microsoft Azure
    Web Apps**作为发布目标：![如何做…](img/B05391_13_26.jpg)'
- en: Clicking on **Next** will either ask you to connect to Azure or, if you have
    previously connected, select your **Subscription** from the drop-down selection.
    Any existing web apps are displayed in the **Existing Web Apps** list. The **cookbookdemo**
    web app we created earlier is displayed:![How to do it…](img/B05391_13_27.jpg)
  id: totrans-48
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**下一步**将要求你连接到Azure，或者如果你之前已经连接，则从下拉选择中选择你的**订阅**。任何现有的Web应用程序都将显示在**现有Web应用程序**列表中。我们之前创建的**cookbookdemo**
    Web应用程序将显示：![如何做…](img/B05391_13_27.jpg)
- en: Selecting the **cookbookdemo** web app, you now have to define your web app
    connection and **Publish method**. For now, we will just select **Web Deploy**
    as our method for publishing our web application to Azure:![How to do it…](img/B05391_13_28.jpg)
  id: totrans-49
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择**cookbookdemo** Web应用程序，你现在必须定义你的Web应用程序连接和**发布方法**。目前，我们将仅选择**Web Deploy**作为将我们的Web应用程序发布到Azure的方法：![如何做…](img/B05391_13_28.jpg)
- en: You can also click on the **Validate Connection** button to make sure everything
    is in order before continuing:![How to do it…](img/B05391_13_29.jpg)
  id: totrans-50
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你还可以点击**验证连接**按钮，确保一切就绪后再继续：![如何做…](img/B05391_13_29.jpg)
- en: Clicking **Next** takes you to the **Settings** screen. Here you can select
    a **Configuration** to deploy, as well as define a database connection:![How to
    do it…](img/B05391_13_30.jpg)
  id: totrans-51
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**下一步**将带你进入**设置**屏幕。在这里，你可以选择要部署的**配置**，以及定义数据库连接：![如何做…](img/B05391_13_30.jpg)
- en: Note
  id: totrans-52
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: As you will notice, the database connection I am using is the connection to
    the database we created in the first recipe of this chapter, *Creating a database
    in Azure for testing*.
  id: totrans-53
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 正如你所注意到的，我正在使用的数据库连接是我们在本章第一个菜谱中创建的数据库的连接，*在Azure中创建数据库进行测试*。
- en: When you click **Next**, you will see that you can preview the files that are
    to be published to the web application on Azure. The initial publish will obviously
    contain the most files, as nothing exists on the web application yet:![How to
    do it…](img/B05391_13_31.jpg)
  id: totrans-54
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 当你点击**下一步**时，你会看到你可以预览要发布到Azure Web应用程序上的文件。初始发布显然包含最多的文件，因为Web应用程序上还没有任何内容：![如何做…](img/B05391_13_31.jpg)
- en: When you are ready, clicking on the **Publish** button will start the process
    of publishing your website to Azure. This can also take a few minutes to complete.
    When the publish has completed, Visual Studio will automatically open the published
    website:![How to do it…](img/B05391_13_32.jpg)
  id: totrans-55
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 当你准备好时，点击**发布**按钮将开始将你的网站发布到Azure的过程。这可能需要几分钟才能完成。发布完成后，Visual Studio将自动打开已发布的网站：![如何做…](img/B05391_13_32.jpg)
- en: Back in Azure, you will see the **Monitoring** window spring to life. You can
    also add other sections here that will provide more information about the state
    of your web application:![How to do it…](img/B05391_13_33.jpg)
  id: totrans-56
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 回到Azure，你会看到**监控**窗口活跃起来。你还可以在此处添加其他部分，以提供更多关于你的Web应用程序状态的信息：![如何做…](img/B05391_13_33.jpg)
- en: How it works…
  id: totrans-57
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的…
- en: 'Azure puts a lot of power into the hands of the developer when deploying to
    Azure. You can add additional sections that assist in the management of your web
    application. These are displayed to you as tiles. Some of the sections available
    are:'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 当你在Azure上部署时，Azure将大量权力交到开发者手中。你可以添加额外的部分来帮助管理你的Web应用程序。这些部分以瓷砖的形式显示给你。一些可用的部分包括：
- en: Process Explorer
  id: totrans-59
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 进程资源管理器
- en: WebJobs
  id: totrans-60
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Web作业
- en: Traffic routing
  id: totrans-61
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 流量路由
- en: Requests and errors
  id: totrans-62
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 请求和错误
- en: Http 4xx
  id: totrans-63
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Http 4xx
- en: Http 5xx
  id: totrans-64
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Http 5xx
- en: Filesystem storage
  id: totrans-65
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 文件系统存储
- en: Web tests
  id: totrans-66
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Web测试
- en: Users and roles
  id: totrans-67
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 用户和角色
- en: Performance tests
  id: totrans-68
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 性能测试
- en: Even your estimated Azure spend
  id: totrans-69
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 即使是你的预估Azure支出
- en: Azure is truly a very versatile cloud solution for developers, no matter what
    your individual needs.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: Azure确实是一个非常灵活的云解决方案，无论你的个人需求如何。
- en: Using virtual machines on Azure
  id: totrans-71
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在Azure上使用虚拟机
- en: A **virtual machine** (**VM**) is indispensable to developers. I have a few
    myself that I use for my personal use and to try out new software. The technology
    behind it is quite incredible as it virtualizes a specific environment for you
    to accurately test your applications against. At my previous employer, we would
    create VMs of certain client environments in order to test application deployment
    and basically to see whether the application works correctly.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: '**虚拟机**（**VM**）对于开发者来说是必不可少的。我自己有几个用于个人使用和尝试新软件。其背后的技术相当令人难以置信，因为它为您虚拟化了一个特定的环境，以便您可以准确测试您的应用程序。在我之前的工作单位，我们会创建特定客户端环境的
    VM，以便测试应用程序部署，基本上是看看应用程序是否正确运行。'
- en: With Azure, developers have so many choices when deciding on a specific VM platform.
    You can spin up virtually (pun intended) any type of VM you need. If you want
    to test out the new Visual Studio, you can. A new version of Windows? You can
    bet there will be a VM on Azure for that. Want to play around with Linux and WordPress
    a bit? No problem. Azure does it all and it is incredibly easy to set up.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 Azure，开发者在决定特定的 VM 平台时有很多选择。您几乎可以启动任何类型的 VM。如果您想尝试新的 Visual Studio，您可以。Windows
    的新版本？您可以在 Azure 上找到相应的 VM。想稍微玩一下 Linux 和 WordPress？没问题。Azure 可以做到这一切，并且设置起来非常简单。
- en: Consider the alternative. If VMs weren't there and you wanted to test an application
    on an OS such as Windows 10, you would probably have to set aside a specific machine
    just for testing different OS versions. That's one machine not available to you
    anymore for other work. Then you need to spend an hour or two setting up that
    PC with the correct OS. You then need to set the PC up to be available over the
    local network at your office. What about if you wanted to access that test machine
    from a remote location (at home for example)? You would need to configure it to
    be accessible remotely while still maintaining security. So then you set up a
    VPN to access the machine remotely on the off chance that the developers need
    to work after hours. This has to be done for a single instance of an application
    in development. If you have servers to spare, sure, this might not be a problem.
    If, however, you are a small-to-medium-sized company with limited resources, chances
    are you'll be reinstalling that machine soon with a different client's setup for
    testing.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 考虑一下替代方案。如果不存在 VM，您想在 Windows 10 这样的操作系统上测试应用程序，您可能需要留出一台特定的机器来测试不同的操作系统版本。这样，您就失去了一台机器，不能再用于其他工作了。然后您需要花上一两个小时设置这台
    PC，安装正确的操作系统。然后您需要设置这台 PC，使其在您的办公室的本地网络中可用。如果您想从远程位置（例如家中）访问这台测试机器怎么办？您需要配置它以便远程访问，同时保持安全性。因此，您设置了
    VPN，以便在开发者需要加班工作时远程访问这台机器。这必须为正在开发中的应用程序的单个实例完成。如果您有可用的服务器，当然，这可能不是问题。然而，如果您是一家资源有限的小到中型公司，您可能会很快重新安装这台机器，为不同的客户端设置进行测试。
- en: This is where Azure is brilliant at making a difference. The setup process takes
    a few minutes, a moment compared to the setup required for a PC at your office.
    Remote access, security, event monitoring, alerts, and a whole bunch of other
    features are immediately available to all the developers in your team.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 这就是 Azure 在创造差异方面表现得非常出色的地方。设置过程只需几分钟，与在办公室设置一台 PC 相比，这只是瞬间的事情。远程访问、安全性、事件监控、警报以及许多其他功能立即对您团队中的所有开发者可用。
- en: Getting ready
  id: totrans-76
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: 'To start working with Azure, you will need to have an Azure account. You can
    create a free trial account. For more information on Azure pricing, have a look
    at the following URL: [https://azure.microsoft.com/en-us/pricing/](https://azure.microsoft.com/en-us/pricing/).'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 要开始使用 Azure，您需要一个 Azure 账户。您可以创建一个免费试用账户。有关 Azure 定价的更多信息，请查看以下网址：[https://azure.microsoft.com/en-us/pricing/](https://azure.microsoft.com/en-us/pricing/).
- en: How to do it…
  id: totrans-78
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: After you have logged in to your Azure account, you will be taken to your **Dashboard**.
    From here you can see any items you may have pinned. To the left you will see
    the menu. Click on the **Virtual machines** menu item:![How to do it…](img/B05391_13_34.jpg)
  id: totrans-79
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 登录您的 Azure 账户后，您将被带到您的**仪表板**。从这里您可以查看您可能已固定的任何项目。在左侧您将看到菜单。点击**虚拟机**菜单项：![如何操作…](img/B05391_13_34.jpg)
- en: You will then be taken to the default directory for the virtual machines on
    your Azure subscription. We need to create a new virtual machine by clicking on
    the **Add** button:![How to do it…](img/B05391_13_35.jpg)
  id: totrans-80
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后，您将被带到 Azure 订阅中虚拟机的默认目录。我们需要通过点击**添加**按钮来创建一个新的虚拟机：![如何操作…](img/B05391_13_35.jpg)
- en: Azure then displays all the types of virtual machine available to you. There
    are quite a lot of types of machine to choose from. From Service Fabric, to Linux,
    to Ubuntu, the choice is vast:![How to do it…](img/B05391_13_36.jpg)
  id: totrans-81
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Azure 会显示所有可供您使用的虚拟机类型。可供选择的主机类型相当多。从服务网格到 Linux，再到 Ubuntu，选择范围很广：![如何操作…](img/B05391_13_36.jpg)
- en: For our purposes, we will just create a Windows virtual machine:![How to do
    it…](img/B05391_13_37.jpg)
  id: totrans-82
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对于我们的目的，我们只需创建一个 Windows 虚拟机：![如何操作…](img/B05391_13_37.jpg)
- en: Clicking on the **Windows** group, you can see that we have a choice of Windows
    10 Enterprise or Windows 8.1 Enterprise 64-bit VMs. We will simply select the
    Windows 10 VM to get started:![How to do it…](img/B05391_13_38.jpg)
  id: totrans-83
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**Windows**组，您可以看到我们有两个选择：Windows 10 企业版或 Windows 8.1 企业版 64 位虚拟机。我们将简单地选择
    Windows 10 虚拟机以开始操作：![如何操作…](img/B05391_13_38.jpg)
- en: You will now be asked to enter various settings to configure your Windows 10
    VMs. Give your VM a name and define a login user and password. The **Resource
    group** will allow you to select an existing one or create a new one:![How to
    do it…](img/B05391_13_39.jpg)
  id: totrans-84
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您现在将被要求输入各种设置以配置您的 Windows 10 虚拟机。为您的虚拟机命名并定义登录用户名和密码。**资源组**将允许您选择一个现有的资源组或创建一个新的资源组：![如何操作…](img/B05391_13_39.jpg)
- en: On the next configuration screen, you will be presented with recommended VM
    sizes, each with their different pricing option displayed in your local currency.
    Choose the option that is most suitable for you, your requirements, and/or budget.
  id: totrans-85
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在下一个配置屏幕上，您将看到推荐的虚拟机大小，每个大小都有其不同的定价选项以您所在地区的货币显示。选择最适合您、您的需求或/和预算的选项。
- en: 'The next screen allows you to configure optional features. The features available
    to you are the following:'
  id: totrans-86
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 下一屏允许您配置可选功能。您可用的功能如下：
- en: Storage account is where the disks for the VM are created.
  id: totrans-87
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 存储账户是创建虚拟机磁盘的地方。
- en: Virtual network acts much like a traditional network. Any VMs in the same virtual
    network will be able to access each other, and this is configured by default.
  id: totrans-88
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 虚拟网络与传统网络类似。同一虚拟网络中的任何虚拟机都可以相互访问，并且默认情况下已配置。
- en: Subnet allows you to isolate VM from other VMs or the Internet.
  id: totrans-89
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 子网允许您将虚拟机与其他虚拟机或互联网隔离。
- en: Public IP address allows you to communicate with a machine outside the virtual
    network defined previously.
  id: totrans-90
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 公共 IP 地址允许您与之前定义的虚拟网络之外的机器进行通信。
- en: Network security group is a collection of rules defined on your firewall that
    controls who can access your Windows 10 virtual machine.
  id: totrans-91
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 网络安全组是在您的防火墙上定义的一组规则，用于控制谁可以访问您的 Windows 10 虚拟机。
- en: Extensions are quite nice. These are additional add-ons, such as antivirus packages.
  id: totrans-92
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 扩展相当不错。这些是额外的附加组件，例如防病毒软件包。
- en: Monitoring is on by default and allows you to gather information about your
    VM and define alerts based on the information monitored. This keeps you in control
    and informed at all times.
  id: totrans-93
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 监控默认开启，允许您收集有关虚拟机的信息，并根据监控信息定义警报。这使您始终处于控制状态并保持信息畅通。
- en: The diagnostics storage account is where the monitoring metrics are stored.
    You can then analyze these with any of your own tools if needed.
  id: totrans-94
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 诊断存储账户是监控指标存储的地方。如果需要，您可以使用自己的工具分析这些指标。
- en: 'The availability setting allows you to cluster two or more VMs together to
    provide a failover if one of the VMs needs to be taken offline for maintenance.
    This need to be configured at this step because the availability setting can''t
    be changed after the VM is created:'
  id: totrans-95
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 可用性设置允许您将两个或更多虚拟机集群在一起，以便在其中一个虚拟机需要离线进行维护时提供故障转移。此步骤需要配置，因为创建虚拟机后无法更改可用性设置：
- en: '![How to do it…](img/B05391_13_41.jpg)'
  id: totrans-96
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![如何操作…](img/B05391_13_41.jpg)'
- en: Once you have configured the VM, you will be presented with a summary of the
    configuration options you selected during setup:![How to do it…](img/B05391_13_42.jpg)
  id: totrans-97
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦您配置了虚拟机，您将看到在设置过程中选择的配置选项的摘要：![如何操作…](img/B05391_13_42.jpg)
- en: When you are satisfied that the VM is set up correctly, Azure will then start
    the deployment process:![How to do it…](img/B05391_13_43.jpg)
  id: totrans-98
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 当您确认虚拟机已正确设置后，Azure 将开始部署过程：![如何操作…](img/B05391_13_43.jpg)
- en: The progress of the deployment process is also visible on the **Dashboard**
    and takes a few minutes to complete:![How to do it…](img/B05391_13_44.jpg)
  id: totrans-99
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 部署过程的进度也可见于**仪表板**，并需要几分钟才能完成：![如何操作…](img/B05391_13_44.jpg)
- en: After a few minutes, the VM is available and ready. You will be taken to the
    virtual machine page for your **cookbookvm**:![How to do it…](img/B05391_13_45.jpg)
  id: totrans-100
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 几分钟后，虚拟机将可用并准备就绪。您将被带到**cookbookvm**的虚拟机页面：![如何操作…](img/B05391_13_45.jpg)
- en: To connect to your VM, click on the **Connect** button:![How to do it…](img/B05391_13_46.jpg)
  id: totrans-101
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要连接到您的虚拟机，请点击**连接**按钮：![如何操作…](img/B05391_13_46.jpg)
- en: An `.rdp` file is then downloaded. You can click on the file directly to start
    the **Remote Desktop Connection** session:![How to do it…](img/B05391_13_47.jpg)
  id: totrans-102
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后将下载一个`.rdp`文件。您可以直接点击该文件以启动**远程桌面连接**会话：![如何操作…](img/B05391_13_47.jpg)
- en: You will probably be asked whether you trust the publisher of the remote connection.
    Obviously you do, so just click on the **Connect** button:![How to do it…](img/B05391_13_48.jpg)
  id: totrans-103
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你可能会被问到是否信任远程连接的出版商。显然你是信任的，所以只需点击**连接**按钮：![如何操作…](img/B05391_13_48.jpg)
- en: You will now be able to enter your login credentials, as defined earlier during
    the VM setup:![How to do it…](img/B05391_13_49.jpg)
  id: totrans-104
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，您将能够输入之前在虚拟机设置期间定义的登录凭据：![如何操作…](img/B05391_13_49.jpg)
- en: You will now be connected to the Windows 10 virtual machine via Remote Desktop
    Connection:![How to do it…](img/B05391_13_50.jpg)
  id: totrans-105
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，您将通过远程桌面连接连接到Windows 10虚拟机：![如何操作…](img/B05391_13_50.jpg)
- en: Back in Azure, if you selected the **Monitoring** option during the VM setup,
    you will see that you have a default **Monitoring** tile for **CPU percentage**.
    Azure allows you to add more monitoring events and create alerts for each event:![How
    to do it…](img/B05391_13_51.jpg)
  id: totrans-106
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在Azure中，如果您在虚拟机设置期间选择了**监控**选项，您会看到有一个默认的**监控**选项卡用于**CPU百分比**。Azure允许您添加更多监控事件并为每个事件创建警报：![如何操作…](img/B05391_13_51.jpg)
- en: How it works…
  id: totrans-107
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的…
- en: Virtual machines are accessible via remote connections. You can use the good
    old Remote Desktop Connection, or something more exotic such as mRemoteNG if you
    have several remote machines that you need to access. The reason that Azure is
    so well suited for development testing is because the resource does not have to
    live on your own network at all. That means the overhead involved in maintaining
    backups of development VMs is largely avoided.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 虚拟机可以通过远程连接访问。您可以使用传统的远程桌面连接，或者如果您需要访问多个远程机器，可以使用更复杂的工具如mRemoteNG。Azure非常适合开发测试的原因在于，资源根本不需要存在于您的本地网络中。这意味着维护开发虚拟机备份的开销在很大程度上被避免了。
- en: I remember the network administrator at my previous employer regularly asking
    what VMs we still used. Some of these VMs were used perhaps once or twice a year,
    so they couldn't be deleted. Having several developers access these VMs also meant
    that there was a lot of junk on these VMs, which made backing those up a painful
    process (usually run over weekends).
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 我记得在我之前雇主那里工作的网络管理员经常询问我们还在使用哪些虚拟机。其中一些虚拟机可能一年只用上一两次，所以不能删除。有多个开发者访问这些虚拟机也意味着这些虚拟机上有很多垃圾文件，这使得备份这些虚拟机变得痛苦不堪（通常在周末进行）。
- en: Azure solves many issues and problems for IT professionals. In this chapter,
    we have looked at only three solutions available to you as a developer. Do not
    be fooled, Azure is much more powerful than just being able to provide a robust
    testing platform for developers. Going into detail about Azure would probably
    require a separate book on its own.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: Azure为IT专业人员解决了许多问题和难题。在本章中，我们只探讨了您作为开发者可用的三种解决方案。不要被误导，Azure的功能远不止为开发者提供一个强大的测试平台。详细探讨Azure可能需要一本单独的书。
