<html><head></head><body>
		<div id="_idContainer087">
			<h1 class="chapter-number" id="_idParaDest-302"><a id="_idTextAnchor303"/>14</h1>
			<h1 id="_idParaDest-303"><a id="_idTextAnchor304"/>The One with the Linux Leaps</h1>
			<p><em class="italic">Systems Programming in C# </em><span class="No-Break"><em class="italic">on Linux</em></span></p>
			<p>I remember the time when only the really cool kids worked on Linux. Windows was for serious people. That was where the work was done. Sure, many servers ran Unix or Linux, but those working on those platforms were considered somewhat weird. They usually had beards, wore sandals, and spoke a language none of the rest of the people had <span class="No-Break">ever heard.</span></p>
			<p>OK, maybe I am exaggerating. Perhaps this shows how I felt about Linux or how intimidated I was by that operating system and its users. Linux has always been considered a more mature but complex operating system. It is more secure, faster, and better to maintain. It is also more complicated to use. Most of the work is done in the command line, although graphical user <span class="No-Break">interfaces exist.</span></p>
			<p>These days, things are different. Linux is everywhere. And for good reasons, too – Linux is an excellent operating system to run your system in the current online, <span class="No-Break">connected world.</span></p>
			<p>With the introduction of <strong class="bold">.NET Core</strong> and <strong class="bold">.NET 5</strong>, developers who traditionally only used Windows can also compile their code to run on Linux. And that opens up a whole <span class="No-Break">new world.</span></p>
			<p>Of course, there are downsides. Linux is more complex than Windows, especially if you have worked on Windows for a long time. Even though .NET can run on Linux, not all the classes and tools you might be used to <span class="No-Break">are available.</span></p>
			<p>This chapter is meant to help you get on your way should you want to run your .NET applications on Linux. Don’t worry – I do not want you to start wearing sandals or become a typical 1970s-type developer. That is entirely optional. So, let’s get your inner penguin out and start hacking <span class="No-Break">on Linux!</span></p>
			<p>In this chapter, we will ask the <span class="No-Break">following questions:</span></p>
			<ul>
				<li>What <span class="No-Break">is Linux?</span></li>
				<li>How do I do basic things <span class="No-Break">in Linux?</span></li>
				<li>How do I develop <span class="No-Break">for Linux?</span></li>
				<li>How do I deploy <span class="No-Break">to Linux?</span></li>
				<li>How can I write background services <span class="No-Break">for Linux?</span></li>
			</ul>
			<p>This chapter contains some history, some theory, and a lot of practical information and samples. Are you ready to <span class="No-Break">follow along?</span></p>
			<h1 id="_idParaDest-304"><a id="_idTextAnchor305"/>Technical requirements</h1>
			<p>You will find all the code in this chapter in our repository  at this <span class="No-Break">URL: </span><a href="https://github.com/PacktPublishing/Systems-Programming-with-C-Sharp-and-.NET/tree/main/SystemsProgrammingWithCSharpAndNet/Chapter14"><span class="No-Break">https://github.com/PacktPublishing/Systems-Programming-with-C-Sharp-and-.NET/tree/main/SystemsProgrammingWithCSharpAndNet/Chapter14</span></a><span class="No-Break">.</span></p>
			<p>If you want to follow along, you need a Linux machine. But during development, you actually do not need that. All you need is WSL. <strong class="bold">WSL</strong> stands for <strong class="bold">Windows Subsystem for Linux</strong>. The official name is WSL2, as we are at version 2 these days, but let’s stick with <span class="No-Break">WSL here.</span></p>
			<p>WSL is a lightweight virtual machine that runs a Linux distribution (I will explain what that is later on) on your Windows machine. You can quickly move to that machine and use it like a “real” Linux machine. You can even deploy directly from Visual Studio and debug your apps <span class="No-Break">on WSL.</span></p>
			<p>To install WSL, follow <span class="No-Break">these steps:</span></p>
			<ol>
				<li>In Powershell, use the <strong class="source-inline">wsl --install</strong> command (you have to be an administrator to do this). Be aware that this might take a couple of gigabytes of hard disk space on <span class="No-Break">your machine.</span></li>
			</ol>
			<p>And that’s it. No <em class="italic">step 2</em>. You can now go to the <strong class="bold">Start</strong> menu and search for <strong class="source-inline">Ubuntu</strong>. That looks <span class="No-Break">like this:</span></p>
			<div>
				<div class="IMG---Figure" id="_idContainer082">
					<img alt="Figure 1﻿4.1: Running Ubuntu from the Windows Start menu" src="image/B20924_15_1.jpg"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.1: Running Ubuntu from the Windows Start menu</p>
			<p>Alternatively, you can install other versions of Linux, but I will use <strong class="bold">Ubuntu 20.04</strong> in this book. What you pick doesn’t matter; just do what you feel most <span class="No-Break">comfortable with.</span></p>
			<p>Alternatively, you can create a virtual machine using HyperV, deploy a Docker container with Linux, get a second machine to install Linux on, or run Linux from a bootable USB stick. The choice <span class="No-Break">is yours.</span></p>
			<h1 id="_idParaDest-305"><a id="_idTextAnchor306"/>An overview of Linux</h1>
			<p>Before<a id="_idIndexMarker1127"/> discussing how to program for Linux, we should discuss what it is. The short answer is that it is an operating system. While that is absolutely true, it does not sufficiently explain all that Linux can do. I can say that a bike is a transporting device, but that also applies to the Saturn 5 rocket that took astronauts to the moon. We need a bit <span class="No-Break">more information.</span></p>
			<h2 id="_idParaDest-306"><a id="_idTextAnchor307"/>A short history of Linux</h2>
			<p>The history <a id="_idIndexMarker1128"/>of Linux is quite fascinating. Understanding the timeline and circumstances under which it was developed can help you appreciate some of the design decisions and choices. So, here is a short timeline of the history <span class="No-Break">of Linux:</span></p>
			<ol>
				<li><span class="No-Break"><strong class="bold">Early beginnings</strong></span><ul><li>In 1983, Richard Stallman announced the GNU Project. The idea was to create a free Unix-like operating system. Unix was the leading operating system in those days. The GNU Project developed many components, but one key piece, the kernel, <span class="No-Break">was missing.</span></li><li>In 1987, Andrew S. Tanenbaum created Minix. Minix was a Unix-like system. It was intended for educational purposes and was very popular among students. One of them was a young man named <span class="No-Break">Linus Torvalds.</span></li></ul></li>
				<li><strong class="bold">The birth </strong><span class="No-Break"><strong class="bold">of Linux</strong></span><ul><li>In 1991, Linus Torvalds, a student at the University of Helsinki in Finland, started developing his kernel. It was just a hobby; he wanted to have something to do. On August 25, 1991, he announced his project in a newsgroup posting, seeking input from others. This is what later became the <span class="No-Break">Linux kernel.</span></li><li>On 5th October, 1991, Torvalds released version 0.02 of Linux. It could run Bash (a terminal) and GCC (<span class="No-Break">a C-compiler).</span></li></ul></li>
				<li><strong class="bold">Development </strong><span class="No-Break"><strong class="bold">and growth</strong></span><ul><li>In 1992, Linux was released under the GNU <strong class="bold">General Public License</strong> (<strong class="bold">GPL</strong>), allowing anyone to use, modify, and distribute <span class="No-Break">the software.</span></li><li>In the <a id="_idIndexMarker1129"/>mid 1990s, Linux snowballed in popularity. Distributions, such as Slackware and Debian, were both released <span class="No-Break">in 1993.</span></li><li>In 1994, Linux version 1.0 was released. It was a significant milestone; this was the first <span class="No-Break">stable release.</span></li></ul></li>
				<li><strong class="bold">Commercial and </strong><span class="No-Break"><strong class="bold">community expansion</strong></span><ul><li>In 1996, Tux the Penguin was chosen as the official <span class="No-Break">Linux mascot.</span></li><li>The late 1990s saw companies such as Red Hat and SUSE begin to offer commercial Linux distributions. Since these also included support, this was the moment enterprises jumped <span class="No-Break">on board.</span></li><li>In 1999, IBM announced support <span class="No-Break">for Linux.</span></li></ul></li>
				<li><strong class="bold">The 21st century and </strong><span class="No-Break"><strong class="bold">mainstream adoption</strong></span><ul><li>In 2001, version 2.4 of the Kernel was released, including USB, PC cards, and other <span class="No-Break">hardware support.</span></li><li>2002–2003 saw major companies such as HP and Dell offering Linux on <span class="No-Break">their servers.</span></li><li>In 2004, Canonical released its Linux distribution, which was way more user-friendly. This enabled the general public to use it <span class="No-Break">as well.</span></li><li>In 2005, Linus Torvalds released a side project called Git. Yes, that Git. The tool you probably use every day. Git was an essential tool for <span class="No-Break">Linux development.</span></li></ul></li>
				<li><strong class="bold">The </strong><span class="No-Break"><strong class="bold">modern era</strong></span><ul><li>In 2011, Linux was the dominant operating system in the server market. It powers the majority of web servers, including those of major companies such as Google, Amazon, <span class="No-Break">and Facebook.</span></li><li>In 2013, Google released Android, a mobile, Linux-based smartphone <span class="No-Break">operating system.</span></li><li>In the 2020s, Linux continues to dominate the server space, cloud infrastructure, supercomputing, and <span class="No-Break">IOT devices.</span></li></ul></li>
			</ol>
			<p>One of the key<a id="_idIndexMarker1130"/> factors that led to the success of Linux was its open source nature. Everybody can look at the sources, download them, adopt them, and do whatever they want. And it is and always will be <span class="No-Break">for free.</span></p>
			<p>Will all this in mind, it is no wonder that we, as system programmers, also need to learn <span class="No-Break">about Linux.</span></p>
			<h2 id="_idParaDest-307"><a id="_idTextAnchor308"/>What is Linux?</h2>
			<p>The name<a id="_idIndexMarker1131"/> Linux itself can be confusing at times. Let me shed some light on that and help you <span class="No-Break">clarify things.</span></p>
			<h3>The Linux kernel</h3>
			<p>The <strong class="bold">Linux kernel</strong> is <a id="_idIndexMarker1132"/>the heart of what we call Linux. It is the core of the operating system. The <a id="_idIndexMarker1133"/>kernel manages the systems’ hardware and resources, such as memory and CPUs. Some of the key responsibilities of the Kernel are <span class="No-Break">as follows:</span></p>
			<ul>
				<li><strong class="bold">Process management</strong>: It decides which process runs and for <span class="No-Break">how long</span></li>
				<li><strong class="bold">Memory management</strong>: It keeps track of every byte in the systems’ memory and manages the allocation and deallocation of <span class="No-Break">memory space</span></li>
				<li><strong class="bold">Device management</strong>: It manages communications with all devices attached to <span class="No-Break">the system</span></li>
				<li><strong class="bold">System calls</strong>: It also provides an interface between the aforementioned systems and the applications that want to <span class="No-Break">use them</span></li>
			</ul>
			<p>The kernel is comparable <a id="_idIndexMarker1134"/>with the <strong class="bold">Windows </strong><span class="No-Break"><strong class="bold">NT kernel</strong></span><span class="No-Break">.</span></p>
			<h3>Other components</h3>
			<p>Linux usually<a id="_idIndexMarker1135"/> comes with a set of other components as well. Some of the most commonly found components are <span class="No-Break">as follows:</span></p>
			<ul>
				<li><strong class="bold">System libraries</strong>: These<a id="_idIndexMarker1136"/> are essential collections of functions that programs can use to perform tasks, such as file handling and mathematical computations. A good example is the GNU C library, the foundation for most C or <span class="No-Break">C++ programs.</span></li>
				<li><strong class="bold">System utilities</strong>: These <a id="_idIndexMarker1137"/>are basic programs necessary for system management. An example is the <strong class="source-inline">init</strong> program. This program manages system startup. Other examples are Bash, a shell program, and various <span class="No-Break">command-line tools.</span></li>
				<li><strong class="bold">Daemons</strong>: These<a id="_idIndexMarker1138"/> are background services that perform various<a id="_idIndexMarker1139"/> tasks, such as handling print jobs, managing network connections, or <span class="No-Break">scheduling tasks.</span></li>
			</ul>
			<p class="callout-heading">Bash? What is that?</p>
			<p class="callout">Names of software or parts in Linux differ from the names you’ll find in Windows. Windows is more serious in its naming, while Linux is more playful. <strong class="bold">Bash</strong>, for instance, stands for <strong class="bold">Bourne Again Shell</strong>, named <a id="_idIndexMarker1140"/>after its creator, Stephen Bourne. He wanted to create a better shell than the most used shell back then – the Thompson shell. So he merged “born again” with his own surname and came up with this new name. You’ll find these kinds of names a lot when working <span class="No-Break">with Linux!</span></p>
			<p>There are a lot more components, and sometimes, the choice of where to place components might seem arbitrary. But in general, this <span class="No-Break">distinction works.</span></p>
			<h3>Added software</h3>
			<p>When you<a id="_idIndexMarker1141"/> install Linux, you often get a lot more software. These are the user-facing programs and the software that the users interact with. There are command-line-based programs and GUI-based programs. Which ones are distributed depends on what package you have downloaded <span class="No-Break">or purchased.</span></p>
			<h3>Distributions</h3>
			<p>A <a id="_idIndexMarker1142"/>Linux <strong class="bold">distribution</strong>, or “<strong class="bold">distro</strong>” for short, is a complete operating system package that includes the Linux Kernel, system libraries, utilities, daemons, and added software. Each distro has its own set of characteristics and is aimed at different kinds of users. In this chapter, I will use Ubuntu. You can easily install this distro – search for <strong class="source-inline">Ubuntu</strong> in the Windows Store and <span class="No-Break">click </span><span class="No-Break"><strong class="bold">Get</strong></span><span class="No-Break">.</span></p>
			<p>Hundreds of distros are available, mostly for free, but some you have to pay for. The following table is a list of the most used distros, grouped by <span class="No-Break">usage category:</span></p>
			<table class="No-Table-Style _idGenTablePara-1" id="table001-13">
				<colgroup>
					<col/>
					<col/>
					<col/>
				</colgroup>
				<thead>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Category</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Distribution</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Description</strong></span></p>
						</td>
					</tr>
				</thead>
				<tbody>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><strong class="bold">General </strong><span class="No-Break"><strong class="bold">desktop use</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">Ubuntu</span></p>
						</td>
						<td class="No-Table-Style">
							<p>Known for its user-friendliness, large community, and <span class="No-Break">robust support</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style"/>
						<td class="No-Table-Style">
							<p><span class="No-Break">Linux Mint</span></p>
						</td>
						<td class="No-Table-Style">
							<p>Based on Ubuntu, popular due to its ease of use and traditional <span class="No-Break">desktop environment</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style"/>
						<td class="No-Table-Style">
							<p><span class="No-Break">Fedora</span></p>
						</td>
						<td class="No-Table-Style">
							<p>Known for its cutting-edge features and close relationship with <span class="No-Break">Red Hat</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Lightweight</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">Lubuntu</span></p>
						</td>
						<td class="No-Table-Style">
							<p>A lighter, faster, and energy-saving variant of Ubuntu that <span class="No-Break">uses LXQt</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style"/>
						<td class="No-Table-Style">
							<p><span class="No-Break">Xubuntu</span></p>
						</td>
						<td class="No-Table-Style">
							<p>An official Ubuntu variant that uses the XFCE <span class="No-Break">desktop environment</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style"/>
						<td class="No-Table-Style">
							<p><span class="No-Break">Puppy Linux</span></p>
						</td>
						<td class="No-Table-Style">
							<p>Extremely lightweight, designed to run on <span class="No-Break">older hardware</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><strong class="bold">Privacy </strong><span class="No-Break"><strong class="bold">and security</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">Tails</span></p>
						</td>
						<td class="No-Table-Style">
							<p>Aimed at preserving privacy and anonymity, based <span class="No-Break">on Debian</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style"/>
						<td class="No-Table-Style">
							<p><span class="No-Break">Qubes OS</span></p>
						</td>
						<td class="No-Table-Style">
							<p>Focuses on security through isolation, using <span class="No-Break">virtual machines</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style"/>
						<td class="No-Table-Style">
							<p><span class="No-Break">Kali Linux</span></p>
						</td>
						<td class="No-Table-Style">
							<p>Designed for penetration testing and <span class="No-Break">security auditing</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><strong class="bold">Server </strong><span class="No-Break"><strong class="bold">and enterprise</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>CentOS/AlmaLinux/Rocky <span class="No-Break">Linux</span></p>
						</td>
						<td class="No-Table-Style">
							<p>Community-supported rebuilds of <strong class="bold">Red Hat Enterprise </strong><span class="No-Break"><strong class="bold">Linux</strong></span><span class="No-Break"> (</span><span class="No-Break"><strong class="bold">RHEL</strong></span><span class="No-Break">)</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style"/>
						<td class="No-Table-Style">
							<p><span class="No-Break">Ubuntu Server</span></p>
						</td>
						<td class="No-Table-Style">
							<p>The server edition of Ubuntu, known for its ease of use and <span class="No-Break">broad support</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style"/>
						<td class="No-Table-Style">
							<p><span class="No-Break">Debian</span></p>
						</td>
						<td class="No-Table-Style">
							<p>Known for its stability and robustness, often used <span class="No-Break">on servers</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Development</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">Arch Linux</span></p>
						</td>
						<td class="No-Table-Style">
							<p>Favored by developers for its simplicity <span class="No-Break">and control</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style"/>
						<td class="No-Table-Style">
							<p><span class="No-Break">Fedora</span></p>
						</td>
						<td class="No-Table-Style">
							<p>Offers cutting-edge software <span class="No-Break">and technologies</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style"/>
						<td class="No-Table-Style">
							<p><span class="No-Break">openSUSE</span></p>
						</td>
						<td class="No-Table-Style">
							<p>Known for its developer-friendly tools and YaST <span class="No-Break">configuration tool</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><strong class="bold">Media </strong><span class="No-Break"><strong class="bold">production</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">Ubuntu Studio</span></p>
						</td>
						<td class="No-Table-Style">
							<p>Specifically tailored for audio, video, and <span class="No-Break">graphic design</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style"/>
						<td class="No-Table-Style">
							<p><span class="No-Break">AV Linux</span></p>
						</td>
						<td class="No-Table-Style">
							<p>Custom-built for multimedia <span class="No-Break">content creators</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style"/>
						<td class="No-Table-Style">
							<p>Fedora <span class="No-Break">Design Suite</span></p>
						</td>
						<td class="No-Table-Style">
							<p>Comes with a range of open source <span class="No-Break">creative applications</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Education</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">Edubuntu</span></p>
						</td>
						<td class="No-Table-Style">
							<p>An Ubuntu flavor designed for use in classrooms and <span class="No-Break">educational environments</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style"/>
						<td class="No-Table-Style">
							<p><span class="No-Break">Kano OS</span></p>
						</td>
						<td class="No-Table-Style">
							<p>Designed for use with the Kano computer kit, aimed at teaching kids how <span class="No-Break">to code</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style"/>
						<td class="No-Table-Style">
							<p>Debian <span class="No-Break">Edu/Skolelinux</span></p>
						</td>
						<td class="No-Table-Style">
							<p>A custom Debian Pure Blend, designed for <span class="No-Break">educational use</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Gaming</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">SteamOS</span></p>
						</td>
						<td class="No-Table-Style">
							<p>Developed by the Valve Corporation for <span class="No-Break">gaming consoles</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style"/>
						<td class="No-Table-Style">
							<p><span class="No-Break">Ubuntu GamePack</span></p>
						</td>
						<td class="No-Table-Style">
							<p>Comes pre-installed with many games <span class="No-Break">and emulators</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style"/>
						<td class="No-Table-Style">
							<p><span class="No-Break">Lakka</span></p>
						</td>
						<td class="No-Table-Style">
							<p>A lightweight Linux distribution that transforms a small computer into a full-blown <span class="No-Break">game console</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><strong class="bold">Special </strong><span class="No-Break"><strong class="bold">Purpose</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Raspberry Pi OS (<span class="No-Break">formerly Raspbian)</span></p>
						</td>
						<td class="No-Table-Style">
							<p>Optimized for the Raspberry <span class="No-Break">Pi hardware</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style"/>
						<td class="No-Table-Style">
							<p><span class="No-Break">Clear Linux</span></p>
						</td>
						<td class="No-Table-Style">
							<p>Developed by Intel, optimized for performance and security on <span class="No-Break">Intel hardware</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style"/>
						<td class="No-Table-Style">
							<p>Tiny <span class="No-Break">Core Linux</span></p>
						</td>
						<td class="No-Table-Style">
							<p>An extremely small, highly modular, and flexible <span class="No-Break">Linux distribution</span></p>
						</td>
					</tr>
				</tbody>
			</table>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Table 14.1: Some of the available Linux distros</p>
			<p>As you<a id="_idIndexMarker1143"/> can see, there is a distro tailored just for you. However, remember that the kernel is probably the same or at least very similar for all of them. The biggest difference between the distros is the added software and the configuration you get out of <span class="No-Break">the box.</span></p>
			<h1 id="_idParaDest-308"><a id="_idTextAnchor309"/>A quick primer to use Linux</h1>
			<p>In the<a id="_idIndexMarker1144"/> early days of my career, I knew I was very good with computers. They held no surprises for me. I knew how to control them; I was the master of the machine. That lasted until I sat behind my first Linux machine. That was when I realized I only knew a lot about Windows and how to use that platform. I was at a loss. I could not even get the contents of a directory on <span class="No-Break">the screen.</span></p>
			<p>To my defense, this was in the early 1990s. Linux was just released, and we did not have the wealth of information online that we have today. The World Wide Web had just been invented, search engines did not exist, and information was hard to find. Today, things are more straightforward – there are tons of sources out there that can help you get up to speed with <span class="No-Break">something new.</span></p>
			<p>I’m going<a id="_idIndexMarker1145"/> to help you learn some of the basics so that you can play around with Linux without pulling your hair out. I am not going to discuss any of the available GUI systems. There are plenty of them, and some of them are very good. But using them is as easy as using Windows. Honestly, real work happens when you are on a command line. So, that is what I focus on from <span class="No-Break">now on.</span></p>
			<p>I also assume you have figured out how to install WSL on your machine and can open a Terminal. I also have a tip – install the Windows Terminal from the Windows Store. The Windows Terminal is an excellent tool for opening different shells, including Linux ones. This is what it <span class="No-Break">looks like:</span></p>
			<div>
				<div class="IMG---Figure" id="_idContainer083">
					<img alt="Figure 1﻿4.2: A Terminal application opening a new Linux shell" src="image/B20924_15_2.jpg"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.2: A Terminal application opening a new Linux shell</p>
			<p>You can open multiple windows, each with its shell. You can open a PowerShell window next to a Ubuntu window and even the old-style Command Prompt. You have everything you need ready at <span class="No-Break">your fingertips.</span></p>
			<p class="callout-heading">Casing – beware!</p>
			<p class="callout">Before we dive into the commands, there is one thing you should know – <em class="italic">Linux is case-sensitive; Windows is not</em>. Trust me – this has tripped up many people in the past and will probably confuse people in the future. So, keep this in mind. A directory can have two files with the same name that only differ in casing. It is possible to have the <strong class="source-inline">MyAwesomeApp</strong> and <strong class="source-inline">myAwesomeApp</strong> files in the same place. If you come from a Windows background, you will often make this mistake; you cannot find a file that you know is there, which I see a lot. Check <span class="No-Break">your casing.</span></p>
			<p>If you have chosen a Terminal, open the shell for Linux. Now, you are ready to try out <span class="No-Break">some commands!</span></p>
			<h2 id="_idParaDest-309"><a id="_idTextAnchor310"/>Basic commands</h2>
			<p>I want to <a id="_idIndexMarker1146"/>give you a list of the most used Linux commands with their equivalents on Windows. But before diving into those lists, I want to share the best command – <strong class="source-inline">man</strong>. This keyword opens the manual pages for any command you want to learn more about. For instance, the equivalent of <strong class="source-inline">dir</strong> on Windows is <strong class="source-inline">ls</strong>. Type <strong class="source-inline">man ls</strong> and press <em class="italic">Enter</em> to learn more about it. Doing this results in pages and pages of information about the command, parameters, and examples. This works for almost <span class="No-Break">all commands.</span></p>
			<h3>Basic navigation and file management</h3>
			<p>Navigating <a id="_idIndexMarker1147"/>the filesystem is probably essential when using an OS. For Linux, you should know <span class="No-Break">these commands:</span></p>
			<table class="No-Table-Style _idGenTablePara-1" id="table002-11">
				<colgroup>
					<col/>
					<col/>
					<col/>
					<col/>
				</colgroup>
				<tbody>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Task</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Windows command</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Linux command</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Description</strong></span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><strong class="bold">List </strong><span class="No-Break"><strong class="bold">directory contents</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">dir</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">ls</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Lists files and directories in the <span class="No-Break">current path</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Change directory</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">cd</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">cd</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Changes the <span class="No-Break">current directory</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><strong class="bold">Print </strong><span class="No-Break"><strong class="bold">working directory</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">cd</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">pwd</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Displays the <span class="No-Break">current directory</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Copy files</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">copy</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">cp</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">Copies files</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Move/rename files</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">move</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">mv</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Moves or <span class="No-Break">renames files</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Delete files</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><strong class="source-inline">del</strong> <span class="No-Break">or </span><span class="No-Break"><strong class="source-inline">erase</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">rm</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">Removes files</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Delete directories</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><strong class="source-inline">rmdir</strong> <span class="No-Break">or </span><span class="No-Break"><strong class="source-inline">rd</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><strong class="source-inline">rmdir</strong> or <span class="No-Break"><strong class="source-inline">rm -r</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">Removes directories</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Create directories</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">mkdir</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">mkdir</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">Creates directories</span></p>
						</td>
					</tr>
				</tbody>
			</table>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Table 14.2: Navigation and file management commands</p>
			<p>The <a id="_idIndexMarker1148"/>commands work more or less as you would expect. So, <span class="No-Break">try them!</span></p>
			<h3>File viewing and editing</h3>
			<p>If you <a id="_idIndexMarker1149"/>want to learn more about the contents of a file or edit the contents, these commands are there to do <span class="No-Break">just that:</span></p>
			<table class="No-Table-Style _idGenTablePara-1" id="table003-7">
				<colgroup>
					<col/>
					<col/>
					<col/>
					<col/>
				</colgroup>
				<tbody>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Task</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Windows c</strong></span><span class="No-Break"><strong class="bold">ommand</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Linux command</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Description</strong></span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><strong class="bold">View </strong><span class="No-Break"><strong class="bold">file contents</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">type</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">cat</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Displays <span class="No-Break">file contents</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Edit files</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">notepad</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><strong class="source-inline">nano</strong>, <strong class="source-inline">vi</strong>, <span class="No-Break">or </span><span class="No-Break"><strong class="source-inline">vim</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">Edits files</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><strong class="bold">View file </strong><span class="No-Break"><strong class="bold">contents (paged)</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">more</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">less</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Views file contents page <span class="No-Break">by page</span></p>
						</td>
					</tr>
				</tbody>
			</table>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Table 14.3: File viewing and editing</p>
			<p>A word of warning – if you start using VI or VIM for the first time, ensure that you have a web page open with the commands to use in those tools. Working with those tools can be pretty complicated when you have no experience <span class="No-Break">with them!</span></p>
			<h3>System information and processes</h3>
			<p>If you want<a id="_idIndexMarker1150"/> to learn more about the system you are on or are keen to learn about the running processes, give these commands <span class="No-Break">a try:</span></p>
			<table class="No-Table-Style _idGenTablePara-1" id="table004-5">
				<colgroup>
					<col/>
					<col/>
					<col/>
					<col/>
				</colgroup>
				<tbody>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Task</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Windows command</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Linux command</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Description</strong></span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><strong class="bold">Display </strong><span class="No-Break"><strong class="bold">system info</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">systeminfo</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">uname -a</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Displays <span class="No-Break">system information</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><strong class="bold">Display </strong><span class="No-Break"><strong class="bold">process info</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">tasklist</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">ps</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Lists <span class="No-Break">running processes</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Kill processes</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">taskkill</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">kill</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">Terminates processes</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><strong class="bold">Show </strong><span class="No-Break"><strong class="bold">disk usage</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><strong class="source-inline">dir </strong><span class="No-Break"><strong class="source-inline">or chkdsk</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">df</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Displays disk <span class="No-Break">space usage</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><strong class="bold">Show </strong><span class="No-Break"><strong class="bold">file size</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">dir</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">du</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Displays file and <span class="No-Break">directory sizes</span></p>
						</td>
					</tr>
				</tbody>
			</table>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Table 14.4: System information and process commands</p>
			<p>These commands are invaluable when you start to write your own software on Linux. Running these commands gives you a lot of information that you might need <span class="No-Break">later on!</span></p>
			<h3>Network commands</h3>
			<p>As system <a id="_idIndexMarker1151"/>programmers, we often work with networks or have our software communicate over networks. In those cases, it is good to know how to learn more about the network on our systems. These are commands that can <span class="No-Break">help you:</span></p>
			<table class="No-Table-Style _idGenTablePara-1" id="table005-4">
				<colgroup>
					<col/>
					<col/>
					<col/>
					<col/>
				</colgroup>
				<tbody>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Task</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Windows command</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Linux command</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Description</strong></span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Ping</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">ping</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">ping</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Checks <span class="No-Break">network connectivity</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">IP configuration</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">ipconfig</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><strong class="source-inline">ifconfig</strong> <span class="No-Break">or </span><span class="No-Break"><strong class="source-inline">ip</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Displays or configures IP <span class="No-Break">network settings</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Trace route</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">tracert</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">traceroute</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Traces the path to a <span class="No-Break">network host</span></p>
						</td>
					</tr>
				</tbody>
			</table>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Table 14.5: Networking commands</p>
			<p>Most of these <a id="_idIndexMarker1152"/>commands are similar to their Windows counterparts, so you should have no problem remembering and <span class="No-Break">using them.</span></p>
			<h3>Package management</h3>
			<p>Many <a id="_idIndexMarker1153"/>distros come packed with software, but it is very likely your distro might miss something that you may find invaluable. But don’t worry – Linux has tools to install them. This is a short list of some <span class="No-Break">of them:</span></p>
			<table class="No-Table-Style _idGenTablePara-1" id="table006-3">
				<colgroup>
					<col/>
					<col/>
					<col/>
					<col/>
				</colgroup>
				<tbody>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Task</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Windows command</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Linux c</strong></span><span class="No-Break"><strong class="bold">ommand</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Description</strong></span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Install software</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Varies (<span class="No-Break">e.g., </span><span class="No-Break"><strong class="source-inline">msiexec</strong></span><span class="No-Break">)</span></p>
						</td>
						<td class="No-Table-Style">
							<p><strong class="source-inline">apt-get install</strong>, <strong class="source-inline">yum install</strong>, or <span class="No-Break"><strong class="source-inline">dnf install</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Installs <span class="No-Break">software packages</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Update software</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break">Windows Update</span></p>
						</td>
						<td class="No-Table-Style">
							<p><strong class="source-inline">apt-get update</strong> or <span class="No-Break"><strong class="source-inline">apt-get upgrade</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Updates <span class="No-Break">software packages</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Remove software</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Varies (e.g., <span class="No-Break">Control Panel)</span></p>
						</td>
						<td class="No-Table-Style">
							<p><strong class="source-inline">apt-get remove</strong>, <strong class="source-inline">yum remove</strong>, or <span class="No-Break"><strong class="source-inline">dnf remove</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Removes <span class="No-Break">software packages</span></p>
						</td>
					</tr>
				</tbody>
			</table>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Table 14.6: Package management commands</p>
			<p>You will <a id="_idIndexMarker1154"/>run into these commands a lot more later on in <span class="No-Break">this chapter.</span></p>
			<h2 id="_idParaDest-310"><a id="_idTextAnchor311"/>Elevated privileges</h2>
			<p>Linux is <a id="_idIndexMarker1155"/>built around security. One of the effects is that you are more or less forced to run all the commands as a regular user. You are not an administrator, even though you logged in as one. You cannot do everything <span class="No-Break">you want.</span></p>
			<p>You can easily change that. You can give yourself root privileges<a id="_idIndexMarker1156"/> using the <strong class="source-inline">su</strong> command, meaning <strong class="bold">super-user</strong>. <strong class="bold">Root</strong> here means you are at the top level of all user rights; you can do anything you want. However, don’t do that. I have rarely had a reason to become the root of my systems. In the Linux community, becoming root is <span class="No-Break">frowned upon.</span></p>
			<p>If you need to elevate your rights to do something, use <a id="_idIndexMarker1157"/>the <strong class="source-inline">sudo</strong> command. This command stands for <strong class="bold">super-user do</strong>. Let’s assume that you start your command with <strong class="source-inline">sudo</strong>. If so, you give the command the root rights it might need once, and then the system immediately returns to the normal privilege. Only the command on that line can use these <span class="No-Break">elevated privileges.</span></p>
			<p>The first time you use <strong class="source-inline">sudo</strong> in a session, you must supply the administrative password you entered when installing your distro. Your system remembers those credentials for the duration of the session, so you do not have to do that <span class="No-Break">every time.</span></p>
			<p>Let me show you how that works. I use the <strong class="source-inline">whoami</strong> command, which provides information about the currently logged-in user. If I use that command, it returns my name. However, when I do that again, I add <strong class="source-inline">sudo</strong> before it, and it returns <strong class="source-inline">root</strong>. Immediately after that, it reverts to returning my name. This screenshot shows that <span class="No-Break">in action:</span></p>
			<div>
				<div class="IMG---Figure" id="_idContainer084">
					<img alt="Figure 1﻿4.3: Sudo in action" src="image/B20924_15_3.jpg"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.3: Sudo in action</p>
			<p>As you <a id="_idIndexMarker1158"/>can see, it also asks me for my password. If I issue the same or another command and use <strong class="source-inline">sudo</strong>, it will use the cached credentials. But remember that this is only valid in this session. If I open another Terminal window and repeat the same exercise, the system will ask me for my <span class="No-Break">password again.</span></p>
			<p>Using <strong class="source-inline">sudo</strong> is another example of how Linux makes things as secure <span class="No-Break">as possible.</span></p>
			<p>It’s useful to know many more commands, but this at least gives you a starting point. Remember that <strong class="source-inline">man</strong> is your <span class="No-Break">friend here!</span></p>
			<p>Now that you can confidently find your way in your Linux distro, it’s time to see how we can work with the OS <span class="No-Break">as developers.</span></p>
			<h1 id="_idParaDest-311"><a id="_idTextAnchor312"/>Developing for Linux</h1>
			<p>One of the first pieces <a id="_idIndexMarker1159"/>of software written for Linux was GCC, created in 1991. <strong class="bold">GCC</strong> is the <strong class="bold">Gnu C Compiler</strong>, and it was used to build a lot of the software that<a id="_idIndexMarker1160"/> became part of the first distro later on. You can still use GCC if you want to, but today, there are many other development tools available to use. For instance, Python is part of most distros. So, if you want to use Python, you can type the <strong class="source-inline">python3</strong> command into the terminal, and you are ready to go. But we do not do Python; we do .NET. And that means we have another road <span class="No-Break">to take.</span></p>
			<h2 id="_idParaDest-312"><a id="_idTextAnchor313"/>Installing .NET on Linux</h2>
			<p>I mentioned <a id="_idIndexMarker1161"/>previously that Linux usually has a lot of development tools pre-installed. However, .NET is not one of those pre-installed environments. The good news is that it is not hard <span class="No-Break">to install.</span></p>
			<p>Before I tell<a id="_idIndexMarker1162"/> you how to get .NET on the system, I want to discuss my choice of <span class="No-Break">development machines.</span></p>
			<p>I love Visual Studio. I think it is by far the best IDE available. There are others, and I know many people who prefer other tools over Visual Studio, but I am not one <span class="No-Break">of them.</span></p>
			<p>One of the IDEs that many people use is <strong class="bold">Visual Studio Code</strong>. And I agree with them that <strong class="bold">VS Code</strong> (to use its shorter name) is a great tool. However, I prefer the richness of the complete edition of Visual Studio when I work on a <span class="No-Break">real-world system.</span></p>
			<p>If you prefer VS Code, you can use that, of course. You can install VS Code on many different platforms, including Linux. There are many tutorials online that tell you how to <span class="No-Break">do this.</span></p>
			<p>I have bad and good news if you want to stay with <span class="No-Break">Visual Studio.</span></p>
			<p>The bad news is that you cannot install Visual Studio on a Linux machine. The good news is that you do not have to. You can install it on your Windows machine and then deploy and debug directly on the Linux system. And that is what we will do in the rest of <span class="No-Break">this chapter.</span></p>
			<p>However, to run .NET applications on your Linux system, you must have the Runtime. The Runtime contains all that is needed to run your .NET applications. This is great if you want to prepare your production system for your applications. But if you want to debug and test your applications on a Linux machine, you<a id="_idIndexMarker1163"/> also need the <strong class="bold">.NET SDK</strong>. The SDK contains the Runtime, so you do not need to <span class="No-Break">install both.</span></p>
			<h3>Installing the .NET Runtime</h3>
			<p>Let’s discuss <a id="_idIndexMarker1164"/>installing the Runtime first. Again, you only need the Runtime on machines that will run your software. If you want to compile your code, you need <span class="No-Break">the SDK.</span></p>
			<p>Open a Terminal on your Linux distro (or a Ubuntu Terminal on your <span class="No-Break">Windows machine).</span></p>
			<p>Enter the <span class="No-Break">following commands:</span></p>
			<pre class="console">
sudo apt-get update
sudo apt-get install -y wget apt-transport-https</pre>			<p>The <a id="_idIndexMarker1165"/>first command updates all packages on your system. The second one installs the HTTPS transport software if it is not already there. It is probably already on your system, but this ensures that is the case. We need <strong class="source-inline">https</strong> to download <span class="No-Break">the software.</span></p>
			<p>Microsoft ensures all their software is signed, so you can trust it. However, to verify that signature, you need to have their public key. This is how we get that key on <span class="No-Break">our system:</span></p>
			<pre class="console">
wget https://packages.microsoft.com/config/ubuntu/$(lsb_release -rs)/packages-microsoft-prod.deb -O packages-microsoft-prod.deb
sudo dpkg -i packages-microsoft-prod.deb</pre>			<p>These commands get the keys and install them on our system. Now, we can use them to verify the downloads <span class="No-Break">from Microsoft.</span></p>
			<p>This was all only preparation. Now, it is finally time to install the Runtime. This is how we <span class="No-Break">do that:</span></p>
			<pre class="console">
sudo apt-get update
sudo apt-get install -y dotnet-runtime-8.0</pre>			<p>First, we make sure everything is updated. Then, we get the <span class="No-Break">Runtime package.</span></p>
			<p>And that’s it. If this command finishes, we can test it by running <span class="No-Break">the command:</span></p>
			<pre class="console">
dotnet --list-runtimes</pre>			<p>You should see the .NET 8 Runtime in the (concise) list <span class="No-Break">of runtimes.</span></p>
			<h3>Installing the SDK</h3>
			<p>If you <a id="_idIndexMarker1166"/>want to build and debug your Linux distro, you need more software. You must install the SDK. Fortunately, that process is almost the same as installing the Runtime. If you have installed the Runtime, you can enter the <span class="No-Break">following command:</span></p>
			<pre class="console">
sudo apt-get update
sudo apt-get install -y dotnet-sdk-8.0</pre>			<p>This set of commands first updates all packages and then installs <span class="No-Break">the SDK.</span></p>
			<p>If you haven’t <a id="_idIndexMarker1167"/>installed the Runtime, you first have to repeat all the steps I showed you during the Runtime installation, except for the last one (the installation of the Runtime itself). You still need to update, get, and install <span class="No-Break">the keys.</span></p>
			<p>Test the installation of the SDK by calling <span class="No-Break">the following:</span></p>
			<pre class="console">
dotnet --list-sdks</pre>			<p>You should now see a list of the SDKS – well, I say list, but you will probably only see <span class="No-Break">one item.</span></p>
			<p>You can further test the installation by doing a quick test, <span class="No-Break">like this:</span></p>
			<pre class="console">
dotnet new console</pre>			<p>This command creates a new console application. When that is done, <span class="No-Break">do this:</span></p>
			<pre class="console">
dotnet build .</pre>			<p>This builds <strong class="source-inline">.csproj</strong> in the current folder. The result ends up in the <strong class="source-inline">/bin/Debug/net8.0</strong> folder. The program’s name is the same as the folder in which you placed your project. If you didn’t create a directory, it is the name of your user. In my case, the program is called <strong class="source-inline">dvroegop</strong>, so I can run it <span class="No-Break">like this:</span></p>
			<pre class="console">
./dvroegop</pre>			<p>I can see a friendly <strong class="source-inline">Hello, World</strong> message, so apparently it <span class="No-Break">all works!</span></p>
			<h2 id="_idParaDest-313"><a id="_idTextAnchor314"/>Running a .NET background worker on Linux</h2>
			<p>We have had<a id="_idIndexMarker1168"/> enough theory for the moment, I think. Let’s get practical. Fire up Visual Studio and start a new background worker project. In the <a id="_idIndexMarker1169"/>wizard, accept all defaults until the project is ready. In the code, we leave everything as it is, including the default template printing a message every second. Run it to see that it <span class="No-Break">all works.</span></p>
			<p>If all goes well, you will have a new background worker running on Windows. Great! But we have seen tons of those already. Let’s move our program to Linux. To do that, we have to do a couple <span class="No-Break">of things.</span></p>
			<h3>Run your app in the WSL</h3>
			<p>We can publish <a id="_idIndexMarker1170"/>directly from Visual Studio to your WSL installation. To do that, do <span class="No-Break">the following.</span></p>
			<p>Open your project, and go to the run menu. In the dropdown, you should see the option to deploy to WSL. This looks <span class="No-Break">like this:</span></p>
			<div>
				<div class="IMG---Figure" id="_idContainer085">
					<img alt="Figure 1﻿4.4: Use WSL as your debugging environment in Visual Studio" src="image/B20924_15_4.jpg"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.4: Use WSL as your debugging environment in Visual Studio</p>
			<p>Select the <strong class="bold">WSL</strong> option in <span class="No-Break">the dropdown.</span></p>
			<p>If you have more than one distro installed in WSL, you might get a warning in Visual Studio that the default WSL does not have the correct SDK installed. If that is the case, just click the <strong class="bold">Install</strong> button to <span class="No-Break">fix it.</span></p>
			<p>The <strong class="source-inline">launchSettings.json</strong> file in the <strong class="source-inline">Properties</strong> folder of your project should also have the WSL option. This determines which distro Visual Studio will launch. If none is specified, it takes the default. In my case, I have both Ubuntu 20 and Ubuntu 22 installed, so I have to make a choice. I can instruct Visual Studio to take version 22 by changing my <strong class="source-inline">launchSettings.json</strong> to look <span class="No-Break">like this:</span></p>
			<pre class="source-code">
"WSL": {
  "commandName": "WSL2",
  "environmentVariables": {
    "DOTNET_ENVIRONMENT": "Development"
  },
  "distributionName": "Ubuntu-22.04"</pre>			<p>The<a id="_idIndexMarker1171"/> distribution name is an empty string by default, resulting in Visual Studio using the default environment to run your system. Since I have specified my desired distro name, it uses that <span class="No-Break">distro instead.</span></p>
			<p>You can change the default distro by opening a command prompt or using the PowerShell Terminal. Then, get the list of installed distros using <span class="No-Break">this command.</span></p>
			<pre class="console">
wsl –-list</pre>			<p>You will see the list of installed distros on your machine. On my machine, this looks <span class="No-Break">like this:</span></p>
			<pre class="console">
Windows Subsystem for Linux Distributions:
Ubuntu-22.04 (Default)
docker-desktop-data
docker-desktop
Ubuntu-20.04</pre>			<p>Then, you can pick one to be the default by issuing <span class="No-Break">this command:</span></p>
			<pre class="console">
wsl –-set-default Ubuntu-22.04</pre>			<p>Of course, you can specify whatever distro you want. I happen to <span class="No-Break">like </span><span class="No-Break"><strong class="source-inline">Ubuntu-22.04</strong></span><span class="No-Break">.</span></p>
			<p>What happens is quite interesting. Visual Studio does a lot of work to ensure we do not have to worry about deployment. Here is a simplified overview of what happens when you click <strong class="bold">Run</strong> after you select WSL as <span class="No-Break">your environment:</span></p>
			<ol>
				<li>Visual Studio builds your project as a <span class="No-Break">cross-platform system.</span></li>
				<li>Visual Studio then uses WSL to start up an instance of <span class="No-Break">the subsystem.</span></li>
				<li>Using WSL, Visual Studio then copies all the output files to <span class="No-Break">the subsystem.</span></li>
				<li>Visual Studio copies VSDBG, which is the remote debugger, <span class="No-Break">to WSL.</span></li>
				<li>It sets up VSDBG, giving it the proper permissions and enabling <span class="No-Break">network communication.</span></li>
				<li>Visual Studio then starts VSDBG in the WSL and attaches <span class="No-Break">your application.</span></li>
				<li>Finally, Visual Studio attaches itself to the running <span class="No-Break">VSDBG instance.</span></li>
			</ol>
			<p>The result is <a id="_idIndexMarker1172"/>that you can use the IDE just like you are used to. You can set breakpoints, break the application, inspect variables, read system information, and so on. You will see little difference between running your app locally and running it on <span class="No-Break">the WSL.</span></p>
			<h3>Deploy your app to a Linux environment</h3>
			<p>Running your <a id="_idIndexMarker1173"/>application directly from Visual Studio is pretty cool. Still, ultimately, you want to deploy your app to the system. That’s not that hard <span class="No-Break">to do.</span></p>
			<p>In Visual Studio, right-click on your project and choose <span class="No-Break">to publish.</span></p>
			<p>Build a new publish profile like you are used to, with a tiny difference – set the target runtime to <strong class="bold">linux-x64</strong>. Setting this framework will ensure that your app runs <span class="No-Break">on Linux!</span></p>
			<p>If you want, you can also deploy your app to your WSL distro. You can use a handy shortcut in Windows Explorer – navigate to the <strong class="source-inline">\\wsl.localhost\Ubuntu-22.04\home\[username]\</strong> folder. Make sure to replace <strong class="source-inline">[username]</strong> with your username from the WSL. You can create a new folder to act as the publish <span class="No-Break">profile recipient.</span></p>
			<p>You can enter that folder in the profile’s target location – that way, Visual Studio automatically sends all the artifacts to the right place. My profile settings look <span class="No-Break">like this.</span></p>
			<div>
				<div class="IMG---Figure" id="_idContainer086">
					<img alt="Figure 1﻿4.5: A publish profile for a Linux/WSL target" src="image/B20924_15_5.jpg"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.5: A publish profile for a Linux/WSL target</p>
			<p>If you do this<a id="_idIndexMarker1174"/> and then press the <strong class="bold">Publish</strong> button, your code ends up where it needs to be. Now, you can run the program from the WSL distro. Of course, if you have another Linux system running, you can use the same mechanism. If you can’t make a share, you can always publish it locally and then use a tool such as SCP to copy <span class="No-Break">the files.</span></p>
			<p>I think we have discussed this matter enough. Next, let’s discuss developing <span class="No-Break">for Linux!</span></p>
			<h1 id="_idParaDest-314"><a id="_idTextAnchor315"/>Make your code cross-platform</h1>
			<p>The beauty of .NET is that it is cross-platform. The IL runs almost everywhere. If you build an application, it will <a id="_idIndexMarker1175"/>work on your Windows and <span class="No-Break">Linux machines.</span></p>
			<p class="callout-heading">Running an exe on Linux?</p>
			<p class="callout">No, you cannot run your Windows <strong class="source-inline">exe</strong> on Linux. An EXE file is a typical Windows construct. The file layout is specific to that platform, and Linux systems have another way to handle executables. However, the compiler also produces a DLL file if you build your system. That file can be run with the <strong class="source-inline">dotnet</strong> command. So, if your system is called <strong class="source-inline">MyAwesomeApp.exe</strong>, you will also find a <strong class="source-inline">MyAwesomeApp.dll</strong> in the <strong class="source-inline">Build</strong> directory. On all supported platforms, you can run your application using the <strong class="source-inline">dotnet MyAwesomeApp.dll command</strong>, which works on Windows <span class="No-Break">and Linux.</span></p>
			<p>But that doesn’t mean you can copy your binaries, run them, and expect everything to work fine. There are some caveats you should be aware of. But don’t worry – we’ll cover them one by <span class="No-Break">one here.</span></p>
			<p class="callout-heading">Permissions in Linux</p>
			<p class="callout">Here is the first caveat – scripts and applications cannot run by default. They do not have the correct permissions. Each file has a set of permissions, telling the OS what it can do with it. These permissions differ per category. There are permissions for the user, a group, and others. The permissions themselves can be read, write, or execute. You use the <strong class="source-inline">chmod</strong> (<strong class="bold">change mode</strong>) command to set or remove these permissions. Try <strong class="source-inline">man chmod</strong> to get all the inside information, but remember that to make your application runnable, you have to use the <strong class="source-inline">chmod +x [yourapplicationname]</strong> command. The <strong class="source-inline">+x</strong> part tells Linux you can <span class="No-Break">execute it.</span></p>
			<p>Once you get the hang of it, you will find it is easy to switch between Windows and Linux. But to be completely honest, I have been known to try the <strong class="source-inline">chmod</strong> command on my Windows machine. Don’t tell anyone I confessed <span class="No-Break">to this!</span></p>
			<h2 id="_idParaDest-315"><a id="_idTextAnchor316"/>How code can help you</h2>
			<p>The<a id="_idIndexMarker1176"/> people who made .NET have gone out of their way to make it as easy as possible for those who need to support multiple platforms. Whereas in the “old days,” you had to have a lot of compiler directives or even different versions of your code, you can now do a lot in code and have the system figure out how to handle things. Let’s look at some <span class="No-Break">of them.</span></p>
			<h3>Finding out where you run</h3>
			<p>Now and then, you want to<a id="_idIndexMarker1177"/> know what platform a system runs on. There is a class called <strong class="source-inline">OperatingSystem</strong> that helps with that. It is a very simple class, but it can be tremendously powerful. Look at the <span class="No-Break">following snippet:</span></p>
			<pre class="source-code">
if(OperatingSystem.IsWindows())
    _logger.LogInformation("Worker running on Windows");
else if(OperatingSystem.IsLinux())
    _logger.LogInformation("Worker running on Linux");</pre>			<p>The <strong class="source-inline">OperatingSystem</strong> class has many more methods like this, but I am sure you get the idea. You can also use this class to determine the software’s specific version of a platform if you need to know that. So, all the information you need <span class="No-Break">is available.</span></p>
			<h3>Paths and directories</h3>
			<p>If you <a id="_idIndexMarker1178"/>played around in WSL using the commands I gave you earlier in this chapter, you might have noticed that paths look quite different from what you may be <span class="No-Break">used to.</span></p>
			<p>For instance, the path to my home directory when I browse in Windows looks <span class="No-Break">like this:</span></p>
			<pre class="source-code">
C:\Users\dvroe</pre>			<p>My main drive is the C drive, with a <strong class="source-inline">Users</strong> folder with a <span class="No-Break">subfolder, </span><span class="No-Break"><strong class="source-inline">dvroe</strong></span><span class="No-Break">.</span></p>
			<p>In my Linux distro, my <strong class="source-inline">home</strong> folder can be found at <span class="No-Break">this location:</span></p>
			<pre class="source-code">
/home/dvroegop</pre>			<p>Apparently, it can be found by going to the root, then the <strong class="source-inline">home</strong> subfolder, and finally, to the <span class="No-Break"><strong class="source-inline">dvroegop</strong></span><span class="No-Break"> folder.</span></p>
			<p>There is no mention of a drive. In addition, all the slashes are the other <span class="No-Break">way around.</span></p>
			<p>Drives are available, but they are in a different place. Linux has a root path called <strong class="source-inline">/mnt</strong>. You can find a folder for all the drives on your machine in that folder. So, in Windows, the drive is the root of all paths; in Linux, it is a subfolder <span class="No-Break">of </span><span class="No-Break"><strong class="source-inline">/mnt</strong></span><span class="No-Break">.</span></p>
			<p>In your code, you<a id="_idIndexMarker1179"/> should never need to worry about what kind of slashes to use or how to structure your path to contain the right drive. The <strong class="source-inline">Path</strong> class contains all the tools you need. Look at <span class="No-Break">this code:</span></p>
			<pre class="source-code">
var directorySeparatorChar = Path.DirectorySeparatorChar;
var pathSeparator = Path.PathSeparator;
var currentPath = Directory.GetCurrentDirectory();
var newPath = currentPath + directorySeparatorChar + "newFolder";
var betterWay = Path.Combine(currentPath, "newFolder");
var twoPaths = currentPath + pathSeparator + newPath;
$"DirectorySeparatorChar: {directorySeparatorChar}".Dump(consoleColor);
$"PathSeparator: {pathSeparator}".Dump(consoleColor);
$"Current Path: {currentPath}".Dump(consoleColor);
$"newPath: {newPath}".Dump(consoleColor);
$"betterWay: {betterWay}".Dump(consoleColor);
$"twoPaths: {twoPaths}".Dump(consoleColor);</pre>			<p>In this sample, I combine two parts of a path. You should never do that. I just wanted to show you what happens if you use <strong class="source-inline">DirectorySeparator</strong>. A better way to do this is to use <strong class="source-inline">Path.Combine()</strong>, as I also show in this code. That way, you can be sure to always get the <span class="No-Break">right results.</span></p>
			<p class="callout-heading">A path separator versus a directory separator</p>
			<p class="callout">I have <a id="_idIndexMarker1180"/>shown you both a path separator and a <a id="_idIndexMarker1181"/>directory separator in the sample. Many developers use path separators and directory separators interchangeably, but they are different things in this case. A directory separator is a character that separates different parts of an entire directory name. For <a id="_idIndexMarker1182"/>instance, the <strong class="source-inline">c:\users\yourname\mydata</strong> path contains the three <strong class="source-inline">\</strong> directory separators. A path separator is used if you need multiple <a id="_idIndexMarker1183"/>directories in <span class="No-Break">one string.</span></p>
			<p class="callout">A good example is the <strong class="source-inline">%PATH%</strong> environment variable, which shows all the directories that Windows uses to search for executables. They come in a long list separated by a path separator. In Windows and Linux, all these <span class="No-Break">characters differ.</span></p>
			<p>A similar thing<a id="_idIndexMarker1184"/> happens with line endings. Windows uses two characters – return and line feed <strong class="source-inline">('\r\n')</strong>. Linux uses line feed only – <strong class="source-inline">('\n')</strong>. If you want to be sure your code works everywhere, use <span class="No-Break">this code:</span></p>
			<pre class="source-code">
$"End of the output: {Environment.NewLine}".Dump(consoleColor);</pre>			<p>That solves this problem <span class="No-Break">for you.</span></p>
			<h1 id="_idParaDest-316"><a id="_idTextAnchor317"/>Writing services for Linux</h1>
			<p>This <a id="_idIndexMarker1185"/>book has mentioned background processes quite a lot. We’ve seen how to write them and how to deploy them. But how does that work on Linux? Let’s <span class="No-Break">find out!</span></p>
			<p>A background service in Linux is<a id="_idIndexMarker1186"/> called a <strong class="bold">daemon</strong>. This software runs in the background and doesn’t immediately interact with a user. That sounds like something we, as system programmers, <span class="No-Break">should recognize.</span></p>
			<p>We can create a Worker Service in Visual Studio to write such software. Build it, then deploy it to a folder on your <span class="No-Break">Linux distro.</span></p>
			<h2 id="_idParaDest-317"><a id="_idTextAnchor318"/>The service description</h2>
			<p>Before <a id="_idIndexMarker1187"/>you do that, add a new file to the project; this is the system description that Linux needs to register <span class="No-Break">your services.</span></p>
			<p>I called my file <strong class="source-inline">crossplatformservice.service</strong>. It looks <span class="No-Break">like this:</span></p>
			<pre class="source-code">
[Unit]
Description=My .NET Core Worker Service
After=network.target
[Service]
WorkingDirectory=/home/dvroegop/service
ExecStart=/usr/bin/dotnet /home/dvroegop/service/14_CrossPlatformService.dll
Restart=always
# Restart service after 10 seconds if the dotnet service crashes:
RestartSec=10
KillSignal=SIGINT
SyslogIdentifier=crossplatformservice
User=dvroegop
Environment=ASPNETCORE_ENVIRONMENT=Production
[Install]
WantedBy=multi-user.target</pre>			<p>Obviously, you should make sure the paths in this file correspond to your paths. I doubt you have a folder called `dvroegop' on your machine. Let’s investigate what this <span class="No-Break">file does.</span></p>
			<p>The <strong class="source-inline">Unit</strong> section <a id="_idIndexMarker1188"/>contains metadata and the dependencies for the service. A <strong class="source-inline">Description</strong> is a <span class="No-Break">human-readable description.</span></p>
			<p><strong class="source-inline">After</strong> specifies when the service should start. Here, we state that the service should start when the network has <span class="No-Break">been initialized.</span></p>
			<p>The <strong class="source-inline">Service</strong> section configures how the service should be run and managed. The parts of this section are explained in the <span class="No-Break">following table:</span></p>
			<table class="No-Table-Style _idGenTablePara-1" id="table007-1">
				<colgroup>
					<col/>
					<col/>
				</colgroup>
				<tbody>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Element</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Description</strong></span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">WorkingDirectory</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>This is where the application will be executed. Can be used for relative <span class="No-Break">path resolution.</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">ExecStart</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>This is the command used to start <span class="No-Break">the service.</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">Restart</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Defines the restart policy. <strong class="source-inline">always</strong> means it always restarts after a crash or <span class="No-Break">unexpected stop.</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">RestartSec</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>This is the delay before restarting <span class="No-Break">the service.</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">KillSignal</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>This defines the signal used to terminate the service. <strong class="source-inline">SIGINT</strong> is the most used one; we’ll look into this <span class="No-Break">later on.</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">SyslogIdentifier</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Sets a name for the service’s <span class="No-Break">log entries.</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">User</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Runs the service as a <span class="No-Break">specified user.</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">Environment</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Sets the environment variables needed for <span class="No-Break">the service.</span></p>
						</td>
					</tr>
				</tbody>
			</table>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Table 14.7: The service elements for a service description</p>
			<p>Finally, we <a id="_idIndexMarker1189"/>have the <strong class="source-inline">Install</strong> section. This indicates how and when a service should be installed and started. The <strong class="source-inline">WantedBy</strong> element specifies the target to which this service should be linked. In our case, we used <strong class="source-inline">multi-user.target</strong>, which means it runs in a multi-user, non-graphical environment. This is typical for services such <span class="No-Break">as ours.</span></p>
			<p>Make sure you add this file to <span class="No-Break">your deployment.</span></p>
			<h2 id="_idParaDest-318"><a id="_idTextAnchor319"/>Installing the service</h2>
			<p>We can <a id="_idIndexMarker1190"/>install the service once you have the binaries and the service description file on your Linux distro. In a Terminal, do <span class="No-Break">the following.</span></p>
			<p>Move the service description file to the correct directory. If you are in the publish directory on your distro, issue the <span class="No-Break">following command:</span></p>
			<pre class="console">
sudo mv crossplatformservice.service /etc/systemd/system</pre>			<p>You need to use <strong class="source-inline">sudo</strong>; a regular user has no right to access <span class="No-Break">that folder.</span></p>
			<p>Now, we have to restart the system manager configuration. Do that with <span class="No-Break">this command:</span></p>
			<pre class="console">
sudo systemctl daemon-reload</pre>			<p>Once the configuration is reloaded and has read our service description file, we can enable <span class="No-Break">the service:</span></p>
			<pre class="console">
sudo systemctl enable crossplatformservice</pre>			<p>The name <strong class="source-inline">crossplatformservice</strong> is the one that I used in the <strong class="source-inline">SyslogIdentifier</strong> setting in the <span class="No-Break">description file.</span></p>
			<p>If the Linux system restarts, our service will also start. But you don’t have to reboot – you can also manually start the service to see whether everything works out fine. Do this with the <span class="No-Break">following command:</span></p>
			<pre class="console">
sudo systemctl start crossplatformservice</pre>			<p>The results are probably disappointing; you see nothing. But you can verify if it all worked out by using <span class="No-Break">this command:</span></p>
			<pre class="console">
sudo systemctl status crossplatformservice</pre>			<p>This command returns the status, confirming that everything works <span class="No-Break">as expected.</span></p>
			<p>If you want more information, you can look in the log files. All logs are collected by Linux, and acquiring them is done with <span class="No-Break">this command:</span></p>
			<pre class="console">
sudo journalctl -u crossplatformservice</pre>			<p>This command shows the last entries in the logs. Since many applications use the log, we can filter the results to only show the ones belonging to our service. That is what the -u <span class="No-Break">parameter does.</span></p>
			<p>You should get the expected data on your screen to confirm that the <span class="No-Break">service works!</span></p>
			<h2 id="_idParaDest-319"><a id="_idTextAnchor320"/>Uninstalling the service</h2>
			<p>You might<a id="_idIndexMarker1191"/> want to get rid of the service on your development machine. That’s not too difficult; just reverse the steps we <span class="No-Break">just took.</span></p>
			<ol>
				<li>First, stop <span class="No-Break">the service:</span><pre class="source-code">
<strong class="bold">sudo systemctl stop crossplatformservice</strong></pre></li>				<li>Then, disable <span class="No-Break">the service:</span><pre class="source-code">
<strong class="bold">sudo systemctl disable crossplatformservice</strong></pre></li>				<li>Remove the service <span class="No-Break">description file:</span><pre class="source-code">
<strong class="bold">sudo rm /etc/systemd/system/crossplatformservice. Service</strong></pre></li>				<li>After that, reload the <span class="No-Break">daemon configuration:</span><pre class="source-code">
<strong class="bold">sudo systemctl daemon-reload</strong></pre></li>				<li>And that’s it. To verify that the service really is deleted, use <span class="No-Break">this command:</span><pre class="source-code">
<strong class="bold">sudo systemctl status crossplatformservice</strong></pre></li>			</ol>
			<p>That last command should return an error, as our service no <span class="No-Break">longer exists.</span></p>
			<h2 id="_idParaDest-320"><a id="_idTextAnchor321"/>Handling signals</h2>
			<p>In the<a id="_idIndexMarker1192"/> service description file, we told the system that our application could be stopped with the <strong class="source-inline">SIGINT</strong> signal. But that was not really true, as we haven’t done anything to <span class="No-Break">process signals.</span></p>
			<p class="callout-heading">What are signals?</p>
			<p class="callout">A signal can be compared to events on a Windows machine, or, if you remember from earlier chapters, instances of Windows messages. In other words, they are messages that are sent to your application. Some are predefined, while others are user-defined, meaning you can also use them to communicate between programs. In this case, we are talking about the two most used messages in Linux. That’s all there is <span class="No-Break">to it.</span></p>
			<p>Signals are<a id="_idIndexMarker1193"/> ways for the operating system to send messages to your application or service. Two of the most used signals are <strong class="source-inline">SIGINT</strong> and <strong class="source-inline">SIGTERM</strong>. The first one, <strong class="source-inline">SIGINT</strong>, requests an interrupt – the OS wants to stop the service. The second, <strong class="source-inline">SIGTERM</strong>, is meant to stop the application immediately. I agree that it is hard to see the difference between these two, but there is logic here – <strong class="source-inline">SIGINT</strong> is usually a response to a user doing something, such as pressing <em class="italic">Ctrl</em> + <em class="italic">C</em>. You could say that a user is responsible for sending <strong class="source-inline">SIGINT</strong>. The <strong class="source-inline">SIGTERM</strong> signal is from the OS or other services if they think our service needs to <span class="No-Break">be terminated.</span></p>
			<p>We must write code to handle these signals and make our application <span class="No-Break">behave nicely.</span></p>
			<p>To do that, we must import a NuGet package. In this case, we <span class="No-Break">need </span><span class="No-Break"><strong class="source-inline">Mono.Posix.NETStandard</strong></span><span class="No-Break">.</span></p>
			<p>Once you have done that, go to the <strong class="source-inline">Worker</strong> class and add the following method to <span class="No-Break">that class:</span></p>
			<pre class="source-code">
private void RegisterSignalHandlers()
{
    // This is the default behavior for SIGTERM
    AppDomain.CurrentDomain.ProcessExit +=
        (sender, eventArgs) =&gt; $"Process exit".Dump();
    // Handle the signals
    UnixSignal[] signals =
    {
        new(Signum.SIGINT),
        new(Signum.SIGTERM)
    };
    var signalThread = new Thread(() =&gt;
    {
        while (true)
        {
            var index = UnixSignal.WaitAny(signals);
            SignalHandler(signals[index].Signum);
        }
    })
    {
        IsBackground = true
    };
    signalThread.Start();
}</pre>			<p>This method does <a id="_idIndexMarker1194"/>two things. First, it registers <strong class="source-inline">eventhandler</strong> for the “normal” <strong class="source-inline">ProcessExit</strong> event. This event is called when a process needs to terminate and is part of the .NET Runtime. In Linux, this is called when <strong class="source-inline">SIGTERM</strong> <span class="No-Break">is used.</span></p>
			<p>Next, we tell the system to listen to the <strong class="source-inline">SIGINT</strong> and <strong class="source-inline">SIGTERM</strong> signals. We create an array with these values and start a new background thread. All that the thread does is wait for those signals to arrive. When they do, it calls the <strong class="source-inline">SignalHandler()</strong> method. This method looks <span class="No-Break">like this:</span></p>
			<pre class="source-code">
private void SignalHandler(Signum signal)
{
    switch (signal)
    {
        case Signum.SIGINT:
            _logger.LogInformation("Received SIGINT");
            break;
        case Signum.SIGTERM:
            _logger.LogInformation("Received SIGTERM");
            break;
        default:
            _logger.LogInformation($"Received signal {(int)signal}");
            break;
    }
    Environment.Exit(0);
}</pre>			<p>This<a id="_idIndexMarker1195"/> method is simple enough – we write to the log that we received and then terminate <span class="No-Break">the program.</span></p>
			<p>In the constructor of the <strong class="source-inline">Worker</strong> class, we add the call to <strong class="source-inline">RegisterSignalHandlers()</strong>, and then we are good <span class="No-Break">to go.</span></p>
			<p>Run the program from Linux (not as a service, but as a regular program), press <em class="italic">Ctrl</em> + <em class="italic">C</em>, and note the messages telling you that we managed to capture the signal. Cool, <span class="No-Break">isn’t it?</span></p>
			<h1 id="_idParaDest-321"><a id="_idTextAnchor322"/>Summing up</h1>
			<p>Now, you should have all the knowledge to start working on Linux programs. Linux is the platform of choice for many services. Services, of course, are something we as system programmers work with all the time. Although a great platform, Linux has a steep learning curve. Many things are similar to what you are used to in Windows but differ slightly, whereas other things are entirely new or unique to <span class="No-Break">the platform.</span></p>
			<p>It takes time to learn it well. But with what we’ve discussed in this chapter, you are well on your way to feeling at home with Linux. We explored the history of the platform, and we discussed some of its most used commands. We discussed development and looked at how to write daemons <span class="No-Break">for Linux.</span></p>
			<h2 id="_idParaDest-322"><a id="_idTextAnchor323"/>Let’s recap</h2>
			<p>Sit back. Take a deep breath. You’ve made it. You’ve reached the end of the book. And I hope you learned a thing <span class="No-Break">or two.</span></p>
			<p>Don’t underestimate what we’ve done. We’ve answered so <span class="No-Break">many questions:</span></p>
			<ul>
				<li>What is <span class="No-Break">systems programming?</span></li>
				<li>How do we use <span class="No-Break">low-level APIs?</span></li>
				<li>How do we use the <span class="No-Break">Win32 API?</span></li>
				<li>How can we make our software <span class="No-Break">run faster?</span></li>
				<li>How can we make our software <span class="No-Break">memory efficient?</span></li>
				<li>What is I/O and how do we <span class="No-Break">use it?</span></li>
				<li>What is the best way to have systems communicate over <span class="No-Break">a network?</span></li>
				<li>How do we monitor and log what our systems <span class="No-Break">are doing?</span></li>
				<li>What is the ultimate way to debug these <span class="No-Break">low-level systems?</span></li>
				<li>How do we even deploy <span class="No-Break">it all?</span></li>
				<li>How do we work <span class="No-Break">with Linux?</span></li>
			</ul>
			<p>That’s a lot of information! But you have taken the challenge. You can call yourself a specialist in writing fast-performing, memory-efficient, network-aware, secure, and cross-platform low-level system software. That’s a long title, but you <span class="No-Break">deserve it!</span></p>
			<p>And don’t forget – these newfound skills made you a better developer. These skills can be applied to all sorts of projects, not only systems programming. The basic principles stand and are applicable everywhere. I look forward to hearing from you and discovering what you are going to do with what you have learned. The best way to learn new techniques is to try them out. So, I urge you to try the samples and write awesome system software. I have faith <span class="No-Break">in you!</span></p>
		</div>
	</body></html>