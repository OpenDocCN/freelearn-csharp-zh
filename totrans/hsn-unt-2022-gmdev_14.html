<html><head></head><body>
  <div><h1 class="chapterNumber">14</h1>
    <h1 id="_idParaDest-175" class="chapterTitle">Sound and Music Integration</h1>
    <p class="normal">We have now achieved good enough graphics quality, but we are missing an important part of the game aesthetics: the sound. Often relegated to being the last step in game development, sound is one of those things that if it’s there, you won’t notice its presence, but if you don’t have it, you will feel that something is missing. It will help you to reinforce the ambience you want in your game and must match the graphical setting. </p>
    <p class="normal">In this chapter, we will examine the following sound concepts: </p>
    <ul>
      <li class="bulletList">Importing audio</li>
      <li class="bulletList">Integrating and mixing audio </li>
    </ul>
    <p class="normal">We will apply those concepts in our game to import the audio to play in different scenarios—such as when the player shoots—and the music. Later in the programming chapters, we will play sounds, but for now, let’s focus on how to import them into our project.</p>
    <h1 id="_idParaDest-176" class="heading-1">Importing audio</h1>
    <p class="normal">As with graphic assets, it is<a id="_idIndexMarker925"/> important to properly set up the import settings for your audio assets, as the import can be resource-intensive if not done properly. </p>
    <p class="normal">In this section, we will examine <a id="_idIndexMarker926"/>the following audio importing concepts:</p>
    <ul>
      <li class="bulletList">Audio types</li>
      <li class="bulletList">Configuring import settings</li>
    </ul>
    <p class="normal">Let’s start by discussing the different kinds of audio we can use.</p>
    <h2 id="_idParaDest-177" class="heading-2">Audio types</h2>
    <p class="normal">There are different types of audio<a id="_idIndexMarker927"/> present in video games, which are the following:</p>
    <ul>
      <li class="bulletList"><strong class="keyWord">Music</strong>: Music used to enhance the <a id="_idIndexMarker928"/>player’s experience according to the situation.</li>
      <li class="bulletList"><strong class="keyWord">Sound effects (SFX)</strong>: Sounds that <a id="_idIndexMarker929"/>happen as a reaction to player or NPC actions, such as clicking a button, walking, opening a door, shooting a gun, and so on.</li>
      <li class="bulletList"><strong class="keyWord">Ambient sound</strong>: A game that uses sounds only in response to events would feel empty. If you are recreating an<a id="_idIndexMarker930"/> apartment in the middle of the city, even if the player is just idle in the middle of the room doing nothing, lots of sounds should be heard, and the sources of most of them will be outside the room, such as an airplane flying overhead, a construction site two blocks away, cars in the street, and so on. Creating objects that won’t be seen is a waste of resources. Instead, we can place individual sounds all over the scene to recreate the desired ambience, but that would be resource-intensive, requiring lots of CPU and RAM to achieve believable results. Considering that these sounds usually occupy the second plane of the user’s attention, we can just combine them all into a single looping track and just play one audio file, and that’s exactly what ambient sound is. If you want to create a café scene, you can simply go to a real café and record a few minutes of audio, using that as your ambient sound.</li>
    </ul>
    <p class="normal">For almost all games, we will need at least one music track, one ambient track, and several SFX to start the production of the audio. As always, we have different sources of audio assets, but we will use the Asset Store. It has three audio categories to search for the assets we need:</p>
    <figure class="mediaobject"><img src="img/B18585_14_01.png" alt=""/></figure>
    <p class="packt_figref">Figure 14.1: Audio categories in the Asset Store</p>
    <p class="normal">In my case, I also used the search bar to further filter the categories, searching for <code class="inlineCode">weather</code> to find a rain effect. Sometimes, you can’t find the exact audio separately; in such cases, you will need to dig into <strong class="screenText">Packs</strong><strong class="keyWord"> </strong>and<strong class="keyWord"> </strong><strong class="screenText">Libraries</strong>, so have patience here. In my case, I picked the three packages you can see in <em class="italic">Figure 14.2</em>, but imported just some of the sounds included, as all of them would weigh a lot in the project in terms of size. For ambience, I picked a rain sound file called <code class="inlineCode">Ambience_Rain_Moderate_01_LOOP</code> in the case of this package, but the <a id="_idIndexMarker931"/>name of the rain sound we are looking for can be different if you downloaded another package. Then, I picked <strong class="screenText">Music – Sad Hope </strong>for music, and for SFX, I picked one gun sound effect package for our future player’s hero character. Of course, you can pick other packages to better suit your game’s needs:</p>
    <figure class="mediaobject"><img src="img/B18585_14_02.png" alt=""/> </figure>
    <p class="packt_figref">Figure 14.2: The packages for our game </p>
    <p class="normal">Now that we have the necessary audio packages, let’s discuss how to import them.</p>
    <h2 id="_idParaDest-178" class="heading-2">Configuring import settings</h2>
    <p class="normal">We have several import<a id="_idIndexMarker932"/> settings we can tweak, but the problem is that we need to consider the usage of the audio to properly set it up, so let’s see the ideal settings for each case. In order to see the import settings, as always, you can select the asset and see it in the Inspector panel, as in the following figure:</p>
    <figure class="mediaobject"><img src="img/B18585_14_03.png" alt=""/></figure>
    <p class="packt_figref">Figure 14.3: Audio Import Settings</p>
    <p class="normal">Let’s discuss the most important ones, starting with <strong class="screenText">Force To Mono</strong>. Some audio may come with stereo channels, meaning that we have one sound playing in the left ear and another one for the right ear. This means that one piece of audio can actually contain two different audio tracks. Stereo sound is useful for different effects and instrument spatialization in the case of music, so we want that in those scenarios, but there are other scenarios where<a id="_idIndexMarker933"/> stereo is not useful. Consider 3D sound effects such as a shooting gun or some walking-pace steps. In those cases, we need the sound to be heard in the direction of the source—if the shooting of a gun happened to my left, I need to hear it coming from my left. In these cases, we can convert stereo audio to mono audio checking the <strong class="screenText">Force To Mono</strong> checkbox in the audio import settings. This will make Unity combine the two channels into a single one, reducing the audio usually to almost half its size (sometimes more, sometimes less, depending on various aspects).</p>
    <p class="normal">You can verify the impact of that and other settings at the bottom of the Audio Asset Inspector, where you can see the imported audio size:</p>
    <figure class="mediaobject"><img src="img/B18585_14_04.png" alt=""/> </figure>
    <p class="packt_figref">Figure 14.4: Left: audio imported without Force To Mono. Right: same audio with Force To Mono</p>
    <p class="normal">The next setting to discuss, and an important one at that, is <strong class="keyWord">Load Type</strong>. In order to play some audio, Unity needs to read the audio from disk, decompress it, and then play it. Load Type changes the way those<a id="_idIndexMarker934"/> three processes are handled. We have the following three options here:</p>
    <ul>
      <li class="bulletList"><strong class="keyWord">Decompress on Load</strong>: The most memory-intensive option. This mode will make Unity load the audio uncompressed in memory when the scene is loaded. That means that the <a id="_idIndexMarker935"/>audio will take lots of space in RAM because we have the uncompressed version loaded. The advantage of using this mode is that playing the audio is easier because we have the raw audio data ready to play in RAM.</li>
      <li class="bulletList"><strong class="keyWord">Streaming</strong>: The total opposite of <strong class="screenText">Decompress on Load</strong>. This mode never loads audio in RAM. Instead, while the audio is playing, Unity reads a piece of the audio asset <a id="_idIndexMarker936"/>from disk, decompresses it, plays it, and repeats, running this process once for each piece of audio playing in <strong class="keyWord">Streaming</strong>. This<a id="_idIndexMarker937"/> means that this mode will be CPU intensive, but will consume almost zero bytes of RAM.</li>
      <li class="bulletList"><strong class="keyWord">Compressed in Memory</strong>: The middle ground. This mode will load the audio from disk when the <a id="_idIndexMarker938"/>scene is loaded but will keep it compressed in memory. When Unity needs to play the audio, it will just take a piece from the RAM, decompress it, and play it. Remember that reading pieces of the audio asset from RAM is considerably faster than reading from disk.</li>
    </ul>
    <p class="normal">Maybe if you are an experienced developer, you can easily determine which mode is better suited for which kind of audio, but if this is your first encounter with video games, it may sound confusing. So, let’s discuss the best modes for different cases:</p>
    <ul>
      <li class="bulletList"><strong class="keyWord">Frequent short audio</strong>: This could be<a id="_idIndexMarker939"/> a shooting gun or the sound of footsteps, which are sounds that last less than one second but can occur in several instances and play at the same time. In such cases, we can use <strong class="screenText">Decompress On Load</strong>. Uncompressed short audio won’t have a huge size difference from its compressed version. Also, since this is the most performant CPU option, having several instances won’t have a huge impact on performance.</li>
      <li class="bulletList"><strong class="keyWord">Infrequent large audio</strong>: This includes music, ambient sound, and dialog. These kinds of audio usually have just one instance playing, and they are usually big. Those cases are better<a id="_idIndexMarker940"/> suited for <strong class="screenText">Streaming</strong> mode because having them compressed or decompressed in RAM can have a huge impact on RAM consumption in low-end devices such as mobile devices (on PCs, we can use <strong class="screenText">Compressed in Memory</strong> sometimes). A CPU can handle having two or three bits of audio playing in Streaming mode, but try to have no more than that.</li>
      <li class="bulletList"><strong class="keyWord">Frequent medium audio</strong>: This includes pre-made voice chat dialog in multiplayer games, character <a id="_idIndexMarker941"/>emotes, long explosions, or any audio that is more than 500 KB (that is not a strict rule—this number depends a lot on the target device). Having this kind of audio decompressed in RAM can have a noticeable impact on performance, but due to the fact that this audio is fairly frequently used, we can have it compressed in memory. Their relatively small size means they usually won’t make a huge difference in our game’s overall size, and we will avoid wasting CPU resources on reading from disk.</li>
    </ul>
    <p class="normal">There are other cases to consider, but those can be extrapolated based on the previous ones. Remember that the previous analysis was made by taking into account the requirements of the<a id="_idIndexMarker942"/> standard game, but this can vary a lot according to your game and your target device. Maybe you are making a game that won’t consume lots of RAM but is pretty intensive in terms of CPU resources, in which case you can just put everything in <strong class="screenText">Decompress on Load</strong>. It’s important to consider all aspects of your game and to balance your resources accordingly.</p>
    <p class="normal">Finally, another thing to consider is the compression format, which will change the way Unity will encode the audio in the published game. Different compression formats will give different compression ratios in exchange for less fidelity with the original audio, or higher decompression times, and all this varies a lot based on the audio patterns and length. We have three compression formats:</p>
    <ul>
      <li class="bulletList"><strong class="keyWord">PCM</strong>: The uncompressed<a id="_idIndexMarker943"/> format will give you the highest audio quality, with no noise artifacts, but will result in a bigger asset file size. </li>
      <li class="bulletList"><strong class="keyWord">ADPCM</strong>: Compressing audio this way reduces file size and yields a fast, uncompressing process, but this <a id="_idIndexMarker944"/>can introduce noise artifacts that can be noticeable in certain types of audio.</li>
      <li class="bulletList"><strong class="keyWord">Vorbis</strong>: A high-quality compression format that will yield almost zero artifacts but takes longer to decompress, so playing Vorbis audio will be slightly more intensive than for other formats. It also provides a quality slider to select the exact amount of compression aggressiveness. </li>
    </ul>
    <p class="normal">Which one should you use? Again, that depends on the features of your audio. Short smooth audio can use PCM, while long noisy audio can use ADPCM; the artifacts introduced by this format will be hidden in the audio itself. Maybe long smooth audio where compression artifacts are noticeable could benefit from using Vorbis. Sometimes, it’s just a matter of trial and error. Maybe use Vorbis by default and when performance is reduced, try to switch to ADPCM, and if that causes glitches, just switch to PCM. Of course, the problem here is being sure that the audio processing is really what’s responsible for the performance issues—maybe switching all audio to ADPCM and checking whether that made a difference is a good way to detect that, but a better approach would<a id="_idIndexMarker945"/> be to use the Profiler, a performance measurement tool that we will see later in this book. </p>
    <p class="normal">We have other settings, such as <strong class="screenText">Sample Rate Setting</strong>, that again, with a little trial and error, you can use to detect the best setting. </p>
    <p class="normal">I have set up the audio that I downloaded from the Asset Store as you can see in <em class="italic">Figures 14.5</em> and <em class="italic">14.6</em>. The first one shows how I set up the music and ambient audio files (large files):</p>
    <figure class="mediaobject"><img src="img/B18585_14_05.png" alt=""/></figure>
    <p class="packt_figref">Figure 14.5: Music and ambient settings</p>
    <p class="normal">The music should be configured as stereo (<strong class="screenText">Force To Mono</strong> unchecked), use <strong class="screenText">Streaming Load Type</strong> because they are large and will have just one instance playing, and <strong class="screenText">ADPCM</strong> <strong class="screenText">Compression Format</strong> because <strong class="screenText">Vorbis</strong> didn’t result in a huge size difference.</p>
    <p class="normal">This second screenshot<a id="_idIndexMarker946"/> shows how I set up the SFX files (small files):</p>
    <p class="packt_figref"><img src="img/B18585_14_06.png" alt=""/></p>
    <p class="packt_figref">Figure 14.6: Shooting SFX settings</p>
    <p class="normal">The sounds we downloaded will be 3D, so <strong class="screenText">Force To Mono</strong> should be checked. They will also be short, so the <strong class="screenText">Load Type</strong> named <strong class="screenText">Decompress On Load</strong> works better. Finally, choosing the <strong class="screenText">Vorbis Compression Format</strong> reduced <strong class="screenText">ADPCM</strong> size by more than a half, which is why we picked it.</p>
    <p class="normal">Now that we have our pieces of audio properly configured, we can start to use them in our scene.</p>
    <h1 id="_idParaDest-179" class="heading-1">Integrating and mixing audio</h1>
    <p class="normal">We can just drag our<a id="_idIndexMarker947"/> bits of audio into our scene to start using it, but we can dig a little bit further to explore the best<a id="_idIndexMarker948"/> ways to configure them to each possible scenario.</p>
    <p class="normal">In this section, we will examine the following audio integration concepts:</p>
    <ul>
      <li class="bulletList">Using 2D and 3D AudioSources</li>
      <li class="bulletList">Using audio mixers</li>
    </ul>
    <p class="normal">Let’s start exploring AudioSources, objects that are in charge of audio playback.</p>
    <h2 id="_idParaDest-180" class="heading-2">Using 2D and 3D AudioSources</h2>
    <p class="normal"><strong class="keyWord">AudioSources</strong> are components<a id="_idIndexMarker949"/> that can be attached to GameObjects. They are responsible for emitting sound in our game based on <strong class="keyWord">AudioClips</strong>, which are the audio assets <a id="_idIndexMarker950"/>we downloaded previously. </p>
    <p class="normal">It’s important to differentiate an AudioClip from an <strong class="keyWord">AudioSource</strong>; we can have a single explosion AudioClip, but lots of AudioSources playing it, simulating several explosions. An AudioSource can be seen as a CD player that can play AudioClips (our CDs in this analogy), only with the exception that we can have several CD players or AudioSources playing the same CD at the same time (for example, two explosions sounds playing at the same time).</p>
    <p class="normal">The simplest way to create an <strong class="screenText">AudioSource</strong> is to pick an <strong class="screenText">AudioClip</strong> (an audio asset) and drag it to the <strong class="screenText">Hierarchy</strong> window. Try to avoid dragging the audio into an existing object; instead, drag it between objects, so Unity will create a new object with the <strong class="screenText">AudioSource</strong> instead of adding it to an existing object (sometimes, you want an existing object to have the <strong class="screenText">AudioSource</strong>, but let’s keep things simple for now):</p>
    <figure class="mediaobject"><img src="img/B18585_14_07.png" alt=""/></figure>
    <p class="packt_figref">Figure 14.7: Dragging an AudioClip to the Hierarchy window between objects</p>
    <p class="normal">The following screenshot shows the <strong class="screenText">AudioSource</strong> generated by dragging the music asset to the scene. You can see that the <strong class="screenText">AudioClip</strong> field has a reference to the dragged audio:</p>
    <figure class="mediaobject"><img src="img/B18585_14_08.png" alt=""/> </figure>
    <p class="packt_figref">Figure 14.8: AudioSource configured to play our music asset</p>
    <p class="normal">As you can see, the <strong class="screenText">AudioSource</strong> has several settings, so let’s review the common ones in the following list:</p>
    <ul>
      <li class="bulletList"><strong class="keyWord">Play on Awake</strong>: Determines<a id="_idIndexMarker951"/> whether the audio starts playing automatically when the game starts. We can uncheck that and play the audio via scripting, perhaps when the player shoots or jumps (more on that in <em class="italic">Part 3</em> of the book).</li>
      <li class="bulletList"><strong class="keyWord">Loop</strong>: Will make the audio repeat automatically when it finishes playing. Remember to always check this setting on the music and ambient audio clips. It is easy to forget this because those tracks are long, and we may never reach the end of them in our tests.</li>
      <li class="bulletList"><strong class="keyWord">Volume</strong>: Controls the audio intensity.</li>
      <li class="bulletList"><strong class="keyWord">Pitch</strong>: Controls the audio velocity. This is useful for simulating effects such as slow motion or the increasing revolutions of an engine.</li>
      <li class="bulletList"><strong class="keyWord">Spatial Blend</strong>: Controls whether our audio is 2D or 3D. In 2D mode, the audio will be heard at the same<a id="_idIndexMarker952"/> volume at all distances, while 3D will <a id="_idIndexMarker953"/>make the audio volume decrease as the distance from the camera increases.</li>
    </ul>
    <p class="normal">In the case of our music track, I have configured it as shown in the following screenshot. You can drag the ambient rain sound to add it to the scene and use the same settings as these because we want the same ambient effect in all our scenes. In complex scenes, though, you can have different 3D ambient sounds scattered all over the scene to change the sound according to the current environment:</p>
    <figure class="mediaobject"><img src="img/B18585_14_09.png" alt=""/></figure>
    <p class="packt_figref">Figure 14.9: Music and ambient settings. This will loop, is set to Play on Awake, and is 2D</p>
    <p class="normal">Now, you can drag the<a id="_idIndexMarker954"/> shooting effect and configure it as shown in <em class="italic">Figure 14.10</em>. As you can see, the <a id="_idIndexMarker955"/>audio, in this case, won’t loop because we want the shooting effect to play once per bullet. Remember that, for our game, the bullet will be a Prefab that will spawn each time we press the shoot key, so each bullet will have its own <strong class="screenText">AudioSource</strong> that will play when the bullet is created. Also, the <a id="_idIndexMarker956"/>bullet is set to a 3D <strong class="keyWord">Spatial Blend</strong>, meaning that the effect will be transmitted through different speakers based on the position of the <strong class="screenText">AudioSource</strong> against the camera position:</p>
    <figure class="mediaobject"><img src="img/B18585_14_10.png" alt=""/></figure>
    <p class="packt_figref">Figure 14.10: Sound effect setting. This won’t loop and is a 3D sound</p>
    <p class="normal">Something to consider in the case of 3D sounds is the <strong class="screenText">Volume Rolloff</strong> setting, which is inside the 3D sound settings<a id="_idIndexMarker957"/> section. This setting controls how the volume decays as distance<a id="_idIndexMarker958"/> from the camera increases. By default, you can see that this setting is set to <strong class="screenText">Logarithmic Rolloff</strong>, the way real-life sound works, but sometimes you don’t want real-life sound decay, because sounds in real life are usually heard slightly even if the source is very far away. </p>
    <p class="normal">One option is to switch to <strong class="screenText">Linear Rolloff</strong> and configure the exact maximum distance with the <strong class="screenText">Max Distance</strong> setting:</p>
    <figure class="mediaobject"><img src="img/B18585_14_11.png" alt=""/></figure>
    <p class="packt_figref">Figure 14.11: A 3D sound with a maximum distance of 10 metres, using Linear Rolloff</p>
    <p class="normal">Considering we just discussed 3D sounds, it is worth mentioning the <strong class="screenText">AudioListener</strong> component, one that is created by default in the <strong class="screenText">MainCamera</strong>, and 99% of the time, this component will be placed in the <strong class="screenText">MainCamera</strong>. It serves as a way to identify which object represents the ears of the player in the world, with which we can calculate audio directionality. The camera is the<a id="_idIndexMarker959"/> logical place to put it given it represents the eyes of <a id="_idIndexMarker960"/>the user, and having the eyes and the ears of the player in different places would be confusing. There are no properties to configure in the <strong class="screenText">AudioListener</strong> component, but it is important to mention that in order for audio to work, we need one, and no more than one; we have just one pair of ears:</p>
    <figure class="mediaobject"><img src="img/B18585_14_12.png" alt=""/></figure>
    <p class="packt_figref">Figure 14.12: Audio Listener component in the Main Camera</p>
    <p class="normal">Now that we can configure individual pieces of audio, let’s see how to apply effects to groups of audio instances using an <strong class="keyWord">Audio Mixer</strong>.</p>
    <h2 id="_idParaDest-181" class="heading-2">Using an Audio Mixer</h2>
    <p class="normal">We will have several audio instances <a id="_idIndexMarker961"/>playing all over our game: the footsteps of characters, shooting, bonfires, explosions, rain, and so on. Controlling exactly which sounds are supposed to sound louder or quieter depending on the context, and applying effects to reinforce certain situations, such as being stunned due to a nearby <a id="_idIndexMarker962"/>explosion, is called audio mixing—the process of mixing several sounds together in a cohesive and controlled way. </p>
    <p class="normal">In Unity, we can create an Audio Mixer, an asset that we can use to define groups of sounds. All changes to a group will affect all sounds inside it by raising or lowering the volume, perhaps, or by applying an effect. You can have SFX and music groups to control sounds separately—as an example, you could lower the SFX volume while in the <strong class="screenText">Pause</strong> menu but not the music volume. Also, groups are organized in a hierarchy, where a group can also contain other groups, so <a id="_idIndexMarker963"/>a change in a group will also apply changes to its sub-groups. As a matter of fact, every group you create will always be a child group of the master group, the group that controls every single sound in the game (that uses that mixer).</p>
    <p class="normal">Let’s create a mixer with SFX and music groups:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">In the Project window, using the <strong class="screenText">+</strong> button, select the <strong class="screenText">Audio Mixer</strong> option. Name the asset as you wish; in my case, I chose <code class="inlineCode">Main Mixer</code>.</li>
      <li class="numberedList">Double-click the created asset to open the <strong class="screenText">Audio Mixer</strong> window:</li>
    </ol>
    <figure class="mediaobject"><img src="img/B18585_14_13.png" alt=""/></figure>
    <p class="packt_figref">Figure 14.13: Audio Mixer window </p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="3">Click the <strong class="screenText">+</strong> button at the right of the <strong class="screenText">Groups </strong>label to create a child group of the master node. Name it <code class="inlineCode">SFX</code>:</li>
    </ol>
    <figure class="mediaobject"><img src="img/B18585_14_14.png" alt=""/></figure>
    <p class="packt_figref">Figure 14.14: Group creation </p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="4">Click on the <strong class="screenText">Master</strong> group and click again on the <strong class="screenText">+</strong> button to create another master node child group called <code class="inlineCode">Music</code>. Remember to select the <strong class="screenText">Master</strong> group before clicking the <strong class="screenText">+</strong> button, because if another group is selected, the new group will be a child of that <a id="_idIndexMarker964"/>one. Anyway, you can rearrange a group child-parent relationship by dragging the group in the <strong class="screenText">Groups</strong> panel in the <strong class="screenText">AudioMixer</strong> window:</li>
    </ol>
    <figure class="mediaobject"><img src="img/B18585_14_15.png" alt=""/></figure>
    <p class="packt_figref">Figure 14.15: The Master, SFX, and Music groups</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="5">Select the <strong class="screenText">Music</strong> GameObject of our scene back in the <strong class="screenText">Hierarchy</strong> window and look for the <strong class="screenText">AudioSource</strong> component in the <strong class="screenText">Inspector</strong> window.</li>
      <li class="numberedList">Click the circle to the right of the <strong class="screenText">Output</strong> property to open the <strong class="screenText">AudioMixerGroup</strong> selector window and select the <strong class="screenText">Music</strong> group. This will make that <strong class="screenText">AudioSource</strong> affected by the settings on the specified Mixer group:</li>
    </ol>
    <figure class="mediaobject"><img src="img/B18585_14_16.png" alt=""/></figure>
    <p class="packt_figref">Figure 14.16: Making an AudioSource belong to an Audio Mixer group</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="7">If you play the game now, you can see how the volume meters in the <strong class="screenText">Audio Mixer</strong> window start to move, indicating that the music is going through the <strong class="screenText">Music </strong>group. You will also see that the <strong class="screenText">Master </strong>group volume meter is also moving, indicating that the <a id="_idIndexMarker965"/>sound that is passing through the <strong class="screenText">Music </strong>group is also passing through the <strong class="screenText">Master</strong> group (the parent of the <strong class="screenText">Music</strong> group) before going to the sound card of your computer:</li>
    </ol>
    <figure class="mediaobject"><img src="img/B18585_14_17.png" alt=""/></figure>
    <p class="packt_figref">Figure 14.17: Group volumes levels </p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="8">Repeat <em class="italic">steps 5</em> and <em class="italic">6</em> for the ambient and shooting sounds to make them belong to the <strong class="screenText">SFX </strong>group.</li>
    </ol>
    <p class="normal">Now that we have separated our sounds into groups, we can start adjusting the groups’ settings. But, before doing that, we need to take into account the fact that we won’t want the same settings all the time, as in the previously mentioned pause menu case, where the SFX volume should be lower. To handle those scenarios, we can create snapshots, which are presets of our mixer that can be activated via scripting during our game. We will deal with the scripting steps in <em class="italic">Part 3</em> of this book, but we can create a normal snapshot for the in-game settings and a pause snapshot for the pause menu settings.</p>
    <p class="normal">If you check the <strong class="screenText">Snapshots</strong> list, you will see that a single snapshot has already been created—that can be our normal snapshot. So, let’s create a pause snapshot by doing the following:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">Click on the <strong class="screenText">+</strong> button to the right of the <strong class="screenText">Snapshots </strong>label and call the snapshot <code class="inlineCode">Pause</code>. Remember to stop the game to edit the mixer or click the <strong class="screenText">Edit in Playmode</strong> option to allow Unity to change the mixer during play. If you do the latter, remember that the changes will persist when you stop the game, unlike changes to GameObjects. Actually, if you change other assets during <strong class="screenText">Play</strong> mode, those changes will also persist—only GameObject changes are reverted. 
    <p class="numberedList">There are some other cases, like Materials<a id="_idIndexMarker966"/> and Animations, changes to which are not reverted after pausing given that they are assets, but we won’t discuss them right now:</p>
</li>
    </ol>
    <figure class="mediaobject"><img src="img/B18585_14_18.png" alt=""/></figure>
    <p class="packt_figref">Figure 14.18: Snapshot creation</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="2">Select the <strong class="screenText">Pause</strong> snapshot and lower the volume slider of the <strong class="screenText">SFX</strong> group:</li>
    </ol>
    <figure class="mediaobject"><img src="img/B18585_14_19.png" alt=""/></figure>
    <p class="packt_figref">Figure 14.19: Lowering the volume of the Pause snapshot</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="3">Play the game and hear how the sound is still at its normal volume. That’s because the original snapshot is the default one—you can see that by checking for the star to its right. You can right-click any snapshot and make it the default one using the <strong class="screenText">Set as Start Snapshot</strong> option.</li>
      <li class="numberedList">Click on <strong class="screenText">Edit in</strong> <strong class="screenText">Playmode</strong> to enable <strong class="screenText">Audio Mixer</strong> modification during runtime.</li>
      <li class="numberedList">Click on the <strong class="screenText">Pause</strong> snapshot to enable it and hear how the <strong class="screenText">Shooting</strong> and <strong class="screenText">Ambient</strong> sound volumes have decreased.</li>
    </ol>
    <p class="normal">As you can see, one of the main uses of the mixer is to control group volume, especially when you see that the intensity of a group’s volume is going higher than the 0 mark, indicating that the group is too loud. Anyway, there are other uses for the mixer, such as applying effects. If you’ve played any war game, you will have noticed that whenever a bomb explodes nearby, you hear the sound differently for a moment, as if the sound were located in another room. That can be accomplished using an effect called <strong class="screenText">Low Pass</strong>, which blocks high-frequency sounds, and that’s exactly what happens with our ears in those scenarios: the <a id="_idIndexMarker967"/>stress of the high-volume sound generated by an explosion irritates our ears, making them less sensitive to high frequencies for a while.</p>
    <p class="normal">We can add effects to any channel and configure them according to the current snapshot, just as we did for the volume, by doing the following:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">Click on the <strong class="screenText">Add…</strong> button at the bottom of the <strong class="screenText">Master</strong> group and select <strong class="screenText">Lowpass Simple</strong>:</li>
    </ol>
    <figure class="mediaobject"><img src="img/B18585_14_20.png" alt=""/></figure>
    <p class="packt_figref">Figure 14.20: The effects list of a channel</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="2">Select the normal snapshot (the one called <code class="inlineCode">Snapshot</code>) to modify it.</li>
      <li class="numberedList">Select the <strong class="screenText">Master</strong> group and look at the <strong class="screenText">Inspector</strong> panel, where you will see settings for the group and its effects.</li>
      <li class="numberedList">Set the <strong class="screenText">Cutoff freq</strong> property of the <strong class="screenText">Lowpass Simple</strong> settings to the highest value (<code class="inlineCode">22000</code>), this will disable the effect.</li>
      <li class="numberedList">Repeat <em class="italic">steps 3</em> and <em class="italic">4</em> for the <strong class="screenText">Pause</strong> snapshot; we don’t want this effect in that snapshot.</li>
      <li class="numberedList">Create a new snapshot called <strong class="screenText">Bomb Stun</strong> and select it to edit it.</li>
      <li class="numberedList">Set <strong class="screenText">Cutoff freq</strong> to <code class="inlineCode">1000</code>:</li>
    </ol>
    <figure class="mediaobject"><img src="img/B18585_14_21.png" alt=""/></figure>
    <p class="packt_figref">Figure 14.21: Setting the cutoff frequency of the Lowpass Simple effect </p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="8">Play the game and change between snapshots to check the difference.</li>
    </ol>
    <div><p class="normal">Aside from the Low Pass filter, you can apply several other filters, such as <strong class="screenText">Echo</strong>, to create an almost dreamy effect, or a combination of <strong class="screenText">Send</strong>, <strong class="screenText">Receive</strong>, and <strong class="screenText">Duck</strong> to make a group lower its volume based on the intensity of another group (for instance, you may want to lower SFX volume when dialog is happening). I invite you to try those and other effects and check the results to identify potential uses by reading the following documentation: <a href="https://docs.unity3d.com/Manual/class-AudioEffectMixer.html">https://docs.unity3d.com/Manual/class-AudioEffectMixer.html</a>.</p>
    </div>
    <p class="normal">Now that we have integrated the <a id="_idIndexMarker968"/>audio, let’s see how we can script our audio.</p>
    <h1 id="_idParaDest-182" class="heading-1">Scripting audio feedback</h1>
    <p class="normal">As with the VFX, audio also needs to <a id="_idIndexMarker969"/>react to what is happening to the game to give a better sense of immersion. Let’s start adding sound to the explosion effect that enemies spawn when they die, which doesn’t necessarily need scripting itself, but is a result of the script that spawned the explosion in the first place:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">Download an explosion sound effect from the internet or the Asset Store.</li>
      <li class="numberedList">Select the <strong class="screenText">Explosion</strong> prefab we spawn when the enemies die and add <strong class="screenText">Audio Source</strong> to it.</li>
      <li class="numberedList">Set the downloaded explosion’s audio clip as the <strong class="screenText">AudioClip</strong> property of the audio source.</li>
      <li class="numberedList">Make sure <strong class="screenText">Play On Awake</strong> is checked and <strong class="screenText">Loop</strong> is unchecked under <strong class="screenText">Audio Source</strong>:</li>
    </ol>
    <figure class="mediaobject"><img src="img/B18585_14_22.png" alt=""/></figure>
    <p class="packt_figref">Figure 14.22: Adding sounds to our explosion effect</p>
    <p class="normal">As you can see here, we didn’t need to use any script. As the sound is added to the Prefab, it will be played automatically at the very moment the Prefab is instantiated. Now, let’s integrate the shooting<a id="_idIndexMarker970"/> sound by doing the following:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">Download a shooting sound and add it through an audio source to the player’s weapon muzzle effect (not the weapon), this time unchecking the <strong class="screenText">Play On Awake</strong> checkbox.</li>
      <li class="numberedList">In the <code class="inlineCode">PlayerShooting</code> script, create a field of the <code class="inlineCode">AudioSource</code> type called <code class="inlineCode">shootSound</code>.</li>
      <li class="numberedList">Select the <strong class="screenText">Player</strong> in the <strong class="screenText">Hierarchy</strong> and drag the weapon muzzle effect GameObject to the S<strong class="screenText">hoot Sound</strong> property in the <strong class="screenText">Inspector</strong> to connect the script with the <code class="inlineCode">AudioSource</code> variable in the weapon muzzle effect.</li>
      <li class="numberedList">In the <code class="inlineCode">if</code> statement that checks whether we can shoot, add the <code class="inlineCode">shootSound.Play();</code> line to execute the sound when shooting:</li>
    </ol>
    <figure class="mediaobject"><img src="img/B18585_14_23.png" alt="Text  Description automatically generated"/></figure>
    <p class="packt_figref">Figure 14.23: Adding sound when shooting</p>
    <p class="normal">The Visual Scripting additional <a id="_idIndexMarker971"/>nodes would look like this:</p>
    <figure class="mediaobject"><img src="img/B18585_14_24.png" alt="A picture containing text, electronics, screenshot  Description automatically generated"/></figure>
    <p class="packt_figref">Figure 14.24: Adding sound when shooting in Visual Scripting</p>
    <p class="normal">As we did with the muzzle effect, we added a GameObject variable called <code class="inlineCode">shootSound</code> to reference the weapon GameObject that<a id="_idIndexMarker972"/> contains the <code class="inlineCode">AudioSource</code>, and then we called the <strong class="screenText">Play</strong> method of the <code class="inlineCode">shootSound</code> variable.</p>
    <p class="normal">I challenge you to try adding shooting sounds to the enemy AI in both C# and Visual Scripting versions of the scripts. Take as a guide what we did in <em class="chapterRef">Chapter 11</em>, <em class="italic">Visual Effects with Particle Systems and Visual Effect Graph</em>,<em class="italic"> </em>for the muzzle effect, and in any case, you can always check the Git repository of the book (link can be found in the <em class="italic">Preface</em>) for the solution.</p>
    <p class="normal">Another approach to this would be the same as the one we did with the explosion; just add the shooting sound to the bullet, but if the bullet collides with a wall, soon enough the sound will be cut off. Or, if in the future we want an automatic weapon sound, it will need to be implemented as a single looping sound that starts when we press the relevant key and stops when we release it. This way, we prevent too many sound instances from overlapping when we shoot too many bullets. Take into account those kinds of scenarios when choosing the approach to script your feedback.</p>
    <h1 id="_idParaDest-183" class="heading-1">Summary</h1>
    <p class="normal">In this chapter, we discussed how to import and integrate sounds, considering their impact on memory usage, and we considered how to apply effects to generate different scenarios. Sound is a big part of achieving the desired game experience, so take the proper amount of time to get it right.</p>
    <p class="normal">Now that we have covered almost all of the vital aesthetic aspects of our game, let’s create another form of visual communication, the user interface or UI. We will create the necessary UI to display the player’s current score, bullets, life, and lots more info in the next chapter.</p>
  </div>
</body></html>