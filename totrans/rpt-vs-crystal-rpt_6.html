<html><head></head><body><div><div><div><div><h1 class="title"><a id="ch06"/>Chapter 6. Working with Cross-Tab Reports</h1></div></div></div><p>In this chapter we will see one of the most important type of Crystal Reports: the Cross-Tab report. It is one of the most powerful tools in Crystal Reports. A Cross-Tab report is used to summarize data efficiently as we will see in this chapter.</p><p>We will cover the following topics:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Creating a Cross-Tab report</li><li class="listitem" style="list-style-type: disc">Customizing the Cross-Tab appearance using the Cross-Tab Expert</li><li class="listitem" style="list-style-type: disc">Doing page setup</li></ul></div><p>The Cross-Tab report<a id="id151" class="indexterm"/> is very useful for the user because it summarizes a lot of information in a simple form to give the user the information he needs. We can see the final report as shown in the following screenshot:</p><div><img src="img/6-1.jpg" alt="Working with Cross-Tab Reports"/></div><p>As we see in the preceding screenshot, the report displays the sum of the product orders for each city. In our application, the user will select the product category and the country. The report will display the result shown in the previous screenshot.</p><div><div><div><div><h1 class="title"><a id="ch06lvl1sec33"/>Creating our report</h1></div></div></div><p>So let's start <a id="id152" class="indexterm"/>creating our report:</p><div><ol class="orderedlist arabic"><li class="listitem">The SQL query that we will use in our report is shown in the following screenshot:<div><img src="img/6-2.jpg" alt="Creating our report"/></div></li><li class="listitem">We will create a new TableAdapter using this SQL query and name it <code class="literal">ProductsOrdersTableAdapter</code>, as seen in the following screenshot:<div><img src="img/6-3.jpg" alt="Creating our report"/></div></li><li class="listitem">Add a new crystal report to our application and name it <code class="literal">crProductsOrders</code>. As we see in the following screenshot, we can create our report by selecting the <strong>Using the Report Wizard</strong> option and then choosing <strong>Cross-Tab</strong> as an Expert, or we can select <strong>As a Blank Report</strong> and we will add the Cross-Tab from the report itself. We will take the second option to see how we can add or modify our Cross-Tab at any time after creating the report, so we will choose <strong>As a Blank Report</strong> as shown in the following screenshot:<div><img src="img/6-4.jpg" alt="Creating our report"/></div></li><li class="listitem">Right-click on <a id="id153" class="indexterm"/><strong>Database Fields</strong> in <strong>Field Explorer</strong> and select <strong>Database Expert</strong>, and then a window appears, as shown in the following screenshot. As shown below, we will choose our TableAdapter <strong>ProductsOrders</strong> as a data source:<div><img src="img/6-5.jpg" alt="Creating our report"/></div></li><li class="listitem">Right-click on the <a id="id154" class="indexterm"/>report and navigate to <strong>Insert</strong> | <strong>Cross-Tab</strong> and drag it to <strong>Section1 (Report Header)</strong>. As we see in the following screenshot, we will add <strong>ShipCountry</strong> and <strong>ShipCity</strong> to the <strong>Columns</strong> list, <strong>CategoryName</strong> and <strong>ProductName</strong> to the <strong>Rows</strong> list, and <strong>Quantity</strong> to <strong>Summarized Fields</strong> list. From the <strong>Style</strong> tab, we can choose any style, however need but the original style is preferred. We will see how to use the <strong>Customize Style</strong> tab in the next few steps. Click on the <strong>OK</strong> button.<div><img src="img/6-6.jpg" alt="Creating our report"/></div></li><li class="listitem">Until now our <a id="id155" class="indexterm"/>report displays all the products and countries, so we will add two parameter fields to filter the report data by product categories and shipping countries. The first parameter field is <strong>pmCountry</strong> and the second one is <strong>pmCategory</strong>. See the following screenshot:<div><img src="img/6-7.jpg" alt="Creating our report"/></div></li><li class="listitem">Add a text object to the report as the report header and enter <code class="literal">Best-selling products</code> for the countries in it.</li><li class="listitem">Go to the main form in our application, double-click on the <strong>btnProductsOrdersByFilters</strong> (<strong>By filter</strong>) button to navigate to the code behind, and write the code to display the report in our application, as shown in the following screenshot:<div><img src="img/6-8.jpg" alt="Creating our report"/></div></li><li class="listitem">Run the <a id="id156" class="indexterm"/>application to test the result. Choose <strong>Dairy Products</strong> from the <strong>Category</strong> list and <strong>UK</strong> from the <strong>Country</strong> list as we see in the following screenshot. Click on the <strong>By filters</strong> button to display the report.<div><img src="img/6-9.jpg" alt="Creating our report"/></div></li><li class="listitem">The report will look like the following screenshot:<div><img src="img/6-10.jpg" alt="Creating our report"/></div></li></ol></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch06lvl1sec34"/>Customizing the Cross-Tab appearance</h1></div></div></div><p>In the next few steps, we<a id="id157" class="indexterm"/> will see how to update the report to resemble the design at the beginning of this chapter.</p><p>As we saw in the preceding screenshot, the two last columns and the last two rows have the same date, so we will hide the last column and the last row in our report.</p><div><ol class="orderedlist arabic"><li class="listitem">Right-click in the top-left of the Cross-Tab and select <strong>Cross-Tab Expert</strong>, and navigate to the <strong>Customize Style</strong> tab. We will select the <strong>Suppress Row Grand Totals</strong> and <strong>Suppress Column Grand Totals</strong> checkboxes as we see in the following screenshot. Click on the <strong>OK</strong> button.<div><img src="img/6-11.jpg" alt="Customizing the Cross-Tab appearance"/></div></li><li class="listitem">Run the <a id="id158" class="indexterm"/>application to test the result. It will look like the following screenshot:<div><img src="img/6-12.jpg" alt="Customizing the Cross-Tab appearance"/></div></li><li class="listitem">We can see in this <a id="id159" class="indexterm"/>report that the number of products displayed is more than the products that we have seen in the designed report in the beginning of this chapter. So, we need to sort the products according to the number of orders.</li><li class="listitem">In the designed report at the beginning of this chapter, we displayed the two products that have the top rate of orders only, so the report header is <strong>Best-selling products for countries</strong> and not all the products. In the next step, we will see how to control the number of products displayed in our report.</li><li class="listitem">Right-click on the top left of the Cross-Tab, select <strong>Group Sort Expert,</strong> and navigate to the <strong>ProductsOrders.ProductName</strong> tab as shown in the following screenshot:<div><img src="img/6-13.jpg" alt="Customizing the Cross-Tab appearance"/></div></li><li class="listitem">We will select the <a id="id160" class="indexterm"/><strong>Top N</strong> value from the <strong>For this group sort</strong> list and enter <code class="literal">2</code> in the <strong>where N is</strong> textbox to display only two products in the Cross-Tab. Click on the <strong>OK</strong> button and run the application to see the result as shown in the following screenshot:<div><img src="img/6-14.jpg" alt="Customizing the Cross-Tab appearance"/></div></li><li class="listitem">If we compare this report with the one designed in the beginning of this chapter, we will find no difference between them except the formatting of the text and the numbers. You can format it as per your need.</li><li class="listitem">In the next step, we will see how we can change the format of the grid lines and the background colors of the cells.</li><li class="listitem">Right-click on the top left of the Cross-Tab and select <strong>Cross-Tab Expert</strong> and navigate to the <strong>Customize Style</strong> tab. As we see in the following screenshot, we will select the row or column we want to change the background color of and select the color we need to apply to it.<div><img src="img/6-15.jpg" alt="Customizing the Cross-Tab appearance"/></div></li><li class="listitem">Click on the <a id="id161" class="indexterm"/><strong>Format Grid Lines</strong> button to format the Cross-Tab lines as we can see in the following screenshot. Select the line. The line color, style, or width can be altered as desired.<div><img src="img/6-16.jpg" alt="Customizing the Cross-Tab appearance"/></div></li><li class="listitem">Click on the <a id="id162" class="indexterm"/><strong>OK</strong> button to save the changes and run the application to test the new appearance. This is shown in the following screenshot:<div><img src="img/6-17.jpg" alt="Customizing the Cross-Tab appearance"/></div></li><li class="listitem">What if the user needs to display products of all categories to a specific country with the ability to filter data by the products category?</li><li class="listitem">We will make a small change to apply this request: we will change the parameter condition in our report as shown in the following screenshot:<div><img src="img/6-18.jpg" alt="Customizing the Cross-Tab appearance"/></div></li><li class="listitem">When the user <a id="id163" class="indexterm"/>writes string <code class="literal">ALL</code> in the category list, the report will display all categories. Run the application and test the change, it will look like the following screenshot:<div><img src="img/6-19.jpg" alt="Customizing the Cross-Tab appearance"/></div></li></ol></div></div>
<div><div><div><div><h1 class="title"><a id="ch06lvl1sec35"/>Performing page setup</h1></div></div></div><p>When we work with<a id="id164" class="indexterm"/> Cross-Tab we need to be careful with<a id="id165" class="indexterm"/> the page size because the width of the report grows dynamically. If we try to test the Cross-Tab by inputting the value <code class="literal">USA</code>, we will see that the report is divided into two parts as shown in the following screenshot:</p><div><img src="img/6-20.jpg" alt="Performing page setup"/></div><p>This problem occurs because the value <code class="literal">USA</code> has many corresponding values for cities in our database and our report is designed to display and print in a portrait letter form. We can change the basic page settings by right-clicking on the report and navigating to <strong>Design</strong> | <strong>Page Setup</strong>. This is shown in the following screenshot. The page size has been changed to <strong>A3</strong> and the <strong>Orientation</strong> to <strong>Landscape</strong>.</p><div><img src="img/6-21.jpg" alt="Performing page setup"/></div><p>If we test by <a id="id166" class="indexterm"/>inputting the value <code class="literal">USA</code> again, the result <a id="id167" class="indexterm"/>will look like the following screenshot:</p><div><img src="img/6-22.jpg" alt="Performing page setup"/></div></div>
<div><div><div><div><h1 class="title"><a id="ch06lvl1sec36"/>Summary</h1></div></div></div><p>In this chapter we have seen how useful Cross-Tab is. We learned to create Cross-Tab report and use the Cross-Tab Expert to control every part of the Cross-Tab. In the next chapter, we will see another fantastic tool in Crystal Reports; we will see how we can create reports containing charts.</p></div></body></html>