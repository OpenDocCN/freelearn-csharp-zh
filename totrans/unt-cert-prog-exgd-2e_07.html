<html><head></head><body>
		<div><h1 id="_idParaDest-130"><em class="italic"><a id="_idTextAnchor132"/>Chapter 7</em>: Creating a Game Loop and Mock Test</h1>
			<p>In the previous chapter, we moved from the <code>testLevel</code> scene (where we controlled the player ship) to a <code>shop</code> scene (buying and calibrating the player's ship). In this chapter, we will be following a similar trend of stretching out to the rest of the other game scenes in our <code>Scene</code> folder (found in the <code>Assets</code> folder).</p>
			<p>As part of scene management, all games we play have something called a "Game Loop" – if you're not familiar with the term, it basically means our game will have alternative routes to take. Each route will load a particular scene. We will need to cater for either outcome at each stage of the game.</p>
			<p>Eventually, all game loops will loop back to somewhere near the beginning. The following image shows what our game loop will look like by the end of this chapter:</p>
			<div><div><img src="img/Figure_7.01_B18381.jpg" alt="Figure 7.1 – Killer Wave's Game Loop&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.1 – Killer Wave's Game Loop</p>
			<p>Referring to the game loop image still, each name in its rectangular box represents a scene in Unity that we have in our <code>Scene</code> folder inside the <strong class="bold">Project</strong> window. The flow of each scene goes in one overall direction, starting at the top with <strong class="bold">BOOTUP</strong>. This is when the game is launched for the first time. The flow will fall through each scene until the player beats all three levels or dies. Either way, they will eventually reach the <strong class="bold">GAMEOVER</strong> scene, which will then loop back up to the <strong class="bold">TITLE</strong> scene to create a loop.</p>
			<p>By the end of this chapter, we will be in the position to run our game from the <code>bootUp</code> scene, where it will automatically move onto the <code>title</code> scene. From there, the player will press the fire button or tap the screen to then load up the <code>shop</code> scene, which is where purchases can be made.</p>
			<p>Once the player presses the <code>shop</code> scene, the first level (<code>level1</code>) will start. If the player dies, the level will restart, whereas if the player completes the level, they will move onto the next level.</p>
			<p>The final outcome from all of this will be that if the player dies three times, they will be taken back to the <code>title</code> scene, whereas if the player completes the <code>level3</code> scene, then the game will be over, and the player will be taken to the <code>gameOver</code> scene.</p>
			<p>Finally, we will cover a few mock test questions related to what we have covered so far.</p>
			<p>In this chapter, we will cover the following topics:</p>
			<ul>
				<li>Transitioning our player ship</li>
				<li>Expanding our <code>ScenesManager</code> script</li>
				<li>Preparing to loop our game</li>
				<li>Mock test</li>
			</ul>
			<h1 id="_idParaDest-131"><a id="_idTextAnchor133"/>Core exam skills covered in this chapter</h1>
			<p>The following are the core exam skills that will be covered in this chapter:</p>
			<p><em class="italic">Programming core interactions:</em></p>
			<ul>
				<li>Implement and configure game object behavior and physics</li>
				<li>Implement and configure camera views and movement</li>
			</ul>
			<p><em class="italic">Working in the art pipeline:</em></p>
			<ul>
				<li>Understand materials, textures, and shaders, and write scripts that interact with Unity's rendering API</li>
				<li>Understand 2D and 3D animation, and write scripts that interact with Unity's animation API</li>
			</ul>
			<p><em class="italic">Programming for scene and environment design:</em></p>
			<ul>
				<li>Identify methods for implementing Game Object instantiation, destruction, and management</li>
				<li>Recognize techniques for structuring scripts for modularity, readability, and reusability</li>
			</ul>
			<h1 id="_idParaDest-132"><a id="_idTextAnchor134"/>Technical requirements</h1>
			<p>The project content for this chapter can be found at <a href="https://github.com/PacktPublishing/Unity-Certified-Programmer-Exam-Guide-Second-Edition/tree/main/Chapter_07">https://github.com/PacktPublishing/Unity-Certified-Programmer-Exam-Guide-Second-Edition/tree/main/Chapter_07</a>.</p>
			<p>You can download the entirety of each chapter's project files at <a href="https://github.com/PacktPublishing/Unity-Certified-Programmer-Exam-Guide-Second-Edition">https://github.com/PacktPublishing/Unity-Certified-Programmer-Exam-Guide-Second-Edition</a>.</p>
			<p>All the content for this chapter is held in this chapter's <code>unitypackage</code> file, including a <code>Complete</code> folder that holds all of the work we'll carry out in this chapter.</p>
			<p>Check out the following video to see the <em class="italic">Code in Action</em>: <a href="https://bit.ly/37Rie3B">https://bit.ly/37Rie3B</a>.</p>
			<h1 id="_idParaDest-133"><a id="_idTextAnchor135"/>Transitioning our player ship</h1>
			<p>Currently, our <a id="_idIndexMarker637"/>levels can only be completed when the player dies, causing the level to restart, or when the player loses all three lives. Only then are we taken to the game over screen. We now need to start thinking of how a player starts and ends a level. Currently, the player just appears at the start of a level.</p>
			<p>In this section, we are going to write some code that animates our player into the scene and, when the level completes, we will have the player ship exit the camera view.</p>
			<p>So, let's make a script the same way we did all the other scripts (<a href="B18381_02_Epub.xhtml#_idTextAnchor048"><em class="italic">Chapter 2</em></a><em class="italic">, Adding and Manipulating Objects</em>, if you need a reference). Name the script <code>PlayerTransition</code> and make sure we have the file in our <code>Script</code> folder in the Unity Editor <strong class="bold">Project</strong> window.</p>
			<p>We now need to attach the <code>PlayerTransition</code> script to our <code>player_ship</code> prefab:</p>
			<ol>
				<li>Load up the <code>testLevel</code> scene from <code>Assets/Scene</code> in the <strong class="bold">Project</strong> window.</li>
				<li>Then, navigate to the <code>Assets/Prefab/Player</code> folder, and select the <code>player_ship</code> prefab.</li>
				<li>Finally, drag and drop the <code>PlayerTransition</code> script into an empty area of the <code>player_ship</code> <code>PlayerTransition</code> component in the <code>PlayerTransition</code> component will start animating <code>player_ship</code> in the <code>shop</code> scene.</li>
			</ol>
			<p>Now that our script has been created and attached, we can go into it and start setting up the following code:</p>
			<ul>
				<li>Adding variables to our <code>PlayerTransition</code> script</li>
				<li>Adding methods/functions to our <code>PlayerTransition</code> script</li>
				<li>Adding <code>if</code> statement checks</li>
				<li>Adding <a id="_idIndexMarker638"/>content to <code>PlayerMovement IEnumerator</code></li>
				<li>Moving the player ship out of the screen</li>
			</ul>
			<p>Let's take a look.</p>
			<h2 id="_idParaDest-134"><a id="_idTextAnchor136"/>Adding variables to our PlayerTransition script</h2>
			<p>In this <a id="_idIndexMarker639"/>section, we are going to make a start by <a id="_idIndexMarker640"/>setting up our <code>PlayerTransition</code> script. We'll do this by adding global variables so that these can be used to position the player ship.</p>
			<p>To start adding our global variables, follow these steps:</p>
			<ol>
				<li value="1">Open our newly created <code>PlayerTransition</code> script.</li>
				<li>At the top of the script, make sure we have the following libraries added:<pre><strong class="bold">using UnityEngine;using System.Collections;</strong></pre></li>
			</ol>
			<p>By default, our script should be automatically named along with its default inherit <code>MonoBehaviour</code> as it's a requirement regarding the Unity Editor and other functionalities. The <code>System.Collections</code> library will be used for our <code>StartCoroutine</code>. Without this library, we can't create coroutines; we will explain more about this when we come to coding it in.</p>
			<ol>
				<li value="3">Check/enter the following code for our <code>PlayerTransition</code> script, which holds <a id="_idIndexMarker641"/>the<a id="_idIndexMarker642"/> script's default name and <code>MonoBeaviour</code> inheritance for added functionality:<pre><strong class="bold">public class PlayerTransition : MonoBehaviour </strong> <strong class="bold">{</strong></pre></li>
				<li>Within the <code>PlayerTransition</code> class, enter the following global <code>Vector3</code> variables:<pre>    Vector3 transitionToEnd = new Vector3(-100,0,0);    Vector3 transitionToCompleteGame = new Vector3(7000,0,0);    Vector3 readyPos = new Vector3(900,0,0);    Vector3 startPos;</pre></li>
			</ol>
			<p>The <code>startPos</code> and <code>readyPos</code> variables are used to measure the distance from where our player ship is and where we want it to travel to.</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">At this point, be sure that the <code>_Player</code> game object's <strong class="bold">Transform Position</strong> property values are set to zero on its X, Y, and Z axes in the <strong class="bold">Inspector</strong> window. Otherwise, the player ship may animate into the wrong position when entering the level.</p>
			<p>The <code>transitionToEnd</code> variables will be used as the coordinates where we want our player game object ship to travel to at the start of the level, as well as when the player's ship is about to leave a level. <code>transitionToCompleteGame</code> is only used when the player completes the third and final level and is used to alter the player's ending animation.</p>
			<ol>
				<li value="5">Continue entering the following <code>float</code> variables in our <code>PlayerTransition</code> script:<pre>  float distCovered;  float journeyLength;</pre></li>
			</ol>
			<p><code>distCovered</code> will hold time data that will be used later to measure between two <code>Vector3</code> points (we will talk about this in more detail when we make <code>PlayerMovement</code> <code>IEnumerator</code>).</p>
			<p><code>journeyLength</code> will <a id="_idIndexMarker643"/>hold the distance between the two <code>Vector3</code> points mentioned <a id="_idIndexMarker644"/>previously (<code>startPos</code> and <code>readyPos</code>).</p>
			<ol>
				<li value="6">The final set of variables are the bools to be added to our <code>PlayerTransition</code> script:<pre> bool levelStarted = true; bool speedOff = false; bool levelEnds = false; bool gameCompleted = false; public bool LevelEnds  {    get {return levelEnds;}    set {levelEnds = value;} } public bool GameCompleted  {    get {return gameCompleted;}    set {gameCompleted = value;} }</pre></li>
			</ol>
			<p><code>levelStarted</code> is the only <code>bool</code> set to <code>true</code> as it confirms that the level has started and will only be set to <code>false</code> after the transition of the player's animation has finished. <code>speedOff</code> will be set to <code>true</code> when we want the player's ship to leave the level.</p>
			<p><code>levelEnds</code> is set to <code>true</code> when the level has come to the end and the player ship will then move to its exit position. The last <code>bool</code> is for when the whole game has been completed. This is used to change the ending animation. The two <a id="_idIndexMarker645"/>properties are used for <a id="_idIndexMarker646"/>accessing the <code>levelEnds</code> and <code>gameCompleted</code> variables from outside of the script.</p>
			<p>That's our variables added to our script. Now, let's continue to the <code>PlayerTransition</code> methods and functions.</p>
			<h2 id="_idParaDest-135"><a id="_idTextAnchor137"/>Adding methods/functions to our PlayerTransition script</h2>
			<p>As we <a id="_idIndexMarker647"/>continue <a id="_idIndexMarker648"/>through our <code>PlayerTransition</code> script, we will add Unity's <code>Start</code> function and create our own <code>Distance</code> method to position the player's ship in the correct location:</p>
			<ol>
				<li value="1">Starting with the <code>Start</code> function, continue entering the following code for our <code>PlayerTransition</code> script:<pre>    void Start()    {        this.transform.localPosition = Vector3.zero;        startPos = transform.position;        Distance();    }</pre></li>
			</ol>
			<p>The <code>Start</code> function gets called as soon as this script is enabled. In this function, we will reset the position of the player's ship to its parent game object, which is the <code>PlayerSpawner</code> game object.</p>
			<p>We will then assign the player ship's beginning world space position to one of the vectors we created earlier in this section (<code>startPos</code>). We will use this in the <code>Distance</code> method, which we will talk about next.</p>
			<ol>
				<li value="2">Enter the <code>Distance</code> method and its content in the <code>PlayerTransition</code> class: <pre>    void Distance()    {        journeyLength = Vector3.Distance(startPos, readyPos);    }</pre></li>
			</ol>
			<p><code>Vector3.Distance</code> is a ready-made Unity function that will measure the distance between two vector points and gives the answer in the form of a <code>float</code> that <a id="_idIndexMarker649"/>we will be storing in <code>journeyLength</code>. The reason for this is that we<a id="_idIndexMarker650"/> will want to know the length between where our player ship is and where it needs to go (which we'll cover later in this chapter).</p>
			<p>In the next section, we will move into Unity's <code>Update</code> function, where we will check for when the level has ended so that we can exit (move) our player ship out of the screen.</p>
			<h2 id="_idParaDest-136"><a id="_idTextAnchor138"/>Adding if statement checks</h2>
			<p>In this <a id="_idIndexMarker651"/>section, we <a id="_idIndexMarker652"/>are going to make use of Unity's frame update function, <code>Update</code>, so that we can run checks to see what state our game is at within the level.</p>
			<p>Within our <code>Update</code> function, we will have three <code>if</code> statements. <code>levelStarted</code> is from one of the <code>bool</code> variables that we introduced earlier on in this section, which is already set to <code>true</code>. So, this <code>if</code> statement is going to be called instantly. Let's take a look:</p>
			<ol>
				<li value="1">Let's start by entering the first <code>if</code> statement in the <code>PlayerTransition</code> script's <code>Update</code> function:<pre>    void Update()    {        if (levelStarted)        {            PlayerMovement(transitionToEnd, 10);         }</pre></li>
			</ol>
			<p>Within <a id="_idIndexMarker653"/>the first <code>if</code> statement is a method called <code>PlayerMovement</code>, which also takes two parameters. With regards to what this method does, we will review its content after we have covered the entirety of the <code>Update</code> function.</p>
			<p>Now, let's continue with the second <code>if</code> statement in the <code>Update</code> function.</p>
			<p>This <code>if</code> statement checks to see if the <code>levelEnds</code> variable is <code>true</code>, which, as you may recall, we set to <code>false</code> by default. This <code>bool</code> is accessed outside of the <code>PlayerTransition</code> class, which we will cover later, but for now, all we need to know is that it becomes <code>true</code> at the end of a level.</p>
			<p>Inside the <code>if</code> statement, there are several lines that prepare our player's ship to begin the end of the level, starting with disabling the <code>Player</code> script by setting its <code>enabled</code> bool setting to <code>false</code>. This will knock out the player's controls so that we can animate the player ship into position for the end of the level.</p>
			<p>Next, we disable the player ship's <code>SphereCollider</code> so that if an enemy or one of its bullets comes into contact with the player's ship, it won't destroy the ship while it's preparing to end the level.</p>
			<ol>
				<li value="2">Enter the second following <code>if</code> statement inside the <code>PlayerTransition</code> <code>Update</code> function:<pre>if (levelEnds)  {    GetComponent&lt;Player&gt;().enabled = false;    GetComponent&lt;SphereCollider&gt;().enabled = false;    Distance();    PlayerMovement(transitionToEnd, 200);  }</pre></li>
			</ol>
			<p>Then, we <a id="_idIndexMarker654"/>measure the distance between where the player's ship was at the start of <a id="_idIndexMarker655"/>the level and where it needs to go with the <code>Distance</code> method.</p>
			<p>Finally, within the <code>if</code> statement, we have the same method that we mentioned earlier, with the only difference being that the argument value is set to <code>200</code>. These values will be explained after the fourth <code>if</code> statement for this <code>Update</code> function.</p>
			<p>While we're still within the <code>Update</code> function, we can enter the <code>if</code> statement that covers when the player completes the third and final level:</p>
			<pre>  if (gameCompleted)    {      GetComponent&lt;Player&gt;().enabled = false;      GetComponent&lt;SphereCollider&gt;().enabled = false;      PlayerMovement(transitionToCompleteGame, 200);    }</pre>
			<p>If the <code>gameCompleted</code> <code>bool</code> is <code>true</code>, we fall into the <code>if</code> statements condition. Inside, we turn off the <code>Player</code> script to disable the player's controls. The second line disables the player's collider to avoid any collisions with any enemy-related game objects, while the third line makes the player ship translate from its current position to the value of <code>transitionToCompleteGame</code>. </p>
			<ol>
				<li value="3">Enter the fourth <code>if</code> statement in our <code>PlayerTransition</code> <code>Update</code> function:<pre> if (speedOff)    {       Invoke("SpeedOff",1f);    }}</pre></li>
			</ol>
			<p>In the <a id="_idIndexMarker656"/>fourth <code>if</code> statement, we run a check to <a id="_idIndexMarker657"/>see if the <code>speedOff</code> <code>bool</code> holds the value of <code>true</code>. If it does, we run Unity's own <code>Invoke</code> function, which delays the execution of the <code>SpeedOff</code> method with a 1-second delay.</p>
			<p class="callout-heading">Further Information</p>
			<p class="callout">More about <code>Invoke</code> can be found on the Unity Scripting reference site: <a href="https://docs.unity3d.com/ScriptReference/MonoBehaviour.Invoke.html">https://docs.unity3d.com/ScriptReference/MonoBehaviour.Invoke.html</a>.</p>
			<p>In the next section, we will write some code so that the player is moved from where they are to where they need to be. The two cases where this will need to be achieved are as follows:</p>
			<ul>
				<li>When the player starts the game, we animate them into the scene.</li>
				<li>When the player has completed the level, they need to move into a position to leave the level. </li>
			</ul>
			<p>We will <a id="_idIndexMarker658"/>be <a id="_idIndexMarker659"/>covering two new Unity functions (<code>Mathf.Round</code> and <code>Vector3.Lerp</code>).</p>
			<h2 id="_idParaDest-137"><a id="_idTextAnchor139"/>Adding content to the PlayerMovement method</h2>
			<p>The <code>PlayerMovement</code> method holds <a id="_idIndexMarker660"/>the<a id="_idIndexMarker661"/> responsibility of animating our player ship in the near center of the screen so that it can begin and also exit the level.</p>
			<p>Let's go into more detail to fully understand this:</p>
			<ol>
				<li value="1">Enter the following code for our <code>PlayerMovement</code> method, along with its two parameters:<pre> void PlayerMovement(Vector3 point, float transitionSpeed)    { </pre></li>
			</ol>
			<p>As mentioned previously, our <code>PlayerMovement</code> takes two parameters: a <code>Vector3</code> with the reference name <code>point</code> and a <code>float</code> with the reference name <code>transitionSpeed</code>. As you can imagine, <code>transitionSpeed</code> is the speed of the player ship moving from one point to another. </p>
			<p>If we trace back to what the value of <code>point</code> is, it's coming from a variable that we've already initialized, <code>transitionToStart</code>, with a <code>Vector3</code> at the beginning of this script with a value of <code>(-100,0,0)</code>.</p>
			<p>So, effectively, <code>transitionToStart</code> and <code>point</code> are the same – they're just different in terms of their names, for the sake of keeping their references separate. Anyway, coming back to <code>point</code>, this value is for our player's ship position. The following screenshot shows our player ship with <code>-100,0,0</code>:</p>
			<div><div><img src="img/Figure_7.02_B18381.jpg" alt="Figure 7.2 – Player Ship's position&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.2 – Player Ship's position</p>
			<p>So, when a level begins, our player ship will be on the far left, outside of the screen, and animate into the position we have marked in the previous screenshot.</p>
			<p>Carrying on with the <code>PlayerMovement</code> method, we begin with an <code>if</code> statement that checks when a series of conditions are met. </p>
			<ol>
				<li value="2">Enter <a id="_idIndexMarker662"/>the following <code>if</code> statement, along<a id="_idIndexMarker663"/> with its four conditions:<pre>   if (Mathf.Round(transform.localPosition.x) &gt;= readyPos.x -5 &amp;&amp;               Mathf.Round(transform.localPosition.x) &lt;= readyPos.x +5 &amp;&amp;               Mathf.Round(transform.localPosition.y) &gt;= -5f &amp;&amp;                         Mathf.Round(transform.localPosition.y) &lt;= +5f)                        {</pre></li>
			</ol>
			<p>In the previous code, we've run a check on four occasions to see if the player is in the correct position before executing the rest of the code. Each line of code checks the following:</p>
			<ul>
				<li>If the player ship's X position is more than or equal to the value that is stored in <code>readyPos</code> variable's X position, minus 5.</li>
				<li>If the player ship's X position is less than or equal to the value that is stored in <code>readyPos</code> variable's X position, plus 5.</li>
				<li>If the player ship's Y position is more than or equal to the value that is stored in <code>readyPos</code> variable's Y position, minus 5.</li>
				<li>If the player ship's Y position is less than or equal to the value that is stored in <code>readyPos</code> variable's Y position, plus 5.</li>
			</ul>
			<ol>
				<li value="3">Still<a id="_idIndexMarker664"/> within our <code>PlayerMovement</code> method and within the previous <code>if</code> statement, enter <a id="_idIndexMarker665"/>the following two <code>if</code> statements:<pre>   if (levelEnds)    {      levelEnds = false;      speedOff = true;    }   if (levelStarted)     {       levelStarted = false;       distCovered = 0;       GetComponent&lt;Player&gt;().enabled = true;      }   }</pre></li>
			</ol>
			<p>In <a id="_idIndexMarker666"/>the previous code block, we have two <code>if</code> statements (<code>levelEnds</code> and <code>levelStarted</code>) that check that each of the <code>bool</code> <a id="_idIndexMarker667"/>conditions are <code>true</code>. Let's go through both of their content:</p>
			<ul>
				<li><code>levelEnds</code>: <code>if</code> <code>levelEnds</code> becomes <code>true</code>, we apply <code>false</code> to the <code>levelEnds</code> <code>bool</code> and apply <code>true</code> to the <code>speedOff</code> <code>bool</code>.</li>
				<li><code>levelStarted</code>: <code>if</code> <code>levelStarted</code> is given the value <code>true</code>, we apply false to the <code>levelStarted</code> <code>bool</code>, set the <code>distCovered</code> <code>float</code> to <code>0</code>, and we set the <code>Player</code> script to <code>true</code>.</li>
			</ul>
			<ol>
				<li value="4">Lastly, in our <code>PlayerMovement</code> method, enter the following <code>else</code> condition that sits outside the main <code>if</code> statement:<pre>   else      {       distCovered += Time.deltaTime * transitionSpeed;       float fractionOfJourney = distCovered /     journeyLength;       transform.position = Vector3.Lerp(transform.    position, point,         fractionOfJourney);      }   }</pre></li>
			</ol>
			<p>Referring to the <code>else</code> condition code block, we add time and multiply it by <code>transitionSpeed</code>, which, as you may recall, is one of the two arguments this method takes. Make sure this else statement is relating to the Mathf.Round if statement and not the two bool checking if statements.</p>
			<p>We then divide the <code>distCovered</code> variable by the <code>journeyLength</code> variable, which, as you may recall, is a measurement between two points. We store the division in a <code>float</code> variable called <code>fractionOfJourney</code>. </p>
			<p>The last thing we do in this <code>else</code> condition is use one of Unity's pre-made functions called <code>Lerp</code>, which linearly interpolates our player's ship between two points. <code>Lerp</code> takes three arguments: point A, point B, and the time scale it's going to move between these two points. <code>transform.position</code> is our player's ship, the second is the <code>Vector3</code> point, which <a id="_idIndexMarker668"/>is the other variable we brought into <code>IEnumerator</code>, and the third <a id="_idIndexMarker669"/>is the active <code>float</code> <code>fractionOfJourney</code>.</p>
			<p class="callout-heading">Information</p>
			<p class="callout">It's also possible to <code>Lerp</code> colors over time with <code>Material.Lerp</code>.For more information about changing one color into another, check out <a href="https://docs.unity3d.com/ScriptReference/Material.Lerp.html">https://docs.unity3d.com/ScriptReference/Material.Lerp.html</a>.</p>
			<p>We now need to add a single line of code in the <code>PlayerSpawner</code> script to turn the <code>PlayerTransition</code> script on after the player leaves the shop scene. As mentioned earlier in the chapter, if the <code>PlayerTransition</code> was left on in the shop scene, the <code>player_ship</code> would animate across the screen.</p>
			<p>So, to turn on the <code>PlayerTransition</code> script at the start of the <code>level1</code> scene, we need to do the following:</p>
			<ol>
				<li value="1">In the <code>Assets/Script</code> and open the <code>PlayerSpawner</code> script.</li>
				<li>Scroll down to the following line of code:<pre>playerShip.transform.position = Vector3.zero;</pre></li>
				<li>Enter the following line of code just after it:<pre>playerShip.GetComponent&lt;PlayerTransition&gt;().enabled = true;</pre></li>
			</ol>
			<p>This line of code will make our player ship animate into the <code>level1</code> scene.</p>
			<p>The last change we need to make in the <code>PlayerSpawner</code> script is to remove the ability to enable the <code>Player</code> script in the <code>PlayerSpawner Start</code> function, we will enable this in the <code>ScenesManager</code> script.</p>
			<ol>
				<li value="4">In the <code>PlayerSpawner</code> script, remove the following line in the <code>Start</code> function:<pre><strong class="bold">GetComponentInChildren&lt;Player&gt;().enabled = true;</strong></pre></li>
				<li>Save the <code>PlayerSpawner</code> script.</li>
			</ol>
			<p>Now, let's<a id="_idIndexMarker670"/> move onto the last bit of code, where<a id="_idIndexMarker671"/> we'll be moving our player ship out of the screen at the end of the level.</p>
			<h2 id="_idParaDest-138"><a id="_idTextAnchor140"/>Moving the player ship out of the screen</h2>
			<p>The last<a id="_idIndexMarker672"/> method we need to cover in the <code>PlayerTransition</code> script is the <code>SpeedOff</code> method. This method simply makes our player's ship jet off, out of the screen, when the level is completed. Let's take a look:</p>
			<ol>
				<li value="1">Enter the following code in our <code>PlayerTransition</code> script:<pre> void SpeedOff() { transform.Translate(Vector3.left * Time.deltaTime*800); }</pre></li>
			</ol>
			<p>This code block uses Unity's pre-made <code>Translate</code> function, which takes a <code>Vector3.left</code> multiplied by time, with <code>800</code> being used to make the player ship move a little faster.</p>
			<ol>
				<li value="2">Save the script.</li>
			</ol>
			<p>That is the end of the <code>PlayerTransition</code> script. Now, our game has an introduction and an ending for our player ship. Originally, our player would just be present at the start of the level and when it was classed as being completed, the next level would load. We also technically covered three new functions, as follows:</p>
			<ul>
				<li><code>Vector3.Distance</code>, which measures between two <code>Vector3</code> points</li>
				<li><code>Vector3.Lerp</code>, which moves the player ship, smoothing between two <code>Vector3</code> points</li>
				<li><code>MathF.Round</code>, which rounds off a number</li>
			</ul>
			<p>We combined these new skills to make our player ship move into position to start the level and, when completed, no matter where the player was on the screen, we moved them into <a id="_idIndexMarker673"/>position. Finally, our player zooms off the screen.</p>
			<p>In the next section, we are going to revisit the <code>ScenesManager</code> script and apply some code so that there's a time limit, counting down to when the level is over.</p>
			<h1 id="_idParaDest-139"><a id="_idTextAnchor141"/>Expanding our ScenesManager script </h1>
			<p>In this <a id="_idIndexMarker674"/>section, we are going to make our <code>ScenesManager</code> script recognize levels 2 and 3 from our <code>scenes</code> folder (<code>Assets/Scene</code>).  We will then add these levels to the game loop. Also, we will be adding a game timer for each level. When the timer reaches its limit, we can then trigger the player leaving the level with an animation that will play out. Lastly, we will add a few common methods to move the game onto the next level.</p>
			<p>Let's start by opening the <code>ScenesManager</code> script (<code>Assets/Script/Scenesmanager.cs</code>) and adding some variables to assist with what we were talking about. Follow these steps:</p>
			<ol>
				<li value="1">At the top of the <code>ScenesManager</code> script, add the following variables:<pre>  float gameTimer = 0;  float[] endLevelTimer = {30,30,45};  int currentSceneNumber = 0;  bool gameEnding = false;</pre></li>
			</ol>
			<p>The <code>gameTimer</code> variable timer will be used as our current counter to time how long the level has left until it is over. The following variable is an array that holds the time until each level ends. So, we have three levels in total, but the question is, how long do we want each level to last? We need to enter a value that represents the seconds until the level ends, so I've chosen <code>30</code> seconds for levels 1 and 2.  Level 3, however, will last 45 seconds. This is because we will be building a special level in , <em class="italic">NavMesh, Timeline, and a Mock Test</em>. We will go into more detail about this when we reach that chapter.</p>
			<p>As you can imagine, <code>currentSceneNumber</code> will hold the number that denotes which scene our player is currently on. Lastly, we have the <code>gameEnding</code> bool, which will be used to trigger the end of the level animation for the player's ship. We will cover these variables in more detail later in this section, let's start with <code>currentSceneNumber</code>.</p>
			<p>Following on from the global variables we just set, let's make sure that the <code>ScenesManager</code> script is always aware of what scene our player is on during the game. This will help our code know which scene the player is on and what scene they will be going to next.</p>
			<ol>
				<li value="2">Add the <code>Update</code> function, which will be called on every frame to check which scene we<a id="_idIndexMarker675"/> are at. Do this by entering the following code in the <code>ScenesManager</code> script:<pre>  void Update()  {    if (currentSceneNumber !=       SceneManager.GetActiveScene().buildIndex)    {      currentSceneNumber = SceneManager.GetActiveScene().buildIndex;      GetScene();    }    GameTimer();  }</pre></li>
			</ol>
			<p>Inside the <code>Update</code> function, we use an <code>if</code> condition to check if the <code>currentSceneNumber</code> variable is not equal to the <code>buildIndex</code> we are grabbing from the active scene we are in.</p>
			<p>If it is not equal, we update <code>currentSceneNumber</code> with the current scene's <code>buildIndex</code>, followed by the <code>GetScene</code> method. The <code>GetScene</code> method is a small method that is worth covering now instead of later as it relates to everything we've just said.</p>
			<p>Inside the <code>GetScene</code> method is a single line of code that updates the scene's variable. This is an instance from the <code>Scenes</code> <code>enum</code> that holds the names for each scene in our game. Also, the code in the <code>GetScene</code> method is casting <code>currentSceneNumber</code> to an <code>enum</code>, which is why the <code>Scenes</code> type is in brackets. More about casting can be found at <a href="https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/types/casting-and-type-conversions">https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/types/casting-and-type-conversions</a>.</p>
			<ol>
				<li value="3">Enter the following code for our <code>ScenesManager</code> script:<pre>  void GetScene()  {    scenes = (Scenes)currentSceneNumber;  }</pre></li>
			</ol>
			<p>We can put the <code>GetScene</code> method anywhere in the <code>ScenesManager</code> class, as long as it's not within another method.</p>
			<p>Coming back to the <code>Update</code> function, after calling the <code>GetScene</code> method, we close the <code>if</code> conditions brackets. The last thing we do before closing the <code>Update</code> function is run the <code>GameTimer</code> method, which will keep track of our game's time and set up some basic methods that will start, reset, and end our game levels.</p>
			<p>In the following sections, we will cover the following topics:</p>
			<ul>
				<li>Adding<a id="_idIndexMarker676"/> a timer to each game level. When the timer is up, that notifies the player has completed the level.</li>
				<li>Make it so that when a level is completed, the <code>ScenesManager</code> script knows what to do next; that is, load a level, which level, and so on.</li>
			</ul>
			<p>Let's get started.</p>
			<h2 id="_idParaDest-140"><a id="_idTextAnchor142"/>Adding a game level timer</h2>
			<p>In the <code>ScenesManager</code> script, we will set up a method that will be responsible for acknowledging <a id="_idIndexMarker677"/>the level has ended. The <code>GameTimer</code> method serves the purpose of adding time to a <code>gameTimer</code> variable and checking to see if it has reached its limit, depending on the <code>endLevelTimer</code> it's comparing to. Finally, if the game has been triggered to end the player ship's animation, it is set to start and the next level is loaded after <code>4</code> seconds.</p>
			<p>With <a id="_idIndexMarker678"/>your <code>ScenesManager</code> script still open, add the following method to your code:</p>
			<pre>void GameTimer() {   switch (scenes)   {     case Scenes.level1 : case Scenes.level2 : case Scenes.level3 :     {         if (gameTimer &lt; endLevelTimer[currentSceneNumber-3])        {           //if level has not completed            gameTimer += Time.deltaTime;         }         else          {         //if level is completed          if (!gameEnding)         {            gameEnding = true;            if (SceneManager.GetActiveScene().name != "level3")          {            GameObject.FindGameObjectWithTag("Player").    GetComponent                 &lt;PlayerTransition&gt;().LevelEnds = true;          }          else           {            GameObject.FindGameObjectWithTag("Player").    GetComponent                &lt;PlayerTransition&gt; ().GameCompleted = true;                                                                                                                     }             Invoke("NextLevel",4);         }       }      break;     }    } }</pre>
			<p>Inside <a id="_idIndexMarker679"/>the <code>GameTimer</code> method, we run a <code>switch</code> statement holding the <code>scenes</code> instance that will contain all of the <code>enum</code> names of each level. We run a check on three possible cases: <code>level1</code>, <code>level2</code>, and <code>level3</code>. If the <code>scenes</code> instance is set to either of the three possibilities, we will fall into an <code>if</code> condition that will then compare whether the <code>gameTimer</code> variable is less than what the <code>endLevelTimer</code> array has been set to. </p>
			<p>We only need to know what build index number levels 1, 2, and 3 are on. So, to avoid the first three scenes, we must subtract by <code>3</code>. </p>
			<p>The following screenshot shows the <strong class="bold">Build Settings</strong> window (<strong class="bold">File</strong> | <strong class="bold">Build Settings</strong>), which contains the scenes and their build numbers in your project on the right-hand side:</p>
			<div><div><img src="img/Figure_7.03_B18381.jpg" alt="Figure 7.3 – Build Settings – scene order&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.3 – Build Settings – scene order</p>
			<p>If <code>gameTimer</code> is less than <code>levelTimer</code>, we will continue to increment <code>gameTimer</code> with the <code>Time.deltaTime</code> fixed function that Unity has pre-made for us. More information about <code>Time.deltaTime</code> can be found here: <a href="https://docs.unity3d.com/ScriptReference/Time-deltaTime.html">https://docs.unity3d.com/ScriptReference/Time-deltaTime.html</a>.</p>
			<p>If <code>gameTimer</code> is equal to or more than <code>levelTimer</code>, we will move into the <code>else</code> condition, which checks the condition of the <code>if</code> statement of the <code>gameEnding</code> <code>bool</code> being <code>false</code>. If the condition is <code>false</code>, we fall into the content of the <code>if</code> statement, which first sets the <code>gameEnding</code> <code>bool</code> to <code>true</code>. This will stop the <code>if</code> statement from repeating in the <code>Update</code> function's frame cycle.</p>
			<p>The last <code>if</code> statement checks which level our game is on. If we are not on <code>"level3"</code>, we set the <code>LevelEnds</code> property in the <code>PlayerTransition</code> script to <code>true</code>. Otherwise, we must have completed the game. So, in the <code>else</code> condition, we set the <code>GameComplete</code> property to <code>true</code> in the <code>PlayerTransition</code> script.</p>
			<p>In this<a id="_idIndexMarker680"/> section, we created a method in the <code>ScenesManager</code> script that made our game aware of how long each level will last before classing the level as completed.</p>
			<p>We will now continue with the <code>ScenesManager</code> script by adding methods that will start, reset, and move our player onto the next level when triggered by the <code>GameTimer</code> method.</p>
			<h2 id="_idParaDest-141"><a id="_idTextAnchor143"/>Beginning, resetting, and skipping levels</h2>
			<p><code>ScenesManager</code> will<a id="_idIndexMarker681"/> have the <a id="_idIndexMarker682"/>responsibility of<a id="_idIndexMarker683"/> starting a level, resetting it when the player dies, and moving onto the next level when the current one has been completed. Thankfully, these require minimal work thanks to Unity's <code>SceneManagement</code> library.</p>
			<p>Let's start by revisiting the <code>ResetScene</code> method we have already started, but now, we will simplify it even more:</p>
			<ol>
				<li value="1">Replace the content from our <code>ResetScene</code> method with the following code in our <code>ScenesManager</code> script:<pre>  public void ResetScene()  {    gameTimer = 0;    SceneManager.LoadScene(GameManager.currentScene);  }</pre></li>
			</ol>
			<p>Inside<a id="_idIndexMarker684"/> the <code>ResetScene</code> method, we<a id="_idIndexMarker685"/> reset the <code>gameTimer</code> variable<a id="_idIndexMarker686"/> to zero, followed by replacing its parameter from the current <code>SceneManager.LoadScene</code> <code>buildIndex</code> to <code>GameManager.currentScene</code>, which we coded back in <a href="B18381_03_Epub.xhtml#_idTextAnchor073"><em class="italic">Chapter 3</em></a>, <em class="italic">Managing Scripts and Taking aMock Test</em>. This is basically just holding the current build index as a <code>static</code> integer so that any script can access it.</p>
			<p>With <code>ResetScene</code> updated, we can now move onto the next method, which is very similar to what we have just done, but it is separate to <code>ResetScene</code> in order to support the expansion of our code.</p>
			<p>When a player completes a level, the <code>NextLevel</code> method runs, which will reset the <code>gameTimer</code> variable. The <code>gameTimer</code> <code>bool</code> will be set back to <code>false</code> and the same <code>SceneManager.LoadScene</code> command will be used to increment the <code>GameManager</code> <code>currentScene</code> integer by <code>1</code>.</p>
			<ol>
				<li value="2">Enter the following method in the <code>ScenesManager</code> script:<pre>  void NextLevel()  {    gameEnding = false;    gameTimer = 0;    SceneManager.LoadScene(GameManager.currentScene+1);  }</pre></li>
			</ol>
			<p>The last method we need to change in our <code>ScenesManager</code> script is our <code>BeginGame</code> method, which will be called when the player is in the <code>shop</code> scene and pressing the <code>"START"</code> button.</p>
			<ol>
				<li value="3">Enter the following code for our <code>ScenesManager</code> script:<pre> public void BeginGame(int gameLevel) {   SceneManager.LoadScene(gameLevel); }}</pre></li>
			</ol>
			<p>The <code>BeginGame</code> method <a id="_idIndexMarker687"/>will take<a id="_idIndexMarker688"/> an <a id="_idIndexMarker689"/>integer parameter called <code>gameLevel</code>. Inside this method is the same <code>SceneManager.LoadScene</code> we have already used, but this time, it will load the <code>gameLevel</code> integer we are providing it. </p>
			<ol>
				<li value="4">Save the script.</li>
			</ol>
			<p>If you remember, back in the previous chapter we set the <code>PlayerSpawner</code> script to temporary call the <code>GameManager.Instance.CameraSetup()</code>;</p>
			<p>This call is no longer required and can now be removed. Let's remove it</p>
			<ol>
				<li value="5">In the <code>Assets/Script</code>.</li>
				<li>Load the PlayerSpawner script and remove the line from the Start function <code>GameManager.Instance.CameraSetup();</code></li>
				<li>Save the script.</li>
			</ol>
			<p>Because we have changed the <code>BeginGame</code> method to now take a parameter, we must update our <code>PlayerShipBuild</code> script, which has a <code>StartGame</code> method that runs the <code>BeginGame</code> method with, currently, no parameter value. To update the <code>PlayerShipBuild</code> <code>StartGame</code> method, we need to do the following:</p>
			<ol>
				<li value="1">In the Unity Editor, navigate to the <code>Assets/Script/PlayerShipBuild.cs</code> folder in the <strong class="bold">Project</strong> window and open it.</li>
				<li>Scroll down to the <code>StartGame</code> method and find this line of code:<pre><strong class="bold">UnityEngine.SceneManagement.SceneManager.LoadScene("testLevel");</strong></pre></li>
				<li>Now, change the preceding line of code to this:<pre><strong class="bold">GameManager.Instance.GetComponent&lt;ScenesManager&gt;   ().BeginGame(GameManager.gameLevelScene);</strong></pre></li>
			</ol>
			<p>This code change will now call the <code>level1</code> scene directly.</p>
			<p>With that, we have reached the end of this section. So far, we have covered the following:</p>
			<ul>
				<li>Our game is now aware of how long a level will take until it is classed as completed.</li>
				<li>The <code>ScenesManager</code> script can now call methods that will start, reset, and move the player onto the next level.</li>
			</ul>
			<p>The majority of our code was created with the use of <code>switch</code> statements and an <code>enum</code> to call when the scenes need to be changed. To load the scenes themselves, we used <a id="_idIndexMarker690"/>Unity's own <code>SceneManager</code> class, which <a id="_idIndexMarker691"/>is fundamental to loading<a id="_idIndexMarker692"/> any scene in a Unity Project.</p>
			<p>In the next section, we will prepare the rest of the scenes in our project that aren't game levels (the <code>bootUp</code> scene, the <code>title</code> scene, and the <code>gameOver</code> scene).</p>
			<h1 id="_idParaDest-142"><a id="_idTextAnchor144"/>Preparing to loop our game</h1>
			<p>In this section, we <a id="_idIndexMarker693"/>are going to move away from the <code>testLevel</code> scene and introduce three other levels (<code>level1</code>, <code>level2</code>, and <code>level3</code>) to demonstrate the game loop. </p>
			<p>By the end of this section, our game loop will be complete. We will be able to start our game from the <code>bootUp</code> scene. From there, we will be able to progress through each scene.</p>
			<p>Let's start by removing the placeholder levels in the Unity Editor. Go to the <code>Assets/Scene</code> location. Follow these steps:</p>
			<ol>
				<li value="1">Make sure your <code>player_ship</code> is saved (<code>testLevel</code> scene. Next, Delete <code>level1</code>, <code>level2</code>, and <code>level3</code>.</li>
				<li>Select <code>testLevel</code>, hold the <em class="italic">Left Ctrl</em> <em class="italic">(Command</em> on the Mac) key on the keyboard, and press <em class="italic">D</em> twice. We should now have three <code>testLevel</code> instances.</li>
				<li>Rename <code>testLevel</code> to <code>level1</code>.</li>
				<li>Rename <code>testLevel 1</code> to <code>level2</code>.</li>
				<li>Rename <code>testLevel 2</code> to <code>level3</code>.</li>
			</ol>
			<p>We now need to check the <strong class="bold">Build Settings</strong> window to check on the order of our scenes.</p>
			<ol>
				<li value="6">At the top of the Unity Editor, click <strong class="bold">File</strong> | <strong class="bold">Build Settings.</strong></li>
			</ol>
			<p>Our order should <a id="_idIndexMarker694"/>look like the one shown in the following screenshot. If it doesn't, select and move the scenes into the correct position by clicking and dragging them in the <strong class="bold">Build Settings</strong> window and by selecting and deleting any extra scenes in the list:</p>
			<div><div><img src="img/Figure_7.04_B18381.jpg" alt="Figure 7.4 – Build Settings – complete scene order&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.4 – Build Settings – complete scene order</p>
			<p>We have duplicated our first level twice to test that our levels can be completed and move forward. Next, we will go back to the first scene in our project list and set it up so that it's ready to act like a boot up scene.</p>
			<p>Because we have removed our <code>testLevel</code> scene, we need to update our <code>GameManager</code> script with regards to the <code>LightandCameraSetup</code> method to keep its <code>Switch</code> statement in sync with the levels we need to light up, as well as set up our camera.</p>
			<p>To make it so our camera and lights work correctly for each scene, we need to do the following:</p>
			<ol>
				<li value="1">In the <code>Assets/Script</code> folder.</li>
			</ol>
			<p>Double-click on the <code>GameManager</code> script.</p>
			<ol>
				<li value="2">Scroll<a id="_idIndexMarker695"/> down to the <code>LightandCameraSetup</code> method's content and make it so that each case number follows this pattern:<pre>case 3 : case 4 : case 5:</pre></li>
			</ol>
			<p>Each case represents the levels the player is going to play.</p>
			<ol>
				<li value="3">Save the script.</li>
			</ol>
			<p>In the next few sections, we will be customizing a placeholder look for each nonlevel scene (basic but informative). These scenes are as follows:</p>
			<ul>
				<li><code>bootUp</code></li>
				<li><code>title</code></li>
				<li><code>gameOver</code></li>
			</ul>
			<p>Each of these scenes will also require basic coding so that the player either presses a button to continue or a timer will be issued. This timer will count down until the next scene is loaded.</p>
			<h2 id="_idParaDest-143"><a id="_idTextAnchor145"/>Setting up the bootUp scene</h2>
			<p>When we <a id="_idIndexMarker696"/>run a game, typically, the game doesn't<a id="_idIndexMarker697"/> start straight away – there's normally a splash screen to show who developed/published the game. Sometimes, it's used as a loading screen, but for us, it will be used to get our game started. In this section, we are going to take away the typical Unity sky background and replace it with a neutral grey color background with a text title that states what screen has loaded up.</p>
			<p>Let's make a start and open the <code>bootUp</code> scene in the Unity Editor:</p>
			<ol>
				<li value="1">In the <code>level1</code> scene by going to <code>Assets/Scene</code>.</li>
				<li>Double-click on <code>prefab</code> folder if it isn't already.</li>
				<li>Next, double-click on the bootUp scene file from <code>Assets/Scene</code>.</li>
				<li>Drag and drop the <code>GameManager</code> prefab from the <code>Assets/Prefab</code>, to the <strong class="bold">Hierarchy</strong> window.</li>
				<li>Create an empty game object in the <strong class="bold">Hierarchy</strong> window. If you have forgotten how to do this, refer to <a href="B18381_02_Epub.xhtml#_idTextAnchor048"><em class="italic">Chapter 2</em></a>, <em class="italic">Adding and Manipulating Objects</em>.</li>
				<li>Name the newly created game object <code>BootUpText</code>.</li>
				<li>Create another empty game object as before and name that <code>BootUpComponent</code>.</li>
			</ol>
			<p>The following screenshot shows the components on the left-hand side of the <strong class="bold">Hierarchy</strong> window. These are as follows:</p>
			<ul>
				<li><strong class="bold">Main Camera</strong></li>
				<li><strong class="bold">Direction Light</strong></li>
				<li><strong class="bold">GameManager</strong></li>
				<li><strong class="bold">BootUpComponent</strong></li>
				<li><strong class="bold">BootUp Text</strong></li>
			</ul>
			<div><div><img src="img/Figure_7.05_B18381.jpg" alt="Figure 7.5 – Game object Hierarchy window order&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.5 – Game object Hierarchy window order</p>
			<p>On the right-hand side of the preceding screenshot, we have our <code>GameManager</code> game object <a id="_idIndexMarker698"/>selected showing its three main component <a id="_idIndexMarker699"/>scripts:</p>
			<ul>
				<li>Game Manager</li>
				<li>Scenes Manager</li>
				<li>Score Manager</li>
			</ul>
			<p>As you may recall, our <code>GameManager</code> script will always remain in a scene, even if the scene is replaced with another, so it's vital we have these components in our Game Manager prefab.</p>
			<p>Next, we are going to change the background from sky to grey, as mentioned previously. To do this, select <strong class="bold">Main Camera</strong> from the <strong class="bold">Hierarchy</strong> window. Now, follow these steps:</p>
			<ol>
				<li value="1">In the <strong class="bold">Inspector</strong> window, click the <strong class="bold">Clear Flags</strong> selection and change it from <strong class="bold">Skybox</strong> to <strong class="bold">Solid Color</strong>.</li>
				<li>Just below <code>32323200</code>.</li>
				<li>This will change the RGB values to <code>50</code>,<code>50</code>,<code>50</code> with an alpha setting of <code>zero</code>.</li>
			</ol>
			<p>Use the following screenshot as a reference for the location for <strong class="bold">Clear Flags</strong>, <strong class="bold">Background</strong>, and <strong class="bold">Hex Color</strong>:</p>
			<div><div><img src="img/Figure_7.06_B18381.jpg" alt="Figure 7.6 – Changing the background color of our scene&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.6 – Changing the background color of our scene</p>
			<p>This will <a id="_idIndexMarker700"/>change the <a id="_idIndexMarker701"/>background in the <strong class="bold">Game</strong> window to gray.</p>
			<p>Next, we will select <code>BootUpText</code> and add a <strong class="bold">Text Mesh</strong> that will be at the bottom center of the screen. Follow these steps:</p>
			<ol>
				<li value="1">Select the <code>BootUpText</code> game object in the <strong class="bold">Hierarchy</strong> window.</li>
				<li> Then, in the <strong class="bold">Inspector</strong> window, click the <strong class="bold">Add Component</strong> button.</li>
				<li>In the drop-down, type <code>Text Mes</code>h until you see it in the drop-down list.</li>
				<li>Select <strong class="bold">Text Mesh</strong> from the drop-down.</li>
			</ol>
			<p>With the <code>BootUp Text</code> game object still selected, change its <strong class="bold">Transform</strong> Position to the following:</p>
			<div><div><img src="img/Table_011.jpg" alt=""/>
				</div>
			</div>
			<p>Now that our text is in the correct position, we need to fill out the <strong class="bold">Text Mesh</strong> component in <strong class="bold">Inspector</strong>. Follow these steps:</p>
			<ol>
				<li value="1">In the <code>BootUp</code>.</li>
				<li>Set <strong class="bold">Anchor</strong> to <strong class="bold">Middle center</strong>.</li>
				<li>Set <strong class="bold">Alignment</strong> to <strong class="bold">Center</strong>.</li>
				<li>Open the <strong class="bold">Game</strong> window (shortcut: <em class="italic">Ctrl (command</em> on Mac<em class="italic">) + 2</em>). Now, we should have a gray screen with white text so that we can easily identify the scene<a id="_idIndexMarker702"/> we are in. The following screenshot<a id="_idIndexMarker703"/> shows the "<strong class="bold">BootUp</strong>" text's settings, along with its <strong class="bold">Inspector</strong> properties for reference:</li>
			</ol>
			<div><div><img src="img/Figure_7.07_B18381.jpg" alt="Figure 7.7 – Basic 'BootUp' scene&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.7 – Basic 'BootUp' scene</p>
			<p>The last thing we need to do for this <code>bootUp</code> scene is to make it function like most <code>bootUp</code> screens. </p>
			<p>When the <code>bootUp</code> screen appears, it stays there for a couple of seconds and then moves onto the next scene.</p>
			<p>To make it so the <code>bootUp</code> screen loads onto the next screen after a few seconds, we will need to create a script and add it to the <code>BootUpComponent</code> game object. </p>
			<ol>
				<li value="5">When we make the script, we need to store it with our other scripts in the <code>Assets/Script</code>).</li>
			</ol>
			<p>If you have forgotten how to make a script, check out the <em class="italic">Updating our camera properties via script</em> section in <a href="B18381_02_Epub.xhtml#_idTextAnchor048"><em class="italic">Chapter 2</em></a>, <em class="italic">Adding and Manipulating Objects.</em></p>
			<ol>
				<li value="6">Name <a id="_idIndexMarker704"/>the <a id="_idIndexMarker705"/>script <code>LoadSceneComponent</code>.</li>
			</ol>
			<p>The following screenshot shows what the <code>BootUpComponent</code> game object should look like when it's selected in the <strong class="bold">Hierarchy</strong> window:</p>
			<div><div><img src="img/Figure_7.08_B18381.jpg" alt="Figure 7.8 – 'BootUpComponent' game object and script&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.8 – 'BootUpComponent' game object and script</p>
			<ol>
				<li value="7">Double-click the grayed-out field of <code>LoadSceneComponent</code> in the <strong class="bold">Inspector</strong> window to open the file.</li>
			</ol>
			<p>The following code is similar to the code that we entered previously for loading a level, just in a shorter form. The basic principle is that we load in <code>UnityEngine.SceneManagement</code> to inherit Unity's <code>SceneManager</code> class. </p>
			<p>Our game's score gets reset at the start of the script to stop any previous scores being carried over.</p>
			<p>Then, we create a timer and increment the time in Unity's <code>Update</code> function. Once the timer goes over <code>3</code> seconds, <code>SceneManager</code> will load whatever we have put in the <code>loadThisScene</code> public variable, which in our case is <code>"title"</code>.</p>
			<p>The following <a id="_idIndexMarker706"/>screenshot <a id="_idIndexMarker707"/>shows the <code>LoadSceneComponent</code> script in <strong class="bold">Inspector</strong> with a field where we can enter the scene we wish to load:</p>
			<div><div><img src="img/Figure_7.09_B18381.jpg" alt="Figure 7.9 – Load Scene Component will load the 'title' scene&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.9 – Load Scene Component will load the 'title' scene</p>
			<p>It's as simple as that – we don't need to worry about anything else as the <code>bootUp</code> scene isn't part of the game loop. The <code>bootUp</code> scene is only played once when the game starts.</p>
			<ol>
				<li value="8">Enter the following code into <code>LoadSceneComponent</code>:<pre>using UnityEngine.SceneManagement;using UnityEngine;public class LoadSceneComponent : MonoBehaviour { float timer = 0; public string loadThisScene; void Start(){  GameManager.Instance.GetComponentInChildren      &lt;ScoreManager&gt;().ResetScore();} void Update() {     timer += Time.deltaTime;     if (timer &gt; 3)     {         SceneManager.LoadScene(loadThisScene);     } }}</pre></li>
				<li>Once <a id="_idIndexMarker708"/>you're <a id="_idIndexMarker709"/>done, save the script.</li>
				<li>Go back into the Unity Editor and type <code>title</code> into the <code>loadThisScene</code> variable field in the <strong class="bold">Inspector</strong> window, as shown in the preceding screenshot.</li>
				<li>Save the <code>bootUp</code> scene and press <code>bootUp</code> scene should load up and then, after <code>3</code> seconds, load up the <code>title</code> scene.</li>
			</ol>
			<p>We can now <a id="_idIndexMarker710"/>repeat the majority of what we've done in the <code>bootUp</code> scene <a id="_idIndexMarker711"/>and duplicate this for the <code>title</code> and <code>gameOver</code> scenes. We will do this next.</p>
			<h2 id="_idParaDest-144"><a id="_idTextAnchor146"/>Setting up the title and gameOver scenes</h2>
			<p>The way <a id="_idIndexMarker712"/>we<a id="_idIndexMarker713"/> set<a id="_idIndexMarker714"/> the <code>bootUp</code> scene in the previous<a id="_idIndexMarker715"/> section is similar to how we want the <code>title</code> and <code>gameOver</code> scenes to look and act before we add any new art and custom functionality.</p>
			<p>Thankfully, with Unity, we don't have to repeat the entire process of making these two scenes from scratch. We can copy, paste, and rename the game objects we have already created in the <code>bootUp</code> scene's <code>title</code> and <code>gameOver</code> scenes.</p>
			<p>To copy the gray background and white <code>bootUp</code> scene, do the following:</p>
			<ol>
				<li value="1">With the <code>bootUp</code> scene still active in the Unity Editor, select all of the <code>5</code> game objects from the <strong class="bold">Hierarchy</strong> window (click the top or the bottom of the list, hold <em class="italic">Shift</em>, then click either end of the list to select all).</li>
				<li>Press <em class="italic">Left Ctrl</em> (<em class="italic">Command</em> on Mac) <em class="italic">+ C</em> to copy these <code>5</code> game objects. </li>
				<li>Open the <code>title</code> scene from the <code>Assets/Scene</code>).</li>
				<li>Select and delete all game objects in the <strong class="bold">Hierarchy</strong> window.</li>
				<li>Click anywhere in the open space of the <code>bootUp</code> game objects.</li>
				<li>Select <code>BootUpText</code> in the <code>TitleText</code>.</li>
				<li>With the <code>TitleText</code> game object still selected, change the <code>Title</code>.</li>
				<li>Select <code>BootUpComponent</code> in the <code>TitleComponent</code>.</li>
				<li>With the <code>TitleComponent</code> game object still selected, click the three small dots in the <strong class="bold">Inspector</strong> window next to <strong class="bold">LoadSceneComponent </strong>(<strong class="bold">Script</strong>)<strong class="bold">.</strong></li>
				<li>A drop-down will appear; click <strong class="bold">Remove Component</strong> from it.</li>
			</ol>
			<p>We now need to make a script for the <code>TitleComponent</code> game object so that<a id="_idIndexMarker716"/> when the player taps or clicks the<a id="_idIndexMarker717"/> mouse<a id="_idIndexMarker718"/> button, the <code>shop</code> scene will load <a id="_idIndexMarker719"/>up next.</p>
			<ol>
				<li value="11">Repeat the same process of making and attaching a script as we did with <code>BootUpComponent</code>, but this time, name the script <code>TitleComponent</code> (also, as with the <code>TitleComponent</code> script, make sure it is moved into the correct folder in the <code>Assets/Script</code>) and paste in the following code:<pre>using UnityEngine.SceneManagement;using UnityEngine;public class TitleComponent : MonoBehaviour { void Update() {     if (Input.GetButtonDown("Fire1"))     {         SceneManager.LoadScene("shop");     } }  void Start()  {    GameManager.playerLives = 3;  }}</pre></li>
			</ol>
			<p>The difference between this <code>TitleComponent</code> script and the previous <code>BootUpComponent</code> script is that <code>TitleComponent</code> will move onto <a id="_idIndexMarker720"/>the <a id="_idIndexMarker721"/>next<a id="_idIndexMarker722"/> scene (<code>shop</code> scene) when<a id="_idIndexMarker723"/> a mouse button (or a finger on a touch screen) is pressed and released in <code>BootUpComponent</code>, which is dependent on a timer to increment the past <code>3</code> seconds to load the next scene, where its failsafe is to reset the game's score if the player completes the game.</p>
			<ol>
				<li value="12">Save the <code>TitleComponent</code> script and <code>title</code> scene.</li>
			</ol>
			<p>The following screenshot shows what the <code>title</code> scene should look like in the Unity Editor:</p>
			<div><div><img src="img/Figure_7.10_B18381.jpg" alt="Figure 7.10 – Hierarchy 'title' scene game object order&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.10 – Hierarchy 'title' scene game object order</p>
			<p>We now need to repeat the exact same process for the <code>gameOver</code> scene.</p>
			<p>Open the <code>gameOver</code> scene from the <code>Assets/Scene</code>) and <a id="_idIndexMarker724"/>repeat<a id="_idIndexMarker725"/> the process <a id="_idIndexMarker726"/>of pasting and renaming the game objects. Do the following:</p>
			<ol>
				<li value="1">In the <code>BootUpComponent</code> game object to <code>GameOver</code>.</li>
				<li>Still in the <code>BootUpText</code> to <code>GameOverText</code>.</li>
				<li>Select the <code>GameOver</code> component in the <code>LoadSceneComponent</code> until we see it in the list. Then, select it if we don't have the component added already..</li>
			</ol>
			<p>The following screenshot shows the <code>GameOver</code> component with the same <code>LoadSceneComponent</code> script where I added <code>"title"</code> to the <code>loadThisScene</code> variable field:</p>
			<div><div><img src="img/Figure_7.11_B18381.jpg" alt="Figure 7.11 – Load Scene Component loading the 'title' scene&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.11 – Load Scene Component loading the 'title' scene</p>
			<ol>
				<li value="4">Save the <code>gameOver</code> scene.</li>
			</ol>
			<p>Our <a id="_idIndexMarker727"/>Unity <a id="_idIndexMarker728"/>Project<a id="_idIndexMarker729"/> is <a id="_idIndexMarker730"/>now ready to run its full game loop. We will talk about the game loop in more detail in the next section.</p>
			<h2 id="_idParaDest-145"><a id="_idTextAnchor147"/>Demonstrating that the game loop is complete</h2>
			<p>In this final <a id="_idIndexMarker731"/>section, we will confirm what we have achieved in this chapter. Our game now has a game loop, so if we load up the <code>bootUp</code> scene and press <strong class="bold">Play</strong> in the Unity Editor, the sequence will be as follows:</p>
			<ul>
				<li><code>bootUp</code>: The scene runs for <code>3</code> seconds and then moves to the <code>title</code> scene.</li>
				<li><code>title</code>: If the player presses the mouse button, the <code>shop</code> scene will load.</li>
				<li><code>shop</code>: The player presses the <code>level1</code>.</li>
				<li><code>level1</code>: The player completes the level after <code>30</code> seconds (45 seconds for level 3) or dies. If the player dies more than <code>3</code> times, they will be presented with the <code>gameOver</code> scene.</li>
				<li><code>level2</code>: The same rules apply as the ones present for <code>level1</code>.</li>
				<li><code>level3</code>: The same rules apply as the ones present for <code>level1</code>, but if the player completes the level, they will be presented with the <code>gameOver</code> scene.</li>
				<li><code>gameOver</code>: The scene runs for <code>3</code> seconds and then moves to the <code>title</code> scene.</li>
			</ul>
			<p>The following image shows the process of our game loop moving through each scene, then going back to the <code>title</code> scene:</p>
			<div><div><img src="img/Figure_7.12_B18381.jpg" alt="Figure 7.12 – Killer Wave's game loop&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.12 – Killer Wave's game loop</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">Remember that if any of our scenes look darker than usual, we will need to bake its lights manually, as we did back in <a href="B18381_03_Epub.xhtml#_idTextAnchor073"><em class="italic">Chapter 3</em></a>, <em class="italic">Managing Scripts and Taking a Mock Test.</em></p>
			<p>With this, we have created a series of scenes that carry their own individual responsibilities. When a scene comes to its end, either by its own choice or prompted to by the player, the next scene in the sequence will load. Eventually, by the player either completing all three levels or losing all their lives, our game will reach the <code>gameOver</code> scene. From the <code>gameOver</code> scene, we send the player back to the <code>title</code> scene. This is our game loop, and this is what every game will have. Game loops are a fundamental requirement<a id="_idIndexMarker732"/> for game development, and it's also possible that this will be mentioned in the exam.</p>
			<p>This concludes this section and this chapter, where we have created and managed our scenes in order to create a game loop.</p>
			<h1 id="_idParaDest-146"><a id="_idTextAnchor148"/>Summary</h1>
			<p>In this chapter, we created a game loop; these are fundamental to game development, and sometimes application development. To create a game loop for our project, we needed multiple scenes that served their own purposes. We also needed to know when a scene started and when it should end. A scene ends when the player presses a button to continue, such as the <code>7</code> scene, or when the <code>bootUp</code> title automatically moves onto the next scene after so many seconds.</p>
			<p>Apart from making our game loops, we also learned some new vector math components on the way, including <code>Mathf.round</code>, which is used to round off figures <code>Vector3.distance</code>, which is used to measure the distance between two <code>Vector3</code> points; and <code>Vector3.lerp</code>, which is used to interpolate between two <code>Vector3</code> points. </p>
			<p>These are useful components in game development and will also likely be mentioned in the exam.</p>
			<p>In the next chapter, we will be adding some polish to our placeholder scenes with custom fonts, creating our own images, and applying some UI animation in the Unity Editor.</p>
			<h1 id="_idParaDest-147"><a id="_idTextAnchor149"/>Mock test</h1>
			<ol>
				<li value="1">What would be the best way for a UI menu system to be worked on from a programmer's perspective, but at the same time in a way that doesn't interfere with an artist working on the same workflow?<ol><li>Make it so that each UI component has its own class so that any art changes won't affect either outcome.</li><li>Give each UI component a separate material so that any changes in the code will be isolated.</li><li>Use prefabs for each UI component so that any artist can modify them individually. </li><li>Have a separate script that sweeps through all UI components to check any changes that are made so that they're known to everyone.</li></ol></li>
				<li>An <strong class="bold">Image</strong> component has a sprite in its <strong class="bold">Source Image</strong> parameter and its <strong class="bold">Image Type</strong> is set to <strong class="bold">Filled</strong>. What does <strong class="bold">Filled</strong> do?<ol><li>Fills open spaces in the sprite.</li><li>It offers various ways to fill in the sprite.</li><li>Makes it so no other sprite can override it.</li><li>Inverts the color of the sprite.</li></ol></li>
				<li>What component does <code>CrossPlatformInputManager</code> replace?<ol><li><code>anyKey</code></li><li><code>Input </code></li><li><code>mousePosition</code></li><li><code>acceleration</code></li></ol></li>
				<li> When testing a top-down shooter game you have just developed, you want the controls to have an "Arcade" feel. To make the controls snap into position when moving the player, which property would help create what is required?<ol><li><code>GetAxisRaw </code></li><li><code>GetJoystickNames</code></li><li><code>InputString</code></li><li><code>gyro</code></li></ol></li>
				<li>When writing code such as variable names, which is the correct naming convention to use?<ol><li>Pascal case</li><li>Lower case</li><li>Cake case</li><li>Camel case</li></ol></li>
				<li>You are working with a team to create a realistic simulation for the military that includes a series of explosions. You have been asked to take over from the previous developer who has, so far, created a framework that issues a series of explosions from a bank of prefabs. The prefabs are updated on a regular basis by one of the artists on the team. As impressive as this looks, the program has gotten quite big and the artist will need to have the option to update, swap out, replace, and delete prefabs from the framework.</li>
			</ol>
			<p>What solution can you offer the team that keeps this framework from not going against SOLID principles and is accessible to the artist in the team?</p>
			<ol>
				<li>Create a series of prefabs that hold a cluster of prefabs that randomize on each occasion when they're used in the Unity scene.</li>
				<li>Create a single scriptable object that holds an array of prefabs that holds a reference to either script.</li>
				<li>Create a non-procedural particle system that creates its own explosions.</li>
				<li>Hold all the explosions in the scene at runtime but off-camera and then bring in those required using a random selection script.</li>
			</ol>
			<ol>
				<li value="7">Which collider is the fastest for the Unity physics system to calculate?<ol><li>Hinge</li><li>Sphere</li><li>Mesh</li><li>Box</li></ol></li>
				<li>Which is the cheapest MinMaxCurve to use?<ol><li>Optimized Curve</li><li>Random between two constants</li><li>Random between two curves</li><li>Constant</li></ol></li>
				<li>Which property needs to be accessed through code to create a strobe effect for a nightclub scene?<ol><li><code>color.a</code></li><li><code>spotAngle</code></li><li><code>range</code></li><li><code>intensity</code></li></ol></li>
			</ol>
		</div>
	</body></html>