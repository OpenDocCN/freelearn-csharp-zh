<html><head></head><body>
  <div id="_idContainer049">
   <h1 class="chapter-number" id="_idParaDest-61">
    <a id="_idTextAnchor061">
    </a>
    <span class="koboSpan" id="kobo.1.1">
     4
    </span>
   </h1>
   <h1 id="_idParaDest-62">
    <a id="_idTextAnchor062">
    </a>
    <span class="koboSpan" id="kobo.2.1">
     Real-Time Interactions with SignalR
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.3.1">
     As part of ASP.NET Core 9, the web API is a framework for building HTTP services, which can be made available for both web page consumption and mobile applications.
    </span>
    <span class="koboSpan" id="kobo.3.2">
     The structure provided by the .Net Core platform provides the development of APIs with high quality and performance.
    </span>
    <span class="koboSpan" id="kobo.3.3">
     In this chapter, we will learn more about WebAPI, including the standards, conventions, and best practices for delivering solutions via
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.4.1">
      a service.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.5.1">
     We will work on creating a real-time task management application where we will use various techniques available on the .NET platform and SignalR to learn about the concepts and implement an example of applications that use the Stream concept.
    </span>
    <span class="koboSpan" id="kobo.5.2">
     We will also explore the premises for hosting SignalR applications on
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.6.1">
      a server.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.7.1">
     In this chapter, we’re going to cover the following
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.8.1">
      main topics:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.9.1">
      What
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.10.1">
       is SignalR?
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.11.1">
      Understanding the concepts of server
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.12.1">
       and clients
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.13.1">
      Working
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.14.1">
       with streaming
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.15.1">
      Hosting the ASP.NET Core
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.16.1">
       SignalR applications
      </span>
     </span>
    </li>
   </ul>
   <h1 id="_idParaDest-63">
    <a id="_idTextAnchor063">
    </a>
    <span class="koboSpan" id="kobo.17.1">
     Technical requirements
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.18.1">
     The code examples used in this chapter can be found in the book’s
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.19.1">
      GitHub repository:
     </span>
    </span>
   </p>
   <p>
    <a href="https://github.com/PacktPublishing/ASP.NET-Core-9.0-Essentials/tree/main/Chapter04">
     <span class="No-Break">
      <span class="koboSpan" id="kobo.20.1">
       https://github.com/PacktPublishing/ASP.NET-Core-9.0-Essentials/tree/main/Chapter04
      </span>
     </span>
    </a>
   </p>
   <h1 id="_idParaDest-64">
    <a id="_idTextAnchor064">
    </a>
    <span class="koboSpan" id="kobo.21.1">
     What is SignalR?
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.22.1">
     As we learned in previous chapters, web-based applications have two parts: the client and
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.23.1">
      the Server.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.24.1">
     A
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.25.1">
      browser
     </span>
    </strong>
    <span class="koboSpan" id="kobo.26.1">
     generally represents the client, where the user interacts with the application.
    </span>
    <span class="koboSpan" id="kobo.26.2">
     Applications have actions executed on a server to process information and return
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.27.1">
      a response.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.28.1">
     This process is based on two phases, which are
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.29.1">
      request
     </span>
    </strong>
    <span class="koboSpan" id="kobo.30.1">
     and
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.31.1">
      response
     </span>
    </strong>
    <span class="koboSpan" id="kobo.32.1">
     .
    </span>
    <span class="koboSpan" id="kobo.32.2">
     These phases happen in sequence.
    </span>
    <span class="koboSpan" id="kobo.32.3">
     With each interaction between the client and the server, a new communication process
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.33.1">
      is created.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.34.1">
     Most web applications have these features that are sufficient for most business contexts.
    </span>
    <span class="koboSpan" id="kobo.34.2">
     However, there are scenarios where there is a need for a
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.35.1">
      real-time communication model
     </span>
    </strong>
    <span class="koboSpan" id="kobo.36.1">
     , where
    </span>
    <a id="_idIndexMarker225">
    </a>
    <span class="koboSpan" id="kobo.37.1">
     the information processed by an application is constantly updated.
    </span>
    <span class="koboSpan" id="kobo.37.2">
     This provides an immediate response to users, enriching usability and certain
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.38.1">
      functional requirements.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.39.1">
     A good example of real-time applications would be, for example, a map application where users have traffic information on a given route, and are notified about any aspects that affect navigation.
    </span>
    <span class="koboSpan" id="kobo.39.2">
     Furthermore, other types of applications such as games, social networks, or even collaborative web text editors depend on constant updates
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.40.1">
      to users.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.41.1">
     To develop applications that contain real-time features, it would be necessary for the server and client to be able to communicate constantly on an
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.42.1">
      active channel.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.43.1">
     The .NET platform has
    </span>
    <a id="_idIndexMarker226">
    </a>
    <span class="koboSpan" id="kobo.44.1">
     SignalR.
    </span>
    <span class="koboSpan" id="kobo.44.2">
     This is a library that adds the ability to build real-time solutions in a simplified way, instantly allowing constant communication between client
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.45.1">
      and server.
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer045">
     <span class="koboSpan" id="kobo.46.1">
      <img alt="Figure 4.1 – SignalR components" src="image/B21788_04_1.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.47.1">
     Figure 4.1 – SignalR components
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.48.1">
     As you can see,
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.49.1">
       Figure 4
      </span>
     </em>
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.50.1">
      .1
     </span>
    </em>
    <span class="koboSpan" id="kobo.51.1">
     demonstrates most of the SignalR components that abstract the communication model between the client and the server.
    </span>
    <span class="koboSpan" id="kobo.51.2">
     Communication between the client and
    </span>
    <a id="_idIndexMarker227">
    </a>
    <span class="koboSpan" id="kobo.52.1">
     the server occurs over an active connection, using a transport technique that transports JSON or binary messages.
    </span>
    <span class="koboSpan" id="kobo.52.2">
     WebSockets is the standard communication technique used by SignalR.
    </span>
    <span class="koboSpan" id="kobo.52.3">
     The other two options are used as fallback.
    </span>
    <span class="koboSpan" id="kobo.52.4">
     In other words, if WebSockets is not supported, Server-sent events or long polling will be used immediately.
    </span>
    <span class="koboSpan" id="kobo.52.5">
     The order of precedence for transport is the same as that established in the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.53.1">
      following list:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.54.1">
       WebSockets
      </span>
     </strong>
     <span class="koboSpan" id="kobo.55.1">
      : It
     </span>
     <a id="_idIndexMarker228">
     </a>
     <span class="koboSpan" id="kobo.56.1">
      provides the ability to establish a
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.57.1">
       full-duplex connection
      </span>
     </em>
     <span class="koboSpan" id="kobo.58.1">
      , that is, allowing constant communication between client
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.59.1">
       and server.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.60.1">
       Server-sent events
      </span>
     </strong>
     <span class="koboSpan" id="kobo.61.1">
      : It
     </span>
     <a id="_idIndexMarker229">
     </a>
     <span class="koboSpan" id="kobo.62.1">
      establishes a
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.63.1">
       one-way connection
      </span>
     </em>
     <span class="koboSpan" id="kobo.64.1">
      from the Server to the client.
     </span>
     <span class="koboSpan" id="kobo.64.2">
      The client does not have the ability to send messages to the server over the same connection, requiring a separate
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.65.1">
       HTTP request.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.66.1">
       Long polling
      </span>
     </strong>
     <span class="koboSpan" id="kobo.67.1">
      : It
     </span>
     <a id="_idIndexMarker230">
     </a>
     <span class="koboSpan" id="kobo.68.1">
      is a more basic technique whereby the client sends a message to the server.
     </span>
     <span class="koboSpan" id="kobo.68.2">
      Instead of sending an immediate message, the server then processes the information and only returns the response
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.69.1">
       after finishing.
      </span>
     </span>
    </li>
   </ol>
   <p>
    <span class="koboSpan" id="kobo.70.1">
     SignalR abstracts
    </span>
    <a id="_idIndexMarker231">
    </a>
    <span class="koboSpan" id="kobo.71.1">
     the choice of transport, making it possible to define the use of just WebSocket,
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.72.1">
      if necessary.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.73.1">
     The connection between the client and the server depends on an important component called the Hub.
    </span>
    <span class="koboSpan" id="kobo.73.2">
     The Hub is a special object.
    </span>
    <span class="koboSpan" id="kobo.73.3">
     It’s a part of the SignalR API that acts as a proxy, allowing server-client communication, where the server can execute functions or methods on the client, remotely, through the use of
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.74.1">
      RPC
     </span>
    </strong>
    <span class="koboSpan" id="kobo.75.1">
     (
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.76.1">
      Remote
     </span>
    </strong>
    <span class="No-Break">
     <strong class="bold">
      <span class="koboSpan" id="kobo.77.1">
       Procedure Call
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.78.1">
      ).
     </span>
    </span>
   </p>
   <p class="callout-heading">
    <span class="koboSpan" id="kobo.79.1">
     RPC
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.80.1">
     RPC is a
    </span>
    <a id="_idIndexMarker232">
    </a>
    <span class="koboSpan" id="kobo.81.1">
     communication protocol that has existed since 1970 and serves as the basis for several innovations that currently exist, such as gRPC, a high-performance communication model developed by Google.
    </span>
    <span class="koboSpan" id="kobo.81.2">
     You can find more information about RPC
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.82.1">
      at
     </span>
    </span>
    <a href="https://en.wikipedia.org/wiki/Remote_procedure_call">
     <span class="No-Break">
      <span class="koboSpan" id="kobo.83.1">
       https://en.wikipedia.org/wiki/Remote_procedure_call
      </span>
     </span>
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.84.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.85.1">
     SignalR abstracts all the complexity of connection and communication management, in addition to bringing other capabilities, such as sending notifications to all connected clients, specific clients, or a group of clients.
    </span>
    <span class="koboSpan" id="kobo.85.2">
     Additionally, APIs can be used in conjunction with .NET applications, even console, Java,
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.86.1">
      and JavaScript.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.87.1">
     It is possible, for example, to have a server that communicates with a console application developed on the .NET or even
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.88.1">
      Java platform.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.89.1">
     It may seem complex at first, but as we learn about the main concepts and good practices, we will come to understand how powerful the SignalR library is.
    </span>
    <span class="koboSpan" id="kobo.89.2">
     Let’s explore some concepts, patterns, and good practices that involve SignalR and how to develop a real-time application using
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.90.1">
      this library.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-65">
    <a id="_idTextAnchor065">
    </a>
    <span class="koboSpan" id="kobo.91.1">
     Understanding the concepts of Servers and Clients
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.92.1">
     As we learned earlier, SignalR is a powerful library that abstracts much of the complexity of creating
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.93.1">
      real-time applications.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.94.1">
     However, it is important to know the concepts and standards related to using the SignalR library to benefit from
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.95.1">
      its features.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.96.1">
     As we know, web applications basically have two main
    </span>
    <a id="_idIndexMarker233">
    </a>
    <span class="koboSpan" id="kobo.97.1">
     components, the Client and the
    </span>
    <a id="_idIndexMarker234">
    </a>
    <span class="koboSpan" id="kobo.98.1">
     Server.
    </span>
    <span class="koboSpan" id="kobo.98.2">
     Likewise, real-time applications using SignalR require both client and server components.
    </span>
    <span class="koboSpan" id="kobo.98.3">
     We will learn how these components interact with each other through a task
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.99.1">
      management application.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-66">
    <a id="_idTextAnchor066">
    </a>
    <span class="koboSpan" id="kobo.100.1">
     Working with a task management application
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.101.1">
     The
    </span>
    <a id="_idIndexMarker235">
    </a>
    <span class="koboSpan" id="kobo.102.1">
     task management application will be created
    </span>
    <a id="_idIndexMarker236">
    </a>
    <span class="koboSpan" id="kobo.103.1">
     using
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.104.1">
      Razor Pages
     </span>
    </strong>
    <span class="koboSpan" id="kobo.105.1">
     technology and have the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.106.1">
      following functionalities:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.107.1">
      Implement concepts in
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.108.1">
       real time
      </span>
     </span>
    </li>
    <li>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.109.1">
       Create tasks
      </span>
     </span>
    </li>
    <li>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.110.1">
       Complete tasks
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.111.1">
      View
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.112.1">
       created tasks
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.113.1">
      View
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.114.1">
       completed tasks
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.115.1">
     All functionalities will be resolved using Visual Studio Code.
    </span>
    <span class="koboSpan" id="kobo.115.2">
     JavaScript will be used to work with the functionalities on the Client side and C# will be used on the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.116.1">
      Server side.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.117.1">
     We can see an outline of the main components used in the application in
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.118.1">
       Figure 4
      </span>
     </em>
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.119.1">
       .2
      </span>
     </em>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.120.1">
      :
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer046">
     <span class="koboSpan" id="kobo.121.1">
      <img alt="Figure 4.2 – TaskManager application components" src="image/B21788_04_2.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.122.1">
     Figure 4.2 – TaskManager application components
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.123.1">
     As we
    </span>
    <a id="_idIndexMarker237">
    </a>
    <span class="koboSpan" id="kobo.124.1">
     can see in
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.125.1">
       Figure 4
      </span>
     </em>
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.126.1">
      .2
     </span>
    </em>
    <span class="koboSpan" id="kobo.127.1">
     , we have some important components that will be used in
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.128.1">
      the application.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.129.1">
     The Client will be implemented using Razor Pages, which will aim to allow user interaction in relation to the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.130.1">
      application’s functionalities:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.131.1">
      The
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.132.1">
       index-page.js
      </span>
     </strong>
     <span class="koboSpan" id="kobo.133.1">
      file will be responsible for managing interactions between the server and the application’s
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.134.1">
       main page.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.135.1">
      The
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.136.1">
       signalr.js
      </span>
     </strong>
     <span class="koboSpan" id="kobo.137.1">
      file is part of the SignalR
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.138.1">
       JavaScript SDK.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.139.1">
      The server is the Razor Page application that will act as an
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.140.1">
       orchestrator server.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.141.1">
      The Hub implementation will be responsible for managing real-time communication between the server and
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.142.1">
       the client.
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.143.1">
     As we create
    </span>
    <a id="_idIndexMarker238">
    </a>
    <span class="koboSpan" id="kobo.144.1">
     the project, we will explain how each component works and implementation details.
    </span>
    <span class="koboSpan" id="kobo.144.2">
     For now, let’s start with creating
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.145.1">
      the project.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.146.1">
     We will focus on the main activities for creating a task manager project.
    </span>
    <span class="koboSpan" id="kobo.146.2">
     However, you can check the entire implementation of the solution in the book GitHub repository, mentioned in the
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.147.1">
      Technical requirements
     </span>
    </em>
    <span class="koboSpan" id="kobo.148.1">
     section.
    </span>
    <span class="koboSpan" id="kobo.148.2">
     Here are the steps we will
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.149.1">
      be following:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.150.1">
      To create the project, open the terminal in a directory of your choice and run the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.151.1">
       following command:
      </span>
     </span>
     <pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.152.1">dotnet new webapp -o TaskManager</span></strong></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.153.1">
      A new folder called
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.154.1">
       TaskManager
      </span>
     </strong>
     <span class="koboSpan" id="kobo.155.1">
      will be created containing the entire project structure.
     </span>
     <span class="koboSpan" id="kobo.155.2">
      Access this page with the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.156.1">
       following command:
      </span>
     </span>
     <pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.157.1">cd TaskManager</span></strong></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.158.1">
      Now that the project has been created, we need to add the SignalR JavaScript SDK.
     </span>
     <span class="koboSpan" id="kobo.158.2">
      It will not be necessary to add the SDK to the server, as it is automatically added when creating the project, as part of the .
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.159.1">
       NET platform.
      </span>
     </span>
    </li>
   </ol>
   <p>
    <span class="koboSpan" id="kobo.160.1">
     As we are using Razor Pages, we will have the client and server in the same project.
    </span>
    <span class="koboSpan" id="kobo.160.2">
     However, we can
    </span>
    <a id="_idIndexMarker239">
    </a>
    <span class="koboSpan" id="kobo.161.1">
     create a
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.162.1">
      Single-Page Application
     </span>
    </strong>
    <span class="koboSpan" id="kobo.163.1">
     (
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.164.1">
      SPA
     </span>
    </strong>
    <span class="koboSpan" id="kobo.165.1">
     ) solution and a WebAPI in Asp.NET Core 9 and perform the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.166.1">
      same procedures.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.167.1">
     We will continue with the Razor pages and go to the installation of the SignalR JavaScript SDK.
    </span>
    <span class="koboSpan" id="kobo.167.2">
     We will use a tool
    </span>
    <a id="_idIndexMarker240">
    </a>
    <span class="koboSpan" id="kobo.168.1">
     called
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.169.1">
      LibMan
     </span>
    </strong>
    <span class="koboSpan" id="kobo.170.1">
     , which
    </span>
    <a id="_idIndexMarker241">
    </a>
    <span class="koboSpan" id="kobo.171.1">
     is a
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.172.1">
      Command Line Interface
     </span>
    </strong>
    <span class="koboSpan" id="kobo.173.1">
     (
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.174.1">
      CLI
     </span>
    </strong>
    <span class="koboSpan" id="kobo.175.1">
     ) from Microsoft, responsible for managing client libraries.
    </span>
    <span class="koboSpan" id="kobo.175.2">
     Its
    </span>
    <a id="_idIndexMarker242">
    </a>
    <span class="koboSpan" id="kobo.176.1">
     operation is similar to
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.177.1">
      Node Package
     </span>
    </strong>
    <span class="No-Break">
     <strong class="bold">
      <span class="koboSpan" id="kobo.178.1">
       Management
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.179.1">
      (
     </span>
    </span>
    <span class="No-Break">
     <strong class="bold">
      <span class="koboSpan" id="kobo.180.1">
       NPM
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.181.1">
      ).
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.182.1">
     To use it, it is advisable to uninstall any previous version existing on your operating system.
    </span>
    <span class="koboSpan" id="kobo.182.2">
     Therefore, we’ll follow
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.183.1">
      these steps:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.184.1">
      Run the following commands in sequence to
     </span>
     <a id="_idTextAnchor067">
     </a>
     <span class="koboSpan" id="kobo.185.1">
      install
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.186.1">
       the tool:
      </span>
     </span>
     <pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.187.1">dotnet to LibraryManager.Cli ol uninstall -g Microsoft.Web.</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.188.1">dotnet tool install -g Microsoft.Web.LibraryManager.Cli</span></strong></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.189.1">
      Next, we
     </span>
     <a id="_idIndexMarker243">
     </a>
     <span class="koboSpan" id="kobo.190.1">
      will run the command to install the SignalR SDK.
     </span>
     <span class="koboSpan" id="kobo.190.2">
      Run the following command and check in the application’s
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.191.1">
       main directory:
      </span>
     </span>
     <pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.192.1">libman install @microsoft/signalr@latest -p unpkg -d wwwroot/js/signalr --files dist/browser/signalr.js</span></strong></pre>
     <p class="list-inset">
      <span class="koboSpan" id="kobo.193.1">
       The preceding command avoided installing the
      </span>
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.194.1">
        @microsoft/signalr@latest
       </span>
      </strong>
      <span class="koboSpan" id="kobo.195.1">
       library and then only added the necessary scripts to the
      </span>
      <span class="No-Break">
       <span class="koboSpan" id="kobo.196.1">
        application directories.
       </span>
      </span>
     </p>
    </li>
   </ol>
   <p>
    <span class="koboSpan" id="kobo.197.1">
     At this moment, the project is being created and prepared to receive implementations of real-time features.
    </span>
    <span class="koboSpan" id="kobo.197.2">
     We must start by creating the Hub and configuring
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.198.1">
      the application.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-67">
    <a id="_idTextAnchor068">
    </a>
    <span class="koboSpan" id="kobo.199.1">
     Creating the Hub
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.200.1">
     The Hub is one
    </span>
    <a id="_idIndexMarker244">
    </a>
    <span class="koboSpan" id="kobo.201.1">
     of the most important components for implementing SignalR.
    </span>
    <span class="koboSpan" id="kobo.201.2">
     It acts as a proxy that manages the connections of all clients to the server and allows both
    </span>
    <a id="_idIndexMarker245">
    </a>
    <span class="koboSpan" id="kobo.202.1">
     the client and the server to talk to each other to execute methods in
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.203.1">
      real time.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.204.1">
     For our
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.205.1">
      TaskManager
     </span>
    </strong>
    <span class="koboSpan" id="kobo.206.1">
     application, our first task will be to create a Hub and prepare it for communicating with clients.
    </span>
    <span class="koboSpan" id="kobo.206.2">
     To do this, still in the terminal and the application directory, type the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.207.1">
      following command:
     </span>
    </span>
   </p>
   <pre class="console"><span class="koboSpan" id="kobo.208.1">
code .</span></pre>
   <p>
    <span class="koboSpan" id="kobo.209.1">
     This command will open an instance of VS Code in the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.210.1">
      application directory.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.211.1">
     At the root of the project, create a folder called
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.212.1">
      Hubs
     </span>
    </strong>
    <span class="koboSpan" id="kobo.213.1">
     and then a file
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.214.1">
      called
     </span>
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.215.1">
       TaskManagerHub.cs
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.216.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.217.1">
     The project
    </span>
    <a id="_idIndexMarker246">
    </a>
    <span class="koboSpan" id="kobo.218.1">
     class will have two methods and will look like the code
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.219.1">
      that follows:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.220.1">
public class TaskManagerHub : </span><strong class="bold"><span class="koboSpan" id="kobo.221.1">Hub</span></strong><span class="koboSpan" id="kobo.222.1">
  {
    public async Task </span><strong class="bold"><span class="koboSpan" id="kobo.223.1">CreateTask</span></strong><span class="koboSpan" id="kobo.224.1">(TaskModel taskModel)
    {
       // ..
</span><span class="koboSpan" id="kobo.224.2">    }
    public async Task </span><strong class="bold"><span class="koboSpan" id="kobo.225.1">CompleteTask</span></strong><span class="koboSpan" id="kobo.226.1">(TaskModel taskModel)
    {
       // ..
</span><span class="koboSpan" id="kobo.226.2">    }
  }</span></pre>
   <p>
    <span class="koboSpan" id="kobo.227.1">
     The first detail to note is inherited from the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.228.1">
      Hub
     </span>
    </strong>
    <span class="koboSpan" id="kobo.229.1">
     class.
    </span>
    <span class="koboSpan" id="kobo.229.2">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.230.1">
      Hub
     </span>
    </strong>
    <span class="koboSpan" id="kobo.231.1">
     class is a superclass that abstracts all connection management and interaction with clients, available through the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.232.1">
      Microsoft.AspNetCore.SignalR
     </span>
    </strong>
    <span class="koboSpan" id="kobo.233.1">
     package.
    </span>
    <span class="koboSpan" id="kobo.233.2">
     All custom
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.234.1">
      Hub
     </span>
    </strong>
    <span class="koboSpan" id="kobo.235.1">
     classes must inherit from
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.236.1">
      this class.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.237.1">
     Next, we have the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.238.1">
      CreateTask
     </span>
    </strong>
    <span class="koboSpan" id="kobo.239.1">
     and
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.240.1">
      CompleteTask
     </span>
    </strong>
    <span class="koboSpan" id="kobo.241.1">
     methods.
    </span>
    <span class="koboSpan" id="kobo.241.2">
     These methods will be invoked through clients and at the same time will invoke methods
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.242.1">
      on clients.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.243.1">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.244.1">
      CreateTask
     </span>
    </strong>
    <span class="koboSpan" id="kobo.245.1">
     method receives as a parameter a class called
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.246.1">
      TaskModel
     </span>
    </strong>
    <span class="koboSpan" id="kobo.247.1">
     .
    </span>
    <span class="koboSpan" id="kobo.247.2">
     This class has been broken into the
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.248.1">
       Model/TaskModel.cs
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.249.1">
      directory:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.250.1">
public class TaskModel
  {
    public Guid Id { get;  } = Guid.NewGuid();
    public string Name { get; set; }
    public bool IsCompleted { get; set; }
    public TaskModel()
    {
       IsCompleted = false;
    }
    public TaskModel(string name) : this()
    {
      Name = name;
    }
    public TaskModel(string name, bool isCompleted)
    {
      Name = name;
      IsCompleted = isCompleted;
    }
  }</span></pre>
   <p>
    <span class="koboSpan" id="kobo.251.1">
     As we can see, the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.252.1">
      TaskModel
     </span>
    </strong>
    <span class="koboSpan" id="kobo.253.1">
     class only has a few basic properties such as
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.254.1">
      Id
     </span>
    </strong>
    <span class="koboSpan" id="kobo.255.1">
     ,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.256.1">
      Name
     </span>
    </strong>
    <span class="koboSpan" id="kobo.257.1">
     , and
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.258.1">
      IsCompleted
     </span>
    </strong>
    <span class="koboSpan" id="kobo.259.1">
     , which represent
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.260.1">
      a task.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.261.1">
     Communication
    </span>
    <a id="_idIndexMarker247">
    </a>
    <span class="koboSpan" id="kobo.262.1">
     between the client and the server is done through a transport strategy, as mentioned previously, and WebSockets will generally be used.
    </span>
    <span class="koboSpan" id="kobo.262.2">
     The information transmitted is serialized in JSON or binary.
    </span>
    <span class="koboSpan" id="kobo.262.3">
     However, binary data, commonly used for audio, images, and videos, is not supported.
    </span>
    <span class="koboSpan" id="kobo.262.4">
     Only text data will
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.263.1">
      be transmitted.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.264.1">
     Now, let’s look at the complete implementation of the
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.265.1">
       CreateTask
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.266.1">
      method:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.267.1">
public async Task CreateTask(TaskModel taskModel)
  {
    </span><strong class="bold"><span class="koboSpan" id="kobo.268.1">_taskRepository</span></strong><span class="koboSpan" id="kobo.269.1">.Save(taskModel);
    await </span><strong class="bold"><span class="koboSpan" id="kobo.270.1">Clients.All.SendAsync</span></strong><span class="koboSpan" id="kobo.271.1">(ClientConstants
      .NOTIFY_TASK_MANAGER, taskModel);
  }</span></pre>
   <p>
    <span class="koboSpan" id="kobo.272.1">
     The preceding code performs
    </span>
    <a id="_idIndexMarker248">
    </a>
    <span class="koboSpan" id="kobo.273.1">
     two
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.274.1">
      basic procedures:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.275.1">
       Persist a task
      </span>
     </strong>
     <span class="koboSpan" id="kobo.276.1">
      : The
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.277.1">
       _taskRepository
      </span>
     </strong>
     <span class="koboSpan" id="kobo.278.1">
      property is an interface that abstracts communication with a persistence layer.
     </span>
     <span class="koboSpan" id="kobo.278.2">
      For this persistence project, it is being done in memory and the complete code for this implementation can be found in the book’s GitHub repository (see the
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.279.1">
       Technical
      </span>
     </em>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.280.1">
        requirements
       </span>
      </em>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.281.1">
       section).
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.282.1">
       Notify customers
      </span>
     </strong>
     <span class="koboSpan" id="kobo.283.1">
      : The
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.284.1">
       Hub
      </span>
     </strong>
     <span class="koboSpan" id="kobo.285.1">
      base class has a
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.286.1">
       Client
      </span>
     </strong>
     <span class="koboSpan" id="kobo.287.1">
      property with some functionality.
     </span>
     <span class="koboSpan" id="kobo.287.2">
      In the code example, a notification is being made to all potential clients connected to
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.288.1">
       Hub
      </span>
     </strong>
     <span class="koboSpan" id="kobo.289.1">
      .
     </span>
     <span class="koboSpan" id="kobo.289.2">
      The
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.290.1">
       SendAsync
      </span>
     </strong>
     <span class="koboSpan" id="kobo.291.1">
      method has 10 overloads of different variations.
     </span>
     <span class="koboSpan" id="kobo.291.2">
      However, for the preceding code, two main parameters are being used.
     </span>
     <span class="koboSpan" id="kobo.291.3">
      The first parameter concerns the name of the client method that will process the Hub’s response, while the second parameter is the task object itself that will be sent
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.292.1">
       to clients.
      </span>
     </span>
    </li>
   </ul>
   <p class="callout-heading">
    <span class="koboSpan" id="kobo.293.1">
     Constants are best practices
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.294.1">
     As we noted in the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.295.1">
      SendAsync
     </span>
    </strong>
    <span class="koboSpan" id="kobo.296.1">
     method, the first parameter references a constant.
    </span>
    <span class="koboSpan" id="kobo.296.2">
     This is good practice as it is necessary to know the name of the method that will process the communication made through the server.
    </span>
    <span class="koboSpan" id="kobo.296.3">
     Since it’s a string, it’s easy to make mistakes.
    </span>
    <span class="koboSpan" id="kobo.296.4">
     Use constants whenever necessary to center strings containing method names.
    </span>
    <span class="koboSpan" id="kobo.296.5">
     This will facilitate maintenance
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.297.1">
      and improvements.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.298.1">
     With the Hub implemented, it will now be necessary to configure the application to handle communication
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.299.1">
      through SignalR.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-68">
    <a id="_idTextAnchor069">
    </a>
    <span class="koboSpan" id="kobo.300.1">
     Preparing the server application
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.301.1">
     The
    </span>
    <a id="_idIndexMarker249">
    </a>
    <span class="koboSpan" id="kobo.302.1">
     application needs to be configured to be able to handle connectivity between the client and the server.
    </span>
    <span class="koboSpan" id="kobo.302.2">
     Without this step, the Hub will have
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.303.1">
      no use.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.304.1">
     To do this, we
    </span>
    <a id="_idIndexMarker250">
    </a>
    <span class="koboSpan" id="kobo.305.1">
     will need to change the code in the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.306.1">
      Program.cs
     </span>
    </strong>
    <span class="koboSpan" id="kobo.307.1">
     file and add some important lines
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.308.1">
      of code.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.309.1">
     We must configure the SignalR services in the application container and map the Hub endpoint that will be used by the client to establish
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.310.1">
      the connection.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.311.1">
     At the end of the changes, the file should be similar to the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.312.1">
      following code:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.313.1">
using TaskManager.Hubs;
using TaskManager.Service;
using TaskManager.Service.Contract;
var builder = WebApplication.CreateBuilder(args);
// Add Razor Page services to the container.
</span><span class="koboSpan" id="kobo.313.2">builder.Services.AddRazorPages();
//Add SignalR Services
</span><strong class="bold"><span class="koboSpan" id="kobo.314.1">builder.Services.AddSignalR();</span></strong><span class="koboSpan" id="kobo.315.1">
// ..
</span><span class="koboSpan" id="kobo.315.2">var app = builder.Build();
// Some codes have been omitted to facilitate learning
app.MapRazorPages();
// Add Hub Endpoint
</span><strong class="bold"><span class="koboSpan" id="kobo.316.1">app.MapHub&lt;TaskManagerHub&gt;("/taskmanagerhub");</span></strong><span class="koboSpan" id="kobo.317.1">
app.Run();</span></pre>
   <p>
    <span class="koboSpan" id="kobo.318.1">
     It is
    </span>
    <a id="_idIndexMarker251">
    </a>
    <span class="koboSpan" id="kobo.319.1">
     very
    </span>
    <a id="_idIndexMarker252">
    </a>
    <span class="koboSpan" id="kobo.320.1">
     important to follow the order in which the settings were made.
    </span>
    <span class="koboSpan" id="kobo.320.2">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.321.1">
      builder.Services.AddSignalR()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.322.1">
     method was added before the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.323.1">
      var app = builder.Build()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.324.1">
     line.
    </span>
    <span class="koboSpan" id="kobo.324.2">
     Likewise, the Hub route mapping is added right after the
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.325.1">
       app.MapRazorPages()
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.326.1">
      statement.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.327.1">
     It is important to note the mapping of the Hub route, configured as
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.328.1">
      /taskmanagerhub
     </span>
    </strong>
    <span class="koboSpan" id="kobo.329.1">
     .
    </span>
    <span class="koboSpan" id="kobo.329.2">
     The Hub route definition follows the same REST API pattern and this same route will be used so that client applications are able to establish connections with the server.
    </span>
    <span class="koboSpan" id="kobo.329.3">
     The client will use the previously installed SignalR JavaScript SDK to connect to
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.330.1">
      the Hub.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.331.1">
     The Hub is configured and ready to receive connections.
    </span>
    <span class="koboSpan" id="kobo.331.2">
     Now, it’s time to configure
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.332.1">
      the client.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-69">
    <a id="_idTextAnchor070">
    </a>
    <span class="koboSpan" id="kobo.333.1">
     Preparing the client application
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.334.1">
     With the
    </span>
    <a id="_idIndexMarker253">
    </a>
    <span class="koboSpan" id="kobo.335.1">
     Hub configured, we must add the necessary features to the client application.
    </span>
    <span class="koboSpan" id="kobo.335.2">
     To do this, we will use the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.336.1">
      Pages/index.cshtml
     </span>
    </strong>
    <span class="koboSpan" id="kobo.337.1">
     page and
    </span>
    <a id="_idIndexMarker254">
    </a>
    <span class="koboSpan" id="kobo.338.1">
     create the JavaScript that will orchestrate all interactions between the client and
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.339.1">
      the server.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.340.1">
     Change the entire contents
    </span>
    <a id="_idIndexMarker255">
    </a>
    <span class="koboSpan" id="kobo.341.1">
     of the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.342.1">
      Index.cshtml
     </span>
    </strong>
    <span class="koboSpan" id="kobo.343.1">
     page to the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.344.1">
      following code:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.345.1">
@page
@model IndexModel
@{
    ViewData["Title"] = "Home page";
}
&lt;div class="text-center"&gt;
    &lt;h1 class="display-4"&gt;SignalR Task Manager&lt;/h1&gt;
&lt;/div&gt;
&lt;div class="task-form-container"&gt;
    &lt;h2&gt;Add a New Task&lt;/h2&gt;
    &lt;form method="post" class="task-form"&gt;
      &lt;input type="text" id="taskName"
        placeholder="Enter task name"
        class="task-input"/&gt;
      &lt;input type="button" value="Add Task"
        id="addTaskButton" class="task-submit"/&gt;
    &lt;/form&gt;
&lt;/div&gt;
&lt;div class="tasks-container"&gt;
    &lt;h2&gt;Uncompleted Tasks&lt;/h2&gt;
    &lt;div class="tasks-list" id="uncompletedTaskList"&gt;
      &lt;/div&gt;
    &lt;h2&gt;Completed Tasks&lt;/h2&gt;
    &lt;div class="tasks-list" id="completedTaskList"&gt;
    &lt;/div&gt;
&lt;/div&gt;
</span><strong class="bold"><span class="koboSpan" id="kobo.346.1">@section Scripts {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.347.1">    &lt;script src="~/js/signalr/dist/browser/signalr.js"</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.348.1">      asp-append-version="true"&gt;&lt;/script&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.349.1">    &lt;script src="~/js/index/index-page.js"</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.350.1">      asp-append-version="true"&gt;&lt;/script&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.351.1">}</span></strong></pre>
   <p>
    <span class="koboSpan" id="kobo.352.1">
     The HTML available is quite simple, just adding a form containing a field to name the task and a button that will be responsible for sending the new task to
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.353.1">
      the server.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.354.1">
     Additionally, there
    </span>
    <a id="_idIndexMarker256">
    </a>
    <span class="koboSpan" id="kobo.355.1">
     are two lists (completed tasks and uncompleted tasks) that will be displayed according to user interaction.
    </span>
    <span class="koboSpan" id="kobo.355.2">
     We are not using any Razor Pages directives in the HTML elements, so it will not be necessary to make any changes to the
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.356.1">
       Index.cshtml.cs
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.357.1">
      file.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.358.1">
     It is important
    </span>
    <a id="_idIndexMarker257">
    </a>
    <span class="koboSpan" id="kobo.359.1">
     to note that to facilitate the understanding of the concepts of client and server, together with SignalR, we are using a Razor Pages application.
    </span>
    <span class="koboSpan" id="kobo.359.2">
     However, it is possible to benefit from another approach called SPA, which makes it possible to use Frameworks such as Angular, React, or VueJS to create applications in JavaScript and HTML that run on the client and interact with
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.360.1">
      the server.
     </span>
    </span>
   </p>
   <p class="callout-heading">
    <span class="koboSpan" id="kobo.361.1">
     SPA
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.362.1">
     The
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.363.1">
      TaskManager
     </span>
    </strong>
    <span class="koboSpan" id="kobo.364.1">
     application
    </span>
    <a id="_idIndexMarker258">
    </a>
    <span class="koboSpan" id="kobo.365.1">
     uses Razor Pages to facilitate the explanation of SignalR concepts, concentrating the client and server in the same project.
    </span>
    <span class="koboSpan" id="kobo.365.2">
     However, SignalR can be installed in a separate application that uses pure JavaScript, typescript, or any framework such as Angular, Vue.js, and so on.
    </span>
    <span class="koboSpan" id="kobo.365.3">
     Furthermore, the SPA concept is a great practice for developing real-time functionalities.
    </span>
    <span class="koboSpan" id="kobo.365.4">
     Otherwise, if there are several pages being loaded by the browser, with each new request, a new connection with the server is established.
    </span>
    <span class="koboSpan" id="kobo.365.5">
     SPA makes it possible to render application pages dynamically while maintaining the same connection when
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.366.1">
      using SignalR.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.367.1">
     Note that the HTML code uses a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.368.1">
      @section Scripts {}
     </span>
    </strong>
    <span class="koboSpan" id="kobo.369.1">
     directive, where the previously installed SignalR libraries and the JavaScript file that we will create are added.
    </span>
    <span class="koboSpan" id="kobo.369.2">
     This section was defined in the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.370.1">
      Pages/Shared/_Layout.cshtml
     </span>
    </strong>
    <span class="koboSpan" id="kobo.371.1">
     file, as we learned in
    </span>
    <a href="B21788_02.xhtml#_idTextAnchor031">
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.372.1">
        Chapter 2
       </span>
      </em>
     </span>
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.373.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.374.1">
     Create an
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.375.1">
      index-page.js
     </span>
    </strong>
    <span class="koboSpan" id="kobo.376.1">
     file in the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.377.1">
      wwwroot/js/index
     </span>
    </strong>
    <span class="koboSpan" id="kobo.378.1">
     directory.
    </span>
    <span class="koboSpan" id="kobo.378.2">
     The entire content of this file is available in the application’s source code in the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.379.1">
      book’s repository.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.380.1">
     Let’s focus on the most important points for establishing a connection with the Hub.
    </span>
    <span class="koboSpan" id="kobo.380.2">
     To do this, we will basically need three
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.381.1">
      main steps:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.382.1">
      Create a
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.383.1">
       connection object.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.384.1">
      Map
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.385.1">
       the events.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.386.1">
      Start
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.387.1">
       the connection.
      </span>
     </span>
    </li>
   </ol>
   <p>
    <span class="koboSpan" id="kobo.388.1">
     These three steps are defined in the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.389.1">
      following code:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.390.1">
var connection = new signalR.HubConnectionBuilder()
  .withUrl(HUB_URL).build();
connection.on(NOTIFY_TASK_MANAGER_EVENT, updateTaskList);
connection.start().then(function () {
     addTaskButton.disabled = false;
}).catch(function (err) {
     return console.error(err.toString());
});</span></pre>
   <p>
    <span class="koboSpan" id="kobo.391.1">
     In the
    </span>
    <a id="_idIndexMarker259">
    </a>
    <span class="koboSpan" id="kobo.392.1">
     first line, we have the creation of the connection object using a SignalR object.
    </span>
    <span class="koboSpan" id="kobo.392.2">
     Note that the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.393.1">
      withUrl(HUB_URL)
     </span>
    </strong>
    <span class="koboSpan" id="kobo.394.1">
     method uses a
    </span>
    <a id="_idIndexMarker260">
    </a>
    <span class="koboSpan" id="kobo.395.1">
     constant that must contain the value of the Hub URL.
    </span>
    <span class="koboSpan" id="kobo.395.2">
     As we are using Razor Pages, the client and server will be available through the same address, and in this case, we can enter a relative URL such as
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.396.1">
      /taskmanagerhub
     </span>
    </strong>
    <span class="koboSpan" id="kobo.397.1">
     .
    </span>
    <span class="koboSpan" id="kobo.397.2">
     This URL is exactly the endpoint that was previously mapped on
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.398.1">
      the server.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.399.1">
     Next, we have the event implementation that will process the return from the server.
    </span>
    <span class="koboSpan" id="kobo.399.2">
     In this case, we use the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.400.1">
      on
     </span>
    </strong>
    <span class="koboSpan" id="kobo.401.1">
     method of the connection object.
    </span>
    <span class="koboSpan" id="kobo.401.2">
     This method receives two parameters, the first being a string that represents the event.
    </span>
    <span class="koboSpan" id="kobo.401.3">
     In this case, the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.402.1">
      NotifyTaskManager
     </span>
    </strong>
    <span class="koboSpan" id="kobo.403.1">
     value was set to a constant.
    </span>
    <span class="koboSpan" id="kobo.403.2">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.404.1">
      updateTaskList
     </span>
    </strong>
    <span class="koboSpan" id="kobo.405.1">
     method will process the return.
    </span>
    <span class="koboSpan" id="kobo.405.2">
     We can use an inline function.
    </span>
    <span class="koboSpan" id="kobo.405.3">
     However, to facilitate maintenance, we create a separate function that has the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.406.1">
      following signature:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.407.1">
function updateTaskList(taskModel) {
    //Code
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.408.1">
     This function could have any name and different types of parameters.
    </span>
    <span class="koboSpan" id="kobo.408.2">
     However, the methods available in the Hub are sending the client a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.409.1">
      TaskModel
     </span>
    </strong>
    <span class="koboSpan" id="kobo.410.1">
     object as a parameter.
    </span>
    <span class="koboSpan" id="kobo.410.2">
     This object will be serialized in JSON or binary and SignalR will add it to the event corresponding to the processing of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.411.1">
      this return.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.412.1">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.413.1">
      updateTaskList
     </span>
    </strong>
    <span class="koboSpan" id="kobo.414.1">
     function just gets the returned object and dynamically feeds the completed or incomplete task lists into the HTML
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.415.1">
      using JavaScript.
     </span>
    </span>
   </p>
   <p class="callout-heading">
    <span class="koboSpan" id="kobo.416.1">
     Best practice
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.417.1">
     It is good practice to use objects as method parameters, both on the client and on the server.
    </span>
    <span class="koboSpan" id="kobo.417.2">
     This prevents us from having to change method signatures in applications if output and input parameters are modified.
    </span>
    <span class="koboSpan" id="kobo.417.3">
     The use of objects simplifies information traffic between the client
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.418.1">
      and server.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.419.1">
     It is
    </span>
    <a id="_idIndexMarker261">
    </a>
    <span class="koboSpan" id="kobo.420.1">
     important to note that the name of the event must be the same both on the client and on the server, hence the use of constants to facilitate maintenance
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.421.1">
      and writing.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.422.1">
     The third step is to
    </span>
    <a id="_idIndexMarker262">
    </a>
    <span class="koboSpan" id="kobo.423.1">
     start the connection through the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.424.1">
      Start
     </span>
    </strong>
    <span class="koboSpan" id="kobo.425.1">
     method of the connection object.
    </span>
    <span class="koboSpan" id="kobo.425.2">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.426.1">
      Start
     </span>
    </strong>
    <span class="koboSpan" id="kobo.427.1">
     method delivers a promise that is triggered after the connection is established.
    </span>
    <span class="koboSpan" id="kobo.427.2">
     Additionally, it is possible to implement the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.428.1">
      catch
     </span>
    </strong>
    <span class="koboSpan" id="kobo.429.1">
     method, for mapping and any possible error when trying to connect with
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.430.1">
      the Hub.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.431.1">
     Now it’s time to add the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.432.1">
      click
     </span>
    </strong>
    <span class="koboSpan" id="kobo.433.1">
     event to the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.434.1">
      Add Task
     </span>
    </strong>
    <span class="koboSpan" id="kobo.435.1">
     button, which will be responsible for requesting the addition of a new task, according to the code
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.436.1">
      that follows:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.437.1">
var addTaskButton = document
  .getElementById("addTaskButton");
addTaskButton.addEventListener("click", function (event) {
    let taskName = document.getElementById(TASK_NAME_ID);
    connection.invoke(HUB_ADD_TASK_METHOD,
      { name: taskName.value }).catch(function (err) {
        return console.error(err.toString());
    });
    taskName.value = "";
    taskName.focus();
    event.preventDefault();
});</span></pre>
   <p>
    <span class="koboSpan" id="kobo.438.1">
     The
    </span>
    <a id="_idIndexMarker263">
    </a>
    <span class="koboSpan" id="kobo.439.1">
     preceding code requests the server through the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.440.1">
      connection.Invoke()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.441.1">
     function, having the name of the method available in the Hub and a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.442.1">
      TaskModel
     </span>
    </strong>
    <span class="koboSpan" id="kobo.443.1">
     object with the name defined through user input
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.444.1">
      as parameters.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.445.1">
     We currently have
    </span>
    <a id="_idIndexMarker264">
    </a>
    <span class="koboSpan" id="kobo.446.1">
     all the necessary requirements for the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.447.1">
      TaskManager
     </span>
    </strong>
    <span class="koboSpan" id="kobo.448.1">
     application to have real-time functionality.
    </span>
    <span class="koboSpan" id="kobo.448.2">
     Although it may seem complex, the approach is simple, requiring the client to be aware of the methods available on the server and the server to be aware of the events that can be executed on
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.449.1">
      the client.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.450.1">
     Let’s analyze the application execution flow in
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.451.1">
      more detail.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-70">
    <a id="_idTextAnchor071">
    </a>
    <span class="koboSpan" id="kobo.452.1">
     Understanding the client and server communication flow
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.453.1">
     With the
    </span>
    <a id="_idIndexMarker265">
    </a>
    <span class="koboSpan" id="kobo.454.1">
     Hub and client properly configured, it’s time to understand how the communication flow will work.
    </span>
    <span class="koboSpan" id="kobo.454.2">
     The flow for creating a task is represented according to
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.455.1">
       Figure 4
      </span>
     </em>
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.456.1">
       .3
      </span>
     </em>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.457.1">
      :
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer047">
     <span class="koboSpan" id="kobo.458.1">
      <img alt="Figure 4.3 – Communication between the Client and Server using SignalR" src="image/B21788_04_3.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.459.1">
     Figure 4.3 – Communication between the Client and Server using SignalR
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.460.1">
     The steps
    </span>
    <a id="_idIndexMarker266">
    </a>
    <span class="koboSpan" id="kobo.461.1">
     shown in
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.462.1">
       Figure 4
      </span>
     </em>
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.463.1">
      .3
     </span>
    </em>
    <span class="koboSpan" id="kobo.464.1">
     simply illustrate the entire communication flow of the application.
    </span>
    <span class="koboSpan" id="kobo.464.2">
     Let’s understand each of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.465.1">
      these steps:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.466.1">
      After entering the task name, the user clicks the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.467.1">
       Add Task
      </span>
     </strong>
     <span class="koboSpan" id="kobo.468.1">
      button.
     </span>
     <span class="koboSpan" id="kobo.468.2">
      The button’s click event requests the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.469.1">
       CreateTask
      </span>
     </strong>
     <span class="koboSpan" id="kobo.470.1">
      method, available on the server, through the Hub, passing a
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.471.1">
       TaskModel
      </span>
     </strong>
     <span class="koboSpan" id="kobo.472.1">
      object with the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.473.1">
       Name
      </span>
     </strong>
     <span class="koboSpan" id="kobo.474.1">
      property defined as a parameter.
     </span>
     <span class="koboSpan" id="kobo.474.2">
      The invocation of the server-side method is done through the connection that was previously made to
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.475.1">
       the Hub.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.476.1">
      Upon receiving a request for the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.477.1">
       CreateTask
      </span>
     </strong>
     <span class="koboSpan" id="kobo.478.1">
      method, the Hub then processes the task, adding it to a list in memory through the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.479.1">
       Save
      </span>
     </strong>
     <span class="koboSpan" id="kobo.480.1">
      method, which adds values to the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.481.1">
       Id
      </span>
     </strong>
     <span class="koboSpan" id="kobo.482.1">
      and
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.483.1">
        IsCompleted
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.484.1">
       properties.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.485.1">
      Then, the Hub invokes the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.486.1">
       NotifyTaskManager
      </span>
     </strong>
     <span class="koboSpan" id="kobo.487.1">
      method on the client, passing it as a parameter from the created
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.488.1">
        TaskModel
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.489.1">
       object.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.490.1">
      The client executes the method responsible for processing the server notification.
     </span>
     <span class="koboSpan" id="kobo.490.2">
      This method was implemented in the SignalR connection object and updates the application screen, displaying the list of created tasks and the list of
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.491.1">
       completed tasks.
      </span>
     </span>
    </li>
   </ol>
   <p>
    <span class="koboSpan" id="kobo.492.1">
     In this section, we
    </span>
    <a id="_idIndexMarker267">
    </a>
    <span class="koboSpan" id="kobo.493.1">
     learned the main concepts of SignalR for implementing real-time communication between client and server.
    </span>
    <span class="koboSpan" id="kobo.493.2">
     These concepts can be used in different types of applications, such as chat apps, order status updates in an online store, and so on.
    </span>
    <span class="koboSpan" id="kobo.493.3">
     However, there are cases wherein we must work with a constant data-sending model between the client and server and this depends on another synchronization model that can be implemented with SignalR through the use of streaming.
    </span>
    <span class="koboSpan" id="kobo.493.4">
     This concept is widely used in dashboards and applications such as news feeds.
    </span>
    <span class="koboSpan" id="kobo.493.5">
     In the next section, we will understand how
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.494.1">
      streaming works.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-71">
    <a id="_idTextAnchor072">
    </a>
    <span class="koboSpan" id="kobo.495.1">
     Working with streaming
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.496.1">
     In the context of SignalR, streaming is a
    </span>
    <a id="_idIndexMarker268">
    </a>
    <span class="koboSpan" id="kobo.497.1">
     powerful way of sending data from the server to
    </span>
    <a id="_idIndexMarker269">
    </a>
    <span class="koboSpan" id="kobo.498.1">
     the client and vice versa, in a continuous stream.
    </span>
    <span class="koboSpan" id="kobo.498.2">
     Unlike traditional request/response models, where data is sent in a single batch, streaming allows for a constant flow of data, which is particularly useful for scenarios involving real-time updates, such as live feeds, dashboards, or even
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.499.1">
      chat apps.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.500.1">
     Streaming on SignalR is characterized by several important features that make it an exceptional choice for real-time applications.
    </span>
    <span class="koboSpan" id="kobo.500.2">
     Through a continuous flow, data is sent as soon as it becomes available, which is crucial to creating a real-time user experience.
    </span>
    <span class="koboSpan" id="kobo.500.3">
     This means users receive updates immediately, keeping them
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.501.1">
      constantly informed.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.502.1">
     Next, streaming operations in SignalR are inherently asynchronous, ensuring that the application remains responsive even when dealing with multiple streaming operations or large volumes of data.
    </span>
    <span class="koboSpan" id="kobo.502.2">
     Lastly, SignalR supports bidirectional streaming, allowing not only server-to-client but also client-to-server
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.503.1">
      data flows.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.504.1">
     This flexibility
    </span>
    <a id="_idIndexMarker270">
    </a>
    <span class="koboSpan" id="kobo.505.1">
     opens up a wide range of possibilities for interactive applications where both the server and clients can initiate and participate in data exchanges, further enhancing the dynamic, real-time capabilities of applications built
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.506.1">
      with SignalR.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.507.1">
     The streaming strategy is a powerful solution.
    </span>
    <span class="koboSpan" id="kobo.507.2">
     However, it is important to keep some limitations and
    </span>
    <a id="_idIndexMarker271">
    </a>
    <span class="koboSpan" id="kobo.508.1">
     challenges
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.509.1">
      in mind:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.510.1">
       Network dependency and stability
      </span>
     </strong>
     <span class="koboSpan" id="kobo.511.1">
      : One of the main limitations of streaming on SignalR is its dependence on network quality.
     </span>
     <span class="koboSpan" id="kobo.511.2">
      Since streaming involves a continuous flow of data, a stable and reliable network connection is crucial.
     </span>
     <span class="koboSpan" id="kobo.511.3">
      Instabilities can cause a loss of connection, compromising the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.512.1">
       user experience.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.513.1">
       Resource intensity
      </span>
     </strong>
     <span class="koboSpan" id="kobo.514.1">
      : Streaming can be more resource-intensive than traditional request/response interactions.
     </span>
     <span class="koboSpan" id="kobo.514.2">
      Since the server must maintain an open connection and continually process and send data, this can increase CPU and memory usage.
     </span>
     <span class="koboSpan" id="kobo.514.3">
      In high-volume scenarios or with a large number of connected clients, this can become a significant challenge for resource management and
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.515.1">
       expansion strategies.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.516.1">
       Complexity in implementation and maintenance
      </span>
     </strong>
     <span class="koboSpan" id="kobo.517.1">
      : Implementing streaming logic is generally more complex than dealing with standard request/response models due to the need to manage continuous connections and deal with asynchronous data streams.
     </span>
     <span class="koboSpan" id="kobo.517.2">
      Additionally, it is challenging to debug streaming applications, especially when it comes to ensuring data integrity and dealing with
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.518.1">
       network issues.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.519.1">
       Scalability challenges
      </span>
     </strong>
     <span class="koboSpan" id="kobo.520.1">
      : Scaling real-time streaming applications can be challenging as the number of concurrent users increases and the load on the server can
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.521.1">
       increase quickly.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.522.1">
       Limited browser support and compatibility issues
      </span>
     </strong>
     <span class="koboSpan" id="kobo.523.1">
      : Although modern browsers generally support the technologies underlying SignalR, there may still be compatibility
     </span>
     <a id="_idIndexMarker272">
     </a>
     <span class="koboSpan" id="kobo.524.1">
      issues, especially with
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.525.1">
       older browsers.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.526.1">
       Security considerations
      </span>
     </strong>
     <span class="koboSpan" id="kobo.527.1">
      : With open and continuous connections, streaming applications may have different security considerations compared to traditional
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.528.1">
       web applications.
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.529.1">
     Understanding these limitations provides better strategy definition and application design to take advantage of the best benefits available
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.530.1">
      in SignalR.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-72">
    <a id="_idTextAnchor073">
    </a>
    <span class="koboSpan" id="kobo.531.1">
     Implementing basic streaming
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.532.1">
     We already
    </span>
    <a id="_idIndexMarker273">
    </a>
    <span class="koboSpan" id="kobo.533.1">
     understand the most important concepts of SignalR, such as how the Hub and the communication between the client and the server work.
    </span>
    <span class="koboSpan" id="kobo.533.2">
     However, it is important to implement a simple application example to understand the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.534.1">
      streaming approach.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.535.1">
     There’s nothing better than making an application to capture the concepts we’re learning.
    </span>
    <span class="koboSpan" id="kobo.535.2">
     Therefore, follow these steps to implement an application that
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.536.1">
      uses streaming:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.537.1">
      Access your operating system’s terminal navigate to a directory of your choice and create a folder with the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.538.1">
       following instructions:
      </span>
     </span>
     <pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.539.1">mkdir SignalRStream</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.540.1">cd SignalRStream</span></strong></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.541.1">
      Now, follow these steps to create
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.542.1">
       the application:
      </span>
     </span>
     <ol>
      <li class="upper-roman">
       <span class="koboSpan" id="kobo.543.1">
        Run the following command to create
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.544.1">
         the project:
        </span>
       </span>
       <pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.545.1">dotnet new webapp -o SignalRStreamingApp</span></strong></pre>
      </li>
      <li class="upper-roman">
       <span class="koboSpan" id="kobo.546.1">
        Then, access the created application directory and open Visual
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.547.1">
         Studio code:
        </span>
       </span>
       <pre class="source-code"><strong class="bold"><span class="koboSpan" id="kobo.548.1">cd SignalRStreamingApp</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.549.1">code .</span></strong></pre>
      </li>
      <li class="upper-roman">
       <span class="koboSpan" id="kobo.550.1">
        In the same way as we did in
       </span>
       <a id="_idIndexMarker274">
       </a>
       <span class="koboSpan" id="kobo.551.1">
        the
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.552.1">
         TaskManager
        </span>
       </strong>
       <span class="koboSpan" id="kobo.553.1">
        project, the first task will be to create a Hub.
       </span>
       <span class="koboSpan" id="kobo.553.2">
        Create
       </span>
       <a id="_idIndexMarker275">
       </a>
       <span class="koboSpan" id="kobo.554.1">
        a new folder called
       </span>
       <strong class="source-inline">
        <span class="koboSpan" id="kobo.555.1">
         Hubs
        </span>
       </strong>
       <span class="koboSpan" id="kobo.556.1">
        and then a class
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.557.1">
         called
        </span>
       </span>
       <span class="No-Break">
        <strong class="source-inline">
         <span class="koboSpan" id="kobo.558.1">
          StreamHub.cs
         </span>
        </strong>
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.559.1">
         :
        </span>
       </span>
       <pre class="source-code"><span class="koboSpan" id="kobo.560.1">using Microsoft.AspNetCore.SignalR;
using System.Threading.Channels;
namespace SignalRStream.Hubs;
public class StreamHub : Hub
{
    public ChannelReader&lt;int&gt; Countdown(int count)
    {
        var channel = Channel
          .CreateUnbounded&lt;int&gt;();
        _ = WriteItemsAsync(channel.Writer, count);
        return channel.Reader;
    }
    private async Task
      WriteItemsAsync(ChannelWriter&lt;int&gt;
      writer, int count)
    {
        for (int i = count; i &gt;= 0; i--)
        {
            await writer.WriteAsync(i);
            await Task.Delay(1000); // Simulates some delay
        }
        writer.TryComplete();
    }
}</span></pre>
      </li>
      <li class="upper-roman">
       <span class="koboSpan" id="kobo.561.1">
        This code has a
       </span>
       <strong class="source-inline">
        <span class="koboSpan" id="kobo.562.1">
         Countdown
        </span>
       </strong>
       <span class="koboSpan" id="kobo.563.1">
        method that returns a stream of integers counting down from a
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.564.1">
         specified number.
        </span>
       </span>
      </li>
      <li class="upper-roman">
       <span class="koboSpan" id="kobo.565.1">
        Now
       </span>
       <a id="_idIndexMarker276">
       </a>
       <span class="koboSpan" id="kobo.566.1">
        let’s change the
       </span>
       <strong class="source-inline">
        <span class="koboSpan" id="kobo.567.1">
         Program.cs
        </span>
       </strong>
       <span class="koboSpan" id="kobo.568.1">
        file by adding SignalR functionalities in the same way as we did in the
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.569.1">
         TaskManager
        </span>
       </strong>
       <span class="koboSpan" id="kobo.570.1">
        project.
       </span>
       <span class="koboSpan" id="kobo.570.2">
        The class should look like the
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.571.1">
         following code:
        </span>
       </span>
       <pre class="source-code"><span class="koboSpan" id="kobo.572.1">using TaskManager.Hubs;
using TaskManager.Service;
using TaskManager.Service.Contract;
var builder = WebApplication.CreateBuilder(args);
builder.Services.AddRazorPages();
//Add SignalR
builder.Services.AddSignalR();
var app = builder.Build();
if (!app.Environment.IsDevelopment())
{
    app.UseExceptionHandler("/Error");
    app.UseHsts();
}
app.UseHttpsRedirection();
app.UseStaticFiles();
app.UseRouting();
app.UseAuthorization();
app.MapRazorPages();
// Add Hub Endpoint
app.MapHub&lt;StreamHub&gt;("/streamHub");
app.Run();</span></pre>
      </li>
      <li class="upper-roman">
       <span class="koboSpan" id="kobo.573.1">
        Add
       </span>
       <a id="_idIndexMarker277">
       </a>
       <span class="koboSpan" id="kobo.574.1">
        the signalR client library using the
       </span>
       <span class="No-Break">
        <strong class="source-inline">
         <span class="koboSpan" id="kobo.575.1">
          libman
         </span>
        </strong>
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.576.1">
         application:
        </span>
       </span>
       <pre class="source-code"><strong class="bold"><span class="koboSpan" id="kobo.577.1">libman install @microsoft/signalr@latest -p unpkg -d wwwroot/js/signalr --files dist/browser/signalr.js</span></strong></pre>
      </li>
      <li class="upper-roman">
       <span class="koboSpan" id="kobo.578.1">
        Now we need to create a script to establish the connection to the Hub.
       </span>
       <span class="koboSpan" id="kobo.578.2">
        To do this, create a file called
       </span>
       <strong class="source-inline">
        <span class="koboSpan" id="kobo.579.1">
         index-stream.js
        </span>
       </strong>
       <span class="koboSpan" id="kobo.580.1">
        in the
       </span>
       <strong class="source-inline">
        <span class="koboSpan" id="kobo.581.1">
         wwwroo/js
        </span>
       </strong>
       <span class="koboSpan" id="kobo.582.1">
        directory.
       </span>
       <span class="koboSpan" id="kobo.582.2">
        This file must contain the
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.583.1">
         following code:
        </span>
       </span>
       <pre class="source-code"><span class="koboSpan" id="kobo.584.1">const connection = new signalR.HubConnectionBuilder()
    .withUrl("/streamHub")
    .build();
connection.start().then(function () {
  </span><strong class="bold"><span class="koboSpan" id="kobo.585.1">connection.stream("Countdown", 10)</span></strong><span class="koboSpan" id="kobo.586.1">.subscribe({
    </span><strong class="bold"><span class="koboSpan" id="kobo.587.1">next: (count)</span></strong><span class="koboSpan" id="kobo.588.1"> =&gt; {
      logStream(count);
    },
    </span><strong class="bold"><span class="koboSpan" id="kobo.589.1">complete: ()</span></strong><span class="koboSpan" id="kobo.590.1"> =&gt; {
      logStream("Stream completed");
    },
    </span><strong class="bold"><span class="koboSpan" id="kobo.591.1">error: (err)</span></strong><span class="koboSpan" id="kobo.592.1"> =&gt; {
      logStream(err);
    }
  });
}).catch(err =&gt; logStream(err.toString()));
function </span><strong class="bold"><span class="koboSpan" id="kobo.593.1">logStream(status)</span></strong><span class="koboSpan" id="kobo.594.1"> {
  let li = document.createElement("li");
  let ul = document.getElementById("ulLog");
  li.textContent = status;
  ul.appendChild(li);
}</span></pre>
      </li>
     </ol>
     <p class="list-inset">
      <span class="koboSpan" id="kobo.595.1">
       The
      </span>
      <a id="_idIndexMarker278">
      </a>
      <span class="koboSpan" id="kobo.596.1">
       preceding code aims to connect the client application to the server, using the same approach learned in the previous session.
      </span>
      <span class="koboSpan" id="kobo.596.2">
       In this example, first, there is the connection to the Hub.
      </span>
      <span class="koboSpan" id="kobo.596.3">
       This is accomplished by creating the connection using the new
      </span>
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.597.1">
        SignalR.HubConnectionBuilder()
       </span>
      </strong>
      <span class="koboSpan" id="kobo.598.1">
       line
      </span>
      <span class="No-Break">
       <span class="koboSpan" id="kobo.599.1">
        of code.
       </span>
      </span>
     </p>
     <p class="list-inset">
      <span class="koboSpan" id="kobo.600.1">
       Then, when starting the connection, the streaming approach is used, initiated by the
      </span>
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.601.1">
        connection.stream(..)
       </span>
      </strong>
      <span class="koboSpan" id="kobo.602.1">
       method.
      </span>
      <span class="koboSpan" id="kobo.602.2">
       The
      </span>
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.603.1">
        stream
       </span>
      </strong>
      <span class="koboSpan" id="kobo.604.1">
       method depends on two arguments, the first being the name of the method that will be requested on the server, called
      </span>
      <strong class="bold">
       <span class="koboSpan" id="kobo.605.1">
        Countdown
       </span>
      </strong>
      <span class="koboSpan" id="kobo.606.1">
       , previously
      </span>
      <a id="_idIndexMarker279">
      </a>
      <span class="koboSpan" id="kobo.607.1">
       created in the
      </span>
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.608.1">
        StreamHub.cs
       </span>
      </strong>
      <span class="koboSpan" id="kobo.609.1">
       file.
      </span>
      <span class="koboSpan" id="kobo.609.2">
       The second parameter is an integer value, where the countdown implemented in the server’s
      </span>
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.610.1">
        Countdown
       </span>
      </strong>
      <span class="koboSpan" id="kobo.611.1">
       method will start.
      </span>
      <span class="koboSpan" id="kobo.611.2">
       It is important to note that the number of parameters required by the stream method, in addition to the name of the function defined as a string, will vary according to the number of parameters implemented on
      </span>
      <span class="No-Break">
       <span class="koboSpan" id="kobo.612.1">
        the server.
       </span>
      </span>
     </p>
     <p class="list-inset">
      <span class="koboSpan" id="kobo.613.1">
       The
      </span>
      <a id="_idIndexMarker280">
      </a>
      <span class="koboSpan" id="kobo.614.1">
       stream method has a nested method called
      </span>
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.615.1">
        subscribe
       </span>
      </strong>
      <span class="koboSpan" id="kobo.616.1">
       , which has an implementation to obtain responses from the server.
      </span>
      <span class="koboSpan" id="kobo.616.2">
       The
      </span>
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.617.1">
        subscribe
       </span>
      </strong>
      <span class="koboSpan" id="kobo.618.1">
       method has an object that contains three main callback methods:
      </span>
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.619.1">
        next
       </span>
      </strong>
      <span class="koboSpan" id="kobo.620.1">
       ,
      </span>
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.621.1">
        complete
       </span>
      </strong>
      <span class="koboSpan" id="kobo.622.1">
       , and
      </span>
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.623.1">
        error
       </span>
      </strong>
      <span class="koboSpan" id="kobo.624.1">
       .
      </span>
      <span class="koboSpan" id="kobo.624.2">
       Each of these events is executed at a certain point in the streaming.
      </span>
      <span class="koboSpan" id="kobo.624.3">
       The
      </span>
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.625.1">
        next
       </span>
      </strong>
      <span class="koboSpan" id="kobo.626.1">
       method is used for the response sent from the server.
      </span>
      <span class="koboSpan" id="kobo.626.2">
       The
      </span>
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.627.1">
        complete
       </span>
      </strong>
      <span class="koboSpan" id="kobo.628.1">
       method is used when the streaming flow is finished and the error method is used if an error occurs.
      </span>
      <span class="koboSpan" id="kobo.628.2">
       All three subscribe methods use a
      </span>
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.629.1">
        logStream
       </span>
      </strong>
      <span class="koboSpan" id="kobo.630.1">
       javascript function implemented in the
      </span>
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.631.1">
        index-stream.js
       </span>
      </strong>
      <span class="koboSpan" id="kobo.632.1">
       file that adds a list element to the HTML containing the response
      </span>
      <span class="No-Break">
       <span class="koboSpan" id="kobo.633.1">
        to events.
       </span>
      </span>
     </p>
     <ol>
      <li class="upper-roman" value="8">
       <span class="koboSpan" id="kobo.634.1">
        Next, we need to change the
       </span>
       <strong class="source-inline">
        <span class="koboSpan" id="kobo.635.1">
         Pages/Index.cshtml
        </span>
       </strong>
       <span class="koboSpan" id="kobo.636.1">
        file to the
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.637.1">
         following code:
        </span>
       </span>
       <pre class="source-code"><span class="koboSpan" id="kobo.638.1">@page
@model IndexModel
@{
  ViewData["Title"] = "Home page";
}
&lt;div class="text-center"&gt;
  &lt;h1 class="display-4"&gt;Stream&lt;/h1&gt;
  &lt;ul id="ulLog"&gt;&lt;/ul&gt;
&lt;/div&gt;
@section Scripts {
  &lt;script src=
    "~/js/signalr/dist/browser/signalr.js"
    asp-append-version="true"&gt;
  &lt;/script&gt;
  &lt;script src="~/js/index-stream.js"
    asp-append-version="true"&gt;&lt;/script&gt;
}</span></pre>
      </li>
      <li class="upper-roman">
       <span class="koboSpan" id="kobo.639.1">
        Now, just run
       </span>
       <a id="_idIndexMarker281">
       </a>
       <span class="koboSpan" id="kobo.640.1">
        the application using the
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.641.1">
         following command:
        </span>
       </span>
       <pre class="source-code"><strong class="bold"><span class="koboSpan" id="kobo.642.1">dotnet run</span></strong></pre>
      </li>
     </ol>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer048">
     <span class="koboSpan" id="kobo.643.1">
      <img alt="Figure 4.4 – SignalR streaming app" src="image/B21788_04_4.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.644.1">
     Figure 4.4 – SignalR streaming app
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.645.1">
     As seen in
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.646.1">
       Figure 4
      </span>
     </em>
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.647.1">
      .4
     </span>
    </em>
    <span class="koboSpan" id="kobo.648.1">
     , we have a countdown starting from the number
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.649.1">
      10
     </span>
    </strong>
    <span class="koboSpan" id="kobo.650.1">
     and, at the end, there is a
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.651.1">
      Stream Completed
     </span>
    </strong>
    <span class="koboSpan" id="kobo.652.1">
     message, which determines the end of the streaming.
    </span>
    <span class="koboSpan" id="kobo.652.2">
     In this example, the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.653.1">
      next
     </span>
    </strong>
    <span class="koboSpan" id="kobo.654.1">
     and
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.655.1">
      complete
     </span>
    </strong>
    <span class="koboSpan" id="kobo.656.1">
     events from the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.657.1">
      subscribe
     </span>
    </strong>
    <span class="koboSpan" id="kobo.658.1">
     method were used.
    </span>
    <span class="koboSpan" id="kobo.658.2">
     This way, we can work with constant interaction between the client and the server using streaming, bringing greater power to
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.659.1">
      our applications.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.660.1">
     The application
    </span>
    <a id="_idIndexMarker282">
    </a>
    <span class="koboSpan" id="kobo.661.1">
     is very simple and basically generates a list of numbers obtained through the connection to the Hub, with a small delay to
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.662.1">
      simulate latency.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.663.1">
     The stream approach is very interesting for transporting small blocks of information and allowing active processing in parts, ensuring a better
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.664.1">
      user experience.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.665.1">
     We already understand the main features available in SignalR, but now let’s learn what is needed to host applications on
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.666.1">
      a server.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-73">
    <a id="_idTextAnchor074">
    </a>
    <span class="koboSpan" id="kobo.667.1">
     Hosting the ASP.NET Core SignalR application
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.668.1">
     Like any
    </span>
    <a id="_idIndexMarker283">
    </a>
    <span class="koboSpan" id="kobo.669.1">
     web-based application, we must make them available through a server after the development stage.
    </span>
    <span class="koboSpan" id="kobo.669.2">
     Applications developed in ASP.NET Core SignalR have the same characteristics and with all the power of the .NET platform, there is the possibility of hosting on internal servers and different
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.670.1">
      cloud providers.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.671.1">
     We will discuss more about hosting applications in
    </span>
    <a href="B21788_10.xhtml#_idTextAnchor162">
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.672.1">
        Chapter 10
       </span>
      </em>
     </span>
    </a>
    <span class="koboSpan" id="kobo.673.1">
     .
    </span>
    <span class="koboSpan" id="kobo.673.2">
     For now, we will just learn what is necessary to generate a hostable package for a
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.674.1">
      SignalR application.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-74">
    <a id="_idTextAnchor075">
    </a>
    <span class="koboSpan" id="kobo.675.1">
     The basics of hosting a SignalR application
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.676.1">
     Hosting
    </span>
    <a id="_idIndexMarker284">
    </a>
    <span class="koboSpan" id="kobo.677.1">
     an ASP.NET Core SignalR application isn’t drastically different from hosting a regular ASP.NET Core web app.
    </span>
    <span class="koboSpan" id="kobo.677.2">
     However, due to the real-time nature of SignalR, there are specific considerations to keep
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.678.1">
      in mind.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.679.1">
     It is important to define what the hosting model will be.
    </span>
    <span class="koboSpan" id="kobo.679.2">
     In general, currently public clouds are selected, such as Azure, AWS, or GCP (Google).
    </span>
    <span class="koboSpan" id="kobo.679.3">
     However, let’s understand each type of hosting available for ASP.NET Core
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.680.1">
      9 applications:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.681.1">
       Traditional hosting (IIS, Nginx, and Apache)
      </span>
     </strong>
     <span class="koboSpan" id="kobo.682.1">
      : These are standard web servers that can also serve SignalR applications.
     </span>
     <span class="koboSpan" id="kobo.682.2">
      They mainly act as reverse proxies, forwarding client requests to the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.683.1">
       SignalR application.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.684.1">
       Cloud hosting
      </span>
     </strong>
     <span class="koboSpan" id="kobo.685.1">
      : Cloud platforms offer robust and scalable hosting environments.
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.686.1">
       Azure App Service
      </span>
     </strong>
     <span class="koboSpan" id="kobo.687.1">
      , for
     </span>
     <a id="_idIndexMarker285">
     </a>
     <span class="koboSpan" id="kobo.688.1">
      example, provides an easy-to-use hosting model for ASP.NET Core applications, including those
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.689.1">
       using SignalR.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.690.1">
       Containers (Docker and Kubernetes)
      </span>
     </strong>
     <span class="koboSpan" id="kobo.691.1">
      : For those looking for more control over their
     </span>
     <a id="_idIndexMarker286">
     </a>
     <span class="koboSpan" id="kobo.692.1">
      hosting
     </span>
     <a id="_idIndexMarker287">
     </a>
     <span class="koboSpan" id="kobo.693.1">
      environment, containerization offers a way to package the SignalR application with all its dependencies, ensuring consistency across
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.694.1">
       different environments.
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.695.1">
     After defining
    </span>
    <a id="_idIndexMarker288">
    </a>
    <span class="koboSpan" id="kobo.696.1">
     the hosting server, the process of hosting the application follows approximately
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.697.1">
      four steps:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.698.1">
       Publishing the application
      </span>
     </strong>
     <span class="koboSpan" id="kobo.699.1">
      : Use Visual Studio or the .NET CLI to publish your application, generating a deployable unit.
     </span>
     <span class="koboSpan" id="kobo.699.2">
      This task can be done by running the following command as an example that compiles the application in the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.700.1">
       Release
      </span>
     </strong>
     <span class="koboSpan" id="kobo.701.1">
      mode and generates publication files in the
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.702.1">
        Published
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.703.1">
       folder:
      </span>
     </span>
     <pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.704.1">dotnet pubilish -c Release -o ./Published</span></strong></pre>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.705.1">
       Configuring the server
      </span>
     </strong>
     <span class="koboSpan" id="kobo.706.1">
      : Whether it’s IIS, a Linux server with Nginx/Apache, or a cloud service, you will need to configure the server or service to host your application.
     </span>
     <span class="koboSpan" id="kobo.706.2">
      This includes installing the necessary .NET runtimes, in the case of IIS or Nginex/Apache servers, and configuring the web server or
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.707.1">
       cloud service.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.708.1">
       Configuring reverse proxy (if necessary)
      </span>
     </strong>
     <span class="koboSpan" id="kobo.709.1">
      : For IIS, Nginx, and Apache, ensure they are configured to correctly forward requests to your ASP.NET Core application.
     </span>
     <span class="koboSpan" id="kobo.709.2">
      This is crucial for SignalR as it relies on
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.710.1">
       persistent connections.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.711.1">
       Deploying the application
      </span>
     </strong>
     <span class="koboSpan" id="kobo.712.1">
      : Upload or deploy the published application to your hosting environment.
     </span>
     <span class="koboSpan" id="kobo.712.2">
      This can be done via FTP, Web Deploy, or CI/CD pipelines if you are using cloud services
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.713.1">
       or containerization.
      </span>
     </span>
    </li>
   </ol>
   <p>
    <span class="koboSpan" id="kobo.714.1">
     Hosting SignalR applications presents unique challenges due to their nature of maintaining persistent connections to clients and can significantly burden
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.715.1">
      server resources.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.716.1">
     It is important to be aware of the connection limits of your server or hosting plan, as each will have a maximum number of simultaneous connections it can support.
    </span>
    <span class="koboSpan" id="kobo.716.2">
     In environments where load balancing is employed, the use of sticky sessions is recommended to preserve the integrity of connections, ensuring that a client communicates consistently with the same
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.717.1">
      server instance.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.718.1">
     Additionally, as
    </span>
    <a id="_idIndexMarker289">
    </a>
    <span class="koboSpan" id="kobo.719.1">
     the number of concurrent connections increases, you may need to expand your application, involving deploying multiple instances of your application and distributing traffic between them.
    </span>
    <span class="koboSpan" id="kobo.719.2">
     This would let you increase your ability to effectively manage a larger volume of concurrent connections.
    </span>
    <span class="koboSpan" id="kobo.719.3">
     This approach helps maintain the optimal performance and reliability of your SignalR application under
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.720.1">
      heavy load.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.721.1">
     However, we understand that SignalR applications add the option of developing real-time applications using ASP.NET Core 9 and their hosting does not present major differences from traditional
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.722.1">
      web-based applications.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.723.1">
     In
    </span>
    <a href="B21788_10.xhtml#_idTextAnchor162">
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.724.1">
        Chapter 10
       </span>
      </em>
     </span>
    </a>
    <span class="koboSpan" id="kobo.725.1">
     , we will explore in greater detail how we can host any type of web-based application dynamically, using the best
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.726.1">
      practices available.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-75">
    <a id="_idTextAnchor076">
    </a>
    <span class="koboSpan" id="kobo.727.1">
     Summary
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.728.1">
     In this chapter, we learned vital skills for creating dynamic real-time applications.
    </span>
    <span class="koboSpan" id="kobo.728.2">
     We learned about the powerful features of ASP.NET Core 9 SignalR, its architectural model and fundamentals, and supporting technologies, as well as creating a real-time task management application.
    </span>
    <span class="koboSpan" id="kobo.728.3">
     Furthermore, we explained the concepts of streaming in SignalR and covered the main activities required to host SignalR applications
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.729.1">
      on servers.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.730.1">
     In the next chapter, we will explore working with data and persistence by learning the aspects of data management and persistence in ASP.NET Core 9 applications, using technologies such as Entity Framework Core.
    </span>
    <span class="koboSpan" id="kobo.730.2">
     We will delve deeper into your understanding of database interactions and state management.
    </span>
    <span class="koboSpan" id="kobo.730.3">
     These are essential components for any
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.731.1">
      web-based application.
     </span>
    </span>
   </p>
  </div>
 

  <div class="Content" id="_idContainer050">
   <h1 id="_idParaDest-76" lang="en-US" xml:lang="en-US">
    <a id="_idTextAnchor077">
    </a>
    <span class="koboSpan" id="kobo.1.1">
     Part 2: Data and Security
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.2.1">
     When developing modern web solutions, we must deal with data persistence models and, of course, security.
    </span>
    <span class="koboSpan" id="kobo.2.2">
     In this part, we will cover the principles, patterns, and best practices for connecting applications developed in ASP.NET Core 9 to databases such as SQL Server.
    </span>
    <span class="koboSpan" id="kobo.2.3">
     We will learn about the entity-relational and NoSQL persistence models.
    </span>
    <span class="koboSpan" id="kobo.2.4">
     We will learn how ASP.NET Core 9 provides powerful tools for interacting with data access layers and we will learn about the use of technologies such as EntityFramework Core and Dapper.
    </span>
    <span class="koboSpan" id="kobo.2.5">
     In addition to interacting with data, we will learn about aspects related to application security, understanding the use of authorization and authentication, and how to implement applications that restrict access to information using ASP.NET
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.3.1">
      Core Identity.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.4.1">
     This part has the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.5.1">
      following chapters:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <a href="B21788_05.xhtml#_idTextAnchor078">
      <em class="italic">
       <span class="koboSpan" id="kobo.6.1">
        Chapter 5
       </span>
      </em>
     </a>
     <span class="koboSpan" id="kobo.7.1">
      ,
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.8.1">
       Working with Data and Persistence
      </span>
     </em>
    </li>
    <li>
     <a href="B21788_06.xhtml#_idTextAnchor093">
      <em class="italic">
       <span class="koboSpan" id="kobo.9.1">
        Chapter 6
       </span>
      </em>
     </a>
     <span class="koboSpan" id="kobo.10.1">
      ,
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.11.1">
       Enhancing Security and Quality
      </span>
     </em>
    </li>
   </ul>
  </div>
  <div>
   <div id="_idContainer051">
   </div>
  </div>
  <div>
   <div class="Basic-Graphics-Frame" id="_idContainer052">
   </div>
  </div>
 </body></html>