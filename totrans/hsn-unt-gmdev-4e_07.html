<html><head></head><body>
  <div id="_idContainer238" class="Basic-Text-Frame">
    <h1 class="chapterNumber">5</h1>
    <h1 id="_idParaDest-75" class="chapterTitle">Unleashing the Power of C# and Visual Scripting</h1>
    <p class="normal">Unity has a lot of great built-in tools to solve the most common problems in game development, such as the ones we have seen so far. Even two games of the same genre have their own little differences that make each game unique, and Unity cannot foresee that, so that’s why we have scripting. In this chapter, we will introduce the two main Unity scripting options: C# and visual scripting. We will discuss their pros and cons and the base knowledge required to start creating gameplay with them. From now on, we will see how to achieve all our scripts using both options.</p>
    <p class="normal">In this chapter, we will examine the following topics:</p>
    <ul>
      <li class="bulletList">Introducing scripting</li>
      <li class="bulletList">Creating scripts</li>
      <li class="bulletList">Using events and instructions</li>
      <li class="bulletList">Common beginner C# script errors</li>
    </ul>
    <p class="normal">We are going to create our own Unity components, learning the basic structure of a script and the way that we can execute actions and expose properties to be configured, both with C# and visual scripting. We are not going to create any of our actual game code in this chapter, just some example scripts to set the groundwork to do so in the next one. Let’s start by discussing Unity’s scripting options.</p>
    <h1 id="_idParaDest-76" class="heading-1">Introducing scripting</h1>
    <p class="normal">Through coding, we can extend Unity’s capabilities in several ways to achieve the exact behavior we need, all<a id="_idIndexMarker213"/> through a well-known programming language—C#. However, aside from C#, Unity also has <strong class="keyWord">visual scripting</strong>, a way <a id="_idIndexMarker214"/>to generate code through a node graph tool. </p>
    <p class="normal">This means you can create scripts without writing code but <a id="_idIndexMarker215"/>by dragging <strong class="keyWord">nodes</strong>, boxes that represent actions that can be chained:</p>
    <figure class="mediaobject"><img src="../Images/B21361_05_01_PRE_BOOK.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 5.1: Example of a visual scripting graph</p>
    <p class="normal">While essentially both ways can achieve the same result, we can use them for different things. Usually, the core logic of a game is written in C# due to it usually being huge and very performance-sensitive. However, sometimes using visual scripts instead allows non-programmer team members, like artists or game designers, to have more freedom to edit minor changes in the game, especially regarding balancing or visual effects.</p>
    <p class="normal">Another example would be game designers prototyping ideas through visual scripts that programmers would later convert to C# scripts when the idea is approved. Also, C# programmers can create nodes for Visual Script programmers to use.</p>
    <p class="normal">The way to mix these tools varies widely between teams, so while, in the next chapters, we are going to focus mainly on C#, we are also going to see the visual scripting equivalent version of the scripts we are going to create. This way, you will have the opportunity to experiment when convenient to use one or the other, according to your team structure.</p>
    <p class="normal">Now, let’s continue by discussing the basics of script creation.</p>
    <h1 id="_idParaDest-77" class="heading-1">Creating scripts</h1>
    <p class="normal">The <a id="_idIndexMarker216"/>first step to creating behavior is to create script assets; these are files that will contain the logic behind the behavior of our components. Both C# and visual scripting have their own type of asset to achieve that, so let’s explore how to do that in both tools.</p>
    <p class="normal">Having some programming knowledge is required in this book. However, in this first section, we are going to discuss a basic script structure to make sure you have a strong foundation to follow when we code the behaviors of our game in the following chapters. Even if you are familiar with C#, try not to skip this section because we will cover Unity-specific structures of code.</p>
    <p class="normal">In this section, we will examine the following script creation concepts:</p>
    <ul>
      <li class="bulletList">Initial setup</li>
      <li class="bulletList">Creating a C# script</li>
      <li class="bulletList">Adding fields</li>
      <li class="bulletList">Creating a visual script graph</li>
    </ul>
    <p class="normal">We are going to create our first script, which will serve to create our component, discussing the tools needed to do so and exploring how to expose our class fields to the editor. Let’s start with the basics of script creation.</p>
    <h2 id="_idParaDest-78" class="heading-2">Initial setup</h2>
    <p class="normal">Support <a id="_idIndexMarker217"/>for visual scripting is added by installing the <strong class="screenText">Visual Scripting</strong> package in the <strong class="screenText">Package Manager</strong> as we did with other packages in previous chapters, but as Unity does that automatically for us when we create the project, we don’t need any further setup. That means the rest of this section will take care of setting up the tools needed to work with C#.</p>
    <p class="normal">One thing to<a id="_idIndexMarker218"/> consider before creating our first C# script is how Unity compiles the code. While coding, we are used to having an <strong class="screenText">Integrated Development Environment</strong> (<strong class="screenText">IDE</strong>), which is a program to create our code and compile or execute it. In Unity, we will just use an IDE as a tool to create the scripts easily with coloring and auto-completion because Unity doesn’t have a custom code editor (if you have never coded before, these are valuable tools for beginners). The scripts will be created inside the Unity project and Unity will detect and compile them if any changes are made, so you won’t compile them in the IDE. Don’t worry, even if not compiling and running the code in the IDE, it is possible to debug, add breakpoints, and check the data on the variables and structures using the IDE and Unity together.</p>
    <p class="normal">We can use Visual Studio, Visual Studio Code, Rider, or whatever C# IDE you’d like to use, but when you install Unity, you will probably see an option to install Visual Studio automatically, which allows you to have a default IDE. This installs the free version of Visual Studio, so don’t worry about the licenses here. If you don’t have an IDE on your computer and didn’t check the Visual Studio option while installing Unity, you can do the following:</p>
    <ol style="list-style-type: decimal;" class="numberedList">
      <li class="numberedList" value="1">Open <strong class="screenText">Unity Hub</strong> and go to the <strong class="screenText">Installs</strong> section.</li>
      <li class="numberedList">Click on the wheel button in the top-right area of the Unity version you are using and click on <strong class="screenText">Add modules</strong>:</li>
    </ol>
    <figure class="mediaobject"><img src="../Images/B21361_05_02.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 5.2: Adding a module to the Unity installation</p>
    <ol style="list-style-type: decimal;" class="numberedList">
      <li class="numberedList" value="3">Check the option that says <strong class="screenText">Visual Studio</strong>; the description of the option will vary, depending on the version of Unity and the platform you are using.</li>
      <li class="numberedList">Hit the <strong class="screenText">Continue</strong> button at the bottom right:</li>
    </ol>
    <figure class="mediaobject"><img src="../Images/B21361_05_03.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 5.3: Installing Visual Studio</p>
    <ol style="list-style-type: decimal;" class="numberedList">
      <li class="numberedList" value="5">Check <a id="_idIndexMarker219"/>that you accept the terms and conditions, and click <strong class="screenText">Install</strong>:</li>
    </ol>
    <figure class="mediaobject"><img src="../Images/B21361_05_04.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 5.4: Accepting the terms and conditions</p>
    <ol style="list-style-type: decimal;" class="numberedList">
      <li class="numberedList" value="6">Wait for the operation to end. This might take a few minutes. There may be additional Visual Studio steps that vary between platforms and versions; if so, just follow them.</li>
    </ol>
    <p class="normal">If you have a <a id="_idIndexMarker220"/>preferred IDE, you can install it yourself and configure Unity to use it. If you can afford it or you are a teacher or a student (as it is free in these cases), I recommend Rider. It is a great IDE with lots of C# and Unity features that you will love; however, it is not vital for this book. In order to set up Unity to use a custom IDE, do the following:</p>
    <ol style="list-style-type: decimal;" class="numberedList">
      <li class="numberedList" value="1">Open the project and go to <strong class="screenText">Edit | Preferences</strong> in the top menu of the editor (<strong class="screenText">Unity | Preferences</strong> on a Mac).</li>
      <li class="numberedList">Select the <strong class="screenText">External Tools</strong> menu from the left panel.</li>
      <li class="numberedList">From the external script editor, select your preferred IDE; Unity will automatically detect the supported IDEs:</li>
    </ol>
    <figure class="mediaobject"><img src="../Images/B21361_05_05_PRE_BOOK.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 5.5: Selecting a custom IDE</p>
    <ol style="list-style-type: decimal;" class="numberedList">
      <li class="numberedList" value="4">If you don’t find your IDE in the list, you can use the <strong class="screenText">Browse…</strong> option. Note that, usually, IDEs that require you to use this option are not very well supported—but it’s worth a shot.</li>
      <li class="numberedList">Click <strong class="screenText">Regenerate project files</strong> after selecting your IDE. That will recompile all the necessary files of the project so you don’t run into any issues if some of the project files don’t exist.</li>
    </ol>
    <p class="normal">Finally, some IDEs, such as Visual Studio, Visual Studio Code, and Rider, have Unity integration tools that you need to install in your project, which is optional but can be useful. Usually, Unity installs these automatically, but if you want to be sure that they are installed, follow these steps:</p>
    <ol style="list-style-type: decimal;" class="numberedList">
      <li class="numberedList" value="1">Open <strong class="screenText">Package Manager</strong> (<strong class="screenText">Window|Package Manager</strong>).</li>
      <li class="numberedList">Set the <strong class="keyWord">Packages</strong> dropdown to<strong class="screenText">Unity Registry </strong>mode:</li>
    </ol>
    <figure class="mediaobject"><img src="../Images/B21361_05_06.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 5.6: Enabling Unity Registry mode</p>
    <ol style="list-style-type: decimal;" class="numberedList">
      <li class="numberedList" value="3">Search<a id="_idIndexMarker221"/> the list for your IDE or filter the list by using the search bar. In my case, I used Rider, and I can find a package called <strong class="screenText">JetBrains Rider Editor</strong>:</li>
    </ol>
    <figure class="mediaobject"><img src="../Images/B21361_05_07.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 5.7: Custom IDE editor extension installation—in this case, the Rider one</p>
    <ol style="list-style-type: decimal;" class="numberedList">
      <li class="numberedList" value="4">Check whether your IDE integration package is installed by looking at the buttons in the <a id="_idIndexMarker222"/>bottom-right part of the Package Manager. If you see an <strong class="screenText">Install </strong>or <strong class="screenText">Update</strong> button, click on it; but if it says <strong class="screenText">Installed</strong>, everything is set up.</li>
    </ol>
    <p class="normal">Now that we have an IDE configured, let’s create our first script.</p>
    <h2 id="_idParaDest-79" class="heading-2">Creating a C# script</h2>
    <p class="normal">C# is an <a id="_idIndexMarker223"/>object-oriented language. Any time we want to extend<a id="_idIndexMarker224"/> Unity, we need to create our own class—a script with the instructions we want to add to Unity. If we want to create custom components, we need to create a class that inherits from <code class="inlineCode">MonoBehaviour</code>, the base class of every custom component.</p>
    <p class="normal">We can create C# script files directly within the Unity project using the Editor, and you can arrange<a id="_idIndexMarker225"/> them in folders right next to other <code class="inlineCode">assets</code> folders. The easiest way to create a script is by following these steps:</p>
    <ol style="list-style-type: decimal;" class="numberedList">
      <li class="numberedList" value="1">Select any GameObject that you want to have the component we are going to create. As we are just testing this out, select any object.</li>
      <li class="numberedList">Click on the <strong class="screenText">Add Component</strong> button at the bottom of the Inspector, and look for the <strong class="screenText">New script</strong> option at the bottom of the list, displayed after clicking on <strong class="screenText">Add Component</strong>:</li>
    </ol>
    <figure class="mediaobject"><img src="../Images/B21361_05_08_PRE_BOOK.png" alt="A screenshot of a computer  Description automatically generated with low confidence"/></figure>
    <p class="packt_figref">Figure 5.8: The New script option</p>
    <ol style="list-style-type: decimal;" class="numberedList">
      <li class="numberedList" value="3">In the <strong class="screenText">Name</strong> field, enter the desired script name, and then click <strong class="screenText">Create and Add</strong>. In my case, I will call it <code class="inlineCode">MyFirstScript</code>, but for the scripts that you will use for your game, try <a id="_idIndexMarker226"/>to enter descriptive names, regardless of the length:
    <figure class="mediaobject"><img src="../Images/B21361_05_09_PRE_BOOK.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 5.9: Naming the script</p>
    <p class="normal">It is<a id="_idIndexMarker227"/> recommended that you use Pascal case for script naming. In Pascal case, a script for the player’s shooting functionality would be called <code class="inlineCode">PlayerShoot</code>. The first letter of each word of the name is in uppercase, and you can’t use spaces.</p></li>
    </ol>
    <ol style="list-style-type: decimal;" class="numberedList">
      <li class="numberedList" value="4">You can check how a new asset with the same name as your script is created in <strong class="screenText">Project View</strong>. Remember that each component has its own asset, and I suggest you put each component in a <code class="inlineCode">Scripts</code> folder:</li>
    </ol>
    <figure class="mediaobject"><img src="../Images/B21361_05_10_PRE_BOOK.png" alt="A blue and white rectangle with black text  Description automatically generated with low confidence"/></figure>
    <p class="packt_figref">Figure 5.10: Script asset</p>
    <ol style="list-style-type: decimal;" class="numberedList">
      <li class="numberedList" value="5">Now, you will also see that your GameObject has a new component in the <strong class="screenText">Inspector</strong> window, which <a id="_idIndexMarker228"/>has the same name as your script. So you have now created<a id="_idIndexMarker229"/> your first <code class="inlineCode">component</code> class:</li>
    </ol>
    <figure class="mediaobject"><img src="../Images/B21361_05_11.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 5.11: Our script added to a GameObject</p>
    <p class="normal">Now that we have created a <code class="inlineCode">component</code> class, remember that a class is not the component itself. It is a description of what the component should be—a blueprint of how a component should work. To actually use the component, we need to instantiate it by creating a component based on the class. Each time we add a component to an object using the editor, Unity is instantiating it for us. If you are familiar with object-oriented programming languages, you may recall that when we use a programming language like C#, we need to code the instantiation of the object using one specific keyword inside a script: <strong class="screenText">new</strong>. In Unity, there is no need to do that; generally, we don’t instantiate components using the new C# keyword but, instead, by using the editor or specialized functions.</p>
    <p class="normal">Now, you can add your new empty component to other objects as you would any other component, by using the <strong class="screenText">Add Component</strong> button in the <strong class="screenText">Inspector</strong> window. Then, you can look for the component in the <strong class="screenText">Scripts </strong>category or search for it by name:</p>
    <figure class="mediaobject"><img src="../Images/B21361_05_12.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 5.12: Adding a custom component in the Scripts category</p>
    <p class="normal">Something<a id="_idIndexMarker230"/> that you need to consider here is that we can add the <a id="_idIndexMarker231"/>same component to several GameObjects. We don’t need to create a class for each GameObject that uses the component. I know this is basic programmers’ knowledge, but remember that we are trying to recap the basics here.</p>
    <p class="normal">Now that we have our component, let’s explore how it looks and carry out a class structure recap by following these steps:</p>
    <ol style="list-style-type: decimal;" class="numberedList">
      <li class="numberedList" value="1">Locate the script asset in <strong class="screenText">Project View</strong> and double-click on it. Remember that it should be in the <code class="inlineCode">Scripts</code> folder you created previously.</li>
      <li class="numberedList">Wait for the IDE to open; this can take a while. You will know that the IDE has finished the initialization when you see your script code and its keywords properly colored like in the following figure, which varies according to the desired IDE. In Rider, it looks like what is shown in <em class="italic">Figure 5.13</em>. In my case, I knew that Rider had finished initializing because the <code class="inlineCode">MonoBehaviour</code> type and the script name are colored the same:</li>
    </ol>
    <figure class="mediaobject"><img src="../Images/B21361_05_13_PRE_BOOK.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 5.13: A new script opened in the Rider IDE</p>
    <ol style="list-style-type: decimal;" class="numberedList">
      <li class="numberedList" value="3">The first <a id="_idIndexMarker232"/>three lines in the preceding screenshot—the ones that start with the <code class="inlineCode">using</code> keyword—include common namespaces. <strong class="screenText">Namespaces</strong> are like code containers, which are, in this case, code created by others (such as Unity, C# creators, and so on). We will be using namespaces<a id="_idIndexMarker233"/> quite often to simplify our tasks; they already contain solved algorithms that we will use. We will add and remove the <code class="inlineCode">using</code> components as we need; in my case, Rider suggests that the first two <code class="inlineCode">using</code> components are not necessary because I am not using any code inside them, and so they are grayed out. But keep them for now, as you will use them in later chapters of this book. Remember, they should always be at the beginning of a file:</li>
    </ol>
    <figure class="mediaobject"><img src="../Images/B21361_05_14_PRE_BOOK.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 5.14: The using sections</p>
    <ol style="list-style-type: decimal;" class="numberedList">
      <li class="numberedList" value="4">The next line, the one that starts with <code class="inlineCode">public class</code>, is where we declare that we are creating a new class that inherits from <code class="inlineCode">MonoBehaviour</code>, the base class of every custom<a id="_idIndexMarker234"/> component. We know this because<a id="_idIndexMarker235"/> it ends with <code class="inlineCode">: MonoBehaviour</code>. You can see how the rest of the code is located inside brackets right below that line, meaning that the code inside them belongs to the component:</li>
    </ol>
    <figure class="mediaobject"><img src="../Images/B21361_05_15_PRE_BOOK.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 5.15: The MyFirstScript class definition inherits from MonoBehaviour</p>
    <p class="normal">Now that we have our C# script, let’s add fields to configure it.</p>
    <h2 id="_idParaDest-80" class="heading-2">Adding fields</h2>
    <p class="normal">In previous <a id="_idIndexMarker236"/>chapters, when we added components such as <code class="inlineCode">Rigidbody</code> or different kinds of colliders, adding the components wasn’t enough. We needed to properly configure them to achieve the exact behavior that we needed. For example, <code class="inlineCode">Rigidbody</code> has the <code class="inlineCode">Mass</code> property to control an object’s weight, and the colliders have the <code class="inlineCode">Size</code> property to control their shape. This way, we can reuse the same component for different scenarios, preventing the duplication of similar components. With a <code class="inlineCode">Box</code> collider, we can represent a cube or rectangular box just by changing the size properties. Our components are no exception; if we have a component that moves an object and we want two objects to move at different speeds, we can use the same component with different configurations.</p>
    <p class="normal">Each configuration is a <strong class="screenText">field</strong> or <strong class="screenText">variable</strong> where we can hold a parameter’s value. We can create class fields that can be edited in the editor in two ways:</p>
    <ul>
      <li class="bulletList">By marking the field as public, but breaking the encapsulation principle</li>
      <li class="bulletList">By making a private field and exposing it with an attribute</li>
    </ul>
    <p class="normal">Now, we are going to cover both methods, but if you are not familiar with <strong class="screenText">Object-Oriented Programming</strong> (<strong class="screenText">OOP</strong>) concepts, such as encapsulation, I recommend you use the first method.</p>
    <p class="normal">Suppose we are<a id="_idIndexMarker237"/> creating a movement script. We will add an editable number field representing the velocity using the first method—that is, by adding the <code class="inlineCode">public</code> field. We will do this by following these steps:</p>
    <ol style="list-style-type: decimal;" class="numberedList">
      <li class="numberedList" value="1">Open the script by double-clicking on it, as we did before.</li>
      <li class="numberedList">Inside the class brackets, but outside any brackets within them, add the following code:
    <figure class="mediaobject"><img src="../Images/B21361_05_16_PRE_BOOK.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 5.16: Creating a speed field in our component</p>
    <p class="normal">The <code class="inlineCode">public</code> keyword specifies that the variable can be seen and edited beyond the scope of the class. The <code class="inlineCode">float</code> part of the code says that the variable uses the decimal number type, and <code class="inlineCode">speed</code> is the name we chose for our field—although this can be whatever you want. You can use other value types to represent other kinds of data, such as <code class="inlineCode">bool</code> to represent checkboxes or <code class="inlineCode">Booleans</code> and <code class="inlineCode">string</code> to represent text.</p></li>
    </ol>
    <ol style="list-style-type: decimal;" class="numberedList">
      <li class="numberedList" value="3">To apply the changes, just save the file in the IDE (usually by pressing <em class="keystroke">Ctrl</em> + <em class="keystroke">S</em> or <em class="keystroke">Command</em> + <em class="keystroke">S</em>) and return to Unity. When you do this, you will notice a little loading wheel in the bottom-right part of the editor, indicating that Unity is compiling the code. You can’t test the changes until the wheel stops turning:
    <figure class="mediaobject"><img src="../Images/B21361_05_17.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 5.17: The loading wheel</p>
    <p class="normal">Remember that Unity will compile the code; don’t compile it in the IDE.</p></li>
    </ol>
    <ol style="list-style-type: decimal;" class="numberedList">
      <li class="numberedList" value="4">After<a id="_idIndexMarker238"/> the compilation is finished, you can see your component in the <strong class="screenText">Inspector</strong> window and the <strong class="screenText">Speed </strong>variable should be there, allowing you to set the speed you want. Of course, right now, the variables do nothing. Unity doesn’t recognize your intention by the name of the variable; we need to set it for use in some way, but we will do that later:
    <figure class="mediaobject"><img src="../Images/B21361_05_18.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 5.18: A public field to edit data that the component will use later</p>
    <p class="normal">If you don’t see the <code class="inlineCode">speed</code> variable, please check the section at the end of this chapter called <em class="italic">Common beginner C# script errors</em>, which will give you tips about how to troubleshoot compilation errors.</p></li>
    </ol>
    <ol style="list-style-type: decimal;" class="numberedList">
      <li class="numberedList" value="5">Try adding the same component to other objects, and set a different speed. This will show you how components in different GameObjects are independent, allowing you to change some of their behaviors via different settings.</li>
      <li class="numberedList">Instead<a id="_idIndexMarker239"/> of using the <code class="inlineCode">public</code> keyword as we did in the previous steps to define available properties in the Inspector, we create a <code class="inlineCode">private</code> field, encouraging encapsulation and exposing it using the <code class="inlineCode">SerializeField</code> attribute, as shown in the following screenshot.</li>
    </ol>
    <figure class="mediaobject"><img src="../Images/B21361_05_19_PRE_BOOK.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 5.19: Exposing private attributes in the Inspector window</p>
    <p class="normal">If you are not familiar with the OOP concept of encapsulation, just use the first approach, using the <code class="inlineCode">public</code> keyword, to expose the variable in the Inspector, which is more flexible for beginners. If you create a <code class="inlineCode">private</code> field, it won’t be accessible to other scripts because the <code class="inlineCode">SerializeField</code> attribute only exposes the variable to the editor. Remember that Unity won’t allow you to use constructors, so the only way to set initial data and inject dependencies is via serialized <code class="inlineCode">private</code> fields or <code class="inlineCode">public</code> fields and setting them in the editor (or using a dependency injection framework, but that is beyond the scope of this book). For simplicity, we will use the first method in most of the exercises in this book.</p>
    <p class="normal">If you want, try to create other types of variables, and check how they look in the Inspector. Try replacing <code class="inlineCode">float</code> with <code class="inlineCode">bool</code> or <code class="inlineCode">string</code>, as previously suggested. Remember that not every possible C# type is recognized by Unity; through this book, we will learn about the most commonly supported ones.</p>
    <p class="normal">Now that we know how to configure our components through data, let’s use that data to create some behavior.</p>
    <div class="note">
      <p class="normal">Even if we are using C#, which is still a very fast language, Unity has a feature called IL2CPP, which automatically converts our scripts to optimized C++ code. Check this documentation to get more info: <a href="https://docs.unity3d.com/Manual/IL2CPP.html"><span class="url">https://docs.unity3d.com/Manual/IL2CPP.html</span></a>. However, IL2CPP is not always necessary, as the code you will write while reading this book will still be fast enough. We won’t do a massive simulation with thousands of GameObjects, but I still recommend experimenting with IL2CPP, especially on mobile devices, where the performance boost is going to be significant.</p>
    </div>
    <p class="normal">Now that we have our C# script, let’s see how to do the same in visual scripting.</p>
    <h2 id="_idParaDest-81" class="heading-2">Creating a visual script</h2>
    <p class="normal">As we need to <a id="_idIndexMarker240"/>create a script asset for C# scripts, we need to create the visual scripting equivalent of it called a<strong class="screenText"> script graph</strong> and also attach it to our GameObject, although using a different approach this time. Before continuing, it is worth noticing that our objects must only have C# or the visual scripting version, but not both, or the behavior will be applied twice, once per version.</p>
    <p class="normal">Essentially, only do the steps for the version you want to try or do both steps in different objects if you want to experiment.</p>
    <p class="normal">Let’s create <a id="_idIndexMarker241"/>a visual script by doing the following:</p>
    <ol style="list-style-type: decimal;" class="numberedList">
      <li class="numberedList" value="1">Create a new GameObject to which we will add the visual script.</li>
      <li class="numberedList">Add the <strong class="screenText">Script Machine</strong> component to it. This component will execute the <strong class="screenText">visual script graph</strong> we will be creating shortly:</li>
    </ol>
    <figure class="mediaobject"><img src="../Images/B21361_05_20_PRE_BOOK.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 5.20: Adding a Script Machine component</p>
    <ol style="list-style-type: decimal;" class="numberedList">
      <li class="numberedList" value="3">In the <strong class="screenText">Script Machine</strong> component, click the <strong class="screenText">New</strong> button, and select a folder and a name to save the visual script graph asset. This asset will contain the instructions of our script, and the <strong class="screenText">Script Machine</strong> component will execute those:</li>
    </ol>
    <figure class="mediaobject"><img src="../Images/B21361_05_21_PRE_BOOK.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 5.21: Using the New button to create a visual scripting graph asset</p>
    <ol style="list-style-type: decimal;" class="numberedList">
      <li class="numberedList" value="4">If a <a id="_idIndexMarker242"/>warning appears, click the <strong class="screenText">Change now</strong> option. This will prevent those changes on the script from affecting the game while<a id="_idIndexMarker243"/> it’s running because, as the warning says, it can cause instability in code. Always stop the game, change the code, and then play again.</li>
      <li class="numberedList">Click the <strong class="screenText">Edit Graph</strong> Button to open the visual script editor window. You can drag the <strong class="screenText">Script Graph</strong> tab to any part of the editor to merge that window:</li>
    </ol>
    <figure class="mediaobject"><img src="../Images/B21361_05_22.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 5.22: Visual scripting asset editor</p>
    <ol style="list-style-type: decimal;" class="numberedList">
      <li class="numberedList" value="6">Put the mouse in an empty area in the grid of the visual script editor, and while holding the middle mouse button, move the mouse to scroll through the graph. On MacBooks and Apple Magic Mouses, you can scroll using two fingers on the trackpad.</li>
    </ol>
    <p class="normal">What we did is create the visual graph asset that will contain the code of our script, and attach it to a GameObject through the <strong class="screenText">Script Machine</strong> component. Unlike C# scripts, we can’t attach the graph asset directly; that’s why we need <strong class="screenText">Script Machine</strong> to run the component for us.</p>
    <p class="normal">Regarding<a id="_idIndexMarker244"/> fields, the<a id="_idIndexMarker245"/> ones we created in the C# scripts are contained in the script itself, but for visual graphs, they work a little bit differently. When we added the <strong class="screenText">Script Machine </strong>component, another one was added: the <strong class="screenText">Variables</strong> component. This will hold all the variables for all the visual script graphs that a GameObject can contain. That means that all graphs we add to our object will share those variables. You can create graph-specific variables if you want, but they won’t be exposed in the Inspector, and this way also simplifies the access of variables from other objects’ scripts. Also remember, you will want to add several graphs to the object, given that each graph will take care of different behaviors, in a way in which we can mix and match them according to our needs.</p>
    <p class="normal">In order to add a variable to our GameObject that can be used by our graph, let’s do the following:</p>
    <ol style="list-style-type: decimal;" class="numberedList">
      <li class="numberedList" value="1">Select a GameObject with a visual script added (with the <strong class="screenText">Script Machine</strong> component) and look at the <strong class="screenText">Variables</strong> component.</li>
      <li class="numberedList">Click the input field that says <strong class="screenText">(New Variable Name)</strong> and type the name of the variable. In my case, this is <code class="inlineCode">speed</code>. If you don’t see that option, click the triangle at the left of the <strong class="screenText">Variables</strong> component name.</li>
      <li class="numberedList">Click the <strong class="screenText">Plus (+)</strong> button of the <strong class="screenText">Variables</strong> component.</li>
      <li class="numberedList">In the <strong class="screenText">Type</strong> dropdown, select <strong class="screenText">Float</strong>.</li>
      <li class="numberedList">Optionally, you can set an initial value in the <strong class="screenText">Value</strong> field:</li>
    </ol>
    <figure class="mediaobject"><img src="../Images/B21361_05_23_PRE_BOOK.png" alt="A screenshot of a computer  Description automatically generated with medium confidence"/></figure>
    <p class="packt_figref">Figure 5.23: Creating variables for the visual graph</p>
    <p class="normal">We created a <code class="inlineCode">speed</code> variable <a id="_idIndexMarker246"/>that we can configure in the GameObject to alter the way all <strong class="screenText">visual script graphs</strong> attached to our GameObject will work, or at least the ones that use that variable value. Consider that maybe you will have different kinds of speed, like movement and <a id="_idIndexMarker247"/>rotational speed, so in real cases you might want to be a bit more specific with the variable name.</p>
    <p class="normal">In visual scripting, the <code class="inlineCode">Variables</code> component is used to manage data, similar to how a Blackboard is used in some programming systems to share and access data across different components or agents. This Blackboard is a container of several values of our object, like a memory or database, that several other components of our object will then query and use. C# scripts usually contain their own variables inside instead. With our scripts created and ready to be configured, let’s see how to make both of them do something.</p>
    <h1 id="_idParaDest-82" class="heading-1">Using events and instructions</h1>
    <p class="normal">Now that we have a<a id="_idIndexMarker248"/> script, we are ready to do something with it. We won’t implement anything useful in this chapter, but we will settle the base concepts to add interesting behavior to the scripts we are going to create in the next chapters.</p>
    <p class="normal">In this section, we are going to cover the following concepts:</p>
    <ul>
      <li class="bulletList">Events and instructions in C#</li>
      <li class="bulletList">Events and instructions in visual scripting</li>
      <li class="bulletList">Using fields in instructions</li>
    </ul>
    <p class="normal">We are going to explore the <strong class="screenText">Unity Event System</strong>, which will allow us to respond to different situations by executing instructions. These instructions will also be affected by the value of the editor. Finally, we are going to discuss common scripting errors and how to solve them. Let’s start by introducing the concept of UnityEvents in C#.</p>
    <h2 id="_idParaDest-83" class="heading-2">Events and instructions in C#</h2>
    <p class="normal">Unity allows us to <a id="_idIndexMarker249"/>create behavior in a cause-effect fashion, which is usually called an <strong class="screenText">event system</strong>. An event is a situation that Unity is monitoring—for example, when two objects collide or are destroyed, Unity tells us about this situation, allowing us to react according to our needs. As an example, we can reduce the life of a player when it collides with a bullet. Here, we will explore how to listen to these events and test them using some simple actions.</p>
    <p class="normal">If you are used to event systems, you will know that they usually require us to subscribe to some kind of listener or delegate, but in Unity, there is a simpler method available. For C# scripts, we just need to write a function with the exact same name as the event we want to use—and I mean <em class="italic">exact</em>. If a letter of the name doesn’t have the correct casing, it won’t execute, and no warning will be raised. This is the most common beginner’s error that is made, so pay attention. For visual scripting, we will add a special kind of node, but we will discuss that after the C# version.</p>
    <p class="normal">There are lots of events or messages to listen to in Unity, so let’s start with the most common one—<code class="inlineCode">Update</code>. This event will tell you when Unity wants you to update your object, However, depending on the purpose of your behavior, not all objects or scripts require the use of the Update event. The <code class="inlineCode">Update</code> logic is usually something that needs to be executed constantly—to be more precise, in every frame. Remember that every game is like a movie—a sequence of images that your screen switches through fast enough to look like we have continuous motion. A common action to perform in the <code class="inlineCode">Update</code> event is to move objects a little bit, and by doing this, every frame will make your object constantly move.</p>
    <p class="normal">We will learn about the sorts of things we can do with <code class="inlineCode">Update</code> and other events or messages later. Now, let’s focus on how to make our component at least listen to this event. Actually, the base script already comes with two event functions that are ready to use, one being <code class="inlineCode">Update</code> and the other one <code class="inlineCode">Start</code>. If you are not familiar with the concept of methods in C#, we are referring to the snippet of code in the following screenshot, which is already included in our script. Try to find it in yours:</p>
    <figure class="mediaobject"><img src="../Images/B21361_05_24_PRE_BOOK.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 5.24: A function called Update, which will be executed with every frame</p>
    <p class="normal">You will <a id="_idIndexMarker250"/>notice a (usually) green line of text (depending on the IDE) above the <code class="inlineCode">void Update()</code> line—this is called a <strong class="screenText">comment</strong>. These are basically ignored by the compiler. They are just notes that you can leave to yourself and must always begin with <code class="inlineCode">//</code>, preventing Unity from trying to execute them and failing. We will use this to temporarily disable lines of code later.</p>
    <p class="normal">Now, to test whether the <code class="inlineCode">Update</code> method actually works, let’s add an instruction to be executed all the time. There’s no better test function than <code class="inlineCode">print</code>. This is a simple instruction that tells Unity to print a message to the console, where all kinds of messages can be seen by the developers to check whether everything is properly working. The user will never see these messages. They are similar to the classic log files that developers sometimes ask you for when something goes wrong in a game and you are reporting an issue.</p>
    <p class="normal">In order to test events in C# using functions, follow these steps:</p>
    <ol style="list-style-type: decimal;" class="numberedList">
      <li class="numberedList" value="1">Open the script by double-clicking on it.</li>
      <li class="numberedList">To test, add <code class="inlineCode">print(“test”);</code> within the event function. In the following screenshot, you can see an example of how to do that in the <code class="inlineCode">Update</code> event. Remember to write the instruction <em class="italic">exactly</em>, including the correct casing, spaces, and quote symbols:</li>
    </ol>
    <figure class="mediaobject"><img src="../Images/B21361_05_25_PRE_BOOK.png" alt="A picture containing text, font, screenshot, white  Description automatically generated"/></figure>
    <p class="packt_figref">Figure 5.25: Printing a message in all the frames</p>
    <ol style="list-style-type: decimal;" class="numberedList">
      <li class="numberedList" value="3">Save<a id="_idIndexMarker251"/> the file, go to Unity, and play the game.
    <div class="note">
      <p class="normal">Remember to save the file before switching back to Unity from the IDE. This is the only way that Unity knows your file has changed. Some IDEs, such as Rider, save the file automatically for you, but I don’t recommend you use auto-save, at least in big projects. You don’t want accidental recompilations of unfinished work—that takes too long in projects with lots of scripts.</p>
    </div></li>
    </ol>
    <ol style="list-style-type: decimal;" class="numberedList">
      <li class="numberedList" value="4">Look for the <strong class="screenText">Console</strong> tab and select it. This is usually found next to the <strong class="screenText">Project View </strong>tab. If you can’t find it, go to <strong class="screenText">Window | General | Console</strong>, or press <em class="keystroke">Ctrl</em> + <em class="keystroke">Shift</em> + <em class="keystroke">C</em> (<em class="keystroke">Command</em> + <em class="keystroke">Shift</em> + <em class="keystroke">C</em> on macOS).</li>
      <li class="numberedList">You will see a new printed message, saying <code class="inlineCode">“test”</code>, in every frame on the <strong class="screenText">Console</strong> tab. If you don’t see this, remember to save the script file before playing the game.</li>
      <li class="numberedList">You might see a single message but with a number increasing to its right; that means the same message appears several times. Try clicking the <strong class="screenText">Collapse</strong> button of the console tab to change that behavior.</li>
      <li class="numberedList">Let’s also test the <code class="inlineCode">Start</code> function. Add <code class="inlineCode">print(“test Start”);</code> to it, save the file, and play the game. The full script should look as follows:</li>
    </ol>
    <figure class="mediaobject"><img src="../Images/B21361_05_26_PRE_BOOK.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 5.26: The script that tests the Start and Update functions</p>
    <p class="normal">If you check the console now and scroll all the way up, you will see a single <code class="inlineCode">“test Start”</code> message and lots of <code class="inlineCode">“test”</code> messages following it. As you can guess, the <code class="inlineCode">Start</code> event tells you that the GameObject is created and allows you to execute the code that needs to execute <a id="_idIndexMarker252"/>just once at the beginning of its lifetime.</p>
    <p class="normal">For the <code class="inlineCode">void Update()</code> syntax, we will say to Unity that whatever is contained within the brackets below this line is a function that will be executed in all the frames. It is important to put the <code class="inlineCode">print</code> instruction <em class="italic">inside</em> the <code class="inlineCode">Update</code> brackets (the ones inside the brackets of the class). Also, the <code class="inlineCode">print</code> function expects to receive a value to print inside its parenthesis, called an argument or parameter. In our example, we want to print simple text, and in C#, it must be enclosed with quotation marks. Finally, all instructions inside functions such as <code class="inlineCode">Update</code> or <code class="inlineCode">Start</code> <em class="italic">must</em> end with a semicolon.</p>
    <p class="normal">Here, I challenge you to try to add another event called <code class="inlineCode">OnDestroy</code>, using <code class="inlineCode">print</code> to discover when it executes. A small suggestion is to play and stop the game and look at the bottom of the console to test this one.</p>
    <p class="normal">For advanced users, you can also use breakpoints if your IDE allows you to do that. <strong class="screenText">Breakpoints</strong> allow you to freeze Unity completely before executing a specific code line to see how our field’s data changes over time and to detect errors. Here, I will show you the steps to use breakpoints in Rider, but the Visual Studio version should be similar:</p>
    <ol style="list-style-type: decimal;" class="numberedList">
      <li class="numberedList" value="1">Install the Unity package belonging to your IDE if not already installed. Check the <strong class="screenText">Package Manager</strong> for the <strong class="screenText">JetBrains Rider Editor</strong> package. In the case of Visual Studio, install the <strong class="screenText">Visual Studio Editor</strong> package.</li>
      <li class="numberedList">Click on the vertical bar at the left of the line where you want to add the breakpoint:</li>
    </ol>
    <figure class="mediaobject"><img src="../Images/B21361_05_27_PRE_BOOK.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 5.27: A breakpoint in the print instruction</p>
    <ol style="list-style-type: decimal;" class="numberedList">
      <li class="numberedList" value="3">Go to <strong class="screenText">Run | Attach to Unity Process</strong>. If you are using Visual Studio, go to <strong class="screenText">Debug | Attach Unity Debugger</strong>:</li>
    </ol>
    <figure class="mediaobject"><img src="../Images/B21361_05_28_PRE_BOOK.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 5.28: Attacking our IDE with a Unity process</p>
    <ol style="list-style-type: decimal;" class="numberedList">
      <li class="numberedList" value="4">From the<a id="_idIndexMarker253"/> list, look for the specific Unity instance you want to test. The list will show other opened editors or running debugging builds if there are any.</li>
      <li class="numberedList">If this doesn’t work, check if the editor is in debug mode by looking at the bug icon in the bottom-right part of the editor. If the bug looks blue with a checkbox, then it is OK, but if it looks gray and crossed out, click it and click <strong class="screenText">Switch to debug mode</strong>:</li>
    </ol>
    <figure class="mediaobject"><img src="../Images/B21361_05_29_PRE_BOOK.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 5.29: Changing from release mode to debug mode</p>
    <p class="normal">Stopping the<a id="_idIndexMarker254"/> debugging process won’t close Unity. It will just detach the IDE from the editor. Remember you can click the <strong class="screenText">Continue</strong> button in Visual Studio (and the equivalent in other IDEs) to continue the game execution without detaching the debugger.</p>
    <p class="normal">Now, let’s explore the visual scripting equivalent of using events and instructions.</p>
    <h2 id="_idParaDest-84" class="heading-2">Events and instructions in visual scripting</h2>
    <p class="normal">The<a id="_idIndexMarker255"/> same concept of events and instructions remains in visual scripting, but of course, this will be done with nodes in the graph. Remember that a node represents an instruction of the graph, and we can connect them to chain the effects of each instruction. In order to add events and the print instruction on our graph, do the following:</p>
    <ol style="list-style-type: decimal;" class="numberedList">
      <li class="numberedList" value="1">Open the visual script graph (double-click the visual script asset).</li>
      <li class="numberedList">Right-click the <strong class="screenText">On Start</strong> and <strong class="screenText">On Update</strong> nodes that are created by default, and then click <strong class="screenText">Delete</strong>. Even if those events are the ones we need, I want you to see how to create them from scratch:</li>
    </ol>
    <figure class="mediaobject"><img src="../Images/B21361_05_30_PRE_BOOK.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 5.30: Deleting nodes</p>
    <ol style="list-style-type: decimal;" class="numberedList">
      <li class="numberedList" value="3">Right-click<a id="_idIndexMarker256"/> in any empty space of the graph and type <code class="inlineCode">start</code> inside the <strong class="screenText">Search</strong> box. It can take a while the first time.</li>
      <li class="numberedList">Select the <strong class="screenText">On Start</strong> element in the list with the green checkbox to its left. In this case, I knew this was an event because I was aware of it, but usually, you will recognize it as an event because it won’t have input pins (more on that in the next steps):</li>
    </ol>
    <figure class="mediaobject"><img src="../Images/B21361_05_31_PRE_BOOK.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 5.31: Searching the On Start event node</p>
    <ol style="list-style-type: decimal;" class="numberedList">
      <li class="numberedList" value="5">Drag the white arrow at the right of the event node, also known as the output flow pin, and release the mouse button in any empty space.</li>
      <li class="numberedList">In the <strong class="screenText">Search</strong> box, search for the <code class="inlineCode">print</code> node, and select the one that says <strong class="screenText">Mono Behaviour:Print</strong>. This means that when the <strong class="screenText">On Start</strong> event happens, the connected node will be executed—in this case, <strong class="screenText">print</strong>. This is how we start to chain instructions to events:</li>
    </ol>
    <figure class="mediaobject"><img src="../Images/B21361_05_32_PRE_BOOK.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 5.32: Creating a print node connected to the event</p>
    <ol style="list-style-type: decimal;" class="numberedList">
      <li class="numberedList" value="7">Drag the <a id="_idIndexMarker257"/>empty circle at the left of the <strong class="screenText">Message</strong> input pin of the <strong class="screenText">print</strong> node, and release it in any empty space. This pin is marked with a circle, indicating that it is a parameter pin, containing data that will be used when executing the pin. The flow pins, the ones with a green arrow, represent the order in which the nodes will be executed.</li>
      <li class="numberedList">Select the <strong class="screenText">String Literal</strong> option, which will create a node to allow us to specify the message to print:</li>
    </ol>
    <figure class="mediaobject"><img src="../Images/B21361_05_33_PRE_BOOK.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 5.33: Creating a String literal node</p>
    <ol style="list-style-type: decimal;" class="numberedList">
      <li class="numberedList" value="9">In the empty <a id="_idIndexMarker258"/>white box, write the message to be printed:</li>
    </ol>
    <figure class="mediaobject"><img src="../Images/B21361_05_34_PRE_BOOK.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 5.34: Specifying the message to print</p>
    <ol style="list-style-type: decimal;" class="numberedList">
      <li class="numberedList" value="10">Play the game, and<a id="_idIndexMarker259"/> see the message printed in the console. Be sure you have only the visual scripting version in the scene to avoid confusing the message in the console with the C# version. You can also use different message text in the visual scripts to be sure which ones are really executing.</li>
    </ol>
    <p class="normal">Now we have the same behavior we previously coded using C#, but now using the visual scripting tool in Unity. You can chain more actions to <strong class="screenText">On Start</strong> by dragging the pin to the right (Output Flow Pin) of the <strong class="screenText">Print</strong> node and chaining new nodes, but we will do that later. Now that we have our scripts doing something, let’s make the instructions use the fields we created so that the scripts use their configurations.</p>
    <h2 id="_idParaDest-85" class="heading-2">Using fields in instructions</h2>
    <p class="normal">We have<a id="_idIndexMarker260"/> created fields to configure our components’ behavior, but we have not used them so far. We will create meaningful components in the next chapter, but one thing we will often need is to use the fields we have created to change the behavior of the object. So far, we have no real use of the <code class="inlineCode">speed</code> field that we created. However, following the idea of testing whether our code is working (also known as debugging), we can learn how to use the data inside a field with a function to test whether the value is the expected one, changing the output of <code class="inlineCode">print</code> in the console according to the field’s value.</p>
    <p class="normal">In our <a id="_idIndexMarker261"/>current C# script, our <code class="inlineCode">speed</code> value doesn’t change during runtime. However, as an example, if you are creating a life system with shield damage absorption and you want to test whether the reduced damage calculation is working properly, you might want to print the calculation values to the console and check whether they are correct.</p>
    <p class="normal">The idea here is to replace the fixed message inside the <code class="inlineCode">print</code> functions with a field. When you do that, <code class="inlineCode">print</code> will show the field’s value in the console. So if you set a value of <code class="inlineCode">5</code> in <code class="inlineCode">speed</code> and you print it, you will see lots of messages saying <code class="inlineCode">5</code> in the console, and the output of the <code class="inlineCode">print</code> function is governed by the field. To test this, your <code class="inlineCode">print</code> message within the <code class="inlineCode">Update</code> function should look as follows:</p>
    <figure class="mediaobject"><img src="../Images/B21361_05_35_PRE_BOOK.png" alt="A picture containing text, font, screenshot, line  Description automatically generated"/></figure>
    <p class="packt_figref">Figure 5.35: Using a field as a print function parameter</p>
    <p class="normal">As you can see, we just put the name of the field without quotation marks. If you use quotation marks, you will print a <code class="inlineCode">“speed”</code> message. In other scenarios, you can use this <code class="inlineCode">speed</code> value within some moving functions to control how fast the movement will be, or you can perhaps create a field called <code class="inlineCode">“fireRate”</code> (fields use <strong class="screenText">camel case</strong> instead of Pascal case, with the first letter being in lowercase) to control the cooldown time between one bullet and the next:</p>
    <figure class="mediaobject"><img src="../Images/B21361_05_36_PRE_BOOK.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 5.36: Printing the current speed</p>
    <p class="normal">Now, to make<a id="_idIndexMarker262"/> the visual script graph print the value of the <strong class="screenText">speed </strong>variable we created in the <strong class="screenText">Variables</strong> component, let’s do the following:</p>
    <ol style="list-style-type: decimal;" class="numberedList">
      <li class="numberedList" value="1">Open the visual scripting graph asset (double-click it).</li>
      <li class="numberedList">In the panel on the left, select the <strong class="screenText">Object </strong>tab to display all the variables our object has—essentially the ones we defined in the <strong class="screenText">Variables</strong> component previously.</li>
      <li class="numberedList">Drag the <strong class="screenText">speed</strong> variable, using the two lines to the left of the variable box, to any empty area of the graph. This will create a <strong class="screenText">Get Variable</strong> node in the graph to represent the variable.</li>
    </ol>
    <figure class="mediaobject"><img src="../Images/B21361_05_37_PRE_BOOK.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 5.37: Dragging variables to the graph to be used in the nodes</p>
    <ol style="list-style-type: decimal;" class="numberedList">
      <li class="numberedList" value="4">Drag the empty circle at the right of the <strong class="screenText">Get Variable </strong>node to the circle at the left of the <strong class="screenText">Message</strong> input pin of the <strong class="screenText">Print</strong> node. This will replace the previous connection to the <strong class="screenText">String Literal </strong>node. This node doesn’t have <strong class="screenText">Input</strong> or <strong class="screenText">Output</strong> flow <a id="_idIndexMarker263"/>nodes (the green arrow ones), as they are data-only nodes that provide data to other nodes. In this case, when <code class="inlineCode">Print</code> needs to execute, it will execute <code class="inlineCode">Get Variable</code> to get the text to read:</li>
    </ol>
    <figure class="mediaobject"><img src="../Images/B21361_05_38_PRE_BOOK.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 5.38: Connecting the speed variable to the Print node</p>
    <ol style="list-style-type: decimal;" class="numberedList">
      <li class="numberedList" value="5">Right-click on the <strong class="screenText">String Literal</strong> node and delete it.</li>
      <li class="numberedList">Play the game and observe.</li>
    </ol>
    <p class="normal">With all this, we now have the necessary tools to start creating actual components. Before moving on, let’s recap some of the common errors that you will likely encounter if this is your first time creating scripts in C#.</p>
    <h1 id="_idParaDest-86" class="heading-1">Common beginner C# script errors</h1>
    <p class="normal">Visual scripting scripts are prepared in a way in which you make fewer errors, not allowing you to write incorrect syntax like C# script does. If you are an experienced programmer, I bet you are quite familiar with them, but let’s recap the common errors that will make you lose lots of time when you start out with C# scripting. Most of them are caused by not copying the shown code <em class="italic">exactly</em>. If you have an error in the code, Unity will show a red message in the console and won’t allow you to run the game, even if you are not using the script. So never leave anything unfinished.</p>
    <p class="normal">Let’s start with a classic error, a missing semicolon, which has resulted in many programmer memes and jokes. All fields and most instructions inside functions (such as <code class="inlineCode">print</code>), when called, need to have a semicolon at the end. If you don’t add a semicolon, Unity will show an error, such as the one in the screenshot in <em class="italic">Figure 5.39</em>, in the console. </p>
    <p class="normal">You will also notice that this also has an example of bad code, where the IDE shows a red icon, suggesting something is wrong in that place:</p>
    <figure class="mediaobject"><img src="../Images/B21361_05_39_PRE_BOOK.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 5.39: An error in the print line Flagged by the IDE and the Unity console</p>
    <p class="normal">You will notice that the error shows the exact script (<code class="inlineCode">MyFirstScript.cs</code>), the exact line of code (<code class="inlineCode">14</code>, in this case), and usually, a descriptive message—in this case, <code class="inlineCode">;expected</code>—as a way to specify that the instruction ends there, so the compiler can process the next instruction as a separate one. You can simply double-click the error and Unity will open the IDE, highlighting the problematic line. You can even click on the links in the stack to jump to the line of the stack that you want.</p>
    <p class="normal">I already mentioned why it is important to use the <em class="italic">exact</em> case for every letter of the instruction. However, based on my experience of teaching beginners, I need to stress this particular aspect more.</p>
    <p class="normal">The first scenario where this can happen is in instructions. In the following screenshots, you can see how a badly written <code class="inlineCode">print</code> function looks—that is, the error that the console will <a id="_idIndexMarker264"/>display and how the IDE will suggest that there is something wrong. First, in the case of Rider, the instruction is colored red, saying that the instruction is not recognized (in Visual Studio, it will show a red line instead). Then, the error message says that <code class="inlineCode">Print</code> does not exist in the current context, meaning that Unity (or C#, actually) does not recognize any instruction named <code class="inlineCode">Print</code>. In another type of script, <code class="inlineCode">Print</code> in uppercase may be valid, but not in regular components, which is why the “<strong class="keyWord">in the current context</strong>” clarification exists:</p>
    <figure class="mediaobject"><img src="../Images/B21361_05_40_PRE_BOOK.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 5.40: Error message when writing an instruction incorrectly</p>
    <p class="normal">Now, if you write an event with the wrong casing, the situation is worse. You can create functions such as <code class="inlineCode">Start</code> and <code class="inlineCode">Update</code> with whatever name you want for other purposes. Writing <code class="inlineCode">update</code> or <code class="inlineCode">start</code> is perfectly valid, as C# will think that you are going to use those functions not as events but as regular functions. So, no error will be shown, and your code will just not work. Try to write <code class="inlineCode">update</code> instead of <code class="inlineCode">Update</code> and see what happens:</p>
    <figure class="mediaobject"><img src="../Images/B21361_05_41_PRE_BOOK.png" alt="A picture containing text, font, screenshot, white  Description automatically generated"/></figure>
    <p class="packt_figref">Figure 5.41: The wrong casing in the Update function will compile the function but won’t execute it</p>
    <p class="normal">Another error is to put instructions outside the function brackets, such as inside the brackets of the class or outside them. Doing this will give no hint to the function as to when it <a id="_idIndexMarker265"/>needs to execute. So a <code class="inlineCode">print</code> function outside an <code class="inlineCode">Event</code> function makes no sense, and it will show an error such as the ones in <em class="italic">Figures 5.42</em> and <em class="italic">5.43</em>.</p>
    <p class="normal">This time, the error is not super-descriptive. C# expects you to create a function or a field—the kind of structure that can be put directly inside a class:</p>
    <figure class="mediaobject"><img src="../Images/B21361_05_42_PRE_BOOK.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 5.42: Misplaced instruction or function call</p>
    <p class="normal">Finally, another classic mistake is to forget to close open brackets. If you don’t close a bracket, C# won’t know where a function finishes and another starts or where the class function ends. This may sound redundant, but C# needs that to be perfectly defined. In the following screenshots, you can see how this would look:</p>
    <figure class="mediaobject"><img src="../Images/B21361_05_43_PRE_BOOK.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 5.43: Missing closed brackets</p>
    <div class="note">
      <p class="normal">So much time is lost looking for that missing semicolon at the end of the line. At first, it was extremely frustrating trying to figure out what was wrong in my code but, at the same time, very satisfying to find the solution and have it all working again. That frustration-satisfaction loop still happens to me, maybe with more complex issues, but it’s all part of being a developer. The sooner you embrace it, the faster you will see improvement.</p>
    </div>
    <p class="normal">This one <a id="_idIndexMarker266"/>is a little bit difficult to catch because the error in the code is shown way after the actual error. This is caused by the fact that C# allows you to put functions inside functions (not used often), and so C# will detect the error later, asking you to add a closing bracket. However, as we don’t want to put <code class="inlineCode">Update</code> inside <code class="inlineCode">Start</code>, we need to fix the error beforehand, at the end of <code class="inlineCode">Start</code>. The error message will be descriptive in the console, but again, don’t put the closing bracket where the message suggests you do unless you are 100% sure that position is correct.</p>
    <p class="normal">You will likely face lots of errors aside from these ones, but they all work the same. The IDE will show you a hint, and the console will display a message; you will learn how to resolve them with time. Just have patience, as every programmer experiences this. There are other kinds of errors, such as runtime errors, code that compiles but fails when being executed due to some misconfiguration, or the worst, logic errors, where your code compiles and executes with no error but doesn’t do what you intended.</p>
    <h1 id="_idParaDest-87" class="heading-1">Summary</h1>
    <p class="normal">In this chapter, we explored the basic concepts that you will use while creating scripts. We discussed the concept of a script’s assets and how the C# ones must inherit from <code class="inlineCode">MonoBehaviour</code> to be accepted by Unity to create our own scripts. We also saw how to mix events and instructions to add behavior to an object and how to use fields in instructions to customize what they do. All of this was done using both C# and visual scripting.</p>
    <p class="normal">We just explored the basics of scripting to ensure that everyone is on the same page. However, from now on, we will assume that you have basic coding experience in some programming language, and you know how to use structures such as <code class="inlineCode">if</code>, <code class="inlineCode">for</code>, <code class="inlineCode">array</code>, and so on. If not, you can still read through this book and try to complement the areas you don’t understand with a C# introduction book, as you need.</p>
    <p class="normal">In the next chapter, we are going to start seeing how we can use what we have learned to create movement and spawning scripts.</p>
    <h1 id="_idParaDest-88" class="heading-1">Learn more on Discord</h1>
    <p class="normal">Read this book alongside other users, Unity game development experts, and the author himself. Ask questions, provide solutions to other readers, chat with the author via Ask Me Anything sessions, and much more. Scan the QR code or visit the link to join the community:</p>
    <p class="normal"><a href="https://packt.link/unitydev"><span class="url">https://packt.link/unitydev</span></a></p>
    <p class="normal"><img src="../Images/QR_Code1498477041053909218.png" alt="" role="presentation"/></p>
  </div>
</body></html>